var HEe=Object.defineProperty;var jEe=t=>{throw TypeError(t)};var VEe=(t,e,n)=>e in t?HEe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Qn=(t,e,n)=>VEe(t,typeof e!="symbol"?e+"":e,n);var wR=(t,e,n)=>e.has(t)?jEe("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n);function GEe(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const s=Object.getOwnPropertyDescriptor(i,r);s&&Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var Ll=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function jre(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var r=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return t[i]}})}),n}var Vre={exports:{}},qU={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qEe=Symbol.for("react.transitional.element"),$Ee=Symbol.for("react.fragment");function Gre(t,e,n){var i=null;if(n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),"key"in e){n={};for(var r in e)r!=="key"&&(n[r]=e[r])}else n=e;return e=n.ref,{$$typeof:qEe,type:t,key:i,ref:e!==void 0?e:null,props:n}}qU.Fragment=$Ee;qU.jsx=Gre;qU.jsxs=Gre;Vre.exports=qU;var Ae=Vre.exports;function WEe(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qre={exports:{}},Fo=qre.exports={},ag,og;function xj(){throw new Error("setTimeout has not been defined")}function wj(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?ag=setTimeout:ag=xj}catch{ag=xj}try{typeof clearTimeout=="function"?og=clearTimeout:og=wj}catch{og=wj}})();function $re(t){if(ag===setTimeout)return setTimeout(t,0);if((ag===xj||!ag)&&setTimeout)return ag=setTimeout,setTimeout(t,0);try{return ag(t,0)}catch{try{return ag.call(null,t,0)}catch{return ag.call(this,t,0)}}}function YEe(t){if(og===clearTimeout)return clearTimeout(t);if((og===wj||!og)&&clearTimeout)return og=clearTimeout,clearTimeout(t);try{return og(t)}catch{try{return og.call(null,t)}catch{return og.call(this,t)}}}var Mv=[],iw=!1,MS,kD=-1;function XEe(){!iw||!MS||(iw=!1,MS.length?Mv=MS.concat(Mv):kD=-1,Mv.length&&Wre())}function Wre(){if(!iw){var t=$re(XEe);iw=!0;for(var e=Mv.length;e;){for(MS=Mv,Mv=[];++kD<e;)MS&&MS[kD].run();kD=-1,e=Mv.length}MS=null,iw=!1,YEe(t)}}Fo.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];Mv.push(new Yre(t,e)),Mv.length===1&&!iw&&$re(Wre)};function Yre(t,e){this.fun=t,this.array=e}Yre.prototype.run=function(){this.fun.apply(null,this.array)};Fo.title="browser";Fo.browser=!0;Fo.env={};Fo.argv=[];Fo.version="";Fo.versions={};function uy(){}Fo.on=uy;Fo.addListener=uy;Fo.once=uy;Fo.off=uy;Fo.removeListener=uy;Fo.removeAllListeners=uy;Fo.emit=uy;Fo.prependListener=uy;Fo.prependOnceListener=uy;Fo.listeners=function(t){return[]};Fo.binding=function(t){throw new Error("process.binding is not supported")};Fo.cwd=function(){return"/"};Fo.chdir=function(t){throw new Error("process.chdir is not supported")};Fo.umask=function(){return 0};var KEe=qre.exports;const zn=WEe(KEe);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const $O="176",JEe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ZEe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Xre=0,Cj=1,Kre=2,QEe=3,Jre=0,$U=1,CA=2,Bp=3,Dg=0,Pc=1,cl=2,Yf=0,US=1,Rj=2,Aj=3,Mj=4,Zre=5,L_=100,Qre=101,ese=102,tse=103,nse=104,ise=200,rse=201,sse=202,ase=203,$P=204,WP=205,ose=206,cse=207,lse=208,use=209,hse=210,dse=211,fse=212,pse=213,mse=214,YP=0,XP=1,KP=2,eT=3,JP=4,ZP=5,QP=6,eL=7,WO=0,gse=1,vse=2,Kp=0,yse=1,_se=2,bse=3,cq=4,Ese=5,Sse=6,Tse=7,Oj="attached",xse="detached",WU=300,Xv=301,vb=302,mM=303,gM=304,IC=306,vM=1e3,Hf=1001,yM=1002,Za=1003,lq=1004,eSe=1004,M1=1005,tSe=1005,_a=1006,RA=1007,nSe=1007,gg=1008,iSe=1008,ml=1009,uq=1010,hq=1011,kw=1012,YU=1013,Pg=1014,iu=1015,Lb=1016,XU=1017,KU=1018,tT=1020,dq=35902,fq=1021,pq=1022,ru=1023,Dw=1026,nT=1027,JU=1028,YO=1029,mq=1030,ZU=1031,rSe=1032,XO=1033,AA=33776,MA=33777,OA=33778,NA=33779,tL=35840,nL=35841,iL=35842,rL=35843,sL=36196,aL=37492,oL=37496,cL=37808,lL=37809,uL=37810,hL=37811,dL=37812,fL=37813,pL=37814,mL=37815,gL=37816,vL=37817,yL=37818,_L=37819,bL=37820,EL=37821,IA=36492,SL=36494,TL=36495,gq=36283,xL=36284,wL=36285,CL=36286,wse=2200,Cse=2201,Rse=2202,_M=2300,RL=2301,DD=2302,OS=2400,NS=2401,bM=2402,QU=2500,vq=2501,sSe=0,aSe=1,oSe=2,Ub=3200,Ase=3201,cSe=3202,lSe=3203,Bb=0,Mse=1,$p="",ya="srgb",Lg="srgb-linear",EM="linear",ws="srgb",uSe=0,fS=7680,hSe=7681,dSe=7682,fSe=7683,pSe=34055,mSe=34056,gSe=5386,vSe=512,ySe=513,_Se=514,bSe=515,ESe=516,SSe=517,TSe=518,Nj=519,Ose=512,Nse=513,Ise=514,yq=515,kse=516,Dse=517,Pse=518,Lse=519,SM=35044,xSe=35048,wSe=35040,CSe=35045,RSe=35049,ASe=35041,MSe=35046,OSe=35050,NSe=35042,ISe="100",Ij="300 es",jf=2e3,TM=2001,kSe={COMPUTE:"compute",RENDER:"render"},DSe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},PSe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class Yd{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(n)===-1&&i[e].push(n)}hasEventListener(e,n){const i=this._listeners;return i===void 0?!1:i[e]!==void 0&&i[e].indexOf(n)!==-1}removeEventListener(e,n){const i=this._listeners;if(i===void 0)return;const r=i[e];if(r!==void 0){const s=r.indexOf(n);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const n=this._listeners;if(n===void 0)return;const i=n[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const Xl=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let lX=1234567;const BS=Math.PI/180,Pw=180/Math.PI;function zd(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Xl[t&255]+Xl[t>>8&255]+Xl[t>>16&255]+Xl[t>>24&255]+"-"+Xl[e&255]+Xl[e>>8&255]+"-"+Xl[e>>16&15|64]+Xl[e>>24&255]+"-"+Xl[n&63|128]+Xl[n>>8&255]+"-"+Xl[n>>16&255]+Xl[n>>24&255]+Xl[i&255]+Xl[i>>8&255]+Xl[i>>16&255]+Xl[i>>24&255]).toLowerCase()}function Xi(t,e,n){return Math.max(e,Math.min(n,t))}function _q(t,e){return(t%e+e)%e}function LSe(t,e,n,i,r){return i+(t-e)*(r-i)/(n-e)}function USe(t,e,n){return t!==e?(n-t)/(e-t):0}function kA(t,e,n){return(1-n)*t+n*e}function BSe(t,e,n,i){return kA(t,e,1-Math.exp(-n*i))}function FSe(t,e=1){return e-Math.abs(_q(t,e*2)-e)}function zSe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function HSe(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function jSe(t,e){return t+Math.floor(Math.random()*(e-t+1))}function VSe(t,e){return t+Math.random()*(e-t)}function GSe(t){return t*(.5-Math.random())}function qSe(t){t!==void 0&&(lX=t);let e=lX+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function $Se(t){return t*BS}function WSe(t){return t*Pw}function YSe(t){return(t&t-1)===0&&t!==0}function XSe(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function KSe(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function JSe(t,e,n,i,r){const s=Math.cos,a=Math.sin,o=s(n/2),c=a(n/2),l=s((e+i)/2),u=a((e+i)/2),h=s((e-i)/2),d=a((e-i)/2),f=s((i-e)/2),p=a((i-e)/2);switch(r){case"XYX":t.set(o*u,c*h,c*d,o*l);break;case"YZY":t.set(c*d,o*u,c*h,o*l);break;case"ZXZ":t.set(c*h,c*d,o*u,o*l);break;case"XZX":t.set(o*u,c*p,c*f,o*l);break;case"YXY":t.set(c*f,o*u,c*p,o*l);break;case"ZYZ":t.set(c*p,c*f,o*u,o*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Yu(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function tr(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const Use={DEG2RAD:BS,RAD2DEG:Pw,generateUUID:zd,clamp:Xi,euclideanModulo:_q,mapLinear:LSe,inverseLerp:USe,lerp:kA,damp:BSe,pingpong:FSe,smoothstep:zSe,smootherstep:HSe,randInt:jSe,randFloat:VSe,randFloatSpread:GSe,seededRandom:qSe,degToRad:$Se,radToDeg:WSe,isPowerOfTwo:YSe,ceilPowerOfTwo:XSe,floorPowerOfTwo:KSe,setQuaternionFromProperEuler:JSe,normalize:tr,denormalize:Yu};class Rt{constructor(e=0,n=0){Rt.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,i=this.y,r=e.elements;return this.x=r[0]*n+r[3]*i+r[6],this.y=r[1]*n+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y;return n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const i=Math.cos(n),r=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*r+e.x,this.y=s*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Zi{constructor(e,n,i,r,s,a,o,c,l){Zi.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l)}set(e,n,i,r,s,a,o,c,l){const u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=n,u[4]=s,u[5]=c,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(e,n,i){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[3],c=i[6],l=i[1],u=i[4],h=i[7],d=i[2],f=i[5],p=i[8],g=r[0],_=r[3],v=r[6],E=r[1],T=r[4],x=r[7],N=r[2],A=r[5],I=r[8];return s[0]=a*g+o*E+c*N,s[3]=a*_+o*T+c*A,s[6]=a*v+o*x+c*I,s[1]=l*g+u*E+h*N,s[4]=l*_+u*T+h*A,s[7]=l*v+u*x+h*I,s[2]=d*g+f*E+p*N,s[5]=d*_+f*T+p*A,s[8]=d*v+f*x+p*I,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8];return n*a*u-n*o*l-i*s*u+i*o*c+r*s*l-r*a*c}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=u*a-o*l,d=o*c-u*s,f=l*s-a*c,p=n*h+i*d+r*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=h*g,e[1]=(r*l-u*i)*g,e[2]=(o*i-r*a)*g,e[3]=d*g,e[4]=(u*n-r*c)*g,e[5]=(r*s-o*n)*g,e[6]=f*g,e[7]=(i*c-l*n)*g,e[8]=(a*n-i*s)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,i,r,s,a,o){const c=Math.cos(s),l=Math.sin(s);return this.set(i*c,i*l,-i*(c*a+l*o)+a+e,-r*l,r*c,-r*(-l*a+c*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply(lz.makeScale(e,n)),this}rotate(e){return this.premultiply(lz.makeRotation(-e)),this}translate(e,n){return this.premultiply(lz.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,i,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<9;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<9;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const lz=new Zi;function Bse(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const ZSe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function O1(t,e){return new ZSe[t](e)}function xM(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Fse(){const t=xM("canvas");return t.style.display="block",t}const uX={};function PD(t){t in uX||(uX[t]=!0,console.warn(t))}function QSe(t,e,n){return new Promise(function(i,r){function s(){switch(t.clientWaitSync(e,t.SYNC_FLUSH_COMMANDS_BIT,0)){case t.WAIT_FAILED:r();break;case t.TIMEOUT_EXPIRED:setTimeout(s,n);break;default:i()}}setTimeout(s,n)})}function eTe(t){const e=t.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function tTe(t){const e=t.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const hX=new Zi().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),dX=new Zi().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function nTe(){const t={enabled:!0,workingColorSpace:Lg,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===ws&&(r.r=zv(r.r),r.g=zv(r.g),r.b=zv(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===ws&&(r.r=rw(r.r),r.g=rw(r.g),r.b=rw(r.b))),r},fromWorkingColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},toWorkingColorSpace:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===$p?EM:this.spaces[r].transfer},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],n=[.2126,.7152,.0722],i=[.3127,.329];return t.define({[Lg]:{primaries:e,whitePoint:i,transfer:EM,toXYZ:hX,fromXYZ:dX,luminanceCoefficients:n,workingColorSpaceConfig:{unpackColorSpace:ya},outputColorSpaceConfig:{drawingBufferColorSpace:ya}},[ya]:{primaries:e,whitePoint:i,transfer:ws,toXYZ:hX,fromXYZ:dX,luminanceCoefficients:n,outputColorSpaceConfig:{drawingBufferColorSpace:ya}}}),t}const Lr=nTe();function zv(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function rw(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let kx;class zse{static getDataURL(e,n="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let i;if(e instanceof HTMLCanvasElement)i=e;else{kx===void 0&&(kx=xM("canvas")),kx.width=e.width,kx.height=e.height;const r=kx.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=kx}return i.toDataURL(n)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=xM("canvas");n.width=e.width,n.height=e.height;const i=n.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=zv(s[a]/255)*255;return i.putImageData(r,0,0),n}else if(e.data){const n=e.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(zv(n[i]/255)*255):n[i]=zv(n[i]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let iTe=0,V_=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:iTe++}),this.uuid=zd(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,o=r.length;a<o;a++)r[a].isDataTexture?s.push(uz(r[a].image)):s.push(uz(r[a]))}else s=uz(r);i.url=s}return n||(e.images[this.uuid]=i),i}};function uz(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?zse.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let rTe=0;class Pa extends Yd{constructor(e=Pa.DEFAULT_IMAGE,n=Pa.DEFAULT_MAPPING,i=Hf,r=Hf,s=_a,a=gg,o=ru,c=ml,l=Pa.DEFAULT_ANISOTROPY,u=$p){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:rTe++}),this.uuid=zd(),this.name="",this.source=new V_(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=l,this.format=o,this.internalFormat=null,this.type=c,this.offset=new Rt(0,0),this.repeat=new Rt(1,1),this.center=new Rt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zi,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),n||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==WU)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vM:e.x=e.x-Math.floor(e.x);break;case Hf:e.x=e.x<0?0:1;break;case yM:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case vM:e.y=e.y-Math.floor(e.y);break;case Hf:e.y=e.y<0?0:1;break;case yM:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}Pa.DEFAULT_IMAGE=null;Pa.DEFAULT_MAPPING=WU;Pa.DEFAULT_ANISOTROPY=1;class Kr{constructor(e=0,n=0,i=0,r=1){Kr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,i,r){return this.x=e,this.y=n,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*i+a[8]*r+a[12]*s,this.y=a[1]*n+a[5]*i+a[9]*r+a[13]*s,this.z=a[2]*n+a[6]*i+a[10]*r+a[14]*s,this.w=a[3]*n+a[7]*i+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,i,r,s;const c=e.elements,l=c[0],u=c[4],h=c[8],d=c[1],f=c[5],p=c[9],g=c[2],_=c[6],v=c[10];if(Math.abs(u-d)<.01&&Math.abs(h-g)<.01&&Math.abs(p-_)<.01){if(Math.abs(u+d)<.1&&Math.abs(h+g)<.1&&Math.abs(p+_)<.1&&Math.abs(l+f+v-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const T=(l+1)/2,x=(f+1)/2,N=(v+1)/2,A=(u+d)/4,I=(h+g)/4,k=(p+_)/4;return T>x&&T>N?T<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(T),r=A/i,s=I/i):x>N?x<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(x),i=A/r,s=k/r):N<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(N),i=I/s,r=k/s),this.set(i,r,s,n),this}let E=Math.sqrt((_-p)*(_-p)+(h-g)*(h-g)+(d-u)*(d-u));return Math.abs(E)<.001&&(E=1),this.x=(_-p)/E,this.y=(h-g)/E,this.z=(d-u)/E,this.w=Math.acos((l+f+v-1)/2),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this.w=n[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this.z=Xi(this.z,e.z,n.z),this.w=Xi(this.w,e.w,n.w),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this.z=Xi(this.z,e,n),this.w=Xi(this.w,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this.w=e.w+(n.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class e3 extends Yd{constructor(e=1,n=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=i.depth?i.depth:1,this.scissor=new Kr(0,0,e,n),this.scissorTest=!1,this.viewport=new Kr(0,0,e,n);const r={width:e,height:n,depth:this.depth};i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:_a,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},i);const s=new Pa(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace);s.flipY=!1,s.generateMipmaps=i.generateMipmaps,s.internalFormat=i.internalFormat,this.textures=[];const a=i.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,n,i=1){if(this.width!==e||this.height!==n||this.depth!==i){this.width=e,this.height=n,this.depth=i;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=n,this.textures[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let n=0,i=e.textures.length;n<i;n++){this.textures[n]=e.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},e.textures[n].image);this.textures[n].source=new V_(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Ul extends e3{constructor(e=1,n=1,i={}){super(e,n,i),this.isWebGLRenderTarget=!0}}class KO extends Pa{constructor(e=null,n=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Za,this.minFilter=Za,this.wrapR=Hf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class sTe extends Ul{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new KO(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class t3 extends Pa{constructor(e=null,n=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:i,depth:r},this.magFilter=Za,this.minFilter=Za,this.wrapR=Hf,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class aTe extends Ul{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new t3(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class jh{constructor(e=0,n=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=i,this._w=r}static slerpFlat(e,n,i,r,s,a,o){let c=i[r+0],l=i[r+1],u=i[r+2],h=i[r+3];const d=s[a+0],f=s[a+1],p=s[a+2],g=s[a+3];if(o===0){e[n+0]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h;return}if(o===1){e[n+0]=d,e[n+1]=f,e[n+2]=p,e[n+3]=g;return}if(h!==g||c!==d||l!==f||u!==p){let _=1-o;const v=c*d+l*f+u*p+h*g,E=v>=0?1:-1,T=1-v*v;if(T>Number.EPSILON){const N=Math.sqrt(T),A=Math.atan2(N,v*E);_=Math.sin(_*A)/N,o=Math.sin(o*A)/N}const x=o*E;if(c=c*_+d*x,l=l*_+f*x,u=u*_+p*x,h=h*_+g*x,_===1-o){const N=1/Math.sqrt(c*c+l*l+u*u+h*h);c*=N,l*=N,u*=N,h*=N}}e[n]=c,e[n+1]=l,e[n+2]=u,e[n+3]=h}static multiplyQuaternionsFlat(e,n,i,r,s,a){const o=i[r],c=i[r+1],l=i[r+2],u=i[r+3],h=s[a],d=s[a+1],f=s[a+2],p=s[a+3];return e[n]=o*p+u*h+c*f-l*d,e[n+1]=c*p+u*d+l*h-o*f,e[n+2]=l*p+u*f+o*d-c*h,e[n+3]=u*p-o*h-c*d-l*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,i,r){return this._x=e,this._y=n,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const i=e._x,r=e._y,s=e._z,a=e._order,o=Math.cos,c=Math.sin,l=o(i/2),u=o(r/2),h=o(s/2),d=c(i/2),f=c(r/2),p=c(s/2);switch(a){case"XYZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"YXZ":this._x=d*u*h+l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"ZXY":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h-d*f*p;break;case"ZYX":this._x=d*u*h-l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h+d*f*p;break;case"YZX":this._x=d*u*h+l*f*p,this._y=l*f*h+d*u*p,this._z=l*u*p-d*f*h,this._w=l*u*h-d*f*p;break;case"XZY":this._x=d*u*h-l*f*p,this._y=l*f*h-d*u*p,this._z=l*u*p+d*f*h,this._w=l*u*h+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const i=n/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,i=n[0],r=n[4],s=n[8],a=n[1],o=n[5],c=n[9],l=n[2],u=n[6],h=n[10],d=i+o+h;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(u-c)*f,this._y=(s-l)*f,this._z=(a-r)*f}else if(i>o&&i>h){const f=2*Math.sqrt(1+i-o-h);this._w=(u-c)/f,this._x=.25*f,this._y=(r+a)/f,this._z=(s+l)/f}else if(o>h){const f=2*Math.sqrt(1+o-i-h);this._w=(s-l)/f,this._x=(r+a)/f,this._y=.25*f,this._z=(c+u)/f}else{const f=2*Math.sqrt(1+h-i-o);this._w=(a-r)/f,this._x=(s+l)/f,this._y=(c+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let i=e.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Xi(this.dot(e),-1,1)))}rotateTowards(e,n){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,n/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const i=e._x,r=e._y,s=e._z,a=e._w,o=n._x,c=n._y,l=n._z,u=n._w;return this._x=i*u+a*o+r*l-s*c,this._y=r*u+a*c+s*o-i*l,this._z=s*u+a*l+i*c-r*o,this._w=a*u-i*o-r*c-s*l,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+r*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=r,this._z=s,this;const c=1-o*o;if(c<=Number.EPSILON){const f=1-n;return this._w=f*a+n*this._w,this._x=f*i+n*this._x,this._y=f*r+n*this._y,this._z=f*s+n*this._z,this.normalize(),this}const l=Math.sqrt(c),u=Math.atan2(l,o),h=Math.sin((1-n)*u)/l,d=Math.sin(n*u)/l;return this._w=a*h+this._w*d,this._x=i*h+this._x*d,this._y=r*h+this._y*d,this._z=s*h+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,n,i){return this.copy(e).slerp(n,i)}random(){const e=2*Math.PI*Math.random(),n=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(n),s*Math.cos(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Re{constructor(e=0,n=0,i=0){Re.prototype.isVector3=!0,this.x=e,this.y=n,this.z=i}set(e,n,i){return i===void 0&&(i=this.z),this.x=e,this.y=n,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(fX.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(fX.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[3]*i+s[6]*r,this.y=s[1]*n+s[4]*i+s[7]*r,this.z=s[2]*n+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,i=this.y,r=this.z,s=e.elements,a=1/(s[3]*n+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*r+s[12])*a,this.y=(s[1]*n+s[5]*i+s[9]*r+s[13])*a,this.z=(s[2]*n+s[6]*i+s[10]*r+s[14])*a,this}applyQuaternion(e){const n=this.x,i=this.y,r=this.z,s=e.x,a=e.y,o=e.z,c=e.w,l=2*(a*r-o*i),u=2*(o*n-s*r),h=2*(s*i-a*n);return this.x=n+c*l+a*h-o*u,this.y=i+c*u+o*l-s*h,this.z=r+c*h+s*u-a*l,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*n+s[4]*i+s[8]*r,this.y=s[1]*n+s[5]*i+s[9]*r,this.z=s[2]*n+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Xi(this.x,e.x,n.x),this.y=Xi(this.y,e.y,n.y),this.z=Xi(this.z,e.z,n.z),this}clampScalar(e,n){return this.x=Xi(this.x,e,n),this.y=Xi(this.y,e,n),this.z=Xi(this.z,e,n),this}clampLength(e,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Xi(i,e,n))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,i){return this.x=e.x+(n.x-e.x)*i,this.y=e.y+(n.y-e.y)*i,this.z=e.z+(n.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const i=e.x,r=e.y,s=e.z,a=n.x,o=n.y,c=n.z;return this.x=r*c-s*o,this.y=s*a-i*c,this.z=i*o-r*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const i=e.dot(this)/n;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return hz.copy(this).projectOnVector(e),this.sub(hz)}reflect(e){return this.sub(hz.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(e)/n;return Math.acos(Xi(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return n*n+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,i){const r=Math.sin(n)*e;return this.x=r*Math.sin(i),this.y=Math.cos(n)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,i){return this.x=e*Math.sin(n),this.y=i,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=i,this.z=r,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,n=Math.random()*2-1,i=Math.sqrt(1-n*n);return this.x=i*Math.cos(e),this.y=n,this.z=i*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const hz=new Re,fX=new jh;class cu{constructor(e=new Re(1/0,1/0,1/0),n=new Re(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n+=3)this.expandByPoint(kp.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,i=e.count;n<i;n++)this.expandByPoint(kp.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=kp.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,kp):kp.fromBufferAttribute(s,a),kp.applyMatrix4(e.matrixWorld),this.expandByPoint(kp);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),LI.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),LI.copy(i.boundingBox)),LI.applyMatrix4(e.matrixWorld),this.union(LI)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],n);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,kp),kp.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,i;return e.normal.x>0?(n=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),n<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(CR),UI.subVectors(this.max,CR),Dx.subVectors(e.a,CR),Px.subVectors(e.b,CR),Lx.subVectors(e.c,CR),e_.subVectors(Px,Dx),t_.subVectors(Lx,Px),VE.subVectors(Dx,Lx);let n=[0,-e_.z,e_.y,0,-t_.z,t_.y,0,-VE.z,VE.y,e_.z,0,-e_.x,t_.z,0,-t_.x,VE.z,0,-VE.x,-e_.y,e_.x,0,-t_.y,t_.x,0,-VE.y,VE.x,0];return!dz(n,Dx,Px,Lx,UI)||(n=[1,0,0,0,1,0,0,0,1],!dz(n,Dx,Px,Lx,UI))?!1:(BI.crossVectors(e_,t_),n=[BI.x,BI.y,BI.z],dz(n,Dx,Px,Lx,UI))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,kp).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(kp).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(nv[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),nv[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),nv[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),nv[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),nv[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),nv[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),nv[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),nv[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(nv),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const nv=[new Re,new Re,new Re,new Re,new Re,new Re,new Re,new Re],kp=new Re,LI=new cu,Dx=new Re,Px=new Re,Lx=new Re,e_=new Re,t_=new Re,VE=new Re,CR=new Re,UI=new Re,BI=new Re,GE=new Re;function dz(t,e,n,i,r){for(let s=0,a=t.length-3;s<=a;s+=3){GE.fromArray(t,s);const o=r.x*Math.abs(GE.x)+r.y*Math.abs(GE.y)+r.z*Math.abs(GE.z),c=e.dot(GE),l=n.dot(GE),u=i.dot(GE);if(Math.max(-Math.max(c,l,u),Math.min(c,l,u))>o)return!1}return!0}const oTe=new cu,RR=new Re,fz=new Re;class Dl{constructor(e=new Re,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const i=this.center;n!==void 0?i.copy(n):oTe.setFromPoints(e).getCenter(i);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const i=this.center.distanceToSquared(e);return n.copy(e),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;RR.subVectors(e,this.center);const n=RR.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),r=(i-this.radius)*.5;this.center.addScaledVector(RR,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(fz.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(RR.copy(e.center).add(fz)),this.expandByPoint(RR.copy(e.center).sub(fz))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const iv=new Re,pz=new Re,FI=new Re,n_=new Re,mz=new Re,zI=new Re,gz=new Re;class kC{constructor(e=new Re,n=new Re(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,iv)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=iv.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(iv.copy(this.origin).addScaledVector(this.direction,n),iv.distanceToSquared(e))}distanceSqToSegment(e,n,i,r){pz.copy(e).add(n).multiplyScalar(.5),FI.copy(n).sub(e).normalize(),n_.copy(this.origin).sub(pz);const s=e.distanceTo(n)*.5,a=-this.direction.dot(FI),o=n_.dot(this.direction),c=-n_.dot(FI),l=n_.lengthSq(),u=Math.abs(1-a*a);let h,d,f,p;if(u>0)if(h=a*c-o,d=a*o-c,p=s*u,h>=0)if(d>=-p)if(d<=p){const g=1/u;h*=g,d*=g,f=h*(h+a*d+2*o)+d*(a*h+d+2*c)+l}else d=s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;else d=-s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;else d<=-p?(h=Math.max(0,-(-a*s+o)),d=h>0?-s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l):d<=p?(h=0,d=Math.min(Math.max(-s,-c),s),f=d*(d+2*c)+l):(h=Math.max(0,-(a*s+o)),d=h>0?s:Math.min(Math.max(-s,-c),s),f=-h*h+d*(d+2*c)+l);else d=a>0?-s:s,h=Math.max(0,-(a*d+o)),f=-h*h+d*(d+2*c)+l;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(pz).addScaledVector(FI,d),f}intersectSphere(e,n){iv.subVectors(e.center,this.origin);const i=iv.dot(this.direction),r=iv.dot(iv)-i*i,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),o=i-a,c=i+a;return c<0?null:o<0?this.at(c,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/n;return i>=0?i:null}intersectPlane(e,n){const i=this.distanceToPlane(e);return i===null?null:this.at(i,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let i,r,s,a,o,c;const l=1/this.direction.x,u=1/this.direction.y,h=1/this.direction.z,d=this.origin;return l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(s=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),i>a||s>r||((s>i||isNaN(i))&&(i=s),(a<r||isNaN(r))&&(r=a),h>=0?(o=(e.min.z-d.z)*h,c=(e.max.z-d.z)*h):(o=(e.max.z-d.z)*h,c=(e.min.z-d.z)*h),i>c||o>r)||((o>i||i!==i)&&(i=o),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,n)}intersectsBox(e){return this.intersectBox(e,iv)!==null}intersectTriangle(e,n,i,r,s){mz.subVectors(n,e),zI.subVectors(i,e),gz.crossVectors(mz,zI);let a=this.direction.dot(gz),o;if(a>0){if(r)return null;o=1}else if(a<0)o=-1,a=-a;else return null;n_.subVectors(this.origin,e);const c=o*this.direction.dot(zI.crossVectors(n_,zI));if(c<0)return null;const l=o*this.direction.dot(mz.cross(n_));if(l<0||c+l>a)return null;const u=-o*n_.dot(gz);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Ni{constructor(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_){Ni.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_)}set(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_){const v=this.elements;return v[0]=e,v[4]=n,v[8]=i,v[12]=r,v[1]=s,v[5]=a,v[9]=o,v[13]=c,v[2]=l,v[6]=u,v[10]=h,v[14]=d,v[3]=f,v[7]=p,v[11]=g,v[15]=_,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Ni().fromArray(this.elements)}copy(e){const n=this.elements,i=e.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(e){const n=this.elements,i=e.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,i){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,n,i){return this.set(e.x,n.x,i.x,0,e.y,n.y,i.y,0,e.z,n.z,i.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,i=e.elements,r=1/Ux.setFromMatrixColumn(e,0).length(),s=1/Ux.setFromMatrixColumn(e,1).length(),a=1/Ux.setFromMatrixColumn(e,2).length();return n[0]=i[0]*r,n[1]=i[1]*r,n[2]=i[2]*r,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*a,n[9]=i[9]*a,n[10]=i[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,i=e.x,r=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),c=Math.cos(r),l=Math.sin(r),u=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const d=a*u,f=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=-c*h,n[8]=l,n[1]=f+p*l,n[5]=d-g*l,n[9]=-o*c,n[2]=g-d*l,n[6]=p+f*l,n[10]=a*c}else if(e.order==="YXZ"){const d=c*u,f=c*h,p=l*u,g=l*h;n[0]=d+g*o,n[4]=p*o-f,n[8]=a*l,n[1]=a*h,n[5]=a*u,n[9]=-o,n[2]=f*o-p,n[6]=g+d*o,n[10]=a*c}else if(e.order==="ZXY"){const d=c*u,f=c*h,p=l*u,g=l*h;n[0]=d-g*o,n[4]=-a*h,n[8]=p+f*o,n[1]=f+p*o,n[5]=a*u,n[9]=g-d*o,n[2]=-a*l,n[6]=o,n[10]=a*c}else if(e.order==="ZYX"){const d=a*u,f=a*h,p=o*u,g=o*h;n[0]=c*u,n[4]=p*l-f,n[8]=d*l+g,n[1]=c*h,n[5]=g*l+d,n[9]=f*l-p,n[2]=-l,n[6]=o*c,n[10]=a*c}else if(e.order==="YZX"){const d=a*c,f=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=g-d*h,n[8]=p*h+f,n[1]=h,n[5]=a*u,n[9]=-o*u,n[2]=-l*u,n[6]=f*h+p,n[10]=d-g*h}else if(e.order==="XZY"){const d=a*c,f=a*l,p=o*c,g=o*l;n[0]=c*u,n[4]=-h,n[8]=l*u,n[1]=d*h+g,n[5]=a*u,n[9]=f*h-p,n[2]=p*h-f,n[6]=o*u,n[10]=g*h+d}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(cTe,e,lTe)}lookAt(e,n,i){const r=this.elements;return Sd.subVectors(e,n),Sd.lengthSq()===0&&(Sd.z=1),Sd.normalize(),i_.crossVectors(i,Sd),i_.lengthSq()===0&&(Math.abs(i.z)===1?Sd.x+=1e-4:Sd.z+=1e-4,Sd.normalize(),i_.crossVectors(i,Sd)),i_.normalize(),HI.crossVectors(Sd,i_),r[0]=i_.x,r[4]=HI.x,r[8]=Sd.x,r[1]=i_.y,r[5]=HI.y,r[9]=Sd.y,r[2]=i_.z,r[6]=HI.z,r[10]=Sd.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const i=e.elements,r=n.elements,s=this.elements,a=i[0],o=i[4],c=i[8],l=i[12],u=i[1],h=i[5],d=i[9],f=i[13],p=i[2],g=i[6],_=i[10],v=i[14],E=i[3],T=i[7],x=i[11],N=i[15],A=r[0],I=r[4],k=r[8],L=r[12],U=r[1],$=r[5],q=r[9],G=r[13],X=r[2],ie=r[6],V=r[10],Z=r[14],Y=r[3],ee=r[7],oe=r[11],de=r[15];return s[0]=a*A+o*U+c*X+l*Y,s[4]=a*I+o*$+c*ie+l*ee,s[8]=a*k+o*q+c*V+l*oe,s[12]=a*L+o*G+c*Z+l*de,s[1]=u*A+h*U+d*X+f*Y,s[5]=u*I+h*$+d*ie+f*ee,s[9]=u*k+h*q+d*V+f*oe,s[13]=u*L+h*G+d*Z+f*de,s[2]=p*A+g*U+_*X+v*Y,s[6]=p*I+g*$+_*ie+v*ee,s[10]=p*k+g*q+_*V+v*oe,s[14]=p*L+g*G+_*Z+v*de,s[3]=E*A+T*U+x*X+N*Y,s[7]=E*I+T*$+x*ie+N*ee,s[11]=E*k+T*q+x*V+N*oe,s[15]=E*L+T*G+x*Z+N*de,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],i=e[4],r=e[8],s=e[12],a=e[1],o=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14],p=e[3],g=e[7],_=e[11],v=e[15];return p*(+s*c*h-r*l*h-s*o*d+i*l*d+r*o*f-i*c*f)+g*(+n*c*f-n*l*d+s*a*d-r*a*f+r*l*u-s*c*u)+_*(+n*l*h-n*o*f-s*a*h+i*a*f+s*o*u-i*l*u)+v*(-r*o*u-n*c*h+n*o*d+r*a*h-i*a*d+i*c*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=n,r[14]=i),this}invert(){const e=this.elements,n=e[0],i=e[1],r=e[2],s=e[3],a=e[4],o=e[5],c=e[6],l=e[7],u=e[8],h=e[9],d=e[10],f=e[11],p=e[12],g=e[13],_=e[14],v=e[15],E=h*_*l-g*d*l+g*c*f-o*_*f-h*c*v+o*d*v,T=p*d*l-u*_*l-p*c*f+a*_*f+u*c*v-a*d*v,x=u*g*l-p*h*l+p*o*f-a*g*f-u*o*v+a*h*v,N=p*h*c-u*g*c-p*o*d+a*g*d+u*o*_-a*h*_,A=n*E+i*T+r*x+s*N;if(A===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/A;return e[0]=E*I,e[1]=(g*d*s-h*_*s-g*r*f+i*_*f+h*r*v-i*d*v)*I,e[2]=(o*_*s-g*c*s+g*r*l-i*_*l-o*r*v+i*c*v)*I,e[3]=(h*c*s-o*d*s-h*r*l+i*d*l+o*r*f-i*c*f)*I,e[4]=T*I,e[5]=(u*_*s-p*d*s+p*r*f-n*_*f-u*r*v+n*d*v)*I,e[6]=(p*c*s-a*_*s-p*r*l+n*_*l+a*r*v-n*c*v)*I,e[7]=(a*d*s-u*c*s+u*r*l-n*d*l-a*r*f+n*c*f)*I,e[8]=x*I,e[9]=(p*h*s-u*g*s-p*i*f+n*g*f+u*i*v-n*h*v)*I,e[10]=(a*g*s-p*o*s+p*i*l-n*g*l-a*i*v+n*o*v)*I,e[11]=(u*o*s-a*h*s-u*i*l+n*h*l+a*i*f-n*o*f)*I,e[12]=N*I,e[13]=(u*g*r-p*h*r+p*i*d-n*g*d-u*i*_+n*h*_)*I,e[14]=(p*o*r-a*g*r-p*i*c+n*g*c+a*i*_-n*o*_)*I,e[15]=(a*h*r-u*o*r+u*i*c-n*h*c-a*i*d+n*o*d)*I,this}scale(e){const n=this.elements,i=e.x,r=e.y,s=e.z;return n[0]*=i,n[4]*=r,n[8]*=s,n[1]*=i,n[5]*=r,n[9]*=s,n[2]*=i,n[6]*=r,n[10]*=s,n[3]*=i,n[7]*=r,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,i,r))}makeTranslation(e,n,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),i=Math.sin(e);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const i=Math.cos(n),r=Math.sin(n),s=1-i,a=e.x,o=e.y,c=e.z,l=s*a,u=s*o;return this.set(l*a+i,l*o-r*c,l*c+r*o,0,l*o+r*c,u*o+i,u*c-r*a,0,l*c-r*o,u*c+r*a,s*c*c+i,0,0,0,0,1),this}makeScale(e,n,i){return this.set(e,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,n,i,r,s,a){return this.set(1,i,s,0,e,1,a,0,n,r,1,0,0,0,0,1),this}compose(e,n,i){const r=this.elements,s=n._x,a=n._y,o=n._z,c=n._w,l=s+s,u=a+a,h=o+o,d=s*l,f=s*u,p=s*h,g=a*u,_=a*h,v=o*h,E=c*l,T=c*u,x=c*h,N=i.x,A=i.y,I=i.z;return r[0]=(1-(g+v))*N,r[1]=(f+x)*N,r[2]=(p-T)*N,r[3]=0,r[4]=(f-x)*A,r[5]=(1-(d+v))*A,r[6]=(_+E)*A,r[7]=0,r[8]=(p+T)*I,r[9]=(_-E)*I,r[10]=(1-(d+g))*I,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,n,i){const r=this.elements;let s=Ux.set(r[0],r[1],r[2]).length();const a=Ux.set(r[4],r[5],r[6]).length(),o=Ux.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Dp.copy(this);const l=1/s,u=1/a,h=1/o;return Dp.elements[0]*=l,Dp.elements[1]*=l,Dp.elements[2]*=l,Dp.elements[4]*=u,Dp.elements[5]*=u,Dp.elements[6]*=u,Dp.elements[8]*=h,Dp.elements[9]*=h,Dp.elements[10]*=h,n.setFromRotationMatrix(Dp),i.x=s,i.y=a,i.z=o,this}makePerspective(e,n,i,r,s,a,o=jf){const c=this.elements,l=2*s/(n-e),u=2*s/(i-r),h=(n+e)/(n-e),d=(i+r)/(i-r);let f,p;if(o===jf)f=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===TM)f=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=l,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=u,c[9]=d,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=p,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,n,i,r,s,a,o=jf){const c=this.elements,l=1/(n-e),u=1/(i-r),h=1/(a-s),d=(n+e)*l,f=(i+r)*u;let p,g;if(o===jf)p=(a+s)*h,g=-2*h;else if(o===TM)p=s*h,g=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=2*l,c[4]=0,c[8]=0,c[12]=-d,c[1]=0,c[5]=2*u,c[9]=0,c[13]=-f,c[2]=0,c[6]=0,c[10]=g,c[14]=-p,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const n=this.elements,i=e.elements;for(let r=0;r<16;r++)if(n[r]!==i[r])return!1;return!0}fromArray(e,n=0){for(let i=0;i<16;i++)this.elements[i]=e[i+n];return this}toArray(e=[],n=0){const i=this.elements;return e[n]=i[0],e[n+1]=i[1],e[n+2]=i[2],e[n+3]=i[3],e[n+4]=i[4],e[n+5]=i[5],e[n+6]=i[6],e[n+7]=i[7],e[n+8]=i[8],e[n+9]=i[9],e[n+10]=i[10],e[n+11]=i[11],e[n+12]=i[12],e[n+13]=i[13],e[n+14]=i[14],e[n+15]=i[15],e}}const Ux=new Re,Dp=new Ni,cTe=new Re(0,0,0),lTe=new Re(1,1,1),i_=new Re,HI=new Re,Sd=new Re,pX=new Ni,mX=new jh;class $h{constructor(e=0,n=0,i=0,r=$h.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,i,r=this._order){return this._x=e,this._y=n,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,i=!0){const r=e.elements,s=r[0],a=r[4],o=r[8],c=r[1],l=r[5],u=r[9],h=r[2],d=r[6],f=r[10];switch(n){case"XYZ":this._y=Math.asin(Xi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-Xi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(c,l)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(Xi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-h,f),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-Xi(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(d,f),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(Xi(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-Xi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,i){return pX.makeRotationFromQuaternion(e),this.setFromRotationMatrix(pX,n,i)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return mX.setFromEuler(this),this.setFromQuaternion(mX,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}$h.DEFAULT_ORDER="XYZ";class Lw{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let uTe=0;const gX=new Re,Bx=new jh,rv=new Ni,jI=new Re,AR=new Re,hTe=new Re,dTe=new jh,vX=new Re(1,0,0),yX=new Re(0,1,0),_X=new Re(0,0,1),bX={type:"added"},fTe={type:"removed"},Fx={type:"childadded",child:null},vz={type:"childremoved",child:null};class Gr extends Yd{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:uTe++}),this.uuid=zd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gr.DEFAULT_UP.clone();const e=new Re,n=new $h,i=new jh,r=new Re(1,1,1);function s(){i.setFromEuler(n,!1)}function a(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Ni},normalMatrix:{value:new Zi}}),this.matrix=new Ni,this.matrixWorld=new Ni,this.matrixAutoUpdate=Gr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Gr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Lw,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Bx.setFromAxisAngle(e,n),this.quaternion.multiply(Bx),this}rotateOnWorldAxis(e,n){return Bx.setFromAxisAngle(e,n),this.quaternion.premultiply(Bx),this}rotateX(e){return this.rotateOnAxis(vX,e)}rotateY(e){return this.rotateOnAxis(yX,e)}rotateZ(e){return this.rotateOnAxis(_X,e)}translateOnAxis(e,n){return gX.copy(e).applyQuaternion(this.quaternion),this.position.add(gX.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(vX,e)}translateY(e){return this.translateOnAxis(yX,e)}translateZ(e){return this.translateOnAxis(_X,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(rv.copy(this.matrixWorld).invert())}lookAt(e,n,i){e.isVector3?jI.copy(e):jI.set(e,n,i);const r=this.parent;this.updateWorldMatrix(!0,!1),AR.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?rv.lookAt(AR,jI,this.up):rv.lookAt(jI,AR,this.up),this.quaternion.setFromRotationMatrix(rv),r&&(rv.extractRotation(r.matrixWorld),Bx.setFromRotationMatrix(rv),this.quaternion.premultiply(Bx.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(bX),Fx.child=e,this.dispatchEvent(Fx),Fx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(fTe),vz.child=e,this.dispatchEvent(vz),vz.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),rv.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),rv.multiply(e.parent.matrixWorld)),e.applyMatrix4(rv),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(bX),Fx.child=e,this.dispatchEvent(Fx),Fx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let i=0,r=this.children.length;i<r;i++){const a=this.children[i].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,i=[]){this[e]===n&&i.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,n,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(AR,e,hTe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(AR,dTe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let i=0,r=n.length;i<r;i++)n[i].updateMatrixWorld(e)}updateWorldMatrix(e,n){const i=this.parent;if(e===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),n===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const n=e===void 0||typeof e=="string",i={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),r.instanceInfo=this._instanceInfo.map(o=>({...o})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,c){return o[c.uuid]===void 0&&(o[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const c=o.shapes;if(Array.isArray(c))for(let l=0,u=c.length;l<u;l++){const h=c[l];s(e.shapes,h)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let c=0,l=this.material.length;c<l;c++)o.push(s(e.materials,this.material[c]));r.material=o}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let o=0;o<this.children.length;o++)r.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let o=0;o<this.animations.length;o++){const c=this.animations[o];r.animations.push(s(e.animations,c))}}if(n){const o=a(e.geometries),c=a(e.materials),l=a(e.textures),u=a(e.images),h=a(e.shapes),d=a(e.skeletons),f=a(e.animations),p=a(e.nodes);o.length>0&&(i.geometries=o),c.length>0&&(i.materials=c),l.length>0&&(i.textures=l),u.length>0&&(i.images=u),h.length>0&&(i.shapes=h),d.length>0&&(i.skeletons=d),f.length>0&&(i.animations=f),p.length>0&&(i.nodes=p)}return i.object=r,i;function a(o){const c=[];for(const l in o){const u=o[l];delete u.metadata,c.push(u)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Gr.DEFAULT_UP=new Re(0,1,0);Gr.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Pp=new Re,sv=new Re,yz=new Re,av=new Re,zx=new Re,Hx=new Re,EX=new Re,_z=new Re,bz=new Re,Ez=new Re,Sz=new Kr,Tz=new Kr,xz=new Kr;class Dh{constructor(e=new Re,n=new Re,i=new Re){this.a=e,this.b=n,this.c=i}static getNormal(e,n,i,r){r.subVectors(i,n),Pp.subVectors(e,n),r.cross(Pp);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,n,i,r,s){Pp.subVectors(r,n),sv.subVectors(i,n),yz.subVectors(e,n);const a=Pp.dot(Pp),o=Pp.dot(sv),c=Pp.dot(yz),l=sv.dot(sv),u=sv.dot(yz),h=a*l-o*o;if(h===0)return s.set(0,0,0),null;const d=1/h,f=(l*c-o*u)*d,p=(a*u-o*c)*d;return s.set(1-f-p,p,f)}static containsPoint(e,n,i,r){return this.getBarycoord(e,n,i,r,av)===null?!1:av.x>=0&&av.y>=0&&av.x+av.y<=1}static getInterpolation(e,n,i,r,s,a,o,c){return this.getBarycoord(e,n,i,r,av)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,av.x),c.addScaledVector(a,av.y),c.addScaledVector(o,av.z),c)}static getInterpolatedAttribute(e,n,i,r,s,a){return Sz.setScalar(0),Tz.setScalar(0),xz.setScalar(0),Sz.fromBufferAttribute(e,n),Tz.fromBufferAttribute(e,i),xz.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(Sz,s.x),a.addScaledVector(Tz,s.y),a.addScaledVector(xz,s.z),a}static isFrontFacing(e,n,i,r){return Pp.subVectors(i,n),sv.subVectors(e,n),Pp.cross(sv).dot(r)<0}set(e,n,i){return this.a.copy(e),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(e,n,i,r){return this.a.copy(e[n]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,n,i,r){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Pp.subVectors(this.c,this.b),sv.subVectors(this.a,this.b),Pp.cross(sv).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Dh.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return Dh.getBarycoord(e,this.a,this.b,this.c,n)}getInterpolation(e,n,i,r,s){return Dh.getInterpolation(e,this.a,this.b,this.c,n,i,r,s)}containsPoint(e){return Dh.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Dh.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const i=this.a,r=this.b,s=this.c;let a,o;zx.subVectors(r,i),Hx.subVectors(s,i),_z.subVectors(e,i);const c=zx.dot(_z),l=Hx.dot(_z);if(c<=0&&l<=0)return n.copy(i);bz.subVectors(e,r);const u=zx.dot(bz),h=Hx.dot(bz);if(u>=0&&h<=u)return n.copy(r);const d=c*h-u*l;if(d<=0&&c>=0&&u<=0)return a=c/(c-u),n.copy(i).addScaledVector(zx,a);Ez.subVectors(e,s);const f=zx.dot(Ez),p=Hx.dot(Ez);if(p>=0&&f<=p)return n.copy(s);const g=f*l-c*p;if(g<=0&&l>=0&&p<=0)return o=l/(l-p),n.copy(i).addScaledVector(Hx,o);const _=u*p-f*h;if(_<=0&&h-u>=0&&f-p>=0)return EX.subVectors(s,r),o=(h-u)/(h-u+(f-p)),n.copy(r).addScaledVector(EX,o);const v=1/(_+g+d);return a=g*v,o=d*v,n.copy(i).addScaledVector(zx,a).addScaledVector(Hx,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Hse={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},r_={h:0,s:0,l:0},VI={h:0,s:0,l:0};function wz(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class _n{constructor(e,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,i)}set(e,n,i){if(n===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,n,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=ya){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Lr.toWorkingColorSpace(this,n),this}setRGB(e,n,i,r=Lr.workingColorSpace){return this.r=e,this.g=n,this.b=i,Lr.toWorkingColorSpace(this,r),this}setHSL(e,n,i,r=Lr.workingColorSpace){if(e=_q(e,1),n=Xi(n,0,1),i=Xi(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,a=2*i-s;this.r=wz(a,s,e+1/3),this.g=wz(a,s,e),this.b=wz(a,s,e-1/3)}return Lr.toWorkingColorSpace(this,r),this}setStyle(e,n=ya){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=ya){const i=Hse[e.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=zv(e.r),this.g=zv(e.g),this.b=zv(e.b),this}copyLinearToSRGB(e){return this.r=rw(e.r),this.g=rw(e.g),this.b=rw(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ya){return Lr.fromWorkingColorSpace(Kl.copy(this),e),Math.round(Xi(Kl.r*255,0,255))*65536+Math.round(Xi(Kl.g*255,0,255))*256+Math.round(Xi(Kl.b*255,0,255))}getHexString(e=ya){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=Lr.workingColorSpace){Lr.fromWorkingColorSpace(Kl.copy(this),n);const i=Kl.r,r=Kl.g,s=Kl.b,a=Math.max(i,r,s),o=Math.min(i,r,s);let c,l;const u=(o+a)/2;if(o===a)c=0,l=0;else{const h=a-o;switch(l=u<=.5?h/(a+o):h/(2-a-o),a){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4;break}c/=6}return e.h=c,e.s=l,e.l=u,e}getRGB(e,n=Lr.workingColorSpace){return Lr.fromWorkingColorSpace(Kl.copy(this),n),e.r=Kl.r,e.g=Kl.g,e.b=Kl.b,e}getStyle(e=ya){Lr.fromWorkingColorSpace(Kl.copy(this),e);const n=Kl.r,i=Kl.g,r=Kl.b;return e!==ya?`color(${e} ${n.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,n,i){return this.getHSL(r_),this.setHSL(r_.h+e,r_.s+n,r_.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,i){return this.r=e.r+(n.r-e.r)*i,this.g=e.g+(n.g-e.g)*i,this.b=e.b+(n.b-e.b)*i,this}lerpHSL(e,n){this.getHSL(r_),e.getHSL(VI);const i=kA(r_.h,VI.h,n),r=kA(r_.s,VI.s,n),s=kA(r_.l,VI.l,n);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*n+s[3]*i+s[6]*r,this.g=s[1]*n+s[4]*i+s[7]*r,this.b=s[2]*n+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Kl=new _n;_n.NAMES=Hse;let pTe=0;class yl extends Yd{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:pTe++}),this.uuid=zd(),this.name="",this.type="Material",this.blending=US,this.side=Dg,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=$P,this.blendDst=WP,this.blendEquation=L_,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new _n(0,0,0),this.blendAlpha=0,this.depthFunc=eT,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Nj,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=fS,this.stencilZFail=fS,this.stencilZPass=fS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const i=e[n];if(i===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const r=this[n];if(r===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[n]=i}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==US&&(i.blending=this.blending),this.side!==Dg&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==$P&&(i.blendSrc=this.blendSrc),this.blendDst!==WP&&(i.blendDst=this.blendDst),this.blendEquation!==L_&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==eT&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Nj&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==fS&&(i.stencilFail=this.stencilFail),this.stencilZFail!==fS&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==fS&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const a=[];for(const o in s){const c=s[o];delete c.metadata,a.push(c)}return a}if(n){const s=r(e.textures),a=r(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let i=null;if(n!==null){const r=n.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Fb extends yl{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new _n(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $h,this.combine=WO,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const xv=mTe();function mTe(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const l=c-127;l<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):l<-14?(i[c]=1024>>-l-14,i[c|256]=1024>>-l-14|32768,r[c]=-l-1,r[c|256]=-l-1):l<=15?(i[c]=l+15<<10,i[c|256]=l+15<<10|32768,r[c]=13,r[c|256]=13):l<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let c=1;c<1024;++c){let l=c<<13,u=0;for(;!(l&8388608);)l<<=1,u-=8388608;l&=-8388609,u+=947912704,s[c]=l|u}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)a[c]=c<<23;a[31]=1199570944,a[32]=2147483648;for(let c=33;c<63;++c)a[c]=2147483648+(c-32<<23);a[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(o[c]=1024);return{floatView:e,uint32View:n,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:o}}function Ch(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Xi(t,-65504,65504),xv.floatView[0]=t;const e=xv.uint32View[0],n=e>>23&511;return xv.baseTable[n]+((e&8388607)>>xv.shiftTable[n])}function uA(t){const e=t>>10;return xv.uint32View[0]=xv.mantissaTable[xv.offsetTable[e]+(t&1023)]+xv.exponentTable[e],xv.floatView[0]}class gTe{static toHalfFloat(e){return Ch(e)}static fromHalfFloat(e){return uA(e)}}const ec=new Re,GI=new Rt;let vTe=0;class rr{constructor(e,n,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:vTe++}),this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=i,this.usage=SM,this.updateRanges=[],this.gpuType=iu,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,i){e*=this.itemSize,i*=n.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=n.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)GI.fromBufferAttribute(this,n),GI.applyMatrix3(e),this.setXY(n,GI.x,GI.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)ec.fromBufferAttribute(this,n),ec.applyMatrix3(e),this.setXYZ(n,ec.x,ec.y,ec.z);return this}applyMatrix4(e){for(let n=0,i=this.count;n<i;n++)ec.fromBufferAttribute(this,n),ec.applyMatrix4(e),this.setXYZ(n,ec.x,ec.y,ec.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)ec.fromBufferAttribute(this,n),ec.applyNormalMatrix(e),this.setXYZ(n,ec.x,ec.y,ec.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)ec.fromBufferAttribute(this,n),ec.transformDirection(e),this.setXYZ(n,ec.x,ec.y,ec.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let i=this.array[e*this.itemSize+n];return this.normalized&&(i=Yu(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=tr(i,this.array)),this.array[e*this.itemSize+n]=i,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=Yu(n,this.array)),n}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=Yu(n,this.array)),n}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=Yu(n,this.array)),n}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=Yu(n,this.array)),n}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.array[e+0]=n,this.array[e+1]=i,this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.array[e+0]=n,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==SM&&(e.usage=this.usage),e}}class yTe extends rr{constructor(e,n,i){super(new Int8Array(e),n,i)}}class _Te extends rr{constructor(e,n,i){super(new Uint8Array(e),n,i)}}class bTe extends rr{constructor(e,n,i){super(new Uint8ClampedArray(e),n,i)}}class ETe extends rr{constructor(e,n,i){super(new Int16Array(e),n,i)}}class bq extends rr{constructor(e,n,i){super(new Uint16Array(e),n,i)}}class STe extends rr{constructor(e,n,i){super(new Int32Array(e),n,i)}}class Eq extends rr{constructor(e,n,i){super(new Uint32Array(e),n,i)}}class TTe extends rr{constructor(e,n,i){super(new Uint16Array(e),n,i),this.isFloat16BufferAttribute=!0}getX(e){let n=uA(this.array[e*this.itemSize]);return this.normalized&&(n=Yu(n,this.array)),n}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize]=Ch(n),this}getY(e){let n=uA(this.array[e*this.itemSize+1]);return this.normalized&&(n=Yu(n,this.array)),n}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+1]=Ch(n),this}getZ(e){let n=uA(this.array[e*this.itemSize+2]);return this.normalized&&(n=Yu(n,this.array)),n}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+2]=Ch(n),this}getW(e){let n=uA(this.array[e*this.itemSize+3]);return this.normalized&&(n=Yu(n,this.array)),n}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.array[e*this.itemSize+3]=Ch(n),this}setXY(e,n,i){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.array[e+0]=Ch(n),this.array[e+1]=Ch(i),this}setXYZ(e,n,i,r){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.array[e+0]=Ch(n),this.array[e+1]=Ch(i),this.array[e+2]=Ch(r),this}setXYZW(e,n,i,r,s){return e*=this.itemSize,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.array[e+0]=Ch(n),this.array[e+1]=Ch(i),this.array[e+2]=Ch(r),this.array[e+3]=Ch(s),this}}class Hn extends rr{constructor(e,n,i){super(new Float32Array(e),n,i)}}let xTe=0;const bf=new Ni,Cz=new Gr,jx=new Re,Td=new cu,MR=new cu,el=new Re;class Qi extends Yd{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:xTe++}),this.uuid=zd(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Bse(e)?Eq:bq)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,i=0){this.groups.push({start:e,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Zi().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return bf.makeRotationFromQuaternion(e),this.applyMatrix4(bf),this}rotateX(e){return bf.makeRotationX(e),this.applyMatrix4(bf),this}rotateY(e){return bf.makeRotationY(e),this.applyMatrix4(bf),this}rotateZ(e){return bf.makeRotationZ(e),this.applyMatrix4(bf),this}translate(e,n,i){return bf.makeTranslation(e,n,i),this.applyMatrix4(bf),this}scale(e,n,i){return bf.makeScale(e,n,i),this.applyMatrix4(bf),this}lookAt(e){return Cz.lookAt(e),Cz.updateMatrix(),this.applyMatrix4(Cz.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(jx).negate(),this.translate(jx.x,jx.y,jx.z),this}setFromPoints(e){const n=this.getAttribute("position");if(n===void 0){const i=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Hn(i,3))}else{const i=Math.min(e.length,n.count);for(let r=0;r<i;r++){const s=e[r];n.setXYZ(r,s.x,s.y,s.z||0)}e.length>n.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),n.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new cu);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Re(-1/0,-1/0,-1/0),new Re(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let i=0,r=n.length;i<r;i++){const s=n[i];Td.setFromBufferAttribute(s),this.morphTargetsRelative?(el.addVectors(this.boundingBox.min,Td.min),this.boundingBox.expandByPoint(el),el.addVectors(this.boundingBox.max,Td.max),this.boundingBox.expandByPoint(el)):(this.boundingBox.expandByPoint(Td.min),this.boundingBox.expandByPoint(Td.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Dl);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Re,1/0);return}if(e){const i=this.boundingSphere.center;if(Td.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const o=n[s];MR.setFromBufferAttribute(o),this.morphTargetsRelative?(el.addVectors(Td.min,MR.min),Td.expandByPoint(el),el.addVectors(Td.max,MR.max),Td.expandByPoint(el)):(Td.expandByPoint(MR.min),Td.expandByPoint(MR.max))}Td.getCenter(i);let r=0;for(let s=0,a=e.count;s<a;s++)el.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(el));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],c=this.morphTargetsRelative;for(let l=0,u=o.count;l<u;l++)el.fromBufferAttribute(o,l),c&&(jx.fromBufferAttribute(e,l),el.add(jx)),r=Math.max(r,i.distanceToSquared(el))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=n.position,r=n.normal,s=n.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new rr(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),o=[],c=[];for(let k=0;k<i.count;k++)o[k]=new Re,c[k]=new Re;const l=new Re,u=new Re,h=new Re,d=new Rt,f=new Rt,p=new Rt,g=new Re,_=new Re;function v(k,L,U){l.fromBufferAttribute(i,k),u.fromBufferAttribute(i,L),h.fromBufferAttribute(i,U),d.fromBufferAttribute(s,k),f.fromBufferAttribute(s,L),p.fromBufferAttribute(s,U),u.sub(l),h.sub(l),f.sub(d),p.sub(d);const $=1/(f.x*p.y-p.x*f.y);isFinite($)&&(g.copy(u).multiplyScalar(p.y).addScaledVector(h,-f.y).multiplyScalar($),_.copy(h).multiplyScalar(f.x).addScaledVector(u,-p.x).multiplyScalar($),o[k].add(g),o[L].add(g),o[U].add(g),c[k].add(_),c[L].add(_),c[U].add(_))}let E=this.groups;E.length===0&&(E=[{start:0,count:e.count}]);for(let k=0,L=E.length;k<L;++k){const U=E[k],$=U.start,q=U.count;for(let G=$,X=$+q;G<X;G+=3)v(e.getX(G+0),e.getX(G+1),e.getX(G+2))}const T=new Re,x=new Re,N=new Re,A=new Re;function I(k){N.fromBufferAttribute(r,k),A.copy(N);const L=o[k];T.copy(L),T.sub(N.multiplyScalar(N.dot(L))).normalize(),x.crossVectors(A,L);const $=x.dot(c[k])<0?-1:1;a.setXYZW(k,T.x,T.y,T.z,$)}for(let k=0,L=E.length;k<L;++k){const U=E[k],$=U.start,q=U.count;for(let G=$,X=$+q;G<X;G+=3)I(e.getX(G+0)),I(e.getX(G+1)),I(e.getX(G+2))}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new rr(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let d=0,f=i.count;d<f;d++)i.setXYZ(d,0,0,0);const r=new Re,s=new Re,a=new Re,o=new Re,c=new Re,l=new Re,u=new Re,h=new Re;if(e)for(let d=0,f=e.count;d<f;d+=3){const p=e.getX(d+0),g=e.getX(d+1),_=e.getX(d+2);r.fromBufferAttribute(n,p),s.fromBufferAttribute(n,g),a.fromBufferAttribute(n,_),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),o.fromBufferAttribute(i,p),c.fromBufferAttribute(i,g),l.fromBufferAttribute(i,_),o.add(u),c.add(u),l.add(u),i.setXYZ(p,o.x,o.y,o.z),i.setXYZ(g,c.x,c.y,c.z),i.setXYZ(_,l.x,l.y,l.z)}else for(let d=0,f=n.count;d<f;d+=3)r.fromBufferAttribute(n,d+0),s.fromBufferAttribute(n,d+1),a.fromBufferAttribute(n,d+2),u.subVectors(a,s),h.subVectors(r,s),u.cross(h),i.setXYZ(d+0,u.x,u.y,u.z),i.setXYZ(d+1,u.x,u.y,u.z),i.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,i=e.count;n<i;n++)el.fromBufferAttribute(e,n),el.normalize(),e.setXYZ(n,el.x,el.y,el.z)}toNonIndexed(){function e(o,c){const l=o.array,u=o.itemSize,h=o.normalized,d=new l.constructor(c.length*u);let f=0,p=0;for(let g=0,_=c.length;g<_;g++){o.isInterleavedBufferAttribute?f=c[g]*o.data.stride+o.offset:f=c[g]*u;for(let v=0;v<u;v++)d[p++]=l[f++]}return new rr(d,u,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Qi,i=this.index.array,r=this.attributes;for(const o in r){const c=r[o],l=e(c,i);n.setAttribute(o,l)}const s=this.morphAttributes;for(const o in s){const c=[],l=s[o];for(let u=0,h=l.length;u<h;u++){const d=l[u],f=e(d,i);c.push(f)}n.morphAttributes[o]=c}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,c=a.length;o<c;o++){const l=a[o];n.addGroup(l.start,l.count,l.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const l in c)c[l]!==void 0&&(e[l]=c[l]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const c in i){const l=i[c];e.data.attributes[c]=l.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const l=this.morphAttributes[c],u=[];for(let h=0,d=l.length;h<d;h++){const f=l[h];u.push(f.toJSON(e.data))}u.length>0&&(r[c]=u,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone());const r=e.attributes;for(const l in r){const u=r[l];this.setAttribute(l,u.clone(n))}const s=e.morphAttributes;for(const l in s){const u=[],h=s[l];for(let d=0,f=h.length;d<f;d++)u.push(h[d].clone(n));this.morphAttributes[l]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let l=0,u=a.length;l<u;l++){const h=a[l];this.addGroup(h.start,h.count,h.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const SX=new Ni,qE=new kC,qI=new Dl,TX=new Re,$I=new Re,WI=new Re,YI=new Re,Rz=new Re,XI=new Re,xX=new Re,KI=new Re;class Bo extends Gr{constructor(e=new Qi,n=new Fb){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,n){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;n.fromBufferAttribute(r,e);const o=this.morphTargetInfluences;if(s&&o){XI.set(0,0,0);for(let c=0,l=s.length;c<l;c++){const u=o[c],h=s[c];u!==0&&(Rz.fromBufferAttribute(h,e),a?XI.addScaledVector(Rz,u):XI.addScaledVector(Rz.sub(n),u))}n.add(XI)}return n}raycast(e,n){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),qI.copy(i.boundingSphere),qI.applyMatrix4(s),qE.copy(e.ray).recast(e.near),!(qI.containsPoint(qE.origin)===!1&&(qE.intersectSphere(qI,TX)===null||qE.origin.distanceToSquared(TX)>(e.far-e.near)**2))&&(SX.copy(s).invert(),qE.copy(e.ray).applyMatrix4(SX),!(i.boundingBox!==null&&qE.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,n,qE)))}_computeIntersections(e,n,i){let r;const s=this.geometry,a=this.material,o=s.index,c=s.attributes.position,l=s.attributes.uv,u=s.attributes.uv1,h=s.attributes.normal,d=s.groups,f=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,g=d.length;p<g;p++){const _=d[p],v=a[_.materialIndex],E=Math.max(_.start,f.start),T=Math.min(o.count,Math.min(_.start+_.count,f.start+f.count));for(let x=E,N=T;x<N;x+=3){const A=o.getX(x),I=o.getX(x+1),k=o.getX(x+2);r=JI(this,v,e,i,l,u,h,A,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=_.materialIndex,n.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(o.count,f.start+f.count);for(let _=p,v=g;_<v;_+=3){const E=o.getX(_),T=o.getX(_+1),x=o.getX(_+2);r=JI(this,a,e,i,l,u,h,E,T,x),r&&(r.faceIndex=Math.floor(_/3),n.push(r))}}else if(c!==void 0)if(Array.isArray(a))for(let p=0,g=d.length;p<g;p++){const _=d[p],v=a[_.materialIndex],E=Math.max(_.start,f.start),T=Math.min(c.count,Math.min(_.start+_.count,f.start+f.count));for(let x=E,N=T;x<N;x+=3){const A=x,I=x+1,k=x+2;r=JI(this,v,e,i,l,u,h,A,I,k),r&&(r.faceIndex=Math.floor(x/3),r.face.materialIndex=_.materialIndex,n.push(r))}}else{const p=Math.max(0,f.start),g=Math.min(c.count,f.start+f.count);for(let _=p,v=g;_<v;_+=3){const E=_,T=_+1,x=_+2;r=JI(this,a,e,i,l,u,h,E,T,x),r&&(r.faceIndex=Math.floor(_/3),n.push(r))}}}}function wTe(t,e,n,i,r,s,a,o){let c;if(e.side===Pc?c=i.intersectTriangle(a,s,r,!0,o):c=i.intersectTriangle(r,s,a,e.side===Dg,o),c===null)return null;KI.copy(o),KI.applyMatrix4(t.matrixWorld);const l=n.ray.origin.distanceTo(KI);return l<n.near||l>n.far?null:{distance:l,point:KI.clone(),object:t}}function JI(t,e,n,i,r,s,a,o,c,l){t.getVertexPosition(o,$I),t.getVertexPosition(c,WI),t.getVertexPosition(l,YI);const u=wTe(t,e,n,i,$I,WI,YI,xX);if(u){const h=new Re;Dh.getBarycoord(xX,$I,WI,YI,h),r&&(u.uv=Dh.getInterpolatedAttribute(r,o,c,l,h,new Rt)),s&&(u.uv1=Dh.getInterpolatedAttribute(s,o,c,l,h,new Rt)),a&&(u.normal=Dh.getInterpolatedAttribute(a,o,c,l,h,new Re),u.normal.dot(i.direction)>0&&u.normal.multiplyScalar(-1));const d={a:o,b:c,c:l,normal:new Re,materialIndex:0};Dh.getNormal($I,WI,YI,d.normal),u.face=d,u.barycoord=h}return u}class PT extends Qi{constructor(e=1,n=1,i=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:i,widthSegments:r,heightSegments:s,depthSegments:a};const o=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const c=[],l=[],u=[],h=[];let d=0,f=0;p("z","y","x",-1,-1,i,n,e,a,s,0),p("z","y","x",1,-1,i,n,-e,a,s,1),p("x","z","y",1,1,e,i,n,r,a,2),p("x","z","y",1,-1,e,i,-n,r,a,3),p("x","y","z",1,-1,e,n,i,r,s,4),p("x","y","z",-1,-1,e,n,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new Hn(l,3)),this.setAttribute("normal",new Hn(u,3)),this.setAttribute("uv",new Hn(h,2));function p(g,_,v,E,T,x,N,A,I,k,L){const U=x/I,$=N/k,q=x/2,G=N/2,X=A/2,ie=I+1,V=k+1;let Z=0,Y=0;const ee=new Re;for(let oe=0;oe<V;oe++){const de=oe*$-G;for(let Me=0;Me<ie;Me++){const He=Me*U-q;ee[g]=He*E,ee[_]=de*T,ee[v]=X,l.push(ee.x,ee.y,ee.z),ee[g]=0,ee[_]=0,ee[v]=A>0?1:-1,u.push(ee.x,ee.y,ee.z),h.push(Me/I),h.push(1-oe/k),Z+=1}}for(let oe=0;oe<k;oe++)for(let de=0;de<I;de++){const Me=d+de+ie*oe,He=d+de+ie*(oe+1),Te=d+(de+1)+ie*(oe+1),Le=d+(de+1)+ie*oe;c.push(Me,He,Le),c.push(He,Te,Le),Y+=6}o.addGroup(f,Y,L),f+=Y,d+=Z}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new PT(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function Uw(t){const e={};for(const n in t){e[n]={};for(const i in t[n]){const r=t[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][i]=null):e[n][i]=r.clone():Array.isArray(r)?e[n][i]=r.slice():e[n][i]=r}}return e}function zu(t){const e={};for(let n=0;n<t.length;n++){const i=Uw(t[n]);for(const r in i)e[r]=i[r]}return e}function CTe(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function jse(t){const e=t.getRenderTarget();return e===null?t.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Lr.workingColorSpace}const Vse={clone:Uw,merge:zu};var RTe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ATe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Bc extends yl{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=RTe,this.fragmentShader=ATe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Uw(e.uniforms),this.uniformsGroups=CTe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class JO extends Gr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Ni,this.projectionMatrix=new Ni,this.projectionMatrixInverse=new Ni,this.coordinateSystem=jf}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const s_=new Re,wX=new Rt,CX=new Rt;let Ic=class extends JO{constructor(e=50,n=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=Pw*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(BS*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Pw*2*Math.atan(Math.tan(BS*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,n,i){s_.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(s_.x,s_.y).multiplyScalar(-e/s_.z),s_.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(s_.x,s_.y).multiplyScalar(-e/s_.z)}getViewSize(e,n){return this.getViewBounds(e,wX,CX),n.subVectors(CX,wX)}setViewOffset(e,n,i,r,s,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(BS*.5*this.fov)/this.zoom,i=2*n,r=this.aspect*i,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const c=a.fullWidth,l=a.fullHeight;s+=a.offsetX*r/c,n-=a.offsetY*i/l,r*=a.width/c,i*=a.height/l}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,n,n-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}};const Vx=-90,Gx=1;class Gse extends Gr{constructor(e,n,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Ic(Vx,Gx,e,n);r.layers=this.layers,this.add(r);const s=new Ic(Vx,Gx,e,n);s.layers=this.layers,this.add(s);const a=new Ic(Vx,Gx,e,n);a.layers=this.layers,this.add(a);const o=new Ic(Vx,Gx,e,n);o.layers=this.layers,this.add(o);const c=new Ic(Vx,Gx,e,n);c.layers=this.layers,this.add(c);const l=new Ic(Vx,Gx,e,n);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[i,r,s,a,o,c]=n;for(const l of n)this.remove(l);if(e===jf)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===TM)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const l of n)this.add(l),l.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,c,l,u]=this.children,h=e.getRenderTarget(),d=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(n,s),e.setRenderTarget(i,1,r),e.render(n,a),e.setRenderTarget(i,2,r),e.render(n,o),e.setRenderTarget(i,3,r),e.render(n,c),e.setRenderTarget(i,4,r),e.render(n,l),i.texture.generateMipmaps=g,e.setRenderTarget(i,5,r),e.render(n,u),e.setRenderTarget(h,d,f),e.xr.enabled=p,i.texture.needsPMREMUpdate=!0}}class ZO extends Pa{constructor(e=[],n=Xv,i,r,s,a,o,c,l,u){super(e,n,i,r,s,a,o,c,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class qse extends Ul{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];this.texture=new ZO(r,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:_a}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new PT(5,5,5),s=new Bc({name:"CubemapFromEquirect",uniforms:Uw(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Pc,blending:Yf});s.uniforms.tEquirect.value=n;const a=new Bo(r,s),o=n.minFilter;return n.minFilter===gg&&(n.minFilter=_a),new Gse(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n=!0,i=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,i,r);e.setRenderTarget(s)}}class N1 extends Gr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const MTe={type:"move"};class LD{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new N1,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new N1,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Re,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Re),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new N1,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Re,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Re),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const i of e.hand.values())this._getHandJoint(n,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,i){let r=null,s=null,a=null;const o=this._targetRay,c=this._grip,l=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(l&&e.hand){a=!0;for(const g of e.hand.values()){const _=n.getJointPose(g,i),v=this._getHandJoint(l,g);_!==null&&(v.matrix.fromArray(_.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=_.radius),v.visible=_!==null}const u=l.joints["index-finger-tip"],h=l.joints["thumb-tip"],d=u.position.distanceTo(h.position),f=.02,p=.005;l.inputState.pinching&&d>f+p?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&d<=f-p&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));o!==null&&(r=n.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,r.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(r.linearVelocity)):o.hasLinearVelocity=!1,r.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(r.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(MTe)))}return o!==null&&(o.visible=r!==null),c!==null&&(c.visible=s!==null),l!==null&&(l.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const i=new N1;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[n.jointName]=i,e.add(i)}return e.joints[n.jointName]}}class n3{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new _n(e),this.density=n}clone(){return new n3(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class i3{constructor(e,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new _n(e),this.near=n,this.far=i}clone(){return new i3(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Bw extends Gr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new $h,this.environmentIntensity=1,this.environmentRotation=new $h,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(n.object.environmentIntensity=this.environmentIntensity),n.object.environmentRotation=this.environmentRotation.toArray(),n}}class r3{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=SM,this.updateRanges=[],this.version=0,this.uuid=zd()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,i){e*=this.stride,i*=n.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=n.array[i+r];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zd()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=zd()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Bu=new Re;class iT{constructor(e,n,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,i=this.data.count;n<i;n++)Bu.fromBufferAttribute(this,n),Bu.applyMatrix4(e),this.setXYZ(n,Bu.x,Bu.y,Bu.z);return this}applyNormalMatrix(e){for(let n=0,i=this.count;n<i;n++)Bu.fromBufferAttribute(this,n),Bu.applyNormalMatrix(e),this.setXYZ(n,Bu.x,Bu.y,Bu.z);return this}transformDirection(e){for(let n=0,i=this.count;n<i;n++)Bu.fromBufferAttribute(this,n),Bu.transformDirection(e),this.setXYZ(n,Bu.x,Bu.y,Bu.z);return this}getComponent(e,n){let i=this.array[e*this.data.stride+this.offset+n];return this.normalized&&(i=Yu(i,this.array)),i}setComponent(e,n,i){return this.normalized&&(i=tr(i,this.array)),this.data.array[e*this.data.stride+this.offset+n]=i,this}setX(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=tr(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=Yu(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=Yu(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=Yu(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=Yu(n,this.array)),n}setXY(e,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this}setXYZ(e,n,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,n,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=tr(n,this.array),i=tr(i,this.array),r=tr(r,this.array),s=tr(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return new rr(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new iT(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Sq extends yl{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new _n(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let qx;const OR=new Re,$x=new Re,Wx=new Re,Yx=new Rt,NR=new Rt,$se=new Ni,ZI=new Re,IR=new Re,QI=new Re,RX=new Rt,Az=new Rt,AX=new Rt;class Wse extends Gr{constructor(e=new Sq){if(super(),this.isSprite=!0,this.type="Sprite",qx===void 0){qx=new Qi;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new r3(n,5);qx.setIndex([0,1,2,0,2,3]),qx.setAttribute("position",new iT(i,3,0,!1)),qx.setAttribute("uv",new iT(i,2,3,!1))}this.geometry=qx,this.material=e,this.center=new Rt(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),$x.setFromMatrixScale(this.matrixWorld),$se.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Wx.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&$x.multiplyScalar(-Wx.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const a=this.center;ek(ZI.set(-.5,-.5,0),Wx,a,$x,r,s),ek(IR.set(.5,-.5,0),Wx,a,$x,r,s),ek(QI.set(.5,.5,0),Wx,a,$x,r,s),RX.set(0,0),Az.set(1,0),AX.set(1,1);let o=e.ray.intersectTriangle(ZI,IR,QI,!1,OR);if(o===null&&(ek(IR.set(-.5,.5,0),Wx,a,$x,r,s),Az.set(0,1),o=e.ray.intersectTriangle(ZI,QI,IR,!1,OR),o===null))return;const c=e.ray.origin.distanceTo(OR);c<e.near||c>e.far||n.push({distance:c,point:OR.clone(),uv:Dh.getInterpolation(OR,ZI,IR,QI,RX,Az,AX,new Rt),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function ek(t,e,n,i,r,s){Yx.subVectors(t,n).addScalar(.5).multiply(i),r!==void 0?(NR.x=s*Yx.x-r*Yx.y,NR.y=r*Yx.x+s*Yx.y):NR.copy(Yx),t.copy(e),t.x+=NR.x,t.y+=NR.y,t.applyMatrix4($se)}const tk=new Re,MX=new Re;class Yse extends Gr{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let i=0,r=n.length;i<r;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,i=0){n=Math.abs(n);const r=this.levels;let s;for(s=0;s<r.length&&!(n<r[s].distance);s++);return r.splice(s,0,{distance:n,hysteresis:i,object:e}),this.add(e),this}removeLevel(e){const n=this.levels;for(let i=0;i<n.length;i++)if(n[i].distance===e){const r=n.splice(i,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let i,r;for(i=1,r=n.length;i<r;i++){let s=n[i].distance;if(n[i].object.visible&&(s-=s*n[i].hysteresis),e<s)break}return n[i-1].object}return null}raycast(e,n){if(this.levels.length>0){tk.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(tk);this.getObjectForDistance(r).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){tk.setFromMatrixPosition(e.matrixWorld),MX.setFromMatrixPosition(this.matrixWorld);const i=tk.distanceTo(MX)/e.zoom;n[0].object.visible=!0;let r,s;for(r=1,s=n.length;r<s;r++){let a=n[r].distance;if(n[r].object.visible&&(a-=a*n[r].hysteresis),i>=a)n[r-1].object.visible=!1,n[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)n[r].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const a=i[r];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const OX=new Re,NX=new Kr,IX=new Kr,OTe=new Re,kX=new Ni,nk=new Re,Mz=new Dl,DX=new Ni,Oz=new kC;class Xse extends Bo{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Oj,this.bindMatrix=new Ni,this.bindMatrixInverse=new Ni,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new cu),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,nk),this.boundingBox.expandByPoint(nk)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Dl),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let i=0;i<n.count;i++)this.getVertexPosition(i,nk),this.boundingSphere.expandByPoint(nk)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Mz.copy(this.boundingSphere),Mz.applyMatrix4(r),e.ray.intersectsSphere(Mz)!==!1&&(DX.copy(r).invert(),Oz.copy(e.ray).applyMatrix4(DX),!(this.boundingBox!==null&&Oz.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,Oz)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Kr,n=this.geometry.attributes.skinWeight;for(let i=0,r=n.count;i<r;i++){e.fromBufferAttribute(n,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Oj?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===xse?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const i=this.skeleton,r=this.geometry;NX.fromBufferAttribute(r.attributes.skinIndex,e),IX.fromBufferAttribute(r.attributes.skinWeight,e),OX.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=IX.getComponent(s);if(a!==0){const o=NX.getComponent(s);kX.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),n.addScaledVector(OTe.copy(OX).applyMatrix4(kX),a)}}return n.applyMatrix4(this.bindMatrixInverse)}}class Tq extends Gr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Xf extends Pa{constructor(e=null,n=1,i=1,r,s,a,o,c,l=Za,u=Za,h,d){super(null,a,o,c,l,u,r,s,h,d),this.isDataTexture=!0,this.image={data:e,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const PX=new Ni,NTe=new Ni;class s3{constructor(e=[],n=[]){this.uuid=zd(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Ni)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const i=new Ni;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,n=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:NTe;PX.multiplyMatrices(o,n[s]),PX.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new s3(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const i=new Xf(n,e,e,ru,iu);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this}getBoneByName(e){for(let n=0,i=this.bones.length;n<i;n++){const r=this.bones[n];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let a=n[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new Tq),this.bones.push(a),this.boneInverses.push(new Ni().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let r=0,s=n.length;r<s;r++){const a=n[r];e.bones.push(a.uuid);const o=i[r];e.boneInverses.push(o.toArray())}return e}}class Fw extends rr{constructor(e,n,i,r=1){super(e,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Xx=new Ni,LX=new Ni,ik=[],UX=new cu,ITe=new Ni,kR=new Bo,DR=new Dl;class Kse extends Bo{constructor(e,n,i){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new Fw(new Float32Array(i*16),16),this.instanceColor=null,this.morphTexture=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,ITe)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new cu),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Xx),UX.copy(e.boundingBox).applyMatrix4(Xx),this.boundingBox.union(UX)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new Dl),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<n;i++)this.getMatrixAt(i,Xx),DR.copy(e.boundingSphere).applyMatrix4(Xx),this.boundingSphere.union(DR)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,n){const i=n.morphTargetInfluences,r=this.morphTexture.source.data.data,s=i.length+1,a=e*s+1;for(let o=0;o<i.length;o++)i[o]=r[a+o]}raycast(e,n){const i=this.matrixWorld,r=this.count;if(kR.geometry=this.geometry,kR.material=this.material,kR.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),DR.copy(this.boundingSphere),DR.applyMatrix4(i),e.ray.intersectsSphere(DR)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Xx),LX.multiplyMatrices(i,Xx),kR.matrixWorld=LX,kR.raycast(e,ik);for(let a=0,o=ik.length;a<o;a++){const c=ik[a];c.instanceId=s,c.object=this,n.push(c)}ik.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new Fw(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,n){const i=n.morphTargetInfluences,r=i.length+1;this.morphTexture===null&&(this.morphTexture=new Xf(new Float32Array(r*this.count),r,this.count,JU,iu));const s=this.morphTexture.source.data.data;let a=0;for(let l=0;l<i.length;l++)a+=i[l];const o=this.geometry.morphTargetsRelative?1:1-a,c=r*e;s[c]=o,s.set(i,c+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const Nz=new Re,kTe=new Re,DTe=new Zi;class Rf{constructor(e=new Re(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,i,r){return this.normal.set(e,n,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,i){const r=Nz.subVectors(i,n).cross(kTe.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const i=e.delta(Nz),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:n.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return n<0&&i>0||i<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const i=n||DTe.getNormalMatrix(e),r=this.coplanarPoint(Nz).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const $E=new Dl,rk=new Re;class DC{constructor(e=new Rf,n=new Rf,i=new Rf,r=new Rf,s=new Rf,a=new Rf){this.planes=[e,n,i,r,s,a]}set(e,n,i,r,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(i),o[3].copy(r),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,n=jf){const i=this.planes,r=e.elements,s=r[0],a=r[1],o=r[2],c=r[3],l=r[4],u=r[5],h=r[6],d=r[7],f=r[8],p=r[9],g=r[10],_=r[11],v=r[12],E=r[13],T=r[14],x=r[15];if(i[0].setComponents(c-s,d-l,_-f,x-v).normalize(),i[1].setComponents(c+s,d+l,_+f,x+v).normalize(),i[2].setComponents(c+a,d+u,_+p,x+E).normalize(),i[3].setComponents(c-a,d-u,_-p,x-E).normalize(),i[4].setComponents(c-o,d-h,_-g,x-T).normalize(),n===jf)i[5].setComponents(c+o,d+h,_+g,x+T).normalize();else if(n===TM)i[5].setComponents(o,h,g,T).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),$E.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),$E.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere($E)}intersectsSprite(e){return $E.center.set(0,0,0),$E.radius=.7071067811865476,$E.applyMatrix4(e.matrixWorld),this.intersectsSphere($E)}intersectsSphere(e){const n=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const n=this.planes;for(let i=0;i<6;i++){const r=n[i];if(rk.x=r.normal.x>0?e.max.x:e.min.x,rk.y=r.normal.y>0?e.max.y:e.min.y,rk.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(rk)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Wm=new Ni,Ym=new DC;class a3{constructor(){this.coordinateSystem=jf}intersectsObject(e,n){if(!n.isArrayCamera||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Wm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ym.setFromProjectionMatrix(Wm,this.coordinateSystem),Ym.intersectsObject(e))return!0}return!1}intersectsSprite(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Wm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ym.setFromProjectionMatrix(Wm,this.coordinateSystem),Ym.intersectsSprite(e))return!0}return!1}intersectsSphere(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Wm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ym.setFromProjectionMatrix(Wm,this.coordinateSystem),Ym.intersectsSphere(e))return!0}return!1}intersectsBox(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Wm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ym.setFromProjectionMatrix(Wm,this.coordinateSystem),Ym.intersectsBox(e))return!0}return!1}containsPoint(e,n){if(!n||!n.cameras||n.cameras.length===0)return!1;for(let i=0;i<n.cameras.length;i++){const r=n.cameras[i];if(Wm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),Ym.setFromProjectionMatrix(Wm,this.coordinateSystem),Ym.containsPoint(e))return!0}return!1}clone(){return new a3}}function Iz(t,e){return t-e}function PTe(t,e){return t.z-e.z}function LTe(t,e){return e.z-t.z}class UTe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n,i,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=n,o.z=i,o.index=r}reset(){this.list.length=0,this.index=0}}const wh=new Ni,BTe=new _n(1,1,1),BX=new DC,FTe=new a3,sk=new cu,WE=new Dl,PR=new Re,FX=new Re,zTe=new Re,kz=new UTe,Jl=new Bo,ak=[];function HTe(t,e,n=0){const i=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const r=t.count;for(let s=0;s<r;s++)for(let a=0;a<i;a++)e.setComponent(s+n,a,t.getComponent(s,a))}else e.array.set(t.array,n*i);e.needsUpdate=!0}function YE(t,e){if(t.constructor!==e.constructor){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++)e[i]=t[i]}else{const n=Math.min(t.length,e.length);e.set(new t.constructor(t.buffer,0,n))}}class Jse extends Bo{constructor(e,n,i=n*2,r){super(new Qi,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=n,this._maxIndexCount=i,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),i=new Xf(n,e,e,ru,iu);this._matricesTexture=i}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Uint32Array(e*e),i=new Xf(n,e,e,YO,Pg);this._indirectTexture=i}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const n=new Float32Array(e*e*4).fill(1),i=new Xf(n,e,e,ru,iu);i.colorSpace=Lr.workingColorSpace,this._colorsTexture=i}_initializeGeometry(e){const n=this.geometry,i=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:c,normalized:l}=a,u=new o.constructor(i*c),h=new rr(u,c,l);n.setAttribute(s,h)}if(e.getIndex()!==null){const s=i>65535?new Uint32Array(r):new Uint16Array(r);n.setIndex(new rr(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const i in n.attributes){if(!e.hasAttribute(i))throw new Error(`THREE.BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=n.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const n=this._instanceInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const n=this._geometryInfo;if(e<0||e>=n.length||n[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new cu);const e=this.boundingBox,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,wh),this.getBoundingBoxAt(s,sk).applyMatrix4(wh),e.union(sk)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Dl);const e=this.boundingSphere,n=this._instanceInfo;e.makeEmpty();for(let i=0,r=n.length;i<r;i++){if(n[i].active===!1)continue;const s=n[i].geometryIndex;this.getMatrixAt(i,wh),this.getBoundingSphereAt(s,WE).applyMatrix4(wh),e.union(WE)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const i={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(Iz),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=i):(r=this._instanceInfo.length,this._instanceInfo.push(i));const s=this._matricesTexture;wh.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(BTe.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,n=-1,i=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=n===-1?e.getAttribute("position").count:n;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=i===-1?a.count:i),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let c;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(Iz),c=this._availableGeometryIds.shift(),s[c]=r):(c=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(c,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,c}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),a=n.getIndex(),o=this._geometryInfo[e];if(r&&a.count>o.reservedIndexCount||n.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const c=o.vertexStart,l=o.reservedVertexCount;o.vertexCount=n.getAttribute("position").count;for(const u in i.attributes){const h=n.getAttribute(u),d=i.getAttribute(u);HTe(h,d,c);const f=h.itemSize;for(let p=h.count,g=l;p<g;p++){const _=c+p;for(let v=0;v<f;v++)d.setComponent(_,v,0)}d.needsUpdate=!0,d.addUpdateRange(c*f,l*f)}if(r){const u=o.indexStart,h=o.reservedIndexCount;o.indexCount=n.getIndex().count;for(let d=0;d<a.count;d++)s.setX(u+d,c+a.getX(d));for(let d=a.count,f=h;d<f;d++)s.setX(u+d,c);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=r?o.indexStart:o.vertexStart,o.count=r?o.indexCount:o.vertexCount,o.boundingBox=null,n.boundingBox!==null&&(o.boundingBox=n.boundingBox.clone()),o.boundingSphere=null,n.boundingSphere!==null&&(o.boundingSphere=n.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._geometryInfo;if(e>=n.length||n[e].active===!1)return this;const i=this._instanceInfo;for(let r=0,s=i.length;r<s;r++)i[r].active&&i[r].geometryIndex===e&&this.deleteInstance(r);return n[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,n=0;const i=this._geometryInfo,r=i.map((a,o)=>o).sort((a,o)=>i[a].vertexStart-i[o].vertexStart),s=this.geometry;for(let a=0,o=i.length;a<o;a++){const c=r[a],l=i[c];if(l.active!==!1){if(s.index!==null){if(l.indexStart!==n){const{indexStart:u,vertexStart:h,reservedIndexCount:d}=l,f=s.index,p=f.array,g=e-h;for(let _=u;_<u+d;_++)p[_]=p[_]+g;f.array.copyWithin(n,u,u+d),f.addUpdateRange(n,d),l.indexStart=n}n+=l.reservedIndexCount}if(l.vertexStart!==e){const{vertexStart:u,reservedVertexCount:h}=l,d=s.attributes;for(const f in d){const p=d[f],{array:g,itemSize:_}=p;g.copyWithin(e*_,u*_,(u+h)*_),p.addUpdateRange(e*_,h*_)}l.vertexStart=e}e+=l.reservedVertexCount,l.start=s.index?l.indexStart:l.vertexStart,this._nextIndexStart=s.index?l.indexStart+l.reservedIndexCount:0,this._nextVertexStart=l.vertexStart+l.reservedVertexCount}}return this}getBoundingBoxAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new cu,a=i.index,o=i.attributes.position;for(let c=r.start,l=r.start+r.count;c<l;c++){let u=c;a&&(u=a.getX(u)),s.expandByPoint(PR.fromBufferAttribute(o,u))}r.boundingBox=s}return n.copy(r.boundingBox),n}getBoundingSphereAt(e,n){if(e>=this._geometryCount)return null;const i=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Dl;this.getBoundingBoxAt(e,sk),sk.getCenter(s.center);const a=i.index,o=i.attributes.position;let c=0;for(let l=r.start,u=r.start+r.count;l<u;l++){let h=l;a&&(h=a.getX(h)),PR.fromBufferAttribute(o,h),c=Math.max(c,s.center.distanceToSquared(PR))}s.radius=Math.sqrt(c),r.boundingSphere=s}return n.copy(r.boundingSphere),n}setMatrixAt(e,n){this.validateInstanceId(e);const i=this._matricesTexture,r=this._matricesTexture.image.data;return n.toArray(r,e*16),i.needsUpdate=!0,this}getMatrixAt(e,n){return this.validateInstanceId(e),n.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,n){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),n.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,n){return this.validateInstanceId(e),n.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,n){return this.validateInstanceId(e),this._instanceInfo[e].visible===n?this:(this._instanceInfo[e].visible=n,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,n){return this.validateInstanceId(e),this.validateGeometryId(n),this._instanceInfo[e].geometryIndex=n,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,n={}){this.validateGeometryId(e);const i=this._geometryInfo[e];return n.vertexStart=i.vertexStart,n.vertexCount=i.vertexCount,n.reservedVertexCount=i.reservedVertexCount,n.indexStart=i.indexStart,n.indexCount=i.indexCount,n.reservedIndexCount=i.reservedIndexCount,n.start=i.start,n.count=i.count,n}setInstanceCount(e){const n=this._availableInstanceIds,i=this._instanceInfo;for(n.sort(Iz);n[n.length-1]===i.length;)i.pop(),n.pop();if(e<i.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);YE(this._multiDrawCounts,r),YE(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,c=this._colorsTexture;a.dispose(),this._initIndirectTexture(),YE(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),YE(o.image.data,this._matricesTexture.image.data),c&&(c.dispose(),this._initColorsTexture(),YE(c.image.data,this._colorsTexture.image.data))}setGeometrySize(e,n){const i=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...i.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${n}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...i.map(c=>c.indexStart+c.reservedIndexCount))>n)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${n}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=n,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Qi,this._initializeGeometry(s));const a=this.geometry;s.index&&YE(s.index.array,a.index.array);for(const o in s.attributes)YE(s.attributes[o].array,a.attributes[o].array)}raycast(e,n){const i=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;Jl.material=this.material,Jl.geometry.index=a.index,Jl.geometry.attributes=a.attributes,Jl.geometry.boundingBox===null&&(Jl.geometry.boundingBox=new cu),Jl.geometry.boundingSphere===null&&(Jl.geometry.boundingSphere=new Dl);for(let o=0,c=i.length;o<c;o++){if(!i[o].visible||!i[o].active)continue;const l=i[o].geometryIndex,u=r[l];Jl.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,Jl.matrixWorld).premultiply(s),this.getBoundingBoxAt(l,Jl.geometry.boundingBox),this.getBoundingSphereAt(l,Jl.geometry.boundingSphere),Jl.raycast(e,ak);for(let h=0,d=ak.length;h<d;h++){const f=ak[h];f.object=this,f.batchId=o,n.push(f)}ak.length=0}Jl.material=null,Jl.geometry.index=null,Jl.geometry.attributes={},Jl.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(n=>({...n,boundingBox:n.boundingBox!==null?n.boundingBox.clone():null,boundingSphere:n.boundingSphere!==null?n.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(n=>({...n})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,n,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,c=this._instanceInfo,l=this._multiDrawStarts,u=this._multiDrawCounts,h=this._geometryInfo,d=this.perObjectFrustumCulled,f=this._indirectTexture,p=f.image.data,g=i.isArrayCamera?FTe:BX;d&&!i.isArrayCamera&&(wh.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),BX.setFromProjectionMatrix(wh,e.coordinateSystem));let _=0;if(this.sortObjects){wh.copy(this.matrixWorld).invert(),PR.setFromMatrixPosition(i.matrixWorld).applyMatrix4(wh),FX.set(0,0,-1).transformDirection(i.matrixWorld).transformDirection(wh);for(let T=0,x=c.length;T<x;T++)if(c[T].visible&&c[T].active){const N=c[T].geometryIndex;this.getMatrixAt(T,wh),this.getBoundingSphereAt(N,WE).applyMatrix4(wh);let A=!1;if(d&&(A=!g.intersectsSphere(WE,i)),!A){const I=h[N],k=zTe.subVectors(WE.center,PR).dot(FX);kz.push(I.start,I.count,k,T)}}const v=kz.list,E=this.customSort;E===null?v.sort(s.transparent?LTe:PTe):E.call(this,v,i);for(let T=0,x=v.length;T<x;T++){const N=v[T];l[_]=N.start*o,u[_]=N.count,p[_]=N.index,_++}kz.reset()}else for(let v=0,E=c.length;v<E;v++)if(c[v].visible&&c[v].active){const T=c[v].geometryIndex;let x=!1;if(d&&(this.getMatrixAt(v,wh),this.getBoundingSphereAt(T,WE).applyMatrix4(wh),x=!g.intersectsSphere(WE,i)),!x){const N=h[T];l[_]=N.start*o,u[_]=N.count,p[_]=v,_++}}f.needsUpdate=!0,this._multiDrawCount=_,this._visibilityChanged=!1}onBeforeShadow(e,n,i,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class th extends yl{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new _n(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const AL=new Re,ML=new Re,zX=new Ni,LR=new kC,ok=new Dl,Dz=new Re,HX=new Re;class yb extends Gr{constructor(e=new Qi,n=new th){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[0];for(let r=1,s=n.count;r<s;r++)AL.fromBufferAttribute(n,r-1),ML.fromBufferAttribute(n,r),i[r]=i[r-1],i[r]+=AL.distanceTo(ML);e.setAttribute("lineDistance",new Hn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ok.copy(i.boundingSphere),ok.applyMatrix4(r),ok.radius+=s,e.ray.intersectsSphere(ok)===!1)return;zX.copy(r).invert(),LR.copy(e.ray).applyMatrix4(zX);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=this.isLineSegments?2:1,u=i.index,d=i.attributes.position;if(u!==null){const f=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let g=f,_=p-1;g<_;g+=l){const v=u.getX(g),E=u.getX(g+1),T=ck(this,e,LR,c,v,E,g);T&&n.push(T)}if(this.isLineLoop){const g=u.getX(p-1),_=u.getX(f),v=ck(this,e,LR,c,g,_,p-1);v&&n.push(v)}}else{const f=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let g=f,_=p-1;g<_;g+=l){const v=ck(this,e,LR,c,g,g+1,g);v&&n.push(v)}if(this.isLineLoop){const g=ck(this,e,LR,c,p-1,f,p-1);g&&n.push(g)}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function ck(t,e,n,i,r,s,a){const o=t.geometry.attributes.position;if(AL.fromBufferAttribute(o,r),ML.fromBufferAttribute(o,s),n.distanceSqToSegment(AL,ML,Dz,HX)>i)return;Dz.applyMatrix4(t.matrixWorld);const l=e.ray.origin.distanceTo(Dz);if(!(l<e.near||l>e.far))return{distance:l,point:HX.clone().applyMatrix4(t.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:t}}const jX=new Re,VX=new Re;class Yg extends yb{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,i=[];for(let r=0,s=n.count;r<s;r+=2)jX.fromBufferAttribute(n,r),VX.fromBufferAttribute(n,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+jX.distanceTo(VX);e.setAttribute("lineDistance",new Hn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Zse extends yb{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class xq extends yl{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new _n(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const GX=new Ni,kj=new kC,lk=new Dl,uk=new Re;class Qse extends Gr{constructor(e=new Qi,n=new xq){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),lk.copy(i.boundingSphere),lk.applyMatrix4(r),lk.radius+=s,e.ray.intersectsSphere(lk)===!1)return;GX.copy(r).invert(),kj.copy(e.ray).applyMatrix4(GX);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=o*o,l=i.index,h=i.attributes.position;if(l!==null){const d=Math.max(0,a.start),f=Math.min(l.count,a.start+a.count);for(let p=d,g=f;p<g;p++){const _=l.getX(p);uk.fromBufferAttribute(h,_),qX(uk,_,c,r,e,n,this)}}else{const d=Math.max(0,a.start),f=Math.min(h.count,a.start+a.count);for(let p=d,g=f;p<g;p++)uk.fromBufferAttribute(h,p),qX(uk,p,c,r,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const r=n[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const o=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function qX(t,e,n,i,r,s,a){const o=kj.distanceSqToPoint(t);if(o<n){const c=new Re;kj.closestPointToPoint(t,c),c.applyMatrix4(i);const l=r.ray.origin.distanceTo(c);if(l<r.near||l>r.far)return;s.push({distance:l,distanceToRay:Math.sqrt(o),point:c,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class eae extends Pa{constructor(e,n,i,r,s=_a,a=_a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function h(){u.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class jTe extends eae{constructor(e,n,i,r,s,a,o,c){super({},e,n,i,r,s,a,o,c),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class VTe extends Pa{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Za,this.minFilter=Za,this.generateMipmaps=!1,this.needsUpdate=!0}}class o3 extends Pa{constructor(e,n,i,r,s,a,o,c,l,u,h,d){super(null,a,o,c,l,u,r,s,h,d),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class GTe extends o3{constructor(e,n,i,r,s,a){super(e,n,i,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Hf,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class qTe extends o3{constructor(e,n,i){super(void 0,e[0].width,e[0].height,n,i,Xv),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class tae extends Pa{constructor(e,n,i,r,s,a,o,c,l){super(e,n,i,r,s,a,o,c,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class PC extends Pa{constructor(e,n,i=Pg,r,s,a,o=Za,c=Za,l,u=Dw){if(u!==Dw&&u!==nT)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,r,s,a,o,c,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:n},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new V_(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}class $Te extends PC{constructor(e=1,n=1,i=1){super(e,n),this.isDepthArrayTexture=!0,this.image={width:e,height:n,depth:i},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class c3 extends Qi{constructor(e=1,n=1,i=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:n,capSegments:i,radialSegments:r,heightSegments:s},n=Math.max(0,n),i=Math.max(1,Math.floor(i)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],o=[],c=[],l=[],u=n/2,h=Math.PI/2*e,d=n,f=2*h+d,p=i*2+s,g=r+1,_=new Re,v=new Re;for(let E=0;E<=p;E++){let T=0,x=0,N=0,A=0;if(E<=i){const L=E/i,U=L*Math.PI/2;x=-u-e*Math.cos(U),N=e*Math.sin(U),A=-e*Math.cos(U),T=L*h}else if(E<=i+s){const L=(E-i)/s;x=-u+L*n,N=e,A=0,T=h+L*d}else{const L=(E-i-s)/i,U=L*Math.PI/2;x=u+e*Math.sin(U),N=e*Math.cos(U),A=e*Math.sin(U),T=h+d+L*h}const I=Math.max(0,Math.min(1,T/f));let k=0;E===0?k=.5/r:E===p&&(k=-.5/r);for(let L=0;L<=r;L++){const U=L/r,$=U*Math.PI*2,q=Math.sin($),G=Math.cos($);v.x=-N*G,v.y=x,v.z=N*q,o.push(v.x,v.y,v.z),_.set(-N*G,A,N*q),_.normalize(),c.push(_.x,_.y,_.z),l.push(U+k,I)}if(E>0){const L=(E-1)*g;for(let U=0;U<r;U++){const $=L+U,q=L+U+1,G=E*g+U,X=E*g+U+1;a.push($,q,G),a.push(q,X,G)}}}this.setIndex(a),this.setAttribute("position",new Hn(o,3)),this.setAttribute("normal",new Hn(c,3)),this.setAttribute("uv",new Hn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new c3(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class l3 extends Qi{constructor(e=1,n=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:i,thetaLength:r},n=Math.max(3,n);const s=[],a=[],o=[],c=[],l=new Re,u=new Rt;a.push(0,0,0),o.push(0,0,1),c.push(.5,.5);for(let h=0,d=3;h<=n;h++,d+=3){const f=i+h/n*r;l.x=e*Math.cos(f),l.y=e*Math.sin(f),a.push(l.x,l.y,l.z),o.push(0,0,1),u.x=(a[d]/e+1)/2,u.y=(a[d+1]/e+1)/2,c.push(u.x,u.y)}for(let h=1;h<=n;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new Hn(a,3)),this.setAttribute("normal",new Hn(o,3)),this.setAttribute("uv",new Hn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l3(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class QO extends Qi{constructor(e=1,n=1,i=1,r=32,s=1,a=!1,o=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:i,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:c};const l=this;r=Math.floor(r),s=Math.floor(s);const u=[],h=[],d=[],f=[];let p=0;const g=[],_=i/2;let v=0;E(),a===!1&&(e>0&&T(!0),n>0&&T(!1)),this.setIndex(u),this.setAttribute("position",new Hn(h,3)),this.setAttribute("normal",new Hn(d,3)),this.setAttribute("uv",new Hn(f,2));function E(){const x=new Re,N=new Re;let A=0;const I=(n-e)/i;for(let k=0;k<=s;k++){const L=[],U=k/s,$=U*(n-e)+e;for(let q=0;q<=r;q++){const G=q/r,X=G*c+o,ie=Math.sin(X),V=Math.cos(X);N.x=$*ie,N.y=-U*i+_,N.z=$*V,h.push(N.x,N.y,N.z),x.set(ie,I,V).normalize(),d.push(x.x,x.y,x.z),f.push(G,1-U),L.push(p++)}g.push(L)}for(let k=0;k<r;k++)for(let L=0;L<s;L++){const U=g[L][k],$=g[L+1][k],q=g[L+1][k+1],G=g[L][k+1];(e>0||L!==0)&&(u.push(U,$,G),A+=3),(n>0||L!==s-1)&&(u.push($,q,G),A+=3)}l.addGroup(v,A,0),v+=A}function T(x){const N=p,A=new Rt,I=new Re;let k=0;const L=x===!0?e:n,U=x===!0?1:-1;for(let q=1;q<=r;q++)h.push(0,_*U,0),d.push(0,U,0),f.push(.5,.5),p++;const $=p;for(let q=0;q<=r;q++){const X=q/r*c+o,ie=Math.cos(X),V=Math.sin(X);I.x=L*V,I.y=_*U,I.z=L*ie,h.push(I.x,I.y,I.z),d.push(0,U,0),A.x=ie*.5+.5,A.y=V*.5*U+.5,f.push(A.x,A.y),p++}for(let q=0;q<r;q++){const G=N+q,X=$+q;x===!0?u.push(X,X+1,G):u.push(X+1,X,G),k+=3}l.addGroup(v,k,x===!0?1:2),v+=k}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new QO(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class eN extends QO{constructor(e=1,n=1,i=32,r=1,s=!1,a=0,o=Math.PI*2){super(0,e,n,i,r,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new eN(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class zb extends Qi{constructor(e=[],n=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:i,detail:r};const s=[],a=[];o(r),l(i),u(),this.setAttribute("position",new Hn(s,3)),this.setAttribute("normal",new Hn(s.slice(),3)),this.setAttribute("uv",new Hn(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function o(E){const T=new Re,x=new Re,N=new Re;for(let A=0;A<n.length;A+=3)f(n[A+0],T),f(n[A+1],x),f(n[A+2],N),c(T,x,N,E)}function c(E,T,x,N){const A=N+1,I=[];for(let k=0;k<=A;k++){I[k]=[];const L=E.clone().lerp(x,k/A),U=T.clone().lerp(x,k/A),$=A-k;for(let q=0;q<=$;q++)q===0&&k===A?I[k][q]=L:I[k][q]=L.clone().lerp(U,q/$)}for(let k=0;k<A;k++)for(let L=0;L<2*(A-k)-1;L++){const U=Math.floor(L/2);L%2===0?(d(I[k][U+1]),d(I[k+1][U]),d(I[k][U])):(d(I[k][U+1]),d(I[k+1][U+1]),d(I[k+1][U]))}}function l(E){const T=new Re;for(let x=0;x<s.length;x+=3)T.x=s[x+0],T.y=s[x+1],T.z=s[x+2],T.normalize().multiplyScalar(E),s[x+0]=T.x,s[x+1]=T.y,s[x+2]=T.z}function u(){const E=new Re;for(let T=0;T<s.length;T+=3){E.x=s[T+0],E.y=s[T+1],E.z=s[T+2];const x=_(E)/2/Math.PI+.5,N=v(E)/Math.PI+.5;a.push(x,1-N)}p(),h()}function h(){for(let E=0;E<a.length;E+=6){const T=a[E+0],x=a[E+2],N=a[E+4],A=Math.max(T,x,N),I=Math.min(T,x,N);A>.9&&I<.1&&(T<.2&&(a[E+0]+=1),x<.2&&(a[E+2]+=1),N<.2&&(a[E+4]+=1))}}function d(E){s.push(E.x,E.y,E.z)}function f(E,T){const x=E*3;T.x=e[x+0],T.y=e[x+1],T.z=e[x+2]}function p(){const E=new Re,T=new Re,x=new Re,N=new Re,A=new Rt,I=new Rt,k=new Rt;for(let L=0,U=0;L<s.length;L+=9,U+=6){E.set(s[L+0],s[L+1],s[L+2]),T.set(s[L+3],s[L+4],s[L+5]),x.set(s[L+6],s[L+7],s[L+8]),A.set(a[U+0],a[U+1]),I.set(a[U+2],a[U+3]),k.set(a[U+4],a[U+5]),N.copy(E).add(T).add(x).divideScalar(3);const $=_(N);g(A,U+0,E,$),g(I,U+2,T,$),g(k,U+4,x,$)}}function g(E,T,x,N){N<0&&E.x===1&&(a[T]=E.x-1),x.x===0&&x.z===0&&(a[T]=N/2/Math.PI+.5)}function _(E){return Math.atan2(E.z,-E.x)}function v(E){return Math.atan2(-E.y,Math.sqrt(E.x*E.x+E.z*E.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zb(e.vertices,e.indices,e.radius,e.details)}}class u3 extends zb{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new u3(e.radius,e.detail)}}const hk=new Re,dk=new Re,Pz=new Re,fk=new Dh;class nae extends Qi{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const r=Math.pow(10,4),s=Math.cos(BS*n),a=e.getIndex(),o=e.getAttribute("position"),c=a?a.count:o.count,l=[0,0,0],u=["a","b","c"],h=new Array(3),d={},f=[];for(let p=0;p<c;p+=3){a?(l[0]=a.getX(p),l[1]=a.getX(p+1),l[2]=a.getX(p+2)):(l[0]=p,l[1]=p+1,l[2]=p+2);const{a:g,b:_,c:v}=fk;if(g.fromBufferAttribute(o,l[0]),_.fromBufferAttribute(o,l[1]),v.fromBufferAttribute(o,l[2]),fk.getNormal(Pz),h[0]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,h[1]=`${Math.round(_.x*r)},${Math.round(_.y*r)},${Math.round(_.z*r)}`,h[2]=`${Math.round(v.x*r)},${Math.round(v.y*r)},${Math.round(v.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let E=0;E<3;E++){const T=(E+1)%3,x=h[E],N=h[T],A=fk[u[E]],I=fk[u[T]],k=`${x}_${N}`,L=`${N}_${x}`;L in d&&d[L]?(Pz.dot(d[L].normal)<=s&&(f.push(A.x,A.y,A.z),f.push(I.x,I.y,I.z)),d[L]=null):k in d||(d[k]={index0:l[E],index1:l[T],normal:Pz.clone()})}}for(const p in d)if(d[p]){const{index0:g,index1:_}=d[p];hk.fromBufferAttribute(o,g),dk.fromBufferAttribute(o,_),f.push(hk.x,hk.y,hk.z),f.push(dk.x,dk.y,dk.z)}this.setAttribute("position",new Hn(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class am{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,n){const i=this.getUtoTmapping(e);return this.getPoint(i,n)}getPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return n}getSpacedPoints(e=5){const n=[];for(let i=0;i<=e;i++)n.push(this.getPointAt(i/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,r=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(r),n.push(s),r=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n=null){const i=this.getLengths();let r=0;const s=i.length;let a;n?a=n:a=e*i[s-1];let o=0,c=s-1,l;for(;o<=c;)if(r=Math.floor(o+(c-o)/2),l=i[r]-a,l<0)o=r+1;else if(l>0)c=r-1;else{c=r;break}if(r=c,i[r]===a)return r/(s-1);const u=i[r],d=i[r+1]-u,f=(a-u)/d;return(r+f)/(s-1)}getTangent(e,n){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),o=this.getPoint(s),c=n||(a.isVector2?new Rt:new Re);return c.copy(o).sub(a).normalize(),c}getTangentAt(e,n){const i=this.getUtoTmapping(e);return this.getTangent(i,n)}computeFrenetFrames(e,n=!1){const i=new Re,r=[],s=[],a=[],o=new Re,c=new Ni;for(let f=0;f<=e;f++){const p=f/e;r[f]=this.getTangentAt(p,new Re)}s[0]=new Re,a[0]=new Re;let l=Number.MAX_VALUE;const u=Math.abs(r[0].x),h=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),h<=l&&(l=h,i.set(0,1,0)),d<=l&&i.set(0,0,1),o.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],o),a[0].crossVectors(r[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(r[f-1],r[f]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(Xi(r[f-1].dot(r[f]),-1,1));s[f].applyMatrix4(c.makeRotationAxis(o,p))}a[f].crossVectors(r[f],s[f])}if(n===!0){let f=Math.acos(Xi(s[0].dot(s[e]),-1,1));f/=e,r[0].dot(o.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(c.makeRotationAxis(r[p],f*p)),a[p].crossVectors(r[p],s[p])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class h3 extends am{constructor(e=0,n=0,i=1,r=1,s=0,a=Math.PI*2,o=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=c}getPoint(e,n=new Rt){const i=n,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const o=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),h=Math.sin(this.aRotation),d=c-this.aX,f=l-this.aY;c=d*u-f*h+this.aX,l=d*h+f*u+this.aY}return i.set(c,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class iae extends h3{constructor(e,n,i,r,s,a){super(e,n,i,i,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function wq(){let t=0,e=0,n=0,i=0;function r(s,a,o,c){t=s,e=o,n=-3*s+3*a-2*o-c,i=2*s-2*a+o+c}return{initCatmullRom:function(s,a,o,c,l){r(a,o,l*(o-s),l*(c-a))},initNonuniformCatmullRom:function(s,a,o,c,l,u,h){let d=(a-s)/l-(o-s)/(l+u)+(o-a)/u,f=(o-a)/u-(c-a)/(u+h)+(c-o)/h;d*=u,f*=u,r(a,o,d,f)},calc:function(s){const a=s*s,o=a*s;return t+e*s+n*a+i*o}}}const pk=new Re,Lz=new wq,Uz=new wq,Bz=new wq;class rae extends am{constructor(e=[],n=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=i,this.tension=r}getPoint(e,n=new Re){const i=n,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),c=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:c===0&&o===s-1&&(o=s-2,c=1);let l,u;this.closed||o>0?l=r[(o-1)%s]:(pk.subVectors(r[0],r[1]).add(r[0]),l=pk);const h=r[o%s],d=r[(o+1)%s];if(this.closed||o+2<s?u=r[(o+2)%s]:(pk.subVectors(r[s-1],r[s-2]).add(r[s-1]),u=pk),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(l.distanceToSquared(h),f),g=Math.pow(h.distanceToSquared(d),f),_=Math.pow(d.distanceToSquared(u),f);g<1e-4&&(g=1),p<1e-4&&(p=g),_<1e-4&&(_=g),Lz.initNonuniformCatmullRom(l.x,h.x,d.x,u.x,p,g,_),Uz.initNonuniformCatmullRom(l.y,h.y,d.y,u.y,p,g,_),Bz.initNonuniformCatmullRom(l.z,h.z,d.z,u.z,p,g,_)}else this.curveType==="catmullrom"&&(Lz.initCatmullRom(l.x,h.x,d.x,u.x,this.tension),Uz.initCatmullRom(l.y,h.y,d.y,u.y,this.tension),Bz.initCatmullRom(l.z,h.z,d.z,u.z,this.tension));return i.set(Lz.calc(c),Uz.calc(c),Bz.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Re().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function $X(t,e,n,i,r){const s=(i-e)*.5,a=(r-n)*.5,o=t*t,c=t*o;return(2*n-2*i+s+a)*c+(-3*n+3*i-2*s-a)*o+s*t+n}function WTe(t,e){const n=1-t;return n*n*e}function YTe(t,e){return 2*(1-t)*t*e}function XTe(t,e){return t*t*e}function DA(t,e,n,i){return WTe(t,e)+YTe(t,n)+XTe(t,i)}function KTe(t,e){const n=1-t;return n*n*n*e}function JTe(t,e){const n=1-t;return 3*n*n*t*e}function ZTe(t,e){return 3*(1-t)*t*t*e}function QTe(t,e){return t*t*t*e}function PA(t,e,n,i,r){return KTe(t,e)+JTe(t,n)+ZTe(t,i)+QTe(t,r)}class Cq extends am{constructor(e=new Rt,n=new Rt,i=new Rt,r=new Rt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Rt){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(PA(e,r.x,s.x,a.x,o.x),PA(e,r.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class sae extends am{constructor(e=new Re,n=new Re,i=new Re,r=new Re){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=i,this.v3=r}getPoint(e,n=new Re){const i=n,r=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(PA(e,r.x,s.x,a.x,o.x),PA(e,r.y,s.y,a.y,o.y),PA(e,r.z,s.z,a.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Rq extends am{constructor(e=new Rt,n=new Rt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Rt){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Rt){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aae extends am{constructor(e=new Re,n=new Re){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new Re){const i=n;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Re){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Aq extends am{constructor(e=new Rt,n=new Rt,i=new Rt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Rt){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(DA(e,r.x,s.x,a.x),DA(e,r.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Mq extends am{constructor(e=new Re,n=new Re,i=new Re){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=i}getPoint(e,n=new Re){const i=n,r=this.v0,s=this.v1,a=this.v2;return i.set(DA(e,r.x,s.x,a.x),DA(e,r.y,s.y,a.y),DA(e,r.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Oq extends am{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Rt){const i=n,r=this.points,s=(r.length-1)*e,a=Math.floor(s),o=s-a,c=r[a===0?a:a-1],l=r[a],u=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return i.set($X(o,c.x,l.x,u.x,h.x),$X(o,c.y,l.y,u.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,i=this.points.length;n<i;n++){const r=this.points[n];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,i=e.points.length;n<i;n++){const r=e.points[n];this.points.push(new Rt().fromArray(r))}return this}}var OL=Object.freeze({__proto__:null,ArcCurve:iae,CatmullRomCurve3:rae,CubicBezierCurve:Cq,CubicBezierCurve3:sae,EllipseCurve:h3,LineCurve:Rq,LineCurve3:aae,QuadraticBezierCurve:Aq,QuadraticBezierCurve3:Mq,SplineCurve:Oq});class oae extends am{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new OL[i](n,e))}return this}getPoint(e,n){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const a=r[s]-i,o=this.curves[s],c=o.getLength(),l=c===0?0:1-a/c;return o.getPointAt(l,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let i=0,r=this.curves.length;i<r;i++)n+=this.curves[i].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let i=0;i<=e;i++)n.push(this.getPoint(i/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,c=a.getPoints(o);for(let l=0;l<c.length;l++){const u=c[l];i&&i.equals(u)||(n.push(u),i=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const r=this.curves[n];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,i=e.curves.length;n<i;n++){const r=e.curves[n];this.curves.push(new OL[r.type]().fromJSON(r))}return this}}class NL extends oae{constructor(e){super(),this.type="Path",this.currentPoint=new Rt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,i=e.length;n<i;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const i=new Rq(this.currentPoint.clone(),new Rt(e,n));return this.curves.push(i),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,i,r){const s=new Aq(this.currentPoint.clone(),new Rt(e,n),new Rt(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,n,i,r,s,a){const o=new Cq(this.currentPoint.clone(),new Rt(e,n),new Rt(i,r),new Rt(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),i=new Oq(n);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,i,r,s,a){const o=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+o,n+c,i,r,s,a),this}absarc(e,n,i,r,s,a){return this.absellipse(e,n,i,i,r,s,a),this}ellipse(e,n,i,r,s,a,o,c){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,n+u,i,r,s,a,o,c),this}absellipse(e,n,i,r,s,a,o,c){const l=new h3(e,n,i,r,s,a,o,c);if(this.curves.length>0){const h=l.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(l);const u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class FS extends NL{constructor(e){super(e),this.uuid=zd(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let i=0,r=this.holes.length;i<r;i++)n[i]=this.holes[i].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const r=this.holes[n];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,i=e.holes.length;n<i;n++){const r=e.holes[n];this.holes.push(new NL().fromJSON(r))}return this}}function exe(t,e,n=2){const i=e&&e.length,r=i?e[0]*n:t.length;let s=cae(t,0,r,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,c,l;if(i&&(s=sxe(t,e,s,n)),t.length>80*n){o=1/0,c=1/0;let u=-1/0,h=-1/0;for(let d=n;d<r;d+=n){const f=t[d],p=t[d+1];f<o&&(o=f),p<c&&(c=p),f>u&&(u=f),p>h&&(h=p)}l=Math.max(u-o,h-c),l=l!==0?32767/l:0}return wM(s,a,n,o,c,l,0),a}function cae(t,e,n,i,r){let s;if(r===gxe(t,e,n,i)>0)for(let a=e;a<n;a+=i)s=WX(a/i|0,t[a],t[a+1],s);else for(let a=n-i;a>=e;a-=i)s=WX(a/i|0,t[a],t[a+1],s);return s&&zw(s,s.next)&&(RM(s),s=s.next),s}function rT(t,e){if(!t)return t;e||(e=t);let n=t,i;do if(i=!1,!n.steiner&&(zw(n,n.next)||Ka(n.prev,n,n.next)===0)){if(RM(n),n=e=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==e);return e}function wM(t,e,n,i,r,s,a){if(!t)return;!a&&s&&uxe(t,i,r,s);let o=t;for(;t.prev!==t.next;){const c=t.prev,l=t.next;if(s?nxe(t,i,r,s):txe(t)){e.push(c.i,t.i,l.i),RM(t),t=l.next,o=l.next;continue}if(t=l,t===o){a?a===1?(t=ixe(rT(t),e),wM(t,e,n,i,r,s,2)):a===2&&rxe(t,e,n,i,r,s):wM(rT(t),e,n,i,r,s,1);break}}}function txe(t){const e=t.prev,n=t,i=t.next;if(Ka(e,n,i)>=0)return!1;const r=e.x,s=n.x,a=i.x,o=e.y,c=n.y,l=i.y,u=Math.min(r,s,a),h=Math.min(o,c,l),d=Math.max(r,s,a),f=Math.max(o,c,l);let p=i.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=h&&p.y<=f&&hA(r,o,s,c,a,l,p.x,p.y)&&Ka(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function nxe(t,e,n,i){const r=t.prev,s=t,a=t.next;if(Ka(r,s,a)>=0)return!1;const o=r.x,c=s.x,l=a.x,u=r.y,h=s.y,d=a.y,f=Math.min(o,c,l),p=Math.min(u,h,d),g=Math.max(o,c,l),_=Math.max(u,h,d),v=Dj(f,p,e,n,i),E=Dj(g,_,e,n,i);let T=t.prevZ,x=t.nextZ;for(;T&&T.z>=v&&x&&x.z<=E;){if(T.x>=f&&T.x<=g&&T.y>=p&&T.y<=_&&T!==r&&T!==a&&hA(o,u,c,h,l,d,T.x,T.y)&&Ka(T.prev,T,T.next)>=0||(T=T.prevZ,x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==r&&x!==a&&hA(o,u,c,h,l,d,x.x,x.y)&&Ka(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;T&&T.z>=v;){if(T.x>=f&&T.x<=g&&T.y>=p&&T.y<=_&&T!==r&&T!==a&&hA(o,u,c,h,l,d,T.x,T.y)&&Ka(T.prev,T,T.next)>=0)return!1;T=T.prevZ}for(;x&&x.z<=E;){if(x.x>=f&&x.x<=g&&x.y>=p&&x.y<=_&&x!==r&&x!==a&&hA(o,u,c,h,l,d,x.x,x.y)&&Ka(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function ixe(t,e){let n=t;do{const i=n.prev,r=n.next.next;!zw(i,r)&&uae(i,n,n.next,r)&&CM(i,r)&&CM(r,i)&&(e.push(i.i,n.i,r.i),RM(n),RM(n.next),n=t=r),n=n.next}while(n!==t);return rT(n)}function rxe(t,e,n,i,r,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&fxe(a,o)){let c=hae(a,o);a=rT(a,a.next),c=rT(c,c.next),wM(a,e,n,i,r,s,0),wM(c,e,n,i,r,s,0);return}o=o.next}a=a.next}while(a!==t)}function sxe(t,e,n,i){const r=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*i,c=s<a-1?e[s+1]*i:t.length,l=cae(t,o,c,i,!1);l===l.next&&(l.steiner=!0),r.push(dxe(l))}r.sort(axe);for(let s=0;s<r.length;s++)n=oxe(r[s],n);return n}function axe(t,e){let n=t.x-e.x;if(n===0&&(n=t.y-e.y,n===0)){const i=(t.next.y-t.y)/(t.next.x-t.x),r=(e.next.y-e.y)/(e.next.x-e.x);n=i-r}return n}function oxe(t,e){const n=cxe(t,e);if(!n)return e;const i=hae(n,t);return rT(i,i.next),rT(n,n.next)}function cxe(t,e){let n=e;const i=t.x,r=t.y;let s=-1/0,a;if(zw(t,n))return n;do{if(zw(t,n.next))return n.next;if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){const h=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=i&&h>s&&(s=h,a=n.x<n.next.x?n:n.next,h===i))return a}n=n.next}while(n!==e);if(!a)return null;const o=a,c=a.x,l=a.y;let u=1/0;n=a;do{if(i>=n.x&&n.x>=c&&i!==n.x&&lae(r<l?i:s,r,c,l,r<l?s:i,r,n.x,n.y)){const h=Math.abs(r-n.y)/(i-n.x);CM(n,t)&&(h<u||h===u&&(n.x>a.x||n.x===a.x&&lxe(a,n)))&&(a=n,u=h)}n=n.next}while(n!==o);return a}function lxe(t,e){return Ka(t.prev,t,e.prev)<0&&Ka(e.next,t,t.next)<0}function uxe(t,e,n,i){let r=t;do r.z===0&&(r.z=Dj(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,hxe(r)}function hxe(t){let e,n=1;do{let i=t,r;t=null;let s=null;for(e=0;i;){e++;let a=i,o=0;for(let l=0;l<n&&(o++,a=a.nextZ,!!a);l++);let c=n;for(;o>0||c>0&&a;)o!==0&&(c===0||!a||i.z<=a.z)?(r=i,i=i.nextZ,o--):(r=a,a=a.nextZ,c--),s?s.nextZ=r:t=r,r.prevZ=s,s=r;i=a}s.nextZ=null,n*=2}while(e>1);return t}function Dj(t,e,n,i,r){return t=(t-n)*r|0,e=(e-i)*r|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function dxe(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function lae(t,e,n,i,r,s,a,o){return(r-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(i-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(r-a)*(i-o)}function hA(t,e,n,i,r,s,a,o){return!(t===a&&e===o)&&lae(t,e,n,i,r,s,a,o)}function fxe(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!pxe(t,e)&&(CM(t,e)&&CM(e,t)&&mxe(t,e)&&(Ka(t.prev,t,e.prev)||Ka(t,e.prev,e))||zw(t,e)&&Ka(t.prev,t,t.next)>0&&Ka(e.prev,e,e.next)>0)}function Ka(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function zw(t,e){return t.x===e.x&&t.y===e.y}function uae(t,e,n,i){const r=gk(Ka(t,e,n)),s=gk(Ka(t,e,i)),a=gk(Ka(n,i,t)),o=gk(Ka(n,i,e));return!!(r!==s&&a!==o||r===0&&mk(t,n,e)||s===0&&mk(t,i,e)||a===0&&mk(n,t,i)||o===0&&mk(n,e,i))}function mk(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function gk(t){return t>0?1:t<0?-1:0}function pxe(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&uae(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function CM(t,e){return Ka(t.prev,t,t.next)<0?Ka(t,e,t.next)>=0&&Ka(t,t.prev,e)>=0:Ka(t,e,t.prev)<0||Ka(t,t.next,e)<0}function mxe(t,e){let n=t,i=!1;const r=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==t);return i}function hae(t,e){const n=Pj(t.i,t.x,t.y),i=Pj(e.i,e.x,e.y),r=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function WX(t,e,n,i){const r=Pj(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function RM(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Pj(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function gxe(t,e,n,i){let r=0;for(let s=e,a=n-i;s<n;s+=i)r+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return r}class vxe{static triangulate(e,n,i=2){return exe(e,n,i)}}class Yp{static area(e){const n=e.length;let i=0;for(let r=n-1,s=0;s<n;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return Yp.area(e)<0}static triangulateShape(e,n){const i=[],r=[],s=[];YX(e),XX(i,e);let a=e.length;n.forEach(YX);for(let c=0;c<n.length;c++)r.push(a),a+=n[c].length,XX(i,n[c]);const o=vxe.triangulate(i,r);for(let c=0;c<o.length;c+=3)s.push(o.slice(c,c+3));return s}}function YX(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function XX(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class d3 extends Qi{constructor(e=new FS([new Rt(.5,.5),new Rt(-.5,.5),new Rt(-.5,-.5),new Rt(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let o=0,c=e.length;o<c;o++){const l=e[o];a(l)}this.setAttribute("position",new Hn(r,3)),this.setAttribute("uv",new Hn(s,2)),this.computeVertexNormals();function a(o){const c=[],l=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,h=n.depth!==void 0?n.depth:1;let d=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:f-.1,g=n.bevelOffset!==void 0?n.bevelOffset:0,_=n.bevelSegments!==void 0?n.bevelSegments:3;const v=n.extrudePath,E=n.UVGenerator!==void 0?n.UVGenerator:yxe;let T,x=!1,N,A,I,k;v&&(T=v.getSpacedPoints(u),x=!0,d=!1,N=v.computeFrenetFrames(u,!1),A=new Re,I=new Re,k=new Re),d||(_=0,f=0,p=0,g=0);const L=o.extractPoints(l);let U=L.shape;const $=L.holes;if(!Yp.isClockWise(U)){U=U.reverse();for(let fe=0,Fe=$.length;fe<Fe;fe++){const Ie=$[fe];Yp.isClockWise(Ie)&&($[fe]=Ie.reverse())}}function G(fe){const Ie=10000000000000001e-36;let it=fe[0];for(let dt=1;dt<=fe.length;dt++){const gt=dt%fe.length,bt=fe[gt],be=bt.x-it.x,ue=bt.y-it.y,Xe=be*be+ue*ue,nt=Math.max(Math.abs(bt.x),Math.abs(bt.y),Math.abs(it.x),Math.abs(it.y)),$e=Ie*nt*nt;if(Xe<=$e){fe.splice(gt,1),dt--;continue}it=bt}}G(U),$.forEach(G);const X=$.length,ie=U;for(let fe=0;fe<X;fe++){const Fe=$[fe];U=U.concat(Fe)}function V(fe,Fe,Ie){return Fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),fe.clone().addScaledVector(Fe,Ie)}const Z=U.length;function Y(fe,Fe,Ie){let it,dt,gt;const bt=fe.x-Fe.x,be=fe.y-Fe.y,ue=Ie.x-fe.x,Xe=Ie.y-fe.y,nt=bt*bt+be*be,$e=bt*Xe-be*ue;if(Math.abs($e)>Number.EPSILON){const Ue=Math.sqrt(nt),qt=Math.sqrt(ue*ue+Xe*Xe),Mt=Fe.x-be/Ue,Yt=Fe.y+bt/Ue,ce=Ie.x-Xe/qt,j=Ie.y+ue/qt,W=((ce-Mt)*Xe-(j-Yt)*ue)/(bt*Xe-be*ue);it=Mt+bt*W-fe.x,dt=Yt+be*W-fe.y;const me=it*it+dt*dt;if(me<=2)return new Rt(it,dt);gt=Math.sqrt(me/2)}else{let Ue=!1;bt>Number.EPSILON?ue>Number.EPSILON&&(Ue=!0):bt<-Number.EPSILON?ue<-Number.EPSILON&&(Ue=!0):Math.sign(be)===Math.sign(Xe)&&(Ue=!0),Ue?(it=-be,dt=bt,gt=Math.sqrt(nt)):(it=bt,dt=be,gt=Math.sqrt(nt/2))}return new Rt(it/gt,dt/gt)}const ee=[];for(let fe=0,Fe=ie.length,Ie=Fe-1,it=fe+1;fe<Fe;fe++,Ie++,it++)Ie===Fe&&(Ie=0),it===Fe&&(it=0),ee[fe]=Y(ie[fe],ie[Ie],ie[it]);const oe=[];let de,Me=ee.concat();for(let fe=0,Fe=X;fe<Fe;fe++){const Ie=$[fe];de=[];for(let it=0,dt=Ie.length,gt=dt-1,bt=it+1;it<dt;it++,gt++,bt++)gt===dt&&(gt=0),bt===dt&&(bt=0),de[it]=Y(Ie[it],Ie[gt],Ie[bt]);oe.push(de),Me=Me.concat(de)}let He;if(_===0)He=Yp.triangulateShape(ie,$);else{const fe=[],Fe=[];for(let Ie=0;Ie<_;Ie++){const it=Ie/_,dt=f*Math.cos(it*Math.PI/2),gt=p*Math.sin(it*Math.PI/2)+g;for(let bt=0,be=ie.length;bt<be;bt++){const ue=V(ie[bt],ee[bt],gt);St(ue.x,ue.y,-dt),it===0&&fe.push(ue)}for(let bt=0,be=X;bt<be;bt++){const ue=$[bt];de=oe[bt];const Xe=[];for(let nt=0,$e=ue.length;nt<$e;nt++){const Ue=V(ue[nt],de[nt],gt);St(Ue.x,Ue.y,-dt),it===0&&Xe.push(Ue)}it===0&&Fe.push(Xe)}}He=Yp.triangulateShape(fe,Fe)}const Te=He.length,Le=p+g;for(let fe=0;fe<Z;fe++){const Fe=d?V(U[fe],Me[fe],Le):U[fe];x?(I.copy(N.normals[0]).multiplyScalar(Fe.x),A.copy(N.binormals[0]).multiplyScalar(Fe.y),k.copy(T[0]).add(I).add(A),St(k.x,k.y,k.z)):St(Fe.x,Fe.y,0)}for(let fe=1;fe<=u;fe++)for(let Fe=0;Fe<Z;Fe++){const Ie=d?V(U[Fe],Me[Fe],Le):U[Fe];x?(I.copy(N.normals[fe]).multiplyScalar(Ie.x),A.copy(N.binormals[fe]).multiplyScalar(Ie.y),k.copy(T[fe]).add(I).add(A),St(k.x,k.y,k.z)):St(Ie.x,Ie.y,h/u*fe)}for(let fe=_-1;fe>=0;fe--){const Fe=fe/_,Ie=f*Math.cos(Fe*Math.PI/2),it=p*Math.sin(Fe*Math.PI/2)+g;for(let dt=0,gt=ie.length;dt<gt;dt++){const bt=V(ie[dt],ee[dt],it);St(bt.x,bt.y,h+Ie)}for(let dt=0,gt=$.length;dt<gt;dt++){const bt=$[dt];de=oe[dt];for(let be=0,ue=bt.length;be<ue;be++){const Xe=V(bt[be],de[be],it);x?St(Xe.x,Xe.y+T[u-1].y,T[u-1].x+Ie):St(Xe.x,Xe.y,h+Ie)}}}we(),Ce();function we(){const fe=r.length/3;if(d){let Fe=0,Ie=Z*Fe;for(let it=0;it<Te;it++){const dt=He[it];At(dt[2]+Ie,dt[1]+Ie,dt[0]+Ie)}Fe=u+_*2,Ie=Z*Fe;for(let it=0;it<Te;it++){const dt=He[it];At(dt[0]+Ie,dt[1]+Ie,dt[2]+Ie)}}else{for(let Fe=0;Fe<Te;Fe++){const Ie=He[Fe];At(Ie[2],Ie[1],Ie[0])}for(let Fe=0;Fe<Te;Fe++){const Ie=He[Fe];At(Ie[0]+Z*u,Ie[1]+Z*u,Ie[2]+Z*u)}}i.addGroup(fe,r.length/3-fe,0)}function Ce(){const fe=r.length/3;let Fe=0;ke(ie,Fe),Fe+=ie.length;for(let Ie=0,it=$.length;Ie<it;Ie++){const dt=$[Ie];ke(dt,Fe),Fe+=dt.length}i.addGroup(fe,r.length/3-fe,1)}function ke(fe,Fe){let Ie=fe.length;for(;--Ie>=0;){const it=Ie;let dt=Ie-1;dt<0&&(dt=fe.length-1);for(let gt=0,bt=u+_*2;gt<bt;gt++){const be=Z*gt,ue=Z*(gt+1),Xe=Fe+it+be,nt=Fe+dt+be,$e=Fe+dt+ue,Ue=Fe+it+ue;Ee(Xe,nt,$e,Ue)}}}function St(fe,Fe,Ie){c.push(fe),c.push(Fe),c.push(Ie)}function At(fe,Fe,Ie){ye(fe),ye(Fe),ye(Ie);const it=r.length/3,dt=E.generateTopUV(i,r,it-3,it-2,it-1);et(dt[0]),et(dt[1]),et(dt[2])}function Ee(fe,Fe,Ie,it){ye(fe),ye(Fe),ye(it),ye(Fe),ye(Ie),ye(it);const dt=r.length/3,gt=E.generateSideWallUV(i,r,dt-6,dt-3,dt-2,dt-1);et(gt[0]),et(gt[1]),et(gt[3]),et(gt[1]),et(gt[2]),et(gt[3])}function ye(fe){r.push(c[fe*3+0]),r.push(c[fe*3+1]),r.push(c[fe*3+2])}function et(fe){s.push(fe.x),s.push(fe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return _xe(n,i,e)}static fromJSON(e,n){const i=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=n[e.shapes[s]];i.push(o)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new OL[r.type]().fromJSON(r)),new d3(i,e.options)}}const yxe={generateTopUV:function(t,e,n,i,r){const s=e[n*3],a=e[n*3+1],o=e[i*3],c=e[i*3+1],l=e[r*3],u=e[r*3+1];return[new Rt(s,a),new Rt(o,c),new Rt(l,u)]},generateSideWallUV:function(t,e,n,i,r,s){const a=e[n*3],o=e[n*3+1],c=e[n*3+2],l=e[i*3],u=e[i*3+1],h=e[i*3+2],d=e[r*3],f=e[r*3+1],p=e[r*3+2],g=e[s*3],_=e[s*3+1],v=e[s*3+2];return Math.abs(o-u)<Math.abs(a-l)?[new Rt(a,1-c),new Rt(l,1-h),new Rt(d,1-p),new Rt(g,1-v)]:[new Rt(o,1-c),new Rt(u,1-h),new Rt(f,1-p),new Rt(_,1-v)]}};function _xe(t,e,n){if(n.shapes=[],Array.isArray(t))for(let i=0,r=t.length;i<r;i++){const s=t[i];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class f3 extends zb{constructor(e=1,n=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new f3(e.radius,e.detail)}}class p3 extends Qi{constructor(e=[new Rt(0,-.5),new Rt(.5,0),new Rt(0,.5)],n=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:i,phiLength:r},n=Math.floor(n),r=Xi(r,0,Math.PI*2);const s=[],a=[],o=[],c=[],l=[],u=1/n,h=new Re,d=new Rt,f=new Re,p=new Re,g=new Re;let _=0,v=0;for(let E=0;E<=e.length-1;E++)switch(E){case 0:_=e[E+1].x-e[E].x,v=e[E+1].y-e[E].y,f.x=v*1,f.y=-_,f.z=v*0,g.copy(f),f.normalize(),c.push(f.x,f.y,f.z);break;case e.length-1:c.push(g.x,g.y,g.z);break;default:_=e[E+1].x-e[E].x,v=e[E+1].y-e[E].y,f.x=v*1,f.y=-_,f.z=v*0,p.copy(f),f.x+=g.x,f.y+=g.y,f.z+=g.z,f.normalize(),c.push(f.x,f.y,f.z),g.copy(p)}for(let E=0;E<=n;E++){const T=i+E*u*r,x=Math.sin(T),N=Math.cos(T);for(let A=0;A<=e.length-1;A++){h.x=e[A].x*x,h.y=e[A].y,h.z=e[A].x*N,a.push(h.x,h.y,h.z),d.x=E/n,d.y=A/(e.length-1),o.push(d.x,d.y);const I=c[3*A+0]*x,k=c[3*A+1],L=c[3*A+0]*N;l.push(I,k,L)}}for(let E=0;E<n;E++)for(let T=0;T<e.length-1;T++){const x=T+E*e.length,N=x,A=x+e.length,I=x+e.length+1,k=x+1;s.push(N,A,k),s.push(I,k,A)}this.setIndex(s),this.setAttribute("position",new Hn(a,3)),this.setAttribute("uv",new Hn(o,2)),this.setAttribute("normal",new Hn(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new p3(e.points,e.segments,e.phiStart,e.phiLength)}}class tN extends zb{constructor(e=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new tN(e.radius,e.detail)}}class LC extends Qi{constructor(e=1,n=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:i,heightSegments:r};const s=e/2,a=n/2,o=Math.floor(i),c=Math.floor(r),l=o+1,u=c+1,h=e/o,d=n/c,f=[],p=[],g=[],_=[];for(let v=0;v<u;v++){const E=v*d-a;for(let T=0;T<l;T++){const x=T*h-s;p.push(x,-E,0),g.push(0,0,1),_.push(T/o),_.push(1-v/c)}}for(let v=0;v<c;v++)for(let E=0;E<o;E++){const T=E+l*v,x=E+l*(v+1),N=E+1+l*(v+1),A=E+1+l*v;f.push(T,x,A),f.push(x,N,A)}this.setIndex(f),this.setAttribute("position",new Hn(p,3)),this.setAttribute("normal",new Hn(g,3)),this.setAttribute("uv",new Hn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new LC(e.width,e.height,e.widthSegments,e.heightSegments)}}class m3 extends Qi{constructor(e=.5,n=1,i=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);const o=[],c=[],l=[],u=[];let h=e;const d=(n-e)/r,f=new Re,p=new Rt;for(let g=0;g<=r;g++){for(let _=0;_<=i;_++){const v=s+_/i*a;f.x=h*Math.cos(v),f.y=h*Math.sin(v),c.push(f.x,f.y,f.z),l.push(0,0,1),p.x=(f.x/n+1)/2,p.y=(f.y/n+1)/2,u.push(p.x,p.y)}h+=d}for(let g=0;g<r;g++){const _=g*(i+1);for(let v=0;v<i;v++){const E=v+_,T=E,x=E+i+1,N=E+i+2,A=E+1;o.push(T,x,A),o.push(x,N,A)}}this.setIndex(o),this.setAttribute("position",new Hn(c,3)),this.setAttribute("normal",new Hn(l,3)),this.setAttribute("uv",new Hn(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new m3(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class g3 extends Qi{constructor(e=new FS([new Rt(0,.5),new Rt(-.5,-.5),new Rt(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const i=[],r=[],s=[],a=[];let o=0,c=0;if(Array.isArray(e)===!1)l(e);else for(let u=0;u<e.length;u++)l(e[u]),this.addGroup(o,c,u),o+=c,c=0;this.setIndex(i),this.setAttribute("position",new Hn(r,3)),this.setAttribute("normal",new Hn(s,3)),this.setAttribute("uv",new Hn(a,2));function l(u){const h=r.length/3,d=u.extractPoints(n);let f=d.shape;const p=d.holes;Yp.isClockWise(f)===!1&&(f=f.reverse());for(let _=0,v=p.length;_<v;_++){const E=p[_];Yp.isClockWise(E)===!0&&(p[_]=E.reverse())}const g=Yp.triangulateShape(f,p);for(let _=0,v=p.length;_<v;_++){const E=p[_];f=f.concat(E)}for(let _=0,v=f.length;_<v;_++){const E=f[_];r.push(E.x,E.y,0),s.push(0,0,1),a.push(E.x,E.y)}for(let _=0,v=g.length;_<v;_++){const E=g[_],T=E[0]+h,x=E[1]+h,N=E[2]+h;i.push(T,x,N),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return bxe(n,e)}static fromJSON(e,n){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=n[e.shapes[r]];i.push(a)}return new g3(i,e.curveSegments)}}function bxe(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,i=t.length;n<i;n++){const r=t[n];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}class nN extends Qi{constructor(e=1,n=32,i=16,r=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:i,phiStart:r,phiLength:s,thetaStart:a,thetaLength:o},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const c=Math.min(a+o,Math.PI);let l=0;const u=[],h=new Re,d=new Re,f=[],p=[],g=[],_=[];for(let v=0;v<=i;v++){const E=[],T=v/i;let x=0;v===0&&a===0?x=.5/n:v===i&&c===Math.PI&&(x=-.5/n);for(let N=0;N<=n;N++){const A=N/n;h.x=-e*Math.cos(r+A*s)*Math.sin(a+T*o),h.y=e*Math.cos(a+T*o),h.z=e*Math.sin(r+A*s)*Math.sin(a+T*o),p.push(h.x,h.y,h.z),d.copy(h).normalize(),g.push(d.x,d.y,d.z),_.push(A+x,1-T),E.push(l++)}u.push(E)}for(let v=0;v<i;v++)for(let E=0;E<n;E++){const T=u[v][E+1],x=u[v][E],N=u[v+1][E],A=u[v+1][E+1];(v!==0||a>0)&&f.push(T,x,A),(v!==i-1||c<Math.PI)&&f.push(x,N,A)}this.setIndex(f),this.setAttribute("position",new Hn(p,3)),this.setAttribute("normal",new Hn(g,3)),this.setAttribute("uv",new Hn(_,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nN(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class v3 extends zb{constructor(e=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new v3(e.radius,e.detail)}}class y3 extends Qi{constructor(e=1,n=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const a=[],o=[],c=[],l=[],u=new Re,h=new Re,d=new Re;for(let f=0;f<=i;f++)for(let p=0;p<=r;p++){const g=p/r*s,_=f/i*Math.PI*2;h.x=(e+n*Math.cos(_))*Math.cos(g),h.y=(e+n*Math.cos(_))*Math.sin(g),h.z=n*Math.sin(_),o.push(h.x,h.y,h.z),u.x=e*Math.cos(g),u.y=e*Math.sin(g),d.subVectors(h,u).normalize(),c.push(d.x,d.y,d.z),l.push(p/r),l.push(f/i)}for(let f=1;f<=i;f++)for(let p=1;p<=r;p++){const g=(r+1)*f+p-1,_=(r+1)*(f-1)+p-1,v=(r+1)*(f-1)+p,E=(r+1)*f+p;a.push(g,_,E),a.push(_,v,E)}this.setIndex(a),this.setAttribute("position",new Hn(o,3)),this.setAttribute("normal",new Hn(c,3)),this.setAttribute("uv",new Hn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new y3(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class _3 extends Qi{constructor(e=1,n=.4,i=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:i,radialSegments:r,p:s,q:a},i=Math.floor(i),r=Math.floor(r);const o=[],c=[],l=[],u=[],h=new Re,d=new Re,f=new Re,p=new Re,g=new Re,_=new Re,v=new Re;for(let T=0;T<=i;++T){const x=T/i*s*Math.PI*2;E(x,s,a,e,f),E(x+.01,s,a,e,p),_.subVectors(p,f),v.addVectors(p,f),g.crossVectors(_,v),v.crossVectors(g,_),g.normalize(),v.normalize();for(let N=0;N<=r;++N){const A=N/r*Math.PI*2,I=-n*Math.cos(A),k=n*Math.sin(A);h.x=f.x+(I*v.x+k*g.x),h.y=f.y+(I*v.y+k*g.y),h.z=f.z+(I*v.z+k*g.z),c.push(h.x,h.y,h.z),d.subVectors(h,f).normalize(),l.push(d.x,d.y,d.z),u.push(T/i),u.push(N/r)}}for(let T=1;T<=i;T++)for(let x=1;x<=r;x++){const N=(r+1)*(T-1)+(x-1),A=(r+1)*T+(x-1),I=(r+1)*T+x,k=(r+1)*(T-1)+x;o.push(N,A,k),o.push(A,I,k)}this.setIndex(o),this.setAttribute("position",new Hn(c,3)),this.setAttribute("normal",new Hn(l,3)),this.setAttribute("uv",new Hn(u,2));function E(T,x,N,A,I){const k=Math.cos(T),L=Math.sin(T),U=N/x*T,$=Math.cos(U);I.x=A*(2+$)*.5*k,I.y=A*(2+$)*L*.5,I.z=A*Math.sin(U)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _3(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class b3 extends Qi{constructor(e=new Mq(new Re(-1,-1,0),new Re(-1,1,0),new Re(1,1,0)),n=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:i,radialSegments:r,closed:s};const a=e.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new Re,c=new Re,l=new Rt;let u=new Re;const h=[],d=[],f=[],p=[];g(),this.setIndex(p),this.setAttribute("position",new Hn(h,3)),this.setAttribute("normal",new Hn(d,3)),this.setAttribute("uv",new Hn(f,2));function g(){for(let T=0;T<n;T++)_(T);_(s===!1?n:0),E(),v()}function _(T){u=e.getPointAt(T/n,u);const x=a.normals[T],N=a.binormals[T];for(let A=0;A<=r;A++){const I=A/r*Math.PI*2,k=Math.sin(I),L=-Math.cos(I);c.x=L*x.x+k*N.x,c.y=L*x.y+k*N.y,c.z=L*x.z+k*N.z,c.normalize(),d.push(c.x,c.y,c.z),o.x=u.x+i*c.x,o.y=u.y+i*c.y,o.z=u.z+i*c.z,h.push(o.x,o.y,o.z)}}function v(){for(let T=1;T<=n;T++)for(let x=1;x<=r;x++){const N=(r+1)*(T-1)+(x-1),A=(r+1)*T+(x-1),I=(r+1)*T+x,k=(r+1)*(T-1)+x;p.push(N,A,k),p.push(A,I,k)}}function E(){for(let T=0;T<=n;T++)for(let x=0;x<=r;x++)l.x=T/n,l.y=x/r,f.push(l.x,l.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new b3(new OL[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class dae extends Qi{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],i=new Set,r=new Re,s=new Re;if(e.index!==null){const a=e.attributes.position,o=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:o.count,materialIndex:0}]);for(let l=0,u=c.length;l<u;++l){const h=c[l],d=h.start,f=h.count;for(let p=d,g=d+f;p<g;p+=3)for(let _=0;_<3;_++){const v=o.getX(p+_),E=o.getX(p+(_+1)%3);r.fromBufferAttribute(a,v),s.fromBufferAttribute(a,E),KX(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,c=a.count/3;o<c;o++)for(let l=0;l<3;l++){const u=3*o+l,h=3*o+(l+1)%3;r.fromBufferAttribute(a,u),s.fromBufferAttribute(a,h),KX(r,s,i)===!0&&(n.push(r.x,r.y,r.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new Hn(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function KX(t,e,n){const i=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(i)===!0||n.has(r)===!0?!1:(n.add(i),n.add(r),!0)}var JX=Object.freeze({__proto__:null,BoxGeometry:PT,CapsuleGeometry:c3,CircleGeometry:l3,ConeGeometry:eN,CylinderGeometry:QO,DodecahedronGeometry:u3,EdgesGeometry:nae,ExtrudeGeometry:d3,IcosahedronGeometry:f3,LatheGeometry:p3,OctahedronGeometry:tN,PlaneGeometry:LC,PolyhedronGeometry:zb,RingGeometry:m3,ShapeGeometry:g3,SphereGeometry:nN,TetrahedronGeometry:v3,TorusGeometry:y3,TorusKnotGeometry:_3,TubeGeometry:b3,WireframeGeometry:dae});class fae extends yl{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new _n(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class pae extends Bc{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Nq extends yl{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new _n(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _n(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $h,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class mae extends Nq{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Rt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Xi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new _n(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new _n(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new _n(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class gae extends yl{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new _n(16777215),this.specular=new _n(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _n(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $h,this.combine=WO,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class vae extends yl{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new _n(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _n(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Iq extends yl{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class yae extends yl{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new _n(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new _n(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $h,this.combine=WO,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class kq extends yl{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Ub,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Dq extends yl{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class _ae extends yl{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new _n(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Bb,this.normalScale=new Rt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bae extends th{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function IS(t,e){return!t||t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function Eae(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Sae(t){function e(r,s){return t[r]-t[s]}const n=t.length,i=new Array(n);for(let r=0;r!==n;++r)i[r]=r;return i.sort(e),i}function Lj(t,e,n){const i=t.length,r=new t.constructor(i);for(let s=0,a=0;a!==i;++s){const o=n[s]*e;for(let c=0;c!==e;++c)r[a++]=t[o+c]}return r}function Pq(t,e,n,i){let r=1,s=t[0];for(;s!==void 0&&s[i]===void 0;)s=t[r++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),n.push(...a)),s=t[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(n,n.length)),s=t[r++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),n.push(a)),s=t[r++];while(s!==void 0)}function Exe(t,e,n,i,r=30){const s=t.clone();s.name=e;const a=[];for(let c=0;c<s.tracks.length;++c){const l=s.tracks[c],u=l.getValueSize(),h=[],d=[];for(let f=0;f<l.times.length;++f){const p=l.times[f]*r;if(!(p<n||p>=i)){h.push(l.times[f]);for(let g=0;g<u;++g)d.push(l.values[f*u+g])}}h.length!==0&&(l.times=IS(h,l.times.constructor),l.values=IS(d,l.values.constructor),a.push(l))}s.tracks=a;let o=1/0;for(let c=0;c<s.tracks.length;++c)o>s.tracks[c].times[0]&&(o=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*o);return s.resetDuration(),s}function Sxe(t,e=0,n=t,i=30){i<=0&&(i=30);const r=n.tracks.length,s=e/i;for(let a=0;a<r;++a){const o=n.tracks[a],c=o.ValueTypeName;if(c==="bool"||c==="string")continue;const l=t.tracks.find(function(v){return v.name===o.name&&v.ValueTypeName===c});if(l===void 0)continue;let u=0;const h=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=h/3);let d=0;const f=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=f/3);const p=o.times.length-1;let g;if(s<=o.times[0]){const v=u,E=h-u;g=o.values.slice(v,E)}else if(s>=o.times[p]){const v=p*h+u,E=v+h-u;g=o.values.slice(v,E)}else{const v=o.createInterpolant(),E=u,T=h-u;v.evaluate(s),g=v.resultBuffer.slice(E,T)}c==="quaternion"&&new jh().fromArray(g).normalize().conjugate().toArray(g);const _=l.times.length;for(let v=0;v<_;++v){const E=v*f+d;if(c==="quaternion")jh.multiplyQuaternionsFlat(l.values,E,g,0,l.values,E);else{const T=f-d*2;for(let x=0;x<T;++x)l.values[E+x]-=g[x]}}}return t.blendMode=vq,t}class Txe{static convertArray(e,n){return IS(e,n)}static isTypedArray(e){return Eae(e)}static getKeyframeOrder(e){return Sae(e)}static sortedArray(e,n,i){return Lj(e,n,i)}static flattenJSON(e,n,i,r){Pq(e,n,i,r)}static subclip(e,n,i,r,s=30){return Exe(e,n,i,r,s)}static makeClipAdditive(e,n=0,i=e,r=30){return Sxe(e,n,i,r)}}class iN{constructor(e,n,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let i=this._cachedIndex,r=n[i],s=n[i-1];e:{t:{let a;n:{i:if(!(e<r)){for(let o=i+2;;){if(r===void 0){if(e<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=r,r=n[++i],e<r)break t}a=n.length;break n}if(!(e>=s)){const o=n[1];e<o&&(i=2,s=o);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=n[--i-1],e>=s)break t}a=i,i=0;break n}break e}for(;i<a;){const o=i+a>>>1;e<n[o]?a=o:i=o+1}if(r=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)n[a]=i[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Tae extends iN{constructor(e,n,i,r){super(e,n,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:OS,endingEnd:OS}}intervalChanged_(e,n,i){const r=this.parameterPositions;let s=e-2,a=e+1,o=r[s],c=r[a];if(o===void 0)switch(this.getSettings_().endingStart){case NS:s=e,o=2*n-i;break;case bM:s=r.length-2,o=n+r[s]-r[s+1];break;default:s=e,o=i}if(c===void 0)switch(this.getSettings_().endingEnd){case NS:a=e,c=2*i-n;break;case bM:a=1,c=i+r[1]-r[0];break;default:a=e-1,c=n}const l=(i-n)*.5,u=this.valueSize;this._weightPrev=l/(n-o),this._weightNext=l/(c-i),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=this._offsetPrev,h=this._offsetNext,d=this._weightPrev,f=this._weightNext,p=(i-n)/(r-n),g=p*p,_=g*p,v=-d*_+2*d*g-d*p,E=(1+d)*_+(-1.5-2*d)*g+(-.5+d)*p+1,T=(-1-f)*_+(1.5+f)*g+.5*p,x=f*_-f*g;for(let N=0;N!==o;++N)s[N]=v*a[u+N]+E*a[l+N]+T*a[c+N]+x*a[h+N];return s}}class Lq extends iN{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=e*o,l=c-o,u=(i-n)/(r-n),h=1-u;for(let d=0;d!==o;++d)s[d]=a[l+d]*h+a[c+d]*u;return s}}class xae extends iN{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class cp{constructor(e,n,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=IS(n,this.TimeBufferType),this.values=IS(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(e);else{i={name:e.name,times:IS(e.times,Array),values:IS(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new xae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Lq(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Tae(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case _M:n=this.InterpolantFactoryMethodDiscrete;break;case RL:n=this.InterpolantFactoryMethodLinear;break;case DD:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return _M;case this.InterpolantFactoryMethodLinear:return RL;case this.InterpolantFactoryMethodSmooth:return DD}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let i=0,r=n.length;i!==r;++i)n[i]*=e}return this}trim(e,n){const i=this.times,r=i.length;let s=0,a=r-1;for(;s!==r&&i[s]<e;)++s;for(;a!==-1&&i[a]>n;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=i.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const c=i[o];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,c),e=!1;break}if(a!==null&&a>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,c,a),e=!1;break}a=c}if(r!==void 0&&Eae(r))for(let o=0,c=r.length;o!==c;++o){const l=r[o];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,l),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===DD,s=e.length-1;let a=1;for(let o=1;o<s;++o){let c=!1;const l=e[o],u=e[o+1];if(l!==u&&(o!==1||l!==e[0]))if(r)c=!0;else{const h=o*i,d=h-i,f=h+i;for(let p=0;p!==i;++p){const g=n[h+p];if(g!==n[d+p]||g!==n[f+p]){c=!0;break}}}if(c){if(o!==a){e[a]=e[o];const h=o*i,d=a*i;for(let f=0;f!==i;++f)n[d+f]=n[h+f]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,c=a*i,l=0;l!==i;++l)n[c+l]=n[o+l];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*i)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),i=this.constructor,r=new i(this.name,e,n);return r.createInterpolant=this.createInterpolant,r}}cp.prototype.ValueTypeName="";cp.prototype.TimeBufferType=Float32Array;cp.prototype.ValueBufferType=Float32Array;cp.prototype.DefaultInterpolation=RL;class LT extends cp{constructor(e,n,i){super(e,n,i)}}LT.prototype.ValueTypeName="bool";LT.prototype.ValueBufferType=Array;LT.prototype.DefaultInterpolation=_M;LT.prototype.InterpolantFactoryMethodLinear=void 0;LT.prototype.InterpolantFactoryMethodSmooth=void 0;class Uq extends cp{constructor(e,n,i,r){super(e,n,i,r)}}Uq.prototype.ValueTypeName="color";class AM extends cp{constructor(e,n,i,r){super(e,n,i,r)}}AM.prototype.ValueTypeName="number";class wae extends iN{constructor(e,n,i,r){super(e,n,i,r)}interpolate_(e,n,i,r){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,c=(i-n)/(r-n);let l=e*o;for(let u=l+o;l!==u;l+=4)jh.slerpFlat(s,0,a,l-o,a,l,c);return s}}class rN extends cp{constructor(e,n,i,r){super(e,n,i,r)}InterpolantFactoryMethodLinear(e){return new wae(this.times,this.values,this.getValueSize(),e)}}rN.prototype.ValueTypeName="quaternion";rN.prototype.InterpolantFactoryMethodSmooth=void 0;class UT extends cp{constructor(e,n,i){super(e,n,i)}}UT.prototype.ValueTypeName="string";UT.prototype.ValueBufferType=Array;UT.prototype.DefaultInterpolation=_M;UT.prototype.InterpolantFactoryMethodLinear=void 0;UT.prototype.InterpolantFactoryMethodSmooth=void 0;class MM extends cp{constructor(e,n,i,r){super(e,n,i,r)}}MM.prototype.ValueTypeName="vector";class OM{constructor(e="",n=-1,i=[],r=QU){this.name=e,this.tracks=i,this.duration=n,this.blendMode=r,this.uuid=zd(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],i=e.tracks,r=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)n.push(wxe(i[a]).scale(r));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)n.push(cp.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,n,i,r){const s=n.length,a=[];for(let o=0;o<s;o++){let c=[],l=[];c.push((o+s-1)%s,o,(o+1)%s),l.push(0,1,0);const u=Sae(c);c=Lj(c,1,u),l=Lj(l,1,u),!r&&c[0]===0&&(c.push(s),l.push(l[0])),a.push(new AM(".morphTargetInfluences["+n[o].name+"]",c,l).scale(1/i))}return new this(e,-1,a)}static findByName(e,n){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===n)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,n,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,c=e.length;o<c;o++){const l=e[o],u=l.name.match(s);if(u&&u.length>1){const h=u[1];let d=r[h];d||(r[h]=d=[]),d.push(l)}}const a=[];for(const o in r)a.push(this.CreateFromMorphTargetSequence(o,r[o],n,i));return a}static parseAnimation(e,n){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,d,f,p,g){if(f.length!==0){const _=[],v=[];Pq(f,_,v,p),_.length!==0&&g.push(new h(d,_,v))}},r=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let c=e.length||-1;const l=e.hierarchy||[];for(let h=0;h<l.length;h++){const d=l[h].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const f={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let g=0;g<d[p].morphTargets.length;g++)f[d[p].morphTargets[g]]=-1;for(const g in f){const _=[],v=[];for(let E=0;E!==d[p].morphTargets.length;++E){const T=d[p];_.push(T.time),v.push(T.morphTarget===g?1:0)}r.push(new AM(".morphTargetInfluence["+g+"]",_,v))}c=f.length*a}else{const f=".bones["+n[h].name+"]";i(MM,f+".position",d,"pos",r),i(rN,f+".quaternion",d,"rot",r),i(MM,f+".scale",d,"scl",r)}}return r.length===0?null:new this(s,c,r,o)}resetDuration(){const e=this.tracks;let n=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function xxe(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return AM;case"vector":case"vector2":case"vector3":case"vector4":return MM;case"color":return Uq;case"quaternion":return rN;case"bool":case"boolean":return LT;case"string":return UT}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function wxe(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=xxe(t.type);if(t.times===void 0){const n=[],i=[];Pq(t.keys,n,i,"value"),t.times=n,t.values=i}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const Ov={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class Bq{constructor(e,n,i){const r=this;let s=!1,a=0,o=0,c;const l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=i,this.itemStart=function(u){o++,s===!1&&r.onStart!==void 0&&r.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,r.onProgress!==void 0&&r.onProgress(u,a,o),a===o&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(u){r.onError!==void 0&&r.onError(u)},this.resolveURL=function(u){return c?c(u):u},this.setURLModifier=function(u){return c=u,this},this.addHandler=function(u,h){return l.push(u,h),this},this.removeHandler=function(u){const h=l.indexOf(u);return h!==-1&&l.splice(h,2),this},this.getHandler=function(u){for(let h=0,d=l.length;h<d;h+=2){const f=l[h],p=l[h+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const Cae=new Bq;class nd{constructor(e){this.manager=e!==void 0?e:Cae,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const i=this;return new Promise(function(r,s){i.load(e,r,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}nd.DEFAULT_MATERIAL_NAME="__DEFAULT";const ov={};class Cxe extends Error{constructor(e,n){super(e),this.response=n}}class Kv extends nd{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Ov.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(ov[e]!==void 0){ov[e].push({onLoad:n,onProgress:i,onError:r});return}ov[e]=[],ov[e].push({onLoad:n,onProgress:i,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,c=this.responseType;fetch(a).then(l=>{if(l.status===200||l.status===0){if(l.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||l.body===void 0||l.body.getReader===void 0)return l;const u=ov[e],h=l.body.getReader(),d=l.headers.get("X-File-Size")||l.headers.get("Content-Length"),f=d?parseInt(d):0,p=f!==0;let g=0;const _=new ReadableStream({start(v){E();function E(){h.read().then(({done:T,value:x})=>{if(T)v.close();else{g+=x.byteLength;const N=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:f});for(let A=0,I=u.length;A<I;A++){const k=u[A];k.onProgress&&k.onProgress(N)}v.enqueue(x),E()}},T=>{v.error(T)})}}});return new Response(_)}else throw new Cxe(`fetch for "${l.url}" responded with ${l.status}: ${l.statusText}`,l)}).then(l=>{switch(c){case"arraybuffer":return l.arrayBuffer();case"blob":return l.blob();case"document":return l.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return l.json();default:if(o==="")return l.text();{const h=/charset="?([^;"\s]*)"?/i.exec(o),d=h&&h[1]?h[1].toLowerCase():void 0,f=new TextDecoder(d);return l.arrayBuffer().then(p=>f.decode(p))}}}).then(l=>{Ov.add(e,l);const u=ov[e];delete ov[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onLoad&&f.onLoad(l)}}).catch(l=>{const u=ov[e];if(u===void 0)throw this.manager.itemError(e),l;delete ov[e];for(let h=0,d=u.length;h<d;h++){const f=u[h];f.onError&&f.onError(l)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Rxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Kv(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=[];for(let i=0;i<e.length;i++){const r=OM.parse(e[i]);n.push(r)}return n}}class Axe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=[],o=new o3,c=new Kv(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let l=0;function u(h){c.load(e[h],function(d){const f=s.parse(d,!0);a[h]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},l+=1,l===6&&(f.mipmapCount===1&&(o.minFilter=_a),o.image=a,o.format=f.format,o.needsUpdate=!0,n&&n(o))},i,r)}if(Array.isArray(e))for(let h=0,d=e.length;h<d;++h)u(h);else c.load(e,function(h){const d=s.parse(h,!0);if(d.isCubemap){const f=d.mipmaps.length/d.mipmapCount;for(let p=0;p<f;p++){a[p]={mipmaps:[]};for(let g=0;g<d.mipmapCount;g++)a[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+g]),a[p].format=d.format,a[p].width=d.width,a[p].height=d.height}o.image=a}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=_a),o.format=d.format,o.needsUpdate=!0,n&&n(o)},i,r);return o}}class NM extends nd{constructor(e){super(e)}load(e,n,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Ov.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=xM("img");function c(){u(),Ov.add(e,this),n&&n(this),s.manager.itemEnd(e)}function l(h){u(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",c,!1),o.removeEventListener("error",l,!1)}return o.addEventListener("load",c,!1),o.addEventListener("error",l,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class Mxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=new ZO;s.colorSpace=ya;const a=new NM(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function c(l){a.load(e[l],function(u){s.images[l]=u,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,r)}for(let l=0;l<e.length;++l)c(l);return s}}class Oxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Xf,o=new Kv(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(c){let l;try{l=s.parse(c)}catch(u){if(r!==void 0)r(u);else{console.error(u);return}}l.image!==void 0?a.image=l.image:l.data!==void 0&&(a.image.width=l.width,a.image.height=l.height,a.image.data=l.data),a.wrapS=l.wrapS!==void 0?l.wrapS:Hf,a.wrapT=l.wrapT!==void 0?l.wrapT:Hf,a.magFilter=l.magFilter!==void 0?l.magFilter:_a,a.minFilter=l.minFilter!==void 0?l.minFilter:_a,a.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.colorSpace!==void 0&&(a.colorSpace=l.colorSpace),l.flipY!==void 0&&(a.flipY=l.flipY),l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.mipmaps!==void 0&&(a.mipmaps=l.mipmaps,a.minFilter=gg),l.mipmapCount===1&&(a.minFilter=_a),l.generateMipmaps!==void 0&&(a.generateMipmaps=l.generateMipmaps),a.needsUpdate=!0,n&&n(a,l)},i,r),a}}class Nxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=new Pa,a=new NM(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,n!==void 0&&n(s)},i,r),s}}class Hb extends Gr{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new _n(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(n.object.target=this.target.uuid),n}}class Rae extends Hb{constructor(e,n,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Gr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new _n(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const Fz=new Ni,ZX=new Re,QX=new Re;class Fq{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Rt(512,512),this.mapType=ml,this.map=null,this.mapPass=null,this.matrix=new Ni,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new DC,this._frameExtents=new Rt(1,1),this._viewportCount=1,this._viewports=[new Kr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,i=this.matrix;ZX.setFromMatrixPosition(e.matrixWorld),n.position.copy(ZX),QX.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(QX),n.updateMatrixWorld(),Fz.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Fz),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Fz)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Ixe extends Fq{constructor(){super(new Ic(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,i=Pw*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(i!==n.fov||r!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=r,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Aae extends Hb{constructor(e,n,i=0,r=Math.PI/3,s=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Gr.DEFAULT_UP),this.updateMatrix(),this.target=new Gr,this.distance=i,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Ixe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const eK=new Ni,UR=new Re,zz=new Re;class kxe extends Fq{constructor(){super(new Ic(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Rt(4,2),this._viewportCount=6,this._viewports=[new Kr(2,1,1,1),new Kr(0,1,1,1),new Kr(3,1,1,1),new Kr(1,1,1,1),new Kr(3,0,1,1),new Kr(1,0,1,1)],this._cubeDirections=[new Re(1,0,0),new Re(-1,0,0),new Re(0,0,1),new Re(0,0,-1),new Re(0,1,0),new Re(0,-1,0)],this._cubeUps=[new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,1,0),new Re(0,0,1),new Re(0,0,-1)]}updateMatrices(e,n=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),UR.setFromMatrixPosition(e.matrixWorld),i.position.copy(UR),zz.copy(i.position),zz.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(zz),i.updateMatrixWorld(),r.makeTranslation(-UR.x,-UR.y,-UR.z),eK.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(eK)}}class Mae extends Hb{constructor(e,n,i=0,r=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new kxe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let sN=class extends JO{constructor(e=-1,n=1,i=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=i,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,i,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=r+n,c=r-n;if(this.view!==null&&this.view.enabled){const l=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=l*this.view.offsetX,a=s+l*this.view.width,o-=u*this.view.offsetY,c=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}};class Dxe extends Fq{constructor(){super(new sN(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Oae extends Hb{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Gr.DEFAULT_UP),this.updateMatrix(),this.target=new Gr,this.shadow=new Dxe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Nae extends Hb{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Iae extends Hb{constructor(e,n,i=10,r=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class kae{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Re)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*r),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*i),n.addScaledVector(a[4],1.092548*(i*r)),n.addScaledVector(a[5],1.092548*(r*s)),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],1.092548*(i*s)),n.addScaledVector(a[8],.546274*(i*i-r*r)),n}getIrradianceAt(e,n){const i=e.x,r=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*r),n.addScaledVector(a[2],2*.511664*s),n.addScaledVector(a[3],2*.511664*i),n.addScaledVector(a[4],2*.429043*i*r),n.addScaledVector(a[5],2*.429043*r*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],2*.429043*i*s),n.addScaledVector(a[8],.429043*(i*i-r*r)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,n+r*3);return this}toArray(e=[],n=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,n+r*3);return e}static getBasisAt(e,n){const i=e.x,r=e.y,s=e.z;n[0]=.282095,n[1]=.488603*r,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*r,n[5]=1.092548*r*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-r*r)}}class Dae extends Hb{constructor(e=new kae,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class E3 extends nd{constructor(e){super(e),this.textures={}}load(e,n,i,r){const s=this,a=new Kv(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new _n().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=i(a.value);break;case"c":r.uniforms[s].value=new _n().setHex(a.value);break;case"v2":r.uniforms[s].value=new Rt().fromArray(a.value);break;case"v3":r.uniforms[s].value=new Re().fromArray(a.value);break;case"v4":r.uniforms[s].value=new Kr().fromArray(a.value);break;case"m3":r.uniforms[s].value=new Zi().fromArray(a.value);break;case"m4":r.uniforms[s].value=new Ni().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new Rt().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Rt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return E3.createMaterialFromType(e)}static createMaterialFromType(e){const n={ShadowMaterial:fae,SpriteMaterial:Sq,RawShaderMaterial:pae,ShaderMaterial:Bc,PointsMaterial:xq,MeshPhysicalMaterial:mae,MeshStandardMaterial:Nq,MeshPhongMaterial:gae,MeshToonMaterial:vae,MeshNormalMaterial:Iq,MeshLambertMaterial:yae,MeshDepthMaterial:kq,MeshDistanceMaterial:Dq,MeshBasicMaterial:Fb,MeshMatcapMaterial:_ae,LineDashedMaterial:bae,LineBasicMaterial:th,Material:yl};return new n[e]}}class Uj{static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class Pae extends Qi{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class Lae extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Kv(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const n={},i={};function r(f,p){if(n[p]!==void 0)return n[p];const _=f.interleavedBuffers[p],v=s(f,_.buffer),E=O1(_.type,v),T=new r3(E,_.stride);return T.uuid=_.uuid,n[p]=T,T}function s(f,p){if(i[p]!==void 0)return i[p];const _=f.arrayBuffers[p],v=new Uint32Array(_).buffer;return i[p]=v,v}const a=e.isInstancedBufferGeometry?new Pae:new Qi,o=e.data.index;if(o!==void 0){const f=O1(o.type,o.array);a.setIndex(new rr(f,1))}const c=e.data.attributes;for(const f in c){const p=c[f];let g;if(p.isInterleavedBufferAttribute){const _=r(e.data,p.data);g=new iT(_,p.itemSize,p.offset,p.normalized)}else{const _=O1(p.type,p.array),v=p.isInstancedBufferAttribute?Fw:rr;g=new v(_,p.itemSize,p.normalized)}p.name!==void 0&&(g.name=p.name),p.usage!==void 0&&g.setUsage(p.usage),a.setAttribute(f,g)}const l=e.data.morphAttributes;if(l)for(const f in l){const p=l[f],g=[];for(let _=0,v=p.length;_<v;_++){const E=p[_];let T;if(E.isInterleavedBufferAttribute){const x=r(e.data,E.data);T=new iT(x,E.itemSize,E.offset,E.normalized)}else{const x=O1(E.type,E.array);T=new rr(x,E.itemSize,E.normalized)}E.name!==void 0&&(T.name=E.name),g.push(T)}a.morphAttributes[f]=g}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let f=0,p=h.length;f!==p;++f){const g=h[f];a.addGroup(g.start,g.count,g.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const f=new Re;d.center!==void 0&&f.fromArray(d.center),a.boundingSphere=new Dl(f,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class Pxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=this.path===""?Uj.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new Kv(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){let l=null;try{l=JSON.parse(c)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const u=l.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(l,n)},i,r)}async loadAsync(e,n){const i=this,r=this.path===""?Uj.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Kv(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,n),o=JSON.parse(a),c=o.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(o)}parse(e,n){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){n!==void 0&&n(l)}),o=this.parseTextures(e.textures,a),c=this.parseMaterials(e.materials,o),l=this.parseObject(e.object,s,c,o,i),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),this.bindLightTargets(l),n!==void 0){let h=!1;for(const d in a)if(a[d].data instanceof HTMLImageElement){h=!0;break}h===!1&&n(l)}return l}async parseAsync(e){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),c=this.parseObject(e.object,r,o,a,n),l=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,l),this.bindLightTargets(c),c}parseShapes(e){const n={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new FS().fromJSON(e[i]);n[s.uuid]=s}return n}parseSkeletons(e,n){const i={},r={};if(n.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new s3().fromJSON(e[s],r);i[o.uuid]=o}return i}parseGeometries(e,n){const i={};if(e!==void 0){const r=new Lae;for(let s=0,a=e.length;s<a;s++){let o;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":o=r.parse(c);break;default:c.type in JX?o=JX[c.type].fromJSON(c,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}o.uuid=c.uuid,c.name!==void 0&&(o.name=c.name),c.userData!==void 0&&(o.userData=c.userData),i[c.uuid]=o}}return i}parseMaterials(e,n){const i={},r={};if(e!==void 0){const s=new E3;s.setTextures(n);for(let a=0,o=e.length;a<o;a++){const c=e[a];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const n={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=OM.parse(r);n[s.uuid]=s}return n}parseImages(e,n){const i=this,r={};let s;function a(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function o(c){if(typeof c=="string"){const l=c,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(l)?l:i.resourcePath+l;return a(u)}else return c.data?{data:O1(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new Bq(n);s=new NM(c),s.setCrossOrigin(this.crossOrigin);for(let l=0,u=e.length;l<u;l++){const h=e[l],d=h.url;if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const _=d[p],v=o(_);v!==null&&(v instanceof HTMLImageElement?f.push(v):f.push(new Xf(v.data,v.width,v.height)))}r[h.uuid]=new V_(f)}else{const f=o(h.url);r[h.uuid]=new V_(f)}}}return r}async parseImagesAsync(e){const n=this,i={};let r;async function s(a){if(typeof a=="string"){const o=a,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:n.resourcePath+o;return await r.loadAsync(c)}else return a.data?{data:O1(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new NM(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const c=e[a],l=c.url;if(Array.isArray(l)){const u=[];for(let h=0,d=l.length;h<d;h++){const f=l[h],p=await s(f);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Xf(p.data,p.width,p.height)))}i[c.uuid]=new V_(u)}else{const u=await s(c.url);i[c.uuid]=new V_(u)}}}return i}parseTextures(e,n){function i(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const c=n[o.image],l=c.data;let u;Array.isArray(l)?(u=new ZO,l.length===6&&(u.needsUpdate=!0)):(l&&l.data?u=new Xf:u=new Pa,l&&(u.needsUpdate=!0)),u.source=c,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=i(o.mapping,Lxe)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=i(o.wrap[0],tK),u.wrapT=i(o.wrap[1],tK)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=i(o.minFilter,nK)),o.magFilter!==void 0&&(u.magFilter=i(o.magFilter,nK)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),r[o.uuid]=u}return r}parseObject(e,n,i,r,s){let a;function o(d){return n[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),n[d]}function c(d){if(d!==void 0){if(Array.isArray(d)){const f=[];for(let p=0,g=d.length;p<g;p++){const _=d[p];i[_]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",_),f.push(i[_])}return f}return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),i[d]}}function l(d){return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),r[d]}let u,h;switch(e.type){case"Scene":a=new Bw,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new _n(e.background):a.background=l(e.background)),e.environment!==void 0&&(a.environment=l(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new i3(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new n3(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Ic(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new sN(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Nae(e.color,e.intensity);break;case"DirectionalLight":a=new Oae(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new Mae(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Iae(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Aae(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new Rae(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new Dae().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),h=c(e.material),a=new Xse(u,h),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),h=c(e.material),a=new Bo(u,h);break;case"InstancedMesh":u=o(e.geometry),h=c(e.material);const d=e.count,f=e.instanceMatrix,p=e.instanceColor;a=new Kse(u,h,d),a.instanceMatrix=new Fw(new Float32Array(f.array),16),p!==void 0&&(a.instanceColor=new Fw(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),h=c(e.material),a=new Jse(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,h),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(g=>{let _=null,v=null;return g.boundingBox!==void 0&&(_=new cu,_.min.fromArray(g.boundingBox.min),_.max.fromArray(g.boundingBox.max)),g.boundingSphere!==void 0&&(v=new Dl,v.radius=g.boundingSphere.radius,v.center.fromArray(g.boundingSphere.center)),{...g,boundingBox:_,boundingSphere:v}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=l(e.matricesTexture.uuid),a._indirectTexture=l(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=l(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Dl,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new cu,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new Yse;break;case"Line":a=new yb(o(e.geometry),c(e.material));break;case"LineLoop":a=new Zse(o(e.geometry),c(e.material));break;case"LineSegments":a=new Yg(o(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new Qse(o(e.geometry),c(e.material));break;case"Sprite":a=new Wse(c(e.material));break;case"Group":a=new N1;break;case"Bone":a=new Tq;break;default:a=new Gr}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let f=0;f<d.length;f++)a.add(this.parseObject(d[f],n,i,r,s))}if(e.animations!==void 0){const d=e.animations;for(let f=0;f<d.length;f++){const p=d[f];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const d=e.levels;for(let f=0;f<d.length;f++){const p=d[f],g=a.getObjectByProperty("uuid",p.object);g!==void 0&&a.addLevel(g,p.distance,p.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=n[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}bindLightTargets(e){e.traverse(function(n){if(n.isDirectionalLight||n.isSpotLight){const i=n.target,r=e.getObjectByProperty("uuid",i);r!==void 0?n.target=r:n.target=new Gr}})}}const Lxe={UVMapping:WU,CubeReflectionMapping:Xv,CubeRefractionMapping:vb,EquirectangularReflectionMapping:mM,EquirectangularRefractionMapping:gM,CubeUVReflectionMapping:IC},tK={RepeatWrapping:vM,ClampToEdgeWrapping:Hf,MirroredRepeatWrapping:yM},nK={NearestFilter:Za,NearestMipmapNearestFilter:lq,NearestMipmapLinearFilter:M1,LinearFilter:_a,LinearMipmapNearestFilter:RA,LinearMipmapLinearFilter:gg};class Uxe extends nd{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Ov.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(l=>{n&&n(l),s.manager.itemEnd(e)}).catch(l=>{r&&r(l)});return}return setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const c=fetch(e,o).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(l){return Ov.add(e,l),n&&n(l),s.manager.itemEnd(e),l}).catch(function(l){r&&r(l),Ov.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Ov.add(e,c),s.manager.itemStart(e)}}let vk,zq=class{static getContext(){return vk===void 0&&(vk=new(window.AudioContext||window.webkitAudioContext)),vk}static setContext(e){vk=e}};class Bxe extends nd{constructor(e){super(e)}load(e,n,i,r){const s=this,a=new Kv(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{const l=c.slice(0);zq.getContext().decodeAudioData(l,function(h){n(h)}).catch(o)}catch(l){o(l)}},i,r);function o(c){r?r(c):console.error(c),s.manager.itemError(e)}}}const iK=new Ni,rK=new Ni,XE=new Ni;class Fxe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ic,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ic,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,XE.copy(e.projectionMatrix);const r=n.eyeSep/2,s=r*n.near/n.focus,a=n.near*Math.tan(BS*n.fov*.5)/n.zoom;let o,c;rK.elements[12]=-r,iK.elements[12]=r,o=-a*n.aspect+s,c=a*n.aspect+s,XE.elements[0]=2*n.near/(c-o),XE.elements[8]=(c+o)/(c-o),this.cameraL.projectionMatrix.copy(XE),o=-a*n.aspect-s,c=a*n.aspect-s,XE.elements[0]=2*n.near/(c-o),XE.elements[8]=(c+o)/(c-o),this.cameraR.projectionMatrix.copy(XE)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(rK),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(iK)}}class Uae extends Ic{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let Hq=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=sK(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=sK();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}};function sK(){return performance.now()}const KE=new Re,aK=new jh,zxe=new Re,JE=new Re;class Hxe extends Gr{constructor(){super(),this.type="AudioListener",this.context=zq.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Hq}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(KE,aK,zxe),JE.set(0,0,-1).applyQuaternion(aK),n.positionX){const r=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(KE.x,r),n.positionY.linearRampToValueAtTime(KE.y,r),n.positionZ.linearRampToValueAtTime(KE.z,r),n.forwardX.linearRampToValueAtTime(JE.x,r),n.forwardY.linearRampToValueAtTime(JE.y,r),n.forwardZ.linearRampToValueAtTime(JE.z,r),n.upX.linearRampToValueAtTime(i.x,r),n.upY.linearRampToValueAtTime(i.y,r),n.upZ.linearRampToValueAtTime(i.z,r)}else n.setPosition(KE.x,KE.y,KE.z),n.setOrientation(JE.x,JE.y,JE.z,i.x,i.y,i.z)}}class Bae extends Gr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,n){return super.copy(e,n),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const ZE=new Re,oK=new jh,jxe=new Re,QE=new Re;class Vxe extends Bae{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ZE,oK,jxe),QE.set(0,0,1).applyQuaternion(oK);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(ZE.x,i),n.positionY.linearRampToValueAtTime(ZE.y,i),n.positionZ.linearRampToValueAtTime(ZE.z,i),n.orientationX.linearRampToValueAtTime(QE.x,i),n.orientationY.linearRampToValueAtTime(QE.y,i),n.orientationZ.linearRampToValueAtTime(QE.z,i)}else n.setPosition(ZE.x,ZE.y,ZE.z),n.setOrientation(QE.x,QE.y,QE.z)}}class Gxe{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)e+=n[i];return e/n.length}}class Fae{constructor(e,n,i){this.binding=e,this.valueSize=i;let r,s,a;switch(n){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const i=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==r;++o)i[s+o]=i[o];a=n}else{a+=n;const o=n/a;this._mixBufferRegion(i,s,0,o,r)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,i=this.buffer,r=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=n*this._origIndex;this._mixBufferRegion(i,r,c,1-s,n)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*n,1,n);for(let c=n,l=n+n;c!==l;++c)if(i[c]!==i[c+n]){o.setValue(i,r);break}}saveOriginalState(){const e=this.binding,n=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(n,r);for(let s=i,a=r;s!==a;++s)n[s]=n[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let i=e;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[e+i]}_select(e,n,i,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[n+a]=e[i+a]}_slerp(e,n,i,r){jh.slerpFlat(e,n,e,n,e,i,r)}_slerpAdditive(e,n,i,r,s){const a=this._workIndex*s;jh.multiplyQuaternionsFlat(e,a,e,n,e,i),jh.slerpFlat(e,n,e,n,e,a,r)}_lerp(e,n,i,r,s){const a=1-r;for(let o=0;o!==s;++o){const c=n+o;e[c]=e[c]*a+e[i+o]*r}}_lerpAdditive(e,n,i,r,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[i+a]*r}}}const jq="\\[\\]\\.:\\/",qxe=new RegExp("["+jq+"]","g"),Vq="[^"+jq+"]",$xe="[^"+jq.replace("\\.","")+"]",Wxe=/((?:WC+[\/:])*)/.source.replace("WC",Vq),Yxe=/(WCOD+)?/.source.replace("WCOD",$xe),Xxe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Vq),Kxe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Vq),Jxe=new RegExp("^"+Wxe+Yxe+Xxe+Kxe+"$"),Zxe=["material","materials","bones","map"];class Qxe{constructor(e,n,i){const r=i||Yr.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,r)}getValue(e,n){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,n)}setValue(e,n){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=e.length;n!==i;++n)e[n].unbind()}}class Yr{constructor(e,n,i){this.path=n,this.parsedPath=i||Yr.parseTrackName(n),this.node=Yr.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,i){return e&&e.isAnimationObjectGroup?new Yr.Composite(e,n,i):new Yr(e,n,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(qxe,"")}static parseTrackName(e){const n=Jxe.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);Zxe.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(n);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===n||o.uuid===n)return o;const c=i(o.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[n++]=i[r]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,i=n.objectName,r=n.propertyName;let s=n.propertyIndex;if(e||(e=Yr.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let l=n.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===l){l=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(l!==void 0){if(e[l]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[l]}}const a=e[r];if(a===void 0){const l=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(c=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Yr.Composite=Qxe;Yr.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Yr.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Yr.prototype.GetterByBindingType=[Yr.prototype._getValue_direct,Yr.prototype._getValue_array,Yr.prototype._getValue_arrayElement,Yr.prototype._getValue_toArray];Yr.prototype.SetterByBindingTypeAndVersioning=[[Yr.prototype._setValue_direct,Yr.prototype._setValue_direct_setNeedsUpdate,Yr.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Yr.prototype._setValue_array,Yr.prototype._setValue_array_setNeedsUpdate,Yr.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Yr.prototype._setValue_arrayElement,Yr.prototype._setValue_arrayElement_setNeedsUpdate,Yr.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Yr.prototype._setValue_fromArray,Yr.prototype._setValue_fromArray_setNeedsUpdate,Yr.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class e1e{constructor(){this.isAnimationObjectGroup=!0,this.uuid=zd(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let o,c=e.length,l=this.nCachedObjects_;for(let u=0,h=arguments.length;u!==h;++u){const d=arguments[u],f=d.uuid;let p=n[f];if(p===void 0){p=c++,n[f]=p,e.push(d);for(let g=0,_=a;g!==_;++g)s[g].push(new Yr(d,i[g],r[g]))}else if(p<l){o=e[p];const g=--l,_=e[g];n[_.uuid]=p,e[p]=_,n[f]=g,e[g]=d;for(let v=0,E=a;v!==E;++v){const T=s[v],x=T[g];let N=T[p];T[p]=x,N===void 0&&(N=new Yr(d,i[v],r[v])),T[g]=N}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const c=arguments[a],l=c.uuid,u=n[l];if(u!==void 0&&u>=s){const h=s++,d=e[h];n[d.uuid]=u,e[u]=d,n[l]=h,e[h]=c;for(let f=0,p=r;f!==p;++f){const g=i[f],_=g[h],v=g[u];g[u]=_,g[h]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,c=arguments.length;o!==c;++o){const l=arguments[o],u=l.uuid,h=n[u];if(h!==void 0)if(delete n[u],h<s){const d=--s,f=e[d],p=--a,g=e[p];n[f.uuid]=h,e[h]=f,n[g.uuid]=d,e[d]=g,e.pop();for(let _=0,v=r;_!==v;++_){const E=i[_],T=E[d],x=E[p];E[h]=T,E[d]=x,E.pop()}}else{const d=--a,f=e[d];d>0&&(n[f.uuid]=h),e[h]=f,e.pop();for(let p=0,g=r;p!==g;++p){const _=i[p];_[h]=_[d],_.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,o=this._parsedPaths,c=this._objects,l=c.length,u=this.nCachedObjects_,h=new Array(l);r=s.length,i[e]=r,a.push(e),o.push(n),s.push(h);for(let d=u,f=c.length;d!==f;++d){const p=c[d];h[d]=new Yr(p,e,n)}return h}unsubscribe_(e){const n=this._bindingsIndicesByPath,i=n[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,c=a[o],l=e[o];n[l]=i,a[i]=c,a.pop(),s[i]=s[o],s.pop(),r[i]=r[o],r.pop()}}}class zae{constructor(e,n,i=null,r=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=i,this.blendMode=r;const s=n.tracks,a=s.length,o=new Array(a),c={endingStart:OS,endingEnd:OS};for(let l=0;l!==a;++l){const u=s[l].createInterpolant(null);o[l]=u,u.settings=c}this._interpolantSettings=c,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Cse,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,i=!1){if(e.fadeOut(n),this.fadeIn(n),i===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,o=r/s;e.warp(1,a,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,i=!1){return e.crossFadeFrom(this,n,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,i){const r=this._mixer,s=r.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);const c=o.parameterPositions,l=o.sampleValues;return c[0]=s,c[1]=s+i,l[0]=e/a,l[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?n=0:(this._startTime=null,n=i*c)}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const c=this._interpolants,l=this._propertyBindings;switch(this.blendMode){case vq:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulateAdditive(o);break;case QU:default:for(let u=0,h=c.length;u!==h;++u)c[u].evaluate(a),l[u].accumulate(r,o)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];n*=r,e>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const a=i===Rse;if(e===0)return s===-1?r:a&&(s&1)===1?n-r:r;if(i===wse){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=n)r=n;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=n||r<0){const o=Math.floor(r/n);r-=n*o,s+=Math.abs(o);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?n:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(a&&(s&1)===1)return n-r}return r}_setEndings(e,n,i){const r=this._interpolantSettings;i?(r.endingStart=NS,r.endingEnd=NS):(e?r.endingStart=this.zeroSlopeAtStart?NS:OS:r.endingStart=bM,n?r.endingEnd=this.zeroSlopeAtEnd?NS:OS:r.endingEnd=bM)}_scheduleFading(e,n,i){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,c=a.sampleValues;return o[0]=s,c[0]=n,o[1]=s+e,c[1]=i,this}}const t1e=new Float32Array(1);class n1e extends Yd{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,o=e._interpolants,c=i.uuid,l=this._bindingsByRootAndName;let u=l[c];u===void 0&&(u={},l[c]=u);for(let h=0;h!==s;++h){const d=r[h],f=d.name;let p=u[f];if(p!==void 0)++p.referenceCount,a[h]=p;else{if(p=a[h],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,c,f));continue}const g=n&&n._propertyBindings[h].binding.parsedPath;p=new Fae(Yr.create(i,f,g),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,c,f),a[h]=p}o[h].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,i){const r=this._actions,s=this._actionsByClip;let a=s[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){const n=this._actions,i=n[n.length-1],r=e._cacheIndex;i._cacheIndex=r,n[r]=i,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],c=o.knownActions,l=c[c.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,c[u]=l,c.pop(),e._byClipCacheIndex=null;const h=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete h[d],c.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let i=0,r=n.length;i!==r;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackAction(e){const n=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_addInactiveBinding(e,n,i){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[n];a===void 0&&(a={},r[n]=a),a[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,a=this._bindingsByRootAndName,o=a[r],c=n[n.length-1],l=e._cacheIndex;c._cacheIndex=l,n[l]=c,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[r]}_lendBinding(e){const n=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_takeBackBinding(e){const n=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=n[r];e._cacheIndex=r,n[r]=e,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=e[n];return i===void 0&&(i=new Lq(new Float32Array(2),new Float32Array(2),1,t1e),i.__cacheIndex=n,e[n]=i),i}_takeBackControlInterpolant(e){const n=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=n[r];e.__cacheIndex=r,n[r]=e,s.__cacheIndex=i,n[i]=s}clipAction(e,n,i){const r=n||this._root,s=r.uuid;let a=typeof e=="string"?OM.findByName(r,e):e;const o=a!==null?a.uuid:e,c=this._actionsByClip[o];let l=null;if(i===void 0&&(a!==null?i=a.blendMode:i=QU),c!==void 0){const h=c.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;l=c.knownActions[0],a===null&&(a=l._clip)}if(a===null)return null;const u=new zae(this,a,n,i);return this._bindAction(u,l),this._addInactiveAction(u,o,s),u}existingAction(e,n){const i=n||this._root,r=i.uuid,s=typeof e=="string"?OM.findByName(i,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[r]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const n=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let l=0;l!==i;++l)n[l]._update(r,e,s,a);const o=this._bindings,c=this._nActiveBindings;for(let l=0;l!==c;++l)o[l].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const a=s.knownActions;for(let o=0,c=a.length;o!==c;++o){const l=a[o];this._deactivateAction(l);const u=l._cacheIndex,h=n[n.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,h._cacheIndex=u,n[u]=h,n.pop(),this._removeInactiveBindingsForAction(l)}delete r[i]}}uncacheRoot(e){const n=e.uuid,i=this._actionsByClip;for(const a in i){const o=i[a].actionByRoot,c=o[n];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[n];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const i=this.existingAction(e,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class i1e extends e3{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTarget3D=!0,this.depth=i,this.texture=new t3(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class r1e extends e3{constructor(e=1,n=1,i=1,r={}){super(e,n,r),this.isRenderTargetArray=!0,this.depth=i,this.texture=new KO(null,e,n,i),this.texture.isRenderTargetTexture=!0}}class Yi{constructor(e){this.value=e}clone(){return new Yi(this.value.clone===void 0?this.value:this.value.clone())}}let s1e=0;class a1e extends Yd{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:s1e++}),this.name="",this.usage=SM,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let i=0,r=n.length;i<r;i++){const s=Array.isArray(n[i])?n[i]:[n[i]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class o1e extends r3{constructor(e,n,i=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class c1e{constructor(e,n,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const cK=new Ni;class Gq{constructor(e,n,i=0,r=1/0){this.ray=new kC(e,n),this.near=i,this.far=r,this.camera=null,this.layers=new Lw,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}setFromXRController(e){return cK.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(cK),this}intersectObject(e,n=!0,i=[]){return Bj(e,this,i,n),i.sort(lK),i}intersectObjects(e,n=!0,i=[]){for(let r=0,s=e.length;r<s;r++)Bj(e[r],this,i,n);return i.sort(lK),i}}function lK(t,e){return t.distance-e.distance}function Bj(t,e,n,i){let r=!0;if(t.layers.test(e.layers)&&t.raycast(e,n)===!1&&(r=!1),r===!0&&i===!0){const s=t.children;for(let a=0,o=s.length;a<o;a++)Bj(s[a],e,n,!0)}}class l1e{constructor(e=1,n=0,i=0){this.radius=e,this.phi=n,this.theta=i}set(e,n,i){return this.radius=e,this.phi=n,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Xi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Xi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class u1e{constructor(e=1,n=0,i=0){this.radius=e,this.theta=n,this.y=i}set(e,n,i){return this.radius=e,this.theta=n,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}class qq{constructor(e,n,i,r){qq.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,n,i,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,n=0){for(let i=0;i<4;i++)this.elements[i]=e[i+n];return this}set(e,n,i,r){const s=this.elements;return s[0]=e,s[2]=n,s[1]=i,s[3]=r,this}}const uK=new Rt;class Hae{constructor(e=new Rt(1/0,1/0),n=new Rt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,i=e.length;n<i;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const i=uK.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,uK).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const hK=new Re,yk=new Re;class h1e{constructor(e=new Re,n=new Re){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){hK.subVectors(e,this.start),yk.subVectors(this.end,this.start);const i=yk.dot(yk);let s=yk.dot(hK)/i;return n&&(s=Xi(s,0,1)),s}closestPointToPoint(e,n,i){const r=this.closestPointToPointParameter(e,n);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const dK=new Re;class d1e extends Gr{constructor(e,n){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const i=new Qi,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,c=32;a<c;a++,o++){const l=a/c*Math.PI*2,u=o/c*Math.PI*2;r.push(Math.cos(l),Math.sin(l),1,Math.cos(u),Math.sin(u),1)}i.setAttribute("position",new Hn(r,3));const s=new th({fog:!1,toneMapped:!1});this.cone=new Yg(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),dK.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dK),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const a_=new Re,_k=new Ni,Hz=new Ni;class f1e extends Yg{constructor(e){const n=jae(e),i=new Qi,r=[],s=[],a=new _n(0,0,1),o=new _n(0,1,0);for(let l=0;l<n.length;l++){const u=n[l];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}i.setAttribute("position",new Hn(r,3)),i.setAttribute("color",new Hn(s,3));const c=new th({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,i=this.geometry,r=i.getAttribute("position");Hz.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(_k.multiplyMatrices(Hz,o.matrixWorld),a_.setFromMatrixPosition(_k),r.setXYZ(a,a_.x,a_.y,a_.z),_k.multiplyMatrices(Hz,o.parent.matrixWorld),a_.setFromMatrixPosition(_k),r.setXYZ(a+1,a_.x,a_.y,a_.z),a+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function jae(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push(...jae(t.children[n]));return e}class p1e extends Bo{constructor(e,n,i){const r=new nN(n,4,2),s=new Fb({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const m1e=new Re,fK=new _n,pK=new _n;class g1e extends Gr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new tN(n);r.rotateY(Math.PI*.5),this.material=new Fb({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new rr(a,3)),this.add(new Bo(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");fK.copy(this.light.color),pK.copy(this.light.groundColor);for(let i=0,r=n.count;i<r;i++){const s=i<r/2?fK:pK;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(m1e.setFromMatrixPosition(this.light.matrixWorld).negate())}}class v1e extends Yg{constructor(e=10,n=10,i=4473924,r=8947848){i=new _n(i),r=new _n(r);const s=n/2,a=e/n,o=e/2,c=[],l=[];for(let d=0,f=0,p=-o;d<=n;d++,p+=a){c.push(-o,0,p,o,0,p),c.push(p,0,-o,p,0,o);const g=d===s?i:r;g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3,g.toArray(l,f),f+=3}const u=new Qi;u.setAttribute("position",new Hn(c,3)),u.setAttribute("color",new Hn(l,3));const h=new th({vertexColors:!0,toneMapped:!1});super(u,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class y1e extends Yg{constructor(e=10,n=16,i=8,r=64,s=4473924,a=8947848){s=new _n(s),a=new _n(a);const o=[],c=[];if(n>1)for(let h=0;h<n;h++){const d=h/n*(Math.PI*2),f=Math.sin(d)*e,p=Math.cos(d)*e;o.push(0,0,0),o.push(f,0,p);const g=h&1?s:a;c.push(g.r,g.g,g.b),c.push(g.r,g.g,g.b)}for(let h=0;h<i;h++){const d=h&1?s:a,f=e-e/i*h;for(let p=0;p<r;p++){let g=p/r*(Math.PI*2),_=Math.sin(g)*f,v=Math.cos(g)*f;o.push(_,0,v),c.push(d.r,d.g,d.b),g=(p+1)/r*(Math.PI*2),_=Math.sin(g)*f,v=Math.cos(g)*f,o.push(_,0,v),c.push(d.r,d.g,d.b)}}const l=new Qi;l.setAttribute("position",new Hn(o,3)),l.setAttribute("color",new Hn(c,3));const u=new th({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const mK=new Re,bk=new Re,gK=new Re;class _1e extends Gr{constructor(e,n,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",n===void 0&&(n=1);let r=new Qi;r.setAttribute("position",new Hn([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new th({fog:!1,toneMapped:!1});this.lightPlane=new yb(r,s),this.add(this.lightPlane),r=new Qi,r.setAttribute("position",new Hn([0,0,0,0,0,1],3)),this.targetLine=new yb(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),mK.setFromMatrixPosition(this.light.matrixWorld),bk.setFromMatrixPosition(this.light.target.matrixWorld),gK.subVectors(bk,mK),this.lightPlane.lookAt(bk),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(bk),this.targetLine.scale.z=gK.length()}}const Ek=new Re,uo=new JO;class b1e extends Yg{constructor(e){const n=new Qi,i=new th({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,g){c(p),c(g)}function c(p){r.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(r.length/3-1)}n.setAttribute("position",new Hn(r,3)),n.setAttribute("color",new Hn(s,3)),super(n,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const l=new _n(16755200),u=new _n(16711680),h=new _n(43775),d=new _n(16777215),f=new _n(3355443);this.setColors(l,u,h,d,f)}setColors(e,n,i,r,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,n.r,n.g,n.b),o.setXYZ(25,n.r,n.g,n.b),o.setXYZ(26,n.r,n.g,n.b),o.setXYZ(27,n.r,n.g,n.b),o.setXYZ(28,n.r,n.g,n.b),o.setXYZ(29,n.r,n.g,n.b),o.setXYZ(30,n.r,n.g,n.b),o.setXYZ(31,n.r,n.g,n.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,r.r,r.g,r.b),o.setXYZ(39,r.r,r.g,r.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,i=1,r=1;uo.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===jf?-1:0;No("c",n,e,uo,0,0,s),No("t",n,e,uo,0,0,1),No("n1",n,e,uo,-1,-1,s),No("n2",n,e,uo,i,-1,s),No("n3",n,e,uo,-1,r,s),No("n4",n,e,uo,i,r,s),No("f1",n,e,uo,-1,-1,1),No("f2",n,e,uo,i,-1,1),No("f3",n,e,uo,-1,r,1),No("f4",n,e,uo,i,r,1),No("u1",n,e,uo,i*.7,r*1.1,s),No("u2",n,e,uo,-1*.7,r*1.1,s),No("u3",n,e,uo,0,r*2,s),No("cf1",n,e,uo,-1,0,1),No("cf2",n,e,uo,i,0,1),No("cf3",n,e,uo,0,-1,1),No("cf4",n,e,uo,0,r,1),No("cn1",n,e,uo,-1,0,s),No("cn2",n,e,uo,i,0,s),No("cn3",n,e,uo,0,-1,s),No("cn4",n,e,uo,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function No(t,e,n,i,r,s,a){Ek.set(r,s,a).unproject(i);const o=e[t];if(o!==void 0){const c=n.getAttribute("position");for(let l=0,u=o.length;l<u;l++)c.setXYZ(o[l],Ek.x,Ek.y,Ek.z)}}const Sk=new cu;class E1e extends Yg{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Qi;s.setIndex(new rr(i,1)),s.setAttribute("position",new rr(r,3)),super(s,new th({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Sk.setFromObject(this.object),Sk.isEmpty())return;const e=Sk.min,n=Sk.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=e.x,r[4]=n.y,r[5]=n.z,r[6]=e.x,r[7]=e.y,r[8]=n.z,r[9]=n.x,r[10]=e.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=e.z,r[15]=e.x,r[16]=n.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=n.x,r[22]=e.y,r[23]=e.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class S1e extends Yg{constructor(e,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Qi;s.setIndex(new rr(i,1)),s.setAttribute("position",new Hn(r,3)),super(s,new th({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class T1e extends yb{constructor(e,n=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Qi;a.setAttribute("position",new Hn(s,3)),a.computeBoundingSphere(),super(a,new th({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new Qi;c.setAttribute("position",new Hn(o,3)),c.computeBoundingSphere(),this.add(new Bo(c,new Fb({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const vK=new Re;let Tk,jz;class x1e extends Gr{constructor(e=new Re(0,0,1),n=new Re(0,0,0),i=1,r=16776960,s=i*.2,a=s*.2){super(),this.type="ArrowHelper",Tk===void 0&&(Tk=new Qi,Tk.setAttribute("position",new Hn([0,0,0,0,1,0],3)),jz=new eN(.5,1,5,1),jz.translate(0,-.5,0)),this.position.copy(n),this.line=new yb(Tk,new th({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Bo(jz,new Fb({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{vK.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(vK,n)}}setLength(e,n=e*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class w1e extends Yg{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Qi;r.setAttribute("position",new Hn(n,3)),r.setAttribute("color",new Hn(i,3));const s=new th({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,n,i){const r=new _n,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(n),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class C1e{constructor(){this.type="ShapePath",this.color=new _n,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new NL,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,i,r){return this.currentPath.quadraticCurveTo(e,n,i,r),this}bezierCurveTo(e,n,i,r,s,a){return this.currentPath.bezierCurveTo(e,n,i,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(v){const E=[];for(let T=0,x=v.length;T<x;T++){const N=v[T],A=new FS;A.curves=N.curves,E.push(A)}return E}function i(v,E){const T=E.length;let x=!1;for(let N=T-1,A=0;A<T;N=A++){let I=E[N],k=E[A],L=k.x-I.x,U=k.y-I.y;if(Math.abs(U)>Number.EPSILON){if(U<0&&(I=E[A],L=-L,k=E[N],U=-U),v.y<I.y||v.y>k.y)continue;if(v.y===I.y){if(v.x===I.x)return!0}else{const $=U*(v.x-I.x)-L*(v.y-I.y);if($===0)return!0;if($<0)continue;x=!x}}else{if(v.y!==I.y)continue;if(k.x<=v.x&&v.x<=I.x||I.x<=v.x&&v.x<=k.x)return!0}}return x}const r=Yp.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,c;const l=[];if(s.length===1)return o=s[0],c=new FS,c.curves=o.curves,l.push(c),l;let u=!r(s[0].getPoints());u=e?!u:u;const h=[],d=[];let f=[],p=0,g;d[p]=void 0,f[p]=[];for(let v=0,E=s.length;v<E;v++)o=s[v],g=o.getPoints(),a=r(g),a=e?!a:a,a?(!u&&d[p]&&p++,d[p]={s:new FS,p:g},d[p].s.curves=o.curves,u&&p++,f[p]=[]):f[p].push({h:o,p:g[0]});if(!d[0])return n(s);if(d.length>1){let v=!1,E=0;for(let T=0,x=d.length;T<x;T++)h[T]=[];for(let T=0,x=d.length;T<x;T++){const N=f[T];for(let A=0;A<N.length;A++){const I=N[A];let k=!0;for(let L=0;L<d.length;L++)i(I.p,d[L].p)&&(T!==L&&E++,k?(k=!1,h[L].push(I)):v=!0);k&&h[T].push(I)}}E>0&&v===!1&&(f=h)}let _;for(let v=0,E=d.length;v<E;v++){c=d[v].s,l.push(c),_=f[v];for(let T=0,x=_.length;T<x;T++)c.holes.push(_[T].h)}return l}}let R1e=class extends Yd{constructor(e,n=null){super(),this.object=e,this.domElement=n,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}};function A1e(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2):(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0),t}function M1e(t,e){const n=t.image&&t.image.width?t.image.width/t.image.height:1;return n>e?(t.repeat.x=e/n,t.repeat.y=1,t.offset.x=(1-t.repeat.x)/2,t.offset.y=0):(t.repeat.x=1,t.repeat.y=n/e,t.offset.x=0,t.offset.y=(1-t.repeat.y)/2),t}function O1e(t){return t.repeat.x=1,t.repeat.y=1,t.offset.x=0,t.offset.y=0,t}function Fj(t,e,n,i){const r=N1e(i);switch(n){case fq:return t*e;case JU:return t*e/r.components*r.byteLength;case YO:return t*e/r.components*r.byteLength;case mq:return t*e*2/r.components*r.byteLength;case ZU:return t*e*2/r.components*r.byteLength;case pq:return t*e*3/r.components*r.byteLength;case ru:return t*e*4/r.components*r.byteLength;case XO:return t*e*4/r.components*r.byteLength;case AA:case MA:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case OA:case NA:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case nL:case rL:return Math.max(t,16)*Math.max(e,8)/4;case tL:case iL:return Math.max(t,8)*Math.max(e,8)/2;case sL:case aL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*8;case oL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case cL:return Math.floor((t+3)/4)*Math.floor((e+3)/4)*16;case lL:return Math.floor((t+4)/5)*Math.floor((e+3)/4)*16;case uL:return Math.floor((t+4)/5)*Math.floor((e+4)/5)*16;case hL:return Math.floor((t+5)/6)*Math.floor((e+4)/5)*16;case dL:return Math.floor((t+5)/6)*Math.floor((e+5)/6)*16;case fL:return Math.floor((t+7)/8)*Math.floor((e+4)/5)*16;case pL:return Math.floor((t+7)/8)*Math.floor((e+5)/6)*16;case mL:return Math.floor((t+7)/8)*Math.floor((e+7)/8)*16;case gL:return Math.floor((t+9)/10)*Math.floor((e+4)/5)*16;case vL:return Math.floor((t+9)/10)*Math.floor((e+5)/6)*16;case yL:return Math.floor((t+9)/10)*Math.floor((e+7)/8)*16;case _L:return Math.floor((t+9)/10)*Math.floor((e+9)/10)*16;case bL:return Math.floor((t+11)/12)*Math.floor((e+9)/10)*16;case EL:return Math.floor((t+11)/12)*Math.floor((e+11)/12)*16;case IA:case SL:case TL:return Math.ceil(t/4)*Math.ceil(e/4)*16;case gq:case xL:return Math.ceil(t/4)*Math.ceil(e/4)*8;case wL:case CL:return Math.ceil(t/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${n} format.`)}function N1e(t){switch(t){case ml:case uq:return{byteLength:1,components:1};case kw:case hq:case Lb:return{byteLength:2,components:1};case XU:case KU:return{byteLength:2,components:4};case Pg:case YU:case iu:return{byteLength:4,components:1};case dq:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${t}.`)}class I1e{static contain(e,n){return A1e(e,n)}static cover(e,n){return M1e(e,n)}static fill(e){return O1e(e)}static getByteLength(e,n,i,r){return Fj(e,n,i,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:$O}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=$O);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function Vae(){let t=null,e=!1,n=null,i=null;function r(s,a){n(s,a),i=t.requestAnimationFrame(r)}return{start:function(){e!==!0&&n!==null&&(i=t.requestAnimationFrame(r),e=!0)},stop:function(){t.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function k1e(t){const e=new WeakMap;function n(o,c){const l=o.array,u=o.usage,h=l.byteLength,d=t.createBuffer();t.bindBuffer(c,d),t.bufferData(c,l,u),o.onUploadCallback();let f;if(l instanceof Float32Array)f=t.FLOAT;else if(l instanceof Uint16Array)o.isFloat16BufferAttribute?f=t.HALF_FLOAT:f=t.UNSIGNED_SHORT;else if(l instanceof Int16Array)f=t.SHORT;else if(l instanceof Uint32Array)f=t.UNSIGNED_INT;else if(l instanceof Int32Array)f=t.INT;else if(l instanceof Int8Array)f=t.BYTE;else if(l instanceof Uint8Array)f=t.UNSIGNED_BYTE;else if(l instanceof Uint8ClampedArray)f=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+l);return{buffer:d,type:f,bytesPerElement:l.BYTES_PER_ELEMENT,version:o.version,size:h}}function i(o,c,l){const u=c.array,h=c.updateRanges;if(t.bindBuffer(l,o),h.length===0)t.bufferSubData(l,0,u);else{h.sort((f,p)=>f.start-p.start);let d=0;for(let f=1;f<h.length;f++){const p=h[d],g=h[f];g.start<=p.start+p.count+1?p.count=Math.max(p.count,g.start+g.count-p.start):(++d,h[d]=g)}h.length=d+1;for(let f=0,p=h.length;f<p;f++){const g=h[f];t.bufferSubData(l,g.start*u.BYTES_PER_ELEMENT,u,g.start,g.count)}c.clearUpdateRanges()}c.onUploadCallback()}function r(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const c=e.get(o);c&&(t.deleteBuffer(c.buffer),e.delete(o))}function a(o,c){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const l=e.get(o);if(l===void 0)e.set(o,n(o,c));else if(l.version<o.version){if(l.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(l.buffer,o,c),l.version=o.version}}return{get:r,remove:s,update:a}}var D1e=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,P1e=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,L1e=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,U1e=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,B1e=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,F1e=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,z1e=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,H1e=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,j1e=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,V1e=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,G1e=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,q1e=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,$1e=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,W1e=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Y1e=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,X1e=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,K1e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,J1e=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Z1e=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Q1e=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,ewe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,twe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,nwe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,iwe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,rwe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,swe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,awe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,owe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,cwe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,lwe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,uwe="gl_FragColor = linearToOutputTexel( gl_FragColor );",hwe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,dwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,fwe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,pwe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,mwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,gwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,vwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ywe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,_we=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,bwe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Ewe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,Swe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Twe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,xwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,wwe=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Cwe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Rwe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Awe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Mwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Owe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Nwe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Iwe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,kwe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Dwe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Pwe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Lwe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Uwe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Bwe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Fwe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,zwe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Hwe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,jwe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Vwe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Gwe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,qwe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,$we=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Wwe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Ywe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Xwe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Kwe=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Jwe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Zwe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Qwe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,eCe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,tCe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,nCe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,iCe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,rCe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,sCe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,aCe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,oCe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,cCe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,lCe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,uCe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,hCe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dCe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,fCe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,pCe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,mCe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,gCe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,vCe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,yCe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,_Ce=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,bCe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,ECe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,SCe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,TCe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,xCe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,wCe=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,CCe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,RCe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,ACe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,MCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,OCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,NCe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,ICe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const kCe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,DCe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,PCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,LCe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,UCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,BCe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,FCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,zCe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,HCe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,jCe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,VCe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,GCe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,qCe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,$Ce=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,WCe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,YCe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,XCe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,KCe=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,JCe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,ZCe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,QCe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,eRe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,tRe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,nRe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,iRe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rRe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,sRe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,aRe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,oRe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,cRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,lRe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,uRe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,hRe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dRe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ir={alphahash_fragment:D1e,alphahash_pars_fragment:P1e,alphamap_fragment:L1e,alphamap_pars_fragment:U1e,alphatest_fragment:B1e,alphatest_pars_fragment:F1e,aomap_fragment:z1e,aomap_pars_fragment:H1e,batching_pars_vertex:j1e,batching_vertex:V1e,begin_vertex:G1e,beginnormal_vertex:q1e,bsdfs:$1e,iridescence_fragment:W1e,bumpmap_pars_fragment:Y1e,clipping_planes_fragment:X1e,clipping_planes_pars_fragment:K1e,clipping_planes_pars_vertex:J1e,clipping_planes_vertex:Z1e,color_fragment:Q1e,color_pars_fragment:ewe,color_pars_vertex:twe,color_vertex:nwe,common:iwe,cube_uv_reflection_fragment:rwe,defaultnormal_vertex:swe,displacementmap_pars_vertex:awe,displacementmap_vertex:owe,emissivemap_fragment:cwe,emissivemap_pars_fragment:lwe,colorspace_fragment:uwe,colorspace_pars_fragment:hwe,envmap_fragment:dwe,envmap_common_pars_fragment:fwe,envmap_pars_fragment:pwe,envmap_pars_vertex:mwe,envmap_physical_pars_fragment:Cwe,envmap_vertex:gwe,fog_vertex:vwe,fog_pars_vertex:ywe,fog_fragment:_we,fog_pars_fragment:bwe,gradientmap_pars_fragment:Ewe,lightmap_pars_fragment:Swe,lights_lambert_fragment:Twe,lights_lambert_pars_fragment:xwe,lights_pars_begin:wwe,lights_toon_fragment:Rwe,lights_toon_pars_fragment:Awe,lights_phong_fragment:Mwe,lights_phong_pars_fragment:Owe,lights_physical_fragment:Nwe,lights_physical_pars_fragment:Iwe,lights_fragment_begin:kwe,lights_fragment_maps:Dwe,lights_fragment_end:Pwe,logdepthbuf_fragment:Lwe,logdepthbuf_pars_fragment:Uwe,logdepthbuf_pars_vertex:Bwe,logdepthbuf_vertex:Fwe,map_fragment:zwe,map_pars_fragment:Hwe,map_particle_fragment:jwe,map_particle_pars_fragment:Vwe,metalnessmap_fragment:Gwe,metalnessmap_pars_fragment:qwe,morphinstance_vertex:$we,morphcolor_vertex:Wwe,morphnormal_vertex:Ywe,morphtarget_pars_vertex:Xwe,morphtarget_vertex:Kwe,normal_fragment_begin:Jwe,normal_fragment_maps:Zwe,normal_pars_fragment:Qwe,normal_pars_vertex:eCe,normal_vertex:tCe,normalmap_pars_fragment:nCe,clearcoat_normal_fragment_begin:iCe,clearcoat_normal_fragment_maps:rCe,clearcoat_pars_fragment:sCe,iridescence_pars_fragment:aCe,opaque_fragment:oCe,packing:cCe,premultiplied_alpha_fragment:lCe,project_vertex:uCe,dithering_fragment:hCe,dithering_pars_fragment:dCe,roughnessmap_fragment:fCe,roughnessmap_pars_fragment:pCe,shadowmap_pars_fragment:mCe,shadowmap_pars_vertex:gCe,shadowmap_vertex:vCe,shadowmask_pars_fragment:yCe,skinbase_vertex:_Ce,skinning_pars_vertex:bCe,skinning_vertex:ECe,skinnormal_vertex:SCe,specularmap_fragment:TCe,specularmap_pars_fragment:xCe,tonemapping_fragment:wCe,tonemapping_pars_fragment:CCe,transmission_fragment:RCe,transmission_pars_fragment:ACe,uv_pars_fragment:MCe,uv_pars_vertex:OCe,uv_vertex:NCe,worldpos_vertex:ICe,background_vert:kCe,background_frag:DCe,backgroundCube_vert:PCe,backgroundCube_frag:LCe,cube_vert:UCe,cube_frag:BCe,depth_vert:FCe,depth_frag:zCe,distanceRGBA_vert:HCe,distanceRGBA_frag:jCe,equirect_vert:VCe,equirect_frag:GCe,linedashed_vert:qCe,linedashed_frag:$Ce,meshbasic_vert:WCe,meshbasic_frag:YCe,meshlambert_vert:XCe,meshlambert_frag:KCe,meshmatcap_vert:JCe,meshmatcap_frag:ZCe,meshnormal_vert:QCe,meshnormal_frag:eRe,meshphong_vert:tRe,meshphong_frag:nRe,meshphysical_vert:iRe,meshphysical_frag:rRe,meshtoon_vert:sRe,meshtoon_frag:aRe,points_vert:oRe,points_frag:cRe,shadow_vert:lRe,shadow_frag:uRe,sprite_vert:hRe,sprite_frag:dRe},vn={common:{diffuse:{value:new _n(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Zi},alphaMap:{value:null},alphaMapTransform:{value:new Zi},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Zi}},envmap:{envMap:{value:null},envMapRotation:{value:new Zi},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Zi}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Zi}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Zi},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Zi},normalScale:{value:new Rt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Zi},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Zi}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Zi}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Zi}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new _n(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new _n(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Zi},alphaTest:{value:0},uvTransform:{value:new Zi}},sprite:{diffuse:{value:new _n(16777215)},opacity:{value:1},center:{value:new Rt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Zi},alphaMap:{value:null},alphaMapTransform:{value:new Zi},alphaTest:{value:0}}},Hp={basic:{uniforms:zu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.fog]),vertexShader:ir.meshbasic_vert,fragmentShader:ir.meshbasic_frag},lambert:{uniforms:zu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new _n(0)}}]),vertexShader:ir.meshlambert_vert,fragmentShader:ir.meshlambert_frag},phong:{uniforms:zu([vn.common,vn.specularmap,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,vn.lights,{emissive:{value:new _n(0)},specular:{value:new _n(1118481)},shininess:{value:30}}]),vertexShader:ir.meshphong_vert,fragmentShader:ir.meshphong_frag},standard:{uniforms:zu([vn.common,vn.envmap,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.roughnessmap,vn.metalnessmap,vn.fog,vn.lights,{emissive:{value:new _n(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag},toon:{uniforms:zu([vn.common,vn.aomap,vn.lightmap,vn.emissivemap,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.gradientmap,vn.fog,vn.lights,{emissive:{value:new _n(0)}}]),vertexShader:ir.meshtoon_vert,fragmentShader:ir.meshtoon_frag},matcap:{uniforms:zu([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,vn.fog,{matcap:{value:null}}]),vertexShader:ir.meshmatcap_vert,fragmentShader:ir.meshmatcap_frag},points:{uniforms:zu([vn.points,vn.fog]),vertexShader:ir.points_vert,fragmentShader:ir.points_frag},dashed:{uniforms:zu([vn.common,vn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ir.linedashed_vert,fragmentShader:ir.linedashed_frag},depth:{uniforms:zu([vn.common,vn.displacementmap]),vertexShader:ir.depth_vert,fragmentShader:ir.depth_frag},normal:{uniforms:zu([vn.common,vn.bumpmap,vn.normalmap,vn.displacementmap,{opacity:{value:1}}]),vertexShader:ir.meshnormal_vert,fragmentShader:ir.meshnormal_frag},sprite:{uniforms:zu([vn.sprite,vn.fog]),vertexShader:ir.sprite_vert,fragmentShader:ir.sprite_frag},background:{uniforms:{uvTransform:{value:new Zi},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ir.background_vert,fragmentShader:ir.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Zi}},vertexShader:ir.backgroundCube_vert,fragmentShader:ir.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ir.cube_vert,fragmentShader:ir.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ir.equirect_vert,fragmentShader:ir.equirect_frag},distanceRGBA:{uniforms:zu([vn.common,vn.displacementmap,{referencePosition:{value:new Re},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ir.distanceRGBA_vert,fragmentShader:ir.distanceRGBA_frag},shadow:{uniforms:zu([vn.lights,vn.fog,{color:{value:new _n(0)},opacity:{value:1}}]),vertexShader:ir.shadow_vert,fragmentShader:ir.shadow_frag}};Hp.physical={uniforms:zu([Hp.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Zi},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Zi},clearcoatNormalScale:{value:new Rt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Zi},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Zi},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Zi},sheen:{value:0},sheenColor:{value:new _n(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Zi},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Zi},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Zi},transmissionSamplerSize:{value:new Rt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Zi},attenuationDistance:{value:0},attenuationColor:{value:new _n(0)},specularColor:{value:new _n(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Zi},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Zi},anisotropyVector:{value:new Rt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Zi}}]),vertexShader:ir.meshphysical_vert,fragmentShader:ir.meshphysical_frag};const xk={r:0,b:0,g:0},eS=new $h,fRe=new Ni;function pRe(t,e,n,i,r,s,a){const o=new _n(0);let c=s===!0?0:1,l,u,h=null,d=0,f=null;function p(T){let x=T.isScene===!0?T.background:null;return x&&x.isTexture&&(x=(T.backgroundBlurriness>0?n:e).get(x)),x}function g(T){let x=!1;const N=p(T);N===null?v(o,c):N&&N.isColor&&(v(N,1),x=!0);const A=t.xr.getEnvironmentBlendMode();A==="additive"?i.buffers.color.setClear(0,0,0,1,a):A==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,a),(t.autoClear||x)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil))}function _(T,x){const N=p(x);N&&(N.isCubeTexture||N.mapping===IC)?(u===void 0&&(u=new Bo(new PT(1,1,1),new Bc({name:"BackgroundCubeMaterial",uniforms:Uw(Hp.backgroundCube.uniforms),vertexShader:Hp.backgroundCube.vertexShader,fragmentShader:Hp.backgroundCube.fragmentShader,side:Pc,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(A,I,k){this.matrixWorld.copyPosition(k.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(u)),eS.copy(x.backgroundRotation),eS.x*=-1,eS.y*=-1,eS.z*=-1,N.isCubeTexture&&N.isRenderTargetTexture===!1&&(eS.y*=-1,eS.z*=-1),u.material.uniforms.envMap.value=N,u.material.uniforms.flipEnvMap.value=N.isCubeTexture&&N.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(fRe.makeRotationFromEuler(eS)),u.material.toneMapped=Lr.getTransfer(N.colorSpace)!==ws,(h!==N||d!==N.version||f!==t.toneMapping)&&(u.material.needsUpdate=!0,h=N,d=N.version,f=t.toneMapping),u.layers.enableAll(),T.unshift(u,u.geometry,u.material,0,0,null)):N&&N.isTexture&&(l===void 0&&(l=new Bo(new LC(2,2),new Bc({name:"BackgroundMaterial",uniforms:Uw(Hp.background.uniforms),vertexShader:Hp.background.vertexShader,fragmentShader:Hp.background.fragmentShader,side:Dg,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),l.geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=N,l.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,l.material.toneMapped=Lr.getTransfer(N.colorSpace)!==ws,N.matrixAutoUpdate===!0&&N.updateMatrix(),l.material.uniforms.uvTransform.value.copy(N.matrix),(h!==N||d!==N.version||f!==t.toneMapping)&&(l.material.needsUpdate=!0,h=N,d=N.version,f=t.toneMapping),l.layers.enableAll(),T.unshift(l,l.geometry,l.material,0,0,null))}function v(T,x){T.getRGB(xk,jse(t)),i.buffers.color.setClear(xk.r,xk.g,xk.b,x,a)}function E(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),l!==void 0&&(l.geometry.dispose(),l.material.dispose(),l=void 0)}return{getClearColor:function(){return o},setClearColor:function(T,x=1){o.set(T),c=x,v(o,c)},getClearAlpha:function(){return c},setClearAlpha:function(T){c=T,v(o,c)},render:g,addToRenderList:_,dispose:E}}function mRe(t,e){const n=t.getParameter(t.MAX_VERTEX_ATTRIBS),i={},r=d(null);let s=r,a=!1;function o(U,$,q,G,X){let ie=!1;const V=h(G,q,$);s!==V&&(s=V,l(s.object)),ie=f(U,G,q,X),ie&&p(U,G,q,X),X!==null&&e.update(X,t.ELEMENT_ARRAY_BUFFER),(ie||a)&&(a=!1,x(U,$,q,G),X!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e.get(X).buffer))}function c(){return t.createVertexArray()}function l(U){return t.bindVertexArray(U)}function u(U){return t.deleteVertexArray(U)}function h(U,$,q){const G=q.wireframe===!0;let X=i[U.id];X===void 0&&(X={},i[U.id]=X);let ie=X[$.id];ie===void 0&&(ie={},X[$.id]=ie);let V=ie[G];return V===void 0&&(V=d(c()),ie[G]=V),V}function d(U){const $=[],q=[],G=[];for(let X=0;X<n;X++)$[X]=0,q[X]=0,G[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:$,enabledAttributes:q,attributeDivisors:G,object:U,attributes:{},index:null}}function f(U,$,q,G){const X=s.attributes,ie=$.attributes;let V=0;const Z=q.getAttributes();for(const Y in Z)if(Z[Y].location>=0){const oe=X[Y];let de=ie[Y];if(de===void 0&&(Y==="instanceMatrix"&&U.instanceMatrix&&(de=U.instanceMatrix),Y==="instanceColor"&&U.instanceColor&&(de=U.instanceColor)),oe===void 0||oe.attribute!==de||de&&oe.data!==de.data)return!0;V++}return s.attributesNum!==V||s.index!==G}function p(U,$,q,G){const X={},ie=$.attributes;let V=0;const Z=q.getAttributes();for(const Y in Z)if(Z[Y].location>=0){let oe=ie[Y];oe===void 0&&(Y==="instanceMatrix"&&U.instanceMatrix&&(oe=U.instanceMatrix),Y==="instanceColor"&&U.instanceColor&&(oe=U.instanceColor));const de={};de.attribute=oe,oe&&oe.data&&(de.data=oe.data),X[Y]=de,V++}s.attributes=X,s.attributesNum=V,s.index=G}function g(){const U=s.newAttributes;for(let $=0,q=U.length;$<q;$++)U[$]=0}function _(U){v(U,0)}function v(U,$){const q=s.newAttributes,G=s.enabledAttributes,X=s.attributeDivisors;q[U]=1,G[U]===0&&(t.enableVertexAttribArray(U),G[U]=1),X[U]!==$&&(t.vertexAttribDivisor(U,$),X[U]=$)}function E(){const U=s.newAttributes,$=s.enabledAttributes;for(let q=0,G=$.length;q<G;q++)$[q]!==U[q]&&(t.disableVertexAttribArray(q),$[q]=0)}function T(U,$,q,G,X,ie,V){V===!0?t.vertexAttribIPointer(U,$,q,X,ie):t.vertexAttribPointer(U,$,q,G,X,ie)}function x(U,$,q,G){g();const X=G.attributes,ie=q.getAttributes(),V=$.defaultAttributeValues;for(const Z in ie){const Y=ie[Z];if(Y.location>=0){let ee=X[Z];if(ee===void 0&&(Z==="instanceMatrix"&&U.instanceMatrix&&(ee=U.instanceMatrix),Z==="instanceColor"&&U.instanceColor&&(ee=U.instanceColor)),ee!==void 0){const oe=ee.normalized,de=ee.itemSize,Me=e.get(ee);if(Me===void 0)continue;const He=Me.buffer,Te=Me.type,Le=Me.bytesPerElement,we=Te===t.INT||Te===t.UNSIGNED_INT||ee.gpuType===YU;if(ee.isInterleavedBufferAttribute){const Ce=ee.data,ke=Ce.stride,St=ee.offset;if(Ce.isInstancedInterleavedBuffer){for(let At=0;At<Y.locationSize;At++)v(Y.location+At,Ce.meshPerAttribute);U.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let At=0;At<Y.locationSize;At++)_(Y.location+At);t.bindBuffer(t.ARRAY_BUFFER,He);for(let At=0;At<Y.locationSize;At++)T(Y.location+At,de/Y.locationSize,Te,oe,ke*Le,(St+de/Y.locationSize*At)*Le,we)}else{if(ee.isInstancedBufferAttribute){for(let Ce=0;Ce<Y.locationSize;Ce++)v(Y.location+Ce,ee.meshPerAttribute);U.isInstancedMesh!==!0&&G._maxInstanceCount===void 0&&(G._maxInstanceCount=ee.meshPerAttribute*ee.count)}else for(let Ce=0;Ce<Y.locationSize;Ce++)_(Y.location+Ce);t.bindBuffer(t.ARRAY_BUFFER,He);for(let Ce=0;Ce<Y.locationSize;Ce++)T(Y.location+Ce,de/Y.locationSize,Te,oe,de*Le,de/Y.locationSize*Ce*Le,we)}}else if(V!==void 0){const oe=V[Z];if(oe!==void 0)switch(oe.length){case 2:t.vertexAttrib2fv(Y.location,oe);break;case 3:t.vertexAttrib3fv(Y.location,oe);break;case 4:t.vertexAttrib4fv(Y.location,oe);break;default:t.vertexAttrib1fv(Y.location,oe)}}}}E()}function N(){k();for(const U in i){const $=i[U];for(const q in $){const G=$[q];for(const X in G)u(G[X].object),delete G[X];delete $[q]}delete i[U]}}function A(U){if(i[U.id]===void 0)return;const $=i[U.id];for(const q in $){const G=$[q];for(const X in G)u(G[X].object),delete G[X];delete $[q]}delete i[U.id]}function I(U){for(const $ in i){const q=i[$];if(q[U.id]===void 0)continue;const G=q[U.id];for(const X in G)u(G[X].object),delete G[X];delete q[U.id]}}function k(){L(),a=!0,s!==r&&(s=r,l(s.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:o,reset:k,resetDefaultState:L,dispose:N,releaseStatesOfGeometry:A,releaseStatesOfProgram:I,initAttributes:g,enableAttribute:_,disableUnusedAttributes:E}}function gRe(t,e,n){let i;function r(l){i=l}function s(l,u){t.drawArrays(i,l,u),n.update(u,i,1)}function a(l,u,h){h!==0&&(t.drawArraysInstanced(i,l,u,h),n.update(u,i,h))}function o(l,u,h){if(h===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,l,0,u,0,h);let f=0;for(let p=0;p<h;p++)f+=u[p];n.update(f,i,1)}function c(l,u,h,d){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<l.length;p++)a(l[p],u[p],d[p]);else{f.multiDrawArraysInstancedWEBGL(i,l,0,u,0,d,0,h);let p=0;for(let g=0;g<h;g++)p+=u[g]*d[g];n.update(p,i,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=c}function vRe(t,e,n,i){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(I){return!(I!==ru&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const k=I===Lb&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==ml&&i.convert(I)!==t.getParameter(t.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==iu&&!k)}function c(I){if(I==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let l=n.precision!==void 0?n.precision:"highp";const u=c(l);u!==l&&(console.warn("THREE.WebGLRenderer:",l,"not supported, using",u,"instead."),l=u);const h=n.logarithmicDepthBuffer===!0,d=n.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),f=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),p=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),g=t.getParameter(t.MAX_TEXTURE_SIZE),_=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),v=t.getParameter(t.MAX_VERTEX_ATTRIBS),E=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),T=t.getParameter(t.MAX_VARYING_VECTORS),x=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),N=p>0,A=t.getParameter(t.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:c,textureFormatReadable:a,textureTypeReadable:o,precision:l,logarithmicDepthBuffer:h,reverseDepthBuffer:d,maxTextures:f,maxVertexTextures:p,maxTextureSize:g,maxCubemapSize:_,maxAttributes:v,maxVertexUniforms:E,maxVaryings:T,maxFragmentUniforms:x,vertexTextures:N,maxSamples:A}}function yRe(t){const e=this;let n=null,i=0,r=!1,s=!1;const a=new Rf,o=new Zi,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,d){const f=h.length!==0||d||i!==0||r;return r=d,i=h.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,d){n=u(h,d,0)},this.setState=function(h,d,f){const p=h.clippingPlanes,g=h.clipIntersection,_=h.clipShadows,v=t.get(h);if(!r||p===null||p.length===0||s&&!_)s?u(null):l();else{const E=s?0:i,T=E*4;let x=v.clippingState||null;c.value=x,x=u(p,d,T,f);for(let N=0;N!==T;++N)x[N]=n[N];v.clippingState=x,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=E}};function l(){c.value!==n&&(c.value=n,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function u(h,d,f,p){const g=h!==null?h.length:0;let _=null;if(g!==0){if(_=c.value,p!==!0||_===null){const v=f+g*4,E=d.matrixWorldInverse;o.getNormalMatrix(E),(_===null||_.length<v)&&(_=new Float32Array(v));for(let T=0,x=f;T!==g;++T,x+=4)a.copy(h[T]).applyMatrix4(E,o),a.normal.toArray(_,x),_[x+3]=a.constant}c.value=_,c.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,_}}function _Re(t){let e=new WeakMap;function n(a,o){return o===mM?a.mapping=Xv:o===gM&&(a.mapping=vb),a}function i(a){if(a&&a.isTexture){const o=a.mapping;if(o===mM||o===gM)if(e.has(a)){const c=e.get(a).texture;return n(c,a.mapping)}else{const c=a.image;if(c&&c.height>0){const l=new qse(c.height);return l.fromEquirectangularTexture(t,a),e.set(a,l),a.addEventListener("dispose",r),n(l.texture,a.mapping)}else return null}}return a}function r(a){const o=a.target;o.removeEventListener("dispose",r);const c=e.get(o);c!==void 0&&(e.delete(o),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}const I1=4,yK=[.125,.215,.35,.446,.526,.582],xS=20,Vz=new sN,_K=new _n;let Gz=null,qz=0,$z=0,Wz=!1;const pS=(1+Math.sqrt(5))/2,Kx=1/pS,bK=[new Re(-pS,Kx,0),new Re(pS,Kx,0),new Re(-Kx,0,pS),new Re(Kx,0,pS),new Re(0,pS,-Kx),new Re(0,pS,Kx),new Re(-1,1,-1),new Re(1,1,-1),new Re(-1,1,1),new Re(1,1,1)],bRe=new Re;class zj{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,i=.1,r=100,s={}){const{size:a=256,position:o=bRe}=s;Gz=this._renderer.getRenderTarget(),qz=this._renderer.getActiveCubeFace(),$z=this._renderer.getActiveMipmapLevel(),Wz=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const c=this._allocateTargets();return c.depthBuffer=!0,this._sceneToCubeUV(e,i,r,c,o),n>0&&this._blur(c,0,0,n),this._applyPMREM(c),this._cleanup(c),c}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=TK(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=SK(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Gz,qz,$z),this._renderer.xr.enabled=Wz,e.scissorTest=!1,wk(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===Xv||e.mapping===vb?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Gz=this._renderer.getRenderTarget(),qz=this._renderer.getActiveCubeFace(),$z=this._renderer.getActiveMipmapLevel(),Wz=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const i=n||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:_a,minFilter:_a,generateMipmaps:!1,type:Lb,format:ru,colorSpace:Lg,depthBuffer:!1},r=EK(e,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=EK(e,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=ERe(s)),this._blurMaterial=SRe(s,e,n)}return r}_compileMaterial(e){const n=new Bo(this._lodPlanes[0],e);this._renderer.compile(n,Vz)}_sceneToCubeUV(e,n,i,r,s){const c=new Ic(90,1,n,i),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],h=this._renderer,d=h.autoClear,f=h.toneMapping;h.getClearColor(_K),h.toneMapping=Kp,h.autoClear=!1;const p=new Fb({name:"PMREM.Background",side:Pc,depthWrite:!1,depthTest:!1}),g=new Bo(new PT,p);let _=!1;const v=e.background;v?v.isColor&&(p.color.copy(v),e.background=null,_=!0):(p.color.copy(_K),_=!0);for(let E=0;E<6;E++){const T=E%3;T===0?(c.up.set(0,l[E],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x+u[E],s.y,s.z)):T===1?(c.up.set(0,0,l[E]),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y+u[E],s.z)):(c.up.set(0,l[E],0),c.position.set(s.x,s.y,s.z),c.lookAt(s.x,s.y,s.z+u[E]));const x=this._cubeSize;wk(r,T*x,E>2?x:0,x,x),h.setRenderTarget(r),_&&h.render(g,c),h.render(e,c)}g.geometry.dispose(),g.material.dispose(),h.toneMapping=f,h.autoClear=d,e.background=v}_textureToCubeUV(e,n){const i=this._renderer,r=e.mapping===Xv||e.mapping===vb;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=TK()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=SK());const s=r?this._cubemapMaterial:this._equirectMaterial,a=new Bo(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const c=this._cubeSize;wk(n,0,0,3*c,2*c),i.setRenderTarget(n),i.render(a,Vz)}_applyPMREM(e){const n=this._renderer,i=n.autoClear;n.autoClear=!1;const r=this._lodPlanes.length;for(let s=1;s<r;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=bK[(r-s-1)%bK.length];this._blur(e,s-1,s,a,o)}n.autoClear=i}_blur(e,n,i,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,i,r,"latitudinal",s),this._halfBlur(a,e,i,i,r,"longitudinal",s)}_halfBlur(e,n,i,r,s,a,o){const c=this._renderer,l=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,h=new Bo(this._lodPlanes[r],l),d=l.uniforms,f=this._sizeLods[i]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*xS-1),g=s/p,_=isFinite(s)?1+Math.floor(u*g):xS;_>xS&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${_} samples when the maximum is set to ${xS}`);const v=[];let E=0;for(let I=0;I<xS;++I){const k=I/g,L=Math.exp(-k*k/2);v.push(L),I===0?E+=L:I<_&&(E+=2*L)}for(let I=0;I<v.length;I++)v[I]=v[I]/E;d.envMap.value=e.texture,d.samples.value=_,d.weights.value=v,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:T}=this;d.dTheta.value=p,d.mipInt.value=T-i;const x=this._sizeLods[r],N=3*x*(r>T-I1?r-T+I1:0),A=4*(this._cubeSize-x);wk(n,N,A,3*x,2*x),c.setRenderTarget(n),c.render(h,Vz)}}function ERe(t){const e=[],n=[],i=[];let r=t;const s=t-I1+1+yK.length;for(let a=0;a<s;a++){const o=Math.pow(2,r);n.push(o);let c=1/o;a>t-I1?c=yK[a-t+I1-1]:a===0&&(c=0),i.push(c);const l=1/(o-2),u=-l,h=1+l,d=[u,u,h,u,h,h,u,u,h,h,u,h],f=6,p=6,g=3,_=2,v=1,E=new Float32Array(g*p*f),T=new Float32Array(_*p*f),x=new Float32Array(v*p*f);for(let A=0;A<f;A++){const I=A%3*2/3-1,k=A>2?0:-1,L=[I,k,0,I+2/3,k,0,I+2/3,k+1,0,I,k,0,I+2/3,k+1,0,I,k+1,0];E.set(L,g*p*A),T.set(d,_*p*A);const U=[A,A,A,A,A,A];x.set(U,v*p*A)}const N=new Qi;N.setAttribute("position",new rr(E,g)),N.setAttribute("uv",new rr(T,_)),N.setAttribute("faceIndex",new rr(x,v)),e.push(N),r>I1&&r--}return{lodPlanes:e,sizeLods:n,sigmas:i}}function EK(t,e,n){const i=new Ul(t,e,n);return i.texture.mapping=IC,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function wk(t,e,n,i,r){t.viewport.set(e,n,i,r),t.scissor.set(e,n,i,r)}function SRe(t,e,n){const i=new Float32Array(xS),r=new Re(0,1,0);return new Bc({name:"SphericalGaussianBlur",defines:{n:xS,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:$q(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Yf,depthTest:!1,depthWrite:!1})}function SK(){return new Bc({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$q(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Yf,depthTest:!1,depthWrite:!1})}function TK(){return new Bc({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$q(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Yf,depthTest:!1,depthWrite:!1})}function $q(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function TRe(t){let e=new WeakMap,n=null;function i(o){if(o&&o.isTexture){const c=o.mapping,l=c===mM||c===gM,u=c===Xv||c===vb;if(l||u){let h=e.get(o);const d=h!==void 0?h.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return n===null&&(n=new zj(t)),h=l?n.fromEquirectangular(o,h):n.fromCubemap(o,h),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),h.texture;if(h!==void 0)return h.texture;{const f=o.image;return l&&f&&f.height>0||u&&f&&r(f)?(n===null&&(n=new zj(t)),h=l?n.fromEquirectangular(o):n.fromCubemap(o),h.texture.pmremVersion=o.pmremVersion,e.set(o,h),o.addEventListener("dispose",s),h.texture):null}}}return o}function r(o){let c=0;const l=6;for(let u=0;u<l;u++)o[u]!==void 0&&c++;return c===l}function s(o){const c=o.target;c.removeEventListener("dispose",s);const l=e.get(c);l!==void 0&&(e.delete(c),l.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:a}}function xRe(t){const e={};function n(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(i)}return e[i]=r,r}return{has:function(i){return n(i)!==null},init:function(){n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance"),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture"),n("WEBGL_render_shared_exponent")},get:function(i){const r=n(i);return r===null&&PD("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function wRe(t,e,n,i){const r={},s=new WeakMap;function a(h){const d=h.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete r[d.id];const f=s.get(d);f&&(e.remove(f),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,n.memory.geometries--}function o(h,d){return r[d.id]===!0||(d.addEventListener("dispose",a),r[d.id]=!0,n.memory.geometries++),d}function c(h){const d=h.attributes;for(const f in d)e.update(d[f],t.ARRAY_BUFFER)}function l(h){const d=[],f=h.index,p=h.attributes.position;let g=0;if(f!==null){const E=f.array;g=f.version;for(let T=0,x=E.length;T<x;T+=3){const N=E[T+0],A=E[T+1],I=E[T+2];d.push(N,A,A,I,I,N)}}else if(p!==void 0){const E=p.array;g=p.version;for(let T=0,x=E.length/3-1;T<x;T+=3){const N=T+0,A=T+1,I=T+2;d.push(N,A,A,I,I,N)}}else return;const _=new(Bse(d)?Eq:bq)(d,1);_.version=g;const v=s.get(h);v&&e.remove(v),s.set(h,_)}function u(h){const d=s.get(h);if(d){const f=h.index;f!==null&&d.version<f.version&&l(h)}else l(h);return s.get(h)}return{get:o,update:c,getWireframeAttribute:u}}function CRe(t,e,n){let i;function r(d){i=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function c(d,f){t.drawElements(i,f,s,d*a),n.update(f,i,1)}function l(d,f,p){p!==0&&(t.drawElementsInstanced(i,f,s,d*a,p),n.update(f,i,p))}function u(d,f,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,f,0,s,d,0,p);let _=0;for(let v=0;v<p;v++)_+=f[v];n.update(_,i,1)}function h(d,f,p,g){if(p===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let v=0;v<d.length;v++)l(d[v]/a,f[v],g[v]);else{_.multiDrawElementsInstancedWEBGL(i,f,0,s,d,0,g,0,p);let v=0;for(let E=0;E<p;E++)v+=f[E]*g[E];n.update(v,i,1)}}this.setMode=r,this.setIndex=o,this.render=c,this.renderInstances=l,this.renderMultiDraw=u,this.renderMultiDrawInstances=h}function RRe(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=o*(s/3);break;case t.LINES:n.lines+=o*(s/2);break;case t.LINE_STRIP:n.lines+=o*(s-1);break;case t.LINE_LOOP:n.lines+=o*s;break;case t.POINTS:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function r(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:r,update:i}}function ARe(t,e,n){const i=new WeakMap,r=new Kr;function s(a,o,c){const l=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,h=u!==void 0?u.length:0;let d=i.get(o);if(d===void 0||d.count!==h){let L=function(){I.dispose(),i.delete(o),o.removeEventListener("dispose",L)};d!==void 0&&d.texture.dispose();const f=o.morphAttributes.position!==void 0,p=o.morphAttributes.normal!==void 0,g=o.morphAttributes.color!==void 0,_=o.morphAttributes.position||[],v=o.morphAttributes.normal||[],E=o.morphAttributes.color||[];let T=0;f===!0&&(T=1),p===!0&&(T=2),g===!0&&(T=3);let x=o.attributes.position.count*T,N=1;x>e.maxTextureSize&&(N=Math.ceil(x/e.maxTextureSize),x=e.maxTextureSize);const A=new Float32Array(x*N*4*h),I=new KO(A,x,N,h);I.type=iu,I.needsUpdate=!0;const k=T*4;for(let U=0;U<h;U++){const $=_[U],q=v[U],G=E[U],X=x*N*4*U;for(let ie=0;ie<$.count;ie++){const V=ie*k;f===!0&&(r.fromBufferAttribute($,ie),A[X+V+0]=r.x,A[X+V+1]=r.y,A[X+V+2]=r.z,A[X+V+3]=0),p===!0&&(r.fromBufferAttribute(q,ie),A[X+V+4]=r.x,A[X+V+5]=r.y,A[X+V+6]=r.z,A[X+V+7]=0),g===!0&&(r.fromBufferAttribute(G,ie),A[X+V+8]=r.x,A[X+V+9]=r.y,A[X+V+10]=r.z,A[X+V+11]=G.itemSize===4?r.w:1)}}d={count:h,texture:I,size:new Rt(x,N)},i.set(o,d),o.addEventListener("dispose",L)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)c.getUniforms().setValue(t,"morphTexture",a.morphTexture,n);else{let f=0;for(let g=0;g<l.length;g++)f+=l[g];const p=o.morphTargetsRelative?1:1-f;c.getUniforms().setValue(t,"morphTargetBaseInfluence",p),c.getUniforms().setValue(t,"morphTargetInfluences",l)}c.getUniforms().setValue(t,"morphTargetsTexture",d.texture,n),c.getUniforms().setValue(t,"morphTargetsTextureSize",d.size)}return{update:s}}function MRe(t,e,n,i){let r=new WeakMap;function s(c){const l=i.render.frame,u=c.geometry,h=e.get(c,u);if(r.get(h)!==l&&(e.update(h),r.set(h,l)),c.isInstancedMesh&&(c.hasEventListener("dispose",o)===!1&&c.addEventListener("dispose",o),r.get(c)!==l&&(n.update(c.instanceMatrix,t.ARRAY_BUFFER),c.instanceColor!==null&&n.update(c.instanceColor,t.ARRAY_BUFFER),r.set(c,l))),c.isSkinnedMesh){const d=c.skeleton;r.get(d)!==l&&(d.update(),r.set(d,l))}return h}function a(){r=new WeakMap}function o(c){const l=c.target;l.removeEventListener("dispose",o),n.remove(l.instanceMatrix),l.instanceColor!==null&&n.remove(l.instanceColor)}return{update:s,dispose:a}}const Gae=new Pa,xK=new PC(1,1),qae=new KO,$ae=new t3,Wae=new ZO,wK=[],CK=[],RK=new Float32Array(16),AK=new Float32Array(9),MK=new Float32Array(4);function UC(t,e,n){const i=t[0];if(i<=0||i>0)return t;const r=e*n;let s=wK[r];if(s===void 0&&(s=new Float32Array(r),wK[r]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function Fc(t,e){if(t.length!==e.length)return!1;for(let n=0,i=t.length;n<i;n++)if(t[n]!==e[n])return!1;return!0}function zc(t,e){for(let n=0,i=e.length;n<i;n++)t[n]=e[n]}function S3(t,e){let n=CK[e];n===void 0&&(n=new Int32Array(e),CK[e]=n);for(let i=0;i!==e;++i)n[i]=t.allocateTextureUnit();return n}function ORe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function NRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Fc(n,e))return;t.uniform2fv(this.addr,e),zc(n,e)}}function IRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(Fc(n,e))return;t.uniform3fv(this.addr,e),zc(n,e)}}function kRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Fc(n,e))return;t.uniform4fv(this.addr,e),zc(n,e)}}function DRe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fc(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),zc(n,e)}else{if(Fc(n,i))return;MK.set(i),t.uniformMatrix2fv(this.addr,!1,MK),zc(n,i)}}function PRe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fc(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),zc(n,e)}else{if(Fc(n,i))return;AK.set(i),t.uniformMatrix3fv(this.addr,!1,AK),zc(n,i)}}function LRe(t,e){const n=this.cache,i=e.elements;if(i===void 0){if(Fc(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),zc(n,e)}else{if(Fc(n,i))return;RK.set(i),t.uniformMatrix4fv(this.addr,!1,RK),zc(n,i)}}function URe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function BRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Fc(n,e))return;t.uniform2iv(this.addr,e),zc(n,e)}}function FRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Fc(n,e))return;t.uniform3iv(this.addr,e),zc(n,e)}}function zRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Fc(n,e))return;t.uniform4iv(this.addr,e),zc(n,e)}}function HRe(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function jRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(Fc(n,e))return;t.uniform2uiv(this.addr,e),zc(n,e)}}function VRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(Fc(n,e))return;t.uniform3uiv(this.addr,e),zc(n,e)}}function GRe(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(Fc(n,e))return;t.uniform4uiv(this.addr,e),zc(n,e)}}function qRe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r);let s;this.type===t.SAMPLER_2D_SHADOW?(xK.compareFunction=yq,s=xK):s=Gae,n.setTexture2D(e||s,r)}function $Re(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(e||$ae,r)}function WRe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTextureCube(e||Wae,r)}function YRe(t,e,n){const i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(e||qae,r)}function XRe(t){switch(t){case 5126:return ORe;case 35664:return NRe;case 35665:return IRe;case 35666:return kRe;case 35674:return DRe;case 35675:return PRe;case 35676:return LRe;case 5124:case 35670:return URe;case 35667:case 35671:return BRe;case 35668:case 35672:return FRe;case 35669:case 35673:return zRe;case 5125:return HRe;case 36294:return jRe;case 36295:return VRe;case 36296:return GRe;case 35678:case 36198:case 36298:case 36306:case 35682:return qRe;case 35679:case 36299:case 36307:return $Re;case 35680:case 36300:case 36308:case 36293:return WRe;case 36289:case 36303:case 36311:case 36292:return YRe}}function KRe(t,e){t.uniform1fv(this.addr,e)}function JRe(t,e){const n=UC(e,this.size,2);t.uniform2fv(this.addr,n)}function ZRe(t,e){const n=UC(e,this.size,3);t.uniform3fv(this.addr,n)}function QRe(t,e){const n=UC(e,this.size,4);t.uniform4fv(this.addr,n)}function eAe(t,e){const n=UC(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function tAe(t,e){const n=UC(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function nAe(t,e){const n=UC(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function iAe(t,e){t.uniform1iv(this.addr,e)}function rAe(t,e){t.uniform2iv(this.addr,e)}function sAe(t,e){t.uniform3iv(this.addr,e)}function aAe(t,e){t.uniform4iv(this.addr,e)}function oAe(t,e){t.uniform1uiv(this.addr,e)}function cAe(t,e){t.uniform2uiv(this.addr,e)}function lAe(t,e){t.uniform3uiv(this.addr,e)}function uAe(t,e){t.uniform4uiv(this.addr,e)}function hAe(t,e,n){const i=this.cache,r=e.length,s=S3(n,r);Fc(i,s)||(t.uniform1iv(this.addr,s),zc(i,s));for(let a=0;a!==r;++a)n.setTexture2D(e[a]||Gae,s[a])}function dAe(t,e,n){const i=this.cache,r=e.length,s=S3(n,r);Fc(i,s)||(t.uniform1iv(this.addr,s),zc(i,s));for(let a=0;a!==r;++a)n.setTexture3D(e[a]||$ae,s[a])}function fAe(t,e,n){const i=this.cache,r=e.length,s=S3(n,r);Fc(i,s)||(t.uniform1iv(this.addr,s),zc(i,s));for(let a=0;a!==r;++a)n.setTextureCube(e[a]||Wae,s[a])}function pAe(t,e,n){const i=this.cache,r=e.length,s=S3(n,r);Fc(i,s)||(t.uniform1iv(this.addr,s),zc(i,s));for(let a=0;a!==r;++a)n.setTexture2DArray(e[a]||qae,s[a])}function mAe(t){switch(t){case 5126:return KRe;case 35664:return JRe;case 35665:return ZRe;case 35666:return QRe;case 35674:return eAe;case 35675:return tAe;case 35676:return nAe;case 5124:case 35670:return iAe;case 35667:case 35671:return rAe;case 35668:case 35672:return sAe;case 35669:case 35673:return aAe;case 5125:return oAe;case 36294:return cAe;case 36295:return lAe;case 36296:return uAe;case 35678:case 36198:case 36298:case 36306:case 35682:return hAe;case 35679:case 36299:case 36307:return dAe;case 35680:case 36300:case 36308:case 36293:return fAe;case 36289:case 36303:case 36311:case 36292:return pAe}}class gAe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.setValue=XRe(n.type)}}class vAe{constructor(e,n,i){this.id=e,this.addr=i,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=mAe(n.type)}}class yAe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,i){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const o=r[s];o.setValue(e,n[o.id],i)}}}const Yz=/(\w+)(\])?(\[|\.)?/g;function OK(t,e){t.seq.push(e),t.map[e.id]=e}function _Ae(t,e,n){const i=t.name,r=i.length;for(Yz.lastIndex=0;;){const s=Yz.exec(i),a=Yz.lastIndex;let o=s[1];const c=s[2]==="]",l=s[3];if(c&&(o=o|0),l===void 0||l==="["&&a+2===r){OK(n,l===void 0?new gAe(o,t,e):new vAe(o,t,e));break}else{let h=n.map[o];h===void 0&&(h=new yAe(o),OK(n,h)),n=h}}}class UD{constructor(e,n){this.seq=[],this.map={};const i=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(n,r),a=e.getUniformLocation(n,s.name);_Ae(s,a,this)}}setValue(e,n,i,r){const s=this.map[n];s!==void 0&&s.setValue(e,i,r)}setOptional(e,n,i){const r=n[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,n,i,r){for(let s=0,a=n.length;s!==a;++s){const o=n[s],c=i[o.id];c.needsUpdate!==!1&&o.setValue(e,c.value,r)}}static seqWithValue(e,n){const i=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in n&&i.push(a)}return i}}function NK(t,e,n){const i=t.createShader(e);return t.shaderSource(i,n),t.compileShader(i),i}const bAe=37297;let EAe=0;function SAe(t,e){const n=t.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=r;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${n[a]}`)}return i.join(`
`)}const IK=new Zi;function TAe(t){Lr._getMatrix(IK,Lr.workingColorSpace,t);const e=`mat3( ${IK.elements.map(n=>n.toFixed(4))} )`;switch(Lr.getTransfer(t)){case EM:return[e,"LinearTransferOETF"];case ws:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",t),[e,"LinearTransferOETF"]}}function kK(t,e,n){const i=t.getShaderParameter(e,t.COMPILE_STATUS),r=t.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const a=parseInt(s[1]);return n.toUpperCase()+`

`+r+`

`+SAe(t.getShaderSource(e),a)}else return r}function xAe(t,e){const n=TAe(e);return[`vec4 ${t}( vec4 value ) {`,`	return ${n[1]}( vec4( value.rgb * ${n[0]}, value.a ) );`,"}"].join(`
`)}function wAe(t,e){let n;switch(e){case yse:n="Linear";break;case _se:n="Reinhard";break;case bse:n="Cineon";break;case cq:n="ACESFilmic";break;case Sse:n="AgX";break;case Tse:n="Neutral";break;case Ese:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}const Ck=new Re;function CAe(){Lr.getLuminanceCoefficients(Ck);const t=Ck.x.toFixed(4),e=Ck.y.toFixed(4),n=Ck.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${t}, ${e}, ${n} );`,"	return dot( weights, rgb );","}"].join(`
`)}function RAe(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",t.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(dA).join(`
`)}function AAe(t){const e=[];for(const n in t){const i=t[n];i!==!1&&e.push("#define "+n+" "+i)}return e.join(`
`)}function MAe(t,e){const n={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=t.getActiveAttrib(e,r),a=s.name;let o=1;s.type===t.FLOAT_MAT2&&(o=2),s.type===t.FLOAT_MAT3&&(o=3),s.type===t.FLOAT_MAT4&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}function dA(t){return t!==""}function DK(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function PK(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const OAe=/^[ \t]*#include +<([\w\d./]+)>/gm;function Hj(t){return t.replace(OAe,IAe)}const NAe=new Map;function IAe(t,e){let n=ir[e];if(n===void 0){const i=NAe.get(e);if(i!==void 0)n=ir[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return Hj(n)}const kAe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LK(t){return t.replace(kAe,DAe)}function DAe(t,e,n,i){let r="";for(let s=parseInt(e);s<parseInt(n);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function UK(t){let e=`precision ${t.precision} float;
	precision ${t.precision} int;
	precision ${t.precision} sampler2D;
	precision ${t.precision} samplerCube;
	precision ${t.precision} sampler3D;
	precision ${t.precision} sampler2DArray;
	precision ${t.precision} sampler2DShadow;
	precision ${t.precision} samplerCubeShadow;
	precision ${t.precision} sampler2DArrayShadow;
	precision ${t.precision} isampler2D;
	precision ${t.precision} isampler3D;
	precision ${t.precision} isamplerCube;
	precision ${t.precision} isampler2DArray;
	precision ${t.precision} usampler2D;
	precision ${t.precision} usampler3D;
	precision ${t.precision} usamplerCube;
	precision ${t.precision} usampler2DArray;
	`;return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function PAe(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===$U?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===CA?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===Bp&&(e="SHADOWMAP_TYPE_VSM"),e}function LAe(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case Xv:case vb:e="ENVMAP_TYPE_CUBE";break;case IC:e="ENVMAP_TYPE_CUBE_UV";break}return e}function UAe(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case vb:e="ENVMAP_MODE_REFRACTION";break}return e}function BAe(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case WO:e="ENVMAP_BLENDING_MULTIPLY";break;case gse:e="ENVMAP_BLENDING_MIX";break;case vse:e="ENVMAP_BLENDING_ADD";break}return e}function FAe(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function zAe(t,e,n,i){const r=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const c=PAe(n),l=LAe(n),u=UAe(n),h=BAe(n),d=FAe(n),f=RAe(n),p=AAe(s),g=r.createProgram();let _,v,E=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(_=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dA).join(`
`),_.length>0&&(_+=`
`),v=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p].filter(dA).join(`
`),v.length>0&&(v+=`
`)):(_=[UK(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.batchingColor?"#define USE_BATCHING_COLOR":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.instancingMorph?"#define USE_INSTANCING_MORPH":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(dA).join(`
`),v=[UK(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+u:"",n.envMap?"#define "+h:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.dispersion?"#define USE_DISPERSION":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor||n.batchingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+c:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==Kp?"#define TONE_MAPPING":"",n.toneMapping!==Kp?ir.tonemapping_pars_fragment:"",n.toneMapping!==Kp?wAe("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",ir.colorspace_pars_fragment,xAe("linearToOutputTexel",n.outputColorSpace),CAe(),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(dA).join(`
`)),a=Hj(a),a=DK(a,n),a=PK(a,n),o=Hj(o),o=DK(o,n),o=PK(o,n),a=LK(a),o=LK(o),n.isRawShaderMaterial!==!0&&(E=`#version 300 es
`,_=[f,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+_,v=["#define varying in",n.glslVersion===Ij?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Ij?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const T=E+_+a,x=E+v+o,N=NK(r,r.VERTEX_SHADER,T),A=NK(r,r.FRAGMENT_SHADER,x);r.attachShader(g,N),r.attachShader(g,A),n.index0AttributeName!==void 0?r.bindAttribLocation(g,0,n.index0AttributeName):n.morphTargets===!0&&r.bindAttribLocation(g,0,"position"),r.linkProgram(g);function I($){if(t.debug.checkShaderErrors){const q=r.getProgramInfoLog(g).trim(),G=r.getShaderInfoLog(N).trim(),X=r.getShaderInfoLog(A).trim();let ie=!0,V=!0;if(r.getProgramParameter(g,r.LINK_STATUS)===!1)if(ie=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(r,g,N,A);else{const Z=kK(r,N,"vertex"),Y=kK(r,A,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(g,r.VALIDATE_STATUS)+`

Material Name: `+$.name+`
Material Type: `+$.type+`

Program Info Log: `+q+`
`+Z+`
`+Y)}else q!==""?console.warn("THREE.WebGLProgram: Program Info Log:",q):(G===""||X==="")&&(V=!1);V&&($.diagnostics={runnable:ie,programLog:q,vertexShader:{log:G,prefix:_},fragmentShader:{log:X,prefix:v}})}r.deleteShader(N),r.deleteShader(A),k=new UD(r,g),L=MAe(r,g)}let k;this.getUniforms=function(){return k===void 0&&I(this),k};let L;this.getAttributes=function(){return L===void 0&&I(this),L};let U=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return U===!1&&(U=r.getProgramParameter(g,bAe)),U},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=EAe++,this.cacheKey=e,this.usedTimes=1,this.program=g,this.vertexShader=N,this.fragmentShader=A,this}let HAe=0;class jAe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(n),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let i=n.get(e);return i===void 0&&(i=new Set,n.set(e,i)),i}_getShaderStage(e){const n=this.shaderCache;let i=n.get(e);return i===void 0&&(i=new VAe(e),n.set(e,i)),i}}class VAe{constructor(e){this.id=HAe++,this.code=e,this.usedTimes=0}}function GAe(t,e,n,i,r,s,a){const o=new Lw,c=new jAe,l=new Set,u=[],h=r.logarithmicDepthBuffer,d=r.vertexTextures;let f=r.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(L){return l.add(L),L===0?"uv":`uv${L}`}function _(L,U,$,q,G){const X=q.fog,ie=G.geometry,V=L.isMeshStandardMaterial?q.environment:null,Z=(L.isMeshStandardMaterial?n:e).get(L.envMap||V),Y=Z&&Z.mapping===IC?Z.image.height:null,ee=p[L.type];L.precision!==null&&(f=r.getMaxPrecision(L.precision),f!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",f,"instead."));const oe=ie.morphAttributes.position||ie.morphAttributes.normal||ie.morphAttributes.color,de=oe!==void 0?oe.length:0;let Me=0;ie.morphAttributes.position!==void 0&&(Me=1),ie.morphAttributes.normal!==void 0&&(Me=2),ie.morphAttributes.color!==void 0&&(Me=3);let He,Te,Le,we;if(ee){const Nt=Hp[ee];He=Nt.vertexShader,Te=Nt.fragmentShader}else He=L.vertexShader,Te=L.fragmentShader,c.update(L),Le=c.getVertexShaderID(L),we=c.getFragmentShaderID(L);const Ce=t.getRenderTarget(),ke=t.state.buffers.depth.getReversed(),St=G.isInstancedMesh===!0,At=G.isBatchedMesh===!0,Ee=!!L.map,ye=!!L.matcap,et=!!Z,fe=!!L.aoMap,Fe=!!L.lightMap,Ie=!!L.bumpMap,it=!!L.normalMap,dt=!!L.displacementMap,gt=!!L.emissiveMap,bt=!!L.metalnessMap,be=!!L.roughnessMap,ue=L.anisotropy>0,Xe=L.clearcoat>0,nt=L.dispersion>0,$e=L.iridescence>0,Ue=L.sheen>0,qt=L.transmission>0,Mt=ue&&!!L.anisotropyMap,Yt=Xe&&!!L.clearcoatMap,ce=Xe&&!!L.clearcoatNormalMap,j=Xe&&!!L.clearcoatRoughnessMap,W=$e&&!!L.iridescenceMap,me=$e&&!!L.iridescenceThicknessMap,De=Ue&&!!L.sheenColorMap,je=Ue&&!!L.sheenRoughnessMap,mt=!!L.specularMap,xt=!!L.specularColorMap,Vn=!!L.specularIntensityMap,qe=qt&&!!L.transmissionMap,Vt=qt&&!!L.thicknessMap,ht=!!L.gradientMap,Pt=!!L.alphaMap,hn=L.alphaTest>0,an=!!L.alphaHash,Ve=!!L.extensions;let ot=Kp;L.toneMapped&&(Ce===null||Ce.isXRRenderTarget===!0)&&(ot=t.toneMapping);const Ct={shaderID:ee,shaderType:L.type,shaderName:L.name,vertexShader:He,fragmentShader:Te,defines:L.defines,customVertexShaderID:Le,customFragmentShaderID:we,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:f,batching:At,batchingColor:At&&G._colorsTexture!==null,instancing:St,instancingColor:St&&G.instanceColor!==null,instancingMorph:St&&G.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:Ce===null?t.outputColorSpace:Ce.isXRRenderTarget===!0?Ce.texture.colorSpace:Lg,alphaToCoverage:!!L.alphaToCoverage,map:Ee,matcap:ye,envMap:et,envMapMode:et&&Z.mapping,envMapCubeUVHeight:Y,aoMap:fe,lightMap:Fe,bumpMap:Ie,normalMap:it,displacementMap:d&&dt,emissiveMap:gt,normalMapObjectSpace:it&&L.normalMapType===Mse,normalMapTangentSpace:it&&L.normalMapType===Bb,metalnessMap:bt,roughnessMap:be,anisotropy:ue,anisotropyMap:Mt,clearcoat:Xe,clearcoatMap:Yt,clearcoatNormalMap:ce,clearcoatRoughnessMap:j,dispersion:nt,iridescence:$e,iridescenceMap:W,iridescenceThicknessMap:me,sheen:Ue,sheenColorMap:De,sheenRoughnessMap:je,specularMap:mt,specularColorMap:xt,specularIntensityMap:Vn,transmission:qt,transmissionMap:qe,thicknessMap:Vt,gradientMap:ht,opaque:L.transparent===!1&&L.blending===US&&L.alphaToCoverage===!1,alphaMap:Pt,alphaTest:hn,alphaHash:an,combine:L.combine,mapUv:Ee&&g(L.map.channel),aoMapUv:fe&&g(L.aoMap.channel),lightMapUv:Fe&&g(L.lightMap.channel),bumpMapUv:Ie&&g(L.bumpMap.channel),normalMapUv:it&&g(L.normalMap.channel),displacementMapUv:dt&&g(L.displacementMap.channel),emissiveMapUv:gt&&g(L.emissiveMap.channel),metalnessMapUv:bt&&g(L.metalnessMap.channel),roughnessMapUv:be&&g(L.roughnessMap.channel),anisotropyMapUv:Mt&&g(L.anisotropyMap.channel),clearcoatMapUv:Yt&&g(L.clearcoatMap.channel),clearcoatNormalMapUv:ce&&g(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:j&&g(L.clearcoatRoughnessMap.channel),iridescenceMapUv:W&&g(L.iridescenceMap.channel),iridescenceThicknessMapUv:me&&g(L.iridescenceThicknessMap.channel),sheenColorMapUv:De&&g(L.sheenColorMap.channel),sheenRoughnessMapUv:je&&g(L.sheenRoughnessMap.channel),specularMapUv:mt&&g(L.specularMap.channel),specularColorMapUv:xt&&g(L.specularColorMap.channel),specularIntensityMapUv:Vn&&g(L.specularIntensityMap.channel),transmissionMapUv:qe&&g(L.transmissionMap.channel),thicknessMapUv:Vt&&g(L.thicknessMap.channel),alphaMapUv:Pt&&g(L.alphaMap.channel),vertexTangents:!!ie.attributes.tangent&&(it||ue),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!ie.attributes.color&&ie.attributes.color.itemSize===4,pointsUvs:G.isPoints===!0&&!!ie.attributes.uv&&(Ee||Pt),fog:!!X,useFog:L.fog===!0,fogExp2:!!X&&X.isFogExp2,flatShading:L.flatShading===!0,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:h,reverseDepthBuffer:ke,skinning:G.isSkinnedMesh===!0,morphTargets:ie.morphAttributes.position!==void 0,morphNormals:ie.morphAttributes.normal!==void 0,morphColors:ie.morphAttributes.color!==void 0,morphTargetsCount:de,morphTextureStride:Me,numDirLights:U.directional.length,numPointLights:U.point.length,numSpotLights:U.spot.length,numSpotLightMaps:U.spotLightMap.length,numRectAreaLights:U.rectArea.length,numHemiLights:U.hemi.length,numDirLightShadows:U.directionalShadowMap.length,numPointLightShadows:U.pointShadowMap.length,numSpotLightShadows:U.spotShadowMap.length,numSpotLightShadowsWithMaps:U.numSpotLightShadowsWithMaps,numLightProbes:U.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:L.dithering,shadowMapEnabled:t.shadowMap.enabled&&$.length>0,shadowMapType:t.shadowMap.type,toneMapping:ot,decodeVideoTexture:Ee&&L.map.isVideoTexture===!0&&Lr.getTransfer(L.map.colorSpace)===ws,decodeVideoTextureEmissive:gt&&L.emissiveMap.isVideoTexture===!0&&Lr.getTransfer(L.emissiveMap.colorSpace)===ws,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===cl,flipSided:L.side===Pc,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:Ve&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ve&&L.extensions.multiDraw===!0||At)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Ct.vertexUv1s=l.has(1),Ct.vertexUv2s=l.has(2),Ct.vertexUv3s=l.has(3),l.clear(),Ct}function v(L){const U=[];if(L.shaderID?U.push(L.shaderID):(U.push(L.customVertexShaderID),U.push(L.customFragmentShaderID)),L.defines!==void 0)for(const $ in L.defines)U.push($),U.push(L.defines[$]);return L.isRawShaderMaterial===!1&&(E(U,L),T(U,L),U.push(t.outputColorSpace)),U.push(L.customProgramCacheKey),U.join()}function E(L,U){L.push(U.precision),L.push(U.outputColorSpace),L.push(U.envMapMode),L.push(U.envMapCubeUVHeight),L.push(U.mapUv),L.push(U.alphaMapUv),L.push(U.lightMapUv),L.push(U.aoMapUv),L.push(U.bumpMapUv),L.push(U.normalMapUv),L.push(U.displacementMapUv),L.push(U.emissiveMapUv),L.push(U.metalnessMapUv),L.push(U.roughnessMapUv),L.push(U.anisotropyMapUv),L.push(U.clearcoatMapUv),L.push(U.clearcoatNormalMapUv),L.push(U.clearcoatRoughnessMapUv),L.push(U.iridescenceMapUv),L.push(U.iridescenceThicknessMapUv),L.push(U.sheenColorMapUv),L.push(U.sheenRoughnessMapUv),L.push(U.specularMapUv),L.push(U.specularColorMapUv),L.push(U.specularIntensityMapUv),L.push(U.transmissionMapUv),L.push(U.thicknessMapUv),L.push(U.combine),L.push(U.fogExp2),L.push(U.sizeAttenuation),L.push(U.morphTargetsCount),L.push(U.morphAttributeCount),L.push(U.numDirLights),L.push(U.numPointLights),L.push(U.numSpotLights),L.push(U.numSpotLightMaps),L.push(U.numHemiLights),L.push(U.numRectAreaLights),L.push(U.numDirLightShadows),L.push(U.numPointLightShadows),L.push(U.numSpotLightShadows),L.push(U.numSpotLightShadowsWithMaps),L.push(U.numLightProbes),L.push(U.shadowMapType),L.push(U.toneMapping),L.push(U.numClippingPlanes),L.push(U.numClipIntersection),L.push(U.depthPacking)}function T(L,U){o.disableAll(),U.supportsVertexTextures&&o.enable(0),U.instancing&&o.enable(1),U.instancingColor&&o.enable(2),U.instancingMorph&&o.enable(3),U.matcap&&o.enable(4),U.envMap&&o.enable(5),U.normalMapObjectSpace&&o.enable(6),U.normalMapTangentSpace&&o.enable(7),U.clearcoat&&o.enable(8),U.iridescence&&o.enable(9),U.alphaTest&&o.enable(10),U.vertexColors&&o.enable(11),U.vertexAlphas&&o.enable(12),U.vertexUv1s&&o.enable(13),U.vertexUv2s&&o.enable(14),U.vertexUv3s&&o.enable(15),U.vertexTangents&&o.enable(16),U.anisotropy&&o.enable(17),U.alphaHash&&o.enable(18),U.batching&&o.enable(19),U.dispersion&&o.enable(20),U.batchingColor&&o.enable(21),L.push(o.mask),o.disableAll(),U.fog&&o.enable(0),U.useFog&&o.enable(1),U.flatShading&&o.enable(2),U.logarithmicDepthBuffer&&o.enable(3),U.reverseDepthBuffer&&o.enable(4),U.skinning&&o.enable(5),U.morphTargets&&o.enable(6),U.morphNormals&&o.enable(7),U.morphColors&&o.enable(8),U.premultipliedAlpha&&o.enable(9),U.shadowMapEnabled&&o.enable(10),U.doubleSided&&o.enable(11),U.flipSided&&o.enable(12),U.useDepthPacking&&o.enable(13),U.dithering&&o.enable(14),U.transmission&&o.enable(15),U.sheen&&o.enable(16),U.opaque&&o.enable(17),U.pointsUvs&&o.enable(18),U.decodeVideoTexture&&o.enable(19),U.decodeVideoTextureEmissive&&o.enable(20),U.alphaToCoverage&&o.enable(21),L.push(o.mask)}function x(L){const U=p[L.type];let $;if(U){const q=Hp[U];$=Vse.clone(q.uniforms)}else $=L.uniforms;return $}function N(L,U){let $;for(let q=0,G=u.length;q<G;q++){const X=u[q];if(X.cacheKey===U){$=X,++$.usedTimes;break}}return $===void 0&&($=new zAe(t,U,L,s),u.push($)),$}function A(L){if(--L.usedTimes===0){const U=u.indexOf(L);u[U]=u[u.length-1],u.pop(),L.destroy()}}function I(L){c.remove(L)}function k(){c.dispose()}return{getParameters:_,getProgramCacheKey:v,getUniforms:x,acquireProgram:N,releaseProgram:A,releaseShaderCache:I,programs:u,dispose:k}}function qAe(){let t=new WeakMap;function e(a){return t.has(a)}function n(a){let o=t.get(a);return o===void 0&&(o={},t.set(a,o)),o}function i(a){t.delete(a)}function r(a,o,c){t.get(a)[o]=c}function s(){t=new WeakMap}return{has:e,get:n,remove:i,update:r,dispose:s}}function $Ae(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function BK(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function FK(){const t=[];let e=0;const n=[],i=[],r=[];function s(){e=0,n.length=0,i.length=0,r.length=0}function a(h,d,f,p,g,_){let v=t[e];return v===void 0?(v={id:h.id,object:h,geometry:d,material:f,groupOrder:p,renderOrder:h.renderOrder,z:g,group:_},t[e]=v):(v.id=h.id,v.object=h,v.geometry=d,v.material=f,v.groupOrder=p,v.renderOrder=h.renderOrder,v.z=g,v.group=_),e++,v}function o(h,d,f,p,g,_){const v=a(h,d,f,p,g,_);f.transmission>0?i.push(v):f.transparent===!0?r.push(v):n.push(v)}function c(h,d,f,p,g,_){const v=a(h,d,f,p,g,_);f.transmission>0?i.unshift(v):f.transparent===!0?r.unshift(v):n.unshift(v)}function l(h,d){n.length>1&&n.sort(h||$Ae),i.length>1&&i.sort(d||BK),r.length>1&&r.sort(d||BK)}function u(){for(let h=e,d=t.length;h<d;h++){const f=t[h];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:i,transparent:r,init:s,push:o,unshift:c,finish:u,sort:l}}function WAe(){let t=new WeakMap;function e(i,r){const s=t.get(i);let a;return s===void 0?(a=new FK,t.set(i,[a])):r>=s.length?(a=new FK,s.push(a)):a=s[r],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function YAe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new Re,color:new _n};break;case"SpotLight":n={position:new Re,direction:new Re,color:new _n,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Re,color:new _n,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Re,skyColor:new _n,groundColor:new _n};break;case"RectAreaLight":n={color:new _n,position:new Re,halfWidth:new Re,halfHeight:new Re};break}return t[e.id]=n,n}}}function XAe(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"SpotLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt};break;case"PointLight":n={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rt,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let KAe=0;function JAe(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function ZAe(t){const e=new YAe,n=XAe(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let l=0;l<9;l++)i.probe.push(new Re);const r=new Re,s=new Ni,a=new Ni;function o(l){let u=0,h=0,d=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let f=0,p=0,g=0,_=0,v=0,E=0,T=0,x=0,N=0,A=0,I=0;l.sort(JAe);for(let L=0,U=l.length;L<U;L++){const $=l[L],q=$.color,G=$.intensity,X=$.distance,ie=$.shadow&&$.shadow.map?$.shadow.map.texture:null;if($.isAmbientLight)u+=q.r*G,h+=q.g*G,d+=q.b*G;else if($.isLightProbe){for(let V=0;V<9;V++)i.probe[V].addScaledVector($.sh.coefficients[V],G);I++}else if($.isDirectionalLight){const V=e.get($);if(V.color.copy($.color).multiplyScalar($.intensity),$.castShadow){const Z=$.shadow,Y=n.get($);Y.shadowIntensity=Z.intensity,Y.shadowBias=Z.bias,Y.shadowNormalBias=Z.normalBias,Y.shadowRadius=Z.radius,Y.shadowMapSize=Z.mapSize,i.directionalShadow[f]=Y,i.directionalShadowMap[f]=ie,i.directionalShadowMatrix[f]=$.shadow.matrix,E++}i.directional[f]=V,f++}else if($.isSpotLight){const V=e.get($);V.position.setFromMatrixPosition($.matrixWorld),V.color.copy(q).multiplyScalar(G),V.distance=X,V.coneCos=Math.cos($.angle),V.penumbraCos=Math.cos($.angle*(1-$.penumbra)),V.decay=$.decay,i.spot[g]=V;const Z=$.shadow;if($.map&&(i.spotLightMap[N]=$.map,N++,Z.updateMatrices($),$.castShadow&&A++),i.spotLightMatrix[g]=Z.matrix,$.castShadow){const Y=n.get($);Y.shadowIntensity=Z.intensity,Y.shadowBias=Z.bias,Y.shadowNormalBias=Z.normalBias,Y.shadowRadius=Z.radius,Y.shadowMapSize=Z.mapSize,i.spotShadow[g]=Y,i.spotShadowMap[g]=ie,x++}g++}else if($.isRectAreaLight){const V=e.get($);V.color.copy(q).multiplyScalar(G),V.halfWidth.set($.width*.5,0,0),V.halfHeight.set(0,$.height*.5,0),i.rectArea[_]=V,_++}else if($.isPointLight){const V=e.get($);if(V.color.copy($.color).multiplyScalar($.intensity),V.distance=$.distance,V.decay=$.decay,$.castShadow){const Z=$.shadow,Y=n.get($);Y.shadowIntensity=Z.intensity,Y.shadowBias=Z.bias,Y.shadowNormalBias=Z.normalBias,Y.shadowRadius=Z.radius,Y.shadowMapSize=Z.mapSize,Y.shadowCameraNear=Z.camera.near,Y.shadowCameraFar=Z.camera.far,i.pointShadow[p]=Y,i.pointShadowMap[p]=ie,i.pointShadowMatrix[p]=$.shadow.matrix,T++}i.point[p]=V,p++}else if($.isHemisphereLight){const V=e.get($);V.skyColor.copy($.color).multiplyScalar(G),V.groundColor.copy($.groundColor).multiplyScalar(G),i.hemi[v]=V,v++}}_>0&&(t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=vn.LTC_FLOAT_1,i.rectAreaLTC2=vn.LTC_FLOAT_2):(i.rectAreaLTC1=vn.LTC_HALF_1,i.rectAreaLTC2=vn.LTC_HALF_2)),i.ambient[0]=u,i.ambient[1]=h,i.ambient[2]=d;const k=i.hash;(k.directionalLength!==f||k.pointLength!==p||k.spotLength!==g||k.rectAreaLength!==_||k.hemiLength!==v||k.numDirectionalShadows!==E||k.numPointShadows!==T||k.numSpotShadows!==x||k.numSpotMaps!==N||k.numLightProbes!==I)&&(i.directional.length=f,i.spot.length=g,i.rectArea.length=_,i.point.length=p,i.hemi.length=v,i.directionalShadow.length=E,i.directionalShadowMap.length=E,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=x,i.spotShadowMap.length=x,i.directionalShadowMatrix.length=E,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=x+N-A,i.spotLightMap.length=N,i.numSpotLightShadowsWithMaps=A,i.numLightProbes=I,k.directionalLength=f,k.pointLength=p,k.spotLength=g,k.rectAreaLength=_,k.hemiLength=v,k.numDirectionalShadows=E,k.numPointShadows=T,k.numSpotShadows=x,k.numSpotMaps=N,k.numLightProbes=I,i.version=KAe++)}function c(l,u){let h=0,d=0,f=0,p=0,g=0;const _=u.matrixWorldInverse;for(let v=0,E=l.length;v<E;v++){const T=l[v];if(T.isDirectionalLight){const x=i.directional[h];x.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(_),h++}else if(T.isSpotLight){const x=i.spot[f];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(_),x.direction.setFromMatrixPosition(T.matrixWorld),r.setFromMatrixPosition(T.target.matrixWorld),x.direction.sub(r),x.direction.transformDirection(_),f++}else if(T.isRectAreaLight){const x=i.rectArea[p];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(_),a.identity(),s.copy(T.matrixWorld),s.premultiply(_),a.extractRotation(s),x.halfWidth.set(T.width*.5,0,0),x.halfHeight.set(0,T.height*.5,0),x.halfWidth.applyMatrix4(a),x.halfHeight.applyMatrix4(a),p++}else if(T.isPointLight){const x=i.point[d];x.position.setFromMatrixPosition(T.matrixWorld),x.position.applyMatrix4(_),d++}else if(T.isHemisphereLight){const x=i.hemi[g];x.direction.setFromMatrixPosition(T.matrixWorld),x.direction.transformDirection(_),g++}}}return{setup:o,setupView:c,state:i}}function zK(t){const e=new ZAe(t),n=[],i=[];function r(u){l.camera=u,n.length=0,i.length=0}function s(u){n.push(u)}function a(u){i.push(u)}function o(){e.setup(n)}function c(u){e.setupView(n,u)}const l={lightsArray:n,shadowsArray:i,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:l,setupLights:o,setupLightsView:c,pushLight:s,pushShadow:a}}function QAe(t){let e=new WeakMap;function n(r,s=0){const a=e.get(r);let o;return a===void 0?(o=new zK(t),e.set(r,[o])):s>=a.length?(o=new zK(t),a.push(o)):o=a[s],o}function i(){e=new WeakMap}return{get:n,dispose:i}}const eMe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,tMe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function nMe(t,e,n){let i=new DC;const r=new Rt,s=new Rt,a=new Kr,o=new kq({depthPacking:Ase}),c=new Dq,l={},u=n.maxTextureSize,h={[Dg]:Pc,[Pc]:Dg,[cl]:cl},d=new Bc({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rt},radius:{value:4}},vertexShader:eMe,fragmentShader:tMe}),f=d.clone();f.defines.HORIZONTAL_PASS=1;const p=new Qi;p.setAttribute("position",new rr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new Bo(p,d),_=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=$U;let v=this.type;this.render=function(A,I,k){if(_.enabled===!1||_.autoUpdate===!1&&_.needsUpdate===!1||A.length===0)return;const L=t.getRenderTarget(),U=t.getActiveCubeFace(),$=t.getActiveMipmapLevel(),q=t.state;q.setBlending(Yf),q.buffers.color.setClear(1,1,1,1),q.buffers.depth.setTest(!0),q.setScissorTest(!1);const G=v!==Bp&&this.type===Bp,X=v===Bp&&this.type!==Bp;for(let ie=0,V=A.length;ie<V;ie++){const Z=A[ie],Y=Z.shadow;if(Y===void 0){console.warn("THREE.WebGLShadowMap:",Z,"has no shadow.");continue}if(Y.autoUpdate===!1&&Y.needsUpdate===!1)continue;r.copy(Y.mapSize);const ee=Y.getFrameExtents();if(r.multiply(ee),s.copy(Y.mapSize),(r.x>u||r.y>u)&&(r.x>u&&(s.x=Math.floor(u/ee.x),r.x=s.x*ee.x,Y.mapSize.x=s.x),r.y>u&&(s.y=Math.floor(u/ee.y),r.y=s.y*ee.y,Y.mapSize.y=s.y)),Y.map===null||G===!0||X===!0){const de=this.type!==Bp?{minFilter:Za,magFilter:Za}:{};Y.map!==null&&Y.map.dispose(),Y.map=new Ul(r.x,r.y,de),Y.map.texture.name=Z.name+".shadowMap",Y.camera.updateProjectionMatrix()}t.setRenderTarget(Y.map),t.clear();const oe=Y.getViewportCount();for(let de=0;de<oe;de++){const Me=Y.getViewport(de);a.set(s.x*Me.x,s.y*Me.y,s.x*Me.z,s.y*Me.w),q.viewport(a),Y.updateMatrices(Z,de),i=Y.getFrustum(),x(I,k,Y.camera,Z,this.type)}Y.isPointLightShadow!==!0&&this.type===Bp&&E(Y,k),Y.needsUpdate=!1}v=this.type,_.needsUpdate=!1,t.setRenderTarget(L,U,$)};function E(A,I){const k=e.update(g);d.defines.VSM_SAMPLES!==A.blurSamples&&(d.defines.VSM_SAMPLES=A.blurSamples,f.defines.VSM_SAMPLES=A.blurSamples,d.needsUpdate=!0,f.needsUpdate=!0),A.mapPass===null&&(A.mapPass=new Ul(r.x,r.y)),d.uniforms.shadow_pass.value=A.map.texture,d.uniforms.resolution.value=A.mapSize,d.uniforms.radius.value=A.radius,t.setRenderTarget(A.mapPass),t.clear(),t.renderBufferDirect(I,null,k,d,g,null),f.uniforms.shadow_pass.value=A.mapPass.texture,f.uniforms.resolution.value=A.mapSize,f.uniforms.radius.value=A.radius,t.setRenderTarget(A.map),t.clear(),t.renderBufferDirect(I,null,k,f,g,null)}function T(A,I,k,L){let U=null;const $=k.isPointLight===!0?A.customDistanceMaterial:A.customDepthMaterial;if($!==void 0)U=$;else if(U=k.isPointLight===!0?c:o,t.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const q=U.uuid,G=I.uuid;let X=l[q];X===void 0&&(X={},l[q]=X);let ie=X[G];ie===void 0&&(ie=U.clone(),X[G]=ie,I.addEventListener("dispose",N)),U=ie}if(U.visible=I.visible,U.wireframe=I.wireframe,L===Bp?U.side=I.shadowSide!==null?I.shadowSide:I.side:U.side=I.shadowSide!==null?I.shadowSide:h[I.side],U.alphaMap=I.alphaMap,U.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,U.map=I.map,U.clipShadows=I.clipShadows,U.clippingPlanes=I.clippingPlanes,U.clipIntersection=I.clipIntersection,U.displacementMap=I.displacementMap,U.displacementScale=I.displacementScale,U.displacementBias=I.displacementBias,U.wireframeLinewidth=I.wireframeLinewidth,U.linewidth=I.linewidth,k.isPointLight===!0&&U.isMeshDistanceMaterial===!0){const q=t.properties.get(U);q.light=k}return U}function x(A,I,k,L,U){if(A.visible===!1)return;if(A.layers.test(I.layers)&&(A.isMesh||A.isLine||A.isPoints)&&(A.castShadow||A.receiveShadow&&U===Bp)&&(!A.frustumCulled||i.intersectsObject(A))){A.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,A.matrixWorld);const G=e.update(A),X=A.material;if(Array.isArray(X)){const ie=G.groups;for(let V=0,Z=ie.length;V<Z;V++){const Y=ie[V],ee=X[Y.materialIndex];if(ee&&ee.visible){const oe=T(A,ee,L,U);A.onBeforeShadow(t,A,I,k,G,oe,Y),t.renderBufferDirect(k,null,G,oe,A,Y),A.onAfterShadow(t,A,I,k,G,oe,Y)}}}else if(X.visible){const ie=T(A,X,L,U);A.onBeforeShadow(t,A,I,k,G,ie,null),t.renderBufferDirect(k,null,G,ie,A,null),A.onAfterShadow(t,A,I,k,G,ie,null)}}const q=A.children;for(let G=0,X=q.length;G<X;G++)x(q[G],I,k,L,U)}function N(A){A.target.removeEventListener("dispose",N);for(const k in l){const L=l[k],U=A.target.uuid;U in L&&(L[U].dispose(),delete L[U])}}}const iMe={[YP]:XP,[KP]:QP,[JP]:eL,[eT]:ZP,[XP]:YP,[QP]:KP,[eL]:JP,[ZP]:eT};function rMe(t,e){function n(){let qe=!1;const Vt=new Kr;let ht=null;const Pt=new Kr(0,0,0,0);return{setMask:function(hn){ht!==hn&&!qe&&(t.colorMask(hn,hn,hn,hn),ht=hn)},setLocked:function(hn){qe=hn},setClear:function(hn,an,Ve,ot,Ct){Ct===!0&&(hn*=ot,an*=ot,Ve*=ot),Vt.set(hn,an,Ve,ot),Pt.equals(Vt)===!1&&(t.clearColor(hn,an,Ve,ot),Pt.copy(Vt))},reset:function(){qe=!1,ht=null,Pt.set(-1,0,0,0)}}}function i(){let qe=!1,Vt=!1,ht=null,Pt=null,hn=null;return{setReversed:function(an){if(Vt!==an){const Ve=e.get("EXT_clip_control");an?Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.ZERO_TO_ONE_EXT):Ve.clipControlEXT(Ve.LOWER_LEFT_EXT,Ve.NEGATIVE_ONE_TO_ONE_EXT),Vt=an;const ot=hn;hn=null,this.setClear(ot)}},getReversed:function(){return Vt},setTest:function(an){an?Ce(t.DEPTH_TEST):ke(t.DEPTH_TEST)},setMask:function(an){ht!==an&&!qe&&(t.depthMask(an),ht=an)},setFunc:function(an){if(Vt&&(an=iMe[an]),Pt!==an){switch(an){case YP:t.depthFunc(t.NEVER);break;case XP:t.depthFunc(t.ALWAYS);break;case KP:t.depthFunc(t.LESS);break;case eT:t.depthFunc(t.LEQUAL);break;case JP:t.depthFunc(t.EQUAL);break;case ZP:t.depthFunc(t.GEQUAL);break;case QP:t.depthFunc(t.GREATER);break;case eL:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}Pt=an}},setLocked:function(an){qe=an},setClear:function(an){hn!==an&&(Vt&&(an=1-an),t.clearDepth(an),hn=an)},reset:function(){qe=!1,ht=null,Pt=null,hn=null,Vt=!1}}}function r(){let qe=!1,Vt=null,ht=null,Pt=null,hn=null,an=null,Ve=null,ot=null,Ct=null;return{setTest:function(Nt){qe||(Nt?Ce(t.STENCIL_TEST):ke(t.STENCIL_TEST))},setMask:function(Nt){Vt!==Nt&&!qe&&(t.stencilMask(Nt),Vt=Nt)},setFunc:function(Nt,Wn,sr){(ht!==Nt||Pt!==Wn||hn!==sr)&&(t.stencilFunc(Nt,Wn,sr),ht=Nt,Pt=Wn,hn=sr)},setOp:function(Nt,Wn,sr){(an!==Nt||Ve!==Wn||ot!==sr)&&(t.stencilOp(Nt,Wn,sr),an=Nt,Ve=Wn,ot=sr)},setLocked:function(Nt){qe=Nt},setClear:function(Nt){Ct!==Nt&&(t.clearStencil(Nt),Ct=Nt)},reset:function(){qe=!1,Vt=null,ht=null,Pt=null,hn=null,an=null,Ve=null,ot=null,Ct=null}}}const s=new n,a=new i,o=new r,c=new WeakMap,l=new WeakMap;let u={},h={},d=new WeakMap,f=[],p=null,g=!1,_=null,v=null,E=null,T=null,x=null,N=null,A=null,I=new _n(0,0,0),k=0,L=!1,U=null,$=null,q=null,G=null,X=null;const ie=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let V=!1,Z=0;const Y=t.getParameter(t.VERSION);Y.indexOf("WebGL")!==-1?(Z=parseFloat(/^WebGL (\d)/.exec(Y)[1]),V=Z>=1):Y.indexOf("OpenGL ES")!==-1&&(Z=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),V=Z>=2);let ee=null,oe={};const de=t.getParameter(t.SCISSOR_BOX),Me=t.getParameter(t.VIEWPORT),He=new Kr().fromArray(de),Te=new Kr().fromArray(Me);function Le(qe,Vt,ht,Pt){const hn=new Uint8Array(4),an=t.createTexture();t.bindTexture(qe,an),t.texParameteri(qe,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(qe,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let Ve=0;Ve<ht;Ve++)qe===t.TEXTURE_3D||qe===t.TEXTURE_2D_ARRAY?t.texImage3D(Vt,0,t.RGBA,1,1,Pt,0,t.RGBA,t.UNSIGNED_BYTE,hn):t.texImage2D(Vt+Ve,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,hn);return an}const we={};we[t.TEXTURE_2D]=Le(t.TEXTURE_2D,t.TEXTURE_2D,1),we[t.TEXTURE_CUBE_MAP]=Le(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),we[t.TEXTURE_2D_ARRAY]=Le(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),we[t.TEXTURE_3D]=Le(t.TEXTURE_3D,t.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),Ce(t.DEPTH_TEST),a.setFunc(eT),Ie(!1),it(Cj),Ce(t.CULL_FACE),fe(Yf);function Ce(qe){u[qe]!==!0&&(t.enable(qe),u[qe]=!0)}function ke(qe){u[qe]!==!1&&(t.disable(qe),u[qe]=!1)}function St(qe,Vt){return h[qe]!==Vt?(t.bindFramebuffer(qe,Vt),h[qe]=Vt,qe===t.DRAW_FRAMEBUFFER&&(h[t.FRAMEBUFFER]=Vt),qe===t.FRAMEBUFFER&&(h[t.DRAW_FRAMEBUFFER]=Vt),!0):!1}function At(qe,Vt){let ht=f,Pt=!1;if(qe){ht=d.get(Vt),ht===void 0&&(ht=[],d.set(Vt,ht));const hn=qe.textures;if(ht.length!==hn.length||ht[0]!==t.COLOR_ATTACHMENT0){for(let an=0,Ve=hn.length;an<Ve;an++)ht[an]=t.COLOR_ATTACHMENT0+an;ht.length=hn.length,Pt=!0}}else ht[0]!==t.BACK&&(ht[0]=t.BACK,Pt=!0);Pt&&t.drawBuffers(ht)}function Ee(qe){return p!==qe?(t.useProgram(qe),p=qe,!0):!1}const ye={[L_]:t.FUNC_ADD,[Qre]:t.FUNC_SUBTRACT,[ese]:t.FUNC_REVERSE_SUBTRACT};ye[tse]=t.MIN,ye[nse]=t.MAX;const et={[ise]:t.ZERO,[rse]:t.ONE,[sse]:t.SRC_COLOR,[$P]:t.SRC_ALPHA,[hse]:t.SRC_ALPHA_SATURATE,[lse]:t.DST_COLOR,[ose]:t.DST_ALPHA,[ase]:t.ONE_MINUS_SRC_COLOR,[WP]:t.ONE_MINUS_SRC_ALPHA,[use]:t.ONE_MINUS_DST_COLOR,[cse]:t.ONE_MINUS_DST_ALPHA,[dse]:t.CONSTANT_COLOR,[fse]:t.ONE_MINUS_CONSTANT_COLOR,[pse]:t.CONSTANT_ALPHA,[mse]:t.ONE_MINUS_CONSTANT_ALPHA};function fe(qe,Vt,ht,Pt,hn,an,Ve,ot,Ct,Nt){if(qe===Yf){g===!0&&(ke(t.BLEND),g=!1);return}if(g===!1&&(Ce(t.BLEND),g=!0),qe!==Zre){if(qe!==_||Nt!==L){if((v!==L_||x!==L_)&&(t.blendEquation(t.FUNC_ADD),v=L_,x=L_),Nt)switch(qe){case US:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Rj:t.blendFunc(t.ONE,t.ONE);break;case Aj:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case Mj:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe);break}else switch(qe){case US:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case Rj:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case Aj:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case Mj:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",qe);break}E=null,T=null,N=null,A=null,I.set(0,0,0),k=0,_=qe,L=Nt}return}hn=hn||Vt,an=an||ht,Ve=Ve||Pt,(Vt!==v||hn!==x)&&(t.blendEquationSeparate(ye[Vt],ye[hn]),v=Vt,x=hn),(ht!==E||Pt!==T||an!==N||Ve!==A)&&(t.blendFuncSeparate(et[ht],et[Pt],et[an],et[Ve]),E=ht,T=Pt,N=an,A=Ve),(ot.equals(I)===!1||Ct!==k)&&(t.blendColor(ot.r,ot.g,ot.b,Ct),I.copy(ot),k=Ct),_=qe,L=!1}function Fe(qe,Vt){qe.side===cl?ke(t.CULL_FACE):Ce(t.CULL_FACE);let ht=qe.side===Pc;Vt&&(ht=!ht),Ie(ht),qe.blending===US&&qe.transparent===!1?fe(Yf):fe(qe.blending,qe.blendEquation,qe.blendSrc,qe.blendDst,qe.blendEquationAlpha,qe.blendSrcAlpha,qe.blendDstAlpha,qe.blendColor,qe.blendAlpha,qe.premultipliedAlpha),a.setFunc(qe.depthFunc),a.setTest(qe.depthTest),a.setMask(qe.depthWrite),s.setMask(qe.colorWrite);const Pt=qe.stencilWrite;o.setTest(Pt),Pt&&(o.setMask(qe.stencilWriteMask),o.setFunc(qe.stencilFunc,qe.stencilRef,qe.stencilFuncMask),o.setOp(qe.stencilFail,qe.stencilZFail,qe.stencilZPass)),gt(qe.polygonOffset,qe.polygonOffsetFactor,qe.polygonOffsetUnits),qe.alphaToCoverage===!0?Ce(t.SAMPLE_ALPHA_TO_COVERAGE):ke(t.SAMPLE_ALPHA_TO_COVERAGE)}function Ie(qe){U!==qe&&(qe?t.frontFace(t.CW):t.frontFace(t.CCW),U=qe)}function it(qe){qe!==Xre?(Ce(t.CULL_FACE),qe!==$&&(qe===Cj?t.cullFace(t.BACK):qe===Kre?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):ke(t.CULL_FACE),$=qe}function dt(qe){qe!==q&&(V&&t.lineWidth(qe),q=qe)}function gt(qe,Vt,ht){qe?(Ce(t.POLYGON_OFFSET_FILL),(G!==Vt||X!==ht)&&(t.polygonOffset(Vt,ht),G=Vt,X=ht)):ke(t.POLYGON_OFFSET_FILL)}function bt(qe){qe?Ce(t.SCISSOR_TEST):ke(t.SCISSOR_TEST)}function be(qe){qe===void 0&&(qe=t.TEXTURE0+ie-1),ee!==qe&&(t.activeTexture(qe),ee=qe)}function ue(qe,Vt,ht){ht===void 0&&(ee===null?ht=t.TEXTURE0+ie-1:ht=ee);let Pt=oe[ht];Pt===void 0&&(Pt={type:void 0,texture:void 0},oe[ht]=Pt),(Pt.type!==qe||Pt.texture!==Vt)&&(ee!==ht&&(t.activeTexture(ht),ee=ht),t.bindTexture(qe,Vt||we[qe]),Pt.type=qe,Pt.texture=Vt)}function Xe(){const qe=oe[ee];qe!==void 0&&qe.type!==void 0&&(t.bindTexture(qe.type,null),qe.type=void 0,qe.texture=void 0)}function nt(){try{t.compressedTexImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function $e(){try{t.compressedTexImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Ue(){try{t.texSubImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function qt(){try{t.texSubImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Mt(){try{t.compressedTexSubImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function Yt(){try{t.compressedTexSubImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function ce(){try{t.texStorage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function j(){try{t.texStorage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function W(){try{t.texImage2D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function me(){try{t.texImage3D(...arguments)}catch(qe){console.error("THREE.WebGLState:",qe)}}function De(qe){He.equals(qe)===!1&&(t.scissor(qe.x,qe.y,qe.z,qe.w),He.copy(qe))}function je(qe){Te.equals(qe)===!1&&(t.viewport(qe.x,qe.y,qe.z,qe.w),Te.copy(qe))}function mt(qe,Vt){let ht=l.get(Vt);ht===void 0&&(ht=new WeakMap,l.set(Vt,ht));let Pt=ht.get(qe);Pt===void 0&&(Pt=t.getUniformBlockIndex(Vt,qe.name),ht.set(qe,Pt))}function xt(qe,Vt){const Pt=l.get(Vt).get(qe);c.get(Vt)!==Pt&&(t.uniformBlockBinding(Vt,Pt,qe.__bindingPointIndex),c.set(Vt,Pt))}function Vn(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),a.setReversed(!1),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),u={},ee=null,oe={},h={},d=new WeakMap,f=[],p=null,g=!1,_=null,v=null,E=null,T=null,x=null,N=null,A=null,I=new _n(0,0,0),k=0,L=!1,U=null,$=null,q=null,G=null,X=null,He.set(0,0,t.canvas.width,t.canvas.height),Te.set(0,0,t.canvas.width,t.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:Ce,disable:ke,bindFramebuffer:St,drawBuffers:At,useProgram:Ee,setBlending:fe,setMaterial:Fe,setFlipSided:Ie,setCullFace:it,setLineWidth:dt,setPolygonOffset:gt,setScissorTest:bt,activeTexture:be,bindTexture:ue,unbindTexture:Xe,compressedTexImage2D:nt,compressedTexImage3D:$e,texImage2D:W,texImage3D:me,updateUBOMapping:mt,uniformBlockBinding:xt,texStorage2D:ce,texStorage3D:j,texSubImage2D:Ue,texSubImage3D:qt,compressedTexSubImage2D:Mt,compressedTexSubImage3D:Yt,scissor:De,viewport:je,reset:Vn}}function sMe(t,e,n,i,r,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),l=new Rt,u=new WeakMap;let h;const d=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(be,ue){return f?new OffscreenCanvas(be,ue):xM("canvas")}function g(be,ue,Xe){let nt=1;const $e=bt(be);if(($e.width>Xe||$e.height>Xe)&&(nt=Xe/Math.max($e.width,$e.height)),nt<1)if(typeof HTMLImageElement<"u"&&be instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&be instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&be instanceof ImageBitmap||typeof VideoFrame<"u"&&be instanceof VideoFrame){const Ue=Math.floor(nt*$e.width),qt=Math.floor(nt*$e.height);h===void 0&&(h=p(Ue,qt));const Mt=ue?p(Ue,qt):h;return Mt.width=Ue,Mt.height=qt,Mt.getContext("2d").drawImage(be,0,0,Ue,qt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+$e.width+"x"+$e.height+") to ("+Ue+"x"+qt+")."),Mt}else return"data"in be&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+$e.width+"x"+$e.height+")."),be;return be}function _(be){return be.generateMipmaps}function v(be){t.generateMipmap(be)}function E(be){return be.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:be.isWebGL3DRenderTarget?t.TEXTURE_3D:be.isWebGLArrayRenderTarget||be.isCompressedArrayTexture?t.TEXTURE_2D_ARRAY:t.TEXTURE_2D}function T(be,ue,Xe,nt,$e=!1){if(be!==null){if(t[be]!==void 0)return t[be];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+be+"'")}let Ue=ue;if(ue===t.RED&&(Xe===t.FLOAT&&(Ue=t.R32F),Xe===t.HALF_FLOAT&&(Ue=t.R16F),Xe===t.UNSIGNED_BYTE&&(Ue=t.R8)),ue===t.RED_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.R8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.R16UI),Xe===t.UNSIGNED_INT&&(Ue=t.R32UI),Xe===t.BYTE&&(Ue=t.R8I),Xe===t.SHORT&&(Ue=t.R16I),Xe===t.INT&&(Ue=t.R32I)),ue===t.RG&&(Xe===t.FLOAT&&(Ue=t.RG32F),Xe===t.HALF_FLOAT&&(Ue=t.RG16F),Xe===t.UNSIGNED_BYTE&&(Ue=t.RG8)),ue===t.RG_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RG8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RG16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RG32UI),Xe===t.BYTE&&(Ue=t.RG8I),Xe===t.SHORT&&(Ue=t.RG16I),Xe===t.INT&&(Ue=t.RG32I)),ue===t.RGB_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RGB8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RGB16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RGB32UI),Xe===t.BYTE&&(Ue=t.RGB8I),Xe===t.SHORT&&(Ue=t.RGB16I),Xe===t.INT&&(Ue=t.RGB32I)),ue===t.RGBA_INTEGER&&(Xe===t.UNSIGNED_BYTE&&(Ue=t.RGBA8UI),Xe===t.UNSIGNED_SHORT&&(Ue=t.RGBA16UI),Xe===t.UNSIGNED_INT&&(Ue=t.RGBA32UI),Xe===t.BYTE&&(Ue=t.RGBA8I),Xe===t.SHORT&&(Ue=t.RGBA16I),Xe===t.INT&&(Ue=t.RGBA32I)),ue===t.RGB&&Xe===t.UNSIGNED_INT_5_9_9_9_REV&&(Ue=t.RGB9_E5),ue===t.RGBA){const qt=$e?EM:Lr.getTransfer(nt);Xe===t.FLOAT&&(Ue=t.RGBA32F),Xe===t.HALF_FLOAT&&(Ue=t.RGBA16F),Xe===t.UNSIGNED_BYTE&&(Ue=qt===ws?t.SRGB8_ALPHA8:t.RGBA8),Xe===t.UNSIGNED_SHORT_4_4_4_4&&(Ue=t.RGBA4),Xe===t.UNSIGNED_SHORT_5_5_5_1&&(Ue=t.RGB5_A1)}return(Ue===t.R16F||Ue===t.R32F||Ue===t.RG16F||Ue===t.RG32F||Ue===t.RGBA16F||Ue===t.RGBA32F)&&e.get("EXT_color_buffer_float"),Ue}function x(be,ue){let Xe;return be?ue===null||ue===Pg||ue===tT?Xe=t.DEPTH24_STENCIL8:ue===iu?Xe=t.DEPTH32F_STENCIL8:ue===kw&&(Xe=t.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):ue===null||ue===Pg||ue===tT?Xe=t.DEPTH_COMPONENT24:ue===iu?Xe=t.DEPTH_COMPONENT32F:ue===kw&&(Xe=t.DEPTH_COMPONENT16),Xe}function N(be,ue){return _(be)===!0||be.isFramebufferTexture&&be.minFilter!==Za&&be.minFilter!==_a?Math.log2(Math.max(ue.width,ue.height))+1:be.mipmaps!==void 0&&be.mipmaps.length>0?be.mipmaps.length:be.isCompressedTexture&&Array.isArray(be.image)?ue.mipmaps.length:1}function A(be){const ue=be.target;ue.removeEventListener("dispose",A),k(ue),ue.isVideoTexture&&u.delete(ue)}function I(be){const ue=be.target;ue.removeEventListener("dispose",I),U(ue)}function k(be){const ue=i.get(be);if(ue.__webglInit===void 0)return;const Xe=be.source,nt=d.get(Xe);if(nt){const $e=nt[ue.__cacheKey];$e.usedTimes--,$e.usedTimes===0&&L(be),Object.keys(nt).length===0&&d.delete(Xe)}i.remove(be)}function L(be){const ue=i.get(be);t.deleteTexture(ue.__webglTexture);const Xe=be.source,nt=d.get(Xe);delete nt[ue.__cacheKey],a.memory.textures--}function U(be){const ue=i.get(be);if(be.depthTexture&&(be.depthTexture.dispose(),i.remove(be.depthTexture)),be.isWebGLCubeRenderTarget)for(let nt=0;nt<6;nt++){if(Array.isArray(ue.__webglFramebuffer[nt]))for(let $e=0;$e<ue.__webglFramebuffer[nt].length;$e++)t.deleteFramebuffer(ue.__webglFramebuffer[nt][$e]);else t.deleteFramebuffer(ue.__webglFramebuffer[nt]);ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer[nt])}else{if(Array.isArray(ue.__webglFramebuffer))for(let nt=0;nt<ue.__webglFramebuffer.length;nt++)t.deleteFramebuffer(ue.__webglFramebuffer[nt]);else t.deleteFramebuffer(ue.__webglFramebuffer);if(ue.__webglDepthbuffer&&t.deleteRenderbuffer(ue.__webglDepthbuffer),ue.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ue.__webglMultisampledFramebuffer),ue.__webglColorRenderbuffer)for(let nt=0;nt<ue.__webglColorRenderbuffer.length;nt++)ue.__webglColorRenderbuffer[nt]&&t.deleteRenderbuffer(ue.__webglColorRenderbuffer[nt]);ue.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ue.__webglDepthRenderbuffer)}const Xe=be.textures;for(let nt=0,$e=Xe.length;nt<$e;nt++){const Ue=i.get(Xe[nt]);Ue.__webglTexture&&(t.deleteTexture(Ue.__webglTexture),a.memory.textures--),i.remove(Xe[nt])}i.remove(be)}let $=0;function q(){$=0}function G(){const be=$;return be>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+be+" texture units while this GPU supports only "+r.maxTextures),$+=1,be}function X(be){const ue=[];return ue.push(be.wrapS),ue.push(be.wrapT),ue.push(be.wrapR||0),ue.push(be.magFilter),ue.push(be.minFilter),ue.push(be.anisotropy),ue.push(be.internalFormat),ue.push(be.format),ue.push(be.type),ue.push(be.generateMipmaps),ue.push(be.premultiplyAlpha),ue.push(be.flipY),ue.push(be.unpackAlignment),ue.push(be.colorSpace),ue.join()}function ie(be,ue){const Xe=i.get(be);if(be.isVideoTexture&&dt(be),be.isRenderTargetTexture===!1&&be.version>0&&Xe.__version!==be.version){const nt=be.image;if(nt===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(nt.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Te(Xe,be,ue);return}}n.bindTexture(t.TEXTURE_2D,Xe.__webglTexture,t.TEXTURE0+ue)}function V(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Te(Xe,be,ue);return}n.bindTexture(t.TEXTURE_2D_ARRAY,Xe.__webglTexture,t.TEXTURE0+ue)}function Z(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Te(Xe,be,ue);return}n.bindTexture(t.TEXTURE_3D,Xe.__webglTexture,t.TEXTURE0+ue)}function Y(be,ue){const Xe=i.get(be);if(be.version>0&&Xe.__version!==be.version){Le(Xe,be,ue);return}n.bindTexture(t.TEXTURE_CUBE_MAP,Xe.__webglTexture,t.TEXTURE0+ue)}const ee={[vM]:t.REPEAT,[Hf]:t.CLAMP_TO_EDGE,[yM]:t.MIRRORED_REPEAT},oe={[Za]:t.NEAREST,[lq]:t.NEAREST_MIPMAP_NEAREST,[M1]:t.NEAREST_MIPMAP_LINEAR,[_a]:t.LINEAR,[RA]:t.LINEAR_MIPMAP_NEAREST,[gg]:t.LINEAR_MIPMAP_LINEAR},de={[Ose]:t.NEVER,[Lse]:t.ALWAYS,[Nse]:t.LESS,[yq]:t.LEQUAL,[Ise]:t.EQUAL,[Pse]:t.GEQUAL,[kse]:t.GREATER,[Dse]:t.NOTEQUAL};function Me(be,ue){if(ue.type===iu&&e.has("OES_texture_float_linear")===!1&&(ue.magFilter===_a||ue.magFilter===RA||ue.magFilter===M1||ue.magFilter===gg||ue.minFilter===_a||ue.minFilter===RA||ue.minFilter===M1||ue.minFilter===gg)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),t.texParameteri(be,t.TEXTURE_WRAP_S,ee[ue.wrapS]),t.texParameteri(be,t.TEXTURE_WRAP_T,ee[ue.wrapT]),(be===t.TEXTURE_3D||be===t.TEXTURE_2D_ARRAY)&&t.texParameteri(be,t.TEXTURE_WRAP_R,ee[ue.wrapR]),t.texParameteri(be,t.TEXTURE_MAG_FILTER,oe[ue.magFilter]),t.texParameteri(be,t.TEXTURE_MIN_FILTER,oe[ue.minFilter]),ue.compareFunction&&(t.texParameteri(be,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(be,t.TEXTURE_COMPARE_FUNC,de[ue.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(ue.magFilter===Za||ue.minFilter!==M1&&ue.minFilter!==gg||ue.type===iu&&e.has("OES_texture_float_linear")===!1)return;if(ue.anisotropy>1||i.get(ue).__currentAnisotropy){const Xe=e.get("EXT_texture_filter_anisotropic");t.texParameterf(be,Xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ue.anisotropy,r.getMaxAnisotropy())),i.get(ue).__currentAnisotropy=ue.anisotropy}}}function He(be,ue){let Xe=!1;be.__webglInit===void 0&&(be.__webglInit=!0,ue.addEventListener("dispose",A));const nt=ue.source;let $e=d.get(nt);$e===void 0&&($e={},d.set(nt,$e));const Ue=X(ue);if(Ue!==be.__cacheKey){$e[Ue]===void 0&&($e[Ue]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,Xe=!0),$e[Ue].usedTimes++;const qt=$e[be.__cacheKey];qt!==void 0&&($e[be.__cacheKey].usedTimes--,qt.usedTimes===0&&L(ue)),be.__cacheKey=Ue,be.__webglTexture=$e[Ue].texture}return Xe}function Te(be,ue,Xe){let nt=t.TEXTURE_2D;(ue.isDataArrayTexture||ue.isCompressedArrayTexture)&&(nt=t.TEXTURE_2D_ARRAY),ue.isData3DTexture&&(nt=t.TEXTURE_3D);const $e=He(be,ue),Ue=ue.source;n.bindTexture(nt,be.__webglTexture,t.TEXTURE0+Xe);const qt=i.get(Ue);if(Ue.version!==qt.__version||$e===!0){n.activeTexture(t.TEXTURE0+Xe);const Mt=Lr.getPrimaries(Lr.workingColorSpace),Yt=ue.colorSpace===$p?null:Lr.getPrimaries(ue.colorSpace),ce=ue.colorSpace===$p||Mt===Yt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ue.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ue.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,ce);let j=g(ue.image,!1,r.maxTextureSize);j=gt(ue,j);const W=s.convert(ue.format,ue.colorSpace),me=s.convert(ue.type);let De=T(ue.internalFormat,W,me,ue.colorSpace,ue.isVideoTexture);Me(nt,ue);let je;const mt=ue.mipmaps,xt=ue.isVideoTexture!==!0,Vn=qt.__version===void 0||$e===!0,qe=Ue.dataReady,Vt=N(ue,j);if(ue.isDepthTexture)De=x(ue.format===nT,ue.type),Vn&&(xt?n.texStorage2D(t.TEXTURE_2D,1,De,j.width,j.height):n.texImage2D(t.TEXTURE_2D,0,De,j.width,j.height,0,W,me,null));else if(ue.isDataTexture)if(mt.length>0){xt&&Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,mt[0].width,mt[0].height);for(let ht=0,Pt=mt.length;ht<Pt;ht++)je=mt[ht],xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,je.width,je.height,W,me,je.data):n.texImage2D(t.TEXTURE_2D,ht,De,je.width,je.height,0,W,me,je.data);ue.generateMipmaps=!1}else xt?(Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,j.width,j.height),qe&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,j.width,j.height,W,me,j.data)):n.texImage2D(t.TEXTURE_2D,0,De,j.width,j.height,0,W,me,j.data);else if(ue.isCompressedTexture)if(ue.isCompressedArrayTexture){xt&&Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Vt,De,mt[0].width,mt[0].height,j.depth);for(let ht=0,Pt=mt.length;ht<Pt;ht++)if(je=mt[ht],ue.format!==ru)if(W!==null)if(xt){if(qe)if(ue.layerUpdates.size>0){const hn=Fj(je.width,je.height,ue.format,ue.type);for(const an of ue.layerUpdates){const Ve=je.data.subarray(an*hn/je.data.BYTES_PER_ELEMENT,(an+1)*hn/je.data.BYTES_PER_ELEMENT);n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,an,je.width,je.height,1,W,Ve)}ue.clearLayerUpdates()}else n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,je.width,je.height,j.depth,W,je.data)}else n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,ht,De,je.width,je.height,j.depth,0,je.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else xt?qe&&n.texSubImage3D(t.TEXTURE_2D_ARRAY,ht,0,0,0,je.width,je.height,j.depth,W,me,je.data):n.texImage3D(t.TEXTURE_2D_ARRAY,ht,De,je.width,je.height,j.depth,0,W,me,je.data)}else{xt&&Vn&&n.texStorage2D(t.TEXTURE_2D,Vt,De,mt[0].width,mt[0].height);for(let ht=0,Pt=mt.length;ht<Pt;ht++)je=mt[ht],ue.format!==ru?W!==null?xt?qe&&n.compressedTexSubImage2D(t.TEXTURE_2D,ht,0,0,je.width,je.height,W,je.data):n.compressedTexImage2D(t.TEXTURE_2D,ht,De,je.width,je.height,0,je.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,je.width,je.height,W,me,je.data):n.texImage2D(t.TEXTURE_2D,ht,De,je.width,je.height,0,W,me,je.data)}else if(ue.isDataArrayTexture)if(xt){if(Vn&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Vt,De,j.width,j.height,j.depth),qe)if(ue.layerUpdates.size>0){const ht=Fj(j.width,j.height,ue.format,ue.type);for(const Pt of ue.layerUpdates){const hn=j.data.subarray(Pt*ht/j.data.BYTES_PER_ELEMENT,(Pt+1)*ht/j.data.BYTES_PER_ELEMENT);n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,Pt,j.width,j.height,1,W,me,hn)}ue.clearLayerUpdates()}else n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,j.width,j.height,j.depth,W,me,j.data)}else n.texImage3D(t.TEXTURE_2D_ARRAY,0,De,j.width,j.height,j.depth,0,W,me,j.data);else if(ue.isData3DTexture)xt?(Vn&&n.texStorage3D(t.TEXTURE_3D,Vt,De,j.width,j.height,j.depth),qe&&n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,j.width,j.height,j.depth,W,me,j.data)):n.texImage3D(t.TEXTURE_3D,0,De,j.width,j.height,j.depth,0,W,me,j.data);else if(ue.isFramebufferTexture){if(Vn)if(xt)n.texStorage2D(t.TEXTURE_2D,Vt,De,j.width,j.height);else{let ht=j.width,Pt=j.height;for(let hn=0;hn<Vt;hn++)n.texImage2D(t.TEXTURE_2D,hn,De,ht,Pt,0,W,me,null),ht>>=1,Pt>>=1}}else if(mt.length>0){if(xt&&Vn){const ht=bt(mt[0]);n.texStorage2D(t.TEXTURE_2D,Vt,De,ht.width,ht.height)}for(let ht=0,Pt=mt.length;ht<Pt;ht++)je=mt[ht],xt?qe&&n.texSubImage2D(t.TEXTURE_2D,ht,0,0,W,me,je):n.texImage2D(t.TEXTURE_2D,ht,De,W,me,je);ue.generateMipmaps=!1}else if(xt){if(Vn){const ht=bt(j);n.texStorage2D(t.TEXTURE_2D,Vt,De,ht.width,ht.height)}qe&&n.texSubImage2D(t.TEXTURE_2D,0,0,0,W,me,j)}else n.texImage2D(t.TEXTURE_2D,0,De,W,me,j);_(ue)&&v(nt),qt.__version=Ue.version,ue.onUpdate&&ue.onUpdate(ue)}be.__version=ue.version}function Le(be,ue,Xe){if(ue.image.length!==6)return;const nt=He(be,ue),$e=ue.source;n.bindTexture(t.TEXTURE_CUBE_MAP,be.__webglTexture,t.TEXTURE0+Xe);const Ue=i.get($e);if($e.version!==Ue.__version||nt===!0){n.activeTexture(t.TEXTURE0+Xe);const qt=Lr.getPrimaries(Lr.workingColorSpace),Mt=ue.colorSpace===$p?null:Lr.getPrimaries(ue.colorSpace),Yt=ue.colorSpace===$p||qt===Mt?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,ue.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ue.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,ue.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yt);const ce=ue.isCompressedTexture||ue.image[0].isCompressedTexture,j=ue.image[0]&&ue.image[0].isDataTexture,W=[];for(let Pt=0;Pt<6;Pt++)!ce&&!j?W[Pt]=g(ue.image[Pt],!0,r.maxCubemapSize):W[Pt]=j?ue.image[Pt].image:ue.image[Pt],W[Pt]=gt(ue,W[Pt]);const me=W[0],De=s.convert(ue.format,ue.colorSpace),je=s.convert(ue.type),mt=T(ue.internalFormat,De,je,ue.colorSpace),xt=ue.isVideoTexture!==!0,Vn=Ue.__version===void 0||nt===!0,qe=$e.dataReady;let Vt=N(ue,me);Me(t.TEXTURE_CUBE_MAP,ue);let ht;if(ce){xt&&Vn&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Vt,mt,me.width,me.height);for(let Pt=0;Pt<6;Pt++){ht=W[Pt].mipmaps;for(let hn=0;hn<ht.length;hn++){const an=ht[hn];ue.format!==ru?De!==null?xt?qe&&n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,an.width,an.height,De,an.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,mt,an.width,an.height,0,an.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,0,0,an.width,an.height,De,je,an.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn,mt,an.width,an.height,0,De,je,an.data)}}}else{if(ht=ue.mipmaps,xt&&Vn){ht.length>0&&Vt++;const Pt=bt(W[0]);n.texStorage2D(t.TEXTURE_CUBE_MAP,Vt,mt,Pt.width,Pt.height)}for(let Pt=0;Pt<6;Pt++)if(j){xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,W[Pt].width,W[Pt].height,De,je,W[Pt].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,mt,W[Pt].width,W[Pt].height,0,De,je,W[Pt].data);for(let hn=0;hn<ht.length;hn++){const Ve=ht[hn].image[Pt].image;xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,Ve.width,Ve.height,De,je,Ve.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,mt,Ve.width,Ve.height,0,De,je,Ve.data)}}else{xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,0,0,De,je,W[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,mt,De,je,W[Pt]);for(let hn=0;hn<ht.length;hn++){const an=ht[hn];xt?qe&&n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,0,0,De,je,an.image[Pt]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,hn+1,mt,De,je,an.image[Pt])}}}_(ue)&&v(t.TEXTURE_CUBE_MAP),Ue.__version=$e.version,ue.onUpdate&&ue.onUpdate(ue)}be.__version=ue.version}function we(be,ue,Xe,nt,$e,Ue){const qt=s.convert(Xe.format,Xe.colorSpace),Mt=s.convert(Xe.type),Yt=T(Xe.internalFormat,qt,Mt,Xe.colorSpace),ce=i.get(ue),j=i.get(Xe);if(j.__renderTarget=ue,!ce.__hasExternalTextures){const W=Math.max(1,ue.width>>Ue),me=Math.max(1,ue.height>>Ue);$e===t.TEXTURE_3D||$e===t.TEXTURE_2D_ARRAY?n.texImage3D($e,Ue,Yt,W,me,ue.depth,0,qt,Mt,null):n.texImage2D($e,Ue,Yt,W,me,0,qt,Mt,null)}n.bindFramebuffer(t.FRAMEBUFFER,be),it(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,nt,$e,j.__webglTexture,0,Ie(ue)):($e===t.TEXTURE_2D||$e>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&$e<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,nt,$e,j.__webglTexture,Ue),n.bindFramebuffer(t.FRAMEBUFFER,null)}function Ce(be,ue,Xe){if(t.bindRenderbuffer(t.RENDERBUFFER,be),ue.depthBuffer){const nt=ue.depthTexture,$e=nt&&nt.isDepthTexture?nt.type:null,Ue=x(ue.stencilBuffer,$e),qt=ue.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Mt=Ie(ue);it(ue)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Mt,Ue,ue.width,ue.height):Xe?t.renderbufferStorageMultisample(t.RENDERBUFFER,Mt,Ue,ue.width,ue.height):t.renderbufferStorage(t.RENDERBUFFER,Ue,ue.width,ue.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,qt,t.RENDERBUFFER,be)}else{const nt=ue.textures;for(let $e=0;$e<nt.length;$e++){const Ue=nt[$e],qt=s.convert(Ue.format,Ue.colorSpace),Mt=s.convert(Ue.type),Yt=T(Ue.internalFormat,qt,Mt,Ue.colorSpace),ce=Ie(ue);Xe&&it(ue)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,ce,Yt,ue.width,ue.height):it(ue)?o.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ce,Yt,ue.width,ue.height):t.renderbufferStorage(t.RENDERBUFFER,Yt,ue.width,ue.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ke(be,ue){if(ue&&ue.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,be),!(ue.depthTexture&&ue.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const nt=i.get(ue.depthTexture);nt.__renderTarget=ue,(!nt.__webglTexture||ue.depthTexture.image.width!==ue.width||ue.depthTexture.image.height!==ue.height)&&(ue.depthTexture.image.width=ue.width,ue.depthTexture.image.height=ue.height,ue.depthTexture.needsUpdate=!0),ie(ue.depthTexture,0);const $e=nt.__webglTexture,Ue=Ie(ue);if(ue.depthTexture.format===Dw)it(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,$e,0,Ue):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,$e,0);else if(ue.depthTexture.format===nT)it(ue)?o.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,$e,0,Ue):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,$e,0);else throw new Error("Unknown depthTexture format")}function St(be){const ue=i.get(be),Xe=be.isWebGLCubeRenderTarget===!0;if(ue.__boundDepthTexture!==be.depthTexture){const nt=be.depthTexture;if(ue.__depthDisposeCallback&&ue.__depthDisposeCallback(),nt){const $e=()=>{delete ue.__boundDepthTexture,delete ue.__depthDisposeCallback,nt.removeEventListener("dispose",$e)};nt.addEventListener("dispose",$e),ue.__depthDisposeCallback=$e}ue.__boundDepthTexture=nt}if(be.depthTexture&&!ue.__autoAllocateDepthBuffer){if(Xe)throw new Error("target.depthTexture not supported in Cube render targets");const nt=be.texture.mipmaps;nt&&nt.length>0?ke(ue.__webglFramebuffer[0],be):ke(ue.__webglFramebuffer,be)}else if(Xe){ue.__webglDepthbuffer=[];for(let nt=0;nt<6;nt++)if(n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer[nt]),ue.__webglDepthbuffer[nt]===void 0)ue.__webglDepthbuffer[nt]=t.createRenderbuffer(),Ce(ue.__webglDepthbuffer[nt],be,!1);else{const $e=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ue=ue.__webglDepthbuffer[nt];t.bindRenderbuffer(t.RENDERBUFFER,Ue),t.framebufferRenderbuffer(t.FRAMEBUFFER,$e,t.RENDERBUFFER,Ue)}}else{const nt=be.texture.mipmaps;if(nt&&nt.length>0?n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer[0]):n.bindFramebuffer(t.FRAMEBUFFER,ue.__webglFramebuffer),ue.__webglDepthbuffer===void 0)ue.__webglDepthbuffer=t.createRenderbuffer(),Ce(ue.__webglDepthbuffer,be,!1);else{const $e=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ue=ue.__webglDepthbuffer;t.bindRenderbuffer(t.RENDERBUFFER,Ue),t.framebufferRenderbuffer(t.FRAMEBUFFER,$e,t.RENDERBUFFER,Ue)}}n.bindFramebuffer(t.FRAMEBUFFER,null)}function At(be,ue,Xe){const nt=i.get(be);ue!==void 0&&we(nt.__webglFramebuffer,be,be.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),Xe!==void 0&&St(be)}function Ee(be){const ue=be.texture,Xe=i.get(be),nt=i.get(ue);be.addEventListener("dispose",I);const $e=be.textures,Ue=be.isWebGLCubeRenderTarget===!0,qt=$e.length>1;if(qt||(nt.__webglTexture===void 0&&(nt.__webglTexture=t.createTexture()),nt.__version=ue.version,a.memory.textures++),Ue){Xe.__webglFramebuffer=[];for(let Mt=0;Mt<6;Mt++)if(ue.mipmaps&&ue.mipmaps.length>0){Xe.__webglFramebuffer[Mt]=[];for(let Yt=0;Yt<ue.mipmaps.length;Yt++)Xe.__webglFramebuffer[Mt][Yt]=t.createFramebuffer()}else Xe.__webglFramebuffer[Mt]=t.createFramebuffer()}else{if(ue.mipmaps&&ue.mipmaps.length>0){Xe.__webglFramebuffer=[];for(let Mt=0;Mt<ue.mipmaps.length;Mt++)Xe.__webglFramebuffer[Mt]=t.createFramebuffer()}else Xe.__webglFramebuffer=t.createFramebuffer();if(qt)for(let Mt=0,Yt=$e.length;Mt<Yt;Mt++){const ce=i.get($e[Mt]);ce.__webglTexture===void 0&&(ce.__webglTexture=t.createTexture(),a.memory.textures++)}if(be.samples>0&&it(be)===!1){Xe.__webglMultisampledFramebuffer=t.createFramebuffer(),Xe.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,Xe.__webglMultisampledFramebuffer);for(let Mt=0;Mt<$e.length;Mt++){const Yt=$e[Mt];Xe.__webglColorRenderbuffer[Mt]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,Xe.__webglColorRenderbuffer[Mt]);const ce=s.convert(Yt.format,Yt.colorSpace),j=s.convert(Yt.type),W=T(Yt.internalFormat,ce,j,Yt.colorSpace,be.isXRRenderTarget===!0),me=Ie(be);t.renderbufferStorageMultisample(t.RENDERBUFFER,me,W,be.width,be.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Mt,t.RENDERBUFFER,Xe.__webglColorRenderbuffer[Mt])}t.bindRenderbuffer(t.RENDERBUFFER,null),be.depthBuffer&&(Xe.__webglDepthRenderbuffer=t.createRenderbuffer(),Ce(Xe.__webglDepthRenderbuffer,be,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(Ue){n.bindTexture(t.TEXTURE_CUBE_MAP,nt.__webglTexture),Me(t.TEXTURE_CUBE_MAP,ue);for(let Mt=0;Mt<6;Mt++)if(ue.mipmaps&&ue.mipmaps.length>0)for(let Yt=0;Yt<ue.mipmaps.length;Yt++)we(Xe.__webglFramebuffer[Mt][Yt],be,ue,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,Yt);else we(Xe.__webglFramebuffer[Mt],be,ue,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Mt,0);_(ue)&&v(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(qt){for(let Mt=0,Yt=$e.length;Mt<Yt;Mt++){const ce=$e[Mt],j=i.get(ce);n.bindTexture(t.TEXTURE_2D,j.__webglTexture),Me(t.TEXTURE_2D,ce),we(Xe.__webglFramebuffer,be,ce,t.COLOR_ATTACHMENT0+Mt,t.TEXTURE_2D,0),_(ce)&&v(t.TEXTURE_2D)}n.unbindTexture()}else{let Mt=t.TEXTURE_2D;if((be.isWebGL3DRenderTarget||be.isWebGLArrayRenderTarget)&&(Mt=be.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY),n.bindTexture(Mt,nt.__webglTexture),Me(Mt,ue),ue.mipmaps&&ue.mipmaps.length>0)for(let Yt=0;Yt<ue.mipmaps.length;Yt++)we(Xe.__webglFramebuffer[Yt],be,ue,t.COLOR_ATTACHMENT0,Mt,Yt);else we(Xe.__webglFramebuffer,be,ue,t.COLOR_ATTACHMENT0,Mt,0);_(ue)&&v(Mt),n.unbindTexture()}be.depthBuffer&&St(be)}function ye(be){const ue=be.textures;for(let Xe=0,nt=ue.length;Xe<nt;Xe++){const $e=ue[Xe];if(_($e)){const Ue=E(be),qt=i.get($e).__webglTexture;n.bindTexture(Ue,qt),v(Ue),n.unbindTexture()}}}const et=[],fe=[];function Fe(be){if(be.samples>0){if(it(be)===!1){const ue=be.textures,Xe=be.width,nt=be.height;let $e=t.COLOR_BUFFER_BIT;const Ue=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,qt=i.get(be),Mt=ue.length>1;if(Mt)for(let ce=0;ce<ue.length;ce++)n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,qt.__webglMultisampledFramebuffer);const Yt=be.texture.mipmaps;Yt&&Yt.length>0?n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglFramebuffer[0]):n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglFramebuffer);for(let ce=0;ce<ue.length;ce++){if(be.resolveDepthBuffer&&(be.depthBuffer&&($e|=t.DEPTH_BUFFER_BIT),be.stencilBuffer&&be.resolveStencilBuffer&&($e|=t.STENCIL_BUFFER_BIT)),Mt){t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,qt.__webglColorRenderbuffer[ce]);const j=i.get(ue[ce]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,j,0)}t.blitFramebuffer(0,0,Xe,nt,0,0,Xe,nt,$e,t.NEAREST),c===!0&&(et.length=0,fe.length=0,et.push(t.COLOR_ATTACHMENT0+ce),be.depthBuffer&&be.resolveDepthBuffer===!1&&(et.push(Ue),fe.push(Ue),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,fe)),t.invalidateFramebuffer(t.READ_FRAMEBUFFER,et))}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Mt)for(let ce=0;ce<ue.length;ce++){n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.RENDERBUFFER,qt.__webglColorRenderbuffer[ce]);const j=i.get(ue[ce]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,qt.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+ce,t.TEXTURE_2D,j,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,qt.__webglMultisampledFramebuffer)}else if(be.depthBuffer&&be.resolveDepthBuffer===!1&&c){const ue=be.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[ue])}}}function Ie(be){return Math.min(r.maxSamples,be.samples)}function it(be){const ue=i.get(be);return be.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&ue.__useRenderToTexture!==!1}function dt(be){const ue=a.render.frame;u.get(be)!==ue&&(u.set(be,ue),be.update())}function gt(be,ue){const Xe=be.colorSpace,nt=be.format,$e=be.type;return be.isCompressedTexture===!0||be.isVideoTexture===!0||Xe!==Lg&&Xe!==$p&&(Lr.getTransfer(Xe)===ws?(nt!==ru||$e!==ml)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Xe)),ue}function bt(be){return typeof HTMLImageElement<"u"&&be instanceof HTMLImageElement?(l.width=be.naturalWidth||be.width,l.height=be.naturalHeight||be.height):typeof VideoFrame<"u"&&be instanceof VideoFrame?(l.width=be.displayWidth,l.height=be.displayHeight):(l.width=be.width,l.height=be.height),l}this.allocateTextureUnit=G,this.resetTextureUnits=q,this.setTexture2D=ie,this.setTexture2DArray=V,this.setTexture3D=Z,this.setTextureCube=Y,this.rebindTextures=At,this.setupRenderTarget=Ee,this.updateRenderTargetMipmap=ye,this.updateMultisampleRenderTarget=Fe,this.setupDepthRenderbuffer=St,this.setupFrameBufferTexture=we,this.useMultisampledRTT=it}function Yae(t,e){function n(i,r=$p){let s;const a=Lr.getTransfer(r);if(i===ml)return t.UNSIGNED_BYTE;if(i===XU)return t.UNSIGNED_SHORT_4_4_4_4;if(i===KU)return t.UNSIGNED_SHORT_5_5_5_1;if(i===dq)return t.UNSIGNED_INT_5_9_9_9_REV;if(i===uq)return t.BYTE;if(i===hq)return t.SHORT;if(i===kw)return t.UNSIGNED_SHORT;if(i===YU)return t.INT;if(i===Pg)return t.UNSIGNED_INT;if(i===iu)return t.FLOAT;if(i===Lb)return t.HALF_FLOAT;if(i===fq)return t.ALPHA;if(i===pq)return t.RGB;if(i===ru)return t.RGBA;if(i===Dw)return t.DEPTH_COMPONENT;if(i===nT)return t.DEPTH_STENCIL;if(i===JU)return t.RED;if(i===YO)return t.RED_INTEGER;if(i===mq)return t.RG;if(i===ZU)return t.RG_INTEGER;if(i===XO)return t.RGBA_INTEGER;if(i===AA||i===MA||i===OA||i===NA)if(a===ws)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(i===AA)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===MA)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===OA)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===NA)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(i===AA)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===MA)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===OA)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===NA)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===tL||i===nL||i===iL||i===rL)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(i===tL)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===nL)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===iL)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===rL)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===sL||i===aL||i===oL)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(i===sL||i===aL)return a===ws?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(i===oL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(i===cL||i===lL||i===uL||i===hL||i===dL||i===fL||i===pL||i===mL||i===gL||i===vL||i===yL||i===_L||i===bL||i===EL)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(i===cL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===lL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===uL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===hL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===dL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===fL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===pL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===mL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===gL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===vL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===yL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===_L)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===bL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===EL)return a===ws?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===IA||i===SL||i===TL)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(i===IA)return a===ws?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===SL)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===TL)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===gq||i===xL||i===wL||i===CL)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(i===IA)return s.COMPRESSED_RED_RGTC1_EXT;if(i===xL)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===wL)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===CL)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===tT?t.UNSIGNED_INT_24_8:t[i]!==void 0?t[i]:null}return{convert:n}}const aMe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,oMe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class cMe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,n,i){if(this.texture===null){const r=new Pa,s=e.properties.get(r);s.__webglTexture=n.texture,(n.depthNear!==i.depthNear||n.depthFar!==i.depthFar)&&(this.depthNear=n.depthNear,this.depthFar=n.depthFar),this.texture=r}}getMesh(e){if(this.texture!==null&&this.mesh===null){const n=e.cameras[0].viewport,i=new Bc({vertexShader:aMe,fragmentShader:oMe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:n.z},depthHeight:{value:n.w}}});this.mesh=new Bo(new LC(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class lMe extends Yd{constructor(e,n){super();const i=this;let r=null,s=1,a=null,o="local-floor",c=1,l=null,u=null,h=null,d=null,f=null,p=null;const g=new cMe,_=n.getContextAttributes();let v=null,E=null;const T=[],x=[],N=new Rt;let A=null;const I=new Ic;I.viewport=new Kr;const k=new Ic;k.viewport=new Kr;const L=[I,k],U=new Uae;let $=null,q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Te){let Le=T[Te];return Le===void 0&&(Le=new LD,T[Te]=Le),Le.getTargetRaySpace()},this.getControllerGrip=function(Te){let Le=T[Te];return Le===void 0&&(Le=new LD,T[Te]=Le),Le.getGripSpace()},this.getHand=function(Te){let Le=T[Te];return Le===void 0&&(Le=new LD,T[Te]=Le),Le.getHandSpace()};function G(Te){const Le=x.indexOf(Te.inputSource);if(Le===-1)return;const we=T[Le];we!==void 0&&(we.update(Te.inputSource,Te.frame,l||a),we.dispatchEvent({type:Te.type,data:Te.inputSource}))}function X(){r.removeEventListener("select",G),r.removeEventListener("selectstart",G),r.removeEventListener("selectend",G),r.removeEventListener("squeeze",G),r.removeEventListener("squeezestart",G),r.removeEventListener("squeezeend",G),r.removeEventListener("end",X),r.removeEventListener("inputsourceschange",ie);for(let Te=0;Te<T.length;Te++){const Le=x[Te];Le!==null&&(x[Te]=null,T[Te].disconnect(Le))}$=null,q=null,g.reset(),e.setRenderTarget(v),f=null,d=null,h=null,r=null,E=null,He.stop(),i.isPresenting=!1,e.setPixelRatio(A),e.setSize(N.width,N.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Te){s=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Te){o=Te,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(Te){l=Te},this.getBaseLayer=function(){return d!==null?d:f},this.getBinding=function(){return h},this.getFrame=function(){return p},this.getSession=function(){return r},this.setSession=async function(Te){if(r=Te,r!==null){if(v=e.getRenderTarget(),r.addEventListener("select",G),r.addEventListener("selectstart",G),r.addEventListener("selectend",G),r.addEventListener("squeeze",G),r.addEventListener("squeezestart",G),r.addEventListener("squeezeend",G),r.addEventListener("end",X),r.addEventListener("inputsourceschange",ie),_.xrCompatible!==!0&&await n.makeXRCompatible(),A=e.getPixelRatio(),e.getSize(N),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let we=null,Ce=null,ke=null;_.depth&&(ke=_.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,we=_.stencil?nT:Dw,Ce=_.stencil?tT:Pg);const St={colorFormat:n.RGBA8,depthFormat:ke,scaleFactor:s};h=new XRWebGLBinding(r,n),d=h.createProjectionLayer(St),r.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),E=new Ul(d.textureWidth,d.textureHeight,{format:ru,type:ml,depthTexture:new PC(d.textureWidth,d.textureHeight,Ce,void 0,void 0,void 0,void 0,void 0,void 0,we),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const we={antialias:_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(r,n,we),r.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),E=new Ul(f.framebufferWidth,f.framebufferHeight,{format:ru,type:ml,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil,resolveDepthBuffer:f.ignoreDepthValues===!1,resolveStencilBuffer:f.ignoreDepthValues===!1})}E.isXRRenderTarget=!0,this.setFoveation(c),l=null,a=await r.requestReferenceSpace(o),He.setContext(r),He.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return g.getDepthTexture()};function ie(Te){for(let Le=0;Le<Te.removed.length;Le++){const we=Te.removed[Le],Ce=x.indexOf(we);Ce>=0&&(x[Ce]=null,T[Ce].disconnect(we))}for(let Le=0;Le<Te.added.length;Le++){const we=Te.added[Le];let Ce=x.indexOf(we);if(Ce===-1){for(let St=0;St<T.length;St++)if(St>=x.length){x.push(we),Ce=St;break}else if(x[St]===null){x[St]=we,Ce=St;break}if(Ce===-1)break}const ke=T[Ce];ke&&ke.connect(we)}}const V=new Re,Z=new Re;function Y(Te,Le,we){V.setFromMatrixPosition(Le.matrixWorld),Z.setFromMatrixPosition(we.matrixWorld);const Ce=V.distanceTo(Z),ke=Le.projectionMatrix.elements,St=we.projectionMatrix.elements,At=ke[14]/(ke[10]-1),Ee=ke[14]/(ke[10]+1),ye=(ke[9]+1)/ke[5],et=(ke[9]-1)/ke[5],fe=(ke[8]-1)/ke[0],Fe=(St[8]+1)/St[0],Ie=At*fe,it=At*Fe,dt=Ce/(-fe+Fe),gt=dt*-fe;if(Le.matrixWorld.decompose(Te.position,Te.quaternion,Te.scale),Te.translateX(gt),Te.translateZ(dt),Te.matrixWorld.compose(Te.position,Te.quaternion,Te.scale),Te.matrixWorldInverse.copy(Te.matrixWorld).invert(),ke[10]===-1)Te.projectionMatrix.copy(Le.projectionMatrix),Te.projectionMatrixInverse.copy(Le.projectionMatrixInverse);else{const bt=At+dt,be=Ee+dt,ue=Ie-gt,Xe=it+(Ce-gt),nt=ye*Ee/be*bt,$e=et*Ee/be*bt;Te.projectionMatrix.makePerspective(ue,Xe,nt,$e,bt,be),Te.projectionMatrixInverse.copy(Te.projectionMatrix).invert()}}function ee(Te,Le){Le===null?Te.matrixWorld.copy(Te.matrix):Te.matrixWorld.multiplyMatrices(Le.matrixWorld,Te.matrix),Te.matrixWorldInverse.copy(Te.matrixWorld).invert()}this.updateCamera=function(Te){if(r===null)return;let Le=Te.near,we=Te.far;g.texture!==null&&(g.depthNear>0&&(Le=g.depthNear),g.depthFar>0&&(we=g.depthFar)),U.near=k.near=I.near=Le,U.far=k.far=I.far=we,($!==U.near||q!==U.far)&&(r.updateRenderState({depthNear:U.near,depthFar:U.far}),$=U.near,q=U.far),I.layers.mask=Te.layers.mask|2,k.layers.mask=Te.layers.mask|4,U.layers.mask=I.layers.mask|k.layers.mask;const Ce=Te.parent,ke=U.cameras;ee(U,Ce);for(let St=0;St<ke.length;St++)ee(ke[St],Ce);ke.length===2?Y(U,I,k):U.projectionMatrix.copy(I.projectionMatrix),oe(Te,U,Ce)};function oe(Te,Le,we){we===null?Te.matrix.copy(Le.matrixWorld):(Te.matrix.copy(we.matrixWorld),Te.matrix.invert(),Te.matrix.multiply(Le.matrixWorld)),Te.matrix.decompose(Te.position,Te.quaternion,Te.scale),Te.updateMatrixWorld(!0),Te.projectionMatrix.copy(Le.projectionMatrix),Te.projectionMatrixInverse.copy(Le.projectionMatrixInverse),Te.isPerspectiveCamera&&(Te.fov=Pw*2*Math.atan(1/Te.projectionMatrix.elements[5]),Te.zoom=1)}this.getCamera=function(){return U},this.getFoveation=function(){if(!(d===null&&f===null))return c},this.setFoveation=function(Te){c=Te,d!==null&&(d.fixedFoveation=Te),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=Te)},this.hasDepthSensing=function(){return g.texture!==null},this.getDepthSensingMesh=function(){return g.getMesh(U)};let de=null;function Me(Te,Le){if(u=Le.getViewerPose(l||a),p=Le,u!==null){const we=u.views;f!==null&&(e.setRenderTargetFramebuffer(E,f.framebuffer),e.setRenderTarget(E));let Ce=!1;we.length!==U.cameras.length&&(U.cameras.length=0,Ce=!0);for(let At=0;At<we.length;At++){const Ee=we[At];let ye=null;if(f!==null)ye=f.getViewport(Ee);else{const fe=h.getViewSubImage(d,Ee);ye=fe.viewport,At===0&&(e.setRenderTargetTextures(E,fe.colorTexture,fe.depthStencilTexture),e.setRenderTarget(E))}let et=L[At];et===void 0&&(et=new Ic,et.layers.enable(At),et.viewport=new Kr,L[At]=et),et.matrix.fromArray(Ee.transform.matrix),et.matrix.decompose(et.position,et.quaternion,et.scale),et.projectionMatrix.fromArray(Ee.projectionMatrix),et.projectionMatrixInverse.copy(et.projectionMatrix).invert(),et.viewport.set(ye.x,ye.y,ye.width,ye.height),At===0&&(U.matrix.copy(et.matrix),U.matrix.decompose(U.position,U.quaternion,U.scale)),Ce===!0&&U.cameras.push(et)}const ke=r.enabledFeatures;if(ke&&ke.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&h){const At=h.getDepthInformation(we[0]);At&&At.isValid&&At.texture&&g.init(e,At,r.renderState)}}for(let we=0;we<T.length;we++){const Ce=x[we],ke=T[we];Ce!==null&&ke!==void 0&&ke.update(Ce,Le,l||a)}de&&de(Te,Le),Le.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:Le}),p=null}const He=new Vae;He.setAnimationLoop(Me),this.setAnimationLoop=function(Te){de=Te},this.dispose=function(){}}}const tS=new $h,uMe=new Ni;function hMe(t,e){function n(_,v){_.matrixAutoUpdate===!0&&_.updateMatrix(),v.value.copy(_.matrix)}function i(_,v){v.color.getRGB(_.fogColor.value,jse(t)),v.isFog?(_.fogNear.value=v.near,_.fogFar.value=v.far):v.isFogExp2&&(_.fogDensity.value=v.density)}function r(_,v,E,T,x){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(_,v):v.isMeshToonMaterial?(s(_,v),h(_,v)):v.isMeshPhongMaterial?(s(_,v),u(_,v)):v.isMeshStandardMaterial?(s(_,v),d(_,v),v.isMeshPhysicalMaterial&&f(_,v,x)):v.isMeshMatcapMaterial?(s(_,v),p(_,v)):v.isMeshDepthMaterial?s(_,v):v.isMeshDistanceMaterial?(s(_,v),g(_,v)):v.isMeshNormalMaterial?s(_,v):v.isLineBasicMaterial?(a(_,v),v.isLineDashedMaterial&&o(_,v)):v.isPointsMaterial?c(_,v,E,T):v.isSpriteMaterial?l(_,v):v.isShadowMaterial?(_.color.value.copy(v.color),_.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(_,v){_.opacity.value=v.opacity,v.color&&_.diffuse.value.copy(v.color),v.emissive&&_.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(_.map.value=v.map,n(v.map,_.mapTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.bumpMap&&(_.bumpMap.value=v.bumpMap,n(v.bumpMap,_.bumpMapTransform),_.bumpScale.value=v.bumpScale,v.side===Pc&&(_.bumpScale.value*=-1)),v.normalMap&&(_.normalMap.value=v.normalMap,n(v.normalMap,_.normalMapTransform),_.normalScale.value.copy(v.normalScale),v.side===Pc&&_.normalScale.value.negate()),v.displacementMap&&(_.displacementMap.value=v.displacementMap,n(v.displacementMap,_.displacementMapTransform),_.displacementScale.value=v.displacementScale,_.displacementBias.value=v.displacementBias),v.emissiveMap&&(_.emissiveMap.value=v.emissiveMap,n(v.emissiveMap,_.emissiveMapTransform)),v.specularMap&&(_.specularMap.value=v.specularMap,n(v.specularMap,_.specularMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest);const E=e.get(v),T=E.envMap,x=E.envMapRotation;T&&(_.envMap.value=T,tS.copy(x),tS.x*=-1,tS.y*=-1,tS.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(tS.y*=-1,tS.z*=-1),_.envMapRotation.value.setFromMatrix4(uMe.makeRotationFromEuler(tS)),_.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=v.reflectivity,_.ior.value=v.ior,_.refractionRatio.value=v.refractionRatio),v.lightMap&&(_.lightMap.value=v.lightMap,_.lightMapIntensity.value=v.lightMapIntensity,n(v.lightMap,_.lightMapTransform)),v.aoMap&&(_.aoMap.value=v.aoMap,_.aoMapIntensity.value=v.aoMapIntensity,n(v.aoMap,_.aoMapTransform))}function a(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,v.map&&(_.map.value=v.map,n(v.map,_.mapTransform))}function o(_,v){_.dashSize.value=v.dashSize,_.totalSize.value=v.dashSize+v.gapSize,_.scale.value=v.scale}function c(_,v,E,T){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.size.value=v.size*E,_.scale.value=T*.5,v.map&&(_.map.value=v.map,n(v.map,_.uvTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest)}function l(_,v){_.diffuse.value.copy(v.color),_.opacity.value=v.opacity,_.rotation.value=v.rotation,v.map&&(_.map.value=v.map,n(v.map,_.mapTransform)),v.alphaMap&&(_.alphaMap.value=v.alphaMap,n(v.alphaMap,_.alphaMapTransform)),v.alphaTest>0&&(_.alphaTest.value=v.alphaTest)}function u(_,v){_.specular.value.copy(v.specular),_.shininess.value=Math.max(v.shininess,1e-4)}function h(_,v){v.gradientMap&&(_.gradientMap.value=v.gradientMap)}function d(_,v){_.metalness.value=v.metalness,v.metalnessMap&&(_.metalnessMap.value=v.metalnessMap,n(v.metalnessMap,_.metalnessMapTransform)),_.roughness.value=v.roughness,v.roughnessMap&&(_.roughnessMap.value=v.roughnessMap,n(v.roughnessMap,_.roughnessMapTransform)),v.envMap&&(_.envMapIntensity.value=v.envMapIntensity)}function f(_,v,E){_.ior.value=v.ior,v.sheen>0&&(_.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),_.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(_.sheenColorMap.value=v.sheenColorMap,n(v.sheenColorMap,_.sheenColorMapTransform)),v.sheenRoughnessMap&&(_.sheenRoughnessMap.value=v.sheenRoughnessMap,n(v.sheenRoughnessMap,_.sheenRoughnessMapTransform))),v.clearcoat>0&&(_.clearcoat.value=v.clearcoat,_.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(_.clearcoatMap.value=v.clearcoatMap,n(v.clearcoatMap,_.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,n(v.clearcoatRoughnessMap,_.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(_.clearcoatNormalMap.value=v.clearcoatNormalMap,n(v.clearcoatNormalMap,_.clearcoatNormalMapTransform),_.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Pc&&_.clearcoatNormalScale.value.negate())),v.dispersion>0&&(_.dispersion.value=v.dispersion),v.iridescence>0&&(_.iridescence.value=v.iridescence,_.iridescenceIOR.value=v.iridescenceIOR,_.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(_.iridescenceMap.value=v.iridescenceMap,n(v.iridescenceMap,_.iridescenceMapTransform)),v.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=v.iridescenceThicknessMap,n(v.iridescenceThicknessMap,_.iridescenceThicknessMapTransform))),v.transmission>0&&(_.transmission.value=v.transmission,_.transmissionSamplerMap.value=E.texture,_.transmissionSamplerSize.value.set(E.width,E.height),v.transmissionMap&&(_.transmissionMap.value=v.transmissionMap,n(v.transmissionMap,_.transmissionMapTransform)),_.thickness.value=v.thickness,v.thicknessMap&&(_.thicknessMap.value=v.thicknessMap,n(v.thicknessMap,_.thicknessMapTransform)),_.attenuationDistance.value=v.attenuationDistance,_.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(_.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(_.anisotropyMap.value=v.anisotropyMap,n(v.anisotropyMap,_.anisotropyMapTransform))),_.specularIntensity.value=v.specularIntensity,_.specularColor.value.copy(v.specularColor),v.specularColorMap&&(_.specularColorMap.value=v.specularColorMap,n(v.specularColorMap,_.specularColorMapTransform)),v.specularIntensityMap&&(_.specularIntensityMap.value=v.specularIntensityMap,n(v.specularIntensityMap,_.specularIntensityMapTransform))}function p(_,v){v.matcap&&(_.matcap.value=v.matcap)}function g(_,v){const E=e.get(v).light;_.referencePosition.value.setFromMatrixPosition(E.matrixWorld),_.nearDistance.value=E.shadow.camera.near,_.farDistance.value=E.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function dMe(t,e,n,i){let r={},s={},a=[];const o=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);function c(E,T){const x=T.program;i.uniformBlockBinding(E,x)}function l(E,T){let x=r[E.id];x===void 0&&(p(E),x=u(E),r[E.id]=x,E.addEventListener("dispose",_));const N=T.program;i.updateUBOMapping(E,N);const A=e.render.frame;s[E.id]!==A&&(d(E),s[E.id]=A)}function u(E){const T=h();E.__bindingPointIndex=T;const x=t.createBuffer(),N=E.__size,A=E.usage;return t.bindBuffer(t.UNIFORM_BUFFER,x),t.bufferData(t.UNIFORM_BUFFER,N,A),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,T,x),x}function h(){for(let E=0;E<o;E++)if(a.indexOf(E)===-1)return a.push(E),E;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(E){const T=r[E.id],x=E.uniforms,N=E.__cache;t.bindBuffer(t.UNIFORM_BUFFER,T);for(let A=0,I=x.length;A<I;A++){const k=Array.isArray(x[A])?x[A]:[x[A]];for(let L=0,U=k.length;L<U;L++){const $=k[L];if(f($,A,L,N)===!0){const q=$.__offset,G=Array.isArray($.value)?$.value:[$.value];let X=0;for(let ie=0;ie<G.length;ie++){const V=G[ie],Z=g(V);typeof V=="number"||typeof V=="boolean"?($.__data[0]=V,t.bufferSubData(t.UNIFORM_BUFFER,q+X,$.__data)):V.isMatrix3?($.__data[0]=V.elements[0],$.__data[1]=V.elements[1],$.__data[2]=V.elements[2],$.__data[3]=0,$.__data[4]=V.elements[3],$.__data[5]=V.elements[4],$.__data[6]=V.elements[5],$.__data[7]=0,$.__data[8]=V.elements[6],$.__data[9]=V.elements[7],$.__data[10]=V.elements[8],$.__data[11]=0):(V.toArray($.__data,X),X+=Z.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,q,$.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(E,T,x,N){const A=E.value,I=T+"_"+x;if(N[I]===void 0)return typeof A=="number"||typeof A=="boolean"?N[I]=A:N[I]=A.clone(),!0;{const k=N[I];if(typeof A=="number"||typeof A=="boolean"){if(k!==A)return N[I]=A,!0}else if(k.equals(A)===!1)return k.copy(A),!0}return!1}function p(E){const T=E.uniforms;let x=0;const N=16;for(let I=0,k=T.length;I<k;I++){const L=Array.isArray(T[I])?T[I]:[T[I]];for(let U=0,$=L.length;U<$;U++){const q=L[U],G=Array.isArray(q.value)?q.value:[q.value];for(let X=0,ie=G.length;X<ie;X++){const V=G[X],Z=g(V),Y=x%N,ee=Y%Z.boundary,oe=Y+ee;x+=ee,oe!==0&&N-oe<Z.storage&&(x+=N-oe),q.__data=new Float32Array(Z.storage/Float32Array.BYTES_PER_ELEMENT),q.__offset=x,x+=Z.storage}}}const A=x%N;return A>0&&(x+=N-A),E.__size=x,E.__cache={},this}function g(E){const T={boundary:0,storage:0};return typeof E=="number"||typeof E=="boolean"?(T.boundary=4,T.storage=4):E.isVector2?(T.boundary=8,T.storage=8):E.isVector3||E.isColor?(T.boundary=16,T.storage=12):E.isVector4?(T.boundary=16,T.storage=16):E.isMatrix3?(T.boundary=48,T.storage=48):E.isMatrix4?(T.boundary=64,T.storage=64):E.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",E),T}function _(E){const T=E.target;T.removeEventListener("dispose",_);const x=a.indexOf(T.__bindingPointIndex);a.splice(x,1),t.deleteBuffer(r[T.id]),delete r[T.id],delete s[T.id]}function v(){for(const E in r)t.deleteBuffer(r[E]);a=[],r={},s={}}return{bind:c,update:l,dispose:v}}class Xae{constructor(e={}){const{canvas:n=Fse(),context:i=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:l=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:h=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let f;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");f=i.getContextAttributes().alpha}else f=a;const p=new Uint32Array(4),g=new Int32Array(4);let _=null,v=null;const E=[],T=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Kp,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const x=this;let N=!1;this._outputColorSpace=ya;let A=0,I=0,k=null,L=-1,U=null;const $=new Kr,q=new Kr;let G=null;const X=new _n(0);let ie=0,V=n.width,Z=n.height,Y=1,ee=null,oe=null;const de=new Kr(0,0,V,Z),Me=new Kr(0,0,V,Z);let He=!1;const Te=new DC;let Le=!1,we=!1;const Ce=new Ni,ke=new Ni,St=new Re,At=new Kr,Ee={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ye=!1;function et(){return k===null?Y:1}let fe=i;function Fe(ve,Ke){return n.getContext(ve,Ke)}try{const ve={alpha:!0,depth:r,stencil:s,antialias:o,premultipliedAlpha:c,preserveDrawingBuffer:l,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${$O}`),n.addEventListener("webglcontextlost",Pt,!1),n.addEventListener("webglcontextrestored",hn,!1),n.addEventListener("webglcontextcreationerror",an,!1),fe===null){const Ke="webgl2";if(fe=Fe(Ke,ve),fe===null)throw Fe(Ke)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(ve){throw console.error("THREE.WebGLRenderer: "+ve.message),ve}let Ie,it,dt,gt,bt,be,ue,Xe,nt,$e,Ue,qt,Mt,Yt,ce,j,W,me,De,je,mt,xt,Vn,qe;function Vt(){Ie=new xRe(fe),Ie.init(),xt=new Yae(fe,Ie),it=new vRe(fe,Ie,e,xt),dt=new rMe(fe,Ie),it.reverseDepthBuffer&&d&&dt.buffers.depth.setReversed(!0),gt=new RRe(fe),bt=new qAe,be=new sMe(fe,Ie,dt,bt,it,xt,gt),ue=new _Re(x),Xe=new TRe(x),nt=new k1e(fe),Vn=new mRe(fe,nt),$e=new wRe(fe,nt,gt,Vn),Ue=new MRe(fe,$e,nt,gt),De=new ARe(fe,it,be),j=new yRe(bt),qt=new GAe(x,ue,Xe,Ie,it,Vn,j),Mt=new hMe(x,bt),Yt=new WAe,ce=new QAe(Ie),me=new pRe(x,ue,Xe,dt,Ue,f,c),W=new nMe(x,Ue,it),qe=new dMe(fe,gt,it,dt),je=new gRe(fe,Ie,gt),mt=new CRe(fe,Ie,gt),gt.programs=qt.programs,x.capabilities=it,x.extensions=Ie,x.properties=bt,x.renderLists=Yt,x.shadowMap=W,x.state=dt,x.info=gt}Vt();const ht=new lMe(x,fe);this.xr=ht,this.getContext=function(){return fe},this.getContextAttributes=function(){return fe.getContextAttributes()},this.forceContextLoss=function(){const ve=Ie.get("WEBGL_lose_context");ve&&ve.loseContext()},this.forceContextRestore=function(){const ve=Ie.get("WEBGL_lose_context");ve&&ve.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(ve){ve!==void 0&&(Y=ve,this.setSize(V,Z,!1))},this.getSize=function(ve){return ve.set(V,Z)},this.setSize=function(ve,Ke,vt=!0){if(ht.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}V=ve,Z=Ke,n.width=Math.floor(ve*Y),n.height=Math.floor(Ke*Y),vt===!0&&(n.style.width=ve+"px",n.style.height=Ke+"px"),this.setViewport(0,0,ve,Ke)},this.getDrawingBufferSize=function(ve){return ve.set(V*Y,Z*Y).floor()},this.setDrawingBufferSize=function(ve,Ke,vt){V=ve,Z=Ke,Y=vt,n.width=Math.floor(ve*vt),n.height=Math.floor(Ke*vt),this.setViewport(0,0,ve,Ke)},this.getCurrentViewport=function(ve){return ve.copy($)},this.getViewport=function(ve){return ve.copy(de)},this.setViewport=function(ve,Ke,vt,yt){ve.isVector4?de.set(ve.x,ve.y,ve.z,ve.w):de.set(ve,Ke,vt,yt),dt.viewport($.copy(de).multiplyScalar(Y).round())},this.getScissor=function(ve){return ve.copy(Me)},this.setScissor=function(ve,Ke,vt,yt){ve.isVector4?Me.set(ve.x,ve.y,ve.z,ve.w):Me.set(ve,Ke,vt,yt),dt.scissor(q.copy(Me).multiplyScalar(Y).round())},this.getScissorTest=function(){return He},this.setScissorTest=function(ve){dt.setScissorTest(He=ve)},this.setOpaqueSort=function(ve){ee=ve},this.setTransparentSort=function(ve){oe=ve},this.getClearColor=function(ve){return ve.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor(...arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha(...arguments)},this.clear=function(ve=!0,Ke=!0,vt=!0){let yt=0;if(ve){let Ze=!1;if(k!==null){const Ht=k.texture.format;Ze=Ht===XO||Ht===ZU||Ht===YO}if(Ze){const Ht=k.texture.type,nn=Ht===ml||Ht===Pg||Ht===kw||Ht===tT||Ht===XU||Ht===KU,mn=me.getClearColor(),Sn=me.getClearAlpha(),oi=mn.r,ci=mn.g,Cn=mn.b;nn?(p[0]=oi,p[1]=ci,p[2]=Cn,p[3]=Sn,fe.clearBufferuiv(fe.COLOR,0,p)):(g[0]=oi,g[1]=ci,g[2]=Cn,g[3]=Sn,fe.clearBufferiv(fe.COLOR,0,g))}else yt|=fe.COLOR_BUFFER_BIT}Ke&&(yt|=fe.DEPTH_BUFFER_BIT),vt&&(yt|=fe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),fe.clear(yt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Pt,!1),n.removeEventListener("webglcontextrestored",hn,!1),n.removeEventListener("webglcontextcreationerror",an,!1),me.dispose(),Yt.dispose(),ce.dispose(),bt.dispose(),ue.dispose(),Xe.dispose(),Ue.dispose(),Vn.dispose(),qe.dispose(),qt.dispose(),ht.dispose(),ht.removeEventListener("sessionstart",Si),ht.removeEventListener("sessionend",si),En.stop()};function Pt(ve){ve.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),N=!0}function hn(){console.log("THREE.WebGLRenderer: Context Restored."),N=!1;const ve=gt.autoReset,Ke=W.enabled,vt=W.autoUpdate,yt=W.needsUpdate,Ze=W.type;Vt(),gt.autoReset=ve,W.enabled=Ke,W.autoUpdate=vt,W.needsUpdate=yt,W.type=Ze}function an(ve){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ve.statusMessage)}function Ve(ve){const Ke=ve.target;Ke.removeEventListener("dispose",Ve),ot(Ke)}function ot(ve){Ct(ve),bt.remove(ve)}function Ct(ve){const Ke=bt.get(ve).programs;Ke!==void 0&&(Ke.forEach(function(vt){qt.releaseProgram(vt)}),ve.isShaderMaterial&&qt.releaseShaderCache(ve))}this.renderBufferDirect=function(ve,Ke,vt,yt,Ze,Ht){Ke===null&&(Ke=Ee);const nn=Ze.isMesh&&Ze.matrixWorld.determinant()<0,mn=Zd(ve,Ke,vt,yt,Ze);dt.setMaterial(yt,nn);let Sn=vt.index,oi=1;if(yt.wireframe===!0){if(Sn=$e.getWireframeAttribute(vt),Sn===void 0)return;oi=2}const ci=vt.drawRange,Cn=vt.attributes.position;let gi=ci.start*oi,ar=(ci.start+ci.count)*oi;Ht!==null&&(gi=Math.max(gi,Ht.start*oi),ar=Math.min(ar,(Ht.start+Ht.count)*oi)),Sn!==null?(gi=Math.max(gi,0),ar=Math.min(ar,Sn.count)):Cn!=null&&(gi=Math.max(gi,0),ar=Math.min(ar,Cn.count));const As=ar-gi;if(As<0||As===1/0)return;Vn.setup(Ze,yt,mn,vt,Sn);let vs,Ki=je;if(Sn!==null&&(vs=nt.get(Sn),Ki=mt,Ki.setIndex(vs)),Ze.isMesh)yt.wireframe===!0?(dt.setLineWidth(yt.wireframeLinewidth*et()),Ki.setMode(fe.LINES)):Ki.setMode(fe.TRIANGLES);else if(Ze.isLine){let Yn=yt.linewidth;Yn===void 0&&(Yn=1),dt.setLineWidth(Yn*et()),Ze.isLineSegments?Ki.setMode(fe.LINES):Ze.isLineLoop?Ki.setMode(fe.LINE_LOOP):Ki.setMode(fe.LINE_STRIP)}else Ze.isPoints?Ki.setMode(fe.POINTS):Ze.isSprite&&Ki.setMode(fe.TRIANGLES);if(Ze.isBatchedMesh)if(Ze._multiDrawInstances!==null)PD("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ki.renderMultiDrawInstances(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount,Ze._multiDrawInstances);else if(Ie.get("WEBGL_multi_draw"))Ki.renderMultiDraw(Ze._multiDrawStarts,Ze._multiDrawCounts,Ze._multiDrawCount);else{const Yn=Ze._multiDrawStarts,Ti=Ze._multiDrawCounts,Bn=Ze._multiDrawCount,Ho=Sn?nt.get(Sn).bytesPerElement:1,zl=bt.get(yt).currentProgram.getUniforms();for(let eo=0;eo<Bn;eo++)zl.setValue(fe,"_gl_DrawID",eo),Ki.render(Yn[eo]/Ho,Ti[eo])}else if(Ze.isInstancedMesh)Ki.renderInstances(gi,As,Ze.count);else if(vt.isInstancedBufferGeometry){const Yn=vt._maxInstanceCount!==void 0?vt._maxInstanceCount:1/0,Ti=Math.min(vt.instanceCount,Yn);Ki.renderInstances(gi,As,Ti)}else Ki.render(gi,As)};function Nt(ve,Ke,vt){ve.transparent===!0&&ve.side===cl&&ve.forceSinglePass===!1?(ve.side=Pc,ve.needsUpdate=!0,ei(ve,Ke,vt),ve.side=Dg,ve.needsUpdate=!0,ei(ve,Ke,vt),ve.side=cl):ei(ve,Ke,vt)}this.compile=function(ve,Ke,vt=null){vt===null&&(vt=ve),v=ce.get(vt),v.init(Ke),T.push(v),vt.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(Ke.layers)&&(v.pushLight(Ze),Ze.castShadow&&v.pushShadow(Ze))}),ve!==vt&&ve.traverseVisible(function(Ze){Ze.isLight&&Ze.layers.test(Ke.layers)&&(v.pushLight(Ze),Ze.castShadow&&v.pushShadow(Ze))}),v.setupLights();const yt=new Set;return ve.traverse(function(Ze){if(!(Ze.isMesh||Ze.isPoints||Ze.isLine||Ze.isSprite))return;const Ht=Ze.material;if(Ht)if(Array.isArray(Ht))for(let nn=0;nn<Ht.length;nn++){const mn=Ht[nn];Nt(mn,vt,Ze),yt.add(mn)}else Nt(Ht,vt,Ze),yt.add(Ht)}),v=T.pop(),yt},this.compileAsync=function(ve,Ke,vt=null){const yt=this.compile(ve,Ke,vt);return new Promise(Ze=>{function Ht(){if(yt.forEach(function(nn){bt.get(nn).currentProgram.isReady()&&yt.delete(nn)}),yt.size===0){Ze(ve);return}setTimeout(Ht,10)}Ie.get("KHR_parallel_shader_compile")!==null?Ht():setTimeout(Ht,10)})};let Wn=null;function sr(ve){Wn&&Wn(ve)}function Si(){En.stop()}function si(){En.start()}const En=new Vae;En.setAnimationLoop(sr),typeof self<"u"&&En.setContext(self),this.setAnimationLoop=function(ve){Wn=ve,ht.setAnimationLoop(ve),ve===null?En.stop():En.start()},ht.addEventListener("sessionstart",Si),ht.addEventListener("sessionend",si),this.render=function(ve,Ke){if(Ke!==void 0&&Ke.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(N===!0)return;if(ve.matrixWorldAutoUpdate===!0&&ve.updateMatrixWorld(),Ke.parent===null&&Ke.matrixWorldAutoUpdate===!0&&Ke.updateMatrixWorld(),ht.enabled===!0&&ht.isPresenting===!0&&(ht.cameraAutoUpdate===!0&&ht.updateCamera(Ke),Ke=ht.getCamera()),ve.isScene===!0&&ve.onBeforeRender(x,ve,Ke,k),v=ce.get(ve,T.length),v.init(Ke),T.push(v),ke.multiplyMatrices(Ke.projectionMatrix,Ke.matrixWorldInverse),Te.setFromProjectionMatrix(ke),we=this.localClippingEnabled,Le=j.init(this.clippingPlanes,we),_=Yt.get(ve,E.length),_.init(),E.push(_),ht.enabled===!0&&ht.isPresenting===!0){const Ht=x.xr.getDepthSensingMesh();Ht!==null&&sn(Ht,Ke,-1/0,x.sortObjects)}sn(ve,Ke,0,x.sortObjects),_.finish(),x.sortObjects===!0&&_.sort(ee,oe),ye=ht.enabled===!1||ht.isPresenting===!1||ht.hasDepthSensing()===!1,ye&&me.addToRenderList(_,ve),this.info.render.frame++,Le===!0&&j.beginShadows();const vt=v.state.shadowsArray;W.render(vt,ve,Ke),Le===!0&&j.endShadows(),this.info.autoReset===!0&&this.info.reset();const yt=_.opaque,Ze=_.transmissive;if(v.setupLights(),Ke.isArrayCamera){const Ht=Ke.cameras;if(Ze.length>0)for(let nn=0,mn=Ht.length;nn<mn;nn++){const Sn=Ht[nn];Nn(yt,Ze,ve,Sn)}ye&&me.render(ve);for(let nn=0,mn=Ht.length;nn<mn;nn++){const Sn=Ht[nn];Ln(_,ve,Sn,Sn.viewport)}}else Ze.length>0&&Nn(yt,Ze,ve,Ke),ye&&me.render(ve),Ln(_,ve,Ke);k!==null&&I===0&&(be.updateMultisampleRenderTarget(k),be.updateRenderTargetMipmap(k)),ve.isScene===!0&&ve.onAfterRender(x,ve,Ke),Vn.resetDefaultState(),L=-1,U=null,T.pop(),T.length>0?(v=T[T.length-1],Le===!0&&j.setGlobalState(x.clippingPlanes,v.state.camera)):v=null,E.pop(),E.length>0?_=E[E.length-1]:_=null};function sn(ve,Ke,vt,yt){if(ve.visible===!1)return;if(ve.layers.test(Ke.layers)){if(ve.isGroup)vt=ve.renderOrder;else if(ve.isLOD)ve.autoUpdate===!0&&ve.update(Ke);else if(ve.isLight)v.pushLight(ve),ve.castShadow&&v.pushShadow(ve);else if(ve.isSprite){if(!ve.frustumCulled||Te.intersectsSprite(ve)){yt&&At.setFromMatrixPosition(ve.matrixWorld).applyMatrix4(ke);const nn=Ue.update(ve),mn=ve.material;mn.visible&&_.push(ve,nn,mn,vt,At.z,null)}}else if((ve.isMesh||ve.isLine||ve.isPoints)&&(!ve.frustumCulled||Te.intersectsObject(ve))){const nn=Ue.update(ve),mn=ve.material;if(yt&&(ve.boundingSphere!==void 0?(ve.boundingSphere===null&&ve.computeBoundingSphere(),At.copy(ve.boundingSphere.center)):(nn.boundingSphere===null&&nn.computeBoundingSphere(),At.copy(nn.boundingSphere.center)),At.applyMatrix4(ve.matrixWorld).applyMatrix4(ke)),Array.isArray(mn)){const Sn=nn.groups;for(let oi=0,ci=Sn.length;oi<ci;oi++){const Cn=Sn[oi],gi=mn[Cn.materialIndex];gi&&gi.visible&&_.push(ve,nn,gi,vt,At.z,Cn)}}else mn.visible&&_.push(ve,nn,mn,vt,At.z,null)}}const Ht=ve.children;for(let nn=0,mn=Ht.length;nn<mn;nn++)sn(Ht[nn],Ke,vt,yt)}function Ln(ve,Ke,vt,yt){const Ze=ve.opaque,Ht=ve.transmissive,nn=ve.transparent;v.setupLightsView(vt),Le===!0&&j.setGlobalState(x.clippingPlanes,vt),yt&&dt.viewport($.copy(yt)),Ze.length>0&&di(Ze,Ke,vt),Ht.length>0&&di(Ht,Ke,vt),nn.length>0&&di(nn,Ke,vt),dt.buffers.depth.setTest(!0),dt.buffers.depth.setMask(!0),dt.buffers.color.setMask(!0),dt.setPolygonOffset(!1)}function Nn(ve,Ke,vt,yt){if((vt.isScene===!0?vt.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[yt.id]===void 0&&(v.state.transmissionRenderTarget[yt.id]=new Ul(1,1,{generateMipmaps:!0,type:Ie.has("EXT_color_buffer_half_float")||Ie.has("EXT_color_buffer_float")?Lb:ml,minFilter:gg,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Lr.workingColorSpace}));const Ht=v.state.transmissionRenderTarget[yt.id],nn=yt.viewport||$;Ht.setSize(nn.z*x.transmissionResolutionScale,nn.w*x.transmissionResolutionScale);const mn=x.getRenderTarget();x.setRenderTarget(Ht),x.getClearColor(X),ie=x.getClearAlpha(),ie<1&&x.setClearColor(16777215,.5),x.clear(),ye&&me.render(vt);const Sn=x.toneMapping;x.toneMapping=Kp;const oi=yt.viewport;if(yt.viewport!==void 0&&(yt.viewport=void 0),v.setupLightsView(yt),Le===!0&&j.setGlobalState(x.clippingPlanes,yt),di(ve,vt,yt),be.updateMultisampleRenderTarget(Ht),be.updateRenderTargetMipmap(Ht),Ie.has("WEBGL_multisampled_render_to_texture")===!1){let ci=!1;for(let Cn=0,gi=Ke.length;Cn<gi;Cn++){const ar=Ke[Cn],As=ar.object,vs=ar.geometry,Ki=ar.material,Yn=ar.group;if(Ki.side===cl&&As.layers.test(yt.layers)){const Ti=Ki.side;Ki.side=Pc,Ki.needsUpdate=!0,ur(As,vt,yt,vs,Ki,Yn),Ki.side=Ti,Ki.needsUpdate=!0,ci=!0}}ci===!0&&(be.updateMultisampleRenderTarget(Ht),be.updateRenderTargetMipmap(Ht))}x.setRenderTarget(mn),x.setClearColor(X,ie),oi!==void 0&&(yt.viewport=oi),x.toneMapping=Sn}function di(ve,Ke,vt){const yt=Ke.isScene===!0?Ke.overrideMaterial:null;for(let Ze=0,Ht=ve.length;Ze<Ht;Ze++){const nn=ve[Ze],mn=nn.object,Sn=nn.geometry,oi=nn.group;let ci=nn.material;ci.allowOverride===!0&&yt!==null&&(ci=yt),mn.layers.test(vt.layers)&&ur(mn,Ke,vt,Sn,ci,oi)}}function ur(ve,Ke,vt,yt,Ze,Ht){ve.onBeforeRender(x,Ke,vt,yt,Ze,Ht),ve.modelViewMatrix.multiplyMatrices(vt.matrixWorldInverse,ve.matrixWorld),ve.normalMatrix.getNormalMatrix(ve.modelViewMatrix),Ze.onBeforeRender(x,Ke,vt,yt,ve,Ht),Ze.transparent===!0&&Ze.side===cl&&Ze.forceSinglePass===!1?(Ze.side=Pc,Ze.needsUpdate=!0,x.renderBufferDirect(vt,Ke,yt,Ze,ve,Ht),Ze.side=Dg,Ze.needsUpdate=!0,x.renderBufferDirect(vt,Ke,yt,Ze,ve,Ht),Ze.side=cl):x.renderBufferDirect(vt,Ke,yt,Ze,ve,Ht),ve.onAfterRender(x,Ke,vt,yt,Ze,Ht)}function ei(ve,Ke,vt){Ke.isScene!==!0&&(Ke=Ee);const yt=bt.get(ve),Ze=v.state.lights,Ht=v.state.shadowsArray,nn=Ze.state.version,mn=qt.getParameters(ve,Ze.state,Ht,Ke,vt),Sn=qt.getProgramCacheKey(mn);let oi=yt.programs;yt.environment=ve.isMeshStandardMaterial?Ke.environment:null,yt.fog=Ke.fog,yt.envMap=(ve.isMeshStandardMaterial?Xe:ue).get(ve.envMap||yt.environment),yt.envMapRotation=yt.environment!==null&&ve.envMap===null?Ke.environmentRotation:ve.envMapRotation,oi===void 0&&(ve.addEventListener("dispose",Ve),oi=new Map,yt.programs=oi);let ci=oi.get(Sn);if(ci!==void 0){if(yt.currentProgram===ci&&yt.lightsStateVersion===nn)return gu(ve,mn),ci}else mn.uniforms=qt.getUniforms(ve),ve.onBeforeCompile(mn,x),ci=qt.acquireProgram(mn,Sn),oi.set(Sn,ci),yt.uniforms=mn.uniforms;const Cn=yt.uniforms;return(!ve.isShaderMaterial&&!ve.isRawShaderMaterial||ve.clipping===!0)&&(Cn.clippingPlanes=j.uniform),gu(ve,mn),yt.needsLights=u0(ve),yt.lightsStateVersion=nn,yt.needsLights&&(Cn.ambientLightColor.value=Ze.state.ambient,Cn.lightProbe.value=Ze.state.probe,Cn.directionalLights.value=Ze.state.directional,Cn.directionalLightShadows.value=Ze.state.directionalShadow,Cn.spotLights.value=Ze.state.spot,Cn.spotLightShadows.value=Ze.state.spotShadow,Cn.rectAreaLights.value=Ze.state.rectArea,Cn.ltc_1.value=Ze.state.rectAreaLTC1,Cn.ltc_2.value=Ze.state.rectAreaLTC2,Cn.pointLights.value=Ze.state.point,Cn.pointLightShadows.value=Ze.state.pointShadow,Cn.hemisphereLights.value=Ze.state.hemi,Cn.directionalShadowMap.value=Ze.state.directionalShadowMap,Cn.directionalShadowMatrix.value=Ze.state.directionalShadowMatrix,Cn.spotShadowMap.value=Ze.state.spotShadowMap,Cn.spotLightMatrix.value=Ze.state.spotLightMatrix,Cn.spotLightMap.value=Ze.state.spotLightMap,Cn.pointShadowMap.value=Ze.state.pointShadowMap,Cn.pointShadowMatrix.value=Ze.state.pointShadowMatrix),yt.currentProgram=ci,yt.uniformsList=null,ci}function La(ve){if(ve.uniformsList===null){const Ke=ve.currentProgram.getUniforms();ve.uniformsList=UD.seqWithValue(Ke.seq,ve.uniforms)}return ve.uniformsList}function gu(ve,Ke){const vt=bt.get(ve);vt.outputColorSpace=Ke.outputColorSpace,vt.batching=Ke.batching,vt.batchingColor=Ke.batchingColor,vt.instancing=Ke.instancing,vt.instancingColor=Ke.instancingColor,vt.instancingMorph=Ke.instancingMorph,vt.skinning=Ke.skinning,vt.morphTargets=Ke.morphTargets,vt.morphNormals=Ke.morphNormals,vt.morphColors=Ke.morphColors,vt.morphTargetsCount=Ke.morphTargetsCount,vt.numClippingPlanes=Ke.numClippingPlanes,vt.numIntersection=Ke.numClipIntersection,vt.vertexAlphas=Ke.vertexAlphas,vt.vertexTangents=Ke.vertexTangents,vt.toneMapping=Ke.toneMapping}function Zd(ve,Ke,vt,yt,Ze){Ke.isScene!==!0&&(Ke=Ee),be.resetTextureUnits();const Ht=Ke.fog,nn=yt.isMeshStandardMaterial?Ke.environment:null,mn=k===null?x.outputColorSpace:k.isXRRenderTarget===!0?k.texture.colorSpace:Lg,Sn=(yt.isMeshStandardMaterial?Xe:ue).get(yt.envMap||nn),oi=yt.vertexColors===!0&&!!vt.attributes.color&&vt.attributes.color.itemSize===4,ci=!!vt.attributes.tangent&&(!!yt.normalMap||yt.anisotropy>0),Cn=!!vt.morphAttributes.position,gi=!!vt.morphAttributes.normal,ar=!!vt.morphAttributes.color;let As=Kp;yt.toneMapped&&(k===null||k.isXRRenderTarget===!0)&&(As=x.toneMapping);const vs=vt.morphAttributes.position||vt.morphAttributes.normal||vt.morphAttributes.color,Ki=vs!==void 0?vs.length:0,Yn=bt.get(yt),Ti=v.state.lights;if(Le===!0&&(we===!0||ve!==U)){const Hs=ve===U&&yt.id===L;j.setState(yt,ve,Hs)}let Bn=!1;yt.version===Yn.__version?(Yn.needsLights&&Yn.lightsStateVersion!==Ti.state.version||Yn.outputColorSpace!==mn||Ze.isBatchedMesh&&Yn.batching===!1||!Ze.isBatchedMesh&&Yn.batching===!0||Ze.isBatchedMesh&&Yn.batchingColor===!0&&Ze.colorTexture===null||Ze.isBatchedMesh&&Yn.batchingColor===!1&&Ze.colorTexture!==null||Ze.isInstancedMesh&&Yn.instancing===!1||!Ze.isInstancedMesh&&Yn.instancing===!0||Ze.isSkinnedMesh&&Yn.skinning===!1||!Ze.isSkinnedMesh&&Yn.skinning===!0||Ze.isInstancedMesh&&Yn.instancingColor===!0&&Ze.instanceColor===null||Ze.isInstancedMesh&&Yn.instancingColor===!1&&Ze.instanceColor!==null||Ze.isInstancedMesh&&Yn.instancingMorph===!0&&Ze.morphTexture===null||Ze.isInstancedMesh&&Yn.instancingMorph===!1&&Ze.morphTexture!==null||Yn.envMap!==Sn||yt.fog===!0&&Yn.fog!==Ht||Yn.numClippingPlanes!==void 0&&(Yn.numClippingPlanes!==j.numPlanes||Yn.numIntersection!==j.numIntersection)||Yn.vertexAlphas!==oi||Yn.vertexTangents!==ci||Yn.morphTargets!==Cn||Yn.morphNormals!==gi||Yn.morphColors!==ar||Yn.toneMapping!==As||Yn.morphTargetsCount!==Ki)&&(Bn=!0):(Bn=!0,Yn.__version=yt.version);let Ho=Yn.currentProgram;Bn===!0&&(Ho=ei(yt,Ke,Ze));let zl=!1,eo=!1,sh=!1;const cs=Ho.getUniforms(),bn=Yn.uniforms;if(dt.useProgram(Ho.program)&&(zl=!0,eo=!0,sh=!0),yt.id!==L&&(L=yt.id,eo=!0),zl||U!==ve){dt.buffers.depth.getReversed()?(Ce.copy(ve.projectionMatrix),eTe(Ce),tTe(Ce),cs.setValue(fe,"projectionMatrix",Ce)):cs.setValue(fe,"projectionMatrix",ve.projectionMatrix),cs.setValue(fe,"viewMatrix",ve.matrixWorldInverse);const qn=cs.map.cameraPosition;qn!==void 0&&qn.setValue(fe,St.setFromMatrixPosition(ve.matrixWorld)),it.logarithmicDepthBuffer&&cs.setValue(fe,"logDepthBufFC",2/(Math.log(ve.far+1)/Math.LN2)),(yt.isMeshPhongMaterial||yt.isMeshToonMaterial||yt.isMeshLambertMaterial||yt.isMeshBasicMaterial||yt.isMeshStandardMaterial||yt.isShaderMaterial)&&cs.setValue(fe,"isOrthographic",ve.isOrthographicCamera===!0),U!==ve&&(U=ve,eo=!0,sh=!0)}if(Ze.isSkinnedMesh){cs.setOptional(fe,Ze,"bindMatrix"),cs.setOptional(fe,Ze,"bindMatrixInverse");const Hs=Ze.skeleton;Hs&&(Hs.boneTexture===null&&Hs.computeBoneTexture(),cs.setValue(fe,"boneTexture",Hs.boneTexture,be))}Ze.isBatchedMesh&&(cs.setOptional(fe,Ze,"batchingTexture"),cs.setValue(fe,"batchingTexture",Ze._matricesTexture,be),cs.setOptional(fe,Ze,"batchingIdTexture"),cs.setValue(fe,"batchingIdTexture",Ze._indirectTexture,be),cs.setOptional(fe,Ze,"batchingColorTexture"),Ze._colorsTexture!==null&&cs.setValue(fe,"batchingColorTexture",Ze._colorsTexture,be));const to=vt.morphAttributes;if((to.position!==void 0||to.normal!==void 0||to.color!==void 0)&&De.update(Ze,vt,Ho),(eo||Yn.receiveShadow!==Ze.receiveShadow)&&(Yn.receiveShadow=Ze.receiveShadow,cs.setValue(fe,"receiveShadow",Ze.receiveShadow)),yt.isMeshGouraudMaterial&&yt.envMap!==null&&(bn.envMap.value=Sn,bn.flipEnvMap.value=Sn.isCubeTexture&&Sn.isRenderTargetTexture===!1?-1:1),yt.isMeshStandardMaterial&&yt.envMap===null&&Ke.environment!==null&&(bn.envMapIntensity.value=Ke.environmentIntensity),eo&&(cs.setValue(fe,"toneMappingExposure",x.toneMappingExposure),Yn.needsLights&&mp(bn,sh),Ht&&yt.fog===!0&&Mt.refreshFogUniforms(bn,Ht),Mt.refreshMaterialUniforms(bn,yt,Y,Z,v.state.transmissionRenderTarget[ve.id]),UD.upload(fe,La(Yn),bn,be)),yt.isShaderMaterial&&yt.uniformsNeedUpdate===!0&&(UD.upload(fe,La(Yn),bn,be),yt.uniformsNeedUpdate=!1),yt.isSpriteMaterial&&cs.setValue(fe,"center",Ze.center),cs.setValue(fe,"modelViewMatrix",Ze.modelViewMatrix),cs.setValue(fe,"normalMatrix",Ze.normalMatrix),cs.setValue(fe,"modelMatrix",Ze.matrixWorld),yt.isShaderMaterial||yt.isRawShaderMaterial){const Hs=yt.uniformsGroups;for(let qn=0,_l=Hs.length;qn<_l;qn++){const oa=Hs[qn];qe.update(oa,Ho),qe.bind(oa,Ho)}}return Ho}function mp(ve,Ke){ve.ambientLightColor.needsUpdate=Ke,ve.lightProbe.needsUpdate=Ke,ve.directionalLights.needsUpdate=Ke,ve.directionalLightShadows.needsUpdate=Ke,ve.pointLights.needsUpdate=Ke,ve.pointLightShadows.needsUpdate=Ke,ve.spotLights.needsUpdate=Ke,ve.spotLightShadows.needsUpdate=Ke,ve.rectAreaLights.needsUpdate=Ke,ve.hemisphereLights.needsUpdate=Ke}function u0(ve){return ve.isMeshLambertMaterial||ve.isMeshToonMaterial||ve.isMeshPhongMaterial||ve.isMeshStandardMaterial||ve.isShadowMaterial||ve.isShaderMaterial&&ve.lights===!0}this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return k},this.setRenderTargetTextures=function(ve,Ke,vt){const yt=bt.get(ve);yt.__autoAllocateDepthBuffer=ve.resolveDepthBuffer===!1,yt.__autoAllocateDepthBuffer===!1&&(yt.__useRenderToTexture=!1),bt.get(ve.texture).__webglTexture=Ke,bt.get(ve.depthTexture).__webglTexture=yt.__autoAllocateDepthBuffer?void 0:vt,yt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(ve,Ke){const vt=bt.get(ve);vt.__webglFramebuffer=Ke,vt.__useDefaultFramebuffer=Ke===void 0};const Qd=fe.createFramebuffer();this.setRenderTarget=function(ve,Ke=0,vt=0){k=ve,A=Ke,I=vt;let yt=!0,Ze=null,Ht=!1,nn=!1;if(ve){const Sn=bt.get(ve);if(Sn.__useDefaultFramebuffer!==void 0)dt.bindFramebuffer(fe.FRAMEBUFFER,null),yt=!1;else if(Sn.__webglFramebuffer===void 0)be.setupRenderTarget(ve);else if(Sn.__hasExternalTextures)be.rebindTextures(ve,bt.get(ve.texture).__webglTexture,bt.get(ve.depthTexture).__webglTexture);else if(ve.depthBuffer){const Cn=ve.depthTexture;if(Sn.__boundDepthTexture!==Cn){if(Cn!==null&&bt.has(Cn)&&(ve.width!==Cn.image.width||ve.height!==Cn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");be.setupDepthRenderbuffer(ve)}}const oi=ve.texture;(oi.isData3DTexture||oi.isDataArrayTexture||oi.isCompressedArrayTexture)&&(nn=!0);const ci=bt.get(ve).__webglFramebuffer;ve.isWebGLCubeRenderTarget?(Array.isArray(ci[Ke])?Ze=ci[Ke][vt]:Ze=ci[Ke],Ht=!0):ve.samples>0&&be.useMultisampledRTT(ve)===!1?Ze=bt.get(ve).__webglMultisampledFramebuffer:Array.isArray(ci)?Ze=ci[vt]:Ze=ci,$.copy(ve.viewport),q.copy(ve.scissor),G=ve.scissorTest}else $.copy(de).multiplyScalar(Y).floor(),q.copy(Me).multiplyScalar(Y).floor(),G=He;if(vt!==0&&(Ze=Qd),dt.bindFramebuffer(fe.FRAMEBUFFER,Ze)&&yt&&dt.drawBuffers(ve,Ze),dt.viewport($),dt.scissor(q),dt.setScissorTest(G),Ht){const Sn=bt.get(ve.texture);fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_CUBE_MAP_POSITIVE_X+Ke,Sn.__webglTexture,vt)}else if(nn){const Sn=bt.get(ve.texture),oi=Ke;fe.framebufferTextureLayer(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,Sn.__webglTexture,vt,oi)}else if(ve!==null&&vt!==0){const Sn=bt.get(ve.texture);fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,Sn.__webglTexture,vt)}L=-1},this.readRenderTargetPixels=function(ve,Ke,vt,yt,Ze,Ht,nn){if(!(ve&&ve.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let mn=bt.get(ve).__webglFramebuffer;if(ve.isWebGLCubeRenderTarget&&nn!==void 0&&(mn=mn[nn]),mn){dt.bindFramebuffer(fe.FRAMEBUFFER,mn);try{const Sn=ve.texture,oi=Sn.format,ci=Sn.type;if(!it.textureFormatReadable(oi)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!it.textureTypeReadable(ci)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ke>=0&&Ke<=ve.width-yt&&vt>=0&&vt<=ve.height-Ze&&fe.readPixels(Ke,vt,yt,Ze,xt.convert(oi),xt.convert(ci),Ht)}finally{const Sn=k!==null?bt.get(k).__webglFramebuffer:null;dt.bindFramebuffer(fe.FRAMEBUFFER,Sn)}}},this.readRenderTargetPixelsAsync=async function(ve,Ke,vt,yt,Ze,Ht,nn){if(!(ve&&ve.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let mn=bt.get(ve).__webglFramebuffer;if(ve.isWebGLCubeRenderTarget&&nn!==void 0&&(mn=mn[nn]),mn)if(Ke>=0&&Ke<=ve.width-yt&&vt>=0&&vt<=ve.height-Ze){dt.bindFramebuffer(fe.FRAMEBUFFER,mn);const Sn=ve.texture,oi=Sn.format,ci=Sn.type;if(!it.textureFormatReadable(oi))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!it.textureTypeReadable(ci))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const Cn=fe.createBuffer();fe.bindBuffer(fe.PIXEL_PACK_BUFFER,Cn),fe.bufferData(fe.PIXEL_PACK_BUFFER,Ht.byteLength,fe.STREAM_READ),fe.readPixels(Ke,vt,yt,Ze,xt.convert(oi),xt.convert(ci),0);const gi=k!==null?bt.get(k).__webglFramebuffer:null;dt.bindFramebuffer(fe.FRAMEBUFFER,gi);const ar=fe.fenceSync(fe.SYNC_GPU_COMMANDS_COMPLETE,0);return fe.flush(),await QSe(fe,ar,4),fe.bindBuffer(fe.PIXEL_PACK_BUFFER,Cn),fe.getBufferSubData(fe.PIXEL_PACK_BUFFER,0,Ht),fe.deleteBuffer(Cn),fe.deleteSync(ar),Ht}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(ve,Ke=null,vt=0){const yt=Math.pow(2,-vt),Ze=Math.floor(ve.image.width*yt),Ht=Math.floor(ve.image.height*yt),nn=Ke!==null?Ke.x:0,mn=Ke!==null?Ke.y:0;be.setTexture2D(ve,0),fe.copyTexSubImage2D(fe.TEXTURE_2D,vt,0,0,nn,mn,Ze,Ht),dt.unbindTexture()};const ef=fe.createFramebuffer(),vu=fe.createFramebuffer();this.copyTextureToTexture=function(ve,Ke,vt=null,yt=null,Ze=0,Ht=null){Ht===null&&(Ze!==0?(PD("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ht=Ze,Ze=0):Ht=0);let nn,mn,Sn,oi,ci,Cn,gi,ar,As;const vs=ve.isCompressedTexture?ve.mipmaps[Ht]:ve.image;if(vt!==null)nn=vt.max.x-vt.min.x,mn=vt.max.y-vt.min.y,Sn=vt.isBox3?vt.max.z-vt.min.z:1,oi=vt.min.x,ci=vt.min.y,Cn=vt.isBox3?vt.min.z:0;else{const to=Math.pow(2,-Ze);nn=Math.floor(vs.width*to),mn=Math.floor(vs.height*to),ve.isDataArrayTexture?Sn=vs.depth:ve.isData3DTexture?Sn=Math.floor(vs.depth*to):Sn=1,oi=0,ci=0,Cn=0}yt!==null?(gi=yt.x,ar=yt.y,As=yt.z):(gi=0,ar=0,As=0);const Ki=xt.convert(Ke.format),Yn=xt.convert(Ke.type);let Ti;Ke.isData3DTexture?(be.setTexture3D(Ke,0),Ti=fe.TEXTURE_3D):Ke.isDataArrayTexture||Ke.isCompressedArrayTexture?(be.setTexture2DArray(Ke,0),Ti=fe.TEXTURE_2D_ARRAY):(be.setTexture2D(Ke,0),Ti=fe.TEXTURE_2D),fe.pixelStorei(fe.UNPACK_FLIP_Y_WEBGL,Ke.flipY),fe.pixelStorei(fe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ke.premultiplyAlpha),fe.pixelStorei(fe.UNPACK_ALIGNMENT,Ke.unpackAlignment);const Bn=fe.getParameter(fe.UNPACK_ROW_LENGTH),Ho=fe.getParameter(fe.UNPACK_IMAGE_HEIGHT),zl=fe.getParameter(fe.UNPACK_SKIP_PIXELS),eo=fe.getParameter(fe.UNPACK_SKIP_ROWS),sh=fe.getParameter(fe.UNPACK_SKIP_IMAGES);fe.pixelStorei(fe.UNPACK_ROW_LENGTH,vs.width),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,vs.height),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,oi),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,ci),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,Cn);const cs=ve.isDataArrayTexture||ve.isData3DTexture,bn=Ke.isDataArrayTexture||Ke.isData3DTexture;if(ve.isDepthTexture){const to=bt.get(ve),Hs=bt.get(Ke),qn=bt.get(to.__renderTarget),_l=bt.get(Hs.__renderTarget);dt.bindFramebuffer(fe.READ_FRAMEBUFFER,qn.__webglFramebuffer),dt.bindFramebuffer(fe.DRAW_FRAMEBUFFER,_l.__webglFramebuffer);for(let oa=0;oa<Sn;oa++)cs&&(fe.framebufferTextureLayer(fe.READ_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,bt.get(ve).__webglTexture,Ze,Cn+oa),fe.framebufferTextureLayer(fe.DRAW_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,bt.get(Ke).__webglTexture,Ht,As+oa)),fe.blitFramebuffer(oi,ci,nn,mn,gi,ar,nn,mn,fe.DEPTH_BUFFER_BIT,fe.NEAREST);dt.bindFramebuffer(fe.READ_FRAMEBUFFER,null),dt.bindFramebuffer(fe.DRAW_FRAMEBUFFER,null)}else if(Ze!==0||ve.isRenderTargetTexture||bt.has(ve)){const to=bt.get(ve),Hs=bt.get(Ke);dt.bindFramebuffer(fe.READ_FRAMEBUFFER,ef),dt.bindFramebuffer(fe.DRAW_FRAMEBUFFER,vu);for(let qn=0;qn<Sn;qn++)cs?fe.framebufferTextureLayer(fe.READ_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,to.__webglTexture,Ze,Cn+qn):fe.framebufferTexture2D(fe.READ_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,to.__webglTexture,Ze),bn?fe.framebufferTextureLayer(fe.DRAW_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,Hs.__webglTexture,Ht,As+qn):fe.framebufferTexture2D(fe.DRAW_FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,Hs.__webglTexture,Ht),Ze!==0?fe.blitFramebuffer(oi,ci,nn,mn,gi,ar,nn,mn,fe.COLOR_BUFFER_BIT,fe.NEAREST):bn?fe.copyTexSubImage3D(Ti,Ht,gi,ar,As+qn,oi,ci,nn,mn):fe.copyTexSubImage2D(Ti,Ht,gi,ar,oi,ci,nn,mn);dt.bindFramebuffer(fe.READ_FRAMEBUFFER,null),dt.bindFramebuffer(fe.DRAW_FRAMEBUFFER,null)}else bn?ve.isDataTexture||ve.isData3DTexture?fe.texSubImage3D(Ti,Ht,gi,ar,As,nn,mn,Sn,Ki,Yn,vs.data):Ke.isCompressedArrayTexture?fe.compressedTexSubImage3D(Ti,Ht,gi,ar,As,nn,mn,Sn,Ki,vs.data):fe.texSubImage3D(Ti,Ht,gi,ar,As,nn,mn,Sn,Ki,Yn,vs):ve.isDataTexture?fe.texSubImage2D(fe.TEXTURE_2D,Ht,gi,ar,nn,mn,Ki,Yn,vs.data):ve.isCompressedTexture?fe.compressedTexSubImage2D(fe.TEXTURE_2D,Ht,gi,ar,vs.width,vs.height,Ki,vs.data):fe.texSubImage2D(fe.TEXTURE_2D,Ht,gi,ar,nn,mn,Ki,Yn,vs);fe.pixelStorei(fe.UNPACK_ROW_LENGTH,Bn),fe.pixelStorei(fe.UNPACK_IMAGE_HEIGHT,Ho),fe.pixelStorei(fe.UNPACK_SKIP_PIXELS,zl),fe.pixelStorei(fe.UNPACK_SKIP_ROWS,eo),fe.pixelStorei(fe.UNPACK_SKIP_IMAGES,sh),Ht===0&&Ke.generateMipmaps&&fe.generateMipmap(Ti),dt.unbindTexture()},this.copyTextureToTexture3D=function(ve,Ke,vt=null,yt=null,Ze=0){return PD('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(ve,Ke,vt,yt,Ze)},this.initRenderTarget=function(ve){bt.get(ve).__webglFramebuffer===void 0&&be.setupRenderTarget(ve)},this.initTexture=function(ve){ve.isCubeTexture?be.setTextureCube(ve,0):ve.isData3DTexture?be.setTexture3D(ve,0):ve.isDataArrayTexture||ve.isCompressedArrayTexture?be.setTexture2DArray(ve,0):be.setTexture2D(ve,0),dt.unbindTexture()},this.resetState=function(){A=0,I=0,k=null,dt.reset(),Vn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return jf}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=Lr._getDrawingBufferColorSpace(e),n.unpackColorSpace=Lr._getUnpackColorSpace()}}const fMe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:cq,AddEquation:L_,AddOperation:vse,AdditiveAnimationBlendMode:vq,AdditiveBlending:Rj,AgXToneMapping:Sse,AlphaFormat:fq,AlwaysCompare:Lse,AlwaysDepth:XP,AlwaysStencilFunc:Nj,AmbientLight:Nae,AnimationAction:zae,AnimationClip:OM,AnimationLoader:Rxe,AnimationMixer:n1e,AnimationObjectGroup:e1e,AnimationUtils:Txe,ArcCurve:iae,ArrayCamera:Uae,ArrowHelper:x1e,AttachedBindMode:Oj,Audio:Bae,AudioAnalyser:Gxe,AudioContext:zq,AudioListener:Hxe,AudioLoader:Bxe,AxesHelper:w1e,BackSide:Pc,BasicDepthPacking:Ub,BasicShadowMap:Jre,BatchedMesh:Jse,Bone:Tq,BooleanKeyframeTrack:LT,Box2:Hae,Box3:cu,Box3Helper:S1e,BoxGeometry:PT,BoxHelper:E1e,BufferAttribute:rr,BufferGeometry:Qi,BufferGeometryLoader:Lae,ByteType:uq,Cache:Ov,Camera:JO,CameraHelper:b1e,CanvasTexture:tae,CapsuleGeometry:c3,CatmullRomCurve3:rae,CineonToneMapping:bse,CircleGeometry:l3,ClampToEdgeWrapping:Hf,Clock:Hq,Color:_n,ColorKeyframeTrack:Uq,ColorManagement:Lr,CompressedArrayTexture:GTe,CompressedCubeTexture:qTe,CompressedTexture:o3,CompressedTextureLoader:Axe,ConeGeometry:eN,ConstantAlphaFactor:pse,ConstantColorFactor:dse,Controls:R1e,CubeCamera:Gse,CubeReflectionMapping:Xv,CubeRefractionMapping:vb,CubeTexture:ZO,CubeTextureLoader:Mxe,CubeUVReflectionMapping:IC,CubicBezierCurve:Cq,CubicBezierCurve3:sae,CubicInterpolant:Tae,CullFaceBack:Cj,CullFaceFront:Kre,CullFaceFrontBack:QEe,CullFaceNone:Xre,Curve:am,CurvePath:oae,CustomBlending:Zre,CustomToneMapping:Ese,CylinderGeometry:QO,Cylindrical:u1e,Data3DTexture:t3,DataArrayTexture:KO,DataTexture:Xf,DataTextureLoader:Oxe,DataUtils:gTe,DecrementStencilOp:fSe,DecrementWrapStencilOp:mSe,DefaultLoadingManager:Cae,DepthArrayTexture:$Te,DepthFormat:Dw,DepthStencilFormat:nT,DepthTexture:PC,DetachedBindMode:xse,DirectionalLight:Oae,DirectionalLightHelper:_1e,DiscreteInterpolant:xae,DodecahedronGeometry:u3,DoubleSide:cl,DstAlphaFactor:ose,DstColorFactor:lse,DynamicCopyUsage:OSe,DynamicDrawUsage:xSe,DynamicReadUsage:RSe,EdgesGeometry:nae,EllipseCurve:h3,EqualCompare:Ise,EqualDepth:JP,EqualStencilFunc:_Se,EquirectangularReflectionMapping:mM,EquirectangularRefractionMapping:gM,Euler:$h,EventDispatcher:Yd,ExtrudeGeometry:d3,FileLoader:Kv,Float16BufferAttribute:TTe,Float32BufferAttribute:Hn,FloatType:iu,Fog:i3,FogExp2:n3,FramebufferTexture:VTe,FrontSide:Dg,Frustum:DC,FrustumArray:a3,GLBufferAttribute:c1e,GLSL1:ISe,GLSL3:Ij,GreaterCompare:kse,GreaterDepth:QP,GreaterEqualCompare:Pse,GreaterEqualDepth:ZP,GreaterEqualStencilFunc:TSe,GreaterStencilFunc:ESe,GridHelper:v1e,Group:N1,HalfFloatType:Lb,HemisphereLight:Rae,HemisphereLightHelper:g1e,IcosahedronGeometry:f3,ImageBitmapLoader:Uxe,ImageLoader:NM,ImageUtils:zse,IncrementStencilOp:dSe,IncrementWrapStencilOp:pSe,InstancedBufferAttribute:Fw,InstancedBufferGeometry:Pae,InstancedInterleavedBuffer:o1e,InstancedMesh:Kse,Int16BufferAttribute:ETe,Int32BufferAttribute:STe,Int8BufferAttribute:yTe,IntType:YU,InterleavedBuffer:r3,InterleavedBufferAttribute:iT,Interpolant:iN,InterpolateDiscrete:_M,InterpolateLinear:RL,InterpolateSmooth:DD,InterpolationSamplingMode:PSe,InterpolationSamplingType:DSe,InvertStencilOp:gSe,KeepStencilOp:fS,KeyframeTrack:cp,LOD:Yse,LatheGeometry:p3,Layers:Lw,LessCompare:Nse,LessDepth:KP,LessEqualCompare:yq,LessEqualDepth:eT,LessEqualStencilFunc:bSe,LessStencilFunc:ySe,Light:Hb,LightProbe:Dae,Line:yb,Line3:h1e,LineBasicMaterial:th,LineCurve:Rq,LineCurve3:aae,LineDashedMaterial:bae,LineLoop:Zse,LineSegments:Yg,LinearFilter:_a,LinearInterpolant:Lq,LinearMipMapLinearFilter:iSe,LinearMipMapNearestFilter:nSe,LinearMipmapLinearFilter:gg,LinearMipmapNearestFilter:RA,LinearSRGBColorSpace:Lg,LinearToneMapping:yse,LinearTransfer:EM,Loader:nd,LoaderUtils:Uj,LoadingManager:Bq,LoopOnce:wse,LoopPingPong:Rse,LoopRepeat:Cse,MOUSE:JEe,Material:yl,MaterialLoader:E3,MathUtils:Use,Matrix2:qq,Matrix3:Zi,Matrix4:Ni,MaxEquation:nse,Mesh:Bo,MeshBasicMaterial:Fb,MeshDepthMaterial:kq,MeshDistanceMaterial:Dq,MeshLambertMaterial:yae,MeshMatcapMaterial:_ae,MeshNormalMaterial:Iq,MeshPhongMaterial:gae,MeshPhysicalMaterial:mae,MeshStandardMaterial:Nq,MeshToonMaterial:vae,MinEquation:tse,MirroredRepeatWrapping:yM,MixOperation:gse,MultiplyBlending:Mj,MultiplyOperation:WO,NearestFilter:Za,NearestMipMapLinearFilter:tSe,NearestMipMapNearestFilter:eSe,NearestMipmapLinearFilter:M1,NearestMipmapNearestFilter:lq,NeutralToneMapping:Tse,NeverCompare:Ose,NeverDepth:YP,NeverStencilFunc:vSe,NoBlending:Yf,NoColorSpace:$p,NoToneMapping:Kp,NormalAnimationBlendMode:QU,NormalBlending:US,NotEqualCompare:Dse,NotEqualDepth:eL,NotEqualStencilFunc:SSe,NumberKeyframeTrack:AM,Object3D:Gr,ObjectLoader:Pxe,ObjectSpaceNormalMap:Mse,OctahedronGeometry:tN,OneFactor:rse,OneMinusConstantAlphaFactor:mse,OneMinusConstantColorFactor:fse,OneMinusDstAlphaFactor:cse,OneMinusDstColorFactor:use,OneMinusSrcAlphaFactor:WP,OneMinusSrcColorFactor:ase,OrthographicCamera:sN,PCFShadowMap:$U,PCFSoftShadowMap:CA,PMREMGenerator:zj,Path:NL,PerspectiveCamera:Ic,Plane:Rf,PlaneGeometry:LC,PlaneHelper:T1e,PointLight:Mae,PointLightHelper:p1e,Points:Qse,PointsMaterial:xq,PolarGridHelper:y1e,PolyhedronGeometry:zb,PositionalAudio:Vxe,PropertyBinding:Yr,PropertyMixer:Fae,QuadraticBezierCurve:Aq,QuadraticBezierCurve3:Mq,Quaternion:jh,QuaternionKeyframeTrack:rN,QuaternionLinearInterpolant:wae,RED_GREEN_RGTC2_Format:wL,RED_RGTC1_Format:gq,REVISION:$O,RGBADepthPacking:Ase,RGBAFormat:ru,RGBAIntegerFormat:XO,RGBA_ASTC_10x10_Format:_L,RGBA_ASTC_10x5_Format:gL,RGBA_ASTC_10x6_Format:vL,RGBA_ASTC_10x8_Format:yL,RGBA_ASTC_12x10_Format:bL,RGBA_ASTC_12x12_Format:EL,RGBA_ASTC_4x4_Format:cL,RGBA_ASTC_5x4_Format:lL,RGBA_ASTC_5x5_Format:uL,RGBA_ASTC_6x5_Format:hL,RGBA_ASTC_6x6_Format:dL,RGBA_ASTC_8x5_Format:fL,RGBA_ASTC_8x6_Format:pL,RGBA_ASTC_8x8_Format:mL,RGBA_BPTC_Format:IA,RGBA_ETC2_EAC_Format:oL,RGBA_PVRTC_2BPPV1_Format:rL,RGBA_PVRTC_4BPPV1_Format:iL,RGBA_S3TC_DXT1_Format:MA,RGBA_S3TC_DXT3_Format:OA,RGBA_S3TC_DXT5_Format:NA,RGBDepthPacking:cSe,RGBFormat:pq,RGBIntegerFormat:rSe,RGB_BPTC_SIGNED_Format:SL,RGB_BPTC_UNSIGNED_Format:TL,RGB_ETC1_Format:sL,RGB_ETC2_Format:aL,RGB_PVRTC_2BPPV1_Format:nL,RGB_PVRTC_4BPPV1_Format:tL,RGB_S3TC_DXT1_Format:AA,RGDepthPacking:lSe,RGFormat:mq,RGIntegerFormat:ZU,RawShaderMaterial:pae,Ray:kC,Raycaster:Gq,RectAreaLight:Iae,RedFormat:JU,RedIntegerFormat:YO,ReinhardToneMapping:_se,RenderTarget:e3,RenderTarget3D:i1e,RenderTargetArray:r1e,RepeatWrapping:vM,ReplaceStencilOp:hSe,ReverseSubtractEquation:ese,RingGeometry:m3,SIGNED_RED_GREEN_RGTC2_Format:CL,SIGNED_RED_RGTC1_Format:xL,SRGBColorSpace:ya,SRGBTransfer:ws,Scene:Bw,ShaderChunk:ir,ShaderLib:Hp,ShaderMaterial:Bc,ShadowMaterial:fae,Shape:FS,ShapeGeometry:g3,ShapePath:C1e,ShapeUtils:Yp,ShortType:hq,Skeleton:s3,SkeletonHelper:f1e,SkinnedMesh:Xse,Source:V_,Sphere:Dl,SphereGeometry:nN,Spherical:l1e,SphericalHarmonics3:kae,SplineCurve:Oq,SpotLight:Aae,SpotLightHelper:d1e,Sprite:Wse,SpriteMaterial:Sq,SrcAlphaFactor:$P,SrcAlphaSaturateFactor:hse,SrcColorFactor:sse,StaticCopyUsage:MSe,StaticDrawUsage:SM,StaticReadUsage:CSe,StereoCamera:Fxe,StreamCopyUsage:NSe,StreamDrawUsage:wSe,StreamReadUsage:ASe,StringKeyframeTrack:UT,SubtractEquation:Qre,SubtractiveBlending:Aj,TOUCH:ZEe,TangentSpaceNormalMap:Bb,TetrahedronGeometry:v3,Texture:Pa,TextureLoader:Nxe,TextureUtils:I1e,TimestampQuery:kSe,TorusGeometry:y3,TorusKnotGeometry:_3,Triangle:Dh,TriangleFanDrawMode:oSe,TriangleStripDrawMode:aSe,TrianglesDrawMode:sSe,TubeGeometry:b3,UVMapping:WU,Uint16BufferAttribute:bq,Uint32BufferAttribute:Eq,Uint8BufferAttribute:_Te,Uint8ClampedBufferAttribute:bTe,Uniform:Yi,UniformsGroup:a1e,UniformsLib:vn,UniformsUtils:Vse,UnsignedByteType:ml,UnsignedInt248Type:tT,UnsignedInt5999Type:dq,UnsignedIntType:Pg,UnsignedShort4444Type:XU,UnsignedShort5551Type:KU,UnsignedShortType:kw,VSMShadowMap:Bp,Vector2:Rt,Vector3:Re,Vector4:Kr,VectorKeyframeTrack:MM,VideoFrameTexture:jTe,VideoTexture:eae,WebGL3DRenderTarget:aTe,WebGLArrayRenderTarget:sTe,WebGLCoordinateSystem:jf,WebGLCubeRenderTarget:qse,WebGLRenderTarget:Ul,WebGLRenderer:Xae,WebGLUtils:Yae,WebGPUCoordinateSystem:TM,WebXRController:LD,WireframeGeometry:dae,WrapAroundEnding:bM,ZeroCurvatureEnding:OS,ZeroFactor:ise,ZeroSlopeEnding:NS,ZeroStencilOp:uSe,createCanvasElement:Fse},Symbol.toStringTag,{value:"Module"}));var Kae={exports:{}},lr={},Wq=Symbol.for("react.transitional.element"),pMe=Symbol.for("react.portal"),mMe=Symbol.for("react.fragment"),gMe=Symbol.for("react.strict_mode"),vMe=Symbol.for("react.profiler"),yMe=Symbol.for("react.consumer"),_Me=Symbol.for("react.context"),bMe=Symbol.for("react.forward_ref"),EMe=Symbol.for("react.suspense"),SMe=Symbol.for("react.memo"),Jae=Symbol.for("react.lazy"),HK=Symbol.iterator;function TMe(t){return t===null||typeof t!="object"?null:(t=HK&&t[HK]||t["@@iterator"],typeof t=="function"?t:null)}var Zae={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Qae=Object.assign,eoe={};function BC(t,e,n){this.props=t,this.context=e,this.refs=eoe,this.updater=n||Zae}BC.prototype.isReactComponent={};BC.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};BC.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function toe(){}toe.prototype=BC.prototype;function Yq(t,e,n){this.props=t,this.context=e,this.refs=eoe,this.updater=n||Zae}var Xq=Yq.prototype=new toe;Xq.constructor=Yq;Qae(Xq,BC.prototype);Xq.isPureReactComponent=!0;var jK=Array.isArray,ka={H:null,A:null,T:null,S:null,V:null},noe=Object.prototype.hasOwnProperty;function Kq(t,e,n,i,r,s){return n=s.ref,{$$typeof:Wq,type:t,key:e,ref:n!==void 0?n:null,props:s}}function xMe(t,e){return Kq(t.type,e,void 0,void 0,void 0,t.props)}function Jq(t){return typeof t=="object"&&t!==null&&t.$$typeof===Wq}function wMe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var VK=/\/+/g;function Xz(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wMe(""+t.key):e.toString(36)}function GK(){}function CMe(t){switch(t.status){case"fulfilled":return t.value;case"rejected":throw t.reason;default:switch(typeof t.status=="string"?t.then(GK,GK):(t.status="pending",t.then(function(e){t.status==="pending"&&(t.status="fulfilled",t.value=e)},function(e){t.status==="pending"&&(t.status="rejected",t.reason=e)})),t.status){case"fulfilled":return t.value;case"rejected":throw t.reason}}throw t}function y1(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"bigint":case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Wq:case pMe:a=!0;break;case Jae:return a=t._init,y1(a(t._payload),e,n,i,r)}}if(a)return r=r(t),a=i===""?"."+Xz(t,0):i,jK(r)?(n="",a!=null&&(n=a.replace(VK,"$&/")+"/"),y1(r,e,n,"",function(l){return l})):r!=null&&(Jq(r)&&(r=xMe(r,n+(r.key==null||t&&t.key===r.key?"":(""+r.key).replace(VK,"$&/")+"/")+a)),e.push(r)),1;a=0;var o=i===""?".":i+":";if(jK(t))for(var c=0;c<t.length;c++)i=t[c],s=o+Xz(i,c),a+=y1(i,e,n,s,r);else if(c=TMe(t),typeof c=="function")for(t=c.call(t),c=0;!(i=t.next()).done;)i=i.value,s=o+Xz(i,c++),a+=y1(i,e,n,s,r);else if(s==="object"){if(typeof t.then=="function")return y1(CMe(t),e,n,i,r);throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.")}return a}function Rk(t,e,n){if(t==null)return t;var i=[],r=0;return y1(t,i,"","",function(s){return e.call(n,s,r++)}),i}function RMe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var qK=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",t);return}console.error(t)};function AMe(){}lr.Children={map:Rk,forEach:function(t,e,n){Rk(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rk(t,function(){e++}),e},toArray:function(t){return Rk(t,function(e){return e})||[]},only:function(t){if(!Jq(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};lr.Component=BC;lr.Fragment=mMe;lr.Profiler=vMe;lr.PureComponent=Yq;lr.StrictMode=gMe;lr.Suspense=EMe;lr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ka;lr.__COMPILER_RUNTIME={__proto__:null,c:function(t){return ka.H.useMemoCache(t)}};lr.cache=function(t){return function(){return t.apply(null,arguments)}};lr.cloneElement=function(t,e,n){if(t==null)throw Error("The argument must be a React element, but you passed "+t+".");var i=Qae({},t.props),r=t.key,s=void 0;if(e!=null)for(a in e.ref!==void 0&&(s=void 0),e.key!==void 0&&(r=""+e.key),e)!noe.call(e,a)||a==="key"||a==="__self"||a==="__source"||a==="ref"&&e.ref===void 0||(i[a]=e[a]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];i.children=o}return Kq(t.type,r,void 0,void 0,s,i)};lr.createContext=function(t){return t={$$typeof:_Me,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null},t.Provider=t,t.Consumer={$$typeof:yMe,_context:t},t};lr.createElement=function(t,e,n){var i,r={},s=null;if(e!=null)for(i in e.key!==void 0&&(s=""+e.key),e)noe.call(e,i)&&i!=="key"&&i!=="__self"&&i!=="__source"&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),c=0;c<a;c++)o[c]=arguments[c+2];r.children=o}if(t&&t.defaultProps)for(i in a=t.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return Kq(t,s,void 0,void 0,null,r)};lr.createRef=function(){return{current:null}};lr.forwardRef=function(t){return{$$typeof:bMe,render:t}};lr.isValidElement=Jq;lr.lazy=function(t){return{$$typeof:Jae,_payload:{_status:-1,_result:t},_init:RMe}};lr.memo=function(t,e){return{$$typeof:SMe,type:t,compare:e===void 0?null:e}};lr.startTransition=function(t){var e=ka.T,n={};ka.T=n;try{var i=t(),r=ka.S;r!==null&&r(n,i),typeof i=="object"&&i!==null&&typeof i.then=="function"&&i.then(AMe,qK)}catch(s){qK(s)}finally{ka.T=e}};lr.unstable_useCacheRefresh=function(){return ka.H.useCacheRefresh()};lr.use=function(t){return ka.H.use(t)};lr.useActionState=function(t,e,n){return ka.H.useActionState(t,e,n)};lr.useCallback=function(t,e){return ka.H.useCallback(t,e)};lr.useContext=function(t){return ka.H.useContext(t)};lr.useDebugValue=function(){};lr.useDeferredValue=function(t,e){return ka.H.useDeferredValue(t,e)};lr.useEffect=function(t,e,n){var i=ka.H;if(typeof n=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return i.useEffect(t,e)};lr.useId=function(){return ka.H.useId()};lr.useImperativeHandle=function(t,e,n){return ka.H.useImperativeHandle(t,e,n)};lr.useInsertionEffect=function(t,e){return ka.H.useInsertionEffect(t,e)};lr.useLayoutEffect=function(t,e){return ka.H.useLayoutEffect(t,e)};lr.useMemo=function(t,e){return ka.H.useMemo(t,e)};lr.useOptimistic=function(t,e){return ka.H.useOptimistic(t,e)};lr.useReducer=function(t,e,n){return ka.H.useReducer(t,e,n)};lr.useRef=function(t){return ka.H.useRef(t)};lr.useState=function(t){return ka.H.useState(t)};lr.useSyncExternalStore=function(t,e,n){return ka.H.useSyncExternalStore(t,e,n)};lr.useTransition=function(){return ka.H.useTransition()};lr.version="19.1.0";Kae.exports=lr;var Be=Kae.exports;const Eg=Gc(Be);var ioe={exports:{}},jb={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */jb.ConcurrentRoot=1;jb.ContinuousEventPriority=8;jb.DefaultEventPriority=32;jb.DiscreteEventPriority=2;jb.IdleEventPriority=268435456;jb.LegacyRoot=0;jb.NoEventPriority=0;ioe.exports=jb;var BD=ioe.exports,roe={exports:{}},soe={},aoe={exports:{}},ooe={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw=Be;function MMe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var OMe=typeof Object.is=="function"?Object.is:MMe,NMe=Hw.useState,IMe=Hw.useEffect,kMe=Hw.useLayoutEffect,DMe=Hw.useDebugValue;function PMe(t,e){var n=e(),i=NMe({inst:{value:n,getSnapshot:e}}),r=i[0].inst,s=i[1];return kMe(function(){r.value=n,r.getSnapshot=e,Kz(r)&&s({inst:r})},[t,n,e]),IMe(function(){return Kz(r)&&s({inst:r}),t(function(){Kz(r)&&s({inst:r})})},[t]),DMe(n),n}function Kz(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!OMe(t,n)}catch{return!0}}function LMe(t,e){return e()}var UMe=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?LMe:PMe;ooe.useSyncExternalStore=Hw.useSyncExternalStore!==void 0?Hw.useSyncExternalStore:UMe;aoe.exports=ooe;var BMe=aoe.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T3=Be,FMe=BMe;function zMe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var HMe=typeof Object.is=="function"?Object.is:zMe,jMe=FMe.useSyncExternalStore,VMe=T3.useRef,GMe=T3.useEffect,qMe=T3.useMemo,$Me=T3.useDebugValue;soe.useSyncExternalStoreWithSelector=function(t,e,n,i,r){var s=VMe(null);if(s.current===null){var a={hasValue:!1,value:null};s.current=a}else a=s.current;s=qMe(function(){function c(f){if(!l){if(l=!0,u=f,f=i(f),r!==void 0&&a.hasValue){var p=a.value;if(r(p,f))return h=p}return h=f}if(p=h,HMe(u,f))return p;var g=i(f);return r!==void 0&&r(p,g)?(u=f,p):(u=f,h=g)}var l=!1,u,h,d=n===void 0?null:n;return[function(){return c(e())},d===null?void 0:function(){return c(d())}]},[e,n,i,r]);var o=jMe(t,s[0],s[1]);return GMe(function(){a.hasValue=!0,a.value=o},[o]),$Me(o),o};roe.exports=soe;var WMe=roe.exports;const YMe=Gc(WMe),$K=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const d=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(f=>f(e,d))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},XMe=t=>t?$K(t):$K,{useSyncExternalStoreWithSelector:KMe}=YMe,JMe=t=>t;function ZMe(t,e=JMe,n){const i=KMe(t.subscribe,t.getState,t.getInitialState,e,n);return Eg.useDebugValue(i),i}const WK=(t,e)=>{const n=XMe(t),i=(r,s=e)=>ZMe(n,r,s);return Object.assign(i,n),i},coe=(t,e)=>t?WK(t,e):WK;var loe={exports:{}},uoe={exports:{}},hoe={exports:{}},doe={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,Z){var Y=V.length;V.push(Z);e:for(;0<Y;){var ee=Y-1>>>1,oe=V[ee];if(0<r(oe,Z))V[ee]=Z,V[Y]=oe,Y=ee;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var Z=V[0],Y=V.pop();if(Y!==Z){V[0]=Y;e:for(var ee=0,oe=V.length,de=oe>>>1;ee<de;){var Me=2*(ee+1)-1,He=V[Me],Te=Me+1,Le=V[Te];if(0>r(He,Y))Te<oe&&0>r(Le,He)?(V[ee]=Le,V[Te]=Y,ee=Te):(V[ee]=He,V[Me]=Y,ee=Me);else if(Te<oe&&0>r(Le,Y))V[ee]=Le,V[Te]=Y,ee=Te;else break e}}return Z}function r(V,Z){var Y=V.sortIndex-Z.sortIndex;return Y!==0?Y:V.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,_=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function T(V){for(var Z=n(l);Z!==null;){if(Z.callback===null)i(l);else if(Z.startTime<=V)i(l),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=n(l)}}function x(V){if(g=!1,T(V),!p)if(n(c)!==null)p=!0,X();else{var Z=n(l);Z!==null&&ie(x,Z.startTime-V)}}var N=!1,A=-1,I=5,k=-1;function L(){return!(t.unstable_now()-k<I)}function U(){if(N){var V=t.unstable_now();k=V;var Z=!0;try{e:{p=!1,g&&(g=!1,v(A),A=-1),f=!0;var Y=d;try{t:{for(T(V),h=n(c);h!==null&&!(h.expirationTime>V&&L());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,d=h.priorityLevel;var oe=ee(h.expirationTime<=V);if(V=t.unstable_now(),typeof oe=="function"){h.callback=oe,T(V),Z=!0;break t}h===n(c)&&i(c),T(V)}else i(c);h=n(c)}if(h!==null)Z=!0;else{var de=n(l);de!==null&&ie(x,de.startTime-V),Z=!1}}break e}finally{h=null,d=Y,f=!1}Z=void 0}}finally{Z?$():N=!1}}}var $;if(typeof E=="function")$=function(){E(U)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,G=q.port2;q.port1.onmessage=U,$=function(){G.postMessage(null)}}else $=function(){_(U,0)};function X(){N||(N=!0,$())}function ie(V,Z){A=_(function(){V(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,X())},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(d){case 1:case 2:case 3:var Z=3;break;default:Z=d}var Y=d;d=Z;try{return V()}finally{d=Y}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,Z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Y=d;d=V;try{return Z()}finally{d=Y}},t.unstable_scheduleCallback=function(V,Z,Y){var ee=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ee+Y:ee):Y=ee,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Y+oe,V={id:u++,callback:Z,priorityLevel:V,startTime:Y,expirationTime:oe,sortIndex:-1},Y>ee?(V.sortIndex=Y,e(l,V),n(c)===null&&V===n(l)&&(g?(v(A),A=-1):g=!0,ie(x,Y-ee))):(V.sortIndex=oe,e(c,V),p||f||(p=!0,X())),V},t.unstable_shouldYield=L,t.unstable_wrapCallback=function(V){var Z=d;return function(){var Y=d;d=Z;try{return V.apply(this,arguments)}finally{d=Y}}}})(doe);hoe.exports=doe;var jj=hoe.exports;(function(t){t.exports=function(e){function n(m,y,C,D){return new Ru(m,y,C,D)}function i(){}function r(m){var y="https://react.dev/errors/"+m;if(1<arguments.length){y+="?args[]="+encodeURIComponent(arguments[1]);for(var C=2;C<arguments.length;C++)y+="&args[]="+encodeURIComponent(arguments[C])}return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(m){return m===null||typeof m!="object"?null:(m=ro&&m[ro]||m["@@iterator"],typeof m=="function"?m:null)}function a(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===TE?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case mh:return"Fragment";case Tp:return"Portal";case gh:return"Profiler";case Kc:return"StrictMode";case B0:return"Suspense";case wp:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case Au:return(m.displayName||"Context")+".Provider";case SE:return(m._context.displayName||"Context")+".Consumer";case Im:var y=m.render;return m=m.displayName,m||(m=y.displayName||y.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case F0:return y=m.displayName||null,y!==null?y:a(m.type)||"Memo";case Mu:y=m._payload,m=m._init;try{return a(m(y))}catch{}}return null}function o(m){if(km===void 0)try{throw Error()}catch(C){var y=C.stack.trim().match(/\n( *(at )?)/);km=y&&y[1]||"",Fy=-1<C.stack.indexOf(`
    at`)?" (<anonymous>)":-1<C.stack.indexOf("@")?"@unknown:0:0":""}return`
`+km+m+Fy}function c(m,y){if(!m||Cp)return"";Cp=!0;var C=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var D={DetermineComponentFrameRoot:function(){try{if(y){var xn=function(){throw Error()};if(Object.defineProperty(xn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xn,[])}catch(er){var Rn=er}Reflect.construct(m,[],xn)}else{try{xn.call()}catch(er){Rn=er}m.call(xn.prototype)}}else{try{throw Error()}catch(er){Rn=er}(xn=m())&&typeof xn.catch=="function"&&xn.catch(function(){})}}catch(er){if(er&&Rn&&typeof er.stack=="string")return[er.stack,Rn.stack]}return[null,null]}};D.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var z=Object.getOwnPropertyDescriptor(D.DetermineComponentFrameRoot,"name");z&&z.configurable&&Object.defineProperty(D.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var J=D.DetermineComponentFrameRoot(),Se=J[0],ze=J[1];if(Se&&ze){var ut=Se.split(`
`),Dt=ze.split(`
`);for(z=D=0;D<ut.length&&!ut[D].includes("DetermineComponentFrameRoot");)D++;for(;z<Dt.length&&!Dt[z].includes("DetermineComponentFrameRoot");)z++;if(D===ut.length||z===Dt.length)for(D=ut.length-1,z=Dt.length-1;1<=D&&0<=z&&ut[D]!==Dt[z];)z--;for(;1<=D&&0<=z;D--,z--)if(ut[D]!==Dt[z]){if(D!==1||z!==1)do if(D--,z--,0>z||ut[D]!==Dt[z]){var en=`
`+ut[D].replace(" at new "," at ");return m.displayName&&en.includes("<anonymous>")&&(en=en.replace("<anonymous>",m.displayName)),en}while(1<=D&&0<=z);break}}}finally{Cp=!1,Error.prepareStackTrace=C}return(C=m?m.displayName||m.name:"")?o(C):""}function l(m){switch(m.tag){case 26:case 27:case 5:return o(m.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return m=c(m.type,!1),m;case 11:return m=c(m.type.render,!1),m;case 1:return m=c(m.type,!0),m;default:return""}}function u(m){try{var y="";do y+=l(m),m=m.return;while(m);return y}catch(C){return`
Error generating stack: `+C.message+`
`+C.stack}}function h(m){var y=m,C=m;if(m.alternate)for(;y.return;)y=y.return;else{m=y;do y=m,y.flags&4098&&(C=y.return),m=y.return;while(m)}return y.tag===3?C:null}function d(m){if(h(m)!==m)throw Error(r(188))}function f(m){var y=m.alternate;if(!y){if(y=h(m),y===null)throw Error(r(188));return y!==m?null:m}for(var C=m,D=y;;){var z=C.return;if(z===null)break;var J=z.alternate;if(J===null){if(D=z.return,D!==null){C=D;continue}break}if(z.child===J.child){for(J=z.child;J;){if(J===C)return d(z),m;if(J===D)return d(z),y;J=J.sibling}throw Error(r(188))}if(C.return!==D.return)C=z,D=J;else{for(var Se=!1,ze=z.child;ze;){if(ze===C){Se=!0,C=z,D=J;break}if(ze===D){Se=!0,D=z,C=J;break}ze=ze.sibling}if(!Se){for(ze=J.child;ze;){if(ze===C){Se=!0,C=J,D=z;break}if(ze===D){Se=!0,D=J,C=z;break}ze=ze.sibling}if(!Se)throw Error(r(189))}}if(C.alternate!==D)throw Error(r(190))}if(C.tag!==3)throw Error(r(188));return C.stateNode.current===C?m:y}function p(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(y=p(m),y!==null)return y;m=m.sibling}return null}function g(m){var y=m.tag;if(y===5||y===26||y===27||y===6)return m;for(m=m.child;m!==null;){if(m.tag!==4&&(y=g(m),y!==null))return y;m=m.sibling}return null}function _(m){return{current:m}}function v(m){0>pf||(m.current=oo[pf],oo[pf]=null,pf--)}function E(m,y){pf++,oo[pf]=m.current,m.current=y}function T(m){return m>>>=0,m===0?32:31-(ER(m)/Xy|0)|0}function x(m){var y=m&42;if(y!==0)return y;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function N(m,y){var C=m.pendingLanes;if(C===0)return 0;var D=0,z=m.suspendedLanes,J=m.pingedLanes,Se=m.warmLanes;m=m.finishedLanes!==0;var ze=C&134217727;return ze!==0?(C=ze&~z,C!==0?D=x(C):(J&=ze,J!==0?D=x(J):m||(Se=ze&~Se,Se!==0&&(D=x(Se))))):(ze=C&~z,ze!==0?D=x(ze):J!==0?D=x(J):m||(Se=C&~Se,Se!==0&&(D=x(Se)))),D===0?0:y!==0&&y!==D&&!(y&z)&&(z=D&-D,Se=y&-y,z>=Se||z===32&&(Se&4194176)!==0)?y:D}function A(m,y){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&y)===0}function I(m,y){switch(m){case 1:case 2:case 4:case 8:return y+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function k(){var m=K0;return K0<<=1,!(K0&4194176)&&(K0=128),m}function L(){var m=ja;return ja<<=1,!(ja&62914560)&&(ja=4194304),m}function U(m){for(var y=[],C=0;31>C;C++)y.push(m);return y}function $(m,y){m.pendingLanes|=y,y!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function q(m,y,C,D,z,J){var Se=m.pendingLanes;m.pendingLanes=C,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=C,m.entangledLanes&=C,m.errorRecoveryDisabledLanes&=C,m.shellSuspendCounter=0;var ze=m.entanglements,ut=m.expirationTimes,Dt=m.hiddenUpdates;for(C=Se&~C;0<C;){var en=31-Jo(C),xn=1<<en;ze[en]=0,ut[en]=-1;var Rn=Dt[en];if(Rn!==null)for(Dt[en]=null,en=0;en<Rn.length;en++){var er=Rn[en];er!==null&&(er.lane&=-536870913)}C&=~xn}D!==0&&G(m,D,0),J!==0&&z===0&&m.tag!==0&&(m.suspendedLanes|=J&~(Se&~y))}function G(m,y,C){m.pendingLanes|=y,m.suspendedLanes&=~y;var D=31-Jo(y);m.entangledLanes|=y,m.entanglements[D]=m.entanglements[D]|1073741824|C&4194218}function X(m,y){var C=m.entangledLanes|=y;for(m=m.entanglements;C;){var D=31-Jo(C),z=1<<D;z&y|m[D]&y&&(m[D]|=y),C&=~z}}function ie(m){return m&=-m,2<m?8<m?m&134217727?32:268435456:8:2}function V(m){if(S&&typeof S.onCommitFiberRoot=="function")try{S.onCommitFiberRoot(O,m,void 0,(m.current.flags&128)===128)}catch{}}function Z(m){if(typeof qm=="function"&&zE(m),S&&typeof S.setStrictMode=="function")try{S.setStrictMode(O,m)}catch{}}function Y(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}function ee(m,y){if(typeof m=="object"&&m!==null){var C=M.get(m);return C!==void 0?C:(y={value:m,source:y,stack:u(y)},M.set(m,y),y)}return{value:m,source:y,stack:u(y)}}function oe(m,y){P[B++]=te,P[B++]=H,H=m,te=y}function de(m,y,C){re[K++]=he,re[K++]=pe,re[K++]=se,se=m;var D=he;m=pe;var z=32-Jo(D)-1;D&=~(1<<z),C+=1;var J=32-Jo(y)+z;if(30<J){var Se=z-z%5;J=(D&(1<<Se)-1).toString(32),D>>=Se,z-=Se,he=1<<32-Jo(y)+z|C<<z|D,pe=J+m}else he=1<<J|C<<z|D,pe=m}function Me(m){m.return!==null&&(oe(m,1),de(m,1,0))}function He(m){for(;m===H;)H=P[--B],P[B]=null,te=P[--B],P[B]=null;for(;m===se;)se=re[--K],re[K]=null,pe=re[--K],re[K]=null,he=re[--K],re[K]=null}function Te(m,y){E(Ye,y),E(Je,m),E(Ne,null),m=Dm(y),v(Ne),E(Ne,m)}function Le(){v(Ne),v(Je),v(Ye)}function we(m){m.memoizedState!==null&&E(Oe,m);var y=Ne.current,C=bx(y,m.type);y!==C&&(E(Je,m),E(Ne,C))}function Ce(m){Je.current===m&&(v(Ne),v(Je)),Oe.current===m&&(v(Oe),ql?xl._currentValue=md:xl._currentValue2=md)}function ke(m){var y=Error(r(418,""));throw et(ee(y,m)),Xn}function St(m,y){if(!Sl)throw Error(r(175));pR(m.stateNode,m.type,m.memoizedProps,y,m)||ke(m)}function At(m){for(_e=m.return;_e;)switch(_e.tag){case 3:case 27:It=!0;return;case 5:case 13:It=!1;return;default:_e=_e.return}}function Ee(m){if(!Sl||m!==_e)return!1;if(!wt)return At(m),wt=!0,!1;var y=!1;if(Ca?m.tag!==3&&m.tag!==27&&(m.tag!==5||Mx(m.type)&&!Pm(m.type,m.memoizedProps))&&(y=!0):m.tag!==3&&(m.tag!==5||Mx(m.type)&&!Pm(m.type,m.memoizedProps))&&(y=!0),y&&lt&&ke(m),At(m),m.tag===13){if(!Sl)throw Error(r(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));lt=jm(m)}else lt=_e?Yo(m.stateNode):null;return!0}function ye(){Sl&&(lt=_e=null,wt=!1)}function et(m){Kt===null?Kt=[m]:Kt.push(m)}function fe(){for(var m=yi,y=Fi=yi=0;y<m;){var C=wn[y];wn[y++]=null;var D=wn[y];wn[y++]=null;var z=wn[y];wn[y++]=null;var J=wn[y];if(wn[y++]=null,D!==null&&z!==null){var Se=D.pending;Se===null?z.next=z:(z.next=Se.next,Se.next=z),D.pending=z}J!==0&&dt(C,z,J)}}function Fe(m,y,C,D){wn[yi++]=m,wn[yi++]=y,wn[yi++]=C,wn[yi++]=D,Fi|=D,m.lanes|=D,m=m.alternate,m!==null&&(m.lanes|=D)}function Ie(m,y,C,D){return Fe(m,y,C,D),gt(m)}function it(m,y){return Fe(m,null,null,y),gt(m)}function dt(m,y,C){m.lanes|=C;var D=m.alternate;D!==null&&(D.lanes|=C);for(var z=!1,J=m.return;J!==null;)J.childLanes|=C,D=J.alternate,D!==null&&(D.childLanes|=C),J.tag===22&&(m=J.stateNode,m===null||m._visibility&1||(z=!0)),m=J,J=J.return;z&&y!==null&&m.tag===3&&(J=m.stateNode,z=31-Jo(C),J=J.hiddenUpdates,m=J[z],m===null?J[z]=[y]:m.push(y),y.lane=C|536870912)}function gt(m){if(50<TR)throw TR=0,cz=null,Error(r(185));for(var y=m.return;y!==null;)m=y,y=m.return;return m.tag===3?m.stateNode:null}function bt(m){m!==xi&&m.next===null&&(xi===null?ki=xi=m:xi=xi.next=m),Ri=!0,_i||(_i=!0,Ue(ue))}function be(m,y){if(!Di&&Ri){Di=!0;do for(var C=!1,D=ki;D!==null;){if(m!==0){var z=D.pendingLanes;if(z===0)var J=0;else{var Se=D.suspendedLanes,ze=D.pingedLanes;J=(1<<31-Jo(42|m)+1)-1,J&=z&~(Se&~ze),J=J&201326677?J&201326677|1:J?J|2:0}J!==0&&(C=!0,$e(D,J))}else J=In,J=N(D,D===Mn?J:0),!(J&3)||A(D,J)||(C=!0,$e(D,J));D=D.next}while(C);Di=!1}}function ue(){Ri=_i=!1;var m=0;bi!==0&&(Tl()&&(m=bi),bi=0);for(var y=Jn(),C=null,D=ki;D!==null;){var z=D.next,J=Xe(D,y);J===0?(D.next=null,C===null?ki=z:C.next=z,z===null&&(xi=C)):(C=D,(m!==0||J&3)&&(Ri=!0)),D=z}be(m)}function Xe(m,y){for(var C=m.suspendedLanes,D=m.pingedLanes,z=m.expirationTimes,J=m.pendingLanes&-62914561;0<J;){var Se=31-Jo(J),ze=1<<Se,ut=z[Se];ut===-1?(!(ze&C)||ze&D)&&(z[Se]=I(ze,y)):ut<=y&&(m.expiredLanes|=ze),J&=~ze}if(y=Mn,C=In,C=N(m,m===y?C:0),D=m.callbackNode,C===0||m===y&&ln===2||m.cancelPendingCommit!==null)return D!==null&&D!==null&&Eh(D),m.callbackNode=null,m.callbackPriority=0;if(!(C&3)||A(m,C)){if(y=C&-C,y===m.callbackPriority)return y;switch(D!==null&&Eh(D),ie(C)){case 2:case 8:C=co;break;case 32:C=Is;break;case 268435456:C=mf;break;default:C=Is}return D=nt.bind(null,m),C=Ns(C,D),m.callbackPriority=y,m.callbackNode=C,y}return D!==null&&D!==null&&Eh(D),m.callbackPriority=2,m.callbackNode=null,2}function nt(m,y){var C=m.callbackNode;if(yc()&&m.callbackNode!==C)return null;var D=In;return D=N(m,m===Mn?D:0),D===0?null:(xu(m,D,y),Xe(m,Jn()),m.callbackNode!=null&&m.callbackNode===C?nt.bind(null,m):null)}function $e(m,y){if(yc())return null;xu(m,y,!0)}function Ue(m){jy?ti(function(){Gt&6?Ns(Nx,m):m()}):Ns(Nx,m)}function qt(){return bi===0&&(bi=k()),bi}function Mt(m,y){if(Ai===null){var C=Ai=[];ui=0,Tn=qt(),$n={status:"pending",value:void 0,then:function(D){C.push(D)}}}return ui++,y.then(Yt,Yt),y}function Yt(){if(--ui===0&&Ai!==null){$n!==null&&($n.status="fulfilled");var m=Ai;Ai=null,Tn=0,$n=null;for(var y=0;y<m.length;y++)(0,m[y])()}}function ce(m,y){var C=[],D={status:"pending",value:null,reason:null,then:function(z){C.push(z)}};return m.then(function(){D.status="fulfilled",D.value=y;for(var z=0;z<C.length;z++)(0,C[z])(y)},function(z){for(D.status="rejected",D.reason=z,z=0;z<C.length;z++)(0,C[z])(void 0)}),D}function j(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function W(m,y){m=m.updateQueue,y.updateQueue===m&&(y.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function me(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function De(m,y,C){var D=m.updateQueue;if(D===null)return null;if(D=D.shared,Gt&2){var z=D.pending;return z===null?y.next=y:(y.next=z.next,z.next=y),D.pending=y,y=gt(m),dt(m,null,C),y}return Fe(m,D,y,C),gt(m)}function je(m,y,C){if(y=y.updateQueue,y!==null&&(y=y.shared,(C&4194176)!==0)){var D=y.lanes;D&=m.pendingLanes,C|=D,y.lanes=C,X(m,C)}}function mt(m,y){var C=m.updateQueue,D=m.alternate;if(D!==null&&(D=D.updateQueue,C===D)){var z=null,J=null;if(C=C.firstBaseUpdate,C!==null){do{var Se={lane:C.lane,tag:C.tag,payload:C.payload,callback:null,next:null};J===null?z=J=Se:J=J.next=Se,C=C.next}while(C!==null);J===null?z=J=y:J=J.next=y}else z=J=y;C={baseState:D.baseState,firstBaseUpdate:z,lastBaseUpdate:J,shared:D.shared,callbacks:D.callbacks},m.updateQueue=C;return}m=C.lastBaseUpdate,m===null?C.firstBaseUpdate=y:m.next=y,C.lastBaseUpdate=y}function xt(){if(Jr){var m=$n;if(m!==null)throw m}}function Vn(m,y,C,D){Jr=!1;var z=m.updateQueue;$i=!1;var J=z.firstBaseUpdate,Se=z.lastBaseUpdate,ze=z.shared.pending;if(ze!==null){z.shared.pending=null;var ut=ze,Dt=ut.next;ut.next=null,Se===null?J=Dt:Se.next=Dt,Se=ut;var en=m.alternate;en!==null&&(en=en.updateQueue,ze=en.lastBaseUpdate,ze!==Se&&(ze===null?en.firstBaseUpdate=Dt:ze.next=Dt,en.lastBaseUpdate=ut))}if(J!==null){var xn=z.baseState;Se=0,en=Dt=ut=null,ze=J;do{var Rn=ze.lane&-536870913,er=Rn!==ze.lane;if(er?(In&Rn)===Rn:(D&Rn)===Rn){Rn!==0&&Rn===Tn&&(Jr=!0),en!==null&&(en=en.next={lane:0,tag:ze.tag,payload:ze.payload,callback:null,next:null});e:{var _f=m,xR=ze;Rn=y;var jE=C;switch(xR.tag){case 1:if(_f=xR.payload,typeof _f=="function"){xn=_f.call(jE,xn,Rn);break e}xn=_f;break e;case 3:_f.flags=_f.flags&-65537|128;case 0:if(_f=xR.payload,Rn=typeof _f=="function"?_f.call(jE,xn,Rn):_f,Rn==null)break e;xn=ph({},xn,Rn);break e;case 2:$i=!0}}Rn=ze.callback,Rn!==null&&(m.flags|=64,er&&(m.flags|=8192),er=z.callbacks,er===null?z.callbacks=[Rn]:er.push(Rn))}else er={lane:Rn,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null},en===null?(Dt=en=er,ut=xn):en=en.next=er,Se|=Rn;if(ze=ze.next,ze===null){if(ze=z.shared.pending,ze===null)break;er=ze,ze=er.next,er.next=null,z.lastBaseUpdate=er,z.shared.pending=null}}while(!0);en===null&&(ut=xn),z.baseState=ut,z.firstBaseUpdate=Dt,z.lastBaseUpdate=en,J===null&&(z.shared.lanes=0),Sc|=Se,m.lanes=Se,m.memoizedState=xn}}function qe(m,y){if(typeof m!="function")throw Error(r(191,m));m.call(y)}function Vt(m,y){var C=m.callbacks;if(C!==null)for(m.callbacks=null,m=0;m<C.length;m++)qe(C[m],y)}function ht(m,y){if(R(m,y))return!0;if(typeof m!="object"||m===null||typeof y!="object"||y===null)return!1;var C=Object.keys(m),D=Object.keys(y);if(C.length!==D.length)return!1;for(D=0;D<C.length;D++){var z=C[D];if(!ys.call(y,z)||!R(m[z],y[z]))return!1}return!0}function Pt(m){return m=m.status,m==="fulfilled"||m==="rejected"}function hn(){}function an(m,y,C){switch(C=m[C],C===void 0?m.push(y):C!==y&&(y.then(hn,hn),y=C),y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===Zr?Error(r(483)):m;default:if(typeof y.status=="string")y.then(hn,hn);else{if(m=Mn,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=y,m.status="pending",m.then(function(D){if(y.status==="pending"){var z=y;z.status="fulfilled",z.value=D}},function(D){if(y.status==="pending"){var z=y;z.status="rejected",z.reason=D}})}switch(y.status){case"fulfilled":return y.value;case"rejected":throw m=y.reason,m===Zr?Error(r(483)):m}throw Ir=y,Zr}}function Ve(){if(Ir===null)throw Error(r(459));var m=Ir;return Ir=null,m}function ot(m){var y=$r;return $r+=1,hr===null&&(hr=[]),an(hr,m,y)}function Ct(m,y){y=y.props.ref,m.ref=y!==void 0?y:null}function Nt(m,y){throw y.$$typeof===Sp?Error(r(525)):(m=Object.prototype.toString.call(y),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":m)))}function Wn(m){var y=m._init;return y(m._payload)}function sr(m){function y(Et,rt){if(m){var Tt=Et.deletions;Tt===null?(Et.deletions=[rt],Et.flags|=16):Tt.push(rt)}}function C(Et,rt){if(!m)return null;for(;rt!==null;)y(Et,rt),rt=rt.sibling;return null}function D(Et){for(var rt=new Map;Et!==null;)Et.key!==null?rt.set(Et.key,Et):rt.set(Et.index,Et),Et=Et.sibling;return rt}function z(Et,rt){return Et=fh(Et,rt),Et.index=0,Et.sibling=null,Et}function J(Et,rt,Tt){return Et.index=Tt,m?(Tt=Et.alternate,Tt!==null?(Tt=Tt.index,Tt<rt?(Et.flags|=33554434,rt):Tt):(Et.flags|=33554434,rt)):(Et.flags|=1048576,rt)}function Se(Et){return m&&Et.alternate===null&&(Et.flags|=33554434),Et}function ze(Et,rt,Tt,Jt){return rt===null||rt.tag!==6?(rt=L0(Tt,Et.mode,Jt),rt.return=Et,rt):(rt=z(rt,Tt),rt.return=Et,rt)}function ut(Et,rt,Tt,Jt){var hi=Tt.type;return hi===mh?en(Et,rt,Tt.props.children,Jt,Tt.key):rt!==null&&(rt.elementType===hi||typeof hi=="object"&&hi!==null&&hi.$$typeof===Mu&&Wn(hi)===rt.type)?(rt=z(rt,Tt.props),Ct(rt,Tt),rt.return=Et,rt):(rt=P0(Tt.type,Tt.key,Tt.props,null,Et.mode,Jt),Ct(rt,Tt),rt.return=Et,rt)}function Dt(Et,rt,Tt,Jt){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==Tt.containerInfo||rt.stateNode.implementation!==Tt.implementation?(rt=Uy(Tt,Et.mode,Jt),rt.return=Et,rt):(rt=z(rt,Tt.children||[]),rt.return=Et,rt)}function en(Et,rt,Tt,Jt,hi){return rt===null||rt.tag!==7?(rt=df(Tt,Et.mode,Jt,hi),rt.return=Et,rt):(rt=z(rt,Tt),rt.return=Et,rt)}function xn(Et,rt,Tt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=L0(""+rt,Et.mode,Tt),rt.return=Et,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case Nm:return Tt=P0(rt.type,rt.key,rt.props,null,Et.mode,Tt),Ct(Tt,rt),Tt.return=Et,Tt;case Tp:return rt=Uy(rt,Et.mode,Tt),rt.return=Et,rt;case Mu:var Jt=rt._init;return rt=Jt(rt._payload),xn(Et,rt,Tt)}if(pd(rt)||s(rt))return rt=df(rt,Et.mode,Tt,null),rt.return=Et,rt;if(typeof rt.then=="function")return xn(Et,ot(rt),Tt);if(rt.$$typeof===Au)return xn(Et,Ar(Et,rt),Tt);Nt(Et,rt)}return null}function Rn(Et,rt,Tt,Jt){var hi=rt!==null?rt.key:null;if(typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint")return hi!==null?null:ze(Et,rt,""+Tt,Jt);if(typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case Nm:return Tt.key===hi?ut(Et,rt,Tt,Jt):null;case Tp:return Tt.key===hi?Dt(Et,rt,Tt,Jt):null;case Mu:return hi=Tt._init,Tt=hi(Tt._payload),Rn(Et,rt,Tt,Jt)}if(pd(Tt)||s(Tt))return hi!==null?null:en(Et,rt,Tt,Jt,null);if(typeof Tt.then=="function")return Rn(Et,rt,ot(Tt),Jt);if(Tt.$$typeof===Au)return Rn(Et,rt,Ar(Et,Tt),Jt);Nt(Et,Tt)}return null}function er(Et,rt,Tt,Jt,hi){if(typeof Jt=="string"&&Jt!==""||typeof Jt=="number"||typeof Jt=="bigint")return Et=Et.get(Tt)||null,ze(rt,Et,""+Jt,hi);if(typeof Jt=="object"&&Jt!==null){switch(Jt.$$typeof){case Nm:return Et=Et.get(Jt.key===null?Tt:Jt.key)||null,ut(rt,Et,Jt,hi);case Tp:return Et=Et.get(Jt.key===null?Tt:Jt.key)||null,Dt(rt,Et,Jt,hi);case Mu:var ma=Jt._init;return Jt=ma(Jt._payload),er(Et,rt,Tt,Jt,hi)}if(pd(Jt)||s(Jt))return Et=Et.get(Tt)||null,en(rt,Et,Jt,hi,null);if(typeof Jt.then=="function")return er(Et,rt,Tt,ot(Jt),hi);if(Jt.$$typeof===Au)return er(Et,rt,Tt,Ar(rt,Jt),hi);Nt(rt,Jt)}return null}function _f(Et,rt,Tt,Jt){for(var hi=null,ma=null,zi=rt,ts=rt=0,Qc=null;zi!==null&&ts<Tt.length;ts++){zi.index>ts?(Qc=zi,zi=null):Qc=zi.sibling;var ns=Rn(Et,zi,Tt[ts],Jt);if(ns===null){zi===null&&(zi=Qc);break}m&&zi&&ns.alternate===null&&y(Et,zi),rt=J(ns,rt,ts),ma===null?hi=ns:ma.sibling=ns,ma=ns,zi=Qc}if(ts===Tt.length)return C(Et,zi),wt&&oe(Et,ts),hi;if(zi===null){for(;ts<Tt.length;ts++)zi=xn(Et,Tt[ts],Jt),zi!==null&&(rt=J(zi,rt,ts),ma===null?hi=zi:ma.sibling=zi,ma=zi);return wt&&oe(Et,ts),hi}for(zi=D(zi);ts<Tt.length;ts++)Qc=er(zi,Et,ts,Tt[ts],Jt),Qc!==null&&(m&&Qc.alternate!==null&&zi.delete(Qc.key===null?ts:Qc.key),rt=J(Qc,rt,ts),ma===null?hi=Qc:ma.sibling=Qc,ma=Qc);return m&&zi.forEach(function(Qy){return y(Et,Qy)}),wt&&oe(Et,ts),hi}function xR(Et,rt,Tt,Jt){if(Tt==null)throw Error(r(151));for(var hi=null,ma=null,zi=rt,ts=rt=0,Qc=null,ns=Tt.next();zi!==null&&!ns.done;ts++,ns=Tt.next()){zi.index>ts?(Qc=zi,zi=null):Qc=zi.sibling;var Qy=Rn(Et,zi,ns.value,Jt);if(Qy===null){zi===null&&(zi=Qc);break}m&&zi&&Qy.alternate===null&&y(Et,zi),rt=J(Qy,rt,ts),ma===null?hi=Qy:ma.sibling=Qy,ma=Qy,zi=Qc}if(ns.done)return C(Et,zi),wt&&oe(Et,ts),hi;if(zi===null){for(;!ns.done;ts++,ns=Tt.next())ns=xn(Et,ns.value,Jt),ns!==null&&(rt=J(ns,rt,ts),ma===null?hi=ns:ma.sibling=ns,ma=ns);return wt&&oe(Et,ts),hi}for(zi=D(zi);!ns.done;ts++,ns=Tt.next())ns=er(zi,Et,ts,ns.value,Jt),ns!==null&&(m&&ns.alternate!==null&&zi.delete(ns.key===null?ts:ns.key),rt=J(ns,rt,ts),ma===null?hi=ns:ma.sibling=ns,ma=ns);return m&&zi.forEach(function(zEe){return y(Et,zEe)}),wt&&oe(Et,ts),hi}function jE(Et,rt,Tt,Jt){if(typeof Tt=="object"&&Tt!==null&&Tt.type===mh&&Tt.key===null&&(Tt=Tt.props.children),typeof Tt=="object"&&Tt!==null){switch(Tt.$$typeof){case Nm:e:{for(var hi=Tt.key;rt!==null;){if(rt.key===hi){if(hi=Tt.type,hi===mh){if(rt.tag===7){C(Et,rt.sibling),Jt=z(rt,Tt.props.children),Jt.return=Et,Et=Jt;break e}}else if(rt.elementType===hi||typeof hi=="object"&&hi!==null&&hi.$$typeof===Mu&&Wn(hi)===rt.type){C(Et,rt.sibling),Jt=z(rt,Tt.props),Ct(Jt,Tt),Jt.return=Et,Et=Jt;break e}C(Et,rt);break}else y(Et,rt);rt=rt.sibling}Tt.type===mh?(Jt=df(Tt.props.children,Et.mode,Jt,Tt.key),Jt.return=Et,Et=Jt):(Jt=P0(Tt.type,Tt.key,Tt.props,null,Et.mode,Jt),Ct(Jt,Tt),Jt.return=Et,Et=Jt)}return Se(Et);case Tp:e:{for(hi=Tt.key;rt!==null;){if(rt.key===hi)if(rt.tag===4&&rt.stateNode.containerInfo===Tt.containerInfo&&rt.stateNode.implementation===Tt.implementation){C(Et,rt.sibling),Jt=z(rt,Tt.children||[]),Jt.return=Et,Et=Jt;break e}else{C(Et,rt);break}else y(Et,rt);rt=rt.sibling}Jt=Uy(Tt,Et.mode,Jt),Jt.return=Et,Et=Jt}return Se(Et);case Mu:return hi=Tt._init,Tt=hi(Tt._payload),jE(Et,rt,Tt,Jt)}if(pd(Tt))return _f(Et,rt,Tt,Jt);if(s(Tt)){if(hi=s(Tt),typeof hi!="function")throw Error(r(150));return Tt=hi.call(Tt),xR(Et,rt,Tt,Jt)}if(typeof Tt.then=="function")return jE(Et,rt,ot(Tt),Jt);if(Tt.$$typeof===Au)return jE(Et,rt,Ar(Et,Tt),Jt);Nt(Et,Tt)}return typeof Tt=="string"&&Tt!==""||typeof Tt=="number"||typeof Tt=="bigint"?(Tt=""+Tt,rt!==null&&rt.tag===6?(C(Et,rt.sibling),Jt=z(rt,Tt),Jt.return=Et,Et=Jt):(C(Et,rt),Jt=L0(Tt,Et.mode,Jt),Jt.return=Et,Et=Jt),Se(Et)):C(Et,rt)}return function(Et,rt,Tt,Jt){try{$r=0;var hi=jE(Et,rt,Tt,Jt);return hr=null,hi}catch(zi){if(zi===Zr)throw zi;var ma=n(29,zi,null,Et.mode);return ma.lanes=Jt,ma.return=Et,ma}finally{}}}function Si(m,y){m=kr,E(pa,m),E(Ks,y),kr=m|y.baseLanes}function si(){E(pa,kr),E(Ks,Ks.current)}function En(){kr=pa.current,v(Ks),v(pa)}function sn(m){var y=m.alternate;E(dr,dr.current&1),E(_s,m),ks===null&&(y===null||Ks.current!==null||y.memoizedState!==null)&&(ks=m)}function Ln(m){if(m.tag===22){if(E(dr,dr.current),E(_s,m),ks===null){var y=m.alternate;y!==null&&y.memoizedState!==null&&(ks=m)}}else Nn()}function Nn(){E(dr,dr.current),E(_s,_s.current)}function di(m){v(_s),ks===m&&(ks=null),v(dr)}function ur(m){for(var y=m;y!==null;){if(y.tag===13){var C=y.memoizedState;if(C!==null&&(C=C.dehydrated,C===null||zm(C)||fa(C)))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if(y.flags&128)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}function ei(){throw Error(r(321))}function La(m,y){if(y===null)return!1;for(var C=0;C<y.length&&C<m.length;C++)if(!R(m[C],y[C]))return!1;return!0}function gu(m,y,C,D,z,J){return Ra=J,Zn=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,vi.H=m===null||m.memoizedState===null?lo:Oo,bc=!1,J=C(D,z),bc=!1,Mo&&(J=mp(y,C,D,z)),Zd(m),J}function Zd(m){vi.H=Aa;var y=Gi!==null&&Gi.next!==null;if(Ra=0,Mr=Gi=Zn=null,Va=!1,ps=0,Zo=null,y)throw Error(r(300));m===null||Gs||(m=m.dependencies,m!==null&&_u(m)&&(Gs=!0))}function mp(m,y,C,D){Zn=m;var z=0;do{if(Mo&&(Zo=null),ps=0,Mo=!1,25<=z)throw Error(r(301));if(z+=1,Mr=Gi=null,m.updateQueue!=null){var J=m.updateQueue;J.lastEffect=null,J.events=null,J.stores=null,J.memoCache!=null&&(J.memoCache.index=0)}vi.H=Qo,J=y(C,D)}while(Mo);return J}function u0(){var m=vi.H,y=m.useState()[0];return y=typeof y.then=="function"?vt(y):y,m=m.useState()[0],(Gi!==null?Gi.memoizedState:null)!==m&&(Zn.flags|=1024),y}function Qd(){var m=Zc!==0;return Zc=0,m}function ef(m,y,C){y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~C}function vu(m){if(Va){for(m=m.memoizedState;m!==null;){var y=m.queue;y!==null&&(y.pending=null),m=m.next}Va=!1}Ra=0,Mr=Gi=Zn=null,Mo=!1,ps=Zc=0,Zo=null}function ve(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Mr===null?Zn.memoizedState=Mr=m:Mr=Mr.next=m,Mr}function Ke(){if(Gi===null){var m=Zn.alternate;m=m!==null?m.memoizedState:null}else m=Gi.next;var y=Mr===null?Zn.memoizedState:Mr.next;if(y!==null)Mr=y,Gi=m;else{if(m===null)throw Zn.alternate===null?Error(r(467)):Error(r(310));Gi=m,m={memoizedState:Gi.memoizedState,baseState:Gi.baseState,baseQueue:Gi.baseQueue,queue:Gi.queue,next:null},Mr===null?Zn.memoizedState=Mr=m:Mr=Mr.next=m}return Mr}function vt(m){var y=ps;return ps+=1,Zo===null&&(Zo=[]),m=an(Zo,m,y),y=Zn,(Mr===null?y.memoizedState:Mr.next)===null&&(y=y.alternate,vi.H=y===null||y.memoizedState===null?lo:Oo),m}function yt(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return vt(m);if(m.$$typeof===Au)return Ua(m)}throw Error(r(438,String(m)))}function Ze(m){var y=null,C=Zn.updateQueue;if(C!==null&&(y=C.memoCache),y==null){var D=Zn.alternate;D!==null&&(D=D.updateQueue,D!==null&&(D=D.memoCache,D!=null&&(y={data:D.data.map(function(z){return z.slice()}),index:0})))}if(y==null&&(y={data:[],index:0}),C===null&&(C=$l(),Zn.updateQueue=C),C.memoCache=y,C=y.data[y.index],C===void 0)for(C=y.data[y.index]=Array(m),D=0;D<m;D++)C[D]=hR;return y.index++,C}function Ht(m,y){return typeof y=="function"?y(m):y}function nn(m){var y=Ke();return mn(y,Gi,m)}function mn(m,y,C){var D=m.queue;if(D===null)throw Error(r(311));D.lastRenderedReducer=C;var z=m.baseQueue,J=D.pending;if(J!==null){if(z!==null){var Se=z.next;z.next=J.next,J.next=Se}y.baseQueue=z=J,D.pending=null}if(J=m.baseState,z===null)m.memoizedState=J;else{y=z.next;var ze=Se=null,ut=null,Dt=y,en=!1;do{var xn=Dt.lane&-536870913;if(xn!==Dt.lane?(In&xn)===xn:(Ra&xn)===xn){var Rn=Dt.revertLane;if(Rn===0)ut!==null&&(ut=ut.next={lane:0,revertLane:0,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null}),xn===Tn&&(en=!0);else if((Ra&Rn)===Rn){Dt=Dt.next,Rn===Tn&&(en=!0);continue}else xn={lane:0,revertLane:Dt.revertLane,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null},ut===null?(ze=ut=xn,Se=J):ut=ut.next=xn,Zn.lanes|=Rn,Sc|=Rn;xn=Dt.action,bc&&C(J,xn),J=Dt.hasEagerState?Dt.eagerState:C(J,xn)}else Rn={lane:xn,revertLane:Dt.revertLane,action:Dt.action,hasEagerState:Dt.hasEagerState,eagerState:Dt.eagerState,next:null},ut===null?(ze=ut=Rn,Se=J):ut=ut.next=Rn,Zn.lanes|=xn,Sc|=xn;Dt=Dt.next}while(Dt!==null&&Dt!==y);if(ut===null?Se=J:ut.next=ze,!R(J,m.memoizedState)&&(Gs=!0,en&&(C=$n,C!==null)))throw C;m.memoizedState=J,m.baseState=Se,m.baseQueue=ut,D.lastRenderedState=J}return z===null&&(D.lanes=0),[m.memoizedState,D.dispatch]}function Sn(m){var y=Ke(),C=y.queue;if(C===null)throw Error(r(311));C.lastRenderedReducer=m;var D=C.dispatch,z=C.pending,J=y.memoizedState;if(z!==null){C.pending=null;var Se=z=z.next;do J=m(J,Se.action),Se=Se.next;while(Se!==z);R(J,y.memoizedState)||(Gs=!0),y.memoizedState=J,y.baseQueue===null&&(y.baseState=J),C.lastRenderedState=J}return[J,D]}function oi(m,y,C){var D=Zn,z=Ke(),J=wt;if(J){if(C===void 0)throw Error(r(407));C=C()}else C=y();var Se=!R((Gi||z).memoizedState,C);if(Se&&(z.memoizedState=C,Gs=!0),z=z.queue,h0(gi.bind(null,D,z,m),[m]),z.getSnapshot!==y||Se||Mr!==null&&Mr.memoizedState.tag&1){if(D.flags|=2048,_l(9,Cn.bind(null,D,z,C,y),{destroy:void 0},null),Mn===null)throw Error(r(349));J||Ra&60||ci(D,y,C)}return C}function ci(m,y,C){m.flags|=16384,m={getSnapshot:y,value:C},y=Zn.updateQueue,y===null?(y=$l(),Zn.updateQueue=y,y.stores=[m]):(C=y.stores,C===null?y.stores=[m]:C.push(m))}function Cn(m,y,C,D){y.value=C,y.getSnapshot=D,ar(y)&&As(m)}function gi(m,y,C){return C(function(){ar(y)&&As(m)})}function ar(m){var y=m.getSnapshot;m=m.value;try{var C=y();return!R(m,C)}catch{return!0}}function As(m){var y=it(m,2);y!==null&&qo(y,m,2)}function vs(m){var y=ve();if(typeof m=="function"){var C=m;if(m=C(),bc){Z(!0);try{C()}finally{Z(!1)}}}return y.memoizedState=y.baseState=m,y.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:m},y}function Ki(m,y,C,D){return m.baseState=C,mn(m,Gi,typeof D=="function"?D:Ht)}function Yn(m,y,C,D,z){if(Ay(m))throw Error(r(485));if(m=y.action,m!==null){var J={payload:z,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Se){J.listeners.push(Se)}};vi.T!==null?C(!0):J.isTransition=!1,D(J),C=y.pending,C===null?(J.next=y.pending=J,Ti(y,J)):(J.next=C.next,y.pending=C.next=J)}}function Ti(m,y){var C=y.action,D=y.payload,z=m.state;if(y.isTransition){var J=vi.T,Se={};vi.T=Se;try{var ze=C(z,D),ut=vi.S;ut!==null&&ut(Se,ze),Bn(m,y,ze)}catch(Dt){zl(m,y,Dt)}finally{vi.T=J}}else try{J=C(z,D),Bn(m,y,J)}catch(Dt){zl(m,y,Dt)}}function Bn(m,y,C){C!==null&&typeof C=="object"&&typeof C.then=="function"?C.then(function(D){Ho(m,y,D)},function(D){return zl(m,y,D)}):Ho(m,y,C)}function Ho(m,y,C){y.status="fulfilled",y.value=C,eo(y),m.state=C,y=m.pending,y!==null&&(C=y.next,C===y?m.pending=null:(C=C.next,y.next=C,Ti(m,C)))}function zl(m,y,C){var D=m.pending;if(m.pending=null,D!==null){D=D.next;do y.status="rejected",y.reason=C,eo(y),y=y.next;while(y!==D)}m.action=null}function eo(m){m=m.listeners;for(var y=0;y<m.length;y++)(0,m[y])()}function sh(m,y){return y}function cs(m,y){if(wt){var C=Mn.formState;if(C!==null){e:{var D=Zn;if(wt){if(lt){var z=Hm(lt,It);if(z){lt=Yo(z),D=$y(z);break e}}ke(D)}D=!1}D&&(y=C[0])}}C=ve(),C.memoizedState=C.baseState=y,D={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sh,lastRenderedState:y},C.queue=D,C=oE.bind(null,Zn,D),D.dispatch=C,D=vs(!1);var J=nf.bind(null,Zn,!1,D.queue);return D=ve(),z={state:y,dispatch:null,action:m,pending:null},D.queue=z,C=Yn.bind(null,Zn,z,J,C),z.dispatch=C,D.memoizedState=m,[y,C,!1]}function bn(m){var y=Ke();return to(y,Gi,m)}function to(m,y,C){y=mn(m,y,sh)[0],m=nn(Ht)[0],y=typeof y=="object"&&y!==null&&typeof y.then=="function"?vt(y):y;var D=Ke(),z=D.queue,J=z.dispatch;return C!==D.memoizedState&&(Zn.flags|=2048,_l(9,Hs.bind(null,z,C),{destroy:void 0},null)),[y,J,m]}function Hs(m,y){m.action=y}function qn(m){var y=Ke(),C=Gi;if(C!==null)return to(y,C,m);Ke(),y=y.memoizedState,C=Ke();var D=C.queue.dispatch;return C.memoizedState=m,[y,D,!1]}function _l(m,y,C,D){return m={tag:m,create:y,inst:C,deps:D,next:null},y=Zn.updateQueue,y===null&&(y=$l(),Zn.updateQueue=y),C=y.lastEffect,C===null?y.lastEffect=m.next=m:(D=C.next,C.next=m,m.next=D,y.lastEffect=m),m}function oa(){return Ke().memoizedState}function gp(m,y,C,D){var z=ve();Zn.flags|=m,z.memoizedState=_l(1|y,C,{destroy:void 0},D===void 0?null:D)}function rd(m,y,C,D){var z=Ke();D=D===void 0?null:D;var J=z.memoizedState.inst;Gi!==null&&D!==null&&La(D,Gi.memoizedState.deps)?z.memoizedState=_l(y,C,J,D):(Zn.flags|=m,z.memoizedState=_l(1|y,C,J,D))}function ah(m,y){gp(8390656,8,m,y)}function h0(m,y){rd(2048,8,m,y)}function wy(m,y){return rd(4,2,m,y)}function d0(m,y){return rd(4,4,m,y)}function jo(m,y){if(typeof y=="function"){m=m();var C=y(m);return function(){typeof C=="function"?C():y(null)}}if(y!=null)return m=m(),y.current=m,function(){y.current=null}}function f0(m,y,C){C=C!=null?C.concat([m]):null,rd(4,4,jo.bind(null,y,m),C)}function Vo(){}function lx(m,y){var C=Ke();y=y===void 0?null:y;var D=C.memoizedState;return y!==null&&La(y,D[1])?D[0]:(C.memoizedState=[m,y],m)}function sE(m,y){var C=Ke();y=y===void 0?null:y;var D=C.memoizedState;if(y!==null&&La(y,D[1]))return D[0];if(D=m(),bc){Z(!0);try{m()}finally{Z(!1)}}return C.memoizedState=[D,y],D}function yu(m,y,C){return C===void 0||Ra&1073741824?m.memoizedState=y:(m.memoizedState=C,m=pE(),Zn.lanes|=m,Sc|=m,C)}function vm(m,y,C,D){return R(C,y)?C:Ks.current!==null?(m=yu(m,C,D),R(m,y)||(Gs=!0),m):Ra&42?(m=pE(),Zn.lanes|=m,Sc|=m,y):(Gs=!0,m.memoizedState=C)}function sd(m,y,C,D,z){var J=so();$o(J!==0&&8>J?J:8);var Se=vi.T,ze={};vi.T=ze,nf(m,!1,y,C);try{var ut=z(),Dt=vi.S;if(Dt!==null&&Dt(ze,ut),ut!==null&&typeof ut=="object"&&typeof ut.then=="function"){var en=ce(ut,D);tf(m,y,en,wo(m))}else tf(m,y,D,wo(m))}catch(xn){tf(m,y,{then:function(){},status:"rejected",reason:xn},wo())}finally{$o(J),vi.T=Se}}function Ss(m){var y=m.memoizedState;if(y!==null)return y;y={memoizedState:md,baseState:md,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:md},next:null};var C={};return y.next={memoizedState:C,baseState:C,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ht,lastRenderedState:C},next:null},m.memoizedState=y,m=m.alternate,m!==null&&(m.memoizedState=y),y}function oh(){return Ua(xl)}function Cy(){return Ke().memoizedState}function aE(){return Ke().memoizedState}function Ry(m){for(var y=m.return;y!==null;){switch(y.tag){case 24:case 3:var C=wo();m=me(C);var D=De(y,m,C);D!==null&&(qo(D,y,C),je(D,y,C)),y={cache:Oy()},m.payload=y;return}y=y.return}}function ux(m,y,C){var D=wo();C={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null},Ay(m)?cE(y,C):(C=Ie(m,y,C,D),C!==null&&(qo(C,m,D),lE(C,y,D)))}function oE(m,y,C){var D=wo();tf(m,y,C,D)}function tf(m,y,C,D){var z={lane:D,revertLane:0,action:C,hasEagerState:!1,eagerState:null,next:null};if(Ay(m))cE(y,z);else{var J=m.alternate;if(m.lanes===0&&(J===null||J.lanes===0)&&(J=y.lastRenderedReducer,J!==null))try{var Se=y.lastRenderedState,ze=J(Se,C);if(z.hasEagerState=!0,z.eagerState=ze,R(ze,Se))return Fe(m,y,z,0),Mn===null&&fe(),!1}catch{}finally{}if(C=Ie(m,y,z,D),C!==null)return qo(C,m,D),lE(C,y,D),!0}return!1}function nf(m,y,C,D){if(D={lane:2,revertLane:qt(),action:D,hasEagerState:!1,eagerState:null,next:null},Ay(m)){if(y)throw Error(r(479))}else y=Ie(m,C,D,2),y!==null&&qo(y,m,2)}function Ay(m){var y=m.alternate;return m===Zn||y!==null&&y===Zn}function cE(m,y){Mo=Va=!0;var C=m.pending;C===null?y.next=y:(y.next=C.next,C.next=y),m.pending=y}function lE(m,y,C){if(C&4194176){var D=y.lanes;D&=m.pendingLanes,C|=D,y.lanes=C,X(m,C)}}function p0(m,y,C,D){y=m.memoizedState,C=C(D,y),C=C==null?y:ph({},y,C),m.memoizedState=C,m.lanes===0&&(m.updateQueue.baseState=C)}function My(m,y,C,D,z,J,Se){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(D,J,Se):y.prototype&&y.prototype.isPureReactComponent?!ht(C,D)||!ht(z,J):!0}function uE(m,y,C,D){m=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(C,D),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(C,D),y.state!==m&&gf.enqueueReplaceState(y,y.state,null)}function ch(m,y){var C=y;if("ref"in y){C={};for(var D in y)D!=="ref"&&(C[D]=y[D])}if(m=m.defaultProps){C===y&&(C=ph({},C));for(var z in m)C[z]===void 0&&(C[z]=m[z])}return C}function ym(m,y){try{var C=m.onUncaughtError;C(y.value,{componentStack:y.stack})}catch(D){setTimeout(function(){throw D})}}function hE(m,y,C){try{var D=m.onCaughtError;D(C.value,{componentStack:C.stack,errorBoundary:y.tag===1?y.stateNode:null})}catch(z){setTimeout(function(){throw z})}}function hc(m,y,C){return C=me(C),C.tag=3,C.payload={element:null},C.callback=function(){ym(m,y)},C}function Ms(m){return m=me(m),m.tag=3,m}function ad(m,y,C,D){var z=C.type.getDerivedStateFromError;if(typeof z=="function"){var J=D.value;m.payload=function(){return z(J)},m.callback=function(){hE(y,C,D)}}var Se=C.stateNode;Se!==null&&typeof Se.componentDidCatch=="function"&&(m.callback=function(){hE(y,C,D),typeof z!="function"&&(Ed===null?Ed=new Set([this]):Ed.add(this));var ze=D.stack;this.componentDidCatch(D.value,{componentStack:ze!==null?ze:""})})}function hx(m,y,C,D,z){if(C.flags|=32768,D!==null&&typeof D=="object"&&typeof D.then=="function"){if(y=C.alternate,y!==null&&v0(y,C,z,!0),C=_s.current,C!==null){switch(C.tag){case 13:return ks===null?Ba():C.alternate===null&&fr===0&&(fr=3),C.flags&=-257,C.flags|=65536,C.lanes=z,D===Qr?C.flags|=16384:(y=C.updateQueue,y===null?C.updateQueue=new Set([D]):y.add(D),I0(m,D,z)),!1;case 22:return C.flags|=65536,D===Qr?C.flags|=16384:(y=C.updateQueue,y===null?(y={transitions:null,markerInstances:null,retryQueue:new Set([D])},C.updateQueue=y):(C=y.retryQueue,C===null?y.retryQueue=new Set([D]):C.add(D)),I0(m,D,z)),!1}throw Error(r(435,C.tag))}return I0(m,D,z),Ba(),!1}if(wt)return y=_s.current,y!==null?(!(y.flags&65536)&&(y.flags|=256),y.flags|=65536,y.lanes=z,D!==Xn&&(m=Error(r(422),{cause:D}),et(ee(m,C)))):(D!==Xn&&(y=Error(r(423),{cause:D}),et(ee(y,C))),m=m.current.alternate,m.flags|=65536,z&=-z,m.lanes|=z,D=ee(D,C),z=hc(m.stateNode,D,z),mt(m,z),fr!==4&&(fr=2)),!1;var J=Error(r(520),{cause:D});if(J=ee(J,C),_d===null?_d=[J]:_d.push(J),fr!==4&&(fr=2),y===null)return!0;D=ee(D,C),C=y;do{switch(C.tag){case 3:return C.flags|=65536,m=z&-z,C.lanes|=m,m=hc(C.stateNode,D,m),mt(C,m),!1;case 1:if(y=C.type,J=C.stateNode,(C.flags&128)===0&&(typeof y.getDerivedStateFromError=="function"||J!==null&&typeof J.componentDidCatch=="function"&&(Ed===null||!Ed.has(J))))return C.flags|=65536,z&=-z,C.lanes|=z,z=Ms(z),ad(z,m,C,D),mt(C,z),!1}C=C.return}while(C!==null);return!1}function ca(m,y,C,D){y.child=m===null?fs(y,null,C,D):es(y,m.child,C,D)}function dx(m,y,C,D,z){C=C.render;var J=y.ref;if("ref"in D){var Se={};for(var ze in D)ze!=="ref"&&(Se[ze]=D[ze])}else Se=D;return Wc(y),D=gu(m,y,C,Se,J,z),ze=Qd(),m!==null&&!Gs?(ef(m,y,z),ji(m,y,z)):(wt&&ze&&Me(y),y.flags|=1,ca(m,y,D,z),y.child)}function m0(m,y,C,D,z){if(m===null){var J=C.type;return typeof J=="function"&&!k0(J)&&J.defaultProps===void 0&&C.compare===null?(y.tag=15,y.type=J,fx(m,y,J,D,z)):(m=P0(C.type,null,D,y,y.mode,z),m.ref=y.ref,m.return=y,y.child=m)}if(J=m.child,!la(m,z)){var Se=J.memoizedProps;if(C=C.compare,C=C!==null?C:ht,C(Se,D)&&m.ref===y.ref)return ji(m,y,z)}return y.flags|=1,m=fh(J,D),m.ref=y.ref,m.return=y,y.child=m}function fx(m,y,C,D,z){if(m!==null){var J=m.memoizedProps;if(ht(J,D)&&m.ref===y.ref)if(Gs=!1,y.pendingProps=D=J,la(m,z))m.flags&131072&&(Gs=!0);else return y.lanes=m.lanes,ji(m,y,z)}return dc(m,y,C,D,z)}function rf(m,y,C){var D=y.pendingProps,z=D.children,J=(y.stateNode._pendingVisibility&2)!==0,Se=m!==null?m.memoizedState:null;if(no(m,y),D.mode==="hidden"||J){if(y.flags&128){if(D=Se!==null?Se.baseLanes|C:C,m!==null){for(z=y.child=m.child,J=0;z!==null;)J=J|z.lanes|z.childLanes,z=z.sibling;y.childLanes=J&~D}else y.childLanes=0,y.child=null;return _m(m,y,D,C)}if(C&536870912)y.memoizedState={baseLanes:0,cachePool:null},m!==null&&Ny(y,Se!==null?Se.cachePool:null),Se!==null?Si(y,Se):si(),Ln(y);else return y.lanes=y.childLanes=536870912,_m(m,y,Se!==null?Se.baseLanes|C:C,C)}else Se!==null?(Ny(y,Se.cachePool),Si(y,Se),Nn(),y.memoizedState=null):(m!==null&&Ny(y,null),si(),Nn());return ca(m,y,z,C),y.child}function _m(m,y,C,D){var z=af();return z=z===null?null:{parent:ql?Wr._currentValue:Wr._currentValue2,pool:z},y.memoizedState={baseLanes:C,cachePool:z},m!==null&&Ny(y,null),si(),Ln(y),m!==null&&v0(m,y,D,!0),null}function no(m,y){var C=y.ref;if(C===null)m!==null&&m.ref!==null&&(y.flags|=2097664);else{if(typeof C!="function"&&typeof C!="object")throw Error(r(284));(m===null||m.ref!==C)&&(y.flags|=2097664)}}function dc(m,y,C,D,z){return Wc(y),C=gu(m,y,C,D,void 0,z),D=Qd(),m!==null&&!Gs?(ef(m,y,z),ji(m,y,z)):(wt&&D&&Me(y),y.flags|=1,ca(m,y,C,z),y.child)}function bm(m,y,C,D,z,J){return Wc(y),y.updateQueue=null,C=mp(y,D,C,z),Zd(m),D=Qd(),m!==null&&!Gs?(ef(m,y,J),ji(m,y,J)):(wt&&D&&Me(y),y.flags|=1,ca(m,y,C,J),y.child)}function px(m,y,C,D,z){if(Wc(y),y.stateNode===null){var J=Ko,Se=C.contextType;typeof Se=="object"&&Se!==null&&(J=Ua(Se)),J=new C(D,J),y.memoizedState=J.state!==null&&J.state!==void 0?J.state:null,J.updater=gf,y.stateNode=J,J._reactInternals=y,J=y.stateNode,J.props=D,J.state=y.memoizedState,J.refs={},j(y),Se=C.contextType,J.context=typeof Se=="object"&&Se!==null?Ua(Se):Ko,J.state=y.memoizedState,Se=C.getDerivedStateFromProps,typeof Se=="function"&&(p0(y,C,Se,D),J.state=y.memoizedState),typeof C.getDerivedStateFromProps=="function"||typeof J.getSnapshotBeforeUpdate=="function"||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(Se=J.state,typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount(),Se!==J.state&&gf.enqueueReplaceState(J,J.state,null),Vn(y,D,J,z),xt(),J.state=y.memoizedState),typeof J.componentDidMount=="function"&&(y.flags|=4194308),D=!0}else if(m===null){J=y.stateNode;var ze=y.memoizedProps,ut=ch(C,ze);J.props=ut;var Dt=J.context,en=C.contextType;Se=Ko,typeof en=="object"&&en!==null&&(Se=Ua(en));var xn=C.getDerivedStateFromProps;en=typeof xn=="function"||typeof J.getSnapshotBeforeUpdate=="function",ze=y.pendingProps!==ze,en||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ze||Dt!==Se)&&uE(y,J,D,Se),$i=!1;var Rn=y.memoizedState;J.state=Rn,Vn(y,D,J,z),xt(),Dt=y.memoizedState,ze||Rn!==Dt||$i?(typeof xn=="function"&&(p0(y,C,xn,D),Dt=y.memoizedState),(ut=$i||My(y,C,ut,D,Rn,Dt,Se))?(en||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(y.flags|=4194308)):(typeof J.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=D,y.memoizedState=Dt),J.props=D,J.state=Dt,J.context=Se,D=ut):(typeof J.componentDidMount=="function"&&(y.flags|=4194308),D=!1)}else{J=y.stateNode,W(m,y),Se=y.memoizedProps,en=ch(C,Se),J.props=en,xn=y.pendingProps,Rn=J.context,Dt=C.contextType,ut=Ko,typeof Dt=="object"&&Dt!==null&&(ut=Ua(Dt)),ze=C.getDerivedStateFromProps,(Dt=typeof ze=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(Se!==xn||Rn!==ut)&&uE(y,J,D,ut),$i=!1,Rn=y.memoizedState,J.state=Rn,Vn(y,D,J,z),xt();var er=y.memoizedState;Se!==xn||Rn!==er||$i||m!==null&&m.dependencies!==null&&_u(m.dependencies)?(typeof ze=="function"&&(p0(y,C,ze,D),er=y.memoizedState),(en=$i||My(y,C,en,D,Rn,er,ut)||m!==null&&m.dependencies!==null&&_u(m.dependencies))?(Dt||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(D,er,ut),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(D,er,ut)),typeof J.componentDidUpdate=="function"&&(y.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof J.componentDidUpdate!="function"||Se===m.memoizedProps&&Rn===m.memoizedState||(y.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||Se===m.memoizedProps&&Rn===m.memoizedState||(y.flags|=1024),y.memoizedProps=D,y.memoizedState=er),J.props=D,J.state=er,J.context=ut,D=en):(typeof J.componentDidUpdate!="function"||Se===m.memoizedProps&&Rn===m.memoizedState||(y.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||Se===m.memoizedProps&&Rn===m.memoizedState||(y.flags|=1024),D=!1)}return J=D,no(m,y),D=(y.flags&128)!==0,J||D?(J=y.stateNode,C=D&&typeof C.getDerivedStateFromError!="function"?null:J.render(),y.flags|=1,m!==null&&D?(y.child=es(y,m.child,null,z),y.child=es(y,null,C,z)):ca(m,y,C,z),y.memoizedState=J.state,m=y.child):m=ji(m,y,z),m}function Ta(m,y,C,D){return ye(),y.flags|=256,ca(m,y,C,D),y.child}function Ys(m){return{baseLanes:m,cachePool:mx()}}function g0(m,y,C){return m=m!==null?m.childLanes&~C:0,y&&(m|=Yl),m}function od(m,y,C){var D=y.pendingProps,z=!1,J=(y.flags&128)!==0,Se;if((Se=J)||(Se=m!==null&&m.memoizedState===null?!1:(dr.current&2)!==0),Se&&(z=!0,y.flags&=-129),Se=(y.flags&32)!==0,y.flags&=-33,m===null){if(wt){if(z?sn(y):Nn(),wt){var ze=lt,ut;(ut=ze)&&(ze=br(ze,It),ze!==null?(y.memoizedState={dehydrated:ze,treeContext:se!==null?{id:he,overflow:pe}:null,retryLane:536870912},ut=n(18,null,null,0),ut.stateNode=ze,ut.return=y,y.child=ut,_e=y,lt=null,ut=!0):ut=!1),ut||ke(y)}if(ze=y.memoizedState,ze!==null&&(ze=ze.dehydrated,ze!==null))return fa(ze)?y.lanes=16:y.lanes=536870912,null;di(y)}return ze=D.children,D=D.fallback,z?(Nn(),z=y.mode,ze=ft({mode:"hidden",children:ze},z),D=df(D,z,C,null),ze.return=y,D.return=y,ze.sibling=D,y.child=ze,z=y.child,z.memoizedState=Ys(C),z.childLanes=g0(m,Se,C),y.memoizedState=yd,D):(sn(y),vp(y,ze))}if(ut=m.memoizedState,ut!==null&&(ze=ut.dehydrated,ze!==null)){if(J)y.flags&256?(sn(y),y.flags&=-257,y=at(m,y,C)):y.memoizedState!==null?(Nn(),y.child=m.child,y.flags|=128,y=null):(Nn(),z=D.fallback,ze=y.mode,D=ft({mode:"visible",children:D.children},ze),z=df(z,ze,C,null),z.flags|=2,D.return=y,z.return=y,D.sibling=z,y.child=D,es(y,m.child,null,C),D=y.child,D.memoizedState=Ys(C),D.childLanes=g0(m,Se,C),y.memoizedState=yd,y=z);else if(sn(y),fa(ze))Se=yh(ze).digest,D=Error(r(419)),D.stack="",D.digest=Se,et({value:D,source:null,stack:null}),y=at(m,y,C);else if(Gs||v0(m,y,C,!1),Se=(C&m.childLanes)!==0,Gs||Se){if(Se=Mn,Se!==null){if(D=C&-C,D&42)D=1;else switch(D){case 2:D=1;break;case 8:D=4;break;case 32:D=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:D=64;break;case 268435456:D=134217728;break;default:D=0}if(D=D&(Se.suspendedLanes|C)?0:D,D!==0&&D!==ut.retryLane)throw ut.retryLane=D,it(m,D),qo(Se,m,D),Np}zm(ze)||Ba(),y=at(m,y,C)}else zm(ze)?(y.flags|=128,y.child=m.child,y=_E.bind(null,m),Rx(ze,y),y=null):(m=ut.treeContext,Sl&&(lt=kE(ze),_e=y,wt=!0,Kt=null,It=!1,m!==null&&(re[K++]=he,re[K++]=pe,re[K++]=se,he=m.id,pe=m.overflow,se=y)),y=vp(y,D.children),y.flags|=4096);return y}return z?(Nn(),z=D.fallback,ze=y.mode,ut=m.child,J=ut.sibling,D=fh(ut,{mode:"hidden",children:D.children}),D.subtreeFlags=ut.subtreeFlags&31457280,J!==null?z=fh(J,z):(z=df(z,ze,C,null),z.flags|=2),z.return=y,D.return=y,D.sibling=z,y.child=D,D=z,z=y.child,ze=m.child.memoizedState,ze===null?ze=Ys(C):(ut=ze.cachePool,ut!==null?(J=ql?Wr._currentValue:Wr._currentValue2,ut=ut.parent!==J?{parent:J,pool:J}:ut):ut=mx(),ze={baseLanes:ze.baseLanes|C,cachePool:ut}),z.memoizedState=ze,z.childLanes=g0(m,Se,C),y.memoizedState=yd,D):(sn(y),C=m.child,m=C.sibling,C=fh(C,{mode:"visible",children:D.children}),C.return=y,C.sibling=null,m!==null&&(Se=y.deletions,Se===null?(y.deletions=[m],y.flags|=16):Se.push(m)),y.child=C,y.memoizedState=null,C)}function vp(m,y){return y=ft({mode:"visible",children:y},m.mode),y.return=m,m.child=y}function ft(m,y){return bE(m,y,0,null)}function at(m,y,C){return es(y,m.child,null,C),m=vp(y,y.pendingProps.children),m.flags|=2,y.memoizedState=null,m}function Ft(m,y,C){m.lanes|=y;var D=m.alternate;D!==null&&(D.lanes|=y),$c(m.return,y,C)}function fn(m,y,C,D,z){var J=m.memoizedState;J===null?m.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:D,tail:C,tailMode:z}:(J.isBackwards=y,J.rendering=null,J.renderingStartTime=0,J.last=D,J.tail=C,J.tailMode=z)}function Xt(m,y,C){var D=y.pendingProps,z=D.revealOrder,J=D.tail;if(ca(m,y,D.children,C),D=dr.current,D&2)D=D&1|2,y.flags|=128;else{if(m!==null&&m.flags&128)e:for(m=y.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&Ft(m,C,y);else if(m.tag===19)Ft(m,C,y);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===y)break e;for(;m.sibling===null;){if(m.return===null||m.return===y)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}D&=1}switch(E(dr,D),z){case"forwards":for(C=y.child,z=null;C!==null;)m=C.alternate,m!==null&&ur(m)===null&&(z=C),C=C.sibling;C=z,C===null?(z=y.child,y.child=null):(z=C.sibling,C.sibling=null),fn(y,!1,z,C,J);break;case"backwards":for(C=null,z=y.child,y.child=null;z!==null;){if(m=z.alternate,m!==null&&ur(m)===null){y.child=z;break}m=z.sibling,z.sibling=C,C=z,z=m}fn(y,!0,C,null,J);break;case"together":fn(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function ji(m,y,C){if(m!==null&&(y.dependencies=m.dependencies),Sc|=y.lanes,!(C&y.childLanes))if(m!==null){if(v0(m,y,C,!1),(C&y.childLanes)===0)return null}else return null;if(m!==null&&y.child!==m.child)throw Error(r(153));if(y.child!==null){for(m=y.child,C=fh(m,m.pendingProps),y.child=C,C.return=y;m.sibling!==null;)m=m.sibling,C=C.sibling=fh(m,m.pendingProps),C.return=y;C.sibling=null}return y.child}function la(m,y){return m.lanes&y?!0:(m=m.dependencies,!!(m!==null&&_u(m)))}function lh(m,y,C){switch(y.tag){case 3:Te(y,y.stateNode.containerInfo),Hl(y,Wr,m.memoizedState.cache),ye();break;case 27:case 5:we(y);break;case 4:Te(y,y.stateNode.containerInfo);break;case 10:Hl(y,y.type,y.memoizedProps.value);break;case 13:var D=y.memoizedState;if(D!==null)return D.dehydrated!==null?(sn(y),y.flags|=128,null):C&y.child.childLanes?od(m,y,C):(sn(y),m=ji(m,y,C),m!==null?m.sibling:null);sn(y);break;case 19:var z=(m.flags&128)!==0;if(D=(C&y.childLanes)!==0,D||(v0(m,y,C,!1),D=(C&y.childLanes)!==0),z){if(D)return Xt(m,y,C);y.flags|=128}if(z=y.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),E(dr,dr.current),D)break;return null;case 22:case 23:return y.lanes=0,rf(m,y,C);case 24:Hl(y,Wr,m.memoizedState.cache)}return ji(m,y,C)}function Ji(m,y,C){if(m!==null)if(m.memoizedProps!==y.pendingProps)Gs=!0;else{if(!la(m,C)&&!(y.flags&128))return Gs=!1,lh(m,y,C);Gs=!!(m.flags&131072)}else Gs=!1,wt&&y.flags&1048576&&de(y,te,y.index);switch(y.lanes=0,y.tag){case 16:e:{m=y.pendingProps;var D=y.elementType,z=D._init;if(D=z(D._payload),y.type=D,typeof D=="function")k0(D)?(m=ch(D,m),y.tag=1,y=px(null,y,D,m,C)):(y.tag=0,y=dc(null,y,D,m,C));else{if(D!=null){if(z=D.$$typeof,z===Im){y.tag=11,y=dx(null,y,D,m,C);break e}else if(z===F0){y.tag=14,y=m0(null,y,D,m,C);break e}}throw y=a(D)||D,Error(r(306,y,""))}}return y;case 0:return dc(m,y,y.type,y.pendingProps,C);case 1:return D=y.type,z=ch(D,y.pendingProps),px(m,y,D,z,C);case 3:e:{if(Te(y,y.stateNode.containerInfo),m===null)throw Error(r(387));var J=y.pendingProps;z=y.memoizedState,D=z.element,W(m,y),Vn(y,J,null,C);var Se=y.memoizedState;if(J=Se.cache,Hl(y,Wr,J),J!==z.cache&&Em(y,[Wr],C,!0),xt(),J=Se.element,Sl&&z.isDehydrated)if(z={element:J,isDehydrated:!1,cache:Se.cache},y.updateQueue.baseState=z,y.memoizedState=z,y.flags&256){y=Ta(m,y,J,C);break e}else if(J!==D){D=ee(Error(r(424)),y),et(D),y=Ta(m,y,J,C);break e}else for(Sl&&(lt=Ao(y.stateNode.containerInfo),_e=y,wt=!0,Kt=null,It=!0),C=fs(y,null,J,C),y.child=C;C;)C.flags=C.flags&-3|4096,C=C.sibling;else{if(ye(),J===D){y=ji(m,y,C);break e}ca(m,y,J,C)}y=y.child}return y;case 26:if(ao)return no(m,y),m===null?(C=bh(y.type,null,y.pendingProps,null))?y.memoizedState=C:wt||(y.stateNode=_R(y.type,y.pendingProps,Ye.current,y)):y.memoizedState=bh(y.type,m.memoizedProps,y.pendingProps,m.memoizedState),null;case 27:if(Ca)return we(y),m===null&&Ca&&wt&&(D=y.stateNode=Gm(y.type,y.pendingProps,Ye.current,Ne.current,!1),_e=y,It=!0,lt=Ro(D)),D=y.pendingProps.children,m!==null||wt?ca(m,y,D,C):y.child=es(y,null,D,C),no(m,y),y.child;case 5:return m===null&&wt&&(Pu(y.type,y.pendingProps,Ne.current),(z=D=lt)&&(D=Ax(D,y.type,y.pendingProps,It),D!==null?(y.stateNode=D,_e=y,lt=Ro(D),It=!1,z=!0):z=!1),z||ke(y)),we(y),z=y.type,J=y.pendingProps,Se=m!==null?m.memoizedProps:null,D=J.children,Pm(z,J)?D=null:Se!==null&&Pm(z,Se)&&(y.flags|=32),y.memoizedState!==null&&(z=gu(m,y,u0,null,null,C),ql?xl._currentValue=z:xl._currentValue2=z),no(m,y),ca(m,y,D,C),y.child;case 6:return m===null&&wt&&(Lu(y.pendingProps,Ne.current),(m=C=lt)&&(C=gd(C,y.pendingProps,It),C!==null?(y.stateNode=C,_e=y,lt=null,m=!0):m=!1),m||ke(y)),null;case 13:return od(m,y,C);case 4:return Te(y,y.stateNode.containerInfo),D=y.pendingProps,m===null?y.child=es(y,null,D,C):ca(m,y,D,C),y.child;case 11:return dx(m,y,y.type,y.pendingProps,C);case 7:return ca(m,y,y.pendingProps,C),y.child;case 8:return ca(m,y,y.pendingProps.children,C),y.child;case 12:return ca(m,y,y.pendingProps.children,C),y.child;case 10:return D=y.pendingProps,Hl(y,y.type,D.value),ca(m,y,D.children,C),y.child;case 9:return z=y.type._context,D=y.pendingProps.children,Wc(y),z=Ua(z),D=D(z),y.flags|=1,ca(m,y,D,C),y.child;case 14:return m0(m,y,y.type,y.pendingProps,C);case 15:return fx(m,y,y.type,y.pendingProps,C);case 19:return Xt(m,y,C);case 22:return rf(m,y,C);case 24:return Wc(y),D=Ua(Wr),m===null?(z=af(),z===null&&(z=Mn,J=Oy(),z.pooledCache=J,J.refCount++,J!==null&&(z.pooledCacheLanes|=C),z=J),y.memoizedState={parent:D,cache:z},j(y),Hl(y,Wr,z)):(m.lanes&C&&(W(m,y),Vn(y,null,null,C),xt()),z=m.memoizedState,J=y.memoizedState,z.parent!==D?(z={parent:D,cache:D},y.memoizedState=z,y.lanes===0&&(y.memoizedState=y.updateQueue.baseState=z),Hl(y,Wr,D)):(D=J.cache,Hl(y,Wr,D),D!==z.cache&&Em(y,[Wr],C,!0))),ca(m,y,y.pendingProps.children,C),y.child;case 29:throw y.pendingProps}throw Error(r(156,y.tag))}function Hl(m,y,C){ql?(E(Th,y._currentValue),y._currentValue=C):(E(Th,y._currentValue2),y._currentValue2=C)}function uh(m){var y=Th.current;ql?m._currentValue=y:m._currentValue2=y,v(Th)}function $c(m,y,C){for(;m!==null;){var D=m.alternate;if((m.childLanes&y)!==y?(m.childLanes|=y,D!==null&&(D.childLanes|=y)):D!==null&&(D.childLanes&y)!==y&&(D.childLanes|=y),m===C)break;m=m.return}}function Em(m,y,C,D){var z=m.child;for(z!==null&&(z.return=m);z!==null;){var J=z.dependencies;if(J!==null){var Se=z.child;J=J.firstContext;e:for(;J!==null;){var ze=J;J=z;for(var ut=0;ut<y.length;ut++)if(ze.context===y[ut]){J.lanes|=C,ze=J.alternate,ze!==null&&(ze.lanes|=C),$c(J.return,C,m),D||(Se=null);break e}J=ze.next}}else if(z.tag===18){if(Se=z.return,Se===null)throw Error(r(341));Se.lanes|=C,J=Se.alternate,J!==null&&(J.lanes|=C),$c(Se,C,m),Se=null}else Se=z.child;if(Se!==null)Se.return=z;else for(Se=z;Se!==null;){if(Se===m){Se=null;break}if(z=Se.sibling,z!==null){z.return=Se.return,Se=z;break}Se=Se.return}z=Se}}function v0(m,y,C,D){m=null;for(var z=y,J=!1;z!==null;){if(!J){if(z.flags&524288)J=!0;else if(z.flags&262144)break}if(z.tag===10){var Se=z.alternate;if(Se===null)throw Error(r(387));if(Se=Se.memoizedProps,Se!==null){var ze=z.type;R(z.pendingProps.value,Se.value)||(m!==null?m.push(ze):m=[ze])}}else if(z===Oe.current){if(Se=z.alternate,Se===null)throw Error(r(387));Se.memoizedState.memoizedState!==z.memoizedState.memoizedState&&(m!==null?m.push(xl):m=[xl])}z=z.return}m!==null&&Em(y,m,C,D),y.flags|=262144}function _u(m){for(m=m.firstContext;m!==null;){var y=m.context;if(!R(ql?y._currentValue:y._currentValue2,m.memoizedValue))return!0;m=m.next}return!1}function Wc(m){Uu=m,Cl=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Ua(m){return y0(Uu,m)}function Ar(m,y){return Uu===null&&Wc(m),y0(m,y)}function y0(m,y){var C=ql?y._currentValue:y._currentValue2;if(y={context:y,memoizedValue:C,next:null},Cl===null){if(m===null)throw Error(r(308));Cl=y,m.dependencies={lanes:0,firstContext:y},m.flags|=524288}else Cl=Cl.next=y;return C}function Oy(){return{controller:new J0,data:new Map,refCount:0}}function sf(m){m.refCount--,m.refCount===0&&Ky(Z0,function(){m.controller.abort()})}function af(){var m=xh.current;return m!==null?m:Mn.pooledCache}function Ny(m,y){y===null?E(xh,xh.current):E(xh,y.pool)}function mx(){var m=af();return m===null?null:{parent:ql?Wr._currentValue:Wr._currentValue2,pool:m}}function Go(m){m.flags|=4}function cd(m,y){if(m!==null&&m.child===y.child)return!1;if(y.flags&16)return!0;for(m=y.child;m!==null;){if(m.flags&13878||m.subtreeFlags&13878)return!0;m=m.sibling}return!1}function hh(m,y,C,D){if(Co)for(C=y.child;C!==null;){if(C.tag===5||C.tag===6)Ap(m,C.stateNode);else if(!(C.tag===4||Ca&&C.tag===27)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===y)break;for(;C.sibling===null;){if(C.return===null||C.return===y)return;C=C.return}C.sibling.return=C.return,C=C.sibling}else if(Nu)for(var z=y.child;z!==null;){if(z.tag===5){var J=z.stateNode;C&&D&&(J=Fm(J,z.type,z.memoizedProps)),Ap(m,J)}else if(z.tag===6)J=z.stateNode,C&&D&&(J=Ha(J,z.memoizedProps)),Ap(m,J);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)J=z.child,J!==null&&(J.return=z),hh(m,z,!0,!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===y)break;for(;z.sibling===null;){if(z.return===null||z.return===y)return;z=z.return}z.sibling.return=z.return,z=z.sibling}}function dE(m,y,C,D){if(Nu)for(var z=y.child;z!==null;){if(z.tag===5){var J=z.stateNode;C&&D&&(J=Fm(J,z.type,z.memoizedProps)),Du(m,J)}else if(z.tag===6)J=z.stateNode,C&&D&&(J=Ha(J,z.memoizedProps)),Du(m,J);else if(z.tag!==4){if(z.tag===22&&z.memoizedState!==null)J=z.child,J!==null&&(J.return=z),dE(m,z,!(z.memoizedProps!==null&&z.memoizedProps.mode==="manual"),!0);else if(z.child!==null){z.child.return=z,z=z.child;continue}}if(z===y)break;for(;z.sibling===null;){if(z.return===null||z.return===y)return;z=z.return}z.sibling.return=z.return,z=z.sibling}}function Sm(m,y){if(Nu&&cd(m,y)){m=y.stateNode;var C=m.containerInfo,D=qy();dE(D,y,!1,!1),m.pendingChildren=D,Go(y),Op(C,D)}}function Tm(m,y,C,D){if(Co)m.memoizedProps!==D&&Go(y);else if(Nu){var z=m.stateNode,J=m.memoizedProps;if((m=cd(m,y))||J!==D){var Se=Ne.current;J=W0(z,C,J,D,!m,null),J===z?y.stateNode=z:(xE(J,C,D,Se)&&Go(y),y.stateNode=J,m?hh(J,y,!1,!1):Go(y))}else y.stateNode=z}}function _0(m,y,C){if(wE(y,C)){if(m.flags|=16777216,!ku(y,C))if(mE())m.flags|=8192;else throw Ir=Qr,ds}else m.flags&=-16777217}function of(m,y){if(Wy(y)){if(m.flags|=16777216,!LE(y))if(mE())m.flags|=8192;else throw Ir=Qr,ds}else m.flags&=-16777217}function b0(m,y){y!==null&&(m.flags|=4),m.flags&16384&&(y=m.tag!==22?L():536870912,m.lanes|=y,Ip|=y)}function bu(m,y){if(!wt)switch(m.tailMode){case"hidden":y=m.tail;for(var C=null;y!==null;)y.alternate!==null&&(C=y),y=y.sibling;C===null?m.tail=null:C.sibling=null;break;case"collapsed":C=m.tail;for(var D=null;C!==null;)C.alternate!==null&&(D=C),C=C.sibling;D===null?y||m.tail===null?m.tail=null:m.tail.sibling=null:D.sibling=null}}function Fr(m){var y=m.alternate!==null&&m.alternate.child===m.child,C=0,D=0;if(y)for(var z=m.child;z!==null;)C|=z.lanes|z.childLanes,D|=z.subtreeFlags&31457280,D|=z.flags&31457280,z.return=m,z=z.sibling;else for(z=m.child;z!==null;)C|=z.lanes|z.childLanes,D|=z.subtreeFlags,D|=z.flags,z.return=m,z=z.sibling;return m.subtreeFlags|=D,m.childLanes=C,y}function E0(m,y,C){var D=y.pendingProps;switch(He(y),y.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fr(y),null;case 1:return Fr(y),null;case 3:return C=y.stateNode,D=null,m!==null&&(D=m.memoizedState.cache),y.memoizedState.cache!==D&&(y.flags|=2048),uh(Wr),Le(),C.pendingContext&&(C.context=C.pendingContext,C.pendingContext=null),(m===null||m.child===null)&&(Ee(y)?Go(y):m===null||m.memoizedState.isDehydrated&&!(y.flags&256)||(y.flags|=1024,Kt!==null&&(A0(Kt),Kt=null))),Sm(m,y),Fr(y),null;case 26:if(ao){C=y.type;var z=y.memoizedState;return m===null?(Go(y),z!==null?(Fr(y),of(y,z)):(Fr(y),_0(y,C,D))):z?z!==m.memoizedState?(Go(y),Fr(y),of(y,z)):(Fr(y),y.flags&=-16777217):(Co?m.memoizedProps!==D&&Go(y):Tm(m,y,C,D),Fr(y),_0(y,C,D)),null}case 27:if(Ca){if(Ce(y),C=Ye.current,z=y.type,m!==null&&y.stateNode!=null)Co?m.memoizedProps!==D&&Go(y):Tm(m,y,z,D);else{if(!D){if(y.stateNode===null)throw Error(r(166));return Fr(y),null}m=Ne.current,Ee(y)?St(y,m):(m=Gm(z,D,C,m,!0),y.stateNode=m,Go(y))}return Fr(y),null}case 5:if(Ce(y),C=y.type,m!==null&&y.stateNode!=null)Tm(m,y,C,D);else{if(!D){if(y.stateNode===null)throw Error(r(166));return Fr(y),null}m=Ne.current,Ee(y)?St(y,m):(z=Rp(C,D,Ye.current,m,y),hh(z,y,!1,!1),y.stateNode=z,xE(z,C,D,m)&&Go(y))}return Fr(y),_0(y,y.type,y.pendingProps),null;case 6:if(m&&y.stateNode!=null)C=m.memoizedProps,Co?C!==D&&Go(y):Nu&&(C!==D?(y.stateNode=H0(D,Ye.current,Ne.current,y),Go(y)):y.stateNode=m.stateNode);else{if(typeof D!="string"&&y.stateNode===null)throw Error(r(166));if(m=Ye.current,C=Ne.current,Ee(y)){if(!Sl)throw Error(r(176));if(m=y.stateNode,C=y.memoizedProps,D=null,z=_e,z!==null)switch(z.tag){case 27:case 5:D=z.memoizedProps}mR(m,C,y,D)||ke(y)}else y.stateNode=H0(D,m,C,y)}return Fr(y),null;case 13:if(D=y.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(z=Ee(y),D!==null&&D.dehydrated!==null){if(m===null){if(!z)throw Error(r(318));if(!Sl)throw Error(r(344));if(z=y.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(r(317));gR(z,y)}else ye(),!(y.flags&128)&&(y.memoizedState=null),y.flags|=4;Fr(y),z=!1}else Kt!==null&&(A0(Kt),Kt=null),z=!0;if(!z)return y.flags&256?(di(y),y):(di(y),null)}if(di(y),y.flags&128)return y.lanes=C,y;if(C=D!==null,m=m!==null&&m.memoizedState!==null,C){D=y.child,z=null,D.alternate!==null&&D.alternate.memoizedState!==null&&D.alternate.memoizedState.cachePool!==null&&(z=D.alternate.memoizedState.cachePool.pool);var J=null;D.memoizedState!==null&&D.memoizedState.cachePool!==null&&(J=D.memoizedState.cachePool.pool),J!==z&&(D.flags|=2048)}return C!==m&&C&&(y.child.flags|=8192),b0(y,y.updateQueue),Fr(y),null;case 4:return Le(),Sm(m,y),m===null&&dR(y.stateNode.containerInfo),Fr(y),null;case 10:return uh(y.type),Fr(y),null;case 19:if(v(dr),z=y.memoizedState,z===null)return Fr(y),null;if(D=(y.flags&128)!==0,J=z.rendering,J===null)if(D)bu(z,!1);else{if(fr!==0||m!==null&&m.flags&128)for(m=y.child;m!==null;){if(J=ur(m),J!==null){for(y.flags|=128,bu(z,!1),m=J.updateQueue,y.updateQueue=m,b0(y,m),y.subtreeFlags=0,m=C,C=y.child;C!==null;)D0(C,m),C=C.sibling;return E(dr,dr.current&1|2),y.child}m=m.sibling}z.tail!==null&&Jn()>ev&&(y.flags|=128,D=!0,bu(z,!1),y.lanes=4194304)}else{if(!D)if(m=ur(J),m!==null){if(y.flags|=128,D=!0,m=m.updateQueue,y.updateQueue=m,b0(y,m),bu(z,!0),z.tail===null&&z.tailMode==="hidden"&&!J.alternate&&!wt)return Fr(y),null}else 2*Jn()-z.renderingStartTime>ev&&C!==536870912&&(y.flags|=128,D=!0,bu(z,!1),y.lanes=4194304);z.isBackwards?(J.sibling=y.child,y.child=J):(m=z.last,m!==null?m.sibling=J:y.child=J,z.last=J)}return z.tail!==null?(y=z.tail,z.rendering=y,z.tail=y.sibling,z.renderingStartTime=Jn(),y.sibling=null,m=dr.current,E(dr,D?m&1|2:m&1),y):(Fr(y),null);case 22:case 23:return di(y),En(),D=y.memoizedState!==null,m!==null?m.memoizedState!==null!==D&&(y.flags|=8192):D&&(y.flags|=8192),D?C&536870912&&!(y.flags&128)&&(Fr(y),y.subtreeFlags&6&&(y.flags|=8192)):Fr(y),C=y.updateQueue,C!==null&&b0(y,C.retryQueue),C=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),D=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(D=y.memoizedState.cachePool.pool),D!==C&&(y.flags|=2048),m!==null&&v(xh),null;case 24:return C=null,m!==null&&(C=m.memoizedState.cache),y.memoizedState.cache!==C&&(y.flags|=2048),uh(Wr),Fr(y),null;case 25:return null}throw Error(r(156,y.tag))}function dn(m,y){switch(He(y),y.tag){case 1:return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 3:return uh(Wr),Le(),m=y.flags,m&65536&&!(m&128)?(y.flags=m&-65537|128,y):null;case 26:case 27:case 5:return Ce(y),null;case 13:if(di(y),m=y.memoizedState,m!==null&&m.dehydrated!==null){if(y.alternate===null)throw Error(r(340));ye()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 19:return v(dr),null;case 4:return Le(),null;case 10:return uh(y.type),null;case 22:case 23:return di(y),En(),m!==null&&v(xh),m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 24:return uh(Wr),null;case 25:return null;default:return null}}function ua(m,y){switch(He(y),y.tag){case 3:uh(Wr),Le();break;case 26:case 27:case 5:Ce(y);break;case 4:Le();break;case 13:di(y);break;case 19:v(dr);break;case 10:uh(y.type);break;case 22:case 23:di(y),En(),m!==null&&v(xh);break;case 24:uh(Wr)}}function S0(m,y){try{var C=y.updateQueue,D=C!==null?C.lastEffect:null;if(D!==null){var z=D.next;C=z;do{if((C.tag&m)===m){D=void 0;var J=C.create,Se=C.inst;D=J(),Se.destroy=D}C=C.next}while(C!==z)}}catch(ze){or(y,y.return,ze)}}function Eu(m,y,C){try{var D=y.updateQueue,z=D!==null?D.lastEffect:null;if(z!==null){var J=z.next;D=J;do{if((D.tag&m)===m){var Se=D.inst,ze=Se.destroy;if(ze!==void 0){Se.destroy=void 0,z=y;var ut=C;try{ze()}catch(Dt){or(z,ut,Dt)}}}D=D.next}while(D!==J)}}catch(Dt){or(y,y.return,Dt)}}function Yc(m){var y=m.updateQueue;if(y!==null){var C=m.stateNode;try{Vt(y,C)}catch(D){or(m,m.return,D)}}}function T0(m,y,C){C.props=ch(m.type,m.memoizedProps),C.state=m.memoizedState;try{C.componentWillUnmount()}catch(D){or(m,y,D)}}function yp(m,y){try{var C=m.ref;if(C!==null){var D=m.stateNode;switch(m.tag){case 26:case 27:case 5:var z=ff(D);break;default:z=D}typeof C=="function"?m.refCleanup=C(z):C.current=z}}catch(J){or(m,y,J)}}function xa(m,y){var C=m.ref,D=m.refCleanup;if(C!==null)if(typeof D=="function")try{D()}catch(z){or(m,y,z)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof C=="function")try{C(null)}catch(z){or(m,y,z)}else C.current=null}function fE(m){var y=m.type,C=m.memoizedProps,D=m.stateNode;try{fR(D,y,C,m)}catch(z){or(m,m.return,z)}}function fc(m,y,C){try{q0(m.stateNode,m.type,C,y,m)}catch(D){or(m,m.return,D)}}function Ts(m){return m.tag===5||m.tag===3||(ao?m.tag===26:!1)||(Ca?m.tag===27:!1)||m.tag===4}function Xs(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||Ts(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&(!Ca||m.tag!==27)&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Ii(m,y,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?Cx(C,m,y):Vy(C,m);else if(!(D===4||Ca&&D===27)&&(m=m.child,m!==null))for(Ii(m,y,C),m=m.sibling;m!==null;)Ii(m,y,C),m=m.sibling}function pc(m,y,C){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?wx(C,m,y):Wo(C,m);else if(!(D===4||Ca&&D===27)&&(m=m.child,m!==null))for(pc(m,y,C),m=m.sibling;m!==null;)pc(m,y,C),m=m.sibling}function To(m,y,C){m=m.containerInfo;try{IE(m,C)}catch(D){or(y,y.return,D)}}function _p(m,y){for(Ex(m.containerInfo),le=y;le!==null;)if(m=le,y=m.child,(m.subtreeFlags&1028)!==0&&y!==null)y.return=m,le=y;else for(;le!==null;){m=le;var C=m.alternate;switch(y=m.flags,m.tag){case 0:break;case 11:case 15:break;case 1:if(y&1024&&C!==null){y=void 0;var D=m,z=C.memoizedProps;C=C.memoizedState;var J=D.stateNode;try{var Se=ch(D.type,z,D.elementType===D.type);y=J.getSnapshotBeforeUpdate(Se,C),J.__reactInternalSnapshotBeforeUpdate=y}catch(ze){or(D,D.return,ze)}}break;case 3:y&1024&&Co&&Bm(m.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(y&1024)throw Error(r(163))}if(y=m.sibling,y!==null){y.return=m.return,le=y;break}le=m.return}return Se=xe,xe=!1,Se}function x0(m,y,C){var D=C.flags;switch(C.tag){case 0:case 11:case 15:bl(m,C),D&4&&S0(5,C);break;case 1:if(bl(m,C),D&4)if(m=C.stateNode,y===null)try{m.componentDidMount()}catch(ze){or(C,C.return,ze)}else{var z=ch(C.type,y.memoizedProps);y=y.memoizedState;try{m.componentDidUpdate(z,y,m.__reactInternalSnapshotBeforeUpdate)}catch(ze){or(C,C.return,ze)}}D&64&&Yc(C),D&512&&yp(C,C.return);break;case 3:if(bl(m,C),D&64&&(D=C.updateQueue,D!==null)){if(m=null,C.child!==null)switch(C.child.tag){case 27:case 5:m=ff(C.child.stateNode);break;case 1:m=C.child.stateNode}try{Vt(D,m)}catch(ze){or(C,C.return,ze)}}break;case 26:if(ao){bl(m,C),D&512&&yp(C,C.return);break}case 27:case 5:bl(m,C),y===null&&D&4&&fE(C),D&512&&yp(C,C.return);break;case 12:bl(m,C);break;case 13:bl(m,C),D&4&&xm(m,C);break;case 22:if(z=C.memoizedState!==null||b,!z){y=y!==null&&y.memoizedState!==null||w;var J=b,Se=w;b=z,(w=y)&&!Se?jl(m,C,(C.subtreeFlags&8772)!==0):bl(m,C),b=J,w=Se}D&512&&(C.memoizedProps.mode==="manual"?yp(C,C.return):xa(C,C.return));break;default:bl(m,C)}}function xo(m){var y=m.alternate;y!==null&&(m.alternate=null,xo(y)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(y=m.stateNode,y!==null&&hs(y)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Bt(m,y,C){for(C=C.child;C!==null;)wa(m,y,C),C=C.sibling}function wa(m,y,C){if(S&&typeof S.onCommitFiberUnmount=="function")try{S.onCommitFiberUnmount(O,C)}catch{}switch(C.tag){case 26:if(ao){w||xa(C,y),Bt(m,y,C),C.memoizedState?Xo(C.memoizedState):C.stateNode&&PE(C.stateNode);break}case 27:if(Ca){w||xa(C,y);var D=Pe,z=We;Pe=C.stateNode,Bt(m,y,C),BE(C.stateNode),Pe=D,We=z;break}case 5:w||xa(C,y);case 6:if(Co){if(D=Pe,z=We,Pe=null,Bt(m,y,C),Pe=D,We=z,Pe!==null)if(We)try{NE(Pe,C.stateNode)}catch(J){or(C,y,J)}else try{Lm(Pe,C.stateNode)}catch(J){or(C,y,J)}}else Bt(m,y,C);break;case 18:Co&&Pe!==null&&(We?yR(Pe,C.stateNode):vR(Pe,C.stateNode));break;case 4:Co?(D=Pe,z=We,Pe=C.stateNode.containerInfo,We=!0,Bt(m,y,C),Pe=D,We=z):(Nu&&To(C.stateNode,C,qy()),Bt(m,y,C));break;case 0:case 11:case 14:case 15:w||Eu(2,C,y),w||Eu(4,C,y),Bt(m,y,C);break;case 1:w||(xa(C,y),D=C.stateNode,typeof D.componentWillUnmount=="function"&&T0(C,y,D)),Bt(m,y,C);break;case 21:Bt(m,y,C);break;case 22:w||xa(C,y),w=(D=w)||C.memoizedState!==null,Bt(m,y,C),w=D;break;default:Bt(m,y,C)}}function xm(m,y){if(Sl&&y.memoizedState===null&&(m=y.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{Y0(m)}catch(C){or(y,y.return,C)}}function cf(m){switch(m.tag){case 13:case 19:var y=m.stateNode;return y===null&&(y=m.stateNode=new Q),y;case 22:return m=m.stateNode,y=m._retryCache,y===null&&(y=m._retryCache=new Q),y;default:throw Error(r(435,m.tag))}}function ld(m,y){var C=cf(m);y.forEach(function(D){var z=yx.bind(null,m,D);C.has(D)||(C.add(D),D.then(z,z))})}function ha(m,y){var C=y.deletions;if(C!==null)for(var D=0;D<C.length;D++){var z=C[D],J=m,Se=y;if(Co){var ze=Se;e:for(;ze!==null;){switch(ze.tag){case 27:case 5:Pe=ze.stateNode,We=!1;break e;case 3:Pe=ze.stateNode.containerInfo,We=!0;break e;case 4:Pe=ze.stateNode.containerInfo,We=!0;break e}ze=ze.return}if(Pe===null)throw Error(r(160));wa(J,Se,z),Pe=null,We=!1}else wa(J,Se,z);J=z.alternate,J!==null&&(J.return=null),z.return=null}if(y.subtreeFlags&13878)for(y=y.child;y!==null;)w0(y,m),y=y.sibling}function w0(m,y){var C=m.alternate,D=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ha(y,m),mc(m),D&4&&(Eu(3,m,m.return),S0(3,m),Eu(5,m,m.return));break;case 1:ha(y,m),mc(m),D&512&&(w||C===null||xa(C,C.return)),D&64&&b&&(m=m.updateQueue,m!==null&&(D=m.callbacks,D!==null&&(C=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=C===null?D:C.concat(D))));break;case 26:if(ao){var z=ct;ha(y,m),mc(m),D&512&&(w||C===null||xa(C,C.return)),D&4&&(D=C!==null?C.memoizedState:null,y=m.memoizedState,C===null?y===null?m.stateNode===null?m.stateNode=DE(z,m.type,m.memoizedProps,m):X0(z,m.type,m.stateNode):m.stateNode=Vs(z,y,m.memoizedProps):D!==y?(D===null?C.stateNode!==null&&PE(C.stateNode):Xo(D),y===null?X0(z,m.type,m.stateNode):Vs(z,y,m.memoizedProps)):y===null&&m.stateNode!==null&&fc(m,m.memoizedProps,C.memoizedProps));break}case 27:if(Ca&&D&4&&m.alternate===null){z=m.stateNode;var J=m.memoizedProps;try{Yy(z),UE(m.type,J,z,m)}catch(en){or(m,m.return,en)}}case 5:if(ha(y,m),mc(m),D&512&&(w||C===null||xa(C,C.return)),Co){if(m.flags&32){y=m.stateNode;try{$0(y)}catch(en){or(m,m.return,en)}}D&4&&m.stateNode!=null&&(y=m.memoizedProps,fc(m,y,C!==null?C.memoizedProps:y)),D&1024&&(F=!0)}break;case 6:if(ha(y,m),mc(m),D&4&&Co){if(m.stateNode===null)throw Error(r(162));D=m.memoizedProps,C=C!==null?C.memoizedProps:D,y=m.stateNode;try{OE(y,C,D)}catch(en){or(m,m.return,en)}}break;case 3:if(ao?(Ox(),z=ct,ct=vd(y.containerInfo),ha(y,m),ct=z):ha(y,m),mc(m),D&4){if(Co&&Sl&&C!==null&&C.memoizedState.isDehydrated)try{Vm(y.containerInfo)}catch(en){or(m,m.return,en)}if(Nu){D=y.containerInfo,C=y.pendingChildren;try{IE(D,C)}catch(en){or(m,m.return,en)}}}F&&(F=!1,gx(m));break;case 4:ao?(C=ct,ct=vd(m.stateNode.containerInfo),ha(y,m),mc(m),ct=C):(ha(y,m),mc(m)),D&4&&Nu&&To(m.stateNode,m,m.stateNode.pendingChildren);break;case 12:ha(y,m),mc(m);break;case 13:ha(y,m),mc(m),m.child.flags&8192&&m.memoizedState!==null!=(C!==null&&C.memoizedState!==null)&&(Zy=Jn()),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,ld(m,D)));break;case 22:D&512&&(w||C===null||xa(C,C.return)),z=m.memoizedState!==null;var Se=C!==null&&C.memoizedState!==null,ze=b,ut=w;if(b=ze||z,w=ut||Se,ha(y,m),w=ut,b=ze,mc(m),y=m.stateNode,y._current=m,y._visibility&=-3,y._visibility|=y._pendingVisibility&2,D&8192&&(y._visibility=z?y._visibility&-2:y._visibility|1,z&&(y=b||w,C===null||Se||y||bp(m)),Co&&(m.memoizedProps===null||m.memoizedProps.mode!=="manual"))){e:if(C=null,Co)for(y=m;;){if(y.tag===5||ao&&y.tag===26||Ca&&y.tag===27){if(C===null){Se=C=y;try{J=Se.stateNode,z?Jc(J):Gy(Se.stateNode,Se.memoizedProps)}catch(en){or(Se,Se.return,en)}}}else if(y.tag===6){if(C===null){Se=y;try{var Dt=Se.stateNode;z?Um(Dt):za(Dt,Se.memoizedProps)}catch(en){or(Se,Se.return,en)}}}else if((y.tag!==22&&y.tag!==23||y.memoizedState===null||y===m)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break e;for(;y.sibling===null;){if(y.return===null||y.return===m)break e;C===y&&(C=null),y=y.return}C===y&&(C=null),y.sibling.return=y.return,y=y.sibling}}D&4&&(D=m.updateQueue,D!==null&&(C=D.retryQueue,C!==null&&(D.retryQueue=null,ld(m,C))));break;case 19:ha(y,m),mc(m),D&4&&(D=m.updateQueue,D!==null&&(m.updateQueue=null,ld(m,D)));break;case 21:break;default:ha(y,m),mc(m)}}function mc(m){var y=m.flags;if(y&2){try{if(Co&&(!Ca||m.tag!==27)){e:{for(var C=m.return;C!==null;){if(Ts(C)){var D=C;break e}C=C.return}throw Error(r(160))}switch(D.tag){case 27:if(Ca){var z=D.stateNode,J=Xs(m);pc(m,J,z);break}case 5:var Se=D.stateNode;D.flags&32&&($0(Se),D.flags&=-33);var ze=Xs(m);pc(m,ze,Se);break;case 3:case 4:var ut=D.stateNode.containerInfo,Dt=Xs(m);Ii(m,Dt,ut);break;default:throw Error(r(161))}}}catch(en){or(m,m.return,en)}m.flags&=-3}y&4096&&(m.flags&=-4097)}function gx(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var y=m;gx(y),y.tag===5&&y.flags&1024&&li(y.stateNode),m=m.sibling}}function bl(m,y){if(y.subtreeFlags&8772)for(y=y.child;y!==null;)x0(m,y.alternate,y),y=y.sibling}function bp(m){for(m=m.child;m!==null;){var y=m;switch(y.tag){case 0:case 11:case 14:case 15:Eu(4,y,y.return),bp(y);break;case 1:xa(y,y.return);var C=y.stateNode;typeof C.componentWillUnmount=="function"&&T0(y,y.return,C),bp(y);break;case 26:case 27:case 5:xa(y,y.return),bp(y);break;case 22:xa(y,y.return),y.memoizedState===null&&bp(y);break;default:bp(y)}m=m.sibling}}function jl(m,y,C){for(C=C&&(y.subtreeFlags&8772)!==0,y=y.child;y!==null;){var D=y.alternate,z=m,J=y,Se=J.flags;switch(J.tag){case 0:case 11:case 15:jl(z,J,C),S0(4,J);break;case 1:if(jl(z,J,C),D=J,z=D.stateNode,typeof z.componentDidMount=="function")try{z.componentDidMount()}catch(Dt){or(D,D.return,Dt)}if(D=J,z=D.updateQueue,z!==null){var ze=D.stateNode;try{var ut=z.shared.hiddenCallbacks;if(ut!==null)for(z.shared.hiddenCallbacks=null,z=0;z<ut.length;z++)qe(ut[z],ze)}catch(Dt){or(D,D.return,Dt)}}C&&Se&64&&Yc(J),yp(J,J.return);break;case 26:case 27:case 5:jl(z,J,C),C&&D===null&&Se&4&&fE(J),yp(J,J.return);break;case 12:jl(z,J,C);break;case 13:jl(z,J,C),C&&Se&4&&xm(z,J);break;case 22:J.memoizedState===null&&jl(z,J,C),yp(J,J.return);break;default:jl(z,J,C)}y=y.sibling}}function lf(m,y){var C=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(C=m.memoizedState.cachePool.pool),m=null,y.memoizedState!==null&&y.memoizedState.cachePool!==null&&(m=y.memoizedState.cachePool.pool),m!==C&&(m!=null&&m.refCount++,C!=null&&sf(C))}function wm(m,y){m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&sf(m))}function ge(m,y,C,D){if(y.subtreeFlags&10256)for(y=y.child;y!==null;)ud(m,y,C,D),y=y.sibling}function ud(m,y,C,D){var z=y.flags;switch(y.tag){case 0:case 11:case 15:ge(m,y,C,D),z&2048&&S0(9,y);break;case 3:ge(m,y,C,D),z&2048&&(m=null,y.alternate!==null&&(m=y.alternate.memoizedState.cache),y=y.memoizedState.cache,y!==m&&(y.refCount++,m!=null&&sf(m)));break;case 12:if(z&2048){ge(m,y,C,D),m=y.stateNode;try{var J=y.memoizedProps,Se=J.id,ze=J.onPostCommit;typeof ze=="function"&&ze(Se,y.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(ut){or(y,y.return,ut)}}else ge(m,y,C,D);break;case 23:break;case 22:J=y.stateNode,y.memoizedState!==null?J._visibility&4?ge(m,y,C,D):io(m,y):J._visibility&4?ge(m,y,C,D):(J._visibility|=4,dh(m,y,C,D,(y.subtreeFlags&10256)!==0)),z&2048&&lf(y.alternate,y);break;case 24:ge(m,y,C,D),z&2048&&wm(y.alternate,y);break;default:ge(m,y,C,D)}}function dh(m,y,C,D,z){for(z=z&&(y.subtreeFlags&10256)!==0,y=y.child;y!==null;){var J=m,Se=y,ze=C,ut=D,Dt=Se.flags;switch(Se.tag){case 0:case 11:case 15:dh(J,Se,ze,ut,z),S0(8,Se);break;case 23:break;case 22:var en=Se.stateNode;Se.memoizedState!==null?en._visibility&4?dh(J,Se,ze,ut,z):io(J,Se):(en._visibility|=4,dh(J,Se,ze,ut,z)),z&&Dt&2048&&lf(Se.alternate,Se);break;case 24:dh(J,Se,ze,ut,z),z&&Dt&2048&&wm(Se.alternate,Se);break;default:dh(J,Se,ze,ut,z)}y=y.sibling}}function io(m,y){if(y.subtreeFlags&10256)for(y=y.child;y!==null;){var C=m,D=y,z=D.flags;switch(D.tag){case 22:io(C,D),z&2048&&lf(D.alternate,D);break;case 24:io(C,D),z&2048&&wm(D.alternate,D);break;default:io(C,D)}y=y.sibling}}function Bi(m){if(m.subtreeFlags&kt)for(m=m.child;m!==null;)hd(m),m=m.sibling}function hd(m){switch(m.tag){case 26:Bi(m),m.flags&kt&&(m.memoizedState!==null?bR(ct,m.memoizedState,m.memoizedProps):Hy(m.type,m.memoizedProps));break;case 5:Bi(m),m.flags&kt&&Hy(m.type,m.memoizedProps);break;case 3:case 4:if(ao){var y=ct;ct=vd(m.stateNode.containerInfo),Bi(m),ct=y}else Bi(m);break;case 22:m.memoizedState===null&&(y=m.alternate,y!==null&&y.memoizedState!==null?(y=kt,kt=16777216,Bi(m),kt=y):Bi(m));break;default:Bi(m)}}function Su(m){var y=m.alternate;if(y!==null&&(m=y.child,m!==null)){y.child=null;do y=m.sibling,m.sibling=null,m=y;while(m!==null)}}function Xc(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var C=0;C<y.length;C++){var D=y[C];le=D,Iy(D,m)}Su(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)Tu(m),m=m.sibling}function Tu(m){switch(m.tag){case 0:case 11:case 15:Xc(m),m.flags&2048&&Eu(9,m,m.return);break;case 3:Xc(m);break;case 12:Xc(m);break;case 22:var y=m.stateNode;m.memoizedState!==null&&y._visibility&4&&(m.return===null||m.return.tag!==13)?(y._visibility&=-5,gc(m)):Xc(m);break;default:Xc(m)}}function gc(m){var y=m.deletions;if(m.flags&16){if(y!==null)for(var C=0;C<y.length;C++){var D=y[C];le=D,Iy(D,m)}Su(m)}for(m=m.child;m!==null;){switch(y=m,y.tag){case 0:case 11:case 15:Eu(8,y,y.return),gc(y);break;case 22:C=y.stateNode,C._visibility&4&&(C._visibility&=-5,gc(y));break;default:gc(y)}m=m.sibling}}function Iy(m,y){for(;le!==null;){var C=le;switch(C.tag){case 0:case 11:case 15:Eu(8,C,y);break;case 23:case 22:if(C.memoizedState!==null&&C.memoizedState.cachePool!==null){var D=C.memoizedState.cachePool.pool;D!=null&&D.refCount++}break;case 24:sf(C.memoizedState.cache)}if(D=C.child,D!==null)D.return=C,le=D;else e:for(C=m;le!==null;){D=le;var z=D.sibling,J=D.return;if(xo(D),D===C){le=null;break e}if(z!==null){z.return=J,le=z;break e}le=J}}}function Vl(m){var y=V0(m);if(y!=null){if(typeof y.memoizedProps["data-testname"]!="string")throw Error(r(364));return y}if(m=G0(m),m===null)throw Error(r(362));return m.stateNode.current}function ky(m,y){var C=m.tag;switch(y.$$typeof){case Wt:if(m.type===y.value)return!0;break;case An:e:{for(y=y.value,m=[m,0],C=0;C<m.length;){var D=m[C++],z=D.tag,J=m[C++],Se=y[J];if(z!==5&&z!==26&&z!==27||!Mp(D)){for(;Se!=null&&ky(D,Se);)J++,Se=y[J];if(J===y.length){y=!0;break e}else for(D=D.child;D!==null;)m.push(D,J),D=D.sibling}}y=!1}return y;case Un:if((C===5||C===26||C===27)&&xx(m.stateNode,y.value))return!0;break;case Ut:if((C===5||C===6||C===26||C===27)&&(m=Fa(m),m!==null&&0<=m.indexOf(y.value)))return!0;break;case ni:if((C===5||C===26||C===27)&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===y.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function C0(m){switch(m.$$typeof){case Wt:return"<"+(a(m.value)||"Unknown")+">";case An:return":has("+(C0(m)||"")+")";case Un:return'[role="'+m.value+'"]';case Ut:return'"'+m.value+'"';case ni:return'[data-testname="'+m.value+'"]';default:throw Error(r(365))}}function R0(m,y){var C=[];m=[m,0];for(var D=0;D<m.length;){var z=m[D++],J=z.tag,Se=m[D++],ze=y[Se];if(J!==5&&J!==26&&J!==27||!Mp(z)){for(;ze!=null&&ky(z,ze);)Se++,ze=y[Se];if(Se===y.length)C.push(z);else for(z=z.child;z!==null;)m.push(z,Se),z=z.sibling}}return C}function uf(m,y){if(!wl)throw Error(r(363));m=Vl(m),m=R0(m,y),y=[],m=Array.from(m);for(var C=0;C<m.length;){var D=m[C++],z=D.tag;if(z===5||z===26||z===27)Mp(D)||y.push(D.stateNode);else for(D=D.child;D!==null;)m.push(D),D=D.sibling}return y}function wo(){if(Gt&2&&In!==0)return In&-In;if(vi.T!==null){var m=Tn;return m!==0?m:qt()}return Iu()}function pE(){Yl===0&&(Yl=!(In&536870912)||wt?k():536870912);var m=_s.current;return m!==null&&(m.flags|=32),Yl}function qo(m,y,C){(m===Mn&&ln===2||m.cancelPendingCommit!==null)&&(El(m,0),ls(m,In,Yl,!1)),$(m,C),(!(Gt&2)||m!==Mn)&&(m===Mn&&(!(Gt&2)&&(Wl|=C),fr===4&&ls(m,In,Yl,!1)),bt(m))}function xu(m,y,C){if(Gt&6)throw Error(r(327));var D=!C&&(y&60)===0&&(y&m.expiredLanes)===0||A(m,y),z=D?wu(m,y):O0(m,y,!0),J=D;do{if(z===0){Ds&&!D&&ls(m,y,0,!1);break}else if(z===6)ls(m,y,0,!xs);else{if(C=m.current.alternate,J&&!vc(C)){z=O0(m,y,!1),J=!1;continue}if(z===2){if(J=y,m.errorRecoveryDisabledLanes&J)var Se=0;else Se=m.pendingLanes&-536870913,Se=Se!==0?Se:Se&536870912?536870912:0;if(Se!==0){y=Se;e:{var ze=m;z=_d;var ut=Sl&&ze.current.memoizedState.isDehydrated;if(ut&&(El(ze,Se).flags|=256),Se=O0(ze,Se,!1),Se!==2){if(Ec&&!ut){ze.errorRecoveryDisabledLanes|=J,Wl|=J,z=4;break e}J=bd,bd=z,J!==null&&A0(J)}z=Se}if(J=!1,z!==2)continue}}if(z===1){El(m,0),ls(m,y,0,!0);break}e:{switch(D=m,z){case 0:case 1:throw Error(r(345));case 4:if((y&4194176)===y){ls(D,y,Yl,!xs);break e}break;case 2:bd=null;break;case 3:case 5:break;default:throw Error(r(329))}if(D.finishedWork=C,D.finishedLanes=y,(y&62914560)===y&&(J=Zy+300-Jn(),10<J)){if(ls(D,y,Yl,!xs),N(D,0)!==0)break e;D.timeoutHandle=Tx(dd.bind(null,D,C,bd,tv,Ix,y,Yl,Wl,Ip,xs,2,-0,0),J);break e}dd(D,C,bd,tv,Ix,y,Yl,Wl,Ip,xs,0,-0,0)}}break}while(!0);bt(m)}function A0(m){bd===null?bd=m:bd.push.apply(bd,m)}function dd(m,y,C,D,z,J,Se,ze,ut,Dt,en,xn,Rn){var er=y.subtreeFlags;if((er&8192||(er&16785408)===16785408)&&(CE(),hd(y),y=RE(),y!==null)){m.cancelPendingCommit=y(Am.bind(null,m,C,D,z,Se,ze,ut,1,xn,Rn)),ls(m,J,Se,!Dt);return}Am(m,C,D,z,Se,ze,ut,en,xn,Rn)}function vc(m){for(var y=m;;){var C=y.tag;if((C===0||C===11||C===15)&&y.flags&16384&&(C=y.updateQueue,C!==null&&(C=C.stores,C!==null)))for(var D=0;D<C.length;D++){var z=C[D],J=z.getSnapshot;z=z.value;try{if(!R(J(),z))return!1}catch{return!1}}if(C=y.child,y.subtreeFlags&16384&&C!==null)C.return=y,y=C;else{if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function ls(m,y,C,D){y&=~Jy,y&=~Wl,m.suspendedLanes|=y,m.pingedLanes&=~y,D&&(m.warmLanes|=y),D=m.expirationTimes;for(var z=y;0<z;){var J=31-Jo(z),Se=1<<J;D[J]=-1,z&=~Se}C!==0&&G(m,C,y)}function Dy(){return Gt&6?!0:(be(0),!1)}function hf(){if(on!==null){if(ln===0)var m=on.return;else m=on,Cl=Uu=null,vu(m),hr=null,$r=0,m=on;for(;m!==null;)ua(m.alternate,m),m=m.return;on=null}}function El(m,y){m.finishedWork=null,m.finishedLanes=0;var C=m.timeoutHandle;C!==j0&&(m.timeoutHandle=j0,zy(C)),C=m.cancelPendingCommit,C!==null&&(m.cancelPendingCommit=null,C()),hf(),Mn=m,on=C=fh(m.current,null),In=y,ln=0,Fn=null,xs=!1,Ds=A(m,y),Ec=!1,Ip=Yl=Jy=Wl=Sc=fr=0,bd=_d=null,Ix=!1,y&8&&(y|=y&32);var D=m.entangledLanes;if(D!==0)for(m=m.entanglements,D&=y;0<D;){var z=31-Jo(D),J=1<<z;y|=m[z],D&=~J}return kr=y,fe(),C}function M0(m,y){Zn=null,vi.H=Aa,y===Zr?(y=Ve(),ln=3):y===ds?(y=Ve(),ln=4):ln=y===Np?8:y!==null&&typeof y=="object"&&typeof y.then=="function"?6:1,Fn=y,on===null&&(fr=1,ym(m,ee(y,m.current)))}function mE(){var m=_s.current;return m===null?!0:(In&4194176)===In?ks===null:(In&62914560)===In||In&536870912?m===ks:!1}function Cm(){var m=vi.H;return vi.H=Aa,m===null?Aa:m}function Rm(){var m=vi.A;return vi.A=Lt,m}function Ba(){fr=4,xs||(In&4194176)!==In&&_s.current!==null||(Ds=!0),!(Sc&134217727)&&!(Wl&134217727)||Mn===null||ls(Mn,In,Yl,!1)}function O0(m,y,C){var D=Gt;Gt|=2;var z=Cm(),J=Rm();(Mn!==m||In!==y)&&(tv=null,El(m,y)),y=!1;var Se=fr;e:do try{if(ln!==0&&on!==null){var ze=on,ut=Fn;switch(ln){case 8:hf(),Se=6;break e;case 3:case 2:case 6:_s.current===null&&(y=!0);var Dt=ln;if(ln=0,Fn=null,Gl(m,ze,ut,Dt),C&&Ds){Se=0;break e}break;default:Dt=ln,ln=0,Fn=null,Gl(m,ze,ut,Dt)}}gE(),Se=fr;break}catch(en){M0(m,en)}while(!0);return y&&m.shellSuspendCounter++,Cl=Uu=null,Gt=D,vi.H=z,vi.A=J,on===null&&(Mn=null,In=0,fe()),Se}function gE(){for(;on!==null;)Cu(on)}function wu(m,y){var C=Gt;Gt|=2;var D=Cm(),z=Rm();Mn!==m||In!==y?(tv=null,ev=Jn()+500,El(m,y)):Ds=A(m,y);e:do try{if(ln!==0&&on!==null){y=on;var J=Fn;t:switch(ln){case 1:ln=0,Fn=null,Gl(m,y,J,1);break;case 2:if(Pt(J)){ln=0,Fn=null,js(y);break}y=function(){ln===2&&Mn===m&&(ln=7),bt(m)},J.then(y,y);break e;case 3:ln=7;break e;case 4:ln=5;break e;case 7:Pt(J)?(ln=0,Fn=null,js(y)):(ln=0,Fn=null,Gl(m,y,J,7));break;case 5:var Se=null;switch(on.tag){case 26:Se=on.memoizedState;case 5:case 27:var ze=on,ut=ze.type,Dt=ze.pendingProps;if(Se?LE(Se):ku(ut,Dt)){ln=0,Fn=null;var en=ze.sibling;if(en!==null)on=en;else{var xn=ze.return;xn!==null?(on=xn,da(xn)):on=null}break t}}ln=0,Fn=null,Gl(m,y,J,5);break;case 6:ln=0,Fn=null,Gl(m,y,J,6);break;case 8:hf(),fr=6;break e;default:throw Error(r(462))}}vE();break}catch(Rn){M0(m,Rn)}while(!0);return Cl=Uu=null,vi.H=D,vi.A=z,Gt=C,on!==null?0:(Mn=null,In=0,fe(),fr)}function vE(){for(;on!==null&&!SR();)Cu(on)}function Cu(m){var y=Ji(m.alternate,m,kr);m.memoizedProps=m.pendingProps,y===null?da(m):on=y}function js(m){var y=m,C=y.alternate;switch(y.tag){case 15:case 0:y=bm(C,y,y.pendingProps,y.type,void 0,In);break;case 11:y=bm(C,y,y.pendingProps,y.type.render,y.ref,In);break;case 5:vu(y);default:ua(C,y),y=on=D0(y,kr),y=Ji(C,y,kr)}m.memoizedProps=m.pendingProps,y===null?da(m):on=y}function Gl(m,y,C,D){Cl=Uu=null,vu(y),hr=null,$r=0;var z=y.return;try{if(hx(m,z,y,C,In)){fr=1,ym(m,ee(C,m.current)),on=null;return}}catch(J){if(z!==null)throw on=z,J;fr=1,ym(m,ee(C,m.current)),on=null;return}y.flags&32768?(wt||D===1?m=!0:Ds||In&536870912?m=!1:(xs=m=!0,(D===2||D===3||D===6)&&(D=_s.current,D!==null&&D.tag===13&&(D.flags|=16384))),zr(y,m)):da(y)}function da(m){var y=m;do{if(y.flags&32768){zr(y,xs);return}m=y.return;var C=E0(y.alternate,y,kr);if(C!==null){on=C;return}if(y=y.sibling,y!==null){on=y;return}on=y=m}while(y!==null);fr===0&&(fr=5)}function zr(m,y){do{var C=dn(m.alternate,m);if(C!==null){C.flags&=32767,on=C;return}if(C=m.return,C!==null&&(C.flags|=32768,C.subtreeFlags=0,C.deletions=null),!y&&(m=m.sibling,m!==null)){on=m;return}on=m=C}while(m!==null);fr=6,on=null}function Am(m,y,C,D,z,J,Se,ze,ut,Dt){var en=vi.T,xn=so();try{$o(2),vi.T=null,Mm(m,y,C,D,xn,z,J,Se,ze,ut,Dt)}finally{vi.T=en,$o(xn)}}function Mm(m,y,C,D,z,J,Se,ze){do yc();while(yf!==null);if(Gt&6)throw Error(r(327));var ut=m.finishedWork;if(D=m.finishedLanes,ut===null)return null;if(m.finishedWork=null,m.finishedLanes=0,ut===m.current)throw Error(r(177));m.callbackNode=null,m.callbackPriority=0,m.cancelPendingCommit=null;var Dt=ut.lanes|ut.childLanes;if(Dt|=Fi,q(m,D,Dt,J,Se,ze),m===Mn&&(on=Mn=null,In=0),!(ut.subtreeFlags&10256)&&!(ut.flags&10256)||HE||(HE=!0,az=Dt,oz=C,Ly(Is,function(){return yc(),null})),C=(ut.flags&15990)!==0,ut.subtreeFlags&15990||C?(C=vi.T,vi.T=null,J=so(),$o(2),Se=Gt,Gt|=4,_p(m,ut),w0(ut,m),Sx(m.containerInfo),m.current=ut,x0(m,ut.alternate,ut),Hr(),Gt=Se,$o(J),vi.T=C):m.current=ut,HE?(HE=!1,yf=m,$m=D):Py(m,Dt),Dt=m.pendingLanes,Dt===0&&(Ed=null),V(ut.stateNode),bt(m),y!==null)for(z=m.onRecoverableError,ut=0;ut<y.length;ut++)Dt=y[ut],z(Dt.value,{componentStack:Dt.stack});return $m&3&&yc(),Dt=m.pendingLanes,D&4194218&&Dt&42?m===cz?TR++:(TR=0,cz=m):TR=0,be(0),null}function Py(m,y){(m.pooledCacheLanes&=y)===0&&(y=m.pooledCache,y!=null&&(m.pooledCache=null,sf(y)))}function yc(){if(yf!==null){var m=yf,y=az;az=0;var C=ie($m),D=32>C?32:C;C=vi.T;var z=so();try{if($o(D),vi.T=null,yf===null)var J=!1;else{D=oz,oz=null;var Se=yf,ze=$m;if(yf=null,$m=0,Gt&6)throw Error(r(331));var ut=Gt;if(Gt|=4,Tu(Se.current),ud(Se,Se.current,ze,D),Gt=ut,be(0,!1),S&&typeof S.onPostCommitFiberRoot=="function")try{S.onPostCommitFiberRoot(O,Se)}catch{}J=!0}return J}finally{$o(z),vi.T=C,Py(m,y)}}return!1}function N0(m,y,C){y=ee(C,y),y=hc(m.stateNode,y,2),m=De(m,y,2),m!==null&&($(m,2),bt(m))}function or(m,y,C){if(m.tag===3)N0(m,m,C);else for(;y!==null;){if(y.tag===3){N0(y,m,C);break}else if(y.tag===1){var D=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Ed===null||!Ed.has(D))){m=ee(C,m),C=Ms(2),D=De(y,C,2),D!==null&&(ad(C,D,y,m),$(D,2),bt(D));break}}y=y.return}}function I0(m,y,C){var D=m.pingCache;if(D===null){D=m.pingCache=new mi;var z=new Set;D.set(y,z)}else z=D.get(y),z===void 0&&(z=new Set,D.set(y,z));z.has(C)||(Ec=!0,z.add(C),m=vx.bind(null,m,y,C),y.then(m,m))}function vx(m,y,C){var D=m.pingCache;D!==null&&D.delete(y),m.pingedLanes|=m.suspendedLanes&C,m.warmLanes&=~C,Mn===m&&(In&C)===C&&(fr===4||fr===3&&(In&62914560)===In&&300>Jn()-Zy?!(Gt&2)&&El(m,0):Jy|=C,Ip===In&&(Ip=0)),bt(m)}function yE(m,y){y===0&&(y=L()),m=it(m,y),m!==null&&($(m,y),bt(m))}function _E(m){var y=m.memoizedState,C=0;y!==null&&(C=y.retryLane),yE(m,C)}function yx(m,y){var C=0;switch(m.tag){case 13:var D=m.stateNode,z=m.memoizedState;z!==null&&(C=z.retryLane);break;case 19:D=m.stateNode;break;case 22:D=m.stateNode._retryCache;break;default:throw Error(r(314))}D!==null&&D.delete(y),yE(m,C)}function Ly(m,y){return Ns(m,y)}function Ru(m,y,C,D){this.tag=m,this.key=C,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function k0(m){return m=m.prototype,!(!m||!m.isReactComponent)}function fh(m,y){var C=m.alternate;return C===null?(C=n(m.tag,y,m.key,m.mode),C.elementType=m.elementType,C.type=m.type,C.stateNode=m.stateNode,C.alternate=m,m.alternate=C):(C.pendingProps=y,C.type=m.type,C.flags=0,C.subtreeFlags=0,C.deletions=null),C.flags=m.flags&31457280,C.childLanes=m.childLanes,C.lanes=m.lanes,C.child=m.child,C.memoizedProps=m.memoizedProps,C.memoizedState=m.memoizedState,C.updateQueue=m.updateQueue,y=m.dependencies,C.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},C.sibling=m.sibling,C.index=m.index,C.ref=m.ref,C.refCleanup=m.refCleanup,C}function D0(m,y){m.flags&=31457282;var C=m.alternate;return C===null?(m.childLanes=0,m.lanes=y,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=C.childLanes,m.lanes=C.lanes,m.child=C.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=C.memoizedProps,m.memoizedState=C.memoizedState,m.updateQueue=C.updateQueue,m.type=C.type,y=C.dependencies,m.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext}),m}function P0(m,y,C,D,z,J){var Se=0;if(D=m,typeof m=="function")k0(m)&&(Se=1);else if(typeof m=="string")Se=ao&&Ca?_h(m,C,Ne.current)?26:FE(m)?27:5:ao?_h(m,C,Ne.current)?26:5:Ca&&FE(m)?27:5;else e:switch(m){case mh:return df(C.children,z,J,y);case Kc:Se=8,z|=24;break;case gh:return m=n(12,C,y,z|2),m.elementType=gh,m.lanes=J,m;case B0:return m=n(13,C,y,z),m.elementType=B0,m.lanes=J,m;case wp:return m=n(19,C,y,z),m.elementType=wp,m.lanes=J,m;case vh:return bE(C,z,J,y);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case xp:case Au:Se=10;break e;case SE:Se=9;break e;case Im:Se=11;break e;case F0:Se=14;break e;case Mu:Se=16,D=null;break e}Se=29,C=Error(r(130,m===null?"null":typeof m,"")),D=null}return y=n(Se,C,y,z),y.elementType=m,y.type=D,y.lanes=J,y}function df(m,y,C,D){return m=n(7,m,D,y),m.lanes=C,m}function bE(m,y,C,D){m=n(22,m,D,y),m.elementType=vh,m.lanes=C;var z={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var J=z._current;if(J===null)throw Error(r(456));if(!(z._pendingVisibility&2)){var Se=it(J,2);Se!==null&&(z._pendingVisibility|=2,qo(Se,J,2))}},attach:function(){var J=z._current;if(J===null)throw Error(r(456));if(z._pendingVisibility&2){var Se=it(J,2);Se!==null&&(z._pendingVisibility&=-3,qo(Se,J,2))}}};return m.stateNode=z,m}function L0(m,y,C){return m=n(6,m,null,y),m.lanes=C,m}function Uy(m,y,C){return y=n(4,m.children!==null?m.children:[],m.key,y),y.lanes=C,y.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},y}function EE(m,y,C,D,z,J,Se,ze){this.tag=1,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=j0,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=U(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=U(0),this.hiddenUpdates=U(null),this.identifierPrefix=D,this.onUncaughtError=z,this.onCaughtError=J,this.onRecoverableError=Se,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ze,this.incompleteTransitions=new Map}function By(m,y,C,D,z,J,Se,ze,ut,Dt,en,xn){return m=new EE(m,y,C,Se,ze,ut,Dt,xn),y=1,J===!0&&(y|=24),J=n(3,null,null,y),m.current=J,J.stateNode=m,y=Oy(),y.refCount++,m.pooledCache=y,y.refCount++,J.memoizedState={element:D,isDehydrated:C,cache:y},j(J),m}function qi(m){return m?(m=Ko,m):Ko}function U0(m){var y=m._reactInternals;if(y===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=f(y),m=m!==null?p(m):null,m===null?null:ff(m.stateNode)}function _x(m,y,C,D,z,J){z=qi(z),D.context===null?D.context=z:D.pendingContext=z,D=me(y),D.payload={element:C},J=J===void 0?null:J,J!==null&&(D.callback=J),C=De(m,D,y),C!==null&&(qo(C,m,y),je(C,m,y))}function Om(m,y){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var C=m.retryLane;m.retryLane=C!==0&&C<y?C:y}}function fd(m,y){Om(m,y),(m=m.alternate)&&Om(m,y)}var Vi={},Ep=Be,us=jj,ph=Object.assign,Sp=Symbol.for("react.element"),Nm=Symbol.for("react.transitional.element"),Tp=Symbol.for("react.portal"),mh=Symbol.for("react.fragment"),Kc=Symbol.for("react.strict_mode"),gh=Symbol.for("react.profiler"),xp=Symbol.for("react.provider"),SE=Symbol.for("react.consumer"),Au=Symbol.for("react.context"),Im=Symbol.for("react.forward_ref"),B0=Symbol.for("react.suspense"),wp=Symbol.for("react.suspense_list"),F0=Symbol.for("react.memo"),Mu=Symbol.for("react.lazy"),vh=Symbol.for("react.offscreen"),hR=Symbol.for("react.memo_cache_sentinel"),ro=Symbol.iterator,TE=Symbol.for("react.client.reference"),vi=Ep.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,km,Fy,Cp=!1,pd=Array.isArray,z0=e.rendererVersion,_c=e.rendererPackageName,Ou=e.extraDevToolsConfig,ff=e.getPublicInstance,Dm=e.getRootHostContext,bx=e.getChildHostContext,Ex=e.prepareForCommit,Sx=e.resetAfterCommit,Rp=e.createInstance,Ap=e.appendInitialChild,xE=e.finalizeInitialChildren,Pm=e.shouldSetTextContent,H0=e.createTextInstance,Tx=e.scheduleTimeout,zy=e.cancelTimeout,j0=e.noTimeout,ql=e.isPrimaryRenderer;e.warnsIfNotActing;var Co=e.supportsMutation,Nu=e.supportsPersistence,Sl=e.supportsHydration,V0=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var dR=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var $o=e.setCurrentUpdatePriority,so=e.getCurrentUpdatePriority,Iu=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Tl=e.shouldAttemptEagerTransition,hs=e.detachDeletedInstance;e.requestPostPaintCallback;var wE=e.maySuspendCommit,ku=e.preloadInstance,CE=e.startSuspendingCommit,Hy=e.suspendInstance,RE=e.waitForCommitToBeReady,md=e.NotPendingTransition,xl=e.HostTransitionContext,li=e.resetFormInstance;e.bindToConsole;var jy=e.supportsMicrotasks,ti=e.scheduleMicrotask,wl=e.supportsTestSelectors,G0=e.findFiberRoot,AE=e.getBoundingRect,Fa=e.getTextContent,Mp=e.isHiddenSubtree,xx=e.matchAccessibilityRole,ME=e.setFocusIfFocusable,Os=e.setupIntersectionObserver,Wo=e.appendChild,Vy=e.appendChildToContainer,OE=e.commitTextUpdate,fR=e.commitMount,q0=e.commitUpdate,wx=e.insertBefore,Cx=e.insertInContainerBefore,Lm=e.removeChild,NE=e.removeChildFromContainer,$0=e.resetTextContent,Jc=e.hideInstance,Um=e.hideTextInstance,Gy=e.unhideInstance,za=e.unhideTextInstance,Bm=e.clearContainer,W0=e.cloneInstance,qy=e.createContainerChildSet,Du=e.appendChildToContainerChildSet,Op=e.finalizeContainerChildren,IE=e.replaceContainerChildren,Fm=e.cloneHiddenInstance,Ha=e.cloneHiddenTextInstance,zm=e.isSuspenseInstancePending,fa=e.isSuspenseInstanceFallback,yh=e.getSuspenseInstanceFallbackErrorDetails,Rx=e.registerSuspenseInstanceRetry,Hm=e.canHydrateFormStateMarker,$y=e.isFormStateMarkerMatching,Yo=e.getNextHydratableSibling,Ro=e.getFirstHydratableChild,Ao=e.getFirstHydratableChildWithinContainer,kE=e.getFirstHydratableChildWithinSuspenseInstance,Ax=e.canHydrateInstance,gd=e.canHydrateTextInstance,br=e.canHydrateSuspenseInstance,pR=e.hydrateInstance,mR=e.hydrateTextInstance,gR=e.hydrateSuspenseInstance,jm=e.getNextHydratableInstanceAfterSuspenseInstance,Vm=e.commitHydratedContainer,Y0=e.commitHydratedSuspenseInstance,vR=e.clearSuspenseBoundary,yR=e.clearSuspenseBoundaryFromContainer,Mx=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var Pu=e.validateHydratableInstance,Lu=e.validateHydratableTextInstance,ao=e.supportsResources,_h=e.isHostHoistableType,vd=e.getHoistableRoot,bh=e.getResource,Vs=e.acquireResource,Xo=e.releaseResource,DE=e.hydrateHoistable,X0=e.mountHoistable,PE=e.unmountHoistable,_R=e.createHoistableInstance,Ox=e.prepareToCommitHoistables,Wy=e.mayResourceSuspendCommit,LE=e.preloadResource,bR=e.suspendResource,Ca=e.supportsSingletons,Gm=e.resolveSingletonInstance,Yy=e.clearSingleton,UE=e.acquireSingletonInstance,BE=e.releaseSingletonInstance,FE=e.isHostSingletonType,oo=[],pf=-1,Ko={},Jo=Math.clz32?Math.clz32:T,ER=Math.log,Xy=Math.LN2,K0=128,ja=4194304,Ns=us.unstable_scheduleCallback,Eh=us.unstable_cancelCallback,SR=us.unstable_shouldYield,Hr=us.unstable_requestPaint,Jn=us.unstable_now,Nx=us.unstable_ImmediatePriority,co=us.unstable_UserBlockingPriority,Is=us.unstable_NormalPriority,mf=us.unstable_IdlePriority,qm=us.log,zE=us.unstable_setDisableYieldValue,O=null,S=null,R=typeof Object.is=="function"?Object.is:Y,M=new WeakMap,P=[],B=0,H=null,te=0,re=[],K=0,se=null,he=1,pe="",Ne=_(null),Je=_(null),Ye=_(null),Oe=_(null),_e=null,lt=null,wt=!1,Kt=null,It=!1,Xn=Error(r(519)),wn=[],yi=0,Fi=0,ki=null,xi=null,_i=!1,Ri=!1,Di=!1,bi=0,Ai=null,ui=0,Tn=0,$n=null,$i=!1,Jr=!1,ys=Object.prototype.hasOwnProperty,Zr=Error(r(460)),ds=Error(r(474)),Qr={then:function(){}},Ir=null,hr=null,$r=0,es=sr(!0),fs=sr(!1),Ks=_(null),pa=_(0),_s=_(null),ks=null,dr=_(0),Ra=0,Zn=null,Gi=null,Mr=null,Va=!1,Mo=!1,bc=!1,Zc=0,ps=0,Zo=null,Sh=0,$l=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Aa={readContext:Ua,use:yt,useCallback:ei,useContext:ei,useEffect:ei,useImperativeHandle:ei,useLayoutEffect:ei,useInsertionEffect:ei,useMemo:ei,useReducer:ei,useRef:ei,useState:ei,useDebugValue:ei,useDeferredValue:ei,useTransition:ei,useSyncExternalStore:ei,useId:ei};Aa.useCacheRefresh=ei,Aa.useMemoCache=ei,Aa.useHostTransitionStatus=ei,Aa.useFormState=ei,Aa.useActionState=ei,Aa.useOptimistic=ei;var lo={readContext:Ua,use:yt,useCallback:function(m,y){return ve().memoizedState=[m,y===void 0?null:y],m},useContext:Ua,useEffect:ah,useImperativeHandle:function(m,y,C){C=C!=null?C.concat([m]):null,gp(4194308,4,jo.bind(null,y,m),C)},useLayoutEffect:function(m,y){return gp(4194308,4,m,y)},useInsertionEffect:function(m,y){gp(4,2,m,y)},useMemo:function(m,y){var C=ve();y=y===void 0?null:y;var D=m();if(bc){Z(!0);try{m()}finally{Z(!1)}}return C.memoizedState=[D,y],D},useReducer:function(m,y,C){var D=ve();if(C!==void 0){var z=C(y);if(bc){Z(!0);try{C(y)}finally{Z(!1)}}}else z=y;return D.memoizedState=D.baseState=z,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:z},D.queue=m,m=m.dispatch=ux.bind(null,Zn,m),[D.memoizedState,m]},useRef:function(m){var y=ve();return m={current:m},y.memoizedState=m},useState:function(m){m=vs(m);var y=m.queue,C=oE.bind(null,Zn,y);return y.dispatch=C,[m.memoizedState,C]},useDebugValue:Vo,useDeferredValue:function(m,y){var C=ve();return yu(C,m,y)},useTransition:function(){var m=vs(!1);return m=sd.bind(null,Zn,m.queue,!0,!1),ve().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,y,C){var D=Zn,z=ve();if(wt){if(C===void 0)throw Error(r(407));C=C()}else{if(C=y(),Mn===null)throw Error(r(349));In&60||ci(D,y,C)}z.memoizedState=C;var J={value:C,getSnapshot:y};return z.queue=J,ah(gi.bind(null,D,J,m),[m]),D.flags|=2048,_l(9,Cn.bind(null,D,J,C,y),{destroy:void 0},null),C},useId:function(){var m=ve(),y=Mn.identifierPrefix;if(wt){var C=pe,D=he;C=(D&~(1<<32-Jo(D)-1)).toString(32)+C,y=":"+y+"R"+C,C=Zc++,0<C&&(y+="H"+C.toString(32)),y+=":"}else C=Sh++,y=":"+y+"r"+C.toString(32)+":";return m.memoizedState=y},useCacheRefresh:function(){return ve().memoizedState=Ry.bind(null,Zn)}};lo.useMemoCache=Ze,lo.useHostTransitionStatus=oh,lo.useFormState=cs,lo.useActionState=cs,lo.useOptimistic=function(m){var y=ve();y.memoizedState=y.baseState=m;var C={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return y.queue=C,y=nf.bind(null,Zn,!0,C),C.dispatch=y,[m,y]};var Oo={readContext:Ua,use:yt,useCallback:lx,useContext:Ua,useEffect:h0,useImperativeHandle:f0,useInsertionEffect:wy,useLayoutEffect:d0,useMemo:sE,useReducer:nn,useRef:oa,useState:function(){return nn(Ht)},useDebugValue:Vo,useDeferredValue:function(m,y){var C=Ke();return vm(C,Gi.memoizedState,m,y)},useTransition:function(){var m=nn(Ht)[0],y=Ke().memoizedState;return[typeof m=="boolean"?m:vt(m),y]},useSyncExternalStore:oi,useId:Cy};Oo.useCacheRefresh=aE,Oo.useMemoCache=Ze,Oo.useHostTransitionStatus=oh,Oo.useFormState=bn,Oo.useActionState=bn,Oo.useOptimistic=function(m,y){var C=Ke();return Ki(C,Gi,m,y)};var Qo={readContext:Ua,use:yt,useCallback:lx,useContext:Ua,useEffect:h0,useImperativeHandle:f0,useInsertionEffect:wy,useLayoutEffect:d0,useMemo:sE,useReducer:Sn,useRef:oa,useState:function(){return Sn(Ht)},useDebugValue:Vo,useDeferredValue:function(m,y){var C=Ke();return Gi===null?yu(C,m,y):vm(C,Gi.memoizedState,m,y)},useTransition:function(){var m=Sn(Ht)[0],y=Ke().memoizedState;return[typeof m=="boolean"?m:vt(m),y]},useSyncExternalStore:oi,useId:Cy};Qo.useCacheRefresh=aE,Qo.useMemoCache=Ze,Qo.useHostTransitionStatus=oh,Qo.useFormState=qn,Qo.useActionState=qn,Qo.useOptimistic=function(m,y){var C=Ke();return Gi!==null?Ki(C,Gi,m,y):(C.baseState=m,[m,C.queue.dispatch])};var gf={isMounted:function(m){return(m=m._reactInternals)?h(m)===m:!1},enqueueSetState:function(m,y,C){m=m._reactInternals;var D=wo(),z=me(D);z.payload=y,C!=null&&(z.callback=C),y=De(m,z,D),y!==null&&(qo(y,m,D),je(y,m,D))},enqueueReplaceState:function(m,y,C){m=m._reactInternals;var D=wo(),z=me(D);z.tag=1,z.payload=y,C!=null&&(z.callback=C),y=De(m,z,D),y!==null&&(qo(y,m,D),je(y,m,D))},enqueueForceUpdate:function(m,y){m=m._reactInternals;var C=wo(),D=me(C);D.tag=2,y!=null&&(D.callback=y),y=De(m,D,C),y!==null&&(qo(y,m,C),je(y,m,C))}},vf=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var y=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(y))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",m);return}console.error(m)},Np=Error(r(461)),Gs=!1,yd={dehydrated:null,treeContext:null,retryLane:0},Th=_(null),Uu=null,Cl=null,J0=typeof AbortController<"u"?AbortController:function(){var m=[],y=this.signal={aborted:!1,addEventListener:function(C,D){m.push(D)}};this.abort=function(){y.aborted=!0,m.forEach(function(C){return C()})}},Ky=us.unstable_scheduleCallback,Z0=us.unstable_NormalPriority,Wr={$$typeof:Au,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},Q0=vi.S;vi.S=function(m,y){typeof y=="object"&&y!==null&&typeof y.then=="function"&&Mt(m,y),Q0!==null&&Q0(m,y)};var xh=_(null),b=!1,w=!1,F=!1,Q=typeof WeakSet=="function"?WeakSet:Set,le=null,xe=!1,Pe=null,We=!1,ct=null,kt=8192,Lt={getCacheForType:function(m){var y=Ua(Wr),C=y.data.get(m);return C===void 0&&(C=m(),y.data.set(m,C)),C}},Wt=0,An=1,Un=2,ni=3,Ut=4;if(typeof Symbol=="function"&&Symbol.for){var Zt=Symbol.for;Wt=Zt("selector.component"),An=Zt("selector.has_pseudo_class"),Un=Zt("selector.role"),ni=Zt("selector.test_id"),Ut=Zt("selector.text")}var mi=typeof WeakMap=="function"?WeakMap:Map,Gt=0,Mn=null,on=null,In=0,ln=0,Fn=null,xs=!1,Ds=!1,Ec=!1,kr=0,fr=0,Sc=0,Wl=0,Jy=0,Yl=0,Ip=0,_d=null,bd=null,Ix=!1,Zy=0,ev=1/0,tv=null,Ed=null,HE=!1,yf=null,$m=0,az=0,oz=null,TR=0,cz=null;return Vi.attemptContinuousHydration=function(m){if(m.tag===13){var y=it(m,67108864);y!==null&&qo(y,m,67108864),fd(m,67108864)}},Vi.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var y=wo(),C=it(m,y);C!==null&&qo(C,m,y),fd(m,y)}},Vi.attemptSynchronousHydration=function(m){switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var y=x(m.pendingLanes);if(y!==0){for(m.pendingLanes|=2,m.entangledLanes|=2;y;){var C=1<<31-Jo(y);m.entanglements[1]|=C,y&=~C}bt(m),!(Gt&6)&&(ev=Jn()+500,be(0))}}break;case 13:y=it(m,2),y!==null&&qo(y,m,2),Dy(),fd(m,2)}},Vi.batchedUpdates=function(m,y){return m(y)},Vi.createComponentSelector=function(m){return{$$typeof:Wt,value:m}},Vi.createContainer=function(m,y,C,D,z,J,Se,ze,ut,Dt){return By(m,y,!1,null,C,D,J,Se,ze,ut,Dt,null)},Vi.createHasPseudoClassSelector=function(m){return{$$typeof:An,value:m}},Vi.createHydrationContainer=function(m,y,C,D,z,J,Se,ze,ut,Dt,en,xn,Rn){return m=By(C,D,!0,m,z,J,ze,ut,Dt,en,xn,Rn),m.context=qi(null),C=m.current,D=wo(),z=me(D),z.callback=y??null,De(C,z,D),m.current.lanes=D,$(m,D),bt(m),m},Vi.createPortal=function(m,y,C){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Tp,key:D==null?null:""+D,children:m,containerInfo:y,implementation:C}},Vi.createRoleSelector=function(m){return{$$typeof:Un,value:m}},Vi.createTestNameSelector=function(m){return{$$typeof:ni,value:m}},Vi.createTextSelector=function(m){return{$$typeof:Ut,value:m}},Vi.defaultOnCaughtError=function(m){console.error(m)},Vi.defaultOnRecoverableError=function(m){vf(m)},Vi.defaultOnUncaughtError=function(m){vf(m)},Vi.deferredUpdates=function(m){var y=vi.T,C=so();try{return $o(32),vi.T=null,m()}finally{$o(C),vi.T=y}},Vi.discreteUpdates=function(m,y,C,D,z){var J=vi.T,Se=so();try{return $o(2),vi.T=null,m(y,C,D,z)}finally{$o(Se),vi.T=J,Gt===0&&(ev=Jn()+500)}},Vi.findAllNodes=uf,Vi.findBoundingRects=function(m,y){if(!wl)throw Error(r(363));y=uf(m,y),m=[];for(var C=0;C<y.length;C++)m.push(AE(y[C]));for(y=m.length-1;0<y;y--){C=m[y];for(var D=C.x,z=D+C.width,J=C.y,Se=J+C.height,ze=y-1;0<=ze;ze--)if(y!==ze){var ut=m[ze],Dt=ut.x,en=Dt+ut.width,xn=ut.y,Rn=xn+ut.height;if(D>=Dt&&J>=xn&&z<=en&&Se<=Rn){m.splice(y,1);break}else if(D!==Dt||C.width!==ut.width||Rn<J||xn>Se){if(!(J!==xn||C.height!==ut.height||en<D||Dt>z)){Dt>D&&(ut.width+=Dt-D,ut.x=D),en<z&&(ut.width=z-Dt),m.splice(y,1);break}}else{xn>J&&(ut.height+=xn-J,ut.y=J),Rn<Se&&(ut.height=Se-xn),m.splice(y,1);break}}}return m},Vi.findHostInstance=U0,Vi.findHostInstanceWithNoPortals=function(m){return m=f(m),m=m!==null?g(m):null,m===null?null:ff(m.stateNode)},Vi.findHostInstanceWithWarning=function(m){return U0(m)},Vi.flushPassiveEffects=yc,Vi.flushSyncFromReconciler=function(m){var y=Gt;Gt|=1;var C=vi.T,D=so();try{if($o(2),vi.T=null,m)return m()}finally{$o(D),vi.T=C,Gt=y,!(Gt&6)&&be(0)}},Vi.flushSyncWork=Dy,Vi.focusWithin=function(m,y){if(!wl)throw Error(r(363));for(m=Vl(m),y=R0(m,y),y=Array.from(y),m=0;m<y.length;){var C=y[m++],D=C.tag;if(!Mp(C)){if((D===5||D===26||D===27)&&ME(C.stateNode))return!0;for(C=C.child;C!==null;)y.push(C),C=C.sibling}}return!1},Vi.getFindAllNodesFailureDescription=function(m,y){if(!wl)throw Error(r(363));var C=0,D=[];m=[Vl(m),0];for(var z=0;z<m.length;){var J=m[z++],Se=J.tag,ze=m[z++],ut=y[ze];if((Se!==5&&Se!==26&&Se!==27||!Mp(J))&&(ky(J,ut)&&(D.push(C0(ut)),ze++,ze>C&&(C=ze)),ze<y.length))for(J=J.child;J!==null;)m.push(J,ze),J=J.sibling}if(C<y.length){for(m=[];C<y.length;C++)m.push(C0(y[C]));return`findAllNodes was able to match part of the selector:
  `+(D.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},Vi.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 27:case 5:return ff(m.child.stateNode);default:return m.child.stateNode}},Vi.injectIntoDevTools=function(){var m={bundleType:0,version:z0,rendererPackageName:_c,currentDispatcherRef:vi,findFiberByHostInstance:V0,reconcilerVersion:"19.0.0"};if(Ou!==null&&(m.rendererConfig=Ou),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var y=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(y.isDisabled||!y.supportsFiber)m=!0;else{try{O=y.inject(m),S=y}catch{}m=!!y.checkDCE}}return m},Vi.isAlreadyRendering=function(){return!1},Vi.observeVisibleRects=function(m,y,C,D){if(!wl)throw Error(r(363));m=uf(m,y);var z=Os(m,C,D).disconnect;return{disconnect:function(){z()}}},Vi.shouldError=function(){return null},Vi.shouldSuspend=function(){return!1},Vi.startHostTransition=function(m,y,C,D){if(m.tag!==5)throw Error(r(476));var z=Ss(m).queue;sd(m,z,y,md,C===null?i:function(){var J=Ss(m).next.queue;return tf(m,J,{},wo()),C(D)})},Vi.updateContainer=function(m,y,C,D){var z=y.current,J=wo();return _x(z,J,m,y,C,D),J},Vi.updateContainerSync=function(m,y,C,D){return y.tag===0&&yc(),_x(y.current,2,m,y,C,D),2},Vi},t.exports.default=t.exports,Object.defineProperty(t.exports,"__esModule",{value:!0})})(uoe);var QMe=uoe.exports;loe.exports=QMe;var eOe=loe.exports;const tOe=Gc(eOe),nOe=t=>typeof t=="object"&&typeof t.then=="function",Ak=[];function iOe(t,e,n=(i,r)=>i===r){if(t===e)return!0;if(!t||!e)return!1;const i=t.length;if(e.length!==i)return!1;for(let r=0;r<i;r++)if(!n(t[r],e[r]))return!1;return!0}function rOe(t,e=null,n=!1,i={}){e===null&&(e=[t]);for(const s of Ak)if(iOe(e,s.keys,s.equal)){if(n)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return i.lifespan&&i.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,i.lifespan)),s.response;if(!n)throw s.promise}const r={keys:e,equal:i.equal,remove:()=>{const s=Ak.indexOf(r);s!==-1&&Ak.splice(s,1)},promise:(nOe(t)?t:t(...e)).then(s=>{r.response=s,i.lifespan&&i.lifespan>0&&(r.timeout=setTimeout(r.remove,i.lifespan))}).catch(s=>r.error=s)};if(Ak.push(r),!n)throw r.promise}const sOe=(t,e,n)=>rOe(t,e,!1,n);function Zq(t,e,n){if(!t)return;if(n(t)===!0)return t;let i=e?t.return:t.child;for(;i;){const r=Zq(i,e,n);if(r)return r;i=e?null:i.sibling}}function foe(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const Qq=foe(Be.createContext(null));let poe=class extends Be.Component{render(){return Be.createElement(Qq.Provider,{value:this._reactInternals},this.props.children)}};function moe(){const t=Be.useContext(Qq);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Be.useId();return Be.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const i=Zq(n,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(i)return i}},[t,e])}const aOe=Symbol.for("react.context"),oOe=t=>t!==null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===aOe;function cOe(){const t=moe(),[e]=Be.useState(()=>new Map);e.clear();let n=t;for(;n;){const i=n.type;oOe(i)&&i!==Qq&&!e.has(i)&&e.set(i,Be.use(foe(i))),n=n.return}return e}function lOe(){const t=cOe();return Be.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>i=>Be.createElement(e,null,Be.createElement(n.Provider,{...i,value:t.get(n)})),e=>Be.createElement(poe,{...e})),[t])}function goe(t){let e=t.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const voe=t=>t&&t.isOrthographicCamera,uOe=t=>t&&t.hasOwnProperty("current"),hOe=t=>t!=null&&(typeof t=="string"||typeof t=="number"||t.isColor),aN=((t,e)=>typeof window<"u"&&(((t=window.document)==null?void 0:t.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Be.useLayoutEffect:Be.useEffect;function e$(t){const e=Be.useRef(t);return aN(()=>void(e.current=t),[t]),e}function dOe(){const t=moe(),e=lOe();return Be.useMemo(()=>({children:n})=>{const r=!!Zq(t,!0,s=>s.type===Be.StrictMode)?Be.StrictMode:Be.Fragment;return Ae.jsx(r,{children:Ae.jsx(e,{children:n})})},[t,e])}function fOe({set:t}){return aN(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}const pOe=(t=>(t=class extends Be.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}},t.getDerivedStateFromError=()=>({error:!0}),t))();function yoe(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}function Jx(t){var e;return(e=t.__r3f)==null?void 0:e.root.getState()}const Ya={obj:t=>t===Object(t)&&!Ya.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,nul:t=>t===null,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:i="reference",strict:r=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(Ya.str(t)||Ya.num(t)||Ya.boo(t))return t===e;const s=Ya.obj(t);if(s&&i==="reference")return t===e;const a=Ya.arr(t);if(a&&n==="reference")return t===e;if((a||s)&&t===e)return!0;let o;for(o in t)if(!(o in e))return!1;if(s&&n==="shallow"&&i==="shallow"){for(o in r?e:t)if(!Ya.equ(t[o],e[o],{strict:r,objects:"reference"}))return!1}else for(o in r?e:t)if(t[o]!==e[o])return!1;if(Ya.und(o)){if(a&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function mOe(t){t.type!=="Scene"&&(t.dispose==null||t.dispose());for(const e in t){const n=t[e];(n==null?void 0:n.type)!=="Scene"&&(n==null||n.dispose==null||n.dispose())}}const _oe=["children","key","ref"];function gOe(t){const e={};for(const n in t)_oe.includes(n)||(e[n]=t[n]);return e}function IL(t,e,n,i){const r=t;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:n,parent:null,children:[],props:gOe(i),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function IM(t,e){let n=t[e];if(!e.includes("-"))return{root:t,key:e,target:n};n=t;for(const r of e.split("-")){var i;e=r,t=n,n=(i=n)==null?void 0:i[e]}return{root:t,key:e,target:n}}const YK=/-\d+$/;function kL(t,e){if(Ya.str(e.props.attach)){if(YK.test(e.props.attach)){const r=e.props.attach.replace(YK,""),{root:s,key:a}=IM(t.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:n,key:i}=IM(t.object,e.props.attach);e.previousAttach=n[i],n[i]=e.object}else Ya.fun(e.props.attach)&&(e.previousAttach=e.props.attach(t.object,e.object))}function DL(t,e){if(Ya.str(e.props.attach)){const{root:n,key:i}=IM(t.object,e.props.attach),r=e.previousAttach;r===void 0?delete n[i]:n[i]=r}else e.previousAttach==null||e.previousAttach(t.object,e.object);delete e.previousAttach}const Vj=[..._oe,"args","dispose","attach","object","onUpdate","dispose"],XK=new Map;function vOe(t){let e=XK.get(t.constructor);try{e||(e=new t.constructor,XK.set(t.constructor,e))}catch{}return e}function yOe(t,e){const n={};for(const i in e)if(!Vj.includes(i)&&!Ya.equ(e[i],t.props[i])){n[i]=e[i];for(const r in e)r.startsWith(`${i}-`)&&(n[r]=e[r])}for(const i in t.props){if(Vj.includes(i)||e.hasOwnProperty(i))continue;const{root:r,key:s}=IM(t.object,i);if(r.constructor&&r.constructor.length===0){const a=vOe(r);Ya.und(a)||(n[s]=a[s])}else n[s]=0}return n}const _Oe=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],bOe=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function U_(t,e){var n;const i=t.__r3f,r=i&&goe(i).getState(),s=i==null?void 0:i.eventCount;for(const o in e){let c=e[o];if(Vj.includes(o))continue;if(i&&bOe.test(o)){typeof c=="function"?i.handlers[o]=c:delete i.handlers[o],i.eventCount=Object.keys(i.handlers).length;continue}if(c===void 0)continue;let{root:l,key:u,target:h}=IM(t,o);if(h instanceof Lw&&c instanceof Lw)h.mask=c.mask;else if(h instanceof _n&&hOe(c))h.set(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof h.copy=="function"&&c!=null&&c.constructor&&h.constructor===c.constructor)h.copy(c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&Array.isArray(c))typeof h.fromArray=="function"?h.fromArray(c):h.set(...c);else if(h!==null&&typeof h=="object"&&typeof h.set=="function"&&typeof c=="number")typeof h.setScalar=="function"?h.setScalar(c):h.set(c);else{var a;l[u]=c,r&&!r.linear&&_Oe.includes(u)&&(a=l[u])!=null&&a.isTexture&&l[u].format===ru&&l[u].type===ml&&(l[u].colorSpace=ya)}}if(i!=null&&i.parent&&r!=null&&r.internal&&(n=i.object)!=null&&n.isObject3D&&s!==i.eventCount){const o=i.object,c=r.internal.interaction.indexOf(o);c>-1&&r.internal.interaction.splice(c,1),i.eventCount&&o.raycast!==null&&r.internal.interaction.push(o)}return i&&i.props.attach===void 0&&(i.object.isBufferGeometry?i.props.attach="geometry":i.object.isMaterial&&(i.props.attach="material")),i&&FC(i),t}function FC(t){var e;if(!t.parent)return;t.props.onUpdate==null||t.props.onUpdate(t.object);const n=(e=t.root)==null||e.getState==null?void 0:e.getState();n&&n.internal.frames===0&&n.invalidate()}function boe(t,e){t.manual||(voe(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix())}const Ih=t=>t==null?void 0:t.isObject3D;function Mk(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function Eoe(t,e,n,i){const r=n.get(e);r&&(n.delete(e),n.size===0&&(t.delete(i),r.target.releasePointerCapture(i)))}function EOe(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(i=>i!==e),n.initialHits=n.initialHits.filter(i=>i!==e),n.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&n.hovered.delete(r)}),n.capturedMap.forEach((i,r)=>{Eoe(n.capturedMap,e,i,r)})}function SOe(t){function e(c){const{internal:l}=t.getState(),u=c.offsetX-l.initialClick[0],h=c.offsetY-l.initialClick[1];return Math.round(Math.sqrt(u*u+h*h))}function n(c){return c.filter(l=>["Move","Over","Enter","Out","Leave"].some(u=>{var h;return(h=l.__r3f)==null?void 0:h.handlers["onPointer"+u]}))}function i(c,l){const u=t.getState(),h=new Set,d=[],f=l?l(u.internal.interaction):u.internal.interaction;for(let v=0;v<f.length;v++){const E=Jx(f[v]);E&&(E.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(c,u);function p(v){const E=Jx(v);if(!E||!E.events.enabled||E.raycaster.camera===null)return[];if(E.raycaster.camera===void 0){var T;E.events.compute==null||E.events.compute(c,E,(T=E.previousRoot)==null?void 0:T.getState()),E.raycaster.camera===void 0&&(E.raycaster.camera=null)}return E.raycaster.camera?E.raycaster.intersectObject(v,!0):[]}let g=f.flatMap(p).sort((v,E)=>{const T=Jx(v.object),x=Jx(E.object);return!T||!x?v.distance-E.distance:x.events.priority-T.events.priority||v.distance-E.distance}).filter(v=>{const E=Mk(v);return h.has(E)?!1:(h.add(E),!0)});u.events.filter&&(g=u.events.filter(g,u));for(const v of g){let E=v.object;for(;E;){var _;(_=E.__r3f)!=null&&_.eventCount&&d.push({...v,eventObject:E}),E=E.parent}}if("pointerId"in c&&u.internal.capturedMap.has(c.pointerId))for(let v of u.internal.capturedMap.get(c.pointerId).values())h.has(Mk(v.intersection))||d.push(v.intersection);return d}function r(c,l,u,h){if(c.length){const d={stopped:!1};for(const f of c){let p=Jx(f.object);if(p||f.object.traverseAncestors(g=>{const _=Jx(g);if(_)return p=_,!1}),p){const{raycaster:g,pointer:_,camera:v,internal:E}=p,T=new Re(_.x,_.y,0).unproject(v),x=L=>{var U,$;return(U=($=E.capturedMap.get(L))==null?void 0:$.has(f.eventObject))!=null?U:!1},N=L=>{const U={intersection:f,target:l.target};E.capturedMap.has(L)?E.capturedMap.get(L).set(f.eventObject,U):E.capturedMap.set(L,new Map([[f.eventObject,U]])),l.target.setPointerCapture(L)},A=L=>{const U=E.capturedMap.get(L);U&&Eoe(E.capturedMap,f.eventObject,U,L)};let I={};for(let L in l){let U=l[L];typeof U!="function"&&(I[L]=U)}let k={...f,...I,pointer:_,intersections:c,stopped:d.stopped,delta:u,unprojectedPoint:T,ray:g.ray,camera:v,stopPropagation(){const L="pointerId"in l&&E.capturedMap.get(l.pointerId);if((!L||L.has(f.eventObject))&&(k.stopped=d.stopped=!0,E.hovered.size&&Array.from(E.hovered.values()).find(U=>U.eventObject===f.eventObject))){const U=c.slice(0,c.indexOf(f));s([...U,f])}},target:{hasPointerCapture:x,setPointerCapture:N,releasePointerCapture:A},currentTarget:{hasPointerCapture:x,setPointerCapture:N,releasePointerCapture:A},nativeEvent:l};if(h(k),d.stopped===!0)break}}}return c}function s(c){const{internal:l}=t.getState();for(const u of l.hovered.values())if(!c.length||!c.find(h=>h.object===u.object&&h.index===u.index&&h.instanceId===u.instanceId)){const d=u.eventObject.__r3f;if(l.hovered.delete(Mk(u)),d!=null&&d.eventCount){const f=d.handlers,p={...u,intersections:c};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function a(c,l){for(let u=0;u<l.length;u++){const h=l[u].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(c)}}function o(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return l=>{const{internal:u}=t.getState();"pointerId"in l&&u.capturedMap.has(l.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(l.pointerId)&&(u.capturedMap.delete(l.pointerId),s([]))})}}return function(u){const{onPointerMissed:h,internal:d}=t.getState();d.lastEvent.current=u;const f=c==="onPointerMove",p=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",_=i(u,f?n:void 0),v=p?e(u):0;c==="onPointerDown"&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=_.map(T=>T.eventObject)),p&&!_.length&&v<=2&&(a(u,d.interaction),h&&h(u)),f&&s(_);function E(T){const x=T.eventObject,N=x.__r3f;if(!(N!=null&&N.eventCount))return;const A=N.handlers;if(f){if(A.onPointerOver||A.onPointerEnter||A.onPointerOut||A.onPointerLeave){const I=Mk(T),k=d.hovered.get(I);k?k.stopped&&T.stopPropagation():(d.hovered.set(I,T),A.onPointerOver==null||A.onPointerOver(T),A.onPointerEnter==null||A.onPointerEnter(T))}A.onPointerMove==null||A.onPointerMove(T)}else{const I=A[c];I?(!p||d.initialHits.includes(x))&&(a(u,d.interaction.filter(k=>!d.initialHits.includes(k))),I(T)):p&&d.initialHits.includes(x)&&a(u,d.interaction.filter(k=>!d.initialHits.includes(k)))}}r(_,u,v,E)}}return{handlePointer:o}}const KK=t=>!!(t!=null&&t.render),t$=Be.createContext(null),TOe=(t,e)=>{const n=coe((o,c)=>{const l=new Re,u=new Re,h=new Re;function d(v=c().camera,E=u,T=c().size){const{width:x,height:N,top:A,left:I}=T,k=x/N;E.isVector3?h.copy(E):h.set(...E);const L=v.getWorldPosition(l).distanceTo(h);if(voe(v))return{width:x/v.zoom,height:N/v.zoom,top:A,left:I,factor:1,distance:L,aspect:k};{const U=v.fov*Math.PI/180,$=2*Math.tan(U/2)*L,q=$*(x/N);return{width:q,height:$,top:A,left:I,factor:x/q,distance:L,aspect:k}}}let f;const p=v=>o(E=>({performance:{...E.performance,current:v}})),g=new Rt;return{set:o,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(v=1)=>t(c(),v),advance:(v,E)=>e(v,E,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Hq,pointer:g,mouse:g,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=c();f&&clearTimeout(f),v.performance.current!==v.performance.min&&p(v.performance.min),f=setTimeout(()=>p(c().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>o(E=>({...E,events:{...E.events,...v}})),setSize:(v,E,T=0,x=0)=>{const N=c().camera,A={width:v,height:E,top:T,left:x};o(I=>({size:A,viewport:{...I.viewport,...d(N,u,A)}}))},setDpr:v=>o(E=>{const T=yoe(v);return{viewport:{...E.viewport,dpr:T,initialDpr:E.viewport.initialDpr||T}}}),setFrameloop:(v="always")=>{const E=c().clock;E.stop(),E.elapsedTime=0,v!=="never"&&(E.start(),E.elapsedTime=0),o(()=>({frameloop:v}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Be.createRef(),active:!1,frames:0,priority:0,subscribe:(v,E,T)=>{const x=c().internal;return x.priority=x.priority+(E>0?1:0),x.subscribers.push({ref:v,priority:E,store:T}),x.subscribers=x.subscribers.sort((N,A)=>N.priority-A.priority),()=>{const N=c().internal;N!=null&&N.subscribers&&(N.priority=N.priority-(E>0?1:0),N.subscribers=N.subscribers.filter(A=>A.ref!==v))}}}}}),i=n.getState();let r=i.size,s=i.viewport.dpr,a=i.camera;return n.subscribe(()=>{const{camera:o,size:c,viewport:l,gl:u,set:h}=n.getState();if(c.width!==r.width||c.height!==r.height||l.dpr!==s){r=c,s=l.dpr,boe(o,c),l.dpr>0&&u.setPixelRatio(l.dpr);const d=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(c.width,c.height,d)}o!==a&&(a=o,h(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(o)}})))}),n.subscribe(o=>t(o)),n};function n$(){const t=Be.useContext(t$);if(!t)throw new Error("R3F: Hooks can only be used within the Canvas component!");return t}function Zu(t=n=>n,e){return n$()(t,e)}function hy(t,e=0){const n=n$(),i=n.getState().internal.subscribe,r=e$(t);return aN(()=>i(r,e,n),[e,i,n]),null}function xOe(t){const e=tOe(t);return e.injectIntoDevTools({bundleType:(typeof zn<"u",0),rendererPackageName:"@react-three/fiber",version:Be.version}),e}const Soe=0,jw={},wOe=/^three(?=[A-Z])/,x3=t=>`${t[0].toUpperCase()}${t.slice(1)}`;let COe=0;const ROe=t=>typeof t=="function";function Toe(t){if(ROe(t)){const e=`${COe++}`;return jw[e]=t,e}else Object.assign(jw,t)}function xoe(t,e){const n=x3(t),i=jw[n];if(t!=="primitive"&&!i)throw new Error(`R3F: ${n} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(t==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function AOe(t,e,n){var i;return t=x3(t)in jw?t:t.replace(wOe,""),xoe(t,e),t==="primitive"&&(i=e.object)!=null&&i.__r3f&&delete e.object.__r3f,IL(e.object,n,t,e)}function MOe(t){if(!t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?DL(t.parent,t):Ih(t.object)&&(t.object.visible=!1),t.isHidden=!0,FC(t)}}function woe(t){if(t.isHidden){var e;t.props.attach&&(e=t.parent)!=null&&e.object?kL(t.parent,t):Ih(t.object)&&t.props.visible!==!1&&(t.object.visible=!0),t.isHidden=!1,FC(t)}}function i$(t,e,n){const i=e.root.getState();if(!(!t.parent&&t.object!==i.scene)){if(!e.object){var r,s;const a=jw[x3(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(U_(e.object,e.props),e.props.attach)kL(t,e);else if(Ih(e.object)&&Ih(t.object)){const a=t.object.children.indexOf(n==null?void 0:n.object);if(n&&a!==-1){const o=t.object.children.indexOf(e.object);if(o!==-1){t.object.children.splice(o,1);const c=o<a?a-1:a;t.object.children.splice(c,0,e.object)}else e.object.parent=t.object,t.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),t.object.dispatchEvent({type:"childadded",child:e.object})}else t.object.add(e.object)}for(const a of e.children)i$(e,a);FC(e)}}function Jz(t,e){e&&(e.parent=t,t.children.push(e),i$(t,e))}function JK(t,e,n){if(!e||!n)return;e.parent=t;const i=t.children.indexOf(n);i!==-1?t.children.splice(i,0,e):t.children.push(e),i$(t,e,n)}function Coe(t){if(typeof t.dispose=="function"){const e=()=>{try{t.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():jj.unstable_scheduleCallback(jj.unstable_IdlePriority,e)}}function Gj(t,e,n){if(!e)return;e.parent=null;const i=t.children.indexOf(e);i!==-1&&t.children.splice(i,1),e.props.attach?DL(t,e):Ih(e.object)&&Ih(t.object)&&(t.object.remove(e.object),EOe(goe(e),e.object));const r=e.props.dispose!==null&&n!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];Gj(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&Coe(e.object),n===void 0&&FC(e)}function OOe(t,e){for(const n of[t,t.alternate])if(n!==null)if(typeof n.ref=="function"){n.refCleanup==null||n.refCleanup();const i=n.ref(e);typeof i=="function"&&(n.refCleanup=i)}else n.ref&&(n.ref.current=e)}const FD=[];function NOe(){for(const[n]of FD){const i=n.parent;if(i){n.props.attach?DL(i,n):Ih(n.object)&&Ih(i.object)&&i.object.remove(n.object);for(const r of n.children)r.props.attach?DL(n,r):Ih(r.object)&&Ih(n.object)&&n.object.remove(r.object)}n.isHidden&&woe(n),n.object.__r3f&&delete n.object.__r3f,n.type!=="primitive"&&Coe(n.object)}for(const[n,i,r]of FD){n.props=i;const s=n.parent;if(s){var t,e;const a=jw[x3(n.type)];n.object=(t=n.props.object)!=null?t:new a(...(e=n.props.args)!=null?e:[]),n.object.__r3f=n,OOe(r,n.object),U_(n.object,n.props),n.props.attach?kL(s,n):Ih(n.object)&&Ih(s.object)&&s.object.add(n.object);for(const o of n.children)o.props.attach?kL(n,o):Ih(o.object)&&Ih(n.object)&&n.object.add(o.object);FC(n)}}FD.length=0}const Zz=()=>{},ZK={};let Ok=Soe;const IOe=0,kOe=4,PL=xOe({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:AOe,removeChild:Gj,appendChild:Jz,appendInitialChild:Jz,insertBefore:JK,appendChildToContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||Jz(n,e)},removeChildFromContainer(t,e){const n=t.getState().scene.__r3f;!e||!n||Gj(n,e)},insertInContainerBefore(t,e,n){const i=t.getState().scene.__r3f;!e||!n||!i||JK(i,e,n)},getRootHostContext:()=>ZK,getChildHostContext:()=>ZK,commitUpdate(t,e,n,i,r){var s,a,o;xoe(e,i);let c=!1;if((t.type==="primitive"&&n.object!==i.object||((s=i.args)==null?void 0:s.length)!==((a=n.args)==null?void 0:a.length)||(o=i.args)!=null&&o.some((u,h)=>{var d;return u!==((d=n.args)==null?void 0:d[h])}))&&(c=!0),c)FD.push([t,{...i},r]);else{const u=yOe(t,i);Object.keys(u).length&&(Object.assign(t.props,u),U_(t.object,u))}(r.sibling===null||(r.flags&kOe)===IOe)&&NOe()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:t=>t==null?void 0:t.object,prepareForCommit:()=>null,preparePortalMount:t=>IL(t.getState().scene,t,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:MOe,unhideInstance:woe,createTextInstance:Zz,hideTextInstance:Zz,unhideTextInstance:Zz,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Be.createContext(null),setCurrentUpdatePriority(t){Ok=t},getCurrentUpdatePriority(){return Ok},resolveUpdatePriority(){var t;if(Ok!==Soe)return Ok;switch(typeof window<"u"&&((t=window.event)==null?void 0:t.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return BD.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return BD.ContinuousEventPriority;default:return BD.DefaultEventPriority}},resetFormInstance(){}}),sT=new Map,Zx={objects:"shallow",strict:!1};function DOe(t,e){if(!e&&typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:n,height:i,top:r,left:s}=t.parentElement.getBoundingClientRect();return{width:n,height:i,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function POe(t){const e=sT.get(t),n=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||TOe(Wj,eJ),a=n||PL.createContainer(s,BD.ConcurrentRoot,null,!1,null,"",r,r,r,null);e||sT.set(t,{fiber:a,store:s});let o,c,l=!1,u=null;return{async configure(h={}){let d;u=new Promise(de=>d=de);let{gl:f,size:p,scene:g,events:_,onCreated:v,shadows:E=!1,linear:T=!1,flat:x=!1,legacy:N=!1,orthographic:A=!1,frameloop:I="always",dpr:k=[1,2],performance:L,raycaster:U,camera:$,onPointerMissed:q}=h,G=s.getState(),X=G.gl;if(!G.gl){const de={canvas:t,powerPreference:"high-performance",antialias:!0,alpha:!0},Me=typeof f=="function"?await f(de):f;KK(Me)?X=Me:X=new Xae({...de,...f}),G.set({gl:X})}let ie=G.raycaster;ie||G.set({raycaster:ie=new Gq});const{params:V,...Z}=U||{};if(Ya.equ(Z,ie,Zx)||U_(ie,{...Z}),Ya.equ(V,ie.params,Zx)||U_(ie,{params:{...ie.params,...V}}),!G.camera||G.camera===c&&!Ya.equ(c,$,Zx)){c=$;const de=$==null?void 0:$.isCamera,Me=de?$:A?new sN(0,0,0,0,.1,1e3):new Ic(75,0,.1,1e3);de||(Me.position.z=5,$&&(U_(Me,$),Me.manual||("aspect"in $||"left"in $||"right"in $||"bottom"in $||"top"in $)&&(Me.manual=!0,Me.updateProjectionMatrix())),!G.camera&&!($!=null&&$.rotation)&&Me.lookAt(0,0,0)),G.set({camera:Me}),ie.camera=Me}if(!G.scene){let de;g!=null&&g.isScene?(de=g,IL(de,s,"",{})):(de=new Bw,IL(de,s,"",{}),g&&U_(de,g)),G.set({scene:de})}_&&!G.events.handlers&&G.set({events:_(s)});const Y=DOe(t,p);if(Ya.equ(Y,G.size,Zx)||G.setSize(Y.width,Y.height,Y.top,Y.left),k&&G.viewport.dpr!==yoe(k)&&G.setDpr(k),G.frameloop!==I&&G.setFrameloop(I),G.onPointerMissed||G.set({onPointerMissed:q}),L&&!Ya.equ(L,G.performance,Zx)&&G.set(de=>({performance:{...de.performance,...L}})),!G.xr){var ee;const de=(Te,Le)=>{const we=s.getState();we.frameloop!=="never"&&eJ(Te,!0,we,Le)},Me=()=>{const Te=s.getState();Te.gl.xr.enabled=Te.gl.xr.isPresenting,Te.gl.xr.setAnimationLoop(Te.gl.xr.isPresenting?de:null),Te.gl.xr.isPresenting||Wj(Te)},He={connect(){const Te=s.getState().gl;Te.xr.addEventListener("sessionstart",Me),Te.xr.addEventListener("sessionend",Me)},disconnect(){const Te=s.getState().gl;Te.xr.removeEventListener("sessionstart",Me),Te.xr.removeEventListener("sessionend",Me)}};typeof((ee=X.xr)==null?void 0:ee.addEventListener)=="function"&&He.connect(),G.set({xr:He})}if(X.shadowMap){const de=X.shadowMap.enabled,Me=X.shadowMap.type;if(X.shadowMap.enabled=!!E,Ya.boo(E))X.shadowMap.type=CA;else if(Ya.str(E)){var oe;const He={basic:Jre,percentage:$U,soft:CA,variance:Bp};X.shadowMap.type=(oe=He[E])!=null?oe:CA}else Ya.obj(E)&&Object.assign(X.shadowMap,E);(de!==X.shadowMap.enabled||Me!==X.shadowMap.type)&&(X.shadowMap.needsUpdate=!0)}return Lr.enabled=!N,l||(X.outputColorSpace=T?Lg:ya,X.toneMapping=x?Kp:cq),G.legacy!==N&&G.set(()=>({legacy:N})),G.linear!==T&&G.set(()=>({linear:T})),G.flat!==x&&G.set(()=>({flat:x})),f&&!Ya.fun(f)&&!KK(f)&&!Ya.equ(f,X,Zx)&&U_(X,f),o=v,l=!0,d(),this},render(h){return!l&&!u&&this.configure(),u.then(()=>{PL.updateContainer(Ae.jsx(LOe,{store:s,children:h,onCreated:o,rootElement:t}),a,null,()=>{})}),s},unmount(){Roe(t)}}}function LOe({store:t,children:e,onCreated:n,rootElement:i}){return aN(()=>{const r=t.getState();r.set(s=>({internal:{...s.internal,active:!0}})),n&&n(r),t.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),Ae.jsx(t$.Provider,{value:t,children:e})}function Roe(t,e){const n=sT.get(t),i=n==null?void 0:n.fiber;if(i){const r=n==null?void 0:n.store.getState();r&&(r.internal.active=!1),PL.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,a,o,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=r.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),mOe(r.scene),sT.delete(t)}catch{}},500)})}}function UOe(t,e,n){return Ae.jsx(BOe,{children:t,container:e,state:n})}function BOe({state:t={},children:e,container:n}){const{events:i,size:r,...s}=t,a=n$(),[o]=Be.useState(()=>new Gq),[c]=Be.useState(()=>new Rt),l=e$((h,d)=>{let f;if(d.camera&&r){const p=d.camera;f=h.viewport.getCurrentViewport(p,new Re,r),p!==h.camera&&boe(p,r)}return{...h,...d,scene:n,raycaster:o,pointer:c,mouse:c,previousRoot:a,events:{...h.events,...d.events,...i},size:{...h.size,...r},viewport:{...h.viewport,...f},setEvents:p=>d.set(g=>({...g,events:{...g.events,...p}}))}}),u=Be.useMemo(()=>{const h=coe((f,p)=>({...s,set:f,get:p})),d=f=>h.setState(p=>l.current(f,p));return d(a.getState()),a.subscribe(d),h},[a,n]);return Ae.jsx(Ae.Fragment,{children:PL.createPortal(Ae.jsx(t$.Provider,{value:u,children:e}),u,null)})}function Aoe(t,e){const n={callback:t};return e.add(n),()=>void e.delete(n)}const Moe=new Set,Ooe=new Set,FOe=new Set,zOe=t=>Aoe(t,Moe),HOe=t=>Aoe(t,Ooe);function Qz(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function LA(t,e){switch(t){case"before":return Qz(Moe,e);case"after":return Qz(Ooe,e);case"tail":return Qz(FOe,e)}}let e8,t8;function qj(t,e,n){let i=e.clock.getDelta();e.frameloop==="never"&&typeof t=="number"&&(i=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),e8=e.internal.subscribers;for(let r=0;r<e8.length;r++)t8=e8[r],t8.ref.current(t8.store.getState(),i,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let LL=!1,$j=!1,n8,QK,Qx;function Noe(t){QK=requestAnimationFrame(Noe),LL=!0,n8=0,LA("before",t),$j=!0;for(const n of sT.values()){var e;Qx=n.store.getState(),Qx.internal.active&&(Qx.frameloop==="always"||Qx.internal.frames>0)&&!((e=Qx.gl.xr)!=null&&e.isPresenting)&&(n8+=qj(t,Qx))}if($j=!1,LA("after",t),n8===0)return LA("tail",t),LL=!1,cancelAnimationFrame(QK)}function Wj(t,e=1){var n;if(!t)return sT.forEach(i=>Wj(i.store.getState(),e));(n=t.gl.xr)!=null&&n.isPresenting||!t.internal.active||t.frameloop==="never"||(e>1?t.internal.frames=Math.min(60,t.internal.frames+e):$j?t.internal.frames=2:t.internal.frames=1,LL||(LL=!0,requestAnimationFrame(Noe)))}function eJ(t,e=!0,n,i){if(e&&LA("before",t),n)qj(t,n,i);else for(const r of sT.values())qj(t,r.store.getState());e&&LA("after",t)}const i8={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Ioe(t){const{handlePointer:e}=SOe(t);return{priority:1,enabled:!0,compute(n,i,r){i.pointer.set(n.offsetX/i.size.width*2-1,-(n.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(i8).reduce((n,i)=>({...n,[i]:e(i)}),{}),update:()=>{var n;const{events:i,internal:r}=t.getState();(n=r.lastEvent)!=null&&n.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:n=>{const{set:i,events:r}=t.getState();if(r.disconnect==null||r.disconnect(),i(s=>({events:{...s.events,connected:n}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[o,c]=i8[s];n.addEventListener(o,a,{passive:c})}},disconnect:()=>{const{set:n,events:i}=t.getState();if(i.connected){if(i.handlers)for(const r in i.handlers){const s=i.handlers[r],[a]=i8[r];i.connected.removeEventListener(a,s)}n(r=>({events:{...r.events,connected:void 0}}))}}}}function tJ(t,e){let n;return(...i)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...i),e)}}function jOe({debounce:t,scroll:e,polyfill:n,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=Be.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=Be.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=t?typeof t=="number"?t:t.scroll:null,l=t?typeof t=="number"?t:t.resize:null,u=Be.useRef(!1);Be.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[h,d,f]=Be.useMemo(()=>{const v=()=>{if(!o.current.element)return;const{left:E,top:T,width:x,height:N,bottom:A,right:I,x:k,y:L}=o.current.element.getBoundingClientRect(),U={left:E,top:T,width:x,height:N,bottom:A,right:I,x:k,y:L};o.current.element instanceof HTMLElement&&i&&(U.height=o.current.element.offsetHeight,U.width=o.current.element.offsetWidth),Object.freeze(U),u.current&&!$Oe(o.current.lastBounds,U)&&a(o.current.lastBounds=U)};return[v,l?tJ(v,l):v,c?tJ(v,c):v]},[a,i,c,l]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",f,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function g(){o.current.element&&(o.current.resizeObserver=new r(f),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(v=>v.addEventListener("scroll",f,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const _=v=>{!v||v===o.current.element||(p(),o.current.element=v,o.current.scrollContainers=koe(v),g())};return GOe(f,!!e),VOe(d),Be.useEffect(()=>{p(),g()},[e,f,d]),Be.useEffect(()=>p,[]),[_,s,h]}function VOe(t){Be.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function GOe(t,e){Be.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function koe(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:i,overflowY:r}=window.getComputedStyle(t);return[n,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...koe(t.parentElement)]}const qOe=["x","y","top","bottom","left","right","width","height"],$Oe=(t,e)=>qOe.every(n=>t[n]===e[n]);function WOe({ref:t,children:e,fallback:n,resize:i,style:r,gl:s,events:a=Ioe,eventSource:o,eventPrefix:c,shadows:l,linear:u,flat:h,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:_,raycaster:v,camera:E,scene:T,onPointerMissed:x,onCreated:N,...A}){Be.useMemo(()=>Toe(fMe),[]);const I=dOe(),[k,L]=jOe({scroll:!0,debounce:{scroll:50,resize:0},...i}),U=Be.useRef(null),$=Be.useRef(null);Be.useImperativeHandle(t,()=>U.current);const q=e$(x),[G,X]=Be.useState(!1),[ie,V]=Be.useState(!1);if(G)throw G;if(ie)throw ie;const Z=Be.useRef(null);aN(()=>{const ee=U.current;if(L.width>0&&L.height>0&&ee){Z.current||(Z.current=POe(ee));async function oe(){await Z.current.configure({gl:s,scene:T,events:a,shadows:l,linear:u,flat:h,legacy:d,orthographic:f,frameloop:p,dpr:g,performance:_,raycaster:v,camera:E,size:L,onPointerMissed:(...de)=>q.current==null?void 0:q.current(...de),onCreated:de=>{de.events.connect==null||de.events.connect(o?uOe(o)?o.current:o:$.current),c&&de.setEvents({compute:(Me,He)=>{const Te=Me[c+"X"],Le=Me[c+"Y"];He.pointer.set(Te/He.size.width*2-1,-(Le/He.size.height)*2+1),He.raycaster.setFromCamera(He.pointer,He.camera)}}),N==null||N(de)}}),Z.current.render(Ae.jsx(I,{children:Ae.jsx(pOe,{set:V,children:Ae.jsx(Be.Suspense,{fallback:Ae.jsx(fOe,{set:X}),children:e??null})})}))}oe()}}),Be.useEffect(()=>{const ee=U.current;if(ee)return()=>Roe(ee)},[]);const Y=o?"none":"auto";return Ae.jsx("div",{ref:$,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...r},...A,children:Ae.jsx("div",{ref:k,style:{width:"100%",height:"100%"},children:Ae.jsx("canvas",{ref:U,style:{display:"block"},children:n})})})}function YOe(t){return Ae.jsx(poe,{children:Ae.jsx(WOe,{...t})})}var r$={exports:{}};function Doe(t,e=100,n={}){if(typeof t!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof t}\`.`);if(e<0)throw new RangeError("`wait` must not be negative.");const{immediate:i}=typeof n=="boolean"?{immediate:n}:n;let r,s,a,o,c;function l(){const d=r,f=s;return r=void 0,s=void 0,c=t.apply(d,f),c}function u(){const d=Date.now()-o;d<e&&d>=0?a=setTimeout(u,e-d):(a=void 0,i||(c=l()))}const h=function(...d){if(r&&this!==r&&Object.getPrototypeOf(this)===Object.getPrototypeOf(r))throw new Error("Debounced method called with different contexts of the same prototype.");r=this,s=d,o=Date.now();const f=i&&!a;return a||(a=setTimeout(u,e)),f&&(c=l()),c};return Object.defineProperty(h,"isPending",{get(){return a!==void 0}}),h.clear=()=>{a&&(clearTimeout(a),a=void 0)},h.flush=()=>{a&&h.trigger()},h.trigger=()=>{c=l(),h.clear()},h}r$.exports.debounce=Doe;r$.exports=Doe;var XOe=r$.exports;const KOe=Gc(XOe);var Poe={exports:{}},w3={},Loe={exports:{}},Uoe={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,Z){var Y=V.length;V.push(Z);e:for(;0<Y;){var ee=Y-1>>>1,oe=V[ee];if(0<r(oe,Z))V[ee]=Z,V[Y]=oe,Y=ee;else break e}}function n(V){return V.length===0?null:V[0]}function i(V){if(V.length===0)return null;var Z=V[0],Y=V.pop();if(Y!==Z){V[0]=Y;e:for(var ee=0,oe=V.length,de=oe>>>1;ee<de;){var Me=2*(ee+1)-1,He=V[Me],Te=Me+1,Le=V[Te];if(0>r(He,Y))Te<oe&&0>r(Le,He)?(V[ee]=Le,V[Te]=Y,ee=Te):(V[ee]=He,V[Me]=Y,ee=Me);else if(Te<oe&&0>r(Le,Y))V[ee]=Le,V[Te]=Y,ee=Te;else break e}}return Z}function r(V,Z){var Y=V.sortIndex-Z.sortIndex;return Y!==0?Y:V.id-Z.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var c=[],l=[],u=1,h=null,d=3,f=!1,p=!1,g=!1,_=!1,v=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function x(V){for(var Z=n(l);Z!==null;){if(Z.callback===null)i(l);else if(Z.startTime<=V)i(l),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=n(l)}}function N(V){if(g=!1,x(V),!p)if(n(c)!==null)p=!0,A||(A=!0,q());else{var Z=n(l);Z!==null&&ie(N,Z.startTime-V)}}var A=!1,I=-1,k=5,L=-1;function U(){return _?!0:!(t.unstable_now()-L<k)}function $(){if(_=!1,A){var V=t.unstable_now();L=V;var Z=!0;try{e:{p=!1,g&&(g=!1,E(I),I=-1),f=!0;var Y=d;try{t:{for(x(V),h=n(c);h!==null&&!(h.expirationTime>V&&U());){var ee=h.callback;if(typeof ee=="function"){h.callback=null,d=h.priorityLevel;var oe=ee(h.expirationTime<=V);if(V=t.unstable_now(),typeof oe=="function"){h.callback=oe,x(V),Z=!0;break t}h===n(c)&&i(c),x(V)}else i(c);h=n(c)}if(h!==null)Z=!0;else{var de=n(l);de!==null&&ie(N,de.startTime-V),Z=!1}}break e}finally{h=null,d=Y,f=!1}Z=void 0}}finally{Z?q():A=!1}}}var q;if(typeof T=="function")q=function(){T($)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,X=G.port2;G.port1.onmessage=$,q=function(){X.postMessage(null)}}else q=function(){v($,0)};function ie(V,Z){I=v(function(){V(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_next=function(V){switch(d){case 1:case 2:case 3:var Z=3;break;default:Z=d}var Y=d;d=Z;try{return V()}finally{d=Y}},t.unstable_requestPaint=function(){_=!0},t.unstable_runWithPriority=function(V,Z){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Y=d;d=V;try{return Z()}finally{d=Y}},t.unstable_scheduleCallback=function(V,Z,Y){var ee=t.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ee+Y:ee):Y=ee,V){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=Y+oe,V={id:u++,callback:Z,priorityLevel:V,startTime:Y,expirationTime:oe,sortIndex:-1},Y>ee?(V.sortIndex=Y,e(l,V),n(c)===null&&V===n(l)&&(g?(E(I),I=-1):g=!0,ie(N,Y-ee))):(V.sortIndex=oe,e(c,V),p||f||(p=!0,A||(A=!0,q()))),V},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(V){var Z=d;return function(){var Y=d;d=Z;try{return V.apply(this,arguments)}finally{d=Y}}}})(Uoe);Loe.exports=Uoe;var JOe=Loe.exports,Boe={exports:{}},nh={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZOe=Be;function Foe(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o_(){}var Ku={d:{f:o_,r:function(){throw Error(Foe(522))},D:o_,C:o_,L:o_,m:o_,X:o_,S:o_,M:o_},p:0,findDOMNode:null},QOe=Symbol.for("react.portal");function eNe(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:QOe,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}var UA=ZOe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function C3(t,e){if(t==="font")return"";if(typeof e=="string")return e==="use-credentials"?e:""}nh.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Ku;nh.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)throw Error(Foe(299));return eNe(t,e,null,n)};nh.flushSync=function(t){var e=UA.T,n=Ku.p;try{if(UA.T=null,Ku.p=2,t)return t()}finally{UA.T=e,Ku.p=n,Ku.d.f()}};nh.preconnect=function(t,e){typeof t=="string"&&(e?(e=e.crossOrigin,e=typeof e=="string"?e==="use-credentials"?e:"":void 0):e=null,Ku.d.C(t,e))};nh.prefetchDNS=function(t){typeof t=="string"&&Ku.d.D(t)};nh.preinit=function(t,e){if(typeof t=="string"&&e&&typeof e.as=="string"){var n=e.as,i=C3(n,e.crossOrigin),r=typeof e.integrity=="string"?e.integrity:void 0,s=typeof e.fetchPriority=="string"?e.fetchPriority:void 0;n==="style"?Ku.d.S(t,typeof e.precedence=="string"?e.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:s}):n==="script"&&Ku.d.X(t,{crossOrigin:i,integrity:r,fetchPriority:s,nonce:typeof e.nonce=="string"?e.nonce:void 0})}};nh.preinitModule=function(t,e){if(typeof t=="string")if(typeof e=="object"&&e!==null){if(e.as==null||e.as==="script"){var n=C3(e.as,e.crossOrigin);Ku.d.M(t,{crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0})}}else e==null&&Ku.d.M(t)};nh.preload=function(t,e){if(typeof t=="string"&&typeof e=="object"&&e!==null&&typeof e.as=="string"){var n=e.as,i=C3(n,e.crossOrigin);Ku.d.L(t,n,{crossOrigin:i,integrity:typeof e.integrity=="string"?e.integrity:void 0,nonce:typeof e.nonce=="string"?e.nonce:void 0,type:typeof e.type=="string"?e.type:void 0,fetchPriority:typeof e.fetchPriority=="string"?e.fetchPriority:void 0,referrerPolicy:typeof e.referrerPolicy=="string"?e.referrerPolicy:void 0,imageSrcSet:typeof e.imageSrcSet=="string"?e.imageSrcSet:void 0,imageSizes:typeof e.imageSizes=="string"?e.imageSizes:void 0,media:typeof e.media=="string"?e.media:void 0})}};nh.preloadModule=function(t,e){if(typeof t=="string")if(e){var n=C3(e.as,e.crossOrigin);Ku.d.m(t,{as:typeof e.as=="string"&&e.as!=="script"?e.as:void 0,crossOrigin:n,integrity:typeof e.integrity=="string"?e.integrity:void 0})}else Ku.d.m(t)};nh.requestFormReset=function(t){Ku.d.r(t)};nh.unstable_batchedUpdates=function(t,e){return t(e)};nh.useFormState=function(t,e,n){return UA.H.useFormState(t,e,n)};nh.useFormStatus=function(){return UA.H.useHostTransitionStatus()};nh.version="19.1.0";function zoe(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zoe)}catch(t){console.error(t)}}zoe(),Boe.exports=nh;var tNe=Boe.exports,Hc=JOe,Hoe=Be,nNe=tNe;function jt(t){var e="https://react.dev/errors/"+t;if(1<arguments.length){e+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function joe(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function oN(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Voe(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function nJ(t){if(oN(t)!==t)throw Error(jt(188))}function iNe(t){var e=t.alternate;if(!e){if(e=oN(t),e===null)throw Error(jt(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return nJ(r),t;if(s===i)return nJ(r),e;s=s.sibling}throw Error(jt(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(jt(189))}}if(n.alternate!==i)throw Error(jt(190))}if(n.tag!==3)throw Error(jt(188));return n.stateNode.current===n?t:e}function Goe(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t;for(t=t.child;t!==null;){if(e=Goe(t),e!==null)return e;t=t.sibling}return null}var Sa=Object.assign,rNe=Symbol.for("react.element"),Nk=Symbol.for("react.transitional.element"),fA=Symbol.for("react.portal"),k1=Symbol.for("react.fragment"),qoe=Symbol.for("react.strict_mode"),Yj=Symbol.for("react.profiler"),sNe=Symbol.for("react.provider"),$oe=Symbol.for("react.consumer"),Nv=Symbol.for("react.context"),s$=Symbol.for("react.forward_ref"),Xj=Symbol.for("react.suspense"),Kj=Symbol.for("react.suspense_list"),a$=Symbol.for("react.memo"),C_=Symbol.for("react.lazy"),Jj=Symbol.for("react.activity"),aNe=Symbol.for("react.memo_cache_sentinel"),iJ=Symbol.iterator;function BR(t){return t===null||typeof t!="object"?null:(t=iJ&&t[iJ]||t["@@iterator"],typeof t=="function"?t:null)}var oNe=Symbol.for("react.client.reference");function Zj(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===oNe?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case k1:return"Fragment";case Yj:return"Profiler";case qoe:return"StrictMode";case Xj:return"Suspense";case Kj:return"SuspenseList";case Jj:return"Activity"}if(typeof t=="object")switch(t.$$typeof){case fA:return"Portal";case Nv:return(t.displayName||"Context")+".Provider";case $oe:return(t._context.displayName||"Context")+".Consumer";case s$:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case a$:return e=t.displayName||null,e!==null?e:Zj(t.type)||"Memo";case C_:e=t._payload,t=t._init;try{return Zj(t(e))}catch{}}return null}var pA=Array.isArray,Ui=Hoe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,gs=nNe.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,zS={pending:!1,data:null,method:null,action:null},Qj=[],D1=-1;function Xg(t){return{current:t}}function dl(t){0>D1||(t.current=Qj[D1],Qj[D1]=null,D1--)}function Da(t,e){D1++,Qj[D1]=t.current,t.current=e}var Sg=Xg(null),kM=Xg(null),J_=Xg(null),UL=Xg(null);function BL(t,e){switch(Da(J_,e),Da(kM,t),Da(Sg,null),e.nodeType){case 9:case 11:t=(t=e.documentElement)&&(t=t.namespaceURI)?cZ(t):0;break;default:if(t=e.tagName,e=e.namespaceURI)e=cZ(e),t=lue(e,t);else switch(t){case"svg":t=1;break;case"math":t=2;break;default:t=0}}dl(Sg),Da(Sg,t)}function Vw(){dl(Sg),dl(kM),dl(J_)}function e5(t){t.memoizedState!==null&&Da(UL,t);var e=Sg.current,n=lue(e,t.type);e!==n&&(Da(kM,t),Da(Sg,n))}function FL(t){kM.current===t&&(dl(Sg),dl(kM)),UL.current===t&&(dl(UL),VM._currentValue=zS)}var t5=Object.prototype.hasOwnProperty,o$=Hc.unstable_scheduleCallback,r8=Hc.unstable_cancelCallback,cNe=Hc.unstable_shouldYield,lNe=Hc.unstable_requestPaint,Tg=Hc.unstable_now,uNe=Hc.unstable_getCurrentPriorityLevel,Woe=Hc.unstable_ImmediatePriority,Yoe=Hc.unstable_UserBlockingPriority,zL=Hc.unstable_NormalPriority,hNe=Hc.unstable_LowPriority,Xoe=Hc.unstable_IdlePriority,dNe=Hc.log,fNe=Hc.unstable_setDisableYieldValue,cN=null,Hd=null;function G_(t){if(typeof dNe=="function"&&fNe(t),Hd&&typeof Hd.setStrictMode=="function")try{Hd.setStrictMode(cN,t)}catch{}}var jd=Math.clz32?Math.clz32:gNe,pNe=Math.log,mNe=Math.LN2;function gNe(t){return t>>>=0,t===0?32:31-(pNe(t)/mNe|0)|0}var Ik=256,kk=4194304;function mS(t){var e=t&42;if(e!==0)return e;switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return t&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return t}}function R3(t,e,n){var i=t.pendingLanes;if(i===0)return 0;var r=0,s=t.suspendedLanes,a=t.pingedLanes;t=t.warmLanes;var o=i&134217727;return o!==0?(i=o&~s,i!==0?r=mS(i):(a&=o,a!==0?r=mS(a):n||(n=o&~t,n!==0&&(r=mS(n))))):(o=i&~s,o!==0?r=mS(o):a!==0?r=mS(a):n||(n=i&~t,n!==0&&(r=mS(n)))),r===0?0:e!==0&&e!==r&&!(e&s)&&(s=r&-r,n=e&-e,s>=n||s===32&&(n&4194048)!==0)?e:r}function lN(t,e){return(t.pendingLanes&~(t.suspendedLanes&~t.pingedLanes)&e)===0}function vNe(t,e){switch(t){case 1:case 2:case 4:case 8:case 64:return e+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Koe(){var t=Ik;return Ik<<=1,!(Ik&4194048)&&(Ik=256),t}function Joe(){var t=kk;return kk<<=1,!(kk&62914560)&&(kk=4194304),t}function s8(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function uN(t,e){t.pendingLanes|=e,e!==268435456&&(t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0)}function yNe(t,e,n,i,r,s){var a=t.pendingLanes;t.pendingLanes=n,t.suspendedLanes=0,t.pingedLanes=0,t.warmLanes=0,t.expiredLanes&=n,t.entangledLanes&=n,t.errorRecoveryDisabledLanes&=n,t.shellSuspendCounter=0;var o=t.entanglements,c=t.expirationTimes,l=t.hiddenUpdates;for(n=a&~n;0<n;){var u=31-jd(n),h=1<<u;o[u]=0,c[u]=-1;var d=l[u];if(d!==null)for(l[u]=null,u=0;u<d.length;u++){var f=d[u];f!==null&&(f.lane&=-536870913)}n&=~h}i!==0&&Zoe(t,i,0),s!==0&&r===0&&t.tag!==0&&(t.suspendedLanes|=s&~(a&~e))}function Zoe(t,e,n){t.pendingLanes|=e,t.suspendedLanes&=~e;var i=31-jd(e);t.entangledLanes|=e,t.entanglements[i]=t.entanglements[i]|1073741824|n&4194090}function Qoe(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-jd(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}function c$(t){switch(t){case 2:t=1;break;case 8:t=4;break;case 32:t=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:t=128;break;case 268435456:t=134217728;break;default:t=0}return t}function l$(t){return t&=-t,2<t?8<t?t&134217727?32:268435456:8:2}function ece(){var t=gs.p;return t!==0?t:(t=window.event,t===void 0?32:_ue(t.type))}function _Ne(t,e){var n=gs.p;try{return gs.p=t,e()}finally{gs.p=n}}var Vb=Math.random().toString(36).slice(2),su="__reactFiber$"+Vb,Wh="__reactProps$"+Vb,zC="__reactContainer$"+Vb,n5="__reactEvents$"+Vb,bNe="__reactListeners$"+Vb,ENe="__reactHandles$"+Vb,rJ="__reactResources$"+Vb,hN="__reactMarker$"+Vb;function u$(t){delete t[su],delete t[Wh],delete t[n5],delete t[bNe],delete t[ENe]}function P1(t){var e=t[su];if(e)return e;for(var n=t.parentNode;n;){if(e=n[zC]||n[su]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=hZ(t);t!==null;){if(n=t[su])return n;t=hZ(t)}return e}t=n,n=t.parentNode}return null}function HC(t){if(t=t[su]||t[zC]){var e=t.tag;if(e===5||e===6||e===13||e===26||e===27||e===3)return t}return null}function mA(t){var e=t.tag;if(e===5||e===26||e===27||e===6)return t.stateNode;throw Error(jt(33))}function sw(t){var e=t[rJ];return e||(e=t[rJ]={hoistableStyles:new Map,hoistableScripts:new Map}),e}function al(t){t[hN]=!0}var tce=new Set,nce={};function BT(t,e){Gw(t,e),Gw(t+"Capture",e)}function Gw(t,e){for(nce[t]=e,t=0;t<e.length;t++)tce.add(e[t])}var SNe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sJ={},aJ={};function TNe(t){return t5.call(aJ,t)?!0:t5.call(sJ,t)?!1:SNe.test(t)?aJ[t]=!0:(sJ[t]=!0,!1)}function zD(t,e,n){if(TNe(e))if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":t.removeAttribute(e);return;case"boolean":var i=e.toLowerCase().slice(0,5);if(i!=="data-"&&i!=="aria-"){t.removeAttribute(e);return}}t.setAttribute(e,""+n)}}function Dk(t,e,n){if(n===null)t.removeAttribute(e);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(e);return}t.setAttribute(e,""+n)}}function cv(t,e,n,i){if(i===null)t.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":t.removeAttribute(n);return}t.setAttributeNS(e,n,""+i)}}var a8,oJ;function _1(t){if(a8===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);a8=e&&e[1]||"",oJ=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+a8+t+oJ}var o8=!1;function c8(t,e){if(!t||o8)return"";o8=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(e){var h=function(){throw Error()};if(Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(f){var d=f}Reflect.construct(t,[],h)}else{try{h.call()}catch(f){d=f}t.call(h.prototype)}}else{try{throw Error()}catch(f){d=f}(h=t())&&typeof h.catch=="function"&&h.catch(function(){})}}catch(f){if(f&&d&&typeof f.stack=="string")return[f.stack,d.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var s=i.DetermineComponentFrameRoot(),a=s[0],o=s[1];if(a&&o){var c=a.split(`
`),l=o.split(`
`);for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(i!==1||r!==1)do if(i--,r--,0>r||c[i]!==l[r]){var u=`
`+c[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=r);break}}}finally{o8=!1,Error.prepareStackTrace=n}return(n=t?t.displayName||t.name:"")?_1(n):""}function xNe(t){switch(t.tag){case 26:case 27:case 5:return _1(t.type);case 16:return _1("Lazy");case 13:return _1("Suspense");case 19:return _1("SuspenseList");case 0:case 15:return c8(t.type,!1);case 11:return c8(t.type.render,!1);case 1:return c8(t.type,!0);case 31:return _1("Activity");default:return""}}function cJ(t){try{var e="";do e+=xNe(t),t=t.return;while(t);return e}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Af(t){switch(typeof t){case"bigint":case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ice(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wNe(t){var e=ice(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function HL(t){t._valueTracker||(t._valueTracker=wNe(t))}function rce(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=ice(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function jL(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}var CNe=/[\n"\\]/g;function Pf(t){return t.replace(CNe,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function i5(t,e,n,i,r,s,a,o){t.name="",a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"?t.type=a:t.removeAttribute("type"),e!=null?a==="number"?(e===0&&t.value===""||t.value!=e)&&(t.value=""+Af(e)):t.value!==""+Af(e)&&(t.value=""+Af(e)):a!=="submit"&&a!=="reset"||t.removeAttribute("value"),e!=null?r5(t,a,Af(e)):n!=null?r5(t,a,Af(n)):i!=null&&t.removeAttribute("value"),r==null&&s!=null&&(t.defaultChecked=!!s),r!=null&&(t.checked=r&&typeof r!="function"&&typeof r!="symbol"),o!=null&&typeof o!="function"&&typeof o!="symbol"&&typeof o!="boolean"?t.name=""+Af(o):t.removeAttribute("name")}function sce(t,e,n,i,r,s,a,o){if(s!=null&&typeof s!="function"&&typeof s!="symbol"&&typeof s!="boolean"&&(t.type=s),e!=null||n!=null){if(!(s!=="submit"&&s!=="reset"||e!=null))return;n=n!=null?""+Af(n):"",e=e!=null?""+Af(e):n,o||e===t.value||(t.value=e),t.defaultValue=e}i=i??r,i=typeof i!="function"&&typeof i!="symbol"&&!!i,t.checked=o?t.checked:!!i,t.defaultChecked=!!i,a!=null&&typeof a!="function"&&typeof a!="symbol"&&typeof a!="boolean"&&(t.name=a)}function r5(t,e,n){e==="number"&&jL(t.ownerDocument)===t||t.defaultValue===""+n||(t.defaultValue=""+n)}function aw(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+Af(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function ace(t,e,n){if(e!=null&&(e=""+Af(e),e!==t.value&&(t.value=e),n==null)){t.defaultValue!==e&&(t.defaultValue=e);return}t.defaultValue=n!=null?""+Af(n):""}function oce(t,e,n,i){if(e==null){if(i!=null){if(n!=null)throw Error(jt(92));if(pA(i)){if(1<i.length)throw Error(jt(93));i=i[0]}n=i}n==null&&(n=""),e=n}n=Af(e),t.defaultValue=n,i=t.textContent,i===n&&i!==""&&i!==null&&(t.value=i)}function qw(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var RNe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function lJ(t,e,n){var i=e.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?i?t.setProperty(e,""):e==="float"?t.cssFloat="":t[e]="":i?t.setProperty(e,n):typeof n!="number"||n===0||RNe.has(e)?e==="float"?t.cssFloat=n:t[e]=(""+n).trim():t[e]=n+"px"}function cce(t,e,n){if(e!=null&&typeof e!="object")throw Error(jt(62));if(t=t.style,n!=null){for(var i in n)!n.hasOwnProperty(i)||e!=null&&e.hasOwnProperty(i)||(i.indexOf("--")===0?t.setProperty(i,""):i==="float"?t.cssFloat="":t[i]="");for(var r in e)i=e[r],e.hasOwnProperty(r)&&n[r]!==i&&lJ(t,r,i)}else for(var s in e)e.hasOwnProperty(s)&&lJ(t,s,e[s])}function h$(t){if(t.indexOf("-")===-1)return!1;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ANe=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MNe=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function HD(t){return MNe.test(""+t)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":t}var s5=null;function d$(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var L1=null,ow=null;function uJ(t){var e=HC(t);if(e&&(t=e.stateNode)){var n=t[Wh]||null;e:switch(t=e.stateNode,e.type){case"input":if(i5(t,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Pf(""+e)+'"][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=i[Wh]||null;if(!r)throw Error(jt(90));i5(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(e=0;e<n.length;e++)i=n[e],i.form===t.form&&rce(i)}break e;case"textarea":ace(t,n.value,n.defaultValue);break e;case"select":e=n.value,e!=null&&aw(t,!!n.multiple,e,!1)}}}var l8=!1;function lce(t,e,n){if(l8)return t(e,n);l8=!0;try{var i=t(e);return i}finally{if(l8=!1,(L1!==null||ow!==null)&&(U3(),L1&&(e=L1,t=ow,ow=L1=null,uJ(e),t)))for(e=0;e<t.length;e++)uJ(t[e])}}function DM(t,e){var n=t.stateNode;if(n===null)return null;var i=n[Wh]||null;if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(jt(231,e,typeof n));return n}var Jv=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a5=!1;if(Jv)try{var FR={};Object.defineProperty(FR,"passive",{get:function(){a5=!0}}),window.addEventListener("test",FR,FR),window.removeEventListener("test",FR,FR)}catch{a5=!1}var q_=null,f$=null,jD=null;function uce(){if(jD)return jD;var t,e=f$,n=e.length,i,r="value"in q_?q_.value:q_.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return jD=r.slice(t,1<i?1-i:void 0)}function VD(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Pk(){return!0}function hJ(){return!1}function id(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Pk:hJ,this.isPropagationStopped=hJ,this}return Sa(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pk)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pk)},persist:function(){},isPersistent:Pk}),e}var FT={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},A3=id(FT),dN=Sa({},FT,{view:0,detail:0}),ONe=id(dN),u8,h8,zR,M3=Sa({},dN,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p$,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==zR&&(zR&&t.type==="mousemove"?(u8=t.screenX-zR.screenX,h8=t.screenY-zR.screenY):h8=u8=0,zR=t),u8)},movementY:function(t){return"movementY"in t?t.movementY:h8}}),dJ=id(M3),NNe=Sa({},M3,{dataTransfer:0}),INe=id(NNe),kNe=Sa({},dN,{relatedTarget:0}),d8=id(kNe),DNe=Sa({},FT,{animationName:0,elapsedTime:0,pseudoElement:0}),PNe=id(DNe),LNe=Sa({},FT,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),UNe=id(LNe),BNe=Sa({},FT,{data:0}),fJ=id(BNe),FNe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zNe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},HNe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jNe(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=HNe[t])?!!e[t]:!1}function p$(){return jNe}var VNe=Sa({},dN,{key:function(t){if(t.key){var e=FNe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=VD(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zNe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p$,charCode:function(t){return t.type==="keypress"?VD(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?VD(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),GNe=id(VNe),qNe=Sa({},M3,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),pJ=id(qNe),$Ne=Sa({},dN,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p$}),WNe=id($Ne),YNe=Sa({},FT,{propertyName:0,elapsedTime:0,pseudoElement:0}),XNe=id(YNe),KNe=Sa({},M3,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),JNe=id(KNe),ZNe=Sa({},FT,{newState:0,oldState:0}),QNe=id(ZNe),eIe=[9,13,27,32],m$=Jv&&"CompositionEvent"in window,BA=null;Jv&&"documentMode"in document&&(BA=document.documentMode);var tIe=Jv&&"TextEvent"in window&&!BA,hce=Jv&&(!m$||BA&&8<BA&&11>=BA),mJ=" ",gJ=!1;function dce(t,e){switch(t){case"keyup":return eIe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fce(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var U1=!1;function nIe(t,e){switch(t){case"compositionend":return fce(e);case"keypress":return e.which!==32?null:(gJ=!0,mJ);case"textInput":return t=e.data,t===mJ&&gJ?null:t;default:return null}}function iIe(t,e){if(U1)return t==="compositionend"||!m$&&dce(t,e)?(t=uce(),jD=f$=q_=null,U1=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return hce&&e.locale!=="ko"?null:e.data;default:return null}}var rIe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vJ(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rIe[t.type]:e==="textarea"}function pce(t,e,n,i){L1?ow?ow.push(i):ow=[i]:L1=i,e=a2(e,"onChange"),0<e.length&&(n=new A3("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var FA=null,PM=null;function sIe(t){aue(t,0)}function O3(t){var e=mA(t);if(rce(e))return t}function yJ(t,e){if(t==="change")return e}var mce=!1;if(Jv){var f8;if(Jv){var p8="oninput"in document;if(!p8){var _J=document.createElement("div");_J.setAttribute("oninput","return;"),p8=typeof _J.oninput=="function"}f8=p8}else f8=!1;mce=f8&&(!document.documentMode||9<document.documentMode)}function bJ(){FA&&(FA.detachEvent("onpropertychange",gce),PM=FA=null)}function gce(t){if(t.propertyName==="value"&&O3(PM)){var e=[];pce(e,PM,t,d$(t)),lce(sIe,e)}}function aIe(t,e,n){t==="focusin"?(bJ(),FA=e,PM=n,FA.attachEvent("onpropertychange",gce)):t==="focusout"&&bJ()}function oIe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return O3(PM)}function cIe(t,e){if(t==="click")return O3(e)}function lIe(t,e){if(t==="input"||t==="change")return O3(e)}function uIe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Wd=typeof Object.is=="function"?Object.is:uIe;function LM(t,e){if(Wd(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!t5.call(e,r)||!Wd(t[r],e[r]))return!1}return!0}function EJ(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function SJ(t,e){var n=EJ(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=EJ(n)}}function vce(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?vce(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function yce(t){t=t!=null&&t.ownerDocument!=null&&t.ownerDocument.defaultView!=null?t.ownerDocument.defaultView:window;for(var e=jL(t.document);e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jL(t.document)}return e}function g$(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}var hIe=Jv&&"documentMode"in document&&11>=document.documentMode,B1=null,o5=null,zA=null,c5=!1;function TJ(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;c5||B1==null||B1!==jL(i)||(i=B1,"selectionStart"in i&&g$(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),zA&&LM(zA,i)||(zA=i,i=a2(o5,"onSelect"),0<i.length&&(e=new A3("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=B1)))}function nS(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var F1={animationend:nS("Animation","AnimationEnd"),animationiteration:nS("Animation","AnimationIteration"),animationstart:nS("Animation","AnimationStart"),transitionrun:nS("Transition","TransitionRun"),transitionstart:nS("Transition","TransitionStart"),transitioncancel:nS("Transition","TransitionCancel"),transitionend:nS("Transition","TransitionEnd")},m8={},_ce={};Jv&&(_ce=document.createElement("div").style,"AnimationEvent"in window||(delete F1.animationend.animation,delete F1.animationiteration.animation,delete F1.animationstart.animation),"TransitionEvent"in window||delete F1.transitionend.transition);function zT(t){if(m8[t])return m8[t];if(!F1[t])return t;var e=F1[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in _ce)return m8[t]=e[n];return t}var bce=zT("animationend"),Ece=zT("animationiteration"),Sce=zT("animationstart"),dIe=zT("transitionrun"),fIe=zT("transitionstart"),pIe=zT("transitioncancel"),Tce=zT("transitionend"),xce=new Map,l5="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");l5.push("scrollEnd");function om(t,e){xce.set(t,e),BT(e,[t])}var xJ=new WeakMap;function Lf(t,e){if(typeof t=="object"&&t!==null){var n=xJ.get(t);return n!==void 0?n:(e={value:t,source:e,stack:cJ(e)},xJ.set(t,e),e)}return{value:t,source:e,stack:cJ(e)}}var xf=[],z1=0,v$=0;function N3(){for(var t=z1,e=v$=z1=0;e<t;){var n=xf[e];xf[e++]=null;var i=xf[e];xf[e++]=null;var r=xf[e];xf[e++]=null;var s=xf[e];if(xf[e++]=null,i!==null&&r!==null){var a=i.pending;a===null?r.next=r:(r.next=a.next,a.next=r),i.pending=r}s!==0&&wce(n,r,s)}}function I3(t,e,n,i){xf[z1++]=t,xf[z1++]=e,xf[z1++]=n,xf[z1++]=i,v$|=i,t.lanes|=i,t=t.alternate,t!==null&&(t.lanes|=i)}function y$(t,e,n,i){return I3(t,e,n,i),VL(t)}function jC(t,e){return I3(t,null,null,e),VL(t)}function wce(t,e,n){t.lanes|=n;var i=t.alternate;i!==null&&(i.lanes|=n);for(var r=!1,s=t.return;s!==null;)s.childLanes|=n,i=s.alternate,i!==null&&(i.childLanes|=n),s.tag===22&&(t=s.stateNode,t===null||t._visibility&1||(r=!0)),t=s,s=s.return;return t.tag===3?(s=t.stateNode,r&&e!==null&&(r=31-jd(n),t=s.hiddenUpdates,i=t[r],i===null?t[r]=[e]:i.push(e),e.lane=n|536870912),s):null}function VL(t){if(50<KA)throw KA=0,O5=null,Error(jt(185));for(var e=t.return;e!==null;)t=e,e=t.return;return t.tag===3?t.stateNode:null}var H1={};function mIe(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bd(t,e,n,i){return new mIe(t,e,n,i)}function _$(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Hv(t,e){var n=t.alternate;return n===null?(n=Bd(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&65011712,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n.refCleanup=t.refCleanup,n}function Cce(t,e){t.flags&=65011714;var n=t.alternate;return n===null?(t.childLanes=0,t.lanes=e,t.child=null,t.subtreeFlags=0,t.memoizedProps=null,t.memoizedState=null,t.updateQueue=null,t.dependencies=null,t.stateNode=null):(t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.subtreeFlags=0,t.deletions=null,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,t.type=n.type,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),t}function GD(t,e,n,i,r,s){var a=0;if(i=t,typeof t=="function")_$(t)&&(a=1);else if(typeof t=="string")a=vke(t,n,Sg.current)?26:t==="html"||t==="head"||t==="body"?27:5;else e:switch(t){case Jj:return t=Bd(31,n,e,r),t.elementType=Jj,t.lanes=s,t;case k1:return HS(n.children,r,s,e);case qoe:a=8,r|=24;break;case Yj:return t=Bd(12,n,e,r|2),t.elementType=Yj,t.lanes=s,t;case Xj:return t=Bd(13,n,e,r),t.elementType=Xj,t.lanes=s,t;case Kj:return t=Bd(19,n,e,r),t.elementType=Kj,t.lanes=s,t;default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case sNe:case Nv:a=10;break e;case $oe:a=9;break e;case s$:a=11;break e;case a$:a=14;break e;case C_:a=16,i=null;break e}a=29,n=Error(jt(130,t===null?"null":typeof t,"")),i=null}return e=Bd(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function HS(t,e,n,i){return t=Bd(7,t,i,e),t.lanes=n,t}function g8(t,e,n){return t=Bd(6,t,null,e),t.lanes=n,t}function v8(t,e,n){return e=Bd(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}var j1=[],V1=0,GL=null,qL=0,Mf=[],Of=0,jS=null,Iv=1,kv="";function gS(t,e){j1[V1++]=qL,j1[V1++]=GL,GL=t,qL=e}function Rce(t,e,n){Mf[Of++]=Iv,Mf[Of++]=kv,Mf[Of++]=jS,jS=t;var i=Iv;t=kv;var r=32-jd(i)-1;i&=~(1<<r),n+=1;var s=32-jd(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Iv=1<<32-jd(e)+r|n<<r|i,kv=s+t}else Iv=1<<s|n<<r|i,kv=t}function b$(t){t.return!==null&&(gS(t,1),Rce(t,1,0))}function E$(t){for(;t===GL;)GL=j1[--V1],j1[V1]=null,qL=j1[--V1],j1[V1]=null;for(;t===jS;)jS=Mf[--Of],Mf[Of]=null,kv=Mf[--Of],Mf[Of]=null,Iv=Mf[--Of],Mf[Of]=null}var Xu=null,go=null,ms=!1,VS=null,hg=!1,u5=Error(jt(519));function aT(t){var e=Error(jt(418,""));throw UM(Lf(e,t)),u5}function wJ(t){var e=t.stateNode,n=t.type,i=t.memoizedProps;switch(e[su]=t,e[Wh]=i,n){case"dialog":wr("cancel",e),wr("close",e);break;case"iframe":case"object":case"embed":wr("load",e);break;case"video":case"audio":for(n=0;n<zM.length;n++)wr(zM[n],e);break;case"source":wr("error",e);break;case"img":case"image":case"link":wr("error",e),wr("load",e);break;case"details":wr("toggle",e);break;case"input":wr("invalid",e),sce(e,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0),HL(e);break;case"select":wr("invalid",e);break;case"textarea":wr("invalid",e),oce(e,i.value,i.defaultValue,i.children),HL(e)}n=i.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||e.textContent===""+n||i.suppressHydrationWarning===!0||cue(e.textContent,n)?(i.popover!=null&&(wr("beforetoggle",e),wr("toggle",e)),i.onScroll!=null&&wr("scroll",e),i.onScrollEnd!=null&&wr("scrollend",e),i.onClick!=null&&(e.onclick=z3),e=!0):e=!1,e||aT(t)}function CJ(t){for(Xu=t.return;Xu;)switch(Xu.tag){case 5:case 13:hg=!1;return;case 27:case 3:hg=!0;return;default:Xu=Xu.return}}function HR(t){if(t!==Xu)return!1;if(!ms)return CJ(t),ms=!0,!1;var e=t.tag,n;if((n=e!==3&&e!==27)&&((n=e===5)&&(n=t.type,n=!(n!=="form"&&n!=="button")||L5(t.type,t.memoizedProps)),n=!n),n&&go&&aT(t),CJ(t),e===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(jt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8)if(n=t.data,n==="/$"){if(e===0){go=Jp(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++;t=t.nextSibling}go=null}}else e===27?(e=go,Gb(t.type)?(t=F5,F5=null,go=t):go=e):go=Xu?Jp(t.stateNode.nextSibling):null;return!0}function fN(){go=Xu=null,ms=!1}function RJ(){var t=VS;return t!==null&&(Oh===null?Oh=t:Oh.push.apply(Oh,t),VS=null),t}function UM(t){VS===null?VS=[t]:VS.push(t)}var h5=Xg(null),HT=null,Dv=null;function B_(t,e,n){Da(h5,e._currentValue),e._currentValue=n}function jv(t){t._currentValue=h5.current,dl(h5)}function d5(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function f5(t,e,n,i){var r=t.child;for(r!==null&&(r.return=t);r!==null;){var s=r.dependencies;if(s!==null){var a=r.child;s=s.firstContext;e:for(;s!==null;){var o=s;s=r;for(var c=0;c<e.length;c++)if(o.context===e[c]){s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),d5(s.return,n,t),i||(a=null);break e}s=o.next}}else if(r.tag===18){if(a=r.return,a===null)throw Error(jt(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),d5(a,n,t),a=null}else a=r.child;if(a!==null)a.return=r;else for(a=r;a!==null;){if(a===t){a=null;break}if(r=a.sibling,r!==null){r.return=a.return,a=r;break}a=a.return}r=a}}function pN(t,e,n,i){t=null;for(var r=e,s=!1;r!==null;){if(!s){if(r.flags&524288)s=!0;else if(r.flags&262144)break}if(r.tag===10){var a=r.alternate;if(a===null)throw Error(jt(387));if(a=a.memoizedProps,a!==null){var o=r.type;Wd(r.pendingProps.value,a.value)||(t!==null?t.push(o):t=[o])}}else if(r===UL.current){if(a=r.alternate,a===null)throw Error(jt(387));a.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(t!==null?t.push(VM):t=[VM])}r=r.return}t!==null&&f5(e,t,n,i),e.flags|=262144}function $L(t){for(t=t.firstContext;t!==null;){if(!Wd(t.context._currentValue,t.memoizedValue))return!0;t=t.next}return!1}function oT(t){HT=t,Dv=null,t=t.dependencies,t!==null&&(t.firstContext=null)}function au(t){return Ace(HT,t)}function Lk(t,e){return HT===null&&oT(t),Ace(t,e)}function Ace(t,e){var n=e._currentValue;if(e={context:e,memoizedValue:n,next:null},Dv===null){if(t===null)throw Error(jt(308));Dv=e,t.dependencies={lanes:0,firstContext:e},t.flags|=524288}else Dv=Dv.next=e;return n}var gIe=typeof AbortController<"u"?AbortController:function(){var t=[],e=this.signal={aborted:!1,addEventListener:function(n,i){t.push(i)}};this.abort=function(){e.aborted=!0,t.forEach(function(n){return n()})}},vIe=Hc.unstable_scheduleCallback,yIe=Hc.unstable_NormalPriority,Oc={$$typeof:Nv,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function S$(){return{controller:new gIe,data:new Map,refCount:0}}function mN(t){t.refCount--,t.refCount===0&&vIe(yIe,function(){t.controller.abort()})}var HA=null,p5=0,$w=0,cw=null;function _Ie(t,e){if(HA===null){var n=HA=[];p5=0,$w=q$(),cw={status:"pending",value:void 0,then:function(i){n.push(i)}}}return p5++,e.then(AJ,AJ),e}function AJ(){if(--p5===0&&HA!==null){cw!==null&&(cw.status="fulfilled");var t=HA;HA=null,$w=0,cw=null;for(var e=0;e<t.length;e++)(0,t[e])()}}function bIe(t,e){var n=[],i={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return t.then(function(){i.status="fulfilled",i.value=e;for(var r=0;r<n.length;r++)(0,n[r])(e)},function(r){for(i.status="rejected",i.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),i}var MJ=Ui.S;Ui.S=function(t,e){typeof e=="object"&&e!==null&&typeof e.then=="function"&&_Ie(t,e),MJ!==null&&MJ(t,e)};var GS=Xg(null);function T$(){var t=GS.current;return t!==null?t:ra.pooledCache}function qD(t,e){e===null?Da(GS,GS.current):Da(GS,e.pool)}function Mce(){var t=T$();return t===null?null:{parent:Oc._currentValue,pool:t}}var gN=Error(jt(460)),Oce=Error(jt(474)),k3=Error(jt(542)),m5={then:function(){}};function OJ(t){return t=t.status,t==="fulfilled"||t==="rejected"}function Uk(){}function Nce(t,e,n){switch(n=t[n],n===void 0?t.push(e):n!==e&&(e.then(Uk,Uk),e=n),e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,IJ(t),t;default:if(typeof e.status=="string")e.then(Uk,Uk);else{if(t=ra,t!==null&&100<t.shellSuspendCounter)throw Error(jt(482));t=e,t.status="pending",t.then(function(i){if(e.status==="pending"){var r=e;r.status="fulfilled",r.value=i}},function(i){if(e.status==="pending"){var r=e;r.status="rejected",r.reason=i}})}switch(e.status){case"fulfilled":return e.value;case"rejected":throw t=e.reason,IJ(t),t}throw jA=e,gN}}var jA=null;function NJ(){if(jA===null)throw Error(jt(459));var t=jA;return jA=null,t}function IJ(t){if(t===gN||t===k3)throw Error(jt(483))}var R_=!1;function x$(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function g5(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,callbacks:null})}function Z_(t){return{lane:t,tag:0,payload:null,callback:null,next:null}}function Q_(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Rs&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,e=VL(t),wce(t,null,n),e}return I3(t,i,e,n),VL(t)}function VA(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194048)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Qoe(t,n)}}function y8(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,callbacks:i.callbacks},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}var v5=!1;function GA(){if(v5){var t=cw;if(t!==null)throw t}}function qA(t,e,n,i){v5=!1;var r=t.updateQueue;R_=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var c=o,l=c.next;c.next=null,a===null?s=l:a.next=l,a=c;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=l:o.next=l,u.lastBaseUpdate=c))}if(s!==null){var h=r.baseState;a=0,u=l=c=null,o=s;do{var d=o.lane&-536870913,f=d!==o.lane;if(f?(Vr&d)===d:(i&d)===d){d!==0&&d===$w&&(v5=!0),u!==null&&(u=u.next={lane:0,tag:o.tag,payload:o.payload,callback:null,next:null});e:{var p=t,g=o;d=e;var _=n;switch(g.tag){case 1:if(p=g.payload,typeof p=="function"){h=p.call(_,h,d);break e}h=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,d=typeof p=="function"?p.call(_,h,d):p,d==null)break e;h=Sa({},h,d);break e;case 2:R_=!0}}d=o.callback,d!==null&&(t.flags|=64,f&&(t.flags|=8192),f=r.callbacks,f===null?r.callbacks=[d]:f.push(d))}else f={lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(l=u=f,c=h):u=u.next=f,a|=d;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;f=o,o=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);u===null&&(c=h),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,s===null&&(r.shared.lanes=0),Eb|=a,t.lanes=a,t.memoizedState=h}}function Ice(t,e){if(typeof t!="function")throw Error(jt(191,t));t.call(e)}function kce(t,e){var n=t.callbacks;if(n!==null)for(t.callbacks=null,t=0;t<n.length;t++)Ice(n[t],e)}var Ww=Xg(null),WL=Xg(0);function kJ(t,e){t=ey,Da(WL,t),Da(Ww,e),ey=t|e.baseLanes}function y5(){Da(WL,ey),Da(Ww,Ww.current)}function w$(){ey=WL.current,dl(Ww),dl(WL)}var _b=0,vr=null,Bs=null,ac=null,YL=!1,lw=!1,cT=!1,XL=0,BM=0,uw=null,EIe=0;function Io(){throw Error(jt(321))}function C$(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Wd(t[n],e[n]))return!1;return!0}function R$(t,e,n,i,r,s){return _b=s,vr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ui.H=t===null||t.memoizedState===null?ule:hle,cT=!1,s=n(i,r),cT=!1,lw&&(s=Pce(e,n,i,r)),Dce(t),s}function Dce(t){Ui.H=KL;var e=Bs!==null&&Bs.next!==null;if(_b=0,ac=Bs=vr=null,YL=!1,BM=0,uw=null,e)throw Error(jt(300));t===null||ul||(t=t.dependencies,t!==null&&$L(t)&&(ul=!0))}function Pce(t,e,n,i){vr=t;var r=0;do{if(lw&&(uw=null),BM=0,lw=!1,25<=r)throw Error(jt(301));if(r+=1,ac=Bs=null,t.updateQueue!=null){var s=t.updateQueue;s.lastEffect=null,s.events=null,s.stores=null,s.memoCache!=null&&(s.memoCache.index=0)}Ui.H=AIe,s=e(n,i)}while(lw);return s}function SIe(){var t=Ui.H,e=t.useState()[0];return e=typeof e.then=="function"?vN(e):e,t=t.useState()[0],(Bs!==null?Bs.memoizedState:null)!==t&&(vr.flags|=1024),e}function A$(){var t=XL!==0;return XL=0,t}function M$(t,e,n){e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~n}function O$(t){if(YL){for(t=t.memoizedState;t!==null;){var e=t.queue;e!==null&&(e.pending=null),t=t.next}YL=!1}_b=0,ac=Bs=vr=null,lw=!1,BM=XL=0,uw=null}function Rh(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ac===null?vr.memoizedState=ac=t:ac=ac.next=t,ac}function lc(){if(Bs===null){var t=vr.alternate;t=t!==null?t.memoizedState:null}else t=Bs.next;var e=ac===null?vr.memoizedState:ac.next;if(e!==null)ac=e,Bs=t;else{if(t===null)throw vr.alternate===null?Error(jt(467)):Error(jt(310));Bs=t,t={memoizedState:Bs.memoizedState,baseState:Bs.baseState,baseQueue:Bs.baseQueue,queue:Bs.queue,next:null},ac===null?vr.memoizedState=ac=t:ac=ac.next=t}return ac}function N$(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vN(t){var e=BM;return BM+=1,uw===null&&(uw=[]),t=Nce(uw,t,e),e=vr,(ac===null?e.memoizedState:ac.next)===null&&(e=e.alternate,Ui.H=e===null||e.memoizedState===null?ule:hle),t}function D3(t){if(t!==null&&typeof t=="object"){if(typeof t.then=="function")return vN(t);if(t.$$typeof===Nv)return au(t)}throw Error(jt(438,String(t)))}function I$(t){var e=null,n=vr.updateQueue;if(n!==null&&(e=n.memoCache),e==null){var i=vr.alternate;i!==null&&(i=i.updateQueue,i!==null&&(i=i.memoCache,i!=null&&(e={data:i.data.map(function(r){return r.slice()}),index:0})))}if(e==null&&(e={data:[],index:0}),n===null&&(n=N$(),vr.updateQueue=n),n.memoCache=e,n=e.data[e.index],n===void 0)for(n=e.data[e.index]=Array(t),i=0;i<t;i++)n[i]=aNe;return e.index++,n}function Zv(t,e){return typeof e=="function"?e(t):e}function $D(t){var e=lc();return k$(e,Bs,t)}function k$(t,e,n){var i=t.queue;if(i===null)throw Error(jt(311));i.lastRenderedReducer=n;var r=t.baseQueue,s=i.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}e.baseQueue=r=s,i.pending=null}if(s=t.baseState,r===null)t.memoizedState=s;else{e=r.next;var o=a=null,c=null,l=e,u=!1;do{var h=l.lane&-536870913;if(h!==l.lane?(Vr&h)===h:(_b&h)===h){var d=l.revertLane;if(d===0)c!==null&&(c=c.next={lane:0,revertLane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),h===$w&&(u=!0);else if((_b&d)===d){l=l.next,d===$w&&(u=!0);continue}else h={lane:0,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=h,a=s):c=c.next=h,vr.lanes|=d,Eb|=d;h=l.action,cT&&n(s,h),s=l.hasEagerState?l.eagerState:n(s,h)}else d={lane:h,revertLane:l.revertLane,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null},c===null?(o=c=d,a=s):c=c.next=d,vr.lanes|=h,Eb|=h;l=l.next}while(l!==null&&l!==e);if(c===null?a=s:c.next=o,!Wd(s,t.memoizedState)&&(ul=!0,u&&(n=cw,n!==null)))throw n;t.memoizedState=s,t.baseState=a,t.baseQueue=c,i.lastRenderedState=s}return r===null&&(i.lanes=0),[t.memoizedState,i.dispatch]}function _8(t){var e=lc(),n=e.queue;if(n===null)throw Error(jt(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);Wd(s,e.memoizedState)||(ul=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Lce(t,e,n){var i=vr,r=lc(),s=ms;if(s){if(n===void 0)throw Error(jt(407));n=n()}else n=e();var a=!Wd((Bs||r).memoizedState,n);a&&(r.memoizedState=n,ul=!0),r=r.queue;var o=Fce.bind(null,i,r,t);if(yN(2048,8,o,[t]),r.getSnapshot!==e||a||ac!==null&&ac.memoizedState.tag&1){if(i.flags|=2048,Yw(9,P3(),Bce.bind(null,i,r,n,e),null),ra===null)throw Error(jt(349));s||_b&124||Uce(i,e,n)}return n}function Uce(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=vr.updateQueue,e===null?(e=N$(),vr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Bce(t,e,n,i){e.value=n,e.getSnapshot=i,zce(e)&&Hce(t)}function Fce(t,e,n){return n(function(){zce(e)&&Hce(t)})}function zce(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Wd(t,n)}catch{return!0}}function Hce(t){var e=jC(t,2);e!==null&&Gd(e,t,2)}function _5(t){var e=Rh();if(typeof t=="function"){var n=t;if(t=n(),cT){G_(!0);try{n()}finally{G_(!1)}}}return e.memoizedState=e.baseState=t,e.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zv,lastRenderedState:t},e}function jce(t,e,n,i){return t.baseState=n,k$(t,Bs,typeof i=="function"?i:Zv)}function TIe(t,e,n,i,r){if(L3(t))throw Error(jt(485));if(t=e.action,t!==null){var s={payload:r,action:t,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(a){s.listeners.push(a)}};Ui.T!==null?n(!0):s.isTransition=!1,i(s),n=e.pending,n===null?(s.next=e.pending=s,Vce(e,s)):(s.next=n.next,e.pending=n.next=s)}}function Vce(t,e){var n=e.action,i=e.payload,r=t.state;if(e.isTransition){var s=Ui.T,a={};Ui.T=a;try{var o=n(r,i),c=Ui.S;c!==null&&c(a,o),DJ(t,e,o)}catch(l){b5(t,e,l)}finally{Ui.T=s}}else try{s=n(r,i),DJ(t,e,s)}catch(l){b5(t,e,l)}}function DJ(t,e,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(i){PJ(t,e,i)},function(i){return b5(t,e,i)}):PJ(t,e,n)}function PJ(t,e,n){e.status="fulfilled",e.value=n,Gce(e),t.state=n,e=t.pending,e!==null&&(n=e.next,n===e?t.pending=null:(n=n.next,e.next=n,Vce(t,n)))}function b5(t,e,n){var i=t.pending;if(t.pending=null,i!==null){i=i.next;do e.status="rejected",e.reason=n,Gce(e),e=e.next;while(e!==i)}t.action=null}function Gce(t){t=t.listeners;for(var e=0;e<t.length;e++)(0,t[e])()}function qce(t,e){return e}function LJ(t,e){if(ms){var n=ra.formState;if(n!==null){e:{var i=vr;if(ms){if(go){t:{for(var r=go,s=hg;r.nodeType!==8;){if(!s){r=null;break t}if(r=Jp(r.nextSibling),r===null){r=null;break t}}s=r.data,r=s==="F!"||s==="F"?r:null}if(r){go=Jp(r.nextSibling),i=r.data==="F!";break e}}aT(i)}i=!1}i&&(e=n[0])}}return n=Rh(),n.memoizedState=n.baseState=e,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qce,lastRenderedState:e},n.queue=i,n=ole.bind(null,vr,i),i.dispatch=n,i=_5(!1),s=U$.bind(null,vr,!1,i.queue),i=Rh(),r={state:e,dispatch:null,action:t,pending:null},i.queue=r,n=TIe.bind(null,vr,r,s,n),r.dispatch=n,i.memoizedState=t,[e,n,!1]}function UJ(t){var e=lc();return $ce(e,Bs,t)}function $ce(t,e,n){if(e=k$(t,e,qce)[0],t=$D(Zv)[0],typeof e=="object"&&e!==null&&typeof e.then=="function")try{var i=vN(e)}catch(a){throw a===gN?k3:a}else i=e;e=lc();var r=e.queue,s=r.dispatch;return n!==e.memoizedState&&(vr.flags|=2048,Yw(9,P3(),xIe.bind(null,r,n),null)),[i,s,t]}function xIe(t,e){t.action=e}function BJ(t){var e=lc(),n=Bs;if(n!==null)return $ce(e,n,t);lc(),e=e.memoizedState,n=lc();var i=n.queue.dispatch;return n.memoizedState=t,[e,i,!1]}function Yw(t,e,n,i){return t={tag:t,create:n,deps:i,inst:e,next:null},e=vr.updateQueue,e===null&&(e=N$(),vr.updateQueue=e),n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function P3(){return{destroy:void 0,resource:void 0}}function Wce(){return lc().memoizedState}function WD(t,e,n,i){var r=Rh();i=i===void 0?null:i,vr.flags|=t,r.memoizedState=Yw(1|e,P3(),n,i)}function yN(t,e,n,i){var r=lc();i=i===void 0?null:i;var s=r.memoizedState.inst;Bs!==null&&i!==null&&C$(i,Bs.memoizedState.deps)?r.memoizedState=Yw(e,s,n,i):(vr.flags|=t,r.memoizedState=Yw(1|e,s,n,i))}function FJ(t,e){WD(8390656,8,t,e)}function Yce(t,e){yN(2048,8,t,e)}function Xce(t,e){return yN(4,2,t,e)}function Kce(t,e){return yN(4,4,t,e)}function Jce(t,e){if(typeof e=="function"){t=t();var n=e(t);return function(){typeof n=="function"?n():e(null)}}if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Zce(t,e,n){n=n!=null?n.concat([t]):null,yN(4,4,Jce.bind(null,e,t),n)}function D$(){}function Qce(t,e){var n=lc();e=e===void 0?null:e;var i=n.memoizedState;return e!==null&&C$(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function ele(t,e){var n=lc();e=e===void 0?null:e;var i=n.memoizedState;if(e!==null&&C$(e,i[1]))return i[0];if(i=t(),cT){G_(!0);try{t()}finally{G_(!1)}}return n.memoizedState=[i,e],i}function P$(t,e,n){return n===void 0||_b&1073741824?t.memoizedState=e:(t.memoizedState=n,t=Gle(),vr.lanes|=t,Eb|=t,n)}function tle(t,e,n,i){return Wd(n,e)?n:Ww.current!==null?(t=P$(t,n,i),Wd(t,e)||(ul=!0),t):_b&42?(t=Gle(),vr.lanes|=t,Eb|=t,e):(ul=!0,t.memoizedState=n)}function nle(t,e,n,i,r){var s=gs.p;gs.p=s!==0&&8>s?s:8;var a=Ui.T,o={};Ui.T=o,U$(t,!1,e,n);try{var c=r(),l=Ui.S;if(l!==null&&l(o,c),c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=bIe(c,i);$A(t,e,u,Vd(t))}else $A(t,e,i,Vd(t))}catch(h){$A(t,e,{then:function(){},status:"rejected",reason:h},Vd())}finally{gs.p=s,Ui.T=a}}function wIe(){}function E5(t,e,n,i){if(t.tag!==5)throw Error(jt(476));var r=ile(t).queue;nle(t,r,e,zS,n===null?wIe:function(){return rle(t),n(i)})}function ile(t){var e=t.memoizedState;if(e!==null)return e;e={memoizedState:zS,baseState:zS,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zv,lastRenderedState:zS},next:null};var n={};return e.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zv,lastRenderedState:n},next:null},t.memoizedState=e,t=t.alternate,t!==null&&(t.memoizedState=e),e}function rle(t){var e=ile(t).next.queue;$A(t,e,{},Vd())}function L$(){return au(VM)}function sle(){return lc().memoizedState}function ale(){return lc().memoizedState}function CIe(t){for(var e=t.return;e!==null;){switch(e.tag){case 24:case 3:var n=Vd();t=Z_(n);var i=Q_(e,t,n);i!==null&&(Gd(i,e,n),VA(i,e,n)),e={cache:S$()},t.payload=e;return}e=e.return}}function RIe(t,e,n){var i=Vd();n={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},L3(t)?cle(e,n):(n=y$(t,e,n,i),n!==null&&(Gd(n,t,i),lle(n,e,i)))}function ole(t,e,n){var i=Vd();$A(t,e,n,i)}function $A(t,e,n,i){var r={lane:i,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(L3(t))cle(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,Wd(o,a))return I3(t,e,r,0),ra===null&&N3(),!1}catch{}finally{}if(n=y$(t,e,r,i),n!==null)return Gd(n,t,i),lle(n,e,i),!0}return!1}function U$(t,e,n,i){if(i={lane:2,revertLane:q$(),action:i,hasEagerState:!1,eagerState:null,next:null},L3(t)){if(e)throw Error(jt(479))}else e=y$(t,n,i,2),e!==null&&Gd(e,t,2)}function L3(t){var e=t.alternate;return t===vr||e!==null&&e===vr}function cle(t,e){lw=YL=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function lle(t,e,n){if(n&4194048){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Qoe(t,n)}}var KL={readContext:au,use:D3,useCallback:Io,useContext:Io,useEffect:Io,useImperativeHandle:Io,useLayoutEffect:Io,useInsertionEffect:Io,useMemo:Io,useReducer:Io,useRef:Io,useState:Io,useDebugValue:Io,useDeferredValue:Io,useTransition:Io,useSyncExternalStore:Io,useId:Io,useHostTransitionStatus:Io,useFormState:Io,useActionState:Io,useOptimistic:Io,useMemoCache:Io,useCacheRefresh:Io},ule={readContext:au,use:D3,useCallback:function(t,e){return Rh().memoizedState=[t,e===void 0?null:e],t},useContext:au,useEffect:FJ,useImperativeHandle:function(t,e,n){n=n!=null?n.concat([t]):null,WD(4194308,4,Jce.bind(null,e,t),n)},useLayoutEffect:function(t,e){return WD(4194308,4,t,e)},useInsertionEffect:function(t,e){WD(4,2,t,e)},useMemo:function(t,e){var n=Rh();e=e===void 0?null:e;var i=t();if(cT){G_(!0);try{t()}finally{G_(!1)}}return n.memoizedState=[i,e],i},useReducer:function(t,e,n){var i=Rh();if(n!==void 0){var r=n(e);if(cT){G_(!0);try{n(e)}finally{G_(!1)}}}else r=e;return i.memoizedState=i.baseState=r,t={pending:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:r},i.queue=t,t=t.dispatch=RIe.bind(null,vr,t),[i.memoizedState,t]},useRef:function(t){var e=Rh();return t={current:t},e.memoizedState=t},useState:function(t){t=_5(t);var e=t.queue,n=ole.bind(null,vr,e);return e.dispatch=n,[t.memoizedState,n]},useDebugValue:D$,useDeferredValue:function(t,e){var n=Rh();return P$(n,t,e)},useTransition:function(){var t=_5(!1);return t=nle.bind(null,vr,t.queue,!0,!1),Rh().memoizedState=t,[!1,t]},useSyncExternalStore:function(t,e,n){var i=vr,r=Rh();if(ms){if(n===void 0)throw Error(jt(407));n=n()}else{if(n=e(),ra===null)throw Error(jt(349));Vr&124||Uce(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,FJ(Fce.bind(null,i,s,t),[t]),i.flags|=2048,Yw(9,P3(),Bce.bind(null,i,s,n,e),null),n},useId:function(){var t=Rh(),e=ra.identifierPrefix;if(ms){var n=kv,i=Iv;n=(i&~(1<<32-jd(i)-1)).toString(32)+n,e=""+e+"R"+n,n=XL++,0<n&&(e+="H"+n.toString(32)),e+=""}else n=EIe++,e=""+e+"r"+n.toString(32)+"";return t.memoizedState=e},useHostTransitionStatus:L$,useFormState:LJ,useActionState:LJ,useOptimistic:function(t){var e=Rh();e.memoizedState=e.baseState=t;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return e.queue=n,e=U$.bind(null,vr,!0,n),n.dispatch=e,[t,e]},useMemoCache:I$,useCacheRefresh:function(){return Rh().memoizedState=CIe.bind(null,vr)}},hle={readContext:au,use:D3,useCallback:Qce,useContext:au,useEffect:Yce,useImperativeHandle:Zce,useInsertionEffect:Xce,useLayoutEffect:Kce,useMemo:ele,useReducer:$D,useRef:Wce,useState:function(){return $D(Zv)},useDebugValue:D$,useDeferredValue:function(t,e){var n=lc();return tle(n,Bs.memoizedState,t,e)},useTransition:function(){var t=$D(Zv)[0],e=lc().memoizedState;return[typeof t=="boolean"?t:vN(t),e]},useSyncExternalStore:Lce,useId:sle,useHostTransitionStatus:L$,useFormState:UJ,useActionState:UJ,useOptimistic:function(t,e){var n=lc();return jce(n,Bs,t,e)},useMemoCache:I$,useCacheRefresh:ale},AIe={readContext:au,use:D3,useCallback:Qce,useContext:au,useEffect:Yce,useImperativeHandle:Zce,useInsertionEffect:Xce,useLayoutEffect:Kce,useMemo:ele,useReducer:_8,useRef:Wce,useState:function(){return _8(Zv)},useDebugValue:D$,useDeferredValue:function(t,e){var n=lc();return Bs===null?P$(n,t,e):tle(n,Bs.memoizedState,t,e)},useTransition:function(){var t=_8(Zv)[0],e=lc().memoizedState;return[typeof t=="boolean"?t:vN(t),e]},useSyncExternalStore:Lce,useId:sle,useHostTransitionStatus:L$,useFormState:BJ,useActionState:BJ,useOptimistic:function(t,e){var n=lc();return Bs!==null?jce(n,Bs,t,e):(n.baseState=t,[t,n.queue.dispatch])},useMemoCache:I$,useCacheRefresh:ale},hw=null,FM=0;function Bk(t){var e=FM;return FM+=1,hw===null&&(hw=[]),Nce(hw,t,e)}function jR(t,e){e=e.props.ref,t.ref=e!==void 0?e:null}function Fk(t,e){throw e.$$typeof===rNe?Error(jt(525)):(t=Object.prototype.toString.call(e),Error(jt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)))}function zJ(t){var e=t._init;return e(t._payload)}function dle(t){function e(v,E){if(t){var T=v.deletions;T===null?(v.deletions=[E],v.flags|=16):T.push(E)}}function n(v,E){if(!t)return null;for(;E!==null;)e(v,E),E=E.sibling;return null}function i(v){for(var E=new Map;v!==null;)v.key!==null?E.set(v.key,v):E.set(v.index,v),v=v.sibling;return E}function r(v,E){return v=Hv(v,E),v.index=0,v.sibling=null,v}function s(v,E,T){return v.index=T,t?(T=v.alternate,T!==null?(T=T.index,T<E?(v.flags|=67108866,E):T):(v.flags|=67108866,E)):(v.flags|=1048576,E)}function a(v){return t&&v.alternate===null&&(v.flags|=67108866),v}function o(v,E,T,x){return E===null||E.tag!==6?(E=g8(T,v.mode,x),E.return=v,E):(E=r(E,T),E.return=v,E)}function c(v,E,T,x){var N=T.type;return N===k1?u(v,E,T.props.children,x,T.key):E!==null&&(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===C_&&zJ(N)===E.type)?(E=r(E,T.props),jR(E,T),E.return=v,E):(E=GD(T.type,T.key,T.props,null,v.mode,x),jR(E,T),E.return=v,E)}function l(v,E,T,x){return E===null||E.tag!==4||E.stateNode.containerInfo!==T.containerInfo||E.stateNode.implementation!==T.implementation?(E=v8(T,v.mode,x),E.return=v,E):(E=r(E,T.children||[]),E.return=v,E)}function u(v,E,T,x,N){return E===null||E.tag!==7?(E=HS(T,v.mode,x,N),E.return=v,E):(E=r(E,T),E.return=v,E)}function h(v,E,T){if(typeof E=="string"&&E!==""||typeof E=="number"||typeof E=="bigint")return E=g8(""+E,v.mode,T),E.return=v,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Nk:return T=GD(E.type,E.key,E.props,null,v.mode,T),jR(T,E),T.return=v,T;case fA:return E=v8(E,v.mode,T),E.return=v,E;case C_:var x=E._init;return E=x(E._payload),h(v,E,T)}if(pA(E)||BR(E))return E=HS(E,v.mode,T,null),E.return=v,E;if(typeof E.then=="function")return h(v,Bk(E),T);if(E.$$typeof===Nv)return h(v,Lk(v,E),T);Fk(v,E)}return null}function d(v,E,T,x){var N=E!==null?E.key:null;if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return N!==null?null:o(v,E,""+T,x);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Nk:return T.key===N?c(v,E,T,x):null;case fA:return T.key===N?l(v,E,T,x):null;case C_:return N=T._init,T=N(T._payload),d(v,E,T,x)}if(pA(T)||BR(T))return N!==null?null:u(v,E,T,x,null);if(typeof T.then=="function")return d(v,E,Bk(T),x);if(T.$$typeof===Nv)return d(v,E,Lk(v,T),x);Fk(v,T)}return null}function f(v,E,T,x,N){if(typeof x=="string"&&x!==""||typeof x=="number"||typeof x=="bigint")return v=v.get(T)||null,o(E,v,""+x,N);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Nk:return v=v.get(x.key===null?T:x.key)||null,c(E,v,x,N);case fA:return v=v.get(x.key===null?T:x.key)||null,l(E,v,x,N);case C_:var A=x._init;return x=A(x._payload),f(v,E,T,x,N)}if(pA(x)||BR(x))return v=v.get(T)||null,u(E,v,x,N,null);if(typeof x.then=="function")return f(v,E,T,Bk(x),N);if(x.$$typeof===Nv)return f(v,E,T,Lk(E,x),N);Fk(E,x)}return null}function p(v,E,T,x){for(var N=null,A=null,I=E,k=E=0,L=null;I!==null&&k<T.length;k++){I.index>k?(L=I,I=null):L=I.sibling;var U=d(v,I,T[k],x);if(U===null){I===null&&(I=L);break}t&&I&&U.alternate===null&&e(v,I),E=s(U,E,k),A===null?N=U:A.sibling=U,A=U,I=L}if(k===T.length)return n(v,I),ms&&gS(v,k),N;if(I===null){for(;k<T.length;k++)I=h(v,T[k],x),I!==null&&(E=s(I,E,k),A===null?N=I:A.sibling=I,A=I);return ms&&gS(v,k),N}for(I=i(I);k<T.length;k++)L=f(I,v,k,T[k],x),L!==null&&(t&&L.alternate!==null&&I.delete(L.key===null?k:L.key),E=s(L,E,k),A===null?N=L:A.sibling=L,A=L);return t&&I.forEach(function($){return e(v,$)}),ms&&gS(v,k),N}function g(v,E,T,x){if(T==null)throw Error(jt(151));for(var N=null,A=null,I=E,k=E=0,L=null,U=T.next();I!==null&&!U.done;k++,U=T.next()){I.index>k?(L=I,I=null):L=I.sibling;var $=d(v,I,U.value,x);if($===null){I===null&&(I=L);break}t&&I&&$.alternate===null&&e(v,I),E=s($,E,k),A===null?N=$:A.sibling=$,A=$,I=L}if(U.done)return n(v,I),ms&&gS(v,k),N;if(I===null){for(;!U.done;k++,U=T.next())U=h(v,U.value,x),U!==null&&(E=s(U,E,k),A===null?N=U:A.sibling=U,A=U);return ms&&gS(v,k),N}for(I=i(I);!U.done;k++,U=T.next())U=f(I,v,k,U.value,x),U!==null&&(t&&U.alternate!==null&&I.delete(U.key===null?k:U.key),E=s(U,E,k),A===null?N=U:A.sibling=U,A=U);return t&&I.forEach(function(q){return e(v,q)}),ms&&gS(v,k),N}function _(v,E,T,x){if(typeof T=="object"&&T!==null&&T.type===k1&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Nk:e:{for(var N=T.key;E!==null;){if(E.key===N){if(N=T.type,N===k1){if(E.tag===7){n(v,E.sibling),x=r(E,T.props.children),x.return=v,v=x;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===C_&&zJ(N)===E.type){n(v,E.sibling),x=r(E,T.props),jR(x,T),x.return=v,v=x;break e}n(v,E);break}else e(v,E);E=E.sibling}T.type===k1?(x=HS(T.props.children,v.mode,x,T.key),x.return=v,v=x):(x=GD(T.type,T.key,T.props,null,v.mode,x),jR(x,T),x.return=v,v=x)}return a(v);case fA:e:{for(N=T.key;E!==null;){if(E.key===N)if(E.tag===4&&E.stateNode.containerInfo===T.containerInfo&&E.stateNode.implementation===T.implementation){n(v,E.sibling),x=r(E,T.children||[]),x.return=v,v=x;break e}else{n(v,E);break}else e(v,E);E=E.sibling}x=v8(T,v.mode,x),x.return=v,v=x}return a(v);case C_:return N=T._init,T=N(T._payload),_(v,E,T,x)}if(pA(T))return p(v,E,T,x);if(BR(T)){if(N=BR(T),typeof N!="function")throw Error(jt(150));return T=N.call(T),g(v,E,T,x)}if(typeof T.then=="function")return _(v,E,Bk(T),x);if(T.$$typeof===Nv)return _(v,E,Lk(v,T),x);Fk(v,T)}return typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint"?(T=""+T,E!==null&&E.tag===6?(n(v,E.sibling),x=r(E,T),x.return=v,v=x):(n(v,E),x=g8(T,v.mode,x),x.return=v,v=x),a(v)):n(v,E)}return function(v,E,T,x){try{FM=0;var N=_(v,E,T,x);return hw=null,N}catch(I){if(I===gN||I===k3)throw I;var A=Bd(29,I,null,v.mode);return A.lanes=x,A.return=v,A}finally{}}}var Xw=dle(!0),fle=dle(!1),Qf=Xg(null),xg=null;function F_(t){var e=t.alternate;Da(kc,kc.current&1),Da(Qf,t),xg===null&&(e===null||Ww.current!==null||e.memoizedState!==null)&&(xg=t)}function ple(t){if(t.tag===22){if(Da(kc,kc.current),Da(Qf,t),xg===null){var e=t.alternate;e!==null&&e.memoizedState!==null&&(xg=t)}}else z_()}function z_(){Da(kc,kc.current),Da(Qf,Qf.current)}function Pv(t){dl(Qf),xg===t&&(xg=null),dl(kc)}var kc=Xg(0);function JL(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||B5(n)))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}function b8(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Sa({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var S5={enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Vd(),r=Z_(i);r.payload=e,n!=null&&(r.callback=n),e=Q_(t,r,i),e!==null&&(Gd(e,t,i),VA(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Vd(),r=Z_(i);r.tag=1,r.payload=e,n!=null&&(r.callback=n),e=Q_(t,r,i),e!==null&&(Gd(e,t,i),VA(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Vd(),i=Z_(n);i.tag=2,e!=null&&(i.callback=e),e=Q_(t,i,n),e!==null&&(Gd(e,t,n),VA(e,t,n))}};function HJ(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!LM(n,i)||!LM(r,s):!0}function jJ(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&S5.enqueueReplaceState(e,e.state,null)}function lT(t,e){var n=e;if("ref"in e){n={};for(var i in e)i!=="ref"&&(n[i]=e[i])}if(t=t.defaultProps){n===e&&(n=Sa({},n));for(var r in t)n[r]===void 0&&(n[r]=t[r])}return n}var ZL=typeof reportError=="function"?reportError:function(t){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof t=="object"&&t!==null&&typeof t.message=="string"?String(t.message):String(t),error:t});if(!window.dispatchEvent(e))return}else if(typeof zn=="object"&&typeof zn.emit=="function"){zn.emit("uncaughtException",t);return}console.error(t)};function mle(t){ZL(t)}function gle(t){console.error(t)}function vle(t){ZL(t)}function QL(t,e){try{var n=t.onUncaughtError;n(e.value,{componentStack:e.stack})}catch(i){setTimeout(function(){throw i})}}function VJ(t,e,n){try{var i=t.onCaughtError;i(n.value,{componentStack:n.stack,errorBoundary:e.tag===1?e.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function T5(t,e,n){return n=Z_(n),n.tag=3,n.payload={element:null},n.callback=function(){QL(t,e)},n}function yle(t){return t=Z_(t),t.tag=3,t}function _le(t,e,n,i){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=i.value;t.payload=function(){return r(s)},t.callback=function(){VJ(e,n,i)}}var a=n.stateNode;a!==null&&typeof a.componentDidCatch=="function"&&(t.callback=function(){VJ(e,n,i),typeof r!="function"&&(eb===null?eb=new Set([this]):eb.add(this));var o=i.stack;this.componentDidCatch(i.value,{componentStack:o!==null?o:""})})}function MIe(t,e,n,i,r){if(n.flags|=32768,i!==null&&typeof i=="object"&&typeof i.then=="function"){if(e=n.alternate,e!==null&&pN(e,n,r,!0),n=Qf.current,n!==null){switch(n.tag){case 13:return xg===null?N5():n.alternate===null&&vo===0&&(vo=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===m5?n.flags|=16384:(e=n.updateQueue,e===null?n.updateQueue=new Set([i]):e.add(i),N8(t,i,r)),!1;case 22:return n.flags|=65536,i===m5?n.flags|=16384:(e=n.updateQueue,e===null?(e={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=e):(n=e.retryQueue,n===null?e.retryQueue=new Set([i]):n.add(i)),N8(t,i,r)),!1}throw Error(jt(435,n.tag))}return N8(t,i,r),N5(),!1}if(ms)return e=Qf.current,e!==null?(!(e.flags&65536)&&(e.flags|=256),e.flags|=65536,e.lanes=r,i!==u5&&(t=Error(jt(422),{cause:i}),UM(Lf(t,n)))):(i!==u5&&(e=Error(jt(423),{cause:i}),UM(Lf(e,n))),t=t.current.alternate,t.flags|=65536,r&=-r,t.lanes|=r,i=Lf(i,n),r=T5(t.stateNode,i,r),y8(t,r),vo!==4&&(vo=2)),!1;var s=Error(jt(520),{cause:i});if(s=Lf(s,n),XA===null?XA=[s]:XA.push(s),vo!==4&&(vo=2),e===null)return!0;i=Lf(i,n),n=e;do{switch(n.tag){case 3:return n.flags|=65536,t=r&-r,n.lanes|=t,t=T5(n.stateNode,i,t),y8(n,t),!1;case 1:if(e=n.type,s=n.stateNode,(n.flags&128)===0&&(typeof e.getDerivedStateFromError=="function"||s!==null&&typeof s.componentDidCatch=="function"&&(eb===null||!eb.has(s))))return n.flags|=65536,r&=-r,n.lanes|=r,r=yle(r),_le(r,t,n,i),y8(n,r),!1}n=n.return}while(n!==null);return!1}var ble=Error(jt(461)),ul=!1;function Ol(t,e,n,i){e.child=t===null?fle(e,null,n,i):Xw(e,t.child,n,i)}function GJ(t,e,n,i,r){n=n.render;var s=e.ref;if("ref"in i){var a={};for(var o in i)o!=="ref"&&(a[o]=i[o])}else a=i;return oT(e),i=R$(t,e,n,a,s,r),o=A$(),t!==null&&!ul?(M$(t,e,r),Qv(t,e,r)):(ms&&o&&b$(e),e.flags|=1,Ol(t,e,i,r),e.child)}function qJ(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!_$(s)&&s.defaultProps===void 0&&n.compare===null?(e.tag=15,e.type=s,Ele(t,e,s,i,r)):(t=GD(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!B$(t,r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:LM,n(a,i)&&t.ref===e.ref)return Qv(t,e,r)}return e.flags|=1,t=Hv(s,i),t.ref=e.ref,t.return=e,e.child=t}function Ele(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(LM(s,i)&&t.ref===e.ref)if(ul=!1,e.pendingProps=i=s,B$(t,r))t.flags&131072&&(ul=!0);else return e.lanes=t.lanes,Qv(t,e,r)}return x5(t,e,n,i,r)}function Sle(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden"){if(e.flags&128){if(i=s!==null?s.baseLanes|n:n,t!==null){for(r=e.child=t.child,s=0;r!==null;)s=s|r.lanes|r.childLanes,r=r.sibling;e.childLanes=s&~i}else e.childLanes=0,e.child=null;return $J(t,e,i,n)}if(n&536870912)e.memoizedState={baseLanes:0,cachePool:null},t!==null&&qD(e,s!==null?s.cachePool:null),s!==null?kJ(e,s):y5(),ple(e);else return e.lanes=e.childLanes=536870912,$J(t,e,s!==null?s.baseLanes|n:n,n)}else s!==null?(qD(e,s.cachePool),kJ(e,s),z_(),e.memoizedState=null):(t!==null&&qD(e,null),y5(),z_());return Ol(t,e,r,n),e.child}function $J(t,e,n,i){var r=T$();return r=r===null?null:{parent:Oc._currentValue,pool:r},e.memoizedState={baseLanes:n,cachePool:r},t!==null&&qD(e,null),y5(),ple(e),t!==null&&pN(t,e,i,!0),null}function YD(t,e){var n=e.ref;if(n===null)t!==null&&t.ref!==null&&(e.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(jt(284));(t===null||t.ref!==n)&&(e.flags|=4194816)}}function x5(t,e,n,i,r){return oT(e),n=R$(t,e,n,i,void 0,r),i=A$(),t!==null&&!ul?(M$(t,e,r),Qv(t,e,r)):(ms&&i&&b$(e),e.flags|=1,Ol(t,e,n,r),e.child)}function WJ(t,e,n,i,r,s){return oT(e),e.updateQueue=null,n=Pce(e,i,n,r),Dce(t),i=A$(),t!==null&&!ul?(M$(t,e,s),Qv(t,e,s)):(ms&&i&&b$(e),e.flags|=1,Ol(t,e,n,s),e.child)}function YJ(t,e,n,i,r){if(oT(e),e.stateNode===null){var s=H1,a=n.contextType;typeof a=="object"&&a!==null&&(s=au(a)),s=new n(i,s),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=S5,e.stateNode=s,s._reactInternals=e,s=e.stateNode,s.props=i,s.state=e.memoizedState,s.refs={},x$(e),a=n.contextType,s.context=typeof a=="object"&&a!==null?au(a):H1,s.state=e.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(b8(e,n,a,i),s.state=e.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(a=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),a!==s.state&&S5.enqueueReplaceState(s,s.state,null),qA(e,i,s,r),GA(),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!0}else if(t===null){s=e.stateNode;var o=e.memoizedProps,c=lT(n,o);s.props=c;var l=s.context,u=n.contextType;a=H1,typeof u=="object"&&u!==null&&(a=au(u));var h=n.getDerivedStateFromProps;u=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function",o=e.pendingProps!==o,u||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o||l!==a)&&jJ(e,s,i,a),R_=!1;var d=e.memoizedState;s.state=d,qA(e,i,s,r),GA(),l=e.memoizedState,o||d!==l||R_?(typeof h=="function"&&(b8(e,n,h,i),l=e.memoizedState),(c=R_||HJ(e,n,c,i,d,l,a))?(u||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=a,i=c):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,g5(t,e),a=e.memoizedProps,u=lT(n,a),s.props=u,h=e.pendingProps,d=s.context,l=n.contextType,c=H1,typeof l=="object"&&l!==null&&(c=au(l)),o=n.getDerivedStateFromProps,(l=typeof o=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==h||d!==c)&&jJ(e,s,i,c),R_=!1,d=e.memoizedState,s.state=d,qA(e,i,s,r),GA();var f=e.memoizedState;a!==h||d!==f||R_||t!==null&&t.dependencies!==null&&$L(t.dependencies)?(typeof o=="function"&&(b8(e,n,o,i),f=e.memoizedState),(u=R_||HJ(e,n,u,i,d,f,c)||t!==null&&t.dependencies!==null&&$L(t.dependencies))?(l||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(i,f,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(i,f,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=f),s.props=i,s.state=f,s.context=c,i=u):(typeof s.componentDidUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&d===t.memoizedState||(e.flags|=1024),i=!1)}return s=i,YD(t,e),i=(e.flags&128)!==0,s||i?(s=e.stateNode,n=i&&typeof n.getDerivedStateFromError!="function"?null:s.render(),e.flags|=1,t!==null&&i?(e.child=Xw(e,t.child,null,r),e.child=Xw(e,null,n,r)):Ol(t,e,n,r),e.memoizedState=s.state,t=e.child):t=Qv(t,e,r),t}function XJ(t,e,n,i){return fN(),e.flags|=256,Ol(t,e,n,i),e.child}var E8={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function S8(t){return{baseLanes:t,cachePool:Mce()}}function T8(t,e,n){return t=t!==null?t.childLanes&~n:0,e&&(t|=Vf),t}function Tle(t,e,n){var i=e.pendingProps,r=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=t!==null&&t.memoizedState===null?!1:(kc.current&2)!==0),a&&(r=!0,e.flags&=-129),a=(e.flags&32)!==0,e.flags&=-33,t===null){if(ms){if(r?F_(e):z_(),ms){var o=go,c;if(c=o){e:{for(c=o,o=hg;c.nodeType!==8;){if(!o){o=null;break e}if(c=Jp(c.nextSibling),c===null){o=null;break e}}o=c}o!==null?(e.memoizedState={dehydrated:o,treeContext:jS!==null?{id:Iv,overflow:kv}:null,retryLane:536870912,hydrationErrors:null},c=Bd(18,null,null,0),c.stateNode=o,c.return=e,e.child=c,Xu=e,go=null,c=!0):c=!1}c||aT(e)}if(o=e.memoizedState,o!==null&&(o=o.dehydrated,o!==null))return B5(o)?e.lanes=32:e.lanes=536870912,null;Pv(e)}return o=i.children,i=i.fallback,r?(z_(),r=e.mode,o=e2({mode:"hidden",children:o},r),i=HS(i,r,n,null),o.return=e,i.return=e,o.sibling=i,e.child=o,r=e.child,r.memoizedState=S8(n),r.childLanes=T8(t,a,n),e.memoizedState=E8,i):(F_(e),w5(e,o))}if(c=t.memoizedState,c!==null&&(o=c.dehydrated,o!==null)){if(s)e.flags&256?(F_(e),e.flags&=-257,e=x8(t,e,n)):e.memoizedState!==null?(z_(),e.child=t.child,e.flags|=128,e=null):(z_(),r=i.fallback,o=e.mode,i=e2({mode:"visible",children:i.children},o),r=HS(r,o,n,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,Xw(e,t.child,null,n),i=e.child,i.memoizedState=S8(n),i.childLanes=T8(t,a,n),e.memoizedState=E8,e=r);else if(F_(e),B5(o)){if(a=o.nextSibling&&o.nextSibling.dataset,a)var l=a.dgst;a=l,i=Error(jt(419)),i.stack="",i.digest=a,UM({value:i,source:null,stack:null}),e=x8(t,e,n)}else if(ul||pN(t,e,n,!1),a=(n&t.childLanes)!==0,ul||a){if(a=ra,a!==null&&(i=n&-n,i=i&42?1:c$(i),i=i&(a.suspendedLanes|n)?0:i,i!==0&&i!==c.retryLane))throw c.retryLane=i,jC(t,i),Gd(a,t,i),ble;o.data==="$?"||N5(),e=x8(t,e,n)}else o.data==="$?"?(e.flags|=192,e.child=t.child,e=null):(t=c.treeContext,go=Jp(o.nextSibling),Xu=e,ms=!0,VS=null,hg=!1,t!==null&&(Mf[Of++]=Iv,Mf[Of++]=kv,Mf[Of++]=jS,Iv=t.id,kv=t.overflow,jS=e),e=w5(e,i.children),e.flags|=4096);return e}return r?(z_(),r=i.fallback,o=e.mode,c=t.child,l=c.sibling,i=Hv(c,{mode:"hidden",children:i.children}),i.subtreeFlags=c.subtreeFlags&65011712,l!==null?r=Hv(l,r):(r=HS(r,o,n,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=t.child.memoizedState,o===null?o=S8(n):(c=o.cachePool,c!==null?(l=Oc._currentValue,c=c.parent!==l?{parent:l,pool:l}:c):c=Mce(),o={baseLanes:o.baseLanes|n,cachePool:c}),r.memoizedState=o,r.childLanes=T8(t,a,n),e.memoizedState=E8,i):(F_(e),n=t.child,t=n.sibling,n=Hv(n,{mode:"visible",children:i.children}),n.return=e,n.sibling=null,t!==null&&(a=e.deletions,a===null?(e.deletions=[t],e.flags|=16):a.push(t)),e.child=n,e.memoizedState=null,n)}function w5(t,e){return e=e2({mode:"visible",children:e},t.mode),e.return=t,t.child=e}function e2(t,e){return t=Bd(22,t,null,e),t.lanes=0,t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},t}function x8(t,e,n){return Xw(e,t.child,null,n),t=w5(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function KJ(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),d5(t.return,e,n)}function w8(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function xle(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Ol(t,e,i.children,n),i=kc.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&KJ(t,n,e);else if(t.tag===19)KJ(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}switch(Da(kc,i),r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&JL(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),w8(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&JL(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}w8(e,!0,n,null,s);break;case"together":w8(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Qv(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Eb|=e.lanes,!(n&e.childLanes))if(t!==null){if(pN(t,e,n,!1),(n&e.childLanes)===0)return null}else return null;if(t!==null&&e.child!==t.child)throw Error(jt(153));if(e.child!==null){for(t=e.child,n=Hv(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Hv(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function B$(t,e){return t.lanes&e?!0:(t=t.dependencies,!!(t!==null&&$L(t)))}function OIe(t,e,n){switch(e.tag){case 3:BL(e,e.stateNode.containerInfo),B_(e,Oc,t.memoizedState.cache),fN();break;case 27:case 5:e5(e);break;case 4:BL(e,e.stateNode.containerInfo);break;case 10:B_(e,e.type,e.memoizedProps.value);break;case 13:var i=e.memoizedState;if(i!==null)return i.dehydrated!==null?(F_(e),e.flags|=128,null):n&e.child.childLanes?Tle(t,e,n):(F_(e),t=Qv(t,e,n),t!==null?t.sibling:null);F_(e);break;case 19:var r=(t.flags&128)!==0;if(i=(n&e.childLanes)!==0,i||(pN(t,e,n,!1),i=(n&e.childLanes)!==0),r){if(i)return xle(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Da(kc,kc.current),i)break;return null;case 22:case 23:return e.lanes=0,Sle(t,e,n);case 24:B_(e,Oc,t.memoizedState.cache)}return Qv(t,e,n)}function wle(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps)ul=!0;else{if(!B$(t,n)&&!(e.flags&128))return ul=!1,OIe(t,e,n);ul=!!(t.flags&131072)}else ul=!1,ms&&e.flags&1048576&&Rce(e,qL,e.index);switch(e.lanes=0,e.tag){case 16:e:{t=e.pendingProps;var i=e.elementType,r=i._init;if(i=r(i._payload),e.type=i,typeof i=="function")_$(i)?(t=lT(i,t),e.tag=1,e=YJ(null,e,i,t,n)):(e.tag=0,e=x5(null,e,i,t,n));else{if(i!=null){if(r=i.$$typeof,r===s$){e.tag=11,e=GJ(null,e,i,t,n);break e}else if(r===a$){e.tag=14,e=qJ(null,e,i,t,n);break e}}throw e=Zj(i)||i,Error(jt(306,e,""))}}return e;case 0:return x5(t,e,e.type,e.pendingProps,n);case 1:return i=e.type,r=lT(i,e.pendingProps),YJ(t,e,i,r,n);case 3:e:{if(BL(e,e.stateNode.containerInfo),t===null)throw Error(jt(387));i=e.pendingProps;var s=e.memoizedState;r=s.element,g5(t,e),qA(e,i,null,n);var a=e.memoizedState;if(i=a.cache,B_(e,Oc,i),i!==s.cache&&f5(e,[Oc],n,!0),GA(),i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){e=XJ(t,e,i,n);break e}else if(i!==r){r=Lf(Error(jt(424)),e),UM(r),e=XJ(t,e,i,n);break e}else{switch(t=e.stateNode.containerInfo,t.nodeType){case 9:t=t.body;break;default:t=t.nodeName==="HTML"?t.ownerDocument.body:t}for(go=Jp(t.firstChild),Xu=e,ms=!0,VS=null,hg=!0,n=fle(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(fN(),i===r){e=Qv(t,e,n);break e}Ol(t,e,i,n)}e=e.child}return e;case 26:return YD(t,e),t===null?(n=fZ(e.type,null,e.pendingProps,null))?e.memoizedState=n:ms||(n=e.type,t=e.pendingProps,i=o2(J_.current).createElement(n),i[su]=e,i[Wh]=t,Pl(i,n,t),al(i),e.stateNode=i):e.memoizedState=fZ(e.type,t.memoizedProps,e.pendingProps,t.memoizedState),null;case 27:return e5(e),t===null&&ms&&(i=e.stateNode=hue(e.type,e.pendingProps,J_.current),Xu=e,hg=!0,r=go,Gb(e.type)?(F5=r,go=Jp(i.firstChild)):go=r),Ol(t,e,e.pendingProps.children,n),YD(t,e),t===null&&(e.flags|=4194304),e.child;case 5:return t===null&&ms&&((r=i=go)&&(i=rke(i,e.type,e.pendingProps,hg),i!==null?(e.stateNode=i,Xu=e,go=Jp(i.firstChild),hg=!1,r=!0):r=!1),r||aT(e)),e5(e),r=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,L5(r,s)?i=null:a!==null&&L5(r,a)&&(e.flags|=32),e.memoizedState!==null&&(r=R$(t,e,SIe,null,null,n),VM._currentValue=r),YD(t,e),Ol(t,e,i,n),e.child;case 6:return t===null&&ms&&((t=n=go)&&(n=ske(n,e.pendingProps,hg),n!==null?(e.stateNode=n,Xu=e,go=null,t=!0):t=!1),t||aT(e)),null;case 13:return Tle(t,e,n);case 4:return BL(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Xw(e,null,i,n):Ol(t,e,i,n),e.child;case 11:return GJ(t,e,e.type,e.pendingProps,n);case 7:return Ol(t,e,e.pendingProps,n),e.child;case 8:return Ol(t,e,e.pendingProps.children,n),e.child;case 12:return Ol(t,e,e.pendingProps.children,n),e.child;case 10:return i=e.pendingProps,B_(e,e.type,i.value),Ol(t,e,i.children,n),e.child;case 9:return r=e.type._context,i=e.pendingProps.children,oT(e),r=au(r),i=i(r),e.flags|=1,Ol(t,e,i,n),e.child;case 14:return qJ(t,e,e.type,e.pendingProps,n);case 15:return Ele(t,e,e.type,e.pendingProps,n);case 19:return xle(t,e,n);case 31:return i=e.pendingProps,n=e.mode,i={mode:i.mode,children:i.children},t===null?(n=e2(i,n),n.ref=e.ref,e.child=n,n.return=e,e=n):(n=Hv(t.child,i),n.ref=e.ref,e.child=n,n.return=e,e=n),e;case 22:return Sle(t,e,n);case 24:return oT(e),i=au(Oc),t===null?(r=T$(),r===null&&(r=ra,s=S$(),r.pooledCache=s,s.refCount++,s!==null&&(r.pooledCacheLanes|=n),r=s),e.memoizedState={parent:i,cache:r},x$(e),B_(e,Oc,r)):(t.lanes&n&&(g5(t,e),qA(e,null,null,n),GA()),r=t.memoizedState,s=e.memoizedState,r.parent!==i?(r={parent:i,cache:i},e.memoizedState=r,e.lanes===0&&(e.memoizedState=e.updateQueue.baseState=r),B_(e,Oc,i)):(i=s.cache,B_(e,Oc,i),i!==r.cache&&f5(e,[Oc],n,!0))),Ol(t,e,e.pendingProps.children,n),e.child;case 29:throw e.pendingProps}throw Error(jt(156,e.tag))}function lv(t){t.flags|=4}function JJ(t,e){if(e.type!=="stylesheet"||e.state.loading&4)t.flags&=-16777217;else if(t.flags|=16777216,!pue(e)){if(e=Qf.current,e!==null&&((Vr&4194048)===Vr?xg!==null:(Vr&62914560)!==Vr&&!(Vr&536870912)||e!==xg))throw jA=m5,Oce;t.flags|=8192}}function zk(t,e){e!==null&&(t.flags|=4),t.flags&16384&&(e=t.tag!==22?Joe():536870912,t.lanes|=e,Kw|=e)}function VR(t,e){if(!ms)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Ga(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&65011712,i|=r.flags&65011712,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function NIe(t,e,n){var i=e.pendingProps;switch(E$(e),e.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(e),null;case 1:return Ga(e),null;case 3:return n=e.stateNode,i=null,t!==null&&(i=t.memoizedState.cache),e.memoizedState.cache!==i&&(e.flags|=2048),jv(Oc),Vw(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(HR(e)?lv(e):t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,RJ())),Ga(e),null;case 26:return n=e.memoizedState,t===null?(lv(e),n!==null?(Ga(e),JJ(e,n)):(Ga(e),e.flags&=-16777217)):n?n!==t.memoizedState?(lv(e),Ga(e),JJ(e,n)):(Ga(e),e.flags&=-16777217):(t.memoizedProps!==i&&lv(e),Ga(e),e.flags&=-16777217),null;case 27:FL(e),n=J_.current;var r=e.type;if(t!==null&&e.stateNode!=null)t.memoizedProps!==i&&lv(e);else{if(!i){if(e.stateNode===null)throw Error(jt(166));return Ga(e),null}t=Sg.current,HR(e)?wJ(e):(t=hue(r,i,n),e.stateNode=t,lv(e))}return Ga(e),null;case 5:if(FL(e),n=e.type,t!==null&&e.stateNode!=null)t.memoizedProps!==i&&lv(e);else{if(!i){if(e.stateNode===null)throw Error(jt(166));return Ga(e),null}if(t=Sg.current,HR(e))wJ(e);else{switch(r=o2(J_.current),t){case 1:t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":t=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":t=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":t=r.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild);break;case"select":t=typeof i.is=="string"?r.createElement("select",{is:i.is}):r.createElement("select"),i.multiple?t.multiple=!0:i.size&&(t.size=i.size);break;default:t=typeof i.is=="string"?r.createElement(n,{is:i.is}):r.createElement(n)}}t[su]=e,t[Wh]=i;e:for(r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break e;for(;r.sibling===null;){if(r.return===null||r.return===e)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}e.stateNode=t;e:switch(Pl(t,n,i),n){case"button":case"input":case"select":case"textarea":t=!!i.autoFocus;break e;case"img":t=!0;break e;default:t=!1}t&&lv(e)}}return Ga(e),e.flags&=-16777217,null;case 6:if(t&&e.stateNode!=null)t.memoizedProps!==i&&lv(e);else{if(typeof i!="string"&&e.stateNode===null)throw Error(jt(166));if(t=J_.current,HR(e)){if(t=e.stateNode,n=e.memoizedProps,i=null,r=Xu,r!==null)switch(r.tag){case 27:case 5:i=r.memoizedProps}t[su]=e,t=!!(t.nodeValue===n||i!==null&&i.suppressHydrationWarning===!0||cue(t.nodeValue,n)),t||aT(e)}else t=o2(t).createTextNode(i),t[su]=e,e.stateNode=t}return Ga(e),null;case 13:if(i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(r=HR(e),i!==null&&i.dehydrated!==null){if(t===null){if(!r)throw Error(jt(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(jt(317));r[su]=e}else fN(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ga(e),r=!1}else r=RJ(),t!==null&&t.memoizedState!==null&&(t.memoizedState.hydrationErrors=r),r=!0;if(!r)return e.flags&256?(Pv(e),e):(Pv(e),null)}if(Pv(e),e.flags&128)return e.lanes=n,e;if(n=i!==null,t=t!==null&&t.memoizedState!==null,n){i=e.child,r=null,i.alternate!==null&&i.alternate.memoizedState!==null&&i.alternate.memoizedState.cachePool!==null&&(r=i.alternate.memoizedState.cachePool.pool);var s=null;i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(s=i.memoizedState.cachePool.pool),s!==r&&(i.flags|=2048)}return n!==t&&n&&(e.child.flags|=8192),zk(e,e.updateQueue),Ga(e),null;case 4:return Vw(),t===null&&$$(e.stateNode.containerInfo),Ga(e),null;case 10:return jv(e.type),Ga(e),null;case 19:if(dl(kc),r=e.memoizedState,r===null)return Ga(e),null;if(i=(e.flags&128)!==0,s=r.rendering,s===null)if(i)VR(r,!1);else{if(vo!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=JL(t),s!==null){for(e.flags|=128,VR(r,!1),t=s.updateQueue,e.updateQueue=t,zk(e,t),e.subtreeFlags=0,t=n,n=e.child;n!==null;)Cce(n,t),n=n.sibling;return Da(kc,kc.current&1|2),e.child}t=t.sibling}r.tail!==null&&Tg()>n2&&(e.flags|=128,i=!0,VR(r,!1),e.lanes=4194304)}else{if(!i)if(t=JL(s),t!==null){if(e.flags|=128,i=!0,t=t.updateQueue,e.updateQueue=t,zk(e,t),VR(r,!0),r.tail===null&&r.tailMode==="hidden"&&!s.alternate&&!ms)return Ga(e),null}else 2*Tg()-r.renderingStartTime>n2&&n!==536870912&&(e.flags|=128,i=!0,VR(r,!1),e.lanes=4194304);r.isBackwards?(s.sibling=e.child,e.child=s):(t=r.last,t!==null?t.sibling=s:e.child=s,r.last=s)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=Tg(),e.sibling=null,t=kc.current,Da(kc,i?t&1|2:t&1),e):(Ga(e),null);case 22:case 23:return Pv(e),w$(),i=e.memoizedState!==null,t!==null?t.memoizedState!==null!==i&&(e.flags|=8192):i&&(e.flags|=8192),i?n&536870912&&!(e.flags&128)&&(Ga(e),e.subtreeFlags&6&&(e.flags|=8192)):Ga(e),n=e.updateQueue,n!==null&&zk(e,n.retryQueue),n=null,t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),i=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(i=e.memoizedState.cachePool.pool),i!==n&&(e.flags|=2048),t!==null&&dl(GS),null;case 24:return n=null,t!==null&&(n=t.memoizedState.cache),e.memoizedState.cache!==n&&(e.flags|=2048),jv(Oc),Ga(e),null;case 25:return null;case 30:return null}throw Error(jt(156,e.tag))}function IIe(t,e){switch(E$(e),e.tag){case 1:return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return jv(Oc),Vw(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 26:case 27:case 5:return FL(e),null;case 13:if(Pv(e),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(jt(340));fN()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return dl(kc),null;case 4:return Vw(),null;case 10:return jv(e.type),null;case 22:case 23:return Pv(e),w$(),t!==null&&dl(GS),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 24:return jv(Oc),null;case 25:return null;default:return null}}function Cle(t,e){switch(E$(e),e.tag){case 3:jv(Oc),Vw();break;case 26:case 27:case 5:FL(e);break;case 4:Vw();break;case 13:Pv(e);break;case 19:dl(kc);break;case 10:jv(e.type);break;case 22:case 23:Pv(e),w$(),t!==null&&dl(GS);break;case 24:jv(Oc)}}function _N(t,e){try{var n=e.updateQueue,i=n!==null?n.lastEffect:null;if(i!==null){var r=i.next;n=r;do{if((n.tag&t)===t){i=void 0;var s=n.create,a=n.inst;i=s(),a.destroy=i}n=n.next}while(n!==r)}}catch(o){$s(e,e.return,o)}}function bb(t,e,n){try{var i=e.updateQueue,r=i!==null?i.lastEffect:null;if(r!==null){var s=r.next;i=s;do{if((i.tag&t)===t){var a=i.inst,o=a.destroy;if(o!==void 0){a.destroy=void 0,r=e;var c=n,l=o;try{l()}catch(u){$s(r,c,u)}}}i=i.next}while(i!==s)}}catch(u){$s(e,e.return,u)}}function Rle(t){var e=t.updateQueue;if(e!==null){var n=t.stateNode;try{kce(e,n)}catch(i){$s(t,t.return,i)}}}function Ale(t,e,n){n.props=lT(t.type,t.memoizedProps),n.state=t.memoizedState;try{n.componentWillUnmount()}catch(i){$s(t,e,i)}}function WA(t,e){try{var n=t.ref;if(n!==null){switch(t.tag){case 26:case 27:case 5:var i=t.stateNode;break;case 30:i=t.stateNode;break;default:i=t.stateNode}typeof n=="function"?t.refCleanup=n(i):n.current=i}}catch(r){$s(t,e,r)}}function vg(t,e){var n=t.ref,i=t.refCleanup;if(n!==null)if(typeof i=="function")try{i()}catch(r){$s(t,e,r)}finally{t.refCleanup=null,t=t.alternate,t!=null&&(t.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){$s(t,e,r)}else n.current=null}function Mle(t){var e=t.type,n=t.memoizedProps,i=t.stateNode;try{e:switch(e){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){$s(t,t.return,r)}}function C8(t,e,n){try{var i=t.stateNode;QIe(i,t.type,n,e),i[Wh]=e}catch(r){$s(t,t.return,r)}}function Ole(t){return t.tag===5||t.tag===3||t.tag===26||t.tag===27&&Gb(t.type)||t.tag===4}function R8(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ole(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.tag===27&&Gb(t.type)||t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function C5(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(t,e):(e=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,e.appendChild(t),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=z3));else if(i!==4&&(i===27&&Gb(t.type)&&(n=t.stateNode,e=null),t=t.child,t!==null))for(C5(t,e,n),t=t.sibling;t!==null;)C5(t,e,n),t=t.sibling}function t2(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(i===27&&Gb(t.type)&&(n=t.stateNode),t=t.child,t!==null))for(t2(t,e,n),t=t.sibling;t!==null;)t2(t,e,n),t=t.sibling}function Nle(t){var e=t.stateNode,n=t.memoizedProps;try{for(var i=t.type,r=e.attributes;r.length;)e.removeAttributeNode(r[0]);Pl(e,i,n),e[su]=t,e[Wh]=n}catch(s){$s(t,t.return,s)}}var wv=!1,Po=!1,A8=!1,ZJ=typeof WeakSet=="function"?WeakSet:Set,il=null;function kIe(t,e){if(t=t.containerInfo,D5=h2,t=yce(t),g$(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,l=0,u=0,h=t,d=null;t:for(;;){for(var f;h!==n||r!==0&&h.nodeType!==3||(o=a+r),h!==s||i!==0&&h.nodeType!==3||(c=a+i),h.nodeType===3&&(a+=h.nodeValue.length),(f=h.firstChild)!==null;)d=h,h=f;for(;;){if(h===t)break t;if(d===n&&++l===r&&(o=a),d===s&&++u===i&&(c=a),(f=h.nextSibling)!==null)break;h=d,d=h.parentNode}h=f}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(P5={focusedElem:t,selectionRange:n},h2=!1,il=e;il!==null;)if(e=il,t=e.child,(e.subtreeFlags&1024)!==0&&t!==null)t.return=e,il=t;else for(;il!==null;){switch(e=il,s=e.alternate,t=e.flags,e.tag){case 0:break;case 11:case 15:break;case 1:if(t&1024&&s!==null){t=void 0,n=e,r=s.memoizedProps,s=s.memoizedState,i=n.stateNode;try{var p=lT(n.type,r,n.elementType===n.type);t=i.getSnapshotBeforeUpdate(p,s),i.__reactInternalSnapshotBeforeUpdate=t}catch(g){$s(n,n.return,g)}}break;case 3:if(t&1024){if(t=e.stateNode.containerInfo,n=t.nodeType,n===9)U5(t);else if(n===1)switch(t.nodeName){case"HEAD":case"HTML":case"BODY":U5(t);break;default:t.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(t&1024)throw Error(jt(163))}if(t=e.sibling,t!==null){t.return=e.return,il=t;break}il=e.return}}function Ile(t,e,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:c_(t,n),i&4&&_N(5,n);break;case 1:if(c_(t,n),i&4)if(t=n.stateNode,e===null)try{t.componentDidMount()}catch(a){$s(n,n.return,a)}else{var r=lT(n.type,e.memoizedProps);e=e.memoizedState;try{t.componentDidUpdate(r,e,t.__reactInternalSnapshotBeforeUpdate)}catch(a){$s(n,n.return,a)}}i&64&&Rle(n),i&512&&WA(n,n.return);break;case 3:if(c_(t,n),i&64&&(t=n.updateQueue,t!==null)){if(e=null,n.child!==null)switch(n.child.tag){case 27:case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}try{kce(t,e)}catch(a){$s(n,n.return,a)}}break;case 27:e===null&&i&4&&Nle(n);case 26:case 5:c_(t,n),e===null&&i&4&&Mle(n),i&512&&WA(n,n.return);break;case 12:c_(t,n);break;case 13:c_(t,n),i&4&&Ple(t,n),i&64&&(t=n.memoizedState,t!==null&&(t=t.dehydrated,t!==null&&(n=jIe.bind(null,n),ake(t,n))));break;case 22:if(i=n.memoizedState!==null||wv,!i){e=e!==null&&e.memoizedState!==null||Po,r=wv;var s=Po;wv=i,(Po=e)&&!s?__(t,n,(n.subtreeFlags&8772)!==0):c_(t,n),wv=r,Po=s}break;case 30:break;default:c_(t,n)}}function kle(t){var e=t.alternate;e!==null&&(t.alternate=null,kle(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&u$(e)),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}var Ma=null,Ah=!1;function uv(t,e,n){for(n=n.child;n!==null;)Dle(t,e,n),n=n.sibling}function Dle(t,e,n){if(Hd&&typeof Hd.onCommitFiberUnmount=="function")try{Hd.onCommitFiberUnmount(cN,n)}catch{}switch(n.tag){case 26:Po||vg(n,e),uv(t,e,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Po||vg(n,e);var i=Ma,r=Ah;Gb(n.type)&&(Ma=n.stateNode,Ah=!1),uv(t,e,n),JA(n.stateNode),Ma=i,Ah=r;break;case 5:Po||vg(n,e);case 6:if(i=Ma,r=Ah,Ma=null,uv(t,e,n),Ma=i,Ah=r,Ma!==null)if(Ah)try{(Ma.nodeType===9?Ma.body:Ma.nodeName==="HTML"?Ma.ownerDocument.body:Ma).removeChild(n.stateNode)}catch(s){$s(n,e,s)}else try{Ma.removeChild(n.stateNode)}catch(s){$s(n,e,s)}break;case 18:Ma!==null&&(Ah?(t=Ma,uZ(t.nodeType===9?t.body:t.nodeName==="HTML"?t.ownerDocument.body:t,n.stateNode),$M(t)):uZ(Ma,n.stateNode));break;case 4:i=Ma,r=Ah,Ma=n.stateNode.containerInfo,Ah=!0,uv(t,e,n),Ma=i,Ah=r;break;case 0:case 11:case 14:case 15:Po||bb(2,n,e),Po||bb(4,n,e),uv(t,e,n);break;case 1:Po||(vg(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"&&Ale(n,e,i)),uv(t,e,n);break;case 21:uv(t,e,n);break;case 22:Po=(i=Po)||n.memoizedState!==null,uv(t,e,n),Po=i;break;default:uv(t,e,n)}}function Ple(t,e){if(e.memoizedState===null&&(t=e.alternate,t!==null&&(t=t.memoizedState,t!==null&&(t=t.dehydrated,t!==null))))try{$M(t)}catch(n){$s(e,e.return,n)}}function DIe(t){switch(t.tag){case 13:case 19:var e=t.stateNode;return e===null&&(e=t.stateNode=new ZJ),e;case 22:return t=t.stateNode,e=t._retryCache,e===null&&(e=t._retryCache=new ZJ),e;default:throw Error(jt(435,t.tag))}}function M8(t,e){var n=DIe(t);e.forEach(function(i){var r=VIe.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}function xd(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i],s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 27:if(Gb(o.type)){Ma=o.stateNode,Ah=!1;break e}break;case 5:Ma=o.stateNode,Ah=!1;break e;case 3:case 4:Ma=o.stateNode.containerInfo,Ah=!0;break e}o=o.return}if(Ma===null)throw Error(jt(160));Dle(s,a,r),Ma=null,Ah=!1,s=r.alternate,s!==null&&(s.return=null),r.return=null}if(e.subtreeFlags&13878)for(e=e.child;e!==null;)Lle(e,t),e=e.sibling}var Fp=null;function Lle(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:xd(e,t),wd(t),i&4&&(bb(3,t,t.return),_N(3,t),bb(5,t,t.return));break;case 1:xd(e,t),wd(t),i&512&&(Po||n===null||vg(n,n.return)),i&64&&wv&&(t=t.updateQueue,t!==null&&(i=t.callbacks,i!==null&&(n=t.shared.hiddenCallbacks,t.shared.hiddenCallbacks=n===null?i:n.concat(i))));break;case 26:var r=Fp;if(xd(e,t),wd(t),i&512&&(Po||n===null||vg(n,n.return)),i&4){var s=n!==null?n.memoizedState:null;if(i=t.memoizedState,n===null)if(i===null)if(t.stateNode===null){e:{i=t.type,n=t.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":s=r.getElementsByTagName("title")[0],(!s||s[hN]||s[su]||s.namespaceURI==="http://www.w3.org/2000/svg"||s.hasAttribute("itemprop"))&&(s=r.createElement(i),r.head.insertBefore(s,r.querySelector("head > title"))),Pl(s,i,n),s[su]=t,al(s),i=s;break e;case"link":var a=mZ("link","href",r).get(i+(n.href||""));if(a){for(var o=0;o<a.length;o++)if(s=a[o],s.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&s.getAttribute("rel")===(n.rel==null?null:n.rel)&&s.getAttribute("title")===(n.title==null?null:n.title)&&s.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){a.splice(o,1);break t}}s=r.createElement(i),Pl(s,i,n),r.head.appendChild(s);break;case"meta":if(a=mZ("meta","content",r).get(i+(n.content||""))){for(o=0;o<a.length;o++)if(s=a[o],s.getAttribute("content")===(n.content==null?null:""+n.content)&&s.getAttribute("name")===(n.name==null?null:n.name)&&s.getAttribute("property")===(n.property==null?null:n.property)&&s.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&s.getAttribute("charset")===(n.charSet==null?null:n.charSet)){a.splice(o,1);break t}}s=r.createElement(i),Pl(s,i,n),r.head.appendChild(s);break;default:throw Error(jt(468,i))}s[su]=t,al(s),i=s}t.stateNode=i}else gZ(r,t.type,t.stateNode);else t.stateNode=pZ(r,i,t.memoizedProps);else s!==i?(s===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):s.count--,i===null?gZ(r,t.type,t.stateNode):pZ(r,i,t.memoizedProps)):i===null&&t.stateNode!==null&&C8(t,t.memoizedProps,n.memoizedProps)}break;case 27:xd(e,t),wd(t),i&512&&(Po||n===null||vg(n,n.return)),n!==null&&i&4&&C8(t,t.memoizedProps,n.memoizedProps);break;case 5:if(xd(e,t),wd(t),i&512&&(Po||n===null||vg(n,n.return)),t.flags&32){r=t.stateNode;try{qw(r,"")}catch(f){$s(t,t.return,f)}}i&4&&t.stateNode!=null&&(r=t.memoizedProps,C8(t,r,n!==null?n.memoizedProps:r)),i&1024&&(A8=!0);break;case 6:if(xd(e,t),wd(t),i&4){if(t.stateNode===null)throw Error(jt(162));i=t.memoizedProps,n=t.stateNode;try{n.nodeValue=i}catch(f){$s(t,t.return,f)}}break;case 3:if(JD=null,r=Fp,Fp=c2(e.containerInfo),xd(e,t),Fp=r,wd(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{$M(e.containerInfo)}catch(f){$s(t,t.return,f)}A8&&(A8=!1,Ule(t));break;case 4:i=Fp,Fp=c2(t.stateNode.containerInfo),xd(e,t),wd(t),Fp=i;break;case 12:xd(e,t),wd(t);break;case 13:xd(e,t),wd(t),t.child.flags&8192&&t.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(V$=Tg()),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,M8(t,i)));break;case 22:r=t.memoizedState!==null;var c=n!==null&&n.memoizedState!==null,l=wv,u=Po;if(wv=l||r,Po=u||c,xd(e,t),Po=u,wv=l,wd(t),i&8192)e:for(e=t.stateNode,e._visibility=r?e._visibility&-2:e._visibility|1,r&&(n===null||c||wv||Po||vS(t)),n=null,e=t;;){if(e.tag===5||e.tag===26){if(n===null){c=n=e;try{if(s=c.stateNode,r)a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none";else{o=c.stateNode;var h=c.memoizedProps.style,d=h!=null&&h.hasOwnProperty("display")?h.display:null;o.style.display=d==null||typeof d=="boolean"?"":(""+d).trim()}}catch(f){$s(c,c.return,f)}}}else if(e.tag===6){if(n===null){c=e;try{c.stateNode.nodeValue=r?"":c.memoizedProps}catch(f){$s(c,c.return,f)}}}else if((e.tag!==22&&e.tag!==23||e.memoizedState===null||e===t)&&e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;n===e&&(n=null),e=e.return}n===e&&(n=null),e.sibling.return=e.return,e=e.sibling}i&4&&(i=t.updateQueue,i!==null&&(n=i.retryQueue,n!==null&&(i.retryQueue=null,M8(t,n))));break;case 19:xd(e,t),wd(t),i&4&&(i=t.updateQueue,i!==null&&(t.updateQueue=null,M8(t,i)));break;case 30:break;case 21:break;default:xd(e,t),wd(t)}}function wd(t){var e=t.flags;if(e&2){try{for(var n,i=t.return;i!==null;){if(Ole(i)){n=i;break}i=i.return}if(n==null)throw Error(jt(160));switch(n.tag){case 27:var r=n.stateNode,s=R8(t);t2(t,s,r);break;case 5:var a=n.stateNode;n.flags&32&&(qw(a,""),n.flags&=-33);var o=R8(t);t2(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,l=R8(t);C5(t,l,c);break;default:throw Error(jt(161))}}catch(u){$s(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ule(t){if(t.subtreeFlags&1024)for(t=t.child;t!==null;){var e=t;Ule(e),e.tag===5&&e.flags&1024&&e.stateNode.reset(),t=t.sibling}}function c_(t,e){if(e.subtreeFlags&8772)for(e=e.child;e!==null;)Ile(t,e.alternate,e),e=e.sibling}function vS(t){for(t=t.child;t!==null;){var e=t;switch(e.tag){case 0:case 11:case 14:case 15:bb(4,e,e.return),vS(e);break;case 1:vg(e,e.return);var n=e.stateNode;typeof n.componentWillUnmount=="function"&&Ale(e,e.return,n),vS(e);break;case 27:JA(e.stateNode);case 26:case 5:vg(e,e.return),vS(e);break;case 22:e.memoizedState===null&&vS(e);break;case 30:vS(e);break;default:vS(e)}t=t.sibling}}function __(t,e,n){for(n=n&&(e.subtreeFlags&8772)!==0,e=e.child;e!==null;){var i=e.alternate,r=t,s=e,a=s.flags;switch(s.tag){case 0:case 11:case 15:__(r,s,n),_N(4,s);break;case 1:if(__(r,s,n),i=s,r=i.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(l){$s(i,i.return,l)}if(i=s,r=i.updateQueue,r!==null){var o=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(c!==null)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)Ice(c[r],o)}catch(l){$s(i,i.return,l)}}n&&a&64&&Rle(s),WA(s,s.return);break;case 27:Nle(s);case 26:case 5:__(r,s,n),n&&i===null&&a&4&&Mle(s),WA(s,s.return);break;case 12:__(r,s,n);break;case 13:__(r,s,n),n&&a&4&&Ple(r,s);break;case 22:s.memoizedState===null&&__(r,s,n),WA(s,s.return);break;case 30:break;default:__(r,s,n)}e=e.sibling}}function F$(t,e){var n=null;t!==null&&t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(n=t.memoizedState.cachePool.pool),t=null,e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(t=e.memoizedState.cachePool.pool),t!==n&&(t!=null&&t.refCount++,n!=null&&mN(n))}function z$(t,e){t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&mN(t))}function Xm(t,e,n,i){if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Ble(t,e,n,i),e=e.sibling}function Ble(t,e,n,i){var r=e.flags;switch(e.tag){case 0:case 11:case 15:Xm(t,e,n,i),r&2048&&_N(9,e);break;case 1:Xm(t,e,n,i);break;case 3:Xm(t,e,n,i),r&2048&&(t=null,e.alternate!==null&&(t=e.alternate.memoizedState.cache),e=e.memoizedState.cache,e!==t&&(e.refCount++,t!=null&&mN(t)));break;case 12:if(r&2048){Xm(t,e,n,i),t=e.stateNode;try{var s=e.memoizedProps,a=s.id,o=s.onPostCommit;typeof o=="function"&&o(a,e.alternate===null?"mount":"update",t.passiveEffectDuration,-0)}catch(c){$s(e,e.return,c)}}else Xm(t,e,n,i);break;case 13:Xm(t,e,n,i);break;case 23:break;case 22:s=e.stateNode,a=e.alternate,e.memoizedState!==null?s._visibility&2?Xm(t,e,n,i):YA(t,e):s._visibility&2?Xm(t,e,n,i):(s._visibility|=2,b1(t,e,n,i,(e.subtreeFlags&10256)!==0)),r&2048&&F$(a,e);break;case 24:Xm(t,e,n,i),r&2048&&z$(e.alternate,e);break;default:Xm(t,e,n,i)}}function b1(t,e,n,i,r){for(r=r&&(e.subtreeFlags&10256)!==0,e=e.child;e!==null;){var s=t,a=e,o=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:b1(s,a,o,c,r),_N(8,a);break;case 23:break;case 22:var u=a.stateNode;a.memoizedState!==null?u._visibility&2?b1(s,a,o,c,r):YA(s,a):(u._visibility|=2,b1(s,a,o,c,r)),r&&l&2048&&F$(a.alternate,a);break;case 24:b1(s,a,o,c,r),r&&l&2048&&z$(a.alternate,a);break;default:b1(s,a,o,c,r)}e=e.sibling}}function YA(t,e){if(e.subtreeFlags&10256)for(e=e.child;e!==null;){var n=t,i=e,r=i.flags;switch(i.tag){case 22:YA(n,i),r&2048&&F$(i.alternate,i);break;case 24:YA(n,i),r&2048&&z$(i.alternate,i);break;default:YA(n,i)}e=e.sibling}}var gA=8192;function e1(t){if(t.subtreeFlags&gA)for(t=t.child;t!==null;)Fle(t),t=t.sibling}function Fle(t){switch(t.tag){case 26:e1(t),t.flags&gA&&t.memoizedState!==null&&_ke(Fp,t.memoizedState,t.memoizedProps);break;case 5:e1(t);break;case 3:case 4:var e=Fp;Fp=c2(t.stateNode.containerInfo),e1(t),Fp=e;break;case 22:t.memoizedState===null&&(e=t.alternate,e!==null&&e.memoizedState!==null?(e=gA,gA=16777216,e1(t),gA=e):e1(t));break;default:e1(t)}}function zle(t){var e=t.alternate;if(e!==null&&(t=e.child,t!==null)){e.child=null;do e=t.sibling,t.sibling=null,t=e;while(t!==null)}}function GR(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];il=i,jle(i,t)}zle(t)}if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Hle(t),t=t.sibling}function Hle(t){switch(t.tag){case 0:case 11:case 15:GR(t),t.flags&2048&&bb(9,t,t.return);break;case 3:GR(t);break;case 12:GR(t);break;case 22:var e=t.stateNode;t.memoizedState!==null&&e._visibility&2&&(t.return===null||t.return.tag!==13)?(e._visibility&=-3,XD(t)):GR(t);break;default:GR(t)}}function XD(t){var e=t.deletions;if(t.flags&16){if(e!==null)for(var n=0;n<e.length;n++){var i=e[n];il=i,jle(i,t)}zle(t)}for(t=t.child;t!==null;){switch(e=t,e.tag){case 0:case 11:case 15:bb(8,e,e.return),XD(e);break;case 22:n=e.stateNode,n._visibility&2&&(n._visibility&=-3,XD(e));break;default:XD(e)}t=t.sibling}}function jle(t,e){for(;il!==null;){var n=il;switch(n.tag){case 0:case 11:case 15:bb(8,n,e);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var i=n.memoizedState.cachePool.pool;i!=null&&i.refCount++}break;case 24:mN(n.memoizedState.cache)}if(i=n.child,i!==null)i.return=n,il=i;else e:for(n=t;il!==null;){i=il;var r=i.sibling,s=i.return;if(kle(i),i===n){il=null;break e}if(r!==null){r.return=s,il=r;break e}il=s}}}var PIe={getCacheForType:function(t){var e=au(Oc),n=e.data.get(t);return n===void 0&&(n=t(),e.data.set(t,n)),n}},LIe=typeof WeakMap=="function"?WeakMap:Map,Rs=0,ra=null,Cr=null,Vr=0,Cs=0,Od=null,$_=!1,VC=!1,H$=!1,ey=0,vo=0,Eb=0,qS=0,j$=0,Vf=0,Kw=0,XA=null,Oh=null,R5=!1,V$=0,n2=1/0,i2=null,eb=null,Il=0,tb=null,Jw=null,dw=0,A5=0,M5=null,Vle=null,KA=0,O5=null;function Vd(){if(Rs&2&&Vr!==0)return Vr&-Vr;if(Ui.T!==null){var t=$w;return t!==0?t:q$()}return ece()}function Gle(){Vf===0&&(Vf=!(Vr&536870912)||ms?Koe():536870912);var t=Qf.current;return t!==null&&(t.flags|=32),Vf}function Gd(t,e,n){(t===ra&&(Cs===2||Cs===9)||t.cancelPendingCommit!==null)&&(Zw(t,0),W_(t,Vr,Vf,!1)),uN(t,n),(!(Rs&2)||t!==ra)&&(t===ra&&(!(Rs&2)&&(qS|=n),vo===4&&W_(t,Vr,Vf,!1)),Kg(t))}function qle(t,e,n){if(Rs&6)throw Error(jt(327));var i=!n&&(e&124)===0&&(e&t.expiredLanes)===0||lN(t,e),r=i?FIe(t,e):O8(t,e,!0),s=i;do{if(r===0){VC&&!i&&W_(t,e,0,!1);break}else{if(n=t.current.alternate,s&&!UIe(n)){r=O8(t,e,!1),s=!1;continue}if(r===2){if(s=e,t.errorRecoveryDisabledLanes&s)var a=0;else a=t.pendingLanes&-536870913,a=a!==0?a:a&536870912?536870912:0;if(a!==0){e=a;e:{var o=t;r=XA;var c=o.current.memoizedState.isDehydrated;if(c&&(Zw(o,a).flags|=256),a=O8(o,a,!1),a!==2){if(H$&&!c){o.errorRecoveryDisabledLanes|=s,qS|=s,r=4;break e}s=Oh,Oh=r,s!==null&&(Oh===null?Oh=s:Oh.push.apply(Oh,s))}r=a}if(s=!1,r!==2)continue}}if(r===1){Zw(t,0),W_(t,e,0,!0);break}e:{switch(i=t,s=r,s){case 0:case 1:throw Error(jt(345));case 4:if((e&4194048)!==e)break;case 6:W_(i,e,Vf,!$_);break e;case 2:Oh=null;break;case 3:case 5:break;default:throw Error(jt(329))}if((e&62914560)===e&&(r=V$+300-Tg(),10<r)){if(W_(i,e,Vf,!$_),R3(i,0,!0)!==0)break e;i.timeoutHandle=uue(QJ.bind(null,i,n,Oh,i2,R5,e,Vf,qS,Kw,$_,s,2,-0,0),r);break e}QJ(i,n,Oh,i2,R5,e,Vf,qS,Kw,$_,s,0,-0,0)}}break}while(!0);Kg(t)}function QJ(t,e,n,i,r,s,a,o,c,l,u,h,d,f){if(t.timeoutHandle=-1,h=e.subtreeFlags,(h&8192||(h&16785408)===16785408)&&(jM={stylesheets:null,count:0,unsuspend:yke},Fle(e),h=bke(),h!==null)){t.cancelPendingCommit=h(tZ.bind(null,t,e,s,n,i,r,a,o,c,u,1,d,f)),W_(t,s,a,!l);return}tZ(t,e,s,n,i,r,a,o,c)}function UIe(t){for(var e=t;;){var n=e.tag;if((n===0||n===11||n===15)&&e.flags&16384&&(n=e.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Wd(s(),r))return!1}catch{return!1}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function W_(t,e,n,i){e&=~j$,e&=~qS,t.suspendedLanes|=e,t.pingedLanes&=~e,i&&(t.warmLanes|=e),i=t.expirationTimes;for(var r=e;0<r;){var s=31-jd(r),a=1<<s;i[s]=-1,r&=~a}n!==0&&Zoe(t,n,e)}function U3(){return Rs&6?!0:(bN(0),!1)}function G$(){if(Cr!==null){if(Cs===0)var t=Cr.return;else t=Cr,Dv=HT=null,O$(t),hw=null,FM=0,t=Cr;for(;t!==null;)Cle(t.alternate,t),t=t.return;Cr=null}}function Zw(t,e){var n=t.timeoutHandle;n!==-1&&(t.timeoutHandle=-1,tke(n)),n=t.cancelPendingCommit,n!==null&&(t.cancelPendingCommit=null,n()),G$(),ra=t,Cr=n=Hv(t.current,null),Vr=e,Cs=0,Od=null,$_=!1,VC=lN(t,e),H$=!1,Kw=Vf=j$=qS=Eb=vo=0,Oh=XA=null,R5=!1,e&8&&(e|=e&32);var i=t.entangledLanes;if(i!==0)for(t=t.entanglements,i&=e;0<i;){var r=31-jd(i),s=1<<r;e|=t[r],i&=~s}return ey=e,N3(),n}function $le(t,e){vr=null,Ui.H=KL,e===gN||e===k3?(e=NJ(),Cs=3):e===Oce?(e=NJ(),Cs=4):Cs=e===ble?8:e!==null&&typeof e=="object"&&typeof e.then=="function"?6:1,Od=e,Cr===null&&(vo=1,QL(t,Lf(e,t.current)))}function Wle(){var t=Ui.H;return Ui.H=KL,t===null?KL:t}function Yle(){var t=Ui.A;return Ui.A=PIe,t}function N5(){vo=4,$_||(Vr&4194048)!==Vr&&Qf.current!==null||(VC=!0),!(Eb&134217727)&&!(qS&134217727)||ra===null||W_(ra,Vr,Vf,!1)}function O8(t,e,n){var i=Rs;Rs|=2;var r=Wle(),s=Yle();(ra!==t||Vr!==e)&&(i2=null,Zw(t,e)),e=!1;var a=vo;e:do try{if(Cs!==0&&Cr!==null){var o=Cr,c=Od;switch(Cs){case 8:G$(),a=6;break e;case 3:case 2:case 9:case 6:Qf.current===null&&(e=!0);var l=Cs;if(Cs=0,Od=null,G1(t,o,c,l),n&&VC){a=0;break e}break;default:l=Cs,Cs=0,Od=null,G1(t,o,c,l)}}BIe(),a=vo;break}catch(u){$le(t,u)}while(!0);return e&&t.shellSuspendCounter++,Dv=HT=null,Rs=i,Ui.H=r,Ui.A=s,Cr===null&&(ra=null,Vr=0,N3()),a}function BIe(){for(;Cr!==null;)Xle(Cr)}function FIe(t,e){var n=Rs;Rs|=2;var i=Wle(),r=Yle();ra!==t||Vr!==e?(i2=null,n2=Tg()+500,Zw(t,e)):VC=lN(t,e);e:do try{if(Cs!==0&&Cr!==null){e=Cr;var s=Od;t:switch(Cs){case 1:Cs=0,Od=null,G1(t,e,s,1);break;case 2:case 9:if(OJ(s)){Cs=0,Od=null,eZ(e);break}e=function(){Cs!==2&&Cs!==9||ra!==t||(Cs=7),Kg(t)},s.then(e,e);break e;case 3:Cs=7;break e;case 4:Cs=5;break e;case 7:OJ(s)?(Cs=0,Od=null,eZ(e)):(Cs=0,Od=null,G1(t,e,s,7));break;case 5:var a=null;switch(Cr.tag){case 26:a=Cr.memoizedState;case 5:case 27:var o=Cr;if(!a||pue(a)){Cs=0,Od=null;var c=o.sibling;if(c!==null)Cr=c;else{var l=o.return;l!==null?(Cr=l,B3(l)):Cr=null}break t}}Cs=0,Od=null,G1(t,e,s,5);break;case 6:Cs=0,Od=null,G1(t,e,s,6);break;case 8:G$(),vo=6;break e;default:throw Error(jt(462))}}zIe();break}catch(u){$le(t,u)}while(!0);return Dv=HT=null,Ui.H=i,Ui.A=r,Rs=n,Cr!==null?0:(ra=null,Vr=0,N3(),vo)}function zIe(){for(;Cr!==null&&!cNe();)Xle(Cr)}function Xle(t){var e=wle(t.alternate,t,ey);t.memoizedProps=t.pendingProps,e===null?B3(t):Cr=e}function eZ(t){var e=t,n=e.alternate;switch(e.tag){case 15:case 0:e=WJ(n,e,e.pendingProps,e.type,void 0,Vr);break;case 11:e=WJ(n,e,e.pendingProps,e.type.render,e.ref,Vr);break;case 5:O$(e);default:Cle(n,e),e=Cr=Cce(e,ey),e=wle(n,e,ey)}t.memoizedProps=t.pendingProps,e===null?B3(t):Cr=e}function G1(t,e,n,i){Dv=HT=null,O$(e),hw=null,FM=0;var r=e.return;try{if(MIe(t,r,e,n,Vr)){vo=1,QL(t,Lf(n,t.current)),Cr=null;return}}catch(s){if(r!==null)throw Cr=r,s;vo=1,QL(t,Lf(n,t.current)),Cr=null;return}e.flags&32768?(ms||i===1?t=!0:VC||Vr&536870912?t=!1:($_=t=!0,(i===2||i===9||i===3||i===6)&&(i=Qf.current,i!==null&&i.tag===13&&(i.flags|=16384))),Kle(e,t)):B3(e)}function B3(t){var e=t;do{if(e.flags&32768){Kle(e,$_);return}t=e.return;var n=NIe(e.alternate,e,ey);if(n!==null){Cr=n;return}if(e=e.sibling,e!==null){Cr=e;return}Cr=e=t}while(e!==null);vo===0&&(vo=5)}function Kle(t,e){do{var n=IIe(t.alternate,t);if(n!==null){n.flags&=32767,Cr=n;return}if(n=t.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!e&&(t=t.sibling,t!==null)){Cr=t;return}Cr=t=n}while(t!==null);vo=6,Cr=null}function tZ(t,e,n,i,r,s,a,o,c){t.cancelPendingCommit=null;do F3();while(Il!==0);if(Rs&6)throw Error(jt(327));if(e!==null){if(e===t.current)throw Error(jt(177));if(s=e.lanes|e.childLanes,s|=v$,yNe(t,n,s,a,o,c),t===ra&&(Cr=ra=null,Vr=0),Jw=e,tb=t,dw=n,A5=s,M5=r,Vle=i,e.subtreeFlags&10256||e.flags&10256?(t.callbackNode=null,t.callbackPriority=0,GIe(zL,function(){return tue(),null})):(t.callbackNode=null,t.callbackPriority=0),i=(e.flags&13878)!==0,e.subtreeFlags&13878||i){i=Ui.T,Ui.T=null,r=gs.p,gs.p=2,a=Rs,Rs|=4;try{kIe(t,e,n)}finally{Rs=a,gs.p=r,Ui.T=i}}Il=1,Jle(),Zle(),Qle()}}function Jle(){if(Il===1){Il=0;var t=tb,e=Jw,n=(e.flags&13878)!==0;if(e.subtreeFlags&13878||n){n=Ui.T,Ui.T=null;var i=gs.p;gs.p=2;var r=Rs;Rs|=4;try{Lle(e,t);var s=P5,a=yce(t.containerInfo),o=s.focusedElem,c=s.selectionRange;if(a!==o&&o&&o.ownerDocument&&vce(o.ownerDocument.documentElement,o)){if(c!==null&&g$(o)){var l=c.start,u=c.end;if(u===void 0&&(u=l),"selectionStart"in o)o.selectionStart=l,o.selectionEnd=Math.min(u,o.value.length);else{var h=o.ownerDocument||document,d=h&&h.defaultView||window;if(d.getSelection){var f=d.getSelection(),p=o.textContent.length,g=Math.min(c.start,p),_=c.end===void 0?g:Math.min(c.end,p);!f.extend&&g>_&&(a=_,_=g,g=a);var v=SJ(o,g),E=SJ(o,_);if(v&&E&&(f.rangeCount!==1||f.anchorNode!==v.node||f.anchorOffset!==v.offset||f.focusNode!==E.node||f.focusOffset!==E.offset)){var T=h.createRange();T.setStart(v.node,v.offset),f.removeAllRanges(),g>_?(f.addRange(T),f.extend(E.node,E.offset)):(T.setEnd(E.node,E.offset),f.addRange(T))}}}}for(h=[],f=o;f=f.parentNode;)f.nodeType===1&&h.push({element:f,left:f.scrollLeft,top:f.scrollTop});for(typeof o.focus=="function"&&o.focus(),o=0;o<h.length;o++){var x=h[o];x.element.scrollLeft=x.left,x.element.scrollTop=x.top}}h2=!!D5,P5=D5=null}finally{Rs=r,gs.p=i,Ui.T=n}}t.current=e,Il=2}}function Zle(){if(Il===2){Il=0;var t=tb,e=Jw,n=(e.flags&8772)!==0;if(e.subtreeFlags&8772||n){n=Ui.T,Ui.T=null;var i=gs.p;gs.p=2;var r=Rs;Rs|=4;try{Ile(t,e.alternate,e)}finally{Rs=r,gs.p=i,Ui.T=n}}Il=3}}function Qle(){if(Il===4||Il===3){Il=0,lNe();var t=tb,e=Jw,n=dw,i=Vle;e.subtreeFlags&10256||e.flags&10256?Il=5:(Il=0,Jw=tb=null,eue(t,t.pendingLanes));var r=t.pendingLanes;if(r===0&&(eb=null),l$(n),e=e.stateNode,Hd&&typeof Hd.onCommitFiberRoot=="function")try{Hd.onCommitFiberRoot(cN,e,void 0,(e.current.flags&128)===128)}catch{}if(i!==null){e=Ui.T,r=gs.p,gs.p=2,Ui.T=null;try{for(var s=t.onRecoverableError,a=0;a<i.length;a++){var o=i[a];s(o.value,{componentStack:o.stack})}}finally{Ui.T=e,gs.p=r}}dw&3&&F3(),Kg(t),r=t.pendingLanes,n&4194090&&r&42?t===O5?KA++:(KA=0,O5=t):KA=0,bN(0)}}function eue(t,e){(t.pooledCacheLanes&=e)===0&&(e=t.pooledCache,e!=null&&(t.pooledCache=null,mN(e)))}function F3(t){return Jle(),Zle(),Qle(),tue()}function tue(){if(Il!==5)return!1;var t=tb,e=A5;A5=0;var n=l$(dw),i=Ui.T,r=gs.p;try{gs.p=32>n?32:n,Ui.T=null,n=M5,M5=null;var s=tb,a=dw;if(Il=0,Jw=tb=null,dw=0,Rs&6)throw Error(jt(331));var o=Rs;if(Rs|=4,Hle(s.current),Ble(s,s.current,a,n),Rs=o,bN(0,!1),Hd&&typeof Hd.onPostCommitFiberRoot=="function")try{Hd.onPostCommitFiberRoot(cN,s)}catch{}return!0}finally{gs.p=r,Ui.T=i,eue(t,e)}}function nZ(t,e,n){e=Lf(n,e),e=T5(t.stateNode,e,2),t=Q_(t,e,2),t!==null&&(uN(t,2),Kg(t))}function $s(t,e,n){if(t.tag===3)nZ(t,t,n);else for(;e!==null;){if(e.tag===3){nZ(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(eb===null||!eb.has(i))){t=Lf(n,t),n=yle(2),i=Q_(e,n,2),i!==null&&(_le(n,i,e,t),uN(i,2),Kg(i));break}}e=e.return}}function N8(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new LIe;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(H$=!0,r.add(n),t=HIe.bind(null,t,e,n),e.then(t,t))}function HIe(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),t.pingedLanes|=t.suspendedLanes&n,t.warmLanes&=~n,ra===t&&(Vr&n)===n&&(vo===4||vo===3&&(Vr&62914560)===Vr&&300>Tg()-V$?!(Rs&2)&&Zw(t,0):j$|=n,Kw===Vr&&(Kw=0)),Kg(t)}function nue(t,e){e===0&&(e=Joe()),t=jC(t,e),t!==null&&(uN(t,e),Kg(t))}function jIe(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),nue(t,n)}function VIe(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;case 22:i=t.stateNode._retryCache;break;default:throw Error(jt(314))}i!==null&&i.delete(e),nue(t,n)}function GIe(t,e){return o$(t,e)}var r2=null,E1=null,I5=!1,s2=!1,I8=!1,$S=0;function Kg(t){t!==E1&&t.next===null&&(E1===null?r2=E1=t:E1=E1.next=t),s2=!0,I5||(I5=!0,$Ie())}function bN(t,e){if(!I8&&s2){I8=!0;do for(var n=!1,i=r2;i!==null;){if(t!==0){var r=i.pendingLanes;if(r===0)var s=0;else{var a=i.suspendedLanes,o=i.pingedLanes;s=(1<<31-jd(42|t)+1)-1,s&=r&~(a&~o),s=s&201326741?s&201326741|1:s?s|2:0}s!==0&&(n=!0,iZ(i,s))}else s=Vr,s=R3(i,i===ra?s:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),!(s&3)||lN(i,s)||(n=!0,iZ(i,s));i=i.next}while(n);I8=!1}}function qIe(){iue()}function iue(){s2=I5=!1;var t=0;$S!==0&&(eke()&&(t=$S),$S=0);for(var e=Tg(),n=null,i=r2;i!==null;){var r=i.next,s=rue(i,e);s===0?(i.next=null,n===null?r2=r:n.next=r,r===null&&(E1=n)):(n=i,(t!==0||s&3)&&(s2=!0)),i=r}bN(t)}function rue(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes&-62914561;0<s;){var a=31-jd(s),o=1<<a,c=r[a];c===-1?(!(o&n)||o&i)&&(r[a]=vNe(o,e)):c<=e&&(t.expiredLanes|=o),s&=~o}if(e=ra,n=Vr,n=R3(t,t===e?n:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i=t.callbackNode,n===0||t===e&&(Cs===2||Cs===9)||t.cancelPendingCommit!==null)return i!==null&&i!==null&&r8(i),t.callbackNode=null,t.callbackPriority=0;if(!(n&3)||lN(t,n)){if(e=n&-n,e===t.callbackPriority)return e;switch(i!==null&&r8(i),l$(n)){case 2:case 8:n=Yoe;break;case 32:n=zL;break;case 268435456:n=Xoe;break;default:n=zL}return i=sue.bind(null,t),n=o$(n,i),t.callbackPriority=e,t.callbackNode=n,e}return i!==null&&i!==null&&r8(i),t.callbackPriority=2,t.callbackNode=null,2}function sue(t,e){if(Il!==0&&Il!==5)return t.callbackNode=null,t.callbackPriority=0,null;var n=t.callbackNode;if(F3()&&t.callbackNode!==n)return null;var i=Vr;return i=R3(t,t===ra?i:0,t.cancelPendingCommit!==null||t.timeoutHandle!==-1),i===0?null:(qle(t,i,e),rue(t,Tg()),t.callbackNode!=null&&t.callbackNode===n?sue.bind(null,t):null)}function iZ(t,e){if(F3())return null;qle(t,e,!0)}function $Ie(){nke(function(){Rs&6?o$(Woe,qIe):iue()})}function q$(){return $S===0&&($S=Koe()),$S}function rZ(t){return t==null||typeof t=="symbol"||typeof t=="boolean"?null:typeof t=="function"?t:HD(""+t)}function sZ(t,e){var n=e.ownerDocument.createElement("input");return n.name=e.name,n.value=e.value,t.id&&n.setAttribute("form",t.id),e.parentNode.insertBefore(n,e),t=new FormData(t),n.parentNode.removeChild(n),t}function WIe(t,e,n,i,r){if(e==="submit"&&n&&n.stateNode===r){var s=rZ((r[Wh]||null).action),a=i.submitter;a&&(e=(e=a[Wh]||null)?rZ(e.formAction):a.getAttribute("formAction"),e!==null&&(s=e,a=null));var o=new A3("action","action",null,i,r);t.push({event:o,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if($S!==0){var c=a?sZ(r,a):new FormData(r);E5(n,{pending:!0,data:c,method:r.method,action:s},null,c)}}else typeof s=="function"&&(o.preventDefault(),c=a?sZ(r,a):new FormData(r),E5(n,{pending:!0,data:c,method:r.method,action:s},s,c))},currentTarget:r}]})}}for(var k8=0;k8<l5.length;k8++){var D8=l5[k8],YIe=D8.toLowerCase(),XIe=D8[0].toUpperCase()+D8.slice(1);om(YIe,"on"+XIe)}om(bce,"onAnimationEnd");om(Ece,"onAnimationIteration");om(Sce,"onAnimationStart");om("dblclick","onDoubleClick");om("focusin","onFocus");om("focusout","onBlur");om(dIe,"onTransitionRun");om(fIe,"onTransitionStart");om(pIe,"onTransitionCancel");om(Tce,"onTransitionEnd");Gw("onMouseEnter",["mouseout","mouseover"]);Gw("onMouseLeave",["mouseout","mouseover"]);Gw("onPointerEnter",["pointerout","pointerover"]);Gw("onPointerLeave",["pointerout","pointerover"]);BT("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));BT("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));BT("onBeforeInput",["compositionend","keypress","textInput","paste"]);BT("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));BT("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));BT("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zM="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KIe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zM));function aue(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],c=o.instance,l=o.currentTarget;if(o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){ZL(u)}r.currentTarget=null,s=c}else for(a=0;a<i.length;a++){if(o=i[a],c=o.instance,l=o.currentTarget,o=o.listener,c!==s&&r.isPropagationStopped())break e;s=o,r.currentTarget=l;try{s(r)}catch(u){ZL(u)}r.currentTarget=null,s=c}}}}function wr(t,e){var n=e[n5];n===void 0&&(n=e[n5]=new Set);var i=t+"__bubble";n.has(i)||(oue(e,t,2,!1),n.add(i))}function P8(t,e,n){var i=0;e&&(i|=4),oue(n,t,i,e)}var Hk="_reactListening"+Math.random().toString(36).slice(2);function $$(t){if(!t[Hk]){t[Hk]=!0,tce.forEach(function(n){n!=="selectionchange"&&(KIe.has(n)||P8(n,!1,t),P8(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hk]||(e[Hk]=!0,P8("selectionchange",!1,e))}}function oue(t,e,n,i){switch(_ue(e)){case 2:var r=Tke;break;case 8:r=xke;break;default:r=K$}n=r.bind(null,e,n,t),r=void 0,!a5||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function L8(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r)break;if(a===4)for(a=i.return;a!==null;){var c=a.tag;if((c===3||c===4)&&a.stateNode.containerInfo===r)return;a=a.return}for(;o!==null;){if(a=P1(o),a===null)return;if(c=a.tag,c===5||c===6||c===26||c===27){i=s=a;continue e}o=o.parentNode}}i=i.return}lce(function(){var l=s,u=d$(n),h=[];e:{var d=xce.get(t);if(d!==void 0){var f=A3,p=t;switch(t){case"keypress":if(VD(n)===0)break e;case"keydown":case"keyup":f=GNe;break;case"focusin":p="focus",f=d8;break;case"focusout":p="blur",f=d8;break;case"beforeblur":case"afterblur":f=d8;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=dJ;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=INe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=WNe;break;case bce:case Ece:case Sce:f=PNe;break;case Tce:f=XNe;break;case"scroll":case"scrollend":f=ONe;break;case"wheel":f=JNe;break;case"copy":case"cut":case"paste":f=UNe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=pJ;break;case"toggle":case"beforetoggle":f=QNe}var g=(e&4)!==0,_=!g&&(t==="scroll"||t==="scrollend"),v=g?d!==null?d+"Capture":null:d;g=[];for(var E=l,T;E!==null;){var x=E;if(T=x.stateNode,x=x.tag,x!==5&&x!==26&&x!==27||T===null||v===null||(x=DM(E,v),x!=null&&g.push(HM(E,x,T))),_)break;E=E.return}0<g.length&&(d=new f(d,p,null,n,u),h.push({event:d,listeners:g}))}}if(!(e&7)){e:{if(d=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",d&&n!==s5&&(p=n.relatedTarget||n.fromElement)&&(P1(p)||p[zC]))break e;if((f||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=l,p=p?P1(p):null,p!==null&&(_=oN(p),g=p.tag,p!==_||g!==5&&g!==27&&g!==6)&&(p=null)):(f=null,p=l),f!==p)){if(g=dJ,x="onMouseLeave",v="onMouseEnter",E="mouse",(t==="pointerout"||t==="pointerover")&&(g=pJ,x="onPointerLeave",v="onPointerEnter",E="pointer"),_=f==null?d:mA(f),T=p==null?d:mA(p),d=new g(x,E+"leave",f,n,u),d.target=_,d.relatedTarget=T,x=null,P1(u)===l&&(g=new g(v,E+"enter",p,n,u),g.target=T,g.relatedTarget=_,x=g),_=x,f&&p)t:{for(g=f,v=p,E=0,T=g;T;T=t1(T))E++;for(T=0,x=v;x;x=t1(x))T++;for(;0<E-T;)g=t1(g),E--;for(;0<T-E;)v=t1(v),T--;for(;E--;){if(g===v||v!==null&&g===v.alternate)break t;g=t1(g),v=t1(v)}g=null}else g=null;f!==null&&aZ(h,d,f,g,!1),p!==null&&_!==null&&aZ(h,_,p,g,!0)}}e:{if(d=l?mA(l):window,f=d.nodeName&&d.nodeName.toLowerCase(),f==="select"||f==="input"&&d.type==="file")var N=yJ;else if(vJ(d))if(mce)N=lIe;else{N=oIe;var A=aIe}else f=d.nodeName,!f||f.toLowerCase()!=="input"||d.type!=="checkbox"&&d.type!=="radio"?l&&h$(l.elementType)&&(N=yJ):N=cIe;if(N&&(N=N(t,l))){pce(h,N,n,u);break e}A&&A(t,d,l),t==="focusout"&&l&&d.type==="number"&&l.memoizedProps.value!=null&&r5(d,"number",d.value)}switch(A=l?mA(l):window,t){case"focusin":(vJ(A)||A.contentEditable==="true")&&(B1=A,o5=l,zA=null);break;case"focusout":zA=o5=B1=null;break;case"mousedown":c5=!0;break;case"contextmenu":case"mouseup":case"dragend":c5=!1,TJ(h,n,u);break;case"selectionchange":if(hIe)break;case"keydown":case"keyup":TJ(h,n,u)}var I;if(m$)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else U1?dce(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(hce&&n.locale!=="ko"&&(U1||k!=="onCompositionStart"?k==="onCompositionEnd"&&U1&&(I=uce()):(q_=u,f$="value"in q_?q_.value:q_.textContent,U1=!0)),A=a2(l,k),0<A.length&&(k=new fJ(k,t,null,n,u),h.push({event:k,listeners:A}),I?k.data=I:(I=fce(n),I!==null&&(k.data=I)))),(I=tIe?nIe(t,n):iIe(t,n))&&(k=a2(l,"onBeforeInput"),0<k.length&&(A=new fJ("onBeforeInput","beforeinput",null,n,u),h.push({event:A,listeners:k}),A.data=I)),WIe(h,t,l,n,u)}aue(h,e)})}function HM(t,e,n){return{instance:t,listener:e,currentTarget:n}}function a2(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||s===null||(r=DM(t,n),r!=null&&i.unshift(HM(t,r,s)),r=DM(t,e),r!=null&&i.push(HM(t,r,s))),t.tag===3)return i;t=t.return}return[]}function t1(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5&&t.tag!==27);return t||null}function aZ(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,c=o.alternate,l=o.stateNode;if(o=o.tag,c!==null&&c===i)break;o!==5&&o!==26&&o!==27||l===null||(c=l,r?(l=DM(n,s),l!=null&&a.unshift(HM(n,l,c))):r||(l=DM(n,s),l!=null&&a.push(HM(n,l,c)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var JIe=/\r\n?/g,ZIe=/\u0000|\uFFFD/g;function oZ(t){return(typeof t=="string"?t:""+t).replace(JIe,`
`).replace(ZIe,"")}function cue(t,e){return e=oZ(e),oZ(t)===e}function z3(){}function Ls(t,e,n,i,r,s){switch(n){case"children":typeof i=="string"?e==="body"||e==="textarea"&&i===""||qw(t,i):(typeof i=="number"||typeof i=="bigint")&&e!=="body"&&qw(t,""+i);break;case"className":Dk(t,"class",i);break;case"tabIndex":Dk(t,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":Dk(t,n,i);break;case"style":cce(t,i,s);break;case"data":if(e!=="object"){Dk(t,"data",i);break}case"src":case"href":if(i===""&&(e!=="a"||n!=="href")){t.removeAttribute(n);break}if(i==null||typeof i=="function"||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=HD(""+i),t.setAttribute(n,i);break;case"action":case"formAction":if(typeof i=="function"){t.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof s=="function"&&(n==="formAction"?(e!=="input"&&Ls(t,e,"name",r.name,r,null),Ls(t,e,"formEncType",r.formEncType,r,null),Ls(t,e,"formMethod",r.formMethod,r,null),Ls(t,e,"formTarget",r.formTarget,r,null)):(Ls(t,e,"encType",r.encType,r,null),Ls(t,e,"method",r.method,r,null),Ls(t,e,"target",r.target,r,null)));if(i==null||typeof i=="symbol"||typeof i=="boolean"){t.removeAttribute(n);break}i=HD(""+i),t.setAttribute(n,i);break;case"onClick":i!=null&&(t.onclick=z3);break;case"onScroll":i!=null&&wr("scroll",t);break;case"onScrollEnd":i!=null&&wr("scrollend",t);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(jt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(jt(60));t.innerHTML=n}}break;case"multiple":t.multiple=i&&typeof i!="function"&&typeof i!="symbol";break;case"muted":t.muted=i&&typeof i!="function"&&typeof i!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(i==null||typeof i=="function"||typeof i=="boolean"||typeof i=="symbol"){t.removeAttribute("xlink:href");break}n=HD(""+i),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""+i):t.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,""):t.removeAttribute(n);break;case"capture":case"download":i===!0?t.setAttribute(n,""):i!==!1&&i!=null&&typeof i!="function"&&typeof i!="symbol"?t.setAttribute(n,i):t.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":i!=null&&typeof i!="function"&&typeof i!="symbol"&&!isNaN(i)&&1<=i?t.setAttribute(n,i):t.removeAttribute(n);break;case"rowSpan":case"start":i==null||typeof i=="function"||typeof i=="symbol"||isNaN(i)?t.removeAttribute(n):t.setAttribute(n,i);break;case"popover":wr("beforetoggle",t),wr("toggle",t),zD(t,"popover",i);break;case"xlinkActuate":cv(t,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":cv(t,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":cv(t,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":cv(t,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":cv(t,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":cv(t,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":cv(t,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":cv(t,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":cv(t,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":zD(t,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=ANe.get(n)||n,zD(t,n,i))}}function k5(t,e,n,i,r,s){switch(n){case"style":cce(t,i,s);break;case"dangerouslySetInnerHTML":if(i!=null){if(typeof i!="object"||!("__html"in i))throw Error(jt(61));if(n=i.__html,n!=null){if(r.children!=null)throw Error(jt(60));t.innerHTML=n}}break;case"children":typeof i=="string"?qw(t,i):(typeof i=="number"||typeof i=="bigint")&&qw(t,""+i);break;case"onScroll":i!=null&&wr("scroll",t);break;case"onScrollEnd":i!=null&&wr("scrollend",t);break;case"onClick":i!=null&&(t.onclick=z3);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nce.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),e=n.slice(2,r?n.length-7:void 0),s=t[Wh]||null,s=s!=null?s[n]:null,typeof s=="function"&&t.removeEventListener(e,s,r),typeof i=="function")){typeof s!="function"&&s!==null&&(n in t?t[n]=null:t.hasAttribute(n)&&t.removeAttribute(n)),t.addEventListener(e,i,r);break e}n in t?t[n]=i:i===!0?t.setAttribute(n,""):zD(t,n,i)}}}function Pl(t,e,n){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wr("error",t),wr("load",t);var i=!1,r=!1,s;for(s in n)if(n.hasOwnProperty(s)){var a=n[s];if(a!=null)switch(s){case"src":i=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(jt(137,e));default:Ls(t,e,s,a,n,null)}}r&&Ls(t,e,"srcSet",n.srcSet,n,null),i&&Ls(t,e,"src",n.src,n,null);return;case"input":wr("invalid",t);var o=s=a=r=null,c=null,l=null;for(i in n)if(n.hasOwnProperty(i)){var u=n[i];if(u!=null)switch(i){case"name":r=u;break;case"type":a=u;break;case"checked":c=u;break;case"defaultChecked":l=u;break;case"value":s=u;break;case"defaultValue":o=u;break;case"children":case"dangerouslySetInnerHTML":if(u!=null)throw Error(jt(137,e));break;default:Ls(t,e,i,u,n,null)}}sce(t,s,o,c,l,a,r,!1),HL(t);return;case"select":wr("invalid",t),i=a=s=null;for(r in n)if(n.hasOwnProperty(r)&&(o=n[r],o!=null))switch(r){case"value":s=o;break;case"defaultValue":a=o;break;case"multiple":i=o;default:Ls(t,e,r,o,n,null)}e=s,n=a,t.multiple=!!i,e!=null?aw(t,!!i,e,!1):n!=null&&aw(t,!!i,n,!0);return;case"textarea":wr("invalid",t),s=r=i=null;for(a in n)if(n.hasOwnProperty(a)&&(o=n[a],o!=null))switch(a){case"value":i=o;break;case"defaultValue":r=o;break;case"children":s=o;break;case"dangerouslySetInnerHTML":if(o!=null)throw Error(jt(91));break;default:Ls(t,e,a,o,n,null)}oce(t,i,r,s),HL(t);return;case"option":for(c in n)if(n.hasOwnProperty(c)&&(i=n[c],i!=null))switch(c){case"selected":t.selected=i&&typeof i!="function"&&typeof i!="symbol";break;default:Ls(t,e,c,i,n,null)}return;case"dialog":wr("beforetoggle",t),wr("toggle",t),wr("cancel",t),wr("close",t);break;case"iframe":case"object":wr("load",t);break;case"video":case"audio":for(i=0;i<zM.length;i++)wr(zM[i],t);break;case"image":wr("error",t),wr("load",t);break;case"details":wr("toggle",t);break;case"embed":case"source":case"link":wr("error",t),wr("load",t);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(l in n)if(n.hasOwnProperty(l)&&(i=n[l],i!=null))switch(l){case"children":case"dangerouslySetInnerHTML":throw Error(jt(137,e));default:Ls(t,e,l,i,n,null)}return;default:if(h$(e)){for(u in n)n.hasOwnProperty(u)&&(i=n[u],i!==void 0&&k5(t,e,u,i,n,void 0));return}}for(o in n)n.hasOwnProperty(o)&&(i=n[o],i!=null&&Ls(t,e,o,i,n,null))}function QIe(t,e,n,i){switch(e){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,s=null,a=null,o=null,c=null,l=null,u=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&h!=null)switch(f){case"checked":break;case"value":break;case"defaultValue":c=h;default:i.hasOwnProperty(f)||Ls(t,e,f,null,i,h)}}for(var d in i){var f=i[d];if(h=n[d],i.hasOwnProperty(d)&&(f!=null||h!=null))switch(d){case"type":s=f;break;case"name":r=f;break;case"checked":l=f;break;case"defaultChecked":u=f;break;case"value":a=f;break;case"defaultValue":o=f;break;case"children":case"dangerouslySetInnerHTML":if(f!=null)throw Error(jt(137,e));break;default:f!==h&&Ls(t,e,d,f,i,h)}}i5(t,a,o,c,l,u,s,r);return;case"select":f=a=o=d=null;for(s in n)if(c=n[s],n.hasOwnProperty(s)&&c!=null)switch(s){case"value":break;case"multiple":f=c;default:i.hasOwnProperty(s)||Ls(t,e,s,null,i,c)}for(r in i)if(s=i[r],c=n[r],i.hasOwnProperty(r)&&(s!=null||c!=null))switch(r){case"value":d=s;break;case"defaultValue":o=s;break;case"multiple":a=s;default:s!==c&&Ls(t,e,r,s,i,c)}e=o,n=a,i=f,d!=null?aw(t,!!n,d,!1):!!i!=!!n&&(e!=null?aw(t,!!n,e,!0):aw(t,!!n,n?[]:"",!1));return;case"textarea":f=d=null;for(o in n)if(r=n[o],n.hasOwnProperty(o)&&r!=null&&!i.hasOwnProperty(o))switch(o){case"value":break;case"children":break;default:Ls(t,e,o,null,i,r)}for(a in i)if(r=i[a],s=n[a],i.hasOwnProperty(a)&&(r!=null||s!=null))switch(a){case"value":d=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(jt(91));break;default:r!==s&&Ls(t,e,a,r,i,s)}ace(t,d,f);return;case"option":for(var p in n)if(d=n[p],n.hasOwnProperty(p)&&d!=null&&!i.hasOwnProperty(p))switch(p){case"selected":t.selected=!1;break;default:Ls(t,e,p,null,i,d)}for(c in i)if(d=i[c],f=n[c],i.hasOwnProperty(c)&&d!==f&&(d!=null||f!=null))switch(c){case"selected":t.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Ls(t,e,c,d,i,f)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)d=n[g],n.hasOwnProperty(g)&&d!=null&&!i.hasOwnProperty(g)&&Ls(t,e,g,null,i,d);for(l in i)if(d=i[l],f=n[l],i.hasOwnProperty(l)&&d!==f&&(d!=null||f!=null))switch(l){case"children":case"dangerouslySetInnerHTML":if(d!=null)throw Error(jt(137,e));break;default:Ls(t,e,l,d,i,f)}return;default:if(h$(e)){for(var _ in n)d=n[_],n.hasOwnProperty(_)&&d!==void 0&&!i.hasOwnProperty(_)&&k5(t,e,_,void 0,i,d);for(u in i)d=i[u],f=n[u],!i.hasOwnProperty(u)||d===f||d===void 0&&f===void 0||k5(t,e,u,d,i,f);return}}for(var v in n)d=n[v],n.hasOwnProperty(v)&&d!=null&&!i.hasOwnProperty(v)&&Ls(t,e,v,null,i,d);for(h in i)d=i[h],f=n[h],!i.hasOwnProperty(h)||d===f||d==null&&f==null||Ls(t,e,h,d,i,f)}var D5=null,P5=null;function o2(t){return t.nodeType===9?t:t.ownerDocument}function cZ(t){switch(t){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function lue(t,e){if(t===0)switch(e){case"svg":return 1;case"math":return 2;default:return 0}return t===1&&e==="foreignObject"?0:t}function L5(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.children=="bigint"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var U8=null;function eke(){var t=window.event;return t&&t.type==="popstate"?t===U8?!1:(U8=t,!0):(U8=null,!1)}var uue=typeof setTimeout=="function"?setTimeout:void 0,tke=typeof clearTimeout=="function"?clearTimeout:void 0,lZ=typeof Promise=="function"?Promise:void 0,nke=typeof queueMicrotask=="function"?queueMicrotask:typeof lZ<"u"?function(t){return lZ.resolve(null).then(t).catch(ike)}:uue;function ike(t){setTimeout(function(){throw t})}function Gb(t){return t==="head"}function uZ(t,e){var n=e,i=0,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(0<i&&8>i){n=i;var a=t.ownerDocument;if(n&1&&JA(a.documentElement),n&2&&JA(a.body),n&4)for(n=a.head,JA(n),a=n.firstChild;a;){var o=a.nextSibling,c=a.nodeName;a[hN]||c==="SCRIPT"||c==="STYLE"||c==="LINK"&&a.rel.toLowerCase()==="stylesheet"||n.removeChild(a),a=o}}if(r===0){t.removeChild(s),$M(e);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:i=n.charCodeAt(0)-48;else i=0;n=s}while(n);$M(e)}function U5(t){var e=t.firstChild;for(e&&e.nodeType===10&&(e=e.nextSibling);e;){var n=e;switch(e=e.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":U5(n),u$(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}t.removeChild(n)}}function rke(t,e,n,i){for(;t.nodeType===1;){var r=n;if(t.nodeName.toLowerCase()!==e.toLowerCase()){if(!i&&(t.nodeName!=="INPUT"||t.type!=="hidden"))break}else if(i){if(!t[hN])switch(e){case"meta":if(!t.hasAttribute("itemprop"))break;return t;case"link":if(s=t.getAttribute("rel"),s==="stylesheet"&&t.hasAttribute("data-precedence"))break;if(s!==r.rel||t.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||t.getAttribute("title")!==(r.title==null?null:r.title))break;return t;case"style":if(t.hasAttribute("data-precedence"))break;return t;case"script":if(s=t.getAttribute("src"),(s!==(r.src==null?null:r.src)||t.getAttribute("type")!==(r.type==null?null:r.type)||t.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&s&&t.hasAttribute("async")&&!t.hasAttribute("itemprop"))break;return t;default:return t}}else if(e==="input"&&t.type==="hidden"){var s=r.name==null?null:""+r.name;if(r.type==="hidden"&&t.getAttribute("name")===s)return t}else return t;if(t=Jp(t.nextSibling),t===null)break}return null}function ske(t,e,n){if(e==="")return null;for(;t.nodeType!==3;)if((t.nodeType!==1||t.nodeName!=="INPUT"||t.type!=="hidden")&&!n||(t=Jp(t.nextSibling),t===null))return null;return t}function B5(t){return t.data==="$!"||t.data==="$?"&&t.ownerDocument.readyState==="complete"}function ake(t,e){var n=t.ownerDocument;if(t.data!=="$?"||n.readyState==="complete")e();else{var i=function(){e(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),t._reactRetry=i}}function Jp(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?"||e==="F!"||e==="F")break;if(e==="/$")return null}}return t}var F5=null;function hZ(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}function hue(t,e,n){switch(e=o2(n),t){case"html":if(t=e.documentElement,!t)throw Error(jt(452));return t;case"head":if(t=e.head,!t)throw Error(jt(453));return t;case"body":if(t=e.body,!t)throw Error(jt(454));return t;default:throw Error(jt(451))}}function JA(t){for(var e=t.attributes;e.length;)t.removeAttributeNode(e[0]);u$(t)}var ep=new Map,dZ=new Set;function c2(t){return typeof t.getRootNode=="function"?t.getRootNode():t.nodeType===9?t:t.ownerDocument}var dy=gs.d;gs.d={f:oke,r:cke,D:lke,C:uke,L:hke,m:dke,X:pke,S:fke,M:mke};function oke(){var t=dy.f(),e=U3();return t||e}function cke(t){var e=HC(t);e!==null&&e.tag===5&&e.type==="form"?rle(e):dy.r(t)}var GC=typeof document>"u"?null:document;function due(t,e,n){var i=GC;if(i&&typeof e=="string"&&e){var r=Pf(e);r='link[rel="'+t+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),dZ.has(r)||(dZ.add(r),t={rel:t,crossOrigin:n,href:e},i.querySelector(r)===null&&(e=i.createElement("link"),Pl(e,"link",t),al(e),i.head.appendChild(e)))}}function lke(t){dy.D(t),due("dns-prefetch",t,null)}function uke(t,e){dy.C(t,e),due("preconnect",t,e)}function hke(t,e,n){dy.L(t,e,n);var i=GC;if(i&&t&&e){var r='link[rel="preload"][as="'+Pf(e)+'"]';e==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Pf(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Pf(n.imageSizes)+'"]')):r+='[href="'+Pf(t)+'"]';var s=r;switch(e){case"style":s=Qw(t);break;case"script":s=qC(t)}ep.has(s)||(t=Sa({rel:"preload",href:e==="image"&&n&&n.imageSrcSet?void 0:t,as:e},n),ep.set(s,t),i.querySelector(r)!==null||e==="style"&&i.querySelector(EN(s))||e==="script"&&i.querySelector(SN(s))||(e=i.createElement("link"),Pl(e,"link",t),al(e),i.head.appendChild(e)))}}function dke(t,e){dy.m(t,e);var n=GC;if(n&&t){var i=e&&typeof e.as=="string"?e.as:"script",r='link[rel="modulepreload"][as="'+Pf(i)+'"][href="'+Pf(t)+'"]',s=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":s=qC(t)}if(!ep.has(s)&&(t=Sa({rel:"modulepreload",href:t},e),ep.set(s,t),n.querySelector(r)===null)){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(SN(s)))return}i=n.createElement("link"),Pl(i,"link",t),al(i),n.head.appendChild(i)}}}function fke(t,e,n){dy.S(t,e,n);var i=GC;if(i&&t){var r=sw(i).hoistableStyles,s=Qw(t);e=e||"default";var a=r.get(s);if(!a){var o={loading:0,preload:null};if(a=i.querySelector(EN(s)))o.loading=5;else{t=Sa({rel:"stylesheet",href:t,"data-precedence":e},n),(n=ep.get(s))&&W$(t,n);var c=a=i.createElement("link");al(c),Pl(c,"link",t),c._p=new Promise(function(l,u){c.onload=l,c.onerror=u}),c.addEventListener("load",function(){o.loading|=1}),c.addEventListener("error",function(){o.loading|=2}),o.loading|=4,KD(a,e,i)}a={type:"stylesheet",instance:a,count:1,state:o},r.set(s,a)}}}function pke(t,e){dy.X(t,e);var n=GC;if(n&&t){var i=sw(n).hoistableScripts,r=qC(t),s=i.get(r);s||(s=n.querySelector(SN(r)),s||(t=Sa({src:t,async:!0},e),(e=ep.get(r))&&Y$(t,e),s=n.createElement("script"),al(s),Pl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function mke(t,e){dy.M(t,e);var n=GC;if(n&&t){var i=sw(n).hoistableScripts,r=qC(t),s=i.get(r);s||(s=n.querySelector(SN(r)),s||(t=Sa({src:t,async:!0,type:"module"},e),(e=ep.get(r))&&Y$(t,e),s=n.createElement("script"),al(s),Pl(s,"link",t),n.head.appendChild(s)),s={type:"script",instance:s,count:1,state:null},i.set(r,s))}}function fZ(t,e,n,i){var r=(r=J_.current)?c2(r):null;if(!r)throw Error(jt(446));switch(t){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(e=Qw(n.href),n=sw(r).hoistableStyles,i=n.get(e),i||(i={type:"style",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){t=Qw(n.href);var s=sw(r).hoistableStyles,a=s.get(t);if(a||(r=r.ownerDocument||r,a={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},s.set(t,a),(s=r.querySelector(EN(t)))&&!s._p&&(a.instance=s,a.state.loading=5),ep.has(t)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},ep.set(t,n),s||gke(r,t,n,a.state))),e&&i===null)throw Error(jt(528,""));return a}if(e&&i!==null)throw Error(jt(529,""));return null;case"script":return e=n.async,n=n.src,typeof n=="string"&&e&&typeof e!="function"&&typeof e!="symbol"?(e=qC(n),n=sw(r).hoistableScripts,i=n.get(e),i||(i={type:"script",instance:null,count:0,state:null},n.set(e,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(jt(444,t))}}function Qw(t){return'href="'+Pf(t)+'"'}function EN(t){return'link[rel="stylesheet"]['+t+"]"}function fue(t){return Sa({},t,{"data-precedence":t.precedence,precedence:null})}function gke(t,e,n,i){t.querySelector('link[rel="preload"][as="style"]['+e+"]")?i.loading=1:(e=t.createElement("link"),i.preload=e,e.addEventListener("load",function(){return i.loading|=1}),e.addEventListener("error",function(){return i.loading|=2}),Pl(e,"link",n),al(e),t.head.appendChild(e))}function qC(t){return'[src="'+Pf(t)+'"]'}function SN(t){return"script[async]"+t}function pZ(t,e,n){if(e.count++,e.instance===null)switch(e.type){case"style":var i=t.querySelector('style[data-href~="'+Pf(n.href)+'"]');if(i)return e.instance=i,al(i),i;var r=Sa({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return i=(t.ownerDocument||t).createElement("style"),al(i),Pl(i,"style",r),KD(i,n.precedence,t),e.instance=i;case"stylesheet":r=Qw(n.href);var s=t.querySelector(EN(r));if(s)return e.state.loading|=4,e.instance=s,al(s),s;i=fue(n),(r=ep.get(r))&&W$(i,r),s=(t.ownerDocument||t).createElement("link"),al(s);var a=s;return a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Pl(s,"link",i),e.state.loading|=4,KD(s,n.precedence,t),e.instance=s;case"script":return s=qC(n.src),(r=t.querySelector(SN(s)))?(e.instance=r,al(r),r):(i=n,(r=ep.get(s))&&(i=Sa({},n),Y$(i,r)),t=t.ownerDocument||t,r=t.createElement("script"),al(r),Pl(r,"link",i),t.head.appendChild(r),e.instance=r);case"void":return null;default:throw Error(jt(443,e.type))}else e.type==="stylesheet"&&!(e.state.loading&4)&&(i=e.instance,e.state.loading|=4,KD(i,n.precedence,t));return e.instance}function KD(t,e,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,s=r,a=0;a<i.length;a++){var o=i[a];if(o.dataset.precedence===e)s=o;else if(s!==r)break}s?s.parentNode.insertBefore(t,s.nextSibling):(e=n.nodeType===9?n.head:n,e.insertBefore(t,e.firstChild))}function W$(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.title==null&&(t.title=e.title)}function Y$(t,e){t.crossOrigin==null&&(t.crossOrigin=e.crossOrigin),t.referrerPolicy==null&&(t.referrerPolicy=e.referrerPolicy),t.integrity==null&&(t.integrity=e.integrity)}var JD=null;function mZ(t,e,n){if(JD===null){var i=new Map,r=JD=new Map;r.set(n,i)}else r=JD,i=r.get(n),i||(i=new Map,r.set(n,i));if(i.has(t))return i;for(i.set(t,null),n=n.getElementsByTagName(t),r=0;r<n.length;r++){var s=n[r];if(!(s[hN]||s[su]||t==="link"&&s.getAttribute("rel")==="stylesheet")&&s.namespaceURI!=="http://www.w3.org/2000/svg"){var a=s.getAttribute(e)||"";a=t+a;var o=i.get(a);o?o.push(s):i.set(a,[s])}}return i}function gZ(t,e,n){t=t.ownerDocument||t,t.head.insertBefore(n,e==="title"?t.querySelector("head > title"):null)}function vke(t,e,n){if(n===1||e.itemProp!=null)return!1;switch(t){case"meta":case"title":return!0;case"style":if(typeof e.precedence!="string"||typeof e.href!="string"||e.href==="")break;return!0;case"link":if(typeof e.rel!="string"||typeof e.href!="string"||e.href===""||e.onLoad||e.onError)break;switch(e.rel){case"stylesheet":return t=e.disabled,typeof e.precedence=="string"&&t==null;default:return!0}case"script":if(e.async&&typeof e.async!="function"&&typeof e.async!="symbol"&&!e.onLoad&&!e.onError&&e.src&&typeof e.src=="string")return!0}return!1}function pue(t){return!(t.type==="stylesheet"&&!(t.state.loading&3))}var jM=null;function yke(){}function _ke(t,e,n){if(jM===null)throw Error(jt(475));var i=jM;if(e.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&!(e.state.loading&4)){if(e.instance===null){var r=Qw(n.href),s=t.querySelector(EN(r));if(s){t=s._p,t!==null&&typeof t=="object"&&typeof t.then=="function"&&(i.count++,i=l2.bind(i),t.then(i,i)),e.state.loading|=4,e.instance=s,al(s);return}s=t.ownerDocument||t,n=fue(n),(r=ep.get(r))&&W$(n,r),s=s.createElement("link"),al(s);var a=s;a._p=new Promise(function(o,c){a.onload=o,a.onerror=c}),Pl(s,"link",n),e.instance=s}i.stylesheets===null&&(i.stylesheets=new Map),i.stylesheets.set(e,t),(t=e.state.preload)&&!(e.state.loading&3)&&(i.count++,e=l2.bind(i),t.addEventListener("load",e),t.addEventListener("error",e))}}function bke(){if(jM===null)throw Error(jt(475));var t=jM;return t.stylesheets&&t.count===0&&z5(t,t.stylesheets),0<t.count?function(e){var n=setTimeout(function(){if(t.stylesheets&&z5(t,t.stylesheets),t.unsuspend){var i=t.unsuspend;t.unsuspend=null,i()}},6e4);return t.unsuspend=e,function(){t.unsuspend=null,clearTimeout(n)}}:null}function l2(){if(this.count--,this.count===0){if(this.stylesheets)z5(this,this.stylesheets);else if(this.unsuspend){var t=this.unsuspend;this.unsuspend=null,t()}}}var u2=null;function z5(t,e){t.stylesheets=null,t.unsuspend!==null&&(t.count++,u2=new Map,e.forEach(Eke,t),u2=null,l2.call(t))}function Eke(t,e){if(!(e.state.loading&4)){var n=u2.get(t);if(n)var i=n.get(null);else{n=new Map,u2.set(t,n);for(var r=t.querySelectorAll("link[data-precedence],style[data-precedence]"),s=0;s<r.length;s++){var a=r[s];(a.nodeName==="LINK"||a.getAttribute("media")!=="not all")&&(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}r=e.instance,a=r.getAttribute("data-precedence"),s=n.get(a)||i,s===i&&n.set(null,r),n.set(a,r),this.count++,i=l2.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),s?s.parentNode.insertBefore(r,s.nextSibling):(t=t.nodeType===9?t.head:t,t.insertBefore(r,t.firstChild)),e.state.loading|=4}}var VM={$$typeof:Nv,Provider:null,Consumer:null,_currentValue:zS,_currentValue2:zS,_threadCount:0};function Ske(t,e,n,i,r,s,a,o){this.tag=1,this.containerInfo=t,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=s8(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=s8(0),this.hiddenUpdates=s8(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=s,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=o,this.incompleteTransitions=new Map}function mue(t,e,n,i,r,s,a,o,c,l,u,h){return t=new Ske(t,e,n,a,o,c,l,h),e=1,s===!0&&(e|=24),s=Bd(3,null,null,e),t.current=s,s.stateNode=t,e=S$(),e.refCount++,t.pooledCache=e,e.refCount++,s.memoizedState={element:i,isDehydrated:n,cache:e},x$(s),t}function gue(t){return t?(t=H1,t):H1}function vue(t,e,n,i,r,s){r=gue(r),i.context===null?i.context=r:i.pendingContext=r,i=Z_(e),i.payload={element:n},s=s===void 0?null:s,s!==null&&(i.callback=s),n=Q_(t,i,e),n!==null&&(Gd(n,t,e),VA(n,t,e))}function vZ(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function X$(t,e){vZ(t,e),(t=t.alternate)&&vZ(t,e)}function yue(t){if(t.tag===13){var e=jC(t,67108864);e!==null&&Gd(e,t,67108864),X$(t,67108864)}}var h2=!0;function Tke(t,e,n,i){var r=Ui.T;Ui.T=null;var s=gs.p;try{gs.p=2,K$(t,e,n,i)}finally{gs.p=s,Ui.T=r}}function xke(t,e,n,i){var r=Ui.T;Ui.T=null;var s=gs.p;try{gs.p=8,K$(t,e,n,i)}finally{gs.p=s,Ui.T=r}}function K$(t,e,n,i){if(h2){var r=H5(i);if(r===null)L8(t,e,i,d2,n),yZ(t,i);else if(Cke(r,t,e,n,i))i.stopPropagation();else if(yZ(t,i),e&4&&-1<wke.indexOf(t)){for(;r!==null;){var s=HC(r);if(s!==null)switch(s.tag){case 3:if(s=s.stateNode,s.current.memoizedState.isDehydrated){var a=mS(s.pendingLanes);if(a!==0){var o=s;for(o.pendingLanes|=2,o.entangledLanes|=2;a;){var c=1<<31-jd(a);o.entanglements[1]|=c,a&=~c}Kg(s),!(Rs&6)&&(n2=Tg()+500,bN(0))}}break;case 13:o=jC(s,2),o!==null&&Gd(o,s,2),U3(),X$(s,2)}if(s=H5(i),s===null&&L8(t,e,i,d2,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else L8(t,e,i,null,n)}}function H5(t){return t=d$(t),J$(t)}var d2=null;function J$(t){if(d2=null,t=P1(t),t!==null){var e=oN(t);if(e===null)t=null;else{var n=e.tag;if(n===13){if(t=Voe(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null)}}return d2=t,null}function _ue(t){switch(t){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(uNe()){case Woe:return 2;case Yoe:return 8;case zL:case hNe:return 32;case Xoe:return 268435456;default:return 32}default:return 32}}var j5=!1,nb=null,ib=null,rb=null,GM=new Map,qM=new Map,H_=[],wke="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yZ(t,e){switch(t){case"focusin":case"focusout":nb=null;break;case"dragenter":case"dragleave":ib=null;break;case"mouseover":case"mouseout":rb=null;break;case"pointerover":case"pointerout":GM.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":qM.delete(e.pointerId)}}function qR(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=HC(e),e!==null&&yue(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Cke(t,e,n,i,r){switch(e){case"focusin":return nb=qR(nb,t,e,n,i,r),!0;case"dragenter":return ib=qR(ib,t,e,n,i,r),!0;case"mouseover":return rb=qR(rb,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return GM.set(s,qR(GM.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,qM.set(s,qR(qM.get(s)||null,t,e,n,i,r)),!0}return!1}function bue(t){var e=P1(t.target);if(e!==null){var n=oN(e);if(n!==null){if(e=n.tag,e===13){if(e=Voe(n),e!==null){t.blockedOn=e,_Ne(t.priority,function(){if(n.tag===13){var i=Vd();i=c$(i);var r=jC(n,i);r!==null&&Gd(r,n,i),X$(n,i)}});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ZD(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=H5(t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);s5=i,n.target.dispatchEvent(i),s5=null}else return e=HC(n),e!==null&&yue(e),t.blockedOn=n,!1;e.shift()}return!0}function _Z(t,e,n){ZD(t)&&n.delete(e)}function Rke(){j5=!1,nb!==null&&ZD(nb)&&(nb=null),ib!==null&&ZD(ib)&&(ib=null),rb!==null&&ZD(rb)&&(rb=null),GM.forEach(_Z),qM.forEach(_Z)}function jk(t,e){t.blockedOn===e&&(t.blockedOn=null,j5||(j5=!0,Hc.unstable_scheduleCallback(Hc.unstable_NormalPriority,Rke)))}var Vk=null;function bZ(t){Vk!==t&&(Vk=t,Hc.unstable_scheduleCallback(Hc.unstable_NormalPriority,function(){Vk===t&&(Vk=null);for(var e=0;e<t.length;e+=3){var n=t[e],i=t[e+1],r=t[e+2];if(typeof i!="function"){if(J$(i||n)===null)continue;break}var s=HC(n);s!==null&&(t.splice(e,3),e-=3,E5(s,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function $M(t){function e(c){return jk(c,t)}nb!==null&&jk(nb,t),ib!==null&&jk(ib,t),rb!==null&&jk(rb,t),GM.forEach(e),qM.forEach(e);for(var n=0;n<H_.length;n++){var i=H_[n];i.blockedOn===t&&(i.blockedOn=null)}for(;0<H_.length&&(n=H_[0],n.blockedOn===null);)bue(n),n.blockedOn===null&&H_.shift();if(n=(t.ownerDocument||t).$$reactFormReplay,n!=null)for(i=0;i<n.length;i+=3){var r=n[i],s=n[i+1],a=r[Wh]||null;if(typeof s=="function")a||bZ(n);else if(a){var o=null;if(s&&s.hasAttribute("formAction")){if(r=s,a=s[Wh]||null)o=a.formAction;else if(J$(r)!==null)continue}else o=a.action;typeof o=="function"?n[i+1]=o:(n.splice(i,3),i-=3),bZ(n)}}}function Z$(t){this._internalRoot=t}H3.prototype.render=Z$.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(jt(409));var n=e.current,i=Vd();vue(n,i,t,e,null,null)};H3.prototype.unmount=Z$.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;vue(t.current,2,null,t,null,null),U3(),e[zC]=null}};function H3(t){this._internalRoot=t}H3.prototype.unstable_scheduleHydration=function(t){if(t){var e=ece();t={blockedOn:null,target:t,priority:e};for(var n=0;n<H_.length&&e!==0&&e<H_[n].priority;n++);H_.splice(n,0,t),n===0&&bue(t)}};var EZ=Hoe.version;if(EZ!=="19.1.0")throw Error(jt(527,EZ,"19.1.0"));gs.findDOMNode=function(t){var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(jt(188)):(t=Object.keys(t).join(","),Error(jt(268,t)));return t=iNe(e),t=t!==null?Goe(t):null,t=t===null?null:t.stateNode,t};var Ake={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Ui,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gk=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gk.isDisabled&&Gk.supportsFiber)try{cN=Gk.inject(Ake),Hd=Gk}catch{}}w3.createRoot=function(t,e){if(!joe(t))throw Error(jt(299));var n=!1,i="",r=mle,s=gle,a=vle,o=null;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onUncaughtError!==void 0&&(r=e.onUncaughtError),e.onCaughtError!==void 0&&(s=e.onCaughtError),e.onRecoverableError!==void 0&&(a=e.onRecoverableError),e.unstable_transitionCallbacks!==void 0&&(o=e.unstable_transitionCallbacks)),e=mue(t,1,!1,null,null,n,i,r,s,a,o,null),t[zC]=e.current,$$(t),new Z$(e)};w3.hydrateRoot=function(t,e,n){if(!joe(t))throw Error(jt(299));var i=!1,r="",s=mle,a=gle,o=vle,c=null,l=null;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(s=n.onUncaughtError),n.onCaughtError!==void 0&&(a=n.onCaughtError),n.onRecoverableError!==void 0&&(o=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(c=n.unstable_transitionCallbacks),n.formState!==void 0&&(l=n.formState)),e=mue(t,1,!0,e,n??null,i,r,s,a,o,c,l),e.context=gue(null),n=e.current,i=Vd(),i=c$(i),r=Z_(i),r.callback=null,Q_(n,r,i),n=i,e.current.lanes=n,uN(e,n),Kg(e),t[zC]=e.current,$$(t),new H3(e)};w3.version="19.1.0";function Eue(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Eue)}catch(t){console.error(t)}}Eue(),Poe.exports=w3;var Mke=Poe.exports;/*! unmute-ios-audio. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var Oke=Nke;const SZ=["auxclick","click","contextmenu","dblclick","keydown","keyup","mousedown","mouseup","touchend"];function Nke(){const t=window.webkitAudioContext;if(!(navigator.maxTouchPoints>0&&t!=null))return;let n="blocked",i="blocked",r,s,a;const o=new t().sampleRate,c=l(o);SZ.forEach(p=>{window.addEventListener(p,u,{capture:!0,passive:!0})});function l(p){const g=new ArrayBuffer(10),_=new DataView(g);return _.setUint32(0,p,!0),_.setUint32(4,p,!0),_.setUint16(8,1,!0),`data:audio/wav;base64,UklGRisAAABXQVZFZm10IBAAAAABAAEA${window.btoa(String.fromCharCode(...new Uint8Array(g))).slice(0,13)}AgAZGF0YQcAAACAgICAgICAAAA=`}function u(p){n==="blocked"&&(n="pending",h()),i==="blocked"&&(i="pending",d())}function h(){r=document.createElement("audio"),r.setAttribute("x-webkit-airplay","deny"),r.preload="auto",r.loop=!0,r.src=c,r.load(),r.play().then(()=>{n="allowed",f()},()=>{n="blocked",r.pause(),r.removeAttribute("src"),r.load(),r=null})}function d(){s=new t,a=s.createBufferSource(),a.buffer=s.createBuffer(1,1,22050),a.connect(s.destination),a.start(),s.state==="running"?(i="allowed",f()):(i="blocked",a.disconnect(s.destination),a=null,s.close(),s=null)}function f(){n!=="allowed"||i!=="allowed"||SZ.forEach(p=>{window.removeEventListener(p,u,{capture:!0,passive:!0})})}}const Ike=Gc(Oke);var Sue={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Ll,function(){return n.importState=function(r){var s=new n;return s.importState(r),s},n;function n(){return function(r){var s=0,a=0,o=0,c=1;r.length==0&&(r=[+new Date]);var l=i();s=l(" "),a=l(" "),o=l(" ");for(var u=0;u<r.length;u++)s-=l(r[u]),s<0&&(s+=1),a-=l(r[u]),a<0&&(a+=1),o-=l(r[u]),o<0&&(o+=1);l=null;var h=function(){var d=2091639*s+c*23283064365386963e-26;return s=a,a=o,o=d-(c=d|0)};return h.next=h,h.uint32=function(){return h()*4294967296},h.fract53=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.version="Alea 0.9",h.args=r,h.exportState=function(){return[s,a,o,c]},h.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,c=+d[3]||0},h}(Array.prototype.slice.call(arguments))}function i(){var r=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){r+=a.charCodeAt(o);var c=.02519603282416938*r;r=c>>>0,c-=r,c*=r,r=c>>>0,c-=r,r+=c*4294967296}return(r>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(Sue);var kke=Sue.exports;const Q$=Gc(kke);new Rt;new Rt;function Er(t,e,n){return Math.max(e,Math.min(n,t))}function Dke(t,e){return Er(t-Math.floor(t/e)*e,0,e)}function Pke(t,e){var n=Dke(e-t,Math.PI*2);return n>Math.PI&&(n-=Math.PI*2),n}function Tue(t){return t/180*Math.PI}function xue(t){return t*180/Math.PI}const Lke=Q$("089fad0j9awfem09wavefc09uwaef");function TZ(t){return 2*Math.floor(t/2)}function j3(t,e){return Math.round(t/e)*e}function Uke(){return Lke()}function Bke(t){return Q$(t)()}function Uf(t,e){const n=Math.min(t,e),r=Math.max(t,e)-n+1;return n+Math.floor(Uke()*r)}function wue(t,e,n){const i=Math.min(e,n),s=Math.max(e,n)-i+1;return i+Math.floor(Bke(t)*s)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var Fke=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,r){i.__proto__=r}||function(i,r){for(var s in r)r.hasOwnProperty(s)&&(i[s]=r[s])},t(e,n)};return function(e,n){t(e,n);function i(){this.constructor=e}e.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),zke=Object.prototype.hasOwnProperty;function V5(t,e){return zke.call(t,e)}function G5(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var i=[];for(var r in t)V5(t,r)&&i.push(r);return i}function Bh(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function q5(t){for(var e=0,n=t.length,i;e<n;){if(i=t.charCodeAt(e),i>=48&&i<=57){e++;continue}return!1}return!0}function yS(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Cue(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function $5(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if($5(t[e]))return!0}else if(typeof t=="object"){for(var i=G5(t),r=i.length,s=0;s<r;s++)if($5(t[i[s]]))return!0}}return!1}function xZ(t,e){var n=[t];for(var i in e){var r=typeof e[i]=="object"?JSON.stringify(e[i],null,2):e[i];typeof r<"u"&&n.push(i+": "+r)}return n.join(`
`)}var Rue=function(t){Fke(e,t);function e(n,i,r,s,a){var o=this.constructor,c=t.call(this,xZ(n,{name:i,index:r,operation:s,tree:a}))||this;return c.name=i,c.index=r,c.operation=s,c.tree=a,Object.setPrototypeOf(c,o.prototype),c.message=xZ(n,{name:i,index:r,operation:s,tree:a}),c}return e}(Error),mo=Rue,Hke=Bh,q1={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var i=t[e];return delete t[e],{newDocument:n,removed:i}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:function(t,e,n){var i=f2(n,this.path);i&&(i=Bh(i));var r=WS(n,{op:"remove",path:this.from}).removed;return WS(n,{op:"add",path:this.path,value:r}),{newDocument:n,removed:i}},copy:function(t,e,n){var i=f2(n,this.from);return WS(n,{op:"add",path:this.path,value:Bh(i)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:WM(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},jke={add:function(t,e,n){return q5(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var i=t.splice(e,1);return{newDocument:n,removed:i[0]}},replace:function(t,e,n){var i=t[e];return t[e]=this.value,{newDocument:n,removed:i}},move:q1.move,copy:q1.copy,test:q1.test,_get:q1._get};function f2(t,e){if(e=="")return t;var n={op:"_get",path:e};return WS(t,n),n.value}function WS(t,e,n,i,r,s){if(n===void 0&&(n=!1),i===void 0&&(i=!0),r===void 0&&(r=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):p2(e,0)),e.path===""){var a={newDocument:t};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=t,a;if(e.op==="move"||e.op==="copy")return a.newDocument=f2(t,e.from),e.op==="move"&&(a.removed=t),a;if(e.op==="test"){if(a.test=WM(t,e.value),a.test===!1)throw new mo("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a.newDocument=t,a}else{if(e.op==="remove")return a.removed=t,a.newDocument=null,a;if(e.op==="_get")return e.value=t,a;if(n)throw new mo("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return a}}else{i||(t=Bh(t));var o=e.path||"",c=o.split("/"),l=t,u=1,h=c.length,d=void 0,f=void 0,p=void 0;for(typeof n=="function"?p=n:p=p2;;){if(f=c[u],f&&f.indexOf("~")!=-1&&(f=Cue(f)),r&&(f=="__proto__"||f=="prototype"&&u>0&&c[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(l[f]===void 0?d=c.slice(0,u).join("/"):u==h-1&&(d=e.path),d!==void 0&&p(e,0,t,d)),u++,Array.isArray(l)){if(f==="-")f=l.length;else{if(n&&!q5(f))throw new mo("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);q5(f)&&(f=~~f)}if(u>=h){if(n&&e.op==="add"&&f>l.length)throw new mo("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var a=jke[e.op].call(e,l,f,t);if(a.test===!1)throw new mo("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}}else if(u>=h){var a=q1[e.op].call(e,l,f,t);if(a.test===!1)throw new mo("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return a}if(l=l[f],n&&u<h&&(!l||typeof l!="object"))throw new mo("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,t)}}}function V3(t,e,n,i,r){if(i===void 0&&(i=!0),r===void 0&&(r=!0),n&&!Array.isArray(e))throw new mo("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(t=Bh(t));for(var s=new Array(e.length),a=0,o=e.length;a<o;a++)s[a]=WS(t,e[a],n,!0,r,a),t=s[a].newDocument;return s.newDocument=t,s}function Vke(t,e,n){var i=WS(t,e);if(i.test===!1)throw new mo("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return i.newDocument}function p2(t,e,n,i){if(typeof t!="object"||t===null||Array.isArray(t))throw new mo("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(q1[t.op]){if(typeof t.path!="string")throw new mo("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new mo('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new mo("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new mo("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&$5(t.value))throw new mo("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var r=t.path.split("/").length,s=i.split("/").length;if(r!==s+1&&r!==s)throw new mo("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==i)throw new mo("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var a={op:"_get",path:t.from,value:void 0},o=e7([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new mo("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new mo("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function e7(t,e,n){try{if(!Array.isArray(t))throw new mo("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)V3(Bh(e),Bh(t),n||!0);else{n=n||p2;for(var i=0;i<t.length;i++)n(t[i],i,e,void 0)}}catch(r){if(r instanceof mo)return r;throw r}}function WM(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),i=Array.isArray(e),r,s,a;if(n&&i){if(s=t.length,s!=e.length)return!1;for(r=s;r--!==0;)if(!WM(t[r],e[r]))return!1;return!0}if(n!=i)return!1;var o=Object.keys(t);if(s=o.length,s!==Object.keys(e).length)return!1;for(r=s;r--!==0;)if(!e.hasOwnProperty(o[r]))return!1;for(r=s;r--!==0;)if(a=o[r],!WM(t[a],e[a]))return!1;return!0}return t!==t&&e!==e}const Gke=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:mo,_areEquals:WM,applyOperation:WS,applyPatch:V3,applyReducer:Vke,deepClone:Hke,getValueByPointer:f2,validate:e7,validator:p2},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var t7=new WeakMap,qke=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),$ke=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function Wke(t){return t7.get(t)}function Yke(t,e){return t.observers.get(e)}function Xke(t,e){t.observers.delete(e.callback)}function Kke(t,e){e.unobserve()}function Jke(t,e){var n=[],i,r=Wke(t);if(!r)r=new qke(t),t7.set(t,r);else{var s=Yke(r,e);i=s&&s.observer}if(i)return i;if(i={},r.value=Bh(t),e){i.callback=e,i.next=null;var a=function(){W5(i)},o=function(){clearTimeout(i.next),i.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return i.patches=n,i.object=t,i.unobserve=function(){W5(i),clearTimeout(i.next),Xke(r,i),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},r.observers.set(e,new $ke(e,i)),i}function W5(t,e){e===void 0&&(e=!1);var n=t7.get(t.object);n7(n.value,t.object,t.patches,"",e),t.patches.length&&V3(n.value,t.patches);var i=t.patches;return i.length>0&&(t.patches=[],t.callback&&t.callback(i)),i}function n7(t,e,n,i,r){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=G5(e),a=G5(t),o=!1,c=a.length-1;c>=0;c--){var l=a[c],u=t[l];if(V5(e,l)&&!(e[l]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var h=e[l];typeof u=="object"&&u!=null&&typeof h=="object"&&h!=null&&Array.isArray(u)===Array.isArray(h)?n7(u,h,n,i+"/"+yS(l),r):u!==h&&(r&&n.push({op:"test",path:i+"/"+yS(l),value:Bh(u)}),n.push({op:"replace",path:i+"/"+yS(l),value:Bh(h)}))}else Array.isArray(t)===Array.isArray(e)?(r&&n.push({op:"test",path:i+"/"+yS(l),value:Bh(u)}),n.push({op:"remove",path:i+"/"+yS(l)}),o=!0):(r&&n.push({op:"test",path:i,value:t}),n.push({op:"replace",path:i,value:e}))}if(!(!o&&s.length==a.length))for(var c=0;c<s.length;c++){var l=s[c];!V5(t,l)&&e[l]!==void 0&&n.push({op:"add",path:i+"/"+yS(l),value:Bh(e[l])})}}}function Zke(t,e,n){n===void 0&&(n=!1);var i=[];return n7(t,e,i,"",n),i}const Qke=Object.freeze(Object.defineProperty({__proto__:null,compare:Zke,generate:W5,observe:Jke,unobserve:Kke},Symbol.toStringTag,{value:"Module"}));Object.assign({},Gke,Qke,{JsonPatchError:Rue,deepClone:Bh,escapePathComponent:yS,unescapePathComponent:Cue});var eDe=typeof Element<"u",tDe=typeof Map=="function",nDe=typeof Set=="function",iDe=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function QD(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,i,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(!QD(t[i],e[i]))return!1;return!0}var s;if(tDe&&t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;for(s=t.entries();!(i=s.next()).done;)if(!QD(i.value[1],e.get(i.value[0])))return!1;return!0}if(nDe&&t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(s=t.entries();!(i=s.next()).done;)if(!e.has(i.value[0]))return!1;return!0}if(iDe&&ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(i=n;i--!==0;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&typeof t.valueOf=="function"&&typeof e.valueOf=="function")return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&typeof t.toString=="function"&&typeof e.toString=="function")return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;if(eDe&&t instanceof Element)return!1;for(i=n;i--!==0;)if(!((r[i]==="_owner"||r[i]==="__v"||r[i]==="__o")&&t.$$typeof)&&!QD(t[r[i]],e[r[i]]))return!1;return!0}return t!==t&&e!==e}var rDe=function(e,n){try{return QD(e,n)}catch(i){if((i.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw i}};const $1=Gc(rDe);function ae(t){return t!=null}const sDe=Object.fromEntries,G3=Object.keys;function ol(t){return Bh(t)}function aDe(t){return typeof t=="boolean"}function pn(t){return typeof t=="number"&&isNaN(t)===!1}function On(t){return typeof t=="string"}function Li(t){return Array.isArray(t)}function Vu(t){return t}function oDe(t){return typeof t=="object"&&On(t.session)&&On(t.player)&&On(t.id)&&On(t.sender)&&On(t.target)}function Hi(t,e,n,...i){return t.emit(e,"error",[`$red${n}$blue>>`,...i]),!1}function Ug(t,e,...n){return t.emit(e,"info",n),!0}function cDe(t,e,...n){return t.emit(e,"debug",n),!0}function lDe(t,e,n){t.emit(e,"toast",n)}function uDe(t,e,n){t.emit(e,"bridge:streamstart",n)}function hDe(t,e){t.emit(e,"bridge:streamstop",void 0)}function dDe(t,e,n){t.emit(e,"bridge:chatstart",n)}function fDe(t,e){t.emit(e,"bridge:chatstop")}function pDe(t,e,n,i,r,s,a){t.emit(e,"bridge:fetch",[n,i,r,s,a])}function mDe(t,e){t.emit(e,"bridge:talkstart",e)}function gDe(t,e){t.emit(e,"bridge:talkstop",e)}function vDe(t,e){t.emit(e,"bridge:mediastart",e)}function yDe(t,e){t.emit(e,"bridge:mediastop",e)}function _De(t,e,n){t.emit(e,"bridge:join",n)}function bDe(t,e,n){t.emit(e,"bridge:start",n)}function EDe(t,e,n){t.emit(e,"bridge:tab",n)}function SDe(t,e,n){t.emit(e,"bridge:tabopen",n)}function TDe(t,e,n,i){t.emit(e,"bridge:showjoincode",[n,i])}function xDe(t,e){t.emit(e,"gadgetserver:desync")}function wDe(t,e){t.emit(e,"gadgetserver:clearscroll")}function wZ(t,e,n,i){t.emit(e,"register:downloadjsonfile",[n,i])}function CDe(t,e){t.emit(e,"register:dev",void 0)}function RDe(t,e){t.emit(e,"register:share",void 0)}function ADe(t,e){t.emit(e,"register:nuke",void 0)}function MDe(t,e){t.emit(e,"synth:audioenabled",void 0)}function ODe(t,e,n,i){t.emit(e,"synth:tts",[n,i])}function NDe(t,e,n){t.emit(e,"synth:tta",[n])}function b_(t,e,n,i,r){t.emit(e,"synth:play",[n,i,r])}function IDe(t,e,n){t.emit(e,"synth:bpm",n)}function kDe(t,e,n){t.emit(e,"synth:playvolume",n)}function DDe(t,e,n){t.emit(e,"synth:bgplayvolume",n)}function PDe(t,e,n){t.emit(e,"synth:ttsvolume",n)}function B8(t,e,n,i,r){t.emit(e,"synth:voice",[n,i,r])}function Aue(t,e,n,i,r,s){t.emit(e,"synth:voicefx",[n,i,r,s])}function LDe(t,e){t.emit(e,"register:inspector")}function UDe(t,e){t.emit(e,"register:terminal:open")}function BDe(t,e){t.emit(e,"register:terminal:quickopen")}function m2(t,e){t.emit(e,"register:terminal:close")}function FDe(t,e){t.emit(e,"register:terminal:toggle")}function Mue(t,e,n){t.emit(e,"register:terminal:inclayout",n)}function i7(t,e){t.emit(e,"register:terminal:full")}function zDe(t,e,n,i,r,s,a){t.emit(e,"register:editor:open",[n,i,r,s,a])}function HDe(t,e){t.emit(e,"register:editor:close")}function jDe(t,e){t.emit(e,"vm:operator")}function VDe(t,e){t.emit(e,"vm:zsswords")}function GDe(t,e,n){t.emit(e,"vm:halt",n)}function qDe(t,e,n,i){t.emit(e,"vm:books",[n,i])}function $De(t,e){t.emit(e,"vm:search")}function WDe(t,e){t.emit(e,"vm:login")}function YDe(t,e){t.emit(e,"vm:logout")}function XDe(t,e){t.emit(e,"vm:doot")}function KDe(t,e,n,i){t.emit(e,"vm:input",[n,i])}function JDe(t,e,n){t.emit(e,"vm:copyjsonfile",n)}function ZDe(t,e,n){t.emit(e,"vm:refsheet",n)}function QDe(t,e,n,i){t.emit(e,"vm:inspect",[n,i])}function Oue(t,e){const[n,i]=e;return`${t}:${[n,i].filter(ae).join(":")}`}function ePe(t,e,n,i){t.emit(e,"vm:codewatch",[n,i])}function tPe(t,e,n,i){t.emit(e,"vm:coderelease",[n,i])}function Lv(t,e,n){t.emit(e,"vm:cli",n)}function nPe(t,e){t.emit(e,"vm:restart")}function iPe(t,e,n){t.emit(e,"vm:synthsend",n)}function rPe(t,e){t.emit(e,"vm:flush")}function sPe(t,e){t.emit(e,"vm:fork")}function aPe(t,e){return{filename:t,cursor:0,lines:e.split(`
`)}}function oPe(t,e){return{filename:t,json:e}}function cPe(t,e){return{filename:t,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function wg(t,e,n,i,r,s){let a;switch(i){case"file":a=s;break;case"text":a=aPe(r,s);break;case"json":a=oPe(r,s);break;case"binary":a=cPe(r,s);break}setTimeout(()=>{t.emit(e,"vm:loader",[n,i,r,a])},1)}function r7(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function lPe(t,e){const n=indexedDB.open(t);n.onupgradeneeded=()=>n.result.createObjectStore(e);const i=r7(n);return(r,s)=>i.then(a=>s(a.transaction(e,r).objectStore(e)))}let F8;function Nue(){return F8||(F8=lPe("keyval-store","keyval")),F8}function uPe(t,e=Nue()){return e("readonly",n=>r7(n.get(t)))}function hPe(t,e,n=Nue()){return n("readwrite",i=>new Promise((r,s)=>{i.get(t).onsuccess=function(){try{i.put(e(this.result),t),r(r7(i.transaction))}catch(a){s(a)}}}))}const z8=new Set,YM={emit(t,e,n,i,r){YM.invoke(MPe(t,e,n,i,r))},invoke(t){z8.forEach(e=>e.handle(t))},connect(t){z8.add(t)},disconnect(t){z8.delete(t)}};var Iue={};(function(t){var e=Ll&&Ll.__spreadArray||function(l,u,h){if(h||arguments.length===2)for(var d=0,f=u.length,p;d<f;d++)(p||!(d in u))&&(p||(p=Array.prototype.slice.call(u,0,d)),p[d]=u[d]);return l.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(t,"__esModule",{value:!0}),t.minLength=t.maxLength=t.poolSize=t.humanId=t.adverbs=t.verbs=t.nouns=t.adjectives=void 0,t.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],t.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],t.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],t.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function n(l){return l[Math.floor(Math.random()*l.length)]}function i(l){return l.reduce(function(u,h){return u.length>h.length?u:h})}function r(l){return l.reduce(function(u,h){return u.length<h.length?u:h})}function s(l){l===void 0&&(l={}),typeof l=="string"&&(l={separator:l}),typeof l=="boolean"&&(l={capitalize:l});var u=l.separator,h=u===void 0?"":u,d=l.capitalize,f=d===void 0?!0:d,p=l.adjectiveCount,g=p===void 0?1:p,_=l.addAdverb,v=_===void 0?!1:_,E=e(e(e([],e([],Array(g),!0).map(function(T){return n(t.adjectives)}),!0),[n(t.nouns),n(t.verbs)],!1),v?[n(t.adverbs)]:[],!0);return f&&(E=E.map(function(T){return T.charAt(0).toUpperCase()+T.substr(1)})),E.join(h)}t.humanId=s;function a(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d;return t.adjectives.length*h*t.nouns.length*t.verbs.length*(f?t.adverbs.length:1)}t.poolSize=a;function o(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d,p=l.separator,g=p===void 0?"":p;return i(t.adjectives).length*h+h*g.length+i(t.nouns).length+g.length+i(t.verbs).length+(f?i(t.adverbs).length+g.length:0)}t.maxLength=o;function c(l){l===void 0&&(l={});var u=l.adjectiveCount,h=u===void 0?1:u,d=l.addAdverb,f=d===void 0?!1:d,p=l.separator,g=p===void 0?"":p;return r(t.adjectives).length*h+h*g.length+r(t.nouns).length+g.length+r(t.verbs).length+(f?r(t.adverbs).length+g.length:0)}t.minLength=c,t.default=s})(Iue);const kue=Gc(Iue),dPe="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let fPe=t=>crypto.getRandomValues(new Uint8Array(t)),pPe=(t,e,n)=>{let i=(2<<Math.log2(t.length-1))-1,r=-~(1.6*i*e/t.length);return(s=e)=>{let a="";for(;;){let o=n(r),c=r;for(;c--;)if(a+=t[o[c]&i]||"",a.length===s)return a}}},Due=(t,e=21)=>pPe(t,e,fPe),mPe=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=dPe[n[t]&63];return e};var Pue="abcdefghijklmnopqrstuvwxyz",Lue="ABCDEFGHIJKLMNOPQRSTUVWXYZ",Uue="0123456789",gPe="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz",vPe="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz";const yPe=Uue,_Pe=Pue,bPe=Lue;var EPe=yPe+_Pe+bPe,Y5={lowercase:Pue,uppercase:Lue,numbers:Uue,nolookalikes:gPe,nolookalikesSafe:vPe,alphanumeric:EPe};function Do(){return`sid_${mPe(12).replaceAll("-",".")}`}const SPe=Due(Y5.numbers,4),TPe=Due(`${Y5.numbers}${Y5.lowercase}`,16);function xPe(){return`pid_${SPe()}_${TPe()}`}function sb(t){return(t==null?void 0:t.startsWith("pid_"))??!1}function wPe(){return kue({capitalize:!1,adjectiveCount:1})}function CPe(){return kue({addAdverb:!1,capitalize:!1,adjectiveCount:0})}const RPe=20,CZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function APe(t){const e=Q$(t),n=[];for(let i=0;i<RPe;++i)n.push(CZ[Math.floor(e()*CZ.length)]);return n.join("")}var Qt=(t=>(t[t.BLACK=0]="BLACK",t[t.DKBLUE=1]="DKBLUE",t[t.DKGREEN=2]="DKGREEN",t[t.DKCYAN=3]="DKCYAN",t[t.DKRED=4]="DKRED",t[t.DKPURPLE=5]="DKPURPLE",t[t.DKYELLOW=6]="DKYELLOW",t[t.LTGRAY=7]="LTGRAY",t[t.DKGRAY=8]="DKGRAY",t[t.BLUE=9]="BLUE",t[t.GREEN=10]="GREEN",t[t.CYAN=11]="CYAN",t[t.RED=12]="RED",t[t.PURPLE=13]="PURPLE",t[t.YELLOW=14]="YELLOW",t[t.WHITE=15]="WHITE",t[t.ONBLACK=16]="ONBLACK",t[t.ONDKBLUE=17]="ONDKBLUE",t[t.ONDKGREEN=18]="ONDKGREEN",t[t.ONDKCYAN=19]="ONDKCYAN",t[t.ONDKRED=20]="ONDKRED",t[t.ONDKPURPLE=21]="ONDKPURPLE",t[t.ONDKYELLOW=22]="ONDKYELLOW",t[t.ONLTGRAY=23]="ONLTGRAY",t[t.ONDKGRAY=24]="ONDKGRAY",t[t.ONBLUE=25]="ONBLUE",t[t.ONGREEN=26]="ONGREEN",t[t.ONCYAN=27]="ONCYAN",t[t.ONRED=28]="ONRED",t[t.ONPURPLE=29]="ONPURPLE",t[t.ONYELLOW=30]="ONYELLOW",t[t.ONWHITE=31]="ONWHITE",t[t.ONCLEAR=32]="ONCLEAR",t))(Qt||{}),bs=(t=>(t[t.ISWALK=0]="ISWALK",t[t.ISSOLID=1]="ISSOLID",t[t.ISSWIM=2]="ISSWIM",t[t.ISBULLET=3]="ISBULLET",t))(bs||{}),uT=(t=>(t[t.ISTERRAIN=0]="ISTERRAIN",t[t.ISOBJECT=1]="ISOBJECT",t))(uT||{}),rn=(t=>(t[t.IDLE=0]="IDLE",t[t.NORTH=1]="NORTH",t[t.SOUTH=2]="SOUTH",t[t.WEST=3]="WEST",t[t.EAST=4]="EAST",t[t.BY=5]="BY",t[t.AT=6]="AT",t[t.FLOW=7]="FLOW",t[t.SEEK=8]="SEEK",t[t.RNDNS=9]="RNDNS",t[t.RNDNE=10]="RNDNE",t[t.RND=11]="RND",t[t.CW=12]="CW",t[t.CCW=13]="CCW",t[t.OPP=14]="OPP",t[t.RNDP=15]="RNDP",t[t.AWAY=16]="AWAY",t[t.TOWARD=17]="TOWARD",t[t.PLAYER=18]="PLAYER",t[t.FIND=19]="FIND",t[t.FLEE=20]="FLEE",t[t.TO=21]="TO",t))(rn||{}),cn=(t=>(t[t.LOADER=0]="LOADER",t[t.BOARD=1]="BOARD",t[t.OBJECT=2]="OBJECT",t[t.TERRAIN=3]="TERRAIN",t[t.CHARSET=4]="CHARSET",t[t.PALETTE=5]="PALETTE",t[t.CONST=6]="CONST",t[t.RANGE=7]="RANGE",t[t.SELECT=8]="SELECT",t[t.NUMBER=9]="NUMBER",t[t.TEXT=10]="TEXT",t[t.LINK=11]="LINK",t[t.HOTKEY=12]="HOTKEY",t[t.COPYIT=13]="COPYIT",t[t.OPENIT=14]="OPENIT",t[t.ZSSEDIT=15]="ZSSEDIT",t[t.CHAREDIT=16]="CHAREDIT",t[t.COLOREDIT=17]="COLOREDIT",t))(cn||{});function ai(t){return(t==null?void 0:t.toLowerCase().trim())??""}function MPe(t,e,n,i,r){return{session:t,player:e,id:Do(),sender:n,target:i,data:r}}function jT(t){const[e,...n]=t.split(":");return{target:e,path:n.join(":")}}function qb(t,e=[],n=Vu,i=""){const r=Do(),s=ai(t),a=e.map(ai);let o=i;const c={id(){return r},name(){return t},session(l){return ae(l)?l.session===o?l.session:"":o},topics(){return e},emit(l,u,h){YM.emit(o,l,r,u,h)},reply(l,u,h){c.emit(l.player,`${l.sender}:${u}`,h)},replynext(l,u,h){setTimeout(()=>c.emit(l.player,`${l.sender}:${u}`,h),64)},handle(l){const{target:u,path:h}=jT(l.target),d=ai(u);!o&&d==="ready"&&(o=l.session),d==="bridge"&&ae(l.session)&&(o=l.session),a.findIndex(f=>f==="all"||f===d)!==-1&&n(l),(r===u||d==="all"||s===d)&&n({...l,target:h})}};return YM.connect(c),c}var wS=(t=>(t[t.Border=-1]="Border",t[t.Data=0]="Data",t[t.Function=1]="Function",t[t.Position=2]="Position",t[t.Timing=3]="Timing",t[t.Alignment=4]="Alignment",t))(wS||{}),OPe=Object.defineProperty,NPe=(t,e,n)=>e in t?OPe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qk=(t,e,n)=>(NPe(t,typeof e!="symbol"?e+"":e,n),n);const IPe=[0,1],Bue=[1,0],Fue=[2,3],zue=[3,2],kPe={L:IPe,M:Bue,Q:Fue,H:zue},DPe=/^[0-9]*$/,PPe=/^[A-Z0-9 $%*+.\/:-]*$/,H8="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",s7=1,a7=40,RZ=3,LPe=3,$k=40,UPe=10,Hue=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],jue=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class BPe{constructor(e,n,i,r){if(this.version=e,this.ecc=n,qk(this,"size"),qk(this,"mask"),qk(this,"modules",[]),qk(this,"types",[]),e<s7||e>a7)throw new RangeError("Version value out of range");if(r<-1||r>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(i);if(this.drawCodewords(a),r===-1){let o=1e9;for(let c=0;c<8;c++){this.applyMask(c),this.drawFormatBits(c);const l=this.getPenaltyScore();l<o&&(r=c,o=l),this.applyMask(c)}}this.mask=r,this.applyMask(r),this.drawFormatBits(r)}getModule(e,n){return e>=0&&e<this.size&&n>=0&&n<this.size&&this.modules[n][e]}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2===0,wS.Timing),this.setFunctionModule(i,6,i%2===0,wS.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),n=e.length;for(let i=0;i<n;i++)for(let r=0;r<n;r++)i===0&&r===0||i===0&&r===n-1||i===n-1&&r===0||this.drawAlignmentPattern(e[i],e[r]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const n=this.ecc[1]<<3|e;let i=n;for(let s=0;s<10;s++)i=i<<1^(i>>>9)*1335;const r=(n<<10|i)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,hv(r,s));this.setFunctionModule(8,7,hv(r,6)),this.setFunctionModule(8,8,hv(r,7)),this.setFunctionModule(7,8,hv(r,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,hv(r,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,hv(r,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,hv(r,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let i=0;i<12;i++)e=e<<1^(e>>>11)*7973;const n=this.version<<12|e;for(let i=0;i<18;i++){const r=hv(n,i),s=this.size-11+i%3,a=Math.floor(i/3);this.setFunctionModule(s,a,r),this.setFunctionModule(a,s,r)}}drawFinderPattern(e,n){for(let i=-4;i<=4;i++)for(let r=-4;r<=4;r++){const s=Math.max(Math.abs(r),Math.abs(i)),a=e+r,o=n+i;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,s!==2&&s!==4,wS.Position)}}drawAlignmentPattern(e,n){for(let i=-2;i<=2;i++)for(let r=-2;r<=2;r++)this.setFunctionModule(e+r,n+i,Math.max(Math.abs(r),Math.abs(i))!==1,wS.Alignment)}setFunctionModule(e,n,i,r=wS.Function){this.modules[n][e]=i,this.types[n][e]=r}addEccAndInterleave(e){const n=this.version,i=this.ecc;if(e.length!==eP(n,i))throw new RangeError("Invalid argument");const r=jue[i[0]][n],s=Hue[i[0]][n],a=Math.floor(X5(n)/8),o=r-a%r,c=Math.floor(a/r),l=[],u=WPe(s);for(let d=0,f=0;d<r;d++){const p=e.slice(f,f+c-s+(d<o?0:1));f+=p.length;const g=YPe(p,u);d<o&&p.push(0),l.push(p.concat(g))}const h=[];for(let d=0;d<l[0].length;d++)l.forEach((f,p)=>{(d!==c-s||p>=o)&&h.push(f[d])});return h}drawCodewords(e){if(e.length!==Math.floor(X5(this.version)/8))throw new RangeError("Invalid argument");let n=0;for(let i=this.size-1;i>=1;i-=2){i===6&&(i=5);for(let r=0;r<this.size;r++)for(let s=0;s<2;s++){const a=i-s,c=(i+1&2)===0?this.size-1-r:r;!this.types[c][a]&&n<e.length*8&&(this.modules[c][a]=hv(e[n>>>3],7-(n&7)),n++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let n=0;n<this.size;n++)for(let i=0;i<this.size;i++){let r;switch(e){case 0:r=(i+n)%2===0;break;case 1:r=n%2===0;break;case 2:r=i%3===0;break;case 3:r=(i+n)%3===0;break;case 4:r=(Math.floor(i/3)+Math.floor(n/2))%2===0;break;case 5:r=i*n%2+i*n%3===0;break;case 6:r=(i*n%2+i*n%3)%2===0;break;case 7:r=((i+n)%2+i*n%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[n][i]&&r&&(this.modules[n][i]=!this.modules[n][i])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[s][l]===a?(o++,o===5?e+=RZ:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*$k),a=this.modules[s][l],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*$k}for(let s=0;s<this.size;s++){let a=!1,o=0;const c=[0,0,0,0,0,0,0];for(let l=0;l<this.size;l++)this.modules[l][s]===a?(o++,o===5?e+=RZ:o>5&&e++):(this.finderPenaltyAddHistory(o,c),a||(e+=this.finderPenaltyCountPatterns(c)*$k),a=this.modules[l][s],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,c)*$k}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){const o=this.modules[s][a];o===this.modules[s][a+1]&&o===this.modules[s+1][a]&&o===this.modules[s+1][a+1]&&(e+=LPe)}let n=0;for(const s of this.modules)n=s.reduce((a,o)=>a+(o?1:0),n);const i=this.size*this.size,r=Math.ceil(Math.abs(n*20-i*10)/i)-1;return e+=r*UPe,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,n=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,i=[6];for(let r=this.size-7;i.length<e;r-=n)i.splice(1,0,r);return i}}finderPenaltyCountPatterns(e){const n=e[1],i=n>0&&e[2]===n&&e[3]===n*3&&e[4]===n&&e[5]===n;return(i&&e[0]>=n*4&&e[6]>=n?1:0)+(i&&e[6]>=n*4&&e[0]>=n?1:0)}finderPenaltyTerminateAndCount(e,n,i){return e&&(this.finderPenaltyAddHistory(n,i),n=0),n+=this.size,this.finderPenaltyAddHistory(n,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(e,n){n[0]===0&&(e+=this.size),n.pop(),n.unshift(e)}}function Cv(t,e,n){if(e<0||e>31||t>>>e)throw new RangeError("Value out of range");for(let i=e-1;i>=0;i--)n.push(t>>>i&1)}function hv(t,e){return(t>>>e&1)!==0}class o7{constructor(e,n,i){if(this.mode=e,this.numChars=n,this.bitData=i,n<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}getData(){return this.bitData.slice()}}const FPe=[1,10,12,14],zPe=[2,9,11,13],HPe=[4,8,16,16];function Vue(t,e){return t[Math.floor((e+7)/17)+1]}function Gue(t){const e=[];for(const n of t)Cv(n,8,e);return new o7(HPe,t.length,e)}function jPe(t){if(!que(t))throw new RangeError("String contains non-numeric characters");const e=[];for(let n=0;n<t.length;){const i=Math.min(t.length-n,3);Cv(Number.parseInt(t.substring(n,n+i),10),i*3+1,e),n+=i}return new o7(FPe,t.length,e)}function VPe(t){if(!$ue(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let n;for(n=0;n+2<=t.length;n+=2){let i=H8.indexOf(t.charAt(n))*45;i+=H8.indexOf(t.charAt(n+1)),Cv(i,11,e)}return n<t.length&&Cv(H8.indexOf(t.charAt(n)),6,e),new o7(zPe,t.length,e)}function GPe(t){return t===""?[]:que(t)?[jPe(t)]:$ue(t)?[VPe(t)]:[Gue($Pe(t))]}function que(t){return DPe.test(t)}function $ue(t){return PPe.test(t)}function qPe(t,e){let n=0;for(const i of t){const r=Vue(i.mode,e);if(i.numChars>=1<<r)return Number.POSITIVE_INFINITY;n+=4+r+i.bitData.length}return n}function $Pe(t){t=encodeURI(t);const e=[];for(let n=0;n<t.length;n++)t.charAt(n)!=="%"?e.push(t.charCodeAt(n)):(e.push(Number.parseInt(t.substring(n+1,n+3),16)),n+=2);return e}function X5(t){if(t<s7||t>a7)throw new RangeError("Version number out of range");let e=(16*t+128)*t+64;if(t>=2){const n=Math.floor(t/7)+2;e-=(25*n-10)*n-55,t>=7&&(e-=36)}return e}function eP(t,e){return Math.floor(X5(t)/8)-Hue[e[0]][t]*jue[e[0]][t]}function WPe(t){if(t<1||t>255)throw new RangeError("Degree out of range");const e=[];for(let i=0;i<t-1;i++)e.push(0);e.push(1);let n=1;for(let i=0;i<t;i++){for(let r=0;r<e.length;r++)e[r]=K5(e[r],n),r+1<e.length&&(e[r]^=e[r+1]);n=K5(n,2)}return e}function YPe(t,e){const n=e.map(i=>0);for(const i of t){const r=i^n.shift();n.push(0),e.forEach((s,a)=>n[a]^=K5(s,r))}return n}function K5(t,e){if(t>>>8||e>>>8)throw new RangeError("Byte out of range");let n=0;for(let i=7;i>=0;i--)n=n<<1^(n>>>7)*285,n^=(e>>>i&1)*t;return n}function XPe(t,e,n=1,i=40,r=-1,s=!0){if(!(s7<=n&&n<=i&&i<=a7)||r<-1||r>7)throw new RangeError("Invalid value");let a,o;for(a=n;;a++){const h=eP(a,e)*8,d=qPe(t,a);if(d<=h){o=d;break}if(a>=i)throw new RangeError("Data too long")}for(const h of[Bue,Fue,zue])s&&o<=eP(a,h)*8&&(e=h);const c=[];for(const h of t){Cv(h.mode[0],4,c),Cv(h.numChars,Vue(h.mode,a),c);for(const d of h.getData())c.push(d)}const l=eP(a,e)*8;Cv(0,Math.min(4,l-c.length),c),Cv(0,(8-c.length%8)%8,c);for(let h=236;c.length<l;h^=253)Cv(h,8,c);const u=Array.from({length:Math.ceil(c.length/8)},()=>0);return c.forEach((h,d)=>u[d>>>3]|=h<<7-(d&7)),new BPe(a,e,u,r)}function KPe(t,e){var h;const{ecc:n="L",boostEcc:i=!1,minVersion:r=1,maxVersion:s=40,maskPattern:a=-1,border:o=1}=e||{},c=typeof t=="string"?GPe(t):Array.isArray(t)?[Gue(t)]:void 0;if(!c)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof t}`);const l=XPe(c,kPe[n],r,s,a,i),u=JPe({version:l.version,maskPattern:l.mask,size:l.size,data:l.modules,types:l.types},o);return e!=null&&e.invert&&(u.data=u.data.map(d=>d.map(f=>!f))),(h=e==null?void 0:e.onEncoded)==null||h.call(e,u),u}function JPe(t,e=1){if(!e)return t;const{size:n}=t,i=n+e*2;t.size=i,t.data.forEach(s=>{for(let a=0;a<e;a++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)t.data.unshift(Array.from({length:i},a=>!1)),t.data.push(Array.from({length:i},a=>!1));const r=wS.Border;t.types.forEach(s=>{for(let a=0;a<e;a++)s.unshift(r),s.push(r)});for(let s=0;s<e;s++)t.types.unshift(Array.from({length:i},a=>r)),t.types.push(Array.from({length:i},a=>r));return t}function ZPe(t,e,n,i=!1){return e<0||n<0||e>=t.length||n>=t.length?i:t[n][e]}function QPe(t,e={}){const n={WHITE_ALL:"",WHITE_BLACK:"",BLACK_WHITE:"",BLACK_ALL:" "},i=KPe(t,e),r=!1,s=!0,a=(l,u)=>ZPe(i.data,l,u,!0),o=[];let c="";for(let l=0;l<i.size;l+=2){for(let u=0;u<i.size;u++)a(u,l)===r&&a(u,l+1)===r?c+=n.WHITE_ALL:a(u,l)===r&&a(u,l+1)===s?c+=n.WHITE_BLACK:a(u,l)===s&&a(u,l+1)===r?c+=n.BLACK_WHITE:c+=n.BLACK_ALL;o.push(c),c=""}return o.join(`
`)}const Sb="$dkpurple",eLe="$196",tLe="$205";function wi(t,e,n){Ug(t,e,n)}function nLe(t,e,n){const i=eLe.repeat(n);wi(t,e,`${Sb}${i}`)}function c7(t,e,n){const i=tLe.repeat(n);wi(t,e,`${Sb}${i}`)}function jp(t,e,n){wi(t,e,`${Sb} ${" ".repeat(n.length)} `),nLe(t,e,n.length+2),wi(t,e,`${Sb} $white${n} `),c7(t,e,n.length+2)}function dv(t,e,n){wi(t,e,`${Sb} ${" ".repeat(n.length)} `),wi(t,e,`${Sb} $gray${n} `),c7(t,e,n.length+2)}function cr(t,e,n,i){wi(t,e,`${Sb} $white${n} $blue${i}`)}function $a(t,e,n){wi(t,e,`${Sb}$blue${n}`)}function g2(t,e,n,i,r=!0){if(r){const s=QPe(n).split(`
`),a={32:32,9600:223,9604:220,9608:219};for(let o=0;o<s.length;o++){const c=[...s[o]].map(l=>`$${a[l.charCodeAt(0)]}`).join("");wi(t,e,c)}}wi(t,e,`!copyit ${n};${i}`),i7(t,e)}function iLe(t,e,n,i){wi(t,e,`!openit ${n};${i}`)}async function J5(t){const e=new FormData;e.append("url",t);const n=new Request("https://bytes.zed.cafe",{method:"POST",body:e});return await(await fetch(n)).text()}function Wue(){return window.location.href.includes("/join/")}function Z5(){return window.location.href.includes("/locked/")}const AZ=t=>{let e;const n=new Set,i=(l,u)=>{const h=typeof l=="function"?l(e):l;if(!Object.is(h,e)){const d=e;e=u??(typeof h!="object"||h===null)?h:Object.assign({},e,h),n.forEach(f=>f(e,d))}},r=()=>e,o={setState:i,getState:r,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(i,r,o);return o},l7=t=>t?AZ(t):AZ,rLe=t=>t;function u7(t,e=rLe){const n=Eg.useSyncExternalStore(t.subscribe,()=>e(t.getState()),()=>e(t.getInitialState()));return Eg.useDebugValue(n),n}const MZ=t=>{const e=l7(t),n=i=>u7(e,i);return Object.assign(n,e),n},$b=t=>t?MZ(t):MZ;function OZ(t){const e=Be.useRef();return n=>{const i=t(n);return(e.current===void 0||i===void 0?e.current===i:$1(e.current,i))?e.current:e.current=i}}const Eo=$b(()=>({desync:!1,zsswords:{cli:[],loader:[],runtime:[],flags:[],stats:[],kinds:[],altkinds:[],colors:[],dirs:[],dirmods:[]},gadget:{id:"",layers:[],scroll:[],sidebar:[]}}));var tP=(t=>(t[t.OFF=0]="OFF",t[t.INFO=1]="INFO",t[t.DEBUG=2]="DEBUG",t))(tP||{});const NZ=128;var kd=(t=>(t[t.TOP=0]="TOP",t[t.FULL=1]="FULL",t[t.BOTTOM=2]="BOTTOM",t[t.SPLIT_Y=3]="SPLIT_Y",t[t.SPLIT_Y_ALT=4]="SPLIT_Y_ALT",t[t.MAX=5]="MAX",t))(kd||{});const Us=$b(()=>({layout:0,inspector:Z5(),quickterminal:!1,toast:"",terminal:{open:!0,level:1,logs:[]},editor:{open:!1,book:"",path:[],type:"",title:"",refsheet:[]}})),nc=$b(()=>({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""]})),ho=$b(()=>({id:"",xscroll:0,yscroll:0,cursor:0,select:void 0})),n1=$b(()=>({cursor:void 0,select:void 0}));function sLe(t){const e=document.createElement("canvas");if(e.width=(t==null?void 0:t.width)||1,e.height=(t==null?void 0:t.height)||1,t){const n=e.getContext("2d"),i=n==null?void 0:n.getImageData(0,0,t.width,t.height);if(i&&n){let r=0;const{data:s}=i;for(let a=0;a<s.length;a+=4){const o=t.bits[r];s[a]=o,s[a+1]=o,s[a+2]=o,s[a+3]=255,r+=1}n.putImageData(i,0,0)}}return e}function Yue(t,e){return{width:t,height:e,size:t*e,bits:new Uint8Array(t*e).fill(0)}}function fw(t,e,n){return{width:t,height:e,size:t*e,bits:new Uint8Array(n)}}const Q5=14,hT=3,Cg=8,Rg=14,Fh=16,XM=16,h7=16;var Dd=(t=>(t[t.BLANK=0]="BLANK",t[t.TILES=1]="TILES",t[t.SPRITES=2]="SPRITES",t[t.DITHER=3]="DITHER",t[t.MEDIA=4]="MEDIA",t[t.CONTROL=5]="CONTROL",t))(Dd||{}),Zp=(t=>(t[t.FAR=1]="FAR",t[t.MID=1.5]="MID",t[t.NEAR=3]="NEAR",t))(Zp||{});function v2(t){let e=0,n=0,i=727,r=-1e3,s=1.5,a="flat",o=0;return t.forEach(c=>{switch(c.type){case 1:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 3:e=Math.max(e,c.width),n=Math.max(n,c.height);break;case 5:i=c.focusx,r=c.focusy,s=c.viewscale,a=c.graphics,o=c.facing;break}}),{width:e,height:n,focusx:i,focusy:r,viewscale:s,graphics:a,facing:o}}function Wb(t,e){return`${t}:${e}`}const Xue=1,Kue=16,Jue=256;var tn=(t=>(t[t.NONE=0]="NONE",t[t.ALT=1]="ALT",t[t.CTRL=2]="CTRL",t[t.SHIFT=3]="SHIFT",t[t.MOVE_UP=4]="MOVE_UP",t[t.MOVE_DOWN=5]="MOVE_DOWN",t[t.MOVE_LEFT=6]="MOVE_LEFT",t[t.MOVE_RIGHT=7]="MOVE_RIGHT",t[t.OK_BUTTON=8]="OK_BUTTON",t[t.CANCEL_BUTTON=9]="CANCEL_BUTTON",t[t.MENU_BUTTON=10]="MENU_BUTTON",t))(tn||{});function $C(t){const e=Math.floor(t.length/hT);if(e*hT!==t.length)return;const n=Yue(3,e);for(let i=0;i<n.bits.length;++i)n.bits[i]=t[i];return n}function aLe(t,e){return t&1<<e?255:0}function WC(t){const e=Math.floor(t.length/Q5);if(e*Q5!==t.length)return;const n=Math.ceil(e/Fh),i=Cg*Fh,r=Yue(i,Rg*n);let s=0,a=0,o=0;for(let c=0;c<t.length;++c){const l=a*Rg+o,u=t[c];for(let h=0;h<Cg;++h){const d=s*Cg+h;r.bits[d+l*i]=aLe(u,7-h)}++o,o===Rg&&(o=0,++s,s===Fh&&(s=0,++a))}return r}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const IZ="0123456789abcdef",Zue=[],y2=[];for(let t=0;t<256;t++)Zue[t]=IZ[t>>4&15]+IZ[t&15],t<16&&(t<10?y2[48+t]=t:y2[87+t]=t);const Que=t=>{const e=t.length;let n="",i=0;for(;i<e;)n+=Zue[t[i++]];return n},KM=t=>{const e=t.length>>1,n=e<<1,i=new Uint8Array(e);let r=0,s=0;for(;s<n;)i[r++]=y2[t.charCodeAt(s++)]<<4|y2[t.charCodeAt(s++)];return i};var kZ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",oLe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Wk=0;Wk<kZ.length;Wk++)oLe[kZ.charCodeAt(Wk)]=Wk;new TextDecoder;new TextEncoder;const DZ=typeof window<"u"?window:self,PZ=DZ.crypto||DZ.msCrypto||{};PZ.subtle||PZ.webkitSubtle;const TN=KM("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),xN=KM("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f"),Xp=globalThis||void 0||self;var ehe=typeof Xp=="object"&&Xp&&Xp.Object===Object&&Xp,cLe=typeof self=="object"&&self&&self.Object===Object&&self,Jg=ehe||cLe||Function("return this")(),tp=Jg.Symbol,the=Object.prototype,lLe=the.hasOwnProperty,uLe=the.toString,$R=tp?tp.toStringTag:void 0;function hLe(t){var e=lLe.call(t,$R),n=t[$R];try{t[$R]=void 0;var i=!0}catch{}var r=uLe.call(t);return i&&(e?t[$R]=n:delete t[$R]),r}var dLe=Object.prototype,fLe=dLe.toString;function pLe(t){return fLe.call(t)}var mLe="[object Null]",gLe="[object Undefined]",LZ=tp?tp.toStringTag:void 0;function Yb(t){return t==null?t===void 0?gLe:mLe:LZ&&LZ in Object(t)?hLe(t):pLe(t)}function nm(t){return t!=null&&typeof t=="object"}var vLe="[object Symbol]";function q3(t){return typeof t=="symbol"||nm(t)&&Yb(t)==vLe}function $3(t,e){for(var n=-1,i=t==null?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}var qr=Array.isArray,yLe=1/0,UZ=tp?tp.prototype:void 0,BZ=UZ?UZ.toString:void 0;function nhe(t){if(typeof t=="string")return t;if(qr(t))return $3(t,nhe)+"";if(q3(t))return BZ?BZ.call(t):"";var e=t+"";return e=="0"&&1/t==-yLe?"-0":e}var _Le=/\s/;function bLe(t){for(var e=t.length;e--&&_Le.test(t.charAt(e)););return e}var ELe=/^\s+/;function SLe(t){return t&&t.slice(0,bLe(t)+1).replace(ELe,"")}function np(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var FZ=NaN,TLe=/^[-+]0x[0-9a-f]+$/i,xLe=/^0b[01]+$/i,wLe=/^0o[0-7]+$/i,CLe=parseInt;function RLe(t){if(typeof t=="number")return t;if(q3(t))return FZ;if(np(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=np(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=SLe(t);var n=xLe.test(t);return n||wLe.test(t)?CLe(t.slice(2),n?2:8):TLe.test(t)?FZ:+t}var zZ=1/0,ALe=17976931348623157e292;function MLe(t){if(!t)return t===0?t:0;if(t=RLe(t),t===zZ||t===-zZ){var e=t<0?-1:1;return e*ALe}return t===t?t:0}function W3(t){var e=MLe(t),n=e%1;return e===e?n?e-n:e:0}function eC(t){return t}var OLe="[object AsyncFunction]",NLe="[object Function]",ILe="[object GeneratorFunction]",kLe="[object Proxy]";function fy(t){if(!np(t))return!1;var e=Yb(t);return e==NLe||e==ILe||e==OLe||e==kLe}var j8=Jg["__core-js_shared__"],HZ=function(){var t=/[^.]+$/.exec(j8&&j8.keys&&j8.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function DLe(t){return!!HZ&&HZ in t}var PLe=Function.prototype,LLe=PLe.toString;function VT(t){if(t!=null){try{return LLe.call(t)}catch{}try{return t+""}catch{}}return""}var ULe=/[\\^$.*+?()[\]{}|]/g,BLe=/^\[object .+?Constructor\]$/,FLe=Function.prototype,zLe=Object.prototype,HLe=FLe.toString,jLe=zLe.hasOwnProperty,VLe=RegExp("^"+HLe.call(jLe).replace(ULe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GLe(t){if(!np(t)||DLe(t))return!1;var e=fy(t)?VLe:BLe;return e.test(VT(t))}function qLe(t,e){return t==null?void 0:t[e]}function GT(t,e){var n=qLe(t,e);return GLe(n)?n:void 0}var eV=GT(Jg,"WeakMap"),jZ=Object.create,$Le=function(){function t(){}return function(e){if(!np(e))return{};if(jZ)return jZ(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function WLe(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Rc(){}function YLe(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e}var XLe=800,KLe=16,JLe=Date.now;function ZLe(t){var e=0,n=0;return function(){var i=JLe(),r=KLe-(i-n);if(n=i,r>0){if(++e>=XLe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function QLe(t){return function(){return t}}var _2=function(){try{var t=GT(Object,"defineProperty");return t({},"",{}),t}catch{}}(),e2e=_2?function(t,e){return _2(t,"toString",{configurable:!0,enumerable:!1,value:QLe(e),writable:!0})}:eC,t2e=ZLe(e2e);function ihe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i&&e(t[n],n,t)!==!1;);return t}function rhe(t,e,n,i){for(var r=t.length,s=n+-1;++s<r;)if(e(t[s],s,t))return s;return-1}function n2e(t){return t!==t}function i2e(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}function d7(t,e,n){return e===e?i2e(t,e,n):rhe(t,n2e,n)}function she(t,e){var n=t==null?0:t.length;return!!n&&d7(t,e,0)>-1}var r2e=9007199254740991,s2e=/^(?:0|[1-9]\d*)$/;function Y3(t,e){var n=typeof t;return e=e??r2e,!!e&&(n=="number"||n!="symbol"&&s2e.test(t))&&t>-1&&t%1==0&&t<e}function f7(t,e,n){e=="__proto__"&&_2?_2(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function wN(t,e){return t===e||t!==t&&e!==e}var a2e=Object.prototype,o2e=a2e.hasOwnProperty;function X3(t,e,n){var i=t[e];(!(o2e.call(t,e)&&wN(i,n))||n===void 0&&!(e in t))&&f7(t,e,n)}function p7(t,e,n,i){var r=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var o=e[s],c=void 0;c===void 0&&(c=t[o]),r?f7(n,o,c):X3(n,o,c)}return n}var VZ=Math.max;function c2e(t,e,n){return e=VZ(e===void 0?t.length-1:e,0),function(){for(var i=arguments,r=-1,s=VZ(i.length-e,0),a=Array(s);++r<s;)a[r]=i[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=i[r];return o[e]=n(a),WLe(t,this,o)}}function m7(t,e){return t2e(c2e(t,e,eC),t+"")}var l2e=9007199254740991;function g7(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=l2e}function Zg(t){return t!=null&&g7(t.length)&&!fy(t)}function ahe(t,e,n){if(!np(n))return!1;var i=typeof e;return(i=="number"?Zg(n)&&Y3(e,n.length):i=="string"&&e in n)?wN(n[e],t):!1}function u2e(t){return m7(function(e,n){var i=-1,r=n.length,s=r>1?n[r-1]:void 0,a=r>2?n[2]:void 0;for(s=t.length>3&&typeof s=="function"?(r--,s):void 0,a&&ahe(n[0],n[1],a)&&(s=r<3?void 0:s,r=1),e=Object(e);++i<r;){var o=n[i];o&&t(e,o,i,s)}return e})}var h2e=Object.prototype;function CN(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||h2e;return t===n}function d2e(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}var f2e="[object Arguments]";function GZ(t){return nm(t)&&Yb(t)==f2e}var ohe=Object.prototype,p2e=ohe.hasOwnProperty,m2e=ohe.propertyIsEnumerable,K3=GZ(function(){return arguments}())?GZ:function(t){return nm(t)&&p2e.call(t,"callee")&&!m2e.call(t,"callee")};function g2e(){return!1}var che=typeof exports=="object"&&exports&&!exports.nodeType&&exports,qZ=che&&typeof module=="object"&&module&&!module.nodeType&&module,v2e=qZ&&qZ.exports===che,$Z=v2e?Jg.Buffer:void 0,y2e=$Z?$Z.isBuffer:void 0,JM=y2e||g2e,_2e="[object Arguments]",b2e="[object Array]",E2e="[object Boolean]",S2e="[object Date]",T2e="[object Error]",x2e="[object Function]",w2e="[object Map]",C2e="[object Number]",R2e="[object Object]",A2e="[object RegExp]",M2e="[object Set]",O2e="[object String]",N2e="[object WeakMap]",I2e="[object ArrayBuffer]",k2e="[object DataView]",D2e="[object Float32Array]",P2e="[object Float64Array]",L2e="[object Int8Array]",U2e="[object Int16Array]",B2e="[object Int32Array]",F2e="[object Uint8Array]",z2e="[object Uint8ClampedArray]",H2e="[object Uint16Array]",j2e="[object Uint32Array]",ga={};ga[D2e]=ga[P2e]=ga[L2e]=ga[U2e]=ga[B2e]=ga[F2e]=ga[z2e]=ga[H2e]=ga[j2e]=!0;ga[_2e]=ga[b2e]=ga[I2e]=ga[E2e]=ga[k2e]=ga[S2e]=ga[T2e]=ga[x2e]=ga[w2e]=ga[C2e]=ga[R2e]=ga[A2e]=ga[M2e]=ga[O2e]=ga[N2e]=!1;function V2e(t){return nm(t)&&g7(t.length)&&!!ga[Yb(t)]}function J3(t){return function(e){return t(e)}}var lhe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,ZA=lhe&&typeof module=="object"&&module&&!module.nodeType&&module,G2e=ZA&&ZA.exports===lhe,V8=G2e&&ehe.process,Tb=function(){try{var t=ZA&&ZA.require&&ZA.require("util").types;return t||V8&&V8.binding&&V8.binding("util")}catch{}}(),WZ=Tb&&Tb.isTypedArray,v7=WZ?J3(WZ):V2e,q2e=Object.prototype,$2e=q2e.hasOwnProperty;function uhe(t,e){var n=qr(t),i=!n&&K3(t),r=!n&&!i&&JM(t),s=!n&&!i&&!r&&v7(t),a=n||i||r||s,o=a?d2e(t.length,String):[],c=o.length;for(var l in t)(e||$2e.call(t,l))&&!(a&&(l=="length"||r&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||Y3(l,c)))&&o.push(l);return o}function hhe(t,e){return function(n){return t(e(n))}}var W2e=hhe(Object.keys,Object),Y2e=Object.prototype,X2e=Y2e.hasOwnProperty;function dhe(t){if(!CN(t))return W2e(t);var e=[];for(var n in Object(t))X2e.call(t,n)&&n!="constructor"&&e.push(n);return e}function ip(t){return Zg(t)?uhe(t):dhe(t)}var K2e=Object.prototype,J2e=K2e.hasOwnProperty,Yh=u2e(function(t,e){if(CN(e)||Zg(e)){p7(e,ip(e),t);return}for(var n in e)J2e.call(e,n)&&X3(t,n,e[n])});function Z2e(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Q2e=Object.prototype,eUe=Q2e.hasOwnProperty;function tUe(t){if(!np(t))return Z2e(t);var e=CN(t),n=[];for(var i in t)i=="constructor"&&(e||!eUe.call(t,i))||n.push(i);return n}function fhe(t){return Zg(t)?uhe(t,!0):tUe(t)}var nUe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,iUe=/^\w*$/;function y7(t,e){if(qr(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||q3(t)?!0:iUe.test(t)||!nUe.test(t)||e!=null&&t in Object(e)}var ZM=GT(Object,"create");function rUe(){this.__data__=ZM?ZM(null):{},this.size=0}function sUe(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var aUe="__lodash_hash_undefined__",oUe=Object.prototype,cUe=oUe.hasOwnProperty;function lUe(t){var e=this.__data__;if(ZM){var n=e[t];return n===aUe?void 0:n}return cUe.call(e,t)?e[t]:void 0}var uUe=Object.prototype,hUe=uUe.hasOwnProperty;function dUe(t){var e=this.__data__;return ZM?e[t]!==void 0:hUe.call(e,t)}var fUe="__lodash_hash_undefined__";function pUe(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ZM&&e===void 0?fUe:e,this}function dT(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}dT.prototype.clear=rUe;dT.prototype.delete=sUe;dT.prototype.get=lUe;dT.prototype.has=dUe;dT.prototype.set=pUe;function mUe(){this.__data__=[],this.size=0}function Z3(t,e){for(var n=t.length;n--;)if(wN(t[n][0],e))return n;return-1}var gUe=Array.prototype,vUe=gUe.splice;function yUe(t){var e=this.__data__,n=Z3(e,t);if(n<0)return!1;var i=e.length-1;return n==i?e.pop():vUe.call(e,n,1),--this.size,!0}function _Ue(t){var e=this.__data__,n=Z3(e,t);return n<0?void 0:e[n][1]}function bUe(t){return Z3(this.__data__,t)>-1}function EUe(t,e){var n=this.__data__,i=Z3(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}function py(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}py.prototype.clear=mUe;py.prototype.delete=yUe;py.prototype.get=_Ue;py.prototype.has=bUe;py.prototype.set=EUe;var QM=GT(Jg,"Map");function SUe(){this.size=0,this.__data__={hash:new dT,map:new(QM||py),string:new dT}}function TUe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Q3(t,e){var n=t.__data__;return TUe(e)?n[typeof e=="string"?"string":"hash"]:n.map}function xUe(t){var e=Q3(this,t).delete(t);return this.size-=e?1:0,e}function wUe(t){return Q3(this,t).get(t)}function CUe(t){return Q3(this,t).has(t)}function RUe(t,e){var n=Q3(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}function my(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}my.prototype.clear=SUe;my.prototype.delete=xUe;my.prototype.get=wUe;my.prototype.has=CUe;my.prototype.set=RUe;var AUe="Expected a function";function _7(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(AUe);var n=function(){var i=arguments,r=e?e.apply(this,i):i[0],s=n.cache;if(s.has(r))return s.get(r);var a=t.apply(this,i);return n.cache=s.set(r,a)||s,a};return n.cache=new(_7.Cache||my),n}_7.Cache=my;var MUe=500;function OUe(t){var e=_7(t,function(i){return n.size===MUe&&n.clear(),i}),n=e.cache;return e}var NUe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,IUe=/\\(\\)?/g,kUe=OUe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(NUe,function(n,i,r,s){e.push(r?s.replace(IUe,"$1"):i||n)}),e});function phe(t){return t==null?"":nhe(t)}function eB(t,e){return qr(t)?t:y7(t,e)?[t]:kUe(phe(t))}var DUe=1/0;function RN(t){if(typeof t=="string"||q3(t))return t;var e=t+"";return e=="0"&&1/t==-DUe?"-0":e}function b7(t,e){e=eB(e,t);for(var n=0,i=e.length;t!=null&&n<i;)t=t[RN(e[n++])];return n&&n==i?t:void 0}function PUe(t,e,n){var i=t==null?void 0:b7(t,e);return i===void 0?n:i}function E7(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}var YZ=tp?tp.isConcatSpreadable:void 0;function LUe(t){return qr(t)||K3(t)||!!(YZ&&t&&t[YZ])}function S7(t,e,n,i,r){var s=-1,a=t.length;for(n||(n=LUe),r||(r=[]);++s<a;){var o=t[s];n(o)?E7(r,o):i||(r[r.length]=o)}return r}function Vh(t){var e=t==null?0:t.length;return e?S7(t):[]}var mhe=hhe(Object.getPrototypeOf,Object);function T7(t,e,n){var i=-1,r=t.length;e<0&&(e=-e>r?0:r+e),n=n>r?r:n,n<0&&(n+=r),r=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=t[i+e];return s}function UUe(t,e,n){var i=t.length;return n=n===void 0?i:n,!e&&n>=i?t:T7(t,e,n)}var BUe="\\ud800-\\udfff",FUe="\\u0300-\\u036f",zUe="\\ufe20-\\ufe2f",HUe="\\u20d0-\\u20ff",jUe=FUe+zUe+HUe,VUe="\\ufe0e\\ufe0f",GUe="\\u200d",qUe=RegExp("["+GUe+BUe+jUe+VUe+"]");function ghe(t){return qUe.test(t)}function $Ue(t){return t.split("")}var vhe="\\ud800-\\udfff",WUe="\\u0300-\\u036f",YUe="\\ufe20-\\ufe2f",XUe="\\u20d0-\\u20ff",KUe=WUe+YUe+XUe,JUe="\\ufe0e\\ufe0f",ZUe="["+vhe+"]",tV="["+KUe+"]",nV="\\ud83c[\\udffb-\\udfff]",QUe="(?:"+tV+"|"+nV+")",yhe="[^"+vhe+"]",_he="(?:\\ud83c[\\udde6-\\uddff]){2}",bhe="[\\ud800-\\udbff][\\udc00-\\udfff]",e3e="\\u200d",Ehe=QUe+"?",She="["+JUe+"]?",t3e="(?:"+e3e+"(?:"+[yhe,_he,bhe].join("|")+")"+She+Ehe+")*",n3e=She+Ehe+t3e,i3e="(?:"+[yhe+tV+"?",tV,_he,bhe,ZUe].join("|")+")",r3e=RegExp(nV+"(?="+nV+")|"+i3e+n3e,"g");function s3e(t){return t.match(r3e)||[]}function a3e(t){return ghe(t)?s3e(t):$Ue(t)}function o3e(t){return function(e){e=phe(e);var n=ghe(e)?a3e(e):void 0,i=n?n[0]:e.charAt(0),r=n?UUe(n,1).join(""):e.slice(1);return i[t]()+r}}var The=o3e("toUpperCase");function c3e(t,e,n,i){var r=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++r]);++r<s;)n=e(n,t[r],r,t);return n}function l3e(){this.__data__=new py,this.size=0}function u3e(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function h3e(t){return this.__data__.get(t)}function d3e(t){return this.__data__.has(t)}var f3e=200;function p3e(t,e){var n=this.__data__;if(n instanceof py){var i=n.__data__;if(!QM||i.length<f3e-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new my(i)}return n.set(t,e),this.size=n.size,this}function Ag(t){var e=this.__data__=new py(t);this.size=e.size}Ag.prototype.clear=l3e;Ag.prototype.delete=u3e;Ag.prototype.get=h3e;Ag.prototype.has=d3e;Ag.prototype.set=p3e;function m3e(t,e){return t&&p7(e,ip(e),t)}var xhe=typeof exports=="object"&&exports&&!exports.nodeType&&exports,XZ=xhe&&typeof module=="object"&&module&&!module.nodeType&&module,g3e=XZ&&XZ.exports===xhe,KZ=g3e?Jg.Buffer:void 0,JZ=KZ?KZ.allocUnsafe:void 0;function v3e(t,e){var n=t.length,i=JZ?JZ(n):new t.constructor(n);return t.copy(i),i}function x7(t,e){for(var n=-1,i=t==null?0:t.length,r=0,s=[];++n<i;){var a=t[n];e(a,n,t)&&(s[r++]=a)}return s}function whe(){return[]}var y3e=Object.prototype,_3e=y3e.propertyIsEnumerable,ZZ=Object.getOwnPropertySymbols,w7=ZZ?function(t){return t==null?[]:(t=Object(t),x7(ZZ(t),function(e){return _3e.call(t,e)}))}:whe;function b3e(t,e){return p7(t,w7(t),e)}var E3e=Object.getOwnPropertySymbols,S3e=E3e?function(t){for(var e=[];t;)E7(e,w7(t)),t=mhe(t);return e}:whe;function Che(t,e,n){var i=e(t);return qr(t)?i:E7(i,n(t))}function iV(t){return Che(t,ip,w7)}function T3e(t){return Che(t,fhe,S3e)}var rV=GT(Jg,"DataView"),sV=GT(Jg,"Promise"),pw=GT(Jg,"Set"),QZ="[object Map]",x3e="[object Object]",eQ="[object Promise]",tQ="[object Set]",nQ="[object WeakMap]",iQ="[object DataView]",w3e=VT(rV),C3e=VT(QM),R3e=VT(sV),A3e=VT(pw),M3e=VT(eV),Nf=Yb;(rV&&Nf(new rV(new ArrayBuffer(1)))!=iQ||QM&&Nf(new QM)!=QZ||sV&&Nf(sV.resolve())!=eQ||pw&&Nf(new pw)!=tQ||eV&&Nf(new eV)!=nQ)&&(Nf=function(t){var e=Yb(t),n=e==x3e?t.constructor:void 0,i=n?VT(n):"";if(i)switch(i){case w3e:return iQ;case C3e:return QZ;case R3e:return eQ;case A3e:return tQ;case M3e:return nQ}return e});var O3e=Object.prototype,N3e=O3e.hasOwnProperty;function I3e(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&N3e.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var b2=Jg.Uint8Array;function k3e(t){var e=new t.constructor(t.byteLength);return new b2(e).set(new b2(t)),e}function D3e(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var P3e=/\w*$/;function L3e(t){var e=new t.constructor(t.source,P3e.exec(t));return e.lastIndex=t.lastIndex,e}var rQ=tp?tp.prototype:void 0,sQ=rQ?rQ.valueOf:void 0;function U3e(t){return sQ?Object(sQ.call(t)):{}}function B3e(t,e){var n=t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var F3e="[object Boolean]",z3e="[object Date]",H3e="[object Map]",j3e="[object Number]",V3e="[object RegExp]",G3e="[object Set]",q3e="[object String]",$3e="[object Symbol]",W3e="[object ArrayBuffer]",Y3e="[object DataView]",X3e="[object Float32Array]",K3e="[object Float64Array]",J3e="[object Int8Array]",Z3e="[object Int16Array]",Q3e="[object Int32Array]",eBe="[object Uint8Array]",tBe="[object Uint8ClampedArray]",nBe="[object Uint16Array]",iBe="[object Uint32Array]";function rBe(t,e,n){var i=t.constructor;switch(e){case W3e:return k3e(t);case F3e:case z3e:return new i(+t);case Y3e:return D3e(t);case X3e:case K3e:case J3e:case Z3e:case Q3e:case eBe:case tBe:case nBe:case iBe:return B3e(t);case H3e:return new i;case j3e:case q3e:return new i(t);case V3e:return L3e(t);case G3e:return new i;case $3e:return U3e(t)}}function sBe(t){return typeof t.constructor=="function"&&!CN(t)?$Le(mhe(t)):{}}var aBe="[object Map]";function oBe(t){return nm(t)&&Nf(t)==aBe}var aQ=Tb&&Tb.isMap,cBe=aQ?J3(aQ):oBe,lBe="[object Set]";function uBe(t){return nm(t)&&Nf(t)==lBe}var oQ=Tb&&Tb.isSet,hBe=oQ?J3(oQ):uBe,Rhe="[object Arguments]",dBe="[object Array]",fBe="[object Boolean]",pBe="[object Date]",mBe="[object Error]",Ahe="[object Function]",gBe="[object GeneratorFunction]",vBe="[object Map]",yBe="[object Number]",Mhe="[object Object]",_Be="[object RegExp]",bBe="[object Set]",EBe="[object String]",SBe="[object Symbol]",TBe="[object WeakMap]",xBe="[object ArrayBuffer]",wBe="[object DataView]",CBe="[object Float32Array]",RBe="[object Float64Array]",ABe="[object Int8Array]",MBe="[object Int16Array]",OBe="[object Int32Array]",NBe="[object Uint8Array]",IBe="[object Uint8ClampedArray]",kBe="[object Uint16Array]",DBe="[object Uint32Array]",ea={};ea[Rhe]=ea[dBe]=ea[xBe]=ea[wBe]=ea[fBe]=ea[pBe]=ea[CBe]=ea[RBe]=ea[ABe]=ea[MBe]=ea[OBe]=ea[vBe]=ea[yBe]=ea[Mhe]=ea[_Be]=ea[bBe]=ea[EBe]=ea[SBe]=ea[NBe]=ea[IBe]=ea[kBe]=ea[DBe]=!0;ea[mBe]=ea[Ahe]=ea[TBe]=!1;function nP(t,e,n,i,r,s){var a;if(a!==void 0)return a;if(!np(t))return t;var o=qr(t);if(o)return a=I3e(t),YLe(t,a);var c=Nf(t),l=c==Ahe||c==gBe;if(JM(t))return v3e(t);if(c==Mhe||c==Rhe||l&&!r)return a=l?{}:sBe(t),b3e(t,m3e(a,t));if(!ea[c])return r?t:{};a=rBe(t,c),s||(s=new Ag);var u=s.get(t);if(u)return u;s.set(t,a),hBe(t)?t.forEach(function(f){a.add(nP(f,e,n,f,t,s))}):cBe(t)&&t.forEach(function(f,p){a.set(p,nP(f,e,n,p,t,s))});var h=iV,d=o?void 0:h(t);return ihe(d||t,function(f,p){d&&(p=f,f=t[p]),X3(a,p,nP(f,e,n,p,t,s))}),a}var PBe=4;function Bl(t){return nP(t,PBe)}function AN(t){for(var e=-1,n=t==null?0:t.length,i=0,r=[];++e<n;){var s=t[e];s&&(r[i++]=s)}return r}var LBe="__lodash_hash_undefined__";function UBe(t){return this.__data__.set(t,LBe),this}function BBe(t){return this.__data__.has(t)}function tC(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new my;++e<n;)this.add(t[e])}tC.prototype.add=tC.prototype.push=UBe;tC.prototype.has=BBe;function Ohe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}function C7(t,e){return t.has(e)}var FBe=1,zBe=2;function Nhe(t,e,n,i,r,s){var a=n&FBe,o=t.length,c=e.length;if(o!=c&&!(a&&c>o))return!1;var l=s.get(t),u=s.get(e);if(l&&u)return l==e&&u==t;var h=-1,d=!0,f=n&zBe?new tC:void 0;for(s.set(t,e),s.set(e,t);++h<o;){var p=t[h],g=e[h];if(i)var _=a?i(g,p,h,e,t,s):i(p,g,h,t,e,s);if(_!==void 0){if(_)continue;d=!1;break}if(f){if(!Ohe(e,function(v,E){if(!C7(f,E)&&(p===v||r(p,v,n,i,s)))return f.push(E)})){d=!1;break}}else if(!(p===g||r(p,g,n,i,s))){d=!1;break}}return s.delete(t),s.delete(e),d}function HBe(t){var e=-1,n=Array(t.size);return t.forEach(function(i,r){n[++e]=[r,i]}),n}function R7(t){var e=-1,n=Array(t.size);return t.forEach(function(i){n[++e]=i}),n}var jBe=1,VBe=2,GBe="[object Boolean]",qBe="[object Date]",$Be="[object Error]",WBe="[object Map]",YBe="[object Number]",XBe="[object RegExp]",KBe="[object Set]",JBe="[object String]",ZBe="[object Symbol]",QBe="[object ArrayBuffer]",eFe="[object DataView]",cQ=tp?tp.prototype:void 0,G8=cQ?cQ.valueOf:void 0;function tFe(t,e,n,i,r,s,a){switch(n){case eFe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case QBe:return!(t.byteLength!=e.byteLength||!s(new b2(t),new b2(e)));case GBe:case qBe:case YBe:return wN(+t,+e);case $Be:return t.name==e.name&&t.message==e.message;case XBe:case JBe:return t==e+"";case WBe:var o=HBe;case KBe:var c=i&jBe;if(o||(o=R7),t.size!=e.size&&!c)return!1;var l=a.get(t);if(l)return l==e;i|=VBe,a.set(t,e);var u=Nhe(o(t),o(e),i,r,s,a);return a.delete(t),u;case ZBe:if(G8)return G8.call(t)==G8.call(e)}return!1}var nFe=1,iFe=Object.prototype,rFe=iFe.hasOwnProperty;function sFe(t,e,n,i,r,s){var a=n&nFe,o=iV(t),c=o.length,l=iV(e),u=l.length;if(c!=u&&!a)return!1;for(var h=c;h--;){var d=o[h];if(!(a?d in e:rFe.call(e,d)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var _=a;++h<c;){d=o[h];var v=t[d],E=e[d];if(i)var T=a?i(E,v,d,e,t,s):i(v,E,d,t,e,s);if(!(T===void 0?v===E||r(v,E,n,i,s):T)){g=!1;break}_||(_=d=="constructor")}if(g&&!_){var x=t.constructor,N=e.constructor;x!=N&&"constructor"in t&&"constructor"in e&&!(typeof x=="function"&&x instanceof x&&typeof N=="function"&&N instanceof N)&&(g=!1)}return s.delete(t),s.delete(e),g}var aFe=1,lQ="[object Arguments]",uQ="[object Array]",Yk="[object Object]",oFe=Object.prototype,hQ=oFe.hasOwnProperty;function cFe(t,e,n,i,r,s){var a=qr(t),o=qr(e),c=a?uQ:Nf(t),l=o?uQ:Nf(e);c=c==lQ?Yk:c,l=l==lQ?Yk:l;var u=c==Yk,h=l==Yk,d=c==l;if(d&&JM(t)){if(!JM(e))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Ag),a||v7(t)?Nhe(t,e,n,i,r,s):tFe(t,e,c,n,i,r,s);if(!(n&aFe)){var f=u&&hQ.call(t,"__wrapped__"),p=h&&hQ.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,_=p?e.value():e;return s||(s=new Ag),r(g,_,n,i,s)}}return d?(s||(s=new Ag),sFe(t,e,n,i,r,s)):!1}function A7(t,e,n,i,r){return t===e?!0:t==null||e==null||!nm(t)&&!nm(e)?t!==t&&e!==e:cFe(t,e,n,i,A7,r)}var lFe=1,uFe=2;function hFe(t,e,n,i){var r=n.length,s=r;if(t==null)return!s;for(t=Object(t);r--;){var a=n[r];if(a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++r<s;){a=n[r];var o=a[0],c=t[o],l=a[1];if(a[2]){if(c===void 0&&!(o in t))return!1}else{var u=new Ag,h;if(!(h===void 0?A7(l,c,lFe|uFe,i,u):h))return!1}}return!0}function Ihe(t){return t===t&&!np(t)}function dFe(t){for(var e=ip(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,Ihe(r)]}return e}function khe(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}function fFe(t){var e=dFe(t);return e.length==1&&e[0][2]?khe(e[0][0],e[0][1]):function(n){return n===t||hFe(n,t,e)}}function pFe(t,e){return t!=null&&e in Object(t)}function Dhe(t,e,n){e=eB(e,t);for(var i=-1,r=e.length,s=!1;++i<r;){var a=RN(e[i]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++i!=r?s:(r=t==null?0:t.length,!!r&&g7(r)&&Y3(a,r)&&(qr(t)||K3(t)))}function mFe(t,e){return t!=null&&Dhe(t,e,pFe)}var gFe=1,vFe=2;function yFe(t,e){return y7(t)&&Ihe(e)?khe(RN(t),e):function(n){var i=PUe(n,t);return i===void 0&&i===e?mFe(n,t):A7(e,i,gFe|vFe)}}function _Fe(t){return function(e){return e==null?void 0:e[t]}}function bFe(t){return function(e){return b7(e,t)}}function EFe(t){return y7(t)?_Fe(RN(t)):bFe(t)}function Qg(t){return typeof t=="function"?t:t==null?eC:typeof t=="object"?qr(t)?yFe(t[0],t[1]):fFe(t):EFe(t)}function SFe(t,e,n,i){for(var r=-1,s=t==null?0:t.length;++r<s;){var a=t[r];e(i,a,n(a),t)}return i}function TFe(t){return function(e,n,i){for(var r=-1,s=Object(e),a=i(e),o=a.length;o--;){var c=a[++r];if(n(s[c],c,s)===!1)break}return e}}var xFe=TFe();function wFe(t,e){return t&&xFe(t,e,ip)}function CFe(t,e){return function(n,i){if(n==null)return n;if(!Zg(n))return t(n,i);for(var r=n.length,s=-1,a=Object(n);++s<r&&i(a[s],s,a)!==!1;);return n}}var qT=CFe(wFe);function RFe(t,e,n,i){return qT(t,function(r,s,a){e(i,r,n(r),a)}),i}function AFe(t,e){return function(n,i){var r=qr(n)?SFe:RFe,s=e?e():{};return r(n,t,Qg(i),s)}}var Phe=Object.prototype,MFe=Phe.hasOwnProperty,M7=m7(function(t,e){t=Object(t);var n=-1,i=e.length,r=i>2?e[2]:void 0;for(r&&ahe(e[0],e[1],r)&&(i=1);++n<i;)for(var s=e[n],a=fhe(s),o=-1,c=a.length;++o<c;){var l=a[o],u=t[l];(u===void 0||wN(u,Phe[l])&&!MFe.call(t,l))&&(t[l]=s[l])}return t});function dQ(t){return nm(t)&&Zg(t)}var OFe=200;function NFe(t,e,n,i){var r=-1,s=she,a=!0,o=t.length,c=[],l=e.length;if(!o)return c;e.length>=OFe&&(s=C7,a=!1,e=new tC(e));e:for(;++r<o;){var u=t[r],h=u;if(u=u!==0?u:0,a&&h===h){for(var d=l;d--;)if(e[d]===h)continue e;c.push(u)}else s(e,h,i)||c.push(u)}return c}var tB=m7(function(t,e){return dQ(t)?NFe(t,S7(e,1,dQ,!0)):[]});function nC(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}function Ml(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:W3(e),T7(t,e<0?0:e,i)):[]}function eO(t,e,n){var i=t==null?0:t.length;return i?(e=e===void 0?1:W3(e),e=i-e,T7(t,0,e<0?0:e)):[]}function IFe(t){return typeof t=="function"?t:eC}function Oi(t,e){var n=qr(t)?ihe:qT;return n(t,IFe(e))}function kFe(t,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(!e(t[n],n,t))return!1;return!0}function DFe(t,e){var n=!0;return qT(t,function(i,r,s){return n=!!e(i,r,s),n}),n}function Qp(t,e,n){var i=qr(t)?kFe:DFe;return i(t,Qg(e))}function Lhe(t,e){var n=[];return qT(t,function(i,r,s){e(i,r,s)&&n.push(i)}),n}function lp(t,e){var n=qr(t)?x7:Lhe;return n(t,Qg(e))}function PFe(t){return function(e,n,i){var r=Object(e);if(!Zg(e)){var s=Qg(n);e=ip(e),n=function(o){return s(r[o],o,r)}}var a=t(e,n,i);return a>-1?r[s?e[a]:a]:void 0}}var LFe=Math.max;function UFe(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=n==null?0:W3(n);return r<0&&(r=LFe(i+r,0)),rhe(t,Qg(e),r)}var iC=PFe(UFe);function im(t){return t&&t.length?t[0]:void 0}function BFe(t,e){var n=-1,i=Zg(t)?Array(t.length):[];return qT(t,function(r,s,a){i[++n]=e(r,s,a)}),i}function Dn(t,e){var n=qr(t)?$3:BFe;return n(t,Qg(e))}function Kf(t,e){return S7(Dn(t,e))}var FFe=Object.prototype,zFe=FFe.hasOwnProperty,Uhe=AFe(function(t,e,n){zFe.call(t,n)?t[n].push(e):f7(t,n,[e])}),HFe=Object.prototype,jFe=HFe.hasOwnProperty;function VFe(t,e){return t!=null&&jFe.call(t,e)}function Ei(t,e){return t!=null&&Dhe(t,e,VFe)}var GFe="[object String]";function Xh(t){return typeof t=="string"||!qr(t)&&nm(t)&&Yb(t)==GFe}function qFe(t,e){return $3(e,function(n){return t[n]})}function oc(t){return t==null?[]:qFe(t,ip(t))}var $Fe=Math.max;function ih(t,e,n,i){t=Zg(t)?t:oc(t),n=n&&!i?W3(n):0;var r=t.length;return n<0&&(n=$Fe(r+n,0)),Xh(t)?n<=r&&t.indexOf(e,n)>-1:!!r&&d7(t,e,n)>-1}function fQ(t,e,n){var i=t==null?0:t.length;if(!i)return-1;var r=0;return d7(t,e,r)}var WFe="[object Map]",YFe="[object Set]",XFe=Object.prototype,KFe=XFe.hasOwnProperty;function ia(t){if(t==null)return!0;if(Zg(t)&&(qr(t)||typeof t=="string"||typeof t.splice=="function"||JM(t)||v7(t)||K3(t)))return!t.length;var e=Nf(t);if(e==WFe||e==YFe)return!t.size;if(CN(t))return!dhe(t).length;for(var n in t)if(KFe.call(t,n))return!1;return!0}var JFe="[object RegExp]";function ZFe(t){return nm(t)&&Yb(t)==JFe}var pQ=Tb&&Tb.isRegExp,ty=pQ?J3(pQ):ZFe;function ny(t){return t===void 0}var QFe="Expected a function";function e4e(t){if(typeof t!="function")throw new TypeError(QFe);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}function t4e(t,e,n,i){if(!np(t))return t;e=eB(e,t);for(var r=-1,s=e.length,a=s-1,o=t;o!=null&&++r<s;){var c=RN(e[r]),l=n;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(r!=a){var u=o[c];l=void 0,l===void 0&&(l=np(u)?u:Y3(e[r+1])?[]:{})}X3(o,c,l),o=o[c]}return t}function n4e(t,e,n){for(var i=-1,r=e.length,s={};++i<r;){var a=e[i],o=b7(t,a);n(o,a)&&t4e(s,eB(a,t),o)}return s}function cm(t,e){if(t==null)return{};var n=$3(T3e(t),function(i){return[i]});return e=Qg(e),n4e(t,n,function(i,r){return e(i,r[0])})}function i4e(t,e,n,i,r){return r(t,function(s,a,o){n=i?(i=!1,s):e(n,s,a,o)}),n}function Kh(t,e,n){var i=qr(t)?c3e:i4e,r=arguments.length<3;return i(t,Qg(e),n,r,qT)}function nB(t,e){var n=qr(t)?x7:Lhe;return n(t,e4e(Qg(e)))}function r4e(t,e){var n;return qT(t,function(i,r,s){return n=e(i,r,s),!n}),!!n}function O7(t,e,n){var i=qr(t)?Ohe:r4e;return i(t,Qg(e))}var s4e=1/0,a4e=pw&&1/R7(new pw([,-0]))[1]==s4e?function(t){return new pw(t)}:Rc,o4e=200;function c4e(t,e,n){var i=-1,r=she,s=t.length,a=!0,o=[],c=o;if(s>=o4e){var l=a4e(t);if(l)return R7(l);a=!1,r=C7,c=new tC}else c=o;e:for(;++i<s;){var u=t[i],h=u;if(u=u!==0?u:0,a&&h===h){for(var d=c.length;d--;)if(c[d]===h)continue e;o.push(u)}else r(c,h,n)||(c!==o&&c.push(h),o.push(u))}return o}function iB(t){return t&&t.length?c4e(t):[]}function aV(t){console&&console.error&&console.error(`Error: ${t}`)}function Bhe(t){console&&console.warn&&console.warn(`Warning: ${t}`)}function Fhe(t){const e=new Date().getTime(),n=t();return{time:new Date().getTime()-e,value:n}}function zhe(t){function e(){}e.prototype=t;const n=new e;function i(){return typeof n.bar}return i(),i(),t}function l4e(t){return u4e(t)?t.LABEL:t.name}function u4e(t){return Xh(t.LABEL)&&t.LABEL!==""}class e0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),Oi(this.definition,n=>{n.accept(e)})}}class Jh extends e0{constructor(e){super([]),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class YC extends e0{constructor(e){super(e.definition),this.orgText="",Yh(this,cm(e,n=>n!==void 0))}}class Zh extends e0{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Yh(this,cm(e,n=>n!==void 0))}}class Gh extends e0{constructor(e){super(e.definition),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}}class t0 extends e0{constructor(e){super(e.definition),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}}class n0 extends e0{constructor(e){super(e.definition),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}}class Dc extends e0{constructor(e){super(e.definition),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}}class lm extends e0{constructor(e){super(e.definition),this.idx=1,Yh(this,cm(e,n=>n!==void 0))}}class um extends e0{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Yh(this,cm(e,n=>n!==void 0))}}class Qa{constructor(e){this.idx=1,Yh(this,cm(e,n=>n!==void 0))}accept(e){e.visit(this)}}function h4e(t){return Dn(t,iP)}function iP(t){function e(n){return Dn(n,iP)}if(t instanceof Jh){const n={type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};return Xh(t.label)&&(n.label=t.label),n}else{if(t instanceof Zh)return{type:"Alternative",definition:e(t.definition)};if(t instanceof Gh)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof t0)return{type:"RepetitionMandatory",idx:t.idx,definition:e(t.definition)};if(t instanceof n0)return{type:"RepetitionMandatoryWithSeparator",idx:t.idx,separator:iP(new Qa({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof lm)return{type:"RepetitionWithSeparator",idx:t.idx,separator:iP(new Qa({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof Dc)return{type:"Repetition",idx:t.idx,definition:e(t.definition)};if(t instanceof um)return{type:"Alternation",idx:t.idx,definition:e(t.definition)};if(t instanceof Qa){const n={type:"Terminal",name:t.terminalType.name,label:l4e(t.terminalType),idx:t.idx};Xh(t.label)&&(n.terminalLabel=t.label);const i=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=ty(i)?i.source:i),n}else{if(t instanceof YC)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}}}class $T{visit(e){const n=e;switch(n.constructor){case Jh:return this.visitNonTerminal(n);case Zh:return this.visitAlternative(n);case Gh:return this.visitOption(n);case t0:return this.visitRepetitionMandatory(n);case n0:return this.visitRepetitionMandatoryWithSeparator(n);case lm:return this.visitRepetitionWithSeparator(n);case Dc:return this.visitRepetition(n);case um:return this.visitAlternation(n);case Qa:return this.visitTerminal(n);case YC:return this.visitRule(n);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function d4e(t){return t instanceof Zh||t instanceof Gh||t instanceof Dc||t instanceof t0||t instanceof n0||t instanceof lm||t instanceof Qa||t instanceof YC}function E2(t,e=[]){return t instanceof Gh||t instanceof Dc||t instanceof lm?!0:t instanceof um?O7(t.definition,i=>E2(i,e)):t instanceof Jh&&ih(e,t)?!1:t instanceof e0?(t instanceof Jh&&e.push(t),Qp(t.definition,i=>E2(i,e))):!1}function f4e(t){return t instanceof um}function cg(t){if(t instanceof Jh)return"SUBRULE";if(t instanceof Gh)return"OPTION";if(t instanceof um)return"OR";if(t instanceof t0)return"AT_LEAST_ONE";if(t instanceof n0)return"AT_LEAST_ONE_SEP";if(t instanceof lm)return"MANY_SEP";if(t instanceof Dc)return"MANY";if(t instanceof Qa)return"CONSUME";throw Error("non exhaustive match")}class rB{walk(e,n=[]){Oi(e.definition,(i,r)=>{const s=Ml(e.definition,r+1);if(i instanceof Jh)this.walkProdRef(i,s,n);else if(i instanceof Qa)this.walkTerminal(i,s,n);else if(i instanceof Zh)this.walkFlat(i,s,n);else if(i instanceof Gh)this.walkOption(i,s,n);else if(i instanceof t0)this.walkAtLeastOne(i,s,n);else if(i instanceof n0)this.walkAtLeastOneSep(i,s,n);else if(i instanceof lm)this.walkManySep(i,s,n);else if(i instanceof Dc)this.walkMany(i,s,n);else if(i instanceof um)this.walkOr(i,s,n);else throw Error("non exhaustive match")})}walkTerminal(e,n,i){}walkProdRef(e,n,i){}walkFlat(e,n,i){const r=n.concat(i);this.walk(e,r)}walkOption(e,n,i){const r=n.concat(i);this.walk(e,r)}walkAtLeastOne(e,n,i){const r=[new Gh({definition:e.definition})].concat(n,i);this.walk(e,r)}walkAtLeastOneSep(e,n,i){const r=mQ(e,n,i);this.walk(e,r)}walkMany(e,n,i){const r=[new Gh({definition:e.definition})].concat(n,i);this.walk(e,r)}walkManySep(e,n,i){const r=mQ(e,n,i);this.walk(e,r)}walkOr(e,n,i){const r=n.concat(i);Oi(e.definition,s=>{const a=new Zh({definition:[s]});this.walk(a,r)})}}function mQ(t,e,n){return[new Gh({definition:[new Qa({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}function MN(t){if(t instanceof Jh)return MN(t.referencedRule);if(t instanceof Qa)return g4e(t);if(d4e(t))return p4e(t);if(f4e(t))return m4e(t);throw Error("non exhaustive match")}function p4e(t){let e=[];const n=t.definition;let i=0,r=n.length>i,s,a=!0;for(;r&&a;)s=n[i],a=E2(s),e=e.concat(MN(s)),i=i+1,r=n.length>i;return iB(e)}function m4e(t){const e=Dn(t.definition,n=>MN(n));return iB(Vh(e))}function g4e(t){return[t.terminalType]}const Hhe="_~IN~_";class v4e extends rB{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,n,i){}walkProdRef(e,n,i){const r=_4e(e.referencedRule,e.idx)+this.topProd.name,s=n.concat(i),a=new Zh({definition:s}),o=MN(a);this.follows[r]=o}}function y4e(t){const e={};return Oi(t,n=>{const i=new v4e(n).startWalking();Yh(e,i)}),e}function _4e(t,e){return t.name+e+Hhe}function Pi(t){return t.charCodeAt(0)}function q8(t,e){Array.isArray(t)?t.forEach(function(n){e.push(n)}):e.push(t)}function WR(t,e){if(t[e]===!0)throw"duplicate flag "+e;t[e],t[e]=!0}function i1(t){if(t===void 0)throw Error("Internal Error - Should never get here!");return!0}function b4e(){throw Error("Internal Error - Should never get here!")}function gQ(t){return t.type==="Character"}const S2=[];for(let t=Pi("0");t<=Pi("9");t++)S2.push(t);const T2=[Pi("_")].concat(S2);for(let t=Pi("a");t<=Pi("z");t++)T2.push(t);for(let t=Pi("A");t<=Pi("Z");t++)T2.push(t);const vQ=[Pi(" "),Pi("\f"),Pi(`
`),Pi("\r"),Pi("	"),Pi("\v"),Pi("	"),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi(""),Pi("\u2028"),Pi("\u2029"),Pi(""),Pi(""),Pi(""),Pi("\uFEFF")],E4e=/[0-9a-fA-F]/,Xk=/[0-9]/,S4e=/[1-9]/;class T4e{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const n=this.disjunction();this.consumeChar("/");const i={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":WR(i,"global");break;case"i":WR(i,"ignoreCase");break;case"m":WR(i,"multiLine");break;case"u":WR(i,"unicode");break;case"y":WR(i,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:i,value:n,loc:this.loc(0)}}disjunction(){const e=[],n=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(n)}}alternative(){const e=[],n=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(n)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let n;switch(this.popChar()){case"=":n="Lookahead";break;case"!":n="NegativeLookahead";break}i1(n);const i=this.disjunction();return this.consumeChar(")"),{type:n,value:i,loc:this.loc(e)}}return b4e()}quantifier(e=!1){let n;const i=this.idx;switch(this.popChar()){case"*":n={atLeast:0,atMost:1/0};break;case"+":n={atLeast:1,atMost:1/0};break;case"?":n={atLeast:0,atMost:1};break;case"{":const r=this.integerIncludingZero();switch(this.popChar()){case"}":n={atLeast:r,atMost:r};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),n={atLeast:r,atMost:s}):n={atLeast:r,atMost:1/0},this.consumeChar("}");break}if(e===!0&&n===void 0)return;i1(n);break}if(!(e===!0&&n===void 0)&&i1(n))return this.peekChar(0)==="?"?(this.consumeChar("?"),n.greedy=!1):n.greedy=!0,n.type="Quantifier",n.loc=this.loc(i),n}atom(){let e;const n=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),i1(e))return e.loc=this.loc(n),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[Pi(`
`),Pi("\r"),Pi("\u2028"),Pi("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,n=!1;switch(this.popChar()){case"d":e=S2;break;case"D":e=S2,n=!0;break;case"s":e=vQ;break;case"S":e=vQ,n=!0;break;case"w":e=T2;break;case"W":e=T2,n=!0;break}if(i1(e))return{type:"Set",value:e,complement:n}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=Pi("\f");break;case"n":e=Pi(`
`);break;case"r":e=Pi("\r");break;case"t":e=Pi("	");break;case"v":e=Pi("\v");break}if(i1(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:Pi("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:Pi(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:Pi(e)}}}characterClass(){const e=[];let n=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),n=!0);this.isClassAtom();){const i=this.classAtom();if(i.type,gQ(i)&&this.isRangeDash()){this.consumeChar("-");const r=this.classAtom();if(r.type,gQ(r)){if(r.value<i.value)throw Error("Range out of order in character class");e.push({from:i.value,to:r.value})}else q8(i.value,e),e.push(Pi("-")),q8(r.value,e)}else q8(i.value,e)}return this.consumeChar("]"),{type:"Set",complement:n,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:Pi("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const n=this.disjunction();this.consumeChar(")");const i={type:"Group",capturing:e,value:n};return e&&(i.idx=this.groupIdx),i}positiveInteger(){let e=this.popChar();if(S4e.test(e)===!1)throw Error("Expecting a positive integer");for(;Xk.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(Xk.test(e)===!1)throw Error("Expecting an integer");for(;Xk.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:Pi(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return Xk.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let n="";for(let r=0;r<e;r++){const s=this.popChar();if(E4e.test(s)===!1)throw Error("Expecting a HexDecimal digits");n+=s}return{type:"Character",value:parseInt(n,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class N7{visitChildren(e){for(const n in e){const i=e[n];e.hasOwnProperty(n)&&(i.type!==void 0?this.visit(i):Array.isArray(i)&&i.forEach(r=>{this.visit(r)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let rP={};const x4e=new T4e;function sB(t){const e=t.toString();if(rP.hasOwnProperty(e))return rP[e];{const n=x4e.pattern(e);return rP[e]=n,n}}function w4e(){rP={}}const jhe="Complement Sets are not supported for first char optimization",x2=`Unable to use "first char" lexer optimizations:
`;function C4e(t,e=!1){try{const n=sB(t);return oV(n.value,{},n.flags.ignoreCase)}catch(n){if(n.message===jhe)e&&Bhe(`${x2}	Unable to optimize: < ${t.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let i="";e&&(i=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),aV(`${x2}
	Failed parsing: < ${t.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+i)}}return[]}function oV(t,e,n){switch(t.type){case"Disjunction":for(let r=0;r<t.value.length;r++)oV(t.value[r],e,n);break;case"Alternative":const i=t.value;for(let r=0;r<i.length;r++){const s=i[r];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":Kk(a.value,e,n);break;case"Set":if(a.complement===!0)throw Error(jhe);Oi(a.value,c=>{if(typeof c=="number")Kk(c,e,n);else{const l=c;if(n===!0)for(let u=l.from;u<=l.to;u++)Kk(u,e,n);else{for(let u=l.from;u<=l.to&&u<yA;u++)Kk(u,e,n);if(l.to>=yA){const u=l.from>=yA?l.from:yA,h=l.to,d=xb(u),f=xb(h);for(let p=d;p<=f;p++)e[p]=p}}}});break;case"Group":oV(a.value,e,n);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&cV(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return oc(e)}function Kk(t,e,n){const i=xb(t);e[i]=i,n===!0&&R4e(t,e)}function R4e(t,e){const n=String.fromCharCode(t),i=n.toUpperCase();if(i!==n){const r=xb(i.charCodeAt(0));e[r]=r}else{const r=n.toLowerCase();if(r!==n){const s=xb(r.charCodeAt(0));e[s]=s}}}function yQ(t,e){return iC(t.value,n=>{if(typeof n=="number")return ih(e,n);{const i=n;return iC(e,r=>i.from<=r&&r<=i.to)!==void 0}})}function cV(t){const e=t.quantifier;return e&&e.atLeast===0?!0:t.value?qr(t.value)?Qp(t.value,cV):cV(t.value):!1}class A4e extends N7{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){ih(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?yQ(e,this.targetCharCodes)===void 0&&(this.found=!0):yQ(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function I7(t,e){if(e instanceof RegExp){const n=sB(e),i=new A4e(t);return i.visit(n),i.found}else return iC(e,n=>ih(t,n.charCodeAt(0)))!==void 0}const fT="PATTERN",vA="defaultMode",Jk="modes";let Vhe=typeof new RegExp("(?:)").sticky=="boolean";function M4e(t,e){e=M7(e,{useSticky:Vhe,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(E,T)=>T()});const n=e.tracer;n("initCharCodeToOptimizedIndexMap",()=>{Z4e()});let i;n("Reject Lexer.NA",()=>{i=nB(t,E=>E[fT]===Uc.NA)});let r=!1,s;n("Transform Patterns",()=>{r=!1,s=Dn(i,E=>{const T=E[fT];if(ty(T)){const x=T.source;return x.length===1&&x!=="^"&&x!=="$"&&x!=="."&&!T.ignoreCase?x:x.length===2&&x[0]==="\\"&&!ih(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],x[1])?x[1]:e.useSticky?bQ(T):_Q(T)}else{if(fy(T))return r=!0,{exec:T};if(typeof T=="object")return r=!0,T;if(typeof T=="string"){if(T.length===1)return T;{const x=T.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),N=new RegExp(x);return e.useSticky?bQ(N):_Q(N)}}else throw Error("non exhaustive match")}})});let a,o,c,l,u;n("misc mapping",()=>{a=Dn(i,E=>E.tokenTypeIdx),o=Dn(i,E=>{const T=E.GROUP;if(T!==Uc.SKIPPED){if(Xh(T))return T;if(ny(T))return!1;throw Error("non exhaustive match")}}),c=Dn(i,E=>{const T=E.LONGER_ALT;if(T)return qr(T)?Dn(T,N=>fQ(i,N)):[fQ(i,T)]}),l=Dn(i,E=>E.PUSH_MODE),u=Dn(i,E=>Ei(E,"POP_MODE"))});let h;n("Line Terminator Handling",()=>{const E=$he(e.lineTerminatorCharacters);h=Dn(i,T=>!1),e.positionTracking!=="onlyOffset"&&(h=Dn(i,T=>Ei(T,"LINE_BREAKS")?!!T.LINE_BREAKS:qhe(T,E)===!1&&I7(E,T.PATTERN)))});let d,f,p,g;n("Misc Mapping #2",()=>{d=Dn(i,Ghe),f=Dn(s,X4e),p=Kh(i,(E,T)=>{const x=T.GROUP;return Xh(x)&&x!==Uc.SKIPPED&&(E[x]=[]),E},{}),g=Dn(s,(E,T)=>({pattern:s[T],longerAlt:c[T],canLineTerminator:h[T],isCustom:d[T],short:f[T],group:o[T],push:l[T],pop:u[T],tokenTypeIdx:a[T],tokenType:i[T]}))});let _=!0,v=[];return e.safeMode||n("First Char Optimization",()=>{v=Kh(i,(E,T,x)=>{if(typeof T.PATTERN=="string"){const N=T.PATTERN.charCodeAt(0),A=xb(N);$8(E,A,g[x])}else if(qr(T.START_CHARS_HINT)){let N;Oi(T.START_CHARS_HINT,A=>{const I=typeof A=="string"?A.charCodeAt(0):A,k=xb(I);N!==k&&(N=k,$8(E,k,g[x]))})}else if(ty(T.PATTERN))if(T.PATTERN.unicode)_=!1,e.ensureOptimizations&&aV(`${x2}	Unable to analyze < ${T.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const N=C4e(T.PATTERN,e.ensureOptimizations);ia(N)&&(_=!1),Oi(N,A=>{$8(E,A,g[x])})}else e.ensureOptimizations&&aV(`${x2}	TokenType: <${T.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),_=!1;return E},[])}),{emptyGroups:p,patternIdxToConfig:g,charCodeToPatternIdxToConfig:v,hasCustom:r,canBeOptimized:_}}function O4e(t,e){let n=[];const i=I4e(t);n=n.concat(i.errors);const r=k4e(i.valid),s=r.valid;return n=n.concat(r.errors),n=n.concat(N4e(s)),n=n.concat(H4e(s)),n=n.concat(j4e(s,e)),n=n.concat(V4e(s)),n}function N4e(t){let e=[];const n=lp(t,i=>ty(i[fT]));return e=e.concat(P4e(n)),e=e.concat(B4e(n)),e=e.concat(F4e(n)),e=e.concat(z4e(n)),e=e.concat(L4e(n)),e}function I4e(t){const e=lp(t,r=>!Ei(r,fT)),n=Dn(e,r=>({message:"Token Type: ->"+r.name+"<- missing static 'PATTERN' property",type:So.MISSING_PATTERN,tokenTypes:[r]})),i=tB(t,e);return{errors:n,valid:i}}function k4e(t){const e=lp(t,r=>{const s=r[fT];return!ty(s)&&!fy(s)&&!Ei(s,"exec")&&!Xh(s)}),n=Dn(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:So.INVALID_PATTERN,tokenTypes:[r]})),i=tB(t,e);return{errors:n,valid:i}}const D4e=/[^\\][$]/;function P4e(t){class e extends N7{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const n=lp(t,r=>{const s=r.PATTERN;try{const a=sB(s),o=new e;return o.visit(a),o.found}catch{return D4e.test(s.source)}});return Dn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:So.EOI_ANCHOR_FOUND,tokenTypes:[r]}))}function L4e(t){const e=lp(t,i=>i.PATTERN.test(""));return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' must not match an empty string",type:So.EMPTY_MATCH_PATTERN,tokenTypes:[i]}))}const U4e=/[^\\[][\^]|^\^/;function B4e(t){class e extends N7{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const n=lp(t,r=>{const s=r.PATTERN;try{const a=sB(s),o=new e;return o.visit(a),o.found}catch{return U4e.test(s.source)}});return Dn(n,r=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+r.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:So.SOI_ANCHOR_FOUND,tokenTypes:[r]}))}function F4e(t){const e=lp(t,i=>{const r=i[fT];return r instanceof RegExp&&(r.multiline||r.global)});return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:So.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[i]}))}function z4e(t){const e=[];let n=Dn(t,s=>Kh(t,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!ih(e,o)&&o.PATTERN!==Uc.NA&&(e.push(o),a.push(o)),a),[]));n=AN(n);const i=lp(n,s=>s.length>1);return Dn(i,s=>{const a=Dn(s,c=>c.name);return{message:`The same RegExp pattern ->${im(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:So.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function H4e(t){const e=lp(t,i=>{if(!Ei(i,"GROUP"))return!1;const r=i.GROUP;return r!==Uc.SKIPPED&&r!==Uc.NA&&!Xh(r)});return Dn(e,i=>({message:"Token Type: ->"+i.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:So.INVALID_GROUP_TYPE_FOUND,tokenTypes:[i]}))}function j4e(t,e){const n=lp(t,r=>r.PUSH_MODE!==void 0&&!ih(e,r.PUSH_MODE));return Dn(n,r=>({message:`Token Type: ->${r.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${r.PUSH_MODE}<-which does not exist`,type:So.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[r]}))}function V4e(t){const e=[],n=Kh(t,(i,r,s)=>{const a=r.PATTERN;return a===Uc.NA||(Xh(a)?i.push({str:a,idx:s,tokenType:r}):ty(a)&&q4e(a)&&i.push({str:a.source,idx:s,tokenType:r})),i},[]);return Oi(t,(i,r)=>{Oi(n,({str:s,idx:a,tokenType:o})=>{if(r<a&&G4e(s,i.PATTERN)){const c=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${i.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:c,type:So.UNREACHABLE_PATTERN,tokenTypes:[i,o]})}})}),e}function G4e(t,e){if(ty(e)){const n=e.exec(t);return n!==null&&n.index===0}else{if(fy(e))return e(t,0,[],{});if(Ei(e,"exec"))return e.exec(t,0,[],{});if(typeof e=="string")return e===t;throw Error("non exhaustive match")}}function q4e(t){return iC([".","\\","[","]","|","^","$","(",")","?","*","+","{"],n=>t.source.indexOf(n)!==-1)===void 0}function _Q(t){const e=t.ignoreCase?"i":"";return new RegExp(`^(?:${t.source})`,e)}function bQ(t){const e=t.ignoreCase?"iy":"y";return new RegExp(`${t.source}`,e)}function $4e(t,e,n){const i=[];return Ei(t,vA)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+vA+`> property in its definition
`,type:So.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Ei(t,Jk)||i.push({message:"A MultiMode Lexer cannot be initialized without a <"+Jk+`> property in its definition
`,type:So.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Ei(t,Jk)&&Ei(t,vA)&&!Ei(t.modes,t.defaultMode)&&i.push({message:`A MultiMode Lexer cannot be initialized with a ${vA}: <${t.defaultMode}>which does not exist
`,type:So.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Ei(t,Jk)&&Oi(t.modes,(r,s)=>{Oi(r,(a,o)=>{if(ny(a))i.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:So.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(Ei(a,"LONGER_ALT")){const c=qr(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];Oi(c,l=>{!ny(l)&&!ih(r,l)&&i.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${l.name}> on token <${a.name}> outside of mode <${s}>
`,type:So.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),i}function W4e(t,e,n){const i=[];let r=!1;const s=AN(Vh(oc(t.modes))),a=nB(s,c=>c[fT]===Uc.NA),o=$he(n);return e&&Oi(a,c=>{const l=qhe(c,o);if(l!==!1){const h={message:J4e(c,l),type:l.issue,tokenType:c};i.push(h)}else Ei(c,"LINE_BREAKS")?c.LINE_BREAKS===!0&&(r=!0):I7(o,c.PATTERN)&&(r=!0)}),e&&!r&&i.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:So.NO_LINE_BREAKS_FLAGS}),i}function Y4e(t){const e={},n=ip(t);return Oi(n,i=>{const r=t[i];if(qr(r))e[i]=[];else throw Error("non exhaustive match")}),e}function Ghe(t){const e=t.PATTERN;if(ty(e))return!1;if(fy(e))return!0;if(Ei(e,"exec"))return!0;if(Xh(e))return!1;throw Error("non exhaustive match")}function X4e(t){return Xh(t)&&t.length===1?t.charCodeAt(0):!1}const K4e={test:function(t){const e=t.length;for(let n=this.lastIndex;n<e;n++){const i=t.charCodeAt(n);if(i===10)return this.lastIndex=n+1,!0;if(i===13)return t.charCodeAt(n+1)===10?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function qhe(t,e){if(Ei(t,"LINE_BREAKS"))return!1;if(ty(t.PATTERN)){try{I7(e,t.PATTERN)}catch(n){return{issue:So.IDENTIFY_TERMINATOR,errMsg:n.message}}return!1}else{if(Xh(t.PATTERN))return!1;if(Ghe(t))return{issue:So.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function J4e(t,e){if(e.issue===So.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${t.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===So.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${t.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function $he(t){return Dn(t,n=>Xh(n)?n.charCodeAt(0):n)}function $8(t,e,n){t[e]===void 0?t[e]=[n]:t[e].push(n)}const yA=256;let sP=[];function xb(t){return t<yA?t:sP[t]}function Z4e(){if(ia(sP)){sP=new Array(65536);for(let t=0;t<65536;t++)sP[t]=t>255?255+~~(t/255):t}}function ON(t,e){const n=t.tokenTypeIdx;return n===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[n]===!0}function w2(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}let EQ=1;const Whe={};function NN(t){const e=Q4e(t);e6e(e),n6e(e),t6e(e),Oi(e,n=>{n.isParent=n.categoryMatches.length>0})}function Q4e(t){let e=Bl(t),n=t,i=!0;for(;i;){n=AN(Vh(Dn(n,s=>s.CATEGORIES)));const r=tB(n,e);e=e.concat(r),ia(r)?i=!1:n=r}return e}function e6e(t){Oi(t,e=>{Xhe(e)||(Whe[EQ]=e,e.tokenTypeIdx=EQ++),SQ(e)&&!qr(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),SQ(e)||(e.CATEGORIES=[]),i6e(e)||(e.categoryMatches=[]),r6e(e)||(e.categoryMatchesMap={})})}function t6e(t){Oi(t,e=>{e.categoryMatches=[],Oi(e.categoryMatchesMap,(n,i)=>{e.categoryMatches.push(Whe[i].tokenTypeIdx)})})}function n6e(t){Oi(t,e=>{Yhe([],e)})}function Yhe(t,e){Oi(t,n=>{e.categoryMatchesMap[n.tokenTypeIdx]=!0}),Oi(e.CATEGORIES,n=>{const i=t.concat(e);ih(i,n)||Yhe(i,n)})}function Xhe(t){return Ei(t,"tokenTypeIdx")}function SQ(t){return Ei(t,"CATEGORIES")}function i6e(t){return Ei(t,"categoryMatches")}function r6e(t){return Ei(t,"categoryMatchesMap")}function s6e(t){return Ei(t,"tokenTypeIdx")}const a6e={buildUnableToPopLexerModeMessage(t){return`Unable to pop Lexer Mode after encountering Token ->${t.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(t,e,n,i,r){return`unexpected character: ->${t.charAt(e)}<- at offset: ${e}, skipped ${n} characters.`}};var So;(function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",t[t.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(So||(So={}));const _A={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:a6e,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(_A);let Uc=class{constructor(e,n=_A){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(r,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${r}>`);const{time:o,value:c}=Fhe(s),l=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&l(`${a}<-- <${r}> time: ${o}ms`),this.traceInitIndent--,c}else return s()},typeof n=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Yh({},_A,n);const i=this.config.traceInitPerf;i===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof i=="number"&&(this.traceInitMaxIdent=i,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let r,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===_A.lineTerminatorsPattern)this.config.lineTerminatorsPattern=K4e;else if(this.config.lineTerminatorCharacters===_A.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(n.safeMode&&n.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),qr(e)?r={modes:{defaultMode:Bl(e)},defaultMode:vA}:(s=!1,r=Bl(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat($4e(r,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(W4e(r,this.trackStartLines,this.config.lineTerminatorCharacters))})),r.modes=r.modes?r.modes:{},Oi(r.modes,(o,c)=>{r.modes[c]=nB(o,l=>ny(l))});const a=ip(r.modes);if(Oi(r.modes,(o,c)=>{this.TRACE_INIT(`Mode: <${c}> processing`,()=>{if(this.modes.push(c),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(O4e(o,a))}),ia(this.lexerDefinitionErrors)){NN(o);let l;this.TRACE_INIT("analyzeTokenTypes",()=>{l=M4e(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:n.positionTracking,ensureOptimizations:n.ensureOptimizations,safeMode:n.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[c]=l.patternIdxToConfig,this.charCodeToPatternIdxToConfig[c]=l.charCodeToPatternIdxToConfig,this.emptyGroups=Yh({},this.emptyGroups,l.emptyGroups),this.hasCustom=l.hasCustom||this.hasCustom,this.canModeBeOptimized[c]=l.canBeOptimized}})}),this.defaultMode=r.defaultMode,!ia(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const c=Dn(this.lexerDefinitionErrors,l=>l.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+c)}Oi(this.lexerDefinitionWarning,o=>{Bhe(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(Vhe?(this.chopInput=eC,this.match=this.matchWithTest):(this.updateLastIndex=Rc,this.match=this.matchWithExec),s&&(this.handleModes=Rc),this.trackStartLines===!1&&(this.computeNewColumn=eC),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=Rc),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=Kh(this.canModeBeOptimized,(c,l,u)=>(l===!1&&c.push(u),c),[]);if(n.ensureOptimizations&&!ia(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{w4e()}),this.TRACE_INIT("toFastProperties",()=>{zhe(this)})})}tokenize(e,n=this.defaultMode){if(!ia(this.lexerDefinitionErrors)){const r=Dn(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+r)}return this.tokenizeInternal(e,n)}tokenizeInternal(e,n){let i,r,s,a,o,c,l,u,h,d,f,p,g,_,v;const E=e,T=E.length;let x=0,N=0;const A=this.hasCustom?0:Math.floor(e.length/10),I=new Array(A),k=[];let L=this.trackStartLines?1:void 0,U=this.trackStartLines?1:void 0;const $=Y4e(this.emptyGroups),q=this.trackStartLines,G=this.config.lineTerminatorsPattern;let X=0,ie=[],V=[];const Z=[],Y=[];Object.freeze(Y);let ee;function oe(){return ie}function de(we){const Ce=xb(we),ke=V[Ce];return ke===void 0?Y:ke}const Me=we=>{if(Z.length===1&&we.tokenType.PUSH_MODE===void 0){const Ce=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(we);k.push({offset:we.startOffset,line:we.startLine,column:we.startColumn,length:we.image.length,message:Ce})}else{Z.pop();const Ce=nC(Z);ie=this.patternIdxToConfig[Ce],V=this.charCodeToPatternIdxToConfig[Ce],X=ie.length;const ke=this.canModeBeOptimized[Ce]&&this.config.safeMode===!1;V&&ke?ee=de:ee=oe}};function He(we){Z.push(we),V=this.charCodeToPatternIdxToConfig[we],ie=this.patternIdxToConfig[we],X=ie.length,X=ie.length;const Ce=this.canModeBeOptimized[we]&&this.config.safeMode===!1;V&&Ce?ee=de:ee=oe}He.call(this,n);let Te;const Le=this.config.recoveryEnabled;for(;x<T;){c=null;const we=E.charCodeAt(x),Ce=ee(we),ke=Ce.length;for(i=0;i<ke;i++){Te=Ce[i];const St=Te.pattern;l=null;const At=Te.short;if(At!==!1?we===At&&(c=St):Te.isCustom===!0?(v=St.exec(E,x,I,$),v!==null?(c=v[0],v.payload!==void 0&&(l=v.payload)):c=null):(this.updateLastIndex(St,x),c=this.match(St,e,x)),c!==null){if(o=Te.longerAlt,o!==void 0){const Ee=o.length;for(s=0;s<Ee;s++){const ye=ie[o[s]],et=ye.pattern;if(u=null,ye.isCustom===!0?(v=et.exec(E,x,I,$),v!==null?(a=v[0],v.payload!==void 0&&(u=v.payload)):a=null):(this.updateLastIndex(et,x),a=this.match(et,e,x)),a&&a.length>c.length){c=a,l=u,Te=ye;break}}}break}}if(c!==null){if(h=c.length,d=Te.group,d!==void 0&&(f=Te.tokenTypeIdx,p=this.createTokenInstance(c,x,f,Te.tokenType,L,U,h),this.handlePayload(p,l),d===!1?N=this.addToken(I,N,p):$[d].push(p)),e=this.chopInput(e,h),x=x+h,U=this.computeNewColumn(U,h),q===!0&&Te.canLineTerminator===!0){let St=0,At,Ee;G.lastIndex=0;do At=G.test(c),At===!0&&(Ee=G.lastIndex-1,St++);while(At===!0);St!==0&&(L=L+St,U=h-Ee,this.updateTokenEndLineColumnLocation(p,d,Ee,St,L,U,h))}this.handleModes(Te,Me,He,p)}else{const St=x,At=L,Ee=U;let ye=Le===!1;for(;ye===!1&&x<T;)for(e=this.chopInput(e,1),x++,r=0;r<X;r++){const et=ie[r],fe=et.pattern,Fe=et.short;if(Fe!==!1?E.charCodeAt(x)===Fe&&(ye=!0):et.isCustom===!0?ye=fe.exec(E,x,I,$)!==null:(this.updateLastIndex(fe,x),ye=fe.exec(e)!==null),ye===!0)break}if(g=x-St,U=this.computeNewColumn(U,g),_=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(E,St,g,At,Ee),k.push({offset:St,line:At,column:Ee,length:g,message:_}),Le===!1)break}}return this.hasCustom||(I.length=N),{tokens:I,groups:$,errors:k}}handleModes(e,n,i,r){if(e.pop===!0){const s=e.push;n(r),s!==void 0&&i.call(this,s)}else e.push!==void 0&&i.call(this,e.push)}chopInput(e,n){return e.substring(n)}updateLastIndex(e,n){e.lastIndex=n}updateTokenEndLineColumnLocation(e,n,i,r,s,a,o){let c,l;n!==void 0&&(c=i===o-1,l=c?-1:0,r===1&&c===!0||(e.endLine=s+l,e.endColumn=a-1+-l))}computeNewColumn(e,n){return e+n}createOffsetOnlyToken(e,n,i,r){return{image:e,startOffset:n,tokenTypeIdx:i,tokenType:r}}createStartOnlyToken(e,n,i,r,s,a){return{image:e,startOffset:n,startLine:s,startColumn:a,tokenTypeIdx:i,tokenType:r}}createFullToken(e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:n+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:i,tokenType:r}}addTokenUsingPush(e,n,i){return e.push(i),n}addTokenUsingMemberAccess(e,n,i){return e[n]=i,n++,n}handlePayloadNoCustom(e,n){}handlePayloadWithCustom(e,n){n!==null&&(e.payload=n)}matchWithTest(e,n,i){return e.test(n)===!0?n.substring(i,e.lastIndex):null}matchWithExec(e,n){const i=e.exec(n);return i!==null?i[0]:null}};Uc.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Uc.NA=/NOT_APPLICABLE/;function QA(t){return Khe(t)?t.LABEL:t.name}function Khe(t){return Xh(t.LABEL)&&t.LABEL!==""}const o6e="parent",TQ="categories",xQ="label",wQ="group",CQ="push_mode",RQ="pop_mode",AQ="longer_alt",MQ="line_breaks",OQ="start_chars_hint";function Xd(t){return c6e(t)}function c6e(t){const e=t.pattern,n={};if(n.name=t.name,ny(e)||(n.PATTERN=e),Ei(t,o6e))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return Ei(t,TQ)&&(n.CATEGORIES=t[TQ]),NN([n]),Ei(t,xQ)&&(n.LABEL=t[xQ]),Ei(t,wQ)&&(n.GROUP=t[wQ]),Ei(t,RQ)&&(n.POP_MODE=t[RQ]),Ei(t,CQ)&&(n.PUSH_MODE=t[CQ]),Ei(t,AQ)&&(n.LONGER_ALT=t[AQ]),Ei(t,MQ)&&(n.LINE_BREAKS=t[MQ]),Ei(t,OQ)&&(n.START_CHARS_HINT=t[OQ]),n}const pT=Xd({name:"EOF",pattern:Uc.NA});NN([pT]);function IN(t,e,n,i,r,s,a,o){return{image:e,startOffset:n,endOffset:i,startLine:r,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function l6e(t,e){return ON(t,e)}const Jhe={buildMismatchTokenMessage({expected:t,actual:e,previous:n,ruleName:i}){return`Expecting ${Khe(t)?`--> ${QA(t)} <--`:`token of type --> ${t.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:t,ruleName:e}){return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage({expectedPathsPerAlt:t,actual:e,previous:n,customUserDescription:i,ruleName:r}){const s="Expecting: ",o=`
but found: '`+im(e).image+"'";if(i)return s+i+o;{const c=Kh(t,(d,f)=>d.concat(f),[]),l=Dn(c,d=>`[${Dn(d,f=>QA(f)).join(", ")}]`),h=`one of these possible Token sequences:
${Dn(l,(d,f)=>`  ${f+1}. ${d}`).join(`
`)}`;return s+h+o}},buildEarlyExitMessage({expectedIterationPaths:t,actual:e,customUserDescription:n,ruleName:i}){const r="Expecting: ",a=`
but found: '`+im(e).image+"'";if(n)return r+n+a;{const c=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Dn(t,l=>`[${Dn(l,u=>QA(u)).join(",")}]`).join(" ,")}>`;return r+c+a}}};Object.freeze(Jhe);const u6e={buildRuleNotFoundError(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+t.name+"<-"}},kS={buildDuplicateFoundError(t,e){function n(u){return u instanceof Qa?u.terminalType.name:u instanceof Jh?u.nonTerminalName:""}const i=t.name,r=im(e),s=r.idx,a=cg(r),o=n(r),c=s>0;let l=`->${a}${c?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${i}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return l=l.replace(/[ \t]+/g," "),l=l.replace(/\s\s+/g,`
`),l},buildNamespaceConflictError(t){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${t.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(t){const e=Dn(t.prefixPath,r=>QA(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;return`Ambiguous alternatives: <${t.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(t){const e=Dn(t.prefixPath,r=>QA(r)).join(", "),n=t.alternation.idx===0?"":t.alternation.idx;let i=`Ambiguous Alternatives Detected: <${t.ambiguityIndices.join(" ,")}> in <OR${n}> inside <${t.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return i=i+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,i},buildEmptyRepetitionError(t){let e=cg(t.repetition);return t.repetition.idx!==0&&(e+=t.repetition.idx),`The repetition <${e}> within Rule <${t.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(t){return"deprecated"},buildEmptyAlternationError(t){return`Ambiguous empty alternative: <${t.emptyChoiceIdx+1}> in <OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(t){return`An Alternation cannot have more than 256 alternatives:
<OR${t.alternation.idx}> inside <${t.topLevelRule.name}> Rule.
 has ${t.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(t){const e=t.topLevelRule.name,n=Dn(t.leftRecursionPath,s=>s.name),i=`${e} --> ${n.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${i}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(t){return"deprecated"},buildDuplicateRuleNameError(t){let e;return t.topLevelRule instanceof YC?e=t.topLevelRule.name:e=t.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${t.grammarName}<-`}};function h6e(t,e){const n=new d6e(t,e);return n.resolveRefs(),n.errors}class d6e extends $T{constructor(e,n){super(),this.nameToTopRule=e,this.errMsgProvider=n,this.errors=[]}resolveRefs(){Oi(oc(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const n=this.nameToTopRule[e.nonTerminalName];if(n)e.referencedRule=n;else{const i=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:i,type:Qu.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class f6e extends rB{constructor(e,n){super(),this.topProd=e,this.path=n,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Bl(this.path.ruleStack).reverse(),this.occurrenceStack=Bl(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,n=[]){this.found||super.walk(e,n)}walkProdRef(e,n,i){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const r=n.concat(i);this.updateExpectedNext(),this.walk(e.referencedRule,r)}}updateExpectedNext(){ia(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class p6e extends f6e{constructor(e,n){super(e,n),this.path=n,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,n,i){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const r=n.concat(i),s=new Zh({definition:r});this.possibleTokTypes=MN(s),this.found=!0}}}class aB extends rB{constructor(e,n){super(),this.topRule=e,this.occurrence=n,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class m6e extends aB{walkMany(e,n,i){if(e.idx===this.occurrence){const r=im(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof Qa&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkMany(e,n,i)}}class NQ extends aB{walkManySep(e,n,i){if(e.idx===this.occurrence){const r=im(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof Qa&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkManySep(e,n,i)}}class g6e extends aB{walkAtLeastOne(e,n,i){if(e.idx===this.occurrence){const r=im(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof Qa&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOne(e,n,i)}}class IQ extends aB{walkAtLeastOneSep(e,n,i){if(e.idx===this.occurrence){const r=im(n.concat(i));this.result.isEndOfRule=r===void 0,r instanceof Qa&&(this.result.token=r.terminalType,this.result.occurrence=r.idx)}else super.walkAtLeastOneSep(e,n,i)}}function lV(t,e,n=[]){n=Bl(n);let i=[],r=0;function s(o){return o.concat(Ml(t,r+1))}function a(o){const c=lV(s(o),e,n);return i.concat(c)}for(;n.length<e&&r<t.length;){const o=t[r];if(o instanceof Zh)return a(o.definition);if(o instanceof Jh)return a(o.definition);if(o instanceof Gh)i=a(o.definition);else if(o instanceof t0){const c=o.definition.concat([new Dc({definition:o.definition})]);return a(c)}else if(o instanceof n0){const c=[new Zh({definition:o.definition}),new Dc({definition:[new Qa({terminalType:o.separator})].concat(o.definition)})];return a(c)}else if(o instanceof lm){const c=o.definition.concat([new Dc({definition:[new Qa({terminalType:o.separator})].concat(o.definition)})]);i=a(c)}else if(o instanceof Dc){const c=o.definition.concat([new Dc({definition:o.definition})]);i=a(c)}else{if(o instanceof um)return Oi(o.definition,c=>{ia(c.definition)===!1&&(i=a(c.definition))}),i;if(o instanceof Qa)n.push(o.terminalType);else throw Error("non exhaustive match")}r++}return i.push({partialPath:n,suffixDef:Ml(t,r)}),i}function Zhe(t,e,n,i){const r="EXIT_NONE_TERMINAL",s=[r],a="EXIT_ALTERNATIVE";let o=!1;const c=e.length,l=c-i-1,u=[],h=[];for(h.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!ia(h);){const d=h.pop();if(d===a){o&&nC(h).idx<=l&&h.pop();continue}const f=d.def,p=d.idx,g=d.ruleStack,_=d.occurrenceStack;if(ia(f))continue;const v=f[0];if(v===r){const E={idx:p,def:Ml(f),ruleStack:eO(g),occurrenceStack:eO(_)};h.push(E)}else if(v instanceof Qa)if(p<c-1){const E=p+1,T=e[E];if(n(T,v.terminalType)){const x={idx:E,def:Ml(f),ruleStack:g,occurrenceStack:_};h.push(x)}}else if(p===c-1)u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:g,occurrenceStack:_}),o=!0;else throw Error("non exhaustive match");else if(v instanceof Jh){const E=Bl(g);E.push(v.nonTerminalName);const T=Bl(_);T.push(v.idx);const x={idx:p,def:v.definition.concat(s,Ml(f)),ruleStack:E,occurrenceStack:T};h.push(x)}else if(v instanceof Gh){const E={idx:p,def:Ml(f),ruleStack:g,occurrenceStack:_};h.push(E),h.push(a);const T={idx:p,def:v.definition.concat(Ml(f)),ruleStack:g,occurrenceStack:_};h.push(T)}else if(v instanceof t0){const E=new Dc({definition:v.definition,idx:v.idx}),T=v.definition.concat([E],Ml(f)),x={idx:p,def:T,ruleStack:g,occurrenceStack:_};h.push(x)}else if(v instanceof n0){const E=new Qa({terminalType:v.separator}),T=new Dc({definition:[E].concat(v.definition),idx:v.idx}),x=v.definition.concat([T],Ml(f)),N={idx:p,def:x,ruleStack:g,occurrenceStack:_};h.push(N)}else if(v instanceof lm){const E={idx:p,def:Ml(f),ruleStack:g,occurrenceStack:_};h.push(E),h.push(a);const T=new Qa({terminalType:v.separator}),x=new Dc({definition:[T].concat(v.definition),idx:v.idx}),N=v.definition.concat([x],Ml(f)),A={idx:p,def:N,ruleStack:g,occurrenceStack:_};h.push(A)}else if(v instanceof Dc){const E={idx:p,def:Ml(f),ruleStack:g,occurrenceStack:_};h.push(E),h.push(a);const T=new Dc({definition:v.definition,idx:v.idx}),x=v.definition.concat([T],Ml(f)),N={idx:p,def:x,ruleStack:g,occurrenceStack:_};h.push(N)}else if(v instanceof um)for(let E=v.definition.length-1;E>=0;E--){const T=v.definition[E],x={idx:p,def:T.definition.concat(Ml(f)),ruleStack:g,occurrenceStack:_};h.push(x),h.push(a)}else if(v instanceof Zh)h.push({idx:p,def:v.definition.concat(Ml(f)),ruleStack:g,occurrenceStack:_});else if(v instanceof YC)h.push(v6e(v,p,g,_));else throw Error("non exhaustive match")}return u}function v6e(t,e,n,i){const r=Bl(n);r.push(t.name);const s=Bl(i);return s.push(1),{idx:e,def:t.definition,ruleStack:r,occurrenceStack:s}}var yo;(function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"})(yo||(yo={}));function Qhe(t){if(t instanceof Gh||t==="Option")return yo.OPTION;if(t instanceof Dc||t==="Repetition")return yo.REPETITION;if(t instanceof t0||t==="RepetitionMandatory")return yo.REPETITION_MANDATORY;if(t instanceof n0||t==="RepetitionMandatoryWithSeparator")return yo.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof lm||t==="RepetitionWithSeparator")return yo.REPETITION_WITH_SEPARATOR;if(t instanceof um||t==="Alternation")return yo.ALTERNATION;throw Error("non exhaustive match")}function y6e(t,e,n,i,r,s){const a=k7(t,e,n),o=nde(a)?w2:ON;return s(a,i,o,r)}function _6e(t,e,n,i,r,s){const a=D7(t,e,r,n),o=nde(a)?w2:ON;return s(a[0],o,i)}function b6e(t,e,n,i){const r=t.length,s=Qp(t,a=>Qp(a,o=>o.length===1));if(e)return function(a){const o=Dn(a,c=>c.GATE);for(let c=0;c<r;c++){const l=t[c],u=l.length,h=o[c];if(!(h!==void 0&&h.call(this)===!1))e:for(let d=0;d<u;d++){const f=l[d],p=f.length;for(let g=0;g<p;g++){const _=this.LA(g+1);if(n(_,f[g])===!1)continue e}return c}}};if(s&&!i){const a=Dn(t,c=>Vh(c)),o=Kh(a,(c,l,u)=>(Oi(l,h=>{Ei(c,h.tokenTypeIdx)||(c[h.tokenTypeIdx]=u),Oi(h.categoryMatches,d=>{Ei(c,d)||(c[d]=u)})}),c),{});return function(){const c=this.LA(1);return o[c.tokenTypeIdx]}}else return function(){for(let a=0;a<r;a++){const o=t[a],c=o.length;e:for(let l=0;l<c;l++){const u=o[l],h=u.length;for(let d=0;d<h;d++){const f=this.LA(d+1);if(n(f,u[d])===!1)continue e}return a}}}}function E6e(t,e,n){const i=Qp(t,s=>s.length===1),r=t.length;if(i&&!n){const s=Vh(t);if(s.length===1&&ia(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=Kh(s,(o,c,l)=>(o[c.tokenTypeIdx]=!0,Oi(c.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<r;s++){const a=t[s],o=a.length;for(let c=0;c<o;c++){const l=this.LA(c+1);if(e(l,a[c])===!1)continue e}return!0}return!1}}class S6e extends rB{constructor(e,n,i){super(),this.topProd=e,this.targetOccurrence=n,this.targetProdType=i}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,n,i,r){return e.idx===this.targetOccurrence&&this.targetProdType===n?(this.restDef=i.concat(r),!0):!1}walkOption(e,n,i){this.checkIsTarget(e,yo.OPTION,n,i)||super.walkOption(e,n,i)}walkAtLeastOne(e,n,i){this.checkIsTarget(e,yo.REPETITION_MANDATORY,n,i)||super.walkOption(e,n,i)}walkAtLeastOneSep(e,n,i){this.checkIsTarget(e,yo.REPETITION_MANDATORY_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}walkMany(e,n,i){this.checkIsTarget(e,yo.REPETITION,n,i)||super.walkOption(e,n,i)}walkManySep(e,n,i){this.checkIsTarget(e,yo.REPETITION_WITH_SEPARATOR,n,i)||super.walkOption(e,n,i)}}class ede extends $T{constructor(e,n,i){super(),this.targetOccurrence=e,this.targetProdType=n,this.targetRef=i,this.result=[]}checkIsTarget(e,n){e.idx===this.targetOccurrence&&this.targetProdType===n&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,yo.OPTION)}visitRepetition(e){this.checkIsTarget(e,yo.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,yo.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,yo.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,yo.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,yo.ALTERNATION)}}function kQ(t){const e=new Array(t);for(let n=0;n<t;n++)e[n]=[];return e}function W8(t){let e=[""];for(let n=0;n<t.length;n++){const i=t[n],r=[];for(let s=0;s<e.length;s++){const a=e[s];r.push(a+"_"+i.tokenTypeIdx);for(let o=0;o<i.categoryMatches.length;o++){const c="_"+i.categoryMatches[o];r.push(a+c)}}e=r}return e}function T6e(t,e,n){for(let i=0;i<t.length;i++){if(i===n)continue;const r=t[i];for(let s=0;s<e.length;s++){const a=e[s];if(r[a]===!0)return!1}}return!0}function tde(t,e){const n=Dn(t,a=>lV([a],1)),i=kQ(n.length),r=Dn(n,a=>{const o={};return Oi(a,c=>{const l=W8(c.partialPath);Oi(l,u=>{o[u]=!0})}),o});let s=n;for(let a=1;a<=e;a++){const o=s;s=kQ(o.length);for(let c=0;c<o.length;c++){const l=o[c];for(let u=0;u<l.length;u++){const h=l[u].partialPath,d=l[u].suffixDef,f=W8(h);if(T6e(r,f,c)||ia(d)||h.length===e){const g=i[c];if(uV(g,h)===!1){g.push(h);for(let _=0;_<f.length;_++){const v=f[_];r[c][v]=!0}}}else{const g=lV(d,a+1,h);s[c]=s[c].concat(g),Oi(g,_=>{const v=W8(_.partialPath);Oi(v,E=>{r[c][E]=!0})})}}}}return i}function k7(t,e,n,i){const r=new ede(t,yo.ALTERNATION,i);return e.accept(r),tde(r.result,n)}function D7(t,e,n,i){const r=new ede(t,n);e.accept(r);const s=r.result,o=new S6e(e,t,n).startWalking(),c=new Zh({definition:s}),l=new Zh({definition:o});return tde([c,l],i)}function uV(t,e){e:for(let n=0;n<t.length;n++){const i=t[n];if(i.length===e.length){for(let r=0;r<i.length;r++){const s=e[r],a=i[r];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function x6e(t,e){return t.length<e.length&&Qp(t,(n,i)=>{const r=e[i];return n===r||r.categoryMatchesMap[n.tokenTypeIdx]})}function nde(t){return Qp(t,e=>Qp(e,n=>Qp(n,i=>ia(i.categoryMatches))))}function w6e(t){const e=t.lookaheadStrategy.validate({rules:t.rules,tokenTypes:t.tokenTypes,grammarName:t.grammarName});return Dn(e,n=>Object.assign({type:Qu.CUSTOM_LOOKAHEAD_VALIDATION},n))}function C6e(t,e,n,i){const r=Kf(t,c=>R6e(c,n)),s=F6e(t,e,n),a=Kf(t,c=>P6e(c,n)),o=Kf(t,c=>O6e(c,t,i,n));return r.concat(s,a,o)}function R6e(t,e){const n=new M6e;t.accept(n);const i=n.allProductions,r=Uhe(i,A6e),s=cm(r,o=>o.length>1);return Dn(oc(s),o=>{const c=im(o),l=e.buildDuplicateFoundError(t,o),u=cg(c),h={message:l,type:Qu.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:u,occurrence:c.idx},d=ide(c);return d&&(h.parameter=d),h})}function A6e(t){return`${cg(t)}_#_${t.idx}_#_${ide(t)}`}function ide(t){return t instanceof Qa?t.terminalType.name:t instanceof Jh?t.nonTerminalName:""}class M6e extends $T{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function O6e(t,e,n,i){const r=[];if(Kh(e,(a,o)=>o.name===t.name?a+1:a,0)>1){const a=i.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});r.push({message:a,type:Qu.DUPLICATE_RULE_NAME,ruleName:t.name})}return r}function N6e(t,e,n){const i=[];let r;return ih(e,t)||(r=`Invalid rule override, rule: ->${t}<- cannot be overridden in the grammar: ->${n}<-as it is not defined in any of the super grammars `,i.push({message:r,type:Qu.INVALID_RULE_OVERRIDE,ruleName:t})),i}function rde(t,e,n,i=[]){const r=[],s=aP(e.definition);if(ia(s))return[];{const a=t.name;ih(s,t)&&r.push({message:n.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:i}),type:Qu.LEFT_RECURSION,ruleName:a});const c=tB(s,i.concat([t])),l=Kf(c,u=>{const h=Bl(i);return h.push(u),rde(t,u,n,h)});return r.concat(l)}}function aP(t){let e=[];if(ia(t))return e;const n=im(t);if(n instanceof Jh)e.push(n.referencedRule);else if(n instanceof Zh||n instanceof Gh||n instanceof t0||n instanceof n0||n instanceof lm||n instanceof Dc)e=e.concat(aP(n.definition));else if(n instanceof um)e=Vh(Dn(n.definition,s=>aP(s.definition)));else if(!(n instanceof Qa))throw Error("non exhaustive match");const i=E2(n),r=t.length>1;if(i&&r){const s=Ml(t);return e.concat(aP(s))}else return e}class P7 extends $T{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function I6e(t,e){const n=new P7;t.accept(n);const i=n.alternations;return Kf(i,s=>{const a=eO(s.definition);return Kf(a,(o,c)=>{const l=Zhe([o],[],ON,1);return ia(l)?[{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:s,emptyChoiceIdx:c}),type:Qu.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:s.idx,alternative:c+1}]:[]})})}function k6e(t,e,n){const i=new P7;t.accept(i);let r=i.alternations;return r=nB(r,a=>a.ignoreAmbiguities===!0),Kf(r,a=>{const o=a.idx,c=a.maxLookahead||e,l=k7(o,t,c,a),u=U6e(l,a,t,n),h=B6e(l,a,t,n);return u.concat(h)})}class D6e extends $T{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function P6e(t,e){const n=new P7;t.accept(n);const i=n.alternations;return Kf(i,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:s}),type:Qu.TOO_MANY_ALTS,ruleName:t.name,occurrence:s.idx}]:[])}function L6e(t,e,n){const i=[];return Oi(t,r=>{const s=new D6e;r.accept(s);const a=s.allProductions;Oi(a,o=>{const c=Qhe(o),l=o.maxLookahead||e,u=o.idx,d=D7(u,r,c,l)[0];if(ia(Vh(d))){const f=n.buildEmptyRepetitionError({topLevelRule:r,repetition:o});i.push({message:f,type:Qu.NO_NON_EMPTY_LOOKAHEAD,ruleName:r.name})}})}),i}function U6e(t,e,n,i){const r=[],s=Kh(t,(o,c,l)=>(e.definition[l].ignoreAmbiguities===!0||Oi(c,u=>{const h=[l];Oi(t,(d,f)=>{l!==f&&uV(d,u)&&e.definition[f].ignoreAmbiguities!==!0&&h.push(f)}),h.length>1&&!uV(r,u)&&(r.push(u),o.push({alts:h,path:u}))}),o),[]);return Dn(s,o=>{const c=Dn(o.alts,u=>u+1);return{message:i.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:c,prefixPath:o.path}),type:Qu.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:o.alts}})}function B6e(t,e,n,i){const r=Kh(t,(a,o,c)=>{const l=Dn(o,u=>({idx:c,path:u}));return a.concat(l)},[]);return AN(Kf(r,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const c=a.idx,l=a.path,u=lp(r,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<c&&x6e(d.path,l));return Dn(u,d=>{const f=[d.idx+1,c+1],p=e.idx===0?"":e.idx;return{message:i.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:f,prefixPath:d.path}),type:Qu.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:p,alternatives:f}})}))}function F6e(t,e,n){const i=[],r=Dn(e,s=>s.name);return Oi(t,s=>{const a=s.name;if(ih(r,a)){const o=n.buildNamespaceConflictError(s);i.push({message:o,type:Qu.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),i}function z6e(t){const e=M7(t,{errMsgProvider:u6e}),n={};return Oi(t.rules,i=>{n[i.name]=i}),h6e(n,e.errMsgProvider)}function H6e(t){return t=M7(t,{errMsgProvider:kS}),C6e(t.rules,t.tokenTypes,t.errMsgProvider,t.grammarName)}const sde="MismatchedTokenException",ade="NoViableAltException",ode="EarlyExitException",cde="NotAllInputParsedException",lde=[sde,ade,ode,cde];Object.freeze(lde);function C2(t){return ih(lde,t.name)}class oB extends Error{constructor(e,n){super(e),this.token=n,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class ude extends oB{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=sde}}class j6e extends oB{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=ade}}class V6e extends oB{constructor(e,n){super(e,n),this.name=cde}}class G6e extends oB{constructor(e,n,i){super(e,n),this.previousToken=i,this.name=ode}}const Y8={},hde="InRuleRecoveryException";class q6e extends Error{constructor(e){super(e),this.name=hde}}class $6e{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Ei(e,"recoveryEnabled")?e.recoveryEnabled:iy.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=W6e)}getTokenToInsert(e){const n=IN(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return n.isInsertedInRecovery=!0,n}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,n,i,r){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let c=!1;const l=this.LA(1);let u=this.LA(1);const h=()=>{const d=this.LA(0),f=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:l,previous:d,ruleName:this.getCurrRuleFullName()}),p=new ude(f,l,this.LA(0));p.resyncedTokens=eO(o),this.SAVE_ERROR(p)};for(;!c;)if(this.tokenMatcher(u,r)){h();return}else if(i.call(this)){h(),e.apply(this,n);return}else this.tokenMatcher(u,s)?c=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,n,i){return!(i===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,n)))}getFollowsForInRuleRecovery(e,n){const i=this.getCurrentGrammarPath(e,n);return this.getNextPossibleTokenTypes(i)}tryInRuleRecovery(e,n){if(this.canRecoverWithSingleTokenInsertion(e,n))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const i=this.SKIP_TOKEN();return this.consumeToken(),i}throw new q6e("sad sad panda")}canPerformInRuleRecovery(e,n){return this.canRecoverWithSingleTokenInsertion(e,n)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,n){if(!this.canTokenTypeBeInsertedInRecovery(e)||ia(n))return!1;const i=this.LA(1);return iC(n,s=>this.tokenMatcher(i,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const n=this.getCurrFollowKey(),i=this.getFollowSetFromFollowKey(n);return ih(i,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let n=this.LA(1),i=2;for(;;){const r=iC(e,s=>l6e(n,s));if(r!==void 0)return r;n=this.LA(i),i++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return Y8;const e=this.getLastExplicitRuleShortName(),n=this.getLastExplicitRuleOccurrenceIndex(),i=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:n,inRule:this.shortRuleNameToFullName(i)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Dn(e,(i,r)=>r===0?Y8:{ruleName:this.shortRuleNameToFullName(i),idxInCallingRule:n[r],inRule:this.shortRuleNameToFullName(e[r-1])})}flattenFollowSet(){const e=Dn(this.buildFullFollowKeyStack(),n=>this.getFollowSetFromFollowKey(n));return Vh(e)}getFollowSetFromFollowKey(e){if(e===Y8)return[pT];const n=e.ruleName+e.idxInCallingRule+Hhe+e.inRule;return this.resyncFollows[n]}addToResyncTokens(e,n){return this.tokenMatcher(e,pT)||n.push(e),n}reSyncTo(e){const n=[];let i=this.LA(1);for(;this.tokenMatcher(i,e)===!1;)i=this.SKIP_TOKEN(),this.addToResyncTokens(i,n);return eO(n)}attemptInRepetitionRecovery(e,n,i,r,s,a,o){}getCurrentGrammarPath(e,n){const i=this.getHumanReadableRuleStack(),r=Bl(this.RULE_OCCURRENCE_STACK);return{ruleStack:i,occurrenceStack:r,lastTok:e,lastTokOccurrence:n}}getHumanReadableRuleStack(){return Dn(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function W6e(t,e,n,i,r,s,a){const o=this.getKeyForAutomaticLookahead(i,r);let c=this.firstAfterRepMap[o];if(c===void 0){const d=this.getCurrRuleFullName(),f=this.getGAstProductions()[d];c=new s(f,r).startWalking(),this.firstAfterRepMap[o]=c}let l=c.token,u=c.occurrence;const h=c.isEndOfRule;this.RULE_STACK.length===1&&h&&l===void 0&&(l=pT,u=1),!(l===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(l,u,a)&&this.tryInRepetitionRecovery(t,e,n,l)}const Y6e=4,Xb=8,dde=1<<Xb,fde=2<<Xb,hV=3<<Xb,dV=4<<Xb,fV=5<<Xb,oP=6<<Xb;function X8(t,e,n){return n|e|t}class X6e{constructor(e){var n;this.maxLookahead=(n=e==null?void 0:e.maxLookahead)!==null&&n!==void 0?n:iy.maxLookahead}validate(e){const n=this.validateNoLeftRecursion(e.rules);if(ia(n)){const i=this.validateEmptyOrAlternatives(e.rules),r=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...n,...i,...r,...s]}return n}validateNoLeftRecursion(e){return Kf(e,n=>rde(n,n,kS))}validateEmptyOrAlternatives(e){return Kf(e,n=>I6e(n,kS))}validateAmbiguousAlternationAlternatives(e,n){return Kf(e,i=>k6e(i,n,kS))}validateSomeNonEmptyLookaheadPath(e,n){return L6e(e,n,kS)}buildLookaheadForAlternation(e){return y6e(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,b6e)}buildLookaheadForOptional(e){return _6e(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,Qhe(e.prodType),E6e)}}class K6e{initLooksAhead(e){this.dynamicTokensEnabled=Ei(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:iy.dynamicTokensEnabled,this.maxLookahead=Ei(e,"maxLookahead")?e.maxLookahead:iy.maxLookahead,this.lookaheadStrategy=Ei(e,"lookaheadStrategy")?e.lookaheadStrategy:new X6e({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){Oi(e,n=>{this.TRACE_INIT(`${n.name} Rule Lookahead`,()=>{const{alternation:i,repetition:r,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:c}=Z6e(n);Oi(i,l=>{const u=l.idx===0?"":l.idx;this.TRACE_INIT(`${cg(l)}${u}`,()=>{const h=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:l.idx,rule:n,maxLookahead:l.maxLookahead||this.maxLookahead,hasPredicates:l.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=X8(this.fullRuleNameToShort[n.name],dde,l.idx);this.setLaFuncCache(d,h)})}),Oi(r,l=>{this.computeLookaheadFunc(n,l.idx,hV,"Repetition",l.maxLookahead,cg(l))}),Oi(s,l=>{this.computeLookaheadFunc(n,l.idx,fde,"Option",l.maxLookahead,cg(l))}),Oi(a,l=>{this.computeLookaheadFunc(n,l.idx,dV,"RepetitionMandatory",l.maxLookahead,cg(l))}),Oi(o,l=>{this.computeLookaheadFunc(n,l.idx,oP,"RepetitionMandatoryWithSeparator",l.maxLookahead,cg(l))}),Oi(c,l=>{this.computeLookaheadFunc(n,l.idx,fV,"RepetitionWithSeparator",l.maxLookahead,cg(l))})})})}computeLookaheadFunc(e,n,i,r,s,a){this.TRACE_INIT(`${a}${n===0?"":n}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:n,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r}),c=X8(this.fullRuleNameToShort[e.name],i,n);this.setLaFuncCache(c,o)})}getKeyForAutomaticLookahead(e,n){const i=this.getLastExplicitRuleShortName();return X8(i,e,n)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,n){this.lookAheadFuncsCache.set(e,n)}}class J6e extends $T{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const Zk=new J6e;function Z6e(t){Zk.reset(),t.accept(Zk);const e=Zk.dslMethods;return Zk.reset(),e}function DQ(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset)}function PQ(t,e){isNaN(t.startOffset)===!0?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function Q6e(t,e,n){t.children[n]===void 0?t.children[n]=[e]:t.children[n].push(e)}function eze(t,e,n){t.children[e]===void 0?t.children[e]=[n]:t.children[e].push(n)}const tze="name";function pde(t,e){Object.defineProperty(t,tze,{enumerable:!1,configurable:!0,writable:!1,value:e})}function nze(t,e){const n=ip(t),i=n.length;for(let r=0;r<i;r++){const s=n[r],a=t[s],o=a.length;for(let c=0;c<o;c++){const l=a[c];l.tokenTypeIdx===void 0&&this[l.name](l.children,e)}}}function ize(t,e){const n=function(){};pde(n,t+"BaseSemantics");const i={visit:function(r,s){if(qr(r)&&(r=r[0]),!ny(r))return this[r.name](r.children,s)},validateVisitor:function(){const r=sze(this,e);if(!ia(r)){const s=Dn(r,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return n.prototype=i,n.prototype.constructor=n,n._RULE_NAMES=e,n}function rze(t,e,n){const i=function(){};pde(i,t+"BaseSemanticsWithDefaults");const r=Object.create(n.prototype);return Oi(e,s=>{r[s]=nze}),i.prototype=r,i.prototype.constructor=i,i}var pV;(function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"})(pV||(pV={}));function sze(t,e){return aze(t,e)}function aze(t,e){const n=lp(e,r=>fy(t[r])===!1),i=Dn(n,r=>({msg:`Missing visitor method: <${r}> on ${t.constructor.name} CST Visitor.`,type:pV.MISSING_METHOD,methodName:r}));return AN(i)}class oze{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=Ei(e,"nodeLocationTracking")?e.nodeLocationTracking:iy.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=Rc,this.cstFinallyStateUpdate=Rc,this.cstPostTerminal=Rc,this.cstPostNonTerminal=Rc,this.cstPostRule=Rc;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=PQ,this.setNodeLocationFromNode=PQ,this.cstPostRule=Rc,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=Rc,this.setNodeLocationFromNode=Rc,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=DQ,this.setNodeLocationFromNode=DQ,this.cstPostRule=Rc,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=Rc,this.setNodeLocationFromNode=Rc,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=Rc,this.setNodeLocationFromNode=Rc,this.cstPostRule=Rc,this.setInitialNodeLocation=Rc;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const n=this.LA(1);e.location={startOffset:n.startOffset,startLine:n.startLine,startColumn:n.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const n={name:e,children:Object.create(null)};this.setInitialNodeLocation(n),this.CST_STACK.push(n)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?(i.endOffset=n.endOffset,i.endLine=n.endLine,i.endColumn=n.endColumn):(i.startOffset=NaN,i.startLine=NaN,i.startColumn=NaN)}cstPostRuleOnlyOffset(e){const n=this.LA(0),i=e.location;i.startOffset<=n.startOffset?i.endOffset=n.endOffset:i.startOffset=NaN}cstPostTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];Q6e(i,n,e),this.setNodeLocationFromToken(i.location,n)}cstPostNonTerminal(e,n){const i=this.CST_STACK[this.CST_STACK.length-1];eze(i,n,e),this.setNodeLocationFromNode(i.location,e.location)}getBaseCstVisitorConstructor(){if(ny(this.baseCstVisitorConstructor)){const e=ize(this.className,ip(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(ny(this.baseCstVisitorWithDefaultsConstructor)){const e=rze(this.className,ip(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class cze{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):A2}LA(e){const n=this.currIdx+e;return n<0||this.tokVectorLength<=n?A2:this.tokVector[n]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class lze{ACTION(e){return e.call(this)}consume(e,n,i){return this.consumeInternal(n,e,i)}subrule(e,n,i){return this.subruleInternal(n,e,i)}option(e,n){return this.optionInternal(n,e)}or(e,n){return this.orInternal(n,e)}many(e,n){return this.manyInternal(e,n)}atLeastOne(e,n){return this.atLeastOneInternal(e,n)}CONSUME(e,n){return this.consumeInternal(e,0,n)}CONSUME1(e,n){return this.consumeInternal(e,1,n)}CONSUME2(e,n){return this.consumeInternal(e,2,n)}CONSUME3(e,n){return this.consumeInternal(e,3,n)}CONSUME4(e,n){return this.consumeInternal(e,4,n)}CONSUME5(e,n){return this.consumeInternal(e,5,n)}CONSUME6(e,n){return this.consumeInternal(e,6,n)}CONSUME7(e,n){return this.consumeInternal(e,7,n)}CONSUME8(e,n){return this.consumeInternal(e,8,n)}CONSUME9(e,n){return this.consumeInternal(e,9,n)}SUBRULE(e,n){return this.subruleInternal(e,0,n)}SUBRULE1(e,n){return this.subruleInternal(e,1,n)}SUBRULE2(e,n){return this.subruleInternal(e,2,n)}SUBRULE3(e,n){return this.subruleInternal(e,3,n)}SUBRULE4(e,n){return this.subruleInternal(e,4,n)}SUBRULE5(e,n){return this.subruleInternal(e,5,n)}SUBRULE6(e,n){return this.subruleInternal(e,6,n)}SUBRULE7(e,n){return this.subruleInternal(e,7,n)}SUBRULE8(e,n){return this.subruleInternal(e,8,n)}SUBRULE9(e,n){return this.subruleInternal(e,9,n)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,n,i=M2){if(ih(this.definedRulesNames,e)){const a={message:kS.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:Qu.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const r=this.defineRule(e,n,i);return this[e]=r,r}OVERRIDE_RULE(e,n,i=M2){const r=N6e(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const s=this.defineRule(e,n,i);return this[e]=s,s}BACKTRACK(e,n){return function(){this.isBackTrackingStack.push(1);const i=this.saveRecogState();try{return e.apply(this,n),!0}catch(r){if(C2(r))return!1;throw r}finally{this.reloadRecogState(i),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return h4e(oc(this.gastProductionsCache))}}class uze{initRecognizerEngine(e,n){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=w2,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Ei(n,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(qr(e)){if(ia(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(qr(e))this.tokensMap=Kh(e,(s,a)=>(s[a.name]=a,s),{});else if(Ei(e,"modes")&&Qp(Vh(oc(e.modes)),s6e)){const s=Vh(oc(e.modes)),a=iB(s);this.tokensMap=Kh(a,(o,c)=>(o[c.name]=c,o),{})}else if(np(e))this.tokensMap=Bl(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=pT;const i=Ei(e,"modes")?Vh(oc(e.modes)):oc(e),r=Qp(i,s=>ia(s.categoryMatches));this.tokenMatcher=r?w2:ON,NN(oc(this.tokensMap))}defineRule(e,n,i){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const r=Ei(i,"resyncEnabled")?i.resyncEnabled:M2.resyncEnabled,s=Ei(i,"recoveryValueFunc")?i.recoveryValueFunc:M2.recoveryValueFunc,a=this.ruleShortNameIdx<<Y6e+Xb;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u);const h=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(h),h}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),n.apply(this,u)}catch(h){return this.invokeRuleCatch(h,r,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:n})}invokeRuleCatch(e,n,i){const r=this.RULE_STACK.length===1,s=n&&!this.isBackTracking()&&this.recoveryEnabled;if(C2(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];return c.recoveredNode=!0,c}else return i(e);else{if(this.outputCst){const c=this.CST_STACK[this.CST_STACK.length-1];c.recoveredNode=!0,a.partialCstResult=c}throw a}}else{if(r)return this.moveToTerminatedState(),i(e);throw a}}else throw e}optionInternal(e,n){const i=this.getKeyForAutomaticLookahead(fde,n);return this.optionInternalLogic(e,n,i)}optionInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=e;if(r.call(this)===!0)return s.call(this)}atLeastOneInternal(e,n){const i=this.getKeyForAutomaticLookahead(dV,e);return this.atLeastOneInternalLogic(e,n,i)}atLeastOneInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const a=n.GATE;if(a!==void 0){const o=r;r=()=>a.call(this)&&o.call(this)}}else s=n;if(r.call(this)===!0){let a=this.doSingleRepetition(s);for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,yo.REPETITION_MANDATORY,n.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,n],r,dV,e,g6e)}atLeastOneSepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(oP,e);this.atLeastOneSepFirstInternalLogic(e,n,i)}atLeastOneSepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,IQ],o,oP,e,IQ)}else throw this.raiseEarlyExitException(e,yo.REPETITION_MANDATORY_WITH_SEPARATOR,n.ERR_MSG)}manyInternal(e,n){const i=this.getKeyForAutomaticLookahead(hV,e);return this.manyInternalLogic(e,n,i)}manyInternalLogic(e,n,i){let r=this.getLaFuncFromCache(i),s;if(typeof n!="function"){s=n.DEF;const o=n.GATE;if(o!==void 0){const c=r;r=()=>o.call(this)&&c.call(this)}}else s=n;let a=!0;for(;r.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,n],r,hV,e,m6e,a)}manySepFirstInternal(e,n){const i=this.getKeyForAutomaticLookahead(fV,e);this.manySepFirstInternalLogic(e,n,i)}manySepFirstInternalLogic(e,n,i){const r=n.DEF,s=n.SEP;if(this.getLaFuncFromCache(i).call(this)===!0){r.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,r,NQ],o,fV,e,NQ)}}repetitionSepSecondInternal(e,n,i,r,s){for(;i();)this.CONSUME(n),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,n,i,r,s],i,oP,e,s)}doSingleRepetition(e){const n=this.getLexerPosition();return e.call(this),this.getLexerPosition()>n}orInternal(e,n){const i=this.getKeyForAutomaticLookahead(dde,n),r=qr(e)?e:e.DEF,a=this.getLaFuncFromCache(i).call(this,r);if(a!==void 0)return r[a].ALT.call(this);this.raiseNoAltException(n,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),n=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new V6e(n,e))}}subruleInternal(e,n,i){let r;try{const s=i!==void 0?i.ARGS:void 0;return this.subruleIdx=n,r=e.apply(this,s),this.cstPostNonTerminal(r,i!==void 0&&i.LABEL!==void 0?i.LABEL:e.ruleName),r}catch(s){throw this.subruleInternalError(s,i,e.ruleName)}}subruleInternalError(e,n,i){throw C2(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,n!==void 0&&n.LABEL!==void 0?n.LABEL:i),delete e.partialCstResult),e}consumeInternal(e,n,i){let r;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),r=s):this.consumeInternalError(e,s,i)}catch(s){r=this.consumeInternalRecovery(e,n,s)}return this.cstPostTerminal(i!==void 0&&i.LABEL!==void 0?i.LABEL:e.name,r),r}consumeInternalError(e,n,i){let r;const s=this.LA(0);throw i!==void 0&&i.ERR_MSG?r=i.ERR_MSG:r=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:n,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new ude(r,n,s))}consumeInternalRecovery(e,n,i){if(this.recoveryEnabled&&i.name==="MismatchedTokenException"&&!this.isBackTracking()){const r=this.getFollowsForInRuleRecovery(e,n);try{return this.tryInRuleRecovery(e,r)}catch(s){throw s.name===hde?i:s}}else throw i}saveRecogState(){const e=this.errors,n=Bl(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:n,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,n,i){this.RULE_OCCURRENCE_STACK.push(i),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(n)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),pT)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class hze{initErrorHandler(e){this._errors=[],this.errorMessageProvider=Ei(e,"errorMessageProvider")?e.errorMessageProvider:iy.errorMessageProvider}SAVE_ERROR(e){if(C2(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Bl(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Bl(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,n,i){const r=this.getCurrRuleFullName(),s=this.getGAstProductions()[r],o=D7(e,s,n,this.maxLookahead)[0],c=[];for(let u=1;u<=this.maxLookahead;u++)c.push(this.LA(u));const l=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:c,previous:this.LA(0),customUserDescription:i,ruleName:r});throw this.SAVE_ERROR(new G6e(l,this.LA(1),this.LA(0)))}raiseNoAltException(e,n){const i=this.getCurrRuleFullName(),r=this.getGAstProductions()[i],s=k7(e,r,this.maxLookahead),a=[];for(let l=1;l<=this.maxLookahead;l++)a.push(this.LA(l));const o=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:n,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new j6e(c,this.LA(1),o))}}class dze{initContentAssist(){}computeContentAssist(e,n){const i=this.gastProductionsCache[e];if(ny(i))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return Zhe([i],n,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const n=im(e.ruleStack),r=this.getGAstProductions()[n];return new p6e(r,e).startWalking()}}const cB={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(cB);const LQ=!0,UQ=Math.pow(2,Xb)-1,mde=Xd({name:"RECORDING_PHASE_TOKEN",pattern:Uc.NA});NN([mde]);const gde=IN(mde,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(gde);const fze={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class pze{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const n=e>0?e:"";this[`CONSUME${n}`]=function(i,r){return this.consumeInternalRecord(i,e,r)},this[`SUBRULE${n}`]=function(i,r){return this.subruleInternalRecord(i,e,r)},this[`OPTION${n}`]=function(i){return this.optionInternalRecord(i,e)},this[`OR${n}`]=function(i){return this.orInternalRecord(i,e)},this[`MANY${n}`]=function(i){this.manyInternalRecord(e,i)},this[`MANY_SEP${n}`]=function(i){this.manySepFirstInternalRecord(e,i)},this[`AT_LEAST_ONE${n}`]=function(i){this.atLeastOneInternalRecord(e,i)},this[`AT_LEAST_ONE_SEP${n}`]=function(i){this.atLeastOneSepFirstInternalRecord(e,i)}}this.consume=function(e,n,i){return this.consumeInternalRecord(n,e,i)},this.subrule=function(e,n,i){return this.subruleInternalRecord(n,e,i)},this.option=function(e,n){return this.optionInternalRecord(n,e)},this.or=function(e,n){return this.orInternalRecord(n,e)},this.many=function(e,n){this.manyInternalRecord(e,n)},this.atLeastOne=function(e,n){this.atLeastOneInternalRecord(e,n)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let n=0;n<10;n++){const i=n>0?n:"";delete e[`CONSUME${i}`],delete e[`SUBRULE${i}`],delete e[`OPTION${i}`],delete e[`OR${i}`],delete e[`MANY${i}`],delete e[`MANY_SEP${i}`],delete e[`AT_LEAST_ONE${i}`],delete e[`AT_LEAST_ONE_SEP${i}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,n){return()=>!0}LA_RECORD(e){return A2}topLevelRuleRecord(e,n){try{const i=new YC({definition:[],name:e});return i.name=e,this.recordingProdStack.push(i),n.call(this),this.recordingProdStack.pop(),i}catch(i){if(i.KNOWN_RECORDER_ERROR!==!0)try{i.message=i.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw i}throw i}}optionInternalRecord(e,n){return YR.call(this,Gh,e,n)}atLeastOneInternalRecord(e,n){YR.call(this,t0,n,e)}atLeastOneSepFirstInternalRecord(e,n){YR.call(this,n0,n,e,LQ)}manyInternalRecord(e,n){YR.call(this,Dc,n,e)}manySepFirstInternalRecord(e,n){YR.call(this,lm,n,e,LQ)}orInternalRecord(e,n){return mze.call(this,e,n)}subruleInternalRecord(e,n,i){if(R2(n),!e||Ei(e,"ruleName")===!1){const o=new Error(`<SUBRULE${BQ(n)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const r=nC(this.recordingProdStack),s=e.ruleName,a=new Jh({idx:n,nonTerminalName:s,label:i==null?void 0:i.LABEL,referencedRule:void 0});return r.definition.push(a),this.outputCst?fze:cB}consumeInternalRecord(e,n,i){if(R2(n),!Xhe(e)){const a=new Error(`<CONSUME${BQ(n)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const r=nC(this.recordingProdStack),s=new Qa({idx:n,terminalType:e,label:i==null?void 0:i.LABEL});return r.definition.push(s),gde}}function YR(t,e,n,i=!1){R2(n);const r=nC(this.recordingProdStack),s=fy(e)?e:e.DEF,a=new t({definition:[],idx:n});return i&&(a.separator=e.SEP),Ei(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),r.definition.push(a),this.recordingProdStack.pop(),cB}function mze(t,e){R2(e);const n=nC(this.recordingProdStack),i=qr(t)===!1,r=i===!1?t:t.DEF,s=new um({definition:[],idx:e,ignoreAmbiguities:i&&t.IGNORE_AMBIGUITIES===!0});Ei(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD);const a=O7(r,o=>fy(o.GATE));return s.hasPredicates=a,n.definition.push(s),Oi(r,o=>{const c=new Zh({definition:[]});s.definition.push(c),Ei(o,"IGNORE_AMBIGUITIES")?c.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:Ei(o,"GATE")&&(c.ignoreAmbiguities=!0),this.recordingProdStack.push(c),o.ALT.call(this),this.recordingProdStack.pop()}),cB}function BQ(t){return t===0?"":`${t}`}function R2(t){if(t<0||t>UQ){const e=new Error(`Invalid DSL Method idx value: <${t}>
	Idx value must be a none negative value smaller than ${UQ+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class gze{initPerformanceTracer(e){if(Ei(e,"traceInitPerf")){const n=e.traceInitPerf,i=typeof n=="number";this.traceInitMaxIdent=i?n:1/0,this.traceInitPerf=i?n>0:n}else this.traceInitMaxIdent=0,this.traceInitPerf=iy.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,n){if(this.traceInitPerf===!0){this.traceInitIndent++;const i=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${i}--> <${e}>`);const{time:r,value:s}=Fhe(n),a=r>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${i}<-- <${e}> time: ${r}ms`),this.traceInitIndent--,s}else return n()}}function vze(t,e){e.forEach(n=>{const i=n.prototype;Object.getOwnPropertyNames(i).forEach(r=>{if(r==="constructor")return;const s=Object.getOwnPropertyDescriptor(i,r);s&&(s.get||s.set)?Object.defineProperty(t.prototype,r,s):t.prototype[r]=n.prototype[r]})})}const A2=IN(pT,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(A2);const iy=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:Jhe,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),M2=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Qu;(function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",t[t.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Qu||(Qu={}));let L7=class vde{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const n=this.className;this.TRACE_INIT("toFastProps",()=>{zhe(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),Oi(this.definedRulesNames,r=>{const a=this[r].originalGrammarAction;let o;this.TRACE_INIT(`${r} Rule`,()=>{o=this.topLevelRuleRecord(r,a)}),this.gastProductionsCache[r]=o})}finally{this.disableRecording()}});let i=[];if(this.TRACE_INIT("Grammar Resolving",()=>{i=z6e({rules:oc(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(i)}),this.TRACE_INIT("Grammar Validations",()=>{if(ia(i)&&this.skipValidations===!1){const r=H6e({rules:oc(this.gastProductionsCache),tokenTypes:oc(this.tokensMap),errMsgProvider:kS,grammarName:n}),s=w6e({lookaheadStrategy:this.lookaheadStrategy,rules:oc(this.gastProductionsCache),tokenTypes:oc(this.tokensMap),grammarName:n});this.definitionErrors=this.definitionErrors.concat(r,s)}}),ia(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const r=y4e(oc(this.gastProductionsCache));this.resyncFollows=r}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var r,s;(s=(r=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(r,{rules:oc(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(oc(this.gastProductionsCache))})),!vde.DEFER_DEFINITION_ERRORS_HANDLING&&!ia(this.definitionErrors))throw e=Dn(this.definitionErrors,r=>r.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,n){this.definitionErrors=[],this.selfAnalysisDone=!1;const i=this;if(i.initErrorHandler(n),i.initLexerAdapter(),i.initLooksAhead(n),i.initRecognizerEngine(e,n),i.initRecoverable(n),i.initTreeBuilder(n),i.initContentAssist(),i.initGastRecorder(n),i.initPerformanceTracer(n),Ei(n,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=Ei(n,"skipValidations")?n.skipValidations:iy.skipValidations}};L7.DEFER_DEFINITION_ERRORS_HANDLING=!1;vze(L7,[$6e,K6e,oze,cze,uze,lze,hze,dze,pze,gze]);class yze extends L7{constructor(e,n=iy){const i=Bl(n);i.outputCst=!0,super(e,i)}}function _ze(t){const e=new bze,n=oc(t);return Dn(n,i=>e.visitRule(i))}class bze extends $T{visitRule(e){const n=this.visitEach(e.definition),i=Uhe(n,s=>s.propertyName),r=Dn(i,(s,a)=>{const o=!O7(s,l=>!l.canBeNull);let c=s[0].type;return s.length>1&&(c=Dn(s,l=>l.type)),{name:a,type:c,optional:o}});return{name:e.name,properties:r}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:Qk(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:Qk(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:Qk(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:Qk(e)}]}visitEachAndOverrideWith(e,n){return Dn(this.visitEach(e),i=>Yh({},i,n))}visitEach(e){return Vh(Dn(e,n=>this.visit(n)))}}function Qk(t){return t instanceof Jh?{kind:"rule",name:t.referencedRule.name}:{kind:"token"}}function Eze(t,e){let n=[];return n=n.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),n=n.concat(Vh(Dn(t,i=>Sze(i)))),e.includeVisitorInterface&&(n=n.concat(Cze(e.visitorInterfaceName,t))),n.join(`

`)+`
`}function Sze(t){const e=Tze(t),n=xze(t);return[e,n]}function Tze(t){const e=yde(t.name),n=U7(t.name);return`export interface ${e} extends CstNode {
  name: "${t.name}";
  children: ${n};
}`}function xze(t){return`export type ${U7(t.name)} = {
  ${Dn(t.properties,n=>wze(n)).join(`
  `)}
};`}function wze(t){const e=Aze(t.type);return`${t.name}${t.optional?"?":""}: ${e}[];`}function Cze(t,e){return`export interface ${t}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${Dn(e,n=>Rze(n)).join(`
  `)}
}`}function Rze(t){const e=U7(t.name);return`${t.name}(children: ${e}, param?: IN): OUT;`}function Aze(t){if(qr(t)){const e=iB(Dn(t,i=>FQ(i)));return"("+Kh(e,(i,r)=>i+" | "+r)+")"}else return FQ(t)}function FQ(t){return t.kind==="token"?"IToken":yde(t.name)}function yde(t){return The(t)+"CstNode"}function U7(t){return The(t)+"CstChildren"}const Mze={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function Oze(t,e){const n=Object.assign(Object.assign({},Mze),e),i=_ze(t);return Eze(i,n)}const Bg=!!JSON.parse("false"),Nze=!!JSON.parse("false"),Ize=!!JSON.parse("false"),kze=!!JSON.parse("false");JSON.parse("false");const Dze=!!JSON.parse("false"),Pze=!!JSON.parse("false"),Lze=!!JSON.parse("false"),kn={HALT_AT_COUNT:256,DRAW_CHAR_SCALE:2,DRAW_CHAR_WIDTH(){return Cg*kn.DRAW_CHAR_SCALE},DRAW_CHAR_HEIGHT(){return Rg*kn.DRAW_CHAR_SCALE}};function B7(t,e,n){typeof t!="number"&&(t=0,e=0,n=1),typeof e!="number"&&(e=t,t=0,n=1),typeof n!="number"&&(n=1);const i=[],r=Math.min(t,e),s=Math.max(t,e);for(let a=r;a<=s;a+=n)i.push(a);return i}function Uze(t){return t[Uf(0,t.length-1)]}function Bze(t,e){return e[wue(t,0,e.length-1)]}function Xa(...t){return Uze(t.flat())}function _de(t,...e){return Bze(t,e.flat())}function Fze(t){return[...new Set(t)].filter(ae)}function zze(t,e){return t%e}function Hze(t,e){return Math.floor(t/e)}function zQ(t,e){return{x:zze(t,e),y:Hze(t,e)}}function mT(t,e){return t.x+t.y*e}function E_(t,e,n,i,r,s){return t>=s&&t<=i&&e>=n&&e<=r}function HQ(t,e,n,i){const r=[],s=Math.abs(n-t),a=Math.abs(i-e),o=t<n?1:-1,c=e<i?1:-1;let l=s-a;for(r.push({x:t,y:e});t!==n||e!==i;){const u=2*l;u>-a&&(l-=a,t+=o),u<s&&(l+=s,e+=c),r.push({x:t,y:e})}return r}const jze=66.666,F7=Math.round(1e3/jze),Vze=3;function zp(t){return new Promise(e=>setTimeout(e,t))}function rC(t){return ae(t)&&ae(t.x)&&ae(t.y)}function ic(t,e){switch(e){case rn.NORTH:--t.y;break;case rn.SOUTH:++t.y;break;case rn.WEST:--t.x;break;case rn.EAST:++t.x;break}return t}function Ev(t,e){const n=e.x-t.x,i=e.y-t.y;if(n<0)return rn.WEST;if(n>0)return rn.EAST;if(i<0)return rn.NORTH;if(i>0)return rn.SOUTH}const bde={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",player:"PLAYER",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST"};function gT(t){return Li(t)&&Ede(t[0])}function Ede(t){return ae(rn[t])&&On(t)}function Gze(t){const e=rn[t];return ae(e)?e:rn.IDLE}function z7(t){if(On(t))return bde[ai(t)]}function qze(t){if(gT(t))return t;if(Ede(t))return[t];const e=z7(t);if(ae(e))return[e]}function jQ(t){const e=ne.words[t],n=qze(e);return gT(n)?[n,t+1]:[void 0,t]}function Sde(t){var r,s;const e=[];let[n,i]=jQ(t);for(;gT(n);){switch(e.push(...n),n[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[c,l,u]=Ot(ne.words,i,[st.NUMBER,st.NUMBER]);e.push(c,l),i=u;break}case"FLEE":case"FIND":{const[c,l]=Ot(ne.words,i,[st.DIR]);e.push(c.x,c.y),i=l;break}case"TO":{const[c,l,u]=Ot(ne.words,i,[st.DIR,st.DIR]),h=((r=ne.element)==null?void 0:r.x)??0,d=((s=ne.element)==null?void 0:s.y)??0;c.x-=h,c.y-=d,l.x-=h,l.y-=d,e.push(h+c.x+l.x,d+c.y+l.y),i=u;break}}switch(n[0]){case"CW":case"CCW":case"OPP":case"RNDP":break;default:return[e,i]}const[a,o]=jQ(i);n=a,i=o}return e.length?[e,i]:[void 0,t]}function sC(t){return Li(t)&&typeof t[0]=="string"}function $ze(t){const e=ne.words[t];return On(e)?[e,t+1]:[void 0,t]}function VQ(t){const e=ne.words[t];if(sC(e))return[e,t+1];const[n,i]=XW(t),[r,s]=$ze(i);return On(r)?[[r,n],s]:[void 0,t]}function mV(t){if(!sC(t))return;const[e]=t;return e}function Tde(t){if(!sC(t))return;const[,e]=t,n=ae(e)?$Ge(e):void 0;return ae(n)?n:void 0}function xde(t){if(!sC(t))return;const[,e]=t,n=ae(e)?WGe(e):void 0;return ae(n)?n:void 0}var qc={},lB={};lB.byteLength=Xze;lB.toByteArray=Jze;lB.fromByteArray=e8e;var dg=[],Tf=[],Wze=typeof Uint8Array<"u"?Uint8Array:Array,K8="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var r1=0,Yze=K8.length;r1<Yze;++r1)dg[r1]=K8[r1],Tf[K8.charCodeAt(r1)]=r1;Tf[45]=62;Tf[95]=63;function wde(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var i=n===e?0:4-n%4;return[n,i]}function Xze(t){var e=wde(t),n=e[0],i=e[1];return(n+i)*3/4-i}function Kze(t,e,n){return(e+n)*3/4-n}function Jze(t){var e,n=wde(t),i=n[0],r=n[1],s=new Wze(Kze(t,i,r)),a=0,o=r>0?i-4:i,c;for(c=0;c<o;c+=4)e=Tf[t.charCodeAt(c)]<<18|Tf[t.charCodeAt(c+1)]<<12|Tf[t.charCodeAt(c+2)]<<6|Tf[t.charCodeAt(c+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return r===2&&(e=Tf[t.charCodeAt(c)]<<2|Tf[t.charCodeAt(c+1)]>>4,s[a++]=e&255),r===1&&(e=Tf[t.charCodeAt(c)]<<10|Tf[t.charCodeAt(c+1)]<<4|Tf[t.charCodeAt(c+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function Zze(t){return dg[t>>18&63]+dg[t>>12&63]+dg[t>>6&63]+dg[t&63]}function Qze(t,e,n){for(var i,r=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(t[s+2]&255),r.push(Zze(i));return r.join("")}function e8e(t){for(var e,n=t.length,i=n%3,r=[],s=16383,a=0,o=n-i;a<o;a+=s)r.push(Qze(t,a,a+s>o?o:a+s));return i===1?(e=t[n-1],r.push(dg[e>>2]+dg[e<<4&63]+"==")):i===2&&(e=(t[n-2]<<8)+t[n-1],r.push(dg[e>>10]+dg[e>>4&63]+dg[e<<2&63]+"=")),r.join("")}var H7={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */H7.read=function(t,e,n,i,r){var s,a,o=r*8-i-1,c=(1<<o)-1,l=c>>1,u=-7,h=n?r-1:0,d=n?-1:1,f=t[e+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=o;u>0;s=s*256+t[e+h],h+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=i;u>0;a=a*256+t[e+h],h+=d,u-=8);if(s===0)s=1-l;else{if(s===c)return a?NaN:(f?-1:1)*(1/0);a=a+Math.pow(2,i),s=s-l}return(f?-1:1)*a*Math.pow(2,s-i)};H7.write=function(t,e,n,i,r,s){var a,o,c,l=s*8-r-1,u=(1<<l)-1,h=u>>1,d=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:s-1,p=i?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),a+h>=1?e+=d/c:e+=d*Math.pow(2,1-h),e*c>=2&&(a++,c/=2),a+h>=u?(o=0,a=u):a+h>=1?(o=(e*c-1)*Math.pow(2,r),a=a+h):(o=e*Math.pow(2,h-1)*Math.pow(2,r),a=0));r>=8;t[n+f]=o&255,f+=p,o/=256,r-=8);for(a=a<<r|o,l+=r;l>0;t[n+f]=a&255,f+=p,a/=256,l-=8);t[n+f-p]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=lB,n=H7,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=N,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=c(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function c(){try{const ce=new s(1),j={foo:function(){return 42}};return Object.setPrototypeOf(j,s.prototype),Object.setPrototypeOf(ce,j),ce.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function l(ce){if(ce>r)throw new RangeError('The value "'+ce+'" is invalid for option "size"');const j=new s(ce);return Object.setPrototypeOf(j,u.prototype),j}function u(ce,j,W){if(typeof ce=="number"){if(typeof j=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(ce)}return h(ce,j,W)}u.poolSize=8192;function h(ce,j,W){if(typeof ce=="string")return g(ce,j);if(a.isView(ce))return v(ce);if(ce==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce);if($e(ce,a)||ce&&$e(ce.buffer,a)||typeof o<"u"&&($e(ce,o)||ce&&$e(ce.buffer,o)))return E(ce,j,W);if(typeof ce=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const me=ce.valueOf&&ce.valueOf();if(me!=null&&me!==ce)return u.from(me,j,W);const De=T(ce);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof ce[Symbol.toPrimitive]=="function")return u.from(ce[Symbol.toPrimitive]("string"),j,W);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof ce)}u.from=function(ce,j,W){return h(ce,j,W)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function d(ce){if(typeof ce!="number")throw new TypeError('"size" argument must be of type number');if(ce<0)throw new RangeError('The value "'+ce+'" is invalid for option "size"')}function f(ce,j,W){return d(ce),ce<=0?l(ce):j!==void 0?typeof W=="string"?l(ce).fill(j,W):l(ce).fill(j):l(ce)}u.alloc=function(ce,j,W){return f(ce,j,W)};function p(ce){return d(ce),l(ce<0?0:x(ce)|0)}u.allocUnsafe=function(ce){return p(ce)},u.allocUnsafeSlow=function(ce){return p(ce)};function g(ce,j){if((typeof j!="string"||j==="")&&(j="utf8"),!u.isEncoding(j))throw new TypeError("Unknown encoding: "+j);const W=A(ce,j)|0;let me=l(W);const De=me.write(ce,j);return De!==W&&(me=me.slice(0,De)),me}function _(ce){const j=ce.length<0?0:x(ce.length)|0,W=l(j);for(let me=0;me<j;me+=1)W[me]=ce[me]&255;return W}function v(ce){if($e(ce,s)){const j=new s(ce);return E(j.buffer,j.byteOffset,j.byteLength)}return _(ce)}function E(ce,j,W){if(j<0||ce.byteLength<j)throw new RangeError('"offset" is outside of buffer bounds');if(ce.byteLength<j+(W||0))throw new RangeError('"length" is outside of buffer bounds');let me;return j===void 0&&W===void 0?me=new s(ce):W===void 0?me=new s(ce,j):me=new s(ce,j,W),Object.setPrototypeOf(me,u.prototype),me}function T(ce){if(u.isBuffer(ce)){const j=x(ce.length)|0,W=l(j);return W.length===0||ce.copy(W,0,0,j),W}if(ce.length!==void 0)return typeof ce.length!="number"||Ue(ce.length)?l(0):_(ce);if(ce.type==="Buffer"&&Array.isArray(ce.data))return _(ce.data)}function x(ce){if(ce>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return ce|0}function N(ce){return+ce!=ce&&(ce=0),u.alloc(+ce)}u.isBuffer=function(j){return j!=null&&j._isBuffer===!0&&j!==u.prototype},u.compare=function(j,W){if($e(j,s)&&(j=u.from(j,j.offset,j.byteLength)),$e(W,s)&&(W=u.from(W,W.offset,W.byteLength)),!u.isBuffer(j)||!u.isBuffer(W))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(j===W)return 0;let me=j.length,De=W.length;for(let je=0,mt=Math.min(me,De);je<mt;++je)if(j[je]!==W[je]){me=j[je],De=W[je];break}return me<De?-1:De<me?1:0},u.isEncoding=function(j){switch(String(j).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(j,W){if(!Array.isArray(j))throw new TypeError('"list" argument must be an Array of Buffers');if(j.length===0)return u.alloc(0);let me;if(W===void 0)for(W=0,me=0;me<j.length;++me)W+=j[me].length;const De=u.allocUnsafe(W);let je=0;for(me=0;me<j.length;++me){let mt=j[me];if($e(mt,s))je+mt.length>De.length?(u.isBuffer(mt)||(mt=u.from(mt)),mt.copy(De,je)):s.prototype.set.call(De,mt,je);else if(u.isBuffer(mt))mt.copy(De,je);else throw new TypeError('"list" argument must be an Array of Buffers');je+=mt.length}return De};function A(ce,j){if(u.isBuffer(ce))return ce.length;if(a.isView(ce)||$e(ce,a))return ce.byteLength;if(typeof ce!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof ce);const W=ce.length,me=arguments.length>2&&arguments[2]===!0;if(!me&&W===0)return 0;let De=!1;for(;;)switch(j){case"ascii":case"latin1":case"binary":return W;case"utf8":case"utf-8":return bt(ce).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W*2;case"hex":return W>>>1;case"base64":return Xe(ce).length;default:if(De)return me?-1:bt(ce).length;j=(""+j).toLowerCase(),De=!0}}u.byteLength=A;function I(ce,j,W){let me=!1;if((j===void 0||j<0)&&(j=0),j>this.length||((W===void 0||W>this.length)&&(W=this.length),W<=0)||(W>>>=0,j>>>=0,W<=j))return"";for(ce||(ce="utf8");;)switch(ce){case"hex":return Me(this,j,W);case"utf8":case"utf-8":return Z(this,j,W);case"ascii":return oe(this,j,W);case"latin1":case"binary":return de(this,j,W);case"base64":return V(this,j,W);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return He(this,j,W);default:if(me)throw new TypeError("Unknown encoding: "+ce);ce=(ce+"").toLowerCase(),me=!0}}u.prototype._isBuffer=!0;function k(ce,j,W){const me=ce[j];ce[j]=ce[W],ce[W]=me}u.prototype.swap16=function(){const j=this.length;if(j%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let W=0;W<j;W+=2)k(this,W,W+1);return this},u.prototype.swap32=function(){const j=this.length;if(j%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let W=0;W<j;W+=4)k(this,W,W+3),k(this,W+1,W+2);return this},u.prototype.swap64=function(){const j=this.length;if(j%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let W=0;W<j;W+=8)k(this,W,W+7),k(this,W+1,W+6),k(this,W+2,W+5),k(this,W+3,W+4);return this},u.prototype.toString=function(){const j=this.length;return j===0?"":arguments.length===0?Z(this,0,j):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(j){if(!u.isBuffer(j))throw new TypeError("Argument must be a Buffer");return this===j?!0:u.compare(this,j)===0},u.prototype.inspect=function(){let j="";const W=t.INSPECT_MAX_BYTES;return j=this.toString("hex",0,W).replace(/(.{2})/g,"$1 ").trim(),this.length>W&&(j+=" ... "),"<Buffer "+j+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(j,W,me,De,je){if($e(j,s)&&(j=u.from(j,j.offset,j.byteLength)),!u.isBuffer(j))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof j);if(W===void 0&&(W=0),me===void 0&&(me=j?j.length:0),De===void 0&&(De=0),je===void 0&&(je=this.length),W<0||me>j.length||De<0||je>this.length)throw new RangeError("out of range index");if(De>=je&&W>=me)return 0;if(De>=je)return-1;if(W>=me)return 1;if(W>>>=0,me>>>=0,De>>>=0,je>>>=0,this===j)return 0;let mt=je-De,xt=me-W;const Vn=Math.min(mt,xt),qe=this.slice(De,je),Vt=j.slice(W,me);for(let ht=0;ht<Vn;++ht)if(qe[ht]!==Vt[ht]){mt=qe[ht],xt=Vt[ht];break}return mt<xt?-1:xt<mt?1:0};function L(ce,j,W,me,De){if(ce.length===0)return-1;if(typeof W=="string"?(me=W,W=0):W>2147483647?W=2147483647:W<-2147483648&&(W=-2147483648),W=+W,Ue(W)&&(W=De?0:ce.length-1),W<0&&(W=ce.length+W),W>=ce.length){if(De)return-1;W=ce.length-1}else if(W<0)if(De)W=0;else return-1;if(typeof j=="string"&&(j=u.from(j,me)),u.isBuffer(j))return j.length===0?-1:U(ce,j,W,me,De);if(typeof j=="number")return j=j&255,typeof s.prototype.indexOf=="function"?De?s.prototype.indexOf.call(ce,j,W):s.prototype.lastIndexOf.call(ce,j,W):U(ce,[j],W,me,De);throw new TypeError("val must be string, number or Buffer")}function U(ce,j,W,me,De){let je=1,mt=ce.length,xt=j.length;if(me!==void 0&&(me=String(me).toLowerCase(),me==="ucs2"||me==="ucs-2"||me==="utf16le"||me==="utf-16le")){if(ce.length<2||j.length<2)return-1;je=2,mt/=2,xt/=2,W/=2}function Vn(Vt,ht){return je===1?Vt[ht]:Vt.readUInt16BE(ht*je)}let qe;if(De){let Vt=-1;for(qe=W;qe<mt;qe++)if(Vn(ce,qe)===Vn(j,Vt===-1?0:qe-Vt)){if(Vt===-1&&(Vt=qe),qe-Vt+1===xt)return Vt*je}else Vt!==-1&&(qe-=qe-Vt),Vt=-1}else for(W+xt>mt&&(W=mt-xt),qe=W;qe>=0;qe--){let Vt=!0;for(let ht=0;ht<xt;ht++)if(Vn(ce,qe+ht)!==Vn(j,ht)){Vt=!1;break}if(Vt)return qe}return-1}u.prototype.includes=function(j,W,me){return this.indexOf(j,W,me)!==-1},u.prototype.indexOf=function(j,W,me){return L(this,j,W,me,!0)},u.prototype.lastIndexOf=function(j,W,me){return L(this,j,W,me,!1)};function $(ce,j,W,me){W=Number(W)||0;const De=ce.length-W;me?(me=Number(me),me>De&&(me=De)):me=De;const je=j.length;me>je/2&&(me=je/2);let mt;for(mt=0;mt<me;++mt){const xt=parseInt(j.substr(mt*2,2),16);if(Ue(xt))return mt;ce[W+mt]=xt}return mt}function q(ce,j,W,me){return nt(bt(j,ce.length-W),ce,W,me)}function G(ce,j,W,me){return nt(be(j),ce,W,me)}function X(ce,j,W,me){return nt(Xe(j),ce,W,me)}function ie(ce,j,W,me){return nt(ue(j,ce.length-W),ce,W,me)}u.prototype.write=function(j,W,me,De){if(W===void 0)De="utf8",me=this.length,W=0;else if(me===void 0&&typeof W=="string")De=W,me=this.length,W=0;else if(isFinite(W))W=W>>>0,isFinite(me)?(me=me>>>0,De===void 0&&(De="utf8")):(De=me,me=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const je=this.length-W;if((me===void 0||me>je)&&(me=je),j.length>0&&(me<0||W<0)||W>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");let mt=!1;for(;;)switch(De){case"hex":return $(this,j,W,me);case"utf8":case"utf-8":return q(this,j,W,me);case"ascii":case"latin1":case"binary":return G(this,j,W,me);case"base64":return X(this,j,W,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,j,W,me);default:if(mt)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),mt=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function V(ce,j,W){return j===0&&W===ce.length?e.fromByteArray(ce):e.fromByteArray(ce.slice(j,W))}function Z(ce,j,W){W=Math.min(ce.length,W);const me=[];let De=j;for(;De<W;){const je=ce[De];let mt=null,xt=je>239?4:je>223?3:je>191?2:1;if(De+xt<=W){let Vn,qe,Vt,ht;switch(xt){case 1:je<128&&(mt=je);break;case 2:Vn=ce[De+1],(Vn&192)===128&&(ht=(je&31)<<6|Vn&63,ht>127&&(mt=ht));break;case 3:Vn=ce[De+1],qe=ce[De+2],(Vn&192)===128&&(qe&192)===128&&(ht=(je&15)<<12|(Vn&63)<<6|qe&63,ht>2047&&(ht<55296||ht>57343)&&(mt=ht));break;case 4:Vn=ce[De+1],qe=ce[De+2],Vt=ce[De+3],(Vn&192)===128&&(qe&192)===128&&(Vt&192)===128&&(ht=(je&15)<<18|(Vn&63)<<12|(qe&63)<<6|Vt&63,ht>65535&&ht<1114112&&(mt=ht))}}mt===null?(mt=65533,xt=1):mt>65535&&(mt-=65536,me.push(mt>>>10&1023|55296),mt=56320|mt&1023),me.push(mt),De+=xt}return ee(me)}const Y=4096;function ee(ce){const j=ce.length;if(j<=Y)return String.fromCharCode.apply(String,ce);let W="",me=0;for(;me<j;)W+=String.fromCharCode.apply(String,ce.slice(me,me+=Y));return W}function oe(ce,j,W){let me="";W=Math.min(ce.length,W);for(let De=j;De<W;++De)me+=String.fromCharCode(ce[De]&127);return me}function de(ce,j,W){let me="";W=Math.min(ce.length,W);for(let De=j;De<W;++De)me+=String.fromCharCode(ce[De]);return me}function Me(ce,j,W){const me=ce.length;(!j||j<0)&&(j=0),(!W||W<0||W>me)&&(W=me);let De="";for(let je=j;je<W;++je)De+=qt[ce[je]];return De}function He(ce,j,W){const me=ce.slice(j,W);let De="";for(let je=0;je<me.length-1;je+=2)De+=String.fromCharCode(me[je]+me[je+1]*256);return De}u.prototype.slice=function(j,W){const me=this.length;j=~~j,W=W===void 0?me:~~W,j<0?(j+=me,j<0&&(j=0)):j>me&&(j=me),W<0?(W+=me,W<0&&(W=0)):W>me&&(W=me),W<j&&(W=j);const De=this.subarray(j,W);return Object.setPrototypeOf(De,u.prototype),De};function Te(ce,j,W){if(ce%1!==0||ce<0)throw new RangeError("offset is not uint");if(ce+j>W)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j],je=1,mt=0;for(;++mt<W&&(je*=256);)De+=this[j+mt]*je;return De},u.prototype.readUintBE=u.prototype.readUIntBE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j+--W],je=1;for(;W>0&&(je*=256);)De+=this[j+--W]*je;return De},u.prototype.readUint8=u.prototype.readUInt8=function(j,W){return j=j>>>0,W||Te(j,1,this.length),this[j]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(j,W){return j=j>>>0,W||Te(j,2,this.length),this[j]|this[j+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(j,W){return j=j>>>0,W||Te(j,2,this.length),this[j]<<8|this[j+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),(this[j]|this[j+1]<<8|this[j+2]<<16)+this[j+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]*16777216+(this[j+1]<<16|this[j+2]<<8|this[j+3])},u.prototype.readBigUInt64LE=Mt(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&it(j,this.length-8);const De=W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24,je=this[++j]+this[++j]*2**8+this[++j]*2**16+me*2**24;return BigInt(De)+(BigInt(je)<<BigInt(32))}),u.prototype.readBigUInt64BE=Mt(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&it(j,this.length-8);const De=W*2**24+this[++j]*2**16+this[++j]*2**8+this[++j],je=this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+me;return(BigInt(De)<<BigInt(32))+BigInt(je)}),u.prototype.readIntLE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=this[j],je=1,mt=0;for(;++mt<W&&(je*=256);)De+=this[j+mt]*je;return je*=128,De>=je&&(De-=Math.pow(2,8*W)),De},u.prototype.readIntBE=function(j,W,me){j=j>>>0,W=W>>>0,me||Te(j,W,this.length);let De=W,je=1,mt=this[j+--De];for(;De>0&&(je*=256);)mt+=this[j+--De]*je;return je*=128,mt>=je&&(mt-=Math.pow(2,8*W)),mt},u.prototype.readInt8=function(j,W){return j=j>>>0,W||Te(j,1,this.length),this[j]&128?(255-this[j]+1)*-1:this[j]},u.prototype.readInt16LE=function(j,W){j=j>>>0,W||Te(j,2,this.length);const me=this[j]|this[j+1]<<8;return me&32768?me|4294901760:me},u.prototype.readInt16BE=function(j,W){j=j>>>0,W||Te(j,2,this.length);const me=this[j+1]|this[j]<<8;return me&32768?me|4294901760:me},u.prototype.readInt32LE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]|this[j+1]<<8|this[j+2]<<16|this[j+3]<<24},u.prototype.readInt32BE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),this[j]<<24|this[j+1]<<16|this[j+2]<<8|this[j+3]},u.prototype.readBigInt64LE=Mt(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&it(j,this.length-8);const De=this[j+4]+this[j+5]*2**8+this[j+6]*2**16+(me<<24);return(BigInt(De)<<BigInt(32))+BigInt(W+this[++j]*2**8+this[++j]*2**16+this[++j]*2**24)}),u.prototype.readBigInt64BE=Mt(function(j){j=j>>>0,Ie(j,"offset");const W=this[j],me=this[j+7];(W===void 0||me===void 0)&&it(j,this.length-8);const De=(W<<24)+this[++j]*2**16+this[++j]*2**8+this[++j];return(BigInt(De)<<BigInt(32))+BigInt(this[++j]*2**24+this[++j]*2**16+this[++j]*2**8+me)}),u.prototype.readFloatLE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),n.read(this,j,!0,23,4)},u.prototype.readFloatBE=function(j,W){return j=j>>>0,W||Te(j,4,this.length),n.read(this,j,!1,23,4)},u.prototype.readDoubleLE=function(j,W){return j=j>>>0,W||Te(j,8,this.length),n.read(this,j,!0,52,8)},u.prototype.readDoubleBE=function(j,W){return j=j>>>0,W||Te(j,8,this.length),n.read(this,j,!1,52,8)};function Le(ce,j,W,me,De,je){if(!u.isBuffer(ce))throw new TypeError('"buffer" argument must be a Buffer instance');if(j>De||j<je)throw new RangeError('"value" argument is out of bounds');if(W+me>ce.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(j,W,me,De){if(j=+j,W=W>>>0,me=me>>>0,!De){const xt=Math.pow(2,8*me)-1;Le(this,j,W,me,xt,0)}let je=1,mt=0;for(this[W]=j&255;++mt<me&&(je*=256);)this[W+mt]=j/je&255;return W+me},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(j,W,me,De){if(j=+j,W=W>>>0,me=me>>>0,!De){const xt=Math.pow(2,8*me)-1;Le(this,j,W,me,xt,0)}let je=me-1,mt=1;for(this[W+je]=j&255;--je>=0&&(mt*=256);)this[W+je]=j/mt&255;return W+me},u.prototype.writeUint8=u.prototype.writeUInt8=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,1,255,0),this[W]=j&255,W+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,65535,0),this[W]=j&255,this[W+1]=j>>>8,W+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,65535,0),this[W]=j>>>8,this[W+1]=j&255,W+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,4294967295,0),this[W+3]=j>>>24,this[W+2]=j>>>16,this[W+1]=j>>>8,this[W]=j&255,W+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,4294967295,0),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4};function we(ce,j,W,me,De){Fe(j,me,De,ce,W,7);let je=Number(j&BigInt(4294967295));ce[W++]=je,je=je>>8,ce[W++]=je,je=je>>8,ce[W++]=je,je=je>>8,ce[W++]=je;let mt=Number(j>>BigInt(32)&BigInt(4294967295));return ce[W++]=mt,mt=mt>>8,ce[W++]=mt,mt=mt>>8,ce[W++]=mt,mt=mt>>8,ce[W++]=mt,W}function Ce(ce,j,W,me,De){Fe(j,me,De,ce,W,7);let je=Number(j&BigInt(4294967295));ce[W+7]=je,je=je>>8,ce[W+6]=je,je=je>>8,ce[W+5]=je,je=je>>8,ce[W+4]=je;let mt=Number(j>>BigInt(32)&BigInt(4294967295));return ce[W+3]=mt,mt=mt>>8,ce[W+2]=mt,mt=mt>>8,ce[W+1]=mt,mt=mt>>8,ce[W]=mt,W+8}u.prototype.writeBigUInt64LE=Mt(function(j,W=0){return we(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Mt(function(j,W=0){return Ce(this,j,W,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(j,W,me,De){if(j=+j,W=W>>>0,!De){const Vn=Math.pow(2,8*me-1);Le(this,j,W,me,Vn-1,-Vn)}let je=0,mt=1,xt=0;for(this[W]=j&255;++je<me&&(mt*=256);)j<0&&xt===0&&this[W+je-1]!==0&&(xt=1),this[W+je]=(j/mt>>0)-xt&255;return W+me},u.prototype.writeIntBE=function(j,W,me,De){if(j=+j,W=W>>>0,!De){const Vn=Math.pow(2,8*me-1);Le(this,j,W,me,Vn-1,-Vn)}let je=me-1,mt=1,xt=0;for(this[W+je]=j&255;--je>=0&&(mt*=256);)j<0&&xt===0&&this[W+je+1]!==0&&(xt=1),this[W+je]=(j/mt>>0)-xt&255;return W+me},u.prototype.writeInt8=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,1,127,-128),j<0&&(j=255+j+1),this[W]=j&255,W+1},u.prototype.writeInt16LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,32767,-32768),this[W]=j&255,this[W+1]=j>>>8,W+2},u.prototype.writeInt16BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,2,32767,-32768),this[W]=j>>>8,this[W+1]=j&255,W+2},u.prototype.writeInt32LE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,2147483647,-2147483648),this[W]=j&255,this[W+1]=j>>>8,this[W+2]=j>>>16,this[W+3]=j>>>24,W+4},u.prototype.writeInt32BE=function(j,W,me){return j=+j,W=W>>>0,me||Le(this,j,W,4,2147483647,-2147483648),j<0&&(j=4294967295+j+1),this[W]=j>>>24,this[W+1]=j>>>16,this[W+2]=j>>>8,this[W+3]=j&255,W+4},u.prototype.writeBigInt64LE=Mt(function(j,W=0){return we(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Mt(function(j,W=0){return Ce(this,j,W,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ke(ce,j,W,me,De,je){if(W+me>ce.length)throw new RangeError("Index out of range");if(W<0)throw new RangeError("Index out of range")}function St(ce,j,W,me,De){return j=+j,W=W>>>0,De||ke(ce,j,W,4),n.write(ce,j,W,me,23,4),W+4}u.prototype.writeFloatLE=function(j,W,me){return St(this,j,W,!0,me)},u.prototype.writeFloatBE=function(j,W,me){return St(this,j,W,!1,me)};function At(ce,j,W,me,De){return j=+j,W=W>>>0,De||ke(ce,j,W,8),n.write(ce,j,W,me,52,8),W+8}u.prototype.writeDoubleLE=function(j,W,me){return At(this,j,W,!0,me)},u.prototype.writeDoubleBE=function(j,W,me){return At(this,j,W,!1,me)},u.prototype.copy=function(j,W,me,De){if(!u.isBuffer(j))throw new TypeError("argument should be a Buffer");if(me||(me=0),!De&&De!==0&&(De=this.length),W>=j.length&&(W=j.length),W||(W=0),De>0&&De<me&&(De=me),De===me||j.length===0||this.length===0)return 0;if(W<0)throw new RangeError("targetStart out of bounds");if(me<0||me>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),j.length-W<De-me&&(De=j.length-W+me);const je=De-me;return this===j&&typeof s.prototype.copyWithin=="function"?this.copyWithin(W,me,De):s.prototype.set.call(j,this.subarray(me,De),W),je},u.prototype.fill=function(j,W,me,De){if(typeof j=="string"){if(typeof W=="string"?(De=W,W=0,me=this.length):typeof me=="string"&&(De=me,me=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!u.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(j.length===1){const mt=j.charCodeAt(0);(De==="utf8"&&mt<128||De==="latin1")&&(j=mt)}}else typeof j=="number"?j=j&255:typeof j=="boolean"&&(j=Number(j));if(W<0||this.length<W||this.length<me)throw new RangeError("Out of range index");if(me<=W)return this;W=W>>>0,me=me===void 0?this.length:me>>>0,j||(j=0);let je;if(typeof j=="number")for(je=W;je<me;++je)this[je]=j;else{const mt=u.isBuffer(j)?j:u.from(j,De),xt=mt.length;if(xt===0)throw new TypeError('The value "'+j+'" is invalid for argument "value"');for(je=0;je<me-W;++je)this[je+W]=mt[je%xt]}return this};const Ee={};function ye(ce,j,W){Ee[ce]=class extends W{constructor(){super(),Object.defineProperty(this,"message",{value:j.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${ce}]`,this.stack,delete this.name}get code(){return ce}set code(De){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:De,writable:!0})}toString(){return`${this.name} [${ce}]: ${this.message}`}}}ye("ERR_BUFFER_OUT_OF_BOUNDS",function(ce){return ce?`${ce} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ye("ERR_INVALID_ARG_TYPE",function(ce,j){return`The "${ce}" argument must be of type number. Received type ${typeof j}`},TypeError),ye("ERR_OUT_OF_RANGE",function(ce,j,W){let me=`The value of "${ce}" is out of range.`,De=W;return Number.isInteger(W)&&Math.abs(W)>2**32?De=et(String(W)):typeof W=="bigint"&&(De=String(W),(W>BigInt(2)**BigInt(32)||W<-(BigInt(2)**BigInt(32)))&&(De=et(De)),De+="n"),me+=` It must be ${j}. Received ${De}`,me},RangeError);function et(ce){let j="",W=ce.length;const me=ce[0]==="-"?1:0;for(;W>=me+4;W-=3)j=`_${ce.slice(W-3,W)}${j}`;return`${ce.slice(0,W)}${j}`}function fe(ce,j,W){Ie(j,"offset"),(ce[j]===void 0||ce[j+W]===void 0)&&it(j,ce.length-(W+1))}function Fe(ce,j,W,me,De,je){if(ce>W||ce<j){const mt=typeof j=="bigint"?"n":"";let xt;throw j===0||j===BigInt(0)?xt=`>= 0${mt} and < 2${mt} ** ${(je+1)*8}${mt}`:xt=`>= -(2${mt} ** ${(je+1)*8-1}${mt}) and < 2 ** ${(je+1)*8-1}${mt}`,new Ee.ERR_OUT_OF_RANGE("value",xt,ce)}fe(me,De,je)}function Ie(ce,j){if(typeof ce!="number")throw new Ee.ERR_INVALID_ARG_TYPE(j,"number",ce)}function it(ce,j,W){throw Math.floor(ce)!==ce?(Ie(ce,W),new Ee.ERR_OUT_OF_RANGE("offset","an integer",ce)):j<0?new Ee.ERR_BUFFER_OUT_OF_BOUNDS:new Ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${j}`,ce)}const dt=/[^+/0-9A-Za-z-_]/g;function gt(ce){if(ce=ce.split("=")[0],ce=ce.trim().replace(dt,""),ce.length<2)return"";for(;ce.length%4!==0;)ce=ce+"=";return ce}function bt(ce,j){j=j||1/0;let W;const me=ce.length;let De=null;const je=[];for(let mt=0;mt<me;++mt){if(W=ce.charCodeAt(mt),W>55295&&W<57344){if(!De){if(W>56319){(j-=3)>-1&&je.push(239,191,189);continue}else if(mt+1===me){(j-=3)>-1&&je.push(239,191,189);continue}De=W;continue}if(W<56320){(j-=3)>-1&&je.push(239,191,189),De=W;continue}W=(De-55296<<10|W-56320)+65536}else De&&(j-=3)>-1&&je.push(239,191,189);if(De=null,W<128){if((j-=1)<0)break;je.push(W)}else if(W<2048){if((j-=2)<0)break;je.push(W>>6|192,W&63|128)}else if(W<65536){if((j-=3)<0)break;je.push(W>>12|224,W>>6&63|128,W&63|128)}else if(W<1114112){if((j-=4)<0)break;je.push(W>>18|240,W>>12&63|128,W>>6&63|128,W&63|128)}else throw new Error("Invalid code point")}return je}function be(ce){const j=[];for(let W=0;W<ce.length;++W)j.push(ce.charCodeAt(W)&255);return j}function ue(ce,j){let W,me,De;const je=[];for(let mt=0;mt<ce.length&&!((j-=2)<0);++mt)W=ce.charCodeAt(mt),me=W>>8,De=W%256,je.push(De),je.push(me);return je}function Xe(ce){return e.toByteArray(gt(ce))}function nt(ce,j,W,me){let De;for(De=0;De<me&&!(De+W>=j.length||De>=ce.length);++De)j[De+W]=ce[De];return De}function $e(ce,j){return ce instanceof j||ce!=null&&ce.constructor!=null&&ce.constructor.name!=null&&ce.constructor.name===j.name}function Ue(ce){return ce!==ce}const qt=function(){const ce="0123456789abcdef",j=new Array(256);for(let W=0;W<16;++W){const me=W*16;for(let De=0;De<16;++De)j[me+De]=ce[W]+ce[De]}return j}();function Mt(ce){return typeof BigInt>"u"?Yt:ce}function Yt(){throw new Error("BigInt not supported")}})(qc);const kl=qc.Buffer,t8e=qc.Blob,n8e=qc.BlobOptions,i8e=qc.Buffer,r8e=qc.File,s8e=qc.FileOptions,a8e=qc.INSPECT_MAX_BYTES,o8e=qc.SlowBuffer,c8e=qc.TranscodeEncoding,l8e=qc.atob,u8e=qc.btoa,h8e=qc.constants,d8e=qc.isAscii,f8e=qc.isUtf8,p8e=qc.kMaxLength,m8e=qc.kStringMaxLength,g8e=qc.resolveObjectURL,v8e=qc.transcode,y8e=Object.freeze(Object.defineProperty({__proto__:null,Blob:t8e,BlobOptions:n8e,Buffer:i8e,File:r8e,FileOptions:s8e,INSPECT_MAX_BYTES:a8e,SlowBuffer:o8e,TranscodeEncoding:c8e,atob:l8e,btoa:u8e,constants:h8e,default:kl,isAscii:d8e,isUtf8:f8e,kMaxLength:p8e,kStringMaxLength:m8e,resolveObjectURL:g8e,transcode:v8e},Symbol.toStringTag,{value:"Module"}));var gV;try{gV=new TextDecoder}catch{}var gn,Bf,Qe=0,ta={},Ur,Y_,wf=0,fg=0,rl,Vv,Qh=[],Nr,GQ={useRecords:!1,mapsAsObjects:!0};class Cde{}const Rde=new Cde;Rde.name="MessagePack 0xC1";var ab=!1,Ade=2,qQ;try{new Function("")}catch{Ade=1/0}class tO{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,n){if(gn)return Dde(()=>(yV(),this?this.unpack(e,n):tO.prototype.unpack.call(GQ,e,n)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof kl<"u"?kl.from(e):new Uint8Array(e)),typeof n=="object"?(Bf=n.end||e.length,Qe=n.start||0):(Qe=0,Bf=n>-1?n:e.length),fg=0,Y_=null,rl=null,gn=e;try{Nr=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(i){throw gn=null,e instanceof Uint8Array?i:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof tO){if(ta=this,this.structures)return Ur=this.structures,eD(n);(!Ur||Ur.length>0)&&(Ur=[])}else ta=GQ,(!Ur||Ur.length>0)&&(Ur=[]);return eD(n)}unpackMultiple(e,n){let i,r=0;try{ab=!0;let s=e.length,a=this?this.unpack(e,s):uB.unpack(e,s);if(n){if(n(a,r,Qe)===!1)return;for(;Qe<s;)if(r=Qe,n(eD(),r,Qe)===!1)return}else{for(i=[a];Qe<s;)r=Qe,i.push(eD());return i}}catch(s){throw s.lastPosition=r,s.values=i,s}finally{ab=!1,yV()}}_mergeStructures(e,n){e=e||[],Object.isFrozen(e)&&(e=e.map(i=>i.slice(0)));for(let i=0,r=e.length;i<r;i++){let s=e[i];s&&(s.isShared=!0,i>=32&&(s.highByte=i-32>>5))}e.sharedLength=e.length;for(let i in n||[])if(i>=0){let r=e[i],s=n[i];s&&(r&&((e.restoreStructures||(e.restoreStructures=[]))[i]=r),e[i]=s)}return this.structures=e}decode(e,n){return this.unpack(e,n)}}function eD(t){try{if(!ta.trusted&&!ab){let n=Ur.sharedLength||0;n<Ur.length&&(Ur.length=n)}let e;if(ta.randomAccessStructure&&gn[Qe]<64&&gn[Qe]>=32&&qQ?(e=qQ(gn,Qe,Bf,ta),gn=null,!(t&&t.lazy)&&e&&(e=e.toJSON()),Qe=Bf):e=Uo(),rl&&(Qe=rl.postBundlePosition,rl=null),ab&&(Ur.restoreStructures=null),Qe==Bf)Ur&&Ur.restoreStructures&&$Q(),Ur=null,gn=null,Vv&&(Vv=null);else{if(Qe>Bf)throw new Error("Unexpected end of MessagePack data");if(!ab){let n;try{n=JSON.stringify(e,(i,r)=>typeof r=="bigint"?`${r}n`:r).slice(0,100)}catch(i){n="(JSON view not available "+i+")"}throw new Error("Data read, but end of buffer not reached "+n)}}return e}catch(e){throw Ur&&Ur.restoreStructures&&$Q(),yV(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||Qe>Bf)&&(e.incomplete=!0),e}}function $Q(){for(let t in Ur.restoreStructures)Ur[t]=Ur.restoreStructures[t];Ur.restoreStructures=null}function Uo(){let t=gn[Qe++];if(t<160)if(t<128){if(t<64)return t;{let e=Ur[t&63]||ta.getStructures&&Mde()[t&63];return e?(e.read||(e.read=j7(e,t&63)),e.read()):t}}else if(t<144)if(t-=128,ta.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=Nde();i==="__proto__"&&(i="__proto_"),e[i]=Uo()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Uo(),Uo());return e}else{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Uo();return ta.freezeData?Object.freeze(e):e}else if(t<192){let e=t-160;if(fg>=Qe)return Y_.slice(Qe-wf,(Qe+=e)-wf);if(fg==0&&Bf<140){let n=e<16?V7(e):Ode(e);if(n!=null)return n}return vV(e)}else{let e;switch(t){case 192:return null;case 193:return rl?(e=Uo(),e>0?rl[1].slice(rl.position1,rl.position1+=e):rl[0].slice(rl.position0,rl.position0-=e)):Rde;case 194:return!1;case 195:return!0;case 196:if(e=gn[Qe++],e===void 0)throw new Error("Unexpected end of buffer");return J8(e);case 197:return e=Nr.getUint16(Qe),Qe+=2,J8(e);case 198:return e=Nr.getUint32(Qe),Qe+=4,J8(e);case 199:return iS(gn[Qe++]);case 200:return e=Nr.getUint16(Qe),Qe+=2,iS(e);case 201:return e=Nr.getUint32(Qe),Qe+=4,iS(e);case 202:if(e=Nr.getFloat32(Qe),ta.useFloat32>2){let n=G7[(gn[Qe]&127)<<1|gn[Qe+1]>>7];return Qe+=4,(n*e+(e>0?.5:-.5)>>0)/n}return Qe+=4,e;case 203:return e=Nr.getFloat64(Qe),Qe+=8,e;case 204:return gn[Qe++];case 205:return e=Nr.getUint16(Qe),Qe+=2,e;case 206:return e=Nr.getUint32(Qe),Qe+=4,e;case 207:return ta.int64AsType==="number"?(e=Nr.getUint32(Qe)*4294967296,e+=Nr.getUint32(Qe+4)):ta.int64AsType==="string"?e=Nr.getBigUint64(Qe).toString():ta.int64AsType==="auto"?(e=Nr.getBigUint64(Qe),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigUint64(Qe),Qe+=8,e;case 208:return Nr.getInt8(Qe++);case 209:return e=Nr.getInt16(Qe),Qe+=2,e;case 210:return e=Nr.getInt32(Qe),Qe+=4,e;case 211:return ta.int64AsType==="number"?(e=Nr.getInt32(Qe)*4294967296,e+=Nr.getUint32(Qe+4)):ta.int64AsType==="string"?e=Nr.getBigInt64(Qe).toString():ta.int64AsType==="auto"?(e=Nr.getBigInt64(Qe),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=Nr.getBigInt64(Qe),Qe+=8,e;case 212:if(e=gn[Qe++],e==114)return ZQ(gn[Qe++]&63);{let n=Qh[e];if(n)return n.read?(Qe++,n.read(Uo())):n.noBuffer?(Qe++,n()):n(gn.subarray(Qe,++Qe));throw new Error("Unknown extension "+e)}case 213:return e=gn[Qe],e==114?(Qe++,ZQ(gn[Qe++]&63,gn[Qe++])):iS(2);case 214:return iS(4);case 215:return iS(8);case 216:return iS(16);case 217:return e=gn[Qe++],fg>=Qe?Y_.slice(Qe-wf,(Qe+=e)-wf):b8e(e);case 218:return e=Nr.getUint16(Qe),Qe+=2,fg>=Qe?Y_.slice(Qe-wf,(Qe+=e)-wf):E8e(e);case 219:return e=Nr.getUint32(Qe),Qe+=4,fg>=Qe?Y_.slice(Qe-wf,(Qe+=e)-wf):S8e(e);case 220:return e=Nr.getUint16(Qe),Qe+=2,YQ(e);case 221:return e=Nr.getUint32(Qe),Qe+=4,YQ(e);case 222:return e=Nr.getUint16(Qe),Qe+=2,XQ(e);case 223:return e=Nr.getUint32(Qe),Qe+=4,XQ(e);default:if(t>=224)return t-256;if(t===void 0){let n=new Error("Unexpected end of MessagePack data");throw n.incomplete=!0,n}throw new Error("Unknown MessagePack token "+t)}}}const _8e=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function j7(t,e){function n(){if(n.count++>Ade){let r=t.read=new Function("r","return function(){return "+(ta.freezeData?"Object.freeze":"")+"({"+t.map(s=>s==="__proto__"?"__proto_:r()":_8e.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(Uo);return t.highByte===0&&(t.read=WQ(e,t.read)),r()}let i={};for(let r=0,s=t.length;r<s;r++){let a=t[r];a==="__proto__"&&(a="__proto_"),i[a]=Uo()}return ta.freezeData?Object.freeze(i):i}return n.count=0,t.highByte===0?WQ(e,n):n}const WQ=(t,e)=>function(){let n=gn[Qe++];if(n===0)return e();let i=t<32?-(t+(n<<5)):t+(n<<5),r=Ur[i]||Mde()[i];if(!r)throw new Error("Record id is not defined for "+i);return r.read||(r.read=j7(r,t)),r.read()};function Mde(){let t=Dde(()=>(gn=null,ta.getStructures()));return Ur=ta._mergeStructures(t,Ur)}var vV=kN,b8e=kN,E8e=kN,S8e=kN;function kN(t){let e;if(t<16&&(e=V7(t)))return e;if(t>64&&gV)return gV.decode(gn.subarray(Qe,Qe+=t));const n=Qe+t,i=[];for(e="";Qe<n;){const r=gn[Qe++];if(!(r&128))i.push(r);else if((r&224)===192){const s=gn[Qe++]&63;i.push((r&31)<<6|s)}else if((r&240)===224){const s=gn[Qe++]&63,a=gn[Qe++]&63;i.push((r&31)<<12|s<<6|a)}else if((r&248)===240){const s=gn[Qe++]&63,a=gn[Qe++]&63,o=gn[Qe++]&63;let c=(r&7)<<18|s<<12|a<<6|o;c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|c&1023),i.push(c)}else i.push(r);i.length>=4096&&(e+=tl.apply(String,i),i.length=0)}return i.length>0&&(e+=tl.apply(String,i)),e}function YQ(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Uo();return ta.freezeData?Object.freeze(e):e}function XQ(t){if(ta.mapsAsObjects){let e={};for(let n=0;n<t;n++){let i=Nde();i==="__proto__"&&(i="__proto_"),e[i]=Uo()}return e}else{let e=new Map;for(let n=0;n<t;n++)e.set(Uo(),Uo());return e}}var tl=String.fromCharCode;function Ode(t){let e=Qe,n=new Array(t);for(let i=0;i<t;i++){const r=gn[Qe++];if((r&128)>0){Qe=e;return}n[i]=r}return tl.apply(String,n)}function V7(t){if(t<4)if(t<2){if(t===0)return"";{let e=gn[Qe++];if((e&128)>1){Qe-=1;return}return tl(e)}}else{let e=gn[Qe++],n=gn[Qe++];if((e&128)>0||(n&128)>0){Qe-=2;return}if(t<3)return tl(e,n);let i=gn[Qe++];if((i&128)>0){Qe-=3;return}return tl(e,n,i)}else{let e=gn[Qe++],n=gn[Qe++],i=gn[Qe++],r=gn[Qe++];if((e&128)>0||(n&128)>0||(i&128)>0||(r&128)>0){Qe-=4;return}if(t<6){if(t===4)return tl(e,n,i,r);{let s=gn[Qe++];if((s&128)>0){Qe-=5;return}return tl(e,n,i,r,s)}}else if(t<8){let s=gn[Qe++],a=gn[Qe++];if((s&128)>0||(a&128)>0){Qe-=6;return}if(t<7)return tl(e,n,i,r,s,a);let o=gn[Qe++];if((o&128)>0){Qe-=7;return}return tl(e,n,i,r,s,a,o)}else{let s=gn[Qe++],a=gn[Qe++],o=gn[Qe++],c=gn[Qe++];if((s&128)>0||(a&128)>0||(o&128)>0||(c&128)>0){Qe-=8;return}if(t<10){if(t===8)return tl(e,n,i,r,s,a,o,c);{let l=gn[Qe++];if((l&128)>0){Qe-=9;return}return tl(e,n,i,r,s,a,o,c,l)}}else if(t<12){let l=gn[Qe++],u=gn[Qe++];if((l&128)>0||(u&128)>0){Qe-=10;return}if(t<11)return tl(e,n,i,r,s,a,o,c,l,u);let h=gn[Qe++];if((h&128)>0){Qe-=11;return}return tl(e,n,i,r,s,a,o,c,l,u,h)}else{let l=gn[Qe++],u=gn[Qe++],h=gn[Qe++],d=gn[Qe++];if((l&128)>0||(u&128)>0||(h&128)>0||(d&128)>0){Qe-=12;return}if(t<14){if(t===12)return tl(e,n,i,r,s,a,o,c,l,u,h,d);{let f=gn[Qe++];if((f&128)>0){Qe-=13;return}return tl(e,n,i,r,s,a,o,c,l,u,h,d,f)}}else{let f=gn[Qe++],p=gn[Qe++];if((f&128)>0||(p&128)>0){Qe-=14;return}if(t<15)return tl(e,n,i,r,s,a,o,c,l,u,h,d,f,p);let g=gn[Qe++];if((g&128)>0){Qe-=15;return}return tl(e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)}}}}}function KQ(){let t=gn[Qe++],e;if(t<192)e=t-160;else switch(t){case 217:e=gn[Qe++];break;case 218:e=Nr.getUint16(Qe),Qe+=2;break;case 219:e=Nr.getUint32(Qe),Qe+=4;break;default:throw new Error("Expected string")}return kN(e)}function J8(t){return ta.copyBuffers?Uint8Array.prototype.slice.call(gn,Qe,Qe+=t):gn.subarray(Qe,Qe+=t)}function iS(t){let e=gn[Qe++];if(Qh[e]){let n;return Qh[e](gn.subarray(Qe,n=Qe+=t),i=>{Qe=i;try{return Uo()}finally{Qe=n}})}else throw new Error("Unknown extension type "+e)}var JQ=new Array(4096);function Nde(){let t=gn[Qe++];if(t>=160&&t<192){if(t=t-160,fg>=Qe)return Y_.slice(Qe-wf,(Qe+=t)-wf);if(!(fg==0&&Bf<180))return vV(t)}else return Qe--,Ide(Uo());let e=(t<<5^(t>1?Nr.getUint16(Qe):t>0?gn[Qe]:0))&4095,n=JQ[e],i=Qe,r=Qe+t-3,s,a=0;if(n&&n.bytes==t){for(;i<r;){if(s=Nr.getUint32(i),s!=n[a++]){i=1879048192;break}i+=4}for(r+=3;i<r;)if(s=gn[i++],s!=n[a++]){i=1879048192;break}if(i===r)return Qe=i,n.string;r-=3,i=Qe}for(n=[],JQ[e]=n,n.bytes=t;i<r;)s=Nr.getUint32(i),n.push(s),i+=4;for(r+=3;i<r;)s=gn[i++],n.push(s);let o=t<16?V7(t):Ode(t);return o!=null?n.string=o:n.string=vV(t)}function Ide(t){if(typeof t=="string")return t;if(typeof t=="number"||typeof t=="boolean"||typeof t=="bigint")return t.toString();if(t==null)return t+"";throw new Error("Invalid property type for record",typeof t)}const ZQ=(t,e)=>{let n=Uo().map(Ide),i=t;e!==void 0&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let r=Ur[t];return r&&(r.isShared||ab)&&((Ur.restoreStructures||(Ur.restoreStructures=[]))[t]=r),Ur[t]=n,n.read=j7(n,i),n.read()};Qh[0]=()=>{};Qh[0].noBuffer=!0;Qh[66]=t=>{let e=t.length,n=BigInt(t[0]&128?t[0]-256:t[0]);for(let i=1;i<e;i++)n<<=BigInt(8),n+=BigInt(t[i]);return n};let T8e={Error,TypeError,ReferenceError};Qh[101]=()=>{let t=Uo();return(T8e[t[0]]||Error)(t[1],{cause:t[2]})};Qh[105]=t=>{if(ta.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(Qe-4);Vv||(Vv=new Map);let n=gn[Qe],i;n>=144&&n<160||n==220||n==221?i=[]:i={};let r={target:i};Vv.set(e,r);let s=Uo();return r.used?Object.assign(i,s):(r.target=s,s)};Qh[112]=t=>{if(ta.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=Nr.getUint32(Qe-4),n=Vv.get(e);return n.used=!0,n.target};Qh[115]=()=>new Set(Uo());const kde=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(t=>t+"Array");let x8e=typeof globalThis=="object"?globalThis:window;Qh[116]=t=>{let e=t[0],n=kde[e];if(!n){if(e===16){let i=new ArrayBuffer(t.length-1);return new Uint8Array(i).set(t.subarray(1)),i}throw new Error("Could not find typed array for code "+e)}return new x8e[n](Uint8Array.prototype.slice.call(t,1).buffer)};Qh[120]=()=>{let t=Uo();return new RegExp(t[0],t[1])};const w8e=[];Qh[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=Qe;return Qe+=e-t.length,rl=w8e,rl=[KQ(),KQ()],rl.position0=0,rl.position1=0,rl.postBundlePosition=Qe,Qe=n,Uo()};Qh[255]=t=>t.length==4?new Date((t[0]*16777216+(t[1]<<16)+(t[2]<<8)+t[3])*1e3):t.length==8?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+((t[3]&3)*4294967296+t[4]*16777216+(t[5]<<16)+(t[6]<<8)+t[7])*1e3):t.length==12?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+((t[4]&128?-281474976710656:0)+t[6]*1099511627776+t[7]*4294967296+t[8]*16777216+(t[9]<<16)+(t[10]<<8)+t[11])*1e3):new Date("invalid");function Dde(t){let e=Bf,n=Qe,i=wf,r=fg,s=Y_,a=Vv,o=rl,c=new Uint8Array(gn.slice(0,Bf)),l=Ur,u=Ur.slice(0,Ur.length),h=ta,d=ab,f=t();return Bf=e,Qe=n,wf=i,fg=r,Y_=s,Vv=a,rl=o,gn=c,ab=d,Ur=l,Ur.splice(0,Ur.length,...u),ta=h,Nr=new DataView(gn.buffer,gn.byteOffset,gn.byteLength),f}function yV(){gn=null,Vv=null,Ur=null}const G7=new Array(147);for(let t=0;t<256;t++)G7[t]=+("1e"+Math.floor(45.15-t*.30103));var uB=new tO({useRecords:!1});uB.unpack;uB.unpackMultiple;uB.unpack;let C8e=new Float32Array(1);new Uint8Array(C8e.buffer,0,4);let cP;try{cP=new TextEncoder}catch{}let _V,Pde;const hB=typeof kl<"u",tD=hB?function(t){return kl.allocUnsafeSlow(t)}:Uint8Array,Lde=hB?kl:Uint8Array,QQ=hB?4294967296:2144337920;let _t,XR,Qs,tt=0,Fu,Wa=null,R8e;const A8e=21760,M8e=/[\u0080-\uFFFF]/,s1=Symbol("record-id");class O8e extends tO{constructor(e){super(e),this.offset=0;let n,i,r,s,a=Lde.prototype.utf8Write?function(G,X){return _t.utf8Write(G,X,_t.byteLength-X)}:cP&&cP.encodeInto?function(G,X){return cP.encodeInto(G,_t.subarray(X)).written}:!1,o=this;e||(e={});let c=e&&e.sequential,l=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=l?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let h=e.maxOwnStructures;h==null&&(h=l?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let d=u>32||h+u>64,f=u+64,p=u+h+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],_=0,v=0;this.pack=this.encode=function(G,X){if(_t||(_t=new tD(8192),Qs=_t.dataView||(_t.dataView=new DataView(_t.buffer,0,8192)),tt=0),Fu=_t.length-10,Fu-tt<2048?(_t=new tD(_t.length),Qs=_t.dataView||(_t.dataView=new DataView(_t.buffer,0,_t.length)),Fu=_t.length-10,tt=0):tt=tt+7&2147483640,n=tt,X&L8e&&(tt+=X&255),s=o.structuredClone?new Map:null,o.bundleStrings&&typeof G!="string"?(Wa=[],Wa.size=1/0):Wa=null,r=o.structures,r){r.uninitialized&&(r=o._mergeStructures(o.getStructures()));let V=r.sharedLength||0;if(V>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let Z=0;Z<V;Z++){let Y=r[Z];if(!Y)continue;let ee,oe=r.transitions;for(let de=0,Me=Y.length;de<Me;de++){let He=Y[de];ee=oe[He],ee||(ee=oe[He]=Object.create(null)),oe=ee}oe[s1]=Z+64}this.lastNamedStructuresLength=V}c||(r.nextId=V+64)}i&&(i=!1);let ie;try{o.randomAccessStructure&&G&&G.constructor&&G.constructor===Object?q(G):x(G);let V=Wa;if(Wa&&nee(n,x,0),s&&s.idsToInsert){let Z=s.idsToInsert.sort((de,Me)=>de.offset>Me.offset?1:-1),Y=Z.length,ee=-1;for(;V&&Y>0;){let de=Z[--Y].offset+n;de<V.stringsPosition+n&&ee===-1&&(ee=0),de>V.position+n?ee>=0&&(ee+=6):(ee>=0&&(Qs.setUint32(V.position+n,Qs.getUint32(V.position+n)+ee),ee=-1),V=V.previous,Y++)}ee>=0&&V&&Qs.setUint32(V.position+n,Qs.getUint32(V.position+n)+ee),tt+=Z.length*6,tt>Fu&&L(tt),o.offset=tt;let oe=I8e(_t.subarray(n,tt),Z);return s=null,oe}return o.offset=tt,X&D8e?(_t.start=n,_t.end=tt,_t):_t.subarray(n,tt)}catch(V){throw ie=V,V}finally{if(r&&(E(),i&&o.saveStructures)){let V=r.sharedLength||0,Z=_t.subarray(n,tt),Y=k8e(r,o);if(!ie)return o.saveStructures(Y,Y.isCompatible)===!1?o.pack(G,X):(o.lastNamedStructuresLength=V,_t.length>1073741824&&(_t=null),Z)}_t.length>1073741824&&(_t=null),X&P8e&&(tt=n)}};const E=()=>{v<10&&v++;let G=r.sharedLength||0;if(r.length>G&&!c&&(r.length=G),_>1e4)r.transitions=null,v=0,_=0,g.length>0&&(g=[]);else if(g.length>0&&!c){for(let X=0,ie=g.length;X<ie;X++)g[X][s1]=0;g=[]}},T=G=>{var X=G.length;X<16?_t[tt++]=144|X:X<65536?(_t[tt++]=220,_t[tt++]=X>>8,_t[tt++]=X&255):(_t[tt++]=221,Qs.setUint32(tt,X),tt+=4);for(let ie=0;ie<X;ie++)x(G[ie])},x=G=>{tt>Fu&&(_t=L(tt));var X=typeof G,ie;if(X==="string"){let V=G.length;if(Wa&&V>=4&&V<4096){if((Wa.size+=V)>A8e){let oe,de=(Wa[0]?Wa[0].length*3+Wa[1].length:0)+10;tt+de>Fu&&(_t=L(tt+de));let Me;Wa.position?(Me=Wa,_t[tt]=200,tt+=3,_t[tt++]=98,oe=tt-n,tt+=4,nee(n,x,0),Qs.setUint16(oe+n-3,tt-n-oe)):(_t[tt++]=214,_t[tt++]=98,oe=tt-n,tt+=4),Wa=["",""],Wa.previous=Me,Wa.size=0,Wa.position=oe}let ee=M8e.test(G);Wa[ee?0:1]+=G,_t[tt++]=193,x(ee?-V:V);return}let Z;V<32?Z=1:V<256?Z=2:V<65536?Z=3:Z=5;let Y=V*3;if(tt+Y>Fu&&(_t=L(tt+Y)),V<64||!a){let ee,oe,de,Me=tt+Z;for(ee=0;ee<V;ee++)oe=G.charCodeAt(ee),oe<128?_t[Me++]=oe:oe<2048?(_t[Me++]=oe>>6|192,_t[Me++]=oe&63|128):(oe&64512)===55296&&((de=G.charCodeAt(ee+1))&64512)===56320?(oe=65536+((oe&1023)<<10)+(de&1023),ee++,_t[Me++]=oe>>18|240,_t[Me++]=oe>>12&63|128,_t[Me++]=oe>>6&63|128,_t[Me++]=oe&63|128):(_t[Me++]=oe>>12|224,_t[Me++]=oe>>6&63|128,_t[Me++]=oe&63|128);ie=Me-tt-Z}else ie=a(G,tt+Z);ie<32?_t[tt++]=160|ie:ie<256?(Z<2&&_t.copyWithin(tt+2,tt+1,tt+1+ie),_t[tt++]=217,_t[tt++]=ie):ie<65536?(Z<3&&_t.copyWithin(tt+3,tt+2,tt+2+ie),_t[tt++]=218,_t[tt++]=ie>>8,_t[tt++]=ie&255):(Z<5&&_t.copyWithin(tt+5,tt+3,tt+3+ie),_t[tt++]=219,Qs.setUint32(tt,ie),tt+=4),tt+=ie}else if(X==="number")if(G>>>0===G)G<32||G<128&&this.useRecords===!1||G<64&&!this.randomAccessStructure?_t[tt++]=G:G<256?(_t[tt++]=204,_t[tt++]=G):G<65536?(_t[tt++]=205,_t[tt++]=G>>8,_t[tt++]=G&255):(_t[tt++]=206,Qs.setUint32(tt,G),tt+=4);else if(G>>0===G)G>=-32?_t[tt++]=256+G:G>=-128?(_t[tt++]=208,_t[tt++]=G+256):G>=-32768?(_t[tt++]=209,Qs.setInt16(tt,G),tt+=2):(_t[tt++]=210,Qs.setInt32(tt,G),tt+=4);else{let V;if((V=this.useFloat32)>0&&G<4294967296&&G>=-2147483648){_t[tt++]=202,Qs.setFloat32(tt,G);let Z;if(V<4||(Z=G*G7[(_t[tt]&127)<<1|_t[tt+1]>>7])>>0===Z){tt+=4;return}else tt--}_t[tt++]=203,Qs.setFloat64(tt,G),tt+=8}else if(X==="object"||X==="function")if(!G)_t[tt++]=192;else{if(s){let Z=s.get(G);if(Z){if(!Z.id){let Y=s.idsToInsert||(s.idsToInsert=[]);Z.id=Y.push(Z)}_t[tt++]=214,_t[tt++]=112,Qs.setUint32(tt,Z.id),tt+=4;return}else s.set(G,{offset:tt-n})}let V=G.constructor;if(V===Object)k(G);else if(V===Array)T(G);else if(V===Map)if(this.mapAsEmptyObject)_t[tt++]=128;else{ie=G.size,ie<16?_t[tt++]=128|ie:ie<65536?(_t[tt++]=222,_t[tt++]=ie>>8,_t[tt++]=ie&255):(_t[tt++]=223,Qs.setUint32(tt,ie),tt+=4);for(let[Z,Y]of G)x(Z),x(Y)}else{for(let Z=0,Y=_V.length;Z<Y;Z++){let ee=Pde[Z];if(G instanceof ee){let oe=_V[Z];if(oe.write){oe.type&&(_t[tt++]=212,_t[tt++]=oe.type,_t[tt++]=0);let Le=oe.write.call(this,G);Le===G?Array.isArray(G)?T(G):k(G):x(Le);return}let de=_t,Me=Qs,He=tt;_t=null;let Te;try{Te=oe.pack.call(this,G,Le=>(_t=de,de=null,tt+=Le,tt>Fu&&L(tt),{target:_t,targetView:Qs,position:tt-Le}),x)}finally{de&&(_t=de,Qs=Me,tt=He,Fu=_t.length-10)}Te&&(Te.length+tt>Fu&&L(Te.length+tt),tt=N8e(Te,_t,tt,oe.type));return}}if(Array.isArray(G))T(G);else{if(G.toJSON){const Z=G.toJSON();if(Z!==G)return x(Z)}if(X==="function")return x(this.writeFunction&&this.writeFunction(G));k(G)}}}else if(X==="boolean")_t[tt++]=G?195:194;else if(X==="bigint"){if(G<BigInt(1)<<BigInt(63)&&G>=-(BigInt(1)<<BigInt(63)))_t[tt++]=211,Qs.setBigInt64(tt,G);else if(G<BigInt(1)<<BigInt(64)&&G>0)_t[tt++]=207,Qs.setBigUint64(tt,G);else if(this.largeBigIntToFloat)_t[tt++]=203,Qs.setFloat64(tt,Number(G));else{if(this.largeBigIntToString)return x(G.toString());if(this.useBigIntExtension&&G<BigInt(2)**BigInt(1023)&&G>-(BigInt(2)**BigInt(1023))){_t[tt++]=199,tt++,_t[tt++]=66;let V=[],Z;do{let Y=G&BigInt(255);Z=(Y&BigInt(128))===(G<BigInt(0)?BigInt(128):BigInt(0)),V.push(Y),G>>=BigInt(8)}while(!((G===BigInt(0)||G===BigInt(-1))&&Z));_t[tt-2]=V.length;for(let Y=V.length;Y>0;)_t[tt++]=Number(V[--Y]);return}else throw new RangeError(G+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}tt+=8}else if(X==="undefined")this.encodeUndefinedAsNil?_t[tt++]=192:(_t[tt++]=212,_t[tt++]=0,_t[tt++]=0);else throw new Error("Unknown type: "+X)},N=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?G=>{let X;if(this.skipValues){X=[];for(let Z in G)(typeof G.hasOwnProperty!="function"||G.hasOwnProperty(Z))&&!this.skipValues.includes(G[Z])&&X.push(Z)}else X=Object.keys(G);let ie=X.length;ie<16?_t[tt++]=128|ie:ie<65536?(_t[tt++]=222,_t[tt++]=ie>>8,_t[tt++]=ie&255):(_t[tt++]=223,Qs.setUint32(tt,ie),tt+=4);let V;if(this.coercibleKeyAsNumber)for(let Z=0;Z<ie;Z++){V=X[Z];let Y=Number(V);x(isNaN(Y)?V:Y),x(G[V])}else for(let Z=0;Z<ie;Z++)x(V=X[Z]),x(G[V])}:G=>{_t[tt++]=222;let X=tt-n;tt+=2;let ie=0;for(let V in G)(typeof G.hasOwnProperty!="function"||G.hasOwnProperty(V))&&(x(V),x(G[V]),ie++);if(ie>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');_t[X+++n]=ie>>8,_t[X+n]=ie&255},A=this.useRecords===!1?N:e.progressiveRecords&&!d?G=>{let X,ie=r.transitions||(r.transitions=Object.create(null)),V=tt++-n,Z;for(let Y in G)if(typeof G.hasOwnProperty!="function"||G.hasOwnProperty(Y)){if(X=ie[Y],X)ie=X;else{let ee=Object.keys(G),oe=ie;ie=r.transitions;let de=0;for(let Me=0,He=ee.length;Me<He;Me++){let Te=ee[Me];X=ie[Te],X||(X=ie[Te]=Object.create(null),de++),ie=X}V+n+1==tt?(tt--,U(ie,ee,de)):$(ie,ee,V,de),Z=!0,ie=oe[Y]}x(G[Y])}if(!Z){let Y=ie[s1];Y?_t[V+n]=Y:$(ie,Object.keys(G),V,0)}}:G=>{let X,ie=r.transitions||(r.transitions=Object.create(null)),V=0;for(let Y in G)(typeof G.hasOwnProperty!="function"||G.hasOwnProperty(Y))&&(X=ie[Y],X||(X=ie[Y]=Object.create(null),V++),ie=X);let Z=ie[s1];Z?Z>=96&&d?(_t[tt++]=((Z-=96)&31)+96,_t[tt++]=Z>>5):_t[tt++]=Z:U(ie,ie.__keys__||Object.keys(G),V);for(let Y in G)(typeof G.hasOwnProperty!="function"||G.hasOwnProperty(Y))&&x(G[Y])},I=typeof this.useRecords=="function"&&this.useRecords,k=I?G=>{I(G)?A(G):N(G)}:A,L=G=>{let X;if(G>16777216){if(G-n>QQ)throw new Error("Packed buffer would be larger than maximum buffer size");X=Math.min(QQ,Math.round(Math.max((G-n)*(G>67108864?1.25:2),4194304)/4096)*4096)}else X=(Math.max(G-n<<2,_t.length-1)>>12)+1<<12;let ie=new tD(X);return Qs=ie.dataView||(ie.dataView=new DataView(ie.buffer,0,X)),G=Math.min(G,_t.length),_t.copy?_t.copy(ie,0,n,G):ie.set(_t.slice(n,G)),tt-=n,n=0,Fu=ie.length-10,_t=ie},U=(G,X,ie)=>{let V=r.nextId;V||(V=64),V<f&&this.shouldShareStructure&&!this.shouldShareStructure(X)?(V=r.nextOwnId,V<p||(V=f),r.nextOwnId=V+1):(V>=p&&(V=f),r.nextId=V+1);let Z=X.highByte=V>=96&&d?V-96>>5:-1;G[s1]=V,G.__keys__=X,r[V-64]=X,V<f?(X.isShared=!0,r.sharedLength=V-63,i=!0,Z>=0?(_t[tt++]=(V&31)+96,_t[tt++]=Z):_t[tt++]=V):(Z>=0?(_t[tt++]=213,_t[tt++]=114,_t[tt++]=(V&31)+96,_t[tt++]=Z):(_t[tt++]=212,_t[tt++]=114,_t[tt++]=V),ie&&(_+=v*ie),g.length>=h&&(g.shift()[s1]=0),g.push(G),x(X))},$=(G,X,ie,V)=>{let Z=_t,Y=tt,ee=Fu,oe=n;_t=XR,tt=0,n=0,_t||(XR=_t=new tD(8192)),Fu=_t.length-10,U(G,X,V),XR=_t;let de=tt;if(_t=Z,tt=Y,Fu=ee,n=oe,de>1){let Me=tt+de-1;Me>Fu&&L(Me);let He=ie+n;_t.copyWithin(He+de,He+1,tt),_t.set(XR.slice(0,de),He),tt=Me}else _t[ie+n]=XR[0]},q=G=>{let X=R8e(G,_t,n,tt,r,L,(ie,V,Z)=>{if(Z)return i=!0;tt=V;let Y=_t;return x(ie),E(),Y!==_t?{position:tt,targetView:Qs,target:_t}:tt},this);if(X===0)return k(G);tt=X}}useBuffer(e){_t=e,_t.dataView||(_t.dataView=new DataView(_t.buffer,_t.byteOffset,_t.byteLength)),tt=0}set position(e){tt=e}get position(){return tt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}Pde=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Cde];_V=[{pack(t,e,n){let i=t.getTime()/1e3;if((this.useTimestamp32||t.getMilliseconds()===0)&&i>=0&&i<4294967296){let{target:r,targetView:s,position:a}=e(6);r[a++]=214,r[a++]=255,s.setUint32(a,i)}else if(i>0&&i<4294967296){let{target:r,targetView:s,position:a}=e(10);r[a++]=215,r[a++]=255,s.setUint32(a,t.getMilliseconds()*4e6+(i/1e3/4294967296>>0)),s.setUint32(a+4,i)}else if(isNaN(i)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:r,targetView:s,position:a}=e(3);r[a++]=212,r[a++]=255,r[a++]=255}else{let{target:r,targetView:s,position:a}=e(15);r[a++]=199,r[a++]=12,r[a++]=255,s.setUint32(a,t.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(i)))}}},{pack(t,e,n){if(this.setAsEmptyObject)return e(0),n({});let i=Array.from(t),{target:r,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(r[s++]=212,r[s++]=115,r[s++]=0),n(i)}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=101,i[r++]=0),n([t.name,t.message,t.cause])}},{pack(t,e,n){let{target:i,position:r}=e(this.moreTypes?3:0);this.moreTypes&&(i[r++]=212,i[r++]=120,i[r++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?eee(t,16,e):tee(hB?kl.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==Lde&&this.moreTypes?eee(t,kde.indexOf(n.name),e):tee(t,e)}},{pack(t,e){let{target:n,position:i}=e(1);n[i]=193}}];function eee(t,e,n,i){let r=t.byteLength;if(r+1<256){var{target:s,position:a}=n(4+r);s[a++]=199,s[a++]=r+1}else if(r+1<65536){var{target:s,position:a}=n(5+r);s[a++]=200,s[a++]=r+1>>8,s[a++]=r+1&255}else{var{target:s,position:a,targetView:o}=n(7+r);s[a++]=201,o.setUint32(a,r+1),a+=4}s[a++]=116,s[a++]=e,t.buffer||(t=new Uint8Array(t)),s.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a)}function tee(t,e){let n=t.byteLength;var i,r;if(n<256){var{target:i,position:r}=e(n+2);i[r++]=196,i[r++]=n}else if(n<65536){var{target:i,position:r}=e(n+3);i[r++]=197,i[r++]=n>>8,i[r++]=n&255}else{var{target:i,position:r,targetView:s}=e(n+5);i[r++]=198,s.setUint32(r,n),r+=4}i.set(t,r)}function N8e(t,e,n,i){let r=t.length;switch(r){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:r<256?(e[n++]=199,e[n++]=r):r<65536?(e[n++]=200,e[n++]=r>>8,e[n++]=r&255):(e[n++]=201,e[n++]=r>>24,e[n++]=r>>16&255,e[n++]=r>>8&255,e[n++]=r&255)}return e[n++]=i,e.set(t,n),n+=r,n}function I8e(t,e){let n,i=e.length*6,r=t.length-i;for(;n=e.pop();){let s=n.offset,a=n.id;t.copyWithin(s+i,s,r),i-=6;let o=s+i;t[o++]=214,t[o++]=105,t[o++]=a>>24,t[o++]=a>>16&255,t[o++]=a>>8&255,t[o++]=a&255,r=s}return t}function nee(t,e,n){if(Wa.length>0){Qs.setUint32(Wa.position+t,tt+n-Wa.position-t),Wa.stringsPosition=tt-t;let i=Wa;Wa=null,e(i[0]),e(i[1])}}function k8e(t,e){return t.isCompatible=n=>{let i=!n||(e.lastNamedStructuresLength||0)===n.length;return i||e._mergeStructures(n),i},t}let Ude=new O8e({useRecords:!1});Ude.pack;Ude.pack;const D8e=512,P8e=1024,L8e=2048,Ge=qb("SOFTWARE");function iee(){return{id:Do()}}function Mg(t){var e;return(((e=t==null?void 0:t.id)==null?void 0:e.length)??0)>0}function O2(t,e){if(!ae(t)||!Vg(e))return;const{color:n,bg:i}=Upe(e);ae(n)&&(t.color=n),ae(i)&&(t.bg=i)}function XC(t){var e;return ai((t==null?void 0:t.name)??((e=t==null?void 0:t.kinddata)==null?void 0:e.name)??"")}const fi=60,jr=25,Bde=fi*jr;var Kn=(t=>(t[t.ERROR=0]="ERROR",t[t.LOADER=1]="LOADER",t[t.BOARD=2]="BOARD",t[t.OBJECT=3]="OBJECT",t[t.TERRAIN=4]="TERRAIN",t[t.CHARSET=5]="CHARSET",t[t.PALETTE=6]="PALETTE",t))(Kn||{});function U8e(){return new Array(fi*jr).map(()=>{})}function q7(t=Vu){const e={terrain:U8e(),objects:{},id:""};return t(e)}function vT(t,e){return!ae(t)||!ae(e==null?void 0:e.x)||!ae(e==null?void 0:e.y)||e.x<0||e.x>=fi||e.y<0||e.y>=jr?-1:e.x+e.y*fi}function em(t,e){const n=vT(t,e);if(n<0||!ae(t==null?void 0:t.lookup))return;const i=ry(t,t.lookup[n]??"");return ae(i)?i:t.terrain[n]}function $7(t,e,n){return(e>=0&&e<fi)??(n>=0&&n<jr)?t==null?void 0:t.terrain[e+n*fi]:void 0}function Og(t,e){if(!ae(t)||!ae(e)||!ae(e.x)||!ae(e.y)||e.x<0||e.x>=fi||e.y<0||e.y>=jr)return;const n=ol(e),i=e.x+e.y*fi;return t.terrain[i]=n,delete t.distmaps,t.terrain[i]}function B8e(t,e){if(!ae(t)||!ae(e))return;const n=ol(e);return n.id=n.id??Do(),t.objects[n.id]=n,t.objects[n.id]}function F8e(t,e,n){return Og(t,{...e,kind:n})}function Fde(t,e,n,i){return B8e(t,{...e,kind:n,id:i})}function ry(t,e){if(t)return t.objects[e]}function z8e(t,e){const n=vT(t,e);if(n<0||!ae(t==null?void 0:t.lookup))return;const i=ry(t,t.lookup[n]??"");if(ae(i))return i}function H8e(t,e,n){if(!ae(t)||!ae(e))return;const i=t.objects[n];if(ae(i))return i;if(rC(e))return jde(e,DN(t,"player"))}function W7(t,e){const n=t??bs.ISWALK,i=e??bs.ISWALK;switch(n){case bs.ISWALK:return i!==bs.ISWALK;case bs.ISSWIM:return i!==bs.ISSWIM;case bs.ISSOLID:return!0;case bs.ISBULLET:return i!==bs.ISWALK&&i!==bs.ISSWIM}}function nO(t,e,n){const i=t==null?void 0:t.objects[n];if(ae(i))return i;const r=DN(t,"player");return ae(e)?(e.x<0&&(e.x=Uf(0,fi-1)),e.y<0&&(e.y=Uf(0,jr-1)),jde(e,r)):Xa(...r)}function DN(t,e){var i,r;return[...((r=(i=t==null?void 0:t.named)==null?void 0:i[e])==null?void 0:r.values())??[]].map(s=>typeof s=="string"?t==null?void 0:t.objects[s]:t==null?void 0:t.terrain[s]).filter(ae)}function j8e(t){const e=[];for(let n=0;n<jr;++n)for(let i=0;i<fi;++i){const r={x:i,y:n},s=em(t,r);!(s!=null&&s.name)&&!(s!=null&&s.kind)&&e.push(r)}return e}function zde(t,e){const n=mV(e),i=Tde(e),r=xde(e);return DN(t,n??"").filter(s=>{var a,o,c;return!(ae(n)&&ai((s==null?void 0:s.name)??((a=s==null?void 0:s.kinddata)==null?void 0:a.name)??"")!==n||ae(i)&&((s==null?void 0:s.color)??((o=s==null?void 0:s.kinddata)==null?void 0:o.color)??Qt.WHITE)!==i||ae(r)&&((s==null?void 0:s.bg)??((c=s==null?void 0:s.kinddata)==null?void 0:c.bg)??Qt.BLACK)!==r)}).filter(ae)}function Hde(t,e){return ae(t)?e.map(n=>{var i;if(typeof n=="string"){const r=t.objects[n];if(ae(r))return r;const s=DN(t,ai(n));if(s.length)return s}else if(rC(n)&&n.x>=0&&n.x<fi&&n.y>=0&&n.y<jr){const r=n.x+n.y*fi,s=(i=t.lookup)==null?void 0:i[r];return ae(s)?t.objects[s]:t.terrain[r]}}).flat().filter(ae):[]}function jde(t,e){let n=0,i;for(let r=0;r<e.length;++r){const s=e[r];if(s){const a=t.x-(s.x??0),o=t.y-(s.y??0),c=Math.sqrt(a*a+o*o);(i===void 0||c<n)&&(n=c,i=s)}}return i}const dB=B7(32,126).map(t=>String.fromCharCode(t));function xr(t){return Xd({...t,name:`token_${t.name}`})}function Kb(t,e=!1){return xr(e?{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:gl,group:Uc.SKIPPED}:{name:t,pattern:new RegExp(t.toLowerCase(),"i"),longer_alt:gl})}const aC=xr({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),Vde=xr({name:"whitespace",pattern:/ +/,group:Uc.SKIPPED}),Gde=xr({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:Uc.SKIPPED}),PN=xr({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),CS=xr({name:"command",pattern:/#/,start_chars_hint:["#"]});let qde=!1;function V8e(t,e,n){if(!qde)return null;const[i]=n.slice(-1);if(i&&i.tokenType!==aC)return null;let r=e;for(;t[r]===" ";)r++;if("@#/?':!".includes(t[r]))return null;let s=e+1;for(;s<t.length&&t[s]!==`
`;)s++;const a=t.substring(e,s);return a.trim().length===0?null:[a]}const fB=xr({name:"text",pattern:V8e,line_breaks:!1,start_chars_hint:dB.filter(t=>"@#/?':!".includes(t)===!1)}),Y7=xr({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),X7=xr({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),K7=xr({name:"hyperlink",pattern:/!/,start_chars_hint:["!"]}),J7=xr({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),gl=xr({name:"stringliteral",pattern:/[^-0-9"!;@#/?()\s]+[^-"!;@#/?()\s]*/,start_chars_hint:dB}),Z7=xr({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),Q7=xr({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),eW=xr({name:"iseq",pattern:/=|is|eq|equal/,longer_alt:gl}),tW=xr({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/,longer_alt:gl}),nW=xr({name:"islessthan",pattern:/<|below/,longer_alt:gl}),iW=xr({name:"isgreaterthan",pattern:/>|above/,longer_alt:gl}),rW=xr({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/,longer_alt:gl}),sW=xr({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/,longer_alt:gl}),N2=xr({name:"or",pattern:/or/i,longer_alt:gl}),I2=xr({name:"not",pattern:/not/i,longer_alt:gl}),k2=xr({name:"and",pattern:/and/i,longer_alt:gl}),D2=xr({name:"plus",pattern:/\+/}),P2=xr({name:"minus",pattern:/-/}),aW=xr({name:"power",pattern:/\*\*/}),oW=xr({name:"multiply",pattern:/\*/}),L2=xr({name:"divide",pattern:/\//}),cW=xr({name:"moddivide",pattern:/%/}),lW=xr({name:"floordivide",pattern:/%%/}),uW=xr({name:"query",pattern:/\?/}),hW=xr({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),dW=xr({name:"rparen",pattern:/\)/,pop_mode:!0}),fW=xr({name:"command_play",pattern:/(play|bgplay) .*/,start_chars_hint:dB,longer_alt:gl}),$de=xr({name:"command_toast",pattern:/toast .*/,start_chars_hint:dB,longer_alt:gl}),U2=xr({name:"if",pattern:/if|try|take|give/,longer_alt:gl}),eM=Kb("do"),B2=Kb("done"),F2=Kb("else"),pW=Kb("while"),mW=Kb("repeat"),gW=Kb("waitfor"),vW=xr({name:"foreach",pattern:/foreach|for/,longer_alt:gl}),yW=Kb("break"),_W=Kb("continue");function Wde(t){return[...t,Q7,eW,tW,rW,nW,sW,iW,N2,I2,k2,D2,P2,aW,oW,L2,lW,cW,uW,hW,dW,Z7,gl]}const Yde=Wde([fB,PN,fW,$de,CS,Y7,X7,K7,J7,aC,Vde,yW,_W,B2,eM,F2,vW,U2,mW,gW,pW]),G8e=new Uc({defaultMode:"use_newlines",modes:{use_newlines:Yde,ignore_newlines:Wde([Gde])}},{skipValidations:!Bg,ensureOptimizations:Bg});function bW(t){qde=!0;const e=G8e.tokenize(t||` 
`),[n]=(Li(e.tokens)?e.tokens:[]).slice(-1);return n&&n.tokenType.name!=="Newline"&&e.tokens.push(IN(aC,`
`,n.startOffset,n.endOffset??NaN,n.startLine??NaN,n.endLine??NaN,n.startColumn??NaN,n.endColumn??NaN)),e}function Xde(t,e,n=!0){if(n){const[i,...r]=e;switch(ai(i??"")){default:return{type:cn.OBJECT,values:e};case"loader":return{type:cn.LOADER,values:r};case"board":return{type:cn.BOARD,values:r};case"object":return{type:cn.OBJECT,values:r};case"terrain":return{type:cn.TERRAIN,values:r};case"charset":return{type:cn.CHARSET,values:r};case"palette":return{type:cn.PALETTE,values:r}}}else{const[i,r,...s]=e,a=ai(r??""),o=[i,t,...s];switch(a){default:return{type:cn.CONST,values:e};case"rn":case"range":return{type:cn.RANGE,values:o};case"sl":case"select":return{type:cn.SELECT,values:o};case"nm":case"number":return{type:cn.NUMBER,values:o};case"tx":case"text":return{type:cn.TEXT,values:o};case"ln":case"link":return{type:cn.LINK,values:o};case"hk":case"hotkey":return{type:cn.HOTKEY,values:o};case"copyit":return{type:cn.COPYIT,values:o};case"openit":return{type:cn.OPENIT,values:o};case"zssedit":return{type:cn.ZSSEDIT,values:o};case"charedit":return{type:cn.CHAREDIT,values:o};case"coloredit":return{type:cn.COLOREDIT,values:o}}}}function Pd(t){switch(t){case cn.LOADER:return"loader";case cn.BOARD:return"board";case cn.OBJECT:return"object";case cn.TERRAIN:return"terrain";case cn.CHARSET:return"charset";case cn.PALETTE:return"palette";case cn.CONST:return"const";case cn.RANGE:return"range";case cn.SELECT:return"select";case cn.NUMBER:return"number";case cn.TEXT:return"text";case cn.LINK:return"link";case cn.HOTKEY:return"hotkey";case cn.COPYIT:return"copyit";case cn.OPENIT:return"openit";case cn.ZSSEDIT:return"zssedit";case cn.CHAREDIT:return"charedit";case cn.COLOREDIT:return"coloredit"}}function q8e(t,e){return{id:Do(),code:t,...e}}function nD(t){const e={...pB(t)};return Object.keys(e).forEach(n=>{switch(n){case"type":case"name":delete e[n];break}}),e}function $8e(t){const e=bW(t),n={};let i=!0;for(let r=0;r<e.tokens.length;++r){const s=e.tokens[r];if(s.tokenType===PN){const a=s.image.slice(1),[o,c]=a.split(";").map(d=>d.trim()),l=o.split(" "),u=Xde(On(c)?c:"",l,i),h=ai(u.values.join(" "));switch(i=!1,u.type){case cn.LOADER:n.type=Kn.LOADER,n.name=h;break;case cn.BOARD:n.type=Kn.BOARD,n.name=h;break;case cn.OBJECT:n.type=Kn.OBJECT,n.name=h||"object";break;case cn.TERRAIN:n.type=Kn.TERRAIN,n.name=h;break;case cn.CHARSET:n.type=Kn.CHARSET,n.name=h;break;case cn.PALETTE:n.type=Kn.PALETTE,n.name=h;break;case cn.CONST:{const[d,f]=u.values;if(On(d)){const p=ai(d);if(On(f)){const g=parseFloat(f);n[p]=pn(g)?g:f}else pn(f)?n[p]=f:n[p]=1}break}case cn.RANGE:case cn.SELECT:case cn.NUMBER:case cn.TEXT:case cn.LINK:case cn.HOTKEY:case cn.ZSSEDIT:case cn.CHAREDIT:case cn.COLOREDIT:{const[d,...f]=u.values;if(On(d)){const p=ai(d);n[p]=[Pd(u.type),...f]}break}}}}return n}function pB(t){var e;return ae(t)?(ae((e=t.stats)==null?void 0:e.type)||(t.stats=$8e(t.code),ae(t.stats.type)||(t.stats.type=Kn.OBJECT)),t.stats):{}}function Kde(t){switch(t){default:case Kn.ERROR:return"error";case Kn.LOADER:return Pd(cn.LOADER);case Kn.BOARD:return Pd(cn.BOARD);case Kn.OBJECT:return Pd(cn.OBJECT);case Kn.TERRAIN:return Pd(cn.TERRAIN);case Kn.CHARSET:return Pd(cn.CHARSET);case Kn.PALETTE:return Pd(cn.PALETTE)}}function yT(t){return pB(t).type??Kn.ERROR}function rS(t){return Kde(yT(t))}function $u(t){return pB(t).name??""}const iD=new _n;function ree(t,e){const n=Object.keys(t);for(let i=0;i<n.length;++i){const r=n[i],s=t[r];if(!Li(s))switch(r){case"name":case"char":case"color":case"bg":case"light":case"p1":case"p2":case"p3":case"cycle":case"stepx":case"stepy":e[r]=t[r];break;case"ispushable":e.pushable=1;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=bs.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=bs.ISSWIM;break;case"issolid":e.collision=bs.ISSOLID;break;case"isbullet":e.collision=bs.ISBULLET;break;case"isdestructible":e.destructible=1;break}}}function vl(t){var e;if(ae(t))switch(yT(t)){default:return;case Kn.ERROR:return t.code??"";case Kn.LOADER:return t.code??"";case Kn.BOARD:{ae(t.board)||(t.board=q7()),t.board.id=t.id;const n=nD(t);return t.board.isdark=n.isdark??t.board.isdark?1:0,t.board.startx=n.startx??t.board.startx,t.board.starty=n.starty??t.board.starty,t.board.over=n.over??t.board.over,t.board.under=n.under??t.board.under,t.board.camera=n.camera??t.board.camera,t.board.graphics=n.graphics??t.board.graphics,t.board.facing=n.facing??t.board.facing,t.board.exitnorth=n.exitnorth??t.board.exitnorth,t.board.exitsouth=n.exitsouth??t.board.exitsouth,t.board.exitwest=n.exitwest??t.board.exitwest,t.board.exiteast=n.exiteast??t.board.exiteast,t.board.timelimit=n.timelimit??t.board.timelimit,t.board.restartonzap=n.restartonzap??t.board.restartonzap,t.board.maxplayershots=n.maxplayershots??t.board.maxplayershots,t.board}case Kn.OBJECT:return ae(t.object)||(t.object=iee()),t.object.name=$u(t),t.object.category=uT.ISOBJECT,ree(nD(t),t.object),t.object;case Kn.TERRAIN:return ae(t.terrain)||(t.terrain=iee()),t.terrain.name=$u(t),t.terrain.category=uT.ISTERRAIN,ree(nD(t),t.terrain),t.terrain;case Kn.PALETTE:{if(ae(t.palette)||(t.palette=$C(xN)),ae((e=t.palette)==null?void 0:e.bits)){const n=nD(t),i=G3(n);for(let r=0;r<i.length;++r){const s=i[r].toLowerCase(),a=n[s];if(s.startsWith("color")&&On(a)){const o=parseFloat(s.replace("color",""));if(o>=0&&o<=15){iD.set(a);const c=o*hT,l=iD.r*63,u=iD.g*63,h=iD.b*63;t.palette.bits[c+0]=Er(l,0,63),t.palette.bits[c+1]=Er(u,0,63),t.palette.bits[c+2]=Er(h,0,63)}}}}return t.palette}case Kn.CHARSET:return ae(t.charset)||(t.charset=WC(TN)),t.charset}}function Jde(t){return{id:Do(),name:wPe(),timestamp:0,activelist:[],pages:t,flags:{}}}function Zde(t){ae(t)&&(t.token=`${CPe()}${Uf(1111,9999)}`)}function YS(t,e){if(!ae(t))return;const n=ai(e);return t.pages.find(r=>r.id===e||n===$u(r))}function ed(t,e,n){if(!ae(t))return;const i=ai(n);return t.pages.find(s=>yT(s)===e&&(s.id===n||i===$u(s)))}function bV(t,e,n){let i=ed(t,e,n);if(!ae(i)){const r=Kde(e);i=q8e(r==="object"?`@${n||"object"}
`:`@${r} ${n}
`,{}),W8e(t,i)}return i}function Gf(t,e,n){if(!ae(t))return[];const i=ai(n);return t.pages.filter(s=>yT(s)===e).filter(s=>{const a=pB(s),o=ai($u(s));return s.id===n||i===o||ae(a[n])})}function Z8(t){return ae(t)?ol(t.pages).sort((n,i)=>{const r=yT(n),s=yT(i);return r===s?$u(n).localeCompare($u(i)):s-r}):[]}function W8e(t,e){if(!ae(t)||!ae(e))return!1;const n=YS(t,e.id);return ae(n)?!1:(t.pages.push(e),Zde(t),!0)}function Qde(t,e){const n=YS(t,e);if(ae(t)&&ae(n)){const i=ai(e);return t.pages=t.pages.filter(r=>r.id!==e&&i!==$u(r)),Zde(t),n}}function wb(t,e){if(ae(e)&&ae(e.kind))return ae(e.kinddata)||(e.kinddata=ae(e.id)?LN(t,e.kind):mB(t,e.kind)),e.kinddata}function oC(t,e,n){const i=wb(t,e);return(e==null?void 0:e[n])??(i==null?void 0:i[n])}function LN(t,e){const n=e??"",i=ed(t,Kn.OBJECT,n);if(ae(i)){const r=vl(i);return{...ol(r),name:n,code:i.code}}}function mB(t,e){const n=e??"",i=ed(t,Kn.TERRAIN,n);if(ae(i)){const r=vl(i);return{...ol(r),name:n,code:i.code}}}function mw(t,e){const n=YS(t,e);return vl(n)}function gB(t,e){return t?(t.flags[e]=t.flags[e]??{},t.flags[e]):{}}function Y8e(t,e){t&&delete t.flags[e]}function efe(t,e,n){const i=gB(t,e);return i==null?void 0:i[n]}function X8e(t,e,n,i){const r=gB(t,e);return r&&(r[n]=i),i}function K8e(t,e){const n=efe(t,e,"board");return mw(t,On(n)?n:"")}function J8e(t,e,n){if(!ae(t))return;X8e(t,e,"board",n);const i=mw(t,n);ae(i)?t.activelist.includes(e)||t.activelist.push(e):t.activelist=t.activelist.filter(r=>r!==e)}function W1(t,e,n,i){if(!ae(t))return;const r=K8e(t,e);if(!ae(r))return;const s=ry(r,e);if(!Mg(s)||!(s!=null&&s.id))return;const a=mw(t,n);if(!ae(a)||(hl(t,a),EW(t,a,bs.ISWALK,i)))return;delete r.objects[s.id];const o=vT(r,s);r.lookup&&(r.lookup[o]=void 0),s.x=i.x,s.y=i.y,a.objects[s.id]=s;const c=vT(a,s);a.lookup&&(a.lookup[c]=s.id),J8e(t,e,a.id)}function Z8e(t){const n=((t==null?void 0:t.activelist)??[]).map(i=>{const r=efe(t,i,"board");return On(r)?r:""});return Fze(n)}function Q8e(t){const e=Z8e(t),n=new Set,i=[];for(let r=0;r<e.length;++r){const s=mw(t,e[r]);if(ae(s)&&!n.has(s.id)){if(On(s.over))if(On(s.overboard)){const a=mw(t,s.overboard);ae(a)?n.has(a.id)||i.push(a):delete s.overboard}else{const a=Gf(t,Kn.BOARD,s.over);if(a.length){const o=Xa(a),c=vl(o);ae(c)&&(s.overboard=c.id)}}else On(s.overboard)&&delete s.overboard;if(i.push(s),On(s.under))if(On(s.underboard)){const a=mw(t,s.underboard);ae(a)||delete s.underboard}else{const a=Gf(t,Kn.BOARD,s.under);if(a.length){const o=Xa(a),c=vl(o);ae(c)&&(s.underboard=c.id)}}else On(s.underboard)&&delete s.underboard}}return i}function tfe(t){return E_(t.x,t.y,0,fi-1,jr-1,0)}function eHe(t,e,n,i,r){if(!ae(e))return;ae(e.distmaps)||(e.distmaps={});const s=`${n}.${i.x}.${i.y}.${r.x}.${r.y}`;let a=e.distmaps[s];if(!ae(a)){a=new Array(Bde).fill(-2);const o=[{...r}];let c=0;for(;o.length;){const l=o.shift();if(ae(l)&&tfe(l)){const u=mT(l,fi);if(a[u]===-2){const h=$7(e,l.x,l.y);W7(n,oC(t,h,"collision")??bs.ISWALK)||(a[u]=c,o.push({x:l.x,y:l.y-1},{x:l.x,y:l.y+1},{x:l.x-1,y:l.y},{x:l.x+1,y:l.y})),++c}}}e.distmaps[s]=a}return a}function see(t,e){return tfe(t)?e[mT(t,fi)]:-1}function aee(t,e,n,i,r,s){if(!ae(t)||!ae(e))return;const a=eHe(t,e,n,i,r);if(!ae(a))return;const o=[{x:i.x,y:i.y-1},{x:i.x,y:i.y+1},{x:i.x-1,y:i.y},{x:i.x+1,y:i.y}];let c;if(s){let l=s?0:1e4;for(let u=0;u<o.length;++u){const h=see(o[u],a);h>=0&&h>l&&(l=h,c=o[u])}}else{let l=1e5;for(let u=0;u<o.length;++u){const h=see(o[u],a);h>=0&&h<l&&(l=h,c=o[u])}}return c}function hl(t,e){var o;if(!ae(t)||!ae(e)||ae(e.lookup)&&ae(e.named))return;const n=new Array(fi*jr).fill(void 0),i={},r=Object.values(e.objects);for(let c=0;c<r.length;++c){const l=r[c];if(ae(l.x)&&ae(l.y)&&ae(l.id)&&!ae(l.removed)){l.category=uT.ISOBJECT,n[l.x+l.y*fi]=l.id;const u=ai(l.name??((o=l.kinddata)==null?void 0:o.name)??"");i[u]||(i[u]=new Set),i[u].add(l.id)}}let s=0,a=0;for(let c=0;c<e.terrain.length;++c){const l=e.terrain[c];if(ae(l)){l.x=s,l.y=a,l.category=uT.ISTERRAIN;const u=XC(l);i[u]||(i[u]=new Set),i[u].add(c)}++s,s>=fi&&(s=0,++a)}e.lookup=n,e.named=i}function oee(t,e,n,i){var s;if(!ae(t)||!ae(e)||!ae(e.named)||!ae(n))return;const r=ai(n.name??((s=n.kinddata)==null?void 0:s.name)??"");e.named[r]||(e.named[r]=new Set),e.named[r].add((n==null?void 0:n.id)??i??"")}function tHe(t,e,n){if(!(!ae(t)||!ae(e)||!ae(e.lookup)||!ae(n==null?void 0:n.id))&&!ae(n.removed)){const i=n.x??0,r=n.y??0;e.lookup[i+r*fi]=n.id}}function nHe(t,e,n){var i;if(ae(t)&&ae(e)&&ae(n==null?void 0:n.x)&&ae(n.y)){const r=XC(n),s=vT(e,n);ae((i=e.named)==null?void 0:i[r])&&e.named[r].delete(s)}}function nfe(t,e,n){var i;if(ae(t)&&ae(e)&&ae(n==null?void 0:n.id)){if(ae(e.lookup)&&ae(n.x)&&ae(n.y)){const s=n.x+n.y*fi;e.lookup[s]===n.id&&(e.lookup[s]=void 0)}const r=XC(n);ae((i=e.named)==null?void 0:i[r])&&ae(n.id)&&e.named[r].delete(n.id)}}function ife(t,e,n,i,r,s){if(!ae(t)||!ae(e)||!ae(n))return{x:0,y:0};const a={x:n.x??0,y:n.y??0},o={x:n.lx??a.x,y:n.ly??a.y},c=Ev(o,a),l=fi-1,u=jr-1;for(let h=0;h<r.length;++h){const d=Gze(r[h]);switch(d){case rn.IDLE:break;case rn.NORTH:case rn.SOUTH:case rn.WEST:case rn.EAST:ic(a,d);break;case rn.BY:{const[f,p]=r.slice(h+1);pn(f)&&pn(p)&&(a.x=Er(a.x+f,0,l),a.y=Er(a.y+p,0,u)),h+=2;break}case rn.TO:case rn.AT:{const[f,p]=r.slice(h+1);pn(f)&&pn(p)&&(a.x=Er(f,0,l),a.y=Er(p,0,u)),h+=2;break}case rn.FLOW:ic(a,c);break;case rn.SEEK:{const f=H8e(e,n,i);rC(f)&&ic(a,Ev(s,f));break}case rn.RNDNS:ic(a,Xa(rn.NORTH,rn.SOUTH));break;case rn.RNDNE:ic(a,Xa(rn.NORTH,rn.EAST));break;case rn.RND:ic(a,Xa(rn.NORTH,rn.SOUTH,rn.WEST,rn.EAST));break;case rn.CW:case rn.CCW:case rn.OPP:case rn.RNDP:{const f=ife(t,e,n,i,r.slice(h+1),s);switch(a.x=s.x,a.y=s.y,d){case rn.CW:switch(Ev(s,f)){case rn.NORTH:ic(a,rn.EAST);break;case rn.SOUTH:ic(a,rn.WEST);break;case rn.EAST:ic(a,rn.SOUTH);break;case rn.WEST:ic(a,rn.NORTH);break}break;case rn.CCW:switch(Ev(s,f)){case rn.NORTH:ic(a,rn.WEST);break;case rn.SOUTH:ic(a,rn.EAST);break;case rn.EAST:ic(a,rn.NORTH);break;case rn.WEST:ic(a,rn.SOUTH);break}break;case rn.OPP:switch(Ev(s,f)){case rn.NORTH:ic(a,rn.SOUTH);break;case rn.SOUTH:ic(a,rn.NORTH);break;case rn.EAST:ic(a,rn.WEST);break;case rn.WEST:ic(a,rn.EAST);break}break;case rn.RNDP:switch(Ev(s,f)){case rn.NORTH:case rn.SOUTH:a.x+=Xa(-1,1);break;case rn.WEST:case rn.EAST:a.y+=Xa(-1,1);break}break}break}case rn.FLEE:case rn.AWAY:{const[f,p]=r.slice(h+1);if(pn(f)&&pn(p)){const g={x:Er(f,0,l),y:Er(p,0,u)},_=oC(t,n,"collision"),v=aee(t,e,_,a,g,!0);ae(v)&&(a.x=v.x,a.y=v.y)}h+=2;break}case rn.FIND:case rn.TOWARD:{const[f,p]=r.slice(h+1);if(pn(f)&&pn(p)){const g={x:Er(f,0,l),y:Er(p,0,u)};if(Uf(1,100)<5)ic(a,Xa(rn.NORTH,rn.SOUTH,rn.WEST,rn.EAST));else{const _=oC(t,n,"collision"),v=aee(t,e,_,a,g,!1);if(ae(v))if(v.x!==f&&v.y!==p&&z8e(e,v))switch(Ev(s,v)){case rn.EAST:case rn.WEST:a.y+=Xa(-1,1);break;case rn.NORTH:case rn.SOUTH:a.x+=Xa(-1,1);break}else a.x=v.x,a.y=v.y}}h+=2;break}case rn.PLAYER:{const f=nO(e,s,i);rC(f)&&(a.x=f.x,a.y=f.y);break}}}return a}function iHe(t,e,n,i){if(ae(t)&&ae(e)&&ae(n)){const[r,s]=n,a=LN(t,r);if(ae(a)&&ae(a.name)){const o=Fde(e,i,r);return O2(o,s),o}}}function _T(t,e,n,i,r){if(ae(t)&&ae(e)&&ae(n)){const[s,a]=n,o=mB(t,s);if(ae(o)){const l=F8e(e,i,s);if(ae(l)){O2(l,a);const u=mT(i,fi);return wb(t,l),oee(t,e,l,u),l}}const c=LN(t,s);if(ae(c)&&ae(c.name)){const l=Fde(e,i,s,r);if(ae(l))return O2(l,a),tHe(t,e,l),wb(t,l),oee(t,e,l),l}}}function sy(t,e,n,i){return!ae(n)||XC(n)==="player"?!1:(n.id?(n.removed=i,nfe(t,e,n)):(Og(e,{x:(n==null?void 0:n.x)??0,y:(n==null?void 0:n.y)??0}),nHe(t,e,n)),!0)}function EW(t,e,n,i){if(!ae(t)||!ae(e)||!ae(e.lookup)||i.x<0||i.x>=fi||i.y<0||i.y>=jr)return!0;const r=i.x+i.y*fi,s=ry(e,e.lookup[r]??"404");if(ae(s))return!0;const a=e.terrain[r];if(ae(a)){const o=wb(t,a),c=a.collision??(o==null?void 0:o.collision);return W7(n,c)}return!1}function rHe(t,e,n,i){const r=ry(e,(n==null?void 0:n.id)??""),s=(r==null?void 0:r.x)??-1,a=(r==null?void 0:r.y)??-1;if(s-i.x===0&&a-i.y===0)return!0;const o=oC(t,r,"collision");return EW(t,e,o,i)}function rfe(t,e,n,i){var d;const r=ry(e,(n==null?void 0:n.id)??"");if(!ae(t)||!ae(e)||!ae(r)||!ae(r.x)||!ae(r.y)||!ae(e.lookup)||i.x<0||i.x>=fi||i.y<0||i.y>=jr)return{name:"edge",kind:"edge",collision:bs.ISSOLID,x:i.x,y:i.y};if(r.x-i.x===0&&r.y-i.y===0)return;const s=vT(e,r),a=vT(e,i),o=oC(t,r,"collision")??bs.ISWALK,c=sb(r==null?void 0:r.id),l=ry(e,e.lookup[a]??""),u=sb((l==null?void 0:l.id)??"");if(ae(l)&&(!c||!u))return{...l};const h=e.terrain[a];if(ae(h)){const f=h.collision??((d=h==null?void 0:h.kinddata)==null?void 0:d.collision)??bs.ISWALK;if(W7(o,f))return{...h,x:i.x,y:i.y}}r.x=i.x,r.y=i.y,ae(r.removed)||(e.lookup[s]=void 0,e.lookup[a]=r.id??"")}var sfe={exports:{}},Q8={exports:{}},cee;function sHe(){return cee||(cee=1,function(t,e){(function(n,i){t.exports=i()})(Ll,function(){function n(g){return!isNaN(parseFloat(g))&&isFinite(g)}function i(g){return g.charAt(0).toUpperCase()+g.substring(1)}function r(g){return function(){return this[g]}}var s=["isConstructor","isEval","isNative","isToplevel"],a=["columnNumber","lineNumber"],o=["fileName","functionName","source"],c=["args"],l=["evalOrigin"],u=s.concat(a,o,c,l);function h(g){if(g)for(var _=0;_<u.length;_++)g[u[_]]!==void 0&&this["set"+i(u[_])](g[u[_]])}h.prototype={getArgs:function(){return this.args},setArgs:function(g){if(Object.prototype.toString.call(g)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=g},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(g){if(g instanceof h)this.evalOrigin=g;else if(g instanceof Object)this.evalOrigin=new h(g);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var g=this.getFileName()||"",_=this.getLineNumber()||"",v=this.getColumnNumber()||"",E=this.getFunctionName()||"";return this.getIsEval()?g?"[eval] ("+g+":"+_+":"+v+")":"[eval]:"+_+":"+v:E?E+" ("+g+":"+_+":"+v+")":g+":"+_+":"+v}},h.fromString=function(_){var v=_.indexOf("("),E=_.lastIndexOf(")"),T=_.substring(0,v),x=_.substring(v+1,E).split(","),N=_.substring(E+1);if(N.indexOf("@")===0)var A=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(N,""),I=A[1],k=A[2],L=A[3];return new h({functionName:T,args:x||void 0,fileName:I,lineNumber:k||void 0,columnNumber:L||void 0})};for(var d=0;d<s.length;d++)h.prototype["get"+i(s[d])]=r(s[d]),h.prototype["set"+i(s[d])]=function(g){return function(_){this[g]=!!_}}(s[d]);for(var f=0;f<a.length;f++)h.prototype["get"+i(a[f])]=r(a[f]),h.prototype["set"+i(a[f])]=function(g){return function(_){if(!n(_))throw new TypeError(g+" must be a Number");this[g]=Number(_)}}(a[f]);for(var p=0;p<o.length;p++)h.prototype["get"+i(o[p])]=r(o[p]),h.prototype["set"+i(o[p])]=function(g){return function(_){this[g]=String(_)}}(o[p]);return h})}(Q8)),Q8.exports}(function(t,e){(function(n,i){t.exports=i(sHe())})(Ll,function(i){var r=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,a=/^(eval@)?(\[native code])?$/;return{parse:function(c){if(typeof c.stacktrace<"u"||typeof c["opera#sourceloc"]<"u")return this.parseOpera(c);if(c.stack&&c.stack.match(s))return this.parseV8OrIE(c);if(c.stack)return this.parseFFOrSafari(c);throw new Error("Cannot parse given Error object")},extractLocation:function(c){if(c.indexOf(":")===-1)return[c];var l=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=l.exec(c.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return l.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var h=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=h.match(/ (\(.+\)$)/);h=d?h.replace(d[0],""):h;var f=this.extractLocation(d?d[1]:h),p=d&&h||void 0,g=["eval","<anonymous>"].indexOf(f[0])>-1?void 0:f[0];return new i({functionName:p,fileName:g,lineNumber:f[1],columnNumber:f[2],source:u})},this)},parseFFOrSafari:function(c){var l=c.stack.split(`
`).filter(function(u){return!u.match(a)},this);return l.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new i({functionName:u});var h=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(h),f=d&&d[1]?d[1]:void 0,p=this.extractLocation(u.replace(h,""));return new i({functionName:f,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(c){return!c.stacktrace||c.message.indexOf(`
`)>-1&&c.message.split(`
`).length>c.stacktrace.split(`
`).length?this.parseOpera9(c):c.stack?this.parseOpera11(c):this.parseOpera10(c)},parseOpera9:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)/i,u=c.message.split(`
`),h=[],d=2,f=u.length;d<f;d+=2){var p=l.exec(u[d]);p&&h.push(new i({fileName:p[2],lineNumber:p[1],source:u[d]}))}return h},parseOpera10:function(c){for(var l=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=c.stacktrace.split(`
`),h=[],d=0,f=u.length;d<f;d+=2){var p=l.exec(u[d]);p&&h.push(new i({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[d]}))}return h},parseOpera11:function(c){var l=c.stack.split(`
`).filter(function(u){return!!u.match(r)&&!u.match(/^Error created at/)},this);return l.map(function(u){var h=u.split("@"),d=this.extractLocation(h.pop()),f=h.shift()||"",p=f.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,g;f.match(/\(([^)]*)\)/)&&(g=f.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var _=g===void 0||g==="[arguments not available]"?void 0:g.split(",");return new i({functionName:p,args:_,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(sfe);var aHe=sfe.exports;const oHe=Gc(aHe);function i0(t){const e={},n={tick(){},everytick(){},listcommands(){return G3(e)},...t,getcommand(i){return e[i]},command(i,r){return e[i]=r,n}};return n}function na(t){return`${t??""}`}function DS(t,e){const n=parseFloat(na(t));return isNaN(n)?e:n}function ou(t,e){return typeof t==typeof e?t:e}function lee(t,e,n){var r;const[i]=Ot(e,0,[st.MAYBE_NAME]);b_(Ge,t,((r=ne.board)==null?void 0:r.id)??"",i??"",n)}function If(t,e,n,i){const[r,s]=Ot(i,0,[st.NUMBER_OR_STRING,st.MAYBE_NUMBER_OR_STRING]);Aue(Ge,t,e,n,r,s)}const cHe=["echo","reverb","phaser","distortion","vibrato","fc"];function afe(t,e,n){const[i,r]=Ot(n,0,[st.NUMBER_OR_STRING]);if(pn(i))B8(Ge,t,e,"volume",i);else if(cHe.includes(ai(i))){const[s,a]=Ot(n,r,[st.NUMBER_OR_STRING,st.MAYBE_NUMBER_OR_STRING]);Aue(Ge,t,e,i,s,a)}else{const[s]=Ot(n,r,[st.MAYBE_NUMBER_OR_STRING]);if(pn(s)){const a=n.length-r,o=new Array(a).fill(st.NUMBER),c=Ot(n,r,o).slice(0,a),l=c.length===1?c[0]:c;B8(Ge,t,e,i,l)}else{const[a]=Ot(n,r,[st.MAYBE_NUMBER_OR_STRING]);B8(Ge,t,e,i,a)}}}const SW=i0().command("talk",(t,e)=>{const[n]=Ot(e,0,[st.ANY]);switch(ai(n)){default:mDe(Ge,ne.elementfocus);break;case"stop":gDe(Ge,ne.elementfocus);break}return 0}).command("media",(t,e)=>{const[n]=Ot(e,0,[st.ANY]);switch(ai(n)){default:vDe(Ge,ne.elementfocus);break;case"stop":yDe(Ge,ne.elementfocus);break}return 0}).command("tts",(t,e)=>{const[n,i]=Ot(e,0,[st.STRING]),r=e.slice(i).map(na).join("");return ODe(Ge,ne.elementfocus,n,r),0}).command("tta",(t,e)=>{const n=e.map(na).join("");return NDe(Ge,ne.elementfocus,n),0}).command("bpm",(t,e)=>{const[n]=Ot(e,0,[st.NUMBER]);return IDe(Ge,ne.elementfocus,n),0}).command("vol",(t,e)=>{const[n]=Ot(e,0,[st.NUMBER]);return kDe(Ge,ne.elementfocus,n),0}).command("bgvol",(t,e)=>{const[n]=Ot(e,0,[st.NUMBER]);return DDe(Ge,ne.elementfocus,n),0}).command("ttsvol",(t,e)=>{const[n]=Ot(e,0,[st.NUMBER]);return PDe(Ge,ne.elementfocus,n),0}).command("play",(t,e)=>(lee(ne.elementfocus,e,!1),0)).command("bgplay",(t,e)=>(lee(ne.elementfocus,e,!0),0)).command("synth",(t,e)=>{for(let n=0;n<8;++n)afe(ne.elementfocus,n,e);return 0}).command("echo",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"echo",e);return 0}).command("fcrush",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"fc",e);return 0}).command("phaser",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"phaser",e);return 0}).command("reverb",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"reverb",e);return 0}).command("distort",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"distort",e);return 0}).command("vibrato",(t,e)=>{for(let n=0;n<3;++n)If(ne.elementfocus,n,"vibrato",e);return 0});for(let t=0;t<8;++t)SW.command(`synth${t+1}`,(e,n)=>(afe(ne.elementfocus,t,n),0));for(let t=0;t<3;++t){const e=t+1;SW.command(`echo${e}`,(n,i)=>(If(ne.elementfocus,t,"echo",i),0)).command(`fcrush${e}`,(n,i)=>(If(ne.elementfocus,t,"fcrush",i),0)).command(`phaser${e}`,(n,i)=>(If(ne.elementfocus,t,"phaser",i),0)).command(`reverb${e}`,(n,i)=>(If(ne.elementfocus,t,"reverb",i),0)).command(`distort${e}`,(n,i)=>(If(ne.elementfocus,t,"distort",i),0)).command(`vibrato${e}`,(n,i)=>(If(ne.elementfocus,t,"vibrato",i),0))}function uee(t,e,n){if(!rC(ne.element))return 0;const[i,r]=Ot(e,0,[st.DIR,st.MAYBE_KIND]),s=r??["bullet"],a=iHe(ne.book,ne.board,s,{x:ne.element.x,y:ne.element.y});if(ae(a)){ae(n)&&(a.arg=n),a.party=ne.elementid,a.collision=bs.ISBULLET,a.destructible=1,a.stepx=i.x-ne.element.x,a.stepy=i.y-ne.element.y,a.bg=Qt.ONCLEAR;const o=wb(ne.book,a),c=a.code??(o==null?void 0:o.code)??"";VGe(ne.book,ne.board,a,c,1)}return t.yield(),0}function rD(t,e,n,i){var h,d;if(!rC(ne.element)||!ae(ne.book)||!ae(ne.board)||!ae(ne.element))return 0;hl(ne.book,ne.board);const[r,s]=Ot(e,0,[st.DIR,st.KIND]),a=em(ne.board,r);if((a==null?void 0:a.category)===uT.ISOBJECT&&(a!=null&&a.pushable)){const f={x:((h=ne.element)==null?void 0:h.x)??0,y:((d=ne.element)==null?void 0:d.y)??0},p=ic(r,Ev(f,r));rfe(ne.book,ne.board,a,p)}const[o]=s,c=LN(ne.book,o)??mB(ne.book,o),l=(c==null?void 0:c.collision)??bs.ISWALK;if(!EW(ne.book,ne.board,l,r)){const f=_T(ne.book,ne.board,s,r,n);ae(f)&&ae(i)&&(f.arg=i)}return 0}const lHe=i0().command("board",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const[n,i]=Ot(e,0,[st.NAME]),[r,s]=Ot(e,i,[st.MAYBE_NUMBER,st.MAYBE_NUMBER]),a=Gf(ne.book,Kn.BOARD,n);if(a.length){const o=Xa(...a);ae(o)&&W1(ne.book,ne.elementfocus,o.id,{x:r??Math.round(fi*.5),y:s??Math.round(jr*.5)})}return 0}).command("edge",(t,e)=>{var s,a;if(!ae(ne.book)||!ae(ne.board)||!ae(ne.element))return 0;const[n,i]=Ot(e,0,[st.DIR,st.NAME]),r=Gf(ne.book,Kn.BOARD,i);if(r.length){const o={x:((s=ne.element)==null?void 0:s.x)??0,y:((a=ne.element)==null?void 0:a.y)??0},c=Ev(o,n),l=Xa(...r);switch(c){case rn.NORTH:ne.board.exitnorth=l.id;break;case rn.SOUTH:ne.board.exitsouth=l.id;break;case rn.WEST:ne.board.exitwest=l.id;break;case rn.EAST:ne.board.exiteast=l.id;break}}return 0}).command("shove",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;hl(ne.book,ne.board);const[n,i]=Ot(e,0,[st.DIR,st.DIR]),r=em(ne.board,n);return Mg(r)&&BV(ne.book,ne.board,r,i),0}).command("duplicate",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;hl(ne.book,ne.board);const[n,i]=Ot(e,0,[st.DIR,st.DIR]),r=em(ne.board,n);return Mg(r),0}).command("write",(t,e)=>{var l;if(!ae(ne.book)||!ae(ne.board))return 0;hl(ne.book,ne.board);const[n,i,r]=Ot(e,0,[st.DIR,st.COLOR,st.STRING]),{color:s,bg:a}=Upe(i),o=((l=$N(r,256,1))==null?void 0:l.measuredwidth)??1,c=Zb(256,1,s??Qt.WHITE,a??Qt.BLACK);ri(r,c,!1);for(let u=0;u<o;++u)Og(ne.board,{x:n.x+u,y:n.y,name:"text",char:c.char[u],color:c.color[u],bg:c.bg[u]});return 0}).command("change",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;hl(ne.book,ne.board);const[n,i]=Ot(e,0,[st.KIND,st.KIND]);(mV(n)??"")==="empty"&&j8e(ne.board).forEach(c=>{_T(ne.book,ne.board,i,c)});const s=mV(i),a=Tde(i),o=xde(i);return zde(ne.board,n).forEach(c=>{if(XC(c)===s)ae(a)&&(c.color=a),ae(o)&&(c.bg=o);else if(sy(ne.book,ne.board,c,ne.timestamp),s!=="empty"){const l={x:c.x??0,y:c.y??0};_T(ne.book,ne.board,i,l)}}),0}).command("put",(t,e)=>rD(t,e)).command("putwith",(t,e)=>{const[n,i]=Ot(e,0,[st.ANY]);return rD(t,e.slice(i),void 0,n)}).command("oneof",(t,e)=>{const[n,i]=Ot(e,0,[st.ANY]);return ae(ne.board)&&ry(ne.board,n)?0:rD(t,e.slice(i),n)}).command("oneofwith",(t,e)=>{const[n,i,r]=Ot(e,0,[st.ANY,st.ANY]);return ae(ne.board)&&ry(ne.board,i)?0:rD(t,e.slice(r),i,n)}).command("shoot",uee).command("shootwith",(t,e)=>{const[n,i]=Ot(e,0,[st.ANY]);return uee(t,e.slice(i),n)}),tm=()=>new Map,EV=t=>{const e=tm();return t.forEach((n,i)=>{e.set(i,n)}),e},Jb=(t,e,n)=>{let i=t.get(e);return i===void 0&&t.set(e,i=n()),i},uHe=(t,e)=>{const n=[];for(const[i,r]of t)n.push(e(r,i));return n},hHe=(t,e)=>{for(const[n,i]of t)if(e(i,n))return!0;return!1},cC=()=>new Set,eH=t=>t[t.length-1],dHe=(t,e)=>{for(let n=0;n<e.length;n++)t.push(e[n])},bT=Array.from,fHe=(t,e)=>{for(let n=0;n<t.length;n++)if(e(t[n],n,t))return!0;return!1},SV=Array.isArray;class ofe{constructor(){this._observers=tm()}on(e,n){return Jb(this._observers,e,cC).add(n),n}once(e,n){const i=(...r)=>{this.off(e,i),n(...r)};this.on(e,i)}off(e,n){const i=this._observers.get(e);i!==void 0&&(i.delete(n),i.size===0&&this._observers.delete(e))}emit(e,n){return bT((this._observers.get(e)||tm()).values()).forEach(i=>i(...n))}destroy(){this._observers=tm()}}const Cb=Math.floor,lP=Math.abs,cfe=(t,e)=>t<e?t:e,WT=(t,e)=>t>e?t:e,lfe=t=>t!==0?t<0:1/t<0,hee=1,dee=2,tH=4,nH=8,iO=32,Gv=64,qd=128,vB=31,TV=63,XS=127,pHe=2147483647,ufe=Number.MAX_SAFE_INTEGER,mHe=Number.isInteger||(t=>typeof t=="number"&&isFinite(t)&&Cb(t)===t),gHe=t=>t.toLowerCase(),vHe=/^\s*/g,yHe=t=>t.replace(vHe,""),_He=/([A-Z])/g,fee=(t,e)=>yHe(t.replace(_He,n=>`${e}${gHe(n)}`)),bHe=t=>{const e=unescape(encodeURIComponent(t)),n=e.length,i=new Uint8Array(n);for(let r=0;r<n;r++)i[r]=e.codePointAt(r);return i},rO=typeof TextEncoder<"u"?new TextEncoder:null,EHe=t=>rO.encode(t),SHe=rO?EHe:bHe;let tM=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});tM&&tM.decode(new Uint8Array).length===1&&(tM=null);class UN{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const yB=()=>new UN,THe=t=>{let e=t.cpos;for(let n=0;n<t.bufs.length;n++)e+=t.bufs[n].length;return e},yg=t=>{const e=new Uint8Array(THe(t));let n=0;for(let i=0;i<t.bufs.length;i++){const r=t.bufs[i];e.set(r,n),n+=r.length}return e.set(new Uint8Array(t.cbuf.buffer,0,t.cpos),n),e},xHe=(t,e)=>{const n=t.cbuf.length;n-t.cpos<e&&(t.bufs.push(new Uint8Array(t.cbuf.buffer,0,t.cpos)),t.cbuf=new Uint8Array(WT(n,e)*2),t.cpos=0)},nl=(t,e)=>{const n=t.cbuf.length;t.cpos===n&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(n*2),t.cpos=0),t.cbuf[t.cpos++]=e},xV=nl,Xr=(t,e)=>{for(;e>XS;)nl(t,qd|XS&e),e=Cb(e/128);nl(t,XS&e)},TW=(t,e)=>{const n=lfe(e);for(n&&(e=-e),nl(t,(e>TV?qd:0)|(n?Gv:0)|TV&e),e=Cb(e/64);e>0;)nl(t,(e>XS?qd:0)|XS&e),e=Cb(e/128)},wV=new Uint8Array(3e4),wHe=wV.length/3,CHe=(t,e)=>{if(e.length<wHe){const n=rO.encodeInto(e,wV).written||0;Xr(t,n);for(let i=0;i<n;i++)nl(t,wV[i])}else Rd(t,SHe(e))},RHe=(t,e)=>{const n=unescape(encodeURIComponent(e)),i=n.length;Xr(t,i);for(let r=0;r<i;r++)nl(t,n.codePointAt(r))},gw=rO&&rO.encodeInto?CHe:RHe,_B=(t,e)=>{const n=t.cbuf.length,i=t.cpos,r=cfe(n-i,e.length),s=e.length-r;t.cbuf.set(e.subarray(0,r),i),t.cpos+=r,s>0&&(t.bufs.push(t.cbuf),t.cbuf=new Uint8Array(WT(n*2,s)),t.cbuf.set(e.subarray(r)),t.cpos=s)},Rd=(t,e)=>{Xr(t,e.byteLength),_B(t,e)},xW=(t,e)=>{xHe(t,e);const n=new DataView(t.cbuf.buffer,t.cpos,e);return t.cpos+=e,n},AHe=(t,e)=>xW(t,4).setFloat32(0,e,!1),MHe=(t,e)=>xW(t,8).setFloat64(0,e,!1),OHe=(t,e)=>xW(t,8).setBigInt64(0,e,!1),pee=new DataView(new ArrayBuffer(4)),NHe=t=>(pee.setFloat32(0,t),pee.getFloat32(0)===t),sO=(t,e)=>{switch(typeof e){case"string":nl(t,119),gw(t,e);break;case"number":mHe(e)&&lP(e)<=pHe?(nl(t,125),TW(t,e)):NHe(e)?(nl(t,124),AHe(t,e)):(nl(t,123),MHe(t,e));break;case"bigint":nl(t,122),OHe(t,e);break;case"object":if(e===null)nl(t,126);else if(SV(e)){nl(t,117),Xr(t,e.length);for(let n=0;n<e.length;n++)sO(t,e[n])}else if(e instanceof Uint8Array)nl(t,116),Rd(t,e);else{nl(t,118);const n=Object.keys(e);Xr(t,n.length);for(let i=0;i<n.length;i++){const r=n[i];gw(t,r),sO(t,e[r])}}break;case"boolean":nl(t,e?120:121);break;default:nl(t,127)}};class mee extends UN{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Xr(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const gee=t=>{t.count>0&&(TW(t.encoder,t.count===1?t.s:-t.s),t.count>1&&Xr(t.encoder,t.count-2))};class uP{constructor(){this.encoder=new UN,this.s=0,this.count=0}write(e){this.s===e?this.count++:(gee(this),this.count=1,this.s=e)}toUint8Array(){return gee(this),yg(this.encoder)}}const vee=t=>{if(t.count>0){const e=t.diff*2+(t.count===1?0:1);TW(t.encoder,e),t.count>1&&Xr(t.encoder,t.count-2)}};class iH{constructor(){this.encoder=new UN,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(vee(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return vee(this),yg(this.encoder)}}class IHe{constructor(){this.sarr=[],this.s="",this.lensE=new uP}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new UN;return this.sarr.push(this.s),this.s="",gw(e,this.sarr.join("")),_B(e,this.lensE.toUint8Array()),yg(e)}}const Rb=t=>new Error(t),Ng=()=>{throw Rb("Method unimplemented")},Fg=()=>{throw Rb("Unexpected case")},hfe=Rb("Unexpected end of array"),dfe=Rb("Integer out of Range");class bB{constructor(e){this.arr=e,this.pos=0}}const KC=t=>new bB(t),kHe=t=>t.pos!==t.arr.length,DHe=(t,e)=>{const n=new Uint8Array(t.arr.buffer,t.pos+t.arr.byteOffset,e);return t.pos+=e,n},Ad=t=>DHe(t,Sr(t)),lC=t=>t.arr[t.pos++],Sr=t=>{let e=0,n=1;const i=t.arr.length;for(;t.pos<i;){const r=t.arr[t.pos++];if(e=e+(r&XS)*n,n*=128,r<qd)return e;if(e>ufe)throw dfe}throw hfe},wW=t=>{let e=t.arr[t.pos++],n=e&TV,i=64;const r=(e&Gv)>0?-1:1;if(!(e&qd))return r*n;const s=t.arr.length;for(;t.pos<s;){if(e=t.arr[t.pos++],n=n+(e&XS)*i,i*=128,e<qd)return r*n;if(n>ufe)throw dfe}throw hfe},PHe=t=>{let e=Sr(t);if(e===0)return"";{let n=String.fromCodePoint(lC(t));if(--e<100)for(;e--;)n+=String.fromCodePoint(lC(t));else for(;e>0;){const i=e<1e4?e:1e4,r=t.arr.subarray(t.pos,t.pos+i);t.pos+=i,n+=String.fromCodePoint.apply(null,r),e-=i}return decodeURIComponent(escape(n))}},LHe=t=>tM.decode(Ad(t)),vw=tM?LHe:PHe,CW=(t,e)=>{const n=new DataView(t.arr.buffer,t.arr.byteOffset+t.pos,e);return t.pos+=e,n},UHe=t=>CW(t,4).getFloat32(0,!1),BHe=t=>CW(t,8).getFloat64(0,!1),FHe=t=>CW(t,8).getBigInt64(0,!1),zHe=[t=>{},t=>null,wW,UHe,BHe,FHe,t=>!1,t=>!0,vw,t=>{const e=Sr(t),n={};for(let i=0;i<e;i++){const r=vw(t);n[r]=aO(t)}return n},t=>{const e=Sr(t),n=[];for(let i=0;i<e;i++)n.push(aO(t));return n},Ad],aO=t=>zHe[127-lC(t)](t);class yee extends bB{constructor(e,n){super(e),this.reader=n,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),kHe(this)?this.count=Sr(this)+1:this.count=-1),this.count--,this.s}}class hP extends bB{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=wW(this);const e=lfe(this.s);this.count=1,e&&(this.s=-this.s,this.count=Sr(this)+2)}return this.count--,this.s}}class rH extends bB{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=wW(this),n=e&1;this.diff=Cb(e/2),this.count=1,n&&(this.count=Sr(this)+2)}return this.s+=this.diff,this.count--,this.s}}class HHe{constructor(e){this.decoder=new hP(e),this.str=vw(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),n=this.str.slice(this.spos,e);return this.spos=e,n}}const jHe=crypto.getRandomValues.bind(crypto),ffe=()=>jHe(new Uint32Array(1))[0],VHe="10000000-1000-4000-8000"+-1e11,GHe=()=>VHe.replace(/[018]/g,t=>(t^ffe()&15>>t/4).toString(16)),qHe=Date.now,_ee=t=>new Promise(t);Promise.all.bind(Promise);const bee=t=>t===void 0?null:t;class $He{constructor(){this.map=new Map}setItem(e,n){this.map.set(e,n)}getItem(e){return this.map.get(e)}}let pfe=new $He,WHe=!0;try{typeof localStorage<"u"&&localStorage&&(pfe=localStorage,WHe=!1)}catch{}const YHe=pfe,XHe=Object.assign,KHe=Object.keys,JHe=(t,e)=>{for(const n in t)e(t[n],n)},Eee=t=>KHe(t).length,ZHe=t=>{for(const e in t)return!1;return!0},QHe=(t,e)=>{for(const n in t)if(!e(t[n],n))return!1;return!0},eje=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),tje=(t,e)=>t===e||Eee(t)===Eee(e)&&QHe(t,(n,i)=>(n!==void 0||eje(e,i))&&e[i]===n),nje=Object.freeze,mfe=t=>{for(const e in t){const n=t[e];(typeof n=="object"||typeof n=="function")&&mfe(t[e])}return nje(t)},RW=(t,e,n=0)=>{try{for(;n<t.length;n++)t[n](...e)}finally{n<t.length&&RW(t,e,n+1)}},ije=t=>t,rje=(t,e)=>e.includes(t);var gfe={};const oO=typeof zn<"u"&&zn.release&&/node|io\.js/.test(zn.release.name)&&Object.prototype.toString.call(typeof zn<"u"?zn:0)==="[object process]";let Km;const sje=()=>{if(Km===void 0)if(oO){Km=tm();const t=zn.argv;let e=null;for(let n=0;n<t.length;n++){const i=t[n];i[0]==="-"?(e!==null&&Km.set(e,""),e=i):e!==null&&(Km.set(e,i),e=null)}e!==null&&Km.set(e,"")}else typeof location=="object"?(Km=tm(),(location.search||"?").slice(1).split("&").forEach(t=>{if(t.length!==0){const[e,n]=t.split("=");Km.set(`--${fee(e,"-")}`,n),Km.set(`-${fee(e,"-")}`,n)}})):Km=tm();return Km},CV=t=>sje().has(t),z2=t=>bee(oO?gfe[t.toUpperCase().replaceAll("-","_")]:YHe.getItem(t)),vfe=t=>CV("--"+t)||z2(t)!==null;vfe("production");const aje=oO&&rje(gfe.FORCE_COLOR,["true","1","2"]),oje=aje||!CV("--no-colors")&&!vfe("no-color")&&(!oO||zn.stdout.isTTY)&&(!oO||CV("--color")||z2("COLORTERM")!==null||(z2("TERM")||"").includes("color")),cje=t=>new Uint8Array(t),lje=t=>{const e=cje(t.byteLength);return e.set(t),e};class uje{constructor(e,n){this.left=e,this.right=n}}const fv=(t,e)=>new uje(t,e);typeof DOMParser<"u"&&new DOMParser;const hje=t=>uHe(t,(e,n)=>`${n}:${e};`).join(""),gy=Symbol,yfe=gy(),_fe=gy(),dje=gy(),fje=gy(),pje=gy(),bfe=gy(),mje=gy(),AW=gy(),gje=gy(),vje=t=>{var r;t.length===1&&((r=t[0])==null?void 0:r.constructor)===Function&&(t=t[0]());const e=[],n=[];let i=0;for(;i<t.length;i++){const s=t[i];if(s===void 0)break;if(s.constructor===String||s.constructor===Number)e.push(s);else if(s.constructor===Object)break}for(i>0&&n.push(e.join(""));i<t.length;i++){const s=t[i];s instanceof Symbol||n.push(s)}return n},yje={[yfe]:fv("font-weight","bold"),[_fe]:fv("font-weight","normal"),[dje]:fv("color","blue"),[pje]:fv("color","green"),[fje]:fv("color","grey"),[bfe]:fv("color","red"),[mje]:fv("color","purple"),[AW]:fv("color","orange"),[gje]:fv("color","black")},_je=t=>{var a;t.length===1&&((a=t[0])==null?void 0:a.constructor)===Function&&(t=t[0]());const e=[],n=[],i=tm();let r=[],s=0;for(;s<t.length;s++){const o=t[s],c=yje[o];if(c!==void 0)i.set(c.left,c.right);else{if(o===void 0)break;if(o.constructor===String||o.constructor===Number){const l=hje(i);s>0||l.length>0?(e.push("%c"+o),n.push(l)):e.push(o)}else break}}for(s>0&&(r=n,r.unshift(e.join("")));s<t.length;s++){const o=t[s];o instanceof Symbol||r.push(o)}return r},Efe=oje?_je:vje,bje=(...t)=>{console.log(...Efe(t)),Tfe.forEach(e=>e.print(t))},Sfe=(...t)=>{console.warn(...Efe(t)),t.unshift(AW),Tfe.forEach(e=>e.print(t))},Tfe=cC(),xfe=t=>({[Symbol.iterator](){return this},next:t}),Eje=(t,e)=>xfe(()=>{let n;do n=t.next();while(!n.done&&!e(n.value));return n}),sH=(t,e)=>xfe(()=>{const{done:n,value:i}=t.next();return{done:n,value:n?void 0:e(i)}});class MW{constructor(e,n){this.clock=e,this.len=n}}class JC{constructor(){this.clients=new Map}}const uC=(t,e,n)=>e.clients.forEach((i,r)=>{const s=t.doc.store.clients.get(r);for(let a=0;a<i.length;a++){const o=i[a];kfe(t,s,o.clock,o.len,n)}}),Sje=(t,e)=>{let n=0,i=t.length-1;for(;n<=i;){const r=Cb((n+i)/2),s=t[r],a=s.clock;if(a<=e){if(e<a+s.len)return r;n=r+1}else i=r-1}return null},BN=(t,e)=>{const n=t.clients.get(e.client);return n!==void 0&&Sje(n,e.clock)!==null},OW=t=>{t.clients.forEach(e=>{e.sort((r,s)=>r.clock-s.clock);let n,i;for(n=1,i=1;n<e.length;n++){const r=e[i-1],s=e[n];r.clock+r.len>=s.clock?r.len=WT(r.len,s.clock+s.len-r.clock):(i<n&&(e[i]=s),i++)}e.length=i})},RV=t=>{const e=new JC;for(let n=0;n<t.length;n++)t[n].clients.forEach((i,r)=>{if(!e.clients.has(r)){const s=i.slice();for(let a=n+1;a<t.length;a++)dHe(s,t[a].clients.get(r)||[]);e.clients.set(r,s)}});return OW(e),e},cO=(t,e,n,i)=>{Jb(t.clients,e,()=>[]).push(new MW(n,i))},Tje=()=>new JC,xje=t=>{const e=Tje();return t.clients.forEach((n,i)=>{const r=[];for(let s=0;s<n.length;s++){const a=n[s];if(a.deleted){const o=a.id.clock;let c=a.length;if(s+1<n.length)for(let l=n[s+1];s+1<n.length&&l.deleted;l=n[++s+1])c+=l.length;r.push(new MW(o,c))}}r.length>0&&e.clients.set(i,r)}),e},ZC=(t,e)=>{Xr(t.restEncoder,e.clients.size),bT(e.clients.entries()).sort((n,i)=>i[0]-n[0]).forEach(([n,i])=>{t.resetDsCurVal(),Xr(t.restEncoder,n);const r=i.length;Xr(t.restEncoder,r);for(let s=0;s<r;s++){const a=i[s];t.writeDsClock(a.clock),t.writeDsLen(a.len)}})},NW=t=>{const e=new JC,n=Sr(t.restDecoder);for(let i=0;i<n;i++){t.resetDsCurVal();const r=Sr(t.restDecoder),s=Sr(t.restDecoder);if(s>0){const a=Jb(e.clients,r,()=>[]);for(let o=0;o<s;o++)a.push(new MW(t.readDsClock(),t.readDsLen()))}}return e},See=(t,e,n)=>{const i=new JC,r=Sr(t.restDecoder);for(let s=0;s<r;s++){t.resetDsCurVal();const a=Sr(t.restDecoder),o=Sr(t.restDecoder),c=n.clients.get(a)||[],l=Lc(n,a);for(let u=0;u<o;u++){const h=t.readDsClock(),d=h+t.readDsLen();if(h<l){l<d&&cO(i,a,l,d-l);let f=zg(c,h),p=c[f];for(!p.deleted&&p.id.clock<h&&(c.splice(f+1,0,Y2(e,p,h-p.id.clock)),f++);f<c.length&&(p=c[f++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&c.splice(f,0,Y2(e,p,d-p.id.clock)),p.delete(e))}else cO(i,a,h,d-h)}}if(i.clients.size>0){const s=new ET;return Xr(s.restEncoder,0),ZC(s,i),s.toUint8Array()}return null},wfe=ffe;class YT extends ofe{constructor({guid:e=GHe(),collectionid:n=null,gc:i=!0,gcFilter:r=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=i,this.gcFilter=r,this.clientID=wfe(),this.guid=e,this.collectionid=n,this.share=new Map,this.store=new Nfe,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=_ee(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})});const c=()=>_ee(l=>{const u=h=>{(h===void 0||h===!0)&&(this.off("sync",u),l())};this.on("sync",u)});this.on("sync",l=>{l===!1&&this.isSynced&&(this.whenSynced=c()),this.isSynced=l===void 0||l===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=c()}load(){const e=this._item;e!==null&&!this.shouldLoad&&qs(e.parent.doc,n=>{n.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(bT(this.subdocs).map(e=>e.guid))}transact(e,n=null){return qs(this,e,n)}get(e,n=fl){const i=Jb(this.share,e,()=>{const s=new n;return s._integrate(this,null),s}),r=i.constructor;if(n!==fl&&r!==n)if(r===fl){const s=new n;s._map=i._map,i._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=i._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=i._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return i}getArray(e=""){return this.get(e,_w)}getText(e=""){return this.get(e,Hg)}getMap(e=""){return this.get(e,dC)}getXmlElement(e=""){return this.get(e,fC)}getXmlFragment(e=""){return this.get(e,ST)}toJSON(){const e={};return this.share.forEach((n,i)=>{e[i]=n.toJSON()}),e}destroy(){this.isDestroyed=!0,bT(this.subdocs).forEach(n=>n.destroy());const e=this._item;if(e!==null){this._item=null;const n=e.content;n.doc=new YT({guid:this.guid,...n.opts,shouldLoad:!1}),n.doc._item=e,qs(e.parent.doc,i=>{const r=n.doc;e.deleted||i.subdocsAdded.add(r),i.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class Cfe{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Sr(this.restDecoder)}readDsLen(){return Sr(this.restDecoder)}}class Rfe extends Cfe{readLeftID(){return Tr(Sr(this.restDecoder),Sr(this.restDecoder))}readRightID(){return Tr(Sr(this.restDecoder),Sr(this.restDecoder))}readClient(){return Sr(this.restDecoder)}readInfo(){return lC(this.restDecoder)}readString(){return vw(this.restDecoder)}readParentInfo(){return Sr(this.restDecoder)===1}readTypeRef(){return Sr(this.restDecoder)}readLen(){return Sr(this.restDecoder)}readAny(){return aO(this.restDecoder)}readBuf(){return lje(Ad(this.restDecoder))}readJSON(){return JSON.parse(vw(this.restDecoder))}readKey(){return vw(this.restDecoder)}}class wje{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Sr(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Sr(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class hC extends wje{constructor(e){super(e),this.keys=[],Sr(e),this.keyClockDecoder=new rH(Ad(e)),this.clientDecoder=new hP(Ad(e)),this.leftClockDecoder=new rH(Ad(e)),this.rightClockDecoder=new rH(Ad(e)),this.infoDecoder=new yee(Ad(e),lC),this.stringDecoder=new HHe(Ad(e)),this.parentInfoDecoder=new yee(Ad(e),lC),this.typeRefDecoder=new hP(Ad(e)),this.lenDecoder=new hP(Ad(e))}readLeftID(){return new yw(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new yw(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return aO(this.restDecoder)}readBuf(){return Ad(this.restDecoder)}readJSON(){return aO(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const n=this.stringDecoder.read();return this.keys.push(n),n}}}class Cje{constructor(){this.restEncoder=yB()}toUint8Array(){return yg(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Xr(this.restEncoder,e)}writeDsLen(e){Xr(this.restEncoder,e)}}class FN extends Cje{writeLeftID(e){Xr(this.restEncoder,e.client),Xr(this.restEncoder,e.clock)}writeRightID(e){Xr(this.restEncoder,e.client),Xr(this.restEncoder,e.clock)}writeClient(e){Xr(this.restEncoder,e)}writeInfo(e){xV(this.restEncoder,e)}writeString(e){gw(this.restEncoder,e)}writeParentInfo(e){Xr(this.restEncoder,e?1:0)}writeTypeRef(e){Xr(this.restEncoder,e)}writeLen(e){Xr(this.restEncoder,e)}writeAny(e){sO(this.restEncoder,e)}writeBuf(e){Rd(this.restEncoder,e)}writeJSON(e){gw(this.restEncoder,JSON.stringify(e))}writeKey(e){gw(this.restEncoder,e)}}class Rje{constructor(){this.restEncoder=yB(),this.dsCurrVal=0}toUint8Array(){return yg(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const n=e-this.dsCurrVal;this.dsCurrVal=e,Xr(this.restEncoder,n)}writeDsLen(e){e===0&&Fg(),Xr(this.restEncoder,e-1),this.dsCurrVal+=e}}class ET extends Rje{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new iH,this.clientEncoder=new uP,this.leftClockEncoder=new iH,this.rightClockEncoder=new iH,this.infoEncoder=new mee(xV),this.stringEncoder=new IHe,this.parentInfoEncoder=new mee(xV),this.typeRefEncoder=new uP,this.lenEncoder=new uP}toUint8Array(){const e=yB();return Xr(e,0),Rd(e,this.keyClockEncoder.toUint8Array()),Rd(e,this.clientEncoder.toUint8Array()),Rd(e,this.leftClockEncoder.toUint8Array()),Rd(e,this.rightClockEncoder.toUint8Array()),Rd(e,yg(this.infoEncoder)),Rd(e,this.stringEncoder.toUint8Array()),Rd(e,yg(this.parentInfoEncoder)),Rd(e,this.typeRefEncoder.toUint8Array()),Rd(e,this.lenEncoder.toUint8Array()),_B(e,yg(this.restEncoder)),yg(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){sO(this.restEncoder,e)}writeBuf(e){Rd(this.restEncoder,e)}writeJSON(e){sO(this.restEncoder,e)}writeKey(e){const n=this.keyMap.get(e);n===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(n)}}const Aje=(t,e,n,i)=>{i=WT(i,e[0].id.clock);const r=zg(e,i);Xr(t.restEncoder,e.length-r),t.writeClient(n),Xr(t.restEncoder,i);const s=e[r];s.write(t,i-s.id.clock);for(let a=r+1;a<e.length;a++)e[a].write(t,0)},IW=(t,e,n)=>{const i=new Map;n.forEach((r,s)=>{Lc(e,s)>r&&i.set(s,r)}),kW(e).forEach((r,s)=>{n.has(s)||i.set(s,0)}),Xr(t.restEncoder,i.size),bT(i.entries()).sort((r,s)=>s[0]-r[0]).forEach(([r,s])=>{Aje(t,e.clients.get(r),r,s)})},Mje=(t,e)=>{const n=tm(),i=Sr(t.restDecoder);for(let r=0;r<i;r++){const s=Sr(t.restDecoder),a=new Array(s),o=t.readClient();let c=Sr(t.restDecoder);n.set(o,{i:0,refs:a});for(let l=0;l<s;l++){const u=t.readInfo();switch(vB&u){case 0:{const h=t.readLen();a[l]=new Ff(Tr(o,c),h),c+=h;break}case 10:{const h=Sr(t.restDecoder);a[l]=new zf(Tr(o,c),h),c+=h;break}default:{const h=(u&(Gv|qd))===0,d=new ba(Tr(o,c),null,(u&qd)===qd?t.readLeftID():null,null,(u&Gv)===Gv?t.readRightID():null,h?t.readParentInfo()?e.get(t.readString()):t.readLeftID():null,h&&(u&iO)===iO?t.readString():null,Qfe(t,u));a[l]=d,c+=d.length}}}}return n},Oje=(t,e,n)=>{const i=[];let r=bT(n.keys()).sort((f,p)=>f-p);if(r.length===0)return null;const s=()=>{if(r.length===0)return null;let f=n.get(r[r.length-1]);for(;f.refs.length===f.i;)if(r.pop(),r.length>0)f=n.get(r[r.length-1]);else return null;return f};let a=s();if(a===null)return null;const o=new Nfe,c=new Map,l=(f,p)=>{const g=c.get(f);(g==null||g>p)&&c.set(f,p)};let u=a.refs[a.i++];const h=new Map,d=()=>{for(const f of i){const p=f.id.client,g=n.get(p);g?(g.i--,o.clients.set(p,g.refs.slice(g.i)),n.delete(p),g.i=0,g.refs=[]):o.clients.set(p,[f]),r=r.filter(_=>_!==p)}i.length=0};for(;;){if(u.constructor!==zf){const p=Jb(h,u.id.client,()=>Lc(e,u.id.client))-u.id.clock;if(p<0)i.push(u),l(u.id.client,u.id.clock-1),d();else{const g=u.getMissing(t,e);if(g!==null){i.push(u);const _=n.get(g)||{refs:[],i:0};if(_.refs.length===_.i)l(g,Lc(e,g)),d();else{u=_.refs[_.i++];continue}}else(p===0||p<u.length)&&(u.integrate(t,p),h.set(u.id.client,u.id.clock+u.length))}}if(i.length>0)u=i.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(o.clients.size>0){const f=new ET;return IW(f,o,new Map),Xr(f.restEncoder,0),{missing:c,update:f.toUint8Array()}}return null},Nje=(t,e)=>IW(t,e.doc.store,e.beforeState),Ije=(t,e,n,i=new hC(t))=>qs(e,r=>{r.local=!1;let s=!1;const a=r.doc,o=a.store,c=Mje(i,a),l=Oje(r,o,c),u=o.pendingStructs;if(u){for(const[d,f]of u.missing)if(f<Lc(o,d)){s=!0;break}if(l){for(const[d,f]of l.missing){const p=u.missing.get(d);(p==null||p>f)&&u.missing.set(d,f)}u.update=j2([u.update,l.update])}}else o.pendingStructs=l;const h=See(i,r,o);if(o.pendingDs){const d=new hC(KC(o.pendingDs));Sr(d.restDecoder);const f=See(d,r,o);h&&f?o.pendingDs=j2([h,f]):o.pendingDs=h||f}else o.pendingDs=h;if(s){const d=o.pendingStructs.update;o.pendingStructs=null,Afe(r.doc,d)}},n,!1),Afe=(t,e,n,i=hC)=>{const r=KC(e);Ije(r,t,n,new i(r))},Tee=(t,e,n)=>Afe(t,e,n,Rfe),kje=(t,e,n=new Map)=>{IW(t,e.store,n),ZC(t,xje(e.store))},Dje=(t,e=new Uint8Array([0]),n=new ET)=>{const i=Mfe(e);kje(n,t,i);const r=[n.toUint8Array()];if(t.store.pendingDs&&r.push(t.store.pendingDs),t.store.pendingStructs&&r.push(Xje(t.store.pendingStructs.update,e)),r.length>1){if(n.constructor===FN)return Wje(r.map((s,a)=>a===0?s:Jje(s)));if(n.constructor===ET)return j2(r)}return r[0]},Pje=(t,e)=>Dje(t,e,new FN),Lje=t=>{const e=new Map,n=Sr(t.restDecoder);for(let i=0;i<n;i++){const r=Sr(t.restDecoder),s=Sr(t.restDecoder);e.set(r,s)}return e},Mfe=t=>Lje(new Cfe(KC(t)));class Uje{constructor(){this.l=[]}}const xee=()=>new Uje,wee=(t,e)=>t.l.push(e),Cee=(t,e)=>{const n=t.l,i=n.length;t.l=n.filter(r=>e!==r),i===t.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},Ofe=(t,e,n)=>RW(t.l,[e,n]);class yw{constructor(e,n){this.client=e,this.clock=n}}const sD=(t,e)=>t===e||t!==null&&e!==null&&t.client===e.client&&t.clock===e.clock,Tr=(t,e)=>new yw(t,e),Bje=t=>{for(const[e,n]of t.doc.share.entries())if(n===t)return e;throw Fg()},H2=(t,e)=>{for(;e!==null;){if(e.parent===t)return!0;e=e.parent._item}return!1},S1=(t,e)=>e===void 0?!t.deleted:e.sv.has(t.id.client)&&(e.sv.get(t.id.client)||0)>t.id.clock&&!BN(e.ds,t.id),AV=(t,e)=>{const n=Jb(t.meta,AV,cC),i=t.doc.store;n.has(e)||(e.sv.forEach((r,s)=>{r<Lc(i,s)&&Ph(t,Tr(s,r))}),uC(t,e.ds,r=>{}),n.add(e))};class Nfe{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const kW=t=>{const e=new Map;return t.clients.forEach((n,i)=>{const r=n[n.length-1];e.set(i,r.id.clock+r.length)}),e},Lc=(t,e)=>{const n=t.clients.get(e);if(n===void 0)return 0;const i=n[n.length-1];return i.id.clock+i.length},Ife=(t,e)=>{let n=t.clients.get(e.id.client);if(n===void 0)n=[],t.clients.set(e.id.client,n);else{const i=n[n.length-1];if(i.id.clock+i.length!==e.id.clock)throw Fg()}n.push(e)},zg=(t,e)=>{let n=0,i=t.length-1,r=t[i],s=r.id.clock;if(s===e)return i;let a=Cb(e/(s+r.length-1)*i);for(;n<=i;){if(r=t[a],s=r.id.clock,s<=e){if(e<s+r.length)return a;n=a+1}else i=a-1;a=Cb((n+i)/2)}throw Fg()},Fje=(t,e)=>{const n=t.clients.get(e.client);return n[zg(n,e.clock)]},dP=Fje,MV=(t,e,n)=>{const i=zg(e,n),r=e[i];return r.id.clock<n&&r instanceof ba?(e.splice(i+1,0,Y2(t,r,n-r.id.clock)),i+1):i},Ph=(t,e)=>{const n=t.doc.store.clients.get(e.client);return n[MV(t,n,e.clock)]},Ree=(t,e,n)=>{const i=e.clients.get(n.client),r=zg(i,n.clock),s=i[r];return n.clock!==s.id.clock+s.length-1&&s.constructor!==Ff&&i.splice(r+1,0,Y2(t,s,n.clock-s.id.clock+1)),s},zje=(t,e,n)=>{const i=t.clients.get(e.id.client);i[zg(i,e.id.clock)]=n},kfe=(t,e,n,i,r)=>{if(i===0)return;const s=n+i;let a=MV(t,e,n),o;do o=e[a++],s<o.id.clock+o.length&&MV(t,e,s),r(o);while(a<e.length&&e[a].id.clock<s)};class Hje{constructor(e,n,i){this.doc=e,this.deleteSet=new JC,this.beforeState=kW(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=n,this.meta=new Map,this.local=i,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const Aee=(t,e)=>e.deleteSet.clients.size===0&&!hHe(e.afterState,(n,i)=>e.beforeState.get(i)!==n)?!1:(OW(e.deleteSet),Nje(t,e),ZC(t,e.deleteSet),!0),Mee=(t,e,n)=>{const i=e._item;(i===null||i.id.clock<(t.beforeState.get(i.id.client)||0)&&!i.deleted)&&Jb(t.changed,e,cC).add(n)},fP=(t,e)=>{let n=t[e],i=t[e-1],r=e;for(;r>0;n=i,i=t[--r-1]){if(i.deleted===n.deleted&&i.constructor===n.constructor&&i.mergeWith(n)){n instanceof ba&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,i);continue}break}const s=e-r;return s&&t.splice(e+1-s,s),s},jje=(t,e,n)=>{for(const[i,r]of t.clients.entries()){const s=e.clients.get(i);for(let a=r.length-1;a>=0;a--){const o=r[a],c=o.clock+o.len;for(let l=zg(s,o.clock),u=s[l];l<s.length&&u.id.clock<c;u=s[++l]){const h=s[l];if(o.clock+o.len<=h.id.clock)break;h instanceof ba&&h.deleted&&!h.keep&&n(h)&&h.gc(e,!1)}}}},Vje=(t,e)=>{t.clients.forEach((n,i)=>{const r=e.clients.get(i);for(let s=n.length-1;s>=0;s--){const a=n[s],o=cfe(r.length-1,1+zg(r,a.clock+a.len-1));for(let c=o,l=r[c];c>0&&l.id.clock>=a.clock;l=r[c])c-=1+fP(r,c)}})},Dfe=(t,e)=>{if(e<t.length){const n=t[e],i=n.doc,r=i.store,s=n.deleteSet,a=n._mergeStructs;try{OW(s),n.afterState=kW(n.doc.store),i.emit("beforeObserverCalls",[n,i]);const o=[];n.changed.forEach((c,l)=>o.push(()=>{(l._item===null||!l._item.deleted)&&l._callObserver(n,c)})),o.push(()=>{n.changedParentTypes.forEach((c,l)=>{l._dEH.l.length>0&&(l._item===null||!l._item.deleted)&&(c=c.filter(u=>u.target._item===null||!u.target._item.deleted),c.forEach(u=>{u.currentTarget=l,u._path=null}),c.sort((u,h)=>u.path.length-h.path.length),Ofe(l._dEH,c,n))})}),o.push(()=>i.emit("afterTransaction",[n,i])),RW(o,[]),n._needFormattingCleanup&&h5e(n)}finally{i.gc&&jje(s,r,i.gcFilter),Vje(s,r),n.afterState.forEach((u,h)=>{const d=n.beforeState.get(h)||0;if(d!==u){const f=r.clients.get(h),p=WT(zg(f,d),1);for(let g=f.length-1;g>=p;)g-=1+fP(f,g)}});for(let u=a.length-1;u>=0;u--){const{client:h,clock:d}=a[u].id,f=r.clients.get(h),p=zg(f,d);p+1<f.length&&fP(f,p+1)>1||p>0&&fP(f,p)}if(!n.local&&n.afterState.get(i.clientID)!==n.beforeState.get(i.clientID)&&(bje(AW,yfe,"[yjs] ",_fe,bfe,"Changed the client-id because another client seems to be using it."),i.clientID=wfe()),i.emit("afterTransactionCleanup",[n,i]),i._observers.has("update")){const u=new FN;Aee(u,n)&&i.emit("update",[u.toUint8Array(),n.origin,i,n])}if(i._observers.has("updateV2")){const u=new ET;Aee(u,n)&&i.emit("updateV2",[u.toUint8Array(),n.origin,i,n])}const{subdocsAdded:o,subdocsLoaded:c,subdocsRemoved:l}=n;(o.size>0||l.size>0||c.size>0)&&(o.forEach(u=>{u.clientID=i.clientID,u.collectionid==null&&(u.collectionid=i.collectionid),i.subdocs.add(u)}),l.forEach(u=>i.subdocs.delete(u)),i.emit("subdocs",[{loaded:c,added:o,removed:l},i,n]),l.forEach(u=>u.destroy())),t.length<=e+1?(i._transactionCleanups=[],i.emit("afterAllTransactions",[i,t])):Dfe(t,e+1)}}},qs=(t,e,n=null,i=!0)=>{const r=t._transactionCleanups;let s=!1,a=null;t._transaction===null&&(s=!0,t._transaction=new Hje(t,n,i),r.push(t._transaction),r.length===1&&t.emit("beforeAllTransactions",[t]),t.emit("beforeTransaction",[t._transaction,t]));try{a=e(t._transaction)}finally{if(s){const o=t._transaction===r[0];t._transaction=null,o&&Dfe(r,0)}}return a};class Gje{constructor(e,n){this.insertions=n,this.deletions=e,this.meta=new Map}}const Oee=(t,e,n)=>{uC(t,n.deletions,i=>{i instanceof ba&&e.scope.some(r=>r===t.doc||H2(r,i))&&HW(i,!1)})},Nee=(t,e,n)=>{let i=null;const r=t.doc,s=t.scope;qs(r,o=>{for(;e.length>0&&t.currStackItem===null;){const c=r.store,l=e.pop(),u=new Set,h=[];let d=!1;uC(o,l.insertions,f=>{if(f instanceof ba){if(f.redone!==null){let{item:p,diff:g}=B5e(c,f.id);g>0&&(p=Ph(o,Tr(p.id.client,p.id.clock+g))),f=p}!f.deleted&&s.some(p=>p===o.doc||H2(p,f))&&h.push(f)}}),uC(o,l.deletions,f=>{f instanceof ba&&s.some(p=>p===o.doc||H2(p,f))&&!BN(l.insertions,f.id)&&u.add(f)}),u.forEach(f=>{d=Zfe(o,f,u,l.insertions,t.ignoreRemoteMapChanges,t)!==null||d});for(let f=h.length-1;f>=0;f--){const p=h[f];t.deleteFilter(p)&&(p.delete(o),d=!0)}t.currStackItem=d?l:null}o.changed.forEach((c,l)=>{c.has(null)&&l._searchMarker&&(l._searchMarker.length=0)}),i=o},t);const a=t.currStackItem;if(a!=null){const o=i.changedParentTypes;t.emit("stack-item-popped",[{stackItem:a,type:n,changedParentTypes:o,origin:t},t]),t.currStackItem=null}return a};class qje extends ofe{constructor(e,{captureTimeout:n=500,captureTransaction:i=c=>!0,deleteFilter:r=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:o=SV(e)?e[0].doc:e instanceof YT?e:e.doc}={}){super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=r,s.add(this),this.trackedOrigins=s,this.captureTransaction=i,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=n,this.afterTransactionHandler=c=>{if(!this.captureTransaction(c)||!this.scope.some(_=>c.changedParentTypes.has(_)||_===this.doc)||!this.trackedOrigins.has(c.origin)&&(!c.origin||!this.trackedOrigins.has(c.origin.constructor)))return;const l=this.undoing,u=this.redoing,h=l?this.redoStack:this.undoStack;l?this.stopCapturing():u||this.clear(!1,!0);const d=new JC;c.afterState.forEach((_,v)=>{const E=c.beforeState.get(v)||0,T=_-E;T>0&&cO(d,v,E,T)});const f=qHe();let p=!1;if(this.lastChange>0&&f-this.lastChange<this.captureTimeout&&h.length>0&&!l&&!u){const _=h[h.length-1];_.deletions=RV([_.deletions,c.deleteSet]),_.insertions=RV([_.insertions,d])}else h.push(new Gje(c.deleteSet,d)),p=!0;!l&&!u&&(this.lastChange=f),uC(c,c.deleteSet,_=>{_ instanceof ba&&this.scope.some(v=>v===c.doc||H2(v,_))&&HW(_,!0)});const g=[{stackItem:h[h.length-1],origin:c.origin,type:l?"redo":"undo",changedParentTypes:c.changedParentTypes},this];p?this.emit("stack-item-added",g):this.emit("stack-item-updated",g)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const n=new Set(this.scope);e=SV(e)?e:[e],e.forEach(i=>{n.has(i)||(n.add(i),(i instanceof fl?i.doc!==this.doc:i!==this.doc)&&Sfe("[yjs#509] Not same Y.Doc"),this.scope.push(i))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,n=!0){(e&&this.canUndo()||n&&this.canRedo())&&this.doc.transact(i=>{e&&(this.undoStack.forEach(r=>Oee(i,this,r)),this.undoStack=[]),n&&(this.redoStack.forEach(r=>Oee(i,this,r)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:n}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=Nee(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=Nee(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*$je(t){const e=Sr(t.restDecoder);for(let n=0;n<e;n++){const i=Sr(t.restDecoder),r=t.readClient();let s=Sr(t.restDecoder);for(let a=0;a<i;a++){const o=t.readInfo();if(o===10){const c=Sr(t.restDecoder);yield new zf(Tr(r,s),c),s+=c}else if(vB&o){const c=(o&(Gv|qd))===0,l=new ba(Tr(r,s),null,(o&qd)===qd?t.readLeftID():null,null,(o&Gv)===Gv?t.readRightID():null,c?t.readParentInfo()?t.readString():t.readLeftID():null,c&&(o&iO)===iO?t.readString():null,Qfe(t,o));yield l,s+=l.length}else{const c=t.readLen();yield new Ff(Tr(r,s),c),s+=c}}}}class DW{constructor(e,n){this.gen=$je(e),this.curr=null,this.done=!1,this.filterSkips=n,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===zf);return this.curr}}class PW{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const Wje=t=>j2(t,Rfe,FN),Yje=(t,e)=>{if(t.constructor===Ff){const{client:n,clock:i}=t.id;return new Ff(Tr(n,i+e),t.length-e)}else if(t.constructor===zf){const{client:n,clock:i}=t.id;return new zf(Tr(n,i+e),t.length-e)}else{const n=t,{client:i,clock:r}=n.id;return new ba(Tr(i,r+e),null,Tr(i,r+e-1),null,n.rightOrigin,n.parent,n.parentSub,n.content.splice(e))}},j2=(t,e=hC,n=ET)=>{if(t.length===1)return t[0];const i=t.map(u=>new e(KC(u)));let r=i.map(u=>new DW(u,!0)),s=null;const a=new n,o=new PW(a);for(;r=r.filter(d=>d.curr!==null),r.sort((d,f)=>{if(d.curr.id.client===f.curr.id.client){const p=d.curr.id.clock-f.curr.id.clock;return p===0?d.curr.constructor===f.curr.constructor?0:d.curr.constructor===zf?1:-1:p}else return f.curr.id.client-d.curr.id.client}),r.length!==0;){const u=r[0],h=u.curr.id.client;if(s!==null){let d=u.curr,f=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=u.next(),f=!0;if(d===null||d.id.client!==h||f&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(h!==s.struct.id.client)j_(o,s.struct,s.offset),s={struct:d,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===zf)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{j_(o,s.struct,s.offset);const p=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new zf(Tr(h,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-d.id.clock;p>0&&(s.struct.constructor===zf?s.struct.length-=p:d=Yje(d,p)),s.struct.mergeWith(d)||(j_(o,s.struct,s.offset),s={struct:d,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let d=u.curr;d!==null&&d.id.client===h&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==zf;d=u.next())j_(o,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(j_(o,s.struct,s.offset),s=null),LW(o);const c=i.map(u=>NW(u)),l=RV(c);return ZC(a,l),a.toUint8Array()},Xje=(t,e,n=hC,i=ET)=>{const r=Mfe(e),s=new i,a=new PW(s),o=new n(KC(t)),c=new DW(o,!1);for(;c.curr;){const u=c.curr,h=u.id.client,d=r.get(h)||0;if(c.curr.constructor===zf){c.next();continue}if(u.id.clock+u.length>d)for(j_(a,u,WT(d-u.id.clock,0)),c.next();c.curr&&c.curr.id.client===h;)j_(a,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===h&&c.curr.id.clock+c.curr.length<=d;)c.next()}LW(a);const l=NW(o);return ZC(s,l),s.toUint8Array()},Pfe=t=>{t.written>0&&(t.clientStructs.push({written:t.written,restEncoder:yg(t.encoder.restEncoder)}),t.encoder.restEncoder=yB(),t.written=0)},j_=(t,e,n)=>{t.written>0&&t.currClient!==e.id.client&&Pfe(t),t.written===0&&(t.currClient=e.id.client,t.encoder.writeClient(e.id.client),Xr(t.encoder.restEncoder,e.id.clock+n)),e.write(t.encoder,n),t.written++},LW=t=>{Pfe(t);const e=t.encoder.restEncoder;Xr(e,t.clientStructs.length);for(let n=0;n<t.clientStructs.length;n++){const i=t.clientStructs[n];Xr(e,i.written),_B(e,i.restEncoder)}},Kje=(t,e,n,i)=>{const r=new n(KC(t)),s=new DW(r,!1),a=new i,o=new PW(a);for(let l=s.curr;l!==null;l=s.next())j_(o,e(l),0);LW(o);const c=NW(r);return ZC(a,c),a.toUint8Array()},Jje=t=>Kje(t,ije,hC,FN),Iee="You must not compute changes after the event-handler fired.";class EB{constructor(e,n){this.target=e,this.currentTarget=e,this.transaction=n,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=Zje(this.currentTarget,this.target))}deletes(e){return BN(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw Rb(Iee);const e=new Map,n=this.target;this.transaction.changed.get(n).forEach(r=>{if(r!==null){const s=n._map.get(r);let a,o;if(this.adds(s)){let c=s.left;for(;c!==null&&this.adds(c);)c=c.left;if(this.deletes(s))if(c!==null&&this.deletes(c))a="delete",o=eH(c.content.getContent());else return;else c!==null&&this.deletes(c)?(a="update",o=eH(c.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=eH(s.content.getContent());else return;e.set(r,{action:a,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw Rb(Iee);const n=this.target,i=cC(),r=cC(),s=[];if(e={added:i,deleted:r,delta:s,keys:this.keys},this.transaction.changed.get(n).has(null)){let o=null;const c=()=>{o&&s.push(o)};for(let l=n._start;l!==null;l=l.right)l.deleted?this.deletes(l)&&!this.adds(l)&&((o===null||o.delete===void 0)&&(c(),o={delete:0}),o.delete+=l.length,r.add(l)):this.adds(l)?((o===null||o.insert===void 0)&&(c(),o={insert:[]}),o.insert=o.insert.concat(l.content.getContent()),i.add(l)):((o===null||o.retain===void 0)&&(c(),o={retain:0}),o.retain+=l.length);o!==null&&o.retain===void 0&&c()}this._changes=e}return e}}const Zje=(t,e)=>{const n=[];for(;e._item!==null&&e!==t;){if(e._item.parentSub!==null)n.unshift(e._item.parentSub);else{let i=0,r=e._item.parent._start;for(;r!==e._item&&r!==null;)!r.deleted&&r.countable&&(i+=r.length),r=r.right;n.unshift(i)}e=e._item.parent}return n},lu=()=>{Sfe("Invalid access: Add Yjs type to a document before reading data.")},Lfe=80;let UW=0;class Qje{constructor(e,n){e.marker=!0,this.p=e,this.index=n,this.timestamp=UW++}}const e5e=t=>{t.timestamp=UW++},Ufe=(t,e,n)=>{t.p.marker=!1,t.p=e,e.marker=!0,t.index=n,t.timestamp=UW++},t5e=(t,e,n)=>{if(t.length>=Lfe){const i=t.reduce((r,s)=>r.timestamp<s.timestamp?r:s);return Ufe(i,e,n),i}else{const i=new Qje(e,n);return t.push(i),i}},SB=(t,e)=>{if(t._start===null||e===0||t._searchMarker===null)return null;const n=t._searchMarker.length===0?null:t._searchMarker.reduce((s,a)=>lP(e-s.index)<lP(e-a.index)?s:a);let i=t._start,r=0;for(n!==null&&(i=n.p,r=n.index,e5e(n));i.right!==null&&r<e;){if(!i.deleted&&i.countable){if(e<r+i.length)break;r+=i.length}i=i.right}for(;i.left!==null&&r>e;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);for(;i.left!==null&&i.left.id.client===i.id.client&&i.left.id.clock+i.left.length===i.id.clock;)i=i.left,!i.deleted&&i.countable&&(r-=i.length);return n!==null&&lP(n.index-r)<i.parent.length/Lfe?(Ufe(n,i,r),n):t5e(t._searchMarker,i,r)},lO=(t,e,n)=>{for(let i=t.length-1;i>=0;i--){const r=t[i];if(n>0){let s=r.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(r.index-=s.length);if(s===null||s.marker===!0){t.splice(i,1);continue}r.p=s,s.marker=!0}(e<r.index||n>0&&e===r.index)&&(r.index=WT(e,r.index+n))}},TB=(t,e,n)=>{const i=t,r=e.changedParentTypes;for(;Jb(r,t,()=>[]).push(n),t._item!==null;)t=t._item.parent;Ofe(i._eH,n,e)};class fl{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=xee(),this._dEH=xee(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,n){this.doc=e,this._item=n}_copy(){throw Ng()}clone(){throw Ng()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,n){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){wee(this._eH,e)}observeDeep(e){wee(this._dEH,e)}unobserve(e){Cee(this._eH,e)}unobserveDeep(e){Cee(this._dEH,e)}toJSON(){}}const Bfe=(t,e,n)=>{t.doc??lu(),e<0&&(e=t._length+e),n<0&&(n=t._length+n);let i=n-e;const r=[];let s=t._start;for(;s!==null&&i>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let o=e;o<a.length&&i>0;o++)r.push(a[o]),i--;e=0}}s=s.right}return r},Ffe=t=>{t.doc??lu();const e=[];let n=t._start;for(;n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let r=0;r<i.length;r++)e.push(i[r])}n=n.right}return e},uO=(t,e)=>{let n=0,i=t._start;for(t.doc??lu();i!==null;){if(i.countable&&!i.deleted){const r=i.content.getContent();for(let s=0;s<r.length;s++)e(r[s],n++,t)}i=i.right}},zfe=(t,e)=>{const n=[];return uO(t,(i,r)=>{n.push(e(i,r,t))}),n},n5e=t=>{let e=t._start,n=null,i=0;return{[Symbol.iterator](){return this},next:()=>{if(n===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};n=e.content.getContent(),i=0,e=e.right}const r=n[i++];return n.length<=i&&(n=null),{done:!1,value:r}}}},Hfe=(t,e)=>{t.doc??lu();const n=SB(t,e);let i=t._start;for(n!==null&&(i=n.p,e-=n.index);i!==null;i=i.right)if(!i.deleted&&i.countable){if(e<i.length)return i.content.getContent()[e];e-=i.length}},V2=(t,e,n,i)=>{let r=n;const s=t.doc,a=s.clientID,o=s.store,c=n===null?e._start:n.right;let l=[];const u=()=>{l.length>0&&(r=new ba(Tr(a,Lc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new TT(l)),r.integrate(t,0),l=[])};i.forEach(h=>{if(h===null)l.push(h);else switch(h.constructor){case Number:case Object:case Boolean:case Array:case String:l.push(h);break;default:switch(u(),h.constructor){case Uint8Array:case ArrayBuffer:r=new ba(Tr(a,Lc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new zN(new Uint8Array(h))),r.integrate(t,0);break;case YT:r=new ba(Tr(a,Lc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new HN(h)),r.integrate(t,0);break;default:if(h instanceof fl)r=new ba(Tr(a,Lc(o,a)),r,r&&r.lastId,c,c&&c.id,e,null,new vy(h)),r.integrate(t,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},jfe=()=>Rb("Length exceeded!"),Vfe=(t,e,n,i)=>{if(n>e._length)throw jfe();if(n===0)return e._searchMarker&&lO(e._searchMarker,n,i.length),V2(t,e,null,i);const r=n,s=SB(e,n);let a=e._start;for(s!==null&&(a=s.p,n-=s.index,n===0&&(a=a.prev,n+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(n<=a.length){n<a.length&&Ph(t,Tr(a.id.client,a.id.clock+n));break}n-=a.length}return e._searchMarker&&lO(e._searchMarker,r,i.length),V2(t,e,a,i)},i5e=(t,e,n)=>{let r=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(r)for(;r.right;)r=r.right;return V2(t,e,r,n)},Gfe=(t,e,n,i)=>{if(i===0)return;const r=n,s=i,a=SB(e,n);let o=e._start;for(a!==null&&(o=a.p,n-=a.index);o!==null&&n>0;o=o.right)!o.deleted&&o.countable&&(n<o.length&&Ph(t,Tr(o.id.client,o.id.clock+n)),n-=o.length);for(;i>0&&o!==null;)o.deleted||(i<o.length&&Ph(t,Tr(o.id.client,o.id.clock+i)),o.delete(t),i-=o.length),o=o.right;if(i>0)throw jfe();e._searchMarker&&lO(e._searchMarker,r,-s+i)},G2=(t,e,n)=>{const i=e._map.get(n);i!==void 0&&i.delete(t)},BW=(t,e,n,i)=>{const r=e._map.get(n)||null,s=t.doc,a=s.clientID;let o;if(i==null)o=new TT([i]);else switch(i.constructor){case Number:case Object:case Boolean:case Array:case String:o=new TT([i]);break;case Uint8Array:o=new zN(i);break;case YT:o=new HN(i);break;default:if(i instanceof fl)o=new vy(i);else throw new Error("Unexpected content type")}new ba(Tr(a,Lc(s.store,a)),r,r&&r.lastId,null,null,e,n,o).integrate(t,0)},FW=(t,e)=>{t.doc??lu();const n=t._map.get(e);return n!==void 0&&!n.deleted?n.content.getContent()[n.length-1]:void 0},qfe=t=>{const e={};return t.doc??lu(),t._map.forEach((n,i)=>{n.deleted||(e[i]=n.content.getContent()[n.length-1])}),e},$fe=(t,e)=>{t.doc??lu();const n=t._map.get(e);return n!==void 0&&!n.deleted},r5e=(t,e)=>{const n={};return t._map.forEach((i,r)=>{let s=i;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&S1(s,e)&&(n[r]=s.content.getContent()[s.length-1])}),n},aD=t=>(t.doc??lu(),Eje(t._map.entries(),e=>!e[1].deleted));class s5e extends EB{}class _w extends fl{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const n=new _w;return n.push(e),n}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new _w}clone(){const e=new _w;return e.insert(0,this.toArray().map(n=>n instanceof fl?n.clone():n)),e}get length(){return this.doc??lu(),this._length}_callObserver(e,n){super._callObserver(e,n),TB(this,e,new s5e(this,e))}insert(e,n){this.doc!==null?qs(this.doc,i=>{Vfe(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}push(e){this.doc!==null?qs(this.doc,n=>{i5e(n,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,n=1){this.doc!==null?qs(this.doc,i=>{Gfe(i,this,e,n)}):this._prelimContent.splice(e,n)}get(e){return Hfe(this,e)}toArray(){return Ffe(this)}slice(e=0,n=this.length){return Bfe(this,e,n)}toJSON(){return this.map(e=>e instanceof fl?e.toJSON():e)}map(e){return zfe(this,e)}forEach(e){uO(this,e)}[Symbol.iterator](){return n5e(this)}_write(e){e.writeTypeRef(O5e)}}const a5e=t=>new _w;class o5e extends EB{constructor(e,n,i){super(e,n),this.keysChanged=i}}class dC extends fl{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,n){super._integrate(e,n),this._prelimContent.forEach((i,r)=>{this.set(r,i)}),this._prelimContent=null}_copy(){return new dC}clone(){const e=new dC;return this.forEach((n,i)=>{e.set(i,n instanceof fl?n.clone():n)}),e}_callObserver(e,n){TB(this,e,new o5e(this,e,n))}toJSON(){this.doc??lu();const e={};return this._map.forEach((n,i)=>{if(!n.deleted){const r=n.content.getContent()[n.length-1];e[i]=r instanceof fl?r.toJSON():r}}),e}get size(){return[...aD(this)].length}keys(){return sH(aD(this),e=>e[0])}values(){return sH(aD(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return sH(aD(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??lu(),this._map.forEach((n,i)=>{n.deleted||e(n.content.getContent()[n.length-1],i,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?qs(this.doc,n=>{G2(n,this,e)}):this._prelimContent.delete(e)}set(e,n){return this.doc!==null?qs(this.doc,i=>{BW(i,this,e,n)}):this._prelimContent.set(e,n),n}get(e){return FW(this,e)}has(e){return $fe(this,e)}clear(){this.doc!==null?qs(this.doc,e=>{this.forEach(function(n,i,r){G2(e,r,i)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(N5e)}}const c5e=t=>new dC,X_=(t,e)=>t===e||typeof t=="object"&&typeof e=="object"&&t&&e&&tje(t,e);class OV{constructor(e,n,i,r){this.left=e,this.right=n,this.index=i,this.currentAttributes=r}forward(){switch(this.right===null&&Fg(),this.right.content.constructor){case jc:this.right.deleted||QC(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const kee=(t,e,n)=>{for(;e.right!==null&&n>0;){switch(e.right.content.constructor){case jc:e.right.deleted||QC(e.currentAttributes,e.right.content);break;default:e.right.deleted||(n<e.right.length&&Ph(t,Tr(e.right.id.client,e.right.id.clock+n)),e.index+=e.right.length,n-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},oD=(t,e,n,i)=>{const r=new Map,s=i?SB(e,n):null;if(s){const a=new OV(s.p.left,s.p,s.index,r);return kee(t,a,n-s.index)}else{const a=new OV(null,e._start,0,r);return kee(t,a,n)}},Wfe=(t,e,n,i)=>{for(;n.right!==null&&(n.right.deleted===!0||n.right.content.constructor===jc&&X_(i.get(n.right.content.key),n.right.content.value));)n.right.deleted||i.delete(n.right.content.key),n.forward();const r=t.doc,s=r.clientID;i.forEach((a,o)=>{const c=n.left,l=n.right,u=new ba(Tr(s,Lc(r.store,s)),c,c&&c.lastId,l,l&&l.id,e,null,new jc(o,a));u.integrate(t,0),n.right=u,n.forward()})},QC=(t,e)=>{const{key:n,value:i}=e;i===null?t.delete(n):t.set(n,i)},Yfe=(t,e)=>{for(;t.right!==null;){if(!(t.right.deleted||t.right.content.constructor===jc&&X_(e[t.right.content.key]??null,t.right.content.value)))break;t.forward()}},Xfe=(t,e,n,i)=>{const r=t.doc,s=r.clientID,a=new Map;for(const o in i){const c=i[o],l=n.currentAttributes.get(o)??null;if(!X_(l,c)){a.set(o,l);const{left:u,right:h}=n;n.right=new ba(Tr(s,Lc(r.store,s)),u,u&&u.lastId,h,h&&h.id,e,null,new jc(o,c)),n.right.integrate(t,0),n.forward()}}return a},aH=(t,e,n,i,r)=>{n.currentAttributes.forEach((d,f)=>{r[f]===void 0&&(r[f]=null)});const s=t.doc,a=s.clientID;Yfe(n,r);const o=Xfe(t,e,n,r),c=i.constructor===String?new jg(i):i instanceof fl?new vy(i):new XT(i);let{left:l,right:u,index:h}=n;e._searchMarker&&lO(e._searchMarker,n.index,c.getLength()),u=new ba(Tr(a,Lc(s.store,a)),l,l&&l.lastId,u,u&&u.id,e,null,c),u.integrate(t,0),n.right=u,n.index=h,n.forward(),Wfe(t,e,n,o)},Dee=(t,e,n,i,r)=>{const s=t.doc,a=s.clientID;Yfe(n,r);const o=Xfe(t,e,n,r);e:for(;n.right!==null&&(i>0||o.size>0&&(n.right.deleted||n.right.content.constructor===jc));){if(!n.right.deleted)switch(n.right.content.constructor){case jc:{const{key:c,value:l}=n.right.content,u=r[c];if(u!==void 0){if(X_(u,l))o.delete(c);else{if(i===0)break e;o.set(c,l)}n.right.delete(t)}else n.currentAttributes.set(c,l);break}default:i<n.right.length&&Ph(t,Tr(n.right.id.client,n.right.id.clock+i)),i-=n.right.length;break}n.forward()}if(i>0){let c="";for(;i>0;i--)c+=`
`;n.right=new ba(Tr(a,Lc(s.store,a)),n.left,n.left&&n.left.lastId,n.right,n.right&&n.right.id,e,null,new jg(c)),n.right.integrate(t,0),n.forward()}Wfe(t,e,n,o)},Kfe=(t,e,n,i,r)=>{let s=e;const a=tm();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===jc){const l=s.content;a.set(l.key,l)}s=s.right}let o=0,c=!1;for(;e!==s;){if(n===e&&(c=!0),!e.deleted){const l=e.content;switch(l.constructor){case jc:{const{key:u,value:h}=l,d=i.get(u)??null;(a.get(u)!==l||d===h)&&(e.delete(t),o++,!c&&(r.get(u)??null)===h&&d!==h&&(d===null?r.delete(u):r.set(u,d))),!c&&!e.deleted&&QC(r,l);break}}}e=e.right}return o},l5e=(t,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const n=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===jc){const i=e.content.key;n.has(i)?e.delete(t):n.add(i)}e=e.left}},u5e=t=>{let e=0;return qs(t.doc,n=>{let i=t._start,r=t._start,s=tm();const a=EV(s);for(;r;){if(r.deleted===!1)switch(r.content.constructor){case jc:QC(a,r.content);break;default:e+=Kfe(n,i,r,s,a),s=EV(a),i=r;break}r=r.right}}),e},h5e=t=>{const e=new Set,n=t.doc;for(const[i,r]of t.afterState.entries()){const s=t.beforeState.get(i)||0;r!==s&&kfe(t,n.store.clients.get(i),s,r,a=>{!a.deleted&&a.content.constructor===jc&&a.constructor!==Ff&&e.add(a.parent)})}qs(n,i=>{uC(t,t.deleteSet,r=>{if(r instanceof Ff||!r.parent._hasFormatting||e.has(r.parent))return;const s=r.parent;r.content.constructor===jc?e.add(s):l5e(i,r)});for(const r of e)u5e(r)})},Pee=(t,e,n)=>{const i=n,r=EV(e.currentAttributes),s=e.right;for(;n>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case vy:case XT:case jg:n<e.right.length&&Ph(t,Tr(e.right.id.client,e.right.id.clock+n)),n-=e.right.length,e.right.delete(t);break}e.forward()}s&&Kfe(t,s,e.right,r,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&lO(a._searchMarker,e.index,-i+n),e};class d5e extends EB{constructor(e,n,i){super(e,n),this.childListChanged=!1,this.keysChanged=new Set,i.forEach(r=>{r===null?this.childListChanged=!0:this.keysChanged.add(r)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,n=[];qs(e,i=>{const r=new Map,s=new Map;let a=this.target._start,o=null;const c={};let l="",u=0,h=0;const d=()=>{if(o!==null){let f=null;switch(o){case"delete":h>0&&(f={delete:h}),h=0;break;case"insert":(typeof l=="object"||l.length>0)&&(f={insert:l},r.size>0&&(f.attributes={},r.forEach((p,g)=>{p!==null&&(f.attributes[g]=p)}))),l="";break;case"retain":u>0&&(f={retain:u},ZHe(c)||(f.attributes=XHe({},c))),u=0;break}f&&n.push(f),o=null}};for(;a!==null;){switch(a.content.constructor){case vy:case XT:this.adds(a)?this.deletes(a)||(d(),o="insert",l=a.content.getContent()[0],d()):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),h+=1):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=1);break;case jg:this.adds(a)?this.deletes(a)||(o!=="insert"&&(d(),o="insert"),l+=a.content.str):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),h+=a.length):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=a.length);break;case jc:{const{key:f,value:p}=a.content;if(this.adds(a)){if(!this.deletes(a)){const g=r.get(f)??null;X_(g,p)?p!==null&&a.delete(i):(o==="retain"&&d(),X_(p,s.get(f)??null)?delete c[f]:c[f]=p)}}else if(this.deletes(a)){s.set(f,p);const g=r.get(f)??null;X_(g,p)||(o==="retain"&&d(),c[f]=g)}else if(!a.deleted){s.set(f,p);const g=c[f];g!==void 0&&(X_(g,p)?g!==null&&a.delete(i):(o==="retain"&&d(),p===null?delete c[f]:c[f]=p))}a.deleted||(o==="insert"&&d(),QC(r,a.content));break}}a=a.right}for(d();n.length>0;){const f=n[n.length-1];if(f.retain!==void 0&&f.attributes===void 0)n.pop();else break}}),this._delta=n}return this._delta}}class Hg extends fl{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??lu(),this._length}_integrate(e,n){super._integrate(e,n);try{this._pending.forEach(i=>i())}catch(i){console.error(i)}this._pending=null}_copy(){return new Hg}clone(){const e=new Hg;return e.applyDelta(this.toDelta()),e}_callObserver(e,n){super._callObserver(e,n);const i=new d5e(this,e,n);TB(this,e,i),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??lu();let e="",n=this._start;for(;n!==null;)!n.deleted&&n.countable&&n.content.constructor===jg&&(e+=n.content.str),n=n.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:n=!0}={}){this.doc!==null?qs(this.doc,i=>{const r=new OV(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const a=e[s];if(a.insert!==void 0){const o=!n&&typeof a.insert=="string"&&s===e.length-1&&r.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&aH(i,this,r,o,a.attributes||{})}else a.retain!==void 0?Dee(i,this,r,a.retain,a.attributes||{}):a.delete!==void 0&&Pee(i,r,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,n,i){this.doc??lu();const r=[],s=new Map,a=this.doc;let o="",c=this._start;function l(){if(o.length>0){const h={};let d=!1;s.forEach((p,g)=>{d=!0,h[g]=p});const f={insert:o};d&&(f.attributes=h),r.push(f),o=""}}const u=()=>{for(;c!==null;){if(S1(c,e)||n!==void 0&&S1(c,n))switch(c.content.constructor){case jg:{const h=s.get("ychange");e!==void 0&&!S1(c,e)?(h===void 0||h.user!==c.id.client||h.type!=="removed")&&(l(),s.set("ychange",i?i("removed",c.id):{type:"removed"})):n!==void 0&&!S1(c,n)?(h===void 0||h.user!==c.id.client||h.type!=="added")&&(l(),s.set("ychange",i?i("added",c.id):{type:"added"})):h!==void 0&&(l(),s.delete("ychange")),o+=c.content.str;break}case vy:case XT:{l();const h={insert:c.content.getContent()[0]};if(s.size>0){const d={};h.attributes=d,s.forEach((f,p)=>{d[p]=f})}r.push(h);break}case jc:S1(c,e)&&(l(),QC(s,c.content));break}c=c.right}l()};return e||n?qs(a,h=>{e&&AV(h,e),n&&AV(h,n),u()},"cleanup"):u(),r}insert(e,n,i){if(n.length<=0)return;const r=this.doc;r!==null?qs(r,s=>{const a=oD(s,this,e,!i);i||(i={},a.currentAttributes.forEach((o,c)=>{i[c]=o})),aH(s,this,a,n,i)}):this._pending.push(()=>this.insert(e,n,i))}insertEmbed(e,n,i){const r=this.doc;r!==null?qs(r,s=>{const a=oD(s,this,e,!i);aH(s,this,a,n,i||{})}):this._pending.push(()=>this.insertEmbed(e,n,i||{}))}delete(e,n){if(n===0)return;const i=this.doc;i!==null?qs(i,r=>{Pee(r,oD(r,this,e,!0),n)}):this._pending.push(()=>this.delete(e,n))}format(e,n,i){if(n===0)return;const r=this.doc;r!==null?qs(r,s=>{const a=oD(s,this,e,!1);a.right!==null&&Dee(s,this,a,n,i)}):this._pending.push(()=>this.format(e,n,i))}removeAttribute(e){this.doc!==null?qs(this.doc,n=>{G2(n,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,n){this.doc!==null?qs(this.doc,i=>{BW(i,this,e,n)}):this._pending.push(()=>this.setAttribute(e,n))}getAttribute(e){return FW(this,e)}getAttributes(){return qfe(this)}_write(e){e.writeTypeRef(I5e)}}const f5e=t=>new Hg;class oH{constructor(e,n=()=>!0){this._filter=n,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??lu()}[Symbol.iterator](){return this}next(){let e=this._currentNode,n=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(n)))do if(n=e.content.type,!e.deleted&&(n.constructor===fC||n.constructor===ST)&&n._start!==null)e=n._start;else for(;e!==null;){const i=e.next;if(i!==null){e=i;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class ST extends fl{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,n){super._integrate(e,n),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new ST}clone(){const e=new ST;return e.insert(0,this.toArray().map(n=>n instanceof fl?n.clone():n)),e}get length(){return this.doc??lu(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new oH(this,e)}querySelector(e){e=e.toUpperCase();const i=new oH(this,r=>r.nodeName&&r.nodeName.toUpperCase()===e).next();return i.done?null:i.value}querySelectorAll(e){return e=e.toUpperCase(),bT(new oH(this,n=>n.nodeName&&n.nodeName.toUpperCase()===e))}_callObserver(e,n){TB(this,e,new g5e(this,n,e))}toString(){return zfe(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,n={},i){const r=e.createDocumentFragment();return i!==void 0&&i._createAssociation(r,this),uO(this,s=>{r.insertBefore(s.toDOM(e,n,i),null)}),r}insert(e,n){this.doc!==null?qs(this.doc,i=>{Vfe(i,this,e,n)}):this._prelimContent.splice(e,0,...n)}insertAfter(e,n){if(this.doc!==null)qs(this.doc,i=>{const r=e&&e instanceof fl?e._item:e;V2(i,this,r,n)});else{const i=this._prelimContent,r=e===null?0:i.findIndex(s=>s===e)+1;if(r===0&&e!==null)throw Rb("Reference item not found");i.splice(r,0,...n)}}delete(e,n=1){this.doc!==null?qs(this.doc,i=>{Gfe(i,this,e,n)}):this._prelimContent.splice(e,n)}toArray(){return Ffe(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Hfe(this,e)}slice(e=0,n=this.length){return Bfe(this,e,n)}forEach(e){uO(this,e)}_write(e){e.writeTypeRef(D5e)}}const p5e=t=>new ST;class fC extends ST{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,n){super._integrate(e,n),this._prelimAttrs.forEach((i,r)=>{this.setAttribute(r,i)}),this._prelimAttrs=null}_copy(){return new fC(this.nodeName)}clone(){const e=new fC(this.nodeName),n=this.getAttributes();return JHe(n,(i,r)=>{typeof i=="string"&&e.setAttribute(r,i)}),e.insert(0,this.toArray().map(i=>i instanceof fl?i.clone():i)),e}toString(){const e=this.getAttributes(),n=[],i=[];for(const o in e)i.push(o);i.sort();const r=i.length;for(let o=0;o<r;o++){const c=i[o];n.push(c+'="'+e[c]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=n.length>0?" "+n.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?qs(this.doc,n=>{G2(n,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,n){this.doc!==null?qs(this.doc,i=>{BW(i,this,e,n)}):this._prelimAttrs.set(e,n)}getAttribute(e){return FW(this,e)}hasAttribute(e){return $fe(this,e)}getAttributes(e){return e?r5e(this,e):qfe(this)}toDOM(e=document,n={},i){const r=e.createElement(this.nodeName),s=this.getAttributes();for(const a in s){const o=s[a];typeof o=="string"&&r.setAttribute(a,o)}return uO(this,a=>{r.appendChild(a.toDOM(e,n,i))}),i!==void 0&&i._createAssociation(r,this),r}_write(e){e.writeTypeRef(k5e),e.writeKey(this.nodeName)}}const m5e=t=>new fC(t.readKey());class g5e extends EB{constructor(e,n,i){super(e,i),this.childListChanged=!1,this.attributesChanged=new Set,n.forEach(r=>{r===null?this.childListChanged=!0:this.attributesChanged.add(r)})}}class q2 extends dC{constructor(e){super(),this.hookName=e}_copy(){return new q2(this.hookName)}clone(){const e=new q2(this.hookName);return this.forEach((n,i)=>{e.set(i,n)}),e}toDOM(e=document,n={},i){const r=n[this.hookName];let s;return r!==void 0?s=r.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),i!==void 0&&i._createAssociation(s,this),s}_write(e){e.writeTypeRef(P5e),e.writeKey(this.hookName)}}const v5e=t=>new q2(t.readKey());class $2 extends Hg{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new $2}clone(){const e=new $2;return e.applyDelta(this.toDelta()),e}toDOM(e=document,n,i){const r=e.createTextNode(this.toString());return i!==void 0&&i._createAssociation(r,this),r}toString(){return this.toDelta().map(e=>{const n=[];for(const r in e.attributes){const s=[];for(const a in e.attributes[r])s.push({key:a,value:e.attributes[r][a]});s.sort((a,o)=>a.key<o.key?-1:1),n.push({nodeName:r,attrs:s})}n.sort((r,s)=>r.nodeName<s.nodeName?-1:1);let i="";for(let r=0;r<n.length;r++){const s=n[r];i+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];i+=` ${o.key}="${o.value}"`}i+=">"}i+=e.insert;for(let r=n.length-1;r>=0;r--)i+=`</${n[r].nodeName}>`;return i}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(L5e)}}const y5e=t=>new $2;class zW{constructor(e,n){this.id=e,this.length=n}get deleted(){throw Ng()}mergeWith(e){return!1}write(e,n,i){throw Ng()}integrate(e,n){throw Ng()}}const _5e=0;class Ff extends zW{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){n>0&&(this.id.clock+=n,this.length-=n),Ife(e.doc.store,this)}write(e,n){e.writeInfo(_5e),e.writeLen(this.length-n)}getMissing(e,n){return null}}class zN{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new zN(this.content)}splice(e){throw Ng()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeBuf(this.content)}getRef(){return 3}}const b5e=t=>new zN(t.readBuf());class hO{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new hO(this.len)}splice(e){const n=new hO(this.len-e);return this.len=e,n}mergeWith(e){return this.len+=e.len,!0}integrate(e,n){cO(e.deleteSet,n.id.client,n.id.clock,this.len),n.markDeleted()}delete(e){}gc(e){}write(e,n){e.writeLen(this.len-n)}getRef(){return 1}}const E5e=t=>new hO(t.readLen()),Jfe=(t,e)=>new YT({guid:t,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class HN{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const n={};this.opts=n,e.gc||(n.gc=!1),e.autoLoad&&(n.autoLoad=!0),e.meta!==null&&(n.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new HN(Jfe(this.doc.guid,this.opts))}splice(e){throw Ng()}mergeWith(e){return!1}integrate(e,n){this.doc._item=n,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,n){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const S5e=t=>new HN(Jfe(t.readString(),t.readAny()));class XT{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new XT(this.embed)}splice(e){throw Ng()}mergeWith(e){return!1}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeJSON(this.embed)}getRef(){return 5}}const T5e=t=>new XT(t.readJSON());class jc{constructor(e,n){this.key=e,this.value=n}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new jc(this.key,this.value)}splice(e){throw Ng()}mergeWith(e){return!1}integrate(e,n){const i=n.parent;i._searchMarker=null,i._hasFormatting=!0}delete(e){}gc(e){}write(e,n){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const x5e=t=>new jc(t.readKey(),t.readJSON());class W2{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new W2(this.arr)}splice(e){const n=new W2(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const w5e=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++){const r=t.readString();r==="undefined"?n.push(void 0):n.push(JSON.parse(r))}return new W2(n)},C5e=z2("node_env")==="development";class TT{constructor(e){this.arr=e,C5e&&mfe(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new TT(this.arr)}splice(e){const n=new TT(this.arr.slice(e));return this.arr=this.arr.slice(0,e),n}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){const i=this.arr.length;e.writeLen(i-n);for(let r=n;r<i;r++){const s=this.arr[r];e.writeAny(s)}}getRef(){return 8}}const R5e=t=>{const e=t.readLen(),n=[];for(let i=0;i<e;i++)n.push(t.readAny());return new TT(n)};class jg{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new jg(this.str)}splice(e){const n=new jg(this.str.slice(e));this.str=this.str.slice(0,e);const i=this.str.charCodeAt(e-1);return i>=55296&&i<=56319&&(this.str=this.str.slice(0,e-1)+"",n.str=""+n.str.slice(1)),n}mergeWith(e){return this.str+=e.str,!0}integrate(e,n){}delete(e){}gc(e){}write(e,n){e.writeString(n===0?this.str:this.str.slice(n))}getRef(){return 4}}const A5e=t=>new jg(t.readString()),M5e=[a5e,c5e,f5e,m5e,p5e,v5e,y5e],O5e=0,N5e=1,I5e=2,k5e=3,D5e=4,P5e=5,L5e=6;class vy{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new vy(this.type._copy())}splice(e){throw Ng()}mergeWith(e){return!1}integrate(e,n){this.type._integrate(e.doc,n)}delete(e){let n=this.type._start;for(;n!==null;)n.deleted?n.id.clock<(e.beforeState.get(n.id.client)||0)&&e._mergeStructs.push(n):n.delete(e),n=n.right;this.type._map.forEach(i=>{i.deleted?i.id.clock<(e.beforeState.get(i.id.client)||0)&&e._mergeStructs.push(i):i.delete(e)}),e.changed.delete(this.type)}gc(e){let n=this.type._start;for(;n!==null;)n.gc(e,!0),n=n.right;this.type._start=null,this.type._map.forEach(i=>{for(;i!==null;)i.gc(e,!0),i=i.left}),this.type._map=new Map}write(e,n){this.type._write(e)}getRef(){return 7}}const U5e=t=>new vy(M5e[t.readTypeRef()](t)),B5e=(t,e)=>{let n=e,i=0,r;do i>0&&(n=Tr(n.client,n.clock+i)),r=dP(t,n),i=n.clock-r.id.clock,n=r.redone;while(n!==null&&r instanceof ba);return{item:r,diff:i}},HW=(t,e)=>{for(;t!==null&&t.keep!==e;)t.keep=e,t=t.parent._item},Y2=(t,e,n)=>{const{client:i,clock:r}=e.id,s=new ba(Tr(i,r+n),e,Tr(i,r+n-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(n));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Tr(e.redone.client,e.redone.clock+n)),e.right=s,s.right!==null&&(s.right.left=s),t._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=n,s},Lee=(t,e)=>fHe(t,n=>BN(n.deletions,e)),Zfe=(t,e,n,i,r,s)=>{const a=t.doc,o=a.store,c=a.clientID,l=e.redone;if(l!==null)return Ph(t,l);let u=e.parent._item,h=null,d;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!n.has(u)||Zfe(t,u,n,i,r,s)===null))return null;for(;u.redone!==null;)u=Ph(t,u.redone)}const f=u===null?e.parent:u.content.type;if(e.parentSub===null){for(h=e.left,d=e;h!==null;){let v=h;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Ph(t,v.redone);if(v!==null&&v.parent._item===u){h=v;break}h=h.left}for(;d!==null;){let v=d;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Ph(t,v.redone);if(v!==null&&v.parent._item===u){d=v;break}d=d.right}}else if(d=null,e.right&&!r){for(h=e;h!==null&&h.right!==null&&(h.right.redone||BN(i,h.right.id)||Lee(s.undoStack,h.right.id)||Lee(s.redoStack,h.right.id));)for(h=h.right;h.redone;)h=Ph(t,h.redone);if(h&&h.right!==null)return null}else h=f._map.get(e.parentSub)||null;const p=Lc(o,c),g=Tr(c,p),_=new ba(g,h,h&&h.lastId,d,d&&d.id,f,e.parentSub,e.content.copy());return e.redone=g,HW(_,!0),_.integrate(t,0),_};class ba extends zW{constructor(e,n,i,r,s,a,o,c){super(e,c.getLength()),this.origin=i,this.left=n,this.right=r,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=c,this.info=this.content.isCountable()?dee:0}set marker(e){(this.info&nH)>0!==e&&(this.info^=nH)}get marker(){return(this.info&nH)>0}get keep(){return(this.info&hee)>0}set keep(e){this.keep!==e&&(this.info^=hee)}get countable(){return(this.info&dee)>0}get deleted(){return(this.info&tH)>0}set deleted(e){this.deleted!==e&&(this.info^=tH)}markDeleted(){this.info|=tH}getMissing(e,n){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Lc(n,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Lc(n,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===yw&&this.id.client!==this.parent.client&&this.parent.clock>=Lc(n,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Ree(e,n,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Ph(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===Ff||this.right&&this.right.constructor===Ff)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===ba?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===ba&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===yw){const i=dP(n,this.parent);i.constructor===Ff?this.parent=null:this.parent=i.content.type}return null}integrate(e,n){if(n>0&&(this.id.clock+=n,this.left=Ree(e,e.doc.store,Tr(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(n),this.length-=n),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let i=this.left,r;if(i!==null)r=i.right;else if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start;const s=new Set,a=new Set;for(;r!==null&&r!==this.right;){if(a.add(r),s.add(r),sD(this.origin,r.origin)){if(r.id.client<this.id.client)i=r,s.clear();else if(sD(this.rightOrigin,r.rightOrigin))break}else if(r.origin!==null&&a.has(dP(e.doc.store,r.origin)))s.has(dP(e.doc.store,r.origin))||(i=r,s.clear());else break;r=r.right}this.left=i}if(this.left!==null){const i=this.left.right;this.right=i,this.left.right=this}else{let i;if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start,this.parent._start=this;this.right=i}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),Ife(e.doc.store,this),this.content.integrate(e,this),Mee(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new Ff(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Tr(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&sD(e.origin,this.lastId)&&this.right===e&&sD(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const n=this.parent._searchMarker;return n&&n.forEach(i=>{i.p===e&&(i.p=this,!this.deleted&&this.countable&&(i.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const n=this.parent;this.countable&&this.parentSub===null&&(n._length-=this.length),this.markDeleted(),cO(e.deleteSet,this.id.client,this.id.clock,this.length),Mee(e,n,this.parentSub),this.content.delete(e)}}gc(e,n){if(!this.deleted)throw Fg();this.content.gc(e),n?zje(e,this,new Ff(this.id,this.length)):this.content=new hO(this.length)}write(e,n){const i=n>0?Tr(this.id.client,this.id.clock+n-1):this.origin,r=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&vB|(i===null?0:qd)|(r===null?0:Gv)|(s===null?0:iO);if(e.writeInfo(a),i!==null&&e.writeLeftID(i),r!==null&&e.writeRightID(r),i===null&&r===null){const o=this.parent;if(o._item!==void 0){const c=o._item;if(c===null){const l=Bje(o);e.writeParentInfo(!0),e.writeString(l)}else e.writeParentInfo(!1),e.writeLeftID(c.id)}else o.constructor===String?(e.writeParentInfo(!0),e.writeString(o)):o.constructor===yw?(e.writeParentInfo(!1),e.writeLeftID(o)):Fg();s!==null&&e.writeString(s)}this.content.write(e,n)}}const Qfe=(t,e)=>F5e[e&vB](t),F5e=[()=>{Fg()},E5e,w5e,b5e,A5e,T5e,x5e,U5e,R5e,S5e,()=>{Fg()}],z5e=10;class zf extends zW{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,n){Fg()}write(e,n){e.writeInfo(z5e),Xr(e.restEncoder,this.length-n)}getMissing(e,n){return null}}const epe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Xp<"u"?Xp:{},tpe="__ $YJS$ __";epe[tpe]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");epe[tpe]=!0;let Uee=!1;const Lh=new YT;function npe(t){const e=Lh.getMap(),[,n]=Be.useState(0);if(Be.useEffect(()=>{function i(){n(r=>1-r)}return e.observe(i),()=>{e.unobserve(i)}},[e,n]),e.has(t))return e.get(t)}function jN(t){const e=npe(t);if(pn(e))return e}function ipe(t){const e=npe(t);if(!(!ae(e)||!(e instanceof Hg)))return e}function rpe(t,e,n){const i=Lh.getMap();if(!i.has(t))switch(e){case 0:case 1:i.set(t,n);break}}function H5e(t,e){rpe(t,0,e)}function spe(t,e){const n=new Hg(e);rpe(t,1,n)}function ll(t,e){Lh.getMap().set(t,e)}function j5e(t,e){const n=Lh.getMap(),i=new Hg(e);n.set(t,i)}function ape(t,e){const n=Lh.getMap();function i(r){const s=n.get(t);for(let a=0;a<r.length;++a)(r[a].target===n||r[a].target===s)&&e(s)}return n.has(t)&&e(n.get(t)),n.observeDeep(i),()=>{n.observeDeep(i)}}function V5e(t,e){return ape(t,n=>{pn(n)&&e(n)})}function G5e(t,e){return ape(t,n=>{n instanceof Hg&&e(n.toJSON())})}const _S=qb("modem",["second"],t=>{if(_S.session(t))switch(t.target){case"second":!Uee&&t.data%2===0&&_S.emit(t.player,"modem:join");break;case"join":t.sender!==_S.id()&&_S.reply(t,"joinack",Que(Pje(Lh)));break;case"joinack":t.sender!==_S.id()&&(Uee=!0,Tee(Lh,KM(t.data),Lh));break;case"sync":{t.sender!==_S.id()&&ae(t.data)&&Tee(Lh,KM(t.data),Lh);break}}});function ope(t,e){e!==Lh&&_S.emit("","modem:sync",Que(t))}Lh.on("update",ope);Lh.on("destroy",()=>{Lh.off("update",ope)});function q5e(t,e,n,i){const r=t.slice(0,e),s=t.slice(e+n);return`${r}${i??""}${s}`}function jW(t){const[e,n]=t.split(":"),i=ae(n);return[i?e:"self",i?n:t]}const Ab=navigator.userAgent.includes("Mac"),Cd=Ab?"cmd":"ctrl";function a1(){rPe(Ge,nM())}const $5e=i0().command("send",(t,e)=>{const[n,i]=Ot(e,0,[st.NAME,st.ANY]);switch(ai(n)){case"helpmenu":jp(Ge,ne.elementfocus,"H E L P"),wi(Ge,ne.elementfocus,""),cr(Ge,ne.elementfocus,"#help controls","zss controls and inputs"),wi(Ge,ne.elementfocus,"!helpcontrols;read help controls"),wi(Ge,ne.elementfocus,""),cr(Ge,ne.elementfocus,"#help text","text formatting"),wi(Ge,ne.elementfocus,"!helptext;read help text"),wi(Ge,ne.elementfocus,""),cr(Ge,ne.elementfocus,"#help developer","developer commands"),wi(Ge,ne.elementfocus,"!helpdeveloper;read help developer"),wi(Ge,ne.elementfocus,""),cr(Ge,ne.elementfocus,"#help player","player settings"),wi(Ge,ne.elementfocus,"!helpplayer;read help player"),dv(Ge,ne.elementfocus,"keyboard input"),cr(Ge,ne.elementfocus,"?","open console"),cr(Ge,ne.elementfocus,"esc","close console"),cr(Ge,ne.elementfocus,"tab","move console"),cr(Ge,ne.elementfocus,"up / down arrow keys","navigate console items"),cr(Ge,ne.elementfocus,"left / right arrow keys","change console items"),cr(Ge,ne.elementfocus,"enter","interact with console items"),cr(Ge,ne.elementfocus,"alt + arrow keys","skip words and console lines"),cr(Ge,ne.elementfocus,`${Cd} + up / down arrow keys`,"input history");break;case"helpcontrols":jp(Ge,ne.elementfocus,"zss controls and inputs"),dv(Ge,ne.elementfocus,"keyboard input"),cr(Ge,ne.elementfocus,"arrow keys","move"),cr(Ge,ne.elementfocus,"shift + arrow keys","shoot"),cr(Ge,ne.elementfocus,"enter","ok / accept"),cr(Ge,ne.elementfocus,"escape","cancel / close"),cr(Ge,ne.elementfocus,"tab","menu / action"),dv(Ge,ne.elementfocus,"controller input"),cr(Ge,ne.elementfocus,"left stick","move"),cr(Ge,ne.elementfocus,"right stick","aim"),cr(Ge,ne.elementfocus,"a","ok / accept"),cr(Ge,ne.elementfocus,"b","cancel / close"),cr(Ge,ne.elementfocus,"y","menu / action"),cr(Ge,ne.elementfocus,"x","shoot"),cr(Ge,ne.elementfocus,"triggers","shoot");break;case"helptext":break;case"helpdeveloper":jp(Ge,ne.elementfocus,"developer commands"),cr(Ge,ne.elementfocus,"#books","list books in memory"),cr(Ge,ne.elementfocus,"#pages","list pages in opened book"),cr(Ge,ne.elementfocus,"@[pagetype:]page name","create & edit a new codepage in the currently opened book"),cr(Ge,ne.elementfocus,"#trash","list books and pages from open book you can delete"),cr(Ge,ne.elementfocus,"#save","flush state to register"),cr(Ge,ne.elementfocus,"#share","creates a click to copy share url and QR code");break;case"helpplayer":jp(Ge,ne.elementfocus,"player settings"),$a(Ge,ne.elementfocus,"todo");break;default:{const[r,s]=jW(n);Ppe(r==="self"&&ne.elementisplayer?`${ne.elementfocus}:${s}`:n,i);break}}return 0}).command("stat",(t,e)=>{let n;const[i,...r]=e.map(na),s=r.join(" ");switch(ai(i)){case Pd(cn.LOADER):n=S_(wc.CONTENT,s,Kn.LOADER);break;default:n=S_(wc.CONTENT,[i,...r].join(" "),Kn.OBJECT);break;case Pd(cn.BOARD):n=S_(wc.CONTENT,s,Kn.BOARD);break;case Pd(cn.OBJECT):n=S_(wc.CONTENT,s,Kn.OBJECT);break;case Pd(cn.TERRAIN):n=S_(wc.CONTENT,s,Kn.TERRAIN);break;case Pd(cn.CHARSET):n=S_(wc.CONTENT,s,Kn.CHARSET);break;case Pd(cn.PALETTE):n=S_(wc.CONTENT,s,Kn.PALETTE);break}return ae(n)&&t.command("pageopen",n.id),0}).command("text",(t,e)=>{const n=e.map(na).join(" ");return ae(ne.element)&&(ne.element.tickertext=n,ne.element.tickertime=ne.timestamp),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=na(n),s=i.map(na).join(" ");return Ug(Ge,ne.elementfocus,`!${s};${r}`),0}).command("bookcreate",(t,e)=>{const[n]=Ot(e,0,[st.MAYBE_NAME]),i=kpe(n);return ae(i)&&t.command("bookopen",i.id),0}).command("bookopen",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Rv(n);return ae(i)?($a(Ge,ne.elementfocus,`opened [book] ${i.name}`),UV(wc.MAIN,i.id),t.command("pages")):Hi(Ge,ne.elementfocus,"bookopen",`book ${n} not found`),0}).command("booktrash",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=X1(wc.MAIN),r=Rv(n);return ae(r)&&(i===r&&UV(wc.MAIN,""),jGe(n),$a(Ge,ne.elementfocus,`trashed [book] ${r.name}`),a1(),t.command("pages")),0}).command("boardopen",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Gf(ne.book,Kn.BOARD,n);if(i.length){const r=Xa(...i);ae(r)&&W1(ne.book,ne.elementfocus,r.id,{x:Uf(0,fi-1),y:Uf(0,jr-1)})}return 0}).command("pageopenwith",(t,e)=>{const[n,i,r]=Ot(e,0,[st.NAME,st.MAYBE_NAME,st.MAYBE_NAME]);return t.command("pageopen",i,r,n)}).command("pageopen",(t,e)=>{const[n,i,r]=Ot(e,0,[st.NAME,st.MAYBE_NAME,st.MAYBE_NAME]),s=Uv(wc.MAIN);if(!ae(s))return 0;const a=YS(s,n);if(ae(a)){const o=$u(a),c=rS(a);$a(Ge,ne.elementfocus,`opened [${c}] ${o}`);const l=[],u=YS(s,r??""),h=ae(u)?bW(u.code):void 0;if(ae(h))for(let p=0;p<h.tokens.length;++p){const g=h.tokens[p];g.tokenType===fB&&l.push(g.image.startsWith('"')?g.image.slice(1):g.image)}const d=[a.id,i];spe(Oue(s.id,d),a.code);const f=rS(a);zDe(Ge,ne.elementfocus,s.id,d,f,`${o} - ${s.name}`,l)}else Hi(Ge,"pageopen",`page ${n} not found`,ne.elementfocus);return 0}).command("pagetrash",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Uv(wc.MAIN),r=Qde(i,n);if(ae(n)){const s=$u(r),a=rS(r);$a(Ge,ne.elementfocus,`trashed [${a}] ${s}`),a1(),t.command("pages")}return 0}).command("help",(t,e)=>{const n=e.map(na).join(" ")||"menu";return t.command(`help${n}`),0}).command("books",()=>{dv(Ge,ne.elementfocus,"books");const t=X1(wc.MAIN);cr(Ge,ne.elementfocus,"main",`${(t==null?void 0:t.name)??"empty"} $GREEN${(t==null?void 0:t.id)??""}`);const e=X1(wc.CONTENT);cr(Ge,ne.elementfocus,"content",`${(e==null?void 0:e.name)??"empty"} ${(e==null?void 0:e.id)??""}`),c7(Ge,ne.elementfocus,7);const n=vP();return n.length?n.forEach(i=>{wi(Ge,ne.elementfocus,`!bookopen ${i.id};${i.name}`)}):$a(Ge,ne.elementfocus,"no books found"),wi(Ge,ne.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const t=Uv(wc.MAIN);return ae(t)&&(dv(Ge,ne.elementfocus,"pages"),cr(Ge,ne.elementfocus,"main",`${t.name} $GREEN${t.id}`),t.pages.length?Z8(t).forEach(n=>{const i=$u(n),r=rS(n);wi(Ge,ne.elementfocus,`!pageopen ${n.id};$blue[${r}]$white ${i}`)}):(wi(Ge,ne.elementfocus,""),$a(Ge,ne.elementfocus,"$white no pages found"),$a(Ge,ne.elementfocus,"$white use @ to create a page"),$a(Ge,ne.elementfocus,"$white @board name of board"),$a(Ge,ne.elementfocus,"$white @object name of object"),$a(Ge,ne.elementfocus,"$white @terrain name of terrain"),$a(Ge,ne.elementfocus,"$white You can omit the type and it will default to object"),$a(Ge,ne.elementfocus,"$white @object name of object"),$a(Ge,ne.elementfocus,"$white @name of object"))),0}).command("boards",()=>{dv(Ge,ne.elementfocus,"boards");const t=Uv(wc.MAIN);if(ae(t)){cr(Ge,ne.elementfocus,"main",`${t.name} $GREEN${t.id}`);const e=Z8(t);e.filter(n=>yT(n)===Kn.BOARD).forEach(n=>{const i=$u(n),r=rS(n);wi(Ge,ne.elementfocus,`!boardopen ${n.id};$blue[${r}]$white ${i}`)}),e.length===0&&(wi(Ge,ne.elementfocus,""),$a(Ge,ne.elementfocus,"$white no boards found"),$a(Ge,ne.elementfocus,"$white use @ to create a board"),$a(Ge,ne.elementfocus,"$white @board name of board"))}return 0}).command("trash",()=>{dv(Ge,ne.elementfocus,"$REDTRASH"),$a(Ge,ne.elementfocus,"books");const t=vP();t.length&&(t.forEach(n=>{wi(Ge,ne.elementfocus,`!booktrash ${n.id};$REDTRASH ${n.name}`)}),wi(Ge,ne.elementfocus,""));const e=X1(wc.MAIN);return ae(e)&&($a(Ge,ne.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(n=>{const i=$u(n);wi(Ge,ne.elementfocus,`!pagetrash ${n.id};$REDTRASH ${i}`)}),wi(Ge,ne.elementfocus,"")),0}).command("dev",()=>(a1(),CDe(Ge,ne.elementfocus),0)).command("share",()=>(a1(),RDe(Ge,ne.elementfocus),0)).command("save",()=>(a1(),0)).command("fork",()=>(sPe(Ge,ne.elementfocus),0)).command("nuke",()=>(ADe(Ge,ne.elementfocus),0)).command("restart",()=>(nPe(Ge,ne.elementfocus),a1(),0)).command("export",()=>{jp(Ge,ne.elementfocus,"E X P O R T"),dv(Ge,ne.elementfocus,"books");const t=vP();return t.length&&t.forEach(e=>wi(Ge,ne.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Rv(n);return ae(i)&&(jp(Ge,ne.elementfocus,"E X P O R T"),dv(Ge,ne.elementfocus,"pages"),setTimeout(()=>{if(i.pages.length){const r=Z8(i);wi(Ge,ne.elementfocus,`!bookallexport ${n};$blue[all]$white export book`),r.forEach(s=>{const a=$u(s),o=rS(s);wi(Ge,ne.elementfocus,`!pageexport ${n}:${s.id};$blue[${o}]$white ${a}`)})}},1e3)),0}).command("bookallexport",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Rv(n);return ae(i)&&wZ(Ge,ne.elementfocus,ol(i),`${i.name}.book.json`),0}).command("pageexport",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),{target:i,path:r}=jT(n),s=Rv(i),a=YS(s,r);return ae(a)&&wZ(Ge,ne.elementfocus,ol(a),`${$u(a)}.${rS(a)}.json`),0}).command("gadget",()=>(LDe(Ge,ne.elementfocus),0)).command("joincode",(t,e)=>{const[n]=Ot(e,0,[st.MAYBE_NAME]);return bDe(Ge,ne.elementfocus,!!n),0}).command("jointab",(t,e)=>{const[n]=Ot(e,0,[st.MAYBE_NAME]);return EDe(Ge,ne.elementfocus,!!n),0}),W5e=i0().command("toast",(t,e)=>{const n=e.map(na).join("");return lDe(Ge,ne.elementfocus,n),0}).command("palette",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Qee(),r=ed(ne.book,Kn.PALETTE,n);return ae(r)?(i.palette=r.id,wi(Ge,ne.elementfocus,`loaded palette ${n}`)):Hi(Ge,ne.elementfocus,"not-found",`unabled to find palette ${n}`),0}).command("charset",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Qee(),r=ed(ne.book,Kn.CHARSET,n);return ae(r)?(i.charset=r.id,wi(Ge,ne.elementfocus,`loaded charset ${n}`)):Hi(Ge,ne.elementfocus,"not-found",`unabled to find charset ${n}`),0}),cpe={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function dO(t){return Li(t)&&lpe(t[0])}function lpe(t){return ae(uT[t])&&On(t)}function upe(t){if(On(t))return cpe[ai(t)]}function Bee(t){if(dO(t))return t;if(lpe(t))return[t];const e=upe(t);if(ae(e))return[e]}function Y5e(t){const e=ne.words[t],n=Bee(e);if(dO(n))return[n,t+1];const[i,r]=Nh(t),s=Bee(i);return dO(s)?[s,r]:[void 0,t]}const hpe={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};bs.ISSOLID,bs.ISWALK,bs.ISSWIM,bs.ISBULLET,bs.ISWALK,bs.ISSWIM;function X2(t){return Li(t)&&NV(t[0])}function NV(t){return ae(bs[t])&&On(t)}function X5e(t){if(On(t))return hpe[ai(t)]}function K5e(t){const e=ne.words[t];if(X2(e))return[e,t+1];if(NV(e))return[[e],t+1];const[n,i]=Nh(t);return X2(n)?[n,i]:NV(n)?[[n],i]:[void 0,t]}const J5e=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),Fee=new Set(["party","player","pushable","collision","destructible","p1","p2","p3","cycle","stepx","stepy","light","sender","arg"]),Z5e=["NORTH","SOUTH","WEST","EAST"];function Q5e(t){const e=fO(t);if(pn(e.inputcurrent)||(e.inputcurrent=0),Li(e.inputqueue)||(e.inputqueue=[]),e.inputcurrent>0)return e;const[n]=e.inputqueue,[i=tn.NONE,r=0]=n??[tn.NONE,0];switch(e.inputmove=[],e.inputok=0,e.inputcancel=0,e.inputmenu=0,e.inputalt=r&Xue?1:0,e.inputctrl=r&Kue?1:0,e.inputshift=r&Jue?1:0,i){case tn.MOVE_UP:case tn.MOVE_DOWN:case tn.MOVE_LEFT:case tn.MOVE_RIGHT:e.inputmove=[Z5e[i-tn.MOVE_UP]];break;case tn.OK_BUTTON:e.inputok=1;break;case tn.CANCEL_BUTTON:e.inputcancel=1;break;case tn.MENU_BUTTON:e.inputmenu=1;break}return e.inputcurrent=i,e.inputqueue=e.inputqueue.filter(s=>{const[a]=s;return a!==tn.NONE&&a!==i}),e}function eVe(t){const e=cpe[t];if(ae(e))return e;const n=hpe[t];if(ae(n))return n;const i=wB[t];if(ae(i))return i;const r=bde[t];if(ae(r))return r}const tVe=i0({get(t,e){var a,o,c,l,u,h,d,f,p,g,_,v,E,T,x,N,A,I,k,L,U;const n=eVe(e);if(ae(n))return[!0,n];if(ne.elementisplayer&&J5e.has(e)){const $=Q5e(ne.elementid)[e];return[ae($),$]}const i=nO(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus),r=(i==null?void 0:i.id)??ne.elementfocus??nM();switch(e){case"isdark":return[!0,(c=ne.board)!=null&&c.isdark?1:0];case"startx":return[!0,((l=ne.board)==null?void 0:l.startx)??0];case"starty":return[!0,((u=ne.board)==null?void 0:u.starty)??0];case"over":return[!0,((h=ne.board)==null?void 0:h.over)??""];case"under":return[!0,((d=ne.board)==null?void 0:d.under)??""];case"camera":return[!0,((f=ne.board)==null?void 0:f.camera)??""];case"graphics":return[!0,((p=ne.board)==null?void 0:p.graphics)??""];case"facing":break;case"exitnorth":return[!0,((g=ne.board)==null?void 0:g.exitnorth)??""];case"exitsouth":return[!0,((_=ne.board)==null?void 0:_.exitsouth)??""];case"exitwest":return[!0,((v=ne.board)==null?void 0:v.exitwest)??""];case"exiteast":return[!0,((E=ne.board)==null?void 0:E.exiteast)??""];case"timelimit":return[!0,((T=ne.board)==null?void 0:T.timelimit)??0];case"restartonzap":return[!0,((x=ne.board)==null?void 0:x.restartonzap)??0];case"maxplayershots":return[!0,((N=ne.board)==null?void 0:N.maxplayershots)??0];case"boardid":return[!0,((A=ne.board)==null?void 0:A.id)??"ERR"];case"playerx":return[!0,(i==null?void 0:i.x)??-1];case"playery":return[!0,(i==null?void 0:i.y)??-1];case"thisid":return[!0,((I=ne.element)==null?void 0:I.id)??""];case"thisx":return[!0,((k=ne.element)==null?void 0:k.x)??-1];case"thisy":return[!0,((L=ne.element)==null?void 0:L.y)??-1];default:{const $=(U=ne.element)==null?void 0:U[e];if(Fee.has(e))return[!0,$];break}}const s=fO(r)[e];return[ae(s),s]},set(t,e,n){var a,o;const i=nO(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus),r=(i==null?void 0:i.id)??ne.elementfocus;switch(e){case"isdark":if(ae(ne.board))return ne.board.isdark=n?1:0,[!0,ne.board.isdark];break;case"startx":if(ae(ne.board))return ne.board.startx=DS(n,0),[!0,ne.board.startx];break;case"starty":if(ae(ne.board))return ne.board.starty=DS(n,0),[!0,ne.board.starty];break;case"over":if(ae(ne.board))return ne.board.over=pn(n)?n:na(n),[!0,ne.board.over];break;case"under":if(ae(ne.board))return ne.board.under=pn(n)?n:na(n),[!0,ne.board.under];break;case"camera":if(ae(ne.board))return[!0,ne.board.camera=na(n)];break;case"graphics":if(ae(ne.board))return[!0,ne.board.graphics=na(n)];break;case"facing":break;case"exitnorth":if(ae(ne.board))return ne.board.exitnorth=na(n),[!0,ne.board.exitnorth];break;case"exitsouth":if(ae(ne.board))return ne.board.exitsouth=na(n),[!0,ne.board.exitsouth];break;case"exitwest":if(ae(ne.board))return ne.board.exitwest=na(n),[!0,ne.board.exitwest];break;case"exiteast":if(ae(ne.board))return ne.board.exiteast=na(n),[!0,ne.board.exiteast];break;case"timelimit":if(ae(ne.board))return ne.board.timelimit=DS(n,0),[!0,ne.board.timelimit];break;case"restartonzap":if(ae(ne.board))return ne.board.restartonzap=n?1:0,[!0,ne.board.restartonzap];break;case"maxplayershots":if(ae(ne.board))return ne.board.maxplayershots=DS(n,0),[!0,ne.board.maxplayershots];break;case"boardid":return[!1,n];case"playerx":return[!1,n];case"playery":return[!1,n];case"thisid":return[!1,n];case"thisx":return[!1,n];case"thisy":return[!1,n];default:{if(Fee.has(e))return ae(ne.element)&&(ne.element[e]=n),[!0,n];break}}const s=fO(r);return ae(s)?(s[e]=n,[!0,n]):[!1,n]},everytick(){var t,e,n,i,r;if(!((t=ne.element)!=null&&t.removed)&&(ae((e=ne.element)==null?void 0:e.stepx)||ae((n=ne.element)==null?void 0:n.stepy))){const s={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};BV(ne.book,ne.board,ne.element,{x:s.x+(ne.element.stepx??0),y:s.y+(ne.element.stepy??0)})===!1&&(ne.element.stepx=0,ne.element.stepy=0,oC(ne.book,ne.element,"destructible")&&sy(ne.book,ne.board,ne.element,ne.timestamp))}}}).command("clear",(t,e)=>(e.forEach(n=>t.set(na(n),0)),0)).command("set",(t,e)=>{const[n,i]=Ot(e,0,[st.NAME,st.ANY]);return t.set(n,i),0}).command("become",(t,e)=>{var i,r;const[n]=Ot(e,0,[st.KIND]);if(hl(ne.book,ne.board),nfe(ne.book,ne.board,ne.element),sy(ne.book,ne.board,ne.element,ne.timestamp)){const s={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};_T(ne.book,ne.board,n,s)}return t.endofprogram(),0}).command("bind",()=>0).command("char",(t,e)=>{const[n]=Ot(e,0,[st.NUMBER]);return ae(ne.element)&&(ne.element.char=n),0}).command("color",(t,e)=>{const[n]=Ot(e,0,[st.COLOR]);return ae(ne.element)&&ae(n)&&O2(ne.element,n),0}).command("go",(t,e)=>{if(ae(ne.element)){const[n]=Ot(e,0,[st.DIR]);if(BV(ne.book,ne.board,ne.element,n),t.yield(),ne.element.x===n.x&&ne.element.y===n.y)return 0}return 1}).command("walk",(t,e)=>{if(!ae(ne.element))return 0;const[n]=Ot(e,0,[st.DIR]),i=ne.element.x??0,r=ne.element.y??0;return ne.element.stepx=n.x-i,ne.element.stepy=n.y-r,0}),nVe=i0().command("idle",t=>(t.yield(),0)).command("end",t=>(t.endofprogram(),0)).command("endwith",(t,e)=>{const[n]=Ot(e,0,[st.ANY]);return t.set("arg",n),t.command("end")}).command("lock",t=>(t.lock(t.id()),0)).command("restore",(t,e)=>(t.restore(na(e[0])),0)).command("unlock",t=>(t.unlock(),0)).command("zap",(t,e)=>(t.zap(na(e[0])),0)).command("cycle",(t,e)=>{if(ae(ne.element)){const[n]=Ot(e,0,[st.NUMBER]);ne.element.cycle=Er(Math.round(n),1,255)}return 0}).command("die",t=>(sy(ne.book,ne.board,ne.element,ne.timestamp),t.endofprogram(),0)).command("endgame",()=>(YDe(Ge,ne.elementfocus),0)).command("run",(t,e)=>{const[n]=Ot(e,0,[st.NAME]);return Q2(n),0}).command("runwith",(t,e)=>{const[n,i]=Ot(e,0,[st.ANY,st.NAME]);return t.set("arg",n),Q2(i),0}),dpe={};function iVe(t){var e;return(e=dpe[t])==null?void 0:e.format}function bw(t){var e;return(e=dpe[t])==null?void 0:e.content}function zee(t,e){if(!ae(t))return;const n=ai(e),i=n.endsWith("le");switch(n){case"float32":case"float32le":{const r=t.dataview.getFloat32(t.cursor,i);return t.cursor+=4,r}case"float64":case"float64le":{const r=t.dataview.getFloat64(t.cursor,i);return t.cursor+=8,r}case"int8":case"int8le":{const r=t.dataview.getInt8(t.cursor);return t.cursor+=1,r}case"int16":case"int16le":{const r=t.dataview.getInt16(t.cursor,i);return t.cursor+=2,r}case"int32":case"int32le":{const r=t.dataview.getInt32(t.cursor,i);return t.cursor+=4,r}case"int64":case"int64le":{const r=t.dataview.getBigInt64(t.cursor,i);return t.cursor+=8,r}case"uint8":case"uint8le":{const r=t.dataview.getUint8(t.cursor);return t.cursor+=1,r}case"uint16":case"uint16le":{const r=t.dataview.getUint16(t.cursor,i);return t.cursor+=2,r}case"uint32":case"uint32le":{const r=t.dataview.getUint32(t.cursor,i);return t.cursor+=4,r}case"uint64":case"uint64le":{const r=t.dataview.getBigUint64(t.cursor,i);return t.cursor+=8,r}}}const rVe=(t,e)=>{const n=bw(t.id());if(!ae(n))return 0;const[i,r]=Ot(e,0,[st.NAME]),s=ai(i);switch(s){case"seek":{const[a]=Ot(e,r,[st.NUMBER]);n.cursor=a;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[a]=Ot(e,r,[st.NAME]);t.set(a,zee(n,s));break}case"text":{const[a,o]=Ot(e,r,[st.NAME,st.NAME]),c=zee(n,a);if(pn(c)&&On(o)){const l=new Uint8Array(n.bytes.buffer,n.cursor,c),h=new TextDecoder("utf-8").decode(l);t.set(o,h),n.cursor+=c}break}case"palette":{const[a]=Ot(e,r,[st.NAME]),o=bV(ne.book,Kn.PALETTE,a),c=vl(o);if(ae(c)){const l=h7*hT,u=$C(new Uint8Array(n.bytes.buffer,n.cursor,l));ae(u)&&(c.bits=u.bits),n.cursor+=l}break}case"charset":{const[a]=Ot(e,r,[st.NAME]),o=bV(ne.book,Kn.CHARSET,a),c=vl(o);if(ae(c)){const l=Fh*XM*Q5,u=WC(new Uint8Array(n.bytes.buffer,n.cursor,l));ae(u)&&(c.bits=u.bits),n.cursor+=l}break}}return 0},pC=t=>t!==null&&Object.prototype.toString.call(t)==="[object Object]",K2=(t,e)=>{if(t===e)return!0;if(typeof t!=typeof e)return!1;if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n+=1)if(!K2(t[n],e[n]))return!1;return!0}if(pC(t)&&pC(e)){const n=Object.entries(t),i=new Set(Object.keys(e));if(n.length!==i.size)return!1;for(const[r,s]of n){if(!K2(s,e[r]))return!1;i.delete(r)}return i.size===0}return!1},cD=t=>{if(t===""||t===!1||t===null||t===void 0||Array.isArray(t)&&t.length===0)return!0;if(pC(t)){for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}return!1},sVe=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t==="_",Hee=t=>t>="0"&&t<="9"||t==="-",aVe=t=>t>="a"&&t<="z"||t>="A"&&t<="Z"||t>="0"&&t<="9"||t==="_";var pt;(function(t){t.TOK_EOF="EOF",t.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",t.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",t.TOK_RBRACKET="Rbracket",t.TOK_RPAREN="Rparen",t.TOK_COMMA="Comma",t.TOK_COLON="Colon",t.TOK_RBRACE="Rbrace",t.TOK_NUMBER="Number",t.TOK_CURRENT="Current",t.TOK_ROOT="Root",t.TOK_EXPREF="Expref",t.TOK_PIPE="Pipe",t.TOK_OR="Or",t.TOK_AND="And",t.TOK_EQ="EQ",t.TOK_GT="GT",t.TOK_LT="LT",t.TOK_GTE="GTE",t.TOK_LTE="LTE",t.TOK_NE="NE",t.TOK_FLATTEN="Flatten",t.TOK_STAR="Star",t.TOK_FILTER="Filter",t.TOK_DOT="Dot",t.TOK_NOT="Not",t.TOK_LBRACE="Lbrace",t.TOK_LBRACKET="Lbracket",t.TOK_LPAREN="Lparen",t.TOK_LITERAL="Literal"})(pt||(pt={}));const jee={"(":pt.TOK_LPAREN,")":pt.TOK_RPAREN,"*":pt.TOK_STAR,",":pt.TOK_COMMA,".":pt.TOK_DOT,":":pt.TOK_COLON,"@":pt.TOK_CURRENT,$:pt.TOK_ROOT,"]":pt.TOK_RBRACKET,"{":pt.TOK_LBRACE,"}":pt.TOK_RBRACE},oVe={"!":!0,"<":!0,"=":!0,">":!0},cVe={"	":!0,"\n":!0,"\r":!0," ":!0};class lVe{constructor(){this._current=0}tokenize(e){const n=[];this._current=0;let i,r,s;for(;this._current<e.length;)if(sVe(e[this._current]))i=this._current,r=this.consumeUnquotedIdentifier(e),n.push({start:i,type:pt.TOK_UNQUOTEDIDENTIFIER,value:r});else if(jee[e[this._current]]!==void 0)n.push({start:this._current,type:jee[e[this._current]],value:e[this._current]}),this._current+=1;else if(Hee(e[this._current]))s=this.consumeNumber(e),n.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),n.push(s);else if(e[this._current]==='"')i=this._current,r=this.consumeQuotedIdentifier(e),n.push({start:i,type:pt.TOK_QUOTEDIDENTIFIER,value:r});else if(e[this._current]==="'")i=this._current,r=this.consumeRawStringLiteral(e),n.push({start:i,type:pt.TOK_LITERAL,value:r});else if(e[this._current]==="`"){i=this._current;const a=this.consumeLiteral(e);n.push({start:i,type:pt.TOK_LITERAL,value:a})}else if(oVe[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&n.push(s);else if(cVe[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")i=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,n.push({start:i,type:pt.TOK_AND,value:"&&"})):n.push({start:i,type:pt.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")i=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,n.push({start:i,type:pt.TOK_OR,value:"||"})):n.push({start:i,type:pt.TOK_PIPE,value:"|"});else{const a=new Error(`Unknown character: ${e[this._current]}`);throw a.name="LexerError",a}return n}consumeUnquotedIdentifier(e){const n=this._current;for(this._current+=1;this._current<e.length&&aVe(e[this._current]);)this._current+=1;return e.slice(n,this._current)}consumeQuotedIdentifier(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=='"'&&this._current<i;){let r=this._current;e[r]==="\\"&&(e[r+1]==="\\"||e[r+1]==='"')?r+=2:r+=1,this._current=r}return this._current+=1,JSON.parse(e.slice(n,this._current))}consumeRawStringLiteral(e){const n=this._current;this._current+=1;const i=e.length;for(;e[this._current]!=="'"&&this._current<i;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(n+1,this._current-1).replace("\\'","'")}consumeNumber(e){const n=this._current;this._current+=1;const i=e.length;for(;Hee(e[this._current])&&this._current<i;)this._current+=1;const r=parseInt(e.slice(n,this._current),10);return{start:n,value:r,type:pt.TOK_NUMBER}}consumeLBracket(e){const n=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:n,type:pt.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:n,type:pt.TOK_FLATTEN,value:"[]"}):{start:n,type:pt.TOK_LBRACKET,value:"["}}consumeOperator(e){const n=this._current,i=e[n];if(this._current+=1,i==="!")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_NE,value:"!="}):{start:n,type:pt.TOK_NOT,value:"!"};if(i==="<")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_LTE,value:"<="}):{start:n,type:pt.TOK_LT,value:"<"};if(i===">")return e[this._current]==="="?(this._current+=1,{start:n,type:pt.TOK_GTE,value:">="}):{start:n,type:pt.TOK_GT,value:">"};if(i==="="&&e[this._current]==="=")return this._current+=1,{start:n,type:pt.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const n=this._current,i=e.length;for(;e[this._current]!=="`"&&this._current<i;){let a=this._current;e[a]==="\\"&&(e[a+1]==="\\"||e[a+1]==="`")?a+=2:a+=1,this._current=a}let r=e.slice(n,this._current).trimLeft();r=r.replace("\\`","`");const s=this.looksLikeJSON(r)?JSON.parse(r):JSON.parse(`"${r}"`);return this._current+=1,s}looksLikeJSON(e){const n='[{"',i=["true","false","null"],r="-0123456789";if(e==="")return!1;if(n.includes(e[0])||i.includes(e))return!0;if(r.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const uVe=new lVe,Zl={[pt.TOK_EOF]:0,[pt.TOK_UNQUOTEDIDENTIFIER]:0,[pt.TOK_QUOTEDIDENTIFIER]:0,[pt.TOK_RBRACKET]:0,[pt.TOK_RPAREN]:0,[pt.TOK_COMMA]:0,[pt.TOK_RBRACE]:0,[pt.TOK_NUMBER]:0,[pt.TOK_CURRENT]:0,[pt.TOK_EXPREF]:0,[pt.TOK_ROOT]:0,[pt.TOK_PIPE]:1,[pt.TOK_OR]:2,[pt.TOK_AND]:3,[pt.TOK_EQ]:5,[pt.TOK_GT]:5,[pt.TOK_LT]:5,[pt.TOK_GTE]:5,[pt.TOK_LTE]:5,[pt.TOK_NE]:5,[pt.TOK_FLATTEN]:9,[pt.TOK_STAR]:20,[pt.TOK_FILTER]:21,[pt.TOK_DOT]:40,[pt.TOK_NOT]:45,[pt.TOK_LBRACE]:50,[pt.TOK_LBRACKET]:55,[pt.TOK_LPAREN]:60};class hVe{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const n=this.expression(0);if(this.lookahead(0)!==pt.TOK_EOF){const i=this.lookaheadToken(0);this.errorToken(i,`Unexpected token type: ${i.type}, value: ${i.value}`)}return n}loadTokens(e){this.tokens=[...uVe.tokenize(e),{type:pt.TOK_EOF,value:"",start:e.length}]}expression(e){const n=this.lookaheadToken(0);this.advance();let i=this.nud(n),r=this.lookahead(0);for(;e<Zl[r];)this.advance(),i=this.led(r,i),r=this.lookahead(0);return i}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let n,i,r;switch(e.type){case pt.TOK_LITERAL:return{type:"Literal",value:e.value};case pt.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case pt.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===pt.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case pt.TOK_NOT:return i=this.expression(Zl.Not),{type:"NotExpression",children:[i]};case pt.TOK_STAR:return n={type:"Identity"},i=this.lookahead(0)===pt.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(Zl.Star),{type:"ValueProjection",children:[n,i]};case pt.TOK_FILTER:return this.led(e.type,{type:"Identity"});case pt.TOK_LBRACE:return this.parseMultiselectHash();case pt.TOK_FLATTEN:return n={type:pt.TOK_FLATTEN,children:[{type:"Identity"}]},i=this.parseProjectionRHS(Zl.Flatten),{type:"Projection",children:[n,i]};case pt.TOK_LBRACKET:return this.lookahead(0)===pt.TOK_NUMBER||this.lookahead(0)===pt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},i)):this.lookahead(0)===pt.TOK_STAR&&this.lookahead(1)===pt.TOK_RBRACKET?(this.advance(),this.advance(),i=this.parseProjectionRHS(Zl.Star),{children:[{type:"Identity"},i],type:"Projection"}):this.parseMultiselectList();case pt.TOK_CURRENT:return{type:pt.TOK_CURRENT};case pt.TOK_ROOT:return{type:pt.TOK_ROOT};case pt.TOK_EXPREF:return r=this.expression(Zl.Expref),{type:"ExpressionReference",children:[r]};case pt.TOK_LPAREN:const a=[];for(;this.lookahead(0)!==pt.TOK_RPAREN;)this.lookahead(0)===pt.TOK_CURRENT?(r={type:pt.TOK_CURRENT},this.advance()):r=this.expression(0),a.push(r);return this.match(pt.TOK_RPAREN),a[0];default:this.errorToken(e)}}led(e,n){let i;switch(e){case pt.TOK_DOT:const r=Zl.Dot;return this.lookahead(0)!==pt.TOK_STAR?(i=this.parseDotRHS(r),{type:"Subexpression",children:[n,i]}):(this.advance(),i=this.parseProjectionRHS(r),{type:"ValueProjection",children:[n,i]});case pt.TOK_PIPE:return i=this.expression(Zl.Pipe),{type:pt.TOK_PIPE,children:[n,i]};case pt.TOK_OR:return i=this.expression(Zl.Or),{type:"OrExpression",children:[n,i]};case pt.TOK_AND:return i=this.expression(Zl.And),{type:"AndExpression",children:[n,i]};case pt.TOK_LPAREN:const s=n.name,a=[];let o;for(;this.lookahead(0)!==pt.TOK_RPAREN;)this.lookahead(0)===pt.TOK_CURRENT?(o={type:pt.TOK_CURRENT},this.advance()):o=this.expression(0),this.lookahead(0)===pt.TOK_COMMA&&this.match(pt.TOK_COMMA),a.push(o);return this.match(pt.TOK_RPAREN),{name:s,type:"Function",children:a};case pt.TOK_FILTER:const l=this.expression(0);return this.match(pt.TOK_RBRACKET),i=this.lookahead(0)===pt.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(Zl.Filter),{type:"FilterProjection",children:[n,i,l]};case pt.TOK_FLATTEN:const u={type:pt.TOK_FLATTEN,children:[n]},h=this.parseProjectionRHS(Zl.Flatten);return{type:"Projection",children:[u,h]};case pt.TOK_EQ:case pt.TOK_NE:case pt.TOK_GT:case pt.TOK_GTE:case pt.TOK_LT:case pt.TOK_LTE:return this.parseComparator(n,e);case pt.TOK_LBRACKET:const d=this.lookaheadToken(0);return d.type===pt.TOK_NUMBER||d.type===pt.TOK_COLON?(i=this.parseIndexExpression(),this.projectIfSlice(n,i)):(this.match(pt.TOK_STAR),this.match(pt.TOK_RBRACKET),i=this.parseProjectionRHS(Zl.Star),{type:"Projection",children:[n,i]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const n=this.lookaheadToken(0);this.errorToken(n,`Expected ${e}, got: ${n.type}`)}}errorToken(e,n=""){const i=new Error(n||`Invalid token (${e.type}): "${e.value}"`);throw i.name="ParserError",i}parseIndexExpression(){if(this.lookahead(0)===pt.TOK_COLON||this.lookahead(1)===pt.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(pt.TOK_RBRACKET),e}projectIfSlice(e,n){const i={type:"IndexExpression",children:[e,n]};return n.type==="Slice"?{children:[i,this.parseProjectionRHS(Zl.Star)],type:"Projection"}:i}parseSliceExpression(){const e=[null,null,null];let n=0,i=this.lookahead(0);for(;i!==pt.TOK_RBRACKET&&n<3;){if(i===pt.TOK_COLON)n+=1,this.advance();else if(i===pt.TOK_NUMBER)e[n]=this.lookaheadToken(0).value,this.advance();else{const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}i=this.lookahead(0)}return this.match(pt.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,n){const i=this.expression(Zl[n]);return{type:"Comparator",name:n,children:[e,i]}}parseDotRHS(e){const n=this.lookahead(0);if([pt.TOK_UNQUOTEDIDENTIFIER,pt.TOK_QUOTEDIDENTIFIER,pt.TOK_STAR].includes(n))return this.expression(e);if(n===pt.TOK_LBRACKET)return this.match(pt.TOK_LBRACKET),this.parseMultiselectList();if(n===pt.TOK_LBRACE)return this.match(pt.TOK_LBRACE),this.parseMultiselectHash();const r=this.lookaheadToken(0);this.errorToken(r,`Syntax error, unexpected token: ${r.value}(${r.type})`)}parseProjectionRHS(e){if(Zl[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===pt.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===pt.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===pt.TOK_DOT)return this.match(pt.TOK_DOT),this.parseDotRHS(e);const n=this.lookaheadToken(0);this.errorToken(n,`Syntax error, unexpected token: ${n.value}(${n.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==pt.TOK_RBRACKET;){const n=this.expression(0);if(e.push(n),this.lookahead(0)===pt.TOK_COMMA&&(this.match(pt.TOK_COMMA),this.lookahead(0)===pt.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(pt.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],n=[pt.TOK_UNQUOTEDIDENTIFIER,pt.TOK_QUOTEDIDENTIFIER];let i,r,s;for(;;){if(i=this.lookaheadToken(0),!n.includes(i.type))throw new Error(`Expecting an identifier token, got: ${i.type}`);if(r=i.value,this.advance(),this.match(pt.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:r}),this.lookahead(0)===pt.TOK_COMMA)this.match(pt.TOK_COMMA);else if(this.lookahead(0)===pt.TOK_RBRACE){this.match(pt.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const dVe=new hVe;var $t;(function(t){t[t.TYPE_NUMBER=0]="TYPE_NUMBER",t[t.TYPE_ANY=1]="TYPE_ANY",t[t.TYPE_STRING=2]="TYPE_STRING",t[t.TYPE_ARRAY=3]="TYPE_ARRAY",t[t.TYPE_OBJECT=4]="TYPE_OBJECT",t[t.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",t[t.TYPE_EXPREF=6]="TYPE_EXPREF",t[t.TYPE_NULL=7]="TYPE_NULL",t[t.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",t[t.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})($t||($t={}));class fVe{constructor(e){this.TYPE_NAME_TABLE={[$t.TYPE_NUMBER]:"number",[$t.TYPE_ANY]:"any",[$t.TYPE_STRING]:"string",[$t.TYPE_ARRAY]:"array",[$t.TYPE_OBJECT]:"object",[$t.TYPE_BOOLEAN]:"boolean",[$t.TYPE_EXPREF]:"expression",[$t.TYPE_NULL]:"null",[$t.TYPE_ARRAY_NUMBER]:"Array<number>",[$t.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([n])=>Math.abs(n),this.functionAvg=([n])=>{let i=0;for(let r=0;r<n.length;r+=1)i+=n[r];return i/n.length},this.functionCeil=([n])=>Math.ceil(n),this.functionContains=n=>{const[i,r]=n;return i.includes(r)},this.functionEndsWith=n=>{const[i,r]=n;return i.includes(r,i.length-r.length)},this.functionFloor=([n])=>Math.floor(n),this.functionJoin=n=>{const[i,r]=n;return r.join(i)},this.functionKeys=([n])=>Object.keys(n),this.functionLength=([n])=>pC(n)?Object.keys(n).length:n.length,this.functionMap=n=>{if(!this._interpreter)return[];const i=[],r=this._interpreter,s=n[0],a=n[1];for(let o=0;o<a.length;o+=1)i.push(r.visit(s,a[o]));return i},this.functionMax=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===$t.TYPE_NUMBER)return Math.max(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)s.localeCompare(r[a])<0&&(s=r[a]);return s},this.functionMaxBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[$t.TYPE_NUMBER,$t.TYPE_STRING]);let a=-1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c>a&&(a=c,o=r[l]);return o},this.functionMerge=n=>{let i={};for(let r=0;r<n.length;r+=1){const s=n[r];i=Object.assign(i,s)}return i},this.functionMin=([n])=>{if(!n.length)return null;if(this.getTypeName(n[0])===$t.TYPE_NUMBER)return Math.min(...n);const r=n;let s=r[0];for(let a=1;a<r.length;a+=1)r[a].localeCompare(s)<0&&(s=r[a]);return s},this.functionMinBy=n=>{const i=n[1],r=n[0],s=this.createKeyFunction(i,[$t.TYPE_NUMBER,$t.TYPE_STRING]);let a=1/0,o,c;for(let l=0;l<r.length;l+=1)c=s&&s(r[l]),c!==void 0&&c<a&&(a=c,o=r[l]);return o},this.functionNotNull=n=>{for(let i=0;i<n.length;i+=1)if(this.getTypeName(n[i])!==$t.TYPE_NULL)return n[i];return null},this.functionReverse=([n])=>{if(this.getTypeName(n)===$t.TYPE_STRING){const s=n;let a="";for(let o=s.length-1;o>=0;o-=1)a+=s[o];return a}const r=n.slice(0);return r.reverse(),r},this.functionSort=([n])=>[...n].sort(),this.functionSortBy=n=>{if(!this._interpreter)return[];const i=n[0].slice(0);if(i.length===0)return i;const r=this._interpreter,s=n[1],a=this.getTypeName(r.visit(s,i[0]));if(a!==void 0&&![$t.TYPE_NUMBER,$t.TYPE_STRING].includes(a))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[a]})`);const o=[];for(let c=0;c<i.length;c+=1)o.push([c,i[c]]);o.sort((c,l)=>{const u=r.visit(s,c[1]),h=r.visit(s,l[1]);if(this.getTypeName(u)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(h)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(h)]}`);return u>h?1:u<h?-1:c[0]-l[0]});for(let c=0;c<o.length;c+=1)i[c]=o[c][1];return i},this.functionStartsWith=([n,i])=>n.startsWith(i),this.functionSum=([n])=>n.reduce((i,r)=>i+r,0),this.functionToArray=([n])=>this.getTypeName(n)===$t.TYPE_ARRAY?n:[n],this.functionToNumber=([n])=>{const i=this.getTypeName(n);let r;return i===$t.TYPE_NUMBER?n:i===$t.TYPE_STRING&&(r=+n,!isNaN(r))?r:null},this.functionToString=([n])=>this.getTypeName(n)===$t.TYPE_STRING?n:JSON.stringify(n),this.functionType=([n])=>{switch(this.getTypeName(n)){case $t.TYPE_NUMBER:return"number";case $t.TYPE_STRING:return"string";case $t.TYPE_ARRAY:return"array";case $t.TYPE_OBJECT:return"object";case $t.TYPE_BOOLEAN:return"boolean";case $t.TYPE_EXPREF:return"expref";case $t.TYPE_NULL:return"null";default:return}},this.functionValues=([n])=>Object.values(n),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[$t.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[$t.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[$t.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY]},{types:[$t.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[$t.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[$t.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY,$t.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[$t.TYPE_EXPREF]},{types:[$t.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[$t.TYPE_ARRAY_NUMBER,$t.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[$t.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[$t.TYPE_ARRAY_NUMBER,$t.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[$t.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[$t.TYPE_STRING,$t.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[$t.TYPE_ARRAY_STRING,$t.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[$t.TYPE_ARRAY]},{types:[$t.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[$t.TYPE_STRING]},{types:[$t.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[$t.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[$t.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[$t.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[$t.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[$t.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[$t.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,n,i){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:n.bind(this),_signature:i}}callFunction(e,n){const i=this.functionTable[e];if(i===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,n,i._signature),i._func.call(this,n)}validateInputSignatures(e,n){for(let i=0;i<n.length;i+=1)if("variadic"in n[i]&&i!==n.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${i+1} must occur last`)}validateArgs(e,n,i){var r,s;let a;this.validateInputSignatures(e,i);const o=i.filter(g=>{var _;return(_=!g.optional)!==null&&_!==void 0?_:!1}).length,c=(s=(r=i[i.length-1])===null||r===void 0?void 0:r.variadic)!==null&&s!==void 0?s:!1,l=n.length<o,u=n.length>i.length,h=l&&(!c&&o>1||c)?"at least ":"";if(c&&l||!c&&(l||u))throw a=i.length>1,new Error(`ArgumentError: ${e}() takes ${h}${o} argument${a&&"s"||""} but received ${n.length}`);let d,f,p;for(let g=0;g<i.length;g+=1){p=!1,d=i[g].types,f=this.getTypeName(n[g]);let _;for(_=0;_<d.length;_+=1)if(f!==void 0&&this.typeMatches(f,d[_],n[g])){p=!0;break}if(!p&&f!==void 0){const v=d.map(E=>this.TYPE_NAME_TABLE[E]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${g+1} to be type (${v}) but received type ${this.TYPE_NAME_TABLE[f]} instead.`)}}}typeMatches(e,n,i){if(n===$t.TYPE_ANY)return!0;if(n===$t.TYPE_ARRAY_STRING||n===$t.TYPE_ARRAY_NUMBER||n===$t.TYPE_ARRAY){if(n===$t.TYPE_ARRAY)return e===$t.TYPE_ARRAY;if(e===$t.TYPE_ARRAY){let r;n===$t.TYPE_ARRAY_NUMBER?r=$t.TYPE_NUMBER:n===$t.TYPE_ARRAY_STRING&&(r=$t.TYPE_STRING);for(let s=0;s<i.length;s+=1){const a=this.getTypeName(i[s]);if(a!==void 0&&r!==void 0&&!this.typeMatches(a,r,i[s]))return!1}return!0}}else return e===n;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return $t.TYPE_STRING;case"[object Number]":return $t.TYPE_NUMBER;case"[object Array]":return $t.TYPE_ARRAY;case"[object Boolean]":return $t.TYPE_BOOLEAN;case"[object Null]":return $t.TYPE_NULL;case"[object Object]":return e.jmespathType===pt.TOK_EXPREF?$t.TYPE_EXPREF:$t.TYPE_OBJECT;default:return}}createKeyFunction(e,n){if(!this._interpreter)return;const i=this._interpreter;return s=>{const a=i.visit(e,s);if(!n.includes(this.getTypeName(a))){const o=`TypeError: expected one of (${n.map(c=>this.TYPE_NAME_TABLE[c]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(a)]}`;throw new Error(o)}return a}}}class pVe{constructor(){this._rootValue=null,this.runtime=new fVe(this)}search(e,n){return this._rootValue=n,this.visit(e,n)}visit(e,n){let i,r,s,a,o,c,l,u,h,d,f;switch(e.type){case"Field":return n===null?null:pC(n)?(c=n[e.name],c===void 0?null:c):null;case"Subexpression":for(s=this.visit(e.children[0],n),d=1;d<e.children.length;d+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return l=this.visit(e.children[0],n),u=this.visit(e.children[1],l),u;case"Index":if(!Array.isArray(n))return null;let p=e.value;return p<0&&(p=n.length+p),s=n[p],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(n))return null;const g=[...e.children],_=this.computeSliceParams(n.length,g),[v,E,T]=_;if(s=[],T>0)for(d=v;d<E;d+=T)s.push(n[d]);else for(d=v;d>E;d+=T)s.push(n[d]);return s;case"Projection":if(f=this.visit(e.children[0],n),!Array.isArray(f))return null;for(h=[],d=0;d<f.length;d+=1)r=this.visit(e.children[1],f[d]),r!==null&&h.push(r);return h;case"ValueProjection":if(f=this.visit(e.children[0],n),!pC(f))return null;h=[];const x=Object.values(f);for(d=0;d<x.length;d+=1)r=this.visit(e.children[1],x[d]),r!==null&&h.push(r);return h;case"FilterProjection":if(f=this.visit(e.children[0],n),!Array.isArray(f))return null;const N=[],A=[];for(d=0;d<f.length;d+=1)i=this.visit(e.children[2],f[d]),cD(i)||N.push(f[d]);for(let q=0;q<N.length;q+=1)r=this.visit(e.children[1],N[q]),r!==null&&A.push(r);return A;case"Comparator":switch(a=this.visit(e.children[0],n),o=this.visit(e.children[1],n),e.name){case pt.TOK_EQ:s=K2(a,o);break;case pt.TOK_NE:s=!K2(a,o);break;case pt.TOK_GT:s=a>o;break;case pt.TOK_GTE:s=a>=o;break;case pt.TOK_LT:s=a<o;break;case pt.TOK_LTE:s=a<=o;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case pt.TOK_FLATTEN:const I=this.visit(e.children[0],n);if(!Array.isArray(I))return null;let k=[];for(d=0;d<I.length;d+=1)r=I[d],Array.isArray(r)?k=[...k,...r]:k.push(r);return k;case"Identity":return n;case"MultiSelectList":if(n===null)return null;for(h=[],d=0;d<e.children.length;d+=1)h.push(this.visit(e.children[d],n));return h;case"MultiSelectHash":if(n===null)return null;h={};let L;for(d=0;d<e.children.length;d+=1)L=e.children[d],h[L.name]=this.visit(L.value,n);return h;case"OrExpression":return i=this.visit(e.children[0],n),cD(i)&&(i=this.visit(e.children[1],n)),i;case"AndExpression":return a=this.visit(e.children[0],n),cD(a)?a:this.visit(e.children[1],n);case"NotExpression":return a=this.visit(e.children[0],n),cD(a);case"Literal":return e.value;case pt.TOK_PIPE:return l=this.visit(e.children[0],n),this.visit(e.children[1],l);case pt.TOK_CURRENT:return n;case pt.TOK_ROOT:return this._rootValue;case"Function":const U=[];for(let q=0;q<e.children.length;q+=1)U.push(this.visit(e.children[q],n));return this.runtime.callFunction(e.name,U);case"ExpressionReference":const $=e.children[0];return $.jmespathType=pt.TOK_EXPREF,$;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,n){let[i,r,s]=n;if(s===null)s=1;else if(s===0){const o=new Error("Invalid slice, step cannot be 0");throw o.name="RuntimeError",o}const a=s<0;return i=i===null?a?e-1:0:this.capSliceRange(e,i,s),r=r===null?a?-1:e:this.capSliceRange(e,r,s),[i,r,s]}capSliceRange(e,n,i){let r=n;return r<0?(r+=e,r<0&&(r=i<0?-1:0)):r>=e&&(r=i<0?e-1:e),r}}const mVe=new pVe;$t.TYPE_ANY;$t.TYPE_ARRAY;$t.TYPE_ARRAY_NUMBER;$t.TYPE_ARRAY_STRING;$t.TYPE_BOOLEAN;$t.TYPE_EXPREF;$t.TYPE_NULL;$t.TYPE_NUMBER;$t.TYPE_OBJECT;$t.TYPE_STRING;function gVe(t,e){const n=dVe.parse(e);return mVe.search(n,t)}const vVe=(t,e)=>{const n=bw(t.id());if(!ae(n))return 0;const[i,r]=Ot(e,0,[st.NAME,st.NAME]),s=gVe(n.json,i);return t.set(r,s),0},yVe=(t,e)=>{const n=bw(t.id());if(!ae(n))return 0;const[i,r]=Ot(e,0,[st.NAME]);switch(ai(i)){case"seek":{const[a]=Ot(e,r,[st.NUMBER]);n.cursor=Er(a,0,n.lines.length-1);break}case"line":n.cursor=Er(n.cursor+1,0,n.lines.length-1);break;default:{const a=n.lines[n.cursor]??"",c=new RegExp(i,"i").exec(a)??[];let l=1;for(let u=r;u<e.length;){const[h,d]=Ot(e,u,[st.NAME]);t.set(h,c[l]??0),++l,u=d}break}}return 0},_Ve=i0({get(t,e){const n=iVe(t.id());if(e==="format")return[!0,n];switch(n){case"text":{const i=bw(t.id());switch(e){case"filename":return[!0,i.filename];case"cursor":return[!0,i.cursor];case"lines":return[!0,i.lines.length]}break}case"json":{const i=bw(t.id());switch(e){case"filename":return[!0,i.filename]}break}case"binary":{const i=bw(t.id());switch(e){case"filename":return[!0,i.filename];case"cursor":return[!0,i.cursor];case"bytes":return[!0,i.bytes.length]}break}}return[!1,void 0]}}).command("send",(t,e)=>{const[n,i]=Ot(e,0,[st.NAME,st.ANY]);return Ppe(n,i),0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(na).join(" ");return Ug(Ge,ne.elementfocus,"$175",n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=na(n),s=i.map(na).join(" ");return Ug(Ge,ne.elementfocus,"$175",`!${s};${r}`),0}).command("readline",yVe).command("readjson",vVe).command("readbin",rVe).command("with",(t,e)=>{const[n]=Ot(e,0,[st.NAME]),i=Gf(ne.book,Kn.BOARD,n);if(i.length){const r=Xa(...i);ae(r)&&(ne.board=vl(r),ne.element={x:-1,y:-1})}return 0});function Vee(t,e,n,i,r,s){const a=[];for(let o=s;o<r.length;){const[c,l]=Ot(r,o,[st.ANY]);Li(c)&&!gT(c)&&!dO(c)&&!X2(c)&&!Vg(c)?a.push(...c):a.push(c),o=l}switch(ai(i)){case"get":case"post:json":pDe(Ge,ne.elementfocus,t,e,n,i,a);break}return 0}const bVe=i0().command("fetch",(t,e)=>{const[n,i,r="get",s]=Ot(e,0,[st.NAME,st.NAME,st.MAYBE_STRING]);return Vee(void 0,n,i,r,e,s),0}).command("fetchwith",(t,e)=>{const[n,i,r,s="get",a]=Ot(e,0,[st.ANY,st.NAME,st.NAME,st.MAYBE_STRING]);return Vee(n,i,r,s,e,a),0}).command("twitchchat",(t,e)=>{const[n]=Ot(e,0,[st.ANY]);switch(ai(n)){default:dDe(Ge,ne.elementfocus,n);break;case"stop":fDe(Ge,ne.elementfocus);break}return 0}).command("twitchbroadcast",(t,e)=>{const[n]=Ot(e,0,[st.NAME]);switch(ai(n)){default:uDe(Ge,ne.elementfocus,n);break;case"stop":hDe(Ge,ne.elementfocus);break}return 0}),pP={},T1={};function EVe(){return{id:Do(),layers:[],scroll:[],sidebar:[]}}const SVe=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit"]),TVe=new Set(["tx","text"]),xVe={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},Gee={};let wVe=t=>{let e=Gee[t];return ae(e)||(Gee[t]=e=EVe()),e};function cH(t){return wVe(t)}function VW(t){return ae(pP[t])||(pP[t]=[]),pP[t]}function CVe(t,e,n){Object.values(T1).forEach(i=>{if(i[e]!==void 0){const r=Wb(t.id(),e);pn(n)&&ll(r,n),On(n)&&j5e(r,n)}})}function RVe(t){const e=VW(t);return pP[t]=[],e}function AVe(t,e){VW(t).push(e)}function MVe(t,e,n,i,r=()=>0,s=Vu){const a=[e,n,...i],o=ai(`${a[3]}`),c={...ne};function l(u,h){ae(h)&&h!==r(u)&&(ne.board=c.board,ne.element=c.element,ne.elementfocus=c.elementfocus,s(u,h))}if(SVe.has(o)){const u=`${a[2]}`;T1[e]=T1[e]??{};const h=r(u)??xVe[o];if(T1[e][u]===void 0){const d=Wb(e,u);pn(h)&&H5e(d,h),On(h)&&spe(d,h),TVe.has(o)?T1[e][u]=G5e(d,f=>{l(u,f)}):T1[e][u]=V5e(d,f=>{l(u,f)})}}VW(t).push(a)}const OVe=i0({set(t,e,n){return CVe(t,e,n),[!1,void 0]},everytick(){const t=RVe(ne.elementid),[e]=t;if(t.length===1&&On(e)){if(ae(ne.element))if(e.trim().length===0){const n=cH(ne.elementid);n.sidebar=[]}else ne.element.tickertext=e,ne.element.tickertime=ne.timestamp}else if(t.length>1)if(ne.elementisplayer){const n=cH(ne.elementid);n.sidebar=t}else{const n=cH(ne.elementfocus);n.scroll=t}}}).command("send",(t,e)=>{var c,l;const[n,i]=Ot(e,0,[st.NAME,st.ANY]),[r,s]=jW(n);function a(u){for(let h=0;h<u.length;++h){const d=u[h];ae(d.id)&&t.send(d.id,s,i)}}switch(ai(r)){case"all":for(const u of Object.keys(((c=ne.board)==null?void 0:c.objects)??{}))t.send(u,s,i);break;case"self":t.message({session:Ge.session(),player:ne.elementfocus,id:Do(),sender:t.id(),target:s,data:i});break;case"others":for(const u of Object.keys(((l=ne.board)==null?void 0:l.objects)??{}))u!==t.id()&&t.send(u,s,i);break;default:{a(Hde(ne.board,[r]));break}}return 0}).command("stat",()=>0).command("text",(t,e)=>{const n=e.map(na).join("");return AVe(ne.elementid,n),0}).command("hyperlink",(t,e)=>{const[n,...i]=e,r=na(n);return MVe(ne.elementid,t.id(),r,i,t.get,t.set),0});function NVe(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=em(e,{x:s,y:r});Mg(a)&&sy(t,e,a,t.timestamp),Og(e,{x:s,y:r})}}function IVe(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s)Og(e,{x:s,y:r})}function kVe(t,e,n,i){for(let r=n.y;r<=i.y;++r)for(let s=n.x;s<=i.x;++s){const a=em(e,{x:s,y:r});Mg(a)&&sy(t,e,a,t.timestamp),Og(e,{x:s,y:r})}}function J2(t,e){ae(t)&&(t.name=e.name,t.char=e.char,t.color=e.color,t.bg=e.bg,t.p1=e.p1,t.p2=e.p2,t.p3=e.p3,t.code=e.code,t.group=e.group,t.party=e.party,t.cycle=e.cycle,t.light=e.light,t.stepx=e.stepx,t.stepy=e.stepy,t.pushable=e.pushable,t.collision=e.collision,t.destructible=e.destructible,t.tickertext=e.tickertext,t.tickertime=e.tickertime)}function GW(t,e,n,i,r){if(!ae(ne.book))return;const s=ne.book,a=ed(s,Kn.BOARD,t),o=vl(a);if(!ae(o))return;const c=ed(s,Kn.BOARD,e),l=vl(c);if(ae(l)&&(hl(s,o),hl(s,l),ae(o&&ae(l)))){switch(r){case"all":NVe(s,l,n,i);break;case"object":kVe(s,l,n,i);break;case"terrain":IVe(s,l,n,i);break}for(let u=n.y;u<=i.y;++u)for(let h=n.x;h<=i.x;++h){let d=!1,f=!1;switch(r){case"all":d=!0,f=!0;break;case"object":d=!0;break;case"terrain":f=!0;break}let p,g=em(o,{x:h,y:u});if(Mg(g)?(p=$7(o,h,u),sb(g==null?void 0:g.id)&&(g=void 0)):(p=g,g=void 0),ae(p)&&f){const _=_T(s,l,[p.kind??""],{x:h,y:u});J2(_,p)}if(ae(g)&&d){const _=_T(s,l,[g.kind??""],{x:h,y:u});J2(_,g)}}delete l.named,delete l.lookup,hl(s,l)}}function DVe(t,e,n,i,r){if(!ae(ne.book))return;const s=ne.book,a=ed(s,Kn.BOARD,t),o=vl(a);if(!ae(o))return;const c=q7(),l=r==="all"||r==="object",u=r==="all"||r==="terrain";hl(s,o),hl(s,c);const h=-Math.tan(e*.5),d=Math.sin(e),f=Math.round(12.5*h),p=Math.round(12.5*d),g=new Array(jr).fill(0);HQ(f,0,-f,jr-1).forEach(x=>{x.x<0?g[x.y]=Math.min(g[x.y],x.x):g[x.y]=Math.max(g[x.y],x.x)});const v=new Array(fi).fill(0);HQ(0,p,fi-1,-p).forEach(x=>{x.y<0?v[x.x]=Math.min(v[x.x],x.y):v[x.x]=Math.max(v[x.x],x.y)});const T=[g,v,g];for(let x=0;x<T.length;++x){const N=T[x];if(x!==1){for(let A=0;A<jr;++A){const I=N[A],k=A*fi;for(let L=0;L<fi;L++){const U=(L+I+fi)%fi;u&&(c.terrain[U+k]=o.terrain[L+k])}}if(l){const A=Object.keys(o.objects);for(let I=0;I<A.length;++I){const k=A[I],{x:L,y:U}=o.objects[k];if(ae(L)&&ae(U)){const $=N[U];o.objects[k].x=(L+$+fi)%fi,o.objects[k].lx=o.objects[k].x}}}}if(x===1){for(let A=0;A<fi;++A){const I=N[A];for(let k=0;k<jr;++k){const L=(k+I+jr)%jr;u&&(c.terrain[A+L*fi]=o.terrain[A+k*fi])}}if(l){const A=Object.keys(o.objects);for(let I=0;I<A.length;++I){const k=A[I],{x:L,y:U}=o.objects[k];if(ae(L)&&ae(U)){const $=N[L];o.objects[k].y=(U+$+jr)%jr,o.objects[k].ly=o.objects[k].y}}}}u&&(o.terrain=[...c.terrain]),delete c.named,delete c.lookup,delete o.named,delete o.lookup,hl(s,c),hl(s,o)}}function PVe(t,e){let n=0,i=0,r=0;for(;r<t.length;r++)n+=t[r];for(r=0,e*=n;e&&r<t.length;){if(i+=t[r],e<=i)return r;r++}return 0}var LVe=PVe;const UVe=LVe,Br=function(){};Br.prototype.FMX=0;Br.prototype.FMY=0;Br.prototype.FMXxFMY=0;Br.prototype.T=0;Br.prototype.N=0;Br.prototype.initiliazedField=!1;Br.prototype.generationComplete=!1;Br.prototype.wave=null;Br.prototype.compatible=null;Br.prototype.weightLogWeights=null;Br.prototype.sumOfWeights=0;Br.prototype.sumOfWeightLogWeights=0;Br.prototype.startingEntropy=0;Br.prototype.sumsOfOnes=null;Br.prototype.sumsOfWeights=null;Br.prototype.sumsOfWeightLogWeights=null;Br.prototype.entropies=null;Br.prototype.propagator=null;Br.prototype.observed=null;Br.prototype.distribution=null;Br.prototype.stack=null;Br.prototype.stackSize=0;Br.prototype.DX=[-1,0,1,0];Br.prototype.DY=[0,1,0,-1];Br.prototype.opposite=[2,3,0,1];Br.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let t=0;t<this.FMXxFMY;t++){this.wave[t]=new Array(this.T),this.compatible[t]=new Array(this.T);for(let e=0;e<this.T;e++)this.compatible[t][e]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0};Br.prototype.observe=function(t){let e=1e3,n=-1;for(let s=0;s<this.FMXxFMY;s++){if(this.onBoundary(s%this.FMX,s/this.FMX|0))continue;const a=this.sumsOfOnes[s];if(a===0)return!1;const o=this.entropies[s];if(a>1&&o<=e){const c=1e-6*t();o+c<e&&(e=o+c,n=s)}}if(n===-1){this.observed=new Array(this.FMXxFMY);for(let s=0;s<this.FMXxFMY;s++)for(let a=0;a<this.T;a++)if(this.wave[s][a]){this.observed[s]=a;break}return!0}for(let s=0;s<this.T;s++)this.distribution[s]=this.wave[n][s]?this.weights[s]:0;const i=UVe(this.distribution,t()),r=this.wave[n];for(let s=0;s<this.T;s++)r[s]!==(s===i)&&this.ban(n,s);return null};Br.prototype.propagate=function(){for(;this.stackSize>0;){const t=this.stack[this.stackSize-1];this.stackSize--;const e=t[0],n=e%this.FMX,i=e/this.FMX|0;for(let r=0;r<4;r++){const s=this.DX[r],a=this.DY[r];let o=n+s,c=i+a;if(this.onBoundary(o,c))continue;o<0?o+=this.FMX:o>=this.FMX&&(o-=this.FMX),c<0?c+=this.FMY:c>=this.FMY&&(c-=this.FMY);const l=o+c*this.FMX,u=this.propagator[r][t[1]],h=this.compatible[l];for(let d=0;d<u.length;d++){const f=u[d],p=h[f];p[r]--,p[r]==0&&this.ban(l,f)}}}};Br.prototype.singleIteration=function(t){const e=this.observe(t);return e!==null?(this.generationComplete=e,!!e):(this.propagate(),null)};Br.prototype.iterate=function(t,e){this.wave||this.initialize(),this.initiliazedField||this.clear(),t=t||0,e=e||Math.random;for(let n=0;n<t||t===0;n++){const i=this.singleIteration(e);if(i!==null)return!!i}return!0};Br.prototype.generate=function(t){for(t=t||Math.random,this.wave||this.initialize(),this.clear();;){const e=this.singleIteration(t);if(e!==null)return!!e}};Br.prototype.isGenerationComplete=function(){return this.generationComplete};Br.prototype.ban=function(t,e){const n=this.compatible[t][e];for(let r=0;r<4;r++)n[r]=0;this.wave[t][e]=!1,this.stack[this.stackSize]=[t,e],this.stackSize++,this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[e],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[e];const i=this.sumsOfWeights[t];this.entropies[t]=Math.log(i)-this.sumsOfWeightLogWeights[t]/i};Br.prototype.clear=function(){for(let t=0;t<this.FMXxFMY;t++){for(let e=0;e<this.T;e++){this.wave[t][e]=!0;for(let n=0;n<4;n++)this.compatible[t][e][n]=this.propagator[this.opposite[n]][e].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1};var fpe=Br;const ppe=fpe,ay=function(e,n,i,r,s,a,o,c,l,u){u=u||0,this.N=r,this.FMX=s,this.FMY=a,this.FMXxFMY=s*a,this.periodic=c;const h=n,d=new Array(h);for(let L=0;L<h;L++)d[L]=new Array(i);this.colors=[];const f={};for(let L=0;L<i;L++)for(let U=0;U<n;U++){const $=(L*n+U)*4,q=[e[$],e[$+1],e[$+2],e[$+3]],G=q.join("-");f.hasOwnProperty(G)||(f[G]=this.colors.length,this.colors.push(q)),d[U][L]=f[G]}const p=this.colors.length,g=Math.pow(p,r*r),_=function(U){let $=new Array(r*r);for(let q=0;q<r;q++)for(let G=0;G<r;G++)$[G+q*r]=U(G,q);return $},v=function(U,$){return _(function(q,G){return d[(U+q)%n][($+G)%i]})},E=function(U){return _(function($,q){return U[r-1-q+$*r]})},T=function(U){return _(function($,q){return U[r-1-$+q*r]})},x=function(U){let $=0,q=1;for(let G=0;G<U.length;G++)$+=U[U.length-1-G]*q,q*=p;return $},N=function(U){let $=U,q=g;const G=new Array(r*r);for(let X=0;X<G.length;X++){q/=p;let ie=0;for(;$>=q;)$-=q,ie++;G[X]=ie}return G},A={},I=[];for(let L=0;L<(o?i:i-r+1);L++)for(let U=0;U<(o?n:n-r+1);U++){const $=new Array(8);$[0]=v(U,L),$[1]=T($[0]),$[2]=E($[0]),$[3]=T($[2]),$[4]=E($[2]),$[5]=T($[4]),$[6]=E($[4]),$[7]=T($[6]);for(let q=0;q<l;q++){const G=x($[q]);A[G]?A[G]++:(I.push(G),A[G]=1)}}this.T=I.length,this.ground=(u+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let L=0;L<this.T;L++){const U=parseInt(I[L],10);this.patterns[L]=N(U),this.weights[L]=A[U]}const k=function(U,$,q,G){const X=q<0?0:q,ie=q<0?q+r:r,V=G<0?0:G,Z=G<0?G+r:r;for(let Y=V;Y<Z;Y++)for(let ee=X;ee<ie;ee++)if(U[ee+r*Y]!=$[ee-q+r*(Y-G)])return!1;return!0};this.propagator=new Array(4);for(let L=0;L<4;L++){this.propagator[L]=new Array(this.T);for(let U=0;U<this.T;U++){const $=[];for(let q=0;q<this.T;q++)k(this.patterns[U],this.patterns[q],this.DX[L],this.DY[L])&&$.push(q);this.propagator[L][U]=$}}};ay.prototype=Object.create(ppe.prototype);ay.prototype.constructor=ay;ay.prototype.onBoundary=function(t,e){return!this.periodic&&(t+this.N>this.FMX||e+this.N>this.FMY||t<0||e<0)};ay.prototype.clear=function(){if(ppe.prototype.clear.call(this),this.ground!==0){for(let t=0;t<this.FMX;t++){for(let e=0;e<this.T;e++)e!==this.ground&&this.ban(t+(this.FMY-1)*this.FMX,e);for(let e=0;e<this.FMY-1;e++)this.ban(t+e*this.FMX,this.ground)}this.propagate()}};ay.prototype.graphics=function(t){return t=t||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t),t};ay.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMY;e++){const n=e<this.FMY-this.N+1?0:this.N-1;for(let i=0;i<this.FMX;i++){const r=i<this.FMX-this.N+1?0:this.N-1,s=(e*this.FMX+i)*4,a=this.colors[this.patterns[this.observed[i-r+(e-n)*this.FMX]][r+n*this.N]];t[s]=a[0],t[s+1]=a[1],t[s+2]=a[2],t[s+3]=a[3]}}};ay.prototype.graphicsIncomplete=function(t){for(let e=0;e<this.FMXxFMY;e++){const n=e%this.FMX,i=e/this.FMX|0;let r=0,s=0,a=0,o=0,c=0;for(let u=0;u<this.N;u++)for(let h=0;h<this.N;h++){let d=n-h;d<0&&(d+=this.FMX);let f=i-u;if(f<0&&(f+=this.FMY),this.onBoundary(d,f))continue;const p=d+f*this.FMX;for(let g=0;g<this.T;g++)if(this.wave[p][g]){r++;const _=this.colors[this.patterns[g][h+u*this.N]];s+=_[0],a+=_[1],o+=_[2],c+=_[3]}}const l=e*4;t[l]=s/r,t[l+1]=a/r,t[l+2]=o/r,t[l+3]=c/r}};var BVe=ay;const FVe=fpe,Mb=function(e,n,i,r,s){const a=e.tilesize||16;this.FMX=i,this.FMY=r,this.FMXxFMY=i*r,this.periodic=s,this.tilesize=a;const o=!!e.unique;let c=null;n&&e.subsets&&e.subsets[n]&&(c=e.subsets[n]);const l=function(x){const N=new Array(a*a);for(let A=0;A<a;A++)for(let I=0;I<a;I++)N[I+A*a]=x(I,A);return N},u=function(x){return l(function(N,A){return x[a-1-A+N*a]})},h=function(x){return l(function(N,A){return x[a-1-N+A*a]})};this.tiles=[];const d=[],f=[],p={};let g,_,v;for(let T=0;T<e.tiles.length;T++){const x=e.tiles[T];if(c!==null&&c.indexOf(x.name)===-1)continue;switch(x.symmetry){case"L":v=4,g=function(A){return(A+1)%4},_=function(A){return A%2===0?A+1:A-1};break;case"T":v=4,g=function(A){return(A+1)%4},_=function(A){return A%2===0?A:4-A};break;case"I":v=2,g=function(A){return 1-A},_=function(A){return A};break;case"\\":v=2,g=function(A){return 1-A},_=function(A){return 1-A};break;case"F":v=8,g=function(A){return A<4?(A+1)%4:4+(A-1)%4},_=function(A){return A<4?A+4:A-4};break;default:v=1,g=function(A){return A},_=function(A){return A};break}this.T=f.length,p[x.name]=this.T;for(let A=0;A<v;A++)f.push([this.T+A,this.T+g(A),this.T+g(g(A)),this.T+g(g(g(A))),this.T+_(A),this.T+_(g(A)),this.T+_(g(g(A))),this.T+_(g(g(g(A))))]);let N;if(o)for(let A=0;A<v;A++)N=x.bitmap[A],this.tiles.push(l(function(I,k){return[N[(a*k+I)*4],N[(a*k+I)*4+1],N[(a*k+I)*4+2],N[(a*k+I)*4+3]]}));else{N=x.bitmap,this.tiles.push(l(function(A,I){return[N[(a*I+A)*4],N[(a*I+A)*4+1],N[(a*I+A)*4+2],N[(a*I+A)*4+3]]}));for(let A=1;A<v;A++)this.tiles.push(A<4?u(this.tiles[this.T+A-1]):h(this.tiles[this.T+A-4]))}for(let A=0;A<v;A++)d.push(x.weight||1)}this.T=f.length,this.weights=d,this.propagator=new Array(4);const E=new Array(4);for(let T=0;T<4;T++){this.propagator[T]=new Array(this.T),E[T]=new Array(this.T);for(let x=0;x<this.T;x++){E[T][x]=new Array(this.T);for(let N=0;N<this.T;N++)E[T][x][N]=!1}}for(let T=0;T<e.neighbors.length;T++){const x=e.neighbors[T],N=x.left.split(" ").filter(function($){return $.length}),A=x.right.split(" ").filter(function($){return $.length});if(c!==null&&(c.indexOf(N[0])===-1||c.indexOf(A[0])===-1))continue;const I=f[p[N[0]]][N.length==1?0:parseInt(N[1],10)],k=f[I][1],L=f[p[A[0]]][A.length==1?0:parseInt(A[1],10)],U=f[L][1];E[0][L][I]=!0,E[0][f[L][6]][f[I][6]]=!0,E[0][f[I][4]][f[L][4]]=!0,E[0][f[I][2]][f[L][2]]=!0,E[1][U][k]=!0,E[1][f[k][6]][f[U][6]]=!0,E[1][f[U][4]][f[k][4]]=!0,E[1][f[k][2]][f[U][2]]=!0}for(let T=0;T<this.T;T++)for(let x=0;x<this.T;x++)E[2][T][x]=E[0][x][T],E[3][T][x]=E[1][x][T];for(let T=0;T<4;T++)for(let x=0;x<this.T;x++){const N=[],A=E[T][x];for(let I=0;I<this.T;I++)A[I]&&N.push(I);this.propagator[T][x]=N}};Mb.prototype=Object.create(FVe.prototype);Mb.prototype.constructor=Mb;Mb.prototype.onBoundary=function(t,e){return!this.periodic&&(t<0||e<0||t>=this.FMX||e>=this.FMY)};Mb.prototype.graphics=function(t,e){return t=t||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,e),t};Mb.prototype.graphicsComplete=function(t){for(let e=0;e<this.FMX;e++)for(let n=0;n<this.FMY;n++){const i=this.tiles[this.observed[e+n*this.FMX]];for(let r=0;r<this.tilesize;r++)for(let s=0;s<this.tilesize;s++){const a=(e*this.tilesize+s+(n*this.tilesize+r)*this.FMX*this.tilesize)*4,o=i[s+r*this.tilesize];t[a]=o[0],t[a+1]=o[1],t[a+2]=o[2],t[a+3]=o[3]}}};Mb.prototype.graphicsIncomplete=function(t,e){(!e||e.length!==4)&&(e=!1);for(let n=0;n<this.FMX;n++)for(let i=0;i<this.FMY;i++){const r=this.wave[n+i*this.FMX];let s=0,a=0;for(let c=0;c<this.T;c++)r[c]&&(s++,a+=this.weights[c]);const o=1/a;for(let c=0;c<this.tilesize;c++)for(let l=0;l<this.tilesize;l++){const u=(n*this.tilesize+l+(i*this.tilesize+c)*this.FMX*this.tilesize)*4;if(e&&s===this.T)t[u]=e[0],t[u+1]=e[1],t[u+2]=e[2],t[u+3]=e[3];else{let h=0,d=0,f=0,p=0;for(let g=0;g<this.T;g++)if(r[g]){const _=this.tiles[g][l+c*this.tilesize],v=this.weights[g]*o;h+=_[0]*v,d+=_[1]*v,f+=_[2]*v,p+=_[3]*v}t[u]=h,t[u+1]=d,t[u+2]=f,t[u+3]=p}}}};var zVe=Mb,HVe={OverlappingModel:BVe,SimpleTiledModel:zVe};const jVe=Gc(HVe),qee=5;function VVe(t,e,n,i,r,s,a){if(!ae(ne.book))return!1;const o=ne.book,c=ed(o,Kn.BOARD,t),l=ed(o,Kn.BOARD,e),u=vl(c),h=vl(l);if(!ae(u)||!ae(h))return!1;hl(o,u),hl(o,h);let d=0;const f=new Map,p=new Map;let g=0;const _=32,v=new Uint8Array(Bde*4);for(let I=0;I<jr;++I)for(let k=0;k<fi;++k){const L=em(h,{x:k,y:I}),U=(L==null?void 0:L.char)??0,$=(L==null?void 0:L.color)??_,q=(L==null?void 0:L.bg)??_;v[g++]=U,v[g++]=$,v[g++]=q;const G=wb(o,L),X=ai((G==null?void 0:G.name)??"empty"),ie=f.get(X);pn(ie)?v[g++]=ie:(f.set(X,d),p.set(d,X),v[g++]=d++)}const E=s.x-r.x+1,T=s.y-r.y+1,x=new jVe.OverlappingModel(v,fi,jr,n,E,T,!1,!1,i,0);let N=0;for(;N<qee&&!x.generate();++N);if(N===qee)return!1;g=0;const A=x.graphics();for(let I=r.y;I<=s.y;++I)for(let k=r.x;k<=s.x;++k){const L={x:k,y:I},U=A[g++],$=A[g++],q=A[g++];switch(d=A[g++],a){case"all":{const Y=em(u,{x:k,y:I});Mg(Y)&&sy(o,u,Y,o.timestamp),Og(u,{x:k,y:I});break}case"object":{const Y=em(u,{x:k,y:I});Mg(Y)&&sy(o,u,Y,o.timestamp);break}case"terrain":Og(u,{x:k,y:I});break}let G=p.get(d)??"";const X=LN(o,G),ie=mB(o,G),V=X??ie;switch(a){case"all":break;case"object":ae(ie)&&(G="");break;case"terrain":ae(X)&&(G="");break}const Z=_T(o,u,[G],L);if(!(!ae(Z)||!ae(V))&&(J2(Z,V),U>0&&(Z.char=U),$<_&&(Z.color=$),q<_&&(Z.bg=q),Mg(Z))){const Y=Xa(DN(h,G));ae(Y)&&(Og(u,{...$7(h,Y.x??0,Y.y??0),x:k,y:I}),J2(Z,Y))}}return!0}function mpe(t){return`zss_snapshot_${t}`}function GVe(t,e,n,i){const r=ed(ne.book,Kn.BOARD,t),s=vl(r);if(!ae(s))return;const a=mpe(s.id);Qde(ne.book,a);const o=S_(wc.CONTENT,a,Kn.BOARD),c=vl(o);if(ae(c))return GW(t,c.id,e,n,i),c}function qVe(t,e,n,i){const r=ed(ne.book,Kn.BOARD,t),s=vl(r);if(!ae(s))return;const a=mpe(s.id),o=ed(ne.book,Kn.BOARD,a),c=vl(o);if(ae(c))return GW(c.id,t,e,n,i),c}function $Ve(t,e,n,i,r){if(!ae(ne.book))return;const s=ne.book,a=ed(s,Kn.BOARD,t),o=vl(a);if(!ae(o))return;const c=q7();hl(s,o);for(let l=n.y;l<=i.y;++l)for(let u=n.x;u<=i.x;++u){let h=!1,d=!1;switch(r){case"all":h=!0,d=!0;break;case"object":h=!0;break;case"terrain":d=!0;break}const f=(u+e.x+fi)%fi,p=(l+e.y+jr)%jr;if(h){const g=em(o,{x:u,y:l});Mg(g)&&ae(g==null?void 0:g.x)&&ae(g==null?void 0:g.y)&&(g.x=f,g.lx=f,g.y=p,g.ly=p)}d&&(c.terrain[f+p*fi]=o.terrain[u+l*fi])}(r==="all"||r==="terrain")&&(o.terrain=[...c.terrain]),delete o.named,delete o.lookup,hl(s,o)}function o1(t,e){let n="all";const i={x:0,y:0},r={x:fi-1,y:jr-1};for(let s=e;s<t.length;){const[a,o]=Ot(t,s,[st.MAYBE_NUMBER_OR_STRING]);if(On(a))n=ai(a),s=o;else if(pn(a)){const[c,l,u,h]=Ot(t,o,[st.NUMBER,st.NUMBER,st.NUMBER]);i.x=Math.min(a,l),i.y=Math.min(c,u),r.x=Math.max(a,l),r.y=Math.max(c,u),s=h}else break}return{targetset:n,pt1:i,pt2:r}}const WVe=i0().command("snapshot",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const n=o1(e,0);return GVe(ne.board.id,n.pt1,n.pt2,n.targetset),0}).command("revert",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const n=o1(e,0);return qVe(ne.board.id,n.pt1,n.pt2,n.targetset),0}).command("copy",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const[n,i]=Ot(e,0,[st.NAME]),r=Gf(ne.book,Kn.BOARD,n),s=Xa(...r);if(ae(s)){const a=o1(e,i);GW(ne.board.id,s.id,a.pt1,a.pt2,a.targetset)}return 0}).command("remix",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const[n,i,r,s]=Ot(e,0,[st.NAME,st.NUMBER,st.NUMBER]),a=Gf(ne.book,Kn.BOARD,n),o=Xa(...a);if(ae(o)){const c=o1(e,s);VVe(ne.board.id,o.id,i,r,c.pt1,c.pt2,c.targetset)}return 0}).command("weave",(t,e)=>{var a,o;if(!ae(ne.book)||!ae(ne.board))return 0;const[n,i]=Ot(e,0,[st.DIR]),r={x:n.x-(((a=ne.element)==null?void 0:a.x)??0),y:n.y-(((o=ne.element)==null?void 0:o.y)??0)},s=o1(e,i);return $Ve(ne.board.id,r,s.pt1,s.pt2,s.targetset),0}).command("pivot",(t,e)=>{if(!ae(ne.book)||!ae(ne.board))return 0;const[n,i]=Ot(e,0,[st.NUMBER]),r=o1(e,i);return DVe(ne.board.id,Tue(n),r.pt1,r.pt2,r.targetset),0});var qW=(t=>(t[t.ERROR=0]="ERROR",t[t.CLI=1]="CLI",t[t.LOADER=2]="LOADER",t[t.RUNTIME=3]="RUNTIME",t))(qW||{});const YVe={audio:SW,board:lHe,cli:$5e,display:W5e,element:tVe,runtime:OVe,lifecycle:nVe,loader:_Ve,network:bVe,transform:WVe},lH=["audio","board","display","network","transform","lifecycle","element"],XVe={0:[],1:["cli",...lH],2:["loader",...lH],3:["runtime",...lH]},KVe={0:new Map,1:new Map,2:new Map,3:new Map};function VN(t){return(XVe[t]??[]).map(n=>YVe[n]).filter(ae)}function JVe(t,e){const n=KVe[t];if(!n.has(e)){let i;const r=VN(t);for(let s=0;s<r.length&&(i=r[s].getcommand(e),!ae(i));++s);n.set(e,i)}return n.get(e)}function ZVe(t,e,n){const i=VN(t);for(let r=0;r<i.length;++r){const s=i[r];if(s.get!==void 0){const[a,o]=s.get(e,n);if(a)return[a,o]}}return[!1,void 0]}function QVe(t,e,n,i){const r=VN(t);for(let s=0;s<r.length;++s){const a=r[s];if(a.set!==void 0){const[o]=a.set(e,n,i);if(o)return[o,i]}}return[!1,void 0]}function eGe(t,e){const n=VN(t);for(let i=0;i<n.length;++i)n[i].tick(e)}function $ee(t,e){const n=VN(t);for(let i=0;i<n.length;++i)n[i].everytick(e)}var gpe={},vpe={},ype={};const Wee="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");ype.encode=function(t){if(0<=t&&t<Wee.length)return Wee[t];throw new TypeError("Must be between 0 and 63: "+t)};const tGe=ype,_pe=5,bpe=1<<_pe,nGe=bpe-1,iGe=bpe;function rGe(t){return t<0?(-t<<1)+1:(t<<1)+0}vpe.encode=function(e){let n="",i,r=rGe(e);do i=r&nGe,r>>>=_pe,r>0&&(i|=iGe),n+=tGe.encode(i);while(r>0);return n};var GN={};(function(t){function e(A,I,k){if(I in A)return A[I];if(arguments.length===3)return k;throw new Error('"'+I+'" is a required argument.')}t.getArg=e;const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,i=/^data:.+\,.+$/;function r(A){const I=A.match(n);return I?{scheme:I[1],auth:I[2],host:I[3],port:I[4],path:I[5]}:null}t.urlParse=r;function s(A){let I="";return A.scheme&&(I+=A.scheme+":"),I+="//",A.auth&&(I+=A.auth+"@"),A.host&&(I+=A.host),A.port&&(I+=":"+A.port),A.path&&(I+=A.path),I}t.urlGenerate=s;const a=32;function o(A){const I=[];return function(k){for(let U=0;U<I.length;U++)if(I[U].input===k){const $=I[0];return I[0]=I[U],I[U]=$,I[0].result}const L=A(k);return I.unshift({input:k,result:L}),I.length>a&&I.pop(),L}}const c=o(function(I){let k=I;const L=r(I);if(L){if(!L.path)return I;k=L.path}const U=t.isAbsolute(k),$=[];let q=0,G=0;for(;;)if(q=G,G=k.indexOf("/",q),G===-1){$.push(k.slice(q));break}else for($.push(k.slice(q,G));G<k.length&&k[G]==="/";)G++;let X=0;for(G=$.length-1;G>=0;G--){const ie=$[G];ie==="."?$.splice(G,1):ie===".."?X++:X>0&&(ie===""?($.splice(G+1,X),X=0):($.splice(G,2),X--))}return k=$.join("/"),k===""&&(k=U?"/":"."),L?(L.path=k,s(L)):k});t.normalize=c;function l(A,I){A===""&&(A="."),I===""&&(I=".");const k=r(I),L=r(A);if(L&&(A=L.path||"/"),k&&!k.scheme)return L&&(k.scheme=L.scheme),s(k);if(k||I.match(i))return I;if(L&&!L.host&&!L.path)return L.host=I,s(L);const U=I.charAt(0)==="/"?I:c(A.replace(/\/+$/,"")+"/"+I);return L?(L.path=U,s(L)):U}t.join=l,t.isAbsolute=function(A){return A.charAt(0)==="/"||n.test(A)};function u(A,I){A===""&&(A="."),A=A.replace(/\/$/,"");let k=0;for(;I.indexOf(A+"/")!==0;){const L=A.lastIndexOf("/");if(L<0||(A=A.slice(0,L),A.match(/^([^\/]+:\/)?\/*$/)))return I;++k}return Array(k+1).join("../")+I.substr(A.length+1)}t.relative=u;const h=function(){return!("__proto__"in Object.create(null))}();function d(A){return A}function f(A){return g(A)?"$"+A:A}t.toSetString=h?d:f;function p(A){return g(A)?A.slice(1):A}t.fromSetString=h?d:p;function g(A){if(!A)return!1;const I=A.length;if(I<9||A.charCodeAt(I-1)!==95||A.charCodeAt(I-2)!==95||A.charCodeAt(I-3)!==111||A.charCodeAt(I-4)!==116||A.charCodeAt(I-5)!==111||A.charCodeAt(I-6)!==114||A.charCodeAt(I-7)!==112||A.charCodeAt(I-8)!==95||A.charCodeAt(I-9)!==95)return!1;for(let k=I-10;k>=0;k--)if(A.charCodeAt(k)!==36)return!1;return!0}function _(A,I,k){let L=E(A.source,I.source);return L!==0||(L=A.originalLine-I.originalLine,L!==0)||(L=A.originalColumn-I.originalColumn,L!==0||k)||(L=A.generatedColumn-I.generatedColumn,L!==0)||(L=A.generatedLine-I.generatedLine,L!==0)?L:E(A.name,I.name)}t.compareByOriginalPositions=_;function v(A,I,k){let L=A.generatedLine-I.generatedLine;return L!==0||(L=A.generatedColumn-I.generatedColumn,L!==0||k)||(L=E(A.source,I.source),L!==0)||(L=A.originalLine-I.originalLine,L!==0)||(L=A.originalColumn-I.originalColumn,L!==0)?L:E(A.name,I.name)}t.compareByGeneratedPositionsDeflated=v;function E(A,I){return A===I?0:A===null?1:I===null?-1:A>I?1:-1}function T(A,I){let k=A.generatedLine-I.generatedLine;return k!==0||(k=A.generatedColumn-I.generatedColumn,k!==0)||(k=E(A.source,I.source),k!==0)||(k=A.originalLine-I.originalLine,k!==0)||(k=A.originalColumn-I.originalColumn,k!==0)?k:E(A.name,I.name)}t.compareByGeneratedPositionsInflated=T;function x(A){return JSON.parse(A.replace(/^\)]}'[^\n]*\n/,""))}t.parseSourceMapInput=x;function N(A,I,k){if(I=I||"",A&&(A[A.length-1]!=="/"&&I[0]!=="/"&&(A+="/"),I=A+I),k){const L=r(k);if(!L)throw new Error("sourceMapURL could not be parsed");if(L.path){const U=L.path.lastIndexOf("/");U>=0&&(L.path=L.path.substring(0,U+1))}I=l(s(L),I)}return c(I)}t.computeSourceURL=N})(GN);var $W={};let sGe=class Epe{constructor(){this._array=[],this._set=new Map}static fromArray(e,n){const i=new Epe;for(let r=0,s=e.length;r<s;r++)i.add(e[r],n);return i}size(){return this._set.size}add(e,n){const i=this.has(e),r=this._array.length;(!i||n)&&this._array.push(e),i||this._set.set(e,r)}has(e){return this._set.has(e)}indexOf(e){const n=this._set.get(e);if(n>=0)return n;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}};$W.ArraySet=sGe;var Spe={};const Tpe=GN;function aGe(t,e){const n=t.generatedLine,i=e.generatedLine,r=t.generatedColumn,s=e.generatedColumn;return i>n||i==n&&s>=r||Tpe.compareByGeneratedPositionsInflated(t,e)<=0}let oGe=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,n){this._array.forEach(e,n)}add(e){aGe(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))}toArray(){return this._sorted||(this._array.sort(Tpe.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}};Spe.MappingList=oGe;const KR=vpe,tc=GN,lD=$W.ArraySet,cGe=Spe.MappingList;let xpe=class wpe{constructor(e){e||(e={}),this._file=tc.getArg(e,"file",null),this._sourceRoot=tc.getArg(e,"sourceRoot",null),this._skipValidation=tc.getArg(e,"skipValidation",!1),this._sources=new lD,this._names=new lD,this._mappings=new cGe,this._sourcesContents=null}static fromSourceMap(e){const n=e.sourceRoot,i=new wpe({file:e.file,sourceRoot:n});return e.eachMapping(function(r){const s={generated:{line:r.generatedLine,column:r.generatedColumn}};r.source!=null&&(s.source=r.source,n!=null&&(s.source=tc.relative(n,s.source)),s.original={line:r.originalLine,column:r.originalColumn},r.name!=null&&(s.name=r.name)),i.addMapping(s)}),e.sources.forEach(function(r){let s=r;n!==null&&(s=tc.relative(n,r)),i._sources.has(s)||i._sources.add(s);const a=e.sourceContentFor(r);a!=null&&i.setSourceContent(r,a)}),i}addMapping(e){const n=tc.getArg(e,"generated"),i=tc.getArg(e,"original",null);let r=tc.getArg(e,"source",null),s=tc.getArg(e,"name",null);this._skipValidation||this._validateMapping(n,i,r,s),r!=null&&(r=String(r),this._sources.has(r)||this._sources.add(r)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:n.line,generatedColumn:n.column,originalLine:i!=null&&i.line,originalColumn:i!=null&&i.column,source:r,name:s})}setSourceContent(e,n){let i=e;this._sourceRoot!=null&&(i=tc.relative(this._sourceRoot,i)),n!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[tc.toSetString(i)]=n):this._sourcesContents&&(delete this._sourcesContents[tc.toSetString(i)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(e,n,i){let r=n;if(n==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);r=e.file}const s=this._sourceRoot;s!=null&&(r=tc.relative(s,r));const a=this._mappings.toArray().length>0?new lD:this._sources,o=new lD;this._mappings.unsortedForEach(function(c){if(c.source===r&&c.originalLine!=null){const h=e.originalPositionFor({line:c.originalLine,column:c.originalColumn});h.source!=null&&(c.source=h.source,i!=null&&(c.source=tc.join(i,c.source)),s!=null&&(c.source=tc.relative(s,c.source)),c.originalLine=h.line,c.originalColumn=h.column,h.name!=null&&(c.name=h.name))}const l=c.source;l!=null&&!a.has(l)&&a.add(l);const u=c.name;u!=null&&!o.has(u)&&o.add(u)},this),this._sources=a,this._names=o,e.sources.forEach(function(c){const l=e.sourceContentFor(c);l!=null&&(i!=null&&(c=tc.join(i,c)),s!=null&&(c=tc.relative(s,c)),this.setSourceContent(c,l))},this)}_validateMapping(e,n,i,r){if(n&&typeof n.line!="number"&&typeof n.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!n&&!i&&!r)){if(!(e&&"line"in e&&"column"in e&&n&&"line"in n&&"column"in n&&e.line>0&&e.column>=0&&n.line>0&&n.column>=0&&i))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:i,original:n,name:r}))}}_serializeMappings(){let e=0,n=1,i=0,r=0,s=0,a=0,o="",c,l,u,h;const d=this._mappings.toArray();for(let f=0,p=d.length;f<p;f++){if(l=d[f],c="",l.generatedLine!==n)for(e=0;l.generatedLine!==n;)c+=";",n++;else if(f>0){if(!tc.compareByGeneratedPositionsInflated(l,d[f-1]))continue;c+=","}c+=KR.encode(l.generatedColumn-e),e=l.generatedColumn,l.source!=null&&(h=this._sources.indexOf(l.source),c+=KR.encode(h-a),a=h,c+=KR.encode(l.originalLine-1-r),r=l.originalLine-1,c+=KR.encode(l.originalColumn-i),i=l.originalColumn,l.name!=null&&(u=this._names.indexOf(l.name),c+=KR.encode(u-s),s=u)),o+=c}return o}_generateSourcesContent(e,n){return e.map(function(i){if(!this._sourcesContents)return null;n!=null&&(i=tc.relative(n,i));const r=tc.toSetString(i);return Object.prototype.hasOwnProperty.call(this._sourcesContents,r)?this._sourcesContents[r]:null},this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}};xpe.prototype._version=3;gpe.SourceMapGenerator=xpe;var Cpe={};(function(t){t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2;function e(n,i,r,s,a,o){const c=Math.floor((i-n)/2)+n,l=a(r,s[c],!0);return l===0?c:l>0?i-c>1?e(c,i,r,s,a,o):o==t.LEAST_UPPER_BOUND?i<s.length?i:-1:c:c-n>1?e(n,c,r,s,a,o):o==t.LEAST_UPPER_BOUND?c:n<0?-1:n}t.search=function(i,r,s,a){if(r.length===0)return-1;let o=e(-1,r.length,i,r,s,a||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(r[o],r[o-1],!0)===0;)--o;return o}})(Cpe);var bA={exports:{}};const lGe={},IV=Object.freeze(Object.defineProperty({__proto__:null,default:lGe},Symbol.toStringTag,{value:"Module"})),xT=jre(IV),uGe=(function(){return typeof window<"u"&&this===window}).call();if(uGe){let t=null;bA.exports=function(){if(typeof t=="string")return fetch(t).then(n=>n.arrayBuffer());if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},bA.exports.initialize=e=>t=e}else{const t=xT,e=xT;bA.exports=function(){return new Promise((i,r)=>{const s=e.join(__dirname,"mappings.wasm");t.readFile(s,null,(a,o)=>{if(a){r(a);return}i(o.buffer)})})},bA.exports.initialize=n=>{console.debug("SourceMapConsumer.initialize is a no-op when running in node.js")}}var Rpe=bA.exports;const hGe=Rpe;function dGe(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let JR=null;var fGe=function(){if(JR)return JR;const e=[];return JR=hGe().then(n=>WebAssembly.instantiate(n,{env:{mapping_callback(i,r,s,a,o,c,l,u,h,d){const f=new dGe;f.generatedLine=i+1,f.generatedColumn=r,s&&(f.lastGeneratedColumn=a-1),o&&(f.source=c,f.originalLine=l+1,f.originalColumn=u,h&&(f.name=d)),e[e.length-1](f)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(n=>({exports:n.instance.exports,withMappingCallback:(i,r)=>{e.push(i);try{r()}finally{e.pop()}}})).then(null,n=>{throw JR=null,n}),JR};const ii=GN,uH=Cpe,Z2=$W.ArraySet,pGe=Rpe,mGe=fGe,WW=Symbol("smcInternal");class Lo{constructor(e,n){return e==WW?Promise.resolve(this):vGe(e,n)}static initialize(e){pGe.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,n){return yGe(e,n)}static async with(e,n,i){const r=await new Lo(e,n);try{return await i(r)}finally{r.destroy()}}_parseMappings(e,n){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,n,i){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}Lo.prototype._version=3;Lo.GENERATED_ORDER=1;Lo.ORIGINAL_ORDER=2;Lo.GREATEST_LOWER_BOUND=1;Lo.LEAST_UPPER_BOUND=2;class qN extends Lo{constructor(e,n){return super(WW).then(i=>{let r=e;typeof e=="string"&&(r=ii.parseSourceMapInput(e));const s=ii.getArg(r,"version");let a=ii.getArg(r,"sources");const o=ii.getArg(r,"names",[]);let c=ii.getArg(r,"sourceRoot",null);const l=ii.getArg(r,"sourcesContent",null),u=ii.getArg(r,"mappings"),h=ii.getArg(r,"file",null);if(s!=i._version)throw new Error("Unsupported version: "+s);return c&&(c=ii.normalize(c)),a=a.map(String).map(ii.normalize).map(function(d){return c&&ii.isAbsolute(c)&&ii.isAbsolute(d)?ii.relative(c,d):d}),i._names=Z2.fromArray(o.map(String),!0),i._sources=Z2.fromArray(a,!0),i._absoluteSources=i._sources.toArray().map(function(d){return ii.computeSourceURL(c,d,n)}),i.sourceRoot=c,i.sourcesContent=l,i._mappings=u,i._sourceMapURL=n,i.file=h,i._computedColumnSpans=!1,i._mappingsPtr=0,i._wasm=null,mGe().then(d=>(i._wasm=d,i))})}_findSourceIndex(e){let n=e;if(this.sourceRoot!=null&&(n=ii.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(let i=0;i<this._absoluteSources.length;++i)if(this._absoluteSources[i]==e)return i;return-1}static fromSourceMap(e,n){return new qN(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,n){const i=e.length,r=this._wasm.exports.allocate_mappings(i),s=new Uint8Array(this._wasm.exports.memory.buffer,r,i);for(let o=0;o<i;o++)s[o]=e.charCodeAt(o);const a=this._wasm.exports.parse_mappings(r);if(!a){const o=this._wasm.exports.get_last_error();let c=`Error parsing mappings (code ${o}): `;switch(o){case 1:c+="the mappings contained a negative line, column, source index, or name index";break;case 2:c+="the mappings contained a number larger than 2**32";break;case 3:c+="reached EOF while in the middle of parsing a VLQ";break;case 4:c+="invalid base 64 character while parsing a VLQ";break;default:c+="unknown error code";break}throw new Error(c)}this._mappingsPtr=a}eachMapping(e,n,i){const r=n||null,s=i||Lo.GENERATED_ORDER,a=this.sourceRoot;this._wasm.withMappingCallback(o=>{o.source!==null&&(o.source=this._sources.at(o.source),o.source=ii.computeSourceURL(a,o.source,this._sourceMapURL),o.name!==null&&(o.name=this._names.at(o.name))),e.call(r,o)},()=>{switch(s){case Lo.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case Lo.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(e){let n=ii.getArg(e,"source");const i=ii.getArg(e,"line"),r=e.column||0;if(n=this._findSourceIndex(n),n<0)return[];if(i<1)throw new Error("Line numbers must be >= 1");if(r<0)throw new Error("Column numbers must be >= 0");const s=[];return this._wasm.withMappingCallback(a=>{let o=a.lastGeneratedColumn;this._computedColumnSpans&&o===null&&(o=1/0),s.push({line:a.generatedLine,column:a.generatedColumn,lastColumn:o})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),n,i-1,"column"in e,r)}),s}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const n={generatedLine:ii.getArg(e,"line"),generatedColumn:ii.getArg(e,"column")};if(n.generatedLine<1)throw new Error("Line numbers must be >= 1");if(n.generatedColumn<0)throw new Error("Column numbers must be >= 0");let i=ii.getArg(e,"bias",Lo.GREATEST_LOWER_BOUND);i==null&&(i=Lo.GREATEST_LOWER_BOUND);let r;if(this._wasm.withMappingCallback(s=>r=s,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),n.generatedLine-1,n.generatedColumn,i)}),r&&r.generatedLine===n.generatedLine){let s=ii.getArg(r,"source",null);s!==null&&(s=this._sources.at(s),s=ii.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));let a=ii.getArg(r,"name",null);return a!==null&&(a=this._names.at(a)),{source:s,line:ii.getArg(r,"originalLine",null),column:ii.getArg(r,"originalColumn",null),name:a}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1}sourceContentFor(e,n){if(!this.sourcesContent)return null;const i=this._findSourceIndex(e);if(i>=0)return this.sourcesContent[i];let r=e;this.sourceRoot!=null&&(r=ii.relative(this.sourceRoot,r));let s;if(this.sourceRoot!=null&&(s=ii.urlParse(this.sourceRoot))){const a=r.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(a))return this.sourcesContent[this._sources.indexOf(a)];if((!s.path||s.path=="/")&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(n)return null;throw new Error('"'+r+'" is not in the SourceMap.')}generatedPositionFor(e){let n=ii.getArg(e,"source");if(n=this._findSourceIndex(n),n<0)return{line:null,column:null,lastColumn:null};const i={source:n,originalLine:ii.getArg(e,"line"),originalColumn:ii.getArg(e,"column")};if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");let r=ii.getArg(e,"bias",Lo.GREATEST_LOWER_BOUND);r==null&&(r=Lo.GREATEST_LOWER_BOUND);let s;if(this._wasm.withMappingCallback(a=>s=a,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),i.source,i.originalLine-1,i.originalColumn,r)}),s&&s.source===i.source){let a=s.lastGeneratedColumn;return this._computedColumnSpans&&a===null&&(a=1/0),{line:ii.getArg(s,"generatedLine",null),column:ii.getArg(s,"generatedColumn",null),lastColumn:a}}return{line:null,column:null,lastColumn:null}}}qN.prototype.consumer=Lo;class gGe extends Lo{constructor(e,n){return super(WW).then(i=>{let r=e;typeof e=="string"&&(r=ii.parseSourceMapInput(e));const s=ii.getArg(r,"version"),a=ii.getArg(r,"sections");if(s!=i._version)throw new Error("Unsupported version: "+s);i._sources=new Z2,i._names=new Z2,i.__generatedMappings=null,i.__originalMappings=null,i.__generatedMappingsUnsorted=null,i.__originalMappingsUnsorted=null;let o={line:-1,column:0};return Promise.all(a.map(c=>{if(c.url)throw new Error("Support for url field in sections not implemented.");const l=ii.getArg(c,"offset"),u=ii.getArg(l,"line"),h=ii.getArg(l,"column");if(u<o.line||u===o.line&&h<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");return o=l,new Lo(ii.getArg(c,"map"),n).then(f=>({generatedOffset:{generatedLine:u+1,generatedColumn:h+1},consumer:f}))})).then(c=>(i._sections=c,i))})}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(ii.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(ii.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let n=0;n<this._sections.length;n++)for(let i=0;i<this._sections[n].consumer.sources.length;i++)e.push(this._sections[n].consumer.sources[i]);return e}originalPositionFor(e){const n={generatedLine:ii.getArg(e,"line"),generatedColumn:ii.getArg(e,"column")},i=uH.search(n,this._sections,function(s,a){const o=s.generatedLine-a.generatedOffset.generatedLine;return o||s.generatedColumn-a.generatedOffset.generatedColumn}),r=this._sections[i];return r?r.consumer.originalPositionFor({line:n.generatedLine-(r.generatedOffset.generatedLine-1),column:n.generatedColumn-(r.generatedOffset.generatedLine===n.generatedLine?r.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})}sourceContentFor(e,n){for(let i=0;i<this._sections.length;i++){const s=this._sections[i].consumer.sourceContentFor(e,!0);if(s)return s}if(n)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let n=0;n<this._sections.length;n++){const i=this._sections[n];if(i.consumer._findSourceIndex(ii.getArg(e,"source"))===-1)continue;const r=i.consumer.generatedPositionFor(e);if(r)return{line:r.line+(i.generatedOffset.generatedLine-1),column:r.column+(i.generatedOffset.generatedLine===r.line?i.generatedOffset.generatedColumn-1:0)}}return{line:null,column:null}}_parseMappings(e,n){const i=this.__generatedMappingsUnsorted=[],r=this.__originalMappingsUnsorted=[];for(let s=0;s<this._sections.length;s++){const a=this._sections[s],o=[];a.consumer.eachMapping(c=>o.push(c));for(let c=0;c<o.length;c++){const l=o[c];let u=ii.computeSourceURL(a.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(u),u=this._sources.indexOf(u);let h=null;l.name&&(this._names.add(l.name),h=this._names.indexOf(l.name));const d={source:u,generatedLine:l.generatedLine+(a.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(a.generatedOffset.generatedLine===l.generatedLine?a.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:h};i.push(d),typeof d.originalLine=="number"&&r.push(d)}}}eachMapping(e,n,i){const r=n||null,s=i||Lo.GENERATED_ORDER;let a;switch(s){case Lo.GENERATED_ORDER:a=this._generatedMappings;break;case Lo.ORIGINAL_ORDER:a=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const o=this.sourceRoot;a.map(function(c){let l=null;return c.source!==null&&(l=this._sources.at(c.source),l=ii.computeSourceURL(o,l,this._sourceMapURL)),{source:l,generatedLine:c.generatedLine,generatedColumn:c.generatedColumn,originalLine:c.originalLine,originalColumn:c.originalColumn,name:c.name===null?null:this._names.at(c.name)}},this).forEach(e,r)}_findMapping(e,n,i,r,s,a){if(e[i]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[i]);if(e[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[r]);return uH.search(e,n,s,a)}allGeneratedPositionsFor(e){const n=ii.getArg(e,"line"),i={source:ii.getArg(e,"source"),originalLine:n,originalColumn:ii.getArg(e,"column",0)};if(i.source=this._findSourceIndex(i.source),i.source<0)return[];if(i.originalLine<1)throw new Error("Line numbers must be >= 1");if(i.originalColumn<0)throw new Error("Column numbers must be >= 0");const r=[];let s=this._findMapping(i,this._originalMappings,"originalLine","originalColumn",ii.compareByOriginalPositions,uH.LEAST_UPPER_BOUND);if(s>=0){let a=this._originalMappings[s];if(e.column===void 0){const o=a.originalLine;for(;a&&a.originalLine===o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:ii.getArg(a,"generatedLine",null),column:ii.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}else{const o=a.originalColumn;for(;a&&a.originalLine===n&&a.originalColumn==o;){let c=a.lastGeneratedColumn;this._computedColumnSpans&&c===null&&(c=1/0),r.push({line:ii.getArg(a,"generatedLine",null),column:ii.getArg(a,"generatedColumn",null),lastColumn:c}),a=this._originalMappings[++s]}}}return r}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}function vGe(t,e){let n=t;typeof t=="string"&&(n=ii.parseSourceMapInput(t));const i=n.sections!=null?new gGe(n,e):new qN(n,e);return Promise.resolve(i)}function yGe(t,e){return qN.fromSourceMap(t,e)}var Ape={};const _Ge=gpe.SourceMapGenerator,uD=GN,bGe=/(\r?\n)/,EGe=10,c1="$$$isSourceNode$$$";let SGe=class kV{constructor(e,n,i,r,s){this.children=[],this.sourceContents={},this.line=e??null,this.column=n??null,this.source=i??null,this.name=s??null,this[c1]=!0,r!=null&&this.add(r)}static fromStringWithSourceMap(e,n,i){const r=new kV,s=e.split(bGe);let a=0;const o=function(){const f=g(),p=g()||"";return f+p;function g(){return a<s.length?s[a++]:void 0}};let c=1,l=0,u=null,h;return n.eachMapping(function(f){if(u!==null)if(c<f.generatedLine)d(u,o()),c++,l=0;else{h=s[a]||"";const p=h.substr(0,f.generatedColumn-l);s[a]=h.substr(f.generatedColumn-l),l=f.generatedColumn,d(u,p),u=f;return}for(;c<f.generatedLine;)r.add(o()),c++;l<f.generatedColumn&&(h=s[a]||"",r.add(h.substr(0,f.generatedColumn)),s[a]=h.substr(f.generatedColumn),l=f.generatedColumn),u=f},this),a<s.length&&(u&&d(u,o()),r.add(s.splice(a).join(""))),n.sources.forEach(function(f){const p=n.sourceContentFor(f);p!=null&&(i!=null&&(f=uD.join(i,f)),r.setSourceContent(f,p))}),r;function d(f,p){if(f===null||f.source===void 0)r.add(p);else{const g=i?uD.join(i,f.source):f.source;r.add(new kV(f.originalLine,f.originalColumn,g,p,f.name))}}}add(e){if(Array.isArray(e))e.forEach(function(n){this.add(n)},this);else if(e[c1]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}prepend(e){if(Array.isArray(e))for(let n=e.length-1;n>=0;n--)this.prepend(e[n]);else if(e[c1]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this}walk(e){let n;for(let i=0,r=this.children.length;i<r;i++)n=this.children[i],n[c1]?n.walk(e):n!==""&&e(n,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let n,i;const r=this.children.length;if(r>0){for(n=[],i=0;i<r-1;i++)n.push(this.children[i]),n.push(e);n.push(this.children[i]),this.children=n}return this}replaceRight(e,n){const i=this.children[this.children.length-1];return i[c1]?i.replaceRight(e,n):typeof i=="string"?this.children[this.children.length-1]=i.replace(e,n):this.children.push("".replace(e,n)),this}setSourceContent(e,n){this.sourceContents[uD.toSetString(e)]=n}walkSourceContents(e){for(let i=0,r=this.children.length;i<r;i++)this.children[i][c1]&&this.children[i].walkSourceContents(e);const n=Object.keys(this.sourceContents);for(let i=0,r=n.length;i<r;i++)e(uD.fromSetString(n[i]),this.sourceContents[n[i]])}toString(){let e="";return this.walk(function(n){e+=n}),e}toStringWithSourceMap(e){const n={code:"",line:1,column:0},i=new _Ge(e);let r=!1,s=null,a=null,o=null,c=null;return this.walk(function(l,u){n.code+=l,u.source!==null&&u.line!==null&&u.column!==null?((s!==u.source||a!==u.line||o!==u.column||c!==u.name)&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name}),s=u.source,a=u.line,o=u.column,c=u.name,r=!0):r&&(i.addMapping({generated:{line:n.line,column:n.column}}),s=null,r=!1);for(let h=0,d=l.length;h<d;h++)l.charCodeAt(h)===EGe?(n.line++,n.column=0,h+1===d?(s=null,r=!1):r&&i.addMapping({source:u.source,original:{line:u.line,column:u.column},generated:{line:n.line,column:n.column},name:u.name})):n.column++}),this.walkSourceContents(function(l,u){i.setSourceContent(l,u)}),{code:n.code,map:i}}};Ape.SourceNode=SGe;var TGe=Ape.SourceNode;let Yee=0;const Xee=Bg,xGe=["Command","lines"];class wGe extends yze{constructor(){super(Yde,{traceInitPerf:Bg,skipValidations:!Bg,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"});Qn(this,"program",this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))}));Qn(this,"line",this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(aC)}])}));Qn(this,"stmt",this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.short_commands)),this.MANY(()=>this.SUBRULE(this.commands))}}])}));Qn(this,"inline",this.RULED("inline",()=>{this.SUBRULE(this.instmt)}));Qn(this,"instmt",this.RULED("instmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}])}));Qn(this,"stmt_label",this.RULED("stmt_label",()=>{this.CONSUME(X7)}));Qn(this,"stmt_stat",this.RULED("stmt_stat",()=>{this.CONSUME(PN)}));Qn(this,"stmt_text",this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(fB)}])}));Qn(this,"stmt_comment",this.RULED("stmt_comment",()=>{this.CONSUME(Y7)}));Qn(this,"stmt_hyperlink",this.RULED("stmt_hyperlink",()=>{this.CONSUME(K7),this.SUBRULE(this.words),this.CONSUME(J7)}));Qn(this,"stmt_command",this.RULED("stmt_command",()=>{this.CONSUME(CS),this.AT_LEAST_ONE(()=>this.SUBRULE(this.commands))}));Qn(this,"short_commands",this.RULED("short_commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])}));Qn(this,"commands",this.RULED("commands",()=>{this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])}));Qn(this,"structured_cmd",this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])}));Qn(this,"short_go",this.RULED("short_go",()=>{this.CONSUME(L2),this.SUBRULE(this.words)}));Qn(this,"short_try",this.RULED("short_try",()=>{this.CONSUME(uW),this.SUBRULE(this.words)}));Qn(this,"command_if",this.RULED("command_if",()=>{this.CONSUME(U2),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))}));Qn(this,"command_if_block",this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(eM),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(aC)),this.CONSUME4(CS),this.CONSUME4(B2)}}])}));Qn(this,"command_block",this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(eM),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(CS),this.CONSUME(B2)}}])}));Qn(this,"command_fork",this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(eM),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])}));Qn(this,"command_else_if",this.RULED("command_else_if",()=>{this.CONSUME(CS),this.CONSUME(F2),this.CONSUME(U2),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))}));Qn(this,"command_else",this.RULED("command_else",()=>{this.CONSUME(CS),this.CONSUME(F2),this.OPTION(()=>this.SUBRULE(this.command_fork))}));Qn(this,"command_while",this.RULED("command_while",()=>{this.CONSUME(pW),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_repeat",this.RULED("command_repeat",()=>{this.CONSUME(mW),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_waitfor",this.RULED("command_waitfor",()=>{this.CONSUME(gW),this.SUBRULE(this.words)}));Qn(this,"command_foreach",this.RULED("command_foreach",()=>{this.CONSUME(vW),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))}));Qn(this,"command_break",this.RULED("command_break",()=>{this.CONSUME(yW)}));Qn(this,"command_continue",this.RULED("command_continue",()=>{this.CONSUME(_W)}));Qn(this,"command_play",this.RULED("command_play",()=>{this.CONSUME(fW)}));Qn(this,"command_toast",this.RULED("command_toast",()=>{this.CONSUME($de)}));Qn(this,"expr",this.RULED("expr",()=>{this.SUBRULE1(this.and_test),this.MANY(()=>{this.CONSUME(N2),this.SUBRULE2(this.and_test)})}));Qn(this,"and_test",this.RULED("and_test",()=>{this.SUBRULE1(this.not_test),this.MANY(()=>{this.CONSUME(k2),this.SUBRULE2(this.not_test)})}));Qn(this,"not_test",this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(I2),this.SUBRULE1(this.not_test)}},{ALT:()=>this.SUBRULE2(this.comparison)}])}));Qn(this,"comparison",this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr)})}));Qn(this,"comp_op",this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(eW)},{ALT:()=>this.CONSUME(tW)},{ALT:()=>this.CONSUME(nW)},{ALT:()=>this.CONSUME(iW)},{ALT:()=>this.CONSUME(rW)},{ALT:()=>this.CONSUME(sW)}])}));Qn(this,"expr_value",this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value),this.MANY(()=>{this.CONSUME(N2),this.SUBRULE2(this.and_test_value)})}));Qn(this,"and_test_value",this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value),this.MANY(()=>{this.CONSUME(k2),this.SUBRULE2(this.not_test_value)})}));Qn(this,"not_test_value",this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(I2),this.SUBRULE1(this.not_test_value)}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])}));Qn(this,"arith_expr",this.RULED("arith_expr",()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item))}));Qn(this,"arith_expr_item",this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(D2)},{ALT:()=>this.CONSUME(P2)}]),this.SUBRULE(this.term)}));Qn(this,"term",this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))}));Qn(this,"term_item",this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(oW)},{ALT:()=>this.CONSUME(L2)},{ALT:()=>this.CONSUME(cW)},{ALT:()=>this.CONSUME(lW)}]),this.SUBRULE(this.factor)}));Qn(this,"factor",this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(D2)},{ALT:()=>this.CONSUME(P2)}]),this.SUBRULE(this.factor)}},{ALT:()=>this.SUBRULE(this.power)}])}));Qn(this,"power",this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(aW),this.SUBRULE(this.factor)})}));Qn(this,"words",this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))}));Qn(this,"token",this.RULED("token",()=>{this.OR([{ALT:()=>this.CONSUME(Z7)},{ALT:()=>this.CONSUME(gl)},{ALT:()=>this.CONSUME(Q7)},{ALT:()=>{this.CONSUME(hW),this.SUBRULE(this.words),this.CONSUME(dW)}}])}));this.performSelfAnalysis()}PEEK(n,i,...r){console.info(n,r.map(s=>[s.image,s.tokenType]),i)}RULED(n,i,r){const s=xGe.some(a=>n.includes(a));return this.RULE(n,()=>{const o=(Yee++).toString().padStart(3),c=s?"font-weight: bold;":"";if(Xee&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(u=>`[${u.tokenType.name} ${u.image.replaceAll(`
`,"\\n")}]`);console.info(`${o}%c> ${n} ${l.join(" ")}`,c)}i(),Xee&&!this.RECORDING_PHASE&&console.info(`${o}%c< ${n} `,c),Yee--},r)}}const Y1=new wGe;if(Nze){const t=Y1.getGAstProductions(),e=Oze(t);console.info(e)}const CGe=Y1.getBaseCstVisitorConstructor();var yn=(t=>(t[t.PROGRAM=0]="PROGRAM",t[t.API=1]="API",t[t.LINE=2]="LINE",t[t.MARK=3]="MARK",t[t.GOTO=4]="GOTO",t[t.COUNT=5]="COUNT",t[t.TEXT=6]="TEXT",t[t.LABEL=7]="LABEL",t[t.HYPERLINK=8]="HYPERLINK",t[t.STAT=9]="STAT",t[t.MOVE=10]="MOVE",t[t.COMMAND=11]="COMMAND",t[t.LITERAL=12]="LITERAL",t[t.IF=13]="IF",t[t.IF_CHECK=14]="IF_CHECK",t[t.IF_BLOCK=15]="IF_BLOCK",t[t.ELSE_IF=16]="ELSE_IF",t[t.ELSE=17]="ELSE",t[t.WHILE=18]="WHILE",t[t.BREAK=19]="BREAK",t[t.CONTINUE=20]="CONTINUE",t[t.REPEAT=21]="REPEAT",t[t.WAITFOR=22]="WAITFOR",t[t.FOREACH=23]="FOREACH",t[t.OR=24]="OR",t[t.AND=25]="AND",t[t.NOT=26]="NOT",t[t.COMPARE=27]="COMPARE",t[t.COMPARE_ITEM=28]="COMPARE_ITEM",t[t.OPERATOR=29]="OPERATOR",t[t.OPERATOR_ITEM=30]="OPERATOR_ITEM",t[t.EXPR=31]="EXPR",t))(yn||{}),bS=(t=>(t[t.IS_EQ=0]="IS_EQ",t[t.IS_NOT_EQ=1]="IS_NOT_EQ",t[t.IS_LESS_THAN=2]="IS_LESS_THAN",t[t.IS_GREATER_THAN=3]="IS_GREATER_THAN",t[t.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",t[t.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",t))(bS||{}),ig=(t=>(t[t.EMPTY=0]="EMPTY",t[t.PLUS=1]="PLUS",t[t.MINUS=2]="MINUS",t[t.POWER=3]="POWER",t[t.MULTIPLY=4]="MULTIPLY",t[t.DIVIDE=5]="DIVIDE",t[t.MOD_DIVIDE=6]="MOD_DIVIDE",t[t.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",t[t.UNI_PLUS=8]="UNI_PLUS",t[t.UNI_MINUS=9]="UNI_MINUS",t))(ig||{}),mP=(t=>(t[t.NUMBER=0]="NUMBER",t[t.STRING=1]="STRING",t[t.TEMPLATE=2]="TEMPLATE",t))(mP||{});function RGe(t){return!!(t!=null&&t.tokenType)}function Ef(t,e){const[n]=t??[];return((n==null?void 0:n.image)??e).trimStart().replaceAll(/^"|"$/g,"")}class AGe extends CGe{constructor(){super();Qn(this,"unique",0);Bg&&this.validateVisitor()}getnodelocation(n){const i=Object.values(n).flat().filter(r=>!!r).map(r=>r&&RGe(r)?{startLine:r.startLine,startColumn:r.startColumn,startOffset:r.startOffset,endLine:r.endLine,endColumn:r.endColumn,endOffset:r.endOffset}:r!=null&&r.location?{...r.location}:{startLine:0,startColumn:0,startOffset:0,endLine:0,endColumn:0,endOffset:0}).filter(r=>r.startLine!==0&&r.endLine!==0);return{startLine:Math.min(...i.map(r=>r.startLine??1)),startColumn:Math.min(...i.map(r=>r.startColumn??1)),startOffset:Math.min(...i.map(r=>r.startOffset??1)),endLine:Math.max(...i.map(r=>r.endLine??1)),endColumn:Math.max(...i.map(r=>r.endColumn??1)),endOffset:Math.max(...i.map(r=>r.endOffset??1))}}createcodenode(n,i){return[{...i,...this.getnodelocation(n),lineindex:0}]}createstringnode(n,i){return this.createcodenode(n,{type:12,literal:1,value:i})}createmarknode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:3,id:i,comment:r}))}creategotonode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:4,id:i,comment:r}))}createlinenode(n,i){return this.createcodenode(n,{type:2,stmts:i})}createapinode(n,i,r){return this.createlinenode(n,this.createcodenode(n,{type:1,words:r,method:i}))}createlogicnode(n,i,r,s){return this.createlinenode(n,this.createcodenode(n,{type:14,skip:r,words:s,method:i}))}createcountnode(n){return this.createcodenode(n,{type:5,index:this.unique++})}go(n){return Array.isArray(n)?n.map(i=>this.visit(i)).flat():ae(n)?[this.visit(n)].flat():[]}program(n){return this.unique=0,this.createcodenode(n,{type:0,lines:[this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:"restart"})),this.go(n.line)].flat()})}line(n){return n.stmt?this.go(n.stmt):[]}stmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.short_commands?[this.go(n.short_commands),this.go(n.commands)].flat():[]}inline(n){return this.go(n.instmt)}instmt(n){return n.stmt_label?this.go(n.stmt_label):n.stmt_stat?this.go(n.stmt_stat):n.stmt_text?this.go(n.stmt_text):n.stmt_comment?this.go(n.stmt_comment):n.stmt_command?this.go(n.stmt_command):n.stmt_hyperlink?this.go(n.stmt_hyperlink):n.commands?this.go(n.commands):[]}stmt_label(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!0,name:Ef(n.token_label,":").slice(1).trim()}))}stmt_stat(n){return this.createlinenode(n,this.createcodenode(n,{type:9,value:Ef(n.token_stat,"@").slice(1)}))}stmt_text(n){return this.createlinenode(n,this.createcodenode(n,{type:6,value:Ef(n.token_text,"")}))}stmt_comment(n){return this.createlinenode(n,this.createcodenode(n,{type:7,active:!1,name:Ef(n.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(n){return this.createlinenode(n,this.createcodenode(n,{type:8,link:this.go(n.words),text:Ef(n.token_hyperlinktext,";").slice(1)}))}stmt_command(n){return n.commands?this.go(n.commands):[]}short_commands(n){return n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):[]}commands(n){return n.words?this.createlinenode(n,this.createcodenode(n,{type:11,words:this.go(n.words)})):n.short_go?this.go(n.short_go):n.short_try?this.go(n.short_try):n.command_play?this.go(n.command_play):n.command_toast?this.go(n.command_toast):n.structured_cmd?this.go(n.structured_cmd):[]}structured_cmd(n){return n.command_if?this.go(n.command_if):n.command_while?this.go(n.command_while):n.command_repeat?this.go(n.command_repeat):n.command_waitfor?this.go(n.command_waitfor):n.command_foreach?this.go(n.command_foreach):n.command_break?this.go(n.command_break):n.command_continue?this.go(n.command_continue):[]}short_go(n){return n.token_divide?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!0,words:this.go(n.words)})):[]}short_try(n){return n.token_query?this.createlinenode(n,this.createcodenode(n,{type:10,wait:!1,words:this.go(n.words)})):[]}command_if(n){const[i]=this.createlogicnode(n,Ef(n.token_if,"if"),"",this.go(n.words)),[r]=this.go(n.command_if_block)??[];return this.createcodenode(n,{type:13,check:i,block:r})}command_if_block(n){const i=Do(),r=Do();return this.createcodenode(n,{type:15,skip:i,done:r,lines:[this.go(n.inline),this.go(n.line),this.creategotonode(n,r,"end of if"),this.createmarknode(n,i,"alt logic")].flat(),altlines:[this.go(n.command_else_if),this.go(n.command_else),this.createmarknode(n,r,"end of if")].flat()})}command_block(n){return[this.go(n.inline),this.go(n.line)].flat()}command_fork(n){return[this.go(n.inline),this.go(n.line)].flat()}command_else_if(n){const i=Do(),r=Do();return this.createcodenode(n,{type:16,done:r,lines:[this.createlogicnode(n,Ef(n.token_if,"if"),i,this.go(n.words)),this.go(n.command_fork),this.creategotonode(n,r,"end of if"),this.createmarknode(n,i,"skip")].flat()})}command_else(n){return this.createcodenode(n,{type:17,lines:this.go(n.command_fork)})}command_while(n){const i=Do(),r=Do();return this.createcodenode(n,{type:18,loop:i,done:r,lines:[this.createmarknode(n,i,"start of while"),this.createlogicnode(n,"if",r,this.go(n.words)),this.go(n.command_block),this.creategotonode(n,i,"loop of while"),this.createmarknode(n,r,"end of while")].flat()})}command_repeat(n){const i=Do(),r=Do(),a=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:21,loop:i,done:r,lines:[this.createapinode(n,"repeatstart",a),this.createmarknode(n,i,"start of repeat"),this.createlogicnode(n,"repeat",r,a),this.go(n.command_block),this.creategotonode(n,i,"loop of repeat"),this.createmarknode(n,r,"end of repeat")].flat()})}command_foreach(n){const i=Do(),r=Do(),a=[this.createcountnode(n),this.go(n.words)].flat();return this.createcodenode(n,{type:23,loop:i,done:r,lines:[this.createapinode(n,"foreachstart",a),this.createmarknode(n,i,"start of foreach"),this.createlogicnode(n,"foreach",r,a),this.go(n.command_block),this.creategotonode(n,i,"loop of foreach"),this.createmarknode(n,r,"end of foreach")].flat()})}command_waitfor(n){const i=Do();return this.createcodenode(n,{type:22,loop:i,lines:[this.createmarknode(n,i,"start of waitfor"),this.createlogicnode(n,"waitfor",i,this.go(n.words))].flat()})}command_break(n){return this.createcodenode(n,{type:19,goto:0})}command_continue(n){return this.createcodenode(n,{type:20,goto:0})}command_play(n){const i=Ef(n.token_command_play,""),r=i.replace("bgplay","").replace("play","").trim(),s=i.includes("bgplay");return this.createlinenode(n,this.createcodenode(n,{type:11,words:[this.createstringnode(n,s?"bgplay":"play"),this.createstringnode(n,r)].flat()}))}command_toast(n){const r=Ef(n.token_command_toast,"").replace("toast","").trim();return this.createlinenode(n,this.createcodenode(n,{type:11,words:[this.createstringnode(n,"toast"),this.createstringnode(n,r)].flat()}))}expr(n){return n.and_test.length===1?this.go(n.and_test):this.createcodenode(n,{type:24,items:this.go(n.and_test)})}and_test(n){return n.not_test.length===1?this.go(n.not_test):this.createcodenode(n,{type:25,items:this.go(n.not_test)})}not_test(n){return n.comparison?this.go(n.comparison):n.not_test?this.createcodenode(n,{type:26,items:this.go(n.not_test)}):[]}comparison(n){if(n.arith_expr.length===1)return this.go(n.arith_expr);const[i,r]=this.go(n.arith_expr),[s]=this.go(n.comp_op);return this.createcodenode(n,{type:27,lhs:i,compare:s,rhs:r})}comp_op(n){return n.token_iseq?this.createcodenode(n,{type:28,method:0}):n.token_isnoteq?this.createcodenode(n,{type:28,method:1}):n.token_islessthan?this.createcodenode(n,{type:28,method:2}):n.token_isgreaterthan?this.createcodenode(n,{type:28,method:3}):n.token_islessthanorequal?this.createcodenode(n,{type:28,method:4}):n.token_isgreaterthanorequal?this.createcodenode(n,{type:28,method:5}):[]}expr_value(n){return n.and_test_value.length===1?this.go(n.and_test_value):this.createcodenode(n,{type:24,items:this.go(n.and_test_value)})}and_test_value(n){return n.not_test_value.length===1?this.go(n.not_test_value):this.createcodenode(n,{type:25,items:this.go(n.not_test_value)})}not_test_value(n){return n.arith_expr?this.go(n.arith_expr):n.not_test_value?this.createcodenode(n,{type:26,items:this.go(n.not_test_value)}):[]}arith_expr(n){const i=this.go(n.term);return n.arith_expr_item?this.createcodenode(n,{type:29,lhs:i[0],items:this.go(n.arith_expr_item)}):i}arith_expr_item(n){return this.createcodenode(n,{type:30,operator:n.token_plus?1:2,rhs:this.go(n.term)[0]})}term(n){return n.term_item?this.createcodenode(n,{type:29,lhs:this.go(n.factor)[0],items:this.go(n.term_item)}):this.go(n.factor)}term_item(n){let i=0;return n.token_multiply&&(i=4),n.token_divide&&(i=5),n.token_moddivide&&(i=6),n.token_floordivide&&(i=7),this.createcodenode(n,{type:30,operator:i,rhs:this.go(n.factor)[0]})}factor(n){if(n.power)return this.go(n.power);let i=0;return n.token_plus&&(i=8),n.token_minus&&(i=9),this.createcodenode(n,{type:29,lhs:void 0,items:this.createcodenode(n,{type:30,operator:i,rhs:this.go(n.factor)[0]})})}power(n){const i=this.go(n.token);return n.factor?this.createcodenode(n,{type:29,lhs:i[0],items:this.createcodenode(n,{type:30,operator:3,rhs:this.go(n.factor)[0]})}):i}words(n){return this.go(n.expr)}token(n){if(n.token_stringliteraldouble){const i=Ef(n.token_stringliteraldouble,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:2,value:i})}if(n.token_stringliteral){const i=Ef(n.token_stringliteral,"").replaceAll(/(^"|"$)/g,"");return this.createcodenode(n,{type:12,literal:1,value:i})}if(n.token_numberliteral){const i=parseFloat(Ef(n.token_numberliteral,"0"));return this.createcodenode(n,{type:12,literal:0,value:i})}return n.token_lparen?this.createcodenode(n,{type:31,words:this.go(n.words)}):[]}}const MGe=new AGe,Uh={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},xB="zss.js";function Pr(t,e){return new TGe(t.startLine??1,t.startColumn??1,xB,e)}function DV(t){return t.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function hH(t){return`'${DV(t)}'`}function gP(t){if(t.startsWith('"'))return gP(t.replaceAll(/(^"|"$)/g,""));const e=CB(t);return e.errors.length?t:`['${e.tokens.map(i=>i.tokenType===e9?`', api.get('${DV(i.image.substring(1))}'), '`:DV(i.image)).join("")}'].join('')`}function l1(t){return t.filter(e=>e!==void 0).map(rs)}function Kee(t){return Pr(t,"")}function OGe(t,e){const n=[];return t.forEach(i=>{n.push(i,e)}),n.pop(),n}function Mc(t,e,n){return Pr(t,[`api.${e}(`,...OGe(n,", "),")"])}function NGe(t){if(t.type===yn.COMPARE&&t.compare.type===yn.COMPARE_ITEM)switch(t.compare.method){case bS.IS_EQ:return Mc(t,"isEq",[rs(t.lhs),rs(t.rhs)]);case bS.IS_NOT_EQ:return Mc(t,"isNotEq",[rs(t.lhs),rs(t.rhs)]);case bS.IS_LESS_THAN:return Mc(t,"isLessThan",[rs(t.lhs),rs(t.rhs)]);case bS.IS_GREATER_THAN:return Mc(t,"isGreaterThan",[rs(t.lhs),rs(t.rhs)]);case bS.IS_LESS_THAN_OR_EQ:return Mc(t,"isLessThanOrEq",[rs(t.lhs),rs(t.rhs)]);case bS.IS_GREATER_THAN_OR_EQ:return Mc(t,"isGreaterThanOrEq",[rs(t.lhs),rs(t.rhs)])}return Pr(t,"")}function sS(t,e,n){return t.prepend(`api.${e}(`),t.add([", ",rs(n),")"])}function Jee(t,e,n){return t.prepend(`api.${e}(`),t.add([rs(n),")"])}function IGe(t,e){if(t.type===yn.OPERATOR_ITEM)switch(t.operator){case ig.PLUS:return sS(e,"opPlus",t.rhs);case ig.MINUS:return sS(e,"opMinus",t.rhs);case ig.POWER:return sS(e,"opPower",t.rhs);case ig.MULTIPLY:return sS(e,"opMultiply",t.rhs);case ig.DIVIDE:return sS(e,"opDivide",t.rhs);case ig.MOD_DIVIDE:return sS(e,"opModDivide",t.rhs);case ig.FLOOR_DIVIDE:return sS(e,"opFloorDivide",t.rhs);case ig.UNI_PLUS:return Jee(e,"opUniPlus",t.rhs);case ig.UNI_MINUS:return Jee(e,"opUniMinus",t.rhs)}return Pr(t,"")}function kGe(t){if(t.type===yn.OPERATOR){const e=t.lhs?rs(t.lhs):Pr(t,"");return t.items.forEach(n=>IGe(n,e)),e}return Pr(t,"")}function hD(t,e){return Pr(t,[Mc(t,"jump",[`${e}`]),"; continue;"])}function pv(t){return Uh.linelookup[t??""]??-1}function PV(t,e){Uh.linelookup[t]=e}function x1(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case yn.WHILE:case yn.REPEAT:case yn.FOREACH:case yn.ELSE_IF:r.type===e&&(r.done=n);break;case yn.IF_BLOCK:case yn.IF_CHECK:r.type===e&&(r.skip=n);break;case yn.LINE:x1(r.stmts,e,n);break}}}function Mpe(t,e,n){for(let i=0;i<t.length;++i){const r=t[i];switch(r.type){case yn.WHILE:case yn.REPEAT:case yn.FOREACH:case yn.ELSE_IF:r.type===e&&PV(r.done,n);break;case yn.IF_BLOCK:case yn.IF_CHECK:r.type===e&&PV(r.skip,n);break;case yn.LINE:Mpe(r.stmts,e,n);break}}}function rs(t){var e;switch(t.type){case yn.PROGRAM:return Pr(t,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { yield 1; }
`,`switch (api.getcase()) {
`,...t.lines.map(rs).flat(),`default:
`,`  api.endofprogram();
`,`  while (api.hm() === 0) { yield 1; };
`,`  continue;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${xB}`]);case yn.API:return Pr(t,["  ",Mc(t,t.method,l1(t.words)),`;
`]);case yn.LINE:return Pr(t,[`case ${t.lineindex}:
`,...t.stmts.map(rs).flat(),`  break;
`]);case yn.MARK:return Pr(t,`  // ${t.comment}
`);case yn.GOTO:{const n=pv(t.id);return Pr(t,["  ",hD(t,n),`
`])}case yn.COUNT:return Pr(t,`${t.index}`);case yn.LITERAL:switch(t.literal){case mP.NUMBER:return Pr(t,`${t.value}`);case mP.STRING:return Pr(t,hH(t.value));case mP.TEMPLATE:return Pr(t,gP(t.value))}return Kee(t);case yn.TEXT:return Pr(t,["  ",Mc(t,"text",[gP(t.value)]),`;
`]);case yn.STAT:if(Uh.isfirststat){Uh.isfirststat=!1;const n=t.value.trim().split(" ").map(hH);return Pr(t,["  ",Mc(t,"stat",n),`;
`])}return Pr(t,`  // skipped ${t.value}
`);case yn.LABEL:{const n=ai(t.name),i=t.active?"label":"comment";Uh.labels[n]||(Uh.labels[n]=[]);const r=(t.active?1:-1)*t.lineindex;return Uh.labels[n].push(r),Pr(t,`  // ${r} '${n}' ${i}
`)}case yn.HYPERLINK:return Pr(t,["  ",Mc(t,"hyperlink",[gP(t.text),...l1(t.link)]),`;
`]);case yn.MOVE:{const n=Mc(t,"command",[hH("go"),l1(t.words)].flat());return t.wait?Pr(t,["  if (",n,`) { continue; };
`]):Pr(t,["  ",n,`;
`])}case yn.COMMAND:return Pr(t,["  if (",Mc(t,"command",l1(t.words)),`) { continue; };
`]);case yn.IF:{const n=((e=t.block)==null?void 0:e.type)===yn.IF_BLOCK?t.block:void 0;if(ae(n)){x1([t.check],yn.IF_CHECK,n.skip);const i=Pr(t,rs(t.check));return n.lines.forEach(r=>i.add(rs(r))),Mpe(n.altlines,yn.ELSE_IF,pv(n.done)),n.altlines.forEach(r=>i.add(rs(r))),i}return Pr(t,rs(t.check))}case yn.IF_CHECK:{const n=pv(t.skip);return n===-1?Pr(t,["  ",Mc(t,t.method,l1(t.words)),`;
`]):Pr(t,["  if (!",Mc(t,t.method,l1(t.words)),") { ",hD(t,n),` }
`])}case yn.ELSE_IF:case yn.ELSE:{const n=Pr(t,"");return t.lines.forEach(i=>n.add(rs(i))),n}case yn.WHILE:{const n=pv(t.loop),i=pv(t.done),r=Pr(t,"");return x1(t.lines,yn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case yn.BREAK:s.goto=i;break;case yn.CONTINUE:s.goto=n;break}r.add(rs(s))}),r}case yn.REPEAT:{const n=pv(t.loop),i=pv(t.done),r=Pr(t,"");return x1(t.lines,yn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case yn.BREAK:s.goto=i;break;case yn.CONTINUE:s.goto=n;break}r.add(rs(s))}),r}case yn.WAITFOR:{const n=Pr(t,"");return x1(t.lines,yn.IF_CHECK,t.loop),t.lines.forEach(i=>{n.add(rs(i))}),n}case yn.FOREACH:{const n=pv(t.loop),i=pv(t.done),r=Pr(t,"");return x1(t.lines,yn.IF_CHECK,t.done),t.lines.forEach(s=>{switch(s.type){case yn.BREAK:s.goto=i;break;case yn.CONTINUE:s.goto=n;break}r.add(rs(s))}),r}case yn.BREAK:return Pr(t,["  ",hD(t,t.goto),`
`]);case yn.CONTINUE:return Pr(t,["  ",hD(t,t.goto),`
`]);case yn.OR:return Mc(t,"or",t.items.map(rs));case yn.AND:return Mc(t,"and",t.items.map(rs));case yn.NOT:return Mc(t,"not",t.items.map(rs));case yn.COMPARE:return NGe(t);case yn.OPERATOR:return kGe(t);case yn.EXPR:return Mc(t,"expr",t.words.map(rs));default:return console.error("<unsupported node>",t.type,t),Kee(t)}}function rg(t){if(ae(t))switch(t.type===yn.LINE&&++Uh.lineindex,t.lineindex=Uh.lineindex,t.type){case yn.PROGRAM:t.lines.forEach(rg);break;case yn.LINE:t.stmts.forEach(rg);break;case yn.MARK:PV(t.id,t.lineindex);break;case yn.IF:rg(t.check),rg(t.block);break;case yn.IF_BLOCK:t.lines.forEach(rg),t.altlines.forEach(rg);break;case yn.ELSE_IF:t.lines.forEach(rg);break;case yn.ELSE:case yn.WHILE:case yn.REPEAT:case yn.FOREACH:case yn.WAITFOR:t.lines.forEach(rg);break;case yn.MOVE:case yn.COMMAND:case yn.IF_CHECK:t.words.forEach(rg);break}}function DGe(t){return Uh.labels={},Uh.internal=1,Uh.lineindex=0,Uh.isfirststat=!0,rg(t),{...rs(t).toStringWithSourceMap({file:`${xB}.map`}),...Uh}}function Zee(t){return Li(t)?t.length>0?1:0:t??0}function PGe(t){return`${t}_chip`}function Ope(t=""){return`vm:${t??""}`}function LGe(t,e,n){var l,u;const i=PGe(t),r=fO(i);let s;const a=ol(Object.entries(n.labels??{}));(!Li(r.lb)||r.lb.length!==a.length)&&(r.lb=a,r.lk="",r.mg=void 0,r.ec=1,r.lc=0,r.ys=0,r.ps=0,r.es=(((l=n.errors)==null?void 0:l.length)??0)!==0?1:0);function o(h,d){ne.words=d;const f=JVe(e,h);return ae(f)?f(c,d):h!=="send"?o("send",[h,...d]):0}const c={halt(){HGe(i)},id(){return t},set(h,d){const[f,p]=QVe(e,c,h,d);if(f)return p},get(h){const[d,f]=ZVe(e,c,h);if(d)return f},tick(h){const d=pn(r.ps)?r.ps:0,f=d%h===0;if(r.ps=d+1,f===!1)return!1;if(c.shouldtick()===!1)return $ee(e,c),!1;r.lc=0,r.ys=0,ne.get=c.get,eGe(e,c);try{const p=s==null?void 0:s.next();p!=null&&p.done&&(r.es=1)}catch(p){Hi(Ge,ne.elementfocus,"crash",p.message),r.es=1}return $ee(e,c),!0},isended(){return r.es===1},isfirstpulse(){return r.ps===1},shouldtick(){return r.es===0||c.hm()!==0},shouldhalt(){return pn(r.lc)?++r.lc>kn.HALT_AT_COUNT:!0},hm(){if(Li(r.mg)&&Li(r.lb)){const[h]=r.mg;if(ae(h))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h)return p.find(g=>pn(g)&&g>0)??0}}return 0},yield(){r.ys=1},jump(h){r.ec=h},sy(){return!!r.ys||c.shouldhalt()},send(h,d,f,p){Ge.emit(h,`${Ope(d)}:${f}`,p)},lock(h){r.lk=h},unlock(){r.lk=""},message(h){r.lk&&h.sender!==r.lk||(r.mg=[h.target,h.data,h.sender,h.player])},zap(h){if(Li(r.lb))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h){const g=p.findIndex(_=>_>0);g>=0&&(p[g]*=-1)}}},restore(h){if(Li(r.lb))for(let d=0;d<r.lb.length;++d){const[f,p]=r.lb[d];if(f===h)for(let g=0;g<p.length;g++)p[d]=Math.abs(p[d])}},getcase(){r.ec=pn(r.ec)?r.ec:1;const h=c.hm();if(h&&Li(r.mg)){const[,d,f,p]=r.mg;c.set("sender",f),ae(d)&&c.set("arg",d),p&&(c.set("player",p),ne.elementfocus=p),r.mg=void 0,r.ys=0,r.es=0,r.ec=h}return r.ec},nextcase(){const h=pn(r.ec)?r.ec:1;return r.ec=h+1,r.ec},endofprogram(){c.yield(),r.es=1},stacktrace(h){const d=oHe.parse(h),[f]=d.filter(p=>p.fileName===xB);return{line:(f==null?void 0:f.lineNumber)??0,column:(f==null?void 0:f.columnNumber)??0}},text(h){return o("text",[h])},stat(...h){return o("stat",h)},hyperlink(...h){return o("hyperlink",h)},command(...h){if(h.length===0)return 0;const[d,...f]=h;return o(ai(na(d)),f)},if(...h){const[d,f]=Ot(h,0,[st.ANY]),p=Zee(d);return p&&f<h.length&&c.command(...h.slice(f)),p?1:0},try(...h){const[,d]=Ot(h,0,[st.DIR]),f=c.command("go",...h);return f&&d<h.length&&c.command(...h.slice(d)),f?1:0},take(...h){const[d,f,p]=Ot(h,0,[st.NAME,st.ANY]),g=pn(f),_=g?p:1,v=c.get(d),E=g?f:1;if(!pn(v))return _<h.length&&c.command(...h.slice(_)),1;const T=v-E;return T<0?(_<h.length&&c.command(...h.slice(_)),1):(c.set(d,T),0)},give(...h){const[d,f,p]=Ot(h,0,[st.NAME,st.ANY]),g=pn(f),_=g?p:1,v=c.get(d),E=g?f:1,T=v===void 0?1:0;return T&&_<h.length&&c.command(...h.slice(_)),c.set(d,DS(v,0)+E),T},repeatstart(h,...d){const[f,p]=Ot(d,0,[st.NUMBER]),g=`repeatcount${h}`,_=`repeatwords${h}`;r[g]=f,r[_]=p<d.length?d.slice(p):void 0},repeat(h){const d=`repeatcount${h}`,f=`repeatwords${h}`;if(!pn(r[d]))return 0;const p=r[d];r[d]=p-1;const g=p>0,_=r[f];return g&&Li(_)&&c.command(..._),g?1:0},foreachstart(h,...d){const[f,p,g,_]=Ot(d,0,[st.NAME,st.NUMBER,st.NUMBER,st.MAYBE_NUMBER]);let v=Math.min(p,g),E=Math.max(p,g);const T=(_??0)||1;if(T<0){const x=v;v=E,E=x}return c.set(f,v-T),0},foreach(h,...d){const[f,p,g,_,v]=Ot(d,0,[st.NAME,st.NUMBER,st.NUMBER,st.MAYBE_NUMBER]);let E=Math.min(p,g),T=Math.max(p,g);const x=(_??0)||1;if(x<0){const I=E;E=T,T=I}let N=c.get(f);!pn(N)||N<E||N>T?N=E:N+=x;const A=N<=T?1:0;return A&&(c.set(f,N),v<d.length&&c.command(...d.slice(v))),A},waitfor(...h){const[d]=Ot(h,0,[st.ANY]),f=Zee(d);return f||c.yield(),f?1:0},or(...h){let d=0;for(let f=0;f<h.length;){const[p,g]=Ot(h,f,[st.ANY]);if(d=p,d)break;f=g}return d},and(...h){let d=0;for(let f=0;f<h.length;){const[p,g]=Ot(h,f,[st.ANY]);if(d=p,!d)break;f=g}return d},not(...h){const[d]=Ot(h,0,[st.ANY]);return d?0:1},expr(...h){const[d]=Ot(h,0,[st.ANY]);return d},isEq(h,d){const[f]=Ot([h],0,[st.ANY]),[p]=Ot([d],0,[st.ANY]);return typeof f=="object"||typeof p=="object"?$1(f,p)?1:0:f===p?1:0},isNotEq(h,d){return this.isEq(h,d)?0:1},isLessThan(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f<p?1:0},isGreaterThan(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f>p?1:0},isLessThanOrEq(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f<=p?1:0},isGreaterThanOrEq(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f>=p?1:0},opPlus(h,d){const[f]=Ot([h],0,[st.ANY]),[p]=Ot([d],0,[st.ANY]);return f+p},opMinus(h,d){const[f]=Ot([h],0,[st.ANY]),[p]=Ot([d],0,[st.ANY]);return f-p},opPower(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return Math.pow(f,p)},opMultiply(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f*p},opDivide(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f/p},opModDivide(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return f%p},opFloorDivide(h,d){const[f]=Ot([h],0,[st.NUMBER]),[p]=Ot([d],0,[st.NUMBER]);return Math.floor(f/p)},opUniPlus(h){const[d]=Ot([h],0,[st.NUMBER]);return+d},opUniMinus(h){const[d]=Ot([h],0,[st.NUMBER]);return-d}};return s=(u=n.code)==null?void 0:u.call(n,c),c}function LV(t){if(!t||t.type===void 0)return;const e=[{start:t.startOffset,end:t.endOffset??0}];return Object.keys(t).forEach(n=>{if(n!=="parent"){const i=t[n];Li(i)?i.forEach(r=>{e.push(LV(r))}):e.push(LV(i))}}),t.range={start:Math.min(...e.filter(n=>n).map(n=>(n==null?void 0:n.start)??0)),end:Math.max(...e.filter(n=>n).map(n=>(n==null?void 0:n.end)??0))},t.range}function Npe(t){const e=bW(`${t}
`);if(e.errors.length>0)return e;Y1.input=e.tokens;const n=Y1.program();if(Y1.errors.length>0)return{tokens:e.tokens,errors:Y1.errors.map(r=>({offset:r.token.startOffset,line:r.token.startLine,column:r.token.startColumn,length:r.token.image.length,message:r.message}))};const[i]=MGe.go(n);return i?(LV(i),{tokens:e.tokens,cst:n,ast:i}):{tokens:e.tokens,cst:n,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}const dH=Object.getPrototypeOf(function*(){}).constructor;function UGe(t,e){const n=`compile-${t}`;console.time(n);const i=Npe(e);if(console.timeEnd(n),i.errors&&i.errors.length>0)return i;if(!i.ast)return{...i,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const r=DGe(i.ast);if(r.code){kze&&console.info(r.code);try{return{...i,...r,source:r.code,code:new dH("api",r.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new dH("api"," ")}}}return{...i,...r,source:"",code:new dH("api"," ")}}function BGe(){const t={},e={};function n(r,s){const a=t[s];if(a)return a;const o=UGe(r,s);return t[s]=o,o}const i={ids(){return Object.keys(e)},isended(r){const s=e[r];return ae(s)?s.isended():!0},halt(r){const s=e[r];return ae(s)&&(s.halt(),delete e[r]),!!s},gc(){const r=i.ids();for(let s=0;s<r.length;++s)i.isended(r[s])&&i.halt(r[s])},arg(r,s){const a=e[r];ae(a)&&a.set("arg",s)},tick(r,s,a,o,c){var u;let l=e[r];if(!ae(e[r])){const h=n(o,c);if(l=e[r]=LGe(r,s,h),(u=h.errors)!=null&&u.length){const[d]=h.errors,f=((d==null?void 0:d.line)??2)-1,p=c.replaceAll(`\r
`,"").split(`
`).map((v,E)=>[v,E]);p.slice(f-5,f).forEach(([v,E])=>{Hi(Ge,nM(),"build",`$grey${E+1} $grey${v}`)});const[g,_]=p[f]??[];if(On(g)&&ae(_)){const v=(d.column??1)-1,E=v+d.length,T=v<g.length?g:`${g}*`,x=T.substring(0,v),N=T.substring(v,E),A=T.substring(E);Hi(Ge,nM(),"build",`$red${_+1} $grey${x}$red${N}$grey${A}`)}return d.message.split(`
`).forEach(v=>{Hi(Ge,nM(),"build",v)}),!1}}return!!(l!=null&&l.tick(a))},once(r,s,a,o){const c=i.tick(r,s,1,a,o);return i.halt(r)&&c},message(r){const{target:s,path:a}=jT(r.target),o=e[s];if(ae(o)){const c={...r,target:a};o.message(c)}}};return i}new Rt;const Ipe=BGe();var wc=(t=>(t.MAIN="main",t.TITLE="title",t.PLAYER="player",t.CONTENT="content",t.GADGETSTORE="gadgetstore",t.GADGETSYNC="gadgetsync",t))(wc||{});const up={halt:!1,session:Do(),operator:"",software:{main:"",content:""},books:new Map,chips:new Map,loaders:new Map};function nM(){return up.operator}function vP(){return[...up.books.values()]}function FGe(){const[t]=up.books.values();return t}function Rv(t){const e=ai(t);return up.books.get(t)??vP().find(n=>n.name===e)}function UV(t,e){ae(Rv(e))&&(up.software[t]=e)}function X1(t){return Rv(up.software[t])}function kpe(t){const e=Jde([]);return On(t)&&(e.name=t),Dpe(e),Ug(Ge,up.operator,`created [book] ${e.name}`),e}function zGe(t){let e=Rv(t);return ae(e)||(e=Jde([]),e.name=t),Dpe(e),Ug(Ge,up.operator,`created [book] ${e.name}`),e}function Uv(t,e){let n=ae(e)?zGe(e):X1(t);return ae(n)||(ae(n)||(n=FGe()),ae(n)||(n=kpe(e)),ae(n)&&Ug(Ge,up.operator,`opened [book] ${n.name} for ${t}`)),UV(t,n.id),n}function S_(t,e,n){return bV(Uv(t),n,e)}function fO(t){const e=Uv("main");return gB(e,t)}function Qee(){const t=Uv("main");return gB(t,"main")}function HGe(t){const e=Uv("main");return Y8e(e,t)}function Dpe(t){return up.books.set(t.id,t),t.id}function jGe(t){const e=Rv(t);e&&up.books.delete(e.id)}function ZR(t,e,n,i){const r=XC(e);On(n.id)&&Ge.emit(t,"vm:touched",[n.id,r,i])}function BV(t,e,n,i){if(!ae(n==null?void 0:n.id))return!1;const r=rfe(t,e,n,i);if(ae(r)){if(n.kind==="player"&&r.kind==="edge"){if(i.x<0){const a=Gf(t,Kn.BOARD,(e==null?void 0:e.exitwest)??"");if(a.length){const o=Xa(a);W1(t,n.id,o.id,{x:fi-1,y:i.y})}}else if(i.x>=fi){const a=Gf(t,Kn.BOARD,(e==null?void 0:e.exiteast)??"");if(a.length){const o=Xa(a);W1(t,n.id,o.id,{x:0,y:i.y})}}else if(i.y<0){const a=Gf(t,Kn.BOARD,(e==null?void 0:e.exitnorth)??"");if(a.length){const o=Xa(a);W1(t,n.id,o.id,{x:i.x,y:jr-1})}}else if(i.y>=jr){const a=Gf(t,Kn.BOARD,(e==null?void 0:e.exitsouth)??"");if(a.length){const o=Xa(a);W1(t,n.id,o.id,{x:i.x,y:0})}}}else ZR("",r,n,"thud");if(n.kind==="player"){const a=sb(r.id);ZR(n.id,n,r,a?"bump":"touch")}else if(n.collision===bs.ISBULLET){const a=sb(n.party),o=sb(r.id);a!==o?ZR(n.party??"",n,r,"shot"):ZR("",n,r,"thud")}else ZR("",n,r,"bump");const s=wb(t,r);return r.destructible??(s==null?void 0:s.destructible)?(ae(r==null?void 0:r.id)?sy(ne.book,ne.board,r,ne.timestamp):Og(e,{x:i.x,y:i.y}),!0):!1}return!0}function VGe(t,e,n,i,r=Vze){var h;if(!ae(t)||!ae(e)||!ae(n))return;const s={...ne};ne.book=t,ne.board=e,ne.element=n,ne.elementid=n.id??"",ne.elementisplayer=sb(ne.elementid);const a=ne.element.player??up.operator;ne.elementfocus=ne.elementisplayer?ne.elementid:a;const o=wb(t,n),c=n.cycle??(o==null?void 0:o.cycle)??r,l=n.id??"",u=ai(n.name??((h=n.kinddata)==null?void 0:h.name)??"");if(Ipe.tick(l,qW.RUNTIME,pn(c)?c:r,u,i),pn(n==null?void 0:n.tickertime)&&ne.timestamp-n.tickertime>F7*5&&(n.tickertime=0,n.tickertext=""),ne.elementisplayer){const d=fO(ne.elementid);pn(d.inputcurrent)&&(d.inputcurrent=0)}G3(s).forEach(d=>{ne[d]=s[d]})}function Ppe(t,e){const n=X1("main");if(!ae(n))return;function i(o,c){for(let l=0;l<o.length;++l){const u=o[l];if(ae(u.id)){const h=`${Ope(u.id)}:${c}`;Ge.emit("",h,e)}}}const{target:r,path:s}=jT(t),a=Q8e(n);for(let o=0;o<a.length;++o){const c=a[o];switch(ai(r)){case"all":case"self":case"others":{i(Object.values(c.objects),s);break}default:{i(Hde(c,[r]),s);break}}}}function Q2(t){var a;const e=Uv("main"),n=YS(e,t);if(!ae(e)||!ae(n)||!ae(ne.element))return;const i=`${t}_run`,r=ai(ne.element.name??((a=ne.element.kinddata)==null?void 0:a.name)??""),s=(n==null?void 0:n.code)??"";Ipe.once(i,qW.RUNTIME,r,s)}function u1(t,e=0){const n=[];let i=t;for(;i<ne.words.length;){const[r,s]=Nh(i);if(Li(r)&&!gT(r)&&!dO(r)&&!X2(r)&&!Vg(r)&&n.push(...r),r==="|")return[n,s];if(i=s,n.push(r),e>0&&n.length>=e)return[n,i]}return[n,i]}function Nh(t){var i,r,s,a,o,c,l,u,h;const e=ne.words[t],n=t+1;if(upe(e)){const[d,f]=Y5e(t);if(ae(d))return[d,f]}if(X5e(e)){const[d,f]=K5e(t);if(ae(d))return[d,f]}if(YW(e)){const[d,f]=XW(t);if(ae(d))return[d,f]}if(On(e)&&ai(e)==="rnd"){const[d,f]=Nh(n),[p,g]=Nh(f);return pn(d)&&pn(p)?[Uf(d,p),g]:pn(d)?[Uf(0,d),f]:[Uf(0,1),n]}if(z7(e)){const[d,f]=Sde(t);if(ae(d))return[d,f]}if(!ae(e))return[void 0,t];if(pn(e)||Li(e))return[e,n];if(On(e)){const d=ai(e),f=(i=ne.get)==null?void 0:i.call(ne,e);if(ae(f))return[f,n];switch(d){case"aligned":case"alligned":{const p=nO(ne.board,{x:((r=ne.element)==null?void 0:r.x)??-1,y:((s=ne.element)==null?void 0:s.y)??-1},ne.elementfocus);return!ae(ne.element)||!ae(p)?[0,n]:[ne.element.x===p.x||ne.element.y===p.y?1:0,n]}case"contact":{const p=nO(ne.board,{x:((a=ne.element)==null?void 0:a.x)??-1,y:((o=ne.element)==null?void 0:o.y)??-1},ne.elementfocus);if(!ae(ne.element)||!ae(p))return[0,n];const g=(p.x??0)-(((c=ne.element)==null?void 0:c.x)??0),_=(p.y??0)-(((l=ne.element)==null?void 0:l.y)??0);return[g===0&&Math.abs(_)<2||_===0&&Math.abs(g)<2?1:0,n]}case"blocked":{const[p,g]=Ot(ne.words,n,[st.DIR]);return[rHe(ne.book,ne.board,ne.element,p)?1:0,g]}case"any":{const[p,g]=Ot(ne.words,n,[st.KIND]);return[zde(ne.board,p).length?1:0,g]}case"rnd":return[Uf(0,1),n];case"abs":{const[p,g]=Ot(ne.words,n,[st.NUMBER]);return[Math.abs(p),g]}case"ceil":{const[p,g]=Ot(ne.words,n,[st.NUMBER]);return[Math.ceil(p),g]}case"floor":{const[p,g]=Ot(ne.words,n,[st.NUMBER]);return[Math.floor(p),g]}case"round":{const[p,g]=Ot(ne.words,n,[st.NUMBER]);return[Math.round(p),g]}case"clamp":{const[p,g,_,v]=Ot(ne.words,n,[st.NUMBER,st.NUMBER,st.NUMBER]);return[Er(p,g,_),v]}case"min":{const[p,g]=u1(n);return[Math.min(...p),g]}case"max":{const[p,g]=u1(n);return[Math.max(...p),g]}case"pick":{const[p,g]=u1(n);return[Xa(p),g]}case"pickwith":{const[p,g]=Ot(ne.words,n,[st.NUMBER_OR_STRING]),[_,v]=u1(g);return[_de(`${p}`,_),v]}case"random":{const[p,g]=u1(n,2),[_,v]=p;return[Uf(_,v??0),g]}case"randomwith":{const[p,g]=Ot(ne.words,n,[st.NUMBER_OR_STRING]),[_,v]=u1(g,2),[E,T]=_;return[wue(`${p}`,E,T??0),v]}case"run":{const[p,g]=Ot(ne.words,n,[st.NAME]);return Q2(p),[(u=ne.get)==null?void 0:u.call(ne,"arg"),g]}case"runwith":{const[p,g,_]=Ot(ne.words,n,[st.ANY,st.NAME]);return ae(ne.element)&&(ne.element.arg=p),Q2(g),[(h=ne.get)==null?void 0:h.call(ne,"arg"),_]}}}return[e,n]}const ne={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var st=(t=>(t[t.COLOR=0]="COLOR",t[t.KIND=1]="KIND",t[t.DIR=2]="DIR",t[t.NAME=3]="NAME",t[t.NUMBER=4]="NUMBER",t[t.STRING=5]="STRING",t[t.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",t[t.MAYBE_KIND=7]="MAYBE_KIND",t[t.MAYBE_NAME=8]="MAYBE_NAME",t[t.MAYBE_NUMBER=9]="MAYBE_NUMBER",t[t.MAYBE_STRING=10]="MAYBE_STRING",t[t.MAYBE_NUMBER_OR_STRING=11]="MAYBE_NUMBER_OR_STRING",t[t.ANY=12]="ANY",t))(st||{});function Ql(t,e,n){throw console.info(n,ne.element,ne.elementid,ne.elementfocus),new Error(`Invalid arg, expected: ${t} but got ${JSON.stringify(e)}`)}function ete(t){var i,r;const e={x:((i=ne.element)==null?void 0:i.x)??0,y:((r=ne.element)==null?void 0:r.y)??0};return ae(ne.board)&&ae(ne.element)?ife(ne.book,ne.board,ne.element,ne.elementfocus,t,e):e}function Ot(t,e,n){const i=ne.words;ne.words=t;const r=[];let s=e;for(let a=0;a<n.length;++a)switch(n[a]){case 1:{const[o,c]=VQ(s);sC(o)?(s=c,r.push(o)):Ql("kind",o,t);break}case 0:{if(YW(t[0])===void 0){const[o,c]=Nh(s);Vg(o)?(s=c,r.push(o)):Ql("color",o,t)}else{const[o,c]=XW(s);Vg(o)?(s=c,r.push(o)):Ql("color",o,t)}break}case 2:{if(z7(t[0])===void 0){const[o,c]=Nh(s);gT(o)?(s=c,r.push(ete(o))):Ql("direction",o,t)}else{const[o,c]=Sde(s);gT(o)?(s=c,r.push(ete(o))):Ql("direction",o,t)}break}case 3:{const o=ne.words[s];On(o)||Ql("string",o,t),++s,r.push(o);break}case 4:{const[o,c]=Nh(s);if(On(o)){const l=parseFloat(o);pn(l)?r.push(l):Ql("number",o,t)}else pn(o)?r.push(o):Ql("number",o,t);s=c;break}case 5:{const[o,c]=Nh(s);On(o)||Ql("string",o,t),s=c,r.push(o);break}case 6:{const[o,c]=Nh(s);let l=o;if(On(l)){const u=parseFloat(l);pn(u)&&(l=u)}else pn(l)||Ql("number or string",l,t);s=c,r.push(l);break}case 7:{const[o,c]=VQ(s);o!==void 0&&!sC(o)&&Ql("optional kind",o,t),s=c,r.push(o);break}case 8:{const o=ne.words[s];o!==void 0&&!On(o)&&Ql("optional string",o,t),++s,r.push(o);break}case 9:{const[o,c]=Nh(s);if(On(o)){const l=parseFloat(o);pn(l)?r.push(l):Ql("optional number",o,t)}else pn(o)||o===void 0?r.push(o):Ql("optional number",o,t);s=c;break}case 10:{const[o,c]=Nh(s);o!==void 0&&!On(o)&&Ql("optional string",o,t),s=c,r.push(o);break}case 11:{const[o,c]=Nh(s);let l=o;if(On(l)){const u=parseFloat(l);pn(u)&&(l=u)}else l!==void 0&&!pn(l)&&Ql("number or string",l,t);s=c,r.push(l);break}case 12:{const[o,c]=Nh(s);s=c,r.push(o);break}}return ne.words=i,[...r,s]}function GGe(t){return ae(t)&&t<Qt.ONBLACK?t:void 0}function qGe(t){return ae(t)&&t>Qt.WHITE&&t<Qt.ONCLEAR?t-Qt.ONBLACK:void 0}const wB={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR"};function Vg(t){return Li(t)&&Lpe(t[0])}function tte(t){return Vg(t)&&t[0].startsWith("ON")}function Lpe(t){return ae(Qt[t])&&On(t)}function YW(t){if(On(t))return wB[ai(t)]}function $Ge(t){return t.map(e=>Qt[e]).find(e=>ae(e)&&e<Qt.ONBLACK)}function WGe(t){return t.map(e=>Qt[e]).find(e=>ae(e)&&e>=Qt.ONBLACK)}function YGe(t){if(Vg(t))return t;if(Lpe(t))return[t];const e=YW(t);if(ae(e))return[e]}function nte(t){const e=ne.words[t],n=YGe(e);return Vg(n)?[n,t+1]:[void 0,t]}function XW(t){const e=[];let n=t;const[i,r]=nte(t);if(Vg(i)&&(e.push(...i),n=r),Vg(e)&&!tte(e)){const[s,a]=nte(r);tte(s)&&(n=a)}return e.length?[e,n]:[void 0,t]}function Upe(t){const e={};return t.every(n=>{const i=Qt[n];ae(i)&&(i<Qt.ONBLACK?e.color=i:e.bg=i-Qt.ONBLACK)}),e}const XGe=B7(32,126).map(t=>String.fromCharCode(t)),KGe=Xd({name:"Whitespace",pattern:/ +/}),JGe=Xd({name:"WhitespaceSkipped",pattern:/ +/,group:Uc.SKIPPED}),KW=Xd({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),JW=Xd({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:XGe}),ZW=Xd({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),QW=Xd({name:"EscapedDollar",pattern:"$$"}),e9=Xd({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),t9=Xd({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),n9=Xd({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function ZGe(t,e=""){return Xd({name:e||t,pattern:new RegExp(t.toLowerCase(),"i")})}const QGe=Object.keys(wB),Bpe=QGe.map(t=>ZGe(`\\$(${t})`,t)),eqe=[KGe,KW,...Bpe,ZW,JW,t9,QW,n9,e9],tqe=new Uc(eqe,{skipValidations:!Bg,ensureOptimizations:Bg}),nqe=new Uc([JGe,KW,...Bpe,ZW,JW,t9,QW,n9,e9],{skipValidations:!Bg,ensureOptimizations:Bg});function CB(t,e=!1){return e?nqe.tokenize(t):tqe.tokenize(t)}function Zb(t,e,n,i,r,s,a,o){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},reset:{color:n,bg:i,topedge:r,leftedge:s,rightedge:a,bottomedge:o},width:t,height:e,char:[],color:[],bg:[],changed(){}}}function RB(t){t.active={...t.reset}}function i9(t,e){const n=e.y;function i(){++e.x;const o=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>o&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function r(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(o){for(let c=0;c<o.length;++c){if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=o.charCodeAt(c),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i()}}for(let o=0;o<t.length;++o){const c=t[o];switch(c.tokenType){case QW:s("$");break;case t9:if(e.measureonly!==!0&&r()){const l=e.x+e.y*e.width;e.char[l]=parseFloat(c.image.replace("$","")),e.active.color!==void 0&&(e.color[l]=e.active.color),e.active.bg!==void 0&&(e.bg[l]=e.active.bg)}i();break;case ZW:s(c.image.substring(1,c.image.length-1).replaceAll('\\"','"'));break;case KW:{e.x=e.active.leftedge??0,++e.y;break}default:{const l=c.tokenType.name,u=wB[l],h=GGe(Qt[u]),d=qGe(Qt[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):ae(h)?e.active.color=h:ae(d)?e.active.bg=d:s(c.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const a=e.active.leftedge??0;if(ae(e.writefullwidth)&&(e.x>a||e.y===n)){const c=(e.active.rightedge??e.width-1)-e.x;if(c>0){RB(e);const l=String.fromCharCode(e.writefullwidth).repeat(c),u=e.x+e.y*e.width;pO(u,u+l.length,e.active.color,e.active.bg,e),AB(u,l,e)}}}function ri(t,e,n){const i=CB(t);i.tokens&&(i9(i.tokens,e),n&&RB(e),e.changed())}function $N(t,e,n){const i=CB(t);if(!i.tokens)return;const r=Zb(e,n,Qt.WHITE,Qt.BLACK);return r.measureonly=!0,i9(i.tokens,r),r.x>0&&++r.y,r}function AB(t,e,n){let i=0;const r=t+e.length;for(let s=t;s<r;++s)n.char[s]=e.charCodeAt(i++);n.changed()}function pO(t,e,n,i,r){const s=Math.min(t,e),a=Math.max(t,e);for(let o=s;o<=a;++o)r.color[o]=n,r.bg[o]=i;r.changed()}function Jm(t,e,n,i,r,s,a){const o=Math.min(n,i),c=Math.max(n,i);if(o>e||c<0)return;const l=Math.max(0,o),u=Math.min(e,c);pO(t+l,t+u,r,s,a)}function Fpe(t,e,n){const i=IN(JW,t,0,0,0,0,0,0);i9([i],e),n&&RB(e),e.changed()}function iqe(t,e,n,i,r){r.active.topedge=t,r.active.leftedge=e,r.active.rightedge=n,r.active.bottomedge=i}function hm(t){const e=t.reset.leftedge??0,n=t.reset.rightedge??t.width-1,i=t.reset.topedge??0,r=t.reset.bottomedge??t.height-1,s=n-e+1,a=r-i+1;return{left:e,right:n,top:i,bottom:r,width:s,height:a}}function mO(t,e=16){return t?B7(e-1).map(n=>{const i=n*hT;return new _n(t.bits[i]/63,t.bits[i+1]/63,t.bits[i+2]/63)}):[]}function rqe(t){return t.generateMipmaps=!1,t.minFilter=Za,t.magFilter=Za,t.needsUpdate=!0,t}function Ew(t){if(ae(t))return rqe(new tae(sLe(t)))}const A_=Be.createContext(Zb(1,1,15,1));function dm(){return Be.useContext(A_)}const zpe=$b(()=>({blink:!1}));setInterval(()=>{zpe.setState(t=>({blink:!t.blink}))},333);function Kd(){return zpe(t=>t.blink)}function Hpe(){return l7(t=>{function e(){t(n=>({render:n.render+1}))}return{dither:[],render:0,changed(){queueMicrotask(e)}}})}function sqe(t){t.fill(0)}function fH(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return-1;t[i+r*e]=s}const jpe=Be.createContext(Hpe());function aqe(t,e,n){const[i]=Be.useState(()=>Hpe()),r=t*e,s=i.getState();return s.dither.length!==r&&(s.dither=new Array(r).fill(n),s.render=0),i}function Vpe(){return l7(t=>{function e(){t(n=>({render:n.render+1}))}return{width:0,height:0,char:[],color:[],bg:[],render:0,changed(){queueMicrotask(e)}}})}function Gpe(t,e,n,i){t.char.fill(e),t.color.fill(n),t.bg.fill(i)}function ko(t,e,n,i,r,s){if(i<0||i>=e||r<0||r>=n)return;const a=i+r*e;G3(s).forEach(o=>{const c=s[o];ae(c)&&(t[o][a]=c)})}const r9=Be.createContext(Vpe());function WN(t,e,n,i,r){const[s]=Be.useState(()=>Vpe()),a=t*e,o=s.getState();return o.char.length!==a&&(o.width=t,o.height=e,o.char=new Array(a).fill(n),o.color=new Array(a).fill(i),o.bg=new Array(a).fill(r),o.render=0),s}function qpe(){return Be.useContext(r9).getState()}const ite=$C(xN),rte=WC(TN),qv=$b(t=>({palette:ite,charset:rte,screen:{},palettedata:mO(ite),charsetdata:Ew(rte),setpalette(e){t(n=>$1(n.palette,e)?n:{...n,palette:e,palettedata:mO(e)})},setcharset(e){t(n=>$1(n.charset,e)?n:{...n,charset:e,charsetdata:Ew(e)})},setaltcharset(e){t(n=>$1(n.altcharset,e)?n:{...n,altcharset:e,altcharsetdata:Ew(e)})},setscreen(e,n){t(i=>$1(i.screen,n)?i:{...i,screen:{...i.screen,[e]:n}})}})),zh=$b(()=>({insetcols:20,insetrows:20,islowrez:!1,islandscape:!0,sidebaropen:!0,showkeyboard:!1,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!1,showtouchcontrols:!1}));function qu(t,e,n){function i(r){Hi(t,e,"crash",r.message)}n().catch(i)}function mr(t,e,n){return t.namespaceURI&&t.namespaceURI!=="http://www.w3.org/1999/xhtml"||(e=Array.isArray(e)?e:[e],!e.includes(t.tagName.toLowerCase()))?!1:n?Object.entries(n).every(([i,r])=>t[i]===r):!0}function hp(t){var e;if(oqe(t)&&t.defaultView)return t.defaultView;if(!((e=t.ownerDocument)===null||e===void 0)&&e.defaultView)return t.ownerDocument.defaultView;throw new Error(`Could not determine window of node. Node was ${cqe(t)}`)}function oqe(t){return t.nodeType===9}function cqe(t){return typeof t=="function"?`function ${t.name}`:t===null?"null":String(t)}function $pe(t,e){return new Promise((n,i)=>{const r=new e;r.onerror=i,r.onabort=i,r.onload=()=>{n(String(r.result))},r.readAsText(t)})}function s9(t,e){const n={...e,length:e.length,item:i=>n[i],[Symbol.iterator]:function*(){for(let r=0;r<n.length;r++)yield n[r]}};return n.constructor=t.FileList,t.FileList&&Object.setPrototypeOf(n,t.FileList.prototype),Object.freeze(n),n}function K_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Wpe{getAsFile(){return this.file}getAsString(e){typeof this.data=="string"&&e(this.data)}webkitGetAsEntry(){throw new Error("not implemented")}constructor(e,n){K_(this,"kind",void 0),K_(this,"type",void 0),K_(this,"file",null),K_(this,"data",void 0),typeof e=="string"?(this.kind="string",this.type=String(n),this.data=e):(this.kind="file",this.type=e.type,this.file=e)}}class lqe extends Array{add(...e){const n=new Wpe(e[0],e[1]);return this.push(n),n}clear(){this.splice(0,this.length)}remove(e){this.splice(e,1)}}function dD(t,e){const[n,i]=t.split("/"),r=!i||i==="*";return s=>e?s.type===(r?n:t):r?s.type.startsWith(`${n}/`):s.type===n}function uqe(t){return new class{getData(n){var i;const r=(i=this.items.find(dD(n,!0)))!==null&&i!==void 0?i:this.items.find(dD(n,!1));let s="";return r==null||r.getAsString(a=>{s=a}),s}setData(n,i){const r=this.items.findIndex(dD(n,!0)),s=new Wpe(i,n);r>=0?this.items.splice(r,1,s):this.items.push(s)}clearData(n){if(n){const i=this.items.findIndex(dD(n,!0));i>=0&&this.items.remove(i)}else this.items.clear()}get types(){const n=[];return this.files.length&&n.push("Files"),this.items.forEach(i=>n.push(i.type)),Object.freeze(n),n}setDragImage(){}constructor(){K_(this,"dropEffect","none"),K_(this,"effectAllowed","uninitialized"),K_(this,"items",new lqe),K_(this,"files",s9(t,[]))}}}function a9(t,e=[]){const n=typeof t.DataTransfer>"u"?uqe(t):new t.DataTransfer;return Object.defineProperty(n,"files",{get:()=>s9(t,e)}),n}async function hqe(t,e){return e.kind==="file"?e.getAsFile():new t.Blob([await new Promise(n=>e.getAsString(n))],{type:e.type})}function Ype(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xpe(t,...e){const n=Object.fromEntries(e.map(i=>[typeof i=="string"?"text/plain":i.type,Promise.resolve(i)]));return typeof t.ClipboardItem<"u"?new t.ClipboardItem(n):new class{get types(){return Array.from(Object.keys(this.data))}async getType(r){const s=await this.data[r];if(!s)throw new Error(`${r} is not one of the available MIME types on this item.`);return s instanceof t.Blob?s:new t.Blob([s],{type:r})}constructor(r){Ype(this,"data",void 0),this.data=r}}(n)}const mC=Symbol("Manage ClipboardSub");function ste(t,e){return Object.assign(new class extends t.EventTarget{async read(){return Array.from(this.items)}async readText(){let i="";for(const r of this.items){const s=r.types.includes("text/plain")?"text/plain":r.types.find(a=>a.startsWith("text/"));s&&(i+=await r.getType(s).then(a=>$pe(a,t.FileReader)))}return i}async write(i){this.items=i}async writeText(i){this.items=[Xpe(t,i)]}constructor(...i){super(...i),Ype(this,"items",[])}},{[mC]:e})}function o9(t){return!!(t!=null&&t[mC])}function dqe(t){if(o9(t.navigator.clipboard))return t.navigator.clipboard[mC];const e=Object.getOwnPropertyDescriptor(t.navigator,"clipboard");let n;const i={resetClipboardStub:()=>{n=ste(t,i)},detachClipboardStub:()=>{e?Object.defineProperty(t.navigator,"clipboard",e):Object.defineProperty(t.navigator,"clipboard",{value:void 0,configurable:!0})}};return n=ste(t,i),Object.defineProperty(t.navigator,"clipboard",{get:()=>n,configurable:!0}),n[mC]}function fqe(t){o9(t.navigator.clipboard)&&t.navigator.clipboard[mC].resetClipboardStub()}function pqe(t){o9(t.navigator.clipboard)&&t.navigator.clipboard[mC].detachClipboardStub()}async function mqe(t){const e=t.defaultView,n=e==null?void 0:e.navigator.clipboard,i=n&&await n.read();if(!i)throw new Error("The Clipboard API is unavailable.");const r=a9(e);for(const s of i)for(const a of s.types)r.setData(a,await s.getType(a).then(o=>$pe(o,e.FileReader)));return r}async function Kpe(t,e){const n=hp(t),i=n.navigator.clipboard,r=[];for(let a=0;a<e.items.length;a++){const o=e.items[a],c=await hqe(n,o);r.push(Xpe(n,c))}if(!(i&&await i.write(r).then(()=>!0,()=>!1)))throw new Error("The Clipboard API is unavailable.")}const eU=globalThis;typeof eU.afterEach=="function"&&eU.afterEach(()=>fqe(globalThis.window));typeof eU.afterAll=="function"&&eU.afterAll(()=>pqe(globalThis.window));const Jpe=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");function c9(t){return t.matches(Jpe)}function gqe(t){return new t.constructor(t.type,t)}function oy(t){for(let n=t;n;n=n.parentElement)if(mr(n,["button","input","select","textarea","optgroup","option"])){if(n.hasAttribute("disabled"))return!0}else if(mr(n,"fieldset")){var e;if(n.hasAttribute("disabled")&&!(!((e=n.querySelector(":scope > legend"))===null||e===void 0)&&e.contains(t)))return!0}else if(n.tagName.includes("-")&&n.constructor.formAssociated&&n.hasAttribute("disabled"))return!0;return!1}function YN(t){const e=t.activeElement;return e!=null&&e.shadowRoot?YN(e.shadowRoot):oy(e)?t.ownerDocument?t.ownerDocument.body:t.body:e}function pH(t){var e;return(e=YN(t))!==null&&e!==void 0?e:t.body}function vqe(t,e){let n=t;do{if(e(n))return n;n=n.parentElement}while(n&&n!==t.ownerDocument.body)}function wT(t){return t.hasAttribute("contenteditable")&&(t.getAttribute("contenteditable")=="true"||t.getAttribute("contenteditable")=="")}function gO(t){const e=yqe(t);return e&&(e.closest('[contenteditable=""]')||e.closest('[contenteditable="true"]'))}function yqe(t){return t.nodeType===1?t:t.parentElement}var Zpe=function(t){return t.button="button",t.color="color",t.file="file",t.image="image",t.reset="reset",t.submit="submit",t.checkbox="checkbox",t.radio="radio",t}(Zpe||{});function Qpe(t){return mr(t,"button")||mr(t,"input")&&t.type in Zpe}function gC(t){return tme(t)&&!t.readOnly||wT(t)}var eme=function(t){return t.text="text",t.date="date",t["datetime-local"]="datetime-local",t.email="email",t.month="month",t.number="number",t.password="password",t.search="search",t.tel="tel",t.time="time",t.url="url",t.week="week",t}(eme||{});function tme(t){return mr(t,"textarea")||mr(t,"input")&&t.type in eme}function r0(t){return nme(t)&&tme(t)}function _qe(t){return nme(t)&&Qpe(t)}function nme(t){return t.nodeType===1}function bqe(t){const e=t.ownerDocument.getSelection();if(e!=null&&e.focusNode&&r0(t)){const i=gO(e.focusNode);if(i){if(!e.isCollapsed){var n;const r=((n=i.firstChild)===null||n===void 0?void 0:n.nodeType)===3?i.firstChild:i;e.setBaseAndExtent(r,0,r,0)}}else e.setBaseAndExtent(t,0,t,0)}}var Ob={},l9={exports:{}};l9.exports;(function(t){const n=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,i=(s=0)=>(a,o,c)=>`\x1B[${38+s};2;${a};${o};${c}m`;function r(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,c]of Object.entries(a)){for(const[l,u]of Object.entries(c))a[l]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},c[l]=a[l],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:c,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=i(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=i(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,c,l)=>o===c&&c===l?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(c/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:o=>{const c=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!c)return[0,0,0];let{colorString:l}=c.groups;l.length===3&&(l=l.split("").map(h=>h+h).join(""));const u=Number.parseInt(l,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:r})})(l9);var ime=l9.exports,yy={};Object.defineProperty(yy,"__esModule",{value:!0});yy.printIteratorEntries=Sqe;yy.printIteratorValues=Tqe;yy.printListItems=xqe;yy.printObjectProperties=wqe;const Eqe=(t,e)=>{const n=Object.keys(t).sort(e);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(i=>{Object.getOwnPropertyDescriptor(t,i).enumerable&&n.push(i)}),n};function Sqe(t,e,n,i,r,s,a=": "){let o="",c=t.next();if(!c.done){o+=e.spacingOuter;const l=n+e.indent;for(;!c.done;){const u=s(c.value[0],e,l,i,r),h=s(c.value[1],e,l,i,r);o+=l+u+a+h,c=t.next(),c.done?e.min||(o+=","):o+=","+e.spacingInner}o+=e.spacingOuter+n}return o}function Tqe(t,e,n,i,r,s){let a="",o=t.next();if(!o.done){a+=e.spacingOuter;const c=n+e.indent;for(;!o.done;)a+=c+s(o.value,e,c,i,r),o=t.next(),o.done?e.min||(a+=","):a+=","+e.spacingInner;a+=e.spacingOuter+n}return a}function xqe(t,e,n,i,r,s){let a="";if(t.length){a+=e.spacingOuter;const o=n+e.indent;for(let c=0;c<t.length;c++)a+=o,c in t&&(a+=s(t[c],e,o,i,r)),c<t.length-1?a+=","+e.spacingInner:e.min||(a+=",");a+=e.spacingOuter+n}return a}function wqe(t,e,n,i,r,s){let a="";const o=Eqe(t,e.compareKeys);if(o.length){a+=e.spacingOuter;const c=n+e.indent;for(let l=0;l<o.length;l++){const u=o[l],h=s(u,e,c,i,r),d=s(t[u],e,c,i,r);a+=c+h+": "+d,l<o.length-1?a+=","+e.spacingInner:e.min||(a+=",")}a+=e.spacingOuter+n}return a}var ob={};Object.defineProperty(ob,"__esModule",{value:!0});ob.test=ob.serialize=ob.default=void 0;var ate=yy,tU=function(){return typeof globalThis<"u"?globalThis:typeof tU<"u"?tU:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),mH=tU["jest-symbol-do-not-touch"]||tU.Symbol;const Cqe=typeof mH=="function"&&mH.for?mH.for("jest.asymmetricMatcher"):1267621,fD=" ",rme=(t,e,n,i,r,s)=>{const a=t.toString();return a==="ArrayContaining"||a==="ArrayNotContaining"?++i>e.maxDepth?"["+a+"]":a+fD+"["+(0,ate.printListItems)(t.sample,e,n,i,r,s)+"]":a==="ObjectContaining"||a==="ObjectNotContaining"?++i>e.maxDepth?"["+a+"]":a+fD+"{"+(0,ate.printObjectProperties)(t.sample,e,n,i,r,s)+"}":a==="StringMatching"||a==="StringNotMatching"||a==="StringContaining"||a==="StringNotContaining"?a+fD+s(t.sample,e,n,i,r):t.toAsymmetricMatcher()};ob.serialize=rme;const sme=t=>t&&t.$$typeof===Cqe;ob.test=sme;const Rqe={serialize:rme,test:sme};var Aqe=Rqe;ob.default=Aqe;var cb={},Mqe=({onlyFirst:t=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,t?void 0:"g")};Object.defineProperty(cb,"__esModule",{value:!0});cb.test=cb.serialize=cb.default=void 0;var ame=ome(Mqe),Js=ome(ime);function ome(t){return t&&t.__esModule?t:{default:t}}const Oqe=t=>t.replace((0,ame.default)(),e=>{switch(e){case Js.default.red.close:case Js.default.green.close:case Js.default.cyan.close:case Js.default.gray.close:case Js.default.white.close:case Js.default.yellow.close:case Js.default.bgRed.close:case Js.default.bgGreen.close:case Js.default.bgYellow.close:case Js.default.inverse.close:case Js.default.dim.close:case Js.default.bold.close:case Js.default.reset.open:case Js.default.reset.close:return"</>";case Js.default.red.open:return"<red>";case Js.default.green.open:return"<green>";case Js.default.cyan.open:return"<cyan>";case Js.default.gray.open:return"<gray>";case Js.default.white.open:return"<white>";case Js.default.yellow.open:return"<yellow>";case Js.default.bgRed.open:return"<bgRed>";case Js.default.bgGreen.open:return"<bgGreen>";case Js.default.bgYellow.open:return"<bgYellow>";case Js.default.inverse.open:return"<inverse>";case Js.default.dim.open:return"<dim>";case Js.default.bold.open:return"<bold>";default:return""}}),cme=t=>typeof t=="string"&&!!t.match((0,ame.default)());cb.test=cme;const lme=(t,e,n,i,r,s)=>s(Oqe(t),e,n,i,r);cb.serialize=lme;const Nqe={serialize:lme,test:cme};var Iqe=Nqe;cb.default=Iqe;var lb={};Object.defineProperty(lb,"__esModule",{value:!0});lb.test=lb.serialize=lb.default=void 0;var ote=yy;const kqe=" ",ume=["DOMStringMap","NamedNodeMap"],Dqe=/^(HTML\w*Collection|NodeList)$/,Pqe=t=>ume.indexOf(t)!==-1||Dqe.test(t),hme=t=>t&&t.constructor&&!!t.constructor.name&&Pqe(t.constructor.name);lb.test=hme;const Lqe=t=>t.constructor.name==="NamedNodeMap",dme=(t,e,n,i,r,s)=>{const a=t.constructor.name;return++i>e.maxDepth?"["+a+"]":(e.min?"":a+kqe)+(ume.indexOf(a)!==-1?"{"+(0,ote.printObjectProperties)(Lqe(t)?Array.from(t).reduce((o,c)=>(o[c.name]=c.value,o),{}):{...t},e,n,i,r,s)+"}":"["+(0,ote.printListItems)(Array.from(t),e,n,i,r,s)+"]")};lb.serialize=dme;const Uqe={serialize:dme,test:hme};var Bqe=Uqe;lb.default=Bqe;var ub={},nu={},u9={};Object.defineProperty(u9,"__esModule",{value:!0});u9.default=Fqe;function Fqe(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}Object.defineProperty(nu,"__esModule",{value:!0});nu.printText=nu.printProps=nu.printElementAsLeaf=nu.printElement=nu.printComment=nu.printChildren=void 0;var fme=zqe(u9);function zqe(t){return t&&t.__esModule?t:{default:t}}const Hqe=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")};nu.printProps=Hqe;const jqe=(t,e,n,i,r,s)=>t.map(a=>e.spacingOuter+n+(typeof a=="string"?pme(a,e):s(a,e,n,i,r))).join("");nu.printChildren=jqe;const pme=(t,e)=>{const n=e.colors.content;return n.open+(0,fme.default)(t)+n.close};nu.printText=pme;const Vqe=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+(0,fme.default)(t)+"-->"+n.close};nu.printComment=Vqe;const Gqe=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close};nu.printElement=Gqe;const qqe=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" "+n.open+" />"+n.close};nu.printElementAsLeaf=qqe;Object.defineProperty(ub,"__esModule",{value:!0});ub.test=ub.serialize=ub.default=void 0;var h1=nu;const $qe=1,mme=3,gme=8,vme=11,Wqe=/^((HTML|SVG)\w*)?Element$/,Yqe=t=>{try{return typeof t.hasAttribute=="function"&&t.hasAttribute("is")}catch{return!1}},Xqe=t=>{const e=t.constructor.name,{nodeType:n,tagName:i}=t,r=typeof i=="string"&&i.includes("-")||Yqe(t);return n===$qe&&(Wqe.test(e)||r)||n===mme&&e==="Text"||n===gme&&e==="Comment"||n===vme&&e==="DocumentFragment"},yme=t=>{var e;return(t==null||(e=t.constructor)===null||e===void 0?void 0:e.name)&&Xqe(t)};ub.test=yme;function Kqe(t){return t.nodeType===mme}function Jqe(t){return t.nodeType===gme}function gH(t){return t.nodeType===vme}const _me=(t,e,n,i,r,s)=>{if(Kqe(t))return(0,h1.printText)(t.data,e);if(Jqe(t))return(0,h1.printComment)(t.data,e);const a=gH(t)?"DocumentFragment":t.tagName.toLowerCase();return++i>e.maxDepth?(0,h1.printElementAsLeaf)(a,e):(0,h1.printElement)(a,(0,h1.printProps)(gH(t)?[]:Array.from(t.attributes).map(o=>o.name).sort(),gH(t)?{}:Array.from(t.attributes).reduce((o,c)=>(o[c.name]=c.value,o),{}),e,n+e.indent,i,r,s),(0,h1.printChildren)(Array.prototype.slice.call(t.childNodes||t.children),e,n+e.indent,i,r,s),e,n)};ub.serialize=_me;const Zqe={serialize:_me,test:yme};var Qqe=Zqe;ub.default=Qqe;var hb={};Object.defineProperty(hb,"__esModule",{value:!0});hb.test=hb.serialize=hb.default=void 0;var vO=yy;const e$e="@@__IMMUTABLE_ITERABLE__@@",t$e="@@__IMMUTABLE_LIST__@@",n$e="@@__IMMUTABLE_KEYED__@@",i$e="@@__IMMUTABLE_MAP__@@",cte="@@__IMMUTABLE_ORDERED__@@",r$e="@@__IMMUTABLE_RECORD__@@",s$e="@@__IMMUTABLE_SEQ__@@",a$e="@@__IMMUTABLE_SET__@@",o$e="@@__IMMUTABLE_STACK__@@",vC=t=>"Immutable."+t,MB=t=>"["+t+"]",yO=" ",lte="",c$e=(t,e,n,i,r,s,a)=>++i>e.maxDepth?MB(vC(a)):vC(a)+yO+"{"+(0,vO.printIteratorEntries)(t.entries(),e,n,i,r,s)+"}";function l$e(t){let e=0;return{next(){if(e<t._keys.length){const n=t._keys[e++];return{done:!1,value:[n,t.get(n)]}}return{done:!0,value:void 0}}}}const u$e=(t,e,n,i,r,s)=>{const a=vC(t._name||"Record");return++i>e.maxDepth?MB(a):a+yO+"{"+(0,vO.printIteratorEntries)(l$e(t),e,n,i,r,s)+"}"},h$e=(t,e,n,i,r,s)=>{const a=vC("Seq");return++i>e.maxDepth?MB(a):t[n$e]?a+yO+"{"+(t._iter||t._object?(0,vO.printIteratorEntries)(t.entries(),e,n,i,r,s):lte)+"}":a+yO+"["+(t._iter||t._array||t._collection||t._iterable?(0,vO.printIteratorValues)(t.values(),e,n,i,r,s):lte)+"]"},vH=(t,e,n,i,r,s,a)=>++i>e.maxDepth?MB(vC(a)):vC(a)+yO+"["+(0,vO.printIteratorValues)(t.values(),e,n,i,r,s)+"]",bme=(t,e,n,i,r,s)=>t[i$e]?c$e(t,e,n,i,r,s,t[cte]?"OrderedMap":"Map"):t[t$e]?vH(t,e,n,i,r,s,"List"):t[a$e]?vH(t,e,n,i,r,s,t[cte]?"OrderedSet":"Set"):t[o$e]?vH(t,e,n,i,r,s,"Stack"):t[s$e]?h$e(t,e,n,i,r,s):u$e(t,e,n,i,r,s);hb.serialize=bme;const Eme=t=>t&&(t[e$e]===!0||t[r$e]===!0);hb.test=Eme;const d$e={serialize:bme,test:Eme};var f$e=d$e;hb.default=f$e;var db={},Sme={exports:{}},Ws={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OB=60103,NB=60106,XN=60107,KN=60108,JN=60114,ZN=60109,QN=60110,eI=60112,tI=60113,h9=60120,nI=60115,iI=60116,Tme=60121,xme=60122,wme=60117,Cme=60129,Rme=60131;if(typeof Symbol=="function"&&Symbol.for){var Rl=Symbol.for;OB=Rl("react.element"),NB=Rl("react.portal"),XN=Rl("react.fragment"),KN=Rl("react.strict_mode"),JN=Rl("react.profiler"),ZN=Rl("react.provider"),QN=Rl("react.context"),eI=Rl("react.forward_ref"),tI=Rl("react.suspense"),h9=Rl("react.suspense_list"),nI=Rl("react.memo"),iI=Rl("react.lazy"),Tme=Rl("react.block"),xme=Rl("react.server.block"),wme=Rl("react.fundamental"),Cme=Rl("react.debug_trace_mode"),Rme=Rl("react.legacy_hidden")}function fm(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case OB:switch(t=t.type,t){case XN:case JN:case KN:case tI:case h9:return t;default:switch(t=t&&t.$$typeof,t){case QN:case eI:case iI:case nI:case ZN:return t;default:return e}}case NB:return e}}}var p$e=ZN,m$e=OB,g$e=eI,v$e=XN,y$e=iI,_$e=nI,b$e=NB,E$e=JN,S$e=KN,T$e=tI;Ws.ContextConsumer=QN;Ws.ContextProvider=p$e;Ws.Element=m$e;Ws.ForwardRef=g$e;Ws.Fragment=v$e;Ws.Lazy=y$e;Ws.Memo=_$e;Ws.Portal=b$e;Ws.Profiler=E$e;Ws.StrictMode=S$e;Ws.Suspense=T$e;Ws.isAsyncMode=function(){return!1};Ws.isConcurrentMode=function(){return!1};Ws.isContextConsumer=function(t){return fm(t)===QN};Ws.isContextProvider=function(t){return fm(t)===ZN};Ws.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===OB};Ws.isForwardRef=function(t){return fm(t)===eI};Ws.isFragment=function(t){return fm(t)===XN};Ws.isLazy=function(t){return fm(t)===iI};Ws.isMemo=function(t){return fm(t)===nI};Ws.isPortal=function(t){return fm(t)===NB};Ws.isProfiler=function(t){return fm(t)===JN};Ws.isStrictMode=function(t){return fm(t)===KN};Ws.isSuspense=function(t){return fm(t)===tI};Ws.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===XN||t===JN||t===Cme||t===KN||t===tI||t===h9||t===Rme||typeof t=="object"&&t!==null&&(t.$$typeof===iI||t.$$typeof===nI||t.$$typeof===ZN||t.$$typeof===QN||t.$$typeof===eI||t.$$typeof===wme||t.$$typeof===Tme||t[0]===xme)};Ws.typeOf=fm;Sme.exports=Ws;var x$e=Sme.exports;Object.defineProperty(db,"__esModule",{value:!0});db.test=db.serialize=db.default=void 0;var ES=w$e(x$e),pD=nu;function Ame(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Ame=function(i){return i?n:e})(t)}function w$e(t,e){if(t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Ame(e);if(n&&n.has(t))return n.get(t);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var a=r?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,n&&n.set(t,i),i}const Mme=(t,e=[])=>(Array.isArray(t)?t.forEach(n=>{Mme(n,e)}):t!=null&&t!==!1&&e.push(t),e),ute=t=>{const e=t.type;if(typeof e=="string")return e;if(typeof e=="function")return e.displayName||e.name||"Unknown";if(ES.isFragment(t))return"React.Fragment";if(ES.isSuspense(t))return"React.Suspense";if(typeof e=="object"&&e!==null){if(ES.isContextProvider(t))return"Context.Provider";if(ES.isContextConsumer(t))return"Context.Consumer";if(ES.isForwardRef(t)){if(e.displayName)return e.displayName;const n=e.render.displayName||e.render.name||"";return n!==""?"ForwardRef("+n+")":"ForwardRef"}if(ES.isMemo(t)){const n=e.displayName||e.type.displayName||e.type.name||"";return n!==""?"Memo("+n+")":"Memo"}}return"UNDEFINED"},C$e=t=>{const{props:e}=t;return Object.keys(e).filter(n=>n!=="children"&&e[n]!==void 0).sort()},Ome=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,pD.printElementAsLeaf)(ute(t),e):(0,pD.printElement)(ute(t),(0,pD.printProps)(C$e(t),t.props,e,n+e.indent,i,r,s),(0,pD.printChildren)(Mme(t.props.children),e,n+e.indent,i,r,s),e,n);db.serialize=Ome;const Nme=t=>t!=null&&ES.isElement(t);db.test=Nme;const R$e={serialize:Ome,test:Nme};var A$e=R$e;db.default=A$e;var fb={};Object.defineProperty(fb,"__esModule",{value:!0});fb.test=fb.serialize=fb.default=void 0;var mD=nu,nU=function(){return typeof globalThis<"u"?globalThis:typeof nU<"u"?nU:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()}(),yH=nU["jest-symbol-do-not-touch"]||nU.Symbol;const M$e=typeof yH=="function"&&yH.for?yH.for("react.test.json"):245830487,O$e=t=>{const{props:e}=t;return e?Object.keys(e).filter(n=>e[n]!==void 0).sort():[]},Ime=(t,e,n,i,r,s)=>++i>e.maxDepth?(0,mD.printElementAsLeaf)(t.type,e):(0,mD.printElement)(t.type,t.props?(0,mD.printProps)(O$e(t),t.props,e,n+e.indent,i,r,s):"",t.children?(0,mD.printChildren)(t.children,e,n+e.indent,i,r,s):"",e,n);fb.serialize=Ime;const kme=t=>t&&t.$$typeof===M$e;fb.test=kme;const N$e={serialize:Ime,test:kme};var I$e=N$e;fb.default=I$e;Object.defineProperty(Ob,"__esModule",{value:!0});Ob.default=Ob.DEFAULT_OPTIONS=void 0;var k$e=Ob.format=qme,Dme=Ob.plugins=void 0,D$e=Qb(ime),QR=yy,P$e=Qb(ob),L$e=Qb(cb),U$e=Qb(lb),B$e=Qb(ub),F$e=Qb(hb),z$e=Qb(db),H$e=Qb(fb);function Qb(t){return t&&t.__esModule?t:{default:t}}const Pme=Object.prototype.toString,j$e=Date.prototype.toISOString,V$e=Error.prototype.toString,hte=RegExp.prototype.toString,_H=t=>typeof t.constructor=="function"&&t.constructor.name||"Object",G$e=t=>typeof window<"u"&&t===window,q$e=/^Symbol\((.*)\)(.*)$/,$$e=/\n/gi;class Lme extends Error{constructor(e,n){super(e),this.stack=n,this.name=this.constructor.name}}function W$e(t){return t==="[object Array]"||t==="[object ArrayBuffer]"||t==="[object DataView]"||t==="[object Float32Array]"||t==="[object Float64Array]"||t==="[object Int8Array]"||t==="[object Int16Array]"||t==="[object Int32Array]"||t==="[object Uint8Array]"||t==="[object Uint8ClampedArray]"||t==="[object Uint16Array]"||t==="[object Uint32Array]"}function Y$e(t){return Object.is(t,-0)?"-0":String(t)}function X$e(t){return`${t}n`}function dte(t,e){return e?"[Function "+(t.name||"anonymous")+"]":"[Function]"}function fte(t){return String(t).replace(q$e,"Symbol($1)")}function pte(t){return"["+V$e.call(t)+"]"}function Ume(t,e,n,i){if(t===!0||t===!1)return""+t;if(t===void 0)return"undefined";if(t===null)return"null";const r=typeof t;if(r==="number")return Y$e(t);if(r==="bigint")return X$e(t);if(r==="string")return i?'"'+t.replace(/"|\\/g,"\\$&")+'"':'"'+t+'"';if(r==="function")return dte(t,e);if(r==="symbol")return fte(t);const s=Pme.call(t);return s==="[object WeakMap]"?"WeakMap {}":s==="[object WeakSet]"?"WeakSet {}":s==="[object Function]"||s==="[object GeneratorFunction]"?dte(t,e):s==="[object Symbol]"?fte(t):s==="[object Date]"?isNaN(+t)?"Date { NaN }":j$e.call(t):s==="[object Error]"?pte(t):s==="[object RegExp]"?n?hte.call(t).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):hte.call(t):t instanceof Error?pte(t):null}function Bme(t,e,n,i,r,s){if(r.indexOf(t)!==-1)return"[Circular]";r=r.slice(),r.push(t);const a=++i>e.maxDepth,o=e.min;if(e.callToJSON&&!a&&t.toJSON&&typeof t.toJSON=="function"&&!s)return M_(t.toJSON(),e,n,i,r,!0);const c=Pme.call(t);return c==="[object Arguments]"?a?"[Arguments]":(o?"":"Arguments ")+"["+(0,QR.printListItems)(t,e,n,i,r,M_)+"]":W$e(c)?a?"["+t.constructor.name+"]":(o||!e.printBasicPrototype&&t.constructor.name==="Array"?"":t.constructor.name+" ")+"["+(0,QR.printListItems)(t,e,n,i,r,M_)+"]":c==="[object Map]"?a?"[Map]":"Map {"+(0,QR.printIteratorEntries)(t.entries(),e,n,i,r,M_," => ")+"}":c==="[object Set]"?a?"[Set]":"Set {"+(0,QR.printIteratorValues)(t.values(),e,n,i,r,M_)+"}":a||G$e(t)?"["+_H(t)+"]":(o||!e.printBasicPrototype&&_H(t)==="Object"?"":_H(t)+" ")+"{"+(0,QR.printObjectProperties)(t,e,n,i,r,M_)+"}"}function K$e(t){return t.serialize!=null}function Fme(t,e,n,i,r,s){let a;try{a=K$e(t)?t.serialize(e,n,i,r,s,M_):t.print(e,o=>M_(o,n,i,r,s),o=>{const c=i+n.indent;return c+o.replace($$e,`
`+c)},{edgeSpacing:n.spacingOuter,min:n.min,spacing:n.spacingInner},n.colors)}catch(o){throw new Lme(o.message,o.stack)}if(typeof a!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof a}".`);return a}function zme(t,e){for(let n=0;n<t.length;n++)try{if(t[n].test(e))return t[n]}catch(i){throw new Lme(i.message,i.stack)}return null}function M_(t,e,n,i,r,s){const a=zme(e.plugins,t);if(a!==null)return Fme(a,t,e,n,i,r);const o=Ume(t,e.printFunctionName,e.escapeRegex,e.escapeString);return o!==null?o:Bme(t,e,n,i,r,s)}const d9={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},Hme=Object.keys(d9),Vp={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:d9};Ob.DEFAULT_OPTIONS=Vp;function J$e(t){if(Object.keys(t).forEach(e=>{if(!Vp.hasOwnProperty(e))throw new Error(`pretty-format: Unknown option "${e}".`)}),t.min&&t.indent!==void 0&&t.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(t.theme!==void 0){if(t.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof t.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof t.theme}".`)}}const Z$e=t=>Hme.reduce((e,n)=>{const i=t.theme&&t.theme[n]!==void 0?t.theme[n]:d9[n],r=i&&D$e.default[i];if(r&&typeof r.close=="string"&&typeof r.open=="string")e[n]=r;else throw new Error(`pretty-format: Option "theme" has a key "${n}" whose value "${i}" is undefined in ansi-styles.`);return e},Object.create(null)),Q$e=()=>Hme.reduce((t,e)=>(t[e]={close:"",open:""},t),Object.create(null)),jme=t=>t&&t.printFunctionName!==void 0?t.printFunctionName:Vp.printFunctionName,Vme=t=>t&&t.escapeRegex!==void 0?t.escapeRegex:Vp.escapeRegex,Gme=t=>t&&t.escapeString!==void 0?t.escapeString:Vp.escapeString,mte=t=>{var e;return{callToJSON:t&&t.callToJSON!==void 0?t.callToJSON:Vp.callToJSON,colors:t&&t.highlight?Z$e(t):Q$e(),compareKeys:t&&typeof t.compareKeys=="function"?t.compareKeys:Vp.compareKeys,escapeRegex:Vme(t),escapeString:Gme(t),indent:t&&t.min?"":e7e(t&&t.indent!==void 0?t.indent:Vp.indent),maxDepth:t&&t.maxDepth!==void 0?t.maxDepth:Vp.maxDepth,min:t&&t.min!==void 0?t.min:Vp.min,plugins:t&&t.plugins!==void 0?t.plugins:Vp.plugins,printBasicPrototype:(e=t==null?void 0:t.printBasicPrototype)!==null&&e!==void 0?e:!0,printFunctionName:jme(t),spacingInner:t&&t.min?" ":`
`,spacingOuter:t&&t.min?"":`
`}};function e7e(t){return new Array(t+1).join(" ")}function qme(t,e){if(e&&(J$e(e),e.plugins)){const i=zme(e.plugins,t);if(i!==null)return Fme(i,t,mte(e),"",0,[])}const n=Ume(t,jme(e),Vme(e),Gme(e));return n!==null?n:Bme(t,mte(e),"",0,[])}const t7e={AsymmetricMatcher:P$e.default,ConvertAnsi:L$e.default,DOMCollection:U$e.default,DOMElement:B$e.default,Immutable:F$e.default,ReactElement:z$e.default,ReactTestComponent:H$e.default};Dme=Ob.plugins=t7e;var n7e=qme;Ob.default=n7e;var i7e=Object.prototype.toString;function r7e(t){return typeof t=="function"||i7e.call(t)==="[object Function]"}function s7e(t){var e=Number(t);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var a7e=Math.pow(2,53)-1;function o7e(t){var e=s7e(t);return Math.min(Math.max(e,0),a7e)}function Gp(t,e){var n=Array,i=Object(t);if(t==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var r=o7e(i.length),s=r7e(n)?Object(new n(r)):new Array(r),a=0,o;a<r;)o=i[a],s[a]=o,a+=1;return s.length=r,s}function _O(t){"@babel/helpers - typeof";return _O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_O(t)}function c7e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l7e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,$me(i.key),i)}}function u7e(t,e,n){return e&&l7e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function h7e(t,e,n){return e=$me(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $me(t){var e=d7e(t,"string");return _O(e)==="symbol"?e:String(e)}function d7e(t,e){if(_O(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(_O(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var f7e=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];c7e(this,t),h7e(this,"items",void 0),this.items=e}return u7e(t,[{key:"add",value:function(n){return this.has(n)===!1&&this.items.push(n),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(n){var i=this.items.length;return this.items=this.items.filter(function(r){return r!==n}),i!==this.items.length}},{key:"forEach",value:function(n){var i=this;this.items.forEach(function(r){n(r,r,i)})}},{key:"has",value:function(n){return this.items.indexOf(n)!==-1}},{key:"size",get:function(){return this.items.length}}]),t}();const p7e=typeof Set>"u"?Set:f7e;function hu(t){var e;return(e=t.localName)!==null&&e!==void 0?e:t.tagName.toLowerCase()}var m7e={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},g7e={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function v7e(t,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(n){var i;return t.hasAttribute(n)&&!((i=g7e[e])!==null&&i!==void 0&&i.has(n))})}function Wme(t,e){return v7e(t,e)}function y7e(t){var e=b7e(t);if(e===null||e==="presentation"){var n=_7e(t);if(e!=="presentation"||Wme(t,n||""))return n}return e}function _7e(t){var e=m7e[hu(t)];if(e!==void 0)return e;switch(hu(t)){case"a":case"area":case"link":if(t.hasAttribute("href"))return"link";break;case"img":return t.getAttribute("alt")===""&&!Wme(t,"img")?"presentation":"img";case"input":{var n=t,i=n.type;switch(i){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return i;case"range":return"slider";case"email":case"tel":case"text":case"url":return t.hasAttribute("list")?"combobox":"textbox";case"search":return t.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return t.hasAttribute("multiple")||t.size>1?"listbox":"combobox"}return null}function b7e(t){var e=t.getAttribute("role");if(e!==null){var n=e.trim().split(" ")[0];if(n.length>0)return n}return null}function Oa(t){return t!==null&&t.nodeType===t.ELEMENT_NODE}function Yme(t){return Oa(t)&&hu(t)==="caption"}function yP(t){return Oa(t)&&hu(t)==="input"}function E7e(t){return Oa(t)&&hu(t)==="optgroup"}function S7e(t){return Oa(t)&&hu(t)==="select"}function T7e(t){return Oa(t)&&hu(t)==="table"}function x7e(t){return Oa(t)&&hu(t)==="textarea"}function w7e(t){var e=t.ownerDocument===null?t:t.ownerDocument,n=e.defaultView;if(n===null)throw new TypeError("no window available");return n}function C7e(t){return Oa(t)&&hu(t)==="fieldset"}function R7e(t){return Oa(t)&&hu(t)==="legend"}function A7e(t){return Oa(t)&&hu(t)==="slot"}function M7e(t){return Oa(t)&&t.ownerSVGElement!==void 0}function O7e(t){return Oa(t)&&hu(t)==="svg"}function N7e(t){return M7e(t)&&hu(t)==="title"}function iU(t,e){if(Oa(t)&&t.hasAttribute(e)){var n=t.getAttribute(e).split(" "),i=t.getRootNode?t.getRootNode():t.ownerDocument;return n.map(function(r){return i.getElementById(r)}).filter(function(r){return r!==null})}return[]}function Bv(t,e){return Oa(t)?e.indexOf(y7e(t))!==-1:!1}function I7e(t){return t.trim().replace(/\s\s+/g," ")}function k7e(t,e){if(!Oa(t))return!1;if(t.hasAttribute("hidden")||t.getAttribute("aria-hidden")==="true")return!0;var n=e(t);return n.getPropertyValue("display")==="none"||n.getPropertyValue("visibility")==="hidden"}function D7e(t){return Bv(t,["button","combobox","listbox","textbox"])||Xme(t,"range")}function Xme(t,e){if(!Oa(t))return!1;switch(e){case"range":return Bv(t,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function gte(t,e){var n=Gp(t.querySelectorAll(e));return iU(t,"aria-owns").forEach(function(i){n.push.apply(n,Gp(i.querySelectorAll(e)))}),n}function P7e(t){return S7e(t)?t.selectedOptions||gte(t,"[selected]"):gte(t,'[aria-selected="true"]')}function L7e(t){return Bv(t,["none","presentation"])}function U7e(t){return Yme(t)}function B7e(t){return Bv(t,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function F7e(t){return!1}function z7e(t){return yP(t)||x7e(t)?t.value:t.textContent||""}function vte(t){var e=t.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function Kme(t){var e=hu(t);return e==="button"||e==="input"&&t.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function Jme(t){if(Kme(t))return t;var e=null;return t.childNodes.forEach(function(n){if(e===null&&Oa(n)){var i=Jme(n);i!==null&&(e=i)}}),e}function H7e(t){if(t.control!==void 0)return t.control;var e=t.getAttribute("for");return e!==null?t.ownerDocument.getElementById(e):Jme(t)}function j7e(t){var e=t.labels;if(e===null)return e;if(e!==void 0)return Gp(e);if(!Kme(t))return null;var n=t.ownerDocument;return Gp(n.querySelectorAll("label")).filter(function(i){return H7e(i)===t})}function V7e(t){var e=t.assignedNodes();return e.length===0?Gp(t.childNodes):e}function Zme(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=new p7e,i=w7e(t),r=e.compute,s=r===void 0?"name":r,a=e.computedStyleSupportsPseudoElements,o=a===void 0?e.getComputedStyle!==void 0:a,c=e.getComputedStyle,l=c===void 0?i.getComputedStyle.bind(i):c,u=e.hidden,h=u===void 0?!1:u;function d(v,E){var T="";if(Oa(v)&&o){var x=l(v,"::before"),N=vte(x);T="".concat(N," ").concat(T)}var A=A7e(v)?V7e(v):Gp(v.childNodes).concat(iU(v,"aria-owns"));if(A.forEach(function(L){var U=_(L,{isEmbeddedInLabel:E.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),$=Oa(L)?l(L).getPropertyValue("display"):"inline",q=$!=="inline"?" ":"";T+="".concat(q).concat(U).concat(q)}),Oa(v)&&o){var I=l(v,"::after"),k=vte(I);T="".concat(T," ").concat(k)}return T.trim()}function f(v,E){var T=v.getAttributeNode(E);return T!==null&&!n.has(T)&&T.value.trim()!==""?(n.add(T),T.value):null}function p(v){return Oa(v)?f(v,"title"):null}function g(v){if(!Oa(v))return null;if(C7e(v)){n.add(v);for(var E=Gp(v.childNodes),T=0;T<E.length;T+=1){var x=E[T];if(R7e(x))return _(x,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(T7e(v)){n.add(v);for(var N=Gp(v.childNodes),A=0;A<N.length;A+=1){var I=N[A];if(Yme(I))return _(I,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(O7e(v)){n.add(v);for(var k=Gp(v.childNodes),L=0;L<k.length;L+=1){var U=k[L];if(N7e(U))return U.textContent}return null}else if(hu(v)==="img"||hu(v)==="area"){var $=f(v,"alt");if($!==null)return $}else if(E7e(v)){var q=f(v,"label");if(q!==null)return q}if(yP(v)&&(v.type==="button"||v.type==="submit"||v.type==="reset")){var G=f(v,"value");if(G!==null)return G;if(v.type==="submit")return"Submit";if(v.type==="reset")return"Reset"}var X=j7e(v);if(X!==null&&X.length!==0)return n.add(v),Gp(X).map(function(Y){return _(Y,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(Y){return Y.length>0}).join(" ");if(yP(v)&&v.type==="image"){var ie=f(v,"alt");if(ie!==null)return ie;var V=f(v,"title");return V!==null?V:"Submit Query"}if(Bv(v,["button"])){var Z=d(v,{isEmbeddedInLabel:!1,isReferenced:!1});if(Z!=="")return Z}return null}function _(v,E){if(n.has(v))return"";if(!h&&k7e(v,l)&&!E.isReferenced)return n.add(v),"";var T=Oa(v)?v.getAttributeNode("aria-labelledby"):null,x=T!==null&&!n.has(T)?iU(v,"aria-labelledby"):[];if(s==="name"&&!E.isReferenced&&x.length>0)return n.add(T),x.map(function($){return _($,{isEmbeddedInLabel:E.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var N=E.recursion&&D7e(v)&&s==="name";if(!N){var A=(Oa(v)&&v.getAttribute("aria-label")||"").trim();if(A!==""&&s==="name")return n.add(v),A;if(!L7e(v)){var I=g(v);if(I!==null)return n.add(v),I}}if(Bv(v,["menu"]))return n.add(v),"";if(N||E.isEmbeddedInLabel||E.isReferenced){if(Bv(v,["combobox","listbox"])){n.add(v);var k=P7e(v);return k.length===0?yP(v)?v.value:"":Gp(k).map(function($){return _($,{isEmbeddedInLabel:E.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(Xme(v,"range"))return n.add(v),v.hasAttribute("aria-valuetext")?v.getAttribute("aria-valuetext"):v.hasAttribute("aria-valuenow")?v.getAttribute("aria-valuenow"):v.getAttribute("value")||"";if(Bv(v,["textbox"]))return n.add(v),z7e(v)}if(B7e(v)||Oa(v)&&E.isReferenced||U7e(v)||F7e()){var L=d(v,{isEmbeddedInLabel:E.isEmbeddedInLabel,isReferenced:!1});if(L!=="")return n.add(v),L}if(v.nodeType===v.TEXT_NODE)return n.add(v),v.textContent||"";if(E.recursion)return n.add(v),d(v,{isEmbeddedInLabel:E.isEmbeddedInLabel,isReferenced:!1});var U=p(v);return U!==null?(n.add(v),U):(n.add(v),"")}return I7e(_(t,{isEmbeddedInLabel:!1,isReferenced:s==="description",recursion:!1}))}function bO(t){"@babel/helpers - typeof";return bO=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bO(t)}function yte(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function _te(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yte(Object(n),!0).forEach(function(i){G7e(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yte(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function G7e(t,e,n){return e=q7e(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q7e(t){var e=$7e(t,"string");return bO(e)==="symbol"?e:String(e)}function $7e(t,e){if(bO(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(bO(i)!=="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qme(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=iU(t,"aria-describedby").map(function(r){return Zme(r,_te(_te({},e),{},{compute:"description"}))}).join(" ");if(n===""){var i=t.getAttribute("title");n=i===null?"":i}return n}function W7e(t){return Bv(t,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function f9(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return W7e(t)?"":Zme(t,e)}var Wp={},IB={},KT={},kB={};Object.defineProperty(kB,"__esModule",{value:!0});kB.default=void 0;function Y7e(){var t=this,e=0,n={"@@iterator":function(){return n},next:function(){if(e<t.length){var r=t[e];return e=e+1,{done:!1,value:r}}else return{done:!0}}};return n}var X7e=Y7e;kB.default=X7e;Object.defineProperty(KT,"__esModule",{value:!0});KT.default=Z7e;var K7e=J7e(kB);function J7e(t){return t&&t.__esModule?t:{default:t}}function FV(t){"@babel/helpers - typeof";return FV=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FV(t)}function Z7e(t,e){return typeof Symbol=="function"&&FV(Symbol.iterator)==="symbol"&&Object.defineProperty(t,Symbol.iterator,{value:K7e.default.bind(e)}),t}Object.defineProperty(IB,"__esModule",{value:!0});IB.default=void 0;var Q7e=eWe(KT);function eWe(t){return t&&t.__esModule?t:{default:t}}function bH(t,e){return iWe(t)||nWe(t,e)||ege(t,e)||tWe()}function tWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nWe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function iWe(t){if(Array.isArray(t))return t}function rWe(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=ege(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function ege(t,e){if(t){if(typeof t=="string")return bte(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bte(t,e)}}function bte(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var d1=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-braillelabel",{type:"string"}],["aria-brailleroledescription",{type:"string"}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-description",{type:"string"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],zV={entries:function(){return d1},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=rWe(d1),r;try{for(i.s();!(r=i.n()).done;){var s=bH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,d1)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=d1.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!zV.get(e)},keys:function(){return d1.map(function(e){var n=bH(e,1),i=n[0];return i})},values:function(){return d1.map(function(e){var n=bH(e,2),i=n[1];return i})}},sWe=(0,Q7e.default)(zV,zV.entries());IB.default=sWe;var DB={};Object.defineProperty(DB,"__esModule",{value:!0});DB.default=void 0;var aWe=oWe(KT);function oWe(t){return t&&t.__esModule?t:{default:t}}function EH(t,e){return uWe(t)||lWe(t,e)||tge(t,e)||cWe()}function cWe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lWe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function uWe(t){if(Array.isArray(t))return t}function hWe(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=tge(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function tge(t,e){if(t){if(typeof t=="string")return Ete(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ete(t,e)}}function Ete(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var f1=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],HV={entries:function(){return f1},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=hWe(f1),r;try{for(i.s();!(r=i.n()).done;){var s=EH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,f1)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=f1.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!HV.get(e)},keys:function(){return f1.map(function(e){var n=EH(e,1),i=n[0];return i})},values:function(){return f1.map(function(e){var n=EH(e,2),i=n[1];return i})}},dWe=(0,aWe.default)(HV,HV.entries());DB.default=dWe;var eR={},PB={},LB={};Object.defineProperty(LB,"__esModule",{value:!0});LB.default=void 0;var fWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},pWe=fWe;LB.default=pWe;var UB={};Object.defineProperty(UB,"__esModule",{value:!0});UB.default=void 0;var mWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},gWe=mWe;UB.default=gWe;var BB={};Object.defineProperty(BB,"__esModule",{value:!0});BB.default=void 0;var vWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},yWe=vWe;BB.default=yWe;var FB={};Object.defineProperty(FB,"__esModule",{value:!0});FB.default=void 0;var _We={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},bWe=_We;FB.default=bWe;var zB={};Object.defineProperty(zB,"__esModule",{value:!0});zB.default=void 0;var EWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},SWe=EWe;zB.default=SWe;var HB={};Object.defineProperty(HB,"__esModule",{value:!0});HB.default=void 0;var TWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},xWe=TWe;HB.default=xWe;var jB={};Object.defineProperty(jB,"__esModule",{value:!0});jB.default=void 0;var wWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},CWe=wWe;jB.default=CWe;var VB={};Object.defineProperty(VB,"__esModule",{value:!0});VB.default=void 0;var RWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},AWe=RWe;VB.default=AWe;var GB={};Object.defineProperty(GB,"__esModule",{value:!0});GB.default=void 0;var MWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},OWe=MWe;GB.default=OWe;var qB={};Object.defineProperty(qB,"__esModule",{value:!0});qB.default=void 0;var NWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},IWe=NWe;qB.default=IWe;var $B={};Object.defineProperty($B,"__esModule",{value:!0});$B.default=void 0;var kWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},DWe=kWe;$B.default=DWe;var WB={};Object.defineProperty(WB,"__esModule",{value:!0});WB.default=void 0;var PWe={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},LWe=PWe;WB.default=LWe;Object.defineProperty(PB,"__esModule",{value:!0});PB.default=void 0;var UWe=dp(LB),BWe=dp(UB),FWe=dp(BB),zWe=dp(FB),HWe=dp(zB),jWe=dp(HB),VWe=dp(jB),GWe=dp(VB),qWe=dp(GB),$We=dp(qB),WWe=dp($B),YWe=dp(WB);function dp(t){return t&&t.__esModule?t:{default:t}}var XWe=[["command",UWe.default],["composite",BWe.default],["input",FWe.default],["landmark",zWe.default],["range",HWe.default],["roletype",jWe.default],["section",VWe.default],["sectionhead",GWe.default],["select",qWe.default],["structure",$We.default],["widget",WWe.default],["window",YWe.default]],KWe=XWe;PB.default=KWe;var YB={},XB={};Object.defineProperty(XB,"__esModule",{value:!0});XB.default=void 0;var JWe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},ZWe=JWe;XB.default=ZWe;var KB={};Object.defineProperty(KB,"__esModule",{value:!0});KB.default=void 0;var QWe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},e9e=QWe;KB.default=e9e;var JB={};Object.defineProperty(JB,"__esModule",{value:!0});JB.default=void 0;var t9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},n9e=t9e;JB.default=n9e;var ZB={};Object.defineProperty(ZB,"__esModule",{value:!0});ZB.default=void 0;var i9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},r9e=i9e;ZB.default=r9e;var QB={};Object.defineProperty(QB,"__esModule",{value:!0});QB.default=void 0;var s9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},a9e=s9e;QB.default=a9e;var eF={};Object.defineProperty(eF,"__esModule",{value:!0});eF.default=void 0;var o9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"blockquote"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},c9e=o9e;eF.default=c9e;var tF={};Object.defineProperty(tF,"__esModule",{value:!0});tF.default=void 0;var l9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},u9e=l9e;tF.default=u9e;var nF={};Object.defineProperty(nF,"__esModule",{value:!0});nF.default=void 0;var h9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"caption"},module:"HTML"}],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},d9e=h9e;nF.default=d9e;var iF={};Object.defineProperty(iF,"__esModule",{value:!0});iF.default=void 0;var f9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["ancestor table element has table role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},p9e=f9e;iF.default=p9e;var rF={};Object.defineProperty(rF,"__esModule",{value:!0});rF.default=void 0;var m9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},g9e=m9e;rF.default=g9e;var sF={};Object.defineProperty(sF,"__esModule",{value:!0});sF.default=void 0;var v9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"code"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},y9e=v9e;sF.default=y9e;var aF={};Object.defineProperty(aF,"__esModule",{value:!0});aF.default=void 0;var _9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"col"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"colgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},b9e=_9e;aF.default=b9e;var oF={};Object.defineProperty(oF,"__esModule",{value:!0});oF.default=void 0;var E9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],constraints:["the multiple attribute is not set and the size attribute does not have a value greater than 1"],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},S9e=E9e;oF.default=S9e;var cF={};Object.defineProperty(cF,"__esModule",{value:!0});cF.default=void 0;var T9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-label"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},x9e=T9e;cF.default=x9e;var lF={};Object.defineProperty(lF,"__esModule",{value:!0});lF.default=void 0;var w9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},C9e=w9e;lF.default=C9e;var uF={};Object.defineProperty(uF,"__esModule",{value:!0});uF.default=void 0;var R9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},A9e=R9e;uF.default=A9e;var hF={};Object.defineProperty(hF,"__esModule",{value:!0});hF.default=void 0;var M9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"del"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},O9e=M9e;hF.default=O9e;var dF={};Object.defineProperty(dF,"__esModule",{value:!0});dF.default=void 0;var N9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},I9e=N9e;dF.default=I9e;var fF={};Object.defineProperty(fF,"__esModule",{value:!0});fF.default=void 0;var k9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},D9e=k9e;fF.default=D9e;var pF={};Object.defineProperty(pF,"__esModule",{value:!0});pF.default=void 0;var P9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"html"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},L9e=P9e;pF.default=L9e;var mF={};Object.defineProperty(mF,"__esModule",{value:!0});mF.default=void 0;var U9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"em"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},B9e=U9e;mF.default=B9e;var gF={};Object.defineProperty(gF,"__esModule",{value:!0});gF.default=void 0;var F9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},z9e=F9e;gF.default=z9e;var vF={};Object.defineProperty(vF,"__esModule",{value:!0});vF.default=void 0;var H9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},j9e=H9e;vF.default=j9e;var yF={};Object.defineProperty(yF,"__esModule",{value:!0});yF.default=void 0;var V9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},G9e=V9e;yF.default=G9e;var _F={};Object.defineProperty(_F,"__esModule",{value:!0});_F.default=void 0;var q9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"a"},module:"HTML"},{concept:{name:"area"},module:"HTML"},{concept:{name:"aside"},module:"HTML"},{concept:{name:"b"},module:"HTML"},{concept:{name:"bdo"},module:"HTML"},{concept:{name:"body"},module:"HTML"},{concept:{name:"data"},module:"HTML"},{concept:{name:"div"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"footer"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"header"},module:"HTML"},{concept:{name:"hgroup"},module:"HTML"},{concept:{name:"i"},module:"HTML"},{concept:{name:"pre"},module:"HTML"},{concept:{name:"q"},module:"HTML"},{concept:{name:"samp"},module:"HTML"},{concept:{name:"section"},module:"HTML"},{concept:{name:"small"},module:"HTML"},{concept:{name:"span"},module:"HTML"},{concept:{name:"u"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},$9e=q9e;_F.default=$9e;var bF={};Object.defineProperty(bF,"__esModule",{value:!0});bF.default=void 0;var W9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},Y9e=W9e;bF.default=Y9e;var EF={};Object.defineProperty(EF,"__esModule",{value:!0});EF.default=void 0;var X9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{constraints:["ancestor table element has grid role","ancestor table element has treegrid role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},K9e=X9e;EF.default=K9e;var SF={};Object.defineProperty(SF,"__esModule",{value:!0});SF.default=void 0;var J9e={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"},{concept:{name:"address"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},Z9e=J9e;SF.default=Z9e;var TF={};Object.defineProperty(TF,"__esModule",{value:!0});TF.default=void 0;var Q9e={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},eYe=Q9e;TF.default=eYe;var xF={};Object.defineProperty(xF,"__esModule",{value:!0});xF.default=void 0;var tYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},nYe=tYe;xF.default=nYe;var wF={};Object.defineProperty(wF,"__esModule",{value:!0});wF.default=void 0;var iYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"ins"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},rYe=iYe;wF.default=rYe;var CF={};Object.defineProperty(CF,"__esModule",{value:!0});CF.default=void 0;var sYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"href"}],name:"area"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},aYe=sYe;CF.default=aYe;var RF={};Object.defineProperty(RF,"__esModule",{value:!0});RF.default=void 0;var oYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},cYe=oYe;RF.default=cYe;var AF={};Object.defineProperty(AF,"__esModule",{value:!0});AF.default=void 0;var lYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"}],constraints:["the size attribute value is greater than 1"],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},uYe=lYe;AF.default=uYe;var MF={};Object.defineProperty(MF,"__esModule",{value:!0});MF.default=void 0;var hYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol","direct descendant of ul","direct descendant of menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},dYe=hYe;MF.default=dYe;var OF={};Object.defineProperty(OF,"__esModule",{value:!0});OF.default=void 0;var fYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},pYe=fYe;OF.default=pYe;var NF={};Object.defineProperty(NF,"__esModule",{value:!0});NF.default=void 0;var mYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},gYe=mYe;NF.default=gYe;var IF={};Object.defineProperty(IF,"__esModule",{value:!0});IF.default=void 0;var vYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:[],props:{"aria-braillelabel":null,"aria-brailleroledescription":null,"aria-description":null},relatedConcepts:[{concept:{name:"mark"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},yYe=vYe;IF.default=yYe;var kF={};Object.defineProperty(kF,"__esModule",{value:!0});kF.default=void 0;var _Ye={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},bYe=_Ye;kF.default=bYe;var DF={};Object.defineProperty(DF,"__esModule",{value:!0});DF.default=void 0;var EYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},SYe=EYe;DF.default=SYe;var PF={};Object.defineProperty(PF,"__esModule",{value:!0});PF.default=void 0;var TYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},xYe=TYe;PF.default=xYe;var LF={};Object.defineProperty(LF,"__esModule",{value:!0});LF.default=void 0;var wYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},CYe=wYe;LF.default=CYe;var UF={};Object.defineProperty(UF,"__esModule",{value:!0});UF.default=void 0;var RYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},AYe=RYe;UF.default=AYe;var BF={};Object.defineProperty(BF,"__esModule",{value:!0});BF.default=void 0;var MYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},OYe=MYe;BF.default=OYe;var FF={};Object.defineProperty(FF,"__esModule",{value:!0});FF.default=void 0;var NYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},IYe=NYe;FF.default=IYe;var zF={};Object.defineProperty(zF,"__esModule",{value:!0});zF.default=void 0;var kYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"meter"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},DYe=kYe;zF.default=DYe;var HF={};Object.defineProperty(HF,"__esModule",{value:!0});HF.default=void 0;var PYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},LYe=PYe;HF.default=LYe;var jF={};Object.defineProperty(jF,"__esModule",{value:!0});jF.default=void 0;var UYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},BYe=UYe;jF.default=BYe;var VF={};Object.defineProperty(VF,"__esModule",{value:!0});VF.default=void 0;var FYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},zYe=FYe;VF.default=zYe;var GF={};Object.defineProperty(GF,"__esModule",{value:!0});GF.default=void 0;var HYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},jYe=HYe;GF.default=jYe;var qF={};Object.defineProperty(qF,"__esModule",{value:!0});qF.default=void 0;var VYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"p"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},GYe=VYe;qF.default=GYe;var $F={};Object.defineProperty($F,"__esModule",{value:!0});$F.default=void 0;var qYe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{attributes:[{name:"alt",value:""}],name:"img"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},$Ye=qYe;$F.default=$Ye;var WF={};Object.defineProperty(WF,"__esModule",{value:!0});WF.default=void 0;var WYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},YYe=WYe;WF.default=YYe;var YF={};Object.defineProperty(YF,"__esModule",{value:!0});YF.default=void 0;var XYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},KYe=XYe;YF.default=KYe;var XF={};Object.defineProperty(XF,"__esModule",{value:!0});XF.default=void 0;var JYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},ZYe=JYe;XF.default=ZYe;var KF={};Object.defineProperty(KF,"__esModule",{value:!0});KF.default=void 0;var QYe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},eXe=QYe;KF.default=eXe;var JF={};Object.defineProperty(JF,"__esModule",{value:!0});JF.default=void 0;var tXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},nXe=tXe;JF.default=nXe;var ZF={};Object.defineProperty(ZF,"__esModule",{value:!0});ZF.default=void 0;var iXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},rXe=iXe;ZF.default=rXe;var QF={};Object.defineProperty(QF,"__esModule",{value:!0});QF.default=void 0;var sXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},aXe=sXe;QF.default=aXe;var e4={};Object.defineProperty(e4,"__esModule",{value:!0});e4.default=void 0;var oXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},cXe=oXe;e4.default=cXe;var t4={};Object.defineProperty(t4,"__esModule",{value:!0});t4.default=void 0;var lXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},uXe=lXe;t4.default=uXe;var n4={};Object.defineProperty(n4,"__esModule",{value:!0});n4.default=void 0;var hXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},dXe=hXe;n4.default=dXe;var i4={};Object.defineProperty(i4,"__esModule",{value:!0});i4.default=void 0;var fXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},pXe=fXe;i4.default=pXe;var r4={};Object.defineProperty(r4,"__esModule",{value:!0});r4.default=void 0;var mXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},gXe=mXe;r4.default=gXe;var s4={};Object.defineProperty(s4,"__esModule",{value:!0});s4.default=void 0;var vXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},yXe=vXe;s4.default=yXe;var a4={};Object.defineProperty(a4,"__esModule",{value:!0});a4.default=void 0;var _Xe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},bXe=_Xe;a4.default=bXe;var o4={};Object.defineProperty(o4,"__esModule",{value:!0});o4.default=void 0;var EXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"strong"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},SXe=EXe;o4.default=SXe;var c4={};Object.defineProperty(c4,"__esModule",{value:!0});c4.default=void 0;var TXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sub"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},xXe=TXe;c4.default=xXe;var l4={};Object.defineProperty(l4,"__esModule",{value:!0});l4.default=void 0;var wXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},CXe=wXe;l4.default=CXe;var u4={};Object.defineProperty(u4,"__esModule",{value:!0});u4.default=void 0;var RXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},AXe=RXe;u4.default=AXe;var h4={};Object.defineProperty(h4,"__esModule",{value:!0});h4.default=void 0;var MXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},OXe=MXe;h4.default=OXe;var d4={};Object.defineProperty(d4,"__esModule",{value:!0});d4.default=void 0;var NXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},IXe=NXe;d4.default=IXe;var f4={};Object.defineProperty(f4,"__esModule",{value:!0});f4.default=void 0;var kXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},DXe=kXe;f4.default=DXe;var p4={};Object.defineProperty(p4,"__esModule",{value:!0});p4.default=void 0;var PXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},LXe=PXe;p4.default=LXe;var m4={};Object.defineProperty(m4,"__esModule",{value:!0});m4.default=void 0;var UXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},BXe=UXe;m4.default=BXe;var g4={};Object.defineProperty(g4,"__esModule",{value:!0});g4.default=void 0;var FXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},zXe=FXe;g4.default=zXe;var v4={};Object.defineProperty(v4,"__esModule",{value:!0});v4.default=void 0;var HXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"time"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},jXe=HXe;v4.default=jXe;var y4={};Object.defineProperty(y4,"__esModule",{value:!0});y4.default=void 0;var VXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},GXe=VXe;y4.default=GXe;var _4={};Object.defineProperty(_4,"__esModule",{value:!0});_4.default=void 0;var qXe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},$Xe=qXe;_4.default=$Xe;var b4={};Object.defineProperty(b4,"__esModule",{value:!0});b4.default=void 0;var WXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},YXe=WXe;b4.default=YXe;var E4={};Object.defineProperty(E4,"__esModule",{value:!0});E4.default=void 0;var XXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},KXe=XXe;E4.default=KXe;var S4={};Object.defineProperty(S4,"__esModule",{value:!0});S4.default=void 0;var JXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},ZXe=JXe;S4.default=ZXe;var T4={};Object.defineProperty(T4,"__esModule",{value:!0});T4.default=void 0;var QXe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},eKe=QXe;T4.default=eKe;Object.defineProperty(YB,"__esModule",{value:!0});YB.default=void 0;var tKe=un(XB),nKe=un(KB),iKe=un(JB),rKe=un(ZB),sKe=un(QB),aKe=un(eF),oKe=un(tF),cKe=un(nF),lKe=un(iF),uKe=un(rF),hKe=un(sF),dKe=un(aF),fKe=un(oF),pKe=un(cF),mKe=un(lF),gKe=un(uF),vKe=un(hF),yKe=un(dF),_Ke=un(fF),bKe=un(pF),EKe=un(mF),SKe=un(gF),TKe=un(vF),xKe=un(yF),wKe=un(_F),CKe=un(bF),RKe=un(EF),AKe=un(SF),MKe=un(TF),OKe=un(xF),NKe=un(wF),IKe=un(CF),kKe=un(RF),DKe=un(AF),PKe=un(MF),LKe=un(OF),UKe=un(NF),BKe=un(IF),FKe=un(kF),zKe=un(DF),HKe=un(PF),jKe=un(LF),VKe=un(UF),GKe=un(BF),qKe=un(FF),$Ke=un(zF),WKe=un(HF),YKe=un(jF),XKe=un(VF),KKe=un(GF),JKe=un(qF),ZKe=un($F),QKe=un(WF),eJe=un(YF),tJe=un(XF),nJe=un(KF),iJe=un(JF),rJe=un(ZF),sJe=un(QF),aJe=un(e4),oJe=un(t4),cJe=un(n4),lJe=un(i4),uJe=un(r4),hJe=un(s4),dJe=un(a4),fJe=un(o4),pJe=un(c4),mJe=un(l4),gJe=un(u4),vJe=un(h4),yJe=un(d4),_Je=un(f4),bJe=un(p4),EJe=un(m4),SJe=un(g4),TJe=un(v4),xJe=un(y4),wJe=un(_4),CJe=un(b4),RJe=un(E4),AJe=un(S4),MJe=un(T4);function un(t){return t&&t.__esModule?t:{default:t}}var OJe=[["alert",tKe.default],["alertdialog",nKe.default],["application",iKe.default],["article",rKe.default],["banner",sKe.default],["blockquote",aKe.default],["button",oKe.default],["caption",cKe.default],["cell",lKe.default],["checkbox",uKe.default],["code",hKe.default],["columnheader",dKe.default],["combobox",fKe.default],["complementary",pKe.default],["contentinfo",mKe.default],["definition",gKe.default],["deletion",vKe.default],["dialog",yKe.default],["directory",_Ke.default],["document",bKe.default],["emphasis",EKe.default],["feed",SKe.default],["figure",TKe.default],["form",xKe.default],["generic",wKe.default],["grid",CKe.default],["gridcell",RKe.default],["group",AKe.default],["heading",MKe.default],["img",OKe.default],["insertion",NKe.default],["link",IKe.default],["list",kKe.default],["listbox",DKe.default],["listitem",PKe.default],["log",LKe.default],["main",UKe.default],["mark",BKe.default],["marquee",FKe.default],["math",zKe.default],["menu",HKe.default],["menubar",jKe.default],["menuitem",VKe.default],["menuitemcheckbox",GKe.default],["menuitemradio",qKe.default],["meter",$Ke.default],["navigation",WKe.default],["none",YKe.default],["note",XKe.default],["option",KKe.default],["paragraph",JKe.default],["presentation",ZKe.default],["progressbar",QKe.default],["radio",eJe.default],["radiogroup",tJe.default],["region",nJe.default],["row",iJe.default],["rowgroup",rJe.default],["rowheader",sJe.default],["scrollbar",aJe.default],["search",oJe.default],["searchbox",cJe.default],["separator",lJe.default],["slider",uJe.default],["spinbutton",hJe.default],["status",dJe.default],["strong",fJe.default],["subscript",pJe.default],["superscript",mJe.default],["switch",gJe.default],["tab",vJe.default],["table",yJe.default],["tablist",_Je.default],["tabpanel",bJe.default],["term",EJe.default],["textbox",SJe.default],["time",TJe.default],["timer",xJe.default],["toolbar",wJe.default],["tooltip",CJe.default],["tree",RJe.default],["treegrid",AJe.default],["treeitem",MJe.default]],NJe=OJe;YB.default=NJe;var x4={},w4={};Object.defineProperty(w4,"__esModule",{value:!0});w4.default=void 0;var IJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},kJe=IJe;w4.default=kJe;var C4={};Object.defineProperty(C4,"__esModule",{value:!0});C4.default=void 0;var DJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},PJe=DJe;C4.default=PJe;var R4={};Object.defineProperty(R4,"__esModule",{value:!0});R4.default=void 0;var LJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},UJe=LJe;R4.default=UJe;var A4={};Object.defineProperty(A4,"__esModule",{value:!0});A4.default=void 0;var BJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},FJe=BJe;A4.default=FJe;var M4={};Object.defineProperty(M4,"__esModule",{value:!0});M4.default=void 0;var zJe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},HJe=zJe;M4.default=HJe;var O4={};Object.defineProperty(O4,"__esModule",{value:!0});O4.default=void 0;var jJe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},VJe=jJe;O4.default=VJe;var N4={};Object.defineProperty(N4,"__esModule",{value:!0});N4.default=void 0;var GJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},qJe=GJe;N4.default=qJe;var I4={};Object.defineProperty(I4,"__esModule",{value:!0});I4.default=void 0;var $Je={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},WJe=$Je;I4.default=WJe;var k4={};Object.defineProperty(k4,"__esModule",{value:!0});k4.default=void 0;var YJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},XJe=YJe;k4.default=XJe;var D4={};Object.defineProperty(D4,"__esModule",{value:!0});D4.default=void 0;var KJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},JJe=KJe;D4.default=JJe;var P4={};Object.defineProperty(P4,"__esModule",{value:!0});P4.default=void 0;var ZJe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},QJe=ZJe;P4.default=QJe;var L4={};Object.defineProperty(L4,"__esModule",{value:!0});L4.default=void 0;var eZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},tZe=eZe;L4.default=tZe;var U4={};Object.defineProperty(U4,"__esModule",{value:!0});U4.default=void 0;var nZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},iZe=nZe;U4.default=iZe;var B4={};Object.defineProperty(B4,"__esModule",{value:!0});B4.default=void 0;var rZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},sZe=rZe;B4.default=sZe;var F4={};Object.defineProperty(F4,"__esModule",{value:!0});F4.default=void 0;var aZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},oZe=aZe;F4.default=oZe;var z4={};Object.defineProperty(z4,"__esModule",{value:!0});z4.default=void 0;var cZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},lZe=cZe;z4.default=lZe;var H4={};Object.defineProperty(H4,"__esModule",{value:!0});H4.default=void 0;var uZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},hZe=uZe;H4.default=hZe;var j4={};Object.defineProperty(j4,"__esModule",{value:!0});j4.default=void 0;var dZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},fZe=dZe;j4.default=fZe;var V4={};Object.defineProperty(V4,"__esModule",{value:!0});V4.default=void 0;var pZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},mZe=pZe;V4.default=mZe;var G4={};Object.defineProperty(G4,"__esModule",{value:!0});G4.default=void 0;var gZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},vZe=gZe;G4.default=vZe;var q4={};Object.defineProperty(q4,"__esModule",{value:!0});q4.default=void 0;var yZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},_Ze=yZe;q4.default=_Ze;var $4={};Object.defineProperty($4,"__esModule",{value:!0});$4.default=void 0;var bZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},EZe=bZe;$4.default=EZe;var W4={};Object.defineProperty(W4,"__esModule",{value:!0});W4.default=void 0;var SZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},TZe=SZe;W4.default=TZe;var Y4={};Object.defineProperty(Y4,"__esModule",{value:!0});Y4.default=void 0;var xZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},wZe=xZe;Y4.default=wZe;var X4={};Object.defineProperty(X4,"__esModule",{value:!0});X4.default=void 0;var CZe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},RZe=CZe;X4.default=RZe;var K4={};Object.defineProperty(K4,"__esModule",{value:!0});K4.default=void 0;var AZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},MZe=AZe;K4.default=MZe;var J4={};Object.defineProperty(J4,"__esModule",{value:!0});J4.default=void 0;var OZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},NZe=OZe;J4.default=NZe;var Z4={};Object.defineProperty(Z4,"__esModule",{value:!0});Z4.default=void 0;var IZe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},kZe=IZe;Z4.default=kZe;var Q4={};Object.defineProperty(Q4,"__esModule",{value:!0});Q4.default=void 0;var DZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},PZe=DZe;Q4.default=PZe;var e6={};Object.defineProperty(e6,"__esModule",{value:!0});e6.default=void 0;var LZe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},UZe=LZe;e6.default=UZe;var t6={};Object.defineProperty(t6,"__esModule",{value:!0});t6.default=void 0;var BZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},FZe=BZe;t6.default=FZe;var n6={};Object.defineProperty(n6,"__esModule",{value:!0});n6.default=void 0;var zZe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},HZe=zZe;n6.default=HZe;var i6={};Object.defineProperty(i6,"__esModule",{value:!0});i6.default=void 0;var jZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},VZe=jZe;i6.default=VZe;var r6={};Object.defineProperty(r6,"__esModule",{value:!0});r6.default=void 0;var GZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},qZe=GZe;r6.default=qZe;var s6={};Object.defineProperty(s6,"__esModule",{value:!0});s6.default=void 0;var $Ze={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},WZe=$Ze;s6.default=WZe;var a6={};Object.defineProperty(a6,"__esModule",{value:!0});a6.default=void 0;var YZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},XZe=YZe;a6.default=XZe;var o6={};Object.defineProperty(o6,"__esModule",{value:!0});o6.default=void 0;var KZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},JZe=KZe;o6.default=JZe;var c6={};Object.defineProperty(c6,"__esModule",{value:!0});c6.default=void 0;var ZZe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},QZe=ZZe;c6.default=QZe;var l6={};Object.defineProperty(l6,"__esModule",{value:!0});l6.default=void 0;var eQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},tQe=eQe;l6.default=tQe;Object.defineProperty(x4,"__esModule",{value:!0});x4.default=void 0;var nQe=_r(w4),iQe=_r(C4),rQe=_r(R4),sQe=_r(A4),aQe=_r(M4),oQe=_r(O4),cQe=_r(N4),lQe=_r(I4),uQe=_r(k4),hQe=_r(D4),dQe=_r(P4),fQe=_r(L4),pQe=_r(U4),mQe=_r(B4),gQe=_r(F4),vQe=_r(z4),yQe=_r(H4),_Qe=_r(j4),bQe=_r(V4),EQe=_r(G4),SQe=_r(q4),TQe=_r($4),xQe=_r(W4),wQe=_r(Y4),CQe=_r(X4),RQe=_r(K4),AQe=_r(J4),MQe=_r(Z4),OQe=_r(Q4),NQe=_r(e6),IQe=_r(t6),kQe=_r(n6),DQe=_r(i6),PQe=_r(r6),LQe=_r(s6),UQe=_r(a6),BQe=_r(o6),FQe=_r(c6),zQe=_r(l6);function _r(t){return t&&t.__esModule?t:{default:t}}var HQe=[["doc-abstract",nQe.default],["doc-acknowledgments",iQe.default],["doc-afterword",rQe.default],["doc-appendix",sQe.default],["doc-backlink",aQe.default],["doc-biblioentry",oQe.default],["doc-bibliography",cQe.default],["doc-biblioref",lQe.default],["doc-chapter",uQe.default],["doc-colophon",hQe.default],["doc-conclusion",dQe.default],["doc-cover",fQe.default],["doc-credit",pQe.default],["doc-credits",mQe.default],["doc-dedication",gQe.default],["doc-endnote",vQe.default],["doc-endnotes",yQe.default],["doc-epigraph",_Qe.default],["doc-epilogue",bQe.default],["doc-errata",EQe.default],["doc-example",SQe.default],["doc-footnote",TQe.default],["doc-foreword",xQe.default],["doc-glossary",wQe.default],["doc-glossref",CQe.default],["doc-index",RQe.default],["doc-introduction",AQe.default],["doc-noteref",MQe.default],["doc-notice",OQe.default],["doc-pagebreak",NQe.default],["doc-pagelist",IQe.default],["doc-part",kQe.default],["doc-preface",DQe.default],["doc-prologue",PQe.default],["doc-pullquote",LQe.default],["doc-qna",UQe.default],["doc-subtitle",BQe.default],["doc-tip",FQe.default],["doc-toc",zQe.default]],jQe=HQe;x4.default=jQe;var u6={},h6={};Object.defineProperty(h6,"__esModule",{value:!0});h6.default=void 0;var VQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},GQe=VQe;h6.default=GQe;var d6={};Object.defineProperty(d6,"__esModule",{value:!0});d6.default=void 0;var qQe={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},$Qe=qQe;d6.default=$Qe;var f6={};Object.defineProperty(f6,"__esModule",{value:!0});f6.default=void 0;var WQe={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},YQe=WQe;f6.default=YQe;Object.defineProperty(u6,"__esModule",{value:!0});u6.default=void 0;var XQe=p9(h6),KQe=p9(d6),JQe=p9(f6);function p9(t){return t&&t.__esModule?t:{default:t}}var ZQe=[["graphics-document",XQe.default],["graphics-object",KQe.default],["graphics-symbol",JQe.default]],QQe=ZQe;u6.default=QQe;Object.defineProperty(eR,"__esModule",{value:!0});eR.default=void 0;var eet=rI(PB),tet=rI(YB),net=rI(x4),iet=rI(u6),ret=rI(KT);function rI(t){return t&&t.__esModule?t:{default:t}}function set(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jV(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=nge(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function iM(t,e){return cet(t)||oet(t,e)||nge(t,e)||aet()}function aet(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nge(t,e){if(t){if(typeof t=="string")return Ste(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ste(t,e)}}function Ste(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function oet(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function cet(t){if(Array.isArray(t))return t}var O_=[].concat(eet.default,tet.default,net.default,iet.default);O_.forEach(function(t){var e=iM(t,2),n=e[1],i=jV(n.superClass),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=jV(s),o;try{var c=function(){var u=o.value,h=O_.find(function(_){var v=iM(_,1),E=v[0];return E===u});if(h)for(var d=h[1],f=0,p=Object.keys(d.props);f<p.length;f++){var g=p[f];Object.prototype.hasOwnProperty.call(n.props,g)||Object.assign(n.props,set({},g,d.props[g]))}};for(a.s();!(o=a.n()).done;)c()}catch(l){a.e(l)}finally{a.f()}}}catch(l){i.e(l)}finally{i.f()}});var VV={entries:function(){return O_},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=jV(O_),r;try{for(i.s();!(r=i.n()).done;){var s=iM(r.value,2),a=s[0],o=s[1];e.call(n,o,a,O_)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=O_.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!VV.get(e)},keys:function(){return O_.map(function(e){var n=iM(e,1),i=n[0];return i})},values:function(){return O_.map(function(e){var n=iM(e,2),i=n[1];return i})}},uet=(0,ret.default)(VV,VV.entries());eR.default=uet;var p6={},ige={},Tte=Object.prototype.hasOwnProperty;function GV(t,e){var n,i;if(t===e)return!0;if(t&&e&&(n=t.constructor)===e.constructor){if(n===Date)return t.getTime()===e.getTime();if(n===RegExp)return t.toString()===e.toString();if(n===Array){if((i=t.length)===e.length)for(;i--&&GV(t[i],e[i]););return i===-1}if(!n||typeof t=="object"){i=0;for(n in t)if(Tte.call(t,n)&&++i&&!Tte.call(e,n)||!(n in e)||!GV(t[n],e[n]))return!1;return Object.keys(e).length===i}}return t!==t&&e!==e}ige.dequal=GV;Object.defineProperty(p6,"__esModule",{value:!0});p6.default=void 0;var rge=ige,het=age(KT),sge=age(eR);function age(t){return t&&t.__esModule?t:{default:t}}function SH(t,e){return pet(t)||fet(t,e)||oge(t,e)||det()}function det(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fet(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function pet(t){if(Array.isArray(t))return t}function met(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=oge(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function oge(t,e){if(t){if(typeof t=="string")return xte(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xte(t,e)}}function xte(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var N_=[],wte=sge.default.keys();for(var TH=0;TH<wte.length;TH++){var xH=wte[TH],wH=sge.default.get(xH);if(wH)for(var Cte=[].concat(wH.baseConcepts,wH.relatedConcepts),CH=0;CH<Cte.length;CH++){var Rte=Cte[CH];Rte.module==="HTML"&&function(){var t=Rte.concept;if(t){var e=N_.find(function(s){return(0,rge.dequal)(s,t)}),n;e?n=e[1]:n=[];for(var i=!0,r=0;r<n.length;r++)if(n[r]===xH){i=!1;break}i&&n.push(xH),N_.push([t,n])}}()}}var qV={entries:function(){return N_},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=met(N_),r;try{for(i.s();!(r=i.n()).done;){var s=SH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,N_)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=N_.find(function(i){return e.name===i[0].name&&(0,rge.dequal)(e.attributes,i[0].attributes)});return n&&n[1]},has:function(e){return!!qV.get(e)},keys:function(){return N_.map(function(e){var n=SH(e,1),i=n[0];return i})},values:function(){return N_.map(function(e){var n=SH(e,2),i=n[1];return i})}},get=(0,het.default)(qV,qV.entries());p6.default=get;var m6={};Object.defineProperty(m6,"__esModule",{value:!0});m6.default=void 0;var vet=lge(KT),cge=lge(eR);function lge(t){return t&&t.__esModule?t:{default:t}}function RH(t,e){return bet(t)||_et(t,e)||uge(t,e)||yet()}function yet(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _et(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i=[],r=!0,s=!1,a,o;try{for(n=n.call(t);!(r=(a=n.next()).done)&&(i.push(a.value),!(e&&i.length===e));r=!0);}catch(c){s=!0,o=c}finally{try{!r&&n.return!=null&&n.return()}finally{if(s)throw o}}return i}}function bet(t){if(Array.isArray(t))return t}function Eet(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=uge(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return s=l.done,l},e:function(l){a=!0,o=l},f:function(){try{!s&&n.return!=null&&n.return()}finally{if(a)throw o}}}}function uge(t,e){if(t){if(typeof t=="string")return Ate(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ate(t,e)}}function Ate(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var SS=[],Mte=cge.default.keys();for(var AH=0;AH<Mte.length;AH++){var Ote=Mte[AH],MH=cge.default.get(Ote),OH=[];if(MH){for(var Nte=[].concat(MH.baseConcepts,MH.relatedConcepts),NH=0;NH<Nte.length;NH++){var Ite=Nte[NH];if(Ite.module==="HTML"){var kte=Ite.concept;kte!=null&&OH.push(kte)}}OH.length>0&&SS.push([Ote,OH])}}var $V={entries:function(){return SS},forEach:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=Eet(SS),r;try{for(i.s();!(r=i.n()).done;){var s=RH(r.value,2),a=s[0],o=s[1];e.call(n,o,a,SS)}}catch(c){i.e(c)}finally{i.f()}},get:function(e){var n=SS.find(function(i){return i[0]===e});return n&&n[1]},has:function(e){return!!$V.get(e)},keys:function(){return SS.map(function(e){var n=RH(e,1),i=n[0];return i})},values:function(){return SS.map(function(e){var n=RH(e,2),i=n[1];return i})}},Tet=(0,vet.default)($V,$V.entries());m6.default=Tet;Object.defineProperty(Wp,"__esModule",{value:!0});var Up=Wp.roles=dge=Wp.roleElements=hge=Wp.elementRoles=Wp.dom=Wp.aria=void 0,xet=sI(IB),wet=sI(DB),Cet=sI(eR),Ret=sI(p6),Aet=sI(m6);function sI(t){return t&&t.__esModule?t:{default:t}}var Met=xet.default;Wp.aria=Met;var Oet=wet.default;Wp.dom=Oet;var Net=Cet.default;Up=Wp.roles=Net;var Iet=Ret.default,hge=Wp.elementRoles=Iet,ket=Aet.default,dge=Wp.roleElements=ket,m9={exports:{}};m9.exports;(function(t){var e=function(){var n=String.fromCharCode,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(c,l){if(!s[c]){s[c]={};for(var u=0;u<c.length;u++)s[c][c.charAt(u)]=u}return s[c][l]}var o={compressToBase64:function(c){if(c==null)return"";var l=o._compress(c,6,function(u){return i.charAt(u)});switch(l.length%4){default:case 0:return l;case 1:return l+"===";case 2:return l+"==";case 3:return l+"="}},decompressFromBase64:function(c){return c==null?"":c==""?null:o._decompress(c.length,32,function(l){return a(i,c.charAt(l))})},compressToUTF16:function(c){return c==null?"":o._compress(c,15,function(l){return n(l+32)})+" "},decompressFromUTF16:function(c){return c==null?"":c==""?null:o._decompress(c.length,16384,function(l){return c.charCodeAt(l)-32})},compressToUint8Array:function(c){for(var l=o.compress(c),u=new Uint8Array(l.length*2),h=0,d=l.length;h<d;h++){var f=l.charCodeAt(h);u[h*2]=f>>>8,u[h*2+1]=f%256}return u},decompressFromUint8Array:function(c){if(c==null)return o.decompress(c);for(var l=new Array(c.length/2),u=0,h=l.length;u<h;u++)l[u]=c[u*2]*256+c[u*2+1];var d=[];return l.forEach(function(f){d.push(n(f))}),o.decompress(d.join(""))},compressToEncodedURIComponent:function(c){return c==null?"":o._compress(c,6,function(l){return r.charAt(l)})},decompressFromEncodedURIComponent:function(c){return c==null?"":c==""?null:(c=c.replace(/ /g,"+"),o._decompress(c.length,32,function(l){return a(r,c.charAt(l))}))},compress:function(c){return o._compress(c,16,function(l){return n(l)})},_compress:function(c,l,u){if(c==null)return"";var h,d,f={},p={},g="",_="",v="",E=2,T=3,x=2,N=[],A=0,I=0,k;for(k=0;k<c.length;k+=1)if(g=c.charAt(k),Object.prototype.hasOwnProperty.call(f,g)||(f[g]=T++,p[g]=!0),_=v+g,Object.prototype.hasOwnProperty.call(f,_))v=_;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)A=A<<1,I==l-1?(I=0,N.push(u(A)),A=0):I++;for(d=v.charCodeAt(0),h=0;h<8;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1}else{for(d=1,h=0;h<x;h++)A=A<<1|d,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=0;for(d=v.charCodeAt(0),h=0;h<16;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1}E--,E==0&&(E=Math.pow(2,x),x++),delete p[v]}else for(d=f[v],h=0;h<x;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1;E--,E==0&&(E=Math.pow(2,x),x++),f[_]=T++,v=String(g)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(h=0;h<x;h++)A=A<<1,I==l-1?(I=0,N.push(u(A)),A=0):I++;for(d=v.charCodeAt(0),h=0;h<8;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1}else{for(d=1,h=0;h<x;h++)A=A<<1|d,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=0;for(d=v.charCodeAt(0),h=0;h<16;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1}E--,E==0&&(E=Math.pow(2,x),x++),delete p[v]}else for(d=f[v],h=0;h<x;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1;E--,E==0&&(E=Math.pow(2,x),x++)}for(d=2,h=0;h<x;h++)A=A<<1|d&1,I==l-1?(I=0,N.push(u(A)),A=0):I++,d=d>>1;for(;;)if(A=A<<1,I==l-1){N.push(u(A));break}else I++;return N.join("")},decompress:function(c){return c==null?"":c==""?null:o._decompress(c.length,32768,function(l){return c.charCodeAt(l)})},_decompress:function(c,l,u){var h=[],d=4,f=4,p=3,g="",_=[],v,E,T,x,N,A,I,k={val:u(0),position:l,index:1};for(v=0;v<3;v+=1)h[v]=v;for(T=0,N=Math.pow(2,2),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;switch(T){case 0:for(T=0,N=Math.pow(2,8),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;I=n(T);break;case 1:for(T=0,N=Math.pow(2,16),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;I=n(T);break;case 2:return""}for(h[3]=I,E=I,_.push(I);;){if(k.index>c)return"";for(T=0,N=Math.pow(2,p),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;switch(I=T){case 0:for(T=0,N=Math.pow(2,8),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;h[f++]=n(T),I=f-1,d--;break;case 1:for(T=0,N=Math.pow(2,16),A=1;A!=N;)x=k.val&k.position,k.position>>=1,k.position==0&&(k.position=l,k.val=u(k.index++)),T|=(x>0?1:0)*A,A<<=1;h[f++]=n(T),I=f-1,d--;break;case 2:return _.join("")}if(d==0&&(d=Math.pow(2,p),p++),h[I])g=h[I];else if(I===f)g=E+E.charAt(0);else return null;_.push(g),h[f++]=E+g.charAt(0),d--,E=g,d==0&&(d=Math.pow(2,p),p++)}}};return o}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(m9);var Det=m9.exports;const Pet=Gc(Det);var WV={};function fge(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const Let=(t,e,n,i,r,s,a)=>{const o=i+n.indent,c=n.colors;return t.map(l=>{const u=e[l];let h=a(u,n,o,r,s);return typeof u!="string"&&(h.indexOf(`
`)!==-1&&(h=n.spacingOuter+o+h+n.spacingOuter+i),h="{"+h+"}"),n.spacingInner+i+c.prop.open+l+c.prop.close+"="+c.value.open+h+c.value.close}).join("")},Uet=3,Bet=(t,e,n,i,r,s)=>t.map(a=>{const o=typeof a=="string"?pge(a,e):s(a,e,n,i,r);return o===""&&typeof a=="object"&&a!==null&&a.nodeType!==Uet?"":e.spacingOuter+n+o}).join(""),pge=(t,e)=>{const n=e.colors.content;return n.open+fge(t)+n.close},Fet=(t,e)=>{const n=e.colors.comment;return n.open+"<!--"+fge(t)+"-->"+n.close},zet=(t,e,n,i,r)=>{const s=i.colors.tag;return s.open+"<"+t+(e&&s.close+e+i.spacingOuter+r+s.open)+(n?">"+s.close+n+i.spacingOuter+r+s.open+"</"+t:(e&&!i.min?"":" ")+"/")+">"+s.close},Het=(t,e)=>{const n=e.colors.tag;return n.open+"<"+t+n.close+" "+n.open+" />"+n.close},jet=1,mge=3,gge=8,vge=11,Vet=/^((HTML|SVG)\w*)?Element$/,yge=t=>{const{tagName:e}=t;return!!(typeof e=="string"&&e.includes("-")||typeof t.hasAttribute=="function"&&t.hasAttribute("is"))},Get=t=>{const e=t.constructor.name,{nodeType:n}=t;return n===jet&&(Vet.test(e)||yge(t))||n===mge&&e==="Text"||n===gge&&e==="Comment"||n===vge&&e==="DocumentFragment"};function qet(t){return t.nodeType===mge}function $et(t){return t.nodeType===gge}function IH(t){return t.nodeType===vge}function Wet(t){return{test:e=>{var n;return((e==null||(n=e.constructor)==null?void 0:n.name)||yge(e))&&Get(e)},serialize:(e,n,i,r,s,a)=>{if(qet(e))return pge(e.data,n);if($et(e))return Fet(e.data,n);const o=IH(e)?"DocumentFragment":e.tagName.toLowerCase();return++r>n.maxDepth?Het(o,n):zet(o,Let(IH(e)?[]:Array.from(e.attributes).map(c=>c.name).sort(),IH(e)?{}:Array.from(e.attributes).reduce((c,l)=>(c[l.name]=l.value,c),{}),n,i+n.indent,r,s,a),Bet(Array.prototype.slice.call(e.childNodes||e.children).filter(t),n,i+n.indent,r,s,a),n,i)}}}let _ge=null,g9=null,v9=null;try{const t=module&&module.require;g9=t.call(module,"fs").readFileSync,v9=t.call(module,"@babel/code-frame").codeFrameColumns,_ge=t.call(module,"chalk")}catch{}function Yet(t){const e=t.indexOf("(")+1,n=t.indexOf(")"),i=t.slice(e,n),r=i.split(":"),[s,a,o]=[r[0],parseInt(r[1],10),parseInt(r[2],10)];let c="";try{c=g9(s,"utf-8")}catch{return""}const l=v9(c,{start:{line:a,column:o}},{highlightCode:!0,linesBelow:0});return _ge.dim(i)+`
`+l+`
`}function Xet(){if(!g9||!v9)return"";const e=new Error().stack.split(`
`).slice(1).find(n=>!n.includes("node_modules/"));return Yet(e)}const bge=3;function kH(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function y9(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function Ket(t){if(t.defaultView)return t.defaultView;if(t.ownerDocument&&t.ownerDocument.defaultView)return t.ownerDocument.defaultView;if(t.window)return t.window;throw t.ownerDocument&&t.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):t.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(t)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof t.debug=="function"&&typeof t.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof t+".")}function _y(t){if(!t||typeof t.querySelector!="function"||typeof t.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+e(t)+".");function e(n){return typeof n=="object"?n===null?"null":n.constructor.name:typeof n}}const Jet=()=>{if(typeof zn>"u")return!1;let t;try{var e;const n=(e=WV)==null?void 0:e.COLORS;n&&(t=JSON.parse(n))}catch{}return typeof t=="boolean"?t:zn.versions!==void 0&&zn.versions.node!==void 0},{DOMCollection:Zet}=Dme,Qet=1,ett=8;function ttt(t){return t.nodeType!==ett&&(t.nodeType!==Qet||!t.matches(as().defaultIgnore))}function rU(t,e,n){if(n===void 0&&(n={}),t||(t=y9().body),typeof e!="number"&&(e=typeof zn<"u"&&typeof WV<"u"&&WV.DEBUG_PRINT_LIMIT||7e3),e===0)return"";t.documentElement&&(t=t.documentElement);let i=typeof t;if(i==="object"?i=t.constructor.name:t={},!("outerHTML"in t))throw new TypeError("Expected an element or document but got "+i);const{filterNode:r=ttt,...s}=n,a=k$e(t,{plugins:[Wet(r),Zet],printFunctionName:!1,highlight:Jet(),...s});return e!==void 0&&t.outerHTML.length>e?a.slice(0,e)+"...":a}const Dte=function(){const t=Xet();console.log(t?rU(...arguments)+`

`+t:rU(...arguments))};let sU={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:t=>t(),unstable_advanceTimersWrapper:t=>t(),eventWrapper:t=>t(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(t,e){const n=rU(e),i=new Error([t,"Ignored nodes: comments, "+sU.defaultIgnore+`
`+n].filter(Boolean).join(`

`));return i.name="TestingLibraryElementError",i},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function ntt(t){try{return sU._disableExpensiveErrorDiagnostics=!0,t()}finally{sU._disableExpensiveErrorDiagnostics=!1}}function as(){return sU}const itt=["button","meter","output","progress","select","textarea","input"];function Ege(t){return itt.includes(t.nodeName.toLowerCase())?"":t.nodeType===bge?t.textContent:Array.from(t.childNodes).map(e=>Ege(e)).join("")}function YV(t){let e;return t.tagName.toLowerCase()==="label"?e=Ege(t):e=t.value||t.textContent,e}function Sge(t){if(t.labels!==void 0){var e;return(e=t.labels)!=null?e:[]}if(!rtt(t))return[];const n=t.ownerDocument.querySelectorAll("label");return Array.from(n).filter(i=>i.control===t)}function rtt(t){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(t.tagName)||t.tagName==="INPUT"&&t.getAttribute("type")!=="hidden"}function Tge(t,e,n){let{selector:i="*"}=n===void 0?{}:n;const r=e.getAttribute("aria-labelledby"),s=r?r.split(" "):[];return s.length?s.map(a=>{const o=t.querySelector('[id="'+a+'"]');return o?{content:YV(o),formControl:null}:{content:"",formControl:null}}):Array.from(Sge(e)).map(a=>{const o=YV(a),l=Array.from(a.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter(u=>u.matches(i))[0];return{content:o,formControl:l}})}function xge(t){if(t==null)throw new Error("It looks like "+t+" was passed instead of a matcher. Did you do something like getByText("+t+")?")}function tR(t,e,n,i){if(typeof t!="string")return!1;xge(n);const r=i(t);return typeof n=="string"||typeof n=="number"?r.toLowerCase().includes(n.toString().toLowerCase()):typeof n=="function"?n(r,e):Cge(n,r)}function $v(t,e,n,i){if(typeof t!="string")return!1;xge(n);const r=i(t);return n instanceof Function?n(r,e):n instanceof RegExp?Cge(n,r):r===String(n)}function wge(t){let{trim:e=!0,collapseWhitespace:n=!0}=t===void 0?{}:t;return i=>{let r=i;return r=e?r.trim():r,r=n?r.replace(/\s+/g," "):r,r}}function JT(t){let{trim:e,collapseWhitespace:n,normalizer:i}=t;if(!i)return wge({trim:e,collapseWhitespace:n});if(typeof e<"u"||typeof n<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return i}function Cge(t,e){const n=t.test(e);return t.global&&t.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),t.lastIndex=0),n}function g6(t){return t.matches("input[type=submit], input[type=button], input[type=reset]")?t.value:Array.from(t.childNodes).filter(e=>e.nodeType===bge&&!!e.textContent).map(e=>e.textContent).join("")}const stt=att(hge);function Rge(t){return t.hidden===!0||t.getAttribute("aria-hidden")==="true"||t.ownerDocument.defaultView.getComputedStyle(t).display==="none"}function _9(t,e){e===void 0&&(e={});const{isSubtreeInaccessible:n=Rge}=e;if(t.ownerDocument.defaultView.getComputedStyle(t).visibility==="hidden")return!0;let r=t;for(;r;){if(n(r))return!0;r=r.parentElement}return!1}function b9(t){for(const{match:e,roles:n}of stt)if(e(t))return[...n];return[]}function att(t){function e(a){let{name:o,attributes:c}=a;return""+o+c.map(l=>{let{name:u,value:h,constraints:d=[]}=l;const f=d.indexOf("undefined")!==-1,p=d.indexOf("set")!==-1;return typeof h<"u"?"["+u+'="'+h+'"]':f?":not(["+u+"])":p?"["+u+"]:not(["+u+'=""])':"["+u+"]"}).join("")}function n(a){let{attributes:o=[]}=a;return o.length}function i(a,o){let{specificity:c}=a,{specificity:l}=o;return l-c}function r(a){let{attributes:o=[]}=a;const c=o.findIndex(u=>u.value&&u.name==="type"&&u.value==="text");c>=0&&(o=[...o.slice(0,c),...o.slice(c+1)]);const l=e({...a,attributes:o});return u=>c>=0&&u.type!=="text"?!1:u.matches(l)}let s=[];for(const[a,o]of t.entries())s=[...s,{match:r(a),roles:Array.from(o),specificity:n(a)}];return s.sort(i)}function ott(t,e){let{hidden:n=!1}=e===void 0?{}:e;function i(r){return[r,...Array.from(r.children).reduce((s,a)=>[...s,...i(a)],[])]}return i(t).filter(r=>n===!1?_9(r)===!1:!0).reduce((r,s)=>{let a=[];return s.hasAttribute("role")?a=s.getAttribute("role").split(" ").slice(0,1):a=b9(s),a.reduce((o,c)=>Array.isArray(o[c])?{...o,[c]:[...o[c],s]}:{...o,[c]:[s]},r)},{})}function ctt(t,e){let{hidden:n,includeDescription:i}=e;const r=ott(t,{hidden:n});return Object.entries(r).filter(s=>{let[a]=s;return a!=="generic"}).map(s=>{let[a,o]=s;const c="-".repeat(50),l=o.map(u=>{const h='Name "'+f9(u,{computedStyleSupportsPseudoElements:as().computedStyleSupportsPseudoElements})+`":
`,d=rU(u.cloneNode(!1));if(i){const f='Description "'+Qme(u,{computedStyleSupportsPseudoElements:as().computedStyleSupportsPseudoElements})+`":
`;return""+h+f+d}return""+h+d}).join(`

`);return a+`:

`+l+`

`+c}).join(`
`)}function ltt(t){return t.tagName==="OPTION"?t.selected:aI(t,"aria-selected")}function utt(t){return t.getAttribute("aria-busy")==="true"}function htt(t){if(!("indeterminate"in t&&t.indeterminate))return"checked"in t?t.checked:aI(t,"aria-checked")}function dtt(t){return aI(t,"aria-pressed")}function ftt(t){var e,n;return(e=(n=aI(t,"aria-current"))!=null?n:t.getAttribute("aria-current"))!=null?e:!1}function ptt(t){return aI(t,"aria-expanded")}function aI(t,e){const n=t.getAttribute(e);if(n==="true")return!0;if(n==="false")return!1}function mtt(t){const e={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return t.getAttribute("aria-level")&&Number(t.getAttribute("aria-level"))||e[t.tagName]}function gtt(t){const e=t.getAttribute("aria-valuenow");return e===null?void 0:+e}function vtt(t){const e=t.getAttribute("aria-valuemax");return e===null?void 0:+e}function ytt(t){const e=t.getAttribute("aria-valuemin");return e===null?void 0:+e}function _tt(t){const e=t.getAttribute("aria-valuetext");return e===null?void 0:e}const Pte=wge();function btt(t){return t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function Lte(t){return new RegExp(btt(t.toLowerCase()),"i")}function l_(t,e,n,i){let{variant:r,name:s}=i,a="";const o={},c=[["Role","TestId"].includes(t)?n:Lte(n)];s&&(o.name=Lte(s)),t==="Role"&&_9(e)&&(o.hidden=!0,a=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(o).length>0&&c.push(o);const l=r+"By"+t;return{queryName:t,queryMethod:l,queryArgs:c,variant:r,warning:a,toString(){a&&console.warn(a);let[u,h]=c;return u=typeof u=="string"?"'"+u+"'":u,h=h?", { "+Object.entries(h).map(d=>{let[f,p]=d;return f+": "+p}).join(", ")+" }":"",l+"("+u+h+")"}}}function u_(t,e,n){return n&&!e}function XV(t,e,n){var i,r;if(e===void 0&&(e="get"),t.matches(as().defaultIgnore))return;const s=(i=t.getAttribute("role"))!=null?i:(r=b9(t))==null?void 0:r[0];if(s!=="generic"&&u_("Role",n,s))return l_("Role",t,s,{variant:e,name:f9(t,{computedStyleSupportsPseudoElements:as().computedStyleSupportsPseudoElements})});const a=Tge(document,t).map(d=>d.content).join(" ");if(u_("LabelText",n,a))return l_("LabelText",t,a,{variant:e});const o=t.getAttribute("placeholder");if(u_("PlaceholderText",n,o))return l_("PlaceholderText",t,o,{variant:e});const c=Pte(g6(t));if(u_("Text",n,c))return l_("Text",t,c,{variant:e});if(u_("DisplayValue",n,t.value))return l_("DisplayValue",t,Pte(t.value),{variant:e});const l=t.getAttribute("alt");if(u_("AltText",n,l))return l_("AltText",t,l,{variant:e});const u=t.getAttribute("title");if(u_("Title",n,u))return l_("Title",t,u,{variant:e});const h=t.getAttribute(as().testIdAttribute);if(u_("TestId",n,h))return l_("TestId",t,h,{variant:e})}function gD(t,e){t.stack=e.stack.replace(e.message,t.message)}function Ett(t,e){let{container:n=y9(),timeout:i=as().asyncUtilTimeout,showOriginalStackTrace:r=as().showOriginalStackTrace,stackTraceError:s,interval:a=50,onTimeout:o=l=>(Object.defineProperty(l,"message",{value:as().getElementError(l.message,n).message}),l),mutationObserverOptions:c={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=e;if(typeof t!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(l,u)=>{let h,d,f,p=!1,g="idle";const _=setTimeout(N,i),v=kH();if(v){const{unstable_advanceTimersWrapper:A}=as();for(x();!p;){if(!kH()){const I=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");r||gD(I,s),u(I);return}if(await A(async()=>{jest.advanceTimersByTime(a)}),p)break;x()}}else{try{_y(n)}catch(I){u(I);return}d=setInterval(T,a);const{MutationObserver:A}=Ket(n);f=new A(T),f.observe(n,c),x()}function E(A,I){p=!0,clearTimeout(_),v||(clearInterval(d),f.disconnect()),A?u(A):l(I)}function T(){if(kH()){const A=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return r||gD(A,s),u(A)}else return x()}function x(){if(g!=="pending")try{const A=ntt(t);typeof(A==null?void 0:A.then)=="function"?(g="pending",A.then(I=>{g="resolved",E(null,I)},I=>{g="rejected",h=I})):E(null,A)}catch(A){h=A}}function N(){let A;h?(A=h,!r&&A.name==="TestingLibraryElementError"&&gD(A,s)):(A=new Error("Timed out in waitFor."),r||gD(A,s)),E(o(A),null)}})}function Stt(t,e){const n=new Error("STACK_TRACE_MESSAGE");return as().asyncWrapper(()=>Ett(t,{stackTraceError:n,...e}))}function Age(t,e){return as().getElementError(t,e)}function Ttt(t,e){return Age(t+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",e)}function v6(t,e,n,i){let{exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=i===void 0?{}:i;const c=r?$v:tR,l=JT({collapseWhitespace:s,trim:a,normalizer:o});return Array.from(e.querySelectorAll("["+t+"]")).filter(u=>c(u.getAttribute(t),u,n,l))}function aU(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(a.length>1){const o=a.map(c=>Age(null,c).message).join(`

`);throw Ttt(e(n,...r)+`

Here are the matching elements:

`+o,n)}return a[0]||null}}function Mge(t,e){return as().getElementError(`A better query is available, try this:
`+t.toString()+`
`,e)}function xtt(t,e){return function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),s=1;s<i;s++)r[s-1]=arguments[s];const a=t(n,...r);if(!a.length)throw as().getElementError(e(n,...r),n);return a}}function oU(t){return(e,n,i,r)=>Stt(()=>t(e,n,i),{container:e,...r})}const Sw=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=as().throwSuggestions}={}]=s.slice(-1);if(o&&c){const l=XV(o,n);if(l&&!e.endsWith(l.queryName))throw Mge(l.toString(),i)}return o},rp=(t,e,n)=>function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];const o=t(i,...s),[{suggest:c=as().throwSuggestions}={}]=s.slice(-1);if(o.length&&c){const l=[...new Set(o.map(u=>{var h;return(h=XV(u,n))==null?void 0:h.toString()}))];if(l.length===1&&!e.endsWith(XV(o[0],n).queryName))throw Mge(l[0],i)}return o};function ZT(t,e,n){const i=Sw(aU(t,e),t.name,"query"),r=xtt(t,n),s=aU(r,e),a=Sw(s,t.name,"get"),o=rp(r,t.name.replace("query","get"),"getAll"),c=oU(rp(r,t.name,"findAll")),l=oU(Sw(s,t.name,"find"));return[i,o,a,c,l]}function wtt(t){return Array.from(t.querySelectorAll("label,input")).map(e=>({node:e,textToMatch:YV(e)})).filter(e=>{let{textToMatch:n}=e;return n!==null})}const Ctt=function(t,e,n){let{exact:i=!0,trim:r,collapseWhitespace:s,normalizer:a}=n===void 0?{}:n;const o=i?$v:tR,c=JT({collapseWhitespace:s,trim:r,normalizer:a});return wtt(t).filter(u=>{let{node:h,textToMatch:d}=u;return o(d,h,e,c)}).map(u=>{let{node:h}=u;return h})},EO=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,normalizer:o}=n===void 0?{}:n;_y(t);const c=r?$v:tR,l=JT({collapseWhitespace:s,trim:a,normalizer:o}),u=Array.from(t.querySelectorAll("*")).filter(h=>Sge(h).length||h.hasAttribute("aria-labelledby")).reduce((h,d)=>{const f=Tge(t,d,{selector:i});f.filter(g=>!!g.formControl).forEach(g=>{c(g.content,g.formControl,e,l)&&g.formControl&&h.push(g.formControl)});const p=f.filter(g=>!!g.content).map(g=>g.content);return c(p.join(" "),d,e,l)&&h.push(d),p.length>1&&p.forEach((g,_)=>{c(g,d,e,l)&&h.push(d);const v=[...p];v.splice(_,1),v.length>1&&c(v.join(" "),d,e,l)&&h.push(d)}),h},[]).concat(v6("aria-label",t,e,{exact:r,normalizer:l}));return Array.from(new Set(u)).filter(h=>h.matches(i))},CT=function(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];const s=EO(t,e,...i);if(!s.length){const a=Ctt(t,e,...i);if(a.length){const o=a.map(c=>Rtt(t,c)).filter(c=>!!c);throw o.length?as().getElementError(o.map(c=>"Found a label with the text of: "+e+", however the element associated with this label (<"+c+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+c+" />, you can use aria-label or aria-labelledby instead.").join(`

`),t):as().getElementError("Found a label with the text of: "+e+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,t)}else throw as().getElementError("Unable to find a label with the text of: "+e,t)}return s};function Rtt(t,e){const n=e.getAttribute("for");if(!n)return null;const i=t.querySelector('[id="'+n+'"]');return i?i.tagName.toLowerCase():null}const Oge=(t,e)=>"Found multiple elements with the text of: "+e,Att=Sw(aU(EO,Oge),EO.name,"query"),Nge=aU(CT,Oge),Mtt=oU(rp(CT,CT.name,"findAll")),Ott=oU(Sw(Nge,CT.name,"find")),Ntt=rp(CT,CT.name,"getAll"),Itt=Sw(Nge,CT.name,"get"),ktt=rp(EO,EO.name,"queryAll"),KV=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _y(e[0]),v6("placeholder",...e)},Dtt=(t,e)=>"Found multiple elements with the placeholder text of: "+e,Ptt=(t,e)=>"Unable to find an element with the placeholder text of: "+e,Ltt=rp(KV,KV.name,"queryAll"),[Utt,Btt,Ftt,ztt,Htt]=ZT(KV,Dtt,Ptt),JV=function(t,e,n){let{selector:i="*",exact:r=!0,collapseWhitespace:s,trim:a,ignore:o=as().defaultIgnore,normalizer:c}=n===void 0?{}:n;_y(t);const l=r?$v:tR,u=JT({collapseWhitespace:s,trim:a,normalizer:c});let h=[];return typeof t.matches=="function"&&t.matches(i)&&(h=[t]),[...h,...Array.from(t.querySelectorAll(i))].filter(d=>!o||!d.matches(o)).filter(d=>l(g6(d),d,e,u))},jtt=(t,e)=>"Found multiple elements with the text: "+e,Vtt=function(t,e,n){n===void 0&&(n={});const{collapseWhitespace:i,trim:r,normalizer:s,selector:a}=n,c=JT({collapseWhitespace:i,trim:r,normalizer:s})(e.toString()),l=c!==e.toString(),u=(a??"*")!=="*";return"Unable to find an element with the text: "+(l?c+" (normalized from '"+e+"')":e)+(u?", which matches selector '"+a+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},Gtt=rp(JV,JV.name,"queryAll"),[qtt,$tt,Wtt,Ytt,Xtt]=ZT(JV,jtt,Vtt),ZV=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;_y(t);const o=i?$v:tR,c=JT({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("input,textarea,select")).filter(l=>l.tagName==="SELECT"?Array.from(l.options).filter(h=>h.selected).some(h=>o(g6(h),h,e,c)):o(l.value,l,e,c))},Ktt=(t,e)=>"Found multiple elements with the display value: "+e+".",Jtt=(t,e)=>"Unable to find an element with the display value: "+e+".",Ztt=rp(ZV,ZV.name,"queryAll"),[Qtt,ent,tnt,nnt,int]=ZT(ZV,Ktt,Jtt),rnt=/^(img|input|area|.+-.+)$/i,QV=function(t,e,n){return n===void 0&&(n={}),_y(t),v6("alt",t,e,n).filter(i=>rnt.test(i.tagName))},snt=(t,e)=>"Found multiple elements with the alt text: "+e,ant=(t,e)=>"Unable to find an element with the alt text: "+e,ont=rp(QV,QV.name,"queryAll"),[cnt,lnt,unt,hnt,dnt]=ZT(QV,snt,ant),fnt=t=>{var e;return t.tagName.toLowerCase()==="title"&&((e=t.parentElement)==null?void 0:e.tagName.toLowerCase())==="svg"},eG=function(t,e,n){let{exact:i=!0,collapseWhitespace:r,trim:s,normalizer:a}=n===void 0?{}:n;_y(t);const o=i?$v:tR,c=JT({collapseWhitespace:r,trim:s,normalizer:a});return Array.from(t.querySelectorAll("[title], svg > title")).filter(l=>o(l.getAttribute("title"),l,e,c)||fnt(l)&&o(g6(l),l,e,c))},pnt=(t,e)=>"Found multiple elements with the title: "+e+".",mnt=(t,e)=>"Unable to find an element with the title: "+e+".",gnt=rp(eG,eG.name,"queryAll"),[vnt,ynt,_nt,bnt,Ent]=ZT(eG,pnt,mnt),tG=function(t,e,n){let{hidden:i=as().defaultHidden,name:r,description:s,queryFallbacks:a=!1,selected:o,busy:c,checked:l,pressed:u,current:h,level:d,expanded:f,value:{now:p,min:g,max:_,text:v}={}}=n===void 0?{}:n;if(_y(t),o!==void 0){var E;if(((E=Up.get(e))==null?void 0:E.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+e+'".')}if(c!==void 0){var T;if(((T=Up.get(e))==null?void 0:T.props["aria-busy"])===void 0)throw new Error('"aria-busy" is not supported on role "'+e+'".')}if(l!==void 0){var x;if(((x=Up.get(e))==null?void 0:x.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+e+'".')}if(u!==void 0){var N;if(((N=Up.get(e))==null?void 0:N.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+e+'".')}if(h!==void 0){var A;if(((A=Up.get(e))==null?void 0:A.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+e+'".')}if(d!==void 0&&e!=="heading")throw new Error('Role "'+e+'" cannot have "level" property.');if(p!==void 0){var I;if(((I=Up.get(e))==null?void 0:I.props["aria-valuenow"])===void 0)throw new Error('"aria-valuenow" is not supported on role "'+e+'".')}if(_!==void 0){var k;if(((k=Up.get(e))==null?void 0:k.props["aria-valuemax"])===void 0)throw new Error('"aria-valuemax" is not supported on role "'+e+'".')}if(g!==void 0){var L;if(((L=Up.get(e))==null?void 0:L.props["aria-valuemin"])===void 0)throw new Error('"aria-valuemin" is not supported on role "'+e+'".')}if(v!==void 0){var U;if(((U=Up.get(e))==null?void 0:U.props["aria-valuetext"])===void 0)throw new Error('"aria-valuetext" is not supported on role "'+e+'".')}if(f!==void 0){var $;if((($=Up.get(e))==null?void 0:$.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+e+'".')}const q=new WeakMap;function G(X){return q.has(X)||q.set(X,Rge(X)),q.get(X)}return Array.from(t.querySelectorAll(Snt(e))).filter(X=>{if(X.hasAttribute("role")){const Z=X.getAttribute("role");if(a)return Z.split(" ").filter(Boolean).some(ee=>ee===e);const[Y]=Z.split(" ");return Y===e}return b9(X).some(Z=>Z===e)}).filter(X=>{if(o!==void 0)return o===ltt(X);if(c!==void 0)return c===utt(X);if(l!==void 0)return l===htt(X);if(u!==void 0)return u===dtt(X);if(h!==void 0)return h===ftt(X);if(f!==void 0)return f===ptt(X);if(d!==void 0)return d===mtt(X);if(p!==void 0||_!==void 0||g!==void 0||v!==void 0){let V=!0;if(p!==void 0&&V&&(V=p===gtt(X)),_!==void 0&&V&&(V=_===vtt(X)),g!==void 0&&V&&(V=g===ytt(X)),v!==void 0){var ie;V&&(V=$v((ie=_tt(X))!=null?ie:null,X,v,Z=>Z))}return V}return!0}).filter(X=>r===void 0?!0:$v(f9(X,{computedStyleSupportsPseudoElements:as().computedStyleSupportsPseudoElements}),X,r,ie=>ie)).filter(X=>s===void 0?!0:$v(Qme(X,{computedStyleSupportsPseudoElements:as().computedStyleSupportsPseudoElements}),X,s,ie=>ie)).filter(X=>i===!1?_9(X,{isSubtreeInaccessible:G})===!1:!0)};function Snt(t){var e;const n='*[role~="'+t+'"]',i=(e=dge.get(t))!=null?e:new Set,r=new Set(Array.from(i).map(s=>{let{name:a}=s;return a}));return[n].concat(Array.from(r)).join(",")}const Ige=t=>{let e="";return t===void 0?e="":typeof t=="string"?e=' and name "'+t+'"':e=" and name `"+t+"`",e},Tnt=function(t,e,n){let{name:i}=n===void 0?{}:n;return'Found multiple elements with the role "'+e+'"'+Ige(i)},xnt=function(t,e,n){let{hidden:i=as().defaultHidden,name:r,description:s}=n===void 0?{}:n;if(as()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+e+'"'+Ige(r);let a="";Array.from(t.children).forEach(u=>{a+=ctt(u,{hidden:i,includeDescription:s!==void 0})});let o;a.length===0?i===!1?o="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":o="There are no available roles.":o=(`
Here are the `+(i===!1?"accessible":"available")+` roles:

  `+a.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let c="";r===void 0?c="":typeof r=="string"?c=' and name "'+r+'"':c=" and name `"+r+"`";let l="";return s===void 0?l="":typeof s=="string"?l=' and description "'+s+'"':l=" and description `"+s+"`",(`
Unable to find an `+(i===!1?"accessible ":"")+'element with the role "'+e+'"'+c+l+`

`+o).trim()},wnt=rp(tG,tG.name,"queryAll"),[Cnt,Rnt,Ant,Mnt,Ont]=ZT(tG,Tnt,xnt),E9=()=>as().testIdAttribute,nG=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return _y(e[0]),v6(E9(),...e)},Nnt=(t,e)=>"Found multiple elements by: ["+E9()+'="'+e+'"]',Int=(t,e)=>"Unable to find an element by: ["+E9()+'="'+e+'"]',knt=rp(nG,nG.name,"queryAll"),[Dnt,Pnt,Lnt,Unt,Bnt]=ZT(nG,Nnt,Int);var iG=Object.freeze({__proto__:null,queryAllByLabelText:ktt,queryByLabelText:Att,getAllByLabelText:Ntt,getByLabelText:Itt,findAllByLabelText:Mtt,findByLabelText:Ott,queryByPlaceholderText:Utt,queryAllByPlaceholderText:Ltt,getByPlaceholderText:Ftt,getAllByPlaceholderText:Btt,findAllByPlaceholderText:ztt,findByPlaceholderText:Htt,queryByText:qtt,queryAllByText:Gtt,getByText:Wtt,getAllByText:$tt,findAllByText:Ytt,findByText:Xtt,queryByDisplayValue:Qtt,queryAllByDisplayValue:Ztt,getByDisplayValue:tnt,getAllByDisplayValue:ent,findAllByDisplayValue:nnt,findByDisplayValue:int,queryByAltText:cnt,queryAllByAltText:ont,getByAltText:unt,getAllByAltText:lnt,findAllByAltText:hnt,findByAltText:dnt,queryByTitle:vnt,queryAllByTitle:gnt,getByTitle:_nt,getAllByTitle:ynt,findAllByTitle:bnt,findByTitle:Ent,queryByRole:Cnt,queryAllByRole:wnt,getAllByRole:Rnt,getByRole:Ant,findAllByRole:Mnt,findByRole:Ont,queryByTestId:Dnt,queryAllByTestId:knt,getByTestId:Lnt,getAllByTestId:Pnt,findAllByTestId:Unt,findByTestId:Bnt});function Fnt(t,e,n){return e===void 0&&(e=iG),n===void 0&&(n={}),Object.keys(e).reduce((i,r)=>{const s=e[r];return i[r]=s.bind(null,t),i},n)}const znt={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},pageHide:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pageShow:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}}},Hnt={doubleClick:"dblClick"};Object.keys(znt).forEach(t=>{t.toLowerCase()});Object.keys(Hnt).forEach(t=>{});function jnt(t){return t.replace(/[ \t]*[\n][ \t]*/g,`
`)}function Vnt(t){return Pet.compressToEncodedURIComponent(jnt(t))}function Gnt(t){return"https://testing-playground.com/#markup="+Vnt(t)}const qnt=(t,e,n)=>Array.isArray(t)?t.forEach(i=>Dte(i,e,n)):Dte(t,e,n),$nt=function(t){if(t===void 0&&(t=y9().body),!t||!("innerHTML"in t)){console.log("The element you're providing isn't a valid DOM element.");return}if(!t.innerHTML){console.log("The provided element doesn't have any children.");return}const e=Gnt(t.innerHTML);return console.log(`Open this URL in your browser

`+e),e},Ute={debug:qnt,logTestingPlaygroundURL:$nt};typeof document<"u"&&document.body?Fnt(document.body,iG,Ute):Object.keys(iG).reduce((t,e)=>(t[e]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},t),Ute);function yC(t,e){return as().eventWrapper(t)}function Nb(t){const e=vqe(t,c9),n=YN(t.ownerDocument);(e??t.ownerDocument.body)!==n&&(yC(e?()=>e.focus():()=>n==null?void 0:n.blur()),bqe(e??t.ownerDocument.body))}function Wnt(t){!c9(t)||!(YN(t.ownerDocument)===t)||yC(()=>t.blur())}const Ib={};Ib.click=(t,e,n)=>{const i=e.closest("button,input,label,select,textarea"),r=i&&mr(i,"label")&&i.control;if(r&&r!==e)return()=>{c9(r)&&(Nb(r),n.dispatchEvent(r,gqe(t)))};if(mr(e,"input",{type:"file"}))return()=>{Wnt(e),e.dispatchEvent(new(hp(e)).Event("fileDialog")),Nb(e)}};const _C=Symbol("Displayed value in UI"),Fv=Symbol("Displayed selection in UI"),cU=Symbol("Initial value to compare on blur");function Ynt(t){return typeof t=="object"&&_C in t}function Xnt(t){return!!t&&typeof t=="object"&&Fv in t}function Knt(t,e){t[cU]===void 0&&(t[cU]=t.value),t[_C]=e,t.value=Object.assign(new String(e),{[_C]:!0})}function s0(t){return t[_C]===void 0?t.value:String(t[_C])}function S9(t){t[_C]=void 0}function kge(t){t[cU]=void 0}function Jnt(t){return t[cU]}function Znt(t,e){t[Fv]=e}function nR(t,{focusOffset:e,anchorOffset:n=e},i="replace"){const r=s0(t).length,s=h=>Math.max(0,Math.min(r,h)),a=i==="replace"||t[Fv]===void 0?s(n):t[Fv].anchorOffset,o=s(e),c=Math.min(a,o),l=Math.max(a,o);if(t[Fv]={anchorOffset:a,focusOffset:o},t.selectionStart===c&&t.selectionEnd===l)return;const u=Object.assign(new Number(c),{[Fv]:!0});try{t.setSelectionRange(u,l)}catch{}}function SO(t){var e,n,i;const r=(i=t[Fv])!==null&&i!==void 0?i:{anchorOffset:(e=t.selectionStart)!==null&&e!==void 0?e:0,focusOffset:(n=t.selectionEnd)!==null&&n!==void 0?n:0};return{...r,startOffset:Math.min(r.anchorOffset,r.focusOffset),endOffset:Math.max(r.anchorOffset,r.focusOffset)}}function Qnt(t){return!!t[Fv]}function _P(t){t[Fv]=void 0}const lU=globalThis.parseInt;function eit(t){const e=t.replace(/\D/g,"");if(e.length<2)return t;const n=lU(e[0],10),i=lU(e[1],10);if(n>=3||n===2&&i>=4){let r;return n>=3?r=1:r=2,Bte(e,r)}return t.length===2?t:Bte(e,2)}function Bte(t,e){const n=t.slice(0,e),i=Math.min(lU(n,10),23),r=t.slice(e),s=lU(r,10),a=Math.min(s,59);return`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function Dge(t,e){const n=t.cloneNode();return n.value=e,n.value===e}var Pge=function(t){return t.email="email",t.password="password",t.search="search",t.telephone="telephone",t.text="text",t.url="url",t}(Pge||{});function tit(t){var e;const n=(e=t.getAttribute("maxlength"))!==null&&e!==void 0?e:"";return/^\d+$/.test(n)&&Number(n)>=0?Number(n):void 0}function nit(t){return mr(t,"textarea")||mr(t,"input")&&t.type in Pge}function Lge(t,e,n,i){if(bP(t)&&e+n>=0&&e+n<=t.nodeValue.length)return{node:t,offset:e+n};const r=Fte(t,e,n);if(r){if(bP(r))return{node:r,offset:n>0?Math.min(1,r.nodeValue.length):Math.max(r.nodeValue.length-1,0)};if(mr(r,"br")){const s=Fte(r,void 0,n);return s?bP(s)?{node:s,offset:n>0?0:s.nodeValue.length}:n<0&&mr(s,"br")?{node:r.parentNode,offset:vD(r)}:{node:s.parentNode,offset:vD(s)+(n>0?0:1)}:n<0&&i==="deleteContentBackward"?{node:r.parentNode,offset:vD(r)}:void 0}else return{node:r.parentNode,offset:vD(r)+(n>0?1:0)}}}function Fte(t,e,n){const i=Number(e)+(n<0?-1:0);return e!==void 0&&T9(t)&&i>=0&&i<t.children.length&&(t=t.children[i]),rit(t,n===1?"next":"previous",iit)}function iit(t){if(bP(t))return!0;if(T9(t)){if(mr(t,["input","textarea"]))return t.type!=="hidden";if(mr(t,"br"))return!0}return!1}function vD(t){let e=0;for(;t.previousSibling;)e++,t=t.previousSibling;return e}function T9(t){return t.nodeType===1}function bP(t){return t.nodeType===3}function rit(t,e,n){for(;;){var i;const r=t[`${e}Sibling`];if(r){if(t=sit(r,e==="next"?"first":"last"),n(t))return t}else if(t.parentNode&&(!T9(t.parentNode)||!wT(t.parentNode)&&t.parentNode!==((i=t.ownerDocument)===null||i===void 0?void 0:i.body)))t=t.parentNode;else break}}function sit(t,e){for(;t.hasChildNodes();)t=t[`${e}Child`];return t}const TO=Symbol("Track programmatic changes for React workaround");function ait(t){return Object.getOwnPropertyNames(t).some(e=>e.startsWith("__react"))&&hp(t).REACT_VERSION===17}function oit(t){ait(t)&&(t[TO]={previousValue:String(t.value),tracked:[]})}function cit(t,e){var n,i;(i=t[TO])===null||i===void 0||(n=i.tracked)===null||n===void 0||n.push(e),t[TO]||(S9(t),nR(t,{focusOffset:e.length}))}function lit(t,e){var n;const i=t[TO];if(t[TO]=void 0,!(!(i==null||(n=i.tracked)===null||n===void 0)&&n.length))return;const r=i.tracked.length===2&&i.tracked[0]===i.previousValue&&i.tracked[1]===t.value;r||S9(t),Qnt(t)&&nR(t,{focusOffset:r?e:t.value.length})}function Uge(t){const e=uit(t);if(e&&r0(e))return{type:"input",selection:SO(e)};const n=e==null?void 0:e.ownerDocument.getSelection();return{type:gO(t)&&(n==null?void 0:n.anchorNode)&&gO(n.anchorNode)?"contenteditable":"default",selection:n}}function uit(t){return t.nodeType===1?t:t.parentElement}function hit(t){const e=Uge(t);if(e.type==="input")return e.selection;if(e.type==="contenteditable"){var n;return(n=e.selection)===null||n===void 0?void 0:n.getRangeAt(0)}}function RT({focusNode:t,focusOffset:e,anchorNode:n=t,anchorOffset:i=e}){var r,s;if(Uge(t).type==="input")return nR(t,{anchorOffset:i,focusOffset:e});(s=n.ownerDocument)===null||s===void 0||(r=s.getSelection())===null||r===void 0||r.setBaseAndExtent(n,i,t,e)}function Bge(t){return mr(t,"input")&&["date","time"].includes(t.type)}function bC(t,e,n,i="insertText"){const r=hit(e);r&&(!Bge(e)&&!t.dispatchUIEvent(e,"beforeinput",{inputType:i,data:n})||("startContainer"in r?dit(t,e,r,n,i):fit(t,e,r,n,i)))}function dit(t,e,n,i,r){let s=!1;if(!n.collapsed)s=!0,n.deleteContents();else if(["deleteContentBackward","deleteContentForward"].includes(r)){const a=Lge(n.startContainer,n.startOffset,r==="deleteContentBackward"?-1:1,r);if(a){s=!0;const o=n.cloneRange();o.comparePoint(a.node,a.offset)<0?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),o.deleteContents()}}if(i)if(n.endContainer.nodeType===3){const a=n.endOffset;n.endContainer.insertData(a,i),n.setStart(n.endContainer,a+i.length),n.setEnd(n.endContainer,a+i.length)}else{const a=e.ownerDocument.createTextNode(i);n.insertNode(a),n.setStart(a,i.length),n.setEnd(a,i.length)}(s||i)&&t.dispatchUIEvent(e,"input",{inputType:r})}function fit(t,e,n,i,r){let s=i;if(nit(e)){const l=tit(e);if(l!==void 0&&i.length>0){const u=l-e.value.length;if(u>0)s=i.substring(0,u);else return}}const{newValue:a,newOffset:o,oldValue:c}=pit(s,e,n,r);a===c&&o===n.startOffset&&o===n.endOffset||mr(e,"input",{type:"number"})&&!mit(a)||(Knt(e,a),RT({focusNode:e,anchorOffset:o,focusOffset:o}),Bge(e)?Dge(e,a)&&(zte(t,e,o,{}),t.dispatchUIEvent(e,"change"),kge(e)):zte(t,e,o,{data:i,inputType:r}))}function pit(t,e,{startOffset:n,endOffset:i},r){const s=s0(e),a=Math.max(0,n===i&&r==="deleteContentBackward"?n-1:n),o=s.substring(0,a),c=Math.min(s.length,n===i&&r==="deleteContentForward"?n+1:i),l=s.substring(c,s.length);let u=`${o}${t}${l}`,h=a+t.length;if(mr(e,"input",{type:"time"})){const d=eit(u);d!==""&&Dge(e,d)&&(u=d,h=d.length)}return{oldValue:s,newValue:u,newOffset:h}}function zte(t,e,n,i){t.dispatchUIEvent(e,"input",i),lit(e,n)}function mit(t){var e,n;const i=t.split("e",2);return!(/[^\d.\-e]/.test(t)||Number((e=t.match(/-/g))===null||e===void 0?void 0:e.length)>2||Number((n=t.match(/\./g))===null||n===void 0?void 0:n.length)>1||i[1]&&!/^-?\d*$/.test(i[1]))}Ib.cut=(t,e,n)=>()=>{gC(e)&&bC(n,e,"","deleteByCut")};function git(t){return t?wT(t)?t.textContent:s0(t):null}function vit(t){const e=hp(t);for(let n=t;n!=null&&n.ownerDocument;n=n.parentElement){const{display:i,visibility:r}=e.getComputedStyle(n);if(i==="none"||r==="hidden")return!1}return!0}function yit(t,e){const n=t.ownerDocument,i=n.querySelectorAll(Jpe),r=Array.from(i).filter(c=>c===t||!(Number(c.getAttribute("tabindex"))<0||oy(c)));Number(t.getAttribute("tabindex"))>=0&&r.sort((c,l)=>{const u=Number(c.getAttribute("tabindex")),h=Number(l.getAttribute("tabindex"));return u===h?0:u===0?1:h===0?-1:u-h});const s={};let a=[n.body];const o=mr(t,"input",{type:"radio"})?t.name:void 0;r.forEach(c=>{const l=c;if(mr(l,"input",{type:"radio"})&&l.name){if(l===t){a.push(l);return}else if(l.name===o)return;if(l.checked){a=a.filter(u=>!mr(u,"input",{type:"radio",name:l.name})),a.push(l),s[l.name]=l;return}if(typeof s[l.name]<"u")return}a.push(l)});for(let c=a.findIndex(l=>l===t);;)if(c+=e?-1:1,c===a.length?c=0:c===-1&&(c=a.length-1),a[c]===t||a[c]===n.body||vit(a[c]))return a[c]}function Hte(t,e){if(r0(t)){const n=SO(t);RT({focusNode:t,focusOffset:n.startOffset===n.endOffset?n.focusOffset+e:e<0?n.startOffset:n.endOffset})}else{const n=t.ownerDocument.getSelection();if(!(n!=null&&n.focusNode))return;if(n.isCollapsed){const i=Lge(n.focusNode,n.focusOffset,e);i&&RT({focusNode:i.node,focusOffset:i.offset})}else n[e<0?"collapseToStart":"collapseToEnd"]()}}function Fge(t){if(r0(t))return RT({focusNode:t,anchorOffset:0,focusOffset:s0(t).length});var e;const n=(e=gO(t))!==null&&e!==void 0?e:t.ownerDocument.body;RT({focusNode:n,anchorOffset:0,focusOffset:n.childNodes.length})}function _it(t){if(r0(t))return SO(t).startOffset===0&&SO(t).endOffset===s0(t).length;var e;const n=(e=gO(t))!==null&&e!==void 0?e:t.ownerDocument.body,i=t.ownerDocument.getSelection();return(i==null?void 0:i.anchorNode)===n&&i.focusNode===n&&i.anchorOffset===0&&i.focusOffset===n.childNodes.length}function EA(t,e,n){var i;if(r0(t))return RT({focusNode:t,anchorOffset:e,focusOffset:n});if(wT(t)&&((i=t.firstChild)===null||i===void 0?void 0:i.nodeType)===3)return RT({focusNode:t.firstChild,anchorOffset:e,focusOffset:n});throw new Error("Not implemented. The result of this interaction is unreliable.")}function yD(t,e,n){const i=hp(e),r=Array.from(e.ownerDocument.querySelectorAll(e.name?`input[type="radio"][name="${i.CSS.escape(e.name)}"]`:'input[type="radio"][name=""], input[type="radio"]:not([name])'));for(let s=r.findIndex(a=>a===e)+n;;s+=n){if(r[s]||(s=n>0?0:r.length-1),r[s]===e)return;if(!oy(r[s])){Nb(r[s]),t.dispatchUIEvent(r[s],"click");return}}}Ib.keydown=(t,e,n)=>{var i,r;return(r=(i=jte[t.key])===null||i===void 0?void 0:i.call(jte,t,e,n))!==null&&r!==void 0?r:bit(t,e,n)};const jte={ArrowDown:(t,e,n)=>{if(mr(e,"input",{type:"radio"}))return()=>yD(n,e,1)},ArrowLeft:(t,e,n)=>mr(e,"input",{type:"radio"})?()=>yD(n,e,-1):()=>Hte(e,-1),ArrowRight:(t,e,n)=>mr(e,"input",{type:"radio"})?()=>yD(n,e,1):()=>Hte(e,1),ArrowUp:(t,e,n)=>{if(mr(e,"input",{type:"radio"}))return()=>yD(n,e,-1)},Backspace:(t,e,n)=>{if(gC(e))return()=>{bC(n,e,"","deleteContentBackward")}},Delete:(t,e,n)=>{if(gC(e))return()=>{bC(n,e,"","deleteContentForward")}},End:(t,e)=>{if(mr(e,["input","textarea"])||wT(e))return()=>{var n,i;const r=(i=(n=git(e))===null||n===void 0?void 0:n.length)!==null&&i!==void 0?i:0;EA(e,r,r)}},Home:(t,e)=>{if(mr(e,["input","textarea"])||wT(e))return()=>{EA(e,0,0)}},PageDown:(t,e)=>{if(mr(e,["input"]))return()=>{const n=s0(e).length;EA(e,n,n)}},PageUp:(t,e)=>{if(mr(e,["input"]))return()=>{EA(e,0,0)}},Tab:(t,e,n)=>()=>{const i=yit(e,n.system.keyboard.modifiers.Shift);Nb(i),r0(i)&&nR(i,{anchorOffset:0,focusOffset:i.value.length})}},bit=(t,e,n)=>{if(t.code==="KeyA"&&n.system.keyboard.modifiers.Control)return()=>Fge(e)};Ib.keypress=(t,e,n)=>{if(t.key==="Enter"){if(mr(e,"button")||mr(e,"input")&&Eit.includes(e.type)||mr(e,"a")&&e.href)return()=>{n.dispatchUIEvent(e,"click")};if(mr(e,"input")){const i=e.form,r=i==null?void 0:i.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');return r?()=>n.dispatchUIEvent(r,"click"):i&&Sit.includes(e.type)&&i.querySelectorAll("input").length===1?()=>n.dispatchUIEvent(i,"submit"):void 0}}if(gC(e)){const i=t.key==="Enter"?wT(e)&&!n.system.keyboard.modifiers.Shift?"insertParagraph":"insertLineBreak":"insertText",r=t.key==="Enter"?`
`:t.key;return()=>bC(n,e,r,i)}};const Eit=["button","color","file","image","reset","submit"],Sit=["email","month","password","search","tel","text","url","week"];Ib.keyup=(t,e,n)=>{var i;return(i=Vte[t.key])===null||i===void 0?void 0:i.call(Vte,t,e,n)};const Vte={" ":(t,e,n)=>{if(Qpe(e))return()=>n.dispatchUIEvent(e,"click")}};Ib.paste=(t,e,n)=>{if(gC(e))return()=>{var i;const r=(i=t.clipboardData)===null||i===void 0?void 0:i.getData("text");r&&bC(n,e,r,"insertFromPaste")}};const zge={auxclick:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},beforeinput:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},click:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},contextmenu:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblclick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusin:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusout:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},keydown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keypress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyup:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},mousedown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseenter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseleave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mousemove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseout:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseover:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseup:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerover:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerenter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerdown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointermove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerup:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointercancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerout:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerleave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}}};function Hge(t){return zge[t].EventType}const Tit=["MouseEvent","PointerEvent"];function xit(t){return Tit.includes(Hge(t))}function wit(t){return Hge(t)==="KeyboardEvent"}const Cit={ClipboardEvent:[Ait],Event:[],FocusEvent:[eA,Mit],InputEvent:[eA,Oit],MouseEvent:[eA,DH,Gte],PointerEvent:[eA,DH,Gte,Iit],KeyboardEvent:[eA,DH,Nit]};function jge(t,e,n){const i=hp(e),{EventType:r,defaultInit:s}=zge[t],a=new(Rit(i))[r](t,s);return Cit[r].forEach(o=>o(a,n??{})),a}function Rit(t){var e;const n=(e=t.Event)!==null&&e!==void 0?e:class{};var i;const r=(i=t.AnimationEvent)!==null&&i!==void 0?i:class extends n{};var s;const a=(s=t.ClipboardEvent)!==null&&s!==void 0?s:class extends n{};var o;const c=(o=t.PopStateEvent)!==null&&o!==void 0?o:class extends n{};var l;const u=(l=t.ProgressEvent)!==null&&l!==void 0?l:class extends n{};var h;const d=(h=t.TransitionEvent)!==null&&h!==void 0?h:class extends n{};var f;const p=(f=t.UIEvent)!==null&&f!==void 0?f:class extends n{};var g;const _=(g=t.CompositionEvent)!==null&&g!==void 0?g:class extends p{};var v;const E=(v=t.FocusEvent)!==null&&v!==void 0?v:class extends p{};var T;const x=(T=t.InputEvent)!==null&&T!==void 0?T:class extends p{};var N;const A=(N=t.KeyboardEvent)!==null&&N!==void 0?N:class extends p{};var I;const k=(I=t.MouseEvent)!==null&&I!==void 0?I:class extends p{};var L;const U=(L=t.DragEvent)!==null&&L!==void 0?L:class extends k{};var $;const q=($=t.PointerEvent)!==null&&$!==void 0?$:class extends k{};var G;const X=(G=t.TouchEvent)!==null&&G!==void 0?G:class extends p{};return{Event:n,AnimationEvent:r,ClipboardEvent:a,PopStateEvent:c,ProgressEvent:u,TransitionEvent:d,UIEvent:p,CompositionEvent:_,FocusEvent:E,InputEvent:x,KeyboardEvent:A,MouseEvent:k,DragEvent:U,PointerEvent:q,TouchEvent:X}}function eE(t,e){for(const[n,i]of Object.entries(e))Object.defineProperty(t,n,{get:()=>i??null})}function po(t){return Number(t??0)}function Ait(t,{clipboardData:e}){eE(t,{clipboardData:e})}function Mit(t,{relatedTarget:e}){eE(t,{relatedTarget:e})}function Oit(t,{data:e,inputType:n,isComposing:i}){eE(t,{data:e,isComposing:!!i,inputType:String(n)})}function eA(t,{view:e,detail:n}){eE(t,{view:e,detail:po(n??0)})}function DH(t,{altKey:e,ctrlKey:n,metaKey:i,shiftKey:r,modifierAltGraph:s,modifierCapsLock:a,modifierFn:o,modifierFnLock:c,modifierNumLock:l,modifierScrollLock:u,modifierSymbol:h,modifierSymbolLock:d}){eE(t,{altKey:!!e,ctrlKey:!!n,metaKey:!!i,shiftKey:!!r,getModifierState(f){return!!{Alt:e,AltGraph:s,CapsLock:a,Control:n,Fn:o,FnLock:c,Meta:i,NumLock:l,ScrollLock:u,Shift:r,Symbol:h,SymbolLock:d}[f]}})}function Nit(t,{key:e,code:n,location:i,repeat:r,isComposing:s,charCode:a}){eE(t,{key:String(e),code:String(n),location:po(i),repeat:!!r,isComposing:!!s,charCode:a})}function Gte(t,{x:e,y:n,screenX:i,screenY:r,clientX:s=e,clientY:a=n,button:o,buttons:c,relatedTarget:l,offsetX:u,offsetY:h,pageX:d,pageY:f}){eE(t,{screenX:po(i),screenY:po(r),clientX:po(s),x:po(s),clientY:po(a),y:po(a),button:po(o),buttons:po(c),relatedTarget:l,offsetX:po(u),offsetY:po(h),pageX:po(d),pageY:po(f)})}function Iit(t,{pointerId:e,width:n,height:i,pressure:r,tangentialPressure:s,tiltX:a,tiltY:o,twist:c,pointerType:l,isPrimary:u}){eE(t,{pointerId:po(e),width:po(n??1),height:po(i??1),pressure:po(r),tangentialPressure:po(s),tiltX:po(a),tiltY:po(o),twist:po(c),pointerType:String(l),isPrimary:!!u})}function kit(t,e,n,i=!1){(xit(e)||wit(e))&&(n={...n,...this.system.getUIEventModifiers()});const r=jge(e,t,n);return Vge.call(this,t,r,i)}function Vge(t,e,n=!1){var i;const r=e.type,s=n?()=>{}:(i=Ib[r])===null||i===void 0?void 0:i.call(Ib,e,t,this);if(s){e.preventDefault();let a=!1;return Object.defineProperty(e,"defaultPrevented",{get:()=>a}),Object.defineProperty(e,"preventDefault",{value:()=>{a=e.cancelable}}),yC(()=>t.dispatchEvent(e)),a||s(),!a}return yC(()=>t.dispatchEvent(e))}function TS(t,e,n){const i=jge(e,t,n);yC(()=>t.dispatchEvent(i))}const qte=Symbol("patched focus/blur methods");function Gge(t){if(t.prototype[qte])return;const{focus:e,blur:n}=t.prototype;Object.defineProperties(t.prototype,{focus:{configurable:!0,get:()=>r},blur:{configurable:!0,get:()=>s},[qte]:{configurable:!0,get:()=>({focus:e,blur:n})}});let i;function r(a){if(this.ownerDocument.visibilityState!=="hidden")return e.call(this,a);const o=$te(this.ownerDocument);if(o===this)return;const c=Symbol("focus call");i=c,o&&(n.call(o),TS(o,"blur",{relatedTarget:this}),TS(o,"focusout",{relatedTarget:i===c?this:null})),i===c&&(e.call(this,a),TS(this,"focus",{relatedTarget:o})),i===c&&TS(this,"focusin",{relatedTarget:o})}function s(){if(this.ownerDocument.visibilityState!=="hidden")return n.call(this);const a=$te(this.ownerDocument);if(a!==this)return;i=Symbol("blur call"),n.call(this),TS(a,"blur",{relatedTarget:null}),TS(a,"focusout",{relatedTarget:null})}}function $te(t){const e=YN(t);return(e==null?void 0:e.tagName)==="BODY"?null:e}const PH=Symbol("Interceptor for programmatical calls");function K1(t,e,n){const i=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=Object.getOwnPropertyDescriptor(t,e),s=i!=null&&i.set?"set":"value";if(typeof(i==null?void 0:i[s])!="function"||i[s][PH])throw new Error(`Element ${t.tagName} does not implement "${String(e)}".`);function a(...o){const{applyNative:c=!1,realArgs:l,then:u}=n.call(this,...o),h=(!c&&r||i)[s];s==="set"?h.call(this,l):h.call(this,...l),u==null||u()}a[PH]=PH,Object.defineProperty(t,e,{...r??i,[s]:a})}function Dit(t){K1(t,"value",function(n){const i=Ynt(n);return i&&oit(this),{applyNative:!!i,realArgs:Pit(this,n),then:i?void 0:()=>cit(this,String(n))}})}function Pit(t,e){return mr(t,"input",{type:"number"})&&String(e)!==""&&!Number.isNaN(Number(e))?String(Number(e)):String(e)}function Lit(t){K1(t,"setSelectionRange",function(n,...i){const r=Xnt(n);return{applyNative:!!r,realArgs:[Number(n),...i],then:()=>r?void 0:_P(t)}}),K1(t,"selectionStart",function(n){return{realArgs:n,then:()=>_P(t)}}),K1(t,"selectionEnd",function(n){return{realArgs:n,then:()=>_P(t)}}),K1(t,"select",function(){return{realArgs:[],then:()=>Znt(t,{anchorOffset:0,focusOffset:s0(t).length})}})}function Uit(t){K1(t,"setRangeText",function(...n){return{realArgs:n,then:()=>{S9(t),_P(t)}}})}const Tw=Symbol("Node prepared with document state workarounds");function qge(t){t[Tw]||(t.addEventListener("focus",e=>{const n=e.target;Wte(n)},{capture:!0,passive:!0}),t.activeElement&&Wte(t.activeElement),t.addEventListener("blur",e=>{const n=e.target,i=Jnt(n);i!==void 0&&(n.value!==i&&TS(n,"change"),kge(n))},{capture:!0,passive:!0}),t[Tw]=Tw)}function Wte(t){t[Tw]||(mr(t,["input","textarea"])&&(Dit(t),Lit(t),Uit(t)),t[Tw]=Tw)}function Bit(t){return Fit(t)?t:t.ownerDocument}function Fit(t){return t.nodeType===9}var Nd=function(t){return t[t.Trigger=2]="Trigger",t[t.Call=1]="Call",t}({});function SA(t,e){t.levelRefs[e]={}}function _D(t,e){return t.levelRefs[e]}function EC(t){const e=t.delay;if(typeof e=="number")return Promise.all([new Promise(n=>globalThis.setTimeout(()=>n(),e)),t.advanceTimers(e)])}var EP=function(t){return t[t.EachTrigger=4]="EachTrigger",t[t.EachApiCall=2]="EachApiCall",t[t.EachTarget=1]="EachTarget",t[t.Never=0]="Never",t}({});function aS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Zm=function(t){return t[t.STANDARD=0]="STANDARD",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.NUMPAD=3]="NUMPAD",t}({});const zit=["Alt","AltGraph","Control","Fn","Meta","Shift","Symbol"];function Yte(t){return zit.includes(t)}const Hit=["CapsLock","FnLock","NumLock","ScrollLock","SymbolLock"];function Xte(t){return Hit.includes(t)}class jit{isKeyPressed(e){return this.pressed.has(String(e.code))}getPressedKeys(){return this.pressed.values().map(e=>e.keyDef)}async keydown(e,n){const i=String(n.key),r=String(n.code),s=pH(e.config.document);this.setKeydownTarget(s),this.pressed.add(r,n),Yte(i)&&(this.modifiers[i]=!0);const a=e.dispatchUIEvent(s,"keydown",{key:i,code:r});Xte(i)&&!this.modifiers[i]&&(this.modifiers[i]=!0,this.modifierLockStart[i]=!0),a&&this.pressed.setUnprevented(r),a&&this.hasKeyPress(i)&&e.dispatchUIEvent(pH(e.config.document),"keypress",{key:i,code:r,charCode:n.key==="Enter"?13:String(n.key).charCodeAt(0)})}async keyup(e,n){const i=String(n.key),r=String(n.code),s=this.pressed.isUnprevented(r);this.pressed.delete(r),Yte(i)&&!this.pressed.values().find(a=>a.keyDef.key===i)&&(this.modifiers[i]=!1),e.dispatchUIEvent(pH(e.config.document),"keyup",{key:i,code:r},!s),Xte(i)&&this.modifiers[i]&&(this.modifierLockStart[i]?this.modifierLockStart[i]=!1:this.modifiers[i]=!1)}setKeydownTarget(e){e!==this.lastKeydownTarget&&(this.carryChar=""),this.lastKeydownTarget=e}hasKeyPress(e){return(e.length===1||e==="Enter")&&!this.modifiers.Control&&!this.modifiers.Alt}constructor(e){aS(this,"system",void 0),aS(this,"modifiers",{Alt:!1,AltGraph:!1,CapsLock:!1,Control:!1,Fn:!1,FnLock:!1,Meta:!1,NumLock:!1,ScrollLock:!1,Shift:!1,Symbol:!1,SymbolLock:!1}),aS(this,"pressed",new class{add(n,i){var r,s,a;(a=(r=this.registry)[s=n])!==null&&a!==void 0||(r[s]={keyDef:i,unpreventedDefault:!1})}has(n){return!!this.registry[n]}setUnprevented(n){const i=this.registry[n];i&&(i.unpreventedDefault=!0)}isUnprevented(n){var i;return!!(!((i=this.registry[n])===null||i===void 0)&&i.unpreventedDefault)}delete(n){delete this.registry[n]}values(){return Object.values(this.registry)}constructor(){aS(this,"registry",{})}}),aS(this,"carryChar",""),aS(this,"lastKeydownTarget",void 0),aS(this,"modifierLockStart",{}),this.system=e}}const Vit=[..."0123456789".split("").map(t=>({code:`Digit${t}`,key:t})),...")!@#$%^&*(".split("").map((t,e)=>({code:`Digit${e}`,key:t,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map(t=>({code:`Key${t.toUpperCase()}`,key:t})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(t=>({code:`Key${t}`,key:t,shiftKey:!0})),{code:"BracketLeft",key:"["},{code:"BracketLeft",key:"{",shiftKey:!0},{code:"BracketRight",key:"]"},{code:"BracketRight",key:"}",shiftKey:!0},{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:Zm.LEFT},{code:"AltRight",key:"Alt",location:Zm.RIGHT},{code:"ShiftLeft",key:"Shift",location:Zm.LEFT},{code:"ShiftRight",key:"Shift",location:Zm.RIGHT},{code:"ControlLeft",key:"Control",location:Zm.LEFT},{code:"ControlRight",key:"Control",location:Zm.RIGHT},{code:"MetaLeft",key:"Meta",location:Zm.LEFT},{code:"MetaRight",key:"Meta",location:Zm.RIGHT},{code:"OSLeft",key:"OS",location:Zm.LEFT},{code:"OSRight",key:"OS",location:Zm.RIGHT},{code:"ContextMenu",key:"ContextMenu"},{code:"Tab",key:"Tab"},{code:"CapsLock",key:"CapsLock"},{code:"Backspace",key:"Backspace"},{code:"Enter",key:"Enter"},{code:"Escape",key:"Escape"},{code:"ArrowUp",key:"ArrowUp"},{code:"ArrowDown",key:"ArrowDown"},{code:"ArrowLeft",key:"ArrowLeft"},{code:"ArrowRight",key:"ArrowRight"},{code:"Home",key:"Home"},{code:"End",key:"End"},{code:"Delete",key:"Delete"},{code:"PageUp",key:"PageUp"},{code:"PageDown",key:"PageDown"},{code:"Fn",key:"Fn"},{code:"Symbol",key:"Symbol"},{code:"AltRight",key:"AltGraph"}],Git=[{name:"MouseLeft",pointerType:"mouse",button:"primary"},{name:"MouseRight",pointerType:"mouse",button:"secondary"},{name:"MouseMiddle",pointerType:"mouse",button:"auxiliary"},{name:"TouchA",pointerType:"touch"},{name:"TouchB",pointerType:"touch"},{name:"TouchC",pointerType:"touch"}];function qit(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class $ge{getButtons(){let e=0;for(const n of Object.keys(this.pressed))e|=2**Number(n);return e}down(e){const n=rG(e.button);if(n in this.pressed){this.pressed[n].push(e);return}return this.pressed[n]=[e],n}up(e){const n=rG(e.button);if(n in this.pressed&&(this.pressed[n]=this.pressed[n].filter(i=>i.name!==e.name),this.pressed[n].length===0))return delete this.pressed[n],n}constructor(){qit(this,"pressed",{})}}const Kte={primary:0,secondary:1,auxiliary:2,back:3,X1:3,forward:4,X2:4};function rG(t=0){return t in Kte?Kte[t]:Number(t)}const Jte={1:2,2:1};function sG(t){return t=rG(t),t in Jte?Jte[t]:t}function $it(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Wit{get countPressed(){return this.pressedKeys.size}isPressed(e){return this.pressedKeys.has(e.name)}addPressed(e){return this.pressedKeys.add(e.name)}removePressed(e){return this.pressedKeys.delete(e.name)}constructor(){$it(this,"pressedKeys",new Set)}}function rM(t,e){const n=[];for(let s=t;s;s=s.parentElement)n.push(s);const i=[];for(let s=e;s;s=s.parentElement)i.push(s);let r=0;for(;!(r>=n.length||r>=i.length||n[n.length-1-r]!==i[i.length-1-r]);r++);return[n.slice(0,n.length-r),i.slice(0,i.length-r),i.slice(i.length-r)]}function aG({target:t,node:e,offset:n}){return r0(t)?{node:t,offset:n??s0(t).length}:e?{node:e,offset:n??(e.nodeType===3?e.nodeValue.length:e.childNodes.length)}:Wge(t,n)}function Wge(t,e,n=!0){let i=e===void 0?t.childNodes.length-1:0;const r=e===void 0?-1:1;for(;e===void 0?i>=(n?Math.max(t.childNodes.length-1,0):0):i<=t.childNodes.length;){if(e&&i===t.childNodes.length)throw new Error("The given offset is out of bounds.");const s=t.childNodes.item(i),a=String(s.textContent);if(a.length)if(e!==void 0&&a.length<e)e-=a.length;else{if(s.nodeType===1)return Wge(s,e,!1);if(s.nodeType===3)return{node:s,offset:e??s.nodeValue.length}}i+=r}return{node:t,offset:t.childNodes.length}}function Yit({document:t,target:e,clickCount:n,node:i,offset:r}){if(_qe(e))return;const s=r0(e),a=String(s?s0(e):e.textContent),[o,c]=i?[r,r]:Xit(a,r,n);if(s)return nR(e,{anchorOffset:o??a.length,focusOffset:c??a.length}),{node:e,start:o??0,end:c??a.length};{const{node:l,offset:u}=aG({target:e,node:i,offset:o}),{node:h,offset:d}=aG({target:e,node:i,offset:c}),f=e.ownerDocument.createRange();try{f.setStart(l,u),f.setEnd(h,d)}catch{throw new Error("The given offset is out of bounds.")}const p=t.getSelection();return p==null||p.removeAllRanges(),p==null||p.addRange(f.cloneRange()),f}}function Xit(t,e,n){if(n%3===1||t.length===0)return[e,e];const i=e??t.length;return n%3===2?[i-t.substr(0,e).match(/(\w+|\s+|\W)?$/)[0].length,e===void 0?e:e+t.substr(e).match(/^(\w+|\s+|\W)?/)[0].length]:[i-t.substr(0,e).match(/[^\r\n]*$/)[0].length,e===void 0?e:e+t.substr(e).match(/^[^\r\n]*/)[0].length]}function Kit(t,{document:e,target:n,node:i,offset:r}){const s=aG({target:n,node:i,offset:r});if("node"in t){if(s.node===t.node){const a=s.offset<t.start?t.end:t.start,o=s.offset>t.end||s.offset<t.start?s.offset:t.end;nR(t.node,{anchorOffset:a,focusOffset:o})}}else{const a=t.cloneRange(),o=a.comparePoint(s.node,s.offset);o<0?a.setStart(s.node,s.offset):o>0&&a.setEnd(s.node,s.offset);const c=e.getSelection();c==null||c.removeAllRanges(),c==null||c.addRange(a.cloneRange())}}function Yge(t,e){var n,i,r,s,a,o,c,l,u,h,d,f,p,g,_,v,E,T,x,N,A,I,k,L;return t.target!==e.target||((n=t.coords)===null||n===void 0?void 0:n.x)!==((i=e.coords)===null||i===void 0?void 0:i.x)||((r=t.coords)===null||r===void 0?void 0:r.y)!==((s=e.coords)===null||s===void 0?void 0:s.y)||((a=t.coords)===null||a===void 0?void 0:a.clientX)!==((o=e.coords)===null||o===void 0?void 0:o.clientX)||((c=t.coords)===null||c===void 0?void 0:c.clientY)!==((l=e.coords)===null||l===void 0?void 0:l.clientY)||((u=t.coords)===null||u===void 0?void 0:u.offsetX)!==((h=e.coords)===null||h===void 0?void 0:h.offsetX)||((d=t.coords)===null||d===void 0?void 0:d.offsetY)!==((f=e.coords)===null||f===void 0?void 0:f.offsetY)||((p=t.coords)===null||p===void 0?void 0:p.pageX)!==((g=e.coords)===null||g===void 0?void 0:g.pageX)||((_=t.coords)===null||_===void 0?void 0:_.pageY)!==((v=e.coords)===null||v===void 0?void 0:v.pageY)||((E=t.coords)===null||E===void 0?void 0:E.screenX)!==((T=e.coords)===null||T===void 0?void 0:T.screenX)||((x=t.coords)===null||x===void 0?void 0:x.screenY)!==((N=e.coords)===null||N===void 0?void 0:N.screenY)||((A=t.caret)===null||A===void 0?void 0:A.node)!==((I=e.caret)===null||I===void 0?void 0:I.node)||((k=t.caret)===null||k===void 0?void 0:k.offset)!==((L=e.caret)===null||L===void 0?void 0:L.offset)}function oS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Jit{move(e,n,i){const r=this.position,s=this.getTarget(e);if(this.position=n,!Yge(r,n))return;const a=this.getTarget(e),o=this.getEventInit("mousemove"),[c,l]=rM(s,a);return{leave:()=>{s!==a&&(e.dispatchUIEvent(s,"mouseout",o),c.forEach(u=>e.dispatchUIEvent(u,"mouseleave",o)))},enter:()=>{s!==a&&(e.dispatchUIEvent(a,"mouseover",o),l.forEach(u=>e.dispatchUIEvent(u,"mouseenter",o)))},move:()=>{i||(e.dispatchUIEvent(a,"mousemove",o),this.modifySelecting(e))}}}down(e,n,i){const r=this.buttons.down(n);if(r===void 0)return;const s=this.getTarget(e);this.buttonDownTarget[r]=s;const a=this.getEventInit("mousedown",n.button),o=oy(s);!i&&(o||e.dispatchUIEvent(s,"mousedown",a))&&(this.startSelecting(e,a.detail),Nb(s)),!o&&sG(n.button)===2&&e.dispatchUIEvent(s,"contextmenu",this.getEventInit("contextmenu",n.button))}up(e,n,i){const r=this.buttons.up(n);if(r===void 0)return;const s=this.getTarget(e);if(!oy(s)){if(!i){const o=this.getEventInit("mouseup",n.button);e.dispatchUIEvent(s,"mouseup",o),this.endSelecting()}const a=rM(this.buttonDownTarget[r],s)[2][0];if(a){const o=this.getEventInit("click",n.button);o.detail&&(e.dispatchUIEvent(a,o.button===0?"click":"auxclick",o),o.button===0&&o.detail===2&&e.dispatchUIEvent(a,"dblclick",{...this.getEventInit("dblclick",n.button),detail:o.detail}))}}}resetClickCount(){this.clickCount.reset()}getEventInit(e,n){const i={...this.position.coords};return i.button=sG(n),i.buttons=this.buttons.getButtons(),e==="mousedown"?i.detail=this.clickCount.getOnDown(i.button):e==="mouseup"?i.detail=this.clickCount.getOnUp(i.button):(e==="click"||e==="auxclick")&&(i.detail=this.clickCount.incOnClick(i.button)),i}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}startSelecting(e,n){var i,r;this.selecting=Yit({document:e.config.document,target:this.getTarget(e),node:(i=this.position.caret)===null||i===void 0?void 0:i.node,offset:(r=this.position.caret)===null||r===void 0?void 0:r.offset,clickCount:n})}modifySelecting(e){var n,i;this.selecting&&Kit(this.selecting,{document:e.config.document,target:this.getTarget(e),node:(n=this.position.caret)===null||n===void 0?void 0:n.node,offset:(i=this.position.caret)===null||i===void 0?void 0:i.offset})}endSelecting(){this.selecting=void 0}constructor(){oS(this,"position",{}),oS(this,"buttons",new $ge),oS(this,"selecting",void 0),oS(this,"buttonDownTarget",{}),oS(this,"clickCount",new class{incOnClick(e){const n=this.down[e]===void 0?void 0:Number(this.down[e])+1;return this.count=this.count[e]===void 0?{}:{[e]:Number(this.count[e])+1},n}getOnDown(e){var n;this.down={[e]:(n=this.count[e])!==null&&n!==void 0?n:0};var i;return this.count={[e]:(i=this.count[e])!==null&&i!==void 0?i:0},Number(this.count[e])+1}getOnUp(e){return this.down[e]===void 0?void 0:Number(this.down[e])+1}reset(){this.count={}}constructor(){oS(this,"down",{}),oS(this,"count",{})}})}}function uU(t,e){var n;return((n=Xge(t,e))===null||n===void 0?void 0:n.pointerEvents)!=="none"}function Zit(t){const e=hp(t);for(let n=t,i=[];n!=null&&n.ownerDocument;n=n.parentElement){i.push(n);const r=e.getComputedStyle(n).pointerEvents;if(r&&!["inherit","unset"].includes(r))return{pointerEvents:r,tree:i}}}const Zte=Symbol("Last check for pointer-events");function Xge(t,e){const n=e[Zte];if(!(t.config.pointerEventsCheck!==EP.Never&&(!n||Qte(t.config.pointerEventsCheck,EP.EachApiCall)&&n[Nd.Call]!==_D(t,Nd.Call)||Qte(t.config.pointerEventsCheck,EP.EachTrigger)&&n[Nd.Trigger]!==_D(t,Nd.Trigger))))return n==null?void 0:n.result;const r=Zit(e);return e[Zte]={[Nd.Call]:_D(t,Nd.Call),[Nd.Trigger]:_D(t,Nd.Trigger),result:r},r}function TA(t,e){const n=Xge(t,e);if((n==null?void 0:n.pointerEvents)==="none")throw new Error([`Unable to perform pointer interaction as the element ${n.tree.length>1?"inherits":"has"} \`pointer-events: none\`:`,"",Qit(n.tree)].join(`
`))}function Qit(t){return t.reverse().map((e,n)=>["".padEnd(n),e.tagName,e.id&&`#${e.id}`,e.hasAttribute("data-testid")&&`(testId=${e.getAttribute("data-testid")})`,ert(e),t.length>1&&n===0&&"  <-- This element declared `pointer-events: none`",t.length>1&&n===t.length-1&&"  <-- Asserted pointer events here"].filter(Boolean).join("")).join(`
`)}function ert(t){var e;let n;if(t.hasAttribute("aria-label"))n=t.getAttribute("aria-label");else if(t.hasAttribute("aria-labelledby")){var i,r;n=(r=t.ownerDocument.getElementById(t.getAttribute("aria-labelledby")))===null||r===void 0||(i=r.textContent)===null||i===void 0?void 0:i.trim()}else if(mr(t,["button","input","meter","output","progress","select","textarea"])&&(!((e=t.labels)===null||e===void 0)&&e.length))n=Array.from(t.labels).map(a=>{var o;return(o=a.textContent)===null||o===void 0?void 0:o.trim()}).join("|");else if(mr(t,"button")){var s;n=(s=t.textContent)===null||s===void 0?void 0:s.trim()}return n=n==null?void 0:n.replace(/\n/g,"  "),Number(n==null?void 0:n.length)>30&&(n=`${n==null?void 0:n.substring(0,29)}`),n?`(label=${n})`:""}function Qte(t,e){return(t&e)>0}function mv(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class trt{init(e){const n=this.getTarget(e),[,i]=rM(null,n),r=this.getEventInit();return TA(e,n),e.dispatchUIEvent(n,"pointerover",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerenter",r)),this}move(e,n){const i=this.position,r=this.getTarget(e);if(this.position=n,!Yge(i,n))return;const s=this.getTarget(e),a=this.getEventInit(-1),[o,c]=rM(r,s);return{leave:()=>{uU(e,r)&&r!==s&&(e.dispatchUIEvent(r,"pointerout",a),o.forEach(l=>e.dispatchUIEvent(l,"pointerleave",a)))},enter:()=>{TA(e,s),r!==s&&(e.dispatchUIEvent(s,"pointerover",a),c.forEach(l=>e.dispatchUIEvent(l,"pointerenter",a)))},move:()=>{e.dispatchUIEvent(s,"pointermove",a)}}}down(e,n=0){if(this.isDown)return;const i=this.getTarget(e);TA(e,i),this.isDown=!0,this.isPrevented=!e.dispatchUIEvent(i,"pointerdown",this.getEventInit(n))}up(e,n=0){if(!this.isDown)return;const i=this.getTarget(e);TA(e,i),this.isPrevented=!1,this.isDown=!1,e.dispatchUIEvent(i,"pointerup",this.getEventInit(n))}release(e){const n=this.getTarget(e),[i]=rM(n,null),r=this.getEventInit();uU(e,n)&&(e.dispatchUIEvent(n,"pointerout",r),i.forEach(s=>e.dispatchUIEvent(s,"pointerleave",r))),this.isCancelled=!0}getTarget(e){var n;return(n=this.position.target)!==null&&n!==void 0?n:e.config.document.body}getEventInit(e){return{...this.position.coords,pointerId:this.pointerId,pointerType:this.pointerType,isPrimary:this.isPrimary,button:sG(e),buttons:this.buttons.getButtons()}}constructor({pointerId:e,pointerType:n,isPrimary:i},r){mv(this,"pointerId",void 0),mv(this,"pointerType",void 0),mv(this,"isPrimary",void 0),mv(this,"buttons",void 0),mv(this,"isMultitouch",!1),mv(this,"isCancelled",!1),mv(this,"isDown",!1),mv(this,"isPrevented",!1),mv(this,"position",{}),this.pointerId=e,this.pointerType=n,this.isPrimary=i,this.isMultitouch=!i,this.buttons=r}}function h_(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class nrt{isKeyPressed(e){return this.devices.get(e.pointerType).isPressed(e)}async press(e,n,i){this.devices.get(n.pointerType).addPressed(n),this.buttons.down(n);const r=this.getPointerName(n),s=n.pointerType==="touch"?this.pointers.new(r,n.pointerType,this.buttons):this.pointers.get(r);s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),s.pointerType==="touch"&&s.init(e),s.down(e,n.button),s.pointerType!=="touch"&&this.mouse.down(e,n,s.isPrevented)}async move(e,n,i){const r=this.pointers.get(n),s=r.move(e,i),a=r.pointerType==="touch"?void 0:this.mouse.move(e,i,r.isPrevented);s==null||s.leave(),a==null||a.leave(),s==null||s.enter(),a==null||a.enter(),s==null||s.move(),a==null||a.move()}async release(e,n,i){const r=this.devices.get(n.pointerType);r.removePressed(n),this.buttons.up(n);const s=this.pointers.get(this.getPointerName(n)),a=s.isPrevented;if(s.position=i,s.pointerType!=="touch"&&(this.mouse.position=i),r.countPressed===0&&s.up(e,n.button),s.pointerType==="touch"&&s.release(e),s.pointerType==="touch"&&!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.down(e,n,a)}if(!s.isMultitouch){const o=this.mouse.move(e,i,a);o==null||o.leave(),o==null||o.enter(),o==null||o.move(),this.mouse.up(e,n,a)}}getPointerName(e){return e.pointerType==="touch"?e.name:e.pointerType}getPreviousPosition(e){return this.pointers.has(e)?this.pointers.get(e).position:void 0}resetClickCount(){this.mouse.resetClickCount()}getMouseTarget(e){var n;return(n=this.mouse.position.target)!==null&&n!==void 0?n:e.config.document.body}setMousePosition(e){this.mouse.position=e,this.pointers.get("mouse").position=e}constructor(e){h_(this,"system",void 0),h_(this,"mouse",void 0),h_(this,"buttons",void 0),h_(this,"devices",new class{get(n){var i,r,s;return(s=(i=this.registry)[r=n])!==null&&s!==void 0?s:i[r]=new Wit}constructor(){h_(this,"registry",{})}}),h_(this,"pointers",new class{new(n,i,r){const s=i!=="touch"||!Object.values(this.registry).some(a=>a.pointerType==="touch"&&!a.isCancelled);return s||Object.values(this.registry).forEach(a=>{a.pointerType===i&&!a.isCancelled&&(a.isMultitouch=!0)}),this.registry[n]=new trt({pointerId:this.nextId++,pointerType:i,isPrimary:s},r),this.registry[n]}get(n){if(!this.has(n))throw new Error(`Trying to access pointer "${n}" which does not exist.`);return this.registry[n]}has(n){return n in this.registry}constructor(){h_(this,"registry",{}),h_(this,"nextId",1)}}),this.system=e,this.buttons=new $ge,this.mouse=new Jit,this.pointers.new("mouse","mouse",this.buttons)}}function ene(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class Kge{getUIEventModifiers(){return{altKey:this.keyboard.modifiers.Alt,ctrlKey:this.keyboard.modifiers.Control,metaKey:this.keyboard.modifiers.Meta,shiftKey:this.keyboard.modifiers.Shift,modifierAltGraph:this.keyboard.modifiers.AltGraph,modifierCapsLock:this.keyboard.modifiers.CapsLock,modifierFn:this.keyboard.modifiers.Fn,modifierFnLock:this.keyboard.modifiers.FnLock,modifierNumLock:this.keyboard.modifiers.NumLock,modifierScrollLock:this.keyboard.modifiers.ScrollLock,modifierSymbol:this.keyboard.modifiers.Symbol,modifierSymbolLock:this.keyboard.modifiers.SymbolLock}}constructor(){ene(this,"keyboard",new jit(this)),ene(this,"pointer",new nrt(this))}}async function irt(t){const e=[];return this.config.skipHover||e.push({target:t}),e.push({keys:"[MouseLeft]",target:t}),this.pointer(e)}async function rrt(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft]"])}async function srt(t){return this.pointer([{target:t},"[MouseLeft][MouseLeft][MouseLeft]"])}async function art(t){return this.pointer({target:t})}async function ort(t){return TA(this,this.system.pointer.getMouseTarget(this)),this.pointer({target:t.ownerDocument.body})}async function crt({shift:t}={}){return this.keyboard(t===!0?"{Shift>}{Tab}{/Shift}":t===!1?"[/ShiftLeft][/ShiftRight]{Tab}":"{Tab}")}var x9=function(t){return t["{"]="}",t["["]="]",t}(x9||{});function Jge(t,e){let n=0;const i=t[n]in x9?t[n]:"";n+=i.length;const s=new RegExp(`^\\${i}{2}`).test(t)?"":i;return{type:s,...s===""?lrt(t,n,e):urt(t,n,s,e)}}function lrt(t,e,n){const i=t[e];return Zge(i,t,e,n),e+=i.length,{consumedLength:e,descriptor:i,releasePrevious:!1,releaseSelf:!0,repeat:1}}function urt(t,e,n,i){var r,s;const a=t[e]==="/"?"/":"";e+=a.length;const o=n==="{"&&t[e]==="\\";e+=Number(o);const c=o?t[e]:(r=t.slice(e).match(n==="{"?/^\w+|^[^}>/]/:/^\w+/))===null||r===void 0?void 0:r[0];Zge(c,t,e,i),e+=c.length;var l;const u=(l=(s=t.slice(e).match(/^>\d+/))===null||s===void 0?void 0:s[0])!==null&&l!==void 0?l:"";e+=u.length;const h=t[e]==="/"||!u&&t[e]===">"?t[e]:"";e+=h.length;const d=x9[n],f=t[e]===d?d:"";if(!f)throw new Error(Qge([!u&&"repeat modifier",!h&&"release modifier",`"${d}"`].filter(Boolean).join(" or "),t[e],t,i));return e+=f.length,{consumedLength:e,descriptor:c,releasePrevious:!!a,repeat:u?Math.max(Number(u.substr(1)),1):1,releaseSelf:hrt(h,u)}}function Zge(t,e,n,i){if(!t)throw new Error(Qge("key descriptor",e[n],e,i))}function hrt(t,e){if(t)return t==="/";if(e)return!1}function Qge(t,e,n,i){return`Expected ${t} but found "${e??""}" in "${n}"
    See ${i==="pointer"?"https://testing-library.com/docs/user-event/pointer#pressing-a-button-or-touching-the-screen":"https://testing-library.com/docs/user-event/keyboard"}
    for more information about how userEvent parses your input.`}function drt(t,e){const n=[];do{const{type:r,descriptor:s,consumedLength:a,releasePrevious:o,releaseSelf:c=!0,repeat:l}=Jge(e,"keyboard");var i;const u=(i=t.find(h=>{if(r==="["){var d;return((d=h.code)===null||d===void 0?void 0:d.toLowerCase())===s.toLowerCase()}else if(r==="{"){var f;return((f=h.key)===null||f===void 0?void 0:f.toLowerCase())===s.toLowerCase()}return h.key===s}))!==null&&i!==void 0?i:{key:"Unknown",code:"Unknown",[r==="["?"code":"key"]:s};n.push({keyDef:u,releasePrevious:o,releaseSelf:c,repeat:l}),e=e.slice(a)}while(e);return n}async function frt(t){const e=drt(this.config.keyboardMap,t);for(let n=0;n<e.length;n++)await EC(this.config),await prt(this,e[n])}async function prt(t,{keyDef:e,releasePrevious:n,releaseSelf:i,repeat:r}){const{system:s}=t;if(s.keyboard.isKeyPressed(e)&&await s.keyboard.keyup(t,e),!n){for(let a=1;a<=r;a++)await s.keyboard.keydown(t,e),a<r&&await EC(t.config);i&&await s.keyboard.keyup(t,e)}}async function mrt(t){for(const e of t.system.keyboard.getPressedKeys())await t.system.keyboard.keyup(t,e)}function e0e(t){const e=r0(t)?{"text/plain":grt(t)}:{"text/plain":String(t.ownerDocument.getSelection())},n=a9(hp(t));for(const i in e)e[i]&&n.setData(i,e[i]);return n}function grt(t){const e=SO(t);return s0(t).substring(e.startOffset,e.endOffset)}async function vrt(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=e0e(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"copy",{clipboardData:i})&&this.config.writeToClipboard&&await Kpe(t,i),i}async function yrt(){const t=this.config.document;var e;const n=(e=t.activeElement)!==null&&e!==void 0?e:t.body,i=e0e(n);if(i.items.length!==0)return this.dispatchUIEvent(n,"cut",{clipboardData:i})&&this.config.writeToClipboard&&await Kpe(n.ownerDocument,i),i}async function _rt(t){const e=this.config.document;var n;const i=(n=e.activeElement)!==null&&n!==void 0?n:e.body;var r;const s=(r=typeof t=="string"?brt(e,t):t)!==null&&r!==void 0?r:await mqe(e).catch(()=>{throw new Error("`userEvent.paste()` without `clipboardData` requires the `ClipboardAPI` to be available.")});this.dispatchUIEvent(i,"paste",{clipboardData:s})}function brt(t,e){const n=a9(hp(t));return n.setData("text",e),n}function tne(t,e){const n=[];do{const{descriptor:i,consumedLength:r,releasePrevious:s,releaseSelf:a=!0}=Jge(e,"pointer"),o=t.find(c=>c.name===i);o&&n.push({keyDef:o,releasePrevious:s,releaseSelf:a}),e=e.slice(r)}while(e);return n}async function Ert(t){const{pointerMap:e}=this.config,n=[];(Array.isArray(t)?t:[t]).forEach(i=>{typeof i=="string"?n.push(...tne(e,i)):"keys"in i?n.push(...tne(e,i.keys).map(r=>({...i,...r}))):n.push(i)});for(let i=0;i<n.length;i++)await EC(this.config),await Srt(this,n[i]);this.system.pointer.resetClickCount()}async function Srt(t,e){var n,i;const r="pointerName"in e&&e.pointerName?e.pointerName:"keyDef"in e?t.system.pointer.getPointerName(e.keyDef):"mouse",s=t.system.pointer.getPreviousPosition(r);var a,o,c,l;const u={target:(a=e.target)!==null&&a!==void 0?a:Trt(t,s),coords:(o=e.coords)!==null&&o!==void 0?o:s==null?void 0:s.coords,caret:{node:(c=e.node)!==null&&c!==void 0?c:nne(e)||s==null||(n=s.caret)===null||n===void 0?void 0:n.node,offset:(l=e.offset)!==null&&l!==void 0?l:nne(e)||s==null||(i=s.caret)===null||i===void 0?void 0:i.offset}};"keyDef"in e?(t.system.pointer.isKeyPressed(e.keyDef)&&(SA(t,Nd.Trigger),await t.system.pointer.release(t,e.keyDef,u)),e.releasePrevious||(SA(t,Nd.Trigger),await t.system.pointer.press(t,e.keyDef,u),e.releaseSelf&&(SA(t,Nd.Trigger),await t.system.pointer.release(t,e.keyDef,u)))):(SA(t,Nd.Trigger),await t.system.pointer.move(t,r,u))}function nne(t){var e,n;return!!((n=(e=t.target)!==null&&e!==void 0?e:t.node)!==null&&n!==void 0?n:t.offset!==void 0)}function Trt(t,e){if(!e)throw new Error("This pointer has no previous position. Provide a target property!");var n;return(n=e.target)!==null&&n!==void 0?n:t.config.document.body}async function xrt(t){if(!gC(t)||oy(t))throw new Error("clear()` is only supported on editable elements.");if(Nb(t),t.ownerDocument.activeElement!==t)throw new Error("The element to be cleared could not be focused.");if(Fge(t),!_it(t))throw new Error("The element content to be cleared could not be selected.");bC(this,t,"","deleteContentBackward")}async function wrt(t,e){return t0e.call(this,!0,t,e)}async function Crt(t,e){return t0e.call(this,!1,t,e)}async function t0e(t,e,n){if(!t&&!e.multiple)throw as().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",e);const i=Array.isArray(n)?n:[n],r=Array.from(e.querySelectorAll('option, [role="option"]')),s=i.map(o=>{if(typeof o!="string"&&r.includes(o))return o;{const c=r.find(l=>l.value===o||l.innerHTML===o);if(c)return c;throw as().getElementError(`Value "${String(o)}" not found in options`,e)}}).filter(o=>!oy(o));if(oy(e)||!s.length)return;const a=o=>{o.selected=t,this.dispatchUIEvent(e,"input",{bubbles:!0,cancelable:!1,composed:!0}),this.dispatchUIEvent(e,"change")};if(mr(e,"select"))if(e.multiple)for(const o of s){const c=this.config.pointerEventsCheck===0?!0:uU(this,o);c&&(this.dispatchUIEvent(o,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(o,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(o,"pointermove"),this.dispatchUIEvent(o,"mousemove"),this.dispatchUIEvent(o,"pointerdown"),this.dispatchUIEvent(o,"mousedown")),Nb(e),c&&(this.dispatchUIEvent(o,"pointerup"),this.dispatchUIEvent(o,"mouseup")),a(o),c&&this.dispatchUIEvent(o,"click"),await EC(this.config)}else if(s.length===1){const o=this.config.pointerEventsCheck===0?!0:uU(this,e);o?await this.click(e):Nb(e),a(s[0]),o&&(this.dispatchUIEvent(e,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(e,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(e,"pointerup"),this.dispatchUIEvent(e,"mouseup"),this.dispatchUIEvent(e,"click")),await EC(this.config)}else throw as().getElementError("Cannot select multiple options on a non-multiple select",e);else if(e.getAttribute("role")==="listbox")for(const o of s)await this.click(o),await this.unhover(o);else throw as().getElementError("Cannot select options on elements that are neither select nor listbox elements",e)}async function Rrt(t,e,{skipClick:n=this.config.skipClick,skipAutoClose:i=this.config.skipAutoClose,initialSelectionStart:r,initialSelectionEnd:s}={}){t.disabled||(n||await this.click(t),r!==void 0&&EA(t,r,s??r),await this.keyboard(e),i||await mrt(this))}const ine=Symbol("files and value properties are mocked");function LH(t,e,n){n?Object.defineProperty(t,e,n):delete t[e]}function Art(t,e){var n;(n=t[ine])===null||n===void 0||n.restore();const i=Object.getOwnPropertyDescriptor(t,"type"),r=Object.getOwnPropertyDescriptor(t,"value"),s=Object.getOwnPropertyDescriptor(t,"files");function a(){LH(t,"type",i),LH(t,"value",r),LH(t,"files",s)}t[ine]={restore:a},Object.defineProperties(t,{files:{configurable:!0,get:()=>e},value:{configurable:!0,get:()=>e.length?`C:\\fakepath\\${e[0].name}`:"",set(o){if(o==="")a();else{var c;r==null||(c=r.set)===null||c===void 0||c.call(t,o)}}},type:{configurable:!0,get:()=>"file",set(o){o!=="file"&&(a(),t.type=o)}}})}async function Mrt(t,e){const n=mr(t,"label")?t.control:t;if(!n||!mr(n,"input",{type:"file"}))throw new TypeError(`The ${n===t?"given":"associated"} ${n==null?void 0:n.tagName} element does not accept file uploads`);if(oy(t))return;const i=(Array.isArray(e)?e:[e]).filter(s=>!this.config.applyAccept||Ort(s,n.accept)).slice(0,n.multiple?void 0:1),r=()=>{var s;i.length===((s=n.files)===null||s===void 0?void 0:s.length)&&i.every((a,o)=>{var c;return a===((c=n.files)===null||c===void 0?void 0:c.item(o))})||(Art(n,s9(hp(t),i)),this.dispatchUIEvent(n,"input"),this.dispatchUIEvent(n,"change"))};n.addEventListener("fileDialog",r),await this.click(t),n.removeEventListener("fileDialog",r)}function bD(t){return t.toLowerCase().replace(/(\.|\/)jpg\b/g,"$1jpeg")}function Ort(t,e){if(!e)return!0;const n=["audio/*","image/*","video/*"];return bD(e).trim().split(/\s*,\s*/).some(i=>i.startsWith(".")?bD(t.name).endsWith(i):n.includes(i)?bD(t.type).startsWith(i.replace("*","")):bD(t.type)===i)}const rne={click:irt,dblClick:rrt,tripleClick:srt,hover:art,unhover:ort,tab:crt,keyboard:frt,copy:vrt,cut:yrt,paste:_rt,pointer:Ert,clear:xrt,deselectOptions:Crt,selectOptions:wrt,type:Rrt,upload:Mrt};function Nrt(t){return as().asyncWrapper(t)}const n0e={applyAccept:!0,autoModify:!0,delay:0,document:globalThis.document,keyboardMap:Vit,pointerMap:Git,pointerEventsCheck:EP.EachApiCall,skipAutoClose:!1,skipClick:!1,skipHover:!1,writeToClipboard:!1,advanceTimers:()=>Promise.resolve()},Irt={...n0e,writeToClipboard:!0};function i0e(t={},e=Irt,n){const i=Lrt(t,n,e);return{...e,...t,document:i}}function krt(t={}){const e=i0e(t);qge(e.document),Gge(hp(e.document).HTMLElement);var n;const i=(n=e.document.defaultView)!==null&&n!==void 0?n:globalThis.window;return dqe(i),w9(e).api}function pu({keyboardState:t,pointerState:e,...n}={},i){const r=i0e(n,n0e,i);qge(r.document),Gge(hp(r.document).HTMLElement);var s;const a=(s=e??t)!==null&&s!==void 0?s:new Kge;return{api:w9(r,a).api,system:a}}function Drt(t){return w9({...this.config,...t},this.system).api}function Prt(t,e){function n(...i){return SA(t,Nd.Call),Nrt(()=>e.apply(t,i).then(async r=>(await EC(t.config),r)))}return Object.defineProperty(n,"name",{get:()=>e.name}),n}function w9(t,e=new Kge){const n={};return Object.assign(n,{config:t,dispatchEvent:Vge.bind(n),dispatchUIEvent:kit.bind(n),system:e,levelRefs:{},...rne}),{instance:n,api:{...Object.fromEntries(Object.entries(rne).map(([i,r])=>[i,Prt(n,r)])),setup:Drt.bind(n)}}}function Lrt(t,e,n){var i,r;return(r=(i=t.document)!==null&&i!==void 0?i:e&&Bit(e))!==null&&r!==void 0?r:n.document}function Urt(t){return pu().api.clear(t)}function Brt(t,e={}){return pu(e,t).api.click(t)}function Frt(t={}){return pu(t).api.copy()}function zrt(t={}){return pu(t).api.cut()}function Hrt(t,e={}){return pu(e).api.dblClick(t)}function jrt(t,e,n={}){return pu(n).api.deselectOptions(t,e)}function Vrt(t,e={}){return pu(e).api.hover(t)}async function Grt(t,e={}){const{api:n,system:i}=pu(e);return n.keyboard(t).then(()=>i)}async function qrt(t,e={}){const{api:n,system:i}=pu(e);return n.pointer(t).then(()=>i)}function $rt(t,e){return pu(e).api.paste(t)}function Wrt(t,e,n={}){return pu(n).api.selectOptions(t,e)}function Yrt(t,e={}){return pu(e).api.tripleClick(t)}function Xrt(t,e,n={}){return pu(n,t).api.type(t,e,n)}function Krt(t,e={}){const{api:n,system:i}=pu(e);return i.pointer.setMousePosition({target:t}),n.unhover(t)}function Jrt(t,e,n={}){return pu(n).api.upload(t,e)}function Zrt(t={}){return pu().api.tab(t)}const Qrt=Object.freeze(Object.defineProperty({__proto__:null,clear:Urt,click:Brt,copy:Frt,cut:zrt,dblClick:Hrt,deselectOptions:jrt,hover:Vrt,keyboard:Grt,paste:$rt,pointer:qrt,selectOptions:Wrt,tab:Zrt,tripleClick:Yrt,type:Xrt,unhover:Krt,upload:Jrt},Symbol.toStringTag,{value:"Module"})),est={...Qrt,setup:krt},Md=est.setup({delay:null});function Ia(){return window.sysclipboard}function C9(t){const e=new Set;function n(s){oDe(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),YM.invoke(s))}const i=qb("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),t(s))});function r(){YM.disconnect(i)}return{forward:n,disconnect:r}}function tst(t){switch(t.target){case"tick":case"tock":case"ready":return!0}return!1}function nst(t){switch(t.target){case"info":case"debug":case"error":case"tick":case"tock":case"ready":case"second":return!0;default:{const e=jT(t.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}function ist(t){return!1}function r0e(t){const e=jT(t.target);switch(e.target){case"vm":case"modem":case"gadgetserver":return!0}switch(e.path){case"sync":case"joinack":return!0}return!1}function rst(t){return new Worker("/assets/simspace-C6F2bAvW.js",{name:t==null?void 0:t.name})}function sst(t){return new Worker("/assets/stubspace-DMmF7b2_.js",{name:t==null?void 0:t.name})}let ED;function ast(t=!1){if(!ae(ED)){ED=t?new sst:new rst;const{forward:e}=C9(n=>{r0e(n)&&ED.postMessage(n)});ED.addEventListener("message",n=>e(n.data))}}async function ost(t){return uPe(t)}async function cst(t,e){return hPe(t,e)}function lst(t){try{return sessionStorage.getItem(t)??void 0}catch(e){Hi(Mi,va,`readsession ${t}`,e.message)}}function ust(t,e){try{ae(e)?sessionStorage.setItem(t,e):sessionStorage.removeItem(t)}catch(n){Hi(Mi,va,`writesession ${t} <- ${e}`,n.message)}}function oG(){try{const t=location.hash.slice(1);if(t.length)return t}catch(t){Hi(Mi,va,"crash",t.message)}return""}function s0e(){iLe(Mi,va,"https://github.com/goldbuick/zed-software-system/wiki","open help wiki")}const hst=["$brown$153","$purple$5","$green$42","$ltgray$94","$white$24","$white$25","$white$26","$white$27","$white$16","$white$17","$white$30","$white$31","$red$234","$cyan$227","$dkpurple$227"];function sne(t){return Li(t.data)?[t.sender,...t.data.map(e=>`${e}`)].join(" "):""}function UH(t){const{terminal:e}=Us.getState();let i=[[Do(),t.target,_de(t.sender,hst),...t.data],...e.logs];i.length>NZ&&(i=i.slice(0,NZ)),Us.setState(r=>({terminal:{...r.terminal,logs:i}}))}function dst(t){const{layout:e,editor:n}=Us.getState();let r=e+(t?1:-1);if(r<0&&(r+=kd.MAX),r>=kd.MAX&&(r-=kd.MAX),!n.open)switch(r){case kd.SPLIT_Y:case kd.SPLIT_Y_ALT:r=kd.TOP;break}Us.setState({layout:r})}async function cG(t){if(t.length===0){Hi(Mi,va,"content","no content found"),s0e(),i7(Mi,va);return}const e=await pst()??"";qDe(Mi,va,t,e)}let hU="";window.addEventListener("hashchange",()=>{qu(Mi,va,async()=>{const t=oG();hU!==t&&(hU=t,await cG(t))})});function fst(t,e){const n=`#${t}`;if(location.hash!==n){hU=t,location.hash=n;const i=`wrote ${(t==null?void 0:t.length)??0} chars [${t.slice(0,8)}...${t.slice(-8)}]`;e.includes("autosave")?cDe(Mi,va,i):(e.length&&(document.title=e),Ug(Mi,va,i))}}async function pst(){return ost("SELECTED")}async function mst(t){return cst("SELECTED",()=>t)}let BH=0;const ane=1,va=lst("PLAYER")??xPe();ust("PLAYER",va);function nr(){return va}const Mi=qb("register",["ready","second","info","error","debug","toast"],function(t){if(!Mi.session(t))return;switch(t.target){case"ready":case"second":break;default:if(t.player!==va)return;break}const{terminal:e}=Us.getState();switch(t.target){case"ready":{qu(Mi,t.player,async()=>{await zp(256),wi(Mi,va,`myplayerid ${va}`),jDe(Mi,va)});break}case"loginfail":Lv(Mi,va,"#pages"),s0e(),i7(Mi,va);break;case"ackoperator":qu(Mi,t.player,async()=>{const n=oG();Wue()?_De(Mi,va,n):(GDe(Mi,va,Z5()),await cG(n))});break;case"loginready":WDe(Mi,va);break;case"acklogin":m2(Mi,va),xDe(Mi,va),VDe(Mi,va);break;case"ackzsswords":Eo.setState({zsswords:t.data});break;case"copy":On(t.data)&&ae(Ia())&&Ia().writeText(t.data).then(()=>$a(Mi,t.player,"copied!")).catch(n=>console.error(n));break;case"copyjsonfile":if(Li(t.data)&&ae(Ia())){const[n,i]=t.data,r=new Blob([JSON.stringify({exported:i,data:n},null,2)],{type:"text/plain"});Ia().write([new ClipboardItem({[r.type]:r})]).then(()=>$a(Mi,t.player,"copied!")).catch(s=>console.error(s))}break;case"downloadjsonfile":if(Li(t.data)){const[n,i]=t.data;try{const r=new Blob([JSON.stringify({exported:i,data:n},null,2)],{type:"application/json;charset=utf-8"}),s=URL.createObjectURL(r),a=document.createElement("a");a.href=s,a.download=i,a.click(),URL.revokeObjectURL(s)}catch(r){console.error(r)}}break;case"dev":qu(Mi,t.player,async function(){if(Z5()){const n=await J5(location.href);g2(Mi,t.player,n,n)}else jp(Mi,t.player,"creating locked terminal"),await zp(100),location.href=location.href.replace("/#","/locked/#")});break;case"share":qu(Mi,t.player,async function(){const n=await J5(location.href.replace(/cafe.*locked/,"cafe"));g2(Mi,t.player,n,n)});break;case"nuke":qu(Mi,t.player,async function(){jp(Mi,t.player,"nuke in"),cr(Mi,t.player,"3","..."),await zp(1e3),cr(Mi,t.player,"2","..."),await zp(1e3),cr(Mi,t.player,"1","..."),await zp(1e3),jp(Mi,t.player,"BYE"),await zp(100),location.hash="",hU=location.hash,location.reload()});break;case"savemem":if(Li(t.data)){const[n,i]=t.data;On(n)&&On(i)&&fst(i,n)}break;case"forkmem":if(Li(t.data)){const[n]=t.data;On(n)&&window.open(location.href.replace(/#.*/,`#${n}`),"_blank")}break;case"select":qu(Mi,t.player,async()=>{On(t.data)&&(await mst(t.data),await cG(oG()))});break;case"second":++BH,BH>=ane&&(BH-=ane,XDe(Mi,va));break;case"inspector":Us.setState(n=>{const i=ae(t.data)?!!t.data:!n.inspector;return wi(Mi,t.player,`gadget inspector ${i?"$greenon":"$redoff"}`),i&&wi(Mi,t.player,"mouse click or tap elements to inspect"),{inspector:i}});break;case"info":e.level>=tP.INFO&&UH(t);break;case"debug":e.level>=tP.DEBUG&&(UH(t),console.debug(sne(t)));break;case"error":e.level>tP.OFF&&UH(t),console.error(sne(t));break;case"toast":qu(Mi,t.player,async()=>{if(ae(t.data)){const n=Math.min(Math.max(t.data.length*150,3e3),14e3);Us.setState({toast:t.data}),await zp(n),Us.setState({toast:""})}});break;case"terminal:full":Us.setState(n=>({layout:kd.FULL,terminal:{...n.terminal,open:!0}}));break;case"terminal:open":Us.setState(n=>({terminal:{...n.terminal,open:!0}}));break;case"terminal:quickopen":Us.setState({quickterminal:!0});break;case"terminal:close":Us.setState(n=>({quickterminal:!1,terminal:{...n.terminal,open:!1}}));break;case"terminal:toggle":Us.setState(n=>({terminal:{...n.terminal,open:!n.terminal.open}}));break;case"terminal:inclayout":aDe(t.data)&&dst(t.data);break;case"editor:open":if(Li(t.data)){const[n,i,r,s,a]=t.data;Us.setState(o=>({editor:{open:!0,player:t.player,book:n,path:i,type:r,title:s,refsheet:a.length?a:o.editor.refsheet}}))}break;case"editor:close":Us.setState(n=>({editor:{...n.editor,open:!1}}));break;default:{const{target:n,path:i}=jT(t.target);switch(n){case"touchkey":qu(Mi,t.player,async()=>{switch(i){case"[Alt]":b_(Mi,t.player,"","-c",!0),zh.setState(r=>({...r,keyboardalt:!r.keyboardalt,keyboardctrl:!1,keyboardshift:!1}));break;case"[Ctrl]":b_(Mi,t.player,"","-e",!0),zh.setState(r=>({...r,keyboardalt:!1,keyboardctrl:!r.keyboardctrl,keyboardshift:!1}));break;case"[Shift]":b_(Mi,t.player,"","-g",!0),zh.setState(r=>({...r,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!r.keyboardshift}));break;default:{const r=!isNaN(parseInt(i,10)),s=zh.getState(),a=[],o=Ab?"Meta":"Ctrl";s.keyboardshift?(b_(Mi,t.player,"",r?"+c":"+f",!0),a.push("{Shift>}")):s.keyboardalt?(b_(Mi,t.player,"",r?"+c!":"+f!",!0),a.push("{Alt>}")):s.keyboardctrl?(b_(Mi,t.player,"",r?"+c#":"+f#",!0),a.push(`{${o}>}`)):b_(Mi,t.player,"",r?"-c":"-f",!0),a.push(i),s.keyboardshift?a.push("{/Shift}"):s.keyboardalt?a.push("{/Alt}"):s.keyboardctrl&&a.push(`{/${o}}`);const c=a.join("");await Md.keyboard(c);break}}});break}break}}});setTimeout(function(){ast(Wue())},100);const a0e="15.1.22",one=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),cne=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),lG=(t,e)=>({startTime:e,type:"setValue",value:t}),o0e=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),c0e=(t,e,{startTime:n,target:i,timeConstant:r})=>i+(e-i)*Math.exp((n-t)/r),J1=t=>t.type==="exponentialRampToValue",dU=t=>t.type==="linearRampToValue",I_=t=>J1(t)||dU(t),R9=t=>t.type==="setValue",Sv=t=>t.type==="setValueCurve",fU=(t,e,n,i)=>{const r=t[e];return r===void 0?i:I_(r)||R9(r)?r.value:Sv(r)?r.values[r.values.length-1]:c0e(n,fU(t,e-1,r.startTime,i),r)},lne=(t,e,n,i,r)=>n===void 0?[i.insertTime,r]:I_(n)?[n.endTime,n.value]:R9(n)?[n.startTime,n.value]:Sv(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,fU(t,e-1,n.startTime,r)],uG=t=>t.type==="cancelAndHold",hG=t=>t.type==="cancelScheduledValues",d_=t=>uG(t)||hG(t)?t.cancelTime:J1(t)||dU(t)?t.endTime:t.startTime,une=(t,e,n,{endTime:i,value:r})=>n===r?r:0<n&&0<r||n<0&&r<0?n*(r/n)**((t-e)/(i-e)):0,hne=(t,e,n,{endTime:i,value:r})=>n+(t-e)/(i-e)*(r-n),gst=(t,e)=>{const n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]},vst=(t,{duration:e,startTime:n,values:i})=>{const r=(t-n)/e*(i.length-1);return gst(i,r)},SD=t=>t.type==="setTarget";class yst{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=d_(e);if(uG(e)||hG(e)){const i=this._automationEvents.findIndex(s=>hG(e)&&Sv(s)?s.startTime+s.duration>=n:d_(s)>=n),r=this._automationEvents[i];if(i!==-1&&(this._automationEvents=this._automationEvents.slice(0,i)),uG(e)){const s=this._automationEvents[this._automationEvents.length-1];if(r!==void 0&&I_(r)){if(s!==void 0&&SD(s))throw new Error("The internal list is malformed.");const a=s===void 0?r.insertTime:Sv(s)?s.startTime+s.duration:d_(s),o=s===void 0?this._defaultValue:Sv(s)?s.values[s.values.length-1]:s.value,c=J1(r)?une(n,a,o,r):hne(n,a,o,r),l=J1(r)?one(c,n,this._currenTime):cne(c,n,this._currenTime);this._automationEvents.push(l)}if(s!==void 0&&SD(s)&&this._automationEvents.push(lG(this.getValue(n),n)),s!==void 0&&Sv(s)&&s.startTime+s.duration>n){const a=n-s.startTime,o=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(a*o)),l=a/(c-1)*o,u=s.values.slice(0,c);if(l<1)for(let h=1;h<c;h+=1){const d=l*h%1;u[h]=s.values[h-1]*(1-d)+s.values[h]*d}this._automationEvents[this._automationEvents.length-1]=o0e(u,s.startTime,a)}}}else{const i=this._automationEvents.findIndex(a=>d_(a)>n),r=i===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[i-1];if(r!==void 0&&Sv(r)&&d_(r)+r.duration>n)return!1;const s=J1(e)?one(e.value,e.endTime,this._currenTime):dU(e)?cne(e.value,n,this._currenTime):e;if(i===-1)this._automationEvents.push(s);else{if(Sv(e)&&n+e.duration>d_(this._automationEvents[i]))return!1;this._automationEvents.splice(i,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(i=>d_(i)>e);if(n>1){const i=this._automationEvents.slice(n-1),r=i[0];SD(r)&&i.unshift(lG(fU(this._automationEvents,n-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=i}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(a=>d_(a)>e),i=this._automationEvents[n],r=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[r];if(s!==void 0&&SD(s)&&(i===void 0||!I_(i)||i.insertTime>e))return c0e(e,fU(this._automationEvents,r-1,s.startTime,this._defaultValue),s);if(s!==void 0&&R9(s)&&(i===void 0||!I_(i)))return s.value;if(s!==void 0&&Sv(s)&&(i===void 0||!I_(i)||s.startTime+s.duration>e))return e<s.startTime+s.duration?vst(e,s):s.values[s.values.length-1];if(s!==void 0&&I_(s)&&(i===void 0||!I_(i)))return s.value;if(i!==void 0&&J1(i)){const[a,o]=lne(this._automationEvents,r,s,i,this._defaultValue);return une(e,a,o,i)}if(i!==void 0&&dU(i)){const[a,o]=lne(this._automationEvents,r,s,i,this._defaultValue);return hne(e,a,o,i)}return this._defaultValue}}const _st=t=>({cancelTime:t,type:"cancelAndHold"}),bst=t=>({cancelTime:t,type:"cancelScheduledValues"}),Est=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),Sst=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),Tst=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),xst=()=>new DOMException("","AbortError"),wst=t=>(e,n,[i,r,s],a)=>{t(e[r],[n,i,s],o=>o[0]===n&&o[1]===i,a)},Cst=t=>(e,n,i)=>{const r=[];for(let s=0;s<i.numberOfInputs;s+=1)r.push(new Set);t.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},Rst=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},SC=new WeakSet,l0e=new WeakMap,A9=new WeakMap,u0e=new WeakMap,M9=new WeakMap,y6=new WeakMap,h0e=new WeakMap,dG=new WeakMap,fG=new WeakMap,pG=new WeakMap,d0e={construct(){return d0e}},Ast=t=>{try{const e=new Proxy(t,d0e);new e}catch{return!1}return!0},dne=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,fne=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),r=i.match(dne);for(;r!==null;){const s=r[1].slice(1,-1),a=r[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(a),i=i.slice(r[0].length).replace(/^[\s]+/,""),r=i.match(dne)}return[n.join(";"),i]},pne=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},mne=t=>{if(!Ast(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},Mst=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>{let f=0;return(p,g,_={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(g))return Promise.resolve();const E=l.get(p);if(E!==void 0){const N=E.get(g);if(N!==void 0)return N}const T=s(p),x=T.audioWorklet===void 0?r(g).then(([N,A])=>{const[I,k]=fne(N,A),L=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${k}
})})(window,'_AWGS')`;return n(L)}).then(()=>{const N=d._AWGS.pop();if(N===void 0)throw new SyntaxError;i(T.currentTime,T.sampleRate,()=>N(class{},void 0,(A,I)=>{if(A.trim()==="")throw e();const k=fG.get(T);if(k!==void 0){if(k.has(A))throw e();mne(I),pne(I.parameterDescriptors),k.set(A,I)}else mne(I),pne(I.parameterDescriptors),fG.set(T,new Map([[A,I]]))},T.sampleRate,void 0,void 0))}):Promise.all([r(g),Promise.resolve(t(h,h))]).then(([[N,A],I])=>{const k=f+1;f=k;const[L,U]=fne(N,A),X=`${L};((AudioWorkletProcessor,registerProcessor)=>{${U}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${k}',class extends AudioWorkletProcessor{process(){return !1}})`,ie=new Blob([X],{type:"application/javascript; charset=utf-8"}),V=URL.createObjectURL(ie);return T.audioWorklet.addModule(V,_).then(()=>{if(o(T))return T;const Z=a(T);return Z.audioWorklet.addModule(V,_).then(()=>Z)}).then(Z=>{if(c===null)throw new SyntaxError;try{new c(Z,`__sac${k}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(V))});return E===void 0?l.set(p,new Map([[g,x]])):E.set(g,x),x.then(()=>{const N=u.get(p);N===void 0?u.set(p,new Set([g])):N.add(g)}).finally(()=>{const N=l.get(p);N!==void 0&&N.delete(g)}),x}},rm=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},_6=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[i]=n;return t.delete(i),i},f0e=(t,e,n,i)=>{const r=rm(t,e),s=_6(r,a=>a[0]===n&&a[1]===i);return r.size===0&&t.delete(e),s},oI=t=>rm(h0e,t),TC=t=>{if(SC.has(t))throw new Error("The AudioNode is already stored.");SC.add(t),oI(t).forEach(e=>e(!0))},p0e=t=>"port"in t,cI=t=>{if(!SC.has(t))throw new Error("The AudioNode is not stored.");SC.delete(t),oI(t).forEach(e=>e(!1))},mG=(t,e)=>{!p0e(t)&&e.every(n=>n.size===0)&&cI(t)},Ost=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>{const f=new WeakMap;return(p,g,_,v,E)=>{const{activeInputs:T,passiveInputs:x}=s(g),{outputs:N}=s(p),A=o(p),I=k=>{const L=c(g),U=c(p);if(k){const $=f0e(x,p,_,v);t(T,p,$,!1),!E&&!h(p)&&n(U,L,_,v),d(g)&&TC(g)}else{const $=i(T,p,_,v);e(x,v,$,!1),!E&&!h(p)&&r(U,L,_,v);const q=a(g);if(q===0)u(g)&&mG(g,T);else{const G=f.get(g);G!==void 0&&clearTimeout(G),f.set(g,setTimeout(()=>{u(g)&&mG(g,T)},q*1e3))}}};return l(N,[g,_,v],k=>k[0]===g&&k[1]===_&&k[2]===v,!0)?(A.add(I),u(p)?t(T,p,[_,v,I],!0):e(x,v,[p,_,I],!0),!0):!1}},Nst=t=>(e,n,[i,r,s],a)=>{const o=e.get(i);o===void 0?e.set(i,new Set([[r,n,s]])):t(o,[r,n,s],c=>c[0]===r&&c[1]===n,a)},Ist=t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const r=()=>{n.removeEventListener("ended",r),n.disconnect(i),i.disconnect()};n.addEventListener("ended",r)},kst=t=>(e,n)=>{t(e).add(n)},Dst={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Pst=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...Dst,...c},h=i(l,u),d=s(l)?e():null;super(o,!1,h,d),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},mu=(t,e)=>t.context===e,Lst=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!mu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},pU=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},a0=()=>new DOMException("","IndexSizeError"),O9=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(i){throw i.code===12?a0():i}})(t.getChannelData)},Ust={numberOfChannels:1},Bst=(t,e,n,i,r,s,a,o)=>{let c=null;return class m0e{constructor(u){if(r===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:d,sampleRate:f}={...Ust,...u};c===null&&(c=new r(1,1,44100));const p=i!==null&&e(s,s)?new i({length:h,numberOfChannels:d,sampleRate:f}):c.createBuffer(d,h,f);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(a(p),O9(p)):e(pU,()=>pU(p))||o(p),t.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===m0e.prototype||t.has(u)}}},kh=-34028234663852886e22,Wu=-kh,Wv=t=>SC.has(t),Fst={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},zst=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...Fst,...u},f=r(h,d),p=a(h),g=p?e():null;super(l,!1,f,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=f,this._onended=null,this._playbackRate=n(this,p,f.playbackRate,Wu,kh)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(l){if(this._nativeAudioBufferSourceNode.buffer=l,l!==null){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(l){this._nativeAudioBufferSourceNode.loop=l}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(l){this._nativeAudioBufferSourceNode.loopEnd=l}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(l){this._nativeAudioBufferSourceNode.loopStart=l}get onended(){return this._onended}set onended(l){const u=typeof l=="function"?o(this,l):null;this._nativeAudioBufferSourceNode.onended=u;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===u?l:h}get playbackRate(){return this._playbackRate}start(l=0,u=0,h){if(this._nativeAudioBufferSourceNode.start(l,u,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[l,u]:[l,u,h]),this.context.state!=="closed"){TC(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),Wv(this)&&cI(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(l=0){this._nativeAudioBufferSourceNode.stop(l),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=l)}},Hst=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const d=mu(h,u);if(!d){const f={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,f),a!==null&&h.start(...a),o!==null&&h.stop(o)}return s.set(u,h),d?await t(u,l.playbackRate,h.playbackRate):await i(u,l.playbackRate,h.playbackRate),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},jst=t=>"playbackRate"in t,Vst=t=>"frequency"in t&&"gain"in t,Gst=t=>"offset"in t,qst=t=>!("frequency"in t)&&"gain"in t,$st=t=>"detune"in t&&"frequency"in t&&!("gain"in t),Wst=t=>"pan"in t,Ju=t=>rm(l0e,t),lI=t=>rm(u0e,t),gG=(t,e)=>{const{activeInputs:n}=Ju(t);n.forEach(r=>r.forEach(([s])=>{e.includes(t)||gG(s,[...e,t])}));const i=jst(t)?[t.playbackRate]:p0e(t)?Array.from(t.parameters.values()):Vst(t)?[t.Q,t.detune,t.frequency,t.gain]:Gst(t)?[t.offset]:qst(t)?[t.gain]:$st(t)?[t.detune,t.frequency]:Wst(t)?[t.pan]:[];for(const r of i){const s=lI(r);s!==void 0&&s.activeInputs.forEach(([a])=>gG(a,e))}Wv(t)&&cI(t)},g0e=t=>{gG(t.destination,[])},Yst=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),Xst=(t,e,n,i,r,s,a,o,c)=>class extends t{constructor(u={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(h===null)throw i();if(!Yst(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&h.sampleRate!==u.sampleRate)throw n();super(h,2);const{latencyHint:d}=u,{sampleRate:f}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:d==="balanced"?512/f:d==="interactive"||d===void 0?256/f:d==="playback"?1024/f:Math.max(2,Math.min(128,Math.round(d*f/128)))*128/f,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",p)};h.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),g0e(this)}))}createMediaElementSource(u){return new r(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,h)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,h)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},Kst=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d=a(h),f=r(h,u,d),p=d?e(o):null;super(l,!1,f,p),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=f}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(l>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=l}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(l){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=l}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},Jst=t=>{const e=new WeakMap,n=async(i,r)=>{const s=r.destination;return e.set(r,s),await t(i,r,s),s};return{render(i,r){const s=e.get(r);return s!==void 0?Promise.resolve(s):n(i,r)}}},Zst=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=l.listener,h=()=>{const N=new Float32Array(1),A=e(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=a(l);let k=!1,L=[0,0,-1,0,1,0],U=[0,0,0];const $=()=>{if(k)return;k=!0;const ie=i(l,256,9,0);ie.onaudioprocess=({inputBuffer:V})=>{const Z=[s(V,N,0),s(V,N,1),s(V,N,2),s(V,N,3),s(V,N,4),s(V,N,5)];Z.some((ee,oe)=>ee!==L[oe])&&(u.setOrientation(...Z),L=Z);const Y=[s(V,N,6),s(V,N,7),s(V,N,8)];Y.some((ee,oe)=>ee!==U[oe])&&(u.setPosition(...Y),U=Y)},A.connect(ie)},q=ie=>V=>{V!==L[ie]&&(L[ie]=V,u.setOrientation(...L))},G=ie=>V=>{V!==U[ie]&&(U[ie]=V,u.setPosition(...U))},X=(ie,V,Z)=>{const Y=n(l,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:V});Y.connect(A,0,ie),Y.start(),Object.defineProperty(Y.offset,"defaultValue",{get(){return V}});const ee=t({context:c},I,Y.offset,Wu,kh);return o(ee,"value",oe=>()=>oe.call(ee),oe=>de=>{try{oe.call(ee,de)}catch(Me){if(Me.code!==9)throw Me}$(),I&&Z(de)}),ee.cancelAndHoldAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.cancelAndHoldAtTime),ee.cancelScheduledValues=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.cancelScheduledValues),ee.exponentialRampToValueAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.exponentialRampToValueAtTime),ee.linearRampToValueAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.linearRampToValueAtTime),ee.setTargetAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.setTargetAtTime),ee.setValueAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.setValueAtTime),ee.setValueCurveAtTime=(oe=>I?()=>{throw r()}:(...de)=>{const Me=oe.apply(ee,de);return $(),Me})(ee.setValueCurveAtTime),ee};return{forwardX:X(0,0,q(0)),forwardY:X(1,0,q(1)),forwardZ:X(2,-1,q(2)),positionX:X(6,0,G(0)),positionY:X(7,0,G(1)),positionZ:X(8,0,G(2)),upX:X(3,0,q(3)),upY:X(4,1,q(4)),upZ:X(5,0,q(5))}},{forwardX:d,forwardY:f,forwardZ:p,positionX:g,positionY:_,positionZ:v,upX:E,upY:T,upZ:x}=u.forwardX===void 0?h():u;return{get forwardX(){return d},get forwardY(){return f},get forwardZ(){return p},get positionX(){return g},get positionY(){return _},get positionZ(){return v},get upX(){return E},get upY(){return T},get upZ(){return x}}},mU=t=>"context"in t,uI=t=>mU(t[0]),QT=(t,e,n,i)=>{for(const r of t)if(n(r)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},gne=(t,e,[n,i],r)=>{QT(t,[e,n,i],s=>s[0]===e&&s[1]===n,r)},vne=(t,[e,n,i],r)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,i]])):QT(s,[n,i],a=>a[0]===n,r)},iR=t=>"inputs"in t,gU=(t,e,n,i)=>{if(iR(e)){const r=e.inputs[i];return t.connect(r,n,0),[r,n,0]}return t.connect(e,n,i),[e,n,i]},v0e=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},Qst=(t,e,n)=>_6(t,i=>i[0]===e&&i[1]===n),y0e=(t,e)=>{if(!oI(t).delete(e))throw new Error("Missing the expected event listener.")},_0e=(t,e,n)=>{const i=rm(t,e),r=_6(i,s=>s[0]===n);return i.size===0&&t.delete(e),r},vU=(t,e,n,i)=>{iR(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},Ea=t=>rm(A9,t),xO=t=>rm(M9,t),AT=t=>dG.has(t),SP=t=>!SC.has(t),yne=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const i=t.createScriptProcessor(256,1,1),r=t.createGain(),s=t.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const o=t.createBufferSource();o.buffer=s,o.loop=!0,o.connect(i).connect(t.destination),o.connect(r),o.disconnect(r),i.onaudioprocess=c=>{const l=c.inputBuffer.getChannelData(0);Array.prototype.some.call(l,u=>u===1)?n(!0):n(!1),o.stop(),i.onaudioprocess=null,o.disconnect(i),i.disconnect(t.destination)},o.start()}}),FH=(t,e)=>{const n=new Map;for(const i of t)for(const r of i){const s=n.get(r);n.set(r,s===void 0?1:s+1)}n.forEach((i,r)=>e(r,i))},yU=t=>"context"in t,eat=t=>{const e=new Map;t.connect=(n=>(i,r=0,s=0)=>{const a=yU(i)?n(i,r,s):n(i,r),o=e.get(i);return o===void 0?e.set(i,[{input:s,output:r}]):o.every(c=>c.input!==s||c.output!==r)&&o.push({input:s,output:r}),a})(t.connect.bind(t)),t.disconnect=(n=>(i,r,s)=>{if(n.apply(t),i===void 0)e.clear();else if(typeof i=="number")for(const[a,o]of e){const c=o.filter(l=>l.output!==i);c.length===0?e.delete(a):e.set(a,c)}else if(e.has(i))if(r===void 0)e.delete(i);else{const a=e.get(i);if(a!==void 0){const o=a.filter(c=>c.output!==r&&(c.input!==s||s===void 0));o.length===0?e.delete(i):e.set(i,o)}}for(const[a,o]of e)o.forEach(c=>{yU(a)?t.connect(a,c.output,c.input):t.connect(a,c.output)})})(t.disconnect)},tat=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=lI(e),{outputs:a}=Ju(t),o=oI(t),c=l=>{const u=Ea(t),h=xO(e);if(l){const d=_0e(s,t,n);gne(r,t,d,!1),!i&&!AT(t)&&u.connect(h,n)}else{const d=Qst(r,t,n);vne(s,d,!1),!i&&!AT(t)&&u.disconnect(h,n)}};return QT(a,[e,n],l=>l[0]===e&&l[1]===n,!0)?(o.add(c),Wv(t)?gne(r,t,[n,c],!0):vne(s,[t,n,c],!0),!0):!1},nat=(t,e,n,i)=>{const{activeInputs:r,passiveInputs:s}=Ju(e),a=v0e(r[i],t,n);return a===null?[f0e(s,t,n,i)[2],!1]:[a[2],!0]},iat=(t,e,n)=>{const{activeInputs:i,passiveInputs:r}=lI(e),s=v0e(i,t,n);return s===null?[_0e(r,t,n)[1],!1]:[s[2],!0]},N9=(t,e,n,i,r)=>{const[s,a]=nat(t,n,i,r);if(s!==null&&(y0e(t,s),a&&!e&&!AT(t)&&vU(Ea(t),Ea(n),i,r)),Wv(n)){const{activeInputs:o}=Ju(n);mG(n,o)}},I9=(t,e,n,i)=>{const[r,s]=iat(t,n,i);r!==null&&(y0e(t,r),s&&!e&&!AT(t)&&Ea(t).disconnect(xO(n),i))},rat=(t,e)=>{const n=Ju(t),i=[];for(const r of n.outputs)uI(r)?N9(t,e,...r):I9(t,e,...r),i.push(r[0]);return n.outputs.clear(),i},sat=(t,e,n)=>{const i=Ju(t),r=[];for(const s of i.outputs)s[1]===n&&(uI(s)?N9(t,e,...s):I9(t,e,...s),r.push(s[0]),i.outputs.delete(s));return r},aat=(t,e,n,i,r)=>{const s=Ju(t);return Array.from(s.outputs).filter(a=>a[0]===n&&(i===void 0||a[1]===i)&&(r===void 0||a[2]===r)).map(a=>(uI(a)?N9(t,e,...a):I9(t,e,...a),s.outputs.delete(a),a[0]))},oat=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)=>class extends l{constructor(v,E,T,x){super(T),this._context=v,this._nativeAudioNode=T;const N=u(v);h(N)&&n(yne,()=>yne(N,g))!==!0&&eat(T),A9.set(this,T),h0e.set(this,new Set),v.state!=="closed"&&E&&TC(this),t(this,x,T)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,E=0,T=0){if(E<0||E>=this._nativeAudioNode.numberOfOutputs)throw r();const x=u(this._context),N=p(x);if(d(v)||f(v))throw s();if(mU(v)){const k=Ea(v);try{const U=gU(this._nativeAudioNode,k,E,T),$=SP(this);(N||$)&&this._nativeAudioNode.disconnect(...U),this.context.state!=="closed"&&!$&&SP(v)&&TC(v)}catch(U){throw U.code===12?s():U}if(e(this,v,E,T,N)){const U=c([this],v);FH(U,i(N))}return v}const A=xO(v);if(A.name==="playbackRate"&&A.maxValue===1024)throw a();try{this._nativeAudioNode.connect(A,E),(N||SP(this))&&this._nativeAudioNode.disconnect(A,E)}catch(k){throw k.code===12?s():k}if(tat(this,v,E,N)){const k=c([this],v);FH(k,i(N))}}disconnect(v,E,T){let x;const N=u(this._context),A=p(N);if(v===void 0)x=rat(this,A);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw r();x=sat(this,A,v)}else{if(E!==void 0&&(E<0||E>=this.numberOfOutputs)||mU(v)&&T!==void 0&&(T<0||T>=v.numberOfInputs))throw r();if(x=aat(this,A,v,E,T),x.length===0)throw s()}for(const I of x){const k=c([this],I);FH(k,o)}}},cat=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>(f,p,g,_=null,v=null)=>{const E=g.value,T=new yst(E),x=p?i(T):null,N={get defaultValue(){return E},get maxValue(){return _===null?g.maxValue:_},get minValue(){return v===null?g.minValue:v},get value(){return g.value},set value(A){g.value=A,N.setValueAtTime(A,f.context.currentTime)},cancelAndHoldAtTime(A){if(typeof g.cancelAndHoldAtTime=="function")x===null&&T.flush(f.context.currentTime),T.add(r(A)),g.cancelAndHoldAtTime(A);else{const I=Array.from(T).pop();x===null&&T.flush(f.context.currentTime),T.add(r(A));const k=Array.from(T).pop();g.cancelScheduledValues(A),I!==k&&k!==void 0&&(k.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(k.value,k.endTime):k.type==="linearRampToValue"?g.linearRampToValueAtTime(k.value,k.endTime):k.type==="setValue"?g.setValueAtTime(k.value,k.startTime):k.type==="setValueCurve"&&g.setValueCurveAtTime(k.values,k.startTime,k.duration))}return N},cancelScheduledValues(A){return x===null&&T.flush(f.context.currentTime),T.add(s(A)),g.cancelScheduledValues(A),N},exponentialRampToValueAtTime(A,I){if(A===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const k=f.context.currentTime;return x===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(E,k)),g.setValueAtTime(E,k)),T.add(a(A,I)),g.exponentialRampToValueAtTime(A,I),N},linearRampToValueAtTime(A,I){const k=f.context.currentTime;return x===null&&T.flush(k),Array.from(T).length===0&&(T.add(l(E,k)),g.setValueAtTime(E,k)),T.add(o(A,I)),g.linearRampToValueAtTime(A,I),N},setTargetAtTime(A,I,k){return x===null&&T.flush(f.context.currentTime),T.add(c(A,I,k)),g.setTargetAtTime(A,I,k),N},setValueAtTime(A,I){return x===null&&T.flush(f.context.currentTime),T.add(l(A,I)),g.setValueAtTime(A,I),N},setValueCurveAtTime(A,I,k){const L=A instanceof Float32Array?A:new Float32Array(A);if(h!==null&&h.name==="webkitAudioContext"){const U=I+k,$=f.context.sampleRate,q=Math.ceil(I*$),G=Math.floor(U*$),X=G-q,ie=new Float32Array(X);for(let Z=0;Z<X;Z+=1){const Y=(L.length-1)/k*((q+Z)/$-I),ee=Math.floor(Y),oe=Math.ceil(Y);ie[Z]=ee===oe?L[ee]:(1-(Y-ee))*L[ee]+(1-(oe-Y))*L[oe]}x===null&&T.flush(f.context.currentTime),T.add(u(ie,I,k)),g.setValueCurveAtTime(ie,I,k);const V=G/$;V<U&&d(N,ie[ie.length-1],V),d(N,L[L.length-1],U)}else x===null&&T.flush(f.context.currentTime),T.add(u(L,I,k)),g.setValueCurveAtTime(L,I,k);return N}};return n.set(N,g),e.set(N,f),t(N,x),N},lat=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:i,value:r}=n;e.exponentialRampToValueAtTime(r,i)}else if(n.type==="linearRampToValue"){const{endTime:i,value:r}=n;e.linearRampToValueAtTime(r,i)}else if(n.type==="setTarget"){const{startTime:i,target:r,timeConstant:s}=n;e.setTargetAtTime(r,i,s)}else if(n.type==="setValue"){const{startTime:i,value:r}=n;e.setValueAtTime(r,i)}else if(n.type==="setValueCurve"){const{duration:i,startTime:r,values:s}=n;e.setValueCurveAtTime(s,r,i)}else throw new Error("Can't apply an unknown automation.")}});class b0e{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((i,r)=>e.call(n,i,r,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const uat={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},hat=(t,e,n,i,r,s,a,o,c,l,u,h,d,f)=>class extends e{constructor(g,_,v){var E;const T=o(g),x=c(T),N=u({...uat,...v});d(N);const A=fG.get(T),I=A==null?void 0:A.get(_),k=x||T.state!=="closed"?T:(E=a(T))!==null&&E!==void 0?E:T,L=r(k,x?null:g.baseLatency,l,_,I,N),U=x?i(_,N,I):null;super(g,!0,L,U);const $=[];L.parameters.forEach((G,X)=>{const ie=n(this,x,G);$.push([X,ie])}),this._nativeAudioWorkletNode=L,this._onprocessorerror=null,this._parameters=new b0e($),x&&t(T,this);const{activeInputs:q}=s(this);h(L,q)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const _=typeof g=="function"?f(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=_;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===_?g:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function _U(t,e,n,i,r){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,r);else{const s=t.getChannelData(i);if(e[n].byteLength===0)e[n]=s.slice(r,r+128);else{const a=new Float32Array(s.buffer,r*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(a)}}}const E0e=(t,e,n,i,r)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],i,r):e[n].byteLength!==0&&t.getChannelData(i).set(e[n],r)},bU=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const r=[],s=typeof e=="number"?e:e[i];for(let a=0;a<s;a+=1)r.push(new Float32Array(128));n.push(r)}return n},dat=(t,e)=>{const n=rm(pG,t),i=Ea(e);return rm(n,i)},fat=async(t,e,n,i,r,s,a)=>{const o=e===null?Math.ceil(t.context.length/128)*128:e.length,c=i.channelCount*i.numberOfInputs,l=r.reduce((_,v)=>_+v,0),u=l===0?null:n.createBuffer(l,o,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const h=Ju(t),d=await dat(n,t),f=bU(i.numberOfInputs,i.channelCount),p=bU(i.numberOfOutputs,r),g=Array.from(t.parameters.keys()).reduce((_,v)=>({..._,[v]:new Float32Array(128)}),{});for(let _=0;_<o;_+=128){if(i.numberOfInputs>0&&e!==null)for(let v=0;v<i.numberOfInputs;v+=1)for(let E=0;E<i.channelCount;E+=1)_U(e,f[v],E,E,_);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:v},E)=>{_U(e,g,v,c+E,_)});for(let v=0;v<i.numberOfInputs;v+=1)for(let E=0;E<r[v];E+=1)p[v][E].byteLength===0&&(p[v][E]=new Float32Array(128));try{const v=f.map((T,x)=>h.activeInputs[x].size===0?[]:T),E=a(_/n.sampleRate,n.sampleRate,()=>d.process(v,p,g));if(u!==null)for(let T=0,x=0;T<i.numberOfOutputs;T+=1){for(let N=0;N<r[T];N+=1)E0e(u,p[T],N,x+N,_);x+=r[T]}if(!E)break}catch(v){t.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},pat=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g)=>(_,v,E)=>{const T=new WeakMap;let x=null;const N=async(A,I)=>{let k=u(A),L=null;const U=mu(k,I),$=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(h===null){const q=$.reduce((V,Z)=>V+Z,0),G=r(I,{channelCount:Math.max(1,q),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,q)}),X=[];for(let V=0;V<A.numberOfOutputs;V+=1)X.push(i(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:$[V]}));const ie=a(I,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});ie.connect=e.bind(null,X),ie.disconnect=c.bind(null,X),L=[G,X,ie]}else U||(k=new h(I,_));if(T.set(I,L===null?k:L[2]),L!==null){if(x===null){if(E===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Z=A.channelCount*A.numberOfInputs,Y=E.parameterDescriptors===void 0?0:E.parameterDescriptors.length,ee=Z+Y;x=fat(A,ee===0?null:await(async()=>{const de=new d(ee,Math.ceil(A.context.length/128)*128,I.sampleRate),Me=[],He=[];for(let we=0;we<v.numberOfInputs;we+=1)Me.push(a(de,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),He.push(r(de,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const Te=await Promise.all(Array.from(A.parameters.values()).map(async we=>{const Ce=s(de,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:we.value});return await f(de,we,Ce.offset),Ce})),Le=i(de,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,Z+Y)});for(let we=0;we<v.numberOfInputs;we+=1){Me[we].connect(He[we]);for(let Ce=0;Ce<v.channelCount;Ce+=1)He[we].connect(Le,Ce,we*v.channelCount+Ce)}for(const[we,Ce]of Te.entries())Ce.connect(Le,0,Z+we),Ce.start(0);return Le.connect(de.destination),await Promise.all(Me.map(we=>p(A,de,we))),g(de)})(),I,v,$,E,l)}const q=await x,G=n(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[X,ie,V]=L;q!==null&&(G.buffer=q,G.start(0)),G.connect(X);for(let Z=0,Y=0;Z<A.numberOfOutputs;Z+=1){const ee=ie[Z];for(let oe=0;oe<$[Z];oe+=1)X.connect(ee,Y+oe,oe);Y+=$[Z]}return V}if(U)for(const[q,G]of A.parameters.entries())await t(I,G,k.parameters.get(q));else for(const[q,G]of A.parameters.entries())await f(I,G,k.parameters.get(q));return await p(A,I,k),k};return{render(A,I){o(I,A);const k=T.get(I);return k!==void 0?Promise.resolve(k):N(A,I)}}},mat=(t,e,n,i,r,s,a,o,c,l,u,h,d,f,p,g,_,v,E,T)=>class extends p{constructor(N,A){super(N,A),this._nativeContext=N,this._audioWorklet=t===void 0?void 0:{addModule:(I,k)=>t(this,I,k)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new r(this)}createBuffer(N,A,I){return new n({length:A,numberOfChannels:N,sampleRate:I})}createBufferSource(){return new i(this)}createChannelMerger(N=6){return new s(this,{numberOfInputs:N})}createChannelSplitter(N=6){return new a(this,{numberOfOutputs:N})}createConstantSource(){return new o(this)}createConvolver(){return new c(this)}createDelay(N=1){return new u(this,{maxDelayTime:N})}createDynamicsCompressor(){return new h(this)}createGain(){return new d(this)}createIIRFilter(N,A){return new f(this,{feedback:A,feedforward:N})}createOscillator(){return new g(this)}createPanner(){return new _(this)}createPeriodicWave(N,A,I={disableNormalization:!1}){return new v(this,{...I,imag:A,real:N})}createStereoPanner(){return new E(this)}createWaveShaper(){return new T(this)}decodeAudioData(N,A,I){return l(this._nativeContext,N).then(k=>(typeof A=="function"&&A(k),k),k=>{throw typeof I=="function"&&I(k),k})}},gat={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},vat=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...gat,...u},f=r(h,d),p=a(h),g=p?n():null;super(l,!1,f,g),this._Q=e(this,p,f.Q,Wu,kh),this._detune=e(this,p,f.detune,1200*Math.log2(Wu),-1200*Math.log2(Wu)),this._frequency=e(this,p,f.frequency,l.sampleRate/2,0),this._gain=e(this,p,f.gain,40*Math.log10(Wu),kh),this._nativeBiquadFilterNode=f,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(l){this._nativeBiquadFilterNode.type=l}getFrequencyResponse(l,u,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(l,u,h)}catch(d){throw d.code===11?i():d}if(l.length!==u.length||u.length!==h.length)throw i()}},yat=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=mu(l,c);if(!u){const h={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type};l=e(c,h)}return s.set(c,l),u?(await t(c,o.Q,l.Q),await t(c,o.detune,l.detune),await t(c,o.frequency,l.frequency),await t(c,o.gain,l.gain)):(await i(c,o.Q,l.Q),await i(c,o.detune,l.detune),await i(c,o.frequency,l.frequency),await i(c,o.gain,l.gain)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},_at=(t,e)=>(n,i)=>{const r=e.get(n);if(r!==void 0)return r;const s=t.get(n);if(s!==void 0)return s;try{const a=i();return a instanceof Promise?(t.set(n,a),a.catch(()=>!1).then(o=>(t.delete(n),e.set(n,o),o))):(e.set(n,a),a)}catch{return e.set(n,!1),!1}},bat={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Eat=(t,e,n,i,r)=>class extends t{constructor(a,o){const c=i(a),l={...bat,...o},u=n(c,l),h=r(c)?e():null;super(a,!1,u,h)}},Sat=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!mu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Tat={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},xat=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=s({...Tat,...c}),h=n(l,u),d=r(l)?e():null;super(o,!1,h,d)}},wat=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!mu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=t(a,l)}return i.set(a,o),await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Cat=t=>(e,n,i)=>t(n,e,i),Rat=t=>(e,n,i=0,r=0)=>{const s=e[i];if(s===void 0)throw t();return yU(n)?s.connect(n,0,r):s.connect(n,0)},Aat=t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,44100);return i.buffer=r,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}},Mat={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Oat=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Mat,...l},d=i(u,h),f=s(u),p=f?n():null;super(c,!1,d,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=d,this._offset=e(this,f,d.offset,Wu,kh),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeConstantSourceNode.onended=l;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===l?c:u}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){TC(this);const l=()=>{this._nativeConstantSourceNode.removeEventListener("ended",l),Wv(this)&&cI(this)};this._nativeConstantSourceNode.addEventListener("ended",l)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},Nat=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null;const c=async(l,u)=>{let h=n(l);const d=mu(h,u);if(!d){const f={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,f),a!==null&&h.start(a),o!==null&&h.stop(o)}return s.set(u,h),d?await t(u,l.offset,h.offset):await i(u,l.offset,h.offset),await r(l,u,h),h};return{set start(l){a=l},set stop(l){o=l},render(l,u){const h=s.get(u);return h!==void 0?Promise.resolve(h):c(l,u)}}},Iat=t=>e=>(t[0]=e,t[0]),kat={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Dat=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u={...kat,...c},h=n(l,u),f=r(l)?e():null;super(o,!1,h,f),this._isBufferNullified=!1,this._nativeConvolverNode=h,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},Pat=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!mu(o,a)){const l={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=t(a,l)}return i.set(a,o),iR(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},Lat=(t,e)=>(n,i,r)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,r)}catch(s){throw s.name==="SyntaxError"?t():s}},Uat=()=>new DOMException("","DataCloneError"),_ne=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(i=>{const r=()=>{n.onmessage=null,e.close(),n.close(),i()};n.onmessage=()=>r();try{e.postMessage(t,[t])}catch{}finally{r()}})},Bat=(t,e,n,i,r,s,a,o,c,l,u)=>(h,d)=>{const f=a(h)?h:s(h);if(r.has(d)){const p=n();return Promise.reject(p)}try{r.add(d)}catch{}return e(c,()=>c(f))?f.decodeAudioData(d).then(p=>(_ne(d).catch(()=>{}),e(o,()=>o(p))||u(p),t.add(p),p)):new Promise((p,g)=>{const _=async()=>{try{await _ne(d)}catch{}},v=E=>{g(E),_()};try{f.decodeAudioData(d,E=>{typeof E.copyFromChannel!="function"&&(l(E),O9(E)),t.add(E),_().then(()=>p(E))},E=>{v(E===null?i():E)})}catch(E){v(E)}})},Fat=(t,e,n,i,r,s,a,o)=>(c,l)=>{const u=e.get(c);if(u===void 0)throw new Error("Missing the expected cycle count.");const h=s(c.context),d=o(h);if(u===l){if(e.delete(c),!d&&a(c)){const f=i(c),{outputs:p}=n(c);for(const g of p)if(uI(g)){const _=i(g[0]);t(f,_,g[1],g[2])}else{const _=r(g[0]);f.connect(_,g[1])}}}else e.set(c,u-l)},zat={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Hat=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...zat,...l},d=i(u,h),f=s(u),p=f?n(h.maxDelayTime):null;super(c,!1,d,p),this._delayTime=e(this,f,d.delayTime),a(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},jat=(t,e,n,i,r)=>s=>{const a=new WeakMap,o=async(c,l)=>{let u=n(c);const h=mu(u,l);if(!h){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(l,d)}return a.set(l,u),h?await t(l,c.delayTime,u.delayTime):await i(l,c.delayTime,u.delayTime),await r(c,l,u),u};return{render(c,l){const u=a.get(l);return u!==void 0?Promise.resolve(u):o(c,l)}}},Vat=t=>(e,n,i,r)=>t(e[r],s=>s[0]===n&&s[1]===i),Gat=t=>(e,n)=>{t(e).delete(n)},qat=t=>"delayTime"in t,$at=(t,e,n)=>function i(r,s){const a=mU(s)?s:n(t,s);if(qat(a))return[];if(r[0]===a)return[r];if(r.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(c=>i([...r,a],c[0])).reduce((c,l)=>c.concat(l),[])},TD=(t,e,n)=>{const i=e[n];if(i===void 0)throw t();return i},Wat=t=>(e,n=void 0,i=void 0,r=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?TD(t,e,n).disconnect():yU(n)?i===void 0?e.forEach(s=>s.disconnect(n)):r===void 0?TD(t,e,i).disconnect(n,0):TD(t,e,i).disconnect(n,0,r):i===void 0?e.forEach(s=>s.disconnect(n)):TD(t,e,i).disconnect(n,0),Yat={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Xat=(t,e,n,i,r,s,a,o)=>class extends t{constructor(l,u){const h=s(l),d={...Yat,...u},f=i(h,d),p=a(h),g=p?n():null;super(l,!1,f,g),this._attack=e(this,p,f.attack),this._knee=e(this,p,f.knee),this._nativeDynamicsCompressorNode=f,this._ratio=e(this,p,f.ratio),this._release=e(this,p,f.release),this._threshold=e(this,p,f.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(l){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=l,l>2)throw this._nativeDynamicsCompressorNode.channelCount=u,r()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(l){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=l,l==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,r()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Kat=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=mu(l,c);if(!u){const h={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value};l=e(c,h)}return s.set(c,l),u?(await t(c,o.attack,l.attack),await t(c,o.knee,l.knee),await t(c,o.ratio,l.ratio),await t(c,o.release,l.release),await t(c,o.threshold,l.threshold)):(await i(c,o.attack,l.attack),await i(c,o.knee,l.knee),await i(c,o.ratio,l.ratio),await i(c,o.release,l.release),await i(c,o.threshold,l.threshold)),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},Jat=()=>new DOMException("","EncodingError"),Zat=t=>e=>new Promise((n,i)=>{if(t===null){i(new SyntaxError);return}const r=t.document.head;if(r===null)i(new SyntaxError);else{const s=t.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),c=t.onerror,l=()=>{t.onerror=c,URL.revokeObjectURL(o)};t.onerror=(u,h,d,f,p)=>{if(h===o||h===t.location.href&&d===1&&f===1)return l(),i(p),!1;if(c!==null)return c(u,h,d,f,p)},s.onerror=()=>{l(),i(new SyntaxError)},s.onload=()=>{l(),n()},s.src=o,s.type="module",r.appendChild(s)}}),Qat=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,i,r){if(i!==null){let s=this._listeners.get(i);s===void 0&&(s=t(this,i),typeof i=="function"&&this._listeners.set(i,s)),this._nativeEventTarget.addEventListener(n,s,r)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,i,r){const s=i===null?void 0:this._listeners.get(i);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,r)}},eot=t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return i()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},tot=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},not={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},iot=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...not,...c},h=i(l,u),d=s(l),f=d?n():null;super(o,!1,h,f),this._gain=e(this,d,h.gain,Wu,kh)}get gain(){return this._gain}},rot=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=mu(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.gain,l.gain):await i(c,o.gain,l.gain),await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},sot=(t,e)=>n=>e(t,n),aot=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},oot=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},cot=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},lot=t=>e=>t.get(e),pl=()=>new DOMException("","InvalidStateError"),uot=t=>e=>{const n=t.get(e);if(n===void 0)throw pl();return n},hot=(t,e)=>n=>{let i=t.get(n);if(i!==void 0)return i;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,44100),t.set(n,i),i},dot=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},b6=()=>new DOMException("","InvalidAccessError"),fot=t=>{t.getFrequencyResponse=(e=>(n,i,r)=>{if(n.length!==i.length||i.length!==r.length)throw b6();return e.call(t,n,i,r)})(t.getFrequencyResponse)},pot={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},mot=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=i(o),u=r(l),h={...pot,...c},d=e(l,u?null:o.baseLatency,h),f=u?n(h.feedback,h.feedforward):null;super(o,!1,d,f),fot(d),this._nativeIIRFilterNode=d,s(this,1)}getFrequencyResponse(o,c,l){return this._nativeIIRFilterNode.getFrequencyResponse(o,c,l)}},S0e=(t,e,n,i,r,s,a,o,c,l,u)=>{const h=l.length;let d=o;for(let f=0;f<h;f+=1){let p=n[0]*l[f];for(let g=1;g<r;g+=1){const _=d-g&c-1;p+=n[g]*s[_],p-=t[g]*a[_]}for(let g=r;g<i;g+=1)p+=n[g]*s[d-g&c-1];for(let g=r;g<e;g+=1)p-=t[g]*a[d-g&c-1];s[d]=l[f],a[d]=p,d=d+1&c-1,u[f]=p}return d},got=(t,e,n,i)=>{const r=n instanceof Float64Array?n:new Float64Array(n),s=i instanceof Float64Array?i:new Float64Array(i),a=r.length,o=s.length,c=Math.min(a,o);if(r[0]!==1){for(let p=0;p<a;p+=1)s[p]/=r[0];for(let p=1;p<o;p+=1)r[p]/=r[0]}const l=32,u=new Float32Array(l),h=new Float32Array(l),d=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),f=t.numberOfChannels;for(let p=0;p<f;p+=1){const g=t.getChannelData(p),_=d.getChannelData(p);u.fill(0),h.fill(0),S0e(r,a,s,o,c,u,h,0,l,g,_)}return d},vot=(t,e,n,i,r)=>(s,a)=>{const o=new WeakMap;let c=null;const l=async(u,h)=>{let d=null,f=e(u);const p=mu(f,h);if(h.createIIRFilter===void 0?d=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(f=h.createIIRFilter(a,s)),o.set(h,d===null?f:d),d!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const _=new n(u.context.destination.channelCount,u.context.length,h.sampleRate);c=(async()=>{await i(u,_,_.destination);const v=await r(_);return got(v,h,s,a)})()}const g=await c;return d.buffer=g,d.start(0),d}return await i(u,h,f),f};return{render(u,h){const d=o.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},yot=(t,e,n,i,r,s)=>a=>(o,c)=>{const l=t.get(o);if(l===void 0){if(!a&&s(o)){const u=i(o),{outputs:h}=n(o);for(const d of h)if(uI(d)){const f=i(d[0]);e(u,f,d[1],d[2])}else{const f=r(d[0]);u.disconnect(f,d[1])}}t.set(o,c)}else t.set(o,l+c)},_ot=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},bot=(t,e)=>n=>t.has(n)||e(n),Eot=(t,e)=>n=>t.has(n)||e(n),Sot=(t,e)=>n=>{const i=t.get(n);return e(i)||e(n)},Tot=t=>e=>t!==null&&e instanceof t,xot=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,wot=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,Cot=(t,e)=>n=>t(n)||e(n),Rot=t=>e=>t!==null&&e instanceof t,Aot=t=>t!==null&&t.isSecureContext,Mot=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Oot={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Not=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s);if(i(o))throw new TypeError;const c={...Oot,...a},l=e(o,c);super(s,!1,l,null),this._nativeMediaStreamAudioDestinationNode=l}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Iot=(t,e,n,i)=>class extends t{constructor(s,a){const o=n(s),c=e(o,a);if(i(o))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},kot=(t,e,n)=>class extends t{constructor(r,s){const a=n(r),o=e(a,s);super(r,!0,o,null)}},Dot=(t,e,n,i,r,s)=>class extends n{constructor(o,c){super(o),this._nativeContext=o,y6.set(this,o),i(o)&&r.set(o,new Set),this._destination=new t(this,c),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const c=typeof o=="function"?s(this,o):null;this._nativeContext.onstatechange=c;const l=this._nativeContext.onstatechange;this._onstatechange=l!==null&&l===c?o:l}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},wO=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},Pot=(t,e)=>(n,i,r)=>{const s=new Set;return n.connect=(a=>(o,c=0,l=0)=>{const u=s.size===0;if(e(o))return a.call(n,o,c,l),t(s,[o,c,l],h=>h[0]===o&&h[1]===c&&h[2]===l,!0),u&&i(),o;a.call(n,o,c),t(s,[o,c],h=>h[0]===o&&h[1]===c,!0),u&&i()})(n.connect),n.disconnect=(a=>(o,c,l)=>{const u=s.size>0;if(o===void 0)a.apply(n),s.clear();else if(typeof o=="number"){a.call(n,o);for(const d of s)d[1]===o&&s.delete(d)}else{e(o)?a.call(n,o,c,l):a.call(n,o,c);for(const d of s)d[0]===o&&(c===void 0||d[1]===c)&&(l===void 0||d[2]===l)&&s.delete(d)}const h=s.size===0;u&&h&&r()})(n.disconnect),n},Na=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n]&&(t[n]=i)},Vc=(t,e)=>{Na(t,e,"channelCount"),Na(t,e,"channelCountMode"),Na(t,e,"channelInterpretation")},bne=t=>typeof t.getFloatTimeDomainData=="function",Lot=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let r=0;r<i;r+=1)e[r]=(n[r]-128)*.0078125;return e}},Uot=(t,e)=>(n,i)=>{const r=n.createAnalyser();if(Vc(r,i),!(i.maxDecibels>i.minDecibels))throw e();return Na(r,i,"fftSize"),Na(r,i,"maxDecibels"),Na(r,i,"minDecibels"),Na(r,i,"smoothingTimeConstant"),t(bne,()=>bne(r))||Lot(r),r},Bot=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,_o=(t,e,n)=>{const i=e[n];i!==void 0&&i!==t[n].value&&(t[n].value=i)},Fot=t=>{t.start=(e=>{let n=!1;return(i=0,r=0,s)=>{if(n)throw pl();e.call(t,i,r,s),n=!0}})(t.start)},k9=t=>{t.start=(e=>(n=0,i=0,r)=>{if(typeof r=="number"&&r<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,r)})(t.start)},D9=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},zot=(t,e,n,i,r,s,a,o,c,l,u)=>(h,d)=>{const f=h.createBufferSource();return Vc(f,d),_o(f,d,"playbackRate"),Na(f,d,"buffer"),Na(f,d,"loop"),Na(f,d,"loopEnd"),Na(f,d,"loopStart"),e(n,()=>n(h))||Fot(f),e(i,()=>i(h))||c(f),e(r,()=>r(h))||l(f,h),e(s,()=>s(h))||k9(f),e(a,()=>a(h))||u(f,h),e(o,()=>o(h))||D9(f),t(h,f),f},Hot=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,jot=(t,e)=>(n,i,r)=>{const s=n.destination;if(s.channelCount!==i)try{s.channelCount=i}catch{}r&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:i});const a=t(n,{channelCount:i,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>c=>{o.call(a,c);try{s.channelCount=c}catch(l){if(c>s.maxChannelCount)throw l}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelCountMode=c}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>c=>{o.call(a,c),s.channelInterpretation=c}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},Vot=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,Got=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},qot=(t,e,n,i,r)=>(s,a,o,c,l,u)=>{if(o!==null)try{const h=new o(s,c,u),d=new Map;let f=null;if(Object.defineProperties(h,{channelCount:{get:()=>u.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>f,set:p=>{typeof f=="function"&&h.removeEventListener("processorerror",f),f=typeof p=="function"?p:null,typeof f=="function"&&h.addEventListener("processorerror",f)}}}),h.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const _=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(_!==null){const v=d.get(g[1]);v!==void 0?g[1]=v:(g[1]=E=>{E.type==="error"?(Object.defineProperties(E,{type:{value:"processorerror"}}),_(E)):_(new ErrorEvent(g[0],{...E}))},d.set(_,g[1]))}}return p.call(h,"error",g[1],g[2]),p.call(h,...g)})(h.addEventListener),h.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const _=d.get(g[1]);_!==void 0&&(d.delete(g[1]),g[1]=_)}return p.call(h,"error",g[1],g[2]),p.call(h,g[0],g[1],g[2])})(h.removeEventListener),u.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(s.destination),r(h,()=>p.disconnect(),()=>p.connect(s.destination))}return h}catch(h){throw h.code===11?i():h}if(l===void 0)throw i();return Got(u),e(s,a,l,u)},T0e=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),$ot=t=>new Promise((e,n)=>{const{port1:i,port2:r}=new MessageChannel;i.onmessage=({data:s})=>{i.close(),r.close(),e(s)},i.onmessageerror=({data:s})=>{i.close(),r.close(),n(s)},r.postMessage(t)}),Wot=async(t,e)=>{const n=await $ot(e);return new t(n)},Yot=(t,e,n,i)=>{let r=pG.get(t);r===void 0&&(r=new WeakMap,pG.set(t,r));const s=Wot(n,i);return r.set(e,s),s},Xot=(t,e,n,i,r,s,a,o,c,l,u,h,d)=>(f,p,g,_)=>{if(_.numberOfInputs===0&&_.numberOfOutputs===0)throw c();const v=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(v.some(Fe=>Fe<1))throw c();if(v.length!==_.numberOfOutputs)throw e();if(_.channelCountMode!=="explicit")throw c();const E=_.channelCount*_.numberOfInputs,T=v.reduce((Fe,Ie)=>Fe+Ie,0),x=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(E+x>6||T>6)throw c();const N=new MessageChannel,A=[],I=[];for(let Fe=0;Fe<_.numberOfInputs;Fe+=1)A.push(a(f,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),I.push(r(f,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const k=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:Fe,maxValue:Ie,minValue:it,name:dt}of g.parameterDescriptors){const gt=s(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:_.parameterData[dt]!==void 0?_.parameterData[dt]:Fe===void 0?0:Fe});Object.defineProperties(gt.offset,{defaultValue:{get:()=>Fe===void 0?0:Fe},maxValue:{get:()=>Ie===void 0?Wu:Ie},minValue:{get:()=>it===void 0?kh:it}}),k.push(gt)}const L=i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,E+x)}),U=T0e(p,f.sampleRate),$=o(f,U,E+x,Math.max(1,T)),q=r(f,{channelCount:Math.max(1,T),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,T)}),G=[];for(let Fe=0;Fe<_.numberOfOutputs;Fe+=1)G.push(i(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[Fe]}));for(let Fe=0;Fe<_.numberOfInputs;Fe+=1){A[Fe].connect(I[Fe]);for(let Ie=0;Ie<_.channelCount;Ie+=1)I[Fe].connect(L,Ie,Fe*_.channelCount+Ie)}const X=new b0e(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:Fe},Ie)=>{const it=k[Ie];return it.connect(L,0,E+Ie),it.start(0),[Fe,it.offset]}));L.connect($);let ie=_.channelInterpretation,V=null;const Z=_.numberOfOutputs===0?[$]:G,Y={get bufferSize(){return U},get channelCount(){return _.channelCount},set channelCount(Fe){throw n()},get channelCountMode(){return _.channelCountMode},set channelCountMode(Fe){throw n()},get channelInterpretation(){return ie},set channelInterpretation(Fe){for(const Ie of A)Ie.channelInterpretation=Fe;ie=Fe},get context(){return $.context},get inputs(){return A},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},get onprocessorerror(){return V},set onprocessorerror(Fe){typeof V=="function"&&Y.removeEventListener("processorerror",V),V=typeof Fe=="function"?Fe:null,typeof V=="function"&&Y.addEventListener("processorerror",V)},get parameters(){return X},get port(){return N.port2},addEventListener(...Fe){return $.addEventListener(Fe[0],Fe[1],Fe[2])},connect:t.bind(null,Z),disconnect:l.bind(null,Z),dispatchEvent(...Fe){return $.dispatchEvent(Fe[0])},removeEventListener(...Fe){return $.removeEventListener(Fe[0],Fe[1],Fe[2])}},ee=new Map;N.port1.addEventListener=(Fe=>(...Ie)=>{if(Ie[0]==="message"){const it=typeof Ie[1]=="function"?Ie[1]:typeof Ie[1]=="object"&&Ie[1]!==null&&typeof Ie[1].handleEvent=="function"?Ie[1].handleEvent:null;if(it!==null){const dt=ee.get(Ie[1]);dt!==void 0?Ie[1]=dt:(Ie[1]=gt=>{u(f.currentTime,f.sampleRate,()=>it(gt))},ee.set(it,Ie[1]))}}return Fe.call(N.port1,Ie[0],Ie[1],Ie[2])})(N.port1.addEventListener),N.port1.removeEventListener=(Fe=>(...Ie)=>{if(Ie[0]==="message"){const it=ee.get(Ie[1]);it!==void 0&&(ee.delete(Ie[1]),Ie[1]=it)}return Fe.call(N.port1,Ie[0],Ie[1],Ie[2])})(N.port1.removeEventListener);let oe=null;Object.defineProperty(N.port1,"onmessage",{get:()=>oe,set:Fe=>{typeof oe=="function"&&N.port1.removeEventListener("message",oe),oe=typeof Fe=="function"?Fe:null,typeof oe=="function"&&(N.port1.addEventListener("message",oe),N.port1.start())}}),g.prototype.port=N.port1;let de=null;Yot(f,Y,g,_).then(Fe=>de=Fe);const He=bU(_.numberOfInputs,_.channelCount),Te=bU(_.numberOfOutputs,v),Le=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((Fe,{name:Ie})=>({...Fe,[Ie]:new Float32Array(128)}),{});let we=!0;const Ce=()=>{_.numberOfOutputs>0&&$.disconnect(q);for(let Fe=0,Ie=0;Fe<_.numberOfOutputs;Fe+=1){const it=G[Fe];for(let dt=0;dt<v[Fe];dt+=1)q.disconnect(it,Ie+dt,dt);Ie+=v[Fe]}},ke=new Map;$.onaudioprocess=({inputBuffer:Fe,outputBuffer:Ie})=>{if(de!==null){const it=h(Y);for(let dt=0;dt<U;dt+=128){for(let gt=0;gt<_.numberOfInputs;gt+=1)for(let bt=0;bt<_.channelCount;bt+=1)_U(Fe,He[gt],bt,bt,dt);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:gt},bt)=>{_U(Fe,Le,gt,E+bt,dt)});for(let gt=0;gt<_.numberOfInputs;gt+=1)for(let bt=0;bt<v[gt];bt+=1)Te[gt][bt].byteLength===0&&(Te[gt][bt]=new Float32Array(128));try{const gt=He.map((be,ue)=>{if(it[ue].size>0)return ke.set(ue,U/128),be;const nt=ke.get(ue);return nt===void 0?[]:(be.every($e=>$e.every(Ue=>Ue===0))&&(nt===1?ke.delete(ue):ke.set(ue,nt-1)),be)});we=u(f.currentTime+dt/f.sampleRate,f.sampleRate,()=>de.process(gt,Te,Le));for(let be=0,ue=0;be<_.numberOfOutputs;be+=1){for(let Xe=0;Xe<v[be];Xe+=1)E0e(Ie,Te[be],Xe,ue+Xe,dt);ue+=v[be]}}catch(gt){we=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:gt.colno,filename:gt.filename,lineno:gt.lineno,message:gt.message}))}if(!we){for(let gt=0;gt<_.numberOfInputs;gt+=1){A[gt].disconnect(I[gt]);for(let bt=0;bt<_.channelCount;bt+=1)I[dt].disconnect(L,bt,gt*_.channelCount+bt)}if(g.parameterDescriptors!==void 0){const gt=g.parameterDescriptors.length;for(let bt=0;bt<gt;bt+=1){const be=k[bt];be.disconnect(L,0,E+bt),be.stop()}}L.disconnect($),$.onaudioprocess=null,St?Ce():ye();break}}}};let St=!1;const At=a(f,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),Ee=()=>$.connect(At).connect(f.destination),ye=()=>{$.disconnect(At),At.disconnect()},et=()=>{if(we){ye(),_.numberOfOutputs>0&&$.connect(q);for(let Fe=0,Ie=0;Fe<_.numberOfOutputs;Fe+=1){const it=G[Fe];for(let dt=0;dt<v[Fe];dt+=1)q.connect(it,Ie+dt,dt);Ie+=v[Fe]}}St=!0},fe=()=>{we&&(Ee(),Ce()),St=!1};return Ee(),d(Y,et,fe)},x0e=(t,e)=>{const n=t.createBiquadFilter();return Vc(n,e),_o(n,e,"Q"),_o(n,e,"detune"),_o(n,e,"frequency"),_o(n,e,"gain"),Na(n,e,"type"),n},Kot=(t,e)=>(n,i)=>{const r=n.createChannelMerger(i.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,r),Vc(r,i),r},Jot=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw pl()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw pl()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw pl()}})},hI=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Vc(n,e),Jot(n),n},Zot=(t,e,n,i,r)=>(s,a)=>{if(s.createConstantSource===void 0)return n(s,a);const o=s.createConstantSource();return Vc(o,a),_o(o,a,"offset"),e(i,()=>i(s))||k9(o),e(r,()=>r(s))||D9(o),t(s,o),o},rR=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Qot=(t,e,n,i)=>(r,{offset:s,...a})=>{const o=r.createBuffer(1,2,44100),c=e(r,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(r,{...a,gain:s}),u=o.getChannelData(0);u[0]=1,u[1]=1,c.buffer=o,c.loop=!0;const h={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(p){l.channelCount=p},get channelCountMode(){return l.channelCountMode},set channelCountMode(p){l.channelCountMode=p},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(p){l.channelInterpretation=p},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},d=()=>c.connect(l),f=()=>c.disconnect(l);return t(r,c),i(rR(h,l),d,f)},ect=(t,e)=>(n,i)=>{const r=n.createConvolver();if(Vc(r,i),i.disableNormalization===r.normalize&&(r.normalize=!i.disableNormalization),Na(r,i,"buffer"),i.channelCount>2||(e(r,"channelCount",s=>()=>s.call(r),s=>a=>{if(a>2)throw t();return s.call(r,a)}),i.channelCountMode==="max"))throw t();return e(r,"channelCountMode",s=>()=>s.call(r),s=>a=>{if(a==="max")throw t();return s.call(r,a)}),r},w0e=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Vc(n,e),_o(n,e,"delayTime"),n},tct=t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Vc(i,n),n.channelCount>2||n.channelCountMode==="max")throw t();return _o(i,n,"attack"),_o(i,n,"knee"),_o(i,n,"ratio"),_o(i,n,"release"),_o(i,n,"threshold"),i},td=(t,e)=>{const n=t.createGain();return Vc(n,e),_o(n,e,"gain"),n},nct=t=>(e,n,i)=>{if(e.createIIRFilter===void 0)return t(e,n,i);const r=e.createIIRFilter(i.feedforward,i.feedback);return Vc(r,i),r};function ict(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function rct(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function Ene(t,e){let n=[0,0];for(let i=t.length-1;i>=0;i-=1)n=rct(n,e),n[0]+=t[i];return n}const sct=(t,e,n,i)=>(r,s,{channelCount:a,channelCountMode:o,channelInterpretation:c,feedback:l,feedforward:u})=>{const h=T0e(s,r.sampleRate),d=l instanceof Float64Array?l:new Float64Array(l),f=u instanceof Float64Array?u:new Float64Array(u),p=d.length,g=f.length,_=Math.min(p,g);if(p===0||p>20)throw i();if(d[0]===0)throw e();if(g===0||g>20)throw i();if(f[0]===0)throw e();if(d[0]!==1){for(let k=0;k<g;k+=1)f[k]/=d[0];for(let k=1;k<p;k+=1)d[k]/=d[0]}const v=n(r,h,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=c;const E=32,T=[],x=[],N=[];for(let k=0;k<a;k+=1){T.push(0);const L=new Float32Array(E),U=new Float32Array(E);L.fill(0),U.fill(0),x.push(L),N.push(U)}v.onaudioprocess=k=>{const L=k.inputBuffer,U=k.outputBuffer,$=L.numberOfChannels;for(let q=0;q<$;q+=1){const G=L.getChannelData(q),X=U.getChannelData(q);T[q]=S0e(d,p,f,g,_,x[q],N[q],T[q],E,G,X)}};const A=r.sampleRate/2;return rR({get bufferSize(){return h},get channelCount(){return v.channelCount},set channelCount(k){v.channelCount=k},get channelCountMode(){return v.channelCountMode},set channelCountMode(k){v.channelCountMode=k},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(k){v.channelInterpretation=k},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...k){return v.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return v.dispatchEvent(k[0])},getFrequencyResponse(k,L,U){if(k.length!==L.length||L.length!==U.length)throw t();const $=k.length;for(let q=0;q<$;q+=1){const G=-Math.PI*(k[q]/A),X=[Math.cos(G),Math.sin(G)],ie=Ene(f,X),V=Ene(d,X),Z=ict(ie,V);L[q]=Math.sqrt(Z[0]*Z[0]+Z[1]*Z[1]),U[q]=Math.atan2(Z[1],Z[0])}},removeEventListener(...k){return v.removeEventListener(k[0],k[1],k[2])}},v)},act=(t,e)=>t.createMediaElementSource(e.mediaElement),oct=(t,e)=>{const n=t.createMediaStreamDestination();return Vc(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},cct=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const i=n.slice(0,1),r=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(r,"mediaStream",{value:e}),r},lct=(t,e)=>(n,{mediaStreamTrack:i})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(i);const r=new MediaStream([i]),s=n.createMediaStreamSource(r);if(i.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},uct=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,hct=(t,e,n,i,r,s)=>(a,o)=>{const c=a.createOscillator();return Vc(c,o),_o(c,o,"detune"),_o(c,o,"frequency"),o.periodicWave!==void 0?c.setPeriodicWave(o.periodicWave):Na(c,o,"type"),e(n,()=>n(a))||k9(c),e(i,()=>i(a))||s(c,a),e(r,()=>r(a))||D9(c),t(a,c),c},dct=t=>(e,n)=>{const i=e.createPanner();return i.orientationX===void 0?t(e,n):(Vc(i,n),_o(i,n,"orientationX"),_o(i,n,"orientationY"),_o(i,n,"orientationZ"),_o(i,n,"positionX"),_o(i,n,"positionY"),_o(i,n,"positionZ"),Na(i,n,"coneInnerAngle"),Na(i,n,"coneOuterAngle"),Na(i,n,"coneOuterGain"),Na(i,n,"distanceModel"),Na(i,n,"maxDistance"),Na(i,n,"panningModel"),Na(i,n,"refDistance"),Na(i,n,"rolloffFactor"),i)},fct=(t,e,n,i,r,s,a,o,c,l)=>(u,{coneInnerAngle:h,coneOuterAngle:d,coneOuterGain:f,distanceModel:p,maxDistance:g,orientationX:_,orientationY:v,orientationZ:E,panningModel:T,positionX:x,positionY:N,positionZ:A,refDistance:I,rolloffFactor:k,...L})=>{const U=u.createPanner();if(L.channelCount>2||L.channelCountMode==="max")throw a();Vc(U,L);const $={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},q=n(u,{...$,channelInterpretation:"speakers",numberOfInputs:6}),G=i(u,{...L,gain:1}),X=i(u,{...$,gain:1}),ie=i(u,{...$,gain:0}),V=i(u,{...$,gain:0}),Z=i(u,{...$,gain:0}),Y=i(u,{...$,gain:0}),ee=i(u,{...$,gain:0}),oe=r(u,256,6,1),de=s(u,{...$,curve:new Float32Array([1,1]),oversample:"none"});let Me=[_,v,E],He=[x,N,A];const Te=new Float32Array(1);oe.onaudioprocess=({inputBuffer:ke})=>{const St=[c(ke,Te,0),c(ke,Te,1),c(ke,Te,2)];St.some((Ee,ye)=>Ee!==Me[ye])&&(U.setOrientation(...St),Me=St);const At=[c(ke,Te,3),c(ke,Te,4),c(ke,Te,5)];At.some((Ee,ye)=>Ee!==He[ye])&&(U.setPosition(...At),He=At)},Object.defineProperty(ie.gain,"defaultValue",{get:()=>0}),Object.defineProperty(V.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Z.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0});const Le={get bufferSize(){},get channelCount(){return U.channelCount},set channelCount(ke){if(ke>2)throw a();G.channelCount=ke,U.channelCount=ke},get channelCountMode(){return U.channelCountMode},set channelCountMode(ke){if(ke==="max")throw a();G.channelCountMode=ke,U.channelCountMode=ke},get channelInterpretation(){return U.channelInterpretation},set channelInterpretation(ke){G.channelInterpretation=ke,U.channelInterpretation=ke},get coneInnerAngle(){return U.coneInnerAngle},set coneInnerAngle(ke){U.coneInnerAngle=ke},get coneOuterAngle(){return U.coneOuterAngle},set coneOuterAngle(ke){U.coneOuterAngle=ke},get coneOuterGain(){return U.coneOuterGain},set coneOuterGain(ke){if(ke<0||ke>1)throw e();U.coneOuterGain=ke},get context(){return U.context},get distanceModel(){return U.distanceModel},set distanceModel(ke){U.distanceModel=ke},get inputs(){return[G]},get maxDistance(){return U.maxDistance},set maxDistance(ke){if(ke<0)throw new RangeError;U.maxDistance=ke},get numberOfInputs(){return U.numberOfInputs},get numberOfOutputs(){return U.numberOfOutputs},get orientationX(){return X.gain},get orientationY(){return ie.gain},get orientationZ(){return V.gain},get panningModel(){return U.panningModel},set panningModel(ke){U.panningModel=ke},get positionX(){return Z.gain},get positionY(){return Y.gain},get positionZ(){return ee.gain},get refDistance(){return U.refDistance},set refDistance(ke){if(ke<0)throw new RangeError;U.refDistance=ke},get rolloffFactor(){return U.rolloffFactor},set rolloffFactor(ke){if(ke<0)throw new RangeError;U.rolloffFactor=ke},addEventListener(...ke){return G.addEventListener(ke[0],ke[1],ke[2])},dispatchEvent(...ke){return G.dispatchEvent(ke[0])},removeEventListener(...ke){return G.removeEventListener(ke[0],ke[1],ke[2])}};h!==Le.coneInnerAngle&&(Le.coneInnerAngle=h),d!==Le.coneOuterAngle&&(Le.coneOuterAngle=d),f!==Le.coneOuterGain&&(Le.coneOuterGain=f),p!==Le.distanceModel&&(Le.distanceModel=p),g!==Le.maxDistance&&(Le.maxDistance=g),_!==Le.orientationX.value&&(Le.orientationX.value=_),v!==Le.orientationY.value&&(Le.orientationY.value=v),E!==Le.orientationZ.value&&(Le.orientationZ.value=E),T!==Le.panningModel&&(Le.panningModel=T),x!==Le.positionX.value&&(Le.positionX.value=x),N!==Le.positionY.value&&(Le.positionY.value=N),A!==Le.positionZ.value&&(Le.positionZ.value=A),I!==Le.refDistance&&(Le.refDistance=I),k!==Le.rolloffFactor&&(Le.rolloffFactor=k),(Me[0]!==1||Me[1]!==0||Me[2]!==0)&&U.setOrientation(...Me),(He[0]!==0||He[1]!==0||He[2]!==0)&&U.setPosition(...He);const we=()=>{G.connect(U),t(G,de,0,0),de.connect(X).connect(q,0,0),de.connect(ie).connect(q,0,1),de.connect(V).connect(q,0,2),de.connect(Z).connect(q,0,3),de.connect(Y).connect(q,0,4),de.connect(ee).connect(q,0,5),q.connect(oe).connect(u.destination)},Ce=()=>{G.disconnect(U),o(G,de,0,0),de.disconnect(X),X.disconnect(q),de.disconnect(ie),ie.disconnect(q),de.disconnect(V),V.disconnect(q),de.disconnect(Z),Z.disconnect(q),de.disconnect(Y),Y.disconnect(q),de.disconnect(ee),ee.disconnect(q),q.disconnect(oe),oe.disconnect(u.destination)};return l(rR(Le,U),we,Ce)},pct=t=>(e,{disableNormalization:n,imag:i,real:r})=>{const s=i instanceof Float32Array?i:new Float32Array(i),a=r instanceof Float32Array?r:new Float32Array(r),o=e.createPeriodicWave(a,s,{disableNormalization:n});if(Array.from(i).length<2)throw t();return o},dI=(t,e,n,i)=>t.createScriptProcessor(e,n,i),mct=(t,e)=>(n,i)=>{const r=i.channelCountMode;if(r==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,i);const s=n.createStereoPanner();return Vc(s,i),_o(s,i,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>r,set:a=>{if(a!==r)throw e()}}),s},gct=(t,e,n,i,r,s)=>{const o=new Float32Array([1,1]),c=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...l,oversample:"none"},h=(p,g,_,v)=>{const E=new Float32Array(16385),T=new Float32Array(16385);for(let L=0;L<16385;L+=1){const U=L/16384*c;E[L]=Math.cos(U),T[L]=Math.sin(U)}const x=n(p,{...l,gain:0}),N=i(p,{...u,curve:E}),A=i(p,{...u,curve:o}),I=n(p,{...l,gain:0}),k=i(p,{...u,curve:T});return{connectGraph(){g.connect(x),g.connect(A.inputs===void 0?A:A.inputs[0]),g.connect(I),A.connect(_),_.connect(N.inputs===void 0?N:N.inputs[0]),_.connect(k.inputs===void 0?k:k.inputs[0]),N.connect(x.gain),k.connect(I.gain),x.connect(v,0,0),I.connect(v,0,1)},disconnectGraph(){g.disconnect(x),g.disconnect(A.inputs===void 0?A:A.inputs[0]),g.disconnect(I),A.disconnect(_),_.disconnect(N.inputs===void 0?N:N.inputs[0]),_.disconnect(k.inputs===void 0?k:k.inputs[0]),N.disconnect(x.gain),k.disconnect(I.gain),x.disconnect(v,0,0),I.disconnect(v,0,1)}}},d=(p,g,_,v)=>{const E=new Float32Array(16385),T=new Float32Array(16385),x=new Float32Array(16385),N=new Float32Array(16385),A=Math.floor(16385/2);for(let Z=0;Z<16385;Z+=1)if(Z>A){const Y=(Z-A)/(16384-A)*c;E[Z]=Math.cos(Y),T[Z]=Math.sin(Y),x[Z]=0,N[Z]=1}else{const Y=Z/(16384-A)*c;E[Z]=1,T[Z]=0,x[Z]=Math.cos(Y),N[Z]=Math.sin(Y)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(p,{...l,gain:0}),L=i(p,{...u,curve:E}),U=n(p,{...l,gain:0}),$=i(p,{...u,curve:T}),q=i(p,{...u,curve:o}),G=n(p,{...l,gain:0}),X=i(p,{...u,curve:x}),ie=n(p,{...l,gain:0}),V=i(p,{...u,curve:N});return{connectGraph(){g.connect(I),g.connect(q.inputs===void 0?q:q.inputs[0]),I.connect(k,0),I.connect(U,0),I.connect(G,1),I.connect(ie,1),q.connect(_),_.connect(L.inputs===void 0?L:L.inputs[0]),_.connect($.inputs===void 0?$:$.inputs[0]),_.connect(X.inputs===void 0?X:X.inputs[0]),_.connect(V.inputs===void 0?V:V.inputs[0]),L.connect(k.gain),$.connect(U.gain),X.connect(G.gain),V.connect(ie.gain),k.connect(v,0,0),G.connect(v,0,0),U.connect(v,0,1),ie.connect(v,0,1)},disconnectGraph(){g.disconnect(I),g.disconnect(q.inputs===void 0?q:q.inputs[0]),I.disconnect(k,0),I.disconnect(U,0),I.disconnect(G,1),I.disconnect(ie,1),q.disconnect(_),_.disconnect(L.inputs===void 0?L:L.inputs[0]),_.disconnect($.inputs===void 0?$:$.inputs[0]),_.disconnect(X.inputs===void 0?X:X.inputs[0]),_.disconnect(V.inputs===void 0?V:V.inputs[0]),L.disconnect(k.gain),$.disconnect(U.gain),X.disconnect(G.gain),V.disconnect(ie.gain),k.disconnect(v,0,0),G.disconnect(v,0,0),U.disconnect(v,0,1),ie.disconnect(v,0,1)}}},f=(p,g,_,v,E)=>{if(g===1)return h(p,_,v,E);if(g===2)return d(p,_,v,E);throw r()};return(p,{channelCount:g,channelCountMode:_,pan:v,...E})=>{if(_==="max")throw r();const T=t(p,{...E,channelCount:1,channelCountMode:_,numberOfInputs:2}),x=n(p,{...E,channelCount:g,channelCountMode:_,gain:1}),N=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:A,disconnectGraph:I}=f(p,g,x,N,T);Object.defineProperty(N.gain,"defaultValue",{get:()=>0}),Object.defineProperty(N.gain,"maxValue",{get:()=>1}),Object.defineProperty(N.gain,"minValue",{get:()=>-1});const k={get bufferSize(){},get channelCount(){return x.channelCount},set channelCount(q){x.channelCount!==q&&(L&&I(),{connectGraph:A,disconnectGraph:I}=f(p,q,x,N,T),L&&A()),x.channelCount=q},get channelCountMode(){return x.channelCountMode},set channelCountMode(q){if(q==="clamped-max"||q==="max")throw r();x.channelCountMode=q},get channelInterpretation(){return x.channelInterpretation},set channelInterpretation(q){x.channelInterpretation=q},get context(){return x.context},get inputs(){return[x]},get numberOfInputs(){return x.numberOfInputs},get numberOfOutputs(){return x.numberOfOutputs},get pan(){return N.gain},addEventListener(...q){return x.addEventListener(q[0],q[1],q[2])},dispatchEvent(...q){return x.dispatchEvent(q[0])},removeEventListener(...q){return x.removeEventListener(q[0],q[1],q[2])}};let L=!1;const U=()=>{A(),L=!0},$=()=>{I(),L=!1};return s(rR(k,T),U,$)}},vct=(t,e,n,i,r,s,a)=>(o,c)=>{const l=o.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return n(o,c);Vc(l,c);const u=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(u!==null&&u.length<2)throw e();Na(l,{curve:u},"curve"),Na(l,c,"oversample");let h=null,d=!1;return a(l,"curve",g=>()=>g.call(l),g=>_=>(g.call(l,_),d&&(i(_)&&h===null?h=t(o,l):!i(_)&&h!==null&&(h(),h=null)),_)),r(l,()=>{d=!0,i(l.curve)&&(h=t(o,l))},()=>{d=!1,h!==null&&(h(),h=null)})},yct=(t,e,n,i,r)=>(s,{curve:a,oversample:o,...c})=>{const l=s.createWaveShaper(),u=s.createWaveShaper();Vc(l,c),Vc(u,c);const h=n(s,{...c,gain:1}),d=n(s,{...c,gain:-1}),f=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,_=!1,v=null;const E={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(N){h.channelCount=N,d.channelCount=N,l.channelCount=N,f.channelCount=N,u.channelCount=N,p.channelCount=N},get channelCountMode(){return l.channelCountMode},set channelCountMode(N){h.channelCountMode=N,d.channelCountMode=N,l.channelCountMode=N,f.channelCountMode=N,u.channelCountMode=N,p.channelCountMode=N},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(N){h.channelInterpretation=N,d.channelInterpretation=N,l.channelInterpretation=N,f.channelInterpretation=N,u.channelInterpretation=N,p.channelInterpretation=N},get context(){return l.context},get curve(){return v},set curve(N){if(N!==null&&N.length<2)throw e();if(N===null)l.curve=N,u.curve=N;else{const A=N.length,I=new Float32Array(A+2-A%2),k=new Float32Array(A+2-A%2);I[0]=N[0],k[0]=-N[A-1];const L=Math.ceil((A+1)/2),U=(A+1)/2-1;for(let $=1;$<L;$+=1){const q=$/L*U,G=Math.floor(q),X=Math.ceil(q);I[$]=G===X?N[G]:(1-(q-G))*N[G]+(1-(X-q))*N[X],k[$]=G===X?-N[A-1-G]:-((1-(q-G))*N[A-1-G])-(1-(X-q))*N[A-1-X]}I[L]=A%2===1?N[L-1]:(N[L-2]+N[L-1])/2,l.curve=I,u.curve=k}v=N,_&&(i(v)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(N){l.oversample=N,u.oversample=N},addEventListener(...N){return h.addEventListener(N[0],N[1],N[2])},dispatchEvent(...N){return h.dispatchEvent(N[0])},removeEventListener(...N){return h.removeEventListener(N[0],N[1],N[2])}};a!==null&&(E.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==E.oversample&&(E.oversample=o);const T=()=>{h.connect(l).connect(f),h.connect(d).connect(u).connect(p).connect(f),_=!0,i(v)&&(g=t(s,h))},x=()=>{h.disconnect(l),l.disconnect(f),h.disconnect(d),d.disconnect(u),u.disconnect(p),p.disconnect(f),_=!1,g!==null&&(g(),g=null)};return r(rR(E,f),T,x)},rh=()=>new DOMException("","NotSupportedError"),_ct={numberOfChannels:1},bct=(t,e,n,i,r)=>class extends t{constructor(a,o,c){let l;if(typeof a=="number"&&o!==void 0&&c!==void 0)l={length:o,numberOfChannels:a,sampleRate:c};else if(typeof a=="object")l=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:h,sampleRate:d}={..._ct,...l},f=i(h,u,d);e(wO,()=>wO(f))||f.addEventListener("statechange",(()=>{let p=0;const g=_=>{this._state==="running"&&(p>0?(f.removeEventListener("statechange",g),_.stopImmediatePropagation(),this._waitForThePromiseToSettle(_)):p+=1)};return g})()),super(f,h),this._length=u,this._nativeOfflineAudioContext=f,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",r(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,g0e(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},Ect={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Sct=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Ect,...l},d=n(u,h),f=s(u),p=f?i():null,g=c.sampleRate/2;super(c,!1,d,p),this._detune=e(this,f,d.detune,153600,-153600),this._frequency=e(this,f,d.frequency,g,-g),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const l=typeof c=="function"?a(this,c):null;this._nativeOscillatorNode.onended=l;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===l?c:u}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){TC(this);const l=()=>{this._nativeOscillatorNode.removeEventListener("ended",l),Wv(this)&&cI(this)};this._nativeOscillatorNode.addEventListener("ended",l)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},Tct=(t,e,n,i,r)=>()=>{const s=new WeakMap;let a=null,o=null,c=null;const l=async(u,h)=>{let d=n(u);const f=mu(d,h);if(!f){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:a===null?void 0:a,type:d.type};d=e(h,p),o!==null&&d.start(o),c!==null&&d.stop(c)}return s.set(h,d),f?(await t(h,u.detune,d.detune),await t(h,u.frequency,d.frequency)):(await i(h,u.detune,d.detune),await i(h,u.frequency,d.frequency)),await r(u,h,d),d};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){c=u},render(u,h){const d=s.get(h);return d!==void 0?Promise.resolve(d):l(u,h)}}},xct={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},wct=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...xct,...l},d=n(u,h),f=s(u),p=f?i():null;super(c,!1,d,p),this._nativePannerNode=d,this._orientationX=e(this,f,d.orientationX,Wu,kh),this._orientationY=e(this,f,d.orientationY,Wu,kh),this._orientationZ=e(this,f,d.orientationZ,Wu,kh),this._positionX=e(this,f,d.positionX,Wu,kh),this._positionY=e(this,f,d.positionY,Wu,kh),this._positionZ=e(this,f,d.positionZ,Wu,kh),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},Cct=(t,e,n,i,r,s,a,o,c,l)=>()=>{const u=new WeakMap;let h=null;const d=async(f,p)=>{let g=null,_=s(f);const v={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation},E={...v,coneInnerAngle:_.coneInnerAngle,coneOuterAngle:_.coneOuterAngle,coneOuterGain:_.coneOuterGain,distanceModel:_.distanceModel,maxDistance:_.maxDistance,panningModel:_.panningModel,refDistance:_.refDistance,rolloffFactor:_.rolloffFactor},T=mu(_,p);if("bufferSize"in _)g=i(p,{...v,gain:1});else if(!T){const x={...E,orientationX:_.orientationX.value,orientationY:_.orientationY.value,orientationZ:_.orientationZ.value,positionX:_.positionX.value,positionY:_.positionY.value,positionZ:_.positionZ.value};_=r(p,x)}if(u.set(p,g===null?_:g),g!==null){if(h===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const $=new a(6,f.context.length,p.sampleRate),q=e($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});q.connect($.destination),h=(async()=>{const G=await Promise.all([f.orientationX,f.orientationY,f.orientationZ,f.positionX,f.positionY,f.positionZ].map(async(X,ie)=>{const V=n($,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ie===0?1:0});return await o($,X,V.offset),V}));for(let X=0;X<6;X+=1)G[X].connect(q,0,X),G[X].start(0);return l($)})()}const x=await h,N=i(p,{...v,gain:1});await c(f,p,N);const A=[];for(let $=0;$<x.numberOfChannels;$+=1)A.push(x.getChannelData($));let I=[A[0][0],A[1][0],A[2][0]],k=[A[3][0],A[4][0],A[5][0]],L=i(p,{...v,gain:1}),U=r(p,{...E,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]});N.connect(L).connect(U.inputs[0]),U.connect(g);for(let $=128;$<x.length;$+=128){const q=[A[0][$],A[1][$],A[2][$]],G=[A[3][$],A[4][$],A[5][$]];if(q.some((X,ie)=>X!==I[ie])||G.some((X,ie)=>X!==k[ie])){I=q,k=G;const X=$/p.sampleRate;L.gain.setValueAtTime(0,X),L=i(p,{...v,gain:0}),U=r(p,{...E,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:k[0],positionY:k[1],positionZ:k[2]}),L.gain.setValueAtTime(1,X),N.connect(L).connect(U.inputs[0]),U.connect(g)}}return g}return T?(await t(p,f.orientationX,_.orientationX),await t(p,f.orientationY,_.orientationY),await t(p,f.orientationZ,_.orientationZ),await t(p,f.positionX,_.positionX),await t(p,f.positionY,_.positionY),await t(p,f.positionZ,_.positionZ)):(await o(p,f.orientationX,_.orientationX),await o(p,f.orientationY,_.orientationY),await o(p,f.orientationZ,_.orientationZ),await o(p,f.positionX,_.positionX),await o(p,f.positionY,_.positionY),await o(p,f.positionZ,_.positionZ)),iR(_)?await c(f,p,_.inputs[0]):await c(f,p,_),_};return{render(f,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):d(f,p)}}},Rct={disableNormalization:!1},Act=(t,e,n,i)=>class C0e{constructor(s,a){const o=e(s),c=i({...Rct,...a}),l=t(o,c);return n.add(l),l}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===C0e.prototype||n.has(s)}},Mct=(t,e)=>(n,i,r)=>(t(i).replay(r),e(i,n,r)),Oct=(t,e,n)=>async(i,r,s)=>{const a=t(i);await Promise.all(a.activeInputs.map((o,c)=>Array.from(o).map(async([l,u])=>{const d=await e(l).render(l,r),f=i.context.destination;!n(l)&&(i!==f||!n(i))&&d.connect(s,u,c)})).reduce((o,c)=>[...o,...c],[]))},Nct=(t,e,n)=>async(i,r,s)=>{const a=e(i);await Promise.all(Array.from(a.activeInputs).map(async([o,c])=>{const u=await t(o).render(o,r);n(o)||u.connect(s,c)}))},Ict=(t,e,n,i)=>r=>t(wO,()=>wO(r))?Promise.resolve(t(i,i)).then(s=>{if(!s){const a=n(r,512,0,1);r.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>r.currentTime,a.connect(r.destination)}return r.startRendering()}):new Promise(s=>{const a=e(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});r.oncomplete=o=>{a.disconnect(),s(o.renderedBuffer)},a.connect(r.destination),r.startRendering()}),kct=t=>(e,n)=>{t.set(e,n)},Dct=t=>(e,n)=>t.set(e,n),Pct=(t,e,n,i,r,s,a,o)=>(c,l)=>n(c).render(c,l).then(()=>Promise.all(Array.from(i(l)).map(u=>n(u).render(u,l)))).then(()=>r(l)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),O9(u)):e(s,()=>s(u))||o(u),t.add(u),u)),Lct={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Uct=(t,e,n,i,r,s)=>class extends t{constructor(o,c){const l=r(o),u={...Lct,...c},h=n(l,u),d=s(l),f=d?i():null;super(o,!1,h,f),this._pan=e(this,d,h.pan)}get pan(){return this._pan}},Bct=(t,e,n,i,r)=>()=>{const s=new WeakMap,a=async(o,c)=>{let l=n(o);const u=mu(l,c);if(!u){const h={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value};l=e(c,h)}return s.set(c,l),u?await t(c,o.pan,l.pan):await i(c,o.pan,l.pan),iR(l)?await r(o,c,l.inputs[0]):await r(o,c,l),l};return{render(o,c){const l=s.get(c);return l!==void 0?Promise.resolve(l):a(o,c)}}},Fct=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},zct=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,44100),r=URL.createObjectURL(n);let s=!1,a=!1;try{await i.audioWorklet.addModule(r);const o=new t(i,"a",{numberOfOutputs:0}),c=i.createOscillator();o.port.onmessage=()=>s=!0,o.onprocessorerror=()=>a=!0,c.connect(o),c.start(0),await i.startRendering(),await new Promise(l=>setTimeout(l))}catch{}finally{URL.revokeObjectURL(r)}return s&&!a},Hct=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{n.oncomplete=()=>{i.disconnect(),r(n.currentTime!==0)},n.startRendering()})},jct=()=>new DOMException("","UnknownError"),Vct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Gct=(t,e,n,i,r,s,a)=>class extends t{constructor(c,l){const u=r(c),h={...Vct,...l},d=n(u,h),p=s(u)?i():null;super(c,!0,d,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},qct=(t,e,n)=>()=>{const i=new WeakMap,r=async(s,a)=>{let o=e(s);if(!mu(o,a)){const l={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=t(a,l)}return i.set(a,o),iR(o)?await n(s,a,o.inputs[0]):await n(s,a,o),o};return{render(s,a){const o=i.get(a);return o!==void 0?Promise.resolve(o):r(s,a)}}},$ct=()=>typeof window>"u"?null:window,Wct=(t,e)=>n=>{n.copyFromChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)i[h]=l[h+a]},n.copyToChannel=(i,r,s=0)=>{const a=t(s),o=t(r);if(o>=n.numberOfChannels)throw e();const c=n.length,l=n.getChannelData(o),u=i.length;for(let h=a<0?-a:0;h+a<c&&h<u;h+=1)l[h+a]=i[h]}},Yct=t=>e=>{e.copyFromChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyFromChannel),e.copyToChannel=(n=>(i,r,s=0)=>{const a=t(s),o=t(r);if(a<e.length)return n.call(e,i,o,a)})(e.copyToChannel)},Xct=t=>(e,n)=>{const i=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=i),t(e,"buffer",r=>()=>{const s=r.call(e);return s===i?null:s},r=>s=>r.call(e,s===null?i:s))},Kct=(t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const r=n.createBufferSource();e(i,()=>{const o=i.numberOfInputs;for(let c=0;c<o;c+=1)r.connect(i,0,c)},()=>r.disconnect(i))},R0e=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),A0e=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},fI=(t,e,n,i)=>{let r=t;for(;!r.hasOwnProperty(e);)r=Object.getPrototypeOf(r);const{get:s,set:a}=Object.getOwnPropertyDescriptor(r,e);Object.defineProperty(t,e,{get:n(s),set:i(a)})},Jct=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),Zct=t=>({...t,channelCount:t.numberOfOutputs}),Qct=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},M0e=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(i.code!==9)throw i;M0e(t,e,n+1e-7)}},elt=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},tlt=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},nlt=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},P9=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},O0e=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},L9=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},ilt=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},rlt=t=>{t.start=(e=>(n=0,i=0,r)=>{const s=t.buffer,a=s===null?i:Math.min(s.duration,i);s!==null&&a>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,a,r)})(t.start)},N0e=(t,e)=>{const n=e.createGain();t.connect(n);const i=(r=>()=>{r.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),rR(t,n),t.stop=(r=>{let s=!1;return(a=0)=>{if(s)try{r.call(t,a)}catch{n.gain.setValueAtTime(0,a)}else r.call(t,a),s=!0}})(t.stop)},sR=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},slt=wst(QT),alt=Nst(QT),olt=Vat(_6),I0e=new WeakMap,clt=oot(I0e),pm=_at(new Map,new WeakMap),Gg=$ct(),k0e=Uot(pm,a0),U9=aot(Ju),Fl=Oct(Ju,U9,AT),llt=Lst(k0e,Ea,Fl),sa=uot(y6),by=uct(Gg),Fs=Rot(by),D0e=new WeakMap,P0e=Qat(sR),pI=Hot(Gg),B9=Tot(pI),F9=xot(Gg),L0e=wot(Gg),CO=Vot(Gg),zo=oat(Cst(l0e),Ost(slt,alt,gU,olt,vU,Ju,clt,oI,Ea,QT,Wv,AT,SP),pm,yot(dG,vU,Ju,Ea,xO,Wv),a0,b6,rh,Fat(gU,dG,Ju,Ea,xO,sa,Wv,Fs),$at(D0e,Ju,rm),P0e,sa,B9,F9,L0e,Fs,CO),ult=Pst(zo,llt,a0,k0e,sa,Fs),z9=new WeakSet,Sne=Bot(Gg),U0e=Iat(new Uint32Array(1)),H9=Wct(U0e,a0),j9=Yct(U0e),B0e=Bst(z9,pm,rh,Sne,by,Fct(Sne),H9,j9),E6=Ist(td),F0e=Nct(U9,lI,AT),o0=Cat(F0e),aR=zot(E6,pm,elt,tlt,nlt,P9,O0e,L9,rlt,Xct(fI),N0e),c0=Mct(cot(lI),F0e),hlt=Hst(o0,aR,Ea,c0,Fl),mm=cat(Rst(u0e),D0e,M9,lat,_st,bst,Est,Sst,Tst,lG,o0e,pI,M0e),dlt=zst(zo,hlt,mm,pl,aR,sa,Fs,sR),flt=Kst(zo,Jst,a0,pl,jot(td,fI),sa,Fs,Fl),plt=yat(o0,x0e,Ea,c0,Fl),ex=Dct(I0e),mlt=vat(zo,mm,plt,b6,x0e,sa,Fs,ex),tE=Pot(QT,F9),glt=Kct(pl,tE),nE=Kot(pI,glt),vlt=Sat(nE,Ea,Fl),ylt=Eat(zo,vlt,nE,sa,Fs),_lt=wat(hI,Ea,Fl),blt=xat(zo,_lt,hI,sa,Fs,Zct),Elt=Qot(E6,aR,td,tE),oR=Zot(E6,pm,Elt,P9,L9),Slt=Nat(o0,oR,Ea,c0,Fl),Tlt=Oat(zo,mm,Slt,oR,sa,Fs,sR),z0e=ect(rh,fI),xlt=Pat(z0e,Ea,Fl),wlt=Dat(zo,xlt,z0e,sa,Fs,ex),Clt=jat(o0,w0e,Ea,c0,Fl),Rlt=Hat(zo,mm,Clt,w0e,sa,Fs,ex),H0e=tct(rh),Alt=Kat(o0,H0e,Ea,c0,Fl),Mlt=Xat(zo,mm,Alt,H0e,rh,sa,Fs,ex),Olt=rot(o0,td,Ea,c0,Fl),Nlt=iot(zo,mm,Olt,td,sa,Fs),Ilt=sct(b6,pl,dI,rh),S6=Ict(pm,td,dI,Hct(td,by)),klt=vot(aR,Ea,by,Fl,S6),Dlt=nct(Ilt),Plt=mot(zo,Dlt,klt,sa,Fs,ex),Llt=Zst(mm,nE,oR,dI,rh,R0e,Fs,fI),j0e=new WeakMap,Ult=Dot(flt,Llt,P0e,Fs,j0e,sR),V0e=hct(E6,pm,P9,O0e,L9,N0e),Blt=Tct(o0,V0e,Ea,c0,Fl),Flt=Sct(zo,mm,V0e,Blt,sa,Fs,sR),G0e=Aat(aR),zlt=yct(G0e,pl,td,A0e,tE),T6=vct(G0e,pl,zlt,A0e,tE,pI,fI),Hlt=fct(gU,pl,nE,td,dI,T6,rh,vU,R0e,tE),q0e=dct(Hlt),jlt=Cct(o0,nE,oR,td,q0e,Ea,by,c0,Fl,S6),Vlt=wct(zo,mm,q0e,jlt,sa,Fs,ex),Glt=pct(a0),qlt=Act(Glt,sa,new WeakSet,Qct),$lt=gct(nE,hI,td,T6,rh,tE),$0e=mct($lt,rh),Wlt=Bct(o0,$0e,Ea,c0,Fl),Ylt=Uct(zo,mm,$0e,Wlt,sa,Fs),Xlt=qct(T6,Ea,Fl),Klt=Gct(zo,pl,T6,Xlt,sa,Fs,ex),W0e=Aot(Gg),V9=eot(Gg),Y0e=new WeakMap,Jlt=hot(Y0e,by),Zlt=W0e?Mst(pm,rh,Zat(Gg),V9,tot(xst),sa,Jlt,Fs,CO,new WeakMap,new WeakMap,zct(CO,by),Gg):void 0,Qlt=Cot(B9,Fs),eut=Bat(z9,pm,Uat,Jat,new WeakSet,sa,Qlt,pU,wO,H9,j9),X0e=mat(Zlt,ult,B0e,dlt,mlt,ylt,blt,Tlt,wlt,eut,Rlt,Mlt,Nlt,Plt,Ult,Flt,Vlt,qlt,Ylt,Klt),tut=Mot(zo,act,sa,Fs),nut=Not(zo,oct,sa,Fs),iut=Iot(zo,cct,sa,Fs),rut=lct(pl,Fs),sut=kot(zo,rut,sa),aut=Xst(X0e,pl,rh,jct,tut,nut,iut,sut,pI),G9=dot(j0e),out=kst(G9),K0e=Rat(a0),cut=Gat(G9),J0e=Wat(a0),Z0e=new WeakMap,lut=sot(Z0e,rm),uut=Xot(K0e,a0,pl,nE,hI,oR,td,dI,rh,J0e,V9,lut,tE),hut=qot(pl,uut,td,rh,tE),dut=pat(o0,K0e,aR,nE,hI,oR,td,cut,J0e,V9,Ea,CO,by,c0,Fl,S6),fut=lot(Y0e),put=kct(Z0e),Tne=W0e?hat(out,zo,mm,dut,hut,Ju,fut,sa,Fs,CO,Jct,put,ilt,sR):void 0,mut=Lat(rh,by),gut=Pct(z9,pm,U9,G9,S6,pU,H9,j9),vut=bct(X0e,pm,pl,mut,gut),yut=_ot(y6,B9),_ut=bot(A9,F9),but=Eot(M9,L0e),Eut=Sot(y6,Fs);function $d(t){return t===void 0}function gr(t){return t!==void 0}function Sut(t){return typeof t=="function"}function sm(t){return typeof t=="number"}function pb(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object}function Q0e(t){return typeof t=="boolean"}function qh(t){return Array.isArray(t)}function cy(t){return typeof t=="string"}function xD(t){return cy(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function Ci(t,e){if(!t)throw new Error(e)}function qf(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function eve(t){!t.isOffline&&t.state!=="running"&&x6('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let tve=!1,xne=!1;function wne(t){tve=t}function Tut(t){$d(t)&&tve&&!xne&&(xne=!0,x6("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let nve=console;function xut(...t){nve.log(...t)}function x6(...t){nve.warn(...t)}function wut(t){return new aut(t)}function Cut(t,e,n){return new vut(t,e,n)}const Ld=typeof self=="object"?self:null,Rut=Ld&&(Ld.hasOwnProperty("AudioContext")||Ld.hasOwnProperty("webkitAudioContext"));function Aut(t,e,n){return Ci(gr(Tne),"AudioWorkletNode only works in a secure context (https or localhost)"),new(t instanceof(Ld==null?void 0:Ld.BaseAudioContext)?Ld==null?void 0:Ld.AudioWorkletNode:Tne)(t,e,n)}var vG=function(t,e){return vG=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},vG(t,e)};function ive(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");vG(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function aa(t,e,n,i){var r=arguments.length,s=r<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,n):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,n,i);else for(var o=t.length-1;o>=0;o--)(a=t[o])&&(s=(r<3?a(s):r>3?a(e,n,s):a(e,n))||s);return r>3&&s&&Object.defineProperty(e,n,s),s}function Ja(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(u){try{l(i.next(u))}catch(h){a(h)}}function c(u){try{l(i.throw(u))}catch(h){a(h)}}function l(u){u.done?s(u.value):r(u.value).then(o,c)}l((i=i.apply(t,e||[])).next())})}function q9(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(l){return function(u){return c([l,u])}}function c(l){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,l[0]&&(n=0)),n;)try{if(i=1,r&&(s=l[0]&2?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,r=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){n.label=l[1];break}if(l[0]===6&&n.label<s[1]){n.label=s[1],s=l;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(l);break}s[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],r=0}finally{i=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function w6(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function yG(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}class Mut{constructor(e,n,i,r){this._callback=e,this._type=n,this._minimumUpdateInterval=Math.max(128/(r||44100),.001),this.updateInterval=i,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(e),i=new Worker(n);i.onmessage=this._callback.bind(this),this._worker=i}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var n;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((n=this._worker)===null||n===void 0||n.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function MT(t){return but(t)}function mb(t){return _ut(t)}function TP(t){return Eut(t)}function w1(t){return yut(t)}function Out(t){return t instanceof B0e}function Nut(t,e){return t==="value"||MT(e)||mb(e)||Out(e)}function KS(t,...e){if(!e.length)return t;const n=e.shift();if(pb(t)&&pb(n))for(const i in n)Nut(i,n[i])?t[i]=n[i]:pb(n[i])?(t[i]||Object.assign(t,{[i]:{}}),KS(t[i],n[i])):Object.assign(t,{[i]:n[i]});return KS(t,...e)}function Iut(t,e){return t.length===e.length&&t.every((n,i)=>e[i]===n)}function Pn(t,e,n=[],i){const r={},s=Array.from(e);if(pb(s[0])&&i&&!Reflect.has(s[0],i)&&(Object.keys(s[0]).some(o=>Reflect.has(t,o))||(KS(r,{[i]:s[0]}),n.splice(n.indexOf(i),1),s.shift())),s.length===1&&pb(s[0]))KS(r,s[0]);else for(let a=0;a<n.length;a++)gr(s[a])&&(r[n[a]]=s[a]);return KS(t,r)}function kut(t){return t.constructor.getDefaults()}function Ig(t,e){return $d(t)?e:t}function RO(t,e){return e.forEach(n=>{Reflect.has(t,n)&&delete t[n]}),t}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Ey{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Ld&&this.toString()===Ld.TONE_DEBUG_CLASS)&&xut(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ey.version=a0e;const $9=1e-6;function xC(t,e){return t>e+$9}function _G(t,e){return xC(t,e)||qp(t,e)}function EU(t,e){return t+$9<e}function qp(t,e){return Math.abs(t-e)<$9}function Dut(t,e,n){return Math.max(Math.min(t,n),e)}class Jf extends Ey{constructor(){super(),this.name="Timeline",this._timeline=[];const e=Pn(Jf.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(Ci(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];Ci(_G(e.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(e){const n=this._timeline.indexOf(e);return n!==-1&&this._timeline.splice(n,1),this}get(e,n="time"){const i=this._search(e,n);return i!==-1?this._timeline[i]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,n="time"){const i=this._search(e,n);return i+1<this._timeline.length?this._timeline[i+1]:null}getBefore(e){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<e)return this._timeline[n-1];const i=this._search(e);return i-1>=0?this._timeline[i-1]:null}cancel(e){if(this._timeline.length>1){let n=this._search(e);if(n>=0)if(qp(this._timeline[n].time,e)){for(let i=n;i>=0&&qp(this._timeline[i].time,e);i--)n=i;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&_G(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const n=this._search(e);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(e){const n=this._timeline.indexOf(e);return n>0?this._timeline[n-1]:null}_search(e,n="time"){if(this._timeline.length===0)return-1;let i=0;const r=this._timeline.length;let s=r;if(r>0&&this._timeline[r-1][n]<=e)return r-1;for(;i<s;){let a=Math.floor(i+(s-i)/2);const o=this._timeline[a],c=this._timeline[a+1];if(qp(o[n],e)){for(let l=a;l<this._timeline.length;l++){const u=this._timeline[l];if(qp(u[n],e))a=l;else break}return a}else{if(EU(o[n],e)&&xC(c[n],e))return a;xC(o[n],e)?s=a:i=a+1}}return-1}_iterate(e,n=0,i=this._timeline.length-1){this._timeline.slice(n,i+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,n){const i=this._search(e);return i!==-1&&this._iterate(n,0,i),this}forEachAfter(e,n){const i=this._search(e);return this._iterate(n,i+1),this}forEachBetween(e,n,i){let r=this._search(e),s=this._search(n);return r!==-1&&s!==-1?(this._timeline[r].time!==e&&(r+=1),this._timeline[s].time===n&&(s-=1),this._iterate(i,r,s)):r===-1&&this._iterate(i,0,s),this}forEachFrom(e,n){let i=this._search(e);for(;i>=0&&this._timeline[i].time>=e;)i--;return this._iterate(n,i+1),this}forEachAtTime(e,n){const i=this._search(e);if(i!==-1&&qp(this._timeline[i].time,e)){let r=i;for(let s=i;s>=0&&qp(this._timeline[s].time,e);s--)r=s;this._iterate(s=>{n(s)},r,i)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const rve=[];function C6(t){rve.push(t)}function Put(t){rve.forEach(e=>e(t))}const sve=[];function R6(t){sve.push(t)}function Lut(t){sve.forEach(e=>e(t))}class mI extends Ey{constructor(){super(...arguments),this.name="Emitter"}on(e,n){return e.split(/\W+/).forEach(r=>{$d(this._events)&&(this._events={}),this._events.hasOwnProperty(r)||(this._events[r]=[]),this._events[r].push(n)}),this}once(e,n){const i=(...r)=>{n(...r),this.off(e,i)};return this.on(e,i),this}off(e,n){return e.split(/\W+/).forEach(r=>{if($d(this._events)&&(this._events={}),this._events.hasOwnProperty(r))if($d(n))this._events[r]=[];else{const s=this._events[r];for(let a=s.length-1;a>=0;a--)s[a]===n&&s.splice(a,1)}}),this}emit(e,...n){if(this._events&&this._events.hasOwnProperty(e)){const i=this._events[e].slice(0);for(let r=0,s=i.length;r<s;r++)i[r].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(n=>{const i=Object.getOwnPropertyDescriptor(mI.prototype,n);Object.defineProperty(e.prototype,n,i)})}dispose(){return super.dispose(),this._events=void 0,this}}class ave extends mI{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class cR extends ave{constructor(){var e,n;super(),this.name="Context",this._constants=new Map,this._timeouts=new Jf,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const i=Pn(cR.getDefaults(),arguments,["context"]);i.context?(this._context=i.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=wut({latencyHint:i.latencyHint}),this._latencyHint=i.latencyHint),this._ticker=new Mut(this.emit.bind(this,"tick"),i.clockSource,i.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((n=arguments[0])===null||n===void 0)&&n.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=i.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(Put(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,n,i){return this._context.createBuffer(e,n,i)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,n){return this._context.createIIRFilter(e,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,n,i){return this._context.createPeriodicWave(e,n,i)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return Ci(w1(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return Ci(w1(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return Ci(w1(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){Ci(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){Ci(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){Ci(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){Ci(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,n){return Aut(this.rawContext,e,n)}addAudioWorkletModule(e){return Ja(this,void 0,void 0,function*(){Ci(gr(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return Ja(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return w1(this._context)?this._context.resume():Promise.resolve()}close(){return Ja(this,void 0,void 0,function*(){w1(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&Lut(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const n=this._context.createBuffer(1,128,this._context.sampleRate),i=n.getChannelData(0);for(let s=0;s<i.length;s++)i[s]=e;const r=this._context.createBufferSource();return r.channelCount=1,r.channelCountMode="explicit",r.buffer=n,r.loop=!0,r.start(0),this._constants.set(e,r),r}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,n=>{n.callback(),this._timeouts.remove(n)})}setTimeout(e,n){this._timeoutIds++;const i=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:i+n}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(n=>{n.id===e&&this._timeouts.remove(n)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,n){const i=++this._timeoutIds,r=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),r()},id:i,time:s+n})};return r(),i}}class Uut extends ave{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,n,i){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,n){return{}}createPanner(){return{}}createPeriodicWave(e,n,i){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,n){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return Ja(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,n){return 0}clearTimeout(e){return this}setInterval(e,n){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Rr(t,e){qh(e)?e.forEach(n=>Rr(t,n)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function gI(t,e){qh(e)?e.forEach(n=>gI(t,n)):Object.defineProperty(t,e,{writable:!0})}const Es=()=>{};class Ps extends Ey{constructor(){super(),this.name="ToneAudioBuffer",this.onload=Es;const e=Pn(Ps.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,cy(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:Es,onload:Es,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:cc().sampleRate}set(e){return e instanceof Ps?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Ja(this,void 0,void 0,function*(){const n=Ps.load(e).then(i=>{this.set(i),this.onload(this)});Ps.downloads.push(n);try{yield n}finally{const i=Ps.downloads.indexOf(n);Ps.downloads.splice(i,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const n=qh(e)&&e[0].length>0,i=n?e.length:1,r=n?e[0].length:e.length,s=cc(),a=s.createBuffer(i,r,s.sampleRate),o=!n&&i===1?[e]:e;for(let c=0;c<i;c++)a.copyToChannel(o[c],c);return this._buffer=a,this}toMono(e){if(sm(e))this.fromArray(this.toArray(e));else{let n=new Float32Array(this.length);const i=this.numberOfChannels;for(let r=0;r<i;r++){const s=this.toArray(r);for(let a=0;a<s.length;a++)n[a]+=s[a]}n=n.map(r=>r/i),this.fromArray(n)}return this}toArray(e){if(sm(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let i=0;i<this.numberOfChannels;i++)n[i]=this.getChannelData(i);return n}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,n=this.duration){Ci(this.loaded,"Buffer is not loaded");const i=Math.floor(e*this.sampleRate),r=Math.floor(n*this.sampleRate);Ci(i<r,"The start time must be less than the end time");const s=r-i,a=cc().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(i,r),o);return new Ps(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Ps().fromArray(e)}static fromUrl(e){return Ja(this,void 0,void 0,function*(){return yield new Ps().load(e)})}static load(e){return Ja(this,void 0,void 0,function*(){const n=Ps.baseUrl===""||Ps.baseUrl.endsWith("/")?Ps.baseUrl:Ps.baseUrl+"/",i=yield fetch(n+e);if(!i.ok)throw new Error(`could not load url: ${e}`);const r=yield i.arrayBuffer();return yield cc().decodeAudioData(r)})}static supportsType(e){const n=e.split("."),i=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+i)!==""}static loaded(){return Ja(this,void 0,void 0,function*(){for(yield Promise.resolve();Ps.downloads.length;)yield Ps.downloads[0]})}}Ps.baseUrl="";Ps.downloads=[];class A6 extends cR{constructor(){super({clockSource:"offline",context:TP(arguments[0])?arguments[0]:Cut(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:TP(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=TP(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Ja(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const i=Math.floor(this.sampleRate/128);e&&n%i===0&&(yield new Promise(r=>setTimeout(r,1)))}})}render(){return Ja(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const n=yield this._context.startRendering();return new Ps(n)})}close(){return Promise.resolve()}}const ove=new Uut;let PS=ove;function cc(){return PS===ove&&Rut&&cve(new cR),PS}function cve(t,e=!1){e&&PS.dispose(),w1(t)?PS=new cR(t):TP(t)?PS=new A6(t):PS=t}function But(){return PS.resume()}if(Ld&&!Ld.TONE_SILENCE_LOGGING){const e=` * Tone.js v${a0e} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function Fut(t){return Math.pow(10,t/20)}function zut(t){return 20*(Math.log(t)/Math.LN10)}function lve(t){return Math.pow(2,t/12)}let M6=440;function Hut(){return M6}function jut(t){M6=t}function LS(t){return Math.round(uve(t))}function uve(t){return 69+12*Math.log2(t/M6)}function hve(t){return M6*Math.pow(2,(t-69)/12)}class W9 extends Ey{constructor(e,n,i){super(),this.defaultUnits="s",this._val=n,this._units=i,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,n)=>{const i=parseInt(e,10),r=n==="."?1.5:1;return i===1?this._beatsToUnits(this._getTimeSignature())*r:this._beatsToUnits(4/i)*r},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const n=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,n,i)=>{let r=0;return e&&e!=="0"&&(r+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r+=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r+=this._beatsToUnits(parseFloat(i)/4)),r},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof W9&&this.fromType(this._val),$d(this._val))return this._noArg();if(cy(this._val)&&$d(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(pb(this._val)){let e=0;for(const n in this._val)if(gr(this._val[n])){const i=this._val[n],r=new this.constructor(this.context,n).valueOf()*i;e+=r}return e}if(gr(this._units)){const e=this._expressions[this._units],n=this._val.toString().trim().match(e.regexp);return n?e.method.apply(this,n.slice(1)):e.method.call(this,this._val)}else return cy(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class $f extends W9{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const n=new $f(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(e,n=1){const i=new this.constructor(this.context,e).valueOf(),r=this.valueOf(),o=Math.round(r/i)*i-r;return r+o*n}toNotation(){const e=this.toSeconds(),n=["1m"];for(let s=1;s<9;s++){const a=Math.pow(2,s);n.push(a+"n."),n.push(a+"n"),n.push(a+"t")}n.push("0");let i=n[0],r=new $f(this.context,n[0]).toSeconds();return n.forEach(s=>{const a=new $f(this.context,s).toSeconds();Math.abs(a-e)<Math.abs(r-e)&&(i=s,r=a)}),i}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let n=this.valueOf()/e;n=parseFloat(n.toFixed(4));const i=Math.floor(n/this._getTimeSignature());let r=n%1*4;n=Math.floor(n)%this._getTimeSignature();const s=r.toString();return s.length>3&&(r=parseFloat(parseFloat(s).toFixed(3))),[i,n,r].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return LS(this.toFrequency())}_now(){return this.context.now()}}function Cc(t,e){return new $f(cc(),t,e)}class Hh extends $f{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Hut()}static set A4(e){jut(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Hh.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,n){const r=Vut[e.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?r:Hh.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,n,i){let r=1;return e&&e!=="0"&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(r*=this._beatsToUnits(parseFloat(n))),i&&i!=="0"&&(r*=this._beatsToUnits(parseFloat(i)/4)),r}}})}transpose(e){return new Hh(this.context,this.valueOf()*lve(e))}harmonize(e){return e.map(n=>this.transpose(n))}toMidi(){return LS(this.valueOf())}toNote(){const e=this.toFrequency(),n=Math.log2(e/Hh.A4);let i=Math.round(12*n)+57;const r=Math.floor(i/12);return r<0&&(i+=-12*r),Gut[i%12]+r.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return hve(e)}static ftom(e){return LS(e)}}const Vut={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},Gut=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Cne(t,e){return new Hh(cc(),t,e)}class xw extends $f{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class uu extends Ey{constructor(){super();const e=Pn(uu.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:cc()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return Tut(e),new $f(this.context,e).toSeconds()}toFrequency(e){return new Hh(this.context,e).toFrequency()}toTicks(e){return new xw(this.context,e).toTicks()}_getPartialProperties(e){const n=this.get();return Object.keys(n).forEach(i=>{$d(e[i])&&delete n[i]}),n}get(){const e=kut(this);return Object.keys(e).forEach(n=>{if(Reflect.has(this,n)){const i=this[n];gr(i)&&gr(i.value)&&gr(i.setValueAtTime)?e[n]=i.value:i instanceof uu?e[n]=i._getPartialProperties(e[n]):qh(i)||sm(i)||cy(i)||Q0e(i)?e[n]=i:delete e[n]}}),e}set(e){return Object.keys(e).forEach(n=>{Reflect.has(this,n)&&gr(this[n])&&(this[n]&&gr(this[n].value)&&gr(this[n].setValueAtTime)?this[n].value!==e[n]&&(this[n].value=e[n]):this[n]instanceof uu?this[n].set(e[n]):this[n]=e[n])}),this}}class vI extends Jf{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const n=this.get(e);return n!==null?n.state:this._initial}setStateAtTime(e,n,i){return qf(n,0),this.add(Object.assign({},i,{state:e,time:n})),this}getLastState(e,n){const i=this._search(n);for(let r=i;r>=0;r--){const s=this._timeline[r];if(s.state===e)return s}}getNextState(e,n){const i=this._search(n);if(i!==-1)for(let r=i;r<this._timeline.length;r++){const s=this._timeline[r];if(s.state===e)return s}}}class pr extends uu{constructor(){const e=Pn(pr.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,Ci(gr(e.param)&&(MT(e.param)||e.param instanceof pr),"param must be an AudioParam");!MT(e.param);)e.param=e.param._param;this._swappable=gr(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Jf(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,gr(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(uu.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return gr(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return gr(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,n){return this.units===n}_assertRange(e){return gr(this.maxValue)&&gr(this.minValue)&&qf(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?Fut(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?zut(e):e}setValueAtTime(e,n){const i=this.toSeconds(n),r=this._fromType(e);return Ci(isFinite(r)&&isFinite(i),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(r),this.log(this.units,"setValueAtTime",e,i),this._events.add({time:i,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,i),this}getValueAtTime(e){const n=Math.max(this.toSeconds(e),0),i=this._events.getAfter(n),r=this._events.get(n);let s=this._initialValue;if(r===null)s=this._initialValue;else if(r.type==="setTargetAtTime"&&(i===null||i.type==="setValueAtTime")){const a=this._events.getBefore(r.time);let o;a===null?o=this._initialValue:o=a.value,r.type==="setTargetAtTime"&&(s=this._exponentialApproach(r.time,o,r.value,r.constant,n))}else if(i===null)s=r.value;else if(i.type==="linearRampToValueAtTime"||i.type==="exponentialRampToValueAtTime"){let a=r.value;if(r.type==="setTargetAtTime"){const o=this._events.getBefore(r.time);o===null?a=this._initialValue:a=o.value}i.type==="linearRampToValueAtTime"?s=this._linearInterpolate(r.time,a,i.time,i.value,n):s=this._exponentialInterpolate(r.time,a,i.time,i.value,n)}else s=r.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let n=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,e),this}linearRampToValueAtTime(e,n){const i=this._fromType(e),r=this.toSeconds(n);return Ci(isFinite(i)&&isFinite(r),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(i),this._events.add({time:r,type:"linearRampToValueAtTime",value:i}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(i,r),this}exponentialRampToValueAtTime(e,n){let i=this._fromType(e);i=qp(i,0)?this._minOutput:i,this._assertRange(i);const r=this.toSeconds(n);return Ci(isFinite(i)&&isFinite(r),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:i}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(i,r),this}exponentialRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialRampToValueAtTime(e,i+this.toSeconds(n)),this}linearRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.linearRampToValueAtTime(e,i+this.toSeconds(n)),this}targetRampTo(e,n,i){return i=this.toSeconds(i),this.setRampPoint(i),this.exponentialApproachValueAtTime(e,i,n),this}exponentialApproachValueAtTime(e,n,i){n=this.toSeconds(n),i=this.toSeconds(i);const r=Math.log(i+1)/Math.log(200);return this.setTargetAtTime(e,n,r),this.cancelAndHoldAtTime(n+i*.9),this.linearRampToValueAtTime(e,n+i),this}setTargetAtTime(e,n,i){const r=this._fromType(e);Ci(isFinite(i)&&i>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(n);return this._assertRange(r),Ci(isFinite(r)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({constant:i,time:s,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,s,i),this._param.setTargetAtTime(r,s,i),this}setValueCurveAtTime(e,n,i,r=1){i=this.toSeconds(i),n=this.toSeconds(n);const s=this._fromType(e[0])*r;this.setValueAtTime(this._toType(s),n);const a=i/(e.length-1);for(let o=1;o<e.length;o++){const c=this._fromType(e[o])*r;this.linearRampToValueAtTime(this._toType(c),n+o*a)}return this}cancelScheduledValues(e){const n=this.toSeconds(e);return Ci(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(e){const n=this.toSeconds(e),i=this._fromType(this.getValueAtTime(n));Ci(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+i);const r=this._events.get(n),s=this._events.getAfter(n);return r&&qp(r.time,n)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(i),n):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(i),n)),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}rampTo(e,n=.1,i){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,n,i):this.linearRampTo(e,n,i),this}apply(e){const n=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(n),n);const i=this._events.get(n);if(i&&i.type==="setTargetAtTime"){const r=this._events.getAfter(i.time),s=r?r.time:n+2,a=(s-n)/10;for(let o=n;o<s;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,r=>{r.type==="cancelScheduledValues"?e.cancelScheduledValues(r.time):r.type==="setTargetAtTime"?e.setTargetAtTime(r.value,r.time,r.constant):e[r.type](r.value,r.time)}),this}setParam(e){Ci(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(e),this._param=e,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,n,i,r,s){return i+(n-i)*Math.exp(-(s-e)/r)}_linearInterpolate(e,n,i,r,s){return n+(r-n)*((s-e)/(i-e))}_exponentialInterpolate(e,n,i,r,s){return n*Math.pow(r/n,(s-e)/(i-e))}}class Gn extends uu{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return gr(this.input)?MT(this.input)||this.input instanceof pr?1:this.input.numberOfInputs:0}get numberOfOutputs(){return gr(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return gr(e)&&(e instanceof Gn||mb(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(i=>{i.channelCount=e.channelCount,i.channelCountMode=e.channelCountMode,i.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();Ci(e.length>0,"ToneAudioNode does not have any internal nodes");const n=e[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:e}))}connect(e,n=0,i=0){return sp(this,e,n,i),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return x6("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,n=0,i=0){return dve(this,e,n,i),this}chain(...e){return OT(this,...e),this}fan(...e){return e.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),gr(this.input)&&(this.input instanceof Gn?this.input.dispose():mb(this.input)&&this.input.disconnect()),gr(this.output)&&(this.output instanceof Gn?this.output.dispose():mb(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function OT(...t){const e=t.shift();t.reduce((n,i)=>(n instanceof Gn?n.connect(i):mb(n)&&sp(n,i),i),e)}function sp(t,e,n=0,i=0){for(Ci(gr(t),"Cannot connect from undefined node"),Ci(gr(e),"Cannot connect to undefined node"),(e instanceof Gn||mb(e))&&Ci(e.numberOfInputs>0,"Cannot connect to node with no inputs"),Ci(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Gn||e instanceof pr;)gr(e.input)&&(e=e.input);for(;t instanceof Gn;)gr(t.output)&&(t=t.output);MT(e)?t.connect(e,n):t.connect(e,n,i)}function dve(t,e,n=0,i=0){if(gr(e))for(;e instanceof Gn;)e=e.input;for(;!mb(t);)gr(t.output)&&(t=t.output);MT(e)?t.disconnect(e,n):mb(e)?t.disconnect(e,n,i):t.disconnect()}class yr extends Gn{constructor(){const e=Pn(yr.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new pr({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Rr(this,"gain")}static getDefaults(){return Object.assign(Gn.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class wC extends Gn{constructor(e){super(e),this.onended=Es,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new yr({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const i=this.toSeconds(n);return this._startTime!==-1&&i>=this._startTime&&(this._stopTime===-1||i<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(Gn.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Es})}_startGain(e,n=1){Ci(this._startTime===-1,"Source cannot be started more than once");const i=this.toSeconds(this._fadeIn);return this._startTime=e+i,this._startTime=Math.max(this._startTime,this.context.currentTime),i>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,e+i):this._gainNode.gain.exponentialApproachValueAtTime(n,e,i)):this._gainNode.gain.setValueAtTime(n,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){Ci(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.now()),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const i=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+i),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==Es&&(this.onended(this),this.onended=Es,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),Ci(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=Es,this}}class Y9 extends wC{constructor(){const e=Pn(Y9.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),sp(this._source,this._gainNode),this.offset=new pr({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(wC.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class os extends Gn{constructor(){const e=Pn(os.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new Y9({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Gn.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,n=0,i=0){return O6(this,e,n,i),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,n){return this._param.setValueAtTime(e,n),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,n){return this._param.linearRampToValueAtTime(e,n),this}exponentialRampToValueAtTime(e,n){return this._param.exponentialRampToValueAtTime(e,n),this}exponentialRampTo(e,n,i){return this._param.exponentialRampTo(e,n,i),this}linearRampTo(e,n,i){return this._param.linearRampTo(e,n,i),this}targetRampTo(e,n,i){return this._param.targetRampTo(e,n,i),this}exponentialApproachValueAtTime(e,n,i){return this._param.exponentialApproachValueAtTime(e,n,i),this}setTargetAtTime(e,n,i){return this._param.setTargetAtTime(e,n,i),this}setValueCurveAtTime(e,n,i,r){return this._param.setValueCurveAtTime(e,n,i,r),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,n,i){return this._param.rampTo(e,n,i),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function O6(t,e,n,i){(e instanceof pr||MT(e)||e instanceof os&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof os&&(e.overridden=!0)),sp(t,e,n,i)}class X9 extends pr{constructor(){const e=Pn(X9.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Jf(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(pr.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,n,i){n=this.toSeconds(n),this.setRampPoint(n);const r=this._fromType(e),s=this._events.get(n),a=Math.round(Math.max(1/i,1));for(let o=0;o<=a;o++){const c=i*o+n,l=this._exponentialApproach(s.time,s.value,r,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}setValueAtTime(e,n){const i=this.toSeconds(n);super.setValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,n){const i=this.toSeconds(n);super.linearRampToValueAtTime(e,n);const r=this._events.get(i),s=this._events.previousEvent(r),a=this._getTicksUntilEvent(s,i);return r.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,n){n=this.toSeconds(n);const i=this._fromType(e),r=this._events.get(n),s=Math.round(Math.max((n-r.time)*10,1)),a=(n-r.time)/s;for(let o=0;o<=s;o++){const c=a*o+r.time,l=this._exponentialInterpolate(r.time,r.value,n,i,c);this.linearRampToValueAtTime(this._toType(l),c)}return this}_getTicksUntilEvent(e,n){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if($d(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const i=this._fromType(this.getValueAtTime(e.time));let r=this._fromType(this.getValueAtTime(n));const s=this._events.get(n);return s&&s.time===n&&s.type==="setValueAtTime"&&(r=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-e.time)*(i+r)+e.ticks}getTicksAtTime(e){const n=this.toSeconds(e),i=this._events.get(n);return Math.max(this._getTicksUntilEvent(i,n),0)}getDurationOfTicks(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(n);return this.getTimeOfTick(r+e)-i}getTimeOfTick(e){const n=this._events.get(e,"ticks"),i=this._events.getAfter(e,"ticks");if(n&&n.ticks===e)return n.time;if(n&&i&&i.type==="linearRampToValueAtTime"&&n.value!==i.value){const r=this._fromType(this.getValueAtTime(n.time)),a=(this._fromType(this.getValueAtTime(i.time))-r)/(i.time-n.time),o=Math.sqrt(Math.pow(r,2)-2*a*(n.ticks-e)),c=(-r+o)/a,l=(-r-o)/a;return(c>0?c:l)+n.time}else return n?n.value===0?1/0:n.time+(e-n.ticks)/n.value:e/this._initialValue}ticksToTime(e,n){return this.getDurationOfTicks(e,n)}timeToTicks(e,n){const i=this.toSeconds(n),r=this.toSeconds(e),s=this.getTicksAtTime(i);return this.getTicksAtTime(i+r)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const n=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class K9 extends os{constructor(){const e=Pn(K9.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new X9({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(os.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,n){return this._param.ticksToTime(e,n)}timeToTicks(e,n){return this._param.timeToTicks(e,n)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,n){return this._param.getDurationOfTicks(e,n)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class J9 extends uu{constructor(){const e=Pn(J9.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new vI,this._tickOffset=new Jf,this._ticksAtTime=new Jf,this._secondsAtTime=new Jf,this.frequency=new K9({context:this.context,units:e.units,value:e.frequency}),Rr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},uu.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,n){const i=this.toSeconds(e);return this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),gr(n)&&this.setTicksAtTime(n,i),this._ticksAtTime.cancel(i),this._secondsAtTime.cancel(i)),this}stop(e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="stopped"){const i=this._state.get(n);i&&i.time>0&&(this._tickOffset.cancel(i.time),this._state.cancel(i.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const n=this.toSeconds(e),i=this._state.getLastState("stopped",n),r=this._ticksAtTime.get(n),s={state:"paused",time:n};this._state.add(s);let a=r||i,o=r?r.ticks:0,c=null;return this._state.forEachBetween(a.time,n+this.sampleTime,l=>{let u=a.time;const h=this._tickOffset.get(l.time);h&&h.time>=a.time&&(o=h.ticks,u=h.time),a.state==="started"&&l.state!=="started"&&(o+=this.frequency.getTicksAtTime(l.time)-this.frequency.getTicksAtTime(u),l.time!==s.time&&(c={state:l.state,time:l.time,ticks:o})),a=l}),this._state.remove(s),c&&this._ticksAtTime.add(c),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const n=this.now(),i=this.frequency.timeToTicks(e,n);this.setTicksAtTime(i,n)}getSecondsAtTime(e){e=this.toSeconds(e);const n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);const r=this._secondsAtTime.get(e);let s=r||n,a=r?r.seconds:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,c=>{let l=s.time;const u=this._tickOffset.get(c.time);u&&u.time>=s.time&&(a=u.seconds,l=u.time),s.state==="started"&&c.state!=="started"&&(a+=c.time-l,c.time!==i.time&&(o={state:c.state,time:c.time,seconds:a})),s=c}),this._state.remove(i),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,n),ticks:e,time:n}),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,n=this.now()){const i=this._tickOffset.get(n),r=this._state.get(n),s=Math.max(i.time,r.time),a=this.frequency.getTicksAtTime(s)+e-i.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,n,i){let r=this._state.get(e);this._state.forEachBetween(e,n,a=>{r&&r.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(r.time,e),a.time-this.sampleTime,i),r=a});let s=null;if(r&&r.state==="started"){const a=Math.max(r.time,e),o=this.frequency.getTicksAtTime(a),c=this.frequency.getTicksAtTime(r.time),l=o-c;let u=Math.ceil(l)-l;u=qp(u,1)?0:u;let h=this.frequency.getTimeOfTick(o+u);for(;h<n;){try{i(h,Math.round(this.getTicksAtTime(h)))}catch(d){s=d;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class N6 extends uu{constructor(){const e=Pn(N6.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=Es,this._lastUpdate=0,this._state=new vI("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new J9({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Rr(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(uu.getDefaults(),{callback:Es,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,n){eve(this.context);const i=this.toSeconds(e);return this.log("start",i),this._state.getValueAtTime(i)!=="started"&&(this._state.setStateAtTime("started",i),this._tickSource.start(i,n),i<this._lastUpdate&&this.emit("start",i,n)),this}stop(e){const n=this.toSeconds(e);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,n){return this._tickSource.setTicksAtTime(e,n),this}getTimeOfTick(e,n=this.now()){return this._tickSource.getTimeOfTick(e,n)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,n){const i=this.toSeconds(n),r=this.getTicksAtTime(i);return this._tickSource.getTimeOfTick(r+e,i)}_loop(){const e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,i=>{switch(i.state){case"started":const r=this._tickSource.getTicksAtTime(i.time);this.emit("start",i.time,r);break;case"stopped":i.time!==0&&this.emit("stop",i.time);break;case"paused":this.emit("pause",i.time);break}}),this._tickSource.forEachTickBetween(e,n,(i,r)=>{this.callback(i,r)}))}getStateAtTime(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}mI.mixin(N6);class CC extends Gn{constructor(){const e=Pn(CC.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const n=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(n,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(n),this.delayTime=new pr({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),Rr(this,"delayTime")}static getDefaults(){return Object.assign(Gn.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class _g extends Gn{constructor(){const e=Pn(_g.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new yr({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Rr(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Z9 extends Gn{constructor(){const e=Pn(Z9.getDefaults(),arguments);super(e),this.name="Destination",this.input=new _g({context:this.context}),this.output=new yr({context:this.context}),this.volume=this.input.volume,OT(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),OT(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}C6(t=>{t.destination=new Z9({context:t})});R6(t=>{t.destination.dispose()});class qut extends Gn{constructor(){super(...arguments),this.name="Listener",this.positionX=new pr({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new pr({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new pr({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new pr({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new pr({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new pr({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new pr({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new pr({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new pr({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Gn.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}C6(t=>{t.listener=new qut({context:t})});R6(t=>{t.listener.dispose()});class Q9 extends Ey{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=Pn(Q9.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(n=>{this._loadingCount++;const i=e.urls[n];this.add(n,i,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:Es,onload:Es,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return Ci(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,n])=>n.loaded)}add(e,n,i=Es,r=Es){return cy(n)?(this.baseUrl&&n.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Ps(this.baseUrl+n,i,r))):this._buffers.set(e.toString(),new Ps(n,i,r)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class SU extends Hh{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return LS(super._frequencyToUnits(e))}_ticksToUnits(e){return LS(super._ticksToUnits(e))}_beatsToUnits(e){return LS(super._beatsToUnits(e))}_secondsToUnits(e){return LS(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return hve(this.toMidi())}transpose(e){return new SU(this.context,this.toMidi()+e)}}class Nc extends xw{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class $ut extends uu{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Jf,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,n){return this._events.add({callback:e,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,n=>{e-n.time<=this.expiration&&n.callback(),this._events.remove(n)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}C6(t=>{t.draw=new $ut({context:t})});R6(t=>{t.draw.dispose()});class Wut extends Ey{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){Ci(gr(e.time),"Events must have a time property"),Ci(gr(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let n=new Yut(e.time,e.time+e.duration,e);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(e){if(this._root!==null){const n=[];this._root.search(e.time,n);for(const i of n)if(i.event===e){this._removeNode(i),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,n=>this.remove(n)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,n){e.parent!==null?(e.isLeftChild()?e.parent.left=n:e.parent.right=n,this._rebalance(e.parent)):this._setRoot(n)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const n=e.getBalance();let i,r=null;if(n>0)if(e.left.right===null)i=e.left,i.right=e.right,r=i;else{for(i=e.left.right;i.right!==null;)i=i.right;i.parent&&(i.parent.right=i.left,r=i.parent,i.left=e.left,i.right=e.right)}else if(e.right.left===null)i=e.right,i.left=e.left,r=i;else{for(i=e.right.left;i.left!==null;)i=i.left;i.parent&&(i.parent.left=i.right,r=i.parent,i.left=e.left,i.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=i:e.parent.right=i:this._setRoot(i),r&&this._rebalance(r)}e.dispose()}_rotateLeft(e){const n=e.parent,i=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rotateRight(e){const n=e.parent,i=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),n!==null?i?n.left=r:n.right=r:this._setRoot(r)}_rebalance(e){const n=e.getBalance();n>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):n<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const n=[];if(this._root.search(e,n),n.length>0){let i=n[0];for(let r=1;r<n.length;r++)n[r].low>i.low&&(i=n[r]);return i.event}}return null}forEach(e){if(this._root!==null){const n=[];this._root.traverse(i=>n.push(i)),n.forEach(i=>{i.event&&e(i.event)})}return this}forEachAtTime(e,n){if(this._root!==null){const i=[];this._root.search(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}forEachFrom(e,n){if(this._root!==null){const i=[];this._root.searchAfter(e,i),i.forEach(r=>{r.event&&n(r.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class Yut{constructor(e,n,i){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=i,this.low=e,this.high=n,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,n){e>this.max||(this.left!==null&&this.left.search(e,n),this.low<=e&&this.high>e&&n.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,n))}searchAfter(e,n){this.low>=e&&(n.push(this),this.left!==null&&this.left.searchAfter(e,n)),this.right!==null&&this.right.searchAfter(e,n)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class Xut extends Ey{constructor(e){super(),this.name="TimelineValue",this._timeline=new Jf({memory:10}),this._initialValue=e}set(e,n){return this._timeline.add({value:e,time:n}),this}get(e){const n=this._timeline.get(e);return n?n.value:this._initialValue}}class qg extends Gn{constructor(){super(Pn(qg.getDefaults(),arguments,["context"]))}connect(e,n=0,i=0){return O6(this,e,n,i),this}}class tx extends qg{constructor(){const e=Pn(tx.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,qh(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):Sut(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(os.getDefaults(),{length:1024})}setMap(e,n=1024){const i=new Float32Array(n);for(let r=0,s=n;r<s;r++){const a=r/(s-1)*2-1;i[r]=e(a,r)}return this.curve=i,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const n=["none","2x","4x"].some(i=>i.includes(e));Ci(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class eY extends qg{constructor(){const e=Pn(eY.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new tx({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(qg.getDefaults(),{value:1})}_expFunc(e){return n=>Math.pow(Math.abs(n),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class kb{constructor(e,n){this.id=kb._eventId++,this._remainderTime=0;const i=Object.assign(kb.getDefaults(),n);this.transport=e,this.callback=i.callback,this._once=i.once,this.time=Math.floor(i.time),this._remainderTime=i.time-this.time}static getDefaults(){return{callback:Es,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const n=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*n),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}kb._eventId=0;class tY extends kb{constructor(e,n){super(e,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const i=Object.assign(tY.getDefaults(),n);this.duration=i.duration,this._interval=i.interval,this._nextTick=i.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},kb.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return EU(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Nc(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){EU(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Nc(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const n=this.transport.getTicksAtTime(e);xC(n,this.time)&&(this._nextTick=this.floatTime+Math.ceil((n-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class I6 extends uu{constructor(){const e=Pn(I6.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new Xut(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Jf,this._repeatedEvents=new Wut,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new N6({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Rr(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(uu.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,n){if(this._loop.get(e)&&n>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),n=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const i=n%(this._swingTicks*2)/(this._swingTicks*2),r=Math.sin(i*Math.PI)*this._swingAmount;e+=new Nc(this.context,this._swingTicks*2/3).toSeconds()*r}wne(!0),this._timeline.forEachAtTime(n,i=>i.invoke(e)),wne(!1)}schedule(e,n){const i=new kb(this,{callback:e,time:new xw(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}scheduleRepeat(e,n,i,r=1/0){const s=new tY(this,{callback:e,duration:new $f(this.context,r).toTicks(),interval:new $f(this.context,n).toTicks(),time:new xw(this.context,i).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,n){const i=new kb(this,{callback:e,once:!0,time:new xw(this.context,n).toTicks()});return this._addEvent(i,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const n=this._scheduledEvents[e.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,n){return this._scheduledEvents[e.id.toString()]={event:e,timeline:n},n.add(e),e.id}cancel(e=0){const n=this.toTicks(e);return this._timeline.forEachFrom(n,i=>this.clear(i.id)),this._repeatedEvents.forEachFrom(n,i=>this.clear(i.id)),this}_bindClockEvents(){this._clock.on("start",(e,n)=>{n=new Nc(this.context,n).toSeconds(),this.emit("start",e,n)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,n){this.context.resume();let i;return gr(n)&&(i=this.toTicks(n)),this._clock.start(e,i),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){qh(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new $f(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new $f(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Nc(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),n=this._clock.getTicksAtTime(e);return new Nc(this.context,n).toBarsBeatsSixteenths()}set position(e){const n=this.toTicks(e);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(e){const n=this.now(),i=this._clock.frequency.timeToTicks(e,n);this.ticks=i}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const n=this.now();if(this.state==="started"){const i=this._clock.getTicksAtTime(n),r=this._clock.frequency.getDurationOfTicks(Math.ceil(i)-i,n),s=n+r;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",n),this._clock.setTicksAtTime(e,n)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const n=this.now(),i=this.getTicksAtTime(n),r=e-i%e;return this._clock.nextTickTime(r,n)}}syncSignal(e,n){const i=this.now();let r=this.bpm,s=1/(60/r.getValueAtTime(i)/this.PPQ),a=[];if(e.units==="time"){const c=.015625/s,l=new yr(c),u=new eY(-1),h=new yr(c);r.chain(l,u,h),r=h,s=1/s,a=[l,u,h]}n||(e.getValueAtTime(i)!==0?n=e.getValueAtTime(i)/s:n=0);const o=new yr(n);return r.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let n=this._syncedSignals.length-1;n>=0;n--){const i=this._syncedSignals[n];i.signal===e&&(i.nodes.forEach(r=>r.dispose()),i.signal.value=i.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),gI(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}mI.mixin(I6);C6(t=>{t.transport=new I6({context:t})});R6(t=>{t.transport.dispose()});class du extends Gn{constructor(e){super(e),this.input=void 0,this._state=new vI("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=Es,this._syncedStop=Es,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new _g({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Rr(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,onstop:Es,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,n,i){let r=$d(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(r=this._clampToCurrentTime(r),!this._synced&&this._state.getValueAtTime(r)==="started")Ci(xC(r,this._state.get(r).time),"Start time must be strictly greater than previous start time"),this._state.cancel(r),this._state.setStateAtTime("started",r),this.log("restart",r),this.restart(r,n,i);else if(this.log("start",r),this._state.setStateAtTime("started",r),this._synced){const s=this._state.get(r);s&&(s.offset=this.toSeconds(Ig(n,0)),s.duration=i?this.toSeconds(i):void 0);const a=this.context.transport.schedule(o=>{this._start(o,n,i)},r);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>r&&this._syncedStart(this.now(),this.context.transport.seconds)}else eve(this.context),this._start(r,n,i);return this}stop(e){let n=$d(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||gr(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const i=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(i)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(e,n,i){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,n,i)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,n)=>{if(xC(n,0)){const i=this._state.get(n);if(i&&i.state==="started"&&i.time!==n){const r=n-this.toSeconds(i.time);let s;i.duration&&(s=this.toSeconds(i.duration)-r),this._start(e,this.toSeconds(i.offset)+r,s)}}},this._syncedStop=e=>{const n=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=Es,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class yI extends wC{constructor(){const e=Pn(yI.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,sp(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new pr({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Ps(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(wC.getDefaults(),{url:new Ps,loop:!1,loopEnd:0,loopStart:0,onload:Es,onerror:Es,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,n,i,r=1){Ci(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,r),this.loop?n=Ig(n,this.loopStart):n=Ig(n,0);let a=Math.max(this.toSeconds(n),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),l=o-c;_G(a,o)&&(a=(a-c)%l+c),qp(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,EU(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,a)),gr(i)){let o=this.toSeconds(i);o=Math.max(o,0),this.stop(s+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class RC extends du{constructor(){const e=Pn(RC.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(du.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(Ci(e in Rne,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const n=this.now();this._stop(n),this._start(n)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const n=Rne[this._type];this._source=new yI({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const p1=44100*5,zH=2,gv={brown:null,pink:null,white:null},Rne={get brown(){if(!gv.brown){const t=[];for(let e=0;e<zH;e++){const n=new Float32Array(p1);t[e]=n;let i=0;for(let r=0;r<p1;r++){const s=Math.random()*2-1;n[r]=(i+.02*s)/1.02,i=n[r],n[r]*=3.5}}gv.brown=new Ps().fromArray(t)}return gv.brown},get pink(){if(!gv.pink){const t=[];for(let e=0;e<zH;e++){const n=new Float32Array(p1);t[e]=n;let i,r,s,a,o,c,l;i=r=s=a=o=c=l=0;for(let u=0;u<p1;u++){const h=Math.random()*2-1;i=.99886*i+h*.0555179,r=.99332*r+h*.0750759,s=.969*s+h*.153852,a=.8665*a+h*.3104856,o=.55*o+h*.5329522,c=-.7616*c-h*.016898,n[u]=i+r+s+a+o+c+l+h*.5362,n[u]*=.11,l=h*.115926}}gv.pink=new Ps().fromArray(t)}return gv.pink},get white(){if(!gv.white){const t=[];for(let e=0;e<zH;e++){const n=new Float32Array(p1);t[e]=n;for(let i=0;i<p1;i++)n[i]=Math.random()*2-1}gv.white=new Ps().fromArray(t)}return gv.white}};function nx(t,e){return Ja(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,i=new A6(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)})}class nY extends wC{constructor(){const e=Pn(nY.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],sp(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new pr({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new pr({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Rr(this,["frequency","detune"])}static getDefaults(){return Object.assign(wC.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class bo extends du{constructor(){const e=Pn(bo.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new os({context:this.context,units:"frequency",value:e.frequency}),Rr(this,"frequency"),this.detune=new os({context:this.context,units:"cents",value:e.detune}),Rr(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(du.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const n=this.toSeconds(e),i=new nY({context:this.context,onended:()=>this.onstop(this)});this._oscillator=i,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(e){const n=this.toSeconds(e);this._oscillator&&this._oscillator.stop(n)}_restart(e){const n=this.toSeconds(e);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return bo._periodicWaveCache.find(n=>n.phase===this._phase&&Iut(n.partials,this._partials));{const e=bo._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const n=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const i=this._getCachedPeriodicWave();if(gr(i)){const{partials:r,wave:s}=i;this._wave=s,this._partials=r,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[r,s]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(r,s);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),bo._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:r,type:this._type,wave:this._wave}),bo._periodicWaveCache.length>100&&bo._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){qf(e,0);let n=this._type;const i=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(i&&(n=i[1]),this._type!=="custom")e===0?this.type=n:this.type=n+e.toString();else{const r=new Float32Array(e);this._partials.forEach((s,a)=>r[a]=s),this._partials=Array.from(r),this.type=this._type}}_getRealImaginary(e,n){let r=2048;const s=new Float32Array(r),a=new Float32Array(r);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,r=o,this._partials.length===0)return[s,a]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(o=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],o=Math.max(o,2),r=o):this._partialCount=0,this._partials=[]}for(let c=1;c<r;++c){const l=2/(c*Math.PI);let u;switch(e){case"sine":u=c<=o?1:0,this._partials[c-1]=u;break;case"square":u=c&1?2*l:0,this._partials[c-1]=u;break;case"sawtooth":u=l*(c&1?1:-1),this._partials[c-1]=u;break;case"triangle":c&1?u=2*(l*l)*(c-1>>1&1?-1:1):u=0,this._partials[c-1]=u;break;case"custom":u=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(s[c]=-u*Math.sin(n*c),a[c]=u*Math.cos(n*c)):(s[c]=0,a[c]=0)}return[s,a]}_inverseFFT(e,n,i){let r=0;const s=e.length;for(let a=0;a<s;a++)r+=e[a]*Math.cos(a*i)+n[a]*Math.sin(a*i);return r}getInitialValue(){const[e,n]=this._getRealImaginary(this._type,0);let i=0;const r=Math.PI*2,s=32;for(let a=0;a<s;a++)i=Math.max(this._inverseFFT(e,n,a/s*r),i);return Dut(-this._inverseFFT(e,n,this._phase)/i,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}bo._periodicWaveCache=[];class fve extends qg{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new tx({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class NT extends os{constructor(){const e=Pn(NT.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new yr({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(os.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class k6 extends du{constructor(){const e=Pn(k6.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new fve({context:this.context}),this._modulationNode=new yr({context:this.context}),this._carrier=new bo({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new bo({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new NT({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Rr(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(bo.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class D6 extends du{constructor(){const e=Pn(D6.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new yr({context:this.context,gain:0}),this._carrier=new bo({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new os({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new bo({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new NT({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new NT({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Rr(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(bo.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class _I extends du{constructor(){const e=Pn(_I.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new yr({context:this.context,gain:0}),this._thresh=new tx({context:this.context,mapping:n=>n<=0?-1:1}),this.width=new os({context:this.context,units:"audioRange",value:e.width}),this._triangle=new bo({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Rr(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(du.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class P6 extends du{constructor(){const e=Pn(P6.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new os({context:this.context,units:"frequency",value:e.frequency}),this.detune=new os({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Rr(this,["frequency","detune"])}static getDefaults(){return Object.assign(bo.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(n=>n.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(n=>n.stop(e))}_restart(e){this._forEach(n=>n.restart(e))}_forEach(e){for(let n=0;n<this._oscillators.length;n++)e(this._oscillators[n],n)}get type(){return this._type}set type(e){this._type=e,this._forEach(n=>n.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const n=-e/2,i=e/(this._oscillators.length-1);this._forEach((r,s)=>r.detune.value=n+i*s)}}get count(){return this._oscillators.length}set count(e){if(qf(e,1),this._oscillators.length!==e){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<e;n++){const i=new bo({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):Es});this.type==="custom"&&(i.partials=this._partials),this.frequency.connect(i.frequency),this.detune.connect(i.detune),i.detune.overridden=!1,i.connect(this.output),this._oscillators[n]=i}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((n,i)=>n.phase=this._phase+i/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(n=>n.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(n=>n.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(n=>n.partialCount=e),this._type=this._oscillators[0].type}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class L6 extends du{constructor(){const e=Pn(L6.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new NT({context:this.context,value:2}),this._pulse=new _I({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new bo({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Rr(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(du.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const Ane={am:k6,fat:P6,fm:D6,oscillator:bo,pulse:_I,pwm:L6};class TU extends du{constructor(){const e=Pn(TU.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new os({context:this.context,units:"frequency",value:e.frequency}),this.detune=new os({context:this.context,units:"cents",value:e.detune}),Rr(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(bo.getDefaults(),D6.getDefaults(),k6.getDefaults(),P6.getDefaults(),_I.getDefaults(),L6.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const n=Ane[e],i=this.now();if(this._oscillator){const r=this._oscillator;r.stop(i),this.context.setTimeout(()=>r.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(i)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),e==="fm"?this.type="fm"+n:e==="am"?this.type="am"+n:e==="fat"?this.type="fat"+n:e==="oscillator"?this.type=n:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,n){return e instanceof Ane[n]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&sm(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&sm(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&cy(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Ja(this,arguments,void 0,function*(e=1024){return nx(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class iY extends os{constructor(){super(Pn(iY.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new yr({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,OT(this._constantSource,this._sum)}static getDefaults(){return Object.assign(os.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class rY extends qg{constructor(){const e=Pn(rY.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new NT({context:this.context,value:e.max-e.min}),this._add=this.output=new iY({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(qg.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class sY extends qg{constructor(){super(Pn(sY.getDefaults(),arguments)),this.name="Zero",this._gain=new yr({context:this.context}),this.output=this._gain,this.input=void 0,sp(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),dve(this.context.getConstant(0),this._gain),this}}class IT extends Gn{constructor(){const e=Pn(IT.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=pr.prototype._fromType,this._toType=pr.prototype._toType,this._is=pr.prototype._is,this._clampValue=pr.prototype._clampValue,this._oscillator=new bo(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new yr({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new os({context:this.context,units:"audioRange",value:0}),this._zeros=new sY({context:this.context}),this._a2g=new fve({context:this.context}),this._scaler=this.output=new rY({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Rr(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(bo.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const n=this.min,i=this.max;this._units=e,this.min=n,this.max=i}get state(){return this._oscillator.state}connect(e,n,i){return(e instanceof pr||e instanceof os)&&(this.convert=e.convert,this.units=e.units),O6(this,e,n,i),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function pve(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){qf(s,t,e),n.set(this,s)}})}}function Sy(t,e=1/0){const n=new WeakMap;return function(i,r){Reflect.defineProperty(i,r,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){qf(this.toSeconds(s),t,e),n.set(this,s)}})}}class bI extends du{constructor(){const e=Pn(bI.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Ps({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(du.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Es,onerror:Es,playbackRate:1,reverse:!1})}load(e){return Ja(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=Es){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,n,i){return super.start(e,n,i),this}_start(e,n,i){this._loop?n=Ig(n,this._loopStart):n=Ig(n,0);const r=this.toSeconds(n),s=i;i=Ig(i,Math.max(this._buffer.duration-r,0));let a=this.toSeconds(i);a=a/this._playbackRate,e=this.toSeconds(e);const o=new yI({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&$d(s)?o.start(e,r):o.start(e,r,a-this.toSeconds(this.fadeOut))}_stop(e){const n=this.toSeconds(e);this._activeSources.forEach(i=>i.stop(n))}restart(e,n,i){return super.restart(e,n,i),this}_restart(e,n,i){var r;(r=[...this._activeSources].pop())===null||r===void 0||r.stop(e),this._start(e,n,i)}seek(e,n){const i=this.toSeconds(n);if(this._state.getValueAtTime(i)==="started"){const r=this.toSeconds(e);this._stop(i),this._start(i,r)}return this}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&qf(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&qf(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(n=>{n.loop=e}),e)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const n=this.now(),i=this._state.getNextState("stopped",n);i&&i.implicitEnd&&(this._state.cancel(i.time),this._activeSources.forEach(r=>r.cancelStop())),this._activeSources.forEach(r=>{r.playbackRate.setValueAtTime(e,n)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}aa([Sy(0)],bI.prototype,"fadeIn",void 0);aa([Sy(0)],bI.prototype,"fadeOut",void 0);class Kut extends qg{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new tx({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ty extends Gn{constructor(){const e=Pn(Ty.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new os({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(Gn.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,n){if(cy(e))return e;{let i;for(i in wD)if(wD[i][n]===e)return i;return e}}_setCurve(e,n,i){if(cy(i)&&Reflect.has(wD,i)){const r=wD[i];pb(r)?e!=="_decayCurve"&&(this[e]=r[n]):this[e]=r}else if(qh(i)&&e!=="_decayCurve")this[e]=i;else throw new Error("Envelope: invalid curve: "+i)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,n=1){this.log("triggerAttack",e,n),e=this.toSeconds(e);let r=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/r;r=(1-a)/o}if(r<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(n,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,r,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,r,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let c=1;c<o.length;c++)if(o[c-1]<=a&&a<=o[c]){o=this._attackCurve.slice(c),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,r,n)}if(s&&this.sustain<1){const o=n*this.sustain,c=e+r;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,s+c):this._sig.exponentialApproachValueAtTime(o,c,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const n=this.getValueAtTime(e);if(n>0){const i=this.toSeconds(this.release);i<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,i,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,i,e):(Ci(qh(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,i,n))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),this.triggerAttack(n,i),this.triggerRelease(n+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,n=0,i=0){return O6(this,e,n,i),this}asArray(){return Ja(this,arguments,void 0,function*(e=1024){const n=e/this.context.sampleRate,i=new A6(1,n,this.context.sampleRate),r=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=r+this.toSeconds(this.release),a=s*.1,o=s+a,c=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/o,decay:n*this.toSeconds(this.decay)/o,release:n*this.toSeconds(this.release)/o,context:i}));return c._sig.toDestination(),c.triggerAttackRelease(n*(r+a)/o,0),(yield i.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}aa([Sy(0)],Ty.prototype,"attack",void 0);aa([Sy(0)],Ty.prototype,"decay",void 0);aa([pve(0,1)],Ty.prototype,"sustain",void 0);aa([Sy(0)],Ty.prototype,"release",void 0);const wD=(()=>{let e,n;const i=[];for(e=0;e<128;e++)i[e]=Math.sin(e/127*(Math.PI/2));const r=[],s=6.4;for(e=0;e<127;e++){n=e/127;const d=Math.sin(n*(Math.PI*2)*s-Math.PI/2)+1;r[e]=d/10+n*.83}r[127]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/127*o)/o;const c=[];for(e=0;e<128;e++)n=e/127,c[e]=.5*(1-Math.cos(Math.PI*n));const l=[];for(e=0;e<128;e++){n=e/127;const d=Math.pow(n,3)*4+.2,f=Math.cos(d*Math.PI*2*n);l[e]=Math.abs(f*(1-n))}function u(d){const f=new Array(d.length);for(let p=0;p<d.length;p++)f[p]=1-d[p];return f}function h(d){return d.slice(0).reverse()}return{bounce:{In:u(l),Out:l},cosine:{In:i,Out:h(i)},exponential:"exponential",linear:"linear",ripple:{In:r,Out:u(r)},sine:{In:c,Out:u(c)},step:{In:a,Out:u(a)}}})();class $g extends Gn{constructor(){const e=Pn($g.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=n=>this._original_triggerRelease(n),this._volume=this.output=new _g({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Rr(this,"volume")}static getDefaults(){return Object.assign(Gn.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,n){const i=this["_original_"+e]=this[e];this[e]=(...r)=>{const s=r[n],a=this.context.transport.schedule(o=>{r[n]=o,i.apply(this,r)},s);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i),a=this.toSeconds(n);return this.triggerAttack(e,s,r),this.triggerRelease(s+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class kT extends $g{constructor(){const e=Pn(kT.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign($g.getDefaults(),{detune:0,onsilence:Es,portamento:0})}triggerAttack(e,n,i=1){this.log("triggerAttack",e,n,i);const r=this.toSeconds(n);return this._triggerEnvelopeAttack(r,i),this.setNote(e,r),this}triggerRelease(e){this.log("triggerRelease",e);const n=this.toSeconds(e);return this._triggerEnvelopeRelease(n),this}setNote(e,n){const i=this.toSeconds(n),r=e instanceof Hh?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(i)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,s,i)}else this.frequency.setValueAtTime(r,i);return this}}aa([Sy(0)],kT.prototype,"portamento",void 0);class U6 extends Ty{constructor(){super(Pn(U6.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new yr({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Gu extends kT{constructor(){const e=Pn(Gu.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new TU(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new U6(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Rr(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(kT.getDefaults(),{envelope:Object.assign(RO(Ty.getDefaults(),Object.keys(Gn.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(RO(TU.getDefaults(),[...Object.keys(du.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,n){if(this.envelope.triggerAttack(e,n),this.oscillator.start(e),this.envelope.sustain===0){const i=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+i+r)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class xU extends Gn{constructor(){const e=Pn(xU.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new pr({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new pr({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new pr({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new pr({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){Ci(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const n=new Float32Array(e);for(let a=0;a<e;a++){const c=Math.pow(a/e,2)*19980+20;n[a]=c}const i=new Float32Array(e),r=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(n,i,r),i}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class kf extends Gn{constructor(){const e=Pn(kf.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new yr({context:this.context}),this.output=new yr({context:this.context}),this._filters=[],this._filters=[],this.Q=new os({context:this.context,units:"positive",value:e.Q}),this.frequency=new os({context:this.context,units:"frequency",value:e.frequency}),this.detune=new os({context:this.context,units:"cents",value:e.detune}),this.gain=new os({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,Rr(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){Ci(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(i=>i.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const n=sm(e)?e:parseInt(e,10),i=[-12,-24,-48,-96];let r=i.indexOf(n);Ci(r!==-1,`rolloff can only be ${i.join(", ")}`),r+=1,this._rolloff=n,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(r);for(let s=0;s<r;s++){const a=new xU({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[s]=a}this._internalChannels=this._filters,OT(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const n=new xU({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),i=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{n.getFrequencyResponse(e).forEach((s,a)=>i[a]*=s)}),n.dispose(),i}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),gI(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class EI extends Gu{constructor(){const e=Pn(EI.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Rr(this,["oscillator","envelope"])}static getDefaults(){return KS(kT.getDefaults(),Gu.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,n){const i=this.toSeconds(n),r=this.toFrequency(e instanceof Hh?e.toFrequency():e),s=r*this.octaves;return this.oscillator.frequency.setValueAtTime(s,i),this.oscillator.frequency.exponentialRampToValueAtTime(r,i+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}aa([pve(0)],EI.prototype,"octaves",void 0);aa([Sy(0)],EI.prototype,"pitchDecay",void 0);class Z1 extends $g{constructor(){const e=Pn(Z1.getDefaults(),arguments);super(e),this.name="NoiseSynth",this.noise=new RC(Object.assign({context:this.context},e.noise)),this.envelope=new U6(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign($g.getDefaults(),{envelope:Object.assign(RO(Ty.getDefaults(),Object.keys(Gn.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(RO(RC.getDefaults(),Object.keys(du.getDefaults())),{type:"white"})})}triggerAttack(e,n=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,n),this.noise.start(e),this.envelope.sustain===0&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,n,i=1){return n=this.toSeconds(n),e=this.toSeconds(e),this.triggerAttack(n,i),this.triggerRelease(n+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const mve=new Set;function aY(t){mve.add(t)}function gve(t,e){const n=`registerProcessor("${t}", ${e})`;mve.add(n)}const Jut=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;aY(Jut);const Zut=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;aY(Zut);const Qut=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;aY(Qut);const eht="feedback-comb-filter",tht=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;gve(eht,tht);class wU extends $g{constructor(){const e=Pn(wU.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=r=>this.releaseAll(r),Ci(!sm(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const n=e.voice.getDefaults();this.options=Object.assign(n,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const i=this._voices.indexOf(this._dummyVoice);this._voices.splice(i,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign($g.getDefaults(),{maxPolyphony:32,options:{},voice:Gu})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const n=this._activeVoices.findIndex(i=>i.voice===e);this._activeVoices.splice(n,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return Ci(e instanceof kT,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else x6("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),n=this._voices.indexOf(e);this._voices.splice(n,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,n,i){e.forEach(r=>{const s=new SU(this.context,r).toMidi(),a=this._getNextAvailableVoice();a&&(a.triggerAttack(r,n,i),this._activeVoices.push({midi:s,voice:a,released:!1}),this.log("triggerAttack",r,n))})}_triggerRelease(e,n){e.forEach(i=>{const r=new SU(this.context,i).toMidi(),s=this._activeVoices.find(({midi:a,released:o})=>a===r&&!o);s&&(s.voice.triggerRelease(n),s.released=!0,this.log("triggerRelease",i,n))})}_scheduleEvent(e,n,i,r){Ci(!this.disposed,"Synth was already disposed"),i<=this.now()?e==="attack"?this._triggerAttack(n,i,r):this._triggerRelease(n,i):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,n,i,r)},i-this.now())}triggerAttack(e,n,i){Array.isArray(e)||(e=[e]);const r=this.toSeconds(n);return this._scheduleEvent("attack",e,r,i),this}triggerRelease(e,n){Array.isArray(e)||(e=[e]);const i=this.toSeconds(n);return this._scheduleEvent("release",e,i),this}triggerAttackRelease(e,n,i,r){const s=this.toSeconds(i);if(this.triggerAttack(e,s,r),qh(n)){Ci(qh(e),"If the duration is an array, the notes must also be an array"),e=e;for(let a=0;a<e.length;a++){const o=n[Math.min(a,n.length-1)],c=this.toSeconds(o);Ci(c>0,"The duration must be greater than 0"),this.triggerRelease(e[a],s+c)}}else{const a=this.toSeconds(n);Ci(a>0,"The duration must be greater than 0"),this.triggerRelease(e,s+a)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const n=RO(e,["onsilence","context"]);return this.options=KS(this.options,n),this._voices.forEach(i=>i.set(n)),this._dummyVoice.set(n),this}get(){return this._dummyVoice.get()}releaseAll(e){const n=this.toSeconds(e);return this._activeVoices.forEach(({voice:i})=>{i.triggerRelease(n)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class SI extends $g{constructor(){const e=Pn(SI.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const n={};Object.keys(e.urls).forEach(i=>{const r=parseInt(i,10);if(Ci(xD(i)||sm(r)&&isFinite(r),`url key is neither a note or midi pitch: ${i}`),xD(i)){const s=new Hh(this.context,i).toMidi();n[s]=e.urls[i]}else sm(r)&&isFinite(r)&&(n[r]=e.urls[r])}),this._buffers=new Q9({urls:n,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign($g.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Es,onerror:Es,release:.1,urls:{}})}_findClosest(e){let i=0;for(;i<96;){if(this._buffers.has(e+i))return-i;if(this._buffers.has(e-i))return i;i++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,n,i=1){return this.log("triggerAttack",e,n,i),Array.isArray(e)||(e=[e]),e.forEach(r=>{const s=uve(new Hh(this.context,r).toFrequency()),a=Math.round(s),o=s-a,c=this._findClosest(a),l=a-c,u=this._buffers.get(l),h=lve(c+o),d=new yI({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);d.start(n,0,u.duration/h,i),qh(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const f=this._activeSources.get(a),p=f.indexOf(d);p!==-1&&f.splice(p,1)}}}),this}triggerRelease(e,n){return this.log("triggerRelease",e,n),Array.isArray(e)||(e=[e]),e.forEach(i=>{const r=new Hh(this.context,i).toMidi();if(this._activeSources.has(r)&&this._activeSources.get(r).length){const s=this._activeSources.get(r);n=this.toSeconds(n),s.forEach(a=>{a.stop(n)}),this._activeSources.set(r,[])}}),this}releaseAll(e){const n=this.toSeconds(e);return this._activeSources.forEach(i=>{for(;i.length;)i.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,n,i,r=1){const s=this.toSeconds(i);return this.triggerAttack(e,s,r),qh(n)?(Ci(qh(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const c=n[Math.min(o,n.length-1)];this.triggerRelease(a,s+this.toSeconds(c))})):this.triggerRelease(e,s+this.toSeconds(n)),this}add(e,n,i){if(Ci(xD(e)||isFinite(e),`note must be a pitch or midi: ${e}`),xD(e)){const r=new Hh(this.context,e).toMidi();this._buffers.add(r,n,i)}else this._buffers.add(e,n,i);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}aa([Sy(0)],SI.prototype,"attack",void 0);aa([Sy(0)],SI.prototype,"release",void 0);class Q1 extends uu{constructor(){const e=Pn(Q1.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new vI("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(uu.getDefaults(),{callback:Es,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,n=>{let i;if(n.state==="started"){n.id!==-1&&this.context.transport.clear(n.id);const r=n.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||sm(this._loop)&&this._loop>1){i=1/0,sm(this._loop)&&(i=this._loop*this._getLoopDuration());const s=this._state.getAfter(r);s!==null&&(i=Math.min(i,s.time-r)),i!==1/0&&(i=new Nc(this.context,i));const a=new Nc(this.context,this._getLoopDuration());n.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new Nc(this.context,r),i)}else n.id=this.context.transport.schedule(this._tick.bind(this),new Nc(this.context,r))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const n=this.toTicks(e);return this._state.getValueAtTime(n)==="stopped"&&(this._state.add({id:-1,state:"started",time:n}),this._rescheduleEvents(n)),this}stop(e){this.cancel(e);const n=this.toTicks(e);if(this._state.getValueAtTime(n)==="started"){this._state.setStateAtTime("stopped",n,{id:-1});const i=this._state.getBefore(n);let r=n;i!==null&&(r=i.time),this._rescheduleEvents(r)}return this}cancel(e){e=Ig(e,-1/0);const n=this.toTicks(e);return this._state.forEachFrom(n,i=>{this.context.transport.clear(i.id)}),this._state.cancel(n),this}_tick(e){const n=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(n)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let i=.02;Q0e(this.humanize)||(i=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*i}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new Nc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new Nc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,n=this._state.get(e);if(n!==null&&n.state==="started"){const i=this._getLoopDuration();return(e-n.time)%i/i}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class CU extends Q1{constructor(){const e=Pn(CU.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new vI("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(n=>{qh(n)?this.add(n[0],n[1]):this.add(n)})}static getDefaults(){return Object.assign(Q1.getDefaults(),{events:[]})}start(e,n){const i=this.toTicks(e);if(this._state.getValueAtTime(i)!=="started"){n=Ig(n,this._loop?this._loopStart:0),this._loop?n=Ig(n,this._loopStart):n=Ig(n,0);const r=this.toTicks(n);this._state.add({id:-1,offset:r,state:"started",time:i}),this._forEach(s=>{this._startNote(s,i,r)})}return this}_startNote(e,n,i){n-=i,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<i&&(n+=this._getLoopDuration()),e.start(new Nc(this.context,n))):e.startOffset<this._loopStart&&e.startOffset>=i&&(e.loop=!1,e.start(new Nc(this.context,n))):e.startOffset>=i&&e.start(new Nc(this.context,n))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(n=>{n.startOffset+=this._startOffset})}stop(e){const n=this.toTicks(e);return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._forEach(i=>{i.stop(e)}),this}at(e,n){const i=new xw(this.context,e).toTicks(),r=new Nc(this.context,1).toSeconds(),s=this._events.values();let a=s.next();for(;!a.done;){const o=a.value;if(Math.abs(i-o.startOffset)<r)return gr(n)&&(o.value=n),o;a=s.next()}return gr(n)?(this.add(e,n),this.at(e)):null}add(e,n){e instanceof Object&&Reflect.has(e,"time")&&(n=e,e=n.time);const i=this.toTicks(e);let r;return n instanceof Q1?(r=n,r.callback=this._tick.bind(this)):r=new Q1({callback:this._tick.bind(this),context:this.context,value:n}),r.startOffset=i,r.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(r),this._restartEvent(r),this}_restartEvent(e){this._state.forEach(n=>{n.state==="started"?this._startNote(e,n.time,n.offset):e.stop(new Nc(this.context,n.time))})}remove(e,n){return pb(e)&&e.hasOwnProperty("time")&&(n=e,e=n.time),e=this.toTicks(e),this._events.forEach(i=>{i.startOffset===e&&($d(n)||gr(n)&&i.value===n)&&(this._events.delete(i),i.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(n=>n.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(n=>{n instanceof CU?n._forEach(e):e(n)}),this}_setAll(e,n){this._forEach(i=>{i[e]=n})}_tick(e,n){this.mute||this.callback(e,n)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(n=>{n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.loop=e,this._testLoopBoundries(n)})}get loopEnd(){return new Nc(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopEnd=e,this._testLoopBoundries(n)})}get loopStart(){return new Nc(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(n=>{n.loopStart=this.loopStart,this._testLoopBoundries(n)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class B6 extends Gn{constructor(){const e=Pn(B6.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Kut({context:this.context}),this.a=new yr({context:this.context,gain:0}),this.b=new yr({context:this.context,gain:0}),this.output=new yr({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new os({context:this.context,units:"normalRange",value:e.fade}),Rr(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",sp(this._split,this.a.gain,0),sp(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Gn.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}let Wg=class extends Gn{constructor(e){super(e),this.name="Effect",this._dryWet=new B6({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new yr({context:this.context}),this.effectReturn=new yr({context:this.context}),this.input=new yr({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Rr(this,"wet")}static getDefaults(){return Object.assign(Gn.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};class oY extends Gn{constructor(){const e=Pn(oY.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new pr({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Rr(this,"pan")}static getDefaults(){return Object.assign(Gn.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const nht="bit-crusher",iht=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;gve(nht,iht);class F6 extends Gn{constructor(){const e=Pn(F6.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Gn.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class TI extends Gn{constructor(){const e=Pn(TI.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(Gn.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class RU extends Gn{constructor(e){super(e),this.name="StereoEffect",this.input=new yr({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new B6({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new F6({context:this.context,channels:2}),this._merge=new TI({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Rr(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),OT(...e),sp(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),OT(...e),sp(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Gn.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Mne extends RU{constructor(e){super(e),this.feedback=new os({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new yr({context:this.context}),this._feedbackR=new yr({context:this.context}),this._feedbackSplit=new F6({context:this.context,channels:2}),this._feedbackMerge=new TI({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Rr(this,["feedback"])}static getDefaults(){return Object.assign(RU.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class cY extends Mne{constructor(){const e=Pn(cY.getDefaults(),arguments,["frequency","delayTime","depth"]);super(e),this.name="Chorus",this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new IT({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new IT({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new CC({context:this.context}),this._delayNodeR=new CC({context:this.context}),this.frequency=this._lfoL.frequency,Rr(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(Mne.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const n=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-n,0),this._lfoL.max=this._delayTime+n,this._lfoR.min=Math.max(this._delayTime-n,0),this._lfoR.max=this._delayTime+n}get delayTime(){return this._delayTime*1e3}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class AO extends Wg{constructor(){const e=Pn(AO.getDefaults(),arguments,["distortion"]);super(e),this.name="Distortion",this._shaper=new tx({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign(Wg.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;const n=e*100,i=Math.PI/180;this._shaper.setMap(r=>Math.abs(r)<.001?0:(3+n)*r*20*i/(Math.PI+n*Math.abs(r)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class One extends Wg{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new yr({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Rr(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Wg.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class z6 extends One{constructor(){const e=Pn(z6.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new CC({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Rr(this,"delayTime")}static getDefaults(){return Object.assign(One.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class lY extends RU{constructor(){const e=Pn(lY.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new IT({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new IT({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new os({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),Rr(this,["frequency","Q"])}static getDefaults(){return Object.assign(RU.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,n){const i=[];for(let r=0;r<e;r++){const s=this.context.createBiquadFilter();s.type="allpass",this.Q.connect(s.Q),n.connect(s.frequency),i.push(s)}return i}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const n=this._baseFrequency*Math.pow(2,e);this._lfoL.max=n,this._lfoR.max=n}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class uY extends Wg{constructor(){const e=Pn(uY.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const n=this.toSeconds(e.decay);qf(n,.001),this._decay=n;const i=this.toSeconds(e.preDelay);qf(i,0),this._preDelay=i,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Wg.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),qf(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),qf(e,0),this._preDelay=e,this.generate()}generate(){return Ja(this,void 0,void 0,function*(){const e=this.ready,n=new A6(2,this._decay+this._preDelay,this.context.sampleRate),i=new RC({context:n}),r=new RC({context:n}),s=new TI({context:n});i.connect(s,0,0),r.connect(s,0,1);const a=new yr({context:n}).toDestination();s.connect(a),i.start(0),r.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=n.render();return this.ready=o.then(Es),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class hY extends Wg{constructor(){const e=Pn(hY.getDefaults(),arguments,["frequency","depth"]);super(e),this.name="Vibrato",this._delayNode=new CC({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new IT({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,Rr(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Wg.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class rc extends Gn{constructor(){const e=Pn(rc.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new yr({context:this.context}),rc._allSolos.has(this.context)||rc._allSolos.set(this.context,new Set),rc._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(Gn.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),rc._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){rc._soloed.has(this.context)||rc._soloed.set(this.context,new Set),rc._soloed.get(this.context).add(this)}_removeSolo(){rc._soloed.has(this.context)&&rc._soloed.get(this.context).delete(this)}_isSoloed(){return rc._soloed.has(this.context)&&rc._soloed.get(this.context).has(this)}_noSolos(){return!rc._soloed.has(this.context)||rc._soloed.has(this.context)&&rc._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),rc._allSolos.get(this.context).delete(this),this._removeSolo(),this}}rc._allSolos=new Map;rc._soloed=new Map;class dY extends Gn{constructor(){const e=Pn(dY.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new oY({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new _g({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Rr(this,["pan","volume"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class ew extends Gn{constructor(){const e=Pn(ew.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new rc({solo:e.solo,context:this.context}),this._panVol=this.output=new dY({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Rr(this,["pan","volume"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return ew.buses.has(e)||ew.buses.set(e,new yr({context:this.context})),ew.buses.get(e)}send(e,n=0){const i=this._getBus(e),r=new yr({context:this.context,units:"decibels",gain:n});return this.connect(r),r.connect(i),r}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}ew.buses=new Map;class fY extends Gn{constructor(){const e=Pn(fY.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(e),this.name="MultibandSplit",this.input=new yr({context:this.context}),this.output=void 0,this.low=new kf({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new kf({context:this.context,frequency:0,type:"highpass"}),this.mid=new kf({context:this.context,frequency:0,type:"lowpass"}),this.high=new kf({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new os({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new os({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new os({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Rr(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),gI(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class pY extends Gn{constructor(){const e=Pn(pY.getDefaults(),arguments,["threshold","ratio"]);super(e),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new pr({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new pr({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new pr({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new pr({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new pr({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),Rr(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Gn.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class mY extends Gn{constructor(){const e=Pn(mY.getDefaults(),arguments,["low","mid","high"]);super(e),this.name="EQ3",this.output=new yr({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new fY({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new yr({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new yr({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new yr({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Rr(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(Gn.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),gI(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}cc().transport;function gY(){return cc().transport}cc().destination;cc().destination;function rht(){return cc().destination}cc().listener;cc().draw;cc();const Nne=4,sht={a:1,b:2,c:3,d:4,e:5,f:6,g:7,x:8,"#":9,"!":10,y:13,t:14,s:15,i:16,q:17,h:18,w:19,3:20,".":21,"+":11,"-":12,0:22,1:23,2:24,p:25,4:26,5:27,6:29,7:28,8:30,9:31};function aht(t,e,n,i=!0){let r=e,s=3,a="32n",o="",c="";const l=[];function u(){c="",o="",r+=Cc(a).toSeconds()}function h(){c===null?(l.push([r,[t,a,c]]),u()):pn(c)?(l.push([r,[t,a,c]]),u()):c.startsWith("#")?(l.push([r,[t,a,c]]),u()):c!==""&&(l.push([r,[t,a,`${c}${o}${s}`]]),u())}if(On(n))c=n;else for(let d=0;d<n.length;++d){switch(n[d]){case 9:case 10:break;default:h();break}switch(n[d]){case 1:c="A";break;case 2:c="B";break;case 3:c="C";break;case 4:c="D";break;case 5:c="E";break;case 6:c="F";break;case 7:c="G";break;case 8:c=null;break;case 9:o+="#";break;case 10:o+="b";break;case 11:++s;break;case 12:--s;break;case 13:a="64n";break;case 14:a="32n";break;case 15:a="16n";break;case 16:a="8n";break;case 17:a="4n";break;case 18:a="2n";break;case 19:a="1n";break;case 20:a=a.replace("n","t");break;case 21:a+=".";break;case 22:c=0;break;case 23:c=1;break;case 24:c=2;break;case 25:c=3;break;case 26:c=4;break;case 27:c=5;break;case 29:c=6;break;case 28:c=7;break;case 30:c=8;break;case 31:c=9;break}}return h(),i&&l.push([r,[t,"8n",-1]]),l}function oht(t){const e=[],n=t.split(";");for(let i=0;i<n.length;++i){const r=[],s=n[i];if(s.startsWith("#"))e.push(s);else{for(let a=0;a<s.length;++a){const o=sht[s[a]];ae(o)&&r.push(o)}e.push(r)}}return e}const cht="data:text/javascript;base64,Ly8gQSBkb3duc2FtcGxpbmcvZGVncmFkaW5nIHByb2Nlc3NpbmcgZWZmZWN0Ci8vIFNhbXBsZSBhbmQgaG9sZHMgdGhlIHNpZ25hbCBiYXNlZCBvbiBhbiBpbmNyZW1lbnRpbmcgY291bnRlcgovLyB3cml0dGVuIGJ5IFRpbW8gSG9vZ2xhbmQsIChjKSAyMDIzLCB3d3cudGltb2hvb2dsYW5kLmNvbQovLwpjbGFzcyBTeW50aFdvcmtsZXRQcm9jZXNzb3IgZXh0ZW5kcyBBdWRpb1dvcmtsZXRQcm9jZXNzb3IgewogIHN0YXRpYyBnZXQgcGFyYW1ldGVyRGVzY3JpcHRvcnMoKSB7CiAgICByZXR1cm4gWwogICAgICB7CiAgICAgICAgbmFtZTogJ2Rvd24nLAogICAgICAgIGRlZmF1bHRWYWx1ZTogMSwKICAgICAgICBtaW5WYWx1ZTogMSwKICAgICAgICBtYXhWYWx1ZTogNTEyLAogICAgICB9LAogICAgXQogIH0KCiAgY29uc3RydWN0b3IoKSB7CiAgICBzdXBlcigpCiAgICAvLyB0aGUgZnJhbWUgY291bnRlcgogICAgdGhpcy5jb3VudCA9IDAKICAgIC8vIHNhbXBsZSBhbmQgaG9sZCB2YXJpYWJsZSBhcnJheQogICAgdGhpcy5zYWggPSBbXQogIH0KCiAgcHJvY2VzcyhpbnB1dHMsIG91dHB1dHMsIHBhcmFtZXRlcnMpIHsKICAgIGNvbnN0IGlucHV0ID0gaW5wdXRzWzBdCiAgICBjb25zdCBvdXRwdXQgPSBvdXRwdXRzWzBdCgogICAgLy8gaWYgdGhlcmUgaXMgYW55dGhpbmcgdG8gcHJvY2VzcwogICAgaWYgKGlucHV0Lmxlbmd0aCA+IDApIHsKICAgICAgLy8gZm9yIHRoZSBsZW5ndGggb2YgdGhlIHNhbXBsZSBhcnJheSAoZ2VuZXJhbGx5IDEyOCkKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dFswXS5sZW5ndGg7IGkrKykgewogICAgICAgIC8vIGZvciBldmVyeSBjaGFubmVsCiAgICAgICAgZm9yIChsZXQgY2hhbm5lbCA9IDA7IGNoYW5uZWwgPCBpbnB1dC5sZW5ndGg7ICsrY2hhbm5lbCkgewogICAgICAgICAgLy8gaWYgY291bnRlciBlcXVhbHMgMCwgc2FtcGxlIGFuZCBob2xkCiAgICAgICAgICBpZiAodGhpcy5jb3VudCAlIHBhcmFtZXRlcnMuZG93biA9PT0gMCkgewogICAgICAgICAgICB0aGlzLnNhaFtjaGFubmVsXSA9IGlucHV0W2NoYW5uZWxdW2ldCiAgICAgICAgICB9CiAgICAgICAgICAvLyBvdXRwdXQgdGhlIGN1cnJlbnRseSBoZWxkIHNhbXBsZQogICAgICAgICAgb3V0cHV0W2NoYW5uZWxdW2ldID0gdGhpcy5zYWhbY2hhbm5lbF0KICAgICAgICB9CiAgICAgICAgLy8gaW5jcmVtZW50IHNhbXBsZSBjb3VudGVyCiAgICAgICAgdGhpcy5jb3VudCsrCiAgICAgIH0KICAgIH0KICAgIHJldHVybiB0cnVlCiAgfQp9CgpyZWdpc3RlclByb2Nlc3Nvcignc3ludGh3b3JrbGV0cHJvY2Vzc29yJywgU3ludGhXb3JrbGV0UHJvY2Vzc29yKQo=";class vY extends Wg{constructor(){const n=Pn(vY.getDefaults(),arguments,["rate"]);super(n);Qn(this,"name","FrequencyCrusher");Qn(this,"rate");Qn(this,"_audioworkletnode",this.context.createAudioWorkletNode("synthworkletprocessor"));this.rate=new pr({context:this.context,param:this._audioworkletnode.parameters.get("down"),value:n.rate,minValue:1,maxValue:512}),this.connectEffect(this._audioworkletnode)}static getDefaults(){return Object.assign(Wg.getDefaults(),{rate:64})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}async function lht(){await cc().addAudioWorkletModule(cht)}const bG=Cc("256n").toSeconds(),uht=Cc("8n").toSeconds();function HH(){const t=new uY,e=ol(t.get()),n=new z6,i=ol(n.get()),r=new lY,s=ol(r.get()),a=new AO,o=ol(a.get()),c=new hY,l=ol(c.get()),u=new vY,h=ol(u.get());function d(){t.set({...e,wet:0}),n.set({...i,wet:0,delayTime:bG,maxDelay:"8n",feedback:.666}),r.set({...s,wet:0,frequency:4,octaves:3,baseFrequency:330}),a.set({...o,wet:0,distortion:.9,oversample:"2x"}),c.set({...l,wet:0,depth:.2}),u.set({...h,wet:0,rate:32})}return d(),{fc:u,echo:n,reverb:t,phaser:r,vibrato:c,distortion:a,applyreset:d,fcrush:u,distort:a}}var Nl=(t=>(t[t.SYNTH=0]="SYNTH",t[t.RETRO_NOISE=1]="RETRO_NOISE",t[t.BUZZ_NOISE=2]="BUZZ_NOISE",t[t.CLANG_NOISE=3]="CLANG_NOISE",t[t.METALLIC_NOISE=4]="METALLIC_NOISE",t))(Nl||{});const Ine=32768;function hht(t){const e=cc().createBuffer(1,Ine,cc().sampleRate);let n=1;const i=e.getChannelData(0);for(let r=0;r<Ine;r++){t===4?i[r]=(n&1)*4*(Math.random()*14+1)-8:i[r]=(n&1)*2-1;let s=n>>1;if((n+s&1)==1)switch(t){default:case 1:s+=16384;break;case 3:s+=32768;break;case 2:s+=40;break;case 4:s+=60;break}n=s}return e}function vv(t){let e,n;function i(){switch(e==null?void 0:e.type){case 0:{e.synth.set({...n,envelope:{...n.envelope,attack:.01,decay:.01,sustain:.5,release:.01},oscillator:{...n.oscillator,type:"square"}});break}case 1:e.synth.set({...n,release:"8n"})}}switch(t){case 0:return e={type:t,synth:new Gu},n=ol(e.synth.get()),i(),{source:e,applyreset:i};case 1:case 2:case 3:case 4:return e={type:t,synth:new SI({volume:-12,attack:.001,release:.75,urls:{C4:hht(t)}})},n=ol(e.synth.get()),i(),{source:e,applyreset:i}}}function kne(t){return 20*Math.log10(t)-35}function dht(){const t=rht(),e=cc().createMediaStreamDestination(),n=new _g(-4);n.connect(t),n.connect(e);const i=new pY({threshold:-24,ratio:4,attack:.003,release:.25,knee:30});i.connect(n);const r=new cY;r.set({wet:.22,depth:.777,delayTime:16}),r.connect(i);const s=new _g;s.connect(r);const a=new _g;a.connect(r);const o=new _g;o.connect(r);const c=[vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH),vv(Nl.SYNTH)],l=[HH(),HH(),HH()];function u($e){return $e<4?Math.floor($e/2):2}function h($e){const Ue=u($e);c[$e].source.synth.chain(l[Ue].fc,l[Ue].distortion,l[Ue].vibrato,l[Ue].phaser,l[Ue].echo,l[Ue].reverb,$e<4?s:a)}for(let $e=0;$e<c.length;++$e)h($e);function d($e,Ue){c[$e].source.type!==Ue&&(c[$e].source.synth.dispose(),c[$e]=vv(Ue),h($e))}const f=new wU().connect(s);f.maxPolyphony=8,f.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function p($e){f.triggerAttackRelease("C6","1i",$e)}const g=new Gu().connect(s);f.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"square"}});function _($e){const Ue=Cc("64n").toSeconds();g.triggerAttackRelease("C6","8n",$e),g.frequency.exponentialRampToValueAtTime("C11",Ue+$e)}const v=new kf(350,"bandpass").connect(s),E=new yr().connect(v);E.gain.value=0;const T=new wU().connect(E);T.volume.value=16,T.maxPolyphony=8,T.set({envelope:{attack:.001,decay:.01,sustain:.1,release:.1},oscillator:{type:"square"}});function x($e,Ue){const qt=Cc("64n").toSeconds()+Cc($e).toSeconds();E.gain.setValueAtTime(.5,Ue),E.gain.exponentialRampToValueAtTime(.01,qt+Ue),T.triggerAttackRelease([800,540],$e,Ue)}const N=new mY(-10,10,-1).connect(s),A=new kf(800,"highpass",-12);A.connect(N);const I=new Z1;I.set({envelope:{attack:.01,decay:.1,sustain:.1,release:.1}}),I.connect(A);function k($e,Ue){I.triggerAttackRelease($e,Ue)}const L=new AO().connect(s);L.set({distortion:.666});const U=new Gu;U.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),U.connect(L);const $=new kf;$.set({type:"highpass",frequency:1e4}),$.connect(L);const q=new Z1;q.set({envelope:{attack:.01,decay:.1,sustain:0,release:.1}}),q.connect($);function G($e,Ue){const qt=Cc("512n").toSeconds(),Mt=Cc("32n").toSeconds();U.triggerAttackRelease(1e4,$e,Ue,1),U.frequency.exponentialRampToValueAtTime(300,Ue+qt),U.frequency.exponentialRampToValueAtTime(100,Ue+Mt),q.triggerAttackRelease("8n",Ue,.333),q.volume.setValueAtTime(1,Ue),q.volume.exponentialRampToValueAtTime(0,Ue+Cc("32n").toSeconds())}const X=new kf;X.set({type:"bandpass",frequency:256,Q:.17}),X.connect(s);const ie=new Gu;ie.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),ie.connect(X);const V=new Gu;V.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),V.connect(X);function Z($e,Ue){ie.triggerAttackRelease(2e3,$e,Ue),ie.frequency.exponentialRampToValueAtTime(1e3,Ue+Cc("32n").toSeconds()),V.triggerAttackRelease(999,$e,Ue),V.frequency.exponentialRampToValueAtTime(888,Ue+Cc("256n").toSeconds())}const Y=new AO().connect(s);Y.set({distortion:.876});const ee=new Gu;ee.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),ee.connect(Y);const oe=new kf;oe.set({type:"highpass",frequency:1e4}),oe.connect(Y);const de=new Z1;de.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}}),de.connect(oe);function Me($e,Ue){const qt=Cc("512n").toSeconds(),Mt=Cc("32n").toSeconds();ee.triggerAttackRelease(1e4,$e,Ue,1),ee.frequency.exponentialRampToValueAtTime(150,Ue+qt),ee.frequency.exponentialRampToValueAtTime(100,Ue+Mt),de.triggerAttackRelease("8n",Ue,.25),de.volume.setValueAtTime(1,Ue),de.volume.exponentialRampToValueAtTime(0,Ue+Cc("32n").toSeconds())}const He=new Gu().connect(s);He.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"sawtooth"}});const Te=new Gu().connect(s);He.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"triangle"}});const Le=new Z1().connect(s);Le.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}});function we($e,Ue){const qt=Cc("256n").toSeconds(),Mt=Cc($e).toSeconds()-qt;He.triggerAttackRelease("C4",Mt,Ue,1),He.frequency.exponentialRampToValueAtTime(Cne("C0").toFrequency(),Ue+Mt),Te.triggerAttackRelease("C5",Mt,Ue,.5),Te.frequency.exponentialRampToValueAtTime(Cne("C0").toFrequency(),Ue+Mt);const Yt=Cc("4n").toSeconds();Le.triggerAttackRelease("8n",Ue),Le.volume.setValueAtTime(1,Ue),Le.volume.exponentialRampToValueAtTime(0,Ue+Yt)}const Ce=new kf;Ce.set({type:"bandpass",frequency:256,Q:.17}),Ce.connect(s);const ke=new Gu;ke.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),ke.connect(Ce);const St=new Gu;St.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),St.connect(Ce);function At($e,Ue){ke.triggerAttackRelease(2e3,$e,Ue),ke.frequency.exponentialRampToValueAtTime(100,Ue+Cc("32n").toSeconds()),St.triggerAttackRelease(699,$e,Ue),St.frequency.exponentialRampToValueAtTime(399,Ue+Cc("256n").toSeconds())}const Ee=new EI().connect(s);Ee.set({octaves:8});function ye($e){Ee.triggerAttackRelease("C1","8n",$e)}const et=new CU(fe);function fe($e,Ue){if(Ue===null)return;const[qt,Mt,Yt]=Ue;if(On(Yt)&&ae(c[qt])&&(Yt.startsWith("#")?iPe(Ge,"",Yt.slice(1)):c[qt].source.synth.triggerAttackRelease(Yt,Mt,$e)),pn(Yt))switch(Yt){case 0:p($e);break;case 1:_($e);break;case 2:x(Mt,$e);break;case 3:k(Mt,$e);break;case 4:G(Mt,$e);break;case 5:Z(Mt,$e);break;case 6:Me(Mt,$e);break;case 7:we(Mt,$e);break;case 8:At(Mt,$e);break;case 9:ye($e);break;case-1:--it,it===0&&(et.clear(),Ie=-1);break}}function Fe($e,Ue,qt,Mt=!0){let Yt=Ue;const ce=aht($e,Ue,qt,Mt),j=ce[ce.length-1];ae(j)&&(Yt=Math.max(Yt,j[0]));for(let W=0;W<ce.length;++W){const[me,De]=ce[W];et.add(me,De)}return Yt}let Ie=-1,it=0,dt=Nne;function gt($e,Ue){const qt=oht($e),Mt=gY().seconds+.1;if(Ue)for(let Yt=0;Yt<qt.length;++Yt)Fe(dt++,Mt,qt[Yt],!1),dt>=c.length&&(dt=Nne);else{Ie===-1&&(Ie=Mt),it+=qt.length;const Yt=Ie;for(let ce=0;ce<qt.length&&ce<c.length;++ce){const j=Fe(ce,Yt,qt[ce]);Ie=Math.max(Ie,j)}}}et.start(0);function bt(){et.clear(),Ie=-1,it=0}function be($e){s.volume.value=kne($e)}function ue($e){a.volume.value=kne($e)}function Xe($e){new bI($e).connect(o).start(0)}function nt($e){o.volume.value=$e}return nt(100),be(45),ue(80),{broadcastdestination:e,addplay:gt,stopplay:bt,addttsaudiobuffer:Xe,setplayvolume:be,setbgplayvolume:ue,setttsvolume:nt,SOURCE:c,FX:l,changesource:d}}const fht=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]+/,pht=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]*/;function mht(t,e){if(On(t)){const n=ai(t);if(fht.test(n))return Li(e);switch(n){case"pwm":case"pulse":case"retro":case"buzz":case"clang":case"metallic":return!0;default:return pht.test(n)}}return!1}function ght(t,e,n,i,r){if(!ae(e))return;const s=e.SOURCE[n];if(!ae(s)){Hi(Ge,t,"synth",`unknown voice ${n}`);return}switch(i){case"reset":case"restart":s.applyreset();return;case"vol":case"volume":pn(r)&&(s.source.synth.volume.value=r);return;case"port":case"portamento":if(pn(r))switch(s.source.type){case Nl.SYNTH:s.source.synth.portamento=r;break;case Nl.RETRO_NOISE:Hi(Ge,t,"synth","portamento for retro synth not supported");break}return;case"env":case"envelope":if(Li(r)){const[a,o,c,l]=r;s.source.synth.set({envelope:{attack:a,decay:o,sustain:c,release:l}})}return;default:if(On(i)){if(mht(i,r)){switch(i){case"retro":e.changesource(n,Nl.RETRO_NOISE);break;case"buzz":e.changesource(n,Nl.BUZZ_NOISE);break;case"clang":e.changesource(n,Nl.CLANG_NOISE);break;case"metallic":e.changesource(n,Nl.METALLIC_NOISE);break;default:e.changesource(n,Nl.SYNTH),s.source.synth.set({oscillator:{type:i}}),Li(r)&&s.source.synth.set({oscillator:{type:i,partials:r,partialCount:r.length}}),pn(r)&&s.source.synth.set({oscillator:{type:i,partials:[r],partialCount:1}});break}return}switch(s.source.type){case Nl.SYNTH:{switch(s.source.synth.get().oscillator.type){case"pwm":switch(i){case"modfreq":case"modulationfrequency":pn(r)&&s.source.synth.set({oscillator:{modulationFrequency:r}});return}break;case"pulse":switch(i){case"width":pn(r)&&s.source.synth.set({oscillator:{width:r}});return}break;case"custom":case"sine":case"square":case"triangle":case"sawtooth":switch(i){case"phase":pn(r)&&s.source.synth.set({oscillator:{phase:r}});return}break;case"amcustom":case"amsine":case"amsquare":case"amtriangle":case"amsawtooth":switch(i){case"harmonicity":pn(r)&&s.source.synth.set({oscillator:{harmonicity:r}});return;case"modtype":case"modulationtype":On(r)&&s.source.synth.set({oscillator:{modulationType:r}});return;case"modenv":case"modulationenvelope":if(Li(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fmcustom":case"fmsine":case"fmsquare":case"fmtriangle":case"fmsawtooth":switch(i){case"harmonicity":if(pn(r)){s.source.synth.set({oscillator:{harmonicity:r}});return}break;case"modindex":if(pn(r)){s.source.synth.set({oscillator:{modulationIndex:r}});return}break;case"modtype":if(On(r)){s.source.synth.set({oscillator:{modulationType:r}});return}break;case"modenv":if(Li(r)){const[o,c,l,u]=r;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:c,sustain:l,release:u}}});return}break}break;case"fatcustom":case"fatsine":case"fatsquare":case"fattriangle":case"fatsawtooth":switch(i){case"count":if(pn(r)){s.source.synth.set({oscillator:{count:r}});return}break;case"phase":if(pn(r)){s.source.synth.set({oscillator:{phase:r}});return}break;case"spread":if(pn(r)){s.source.synth.set({oscillator:{spread:r}});return}break}break}return}}Hi(Ge,t,"synth",`unknown config ${i}`)}break}}function vht(t,e,n,i,r){if(!ae(e)||n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].distortion;switch(i){case"distortion":if(pn(r)){s.set({distortion:r});return}break;case"oversample":if(On(r)){s.set({oversample:r});return}break}Hi(Ge,t,"kind",`unknown distortion ${i} or ${r}`)}function yht(t,e,n,i,r){if(!ae(e)||n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].echo;switch(i){case"delaytime":if(pn(r)){s.set({delayTime:r});return}break;case"feedback":if(pn(r)){s.set({feedback:r});return}break}Hi(Ge,t,"kind",`unknown echo ${i} or ${r}`)}function _ht(t,e,n,i,r){if(!ae(e)||n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].fcrush;switch(i){case"rate":if(pn(r)){s.set({rate:r});return}break}Hi(Ge,t,"kind",`unknown fcrush ${i} or ${r}`)}function bht(t,e,n,i,r){if(!ae(e)||n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].phaser;switch(i){case"q":if(pn(r)){s.set({Q:r});return}break;case"octaves":if(pn(r)){s.set({octaves:r});return}break;case"basefrequency":s.set({baseFrequency:r});return}Hi(Ge,t,"kind",`unknown phaser ${i} or ${r}`)}function Eht(t,e,n,i,r){if(!ae(e)||n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].reverb;switch(i){case"decay":if(pn(r)){s.set({decay:r});return}break;case"predelay":if(pn(r)){s.set({preDelay:r});return}break}Hi(Ge,t,"kind",`unknown reverb ${i} or ${r}`)}function Sht(t,e,n,i,r){if(!ae(e))return;if(n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const s=e.FX[n].vibrato;switch(i){case"maxdelay":if(pn(r)){s.set({maxDelay:r});return}break;case"depth":if(pn(r)){s.set({depth:r});return}break}Hi(Ge,t,"synth",`unknown vibrato config ${i} with ${r}`)}function Tht(t,e,n,i,r,s){if(!ae(e))return;if(n<0||n>=e.FX.length){Hi(Ge,t,"synth",`index ${n} out of bounds`);return}const a=e.FX[n][i];if(ae(a)){switch(r){case"on":a.wet.value=.2;break;case"off":a.wet.value=0;break;default:if(pn(r))a.wet.value=Er(.01*r,0,1);else switch(i){case"fc":case"fcrush":_ht(t,e,n,r,s);break;case"echo":yht(t,e,n,r,s);break;case"phaser":bht(t,e,n,r,s);break;case"reverb":Eht(t,e,n,r,s);break;case"distort":case"distortion":vht(t,e,n,r,s);break;case"vibrato":Sht(t,e,n,r,s);break}break}a instanceof z6&&(a.wet.value===0?a.set({delayTime:bG}):a.get().delayTime===bG&&a.set({delayTime:uht}));return}Hi(Ge,t,"synth",`unknown fx ${i}`)}const xht="modulepreload",wht=function(t){return"/"+t},Dne={},EG=function(e,n,i){let r=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(n.map(c=>{if(c=wht(c),c in Dne)return;Dne[c]=!0;const l=c.endsWith(".css"),u=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":xht,l||(h.as="script"),h.crossOrigin="",h.href=c,o&&h.setAttribute("nonce",o),document.head.appendChild(h),l)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return e().catch(s)})};var Cht=Object.defineProperty,Rht=(t,e,n)=>e in t?Cht(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wi=(t,e,n)=>(Rht(t,typeof e!="symbol"?e+"":e,n),n),vve=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)},tA=(t,e,n)=>(vve(t,e,"read from private field"),n?n.call(t):e.get(t)),Aht=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},Mht=(t,e,n,i)=>(vve(t,e,"write to private field"),e.set(t,n),n),T_,jH=new Intl.Collator(0,{numeric:1}).compare;function yve(t,e,n){return t=t.split("."),e=e.split("."),jH(t[0],e[0])||jH(t[1],e[1])||(e[2]=e.slice(2).join("."),n=/[.-]/.test(t[2]=t.slice(2).join(".")),n==/[.-]/.test(e[2])?jH(t[2],e[2]):n?-1:1)}const Oht="host",_ve="queue/data",Nht="queue/join",Pne="upload",Iht="login",kht="config",Dht="info",Pht="runtime",Lht="sleeptime",Uht="heartbeat",Bht="component_server",Fht="reset",zht="cancel",Hht="https://gradio-space-api-fetcher-v2.hf.space/api",bve="This application is currently busy. Please try again. ",JS="Connection errored out. ",k_="Could not resolve app config. ",jht="Could not get space status. ",Vht="Could not get API info. ",yY="Space metadata could not be loaded. ",Ght="Invalid URL. A full URL path is required.",qht="Not authorized to access this space. ",Eve="Invalid credentials. Could not login. ",$ht="Login credentials are required to access this space.",Wht="File system access is only available in Node.js environments",Sve="Root URL not found in client config",Yht="Error uploading file";function Tve(t,e,n){return e.startsWith("http://")||e.startsWith("https://")?n?t:e:t+e}async function Lne(t,e,n){try{return(await(await fetch(`https://huggingface.co/api/spaces/${t}/jwt`,{headers:{Authorization:`Bearer ${e}`,...n?{Cookie:n}:{}}})).json()).token||!1}catch{return!1}}function Xht(t){let e={};return t.forEach(({api_name:n,id:i})=>{n&&(e[n]=i)}),e}async function Kht(t){var e;const n=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(n["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&location.origin!=="http://localhost:9876"&&!window.gradio_config.dev_mode){const i=window.gradio_config.root,r=window.gradio_config;let s=Tve(t,r.root,!1);return r.root=s,{...r,path:i}}else if(t){const i=Cve(t,kht),r=await this.fetch(i,{headers:n,credentials:"include"});if((r==null?void 0:r.status)===401&&!this.options.auth)throw new Error($ht);if((r==null?void 0:r.status)===401&&this.options.auth)throw new Error(Eve);if((r==null?void 0:r.status)===200){let s=await r.json();return s.path=s.path??"",s.root=t,(e=s.dependencies)==null||e.forEach((a,o)=>{a.id===void 0&&(a.id=o)}),s}else if((r==null?void 0:r.status)===401)throw new Error(qht);throw new Error(k_)}throw new Error(k_)}async function Jht(){const{http_protocol:t,host:e}=await H6(this.app_reference,this.options.hf_token);try{if(this.options.auth){const n=await xve(t,e,this.options.auth,this.fetch,this.options.hf_token);n&&this.set_cookies(n)}}catch(n){throw Error(n.message)}}async function xve(t,e,n,i,r){const s=new FormData;s.append("username",n==null?void 0:n[0]),s.append("password",n==null?void 0:n[1]);let a={};r&&(a.Authorization=`Bearer ${r}`);const o=await i(`${t}//${e}/${Iht}`,{headers:a,method:"POST",body:s,credentials:"include"});if(o.status===200)return o.headers.get("set-cookie");throw o.status===401?new Error(Eve):new Error(yY)}function VH(t){if(t.startsWith("http")){const{protocol:e,host:n,pathname:i}=new URL(t);return{ws_protocol:e==="https:"?"wss":"ws",http_protocol:e,host:n+(i!=="/"?i:"")}}else if(t.startsWith("file:"))return{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"};return{ws_protocol:"wss",http_protocol:"https:",host:new URL(t).host}}const wve=t=>{let e=[];return t.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach(i=>{const[r,s]=i.split(";")[0].split("=");r&&s&&e.push(`${r.trim()}=${s.trim()}`)}),e},_Y=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,Zht=/.*hf\.space\/{0,1}.*$/;async function H6(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);const i=t.trim().replace(/\/$/,"");if(_Y.test(i))try{const s=(await(await fetch(`https://huggingface.co/api/spaces/${i}/${Oht}`,{headers:n})).json()).host;return{space_id:t,...VH(s)}}catch{throw new Error(yY)}if(Zht.test(i)){const{ws_protocol:r,http_protocol:s,host:a}=VH(i);return{space_id:a.split("/")[0].replace(".hf.space",""),ws_protocol:r,http_protocol:s,host:a}}return{space_id:!1,...VH(i)}}const Cve=(...t)=>{try{return t.reduce((e,n)=>(e=e.replace(/\/+$/,""),n=n.replace(/^\/+/,""),new URL(n,e+"/").toString()))}catch{throw new Error(Ght)}};function Qht(t,e,n){const i={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(t).forEach(r=>{(r==="named_endpoints"||r==="unnamed_endpoints")&&(i[r]={},Object.entries(t[r]).forEach(([s,{parameters:a,returns:o}])=>{var c,l,u,h;const d=((c=e.dependencies.find(g=>g.api_name===s||g.api_name===s.replace("/","")))==null?void 0:c.id)||n[s.replace("/","")]||-1,f=d!==-1?(l=e.dependencies.find(g=>g.id==d))==null?void 0:l.types:{generator:!1,cancel:!1};if(d!==-1&&((h=(u=e.dependencies.find(g=>g.id==d))==null?void 0:u.inputs)==null?void 0:h.length)!==a.length){const g=e.dependencies.find(_=>_.id==d).inputs.map(_=>{var v;return(v=e.components.find(E=>E.id===_))==null?void 0:v.type});try{g.forEach((_,v)=>{if(_==="state"){const E={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};a.splice(v,0,E)}})}catch(_){console.error(_)}}const p=(g,_,v,E)=>({...g,description:tdt(g==null?void 0:g.type,v),type:edt(g==null?void 0:g.type,_,v,E)||""});i[r][s]={parameters:a.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"parameter")),returns:o.map(g=>p(g,g==null?void 0:g.component,g==null?void 0:g.serializer,"return")),type:f}}))}),i}function edt(t,e,n,i){if(e==="Api")return t.type;switch(t==null?void 0:t.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}if(n==="JSONSerializable"||n==="StringSerializable")return"any";if(n==="ListStringSerializable")return"string[]";if(e==="Image")return i==="parameter"?"Blob | File | Buffer":"string";if(n==="FileSerializable")return(t==null?void 0:t.type)==="array"?i==="parameter"?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":i==="parameter"?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}";if(n==="GallerySerializable")return i==="parameter"?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]"}function tdt(t,e){return e==="GallerySerializable"?"array of [file, label] tuples":e==="ListStringSerializable"?"array of strings":e==="FileSerializable"?"array of files or single file":t==null?void 0:t.description}function GH(t,e){switch(t.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:bve,stage:"error",code:t.code,success:t.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:t.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:e||"pending",code:t.code,size:t.queue_size,position:t.rank,eta:t.rank_eta,success:t.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,progress_data:t.progress_data,success:t.success}};case"log":return{type:"log",data:t};case"process_generating":return{type:"generating",status:{queue:!0,message:t.success?null:t.output.error,stage:t.success?"generating":"error",code:t.code,progress_data:t.progress_data,eta:t.average_duration,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_streaming":return{type:"streaming",status:{queue:!0,message:t.output.error,stage:"streaming",time_limit:t.time_limit,code:t.code,progress_data:t.progress_data,eta:t.eta},data:t.output};case"process_completed":return"error"in t.output?{type:"update",status:{queue:!0,title:t.output.title,message:t.output.error,visible:t.output.visible,duration:t.output.duration,stage:"error",code:t.code,success:t.success}}:{type:"complete",status:{queue:!0,message:t.success?void 0:t.output.error,stage:t.success?"complete":"error",code:t.code,progress_data:t.progress_data,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:t.code,size:t.rank,position:0,success:t.success,eta:t.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:!0}}}const ndt=(t=[],e)=>{const n=e?e.parameters:[];if(Array.isArray(t))return t.length>n.length&&console.warn("Too many arguments provided for the endpoint."),t;const i=[],r=Object.keys(t);return n.forEach((s,a)=>{if(t.hasOwnProperty(s.parameter_name))i[a]=t[s.parameter_name];else if(s.parameter_has_default)i[a]=s.parameter_default;else throw new Error(`No value provided for required parameter: ${s.parameter_name}`)}),r.forEach(s=>{if(!n.some(a=>a.parameter_name===s))throw new Error(`Parameter \`${s}\` is not a valid keyword argument. Please refer to the API for usage.`)}),i.forEach((s,a)=>{if(s===void 0&&!n[a].parameter_has_default)throw new Error(`No value provided for required parameter: ${n[a].parameter_name}`)}),i};async function idt(){if(this.api_info)return this.api_info;const{hf_token:t}=this.options,{config:e}=this,n={"Content-Type":"application/json"};if(t&&(n.Authorization=`Bearer ${t}`),!!e)try{let i,r;if(typeof window<"u"&&window.gradio_api_info)r=window.gradio_api_info;else{if(yve((e==null?void 0:e.version)||"2.0.0","3.30")<0)i=await this.fetch(Hht,{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(e)}),headers:n,credentials:"include"});else{const s=Cve(e.root,this.api_prefix,Dht);i=await this.fetch(s,{headers:n,credentials:"include"})}if(!i.ok)throw new Error(JS);r=await i.json()}return"api"in r&&(r=r.api),r.named_endpoints["/predict"]&&!r.unnamed_endpoints[0]&&(r.unnamed_endpoints[0]=r.named_endpoints["/predict"]),Qht(r,e,this.api_map)}catch(i){""+i.message}}async function rdt(t,e,n){var i;const r={};(i=this==null?void 0:this.options)!=null&&i.hf_token&&(r.Authorization=`Bearer ${this.options.hf_token}`);const s=1e3,a=[];let o;for(let c=0;c<e.length;c+=s){const l=e.slice(c,c+s),u=new FormData;l.forEach(d=>{u.append("files",d)});try{const d=n?`${t}${this.api_prefix}/${Pne}?upload_id=${n}`:`${t}${this.api_prefix}/${Pne}`;o=await this.fetch(d,{method:"POST",body:u,headers:r,credentials:"include"})}catch(d){throw new Error(JS+d.message)}if(!o.ok){const d=await o.text();return{error:`HTTP ${o.status}: ${d}`}}const h=await o.json();h&&a.push(...h)}return{files:a}}async function sdt(t,e,n,i){let r=(Array.isArray(t)?t:[t]).map(a=>a.blob);const s=r.filter(a=>a.size>(i??1/0));if(s.length)throw new Error(`File size exceeds the maximum allowed size of ${i} bytes: ${s.map(a=>a.name).join(", ")}`);return await Promise.all(await this.upload_files(e,r,n).then(async a=>{if(a.error)throw new Error(a.error);return a.files?a.files.map((o,c)=>new bY({...t[c],path:o,url:`${e}${this.api_prefix}/file=${o}`})):[]}))}class bY{constructor({path:e,url:n,orig_name:i,size:r,blob:s,is_stream:a,mime_type:o,alt_text:c,b64:l}){Wi(this,"path"),Wi(this,"url"),Wi(this,"orig_name"),Wi(this,"size"),Wi(this,"blob"),Wi(this,"is_stream"),Wi(this,"mime_type"),Wi(this,"alt_text"),Wi(this,"b64"),Wi(this,"meta",{_type:"gradio.FileData"}),this.path=e,this.url=n,this.orig_name=i,this.size=r,this.blob=n?void 0:s,this.is_stream=a,this.mime_type=o,this.alt_text=c,this.b64=l}}class adt{constructor(e,n){Wi(this,"type"),Wi(this,"command"),Wi(this,"meta"),Wi(this,"fileData"),this.type="command",this.command=e,this.meta=n}}typeof zn<"u"&&zn.versions&&zn.versions.node;function Une(t,e,n){for(;n.length>1;){const r=n.shift();if(typeof r=="string"||typeof r=="number")t=t[r];else throw new Error("Invalid key type")}const i=n.shift();if(typeof i=="string"||typeof i=="number")t[i]=e;else throw new Error("Invalid key type")}async function SG(t,e=void 0,n=[],i=!1,r=void 0){if(Array.isArray(t)){let s=[];return await Promise.all(t.map(async(a,o)=>{var c;let l=n.slice();l.push(String(o));const u=await SG(t[o],i?((c=r==null?void 0:r.parameters[o])==null?void 0:c.component)||void 0:e,l,!1,r);s=s.concat(u)})),s}else{if(globalThis.Buffer&&t instanceof globalThis.Buffer||t instanceof Blob)return[{path:n,blob:new Blob([t]),type:e}];if(typeof t=="object"&&t!==null){let s=[];for(const a of Object.keys(t)){const o=[...n,a],c=t[a];s=s.concat(await SG(c,void 0,o,!1,r))}return s}}return[]}function odt(t,e){var n,i;let r=(i=(n=e==null?void 0:e.dependencies)==null?void 0:n.find(s=>s.id==t))==null?void 0:i.queue;return r!=null?!r:!e.enable_queue}function cdt(t,e){return new Promise((n,i)=>{const r=new MessageChannel;r.port1.onmessage=({data:s})=>{r.port1.close(),n(s)},window.parent.postMessage(t,e,[r.port2])})}function nA(t,e,n,i,r=!1){if(i==="input"&&!r)throw new Error("Invalid code path. Cannot skip state inputs for input.");if(i==="output"&&r)return t;let s=[],a=0;const o=i==="input"?e.inputs:e.outputs;for(let c=0;c<o.length;c++){const l=o[c],u=n.find(h=>h.id===l);if((u==null?void 0:u.type)==="state"){if(r)if(t.length===o.length){const h=t[a];s.push(h),a++}else s.push(null);else{a++;continue}continue}else{const h=t[a];s.push(h),a++}}return s}async function ldt(t,e,n){const i=this;await udt(i,e);const r=await SG(e,void 0,[],!0,n);return(await Promise.all(r.map(async({path:a,blob:o,type:c})=>{if(!o)return{path:a,type:c};const l=await i.upload_files(t,[o]),u=l.files&&l.files[0];return{path:a,file_url:u,type:c,name:typeof File<"u"&&o instanceof File?o==null?void 0:o.name:void 0}}))).forEach(({path:a,file_url:o,type:c,name:l})=>{if(c==="Gallery")Une(e,o,a);else if(o){const u=new bY({path:o,orig_name:l});Une(e,u,a)}}),e}async function udt(t,e){var n,i;if(!(((n=t.config)==null?void 0:n.root)||((i=t.config)==null?void 0:i.root_url)))throw new Error(Sve);await Rve(t,e)}async function Rve(t,e,n=[]){for(const i in e)e[i]instanceof adt?await hdt(t,e,i):typeof e[i]=="object"&&e[i]!==null&&await Rve(t,e[i],[...n,i])}async function hdt(t,e,n){var i,r;let s=e[n];const a=((i=t.config)==null?void 0:i.root)||((r=t.config)==null?void 0:r.root_url);if(!a)throw new Error(Sve);try{let o,c;if(typeof zn<"u"&&zn.versions&&zn.versions.node){const d=await EG(()=>Promise.resolve().then(()=>IV),void 0);c=(await EG(()=>Promise.resolve().then(()=>IV),void 0)).resolve(zn.cwd(),s.meta.path),o=await d.readFile(c)}else throw new Error(Wht);const l=new Blob([o],{type:"application/octet-stream"}),u=await t.upload_files(a,[l]),h=u.files&&u.files[0];if(h){const d=new bY({path:h,orig_name:s.meta.name||""});e[n]=d}}catch(o){console.error(Yht,o)}}async function ddt(t,e,n){const i={"Content-Type":"application/json"};this.options.hf_token&&(i.Authorization=`Bearer ${this.options.hf_token}`);try{var r=await this.fetch(t,{method:"POST",body:JSON.stringify(e),headers:{...i,...n},credentials:"include"})}catch{return[{error:JS},500]}let s,a;try{s=await r.json(),a=r.status}catch(o){s={error:`Could not parse server response: ${o}`},a=500}return[s,a]}async function fdt(t,e={}){let n=!1,i=!1;if(!this.config)throw new Error("Could not resolve app config");if(typeof t=="number")this.config.dependencies.find(r=>r.id==t);else{const r=t.replace(/^\//,"");this.config.dependencies.find(s=>s.id==this.api_map[r])}return new Promise(async(r,s)=>{const a=this.submit(t,e,null,null,!0);let o;for await(const c of a)c.type==="data"&&(i&&r(o),n=!0,o=c),c.type==="status"&&(c.stage==="error"&&s(c),c.stage==="complete"&&(i=!0,n&&r(o)))})}async function sM(t,e,n){let i=e==="subdomain"?`https://huggingface.co/api/spaces/by-subdomain/${t}`:`https://huggingface.co/api/spaces/${t}`,r,s;try{if(r=await fetch(i),s=r.status,s!==200)throw new Error;r=await r.json()}catch{n({status:"error",load_status:"error",message:jht,detail:"NOT_FOUND"});return}if(!r||s!==200)return;const{runtime:{stage:a},id:o}=r;switch(a){case"STOPPED":case"SLEEPING":n({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:a}),setTimeout(()=>{sM(t,e,n)},1e3);break;case"PAUSED":n({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:a,discussions_enabled:await Bne(o)});break;case"RUNNING":case"RUNNING_BUILDING":n({status:"running",load_status:"complete",message:"Space is running.",detail:a});break;case"BUILDING":n({status:"building",load_status:"pending",message:"Space is building...",detail:a}),setTimeout(()=>{sM(t,e,n)},1e3);break;case"APP_STARTING":n({status:"starting",load_status:"pending",message:"Space is starting...",detail:a}),setTimeout(()=>{sM(t,e,n)},1e3);break;default:n({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:a,discussions_enabled:await Bne(o)});break}}const Ave=async(t,e)=>{let n=0;const i=12,r=5e3;return new Promise(s=>{sM(t,_Y.test(t)?"space_name":"subdomain",a=>{e(a),a.status==="running"||a.status==="error"||a.status==="paused"||a.status==="space_error"?s():(a.status==="sleeping"||a.status==="building")&&(n<i?(n++,setTimeout(()=>{Ave(t,e).then(s)},r)):s())})})},pdt=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function Bne(t){try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/discussions`,{method:"HEAD"}),n=e.headers.get("x-error-message");return!(!e.ok||n&&pdt.test(n))}catch{return!1}}async function mdt(t,e){const n={};e&&(n.Authorization=`Bearer ${e}`);try{const i=await fetch(`https://huggingface.co/api/spaces/${t}/${Pht}`,{headers:n});if(i.status!==200)throw new Error("Space hardware could not be obtained.");const{hardware:r}=await i.json();return r.current}catch(i){throw new Error(i.message)}}async function gdt(t,e,n){const i={};n&&(i.Authorization=`Bearer ${n}`);const r={seconds:e};try{const s=await fetch(`https://huggingface.co/api/spaces/${t}/${Lht}`,{method:"POST",headers:{"Content-Type":"application/json",...i},body:JSON.stringify(r)});if(s.status!==200)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await s.json()}catch(s){throw new Error(s.message)}}const Fne=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function vdt(t,e){const{hf_token:n,private:i,hardware:r,timeout:s,auth:a}=e;if(r&&!Fne.includes(r))throw new Error(`Invalid hardware type provided. Valid types are: ${Fne.map(_=>`"${_}"`).join(",")}.`);const{http_protocol:o,host:c}=await H6(t,n);let l=null;if(a){const _=await xve(o,c,a,fetch);_&&(l=wve(_))}const u={Authorization:`Bearer ${n}`,"Content-Type":"application/json",...l?{Cookie:l.join("; ")}:{}},h=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:u})).json()).name,d=t.split("/")[1],f={repository:`${h}/${d}`};i&&(f.private=!0);let p;try{r||(p=await mdt(t,n))}catch(_){throw Error(yY+_.message)}const g=r||p||"cpu-basic";f.hardware=g;try{const _=await fetch(`https://huggingface.co/api/spaces/${t}/duplicate`,{method:"POST",headers:u,body:JSON.stringify(f)});if(_.status===409)try{return await TG.connect(`${h}/${d}`,e)}catch(E){throw console.error("Failed to connect Client instance:",E),E}else if(_.status!==200)throw new Error(_.statusText);const v=await _.json();return await gdt(`${h}/${d}`,s||300,n),await TG.connect(ydt(v.url),e)}catch(_){throw new Error(_)}}function ydt(t){const e=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,n=t.match(e);if(n)return n[1]}class _dt extends TransformStream{constructor(e={allowCR:!1}){super({transform:(n,i)=>{for(n=tA(this,T_)+n;;){const r=n.indexOf(`
`),s=e.allowCR?n.indexOf("\r"):-1;if(s!==-1&&s!==n.length-1&&(r===-1||r-1>s)){i.enqueue(n.slice(0,s)),n=n.slice(s+1);continue}if(r===-1)break;const a=n[r-1]==="\r"?r-1:r;i.enqueue(n.slice(0,a)),n=n.slice(r+1)}Mht(this,T_,n)},flush:n=>{if(tA(this,T_)==="")return;const i=e.allowCR&&tA(this,T_).endsWith("\r")?tA(this,T_).slice(0,-1):tA(this,T_);n.enqueue(i)}}),Aht(this,T_,"")}}T_=new WeakMap;function bdt(t){let e=new TextDecoderStream,n=new _dt({allowCR:!0});return t.pipeThrough(e).pipeThrough(n)}function Edt(t){let n=/[:]\s*/.exec(t),i=n&&n.index;if(i)return[t.substring(0,i),t.substring(i+n[0].length)]}function zne(t,e,n){t.get(e)||t.set(e,n)}async function*Sdt(t,e){if(!t.body)return;let n=bdt(t.body),i,r=n.getReader(),s;for(;;){if(e&&e.aborted)return r.cancel();if(i=await r.read(),i.done)return;if(!i.value){s&&(yield s),s=void 0;continue}let[a,o]=Edt(i.value)||[];a&&(a==="data"?(s||(s={}),s[a]=s[a]?s[a]+`
`+o:o):a==="event"?(s||(s={}),s[a]=o):a==="id"?(s||(s={}),s[a]=+o||o):a==="retry"&&(s||(s={}),s[a]=+o||void 0))}}async function Tdt(t,e){let n=new Request(t,e);zne(n.headers,"Accept","text/event-stream"),zne(n.headers,"Content-Type","application/json");let i=await fetch(n);if(!i.ok)throw i;return Sdt(i,n.signal)}async function xdt(){let{event_callbacks:t,unclosed_events:e,pending_stream_messages:n,stream_status:i,config:r,jwt:s}=this;const a=this;if(!r)throw new Error("Could not resolve app config");i.open=!0;let o=null,c=new URLSearchParams({session_hash:this.session_hash}).toString(),l=new URL(`${r.root}${this.api_prefix}/${_ve}?${c}`);if(s&&l.searchParams.set("__sign",s),o=this.stream(l),!o){console.warn("Cannot connect to SSE endpoint: "+l.toString());return}o.onmessage=async function(u){let h=JSON.parse(u.data);if(h.msg==="close_stream"){AU(i,a.abort_controller);return}const d=h.event_id;if(!d)await Promise.all(Object.keys(t).map(f=>t[f](h)));else if(t[d]&&r){h.msg==="process_completed"&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(r.protocol)&&e.delete(d);let f=t[d];typeof window<"u"&&typeof document<"u"?setTimeout(f,0,h):f(h)}else n[d]||(n[d]=[]),n[d].push(h)},o.onerror=async function(){await Promise.all(Object.keys(t).map(u=>t[u]({msg:"unexpected_error",message:JS})))}}function AU(t,e){t&&(t.open=!1,e==null||e.abort())}function wdt(t,e,n){!t[e]?(t[e]=[],n.data.forEach((r,s)=>{t[e][s]=r})):n.data.forEach((r,s)=>{let a=Cdt(t[e][s],r);t[e][s]=a,n.data[s]=a})}function Cdt(t,e){return e.forEach(([n,i,r])=>{t=Rdt(t,i,n,r)}),t}function Rdt(t,e,n,i){if(e.length===0){if(n==="replace")return i;if(n==="append")return t+i;throw new Error(`Unsupported action: ${n}`)}let r=t;for(let a=0;a<e.length-1;a++)r=r[e[a]];const s=e[e.length-1];switch(n){case"replace":r[s]=i;break;case"append":r[s]+=i;break;case"add":Array.isArray(r)?r.splice(Number(s),0,i):r[s]=i;break;case"delete":Array.isArray(r)?r.splice(Number(s),1):delete r[s];break;default:throw new Error(`Unknown action: ${n}`)}return t}function Adt(t,e={}){const n={close:()=>{console.warn("Method not implemented.")},onerror:null,onmessage:null,onopen:null,readyState:0,url:t.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return Tdt(t,e).then(async i=>{n.readyState=n.OPEN;try{for await(const r of i)n.onmessage&&n.onmessage(r);n.readyState=n.CLOSED}catch(r){n.onerror&&n.onerror(r),n.readyState=n.CLOSED}}).catch(i=>{console.error(i),n.onerror&&n.onerror(i),n.readyState=n.CLOSED}),n}function Mdt(t,e={},n,i,r){var s;try{let a=function(Fe){(r||Ce[Fe.type])&&u(Fe)},o=function(){for(Ee=!0;et.length>0;)et.shift()({value:void 0,done:!0})},c=function(Fe){Ee||(et.length>0?et.shift()(Fe):ye.push(Fe))},l=function(Fe){c(Odt(Fe)),o()},u=function(Fe){c({value:Fe,done:!1})},h=function(){return ye.length>0?Promise.resolve(ye.shift()):Ee?Promise.resolve({value:void 0,done:!0}):new Promise(Fe=>et.push(Fe))};const{hf_token:d}=this.options,{fetch:f,app_reference:p,config:g,session_hash:_,api_info:v,api_map:E,stream_status:T,pending_stream_messages:x,pending_diff_streams:N,event_callbacks:A,unclosed_events:I,post_data:k,options:L,api_prefix:U}=this,$=this;if(!v)throw new Error("No API found");if(!g)throw new Error("Could not resolve app config");let{fn_index:q,endpoint_info:G,dependency:X}=Ndt(v,t,E,g),ie=ndt(e,G),V,Z,Y=g.protocol??"ws",ee="",oe=()=>ee;const de=typeof t=="number"?"/predict":t;let Me,He=null,Te=!1,Le={},we=typeof window<"u"&&typeof document<"u"?new URLSearchParams(window.location.search).toString():"";const Ce=((s=L==null?void 0:L.events)==null?void 0:s.reduce((Fe,Ie)=>(Fe[Ie]=!0,Fe),{}))||{};async function ke(){const Fe={stage:"complete",queue:!1,time:new Date};Te=Fe,a({...Fe,type:"status",endpoint:de,fn_index:q});let Ie={},it={};Y==="ws"?(V&&V.readyState===0?V.addEventListener("open",()=>{V.close()}):V.close(),Ie={fn_index:q,session_hash:_}):(AU(T,$.abort_controller),o(),Ie={event_id:He},it={event_id:He,session_hash:_,fn_index:q});try{if(!g)throw new Error("Could not resolve app config");"event_id"in it&&await f(`${g.root}${U}/${zht}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(it)}),await f(`${g.root}${U}/${Fht}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(Ie)})}catch{console.warn("The `/reset` endpoint could not be called. Subsequent endpoint results may be unreliable.")}}const St=async Fe=>{await this._resolve_hearbeat(Fe)};async function At(Fe){if(!g)return;let Ie=Fe.render_id;g.components=[...g.components.filter(gt=>gt.props.rendered_in!==Ie),...Fe.components],g.dependencies=[...g.dependencies.filter(gt=>gt.rendered_in!==Ie),...Fe.dependencies];const it=g.components.some(gt=>gt.type==="state"),dt=g.dependencies.some(gt=>gt.targets.some(bt=>bt[1]==="unload"));g.connect_heartbeat=it||dt,await St(g),a({type:"render",data:Fe,endpoint:de,fn_index:q})}this.handle_blob(g.root,ie,G).then(async Fe=>{var Ie;if(Me={data:nA(Fe,X,g.components,"input",!0)||[],event_data:n,fn_index:q,trigger_id:i},odt(q,g))a({type:"status",endpoint:de,stage:"pending",queue:!1,fn_index:q,time:new Date}),k(`${g.root}${U}/run${de.startsWith("/")?de:`/${de}`}${we?"?"+we:""}`,{...Me,session_hash:_}).then(([gt,bt])=>{const be=gt.data;bt==200?(a({type:"data",endpoint:de,fn_index:q,data:nA(be,X,g.components,"output",L.with_null_state),time:new Date,event_data:n,trigger_id:i}),gt.render_config&&At(gt.render_config),a({type:"status",endpoint:de,fn_index:q,stage:"complete",eta:gt.average_duration,queue:!1,time:new Date})):a({type:"status",stage:"error",endpoint:de,fn_index:q,message:gt.error,queue:!1,time:new Date})}).catch(gt=>{a({type:"status",stage:"error",message:gt.message,endpoint:de,fn_index:q,queue:!1,time:new Date})});else if(Y=="ws"){const{ws_protocol:gt,host:bt}=await H6(p,d);a({type:"status",stage:"pending",queue:!0,endpoint:de,fn_index:q,time:new Date});let be=new URL(`${gt}://${Tve(bt,g.path,!0)}/queue/join${we?"?"+we:""}`);this.jwt&&be.searchParams.set("__sign",this.jwt),V=new WebSocket(be),V.onclose=ue=>{ue.wasClean||a({type:"status",stage:"error",broken:!0,message:JS,queue:!0,endpoint:de,fn_index:q,time:new Date})},V.onmessage=function(ue){const Xe=JSON.parse(ue.data),{type:nt,status:$e,data:Ue}=GH(Xe,Le[q]);if(nt==="update"&&$e&&!Te)a({type:"status",endpoint:de,fn_index:q,time:new Date,...$e}),$e.stage==="error"&&V.close();else if(nt==="hash"){V.send(JSON.stringify({fn_index:q,session_hash:_}));return}else nt==="data"?V.send(JSON.stringify({...Me,session_hash:_})):nt==="complete"?Te=$e:nt==="log"?a({type:"log",title:Ue.title,log:Ue.log,level:Ue.level,endpoint:de,duration:Ue.duration,visible:Ue.visible,fn_index:q}):nt==="generating"&&a({type:"status",time:new Date,...$e,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:de,fn_index:q});Ue&&(a({type:"data",time:new Date,data:nA(Ue.data,X,g.components,"output",L.with_null_state),endpoint:de,fn_index:q,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:$e==null?void 0:$e.stage,queue:!0,endpoint:de,fn_index:q}),V.close()))},yve(g.version||"2.0.0","3.6")<0&&addEventListener("open",()=>V.send(JSON.stringify({hash:_})))}else if(Y=="sse"){a({type:"status",stage:"pending",queue:!0,endpoint:de,fn_index:q,time:new Date});var dt=new URLSearchParams({fn_index:q.toString(),session_hash:_}).toString();let gt=new URL(`${g.root}${U}/${_ve}?${we?we+"&":""}${dt}`);if(this.jwt&&gt.searchParams.set("__sign",this.jwt),Z=this.stream(gt),!Z)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+gt.toString()));Z.onmessage=async function(bt){const be=JSON.parse(bt.data),{type:ue,status:Xe,data:nt}=GH(be,Le[q]);if(ue==="update"&&Xe&&!Te)a({type:"status",endpoint:de,fn_index:q,time:new Date,...Xe}),Xe.stage==="error"&&(Z==null||Z.close(),o());else if(ue==="data"){let[$e,Ue]=await k(`${g.root}${U}/queue/data`,{...Me,session_hash:_,event_id:He});Ue!==200&&(a({type:"status",stage:"error",message:JS,queue:!0,endpoint:de,fn_index:q,time:new Date}),Z==null||Z.close(),o())}else ue==="complete"?Te=Xe:ue==="log"?a({type:"log",title:nt.title,log:nt.log,level:nt.level,endpoint:de,duration:nt.duration,visible:nt.visible,fn_index:q}):(ue==="generating"||ue==="streaming")&&a({type:"status",time:new Date,...Xe,stage:Xe==null?void 0:Xe.stage,queue:!0,endpoint:de,fn_index:q});nt&&(a({type:"data",time:new Date,data:nA(nt.data,X,g.components,"output",L.with_null_state),endpoint:de,fn_index:q,event_data:n,trigger_id:i}),Te&&(a({type:"status",time:new Date,...Te,stage:Xe==null?void 0:Xe.stage,queue:!0,endpoint:de,fn_index:q}),Z==null||Z.close(),o()))}}else if(Y=="sse_v1"||Y=="sse_v2"||Y=="sse_v2.1"||Y=="sse_v3"){a({type:"status",stage:"pending",queue:!0,endpoint:de,fn_index:q,time:new Date});let gt="";typeof window<"u"&&typeof document<"u"&&(gt=(Ie=window==null?void 0:window.location)==null?void 0:Ie.hostname);const be=gt.includes(".dev.")?`https://moon-${gt.split(".")[1]}.dev.spaces.huggingface.tech`:"https://huggingface.co";(typeof window<"u"&&typeof document<"u"&&window.parent!=window&&window.supports_zerogpu_headers?cdt("zerogpu-headers",be):Promise.resolve(null)).then($e=>k(`${g.root}${U}/${Nht}?${we}`,{...Me,session_hash:_},$e)).then(async([$e,Ue])=>{if(Ue===503)a({type:"status",stage:"error",message:bve,queue:!0,endpoint:de,fn_index:q,time:new Date});else if(Ue!==200)a({type:"status",stage:"error",message:JS,queue:!0,endpoint:de,fn_index:q,time:new Date});else{He=$e.event_id,ee=He;let qt=async function(Mt){try{const{type:Yt,status:ce,data:j,original_msg:W}=GH(Mt,Le[q]);if(Yt=="heartbeat")return;if(Yt==="update"&&ce&&!Te)a({type:"status",endpoint:de,fn_index:q,time:new Date,original_msg:W,...ce});else if(Yt==="complete")Te=ce;else if(Yt=="unexpected_error")console.error("Unexpected error",ce==null?void 0:ce.message),a({type:"status",stage:"error",message:(ce==null?void 0:ce.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:de,fn_index:q,time:new Date});else if(Yt==="log"){a({type:"log",title:j.title,log:j.log,level:j.level,endpoint:de,duration:j.duration,visible:j.visible,fn_index:q});return}else(Yt==="generating"||Yt==="streaming")&&(a({type:"status",time:new Date,...ce,stage:ce==null?void 0:ce.stage,queue:!0,endpoint:de,fn_index:q}),j&&X.connection!=="stream"&&["sse_v2","sse_v2.1","sse_v3"].includes(Y)&&wdt(N,He,j));j&&(a({type:"data",time:new Date,data:nA(j.data,X,g.components,"output",L.with_null_state),endpoint:de,fn_index:q}),j.render_config&&await At(j.render_config),Te&&(a({type:"status",time:new Date,...Te,stage:ce==null?void 0:ce.stage,queue:!0,endpoint:de,fn_index:q}),o())),((ce==null?void 0:ce.stage)==="complete"||(ce==null?void 0:ce.stage)==="error")&&(A[He]&&delete A[He],He in N&&delete N[He])}catch(Yt){console.error("Unexpected client exception",Yt),a({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:de,fn_index:q,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(Y)&&(AU(T,$.abort_controller),T.open=!1,o())}};He in x&&(x[He].forEach(Mt=>qt(Mt)),delete x[He]),A[He]=qt,I.add(He),T.open||await this.open_stream()}})}});let Ee=!1;const ye=[],et=[],fe={[Symbol.asyncIterator]:()=>fe,next:h,throw:async Fe=>(l(Fe),h()),return:async()=>(o(),h()),cancel:ke,event_id:oe};return fe}catch(a){throw console.error("Submit function encountered an error:",a),a}}function Odt(t){return{then:(e,n)=>n(t)}}function Ndt(t,e,n,i){let r,s,a;if(typeof e=="number")r=e,s=t.unnamed_endpoints[r],a=i.dependencies.find(o=>o.id==e);else{const o=e.replace(/^\//,"");r=n[o],s=t.named_endpoints[e.trim()],a=i.dependencies.find(c=>c.id==n[o])}if(typeof r!="number")throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:r,endpoint_info:s,dependency:a}}class TG{constructor(e,n={events:["data"]}){Wi(this,"app_reference"),Wi(this,"options"),Wi(this,"config"),Wi(this,"api_prefix",""),Wi(this,"api_info"),Wi(this,"api_map",{}),Wi(this,"session_hash",Math.random().toString(36).substring(2)),Wi(this,"jwt",!1),Wi(this,"last_status",{}),Wi(this,"cookies",null),Wi(this,"stream_status",{open:!1}),Wi(this,"pending_stream_messages",{}),Wi(this,"pending_diff_streams",{}),Wi(this,"event_callbacks",{}),Wi(this,"unclosed_events",new Set),Wi(this,"heartbeat_event",null),Wi(this,"abort_controller",null),Wi(this,"stream_instance",null),Wi(this,"current_payload"),Wi(this,"ws_map",{}),Wi(this,"view_api"),Wi(this,"upload_files"),Wi(this,"upload"),Wi(this,"handle_blob"),Wi(this,"post_data"),Wi(this,"submit"),Wi(this,"predict"),Wi(this,"open_stream"),Wi(this,"resolve_config"),Wi(this,"resolve_cookies"),this.app_reference=e,n.events||(n.events=["data"]),this.options=n,this.current_payload={},this.view_api=idt.bind(this),this.upload_files=rdt.bind(this),this.handle_blob=ldt.bind(this),this.post_data=ddt.bind(this),this.submit=Mdt.bind(this),this.predict=fdt.bind(this),this.open_stream=xdt.bind(this),this.resolve_config=Kht.bind(this),this.resolve_cookies=Jht.bind(this),this.upload=sdt.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}get_url_config(e=null){if(!this.config)throw new Error(k_);e===null&&(e=window.location.href);const n=a=>a.replace(/^\/+|\/+$/g,"");let i=n(new URL(this.config.root).pathname),r=n(new URL(e).pathname),s;return r.startsWith(i)?s=n(r.substring(i.length)):s="",this.get_page_config(s)}get_page_config(e){if(!this.config)throw new Error(k_);let n=this.config;return e in n.page||(e=""),{...n,current_page:e,layout:n.page[e].layout,components:n.components.filter(i=>n.page[e].components.includes(i.id)),dependencies:this.config.dependencies.filter(i=>n.page[e].dependencies.includes(i.id))}}fetch(e,n){const i=new Headers((n==null?void 0:n.headers)||{});if(this&&this.cookies&&i.append("Cookie",this.cookies),this&&this.options.headers)for(const r in this.options.headers)i.append(r,this.options.headers[r]);return fetch(e,{...n,headers:i})}stream(e){const n=new Headers;if(this&&this.cookies&&n.append("Cookie",this.cookies),this&&this.options.headers)for(const i in this.options.headers)n.append(i,this.options.headers[i]);return this.abort_controller=new AbortController,this.stream_instance=Adt(e.toString(),{credentials:"include",headers:n,signal:this.abort_controller.signal}),this.stream_instance}async init(){var e;if((typeof window>"u"||!("WebSocket"in window))&&!Xp.WebSocket){const n=await EG(()=>import("./wrapper-CviSselG-9y2zt4I0.js"),[]);Xp.WebSocket=n.WebSocket}this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then(({config:n})=>this._resolve_hearbeat(n)),this.api_info=await this.view_api(),this.api_map=Xht(((e=this.config)==null?void 0:e.dependencies)||[])}async _resolve_hearbeat(e){if(e&&(this.config=e,this.api_prefix=e.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.hf_token&&(this.jwt=await Lne(this.config.space_id,this.options.hf_token,this.cookies))),e.space_id&&this.options.hf_token&&(this.jwt=await Lne(e.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const n=new URL(`${this.config.root}${this.api_prefix}/${Uht}/${this.session_hash}`);this.jwt&&n.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(n))}}static async connect(e,n={events:["data"]}){const i=new this(e,n);return await i.init(),i}close(){AU(this.stream_status,this.abort_controller)}set_current_payload(e){this.current_payload=e}static async duplicate(e,n={events:["data"]}){return vdt(e,n)}async _resolve_config(){const{http_protocol:e,host:n,space_id:i}=await H6(this.app_reference,this.options.hf_token),{status_callback:r}=this.options;i&&r&&await Ave(i,r);let s;try{if(s=await this.resolve_config(`${e}//${n}`),!s)throw new Error(k_);return this.config_success(s)}catch(a){if(i&&r)sM(i,_Y.test(i)?"space_name":"subdomain",this.handle_space_success);else throw r&&r({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(a)}}async config_success(e){if(this.config=e,this.api_prefix=e.api_prefix||"",typeof window<"u"&&typeof document<"u"&&window.location.protocol==="https:"&&(this.config.root=this.config.root.replace("http://","https://")),this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(n){console.error(Vht+n.message)}return this.prepare_return_obj()}async handle_space_success(e){var n;if(!this)throw new Error(k_);const{status_callback:i}=this.options;if(i&&i(e),e.status==="running")try{if(this.config=await this._resolve_config(),this.api_prefix=((n=this==null?void 0:this.config)==null?void 0:n.api_prefix)||"",!this.config)throw new Error(k_);return await this.config_success(this.config)}catch(r){throw i&&i({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),r}}async component_server(e,n,i){var r;if(!this.config)throw new Error(k_);const s={},{hf_token:a}=this.options,{session_hash:o}=this;a&&(s.Authorization=`Bearer ${this.options.hf_token}`);let c,l=this.config.components.find(h=>h.id===e);(r=l==null?void 0:l.props)!=null&&r.root_url?c=l.props.root_url:c=this.config.root;let u;if("binary"in i){u=new FormData;for(const h in i.data)h!=="binary"&&u.append(h,i.data[h]);u.set("component_id",e.toString()),u.set("fn_name",n),u.set("session_hash",o)}else u=JSON.stringify({data:i,component_id:e,fn_name:n,session_hash:o}),s["Content-Type"]="application/json";a&&(s.Authorization=`Bearer ${a}`);try{const h=await this.fetch(`${c}${this.api_prefix}/${Bht}/`,{method:"POST",body:u,headers:s,credentials:"include"});if(!h.ok)throw new Error("Could not connect to component server: "+h.statusText);return await h.json()}catch(h){console.warn(h)}}set_cookies(e){this.cookies=wve(e).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}async connect_ws(e){return new Promise((n,i)=>{let r;try{r=new WebSocket(e)}catch{this.ws_map[e]="failed";return}r.onopen=()=>{n()},r.onerror=s=>{console.error("WebSocket error:",s),this.close_ws(e),this.ws_map[e]="failed",n()},r.onclose=()=>{delete this.ws_map[e],this.ws_map[e]="failed"},r.onmessage=s=>{},this.ws_map[e]=r})}async send_ws_message(e,n){e in this.ws_map||await this.connect_ws(e);const i=this.ws_map[e];i instanceof WebSocket?i.send(JSON.stringify(n)):this.post_data(e,n)}async close_ws(e){if(e in this.ws_map){const n=this.ws_map[e];n instanceof WebSocket&&(n.close(),delete this.ws_map[e])}}}function DT(t){"@babel/helpers - typeof";return DT=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DT(t)}function Ud(){Ud=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,r=Object.defineProperty||function(V,Z,Y){V[Z]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function l(V,Z,Y){return Object.defineProperty(V,Z,{value:Y,enumerable:!0,configurable:!0,writable:!0}),V[Z]}try{l({},"")}catch{l=function(Y,ee,oe){return Y[ee]=oe}}function u(V,Z,Y,ee){var oe=Z&&Z.prototype instanceof v?Z:v,de=Object.create(oe.prototype),Me=new X(ee||[]);return r(de,"_invoke",{value:U(V,Y,Me)}),de}function h(V,Z,Y){try{return{type:"normal",arg:V.call(Z,Y)}}catch(ee){return{type:"throw",arg:ee}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",p="executing",g="completed",_={};function v(){}function E(){}function T(){}var x={};l(x,a,function(){return this});var N=Object.getPrototypeOf,A=N&&N(N(ie([])));A&&A!==n&&i.call(A,a)&&(x=A);var I=T.prototype=v.prototype=Object.create(x);function k(V){["next","throw","return"].forEach(function(Z){l(V,Z,function(Y){return this._invoke(Z,Y)})})}function L(V,Z){function Y(oe,de,Me,He){var Te=h(V[oe],V,de);if(Te.type!=="throw"){var Le=Te.arg,we=Le.value;return we&&DT(we)=="object"&&i.call(we,"__await")?Z.resolve(we.__await).then(function(Ce){Y("next",Ce,Me,He)},function(Ce){Y("throw",Ce,Me,He)}):Z.resolve(we).then(function(Ce){Le.value=Ce,Me(Le)},function(Ce){return Y("throw",Ce,Me,He)})}He(Te.arg)}var ee;r(this,"_invoke",{value:function(de,Me){function He(){return new Z(function(Te,Le){Y(de,Me,Te,Le)})}return ee=ee?ee.then(He,He):He()}})}function U(V,Z,Y){var ee=d;return function(oe,de){if(ee===p)throw Error("Generator is already running");if(ee===g){if(oe==="throw")throw de;return{value:t,done:!0}}for(Y.method=oe,Y.arg=de;;){var Me=Y.delegate;if(Me){var He=$(Me,Y);if(He){if(He===_)continue;return He}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ee===d)throw ee=g,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ee=p;var Te=h(V,Z,Y);if(Te.type==="normal"){if(ee=Y.done?g:f,Te.arg===_)continue;return{value:Te.arg,done:Y.done}}Te.type==="throw"&&(ee=g,Y.method="throw",Y.arg=Te.arg)}}}function $(V,Z){var Y=Z.method,ee=V.iterator[Y];if(ee===t)return Z.delegate=null,Y==="throw"&&V.iterator.return&&(Z.method="return",Z.arg=t,$(V,Z),Z.method==="throw")||Y!=="return"&&(Z.method="throw",Z.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),_;var oe=h(ee,V.iterator,Z.arg);if(oe.type==="throw")return Z.method="throw",Z.arg=oe.arg,Z.delegate=null,_;var de=oe.arg;return de?de.done?(Z[V.resultName]=de.value,Z.next=V.nextLoc,Z.method!=="return"&&(Z.method="next",Z.arg=t),Z.delegate=null,_):de:(Z.method="throw",Z.arg=new TypeError("iterator result is not an object"),Z.delegate=null,_)}function q(V){var Z={tryLoc:V[0]};1 in V&&(Z.catchLoc=V[1]),2 in V&&(Z.finallyLoc=V[2],Z.afterLoc=V[3]),this.tryEntries.push(Z)}function G(V){var Z=V.completion||{};Z.type="normal",delete Z.arg,V.completion=Z}function X(V){this.tryEntries=[{tryLoc:"root"}],V.forEach(q,this),this.reset(!0)}function ie(V){if(V||V===""){var Z=V[a];if(Z)return Z.call(V);if(typeof V.next=="function")return V;if(!isNaN(V.length)){var Y=-1,ee=function oe(){for(;++Y<V.length;)if(i.call(V,Y))return oe.value=V[Y],oe.done=!1,oe;return oe.value=t,oe.done=!0,oe};return ee.next=ee}}throw new TypeError(DT(V)+" is not iterable")}return E.prototype=T,r(I,"constructor",{value:T,configurable:!0}),r(T,"constructor",{value:E,configurable:!0}),E.displayName=l(T,c,"GeneratorFunction"),e.isGeneratorFunction=function(V){var Z=typeof V=="function"&&V.constructor;return!!Z&&(Z===E||(Z.displayName||Z.name)==="GeneratorFunction")},e.mark=function(V){return Object.setPrototypeOf?Object.setPrototypeOf(V,T):(V.__proto__=T,l(V,c,"GeneratorFunction")),V.prototype=Object.create(I),V},e.awrap=function(V){return{__await:V}},k(L.prototype),l(L.prototype,o,function(){return this}),e.AsyncIterator=L,e.async=function(V,Z,Y,ee,oe){oe===void 0&&(oe=Promise);var de=new L(u(V,Z,Y,ee),oe);return e.isGeneratorFunction(Z)?de:de.next().then(function(Me){return Me.done?Me.value:de.next()})},k(I),l(I,c,"Generator"),l(I,a,function(){return this}),l(I,"toString",function(){return"[object Generator]"}),e.keys=function(V){var Z=Object(V),Y=[];for(var ee in Z)Y.push(ee);return Y.reverse(),function oe(){for(;Y.length;){var de=Y.pop();if(de in Z)return oe.value=de,oe.done=!1,oe}return oe.done=!0,oe}},e.values=ie,X.prototype={constructor:X,reset:function(Z){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(G),!Z)for(var Y in this)Y.charAt(0)==="t"&&i.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=t)},stop:function(){this.done=!0;var Z=this.tryEntries[0].completion;if(Z.type==="throw")throw Z.arg;return this.rval},dispatchException:function(Z){if(this.done)throw Z;var Y=this;function ee(Le,we){return Me.type="throw",Me.arg=Z,Y.next=Le,we&&(Y.method="next",Y.arg=t),!!we}for(var oe=this.tryEntries.length-1;oe>=0;--oe){var de=this.tryEntries[oe],Me=de.completion;if(de.tryLoc==="root")return ee("end");if(de.tryLoc<=this.prev){var He=i.call(de,"catchLoc"),Te=i.call(de,"finallyLoc");if(He&&Te){if(this.prev<de.catchLoc)return ee(de.catchLoc,!0);if(this.prev<de.finallyLoc)return ee(de.finallyLoc)}else if(He){if(this.prev<de.catchLoc)return ee(de.catchLoc,!0)}else{if(!Te)throw Error("try statement without catch or finally");if(this.prev<de.finallyLoc)return ee(de.finallyLoc)}}}},abrupt:function(Z,Y){for(var ee=this.tryEntries.length-1;ee>=0;--ee){var oe=this.tryEntries[ee];if(oe.tryLoc<=this.prev&&i.call(oe,"finallyLoc")&&this.prev<oe.finallyLoc){var de=oe;break}}de&&(Z==="break"||Z==="continue")&&de.tryLoc<=Y&&Y<=de.finallyLoc&&(de=null);var Me=de?de.completion:{};return Me.type=Z,Me.arg=Y,de?(this.method="next",this.next=de.finallyLoc,_):this.complete(Me)},complete:function(Z,Y){if(Z.type==="throw")throw Z.arg;return Z.type==="break"||Z.type==="continue"?this.next=Z.arg:Z.type==="return"?(this.rval=this.arg=Z.arg,this.method="return",this.next="end"):Z.type==="normal"&&Y&&(this.next=Y),_},finish:function(Z){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ee=this.tryEntries[Y];if(ee.finallyLoc===Z)return this.complete(ee.completion,ee.afterLoc),G(ee),_}},catch:function(Z){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ee=this.tryEntries[Y];if(ee.tryLoc===Z){var oe=ee.completion;if(oe.type==="throw"){var de=oe.arg;G(ee)}return de}}throw Error("illegal catch attempt")},delegateYield:function(Z,Y,ee){return this.delegate={iterator:ie(Z),resultName:Y,nextLoc:ee},this.method==="next"&&(this.arg=t),_}},e}function Hne(t,e,n,i,r,s,a){try{var o=t[s](a),c=o.value}catch(l){return void n(l)}o.done?e(c):Promise.resolve(c).then(i,r)}function ww(t){return function(){var e=this,n=arguments;return new Promise(function(i,r){var s=t.apply(e,n);function a(c){Hne(s,i,r,a,o,"next",c)}function o(c){Hne(s,i,r,a,o,"throw",c)}a(void 0)})}}function Idt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kdt(t,e){if(DT(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(DT(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mve(t){var e=kdt(t,"string");return DT(e)=="symbol"?e:e+""}function Ddt(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,Mve(i.key),i)}}function Pdt(t,e,n){return e&&Ddt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function lg(t,e,n){return(e=Mve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const xP={"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-KatjaNeural","de-DE-KillianNeural"],"en-US":["en-US-AriaNeural","en-US-AnaNeural","en-US-ChristopherNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"ko-KR":["ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-YunJheNeural","zh-TW-HsiaoYuNeural"]},wP={"ar-SA-HamedNeural":"","ar-SA-ZariyahNeural":"","de-DE-AmalaNeural":"Amala","de-DE-BerndNeural":"Bernd","de-DE-ChristophNeural":"Christoph","de-DE-ConradNeural":"Conrad","de-DE-ElkeNeural":"Elke","de-DE-GiselaNeural":"Gisela","de-DE-KasperNeural":"Kasper","de-DE-KatjaNeural":"Katja","de-DE-KillianNeural":"Killian","de-DE-KlarissaNeural":"Klarissa","de-DE-KlausNeural":"Klaus","de-DE-LouisaNeural":"Louisa","de-DE-MajaNeural":"Maja","de-DE-RalfNeural":"Ralf","de-DE-TanjaNeural":"Tanja","en-US-AIGenerate1Neural":"AIGenerate1","en-US-AIGenerate2Neural":"AIGenerate2","en-US-AmberNeural":"Amber","en-US-AnaNeural":"Ana","en-US-AndrewNeural":"Andrew","en-US-AriaNeural":"Aria","en-US-AshleyNeural":"Ashley","en-US-BlueNeural":"Blue","en-US-BrandonNeural":"Brandon","en-US-BrianNeural":"Brian","en-US-ChristopherNeural":"Christopher","en-US-CoraNeural":"Cora","en-US-DavisNeural":"Davis","en-US-ElizabethNeural":"Elizabeth","en-US-EmmaNeural":"Emma","en-US-EricNeural":"Eric","en-US-GuyNeural":"Guy","en-US-JacobNeural":"Jacob","en-US-JaneNeural":"Jane","en-US-JasonNeural":"Jason","en-US-JennyMultilingualNeural":"Jenny Multilingual","en-US-JennyMultilingualV2Neural":"Jenny Multilingual V2","en-US-JennyNeural":"Jenny","en-US-MichelleNeural":"Michelle","en-US-MonicaNeural":"Monica","en-US-NancyNeural":"Nancy","en-US-RogerNeural":"Roger","en-US-RyanMultilingualNeural":"Ryan Multilingual","en-US-SaraNeural":"Sara","en-US-SteffanNeural":"Steffan","en-US-TonyNeural":"Tony","es-ES-AbrilNeural":"Abril","es-ES-AlvaroNeural":"lvaro","es-ES-ArnauNeural":"Arnau","es-ES-DarioNeural":"Dario","es-ES-EliasNeural":"Elias","es-ES-ElviraNeural":"Elvira","es-ES-EstrellaNeural":"Estrella","es-ES-IreneNeural":"Irene","es-ES-LaiaNeural":"Laia","es-ES-LiaNeural":"Lia","es-ES-NilNeural":"Nil","es-ES-SaulNeural":"Saul","es-ES-TeoNeural":"Teo","es-ES-TrianaNeural":"Triana","es-ES-VeraNeural":"Vera","fr-FR-AlainNeural":"Alain","fr-FR-BrigitteNeural":"Brigitte","fr-FR-CelesteNeural":"Celeste","fr-FR-ClaudeNeural":"Claude","fr-FR-CoralieNeural":"Coralie","fr-FR-DeniseNeural":"Denise","fr-FR-EloiseNeural":"Eloise","fr-FR-HenriNeural":"Henri","fr-FR-JacquelineNeural":"Jacqueline","fr-FR-JeromeNeural":"Jerome","fr-FR-JosephineNeural":"Josephine","fr-FR-MauriceNeural":"Maurice","fr-FR-YvesNeural":"Yves","fr-FR-YvetteNeural":"Yvette","ja-JP-AoiNeural":"","ja-JP-DaichiNeural":"","ja-JP-KeitaNeural":"","ja-JP-MayuNeural":"","ja-JP-NanamiNeural":"","ja-JP-NaokiNeural":"","ja-JP-ShioriNeural":"","ko-KR-BongJinNeural":"","ko-KR-GookMinNeural":"","ko-KR-InJoonNeural":"","ko-KR-JiMinNeural":"","ko-KR-SeoHyeonNeural":"","ko-KR-SoonBokNeural":"","ko-KR-SunHiNeural":"","ko-KR-YuJinNeural":"","pt-BR-AntonioNeural":"Antnio","pt-BR-BrendaNeural":"Brenda","pt-BR-DonatoNeural":"Donato","pt-BR-ElzaNeural":"Elza","pt-BR-FabioNeural":"Fabio","pt-BR-FranciscaNeural":"Francisca","pt-BR-GiovannaNeural":"Giovanna","pt-BR-HumbertoNeural":"Humberto","pt-BR-JulioNeural":"Julio","pt-BR-LeilaNeural":"Leila","pt-BR-LeticiaNeural":"Leticia","pt-BR-ManuelaNeural":"Manuela","pt-BR-NicolauNeural":"Nicolau","pt-BR-ValerioNeural":"Valerio","pt-BR-YaraNeural":"Yara","ru-RU-DariyaNeural":"","ru-RU-DmitryNeural":"","ru-RU-SvetlanaNeural":"","wuu-CN-XiaotongNeural":"","wuu-CN-YunzheNeural":"","yue-CN-XiaoMinNeural":"","yue-CN-YunSongNeural":"","zh-CN-XiaochenNeural":"","zh-CN-XiaohanNeural":"","zh-CN-XiaomengNeural":"","zh-CN-XiaomoNeural":"","zh-CN-XiaoqiuNeural":"","zh-CN-XiaorouNeural":"","zh-CN-XiaoruiNeural":"","zh-CN-XiaoshuangNeural":"","zh-CN-XiaoxiaoNeural":"","zh-CN-XiaoxuanNeural":"","zh-CN-XiaoyanNeural":"","zh-CN-XiaoyiNeural":"","zh-CN-XiaoyouNeural":"","zh-CN-XiaozhenNeural":"","zh-CN-YunfengNeural":"","zh-CN-YunhaoNeural":"","zh-CN-YunjianNeural":"","zh-CN-YunjieNeural":"","zh-CN-YunxiNeural":"","zh-CN-YunxiaNeural":"","zh-CN-YunyangNeural":"","zh-CN-YunyeNeural":"","zh-CN-YunzeNeural":"","zh-CN-guangxi-YunqiNeural":"","zh-CN-henan-YundengNeural":"","zh-CN-liaoning-XiaobeiNeural":"","zh-CN-liaoning-YunbiaoNeural":"","zh-CN-shaanxi-XiaoniNeural":"","zh-CN-shandong-YunxiangNeural":"","zh-CN-sichuan-YunxiNeural":"","zh-TW-HsiaoChenNeural":"","zh-TW-HsiaoYuNeural":"","zh-TW-YunJheNeural":""};var Ldt=function(){var t=ww(Ud().mark(function e(n){var i;return Ud().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return i=new AudioContext,s.next=3,i.decodeAudioData(n);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},e)}));return function(n){return t.apply(this,arguments)}}();function Udt(t){if(Array.isArray(t))return t}function Bdt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],c=!0,l=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(c=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);c=!0);}catch(u){l=!0,r=u}finally{try{if(!c&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return o}}function jne(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Ove(t,e){if(t){if(typeof t=="string")return jne(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jne(t,e):void 0}}function Fdt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EY(t,e){return Udt(t)||Bdt(t,e)||Ove(t,e)||Fdt()}const zdt={"ar-SA":"","de-DE":"Deutsch","en-US":"English","es-ES":"Espaol","fr-FR":"Franais","ja-JP":"","ko-KR":"","pt-BR":"Portugus","ru-RU":"","zh-CN":"","zh-TW":""};var Hdt=function(){return Object.entries(zdt).map(function(e){var n=EY(e,2),i=n[0],r=n[1];return{label:r,value:i}})};const Nve="%[a-f0-9]{2}",Vne=new RegExp("("+Nve+")|([^%]+?)","gi"),Gne=new RegExp("("+Nve+")+","gi");function xG(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const n=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],xG(n),xG(i))}function jdt(t){try{return decodeURIComponent(t)}catch{let e=t.match(Vne)||[];for(let n=1;n<e.length;n++)t=xG(e,n).join(""),e=t.match(Vne)||[];return t}}function Vdt(t){const e={"%FE%FF":"","%FF%FE":""};let n=Gne.exec(t);for(;n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{const r=jdt(n[0]);r!==n[0]&&(e[n[0]]=r)}n=Gne.exec(t)}e["%C2"]="";const i=Object.keys(e);for(const r of i)t=t.replace(new RegExp(r,"g"),e[r]);return t}function Gdt(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return Vdt(t)}}function qdt(t,e){const n={};if(Array.isArray(e))for(const i of e){const r=Object.getOwnPropertyDescriptor(t,i);r!=null&&r.enumerable&&Object.defineProperty(n,i,r)}else for(const i of Reflect.ownKeys(t)){const r=Object.getOwnPropertyDescriptor(t,i);if(r.enumerable){const s=t[i];e(i,s,t)&&Object.defineProperty(n,i,r)}}return n}function Ive(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const n=t.indexOf(e);return n===-1?[]:[t.slice(0,n),t.slice(n+e.length)]}const $dt=t=>t==null,Wdt=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),wG=Symbol("encodeFragmentIdentifier");function Ydt(t){switch(t.arrayFormat){case"index":return e=>(n,i)=>{const r=n.length;return i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[sc(e,t),"[",r,"]"].join("")]:[...n,[sc(e,t),"[",sc(r,t),"]=",sc(i,t)].join("")]};case"bracket":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[sc(e,t),"[]"].join("")]:[...n,[sc(e,t),"[]=",sc(i,t)].join("")];case"colon-list-separator":return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,[sc(e,t),":list="].join("")]:[...n,[sc(e,t),":list=",sc(i,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(i,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?i:(r=r===null?"":r,i.length===0?[[sc(n,t),e,sc(r,t)].join("")]:[[i,sc(r,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,i)=>i===void 0||t.skipNull&&i===null||t.skipEmptyString&&i===""?n:i===null?[...n,sc(e,t)]:[...n,[sc(e,t),"=",sc(i,t)].join("")]}}function Xdt(t){let e;switch(t.arrayFormat){case"index":return(n,i,r)=>{if(e=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!e){r[n]=i;return}r[n]===void 0&&(r[n]={}),r[n][e[1]]=i};case"bracket":return(n,i,r)=>{if(e=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"colon-list-separator":return(n,i,r)=>{if(e=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!e){r[n]=i;return}if(r[n]===void 0){r[n]=[i];return}r[n]=[...r[n],i]};case"comma":case"separator":return(n,i,r)=>{const s=typeof i=="string"&&i.includes(t.arrayFormatSeparator),a=typeof i=="string"&&!s&&Tv(i,t).includes(t.arrayFormatSeparator);i=a?Tv(i,t):i;const o=s||a?i.split(t.arrayFormatSeparator).map(c=>Tv(c,t)):i===null?i:Tv(i,t);r[n]=o};case"bracket-separator":return(n,i,r)=>{const s=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!s){r[n]=i&&Tv(i,t);return}const a=i===null?[]:Tv(i,t).split(t.arrayFormatSeparator);if(r[n]===void 0){r[n]=a;return}r[n]=[...r[n],...a]};default:return(n,i,r)=>{if(r[n]===void 0){r[n]=i;return}r[n]=[...[r[n]].flat(),i]}}}function kve(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function sc(t,e){return e.encode?e.strict?Wdt(t):encodeURIComponent(t):t}function Tv(t,e){return e.decode?Gdt(t):t}function Dve(t){return Array.isArray(t)?t.sort():typeof t=="object"?Dve(Object.keys(t)).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]):t}function Pve(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function Kdt(t){let e="";const n=t.indexOf("#");return n!==-1&&(e=t.slice(n)),e}function qne(t,e,n){return n==="string"&&typeof t=="string"?t:typeof n=="function"&&typeof t=="string"?n(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":n==="number"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""||e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):t}function SY(t){t=Pve(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function TY(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},kve(e.arrayFormatSeparator);const n=Xdt(e),i=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return i;for(const r of t.split("&")){if(r==="")continue;const s=e.decode?r.replaceAll("+"," "):r;let[a,o]=Ive(s,"=");a===void 0&&(a=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:Tv(o,e),n(Tv(a,e),o,i)}for(const[r,s]of Object.entries(i))if(typeof s=="object"&&s!==null&&e.types[r]!=="string")for(const[a,o]of Object.entries(s)){const c=e.types[r]?e.types[r].replace("[]",""):void 0;s[a]=qne(o,e,c)}else typeof s=="object"&&s!==null&&e.types[r]==="string"?i[r]=Object.values(s).join(e.arrayFormatSeparator):i[r]=qne(s,e,e.types[r]);return e.sort===!1?i:(e.sort===!0?Object.keys(i).sort():Object.keys(i).sort(e.sort)).reduce((r,s)=>{const a=i[s];return r[s]=a&&typeof a=="object"&&!Array.isArray(a)?Dve(a):a,r},Object.create(null))}function Lve(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},kve(e.arrayFormatSeparator);const n=a=>e.skipNull&&$dt(t[a])||e.skipEmptyString&&t[a]==="",i=Ydt(e),r={};for(const[a,o]of Object.entries(t))n(a)||(r[a]=o);const s=Object.keys(r);return e.sort!==!1&&s.sort(e.sort),s.map(a=>{const o=t[a];return o===void 0?"":o===null?sc(a,e):Array.isArray(o)?o.length===0&&e.arrayFormat==="bracket-separator"?sc(a,e)+"[]":o.reduce(i(a),[]).join("&"):sc(a,e)+"="+sc(o,e)}).filter(a=>a.length>0).join("&")}function Uve(t,e){var r;e={decode:!0,...e};let[n,i]=Ive(t,"#");return n===void 0&&(n=t),{url:((r=n==null?void 0:n.split("?"))==null?void 0:r[0])??"",query:TY(SY(t),e),...e&&e.parseFragmentIdentifier&&i?{fragmentIdentifier:Tv(i,e)}:{}}}function Bve(t,e){e={encode:!0,strict:!0,[wG]:!0,...e};const n=Pve(t.url).split("?")[0]||"",i=SY(t.url),r={...TY(i,{sort:!1}),...t.query};let s=Lve(r,e);s&&(s=`?${s}`);let a=Kdt(t.url);if(typeof t.fragmentIdentifier=="string"){const o=new URL(n);o.hash=t.fragmentIdentifier,a=e[wG]?o.hash:`#${t.fragmentIdentifier}`}return`${n}${s}${a}`}function Fve(t,e,n){n={parseFragmentIdentifier:!0,[wG]:!1,...n};const{url:i,query:r,fragmentIdentifier:s}=Uve(t,n);return Bve({url:i,query:qdt(r,e),fragmentIdentifier:s},n)}function Jdt(t,e,n){const i=Array.isArray(e)?r=>!e.includes(r):(r,s)=>!e(r,s);return Fve(t,i,n)}const Zdt=Object.freeze(Object.defineProperty({__proto__:null,exclude:Jdt,extract:SY,parse:TY,parseUrl:Uve,pick:Fve,stringify:Lve,stringifyUrl:Bve},Symbol.toStringTag,{value:"Module"}));var Al=[];for(var qH=0;qH<256;++qH)Al.push((qH+256).toString(16).slice(1));function Qdt(t,e=0){return(Al[t[e+0]]+Al[t[e+1]]+Al[t[e+2]]+Al[t[e+3]]+"-"+Al[t[e+4]]+Al[t[e+5]]+"-"+Al[t[e+6]]+Al[t[e+7]]+"-"+Al[t[e+8]]+Al[t[e+9]]+"-"+Al[t[e+10]]+Al[t[e+11]]+Al[t[e+12]]+Al[t[e+13]]+Al[t[e+14]]+Al[t[e+15]]).toLowerCase()}var CD,eft=new Uint8Array(16);function tft(){if(!CD&&(CD=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!CD))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return CD(eft)}var nft=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const $ne={randomUUID:nft};function ift(t,e,n){if($ne.randomUUID&&!e&&!t)return $ne.randomUUID();t=t||{};var i=t.random||(t.rng||tft)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,Qdt(i)}var rft=function(e,n){var i=n.voice;return'<voice name="'.concat(i,'">').concat(e,"</voice>")},sft=function(e,n){var i=n.style;return i?'<mstts:express-as style="'.concat(i,'">').concat(e,"</mstts:express-as>"):e},aft=function(e,n){var i=n.pitch,r=n.rate;return!i&&!r?e:'<prosody pitch="'.concat(Math.floor((i||1)*100),'%" rate="').concat(Math.floor((r||1)*100),'%">').concat(e,"</prosody>")},oft=function(e){return'<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US">'.concat(e,"</speak>")},cft=function(e,n){var i=aft(e,n);return i=sft(i,n),i=rft(i,n),i=oft(i),i},Wne=function(e,n){for(var i=[],r=0,s=Object.entries(e);r<s.length;r++){var a=EY(s[r],2),o=a[0],c=a[1];i.push("".concat(o,":").concat(c))}return i.push("",n),i.join(`\r
`)};function lft(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ove(t))||e){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(l){throw l},f:r}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,o=!1;return{s:function(){n=n.call(t)},n:function(){var l=n.next();return a=l.done,l},e:function(l){o=!0,s=l},f:function(){try{a||n.return==null||n.return()}finally{if(o)throw s}}}}var uft=function(e){var n={},i=lft(e.slice(0,e.indexOf(`\r
\r
`)).split(`\r
`)),r;try{for(i.s();!(r=i.n()).done;){var s=r.value,a=s.split(":",2),o=EY(a,2),c=o[0],l=o[1];n[c]=l}}catch(u){i.e(u)}finally{i.f()}return{data:e.slice(e.indexOf(`\r
\r
`)+4),headers:n}},hft="wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1",dft="6A5AA1D4EAFF4E9FB37E23D68491D6F4",fft=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),pft=function(e){var n=new Date().toString(),i={"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":n},r={"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":e,"X-Timestamp":n};return{configHeader:i,contentHeader:r}},zve=function(){var t=ww(Ud().mark(function e(n){var i,r,s,a,o,c,l,u,h,d,f,p,g,_=arguments;return Ud().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return i=n.payload,r=_.length>1&&_[1]!==void 0?_[1]:{},s=r.proxyUrl,a=r.token,o=i.input,c=i.options,l=ift().replaceAll("-",""),u=Zdt.stringifyUrl({query:{ConnectionId:l,TrustedClientToken:a||dft},url:s||hft}),h=pft(l),d=h.configHeader,f=h.contentHeader,p=Wne(d,fft),g=Wne(f,cft(o,c)),E.abrupt("return",new Promise(function(T,x){var N=new WebSocket(u);N.binaryType="arraybuffer";var A=function(){N.send(p),N.send(g)},I=new ArrayBuffer(0),k=function(){var U=ww(Ud().mark(function $(q){var G,X,ie,V,Z,Y,ee,oe;return Ud().wrap(function(Me){for(;;)switch(Me.prev=Me.next){case 0:if(typeof q.data!="string"){Me.next=13;break}G=uft(q.data),X=G.headers,Me.t0=X.Path,Me.next=Me.t0==="turn.end"?5:11;break;case 5:if(N.close(),I.byteLength){Me.next=8;break}return Me.abrupt("return");case 8:return ie=new Response(I),T(ie),Me.abrupt("break",11);case 11:Me.next=14;break;case 13:q.data instanceof ArrayBuffer&&(V=new DataView(q.data),Z=V.getInt16(0),q.data.byteLength>Z+2&&(Y=q.data.slice(2+Z),ee=new ArrayBuffer(I.byteLength+Y.byteLength),oe=new Uint8Array(ee),oe.set(new Uint8Array(I),0),oe.set(new Uint8Array(Y),I.byteLength),I=ee));case 14:case"end":return Me.stop()}},$)}));return function(q){return U.apply(this,arguments)}}(),L=function(){x(new Error("WebSocket error occurred.")),N.close()};N.addEventListener("open",A),N.addEventListener("message",k),N.addEventListener("error",L)}));case 9:case"end":return E.stop()}},e)}));return function(n){return t.apply(this,arguments)}}(),mft=function(e){var n=e&&xP[e]?xP[e]||[]:Vh(Object.values(xP));return n.map(function(i){return{label:(wP==null?void 0:wP[i])||i,value:i}})},xI=function(){function t(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.serviceUrl,r=n.locale,s=n.headers;Idt(this,t),lg(this,"locale",void 0),lg(this,"serviceUrl",void 0),lg(this,"headers",void 0),lg(this,"fetch",function(){var a=ww(Ud().mark(function o(c){var l;return Ud().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,e.serviceUrl?fetch(e.serviceUrl,{body:JSON.stringify(c),headers:e.headers,method:"POST"}):zve({payload:c});case 2:return l=h.sent,h.abrupt("return",l);case 4:case"end":return h.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),lg(this,"create",function(){var a=ww(Ud().mark(function o(c){return Ud().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",e.fetch(c));case 1:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),lg(this,"createAudio",function(){var a=ww(Ud().mark(function o(c){var l,u;return Ud().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,e.create(c);case 2:return l=d.sent,d.next=5,l.arrayBuffer();case 5:return u=d.sent,d.abrupt("return",Ldt(u));case 7:case"end":return d.stop()}},o)}));return function(o){return a.apply(this,arguments)}}()),this.locale=r,this.serviceUrl=i,this.headers=s}return Pdt(t,[{key:"voiceOptions",get:function(){return mft(this.locale)}}]),t}();lg(xI,"localeOptions",Hdt());lg(xI,"voiceList",xP);lg(xI,"voiceName",wP);lg(xI,"createRequest",zve);let $H;async function gft(t,e){if(!ae(t))return;ae($H)||($H=new xI({locale:"en-US"}));const[n,i]=e,r=await $H.createAudio({input:i,options:{voice:n||"en-US-GuyNeural"}});t.addttsaudiobuffer(r)}const Yne=new Map;async function vft(t,e,n){var s,a;if(!ae(e))return;const[i]=n,r=Yne.get(i);if(ae(r))r.loaded&&e.addttsaudiobuffer(r);else{const c=await(await TG.connect("declare-lab/TangoFlux")).predict("/predict",[i,25,4.5,3]);if(Li(c.data)&&On((s=c.data[0])==null?void 0:s.url)){const l=(a=c.data[0])==null?void 0:a.url;Yne.set(i,new Ps(l,()=>{Ug(Ge,t,"loaded",`${l.substring(0,8)}...${l.slice(-8)}`)}))}}}const yft=Date.now(),Cf={get value(){return(Date.now()-yft)/1e3%1e6}},_ft=120;let Hve=0;function xY(t){Hve=_ft/t,gY().bpm.value=t}xY(150);const j6={get value(){return Hve}};function V6(t){const e=t.clone();return e.uniforms.time=Cf,e.uniforms.interval=j6,e}cve(new cR({latencyHint:"playback"}));lht().catch(t=>{Hi(Av,nr(),"audio",t.message)});let CP=!1;function iE(){CP||But().then(()=>{if(!CP){const t=gY();CP=!0,t.start(),Ug(Av,nr(),"audio is enabled!"),xY(107);try{const e=navigator;ae(e.audioSession)&&(e.audioSession.type="playback")}catch{}MDe(Av,nr())}}).catch(t=>{Hi(Av,nr(),"audio",t.message)})}let Hu,Xne="";function bft(){return Hu==null?void 0:Hu.broadcastdestination}const Av=qb("synth",[],t=>{if(Av.session(t)&&(CP&&!ae(Hu)&&(Hu=dht()),!!ae(Hu)))switch(t.target){case"audioenabled":qu(Av,t.player,async()=>{await zp(1e3),wg(Av,t.player,void 0,"text","audioenabled","")});break;case"bpm":pn(t.data)&&xY(t.data);break;case"playvolume":pn(t.data)&&Hu.setplayvolume(t.data);break;case"bgplayvolume":pn(t.data)&&Hu.setbgplayvolume(t.data);break;case"ttsvolume":pn(t.data)&&Hu.setttsvolume(t.data);break;case"focus":On(t.data)&&(Xne=t.data);break;case"play":if(Li(t.data)){const[e,n,i]=t.data;if(e&&e!==Xne)return;n.trim()===""?Hu.stopplay():Hu.addplay(n,i)}break;case"voice":if(Li(t.data)){const[e,n,i]=t.data;ght(t.player,Hu,e,n,i)}break;case"voicefx":if(Li(t.data)){const[e,n,i,r]=t.data;Tht(t.player,Hu,e,n,i,r)}break;case"tts":qu(Av,t.player,async()=>{Li(t.data)&&await gft(Hu,t.data)});break;case"tta":qu(Av,t.player,async()=>{Li(t.data)&&await vft(t.player,Hu,t.data)});break}});function MO(){return MO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},MO.apply(null,arguments)}var Eft=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return i/Math.atan(1/n)*Math.atan(Math.sin(2*Math.PI*e*r)/n)},Sft=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function Yv(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Sft,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,c="velocity_"+e;if(t.__damp===void 0&&(t.__damp={}),t.__damp[c]===void 0&&(t.__damp[c]=0),Math.abs(t[e]-n)<=o)return t[e]=n,!1;i=Math.max(1e-4,i);var l=2/i,u=a(l*r),h=t[e]-n,d=n,f=s*i;h=Math.min(Math.max(h,-f),f),n=t[e]-h;var p=(t.__damp[c]+l*h)*r;t.__damp[c]=(t.__damp[c]-l*p)*u;var g=n+(h+p)*u;return d-t[e]>0==g>d&&(g=d,t.__damp[c]=(g-d)/r),t[e]=g,!0}function WH(t,e,n,i,r,s,a,o){return Yv(t,e,t[e]+Pke(t[e],n),i,r,s,a,o)}var m1=new Re,Kne,Jne,Zne;function MU(t,e,n,i,r,s,a){return typeof e=="number"?m1.setScalar(e):Array.isArray(e)?m1.set(e[0],e[1],e[2]):m1.copy(e),Kne=Yv(t,"x",m1.x,n,i,r,s,a),Jne=Yv(t,"y",m1.y,n,i,r,s,a),Zne=Yv(t,"z",m1.z,n,i,r,s,a),Kne||Jne||Zne}var iA=new $h,Qne,eie,tie;function Tft(t,e,n,i,r,s,a){return Array.isArray(e)?iA.set(e[0],e[1],e[2],e[3]):iA.copy(e),Qne=WH(t,"x",iA.x,n,i,r,s,a),eie=WH(t,"y",iA.y,n,i,r,s,a),tie=WH(t,"z",iA.z,n,i,r,s,a),Qne||eie||tie}const nie=t=>Symbol.iterator in t,iie=t=>"entries"in t,rie=(t,e)=>{const n=t instanceof Map?t:new Map(t.entries()),i=e instanceof Map?e:new Map(e.entries());if(n.size!==i.size)return!1;for(const[r,s]of n)if(!Object.is(s,i.get(r)))return!1;return!0},xft=(t,e)=>{const n=t[Symbol.iterator](),i=e[Symbol.iterator]();let r=n.next(),s=i.next();for(;!r.done&&!s.done;){if(!Object.is(r.value,s.value))return!1;r=n.next(),s=i.next()}return!!r.done&&!!s.done};function wft(t,e){return Object.is(t,e)?!0:typeof t!="object"||t===null||typeof e!="object"||e===null?!1:!nie(t)||!nie(e)?rie({entries:()=>Object.entries(t)},{entries:()=>Object.entries(e)}):iie(t)&&iie(e)?rie(t,e):xft(t,e)}function ap(t){const e=Eg.useRef();return n=>{const i=t(n);return wft(e.current,i)?e.current:e.current=i}}function wY(t,e,n){const i=Zu(d=>d.size),r=Zu(d=>d.viewport),s=typeof t=="number"?t:i.width*r.dpr,a=typeof e=="number"?e:i.height*r.dpr,o=(typeof t=="number"?n:t)||{},{samples:c=0,depth:l,...u}=o,h=Be.useMemo(()=>{const d=new Ul(s,a,{minFilter:_a,magFilter:_a,type:Lb,...u});return l&&(d.depthTexture=new PC(s,a,iu)),d.samples=c,d},[]);return Be.useLayoutEffect(()=>{h.setSize(s,a),c&&(h.samples=c)},[c,h,s,a]),Be.useEffect(()=>()=>h.dispose(),[]),h}const Cft=t=>typeof t=="function",Rft=Be.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,children:i,makeDefault:r,...s},a)=>{const o=Zu(({set:_})=>_),c=Zu(({camera:_})=>_),l=Zu(({size:_})=>_),u=Be.useRef(null);Be.useImperativeHandle(a,()=>u.current,[]);const h=Be.useRef(null),d=wY(e);Be.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[l,s]),Be.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),Be.useLayoutEffect(()=>{if(r){const _=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:_}))}},[u,r,o]);let f=0,p=null;const g=Cft(i);return hy(_=>{g&&(n===1/0||f<n)&&(h.current.visible=!1,_.gl.setRenderTarget(d),p=_.scene.background,t&&(_.scene.background=t),_.gl.render(_.scene,u.current),_.scene.background=p,_.gl.setRenderTarget(null),h.current.visible=!0,f++)}),Be.createElement(Be.Fragment,null,Be.createElement("orthographicCamera",MO({left:l.width/-2,right:l.width/2,top:l.height/2,bottom:l.height/-2,ref:u},s),!g&&i),Be.createElement("group",{ref:h},g&&i(d.texture)))}),Aft=t=>typeof t=="function",Mft=Be.forwardRef(({envMap:t,resolution:e=256,frames:n=1/0,makeDefault:i,children:r,...s},a)=>{const o=Zu(({set:_})=>_),c=Zu(({camera:_})=>_),l=Zu(({size:_})=>_),u=Be.useRef(null);Be.useImperativeHandle(a,()=>u.current,[]);const h=Be.useRef(null),d=wY(e);Be.useLayoutEffect(()=>{s.manual||(u.current.aspect=l.width/l.height)},[l,s]),Be.useLayoutEffect(()=>{u.current.updateProjectionMatrix()});let f=0,p=null;const g=Aft(r);return hy(_=>{g&&(n===1/0||f<n)&&(h.current.visible=!1,_.gl.setRenderTarget(d),p=_.scene.background,t&&(_.scene.background=t),_.gl.render(_.scene,u.current),_.scene.background=p,_.gl.setRenderTarget(null),h.current.visible=!0,f++)}),Be.useLayoutEffect(()=>{if(i){const _=c;return o(()=>({camera:u.current})),()=>o(()=>({camera:_}))}},[u,i,o]),Be.createElement(Be.Fragment,null,Be.createElement("perspectiveCamera",MO({ref:u},s),!g&&r),Be.createElement("group",{ref:h},g&&r(d.texture)))});var jve={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(Ll,function(){var n=function(){function i(f){return a.appendChild(f.dom),f}function r(f){for(var p=0;p<a.children.length;p++)a.children[p].style.display=p===f?"block":"none";s=f}var s=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(f){f.preventDefault(),r(++s%a.children.length)},!1);var o=(performance||Date).now(),c=o,l=0,u=i(new n.Panel("FPS","#0ff","#002")),h=i(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=i(new n.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:a,addPanel:i,showPanel:r,begin:function(){o=(performance||Date).now()},end:function(){l++;var f=(performance||Date).now();if(h.update(f-o,200),f>c+1e3&&(u.update(1e3*l/(f-c),100),c=f,l=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return f},update:function(){o=this.end()},domElement:a,setMode:r}};return n.Panel=function(i,r,s){var a=1/0,o=0,c=Math.round,l=c(window.devicePixelRatio||1),u=80*l,h=48*l,d=3*l,f=2*l,p=3*l,g=15*l,_=74*l,v=30*l,E=document.createElement("canvas");E.width=u,E.height=h,E.style.cssText="width:80px;height:48px";var T=E.getContext("2d");return T.font="bold "+9*l+"px Helvetica,Arial,sans-serif",T.textBaseline="top",T.fillStyle=s,T.fillRect(0,0,u,h),T.fillStyle=r,T.fillText(i,d,f),T.fillRect(p,g,_,v),T.fillStyle=s,T.globalAlpha=.9,T.fillRect(p,g,_,v),{dom:E,update:function(x,N){a=Math.min(a,x),o=Math.max(o,x),T.fillStyle=s,T.globalAlpha=1,T.fillRect(0,0,u,g),T.fillStyle=r,T.fillText(c(x)+" "+i+" ("+c(a)+"-"+c(o)+")",d,f),T.drawImage(E,p+l,g,_-l,v,p,g,_-l,v),T.fillRect(p+_-l,g,l,v),T.fillStyle=s,T.globalAlpha=.9,T.fillRect(p+_-l,g,l,c((1-x/N)*v))}}},n})})(jve);var Oft=jve.exports;const Nft=Gc(Oft);function YH(t,e,n,i){return new(n||(n=Promise))(function(r,s){function a(l){try{c(i.next(l))}catch(u){s(u)}}function o(l){try{c(i.throw(l))}catch(u){s(u)}}function c(l){var u;l.done?r(l.value):(u=l.value,u instanceof n?u:new n(function(h){h(u)})).then(a,o)}c((i=i.apply(t,[])).next())})}const Ift=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function sie(t){return t=t.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const Vve=typeof window>"u",sg=(()=>{if(Vve)return;const{userAgent:t,platform:e,maxTouchPoints:n}=window.navigator,i=/(iphone|ipod|ipad)/i.test(t),r=e==="iPad"||e==="MacIntel"&&n>0&&!window.MSStream;return{isIpad:r,isMobile:/android/i.test(t)||i||r,isSafari12:/Version\/12.+Safari/.test(t),isFirefox:/Firefox/.test(t)}})();function kft(t,e,n){if(!n)return[e];const i=function(l){const u=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,h=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,d=l.createShader(35633),f=l.createShader(35632),p=l.createProgram();if(!(f&&d&&p))return;l.shaderSource(d,u),l.shaderSource(f,h),l.compileShader(d),l.compileShader(f),l.attachShader(p,d),l.attachShader(p,f),l.linkProgram(p),l.detachShader(p,d),l.detachShader(p,f),l.deleteShader(d),l.deleteShader(f),l.useProgram(p);const g=l.createBuffer();l.bindBuffer(34962,g),l.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const _=l.getAttribLocation(p,"aPosition");l.vertexAttribPointer(_,3,5126,!1,0,0),l.enableVertexAttribArray(_),l.clearColor(1,1,1,1),l.clear(16384),l.viewport(0,0,1,1),l.drawArrays(4,0,3);const v=new Uint8Array(4);return l.readPixels(0,0,1,1,6408,5121,v),l.deleteProgram(p),l.deleteBuffer(g),v.join("")}(t),r="801621810",s="8016218135",a="80162181161",o=sg!=null&&sg.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",r,15],["a12x",r,15],["a12z",r,15],["a14",r,15],["a15",r,15],["m1",r,15],["m2",r,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",r,15],["a12",r,15],["a13",r,15],["a14",r,15],["a15",r,15],["a16",r,15],["a17",r,15]];let c;return i==="80162181255"?c=o.filter(([,,l])=>l>=14):(c=o.filter(([,l])=>l===i),c.length||(c=o)),c.map(([l])=>`apple ${l} gpu`)}class aie extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const XH=[],oie=[];function Dft(t,e){if(t===e)return 0;const n=t;t.length>e.length&&(t=e,e=n);let i=t.length,r=e.length;for(;i>0&&t.charCodeAt(~-i)===e.charCodeAt(~-r);)i--,r--;let s,a=0;for(;a<i&&t.charCodeAt(a)===e.charCodeAt(a);)a++;if(i-=a,r-=a,i===0)return r;let o,c,l=0,u=0,h=0;for(;u<i;)oie[u]=t.charCodeAt(a+u),XH[u]=++u;for(;h<r;)for(s=e.charCodeAt(a+h),o=h++,l=h,u=0;u<i;u++)c=s===oie[u]?o:o+1,o=XH[u],l=XH[u]=o>l?c>l?l+1:c:c>o?o+1:c;return l}function Pft(t){return t!=null}const Lft=({mobileTiers:t=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:n={},glContext:i,failIfMajorPerformanceCaveat:r=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.56/dist/benchmarks"}={})=>YH(void 0,void 0,void 0,function*(){const a={};if(Vve)return{tier:0,type:"SSR"};const{isIpad:o=!!(sg!=null&&sg.isIpad),isMobile:c=!!(sg!=null&&sg.isMobile),screenSize:l=window.screen,loadBenchmarks:u=N=>YH(void 0,void 0,void 0,function*(){const A=yield fetch(`${s}/${N}`).then(I=>I.json());if(parseInt(A.shift().split(".")[0],10)<4)throw new aie("Detect GPU benchmark data is out of date. Please update to version 4x");return A})}=n;let{renderer:h}=n;const d=(N,A,I,k,L)=>({device:L,fps:k,gpu:I,isMobile:c,tier:N,type:A});let f,p="";if(h)h=sie(h),f=[h];else{const N=i||function(I,k=!1){const L={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:k,powerPreference:"high-performance",stencil:!1};I&&delete L.powerPreference;const U=window.document.createElement("canvas"),$=U.getContext("webgl",L)||U.getContext("experimental-webgl",L);return $??void 0}(sg==null?void 0:sg.isSafari12,r);if(!N)return d(0,"WEBGL_UNSUPPORTED");const A=sg!=null&&sg.isFirefox?null:N.getExtension("WEBGL_debug_renderer_info");if(h=A?N.getParameter(A.UNMASKED_RENDERER_WEBGL):N.getParameter(N.RENDERER),!h)return d(1,"FALLBACK");p=h,h=sie(h),f=function(I,k,L){return k==="apple gpu"?kft(I,k,L):[k]}(N,h,c)}const g=(yield Promise.all(f.map(function(N){var A;return YH(this,void 0,void 0,function*(){const I=(He=>{const Te=c?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const Le of Te)if(He.includes(Le))return Le})(N);if(!I)return;const k=`${c?"m":"d"}-${I}${o?"-ipad":""}.json`,L=a[k]=(A=a[k])!==null&&A!==void 0?A:u(k);let U;try{U=yield L}catch(He){if(He instanceof aie)throw He;return}const $=function(He){var Te;const Le=(He=He.replace(/\([^)]+\)/,"")).match(/\d+/)||He.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(Te=Le==null?void 0:Le.join("").replace(/\W|amd/g,""))!==null&&Te!==void 0?Te:""}(N);let q=U.filter(([,He])=>He===$);q.length||(q=U.filter(([He])=>He.includes(N)));const G=q.length;if(G===0)return;const X=N.split(/[.,()\[\]/\s]/g).sort().filter((He,Te,Le)=>Te===0||He!==Le[Te-1]).join(" ");let ie,[V,,,,Z]=G>1?q.map(He=>[He,Dft(X,He[2])]).sort(([,He],[,Te])=>He-Te)[0][0]:q[0],Y=Number.MAX_VALUE;const{devicePixelRatio:ee}=window,oe=l.width*ee*l.height*ee;for(const He of Z){const[Te,Le]=He,we=Te*Le,Ce=Math.abs(oe-we);Ce<Y&&(Y=Ce,ie=He)}if(!ie)return;const[,,de,Me]=ie;return[Y,de,V,Me]})}))).filter(Pft).sort(([N=Number.MAX_VALUE,A],[I=Number.MAX_VALUE,k])=>N===I?A-k:N-I);if(!g.length){const N=Ift.find(A=>h.includes(A));return N?d(0,"BLOCKLISTED",N):d(1,"FALLBACK",`${h} (${p})`)}const[,_,v,E]=g[0];if(_===-1)return d(0,"BLOCKLISTED",v,_,E);const T=c?t:e;let x=0;for(let N=0;N<T.length;N++)_>=T[N]&&(x=N);return d(x,"BENCHMARK",v,_,E)}),Uft=t=>sOe(()=>Lft(t),["useDetectGPU"]),Bft=Be.forwardRef(({children:t,compute:e,width:n,height:i,samples:r=8,renderPriority:s=0,eventPriority:a=0,frames:o=1/0,stencilBuffer:c=!1,depthBuffer:l=!0,generateMipmaps:u=!1,...h},d)=>{const{size:f,viewport:p}=Zu(),g=wY((n||f.width)*p.dpr,(i||f.height)*p.dpr,{samples:r,stencilBuffer:c,depthBuffer:l,generateMipmaps:u}),[_]=Be.useState(()=>new Bw),v=Be.useCallback((E,T,x)=>{var N,A;let I=(N=g.texture)==null||(N=N.__r3f.parent)==null?void 0:N.object;for(;I&&!(I instanceof Gr);){var k;I=(k=I.__r3f.parent)==null?void 0:k.object}if(!I)return!1;x.raycaster.camera||x.events.compute(E,x,(A=x.previousRoot)==null?void 0:A.getState());const[L]=x.raycaster.intersectObject(I);if(!L)return!1;const U=L.uv;if(!U)return!1;T.raycaster.setFromCamera(T.pointer.set(U.x*2-1,U.y*2-1),T.camera)},[]);return Be.useImperativeHandle(d,()=>g.texture,[g]),Be.createElement(Be.Fragment,null,UOe(Be.createElement(Fft,{renderPriority:s,frames:o,fbo:g},t,Be.createElement("group",{onPointerOver:()=>null})),_,{events:{compute:e||v,priority:a}}),Be.createElement("primitive",MO({object:g.texture},h)))});function Fft({frames:t,renderPriority:e,children:n,fbo:i}){let r=0,s,a,o,c;return hy(l=>{(t===1/0||r<t)&&(s=l.gl.autoClear,a=l.gl.xr.enabled,o=l.gl.getRenderTarget(),c=l.gl.xr.isPresenting,l.gl.autoClear=!0,l.gl.xr.enabled=!1,l.gl.xr.isPresenting=!1,l.gl.setRenderTarget(i),l.gl.render(l.scene,l.camera),l.gl.setRenderTarget(o),l.gl.autoClear=s,l.gl.xr.enabled=a,l.gl.xr.isPresenting=c,r++)},e),Be.createElement(Be.Fragment,null,n)}/**
 * postprocessing v6.37.3 build Sun Apr 27 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var KH=1/1e3,zft=1e3,Hft=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(t){typeof document<"u"&&document.hidden!==void 0&&(t?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=t)}get delta(){return this._delta*KH}get fixedDelta(){return this._fixedDelta*KH}set fixedDelta(t){this._fixedDelta=t*zft}get elapsed(){return this._elapsed*KH}update(t){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(t!==void 0?t:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(t){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},jft=(()=>{const t=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),n=new Qi;return n.setAttribute("position",new rr(t,3)),n.setAttribute("uv",new rr(e,2)),n})(),gm=class CG{static get fullscreenGeometry(){return jft}constructor(e="Pass",n=new Bw,i=new JO){this.name=e,this.renderer=null,this.scene=n,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const n=this.fullscreenMaterial;n!==null&&(n.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let n=this.screen;n!==null?n.material=e:(n=new Bo(CG.fullscreenGeometry,e),n.frustumCulled=!1,this.scene===null&&(this.scene=new Bw),this.scene.add(n),this.screen=n)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,n=Ub){}render(e,n,i,r,s){throw new Error("Render method not implemented!")}setSize(e,n){}initialize(e,n,i){}dispose(){for(const e of Object.keys(this)){const n=this[e];(n instanceof Ul||n instanceof yl||n instanceof Pa||n instanceof CG)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},Vft=class extends gm{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(t,e,n,i,r){const s=t.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},Gft=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,qft="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",$ft=class extends Bc{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new Yi(null),opacity:new Yi(1)},blending:Yf,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Gft,vertexShader:qft})}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}getOpacity(t){return this.uniforms.opacity.value}setOpacity(t){this.uniforms.opacity.value=t}},Wft=class extends gm{constructor(t,e=!0){super("CopyPass"),this.fullscreenMaterial=new $ft,this.needsSwap=!1,this.renderTarget=t,t===void 0&&(this.renderTarget=new Ul(1,1,{minFilter:_a,magFilter:_a,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(t){this.autoResize=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(t){this.autoResize=t}render(t,e,n,i,r){this.fullscreenMaterial.inputBuffer=e.texture,t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){this.autoResize&&this.renderTarget.setSize(t,e)}initialize(t,e,n){n!==void 0&&(this.renderTarget.texture.type=n,n!==ml?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":t!==null&&t.outputColorSpace===ya&&(this.renderTarget.texture.colorSpace=ya))}},cie=new _n,Gve=class extends gm{constructor(t=!0,e=!0,n=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=t,this.depth=e,this.stencil=n,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(t,e,n){this.color=t,this.depth=e,this.stencil=n}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(t){this.overrideClearColor=t}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(t){this.overrideClearAlpha=t}render(t,e,n,i,r){const s=this.overrideClearColor,a=this.overrideClearAlpha,o=t.getClearAlpha(),c=s!==null,l=a>=0;c?(t.getClearColor(cie),t.setClearColor(s,l?a:o)):l&&t.setClearAlpha(a),t.setRenderTarget(this.renderToScreen?null:e),t.clear(this.color,this.depth,this.stencil),c?t.setClearColor(cie,o):l&&t.setClearAlpha(o)}},Yft=class extends gm{constructor(t,e){super("MaskPass",t,e),this.needsSwap=!1,this.clearPass=new Gve(!1,!1,!0),this.inverse=!1}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get inverted(){return this.inverse}set inverted(t){this.inverse=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(t){this.inverted=t}render(t,e,n,i,r){const s=t.getContext(),a=t.state.buffers,o=this.scene,c=this.camera,l=this.clearPass,u=this.inverted?0:1,h=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(h),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?l.render(t,null):(l.render(t,e),l.render(t,n))),this.renderToScreen?(t.setRenderTarget(null),t.render(o,c)):(t.setRenderTarget(e),t.render(o,c),t.setRenderTarget(n),t.render(o,c)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},Xft=class{constructor(t=null,{depthBuffer:e=!0,stencilBuffer:n=!1,multisampling:i=0,frameBufferType:r}={}){this.renderer=null,this.inputBuffer=this.createBuffer(e,n,r,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Wft,this.depthTexture=null,this.passes=[],this.timer=new Hft,this.autoRenderToScreen=!0,this.setRenderer(t)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(t){const e=this.inputBuffer,n=this.multisampling;n>0&&t>0?(this.inputBuffer.samples=t,this.outputBuffer.samples=t,this.inputBuffer.dispose(),this.outputBuffer.dispose()):n!==t&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(e.depthBuffer,e.stencilBuffer,e.texture.type,t),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(t){if(this.renderer=t,t!==null){const e=t.getSize(new Rt),n=t.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===ml&&t.outputColorSpace===ya&&(this.inputBuffer.texture.colorSpace=ya,this.outputBuffer.texture.colorSpace=ya,this.inputBuffer.dispose(),this.outputBuffer.dispose()),t.autoClear=!1,this.setSize(e.width,e.height);for(const r of this.passes)r.initialize(t,n,i)}}replaceRenderer(t,e=!0){const n=this.renderer,i=n.domElement.parentNode;return this.setRenderer(t),e&&i!==null&&(i.removeChild(n.domElement),i.appendChild(t.domElement)),n}createDepthTexture(){const t=this.depthTexture=new PC;return this.inputBuffer.depthTexture=t,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(t.format=nT,t.type=tT):t.type=Pg,t}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const t of this.passes)t.setDepthTexture(null)}}createBuffer(t,e,n,i){const r=this.renderer,s=r===null?new Rt:r.getDrawingBufferSize(new Rt),a={minFilter:_a,magFilter:_a,stencilBuffer:e,depthBuffer:t,type:n},o=new Ul(s.width,s.height,a);return i>0&&(o.ignoreDepthForMultisampleCopy=!1,o.samples=i),n===ml&&r!==null&&r.outputColorSpace===ya&&(o.texture.colorSpace=ya),o.texture.name="EffectComposer.Buffer",o.texture.generateMipmaps=!1,o}setMainScene(t){for(const e of this.passes)e.mainScene=t}setMainCamera(t){for(const e of this.passes)e.mainCamera=t}addPass(t,e){const n=this.passes,i=this.renderer,r=i.getDrawingBufferSize(new Rt),s=i.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(t.setRenderer(i),t.setSize(r.width,r.height),t.initialize(i,s,a),this.autoRenderToScreen&&(n.length>0&&(n[n.length-1].renderToScreen=!1),t.renderToScreen&&(this.autoRenderToScreen=!1)),e!==void 0?n.splice(e,0,t):n.push(t),this.autoRenderToScreen&&(n[n.length-1].renderToScreen=!0),t.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const o=this.createDepthTexture();for(t of n)t.setDepthTexture(o)}else t.setDepthTexture(this.depthTexture)}removePass(t){const e=this.passes,n=e.indexOf(t);if(n!==-1&&e.splice(n,1).length>0){if(this.depthTexture!==null){const s=(o,c)=>o||c.needsDepthTexture;e.reduce(s,!1)||(t.getDepthTexture()===this.depthTexture&&t.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&n===e.length&&(t.renderToScreen=!1,e.length>0&&(e[e.length-1].renderToScreen=!0))}}removeAllPasses(){const t=this.passes;this.deleteDepthTexture(),t.length>0&&(this.autoRenderToScreen&&(t[t.length-1].renderToScreen=!1),this.passes=[])}render(t){const e=this.renderer,n=this.copyPass;let i=this.inputBuffer,r=this.outputBuffer,s=!1,a,o,c;t===void 0&&(this.timer.update(),t=this.timer.getDelta());for(const l of this.passes)l.enabled&&(l.render(e,i,r,t,s),l.needsSwap&&(s&&(n.renderToScreen=l.renderToScreen,a=e.getContext(),o=e.state.buffers.stencil,o.setFunc(a.NOTEQUAL,1,4294967295),n.render(e,i,r,t,s),o.setFunc(a.EQUAL,1,4294967295)),c=i,i=r,r=c),l instanceof Yft?s=!0:l instanceof Vft&&(s=!1))}setSize(t,e,n){const i=this.renderer,r=i.getSize(new Rt);(t===void 0||e===void 0)&&(t=r.width,e=r.height),(r.width!==t||r.height!==e)&&i.setSize(t,e,n);const s=i.getDrawingBufferSize(new Rt);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);for(const a of this.passes)a.setSize(s.width,s.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const t of this.passes)t.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),gm.fullscreenGeometry.dispose()}},gb={NONE:0,DEPTH:1,CONVOLUTION:2},ss={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},Kft=class{constructor(){this.shaderParts=new Map([[ss.FRAGMENT_HEAD,null],[ss.FRAGMENT_MAIN_UV,null],[ss.FRAGMENT_MAIN_IMAGE,null],[ss.VERTEX_HEAD,null],[ss.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=gb.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Lg}},JH=!1,lie=class{constructor(t=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(t),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let n;if(e.material.flatShading)switch(e.material.side){case cl:n=this.materialsFlatShadedDoubleSide;break;case Pc:n=this.materialsFlatShadedBackSide;break;default:n=this.materialsFlatShaded;break}else switch(e.material.side){case cl:n=this.materialsDoubleSide;break;case Pc:n=this.materialsBackSide;break;default:n=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++this.meshCount}}}cloneMaterial(t){if(!(t instanceof Bc))return t.clone();const e=t.uniforms,n=new Map;for(const r in e){const s=e[r].value;s.isRenderTargetTexture&&(e[r].value=null,n.set(r,s))}const i=t.clone();for(const r of n)e[r[0]].value=r[1],i.uniforms[r[0]].value=r[1];return i}setMaterial(t){if(this.disposeMaterials(),this.material=t,t!==null){const e=this.materials=[this.cloneMaterial(t),this.cloneMaterial(t),this.cloneMaterial(t)];for(const n of e)n.uniforms=Object.assign({},t.uniforms),n.side=Dg;e[2].skinning=!0,this.materialsBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=Pc,i}),this.materialsDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.side=cl,i}),this.materialsFlatShaded=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i}),this.materialsFlatShadedBackSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=Pc,i}),this.materialsFlatShadedDoubleSide=e.map(n=>{const i=this.cloneMaterial(n);return i.uniforms=Object.assign({},t.uniforms),i.flatShading=!0,i.side=cl,i})}}render(t,e,n){const i=t.shadowMap.enabled;if(t.shadowMap.enabled=!1,JH){const r=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),t.render(e,n);for(const s of r)s[0].material=s[1];this.meshCount!==r.size&&r.clear()}else{const r=e.overrideMaterial;e.overrideMaterial=this.material,t.render(e,n),e.overrideMaterial=r}t.shadowMap.enabled=i}disposeMaterials(){if(this.material!==null){const t=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of t)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return JH}static set workaroundEnabled(t){JH=t}},f_=-1,Cw=class extends Yd{constructor(t,e=f_,n=f_,i=1){super(),this.resizable=t,this.baseSize=new Rt(1,1),this.preferredSize=new Rt(e,n),this.target=this.preferredSize,this.s=i,this.effectiveSize=new Rt,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const t=this.baseSize,e=this.preferredSize,n=this.effectiveSize,i=this.scale;e.width!==f_?n.width=e.width:e.height!==f_?n.width=Math.round(e.height*(t.width/Math.max(t.height,1))):n.width=Math.round(t.width*i),e.height!==f_?n.height=e.height:e.width!==f_?n.height=Math.round(e.width/Math.max(t.width/Math.max(t.height,1),1)):n.height=Math.round(t.height*i)}get width(){return this.effectiveSize.width}set width(t){this.preferredWidth=t}get height(){return this.effectiveSize.height}set height(t){this.preferredHeight=t}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(t){this.s!==t&&(this.s=t,this.preferredSize.setScalar(f_),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(t){this.scale=t}get baseWidth(){return this.baseSize.width}set baseWidth(t){this.baseSize.width!==t&&(this.baseSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(t){this.baseWidth=t}get baseHeight(){return this.baseSize.height}set baseHeight(t){this.baseSize.height!==t&&(this.baseSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(t){this.baseHeight=t}setBaseSize(t,e){(this.baseSize.width!==t||this.baseSize.height!==e)&&(this.baseSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(t){this.preferredSize.width!==t&&(this.preferredSize.width=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(t){this.preferredWidth=t}get preferredHeight(){return this.preferredSize.height}set preferredHeight(t){this.preferredSize.height!==t&&(this.preferredSize.height=t,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(t){this.preferredHeight=t}setPreferredSize(t,e){(this.preferredSize.width!==t||this.preferredSize.height!==e)&&(this.preferredSize.set(t,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(t){this.s=t.scale,this.baseSize.set(t.baseWidth,t.baseHeight),this.preferredSize.set(t.preferredWidth,t.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return f_}},Or={SKIP:9,SET:30,ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},Jft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y,opacity);}",Zft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,min(y.a,opacity));}",Qft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y)*0.5,opacity);}",ept="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.rg,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",tpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(step(0.0,y)*(1.0-min(vec4(1.0),(1.0-x)/y)),vec4(1.0),step(1.0,x));return mix(x,z,opacity);}",npt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=step(0.0,x)*mix(min(vec4(1.0),x/max(1.0-y,1e-9)),vec4(1.0),step(1.0,y));return mix(x,z,opacity);}",ipt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x,y),opacity);}",rpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,abs(x-y),opacity);}",spt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x/max(y,1e-12),opacity);}",apt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,(x+y-2.0*x*y),opacity);}",opt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 a=min(x,1.0),b=min(y,1.0);vec4 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,y));return mix(x,z,opacity);}",cpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,step(1.0,x+y),opacity);}",lpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.r,xHSL.gb));return vec4(mix(x.rgb,z,opacity),y.a);}",upt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-y,opacity);}",hpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y*(1.0-x),opacity);}",dpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x,y),opacity);}",fpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(y+x-1.0,0.0,1.0),opacity);}",ppt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,min(x+y,1.0),opacity);}",mpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,clamp(2.0*y+x-1.0,0.0,1.0),opacity);}",gpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.rg,yHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",vpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x*y,opacity);}",ypt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,1.0-abs(1.0-x-y),opacity);}",_pt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",bpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(2.0*y*x,1.0-2.0*(1.0-y)*(1.0-x),step(0.5,x));return mix(x,z,opacity);}",Ept="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 z=mix(mix(y2,x,step(0.5*x,y)),max(vec4(0.0),y2-1.0),step(x,(y2-1.0)));return mix(x,z,opacity);}",Spt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(min(x*x/max(1.0-y,1e-12),1.0),y,step(1.0,y));return mix(x,z,opacity);}",Tpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.r,yHSL.g,xHSL.b));return vec4(mix(x.rgb,z,opacity),y.a);}",xpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,x+y-min(x*y,1.0),opacity);}",wpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 y2=2.0*y;vec4 w=step(0.5,y);vec4 z=mix(x-(1.0-y2)*x*(1.0-x),mix(x+(y2-1.0)*(sqrt(x)-x),x+(y2-1.0)*x*((16.0*x-12.0)*x+3.0),w*(1.0-step(0.25,x))),w);return mix(x,z,opacity);}",Cpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Rpt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,max(x+y-1.0,0.0),opacity);}",Apt="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=mix(max(1.0-min((1.0-x)/(2.0*y),1.0),0.0),min(x/(2.0*(1.0-y)),1.0),step(0.5,y));return mix(x,z,opacity);}",Mpt=new Map([[Or.ADD,Jft],[Or.ALPHA,Zft],[Or.AVERAGE,Qft],[Or.COLOR,ept],[Or.COLOR_BURN,tpt],[Or.COLOR_DODGE,npt],[Or.DARKEN,ipt],[Or.DIFFERENCE,rpt],[Or.DIVIDE,spt],[Or.DST,null],[Or.EXCLUSION,apt],[Or.HARD_LIGHT,opt],[Or.HARD_MIX,cpt],[Or.HUE,lpt],[Or.INVERT,upt],[Or.INVERT_RGB,hpt],[Or.LIGHTEN,dpt],[Or.LINEAR_BURN,fpt],[Or.LINEAR_DODGE,ppt],[Or.LINEAR_LIGHT,mpt],[Or.LUMINOSITY,gpt],[Or.MULTIPLY,vpt],[Or.NEGATION,ypt],[Or.NORMAL,_pt],[Or.OVERLAY,bpt],[Or.PIN_LIGHT,Ept],[Or.REFLECT,Spt],[Or.SATURATION,Tpt],[Or.SCREEN,xpt],[Or.SOFT_LIGHT,wpt],[Or.SRC,Cpt],[Or.SUBTRACT,Rpt],[Or.VIVID_LIGHT,Apt]]),Opt=class extends Yd{constructor(t,e=1){super(),this._blendFunction=t,this.opacity=new Yi(e)}getOpacity(){return this.opacity.value}setOpacity(t){this.opacity.value=t}get blendFunction(){return this._blendFunction}set blendFunction(t){this._blendFunction=t,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(t){this.blendFunction=t}getShaderCode(){return Mpt.get(this.blendFunction)}},RG=class extends Yd{constructor(t,e,{attributes:n=gb.NONE,blendFunction:i=Or.NORMAL,defines:r=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=t,this.renderer=null,this.attributes=n,this.fragmentShader=e,this.vertexShader=o,this.defines=r,this.uniforms=s,this.extensions=a,this.blendMode=new Opt(i),this.blendMode.addEventListener("change",c=>this.setChanged()),this._inputColorSpace=Lg,this._outputColorSpace=$p}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(t){this._inputColorSpace=t,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t,this.setChanged()}set mainScene(t){}set mainCamera(t){}getName(){return this.name}setRenderer(t){this.renderer=t}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(t){this.attributes=t,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(t){this.fragmentShader=t,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(t){this.vertexShader=t,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(t,e=Ub){}update(t,e,n){}setSize(t,e){}initialize(t,e,n){}dispose(){for(const t of Object.keys(this)){const e=this[t];(e instanceof Ul||e instanceof yl||e instanceof Pa||e instanceof gm)&&this[t].dispose()}}},RD={RED:0,GREEN:1,BLUE:2,ALPHA:3},qve=class extends gm{constructor(t,e,n=null){super("RenderPass",t,e),this.needsSwap=!1,this.clearPass=new Gve,this.overrideMaterialManager=n===null?null:new lie(n),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(t){this.scene=t}set mainCamera(t){this.camera=t}get renderToScreen(){return super.renderToScreen}set renderToScreen(t){super.renderToScreen=t,this.clearPass.renderToScreen=t}get overrideMaterial(){const t=this.overrideMaterialManager;return t!==null?t.material:null}set overrideMaterial(t){const e=this.overrideMaterialManager;t!==null?e!==null?e.setMaterial(t):this.overrideMaterialManager=new lie(t):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(t){this.overrideMaterial=t}get clear(){return this.clearPass.enabled}set clear(t){this.clearPass.enabled=t}getSelection(){return this.selection}setSelection(t){this.selection=t}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(t){this.ignoreBackground=t}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(t){this.skipShadowMapUpdate=t}getClearPass(){return this.clearPass}render(t,e,n,i,r){const s=this.scene,a=this.camera,o=this.selection,c=a.layers.mask,l=s.background,u=t.shadowMap.autoUpdate,h=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(t.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(t,e),t.setRenderTarget(h),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(t,s,a):t.render(s,a),a.layers.mask=c,s.background=l,t.shadowMap.autoUpdate=u}},Npt=`#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
#ifdef DOWNSAMPLE_NORMALS
uniform lowp sampler2D normalBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}int findBestDepth(const in float samples[4]){float c=(samples[0]+samples[1]+samples[2]+samples[3])*0.25;float distances[4];distances[0]=abs(c-samples[0]);distances[1]=abs(c-samples[1]);distances[2]=abs(c-samples[2]);distances[3]=abs(c-samples[3]);float maxDistance=max(max(distances[0],distances[1]),max(distances[2],distances[3]));int remaining[3];int rejected[3];int i,j,k;for(i=0,j=0,k=0;i<4;++i){if(distances[i]<maxDistance){remaining[j++]=i;}else{rejected[k++]=i;}}for(;j<3;++j){remaining[j]=rejected[--k];}vec3 s=vec3(samples[remaining[0]],samples[remaining[1]],samples[remaining[2]]);c=(s.x+s.y+s.z)/3.0;distances[0]=abs(c-s.x);distances[1]=abs(c-s.y);distances[2]=abs(c-s.z);float minDistance=min(distances[0],min(distances[1],distances[2]));for(i=0;i<3;++i){if(distances[i]==minDistance){break;}}return remaining[i];}void main(){float d[4];d[0]=readDepth(vUv0);d[1]=readDepth(vUv1);d[2]=readDepth(vUv2);d[3]=readDepth(vUv3);int index=findBestDepth(d);
#ifdef DOWNSAMPLE_NORMALS
vec3 n[4];n[0]=texture2D(normalBuffer,vUv0).rgb;n[1]=texture2D(normalBuffer,vUv1).rgb;n[2]=texture2D(normalBuffer,vUv2).rgb;n[3]=texture2D(normalBuffer,vUv3).rgb;
#else
vec3 n[4];n[0]=vec3(0.0);n[1]=vec3(0.0);n[2]=vec3(0.0);n[3]=vec3(0.0);
#endif
gl_FragColor=vec4(n[index],d[index]);}`,Ipt="uniform vec2 texelSize;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vUv0=uv;vUv1=vec2(uv.x,uv.y+texelSize.y);vUv2=vec2(uv.x+texelSize.x,uv.y);vUv3=uv+texelSize;gl_Position=vec4(position.xy,1.0,1.0);}",kpt=class extends Bc{constructor(){super({name:"DepthDownsamplingMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new Yi(null),normalBuffer:new Yi(null),texelSize:new Yi(new Rt)},blending:Yf,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Npt,vertexShader:Ipt})}set depthBuffer(t){this.uniforms.depthBuffer.value=t}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=Ub){this.depthBuffer=t,this.depthPacking=e}set normalBuffer(t){this.uniforms.normalBuffer.value=t,t!==null?this.defines.DOWNSAMPLE_NORMALS="1":delete this.defines.DOWNSAMPLE_NORMALS,this.needsUpdate=!0}setNormalBuffer(t){this.normalBuffer=t}setTexelSize(t,e){this.uniforms.texelSize.value.set(t,e)}setSize(t,e){this.uniforms.texelSize.value.set(1/t,1/e)}},Dpt=class extends gm{constructor({normalBuffer:t=null,resolutionScale:e=.5,width:n=Cw.AUTO_SIZE,height:i=Cw.AUTO_SIZE,resolutionX:r=n,resolutionY:s=i}={}){super("DepthDownsamplingPass");const a=new kpt;a.normalBuffer=t,this.fullscreenMaterial=a,this.needsDepthTexture=!0,this.needsSwap=!1,this.renderTarget=new Ul(1,1,{minFilter:Za,magFilter:Za,depthBuffer:!1,type:iu}),this.renderTarget.texture.name="DepthDownsamplingPass.Target",this.renderTarget.texture.generateMipmaps=!1;const o=this.resolution=new Cw(this,r,s,e);o.addEventListener("change",c=>this.setSize(o.baseWidth,o.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}setDepthTexture(t,e=Ub){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e}render(t,e,n,i,r){t.setRenderTarget(this.renderToScreen?null:this.renderTarget),t.render(this.scene,this.camera)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height),this.fullscreenMaterial.setSize(t,e)}initialize(t,e,n){const i=t.getContext();if(!(i.getExtension("EXT_color_buffer_float")||i.getExtension("EXT_color_buffer_half_float")))throw new Error("Rendering to float texture is not supported.")}},Ppt=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,Lpt="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",Upt=class extends Bc{constructor(t,e,n,i,r=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:$O.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new Yi(null),depthBuffer:new Yi(null),resolution:new Yi(new Rt),texelSize:new Yi(new Rt),cameraNear:new Yi(.3),cameraFar:new Yi(1e3),aspect:new Yi(1),time:new Yi(0)},blending:Yf,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:r}),t&&this.setShaderParts(t),e&&this.setDefines(e),n&&this.setUniforms(n),this.copyCameraSettings(i)}set inputBuffer(t){this.uniforms.inputBuffer.value=t}setInputBuffer(t){this.uniforms.inputBuffer.value=t}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(t){this.uniforms.depthBuffer.value=t}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(t){this.defines.DEPTH_PACKING=t.toFixed(0),this.needsUpdate=!0}setDepthBuffer(t,e=Ub){this.depthBuffer=t,this.depthPacking=e}setShaderData(t){this.setShaderParts(t.shaderParts),this.setDefines(t.defines),this.setUniforms(t.uniforms),this.setExtensions(t.extensions)}setShaderParts(t){return this.fragmentShader=Ppt.replace(ss.FRAGMENT_HEAD,t.get(ss.FRAGMENT_HEAD)||"").replace(ss.FRAGMENT_MAIN_UV,t.get(ss.FRAGMENT_MAIN_UV)||"").replace(ss.FRAGMENT_MAIN_IMAGE,t.get(ss.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=Lpt.replace(ss.VERTEX_HEAD,t.get(ss.VERTEX_HEAD)||"").replace(ss.VERTEX_MAIN_SUPPORT,t.get(ss.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(t){for(const e of t.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(t){for(const e of t.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(t){this.extensions={};for(const e of t)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(t){this.encodeOutput!==t&&(t?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(t){return this.encodeOutput}setOutputEncodingEnabled(t){this.encodeOutput=t}get time(){return this.uniforms.time.value}set time(t){this.uniforms.time.value=t}setDeltaTime(t){this.uniforms.time.value+=t}adoptCameraSettings(t){this.copyCameraSettings(t)}copyCameraSettings(t){t&&(this.uniforms.cameraNear.value=t.near,this.uniforms.cameraFar.value=t.far,t instanceof Ic?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(t,e){const n=this.uniforms;n.resolution.value.set(t,e),n.texelSize.value.set(1/t,1/e),n.aspect.value=t/e}static get Section(){return ss}};function uie(t,e,n){for(const i of e){const r="$1"+t+i.charAt(0).toUpperCase()+i.slice(1),s=new RegExp("([^\\.])(\\b"+i+"\\b)","g");for(const a of n.entries())a[1]!==null&&n.set(a[0],a[1].replace(s,r))}}function Bpt(t,e,n){let i=e.getFragmentShader(),r=e.getVertexShader();const s=i!==void 0&&/mainImage/.test(i),a=i!==void 0&&/mainUv/.test(i);if(n.attributes|=e.getAttributes(),i===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&n.attributes&gb.CONVOLUTION)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,c=n.shaderParts;let l=c.get(ss.FRAGMENT_HEAD)||"",u=c.get(ss.FRAGMENT_MAIN_UV)||"",h=c.get(ss.FRAGMENT_MAIN_IMAGE)||"",d=c.get(ss.VERTEX_HEAD)||"",f=c.get(ss.VERTEX_MAIN_SUPPORT)||"";const p=new Set,g=new Set;if(a&&(u+=`	${t}MainUv(UV);
`,n.uvTransformation=!0),r!==null&&/mainSupport/.test(r)){const E=/mainSupport *\([\w\s]*?uv\s*?\)/.test(r);f+=`	${t}MainSupport(`,f+=E?`vUv);
`:`);
`;for(const T of r.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const x of T[1].split(/\s*,\s*/))n.varyings.add(x),p.add(x),g.add(x);for(const T of r.matchAll(o))g.add(T[1])}for(const E of i.matchAll(o))g.add(E[1]);for(const E of e.defines.keys())g.add(E.replace(/\([\w\s,]*\)/g,""));for(const E of e.uniforms.keys())g.add(E);g.delete("while"),g.delete("for"),g.delete("if"),e.uniforms.forEach((E,T)=>n.uniforms.set(t+T.charAt(0).toUpperCase()+T.slice(1),E)),e.defines.forEach((E,T)=>n.defines.set(t+T.charAt(0).toUpperCase()+T.slice(1),E));const _=new Map([["fragment",i],["vertex",r]]);uie(t,g,n.defines),uie(t,g,_),i=_.get("fragment"),r=_.get("vertex");const v=e.blendMode;if(n.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==n.colorSpace&&(h+=e.inputColorSpace===ya?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==$p?n.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(n.colorSpace=e.inputColorSpace);const E=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;h+=`${t}MainImage(color0, UV, `,n.attributes&gb.DEPTH&&E.test(i)&&(h+="depth, ",n.readDepth=!0),h+=`color1);
	`;const T=t+"BlendOpacity";n.uniforms.set(T,v.opacity),h+=`color0 = blend${v.blendFunction}(color0, color1, ${T});

	`,l+=`uniform float ${T};

`}if(l+=i+`
`,r!==null&&(d+=r+`
`),c.set(ss.FRAGMENT_HEAD,l),c.set(ss.FRAGMENT_MAIN_UV,u),c.set(ss.FRAGMENT_MAIN_IMAGE,h),c.set(ss.VERTEX_HEAD,d),c.set(ss.VERTEX_MAIN_SUPPORT,f),e.extensions!==null)for(const E of e.extensions)n.extensions.add(E)}}var Fpt=class extends gm{constructor(t,...e){super("EffectPass"),this.fullscreenMaterial=new Upt(null,null,null,t),this.listener=n=>this.handleEvent(n),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(t){for(const e of this.effects)e.mainScene=t}set mainCamera(t){this.fullscreenMaterial.copyCameraSettings(t);for(const e of this.effects)e.mainCamera=t}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(t){this.fullscreenMaterial.encodeOutput=t}get dithering(){return this.fullscreenMaterial.dithering}set dithering(t){const e=this.fullscreenMaterial;e.dithering=t,e.needsUpdate=!0}setEffects(t){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=t.sort((e,n)=>n.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const t=new Kft;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===Or.DST)t.attributes|=a.getAttributes()&gb.DEPTH;else{if(t.attributes&a.getAttributes()&gb.CONVOLUTION)throw new Error(`Convolution effects cannot be merged (${a.name})`);Bpt("e"+e++,a,t)}let n=t.shaderParts.get(ss.FRAGMENT_HEAD),i=t.shaderParts.get(ss.FRAGMENT_MAIN_IMAGE),r=t.shaderParts.get(ss.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of t.blendModes.values())n+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;t.attributes&gb.DEPTH?(t.readDepth&&(i=`float depth = readDepth(UV);

	`+i),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,t.colorSpace===ya&&(i+=`color0 = sRGBToLinear(color0);
	`),t.uvTransformation?(r=`vec2 transformedUv = vUv;
`+r,t.defines.set("UV","transformedUv")):t.defines.set("UV","vUv"),t.shaderParts.set(ss.FRAGMENT_HEAD,n),t.shaderParts.set(ss.FRAGMENT_MAIN_IMAGE,i),t.shaderParts.set(ss.FRAGMENT_MAIN_UV,r);for(const[a,o]of t.shaderParts)o!==null&&t.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(t)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(t,e=Ub){this.fullscreenMaterial.depthBuffer=t,this.fullscreenMaterial.depthPacking=e;for(const n of this.effects)n.setDepthTexture(t,e)}render(t,e,n,i,r){for(const s of this.effects)s.update(t,e,i);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=i*this.timeScale,t.setRenderTarget(this.renderToScreen?null:n),t.render(this.scene,this.camera)}}setSize(t,e){this.fullscreenMaterial.setSize(t,e);for(const n of this.effects)n.setSize(t,e)}initialize(t,e,n){this.renderer=t;for(const i of this.effects)i.initialize(t,e,n);this.updateMaterial(),n!==void 0&&n!==ml&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const t of this.effects)t.removeEventListener("change",this.listener),t.dispose()}handleEvent(t){switch(t.type){case"change":this.recompile();break}}},zpt=class extends gm{constructor(t,e,{renderTarget:n,resolutionScale:i=1,width:r=Cw.AUTO_SIZE,height:s=Cw.AUTO_SIZE,resolutionX:a=r,resolutionY:o=s}={}){super("NormalPass"),this.needsSwap=!1,this.renderPass=new qve(t,e,new Iq);const c=this.renderPass;c.ignoreBackground=!0,c.skipShadowMapUpdate=!0;const l=c.getClearPass();l.overrideClearColor=new _n(7829503),l.overrideClearAlpha=1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Ul(1,1,{minFilter:Za,magFilter:Za}),this.renderTarget.texture.name="NormalPass.Target");const u=this.resolution=new Cw(this,a,o,i);u.addEventListener("change",h=>this.setSize(u.baseWidth,u.baseHeight))}set mainScene(t){this.renderPass.mainScene=t}set mainCamera(t){this.renderPass.mainCamera=t}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}getResolutionScale(){return this.resolution.scale}setResolutionScale(t){this.resolution.scale=t}render(t,e,n,i,r){const s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(t,s,s)}setSize(t,e){const n=this.resolution;n.setBaseSize(t,e),this.renderTarget.setSize(n.width,n.height)}};function aM(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}new Rt;new Rt;function $ve(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Sf=function t(e,n,i){var r=this;$ve(this,t),aM(this,"dot2",function(s,a){return r.x*s+r.y*a}),aM(this,"dot3",function(s,a,o){return r.x*s+r.y*a+r.z*o}),this.x=e,this.y=n,this.z=i},Hpt=[new Sf(1,1,0),new Sf(-1,1,0),new Sf(1,-1,0),new Sf(-1,-1,0),new Sf(1,0,1),new Sf(-1,0,1),new Sf(1,0,-1),new Sf(-1,0,-1),new Sf(0,1,1),new Sf(0,-1,1),new Sf(0,1,-1),new Sf(0,-1,-1)],hie=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],die=new Array(512),fie=new Array(512),jpt=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var n=0;n<256;n++){var i;n&1?i=hie[n]^e&255:i=hie[n]^e>>8&255,die[n]=die[n+256]=i,fie[n]=fie[n+256]=Hpt[i%12]}};jpt(0);function Vpt(t){if(typeof t=="number")t=Math.abs(t);else if(typeof t=="string"){var e=t;t=0;for(var n=0;n<e.length;n++)t=(t+(n+1)*(e.charCodeAt(n)%96))%2147483647}return t===0&&(t=311),t}function pie(t){var e=Vpt(t);return function(){var n=e*48271%2147483647;return e=n,n/2147483647}}var Gpt=function t(e){var n=this;$ve(this,t),aM(this,"seed",0),aM(this,"init",function(i){n.seed=i,n.value=pie(i)}),aM(this,"value",pie(this.seed)),this.init(e)};new Gpt(Math.random());const qpt=Be.createContext(null),mie=t=>(t.getAttributes()&2)===2,$pt=Be.memo(Be.forwardRef(({children:t,camera:e,scene:n,resolutionScale:i,enabled:r=!0,renderPriority:s=1,autoClear:a=!0,depthBuffer:o,enableNormalPass:c,stencilBuffer:l,multisampling:u=8,frameBufferType:h=Lb},d)=>{const{gl:f,scene:p,camera:g,size:_}=Zu(),v=n||p,E=e||g,[T,x,N]=Be.useMemo(()=>{const k=new Xft(f,{depthBuffer:o,stencilBuffer:l,multisampling:u,frameBufferType:h});k.addPass(new qve(v,E));let L=null,U=null;return c&&(U=new zpt(v,E),U.enabled=!1,k.addPass(U),i!==void 0&&(L=new Dpt({normalBuffer:U.texture,resolutionScale:i}),L.enabled=!1,k.addPass(L))),[k,U,L]},[E,f,o,l,u,h,v,c,i]);Be.useEffect(()=>T==null?void 0:T.setSize(_.width,_.height),[T,_]),hy((k,L)=>{if(r){const U=f.autoClear;f.autoClear=a,l&&!a&&f.clearStencil(),T.render(L),f.autoClear=U}},r?s:0);const A=Be.useRef(null);Be.useLayoutEffect(()=>{var U;const k=[],L=A.current.__r3f;if(L&&T){const $=L.children;for(let q=0;q<$.length;q++){const G=$[q].object;if(G instanceof RG){const X=[G];if(!mie(G)){let V=null;for(;(V=(U=$[q+1])==null?void 0:U.object)instanceof RG&&!mie(V);)X.push(V),q++}const ie=new Fpt(E,...X);k.push(ie)}else G instanceof gm&&k.push(G)}for(const q of k)T==null||T.addPass(q);x&&(x.enabled=!0),N&&(N.enabled=!0)}return()=>{for(const $ of k)T==null||T.removePass($);x&&(x.enabled=!1),N&&(N.enabled=!1)}},[T,t,E,x,N]),Be.useEffect(()=>{const k=f.toneMapping;return f.toneMapping=Kp,()=>{f.toneMapping=k}},[f]);const I=Be.useMemo(()=>({composer:T,normalPass:x,downSamplingPass:N,resolutionScale:i,camera:E,scene:v}),[T,x,N,i,E,v]);return Be.useImperativeHandle(d,()=>T,[T]),Ae.jsx(qpt.Provider,{value:I,children:Ae.jsx("group",{ref:A,children:t})})}));let Wpt=0;const gie=new WeakMap,Ypt=(t,e)=>function({blendFunction:n=e==null?void 0:e.blendFunction,opacity:i=e==null?void 0:e.opacity,...r}){let s=gie.get(t);if(!s){const c=`@react-three/postprocessing/${t.name}-${Wpt++}`;Toe({[c]:t}),gie.set(t,s=c)}const a=Zu(c=>c.camera),o=Eg.useMemo(()=>[...(e==null?void 0:e.args)??[],...r.args??[{...e,...r}]],[JSON.stringify(r)]);return Ae.jsx(s,{camera:a,"blendMode-blendFunction":n,"blendMode-opacity-value":i,...r,args:o})};var op=typeof window<"u"?window:{screen:{},navigator:{}},AC=(op.matchMedia||function(){return{matches:!1}}).bind(op),Xpt={get passive(){return!0}},Wve=function(){};op.addEventListener&&op.addEventListener("p",Wve,Xpt);op.removeEventListener&&op.removeEventListener("p",Wve,!1);var CY="ontouchstart"in op,Kpt="TouchEvent"in op,Jpt=CY||Kpt&&AC("(any-pointer: coarse)").matches,vie=(op.navigator.maxTouchPoints||0)>0||Jpt,Yve=op.navigator.userAgent||"",Zpt=AC("(pointer: coarse)").matches&&/iPad|Macintosh/.test(Yve)&&Math.min(op.screen.width||0,op.screen.height||0)>=768,Xve=(AC("(pointer: coarse)").matches||!AC("(pointer: fine)").matches&&CY)&&!/Windows.*Firefox/.test(Yve),Qpt=AC("(any-pointer: fine)").matches||AC("(any-hover: hover)").matches||Zpt||!CY,AG=vie&&(Qpt||!Xve)?"hybrid":vie?"touchOnly":"mouseOnly",emt=AG==="mouseOnly"?"mouse":AG==="touchOnly"||Xve?"touch":"mouse";const tmt=`  
vec3 halftone(vec3 texcolor, vec2 st, float frequency) {
  float n = 0.1 * snoise(st * 200.0); // Fractal noise
  n += 0.05 * snoise(st * 400.0);
  n += 0.025 * snoise(st * 800.0);

  // Perform a rough RGB-to-CMYK conversion
  vec4 cmyk;
  // CMY = 1-RGB
  cmyk.xyz = 1.0 - texcolor;
  // Black generation: K = min(C,M,Y)
  cmyk.w = min(cmyk.x, min(cmyk.y, cmyk.z)); 
  // Grey component replacement: subtract K from CMY
  cmyk.xyz -= cmyk.w; 

  // K based modifier
  float flex = pow(cmyk.w, 3.11);

  // Distance to nearest point in a grid of
  // (frequency x frequency) points over the unit square
  
  float t = 0.1 + 0.1 * n + 0.11 * flex + 0.1 * cmyk.y;

  // K component: 45 degrees screen angle
  vec2 Kst = frequency * mat2(0.707, -0.707, 0.707, 0.707) * st;
  vec2 Kuv = 2.0 * fract(Kst) - 1.0; 
  float k = aastep(0.0, sqrt(cmyk.w) + t - length(Kuv) + n);
  
  // C component: 15 degrees screen angle
  vec2 Cst = frequency*mat2(0.966, -0.259, 0.259, 0.966) * st;
  vec2 Cuv = 2.0 * fract(Cst) - 1.0;
  float c = aastep(0.0, sqrt(cmyk.x) + t - length(Cuv) + n);
  
  // M component: -15 degrees screen angle
  vec2 Mst = frequency * mat2(0.966, 0.259, -0.259, 0.966) * st;
  vec2 Muv = 2.0 * fract(Mst) - 1.0;
  float m = aastep(0.0, sqrt(cmyk.y) + t - length(Muv) + n);

  // Y component: 0 degrees screen angle
  vec2 Yst = frequency * st; // 0 deg 
  vec2 Yuv = 2.0 * fract(Yst) - 1.0;
  float y = aastep(0.0, sqrt(cmyk.z) + t - length(Yuv) + n);

  // CMY screen in RGB
  vec3 black = vec3(n + 0.01);
  vec3 rgbscreen = 1.0 - vec3(c,m,y) + n;
  
  // Blend in K for final color
  vec3 factor = mix(rgbscreen, black, 1.1 * k + 0.3 * n);

  // Blend with og color
  return mix(factor, texcolor, 0.777);
}

vec3 halftone(vec3 texcolor, vec2 st) {
  return halftone(texcolor, st, 412.321);
}
`,nmt=`
float blendLighten(float base, float blend) {
	return max(blend,base);
}

vec3 blendLighten(vec3 base, vec3 blend) {
	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));
}

vec3 blendLighten(vec3 base, vec3 blend, float opacity) {
	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));
}

float blendDarken(float base, float blend) {
	return min(blend,base);
}

vec3 blendDarken(vec3 base, vec3 blend) {
	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));
}

vec3 blendDarken(vec3 base, vec3 blend, float opacity) {
	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));
}
`,imt=`
float aastep(float threshold, float value) {
  float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;
  return smoothstep(threshold-afwidth, threshold+afwidth, value);
}
`,rmt=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`,smt=`
#ifdef ASPECT_CORRECTION
	uniform float scale;
#else
	uniform mat3 uvTransform;
#endif

varying vec2 vUv2;

void mainSupport(const in vec2 uv) {
	#ifdef ASPECT_CORRECTION
		vUv2 = uv * vec2(aspect, 1.0) * scale;
	#else
		vUv2 = (uvTransform * vec3(uv, 1.0)).xy;
	#endif
}
`,amt=`
uniform float viewheight;
uniform sampler2D splat;

${nmt}
${imt}
${rmt}
${tmt}

float rectdistance(vec2 uv) {
  vec2 tl = vec2(-1.0);
  vec2 br = vec2(1.0);
  vec2 d = max(tl - uv, uv - br);
  return abs(length(max(vec2(0.0), d)) + min(0.0, max(d.x, d.y)));
}

vec2 bendy(const in vec2 xn, float dn, float sn) {
  // config
  float distortion = 0.0173 + dn; // 0.0173, 0.511
  float scale = 0.991 + sn; // 1.0, 0.7
  // calc
  vec3 xDistorted = vec3((1.0 + vec2(distortion, distortion) * dot(xn, xn)) * xn, 1.0);
  mat3 kk = mat3(
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0)
  );
  return (kk * xDistorted).xy * scale;
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
	#ifdef UV_TRANSFORM
		vec4 bright = texture2D(splat, vUv2);
		vec4 dark = texture2D(splat, 1.0 - vUv2);
	#else
		vec4 bright = texture2D(splat, uv);
		vec4 dark = texture2D(splat, 1.0 - uv);
	#endif
  
  float n = 0.1 * snoise(uv.st * 200.0); // Fractal noise
  n += 0.05 * snoise(uv.st * 400.0);
  n += 0.025 * snoise(uv.st * 800.0);

  vec2 xn = 2.0 * (uv.st - 0.5);
  float fz = 0.005;
  vec2 edge = bendy(xn, fz * n, -fz * n);
  vec2 bent = edge.xy * 0.5 + 0.5;
  
  float dx = rectdistance(xn);
  float bx = rectdistance(edge);

  // apply shape
  float doot = max(abs(edge.x), abs(edge.y));
  if (doot < 1.0) {
    // display
    outputColor = texture2D(inputBuffer, bent);

    // apply scratches
    outputColor.rgb = blendLighten(outputColor.rgb, bright.rgb, 0.079);
    outputColor.rgb = blendDarken(outputColor.rgb, dark.rgb, 0.0666);

    // apply halftones
    outputColor.rgb = halftone(outputColor.rgb, uv.st);
  
  } else if (doot > 1.004) {
    // display shell
    // rbgb 205 205 193
    vec3 matte = vec3(205.0 / 255.0, 205.0 / 255.0, 193.0 / 255.0);
    vec3 dkmatte = mix(matte, vec3(0.0), 0.5);
    float mx = pow(1.0 - bx, 16.0) + n;
    outputColor = vec4(mix(matte, dkmatte, mx), inputColor.a);

  } else {
    // border
    outputColor = vec4(mix(vec3(0.0), outputColor.rgb, 0.5), inputColor.a);
  }

  // apply inner shade
  if (doot >= 0.5 && doot < 1.0) {
    float sh = clamp(0.0, 1.0, 1.0 - bx - 0.7);
    vec3 shade = mix(outputColor.rgb, vec3(0.0), pow(sh, 4.0));
    outputColor = vec4(shade, inputColor.a);
  }

  // apply outer shade
  if (doot >= 0.97) {
    float sh = clamp(0.0, 1.0, bx * 24.0);
    vec3 dkout = mix(vec3(0.0), outputColor.rgb, 0.81);
    vec3 shade = mix(dkout, outputColor.rgb, sh);
    outputColor = vec4(shade, inputColor.a);
  }
}
`;class omt extends RG{constructor({splat:e,viewheight:n}={}){super("CRTShapeEffect",amt,{blendFunction:Or.NORMAL,attributes:gb.CONVOLUTION,defines:new Map([["TEXEL","texel"],["TEXTURE_PRECISION_HIGH","1"]]),uniforms:new Map([["splat",new Yi(e)],["viewheight",new Yi(n??128)]])})}get splat(){var e;return(e=this.uniforms.get("splat"))==null?void 0:e.value}set splat(e){const{splat:n,uniforms:i,defines:r}=this,s=i.get("splat"),a=i.get("uvTransform");n!==e&&s&&a&&(s.value=e,a.value=e.matrix,r.delete("TEXTURE_PRECISION_HIGH"),e!==null&&(e.matrixAutoUpdate?(r.set("UV_TRANSFORM","1"),this.setVertexShader(smt)):(r.delete("UV_TRANSFORM"),this.setVertexShader(null)),e.type!==ml&&r.set("TEXTURE_PRECISION_HIGH","1"),(n===null||(n==null?void 0:n.type)!==e.type)&&this.setChanged()))}getTexture(){return this.splat}setTexture(e){this.splat=e}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(e){this.aspectCorrection!==e&&(e?this.defines.set("ASPECT_CORRECTION","1"):this.defines.delete("ASPECT_CORRECTION"),this.setChanged())}get uvTransform(){const e=this.splat;return!!(e!=null&&e.matrixAutoUpdate)}set uvTransform(e){const n=this.splat;ae(n)&&(n.matrixAutoUpdate=e)}setTextureSwizzleRGBA(e,n=e,i=e,r=e){const s="rgba";let a="";(e!==RD.RED||n!==RD.GREEN||i!==RD.BLUE||r!==RD.ALPHA)&&(a=[".",s[e],s[n],s[i],s[r]].join("")),this.defines.set("TEXEL","texel"+a),this.setChanged()}update(){var e;(e=this.splat)!=null&&e.matrixAutoUpdate&&this.splat.updateMatrix()}}const cmt=Ypt(omt),lmt=new Re,Kve=Be.createContext([]);function G6(){return Be.useContext(Kve)}function Jve({width:t=0,height:e=0,children:n,...i}){const r=Be.useRef(null),[s]=Be.useState(()=>{const o=[];return t&&o.push(new Rf,new Rf),e&&o.push(new Rf,new Rf),o}),[a]=Be.useState(()=>[new Re(0,0,0),new Re(0,0,0),new Re(0,0,0),new Re(0,0,0),new Re(0,0,0)]);return hy(()=>{if(r.current){const o=r.current.localToWorld(a[0].set(0,0,0)),c=[];if(t){const l=t*.5;c.push(r.current.localToWorld(a[3].set(l,0,0)),r.current.localToWorld(a[4].set(-l,0,0)))}if(e){const l=e*.5;c.push(r.current.localToWorld(a[1].set(0,l,0)),r.current.localToWorld(a[2].set(0,-l,0)))}for(let l=0;l<s.length;l+=1)s[l].setFromNormalAndCoplanarPoint(lmt.subVectors(o,c[l]).normalize(),c[l])}}),Ae.jsx(Kve.Provider,{value:s,children:Ae.jsx("group",{position:[t*.5,e*.5,0],children:Ae.jsx("group",{ref:r,...i,children:Ae.jsx("group",{position:[t*-.5,e*-.5,0],children:n})})})})}function yie(){}const umt=Eg.forwardRef(function({args:e,children:n,...i},r){const s=Eg.useRef(null);return Eg.useImperativeHandle(r,()=>s.current),Ae.jsxs("mesh",{ref:s,...i,children:[Ae.jsx("planeGeometry",{attach:"geometry",args:e}),n]})}),Fd=Eg.forwardRef(function({blocking:e=!1,cursor:n="default",x:i=0,y:r=0,z:s=0,width:a=1,height:o=1,opacity:c=1,visible:l=!0,color:u="white",...h},d){const f=a*.5,p=o*.5,g=[(i+f)*kn.DRAW_CHAR_WIDTH(),(r+p)*kn.DRAW_CHAR_HEIGHT(),s],_=G6();return Ae.jsx(umt,{ref:d,args:[a*kn.DRAW_CHAR_WIDTH(),o*kn.DRAW_CHAR_HEIGHT()],userData:{blocking:e,cursor:n,clippingPlanes:_},onClick:e?yie:void 0,onPointerMove:e?yie:void 0,position:g,...h,children:Ae.jsx("meshBasicMaterial",{color:u,opacity:c,visible:l,transparent:c!==1,clippingPlanes:_})})}),OU=new Re;function _ie(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(OU.x/t),i=Math.floor((OU.y+e*.5)/e);return{x:n,y:jr*.5+i}}function hmt(){const t=Us(u=>u.inspector),[e,n]=n1(ap(u=>[u.cursor,u.select])),i=zQ(e??0,fi),r=zQ(n??e??0,fi),s={x:Math.min(i.x,r.x),y:Math.min(i.y,r.y)},a={x:Math.max(i.x,r.x),y:Math.max(i.y,r.y)},o=a.x-s.x+1,c=a.y-s.y+1;function l(){n1.getState().cursor&&QDe(Ge,nr(),s,a),n1.setState(()=>({cursor:void 0,select:void 0}))}return Ae.jsxs(Ae.Fragment,{children:[t?Ae.jsx(Fd,{visible:!0,x:0,y:0,z:-1,width:fi,height:jr,color:"black",cursor:"pointer",onPointerDown:u=>{u.intersections[0].object.worldToLocal(OU.copy(u.intersections[0].point));const h=_ie();n1.setState(()=>({cursor:mT(h,fi)}))},onPointerMove:u=>{if(ae(n1.getState().cursor)){u.intersections[0].object.worldToLocal(OU.copy(u.intersections[0].point));const h=_ie();n1.setState(()=>({select:mT(h,fi)}))}},onPointerUp:l,onPointerOut:l,onPointerCancel:l}):Ae.jsx(Fd,{visible:!0,x:0,y:0,z:-1,width:fi,height:jr,color:"black"}),ae(e)&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Fd,{x:s.x+.25,y:s.y+.25,z:100,width:o-.5,height:c-.5,color:"black",opacity:.3}),Ae.jsx(Fd,{x:s.x,y:s.y,z:101,width:o,height:c,color:"white",opacity:.25})]})]})}class dmt{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const n of this._parts)e.push(n);return fmt(e).buffer}}function fmt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t){const s=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);n.set(s,i),i+=r.byteLength}return n}function Zve(t){return new pmt(t).unpack()}function Qve(t){const e=new mmt,n=e.pack(t);return n instanceof Promise?n.then(()=>e.getBuffer()):e.getBuffer()}class pmt{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let n;if((n=e^160)<=15)return this.unpack_raw(n);if((n=e^176)<=15)return this.unpack_string(n);if((n=e^144)<=15)return this.unpack_array(n);if((n=e^128)<=15)return this.unpack_map(n);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return n=this.unpack_uint16(),this.unpack_string(n);case 217:return n=this.unpack_uint32(),this.unpack_string(n);case 218:return n=this.unpack_uint16(),this.unpack_raw(n);case 219:return n=this.unpack_uint32(),this.unpack_raw(n);case 220:return n=this.unpack_uint16(),this.unpack_array(n);case 221:return n=this.unpack_uint32(),this.unpack_array(n);case 222:return n=this.unpack_uint16(),this.unpack_map(n);case 223:return n=this.unpack_uint32(),this.unpack_map(n)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),n=(e[0]&255)*256+(e[1]&255);return this.index+=2,n}unpack_uint32(){const e=this.read(4),n=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,n}unpack_uint64(){const e=this.read(8),n=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,n}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const n=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,n}unpack_string(e){const n=this.read(e);let i=0,r="",s,a;for(;i<e;)s=n[i],s<160?(a=s,i++):(s^192)<32?(a=(s&31)<<6|n[i+1]&63,i+=2):(s^224)<16?(a=(s&15)<<12|(n[i+1]&63)<<6|n[i+2]&63,i+=3):(a=(s&7)<<18|(n[i+1]&63)<<12|(n[i+2]&63)<<6|n[i+3]&63,i+=4),r+=String.fromCodePoint(a);return this.index+=e,r}unpack_array(e){const n=new Array(e);for(let i=0;i<e;i++)n[i]=this.unpack();return n}unpack_map(e){const n={};for(let i=0;i<e;i++){const r=this.unpack();n[r]=this.unpack()}return n}unpack_float(){const e=this.unpack_uint32(),n=e>>31,i=(e>>23&255)-127,r=e&8388607|8388608;return(n===0?1:-1)*r*2**(i-23)}unpack_double(){const e=this.unpack_uint32(),n=this.unpack_uint32(),i=e>>31,r=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(r-20)+n*2**(r-52);return(i===0?1:-1)*a}read(e){const n=this.index;if(n+e<=this.length)return this.dataView.subarray(n,n+e);throw new Error("BinaryPackFailure: read index out of range")}}class mmt{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const n=e.constructor;if(e instanceof Array){const i=this.pack_array(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const i=e;this.pack_bin(new Uint8Array(i.buffer,i.byteOffset,i.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(i=>{this.pack_bin(new Uint8Array(i)),this._bufferBuilder.flush()});if(n==Object||n.toString().startsWith("class")){const i=this.pack_object(e);if(i instanceof Promise)return i.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${n.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const n=e.length;if(n<=15)this.pack_uint8(160+n);else if(n<=65535)this._bufferBuilder.append(218),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(n);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const n=this._textEncoder.encode(e),i=n.length;if(i<=15)this.pack_uint8(176+i);else if(i<=65535)this._bufferBuilder.append(216),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(i);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(n)}pack_array(e){const n=e.length;if(n<=15)this.pack_uint8(144+n);else if(n<=65535)this._bufferBuilder.append(220),this.pack_uint16(n);else if(n<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(n);else throw new Error("Invalid length");const i=r=>{if(r<n){const s=this.pack(e[r]);return s instanceof Promise?s.then(()=>i(r+1)):i(r+1)}};return i(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let n=0;e<0&&(n=1,e=-e);const i=Math.floor(Math.log(e)/Math.LN2),r=e/2**i-1,s=Math.floor(r*2**52),a=2**32,o=n<<31|i+1023<<20|s/a&1048575,c=s%a;this._bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(c)}pack_object(e){const n=Object.keys(e),i=n.length;if(i<=15)this.pack_uint8(128+i);else if(i<=65535)this._bufferBuilder.append(222),this.pack_uint16(i);else if(i<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(i);else throw new Error("Invalid length");const r=s=>{if(s<n.length){const a=n[s];if(e.hasOwnProperty(a)){this.pack(a);const o=this.pack(e[a]);if(o instanceof Promise)return o.then(()=>r(s+1))}return r(s+1)}};return r(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const n=e&4294967295;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255)}pack_uint64(e){const n=e/4294967296,i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const n=Math.floor(e/4294967296),i=e%2**32;this._bufferBuilder.append((n&4278190080)>>>24),this._bufferBuilder.append((n&16711680)>>>16),this._bufferBuilder.append((n&65280)>>>8),this._bufferBuilder.append(n&255),this._bufferBuilder.append((i&4278190080)>>>24),this._bufferBuilder.append((i&16711680)>>>16),this._bufferBuilder.append((i&65280)>>>8),this._bufferBuilder.append(i&255)}constructor(){this._bufferBuilder=new dmt,this._textEncoder=new TextEncoder}}let eye=!0,tye=!0;function RP(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function ix(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(a,o){if(a!==e)return r.apply(this,arguments);const c=l=>{const u=n(l);u&&(o.handleEvent?o.handleEvent(u):o(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,c),r.apply(this,[a,c])};const s=i.removeEventListener;i.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const c=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,c])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function gmt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(eye=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function vmt(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(tye=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function nye(){if(typeof window=="object"){if(eye)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function RY(t,e){tye&&console.warn(t+" is deprecated, please use "+e+" instead.")}function ymt(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const i=n.userAgentData.brands.find(r=>r.brand==="Chromium");if(i)return{browser:"chrome",version:parseInt(i.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=RP(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=RP(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=RP(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function bie(t){return Object.prototype.toString.call(t)==="[object Object]"}function iye(t){return bie(t)?Object.keys(t).reduce(function(e,n){const i=bie(t[n]),r=i?iye(t[n]):t[n],s=i&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[n]:r})},{}):t}function MG(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?MG(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{MG(t,t.get(r),n)})}))}function Eie(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return t.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{t.forEach(o=>{o.type===i&&o.trackId===a.id&&MG(t,o,r)})}),r}const Sie=nye;function rye(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const c={};return Object.keys(o).forEach(l=>{if(l==="require"||l==="advanced"||l==="mediaSource")return;const u=typeof o[l]=="object"?o[l]:{ideal:o[l]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const h=function(d,f){return d?d+f.charAt(0).toUpperCase()+f.slice(1):f==="deviceId"?"sourceId":f};if(u.ideal!==void 0){c.optional=c.optional||[];let d={};typeof u.ideal=="number"?(d[h("min",l)]=u.ideal,c.optional.push(d),d={},d[h("max",l)]=u.ideal,c.optional.push(d)):(d[h("",l)]=u.ideal,c.optional.push(d))}u.exact!==void 0&&typeof u.exact!="number"?(c.mandatory=c.mandatory||{},c.mandatory[h("",l)]=u.exact):["min","max"].forEach(d=>{u[d]!==void 0&&(c.mandatory=c.mandatory||{},c.mandatory[h(d,l)]=u[d])})}),o.advanced&&(c.optional=(c.optional||[]).concat(o.advanced)),c},r=function(o,c){if(e.version>=61)return c(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const l=function(u,h,d){h in u&&!(d in u)&&(u[d]=u[h],delete u[h])};o=JSON.parse(JSON.stringify(o)),l(o.audio,"autoGainControl","googAutoGainControl"),l(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=i(o.audio)}if(o&&typeof o.video=="object"){let l=o.video.facingMode;l=l&&(typeof l=="object"?l:{ideal:l});const u=e.version<66;if(l&&(l.exact==="user"||l.exact==="environment"||l.ideal==="user"||l.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete o.video.facingMode;let h;if(l.exact==="environment"||l.ideal==="environment"?h=["back","rear"]:(l.exact==="user"||l.ideal==="user")&&(h=["front"]),h)return n.mediaDevices.enumerateDevices().then(d=>{d=d.filter(p=>p.kind==="videoinput");let f=d.find(p=>h.some(g=>p.label.toLowerCase().includes(g)));return!f&&d.length&&h.includes("back")&&(f=d[d.length-1]),f&&(o.video.deviceId=l.exact?{exact:f.deviceId}:{ideal:f.deviceId}),o.video=i(o.video),Sie("chrome: "+JSON.stringify(o)),c(o)})}o.video=i(o.video)}return Sie("chrome: "+JSON.stringify(o)),c(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,c,l){r(o,u=>{n.webkitGetUserMedia(u,c,h=>{l&&l(s(h))})})};if(n.getUserMedia=a.bind(n),n.mediaDevices.getUserMedia){const o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(c){return r(c,l=>o(l).then(u=>{if(l.audio&&!u.getAudioTracks().length||l.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(h=>{h.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function sye(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function aye(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):s={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)}),i.stream.getTracks().forEach(r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.id):s={track:r};const a=new Event("track");a.track=r,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else ix(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function oye(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,c){let l=r.apply(this,arguments);return l||(l=e(this,o),this._senders.push(l)),l};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const c=this._senders.indexOf(o);c!==-1&&this._senders.splice(c,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(c=>c.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function cye(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(a=>a._pc=this),s});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>Eie(a,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),ix(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>Eie(s,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,s,a;return this.getSenders().forEach(o=>{o.track===i&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===i&&(s?a=!0:s=o),o.track===i)),a||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function lye(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const c=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(c)===-1&&this._shimmedLocalStreams[o.id].push(c):this._shimmedLocalStreams[o.id]=[o,c],c};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(l=>{if(this.getSenders().find(h=>h.track===l))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const c=this.getSenders().filter(l=>o.indexOf(l)===-1);this._shimmedLocalStreams[a.id]=[a].concat(c)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const c=this._shimmedLocalStreams[o].indexOf(a);c!==-1&&this._shimmedLocalStreams[o].splice(c,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),r.apply(this,arguments)}}function uye(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return lye(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const u=n.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(h=>this._reverseStreams[h.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(h=>{if(this.getSenders().find(f=>f.track===h))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const h=new t.MediaStream(u.getTracks());this._streams[u.id]=h,this._reverseStreams[h.id]=u,u=h}i.apply(this,[u])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},t.RTCPeerConnection.prototype.addTrack=function(u,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(g=>g===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(g=>g.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[h.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const g=new t.MediaStream([u]);this._streams[h.id]=g,this._reverseStreams[g.id]=h,this.addStream(g)}return this.getSenders().find(g=>g.track===u)};function s(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(d=>{const f=l._reverseStreams[d],p=l._streams[f.id];h=h.replace(new RegExp(p.id,"g"),f.id)}),new RTCSessionDescription({type:u.type,sdp:h})}function a(l,u){let h=u.sdp;return Object.keys(l._reverseStreams||[]).forEach(d=>{const f=l._reverseStreams[d],p=l._streams[f.id];h=h.replace(new RegExp(f.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:h})}["createOffer","createAnswer"].forEach(function(l){const u=t.RTCPeerConnection.prototype[l],h={[l](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const g=s(this,p);d[0].apply(null,[g])},p=>{d[1]&&d[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};t.RTCPeerConnection.prototype[l]=h[l]});const o=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const c=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const l=c.get.apply(this);return l.type===""?l:s(this,l)}}),t.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(f=>{this._streams[f].getTracks().find(g=>u.track===g)&&(d=this._streams[f])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function OG(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function hye(t,e){ix(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}const Tie=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:hye,shimAddTrackRemoveTrack:uye,shimAddTrackRemoveTrackWithNative:lye,shimGetSendersWithDtmf:oye,shimGetUserMedia:rye,shimMediaStream:sye,shimOnTrack:aye,shimPeerConnection:OG,shimSenderReceiverGetStats:cye},Symbol.toStringTag,{value:"Module"}));function dye(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,s,a){RY("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(s,a)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(a,o,c){o in a&&!(c in a)&&(a[c]=a[o],delete a[o])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a.audio,"autoGainControl","mozAutoGainControl"),r(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const o=a.apply(this,arguments);return r(o,"mozAutoGainControl","autoGainControl"),r(o,"mozNoiseSuppression","noiseSuppression"),o}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o,"autoGainControl","mozAutoGainControl"),r(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function _mt(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function fye(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function NG(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=t.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=a[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return i.apply(this,[s||null]).then(c=>{if(e.version<53&&!a)try{c.forEach(l=>{l.type=n[l.type]||l.type})}catch(l){if(l.name!=="TypeError")throw l;c.forEach((u,h)=>{c.set(h,Object.assign({},u,{type:n[u.type]||u.type}))})}return c}).then(a,o)}}function pye(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function mye(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),ix(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function gye(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){RY("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function vye(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function yye(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=i,a.sendEncodings=i,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function _ye(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function bye(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Eye(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const xie=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:yye,shimCreateAnswer:Eye,shimCreateOffer:bye,shimGetDisplayMedia:_mt,shimGetParameters:_ye,shimGetUserMedia:dye,shimOnTrack:fye,shimPeerConnection:NG,shimRTCDataChannel:vye,shimReceiverGetStats:mye,shimRemoveStream:gye,shimSenderGetStats:pye},Symbol.toStringTag,{value:"Module"}));function Sye(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i,...r){return r&&r.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function Tye(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(s)>=0)return;i._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,i.dispatchEvent(a)})}),e.apply(i,arguments)}}}function xye(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],d=n.apply(this,[h]);return u?(d.then(l,u),Promise.resolve()):d},e.createAnswer=function(l,u){const h=arguments.length>=2?arguments[2]:arguments[0],d=i.apply(this,[h]);return u?(d.then(l,u),Promise.resolve()):d};let o=function(c,l,u){const h=r.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h};e.setLocalDescription=o,o=function(c,l,u){const h=s.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.setRemoteDescription=o,o=function(c,l,u){const h=a.apply(this,[c]);return u?(h.then(l,u),Promise.resolve()):h},e.addIceCandidate=o}function wye(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(Cye(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,s){e.mediaDevices.getUserMedia(i).then(r,s)}).bind(e))}function Cye(t){return t&&t.video!==void 0?Object.assign({},t,{video:iye(t.video)}):t}function Rye(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const s=[];for(let a=0;a<i.iceServers.length;a++){let o=i.iceServers[a];o.urls===void 0&&o.url?(RY("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(i.iceServers[a])}i.iceServers=s}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function Aye(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Mye(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Oye(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}const wie=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:Oye,shimCallbacksAPI:xye,shimConstraints:Cye,shimCreateOfferLegacy:Mye,shimGetUserMedia:wye,shimLocalStreamsAPI:Sye,shimRTCIceServerUrls:Rye,shimRemoteStreamsAPI:Tye,shimTrackEventTransceiver:Aye},Symbol.toStringTag,{value:"Module"}));var Nye={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let s=8;s<i.length;s+=2)switch(i[s]){case"raddr":r.relatedAddress=i[s+1];break;case"rport":r.relatedPort=parseInt(i[s+1],10);break;case"tcptype":r.tcpType=i[s+1];break;case"ufrag":r.ufrag=i[s+1],r.usernameFragment=i[s+1];break;default:r[i[s]]===void 0&&(r[i[s]]=i[s+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const s=n.type;return i.push("typ"),i.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const s=n.substring(n.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)r=s[a].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(a=>{n.parameters[a]!==void 0?s.push(a+"="+n.parameters[a]):s.push(a)}),i+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{i+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},s=n.indexOf(":",i);return s>-1?(r.attribute=n.substring(i+1,s),r.value=n.substring(s+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],s=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");i.profile=s[2];for(let o=3;o<s.length;o++){const c=s[o],l=e.matchPrefix(n,"a=rtpmap:"+c+" ")[0];if(l){const u=e.parseRtpMap(l),h=e.matchPrefix(n,"a=fmtp:"+c+" ");switch(u.parameters=h.length?e.parseFmtp(h[0]):{},u.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+c+" ").map(e.parseRtcpFb),i.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{i.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(o=>{a.forEach(c=>{o.rtcpFeedback.find(u=>u.type===c.type&&u.parameter===c.parameter)||o.rtcpFeedback.push(c)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(a=>{r+=e.writeRtpMap(a),r+=e.writeFmtp(a),r+=e.writeRtcpFb(a)});let s=0;return i.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(a=>{r+=e.writeExtmap(a)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),s=r.fecMechanisms.indexOf("RED")!==-1,a=r.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(n,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname"),c=o.length>0&&o[0].ssrc;let l;const u=e.matchPrefix(n,"a=ssrc-group:FID").map(d=>d.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===c&&(l=u[0][1]),r.codecs.forEach(d=>{if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){let f={ssrc:c,codecPayloadType:parseInt(d.parameters.apt,10)};c&&l&&(f.rtx={ssrc:l}),i.push(f),s&&(f=JSON.parse(JSON.stringify(f)),f.fec={ssrc:c,mechanism:a?"red+ulpfec":"red"},i.push(f))}}),i.length===0&&c&&i.push({ssrc:c});let h=e.matchPrefix(n,"b=");return h.length&&(h[0].indexOf("b=TIAS:")===0?h=parseInt(h[0].substring(7),10):h[0].indexOf("b=AS:")===0?h=parseInt(h[0].substring(5),10)*1e3*.95-50*40*8:h=void 0,i.forEach(d=>{d.maxBitrate=h})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=s.length===0;const a=e.matchPrefix(n,"a=rtcp-mux");return i.mux=a.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const s=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return i=s[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:i.fmt,maxMessageSize:s};const o=e.matchPrefix(n,"a=sctpmap:");if(o.length>0){const c=o[0].substring(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let s;const a=i!==void 0?i:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e})(Nye);var Iye=Nye.exports;const Rw=Gc(Iye),bmt=GEe({__proto__:null,default:Rw},[Iye]);function AP(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),s=Rw.parseCandidate(i.candidate);for(const a in s)a in r||Object.defineProperty(r,a,{value:s[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,ix(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function IG(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||ix(t,"icecandidate",e=>{if(e.candidate){const n=Rw.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function MP(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(o){if(!o||!o.sdp)return!1;const c=Rw.splitSections(o.sdp);return c.shift(),c.some(l=>{const u=Rw.parseMLine(l);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},i=function(o){const c=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(c===null||c.length<2)return-1;const l=parseInt(c[1],10);return l!==l?-1:l},r=function(o){let c=65536;return e.browser==="firefox"&&(e.version<57?o===-1?c=16384:c=2147483637:e.version<60?c=e.version===57?65535:65536:c=2147483637),c},s=function(o,c){let l=65536;e.browser==="firefox"&&e.version===57&&(l=65535);const u=Rw.matchPrefix(o.sdp,"a=max-message-size:");return u.length>0?l=parseInt(u[0].substring(19),10):e.browser==="firefox"&&c!==-1&&(l=2147483637),l},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:c}=this.getConfiguration();c==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const c=i(arguments[0]),l=r(c),u=s(arguments[0],c);let h;l===0&&u===0?h=Number.POSITIVE_INFINITY:l===0||u===0?h=Math.max(l,u):h=Math.min(l,u);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return h}}),this._sctp=d}return a.apply(this,arguments)}}function OP(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const s=i.send;i.send=function(){const o=arguments[0],c=o.length||o.size||o.byteLength;if(i.readyState==="open"&&r.sctp&&c>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},ix(t,"datachannel",i=>(e(i.channel,i.target),i))}function kG(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",r);s.dispatchEvent(a)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function DG(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return n.apply(this,arguments)}}function NP(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function IP(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>n.apply(this,[a]))})}const Emt=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:DG,shimAddIceCandidateNullOrEmpty:NP,shimConnectionState:kG,shimMaxMessageSize:MP,shimParameterlessSetLocalDescription:IP,shimRTCIceCandidate:AP,shimRTCIceCandidateRelayProtocol:IG,shimSendThrowTypeError:OP},Symbol.toStringTag,{value:"Module"}));function Smt({window:t}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const n=nye,i=ymt(t),r={browserDetails:i,commonShim:Emt,extractVersion:RP,disableLog:gmt,disableWarnings:vmt,sdp:bmt};switch(i.browser){case"chrome":if(!Tie||!OG||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Tie,NP(t,i),IP(t),rye(t,i),sye(t),OG(t,i),aye(t),uye(t,i),oye(t),cye(t),hye(t,i),AP(t),IG(t),kG(t),MP(t,i),OP(t),DG(t,i);break;case"firefox":if(!xie||!NG||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=xie,NP(t,i),IP(t),dye(t,i),NG(t,i),fye(t),gye(t),pye(t),mye(t),vye(t),yye(t),_ye(t),bye(t),Eye(t),AP(t),kG(t),MP(t,i),OP(t);break;case"safari":if(!wie||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=wie,NP(t,i),IP(t),Rye(t),Mye(t),xye(t),Sye(t),Tye(t),Aye(t),wye(t),Oye(t),AP(t),IG(t),MP(t,i),OP(t),DG(t,i);break;default:n("Unsupported browser!");break}return r}const Cie=Smt({window:typeof window>"u"?void 0:window});function rx(t,e,n,i){Object.defineProperty(t,e,{get:n,set:i,enumerable:!0,configurable:!0})}class kye{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const n=[],i=e.byteLength,r=Math.ceil(i/this.chunkedMTU);let s=0,a=0;for(;a<i;){const o=Math.min(i,a+this.chunkedMTU),c=e.slice(a,o),l={__peerData:this._dataCount,n:s,data:c,total:r};n.push(l),a=o,s++}return this._dataCount++,n}}}function Tmt(t){let e=0;for(const r of t)e+=r.byteLength;const n=new Uint8Array(e);let i=0;for(const r of t)n.set(r,i),i+=r.byteLength;return n}const ZH=Cie.default||Cie,rA=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const t=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(t)?t==="chrome"?e>=this.minChromeVersion:t==="firefox"?e>=this.minFirefoxVersion:t==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return ZH.browserDetails.browser}getVersion(){return ZH.browserDetails.version||0}isUnifiedPlanSupported(){const t=this.getBrowser(),e=ZH.browserDetails.version||0;if(t==="chrome"&&e<this.minChromeVersion)return!1;if(t==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let n,i=!1;try{n=new RTCPeerConnection,n.addTransceiver("audio"),i=!0}catch{}finally{n&&n.close()}return i}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},xmt=t=>!t||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(t),Dye=()=>Math.random().toString(36).slice(2),Rie={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class wmt extends kye{noop(){}blobToArrayBuffer(e,n){const i=new FileReader;return i.onload=function(r){r.target&&n(r.target.result)},i.readAsArrayBuffer(e),i}binaryStringToArrayBuffer(e){const n=new Uint8Array(e.length);for(let i=0;i<e.length;i++)n[i]=e.charCodeAt(i)&255;return n.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=Rie,this.browser=rA.getBrowser(),this.browserVersion=rA.getVersion(),this.pack=Qve,this.unpack=Zve,this.supports=function(){const n={browser:rA.isBrowserSupported(),webRTC:rA.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!n.webRTC)return n;let i;try{i=new RTCPeerConnection(Rie),n.audioVideo=!0;let r;try{r=i.createDataChannel("_PEERJSTEST",{ordered:!0}),n.data=!0,n.reliable=!!r.ordered;try{r.binaryType="blob",n.binaryBlob=!rA.isIOS}catch{}}catch{}finally{r&&r.close()}}catch{}finally{i&&i.close()}return n}(),this.validateId=xmt,this.randomToken=Dye}}const Mh=new wmt,Cmt="PeerJS: ";var Aie;(function(t){t[t.Disabled=0]="Disabled",t[t.Errors=1]="Errors",t[t.Warnings=2]="Warnings",t[t.All=3]="All"})(Aie||(Aie={}));class Rmt{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...n){const i=[Cmt,...n];for(const r in i)i[r]instanceof Error&&(i[r]="("+i[r].name+") "+i[r].message);e>=3?console.log(...i):e>=2?console.warn("WARNING",...i):e>=1&&console.error("ERROR",...i)}constructor(){this._logLevel=0}}var jn=new Rmt,AY={},Amt=Object.prototype.hasOwnProperty,eh="~";function OO(){}Object.create&&(OO.prototype=Object.create(null),new OO().__proto__||(eh=!1));function Mmt(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function Pye(t,e,n,i,r){if(typeof n!="function")throw new TypeError("The listener must be a function");var s=new Mmt(n,i||t,r),a=eh?eh+e:e;return t._events[a]?t._events[a].fn?t._events[a]=[t._events[a],s]:t._events[a].push(s):(t._events[a]=s,t._eventsCount++),t}function kP(t,e){--t._eventsCount===0?t._events=new OO:delete t._events[e]}function fu(){this._events=new OO,this._eventsCount=0}fu.prototype.eventNames=function(){var e=[],n,i;if(this._eventsCount===0)return e;for(i in n=this._events)Amt.call(n,i)&&e.push(eh?i.slice(1):i);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(n)):e};fu.prototype.listeners=function(e){var n=eh?eh+e:e,i=this._events[n];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,s=i.length,a=new Array(s);r<s;r++)a[r]=i[r].fn;return a};fu.prototype.listenerCount=function(e){var n=eh?eh+e:e,i=this._events[n];return i?i.fn?1:i.length:0};fu.prototype.emit=function(e,n,i,r,s,a){var o=eh?eh+e:e;if(!this._events[o])return!1;var c=this._events[o],l=arguments.length,u,h;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,n),!0;case 3:return c.fn.call(c.context,n,i),!0;case 4:return c.fn.call(c.context,n,i,r),!0;case 5:return c.fn.call(c.context,n,i,r,s),!0;case 6:return c.fn.call(c.context,n,i,r,s,a),!0}for(h=1,u=new Array(l-1);h<l;h++)u[h-1]=arguments[h];c.fn.apply(c.context,u)}else{var d=c.length,f;for(h=0;h<d;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),l){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,n);break;case 3:c[h].fn.call(c[h].context,n,i);break;case 4:c[h].fn.call(c[h].context,n,i,r);break;default:if(!u)for(f=1,u=new Array(l-1);f<l;f++)u[f-1]=arguments[f];c[h].fn.apply(c[h].context,u)}}return!0};fu.prototype.on=function(e,n,i){return Pye(this,e,n,i,!1)};fu.prototype.once=function(e,n,i){return Pye(this,e,n,i,!0)};fu.prototype.removeListener=function(e,n,i,r){var s=eh?eh+e:e;if(!this._events[s])return this;if(!n)return kP(this,s),this;var a=this._events[s];if(a.fn)a.fn===n&&(!r||a.once)&&(!i||a.context===i)&&kP(this,s);else{for(var o=0,c=[],l=a.length;o<l;o++)(a[o].fn!==n||r&&!a[o].once||i&&a[o].context!==i)&&c.push(a[o]);c.length?this._events[s]=c.length===1?c[0]:c:kP(this,s)}return this};fu.prototype.removeAllListeners=function(e){var n;return e?(n=eh?eh+e:e,this._events[n]&&kP(this,n)):(this._events=new OO,this._eventsCount=0),this};fu.prototype.off=fu.prototype.removeListener;fu.prototype.addListener=fu.prototype.on;fu.prefixed=eh;fu.EventEmitter=fu;AY=fu;var sx={};rx(sx,"ConnectionType",()=>kg);rx(sx,"PeerErrorType",()=>fo);rx(sx,"BaseConnectionErrorType",()=>NO);rx(sx,"DataConnectionErrorType",()=>IO);rx(sx,"SerializationType",()=>MC);rx(sx,"SocketEventType",()=>bg);rx(sx,"ServerMessageType",()=>sl);var kg;(function(t){t.Data="data",t.Media="media"})(kg||(kg={}));var fo;(function(t){t.BrowserIncompatible="browser-incompatible",t.Disconnected="disconnected",t.InvalidID="invalid-id",t.InvalidKey="invalid-key",t.Network="network",t.PeerUnavailable="peer-unavailable",t.SslUnavailable="ssl-unavailable",t.ServerError="server-error",t.SocketError="socket-error",t.SocketClosed="socket-closed",t.UnavailableID="unavailable-id",t.WebRTC="webrtc"})(fo||(fo={}));var NO;(function(t){t.NegotiationFailed="negotiation-failed",t.ConnectionClosed="connection-closed"})(NO||(NO={}));var IO;(function(t){t.NotOpenYet="not-open-yet",t.MessageToBig="message-too-big"})(IO||(IO={}));var MC;(function(t){t.Binary="binary",t.BinaryUTF8="binary-utf8",t.JSON="json",t.None="raw"})(MC||(MC={}));var bg;(function(t){t.Message="message",t.Disconnected="disconnected",t.Error="error",t.Close="close"})(bg||(bg={}));var sl;(function(t){t.Heartbeat="HEARTBEAT",t.Candidate="CANDIDATE",t.Offer="OFFER",t.Answer="ANSWER",t.Open="OPEN",t.Error="ERROR",t.IdTaken="ID-TAKEN",t.InvalidKey="INVALID-KEY",t.Leave="LEAVE",t.Expire="EXPIRE"})(sl||(sl={}));var MY={};MY=JSON.parse('{"name":"peerjs","version":"1.5.4","keywords":["peerjs","webrtc","p2p","rtc"],"description":"PeerJS client","homepage":"https://peerjs.com","bugs":{"url":"https://github.com/peers/peerjs/issues"},"repository":{"type":"git","url":"https://github.com/peers/peerjs"},"license":"MIT","contributors":["Michelle Bu <michelle@michellebu.com>","afrokick <devbyru@gmail.com>","ericz <really.ez@gmail.com>","Jairo <kidandcat@gmail.com>","Jonas Gloning <34194370+jonasgloning@users.noreply.github.com>","Jairo Caro-Accino Viciana <jairo@galax.be>","Carlos Caballero <carlos.caballero.gonzalez@gmail.com>","hc <hheennrryy@gmail.com>","Muhammad Asif <capripio@gmail.com>","PrashoonB <prashoonbhattacharjee@gmail.com>","Harsh Bardhan Mishra <47351025+HarshCasper@users.noreply.github.com>","akotynski <aleksanderkotbury@gmail.com>","lmb <i@lmb.io>","Jairooo <jairocaro@msn.com>","Moritz Stckler <moritz.stueckler@gmail.com>","Simon <crydotsnakegithub@gmail.com>","Denis Lukov <denismassters@gmail.com>","Philipp Hancke <fippo@andyet.net>","Hans Oksendahl <hansoksendahl@gmail.com>","Jess <jessachandler@gmail.com>","khankuan <khankuan@gmail.com>","DUODVK <kurmanov.work@gmail.com>","XiZhao <kwang1imsa@gmail.com>","Matthias Lohr <matthias@lohr.me>","=frank tree <=frnktrb@googlemail.com>","Andre Eckardt <aeckardt@outlook.com>","Chris Cowan <agentme49@gmail.com>","Alex Chuev <alex@chuev.com>","alxnull <alxnull@e.mail.de>","Yemel Jardi <angel.jardi@gmail.com>","Ben Parnell <benjaminparnell.94@gmail.com>","Benny Lichtner <bennlich@gmail.com>","fresheneesz <bitetrudpublic@gmail.com>","bob.barstead@exaptive.com <bob.barstead@exaptive.com>","chandika <chandika@gmail.com>","emersion <contact@emersion.fr>","Christopher Van <cvan@users.noreply.github.com>","eddieherm <edhermoso@gmail.com>","Eduardo Pinho <enet4mikeenet@gmail.com>","Evandro Zanatta <ezanatta@tray.net.br>","Gardner Bickford <gardner@users.noreply.github.com>","Gian Luca <gianluca.cecchi@cynny.com>","PatrickJS <github@gdi2290.com>","jonnyf <github@jonathanfoss.co.uk>","Hizkia Felix <hizkifw@gmail.com>","Hristo Oskov <hristo.oskov@gmail.com>","Isaac Madwed <i.madwed@gmail.com>","Ilya Konanykhin <ilya.konanykhin@gmail.com>","jasonbarry <jasbarry@me.com>","Jonathan Burke <jonathan.burke.1311@googlemail.com>","Josh Hamit <josh.hamit@gmail.com>","Jordan Austin <jrax86@gmail.com>","Joel Wetzell <jwetzell@yahoo.com>","xizhao <kevin.wang@cloudera.com>","Alberto Torres <kungfoobar@gmail.com>","Jonathan Mayol <mayoljonathan@gmail.com>","Jefferson Felix <me@jsfelix.dev>","Rolf Erik Lekang <me@rolflekang.com>","Kevin Mai-Husan Chia <mhchia@users.noreply.github.com>","Pepijn de Vos <pepijndevos@gmail.com>","JooYoung <qkdlql@naver.com>","Tobias Speicher <rootcommander@gmail.com>","Steve Blaurock <sblaurock@gmail.com>","Kyrylo Shegeda <shegeda@ualberta.ca>","Diwank Singh Tomer <singh@diwank.name>","Soren Balko <Soeren.Balko@gmail.com>","Arpit Solanki <solankiarpit1997@gmail.com>","Yuki Ito <yuki@gnnk.net>","Artur Zayats <zag2art@gmail.com>"],"funding":{"type":"opencollective","url":"https://opencollective.com/peer"},"collective":{"type":"opencollective","url":"https://opencollective.com/peer"},"files":["dist/*"],"sideEffects":["lib/global.ts","lib/supports.ts"],"main":"dist/bundler.cjs","module":"dist/bundler.mjs","browser-minified":"dist/peerjs.min.js","browser-unminified":"dist/peerjs.js","browser-minified-msgpack":"dist/serializer.msgpack.mjs","types":"dist/types.d.ts","engines":{"node":">= 14"},"targets":{"types":{"source":"lib/exports.ts"},"main":{"source":"lib/exports.ts","sourceMap":{"inlineSources":true}},"module":{"source":"lib/exports.ts","includeNodeModules":["eventemitter3"],"sourceMap":{"inlineSources":true}},"browser-minified":{"context":"browser","outputFormat":"global","optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-unminified":{"context":"browser","outputFormat":"global","optimize":false,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 80, safari >= 15"},"source":"lib/global.ts"},"browser-minified-msgpack":{"context":"browser","outputFormat":"esmodule","isLibrary":true,"optimize":true,"engines":{"browsers":"chrome >= 83, edge >= 83, firefox >= 102, safari >= 15"},"source":"lib/dataconnection/StreamConnection/MsgPack.ts"}},"scripts":{"contributors":"git-authors-cli --print=false && prettier --write package.json && git add package.json package-lock.json && git commit -m \\"chore(contributors): update and sort contributors list\\"","check":"tsc --noEmit && tsc -p e2e/tsconfig.json --noEmit","watch":"parcel watch","build":"rm -rf dist && parcel build","prepublishOnly":"npm run build","test":"jest","test:watch":"jest --watch","coverage":"jest --coverage --collectCoverageFrom=\\"./lib/**\\"","format":"prettier --write .","format:check":"prettier --check .","semantic-release":"semantic-release","e2e":"wdio run e2e/wdio.local.conf.ts","e2e:bstack":"wdio run e2e/wdio.bstack.conf.ts"},"devDependencies":{"@parcel/config-default":"^2.9.3","@parcel/packager-ts":"^2.9.3","@parcel/transformer-typescript-tsc":"^2.9.3","@parcel/transformer-typescript-types":"^2.9.3","@semantic-release/changelog":"^6.0.1","@semantic-release/git":"^10.0.1","@swc/core":"^1.3.27","@swc/jest":"^0.2.24","@types/jasmine":"^4.3.4","@wdio/browserstack-service":"^8.11.2","@wdio/cli":"^8.11.2","@wdio/globals":"^8.11.2","@wdio/jasmine-framework":"^8.11.2","@wdio/local-runner":"^8.11.2","@wdio/spec-reporter":"^8.11.2","@wdio/types":"^8.10.4","http-server":"^14.1.1","jest":"^29.3.1","jest-environment-jsdom":"^29.3.1","mock-socket":"^9.0.0","parcel":"^2.9.3","prettier":"^3.0.0","semantic-release":"^21.0.0","ts-node":"^10.9.1","typescript":"^5.0.0","wdio-geckodriver-service":"^5.0.1"},"dependencies":{"@msgpack/msgpack":"^2.8.0","eventemitter3":"^4.0.7","peerjs-js-binarypack":"^2.1.0","webrtc-adapter":"^9.0.0"},"alias":{"process":false,"buffer":false}}');class Omt extends AY.EventEmitter{constructor(e,n,i,r,s,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const o=e?"wss://":"ws://";this._baseUrl=o+n+":"+i+r+"peerjs?key="+s}start(e,n){this._id=e;const i=`${this._baseUrl}&id=${e}&token=${n}`;this._socket||!this._disconnected||(this._socket=new WebSocket(i+"&version="+MY.version),this._disconnected=!1,this._socket.onmessage=r=>{let s;try{s=JSON.parse(r.data),jn.log("Server message received:",s)}catch{jn.log("Invalid server message",r.data);return}this.emit(bg.Message,s)},this._socket.onclose=r=>{this._disconnected||(jn.log("Socket closed.",r),this._cleanup(),this._disconnected=!0,this.emit(bg.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),jn.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){jn.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:sl.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const n of e)this.send(n)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(bg.Error,"Invalid message");return}if(!this._wsOpen())return;const n=JSON.stringify(e);this._socket.send(n)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class Lye{constructor(e){this.connection=e}startConnection(e){const n=this._startPeerConnection();if(this.connection.peerConnection=n,this.connection.type===kg.Media&&e._stream&&this._addTracksToConnection(e._stream,n),e.originator){const i=this.connection,r={ordered:!!e.reliable},s=n.createDataChannel(i.label,r);i._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){jn.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const n=this.connection.peer,i=this.connection.connectionId,r=this.connection.type,s=this.connection.provider;jn.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(jn.log(`Received ICE candidates for ${n}:`,a.candidate),s.socket.send({type:sl.Candidate,payload:{candidate:a.candidate,type:r,connectionId:i},dst:n}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":jn.log("iceConnectionState is failed, closing connections to "+n),this.connection.emitError(NO.NegotiationFailed,"Negotiation of connection to "+n+" failed."),this.connection.close();break;case"closed":jn.log("iceConnectionState is closed, closing connections to "+n),this.connection.emitError(NO.ConnectionClosed,"Connection to "+n+" closed."),this.connection.close();break;case"disconnected":jn.log("iceConnectionState changed to disconnected on the connection with "+n);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},jn.log("Listening for data channel"),e.ondatachannel=a=>{jn.log("Received data channel");const o=a.channel;s.getConnection(n,i)._initializeDataChannel(o)},jn.log("Listening for remote stream"),e.ontrack=a=>{jn.log("Received remote stream");const o=a.streams[0],c=s.getConnection(n,i);if(c.type===kg.Media){const l=c;this._addStreamToMediaConnection(o,l)}}}cleanup(){jn.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const n=e.signalingState!=="closed";let i=!1;const r=this.connection.dataChannel;r&&(i=!!r.readyState&&r.readyState!=="closed"),(n||i)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createOffer(this.connection.options.constraints);jn.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),jn.log("Set localDescription:",i,`for:${this.connection.peer}`);let r={sdp:i,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===kg.Data){const s=this.connection;r={...r,label:s.label,reliable:s.reliable,serialization:s.serialization}}n.socket.send({type:sl.Offer,payload:r,dst:this.connection.peer})}catch(r){r!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(n.emitError(fo.WebRTC,r),jn.log("Failed to setLocalDescription, ",r))}}catch(i){n.emitError(fo.WebRTC,i),jn.log("Failed to createOffer, ",i)}}async _makeAnswer(){const e=this.connection.peerConnection,n=this.connection.provider;try{const i=await e.createAnswer();jn.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(i.sdp=this.connection.options.sdpTransform(i.sdp)||i.sdp);try{await e.setLocalDescription(i),jn.log("Set localDescription:",i,`for:${this.connection.peer}`),n.socket.send({type:sl.Answer,payload:{sdp:i,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(r){n.emitError(fo.WebRTC,r),jn.log("Failed to setLocalDescription, ",r)}}catch(i){n.emitError(fo.WebRTC,i),jn.log("Failed to create answer, ",i)}}async handleSDP(e,n){n=new RTCSessionDescription(n);const i=this.connection.peerConnection,r=this.connection.provider;jn.log("Setting remote description",n);const s=this;try{await i.setRemoteDescription(n),jn.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(a){r.emitError(fo.WebRTC,a),jn.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){jn.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),jn.log(`Added ICE candidate for:${this.connection.peer}`)}catch(n){this.connection.provider.emitError(fo.WebRTC,n),jn.log("Failed to handleCandidate, ",n)}}_addTracksToConnection(e,n){if(jn.log(`add tracks from stream ${e.id} to peer connection`),!n.addTrack)return jn.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(i=>{n.addTrack(i,e)})}_addStreamToMediaConnection(e,n){jn.log(`add stream ${e.id} to media connection ${n.connectionId}`),n.addStream(e)}}class Uye extends AY.EventEmitter{emitError(e,n){jn.error("Error:",n),this.emit("error",new Nmt(`${e}`,n))}}class Nmt extends Error{constructor(e,n){typeof n=="string"?super(n):(super(),Object.assign(this,n)),this.type=e}}class Bye extends Uye{get open(){return this._open}constructor(e,n,i){super(),this.peer=e,this.provider=n,this.options=i,this._open=!1,this.metadata=i.metadata}}var rq;const fM=class fM extends Bye{get type(){return kg.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,n,i){super(e,n,i),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||fM.ID_PREFIX+Mh.randomToken(),this._negotiator=new Lye(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{jn.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{jn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){jn.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const n=e.type,i=e.payload;switch(e.type){case sl.Answer:this._negotiator.handleSDP(n,i.sdp),this._open=!0;break;case sl.Candidate:this._negotiator.handleCandidate(i.candidate);break;default:jn.warn(`Unrecognized message type:${n} from peer:${this.peer}`);break}}answer(e,n={}){if(this._localStream){jn.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,n&&n.sdpTransform&&(this.options.sdpTransform=n.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const i=this.provider._getMessages(this.connectionId);for(const r of i)this.handleMessage(r);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}};rq=new WeakMap,wR(fM,rq,fM.ID_PREFIX="mc_");let NU=fM;class Imt{constructor(e){this._options=e}_buildRequest(e){const n=this._options.secure?"https":"http",{host:i,port:r,path:s,key:a}=this._options,o=new URL(`${n}://${i}:${r}${s}${a}/${e}`);return o.searchParams.set("ts",`${Date.now()}${Math.random()}`),o.searchParams.set("version",MY.version),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){jn.error("Error retrieving ID",e);let n="";throw this._options.path==="/"&&this._options.host!==Mh.CLOUD_HOST&&(n=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+n)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let n="";throw this._options.host===Mh.CLOUD_HOST?n="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":n="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+n)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw jn.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}var sq,aq;const AS=class AS extends Bye{get type(){return kg.Data}constructor(e,n,i){super(e,n,i),this.connectionId=this.options.connectionId||AS.ID_PREFIX+Dye(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new Lye(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{jn.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=n=>{jn.log(`DC#${this.connectionId} dc onmessage:`,n.data)},this.dataChannel.onclose=()=>{jn.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,n=!1){if(!this.open){this.emitError(IO.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,n)}async handleMessage(e){const n=e.payload;switch(e.type){case sl.Answer:await this._negotiator.handleSDP(e.type,n.sdp);break;case sl.Candidate:await this._negotiator.handleCandidate(n.candidate);break;default:jn.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}};sq=new WeakMap,aq=new WeakMap,wR(AS,sq,AS.ID_PREFIX="dc_"),wR(AS,aq,AS.MAX_BUFFERED_AMOUNT=8388608);let IU=AS;class OY extends IU{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",n=>this._handleDataMessage(n))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>IU.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(n){return jn.error(`DC#:${this.connectionId} Error when sending:`,n),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e!=null&&e.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class QH extends OY{close(e){super.close(e),this._chunkedData={}}constructor(e,n,i){super(e,n,i),this.chunker=new kye,this.serialization=MC.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const n=Zve(e),i=n.__peerData;if(i){if(i.type==="close"){this.close();return}this._handleChunk(n);return}this.emit("data",n)}_handleChunk(e){const n=e.__peerData,i=this._chunkedData[n]||{data:[],count:0,total:e.total};if(i.data[e.n]=new Uint8Array(e.data),i.count++,this._chunkedData[n]=i,i.total===i.count){delete this._chunkedData[n];const r=Tmt(i.data);this._handleDataMessage({data:r})}}_send(e,n){const i=Qve(e);if(i instanceof Promise)return this._send_blob(i);if(!n&&i.byteLength>this.chunker.chunkedMTU){this._sendChunks(i);return}this._bufferedSend(i)}async _send_blob(e){const n=await e;if(n.byteLength>this.chunker.chunkedMTU){this._sendChunks(n);return}this._bufferedSend(n)}_sendChunks(e){const n=this.chunker.chunk(e);jn.log(`DC#${this.connectionId} Try to send ${n.length} chunks...`);for(const i of n)this.send(i,!0)}}class kmt extends OY{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,n){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=MC.None}}class Dmt extends OY{_handleDataMessage({data:e}){const n=this.parse(this.decoder.decode(e)),i=n.__peerData;if(i&&i.type==="close"){this.close();return}this.emit("data",n)}_send(e,n){const i=this.encoder.encode(this.stringify(e));if(i.byteLength>=Mh.chunkedMTU){this.emitError(IO.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(i)}constructor(...e){super(...e),this.serialization=MC.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}var oq;const pM=class pM extends Uye{get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[n,i]of this._connections)e[n]=i;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,n){super(),this._serializers={raw:kmt,json:Dmt,binary:QH,"binary-utf8":QH,default:QH},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let i;if(e&&e.constructor==Object?n=e:e&&(i=e.toString()),n={debug:0,host:Mh.CLOUD_HOST,port:Mh.CLOUD_PORT,path:"/",key:pM.DEFAULT_KEY,token:Mh.randomToken(),config:Mh.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...n},this._options=n,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==Mh.CLOUD_HOST?this._options.secure=Mh.isSecure():this._options.host==Mh.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&jn.setLogFunction(this._options.logFunction),jn.logLevel=this._options.debug||0,this._api=new Imt(n),this._socket=this._createServerConnection(),!Mh.supports.audioVideo&&!Mh.supports.data){this._delayedAbort(fo.BrowserIncompatible,"The current browser does not support WebRTC");return}if(i&&!Mh.validateId(i)){this._delayedAbort(fo.InvalidID,`ID "${i}" is invalid`);return}i?this._initialize(i):this._api.retrieveId().then(r=>this._initialize(r)).catch(r=>this._abort(fo.ServerError,r))}_createServerConnection(){const e=new Omt(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(bg.Message,n=>{this._handleMessage(n)}),e.on(bg.Error,n=>{this._abort(fo.SocketError,n)}),e.on(bg.Disconnected,()=>{this.disconnected||(this.emitError(fo.Network,"Lost connection to server."),this.disconnect())}),e.on(bg.Close,()=>{this.disconnected||this._abort(fo.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const n=e.type,i=e.payload,r=e.src;switch(n){case sl.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case sl.Error:this._abort(fo.ServerError,i.msg);break;case sl.IdTaken:this._abort(fo.UnavailableID,`ID "${this.id}" is taken`);break;case sl.InvalidKey:this._abort(fo.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case sl.Leave:jn.log(`Received leave message from ${r}`),this._cleanupPeer(r),this._connections.delete(r);break;case sl.Expire:this.emitError(fo.PeerUnavailable,`Could not connect to peer ${r}`);break;case sl.Offer:{const s=i.connectionId;let a=this.getConnection(r,s);if(a&&(a.close(),jn.warn(`Offer received for existing Connection ID:${s}`)),i.type===kg.Media){const c=new NU(r,this,{connectionId:s,_payload:i,metadata:i.metadata});a=c,this._addConnection(r,a),this.emit("call",c)}else if(i.type===kg.Data){const c=new this._serializers[i.serialization](r,this,{connectionId:s,_payload:i,metadata:i.metadata,label:i.label,serialization:i.serialization,reliable:i.reliable});a=c,this._addConnection(r,a),this.emit("connection",c)}else{jn.warn(`Received malformed connection type:${i.type}`);return}const o=this._getMessages(s);for(const c of o)a.handleMessage(c);break}default:{if(!i){jn.warn(`You received a malformed message from ${r} of type ${n}`);return}const s=i.connectionId,a=this.getConnection(r,s);a&&a.peerConnection?a.handleMessage(e):s?this._storeMessage(s,e):jn.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,n){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(n)}_getMessages(e){const n=this._lostMessages.get(e);return n?(this._lostMessages.delete(e),n):[]}connect(e,n={}){if(n={serialization:"default",...n},this.disconnected){jn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(fo.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const i=new this._serializers[n.serialization](e,this,n);return this._addConnection(e,i),i}call(e,n,i={}){if(this.disconnected){jn.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(fo.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!n){jn.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const r=new NU(e,this,{...i,_stream:n});return this._addConnection(e,r),r}_addConnection(e,n){jn.log(`add connection ${n.type}:${n.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(n)}_removeConnection(e){const n=this._connections.get(e.peer);if(n){const i=n.indexOf(e);i!==-1&&n.splice(i,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,n){const i=this._connections.get(e);if(!i)return null;for(const r of i)if(r.connectionId===n)return r;return null}_delayedAbort(e,n){setTimeout(()=>{this._abort(e,n)},0)}_abort(e,n){jn.error("Aborting!"),this.emitError(e,n),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(jn.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const n=this._connections.get(e);if(n)for(const i of n)i.close()}disconnect(){if(this.disconnected)return;const e=this.id;jn.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)jn.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)jn.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=n=>{}){this._api.listAllPeers().then(n=>e(n)).catch(n=>this._abort(fo.ServerError,n))}};oq=new WeakMap,wR(pM,oq,pM.DEFAULT_KEY="peerjs");let PG=pM;var Pmt=PG;let Wf,kO,DO;const PO={},OC={},LO={},LG={},Fye={};function zye(t,e,n=!1){const i=cc().createMediaStreamSource(e),r=new yr(5);sp(i,r),t===nr()?(console.info("setup local voice",t),kO=e):console.info("setup remote voice",t),r.toDestination(),LO[t]=r}function Hye(t,e){const n=document.createElement("video");n.autoplay=!0,n.srcObject=e,t===nr()?DO=e:console.info("setup remote screen",t),qv.getState().setscreen(t,n),Fye[t]=n}function UG(t){var e,n;(e=LO[t])==null||e.dispose(),(n=OC[t])==null||n.close(),delete LO[t],delete OC[t],delete LG[t],delete Fye[t]}function BG(t){console.info("mediaconnection.metadata",t.metadata),t.on("stream",e=>{t.metadata.screen?Hye(t.peer,e):zye(t.peer,e)}),t.on("close",()=>{UG(t.peer)}),t.on("error",()=>{UG(t.peer)})}function NY(){ae(Wf)||(Wf=new Pmt(nr()),Wf.on("call",t=>{t.answer(),BG(t),setTimeout(q6,1e3)}),Wf.on("error",t=>{Hi(Ge,nr(),"usermedia",t.toString())}))}function jye(){ae(Wf)&&(Wf.destroy(),Wf=void 0)}async function Lmt(){try{return await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1}})}catch(t){Hi(Ge,nr(),"uservoice",t.toString())}}function Umt(){NY(),Lmt().then(t=>{ae(t)&&(zye(nr(),t),q6())}).catch(t=>{Hi(Ge,nr(),"uservoice",t.toString())})}function Bmt(){UG(nr()),kO=void 0,ae(DO)||jye()}async function Fmt(){try{return await navigator.mediaDevices.getDisplayMedia({audio:!0,video:!0})}catch(t){Hi(Ge,nr(),"userscreenshare",t.toString())}}function zmt(){NY(),Fmt().then(t=>{ae(t)&&(Hye(nr(),t),q6())}).catch(t=>{Hi(Ge,nr(),"userscreen",t.toString())})}function Hmt(){DO=void 0,ae(kO)||jye()}function jmt(t){NY(),ae(Wf)&&(PO[t]=!0)}function Vmt(t){var e,n;ae(Wf)&&((e=OC[t])==null||e.close(),(n=LO[t])==null||n.dispose(),delete PO[t],delete OC[t],delete LO[t])}function q6(){if(!ae(Wf))return;const t=Object.keys(PO);if(ae(kO))for(let e=0;e<t.length;++e){const n=t[e];if(n===nr())continue;const i=OC[n];if(!ae(i)||!i.open){const r=Wf.call(n,kO,{metadata:{voice:!0}});OC[n]=r,BG(r)}}if(ae(DO))for(let e=0;e<t.length;++e){const n=t[e];if(n===nr())continue;const i=LG[n];if(!ae(i)||!i.open){const r=Wf.call(n,DO,{metadata:{screen:!0}});LG[n]=r,BG(r)}}}function Vye(t){const e={};for(let i=0;i<t.length;++i){const r=t[i];ae(PO[r])||(e[r]=!0,jmt(r))}const n=Object.keys(PO);for(let i=0;i<n.length;++i){const r=n[i];ae(e[r])||Vmt(r)}q6()}function Gmt(t,e,n,i){const r=e*n*4;for(let s=0,a=0;s<r;++a)t.image.data[s]=i[a]*255,s+=4;return t.needsUpdate=!0,t}function qmt(t,e){const n=new Uint8Array(4*t*e);return new Xf(n,t,e)}const $mt=new Bc({transparent:!1,side:cl,uniforms:{color:{value:new _n(0,0,0)},data:{value:null}},vertexShader:`
      #include <clipping_planes_pars_vertex>
  
      varying vec2 vUv;
    
      void main() {
        vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
        gl_Position = projectionMatrix * mvPosition;
        
        vUv = uv;
        
        #include <clipping_planes_vertex>
      }
    `,fragmentShader:`
      #include <clipping_planes_pars_fragment>
  
      uniform vec3 color;
      uniform sampler2D data;
  
      varying vec2 vUv;

      // adapted from https://www.shadertoy.com/view/Mlt3z8
      float bayerDither2x2( vec2 v ) {
        return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
      }

      float bayerDither4x4( vec2 v ) {
        vec2 P1 = mod( v, 2.0 );
        vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
        return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
      }

      void main() {
        #include <clipping_planes_fragment>
  
        float alpha = texture2D(data, vUv).r;
        if (alpha < 1.0) {
          vec2 ditherCoord = floor( mod( gl_FragCoord.xy, 4.0 ) );
          if ( bayerDither4x4( ditherCoord ) / 16.0 >= alpha ) {
            discard;
          }
        }

        gl_FragColor.rgba = vec4(color.xyz, 1.0);
      }
    `});function Wmt(){return V6($mt)}const kU=[0,1,0],Gye=[1,1,0],DU=[1,0,0],qye=[0,0,0],Ymt=new Float32Array([...kU,...DU,...Gye,...kU,...qye,...DU]),Xmt=new Float32Array([...kU.slice(0,2),...DU.slice(0,2),...Gye.slice(0,2),...kU.slice(0,2),...qye.slice(0,2),...DU.slice(0,2)]);function Kmt(t,e,n,i,r,s){const a=e*n*4;for(let o=0,c=0;o<a;++c){const l=i[c]??0;t.image.data[o++]=l%Fh,t.image.data[o++]=Math.floor(l/Fh),t.image.data[o++]=r[c]??16,t.image.data[o++]=s[c]??16}return t.needsUpdate=!0,t}function Jmt(t,e){const n=new Uint8Array(4*t*e),i=new Xf(n,t,e,XO,ml);return i.internalFormat="RGBA8UI",i}function $ye(t,e,n){const i=e*kn.DRAW_CHAR_WIDTH(),r=n*kn.DRAW_CHAR_HEIGHT(),s=Ymt.map((a,o)=>{switch(o%3){case 0:return a*i;case 1:return a*r;default:return a}});t.setAttribute("position",new rr(s,3)),t.setAttribute("uv",new rr(Xmt,2)),t.computeBoundingBox(),t.computeBoundingSphere()}const Zmt=mO($C(xN)),Mie=Ew(WC(TN)),Qmt=new Bc({transparent:!1,side:cl,uniforms:{time:Cf,interval:j6,palette:new Yi(Zmt),map:new Yi(Mie),alt:new Yi(Mie),data:new Yi(null),size:{value:new Rt},step:{value:new Rt},flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>
    varying vec2 vUv;
    void main() {
      vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
      gl_Position = projectionMatrix * mvPosition;
      vUv = uv;
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform usampler2D data;
    uniform vec3 palette[16];
    uniform vec2 size;
    uniform vec2 step;
    uniform bool flip;
    varying vec2 vUv;

    void main() {
      #include <clipping_planes_fragment>

      uvec4 tiledata = texture(data, vUv);
      int colori = int(tiledata.z);
      int bgi = int(tiledata.w);

      vec2 charPosition = mod(vUv, size) / size;
      vec2 uv = vec2(charPosition.x * step.x, charPosition.y * step.y);
      vec3 color = palette[colori];

      uv.x += step.x * float(tiledata.x);
      uv.y += step.y * float(tiledata.y);
      if (flip) {
        uv.y = 1.0 - uv.y;
      }

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${Qt.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function egt(){return V6(Qmt)}function wI({width:t,height:e,alphas:n}){const i=G6(),r=Be.useRef(null),[s]=Be.useState(()=>Wmt());return Be.useEffect(()=>{s.uniforms.data.value=qmt(t,e)},[s.uniforms.data,t,e]),Be.useEffect(()=>{Gmt(s.uniforms.data.value,t,e,n)},[s.uniforms.data.value,t,e,n]),Be.useEffect(()=>{r.current&&($ye(r.current,t,e),s.clipping=i.length>0,s.clippingPlanes=i,s.needsUpdate=!0)},[s,i,t,e]),Ae.jsx("mesh",{material:s,children:Ae.jsx("bufferGeometry",{ref:r})})}function tgt({width:t,height:e,alpha:n}){const i=Be.useMemo(()=>new Array(t*e).fill(n),[t,e,n]);return Ae.jsx(wI,{width:t,height:e,alphas:i})}const sA=new Hae,cS=new Rt;function UO({width:t,height:e,top:n,left:i,right:r,bottom:s,scale:a=.125,alpha:o=.25}){const c=Be.useMemo(()=>{const l=new Array(t*e);sA.min.x=i,sA.min.y=n,sA.max.x=r,sA.max.y=s,cS.x=0,cS.y=0;for(let u=0;u<l.length;++u)l[u]=Use.smootherstep(1-sA.distanceToPoint(cS)*a,0,1)*o,++cS.x,cS.x>=t&&(cS.x=0,++cS.y);return l},[t,e,n,i,r,s,a,o]);return Ae.jsx(wI,{width:t,height:e,alphas:c})}const ngt=F7,igt=mO($C(xN)),Oie=Ew(WC(TN)),rgt=new Bc({transparent:!1,side:cl,uniforms:{time:Cf,interval:j6,smoothrate:new Yi(ngt),palette:new Yi(igt),map:new Yi(Oie),alt:new Yi(Oie),dpr:new Yi(1),screenwidth:new Yi(1),screenheight:new Yi(1),pointSize:{value:new Rt(1,1)},rows:new Yi(1),step:new Yi(new Rt),flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>

    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float screenwidth;
    uniform float screenheight;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      // draw space
      float xpadding = (pointSize.y - pointSize.x);
      animPosition *= pointSize;
      animPosition.x += pointSize.x * 0.5;
      animPosition.x += xpadding * 0.5;
      animPosition.y += pointSize.y;

      // model space
      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);

      // transform to screenspace 
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      float ptaspect = (screenwidth / screenheight);
      float ptsize = pointSize.y + ptaspect;
      
      gl_PointSize = (screenheight * (ptsize + 0.5)) / gl_Position.w;
      gl_PointSize *= dpr;
      gl_Position.y -= ptsize - ptaspect;
      
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      #include <clipping_planes_fragment>

      float xscale = pointSize.y / pointSize.x;
      float px = gl_PointCoord.x * xscale;
      
      if (vVisible == 0.0 || px >= 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function sgt(){return V6(rgt)}const agt=F7,ogt=mO($C(xN)),Nie=Ew(WC(TN)),cgt=new Bc({transparent:!1,side:cl,uniforms:{time:Cf,interval:j6,smoothrate:new Yi(agt),palette:new Yi(ogt),map:new Yi(Nie),alt:new Yi(Nie),dpr:new Yi(1),screenwidth:new Yi(1),screenheight:new Yi(1),pointSize:{value:new Rt(1,1)},rows:new Yi(1),step:new Yi(new Rt),flip:new Yi(!0)},vertexShader:`
    #include <clipping_planes_pars_vertex>

    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      vec3 sourceColor = colorFromIndex(lastColor.x);
      vec3 destColor = colorFromIndex(charData.z);
      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      vCharData.xy = charData.xy;

      animPosition = animPosition * pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x += (pointSize.y - pointSize.x) * 0.5;

      vec4 mvPosition = modelViewMatrix * vec4(animPosition, 0.0, 1.0);
      gl_Position = projectionMatrix * mvPosition;      

      // this handles things being scaled
      gl_PointSize = pointSize.y * modelViewMatrix[0][0] * dpr;
      
      #include <clipping_planes_vertex>
    }
  `,fragmentShader:`
    #include <clipping_planes_pars_fragment>

    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      #include <clipping_planes_fragment>

      float xscale = pointSize.y / pointSize.x;
      float px = gl_PointCoord.x * xscale;
      
      if (vVisible == 0.0 || px >= 1.0) {
        discard;
      }

      vec2 lookup = vec2(vCharData.x, vCharData.y);

      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }
      vec2 idx = vec2(px, py);
      vec2 char = vec2(lookup.x * step.x, (rows - lookup.y) * step.y);
      vec2 uv = idx * step + char;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 1.0) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function lgt(){return V6(cgt)}const Iie=2048;function Wye({sprites:t,fliptexture:e=!0,withbillboards:n=!1}){const{viewport:i}=Zu(),r=qv(f=>f.palettedata),s=qv(f=>f.charsetdata),a=qv(f=>f.altcharsetdata),o=Be.useMemo(()=>n?sgt():lgt(),[n]),c=G6(),l=Be.useRef(null),u=Be.useRef([]),{width:h=0,height:d=0}=(s==null?void 0:s.image)??{};return Be.useMemo(()=>{var _;u.current.length===0&&(u.current=Array.from({length:Iie},()=>({id:"",x:0,y:0,char:0,color:0,bg:0})));const f={};for(let v=0;v<t.length;++v)f[t[v].id]=t[v];const p=new Set(u.current.map(v=>v.id));let g=0;for(let v=0;v<Iie;++v)if(u.current[v].id){const E=f[u.current[v].id];ae(E)?u.current[v]={...E}:u.current[v].id=""}else if(g<t.length){for(;p.has((_=t[g])==null?void 0:_.id)===!0;)++g;g<t.length&&(u.current[v]={...t[g++]})}},[t]),Be.useEffect(()=>{const{current:f}=l,{current:p}=u;if(!f||!p)return;let g=f.getAttribute("visible"),_=f.getAttribute("lastVisible"),v=f.getAttribute("position"),E=f.getAttribute("charData"),T=f.getAttribute("lastPosition"),x=f.getAttribute("lastColor"),N=f.getAttribute("lastBg"),A=f.getAttribute("animShake"),I=f.getAttribute("animBounce");if(!g||g.count!==p.length){g=new rr(new Float32Array(p.length),1),_=new rr(new Float32Array(p.length),1),v=new rr(new Float32Array(p.length*3),3),E=new rr(new Float32Array(p.length*4),4),T=new rr(new Float32Array(p.length*3),3),x=new rr(new Float32Array(p.length*2),2),N=new rr(new Float32Array(p.length*2),2),A=new rr(new Float32Array(p.length*2),2),I=new rr(new Float32Array(p.length*2),2);for(let k=0;k<p.length;++k){const L=p[k],U=L.id?1:0;g.setX(k,U),_.setX(k,U),v.setXY(k,L.x,L.y),E.setXYZW(k,L.char%Fh,Math.floor(L.char/Fh),L.color,L.bg),T.setXYZ(k,L.x,L.y,Cf.value),x.setXY(k,L.color,Cf.value),N.setXY(k,L.bg,Cf.value),A.setXY(k,0,Cf.value-1e6),I.setXY(k,0,Cf.value-1e6)}f.setAttribute("visible",g),f.setAttribute("lastVisible",_),f.setAttribute("position",v),f.setAttribute("charData",E),f.setAttribute("lastPosition",T),f.setAttribute("lastColor",x),f.setAttribute("lastBg",N),f.setAttribute("animShake",A),f.setAttribute("animBounce",I)}else for(let k=0;k<p.length;++k){const L=p[k],U=v.getX(k),$=v.getY(k),q=E.getX(k),G=E.getY(k),X=E.getZ(k),ie=E.getW(k);_.setX(k,g.getX(k)),_.needsUpdate=!0,g.setX(k,L.id?1:0),g.needsUpdate=!0;const V=_.getX(k)===0&&g.getX(k)===1;(V||U!==L.x||$!==L.y)&&(T.setXYZ(k,V?L.x:U,V?L.y:$,Cf.value),T.needsUpdate=!0,v.setXY(k,L.x,L.y),v.needsUpdate=!0),(V||X!==L.color)&&(x.setXY(k,V?L.color:X,Cf.value),x.needsUpdate=!0,E.setZ(k,L.color),E.needsUpdate=!0),(V||ie!==L.bg)&&(N.setXY(k,V?L.bg:ie,Cf.value),N.needsUpdate=!0,E.setW(k,L.bg),E.needsUpdate=!0);const Z=L.char%Fh,Y=Math.floor(L.char/Fh);(q!==Z||G!==Y)&&(E.setXY(k,Z,Y),E.needsUpdate=!0)}f.computeBoundingBox(),f.computeBoundingSphere()},[t]),Be.useEffect(()=>{if(!s||!l.current)return;const f=Math.round(h/Cg),p=Math.round(d/Rg);o.uniforms.palette.value=r,o.uniforms.map.value=s,o.uniforms.alt.value=a??s,o.uniforms.dpr.value=window.devicePixelRatio,o.uniforms.screenwidth.value=i.width,o.uniforms.screenheight.value=i.height,o.uniforms.pointSize.value.x=kn.DRAW_CHAR_WIDTH(),o.uniforms.pointSize.value.y=kn.DRAW_CHAR_HEIGHT(),o.uniforms.rows.value=p-1,o.uniforms.step.value.x=1/f,o.uniforms.step.value.y=1/p,o.uniforms.flip.value=e,o.clipping=c.length>0,o.clippingPlanes=c,o.needsUpdate=!0},[r,s,a,o,h,d,e,c,n,i.width,i.height]),Ae.jsx("points",{frustumCulled:!1,material:o,children:Ae.jsx("bufferGeometry",{ref:l})})}function IY({width:t,height:e,char:n,color:i,bg:r,fliptexture:s=!0}){const a=qv(p=>p.palettedata),o=qv(p=>p.charsetdata),c=qv(p=>p.altcharsetdata),l=G6(),[u]=Be.useState(()=>egt()),h=Be.useRef(null),{width:d=0,height:f=0}=(o==null?void 0:o.image)??{};return Be.useEffect(()=>{t===0||e===0||(u.uniforms.data.value=Jmt(t,e))},[u.uniforms.data,t,e]),Be.useEffect(()=>{t===0||e===0||Kmt(u.uniforms.data.value,t,e,n,i,r)},[u.uniforms.data.value,t,e,n,i,r]),Be.useEffect(()=>{t===0||e===0||!h.current||!o||($ye(h.current,t,e),u.uniforms.map.value=o,u.uniforms.alt.value=c??o,u.uniforms.palette.value=a,u.uniforms.size.value.x=1/t,u.uniforms.size.value.y=1/e,u.uniforms.step.value.x=1/Math.round(d/Cg),u.uniforms.step.value.y=1/Math.round(f/Rg),u.uniforms.flip.value=s,u.clipping=l.length>0,u.clippingPlanes=l,u.needsUpdate=!0)},[a,o,c,u,t,e,d,f,s,l]),Ae.jsx("mesh",{material:u,children:Ae.jsx("bufferGeometry",{ref:h})})}function oM({id:t,z:e,from:n}){const i=qv(),r=Eo(ap(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),s=(r==null?void 0:r.type)===Dd.MEDIA?r:void 0;switch(Be.useEffect(()=>{switch(s==null?void 0:s.mime){case"image/palette":Li(s.media)&&i.setpalette(fw(hT,h7,s.media));break;case"image/charset":Li(s.media)&&i.setcharset(fw(Fh*Cg,XM*Rg,s.media));break;case"image/altcharset":Li(s.media)&&i.setaltcharset(fw(Fh*Cg,XM*Rg,s.media));break;case"text/players":On(s.media)&&Vye(s.media.split(","));break}},[i,s]),r==null?void 0:r.type){default:case Dd.BLANK:case Dd.MEDIA:return null;case Dd.TILES:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(IY,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case Dd.SPRITES:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(Wye,{sprites:[...r.sprites]})},r.id);case Dd.DITHER:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(wI,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function ugt({width:t,height:e}){const n=t*kn.DRAW_CHAR_WIDTH(),i=e*kn.DRAW_CHAR_HEIGHT(),r=Be.useRef(null),s=Be.useRef(null),a=Be.useRef(null),o=Be.useRef(null);hy((h,d)=>{if(!r.current||!s.current||!a.current||!o.current)return;const f=v2(Eo.getState().gadget.layers??[]);ae(s.current.userData.focusx)||(a.current.scale.setScalar(f.viewscale),s.current.userData={focusx:f.focusx,focusy:f.focusy,tfocusx:f.focusx,tfocusy:f.focusy,facing:f.facing},s.current.position.set(-f.focusx*kn.DRAW_CHAR_WIDTH(),-f.focusy*kn.DRAW_CHAR_HEIGHT(),0));const p=.25,g=s.current.userData.focusx,_=s.current.userData.focusy,v=g*kn.DRAW_CHAR_WIDTH(),E=_*kn.DRAW_CHAR_HEIGHT();MU(s.current.position,[-v,-E,0],p,d);const T=Math.abs(s.current.userData.focusx-s.current.userData.tfocusx),x=Math.abs(s.current.userData.focusy-s.current.userData.tfocusy);T<1&&x<1&&MU(a.current.scale,f.viewscale,p,d);const N=a.current.scale.x;console.info({viewscale:N});const A=1/N,k=Math.abs(N-f.viewscale)>.01,L=N<Zp.MID,q=(N*kn.DRAW_CHAR_WIDTH()-kn.DRAW_CHAR_WIDTH())*A,G=kn.DRAW_CHAR_WIDTH()+q,V=(N*kn.DRAW_CHAR_HEIGHT()-kn.DRAW_CHAR_HEIGHT())*A,Z=kn.DRAW_CHAR_HEIGHT()+V;o.current.position.set(v-g*G,E-_*Z,0);const Y=kn.DRAW_CHAR_WIDTH()*N,ee=kn.DRAW_CHAR_HEIGHT()*N,oe=n/Y,de=i/ee;if(k&&(s.current.userData.tfocusx=f.focusx+.5,s.current.userData.tfocusy=f.focusy+.5),r.current.position.set(n*.5,i*.5,0),!k)if(L)s.current.userData.tfocusx=f.focusx+.5,s.current.userData.tfocusy=f.focusy+.5;else{const ke=Math.round(oe*.25),St=Math.round(de*.25),At=Math.round(s.current.userData.tfocusx-f.focusx);if(Math.abs(At)>=ke){const ye=At<0?ke:-ke;s.current.userData.tfocusx+=ye*2}const Ee=Math.round(s.current.userData.tfocusy-f.focusy);if(Math.abs(Ee)>=St){const ye=Ee<0?St:-St;s.current.userData.tfocusy+=ye*2}}const Me=Math.round(oe*.5),He=Math.round(de*.5),Te=f.width-oe*.5,Le=f.height-de*.5,we=-Math.round((oe-f.width)*.5),Ce=-Math.round((de-f.height)*.5);we>=0?(s.current.userData.tfocusx<Me&&(k&&(s.current.userData.focusx=Me),s.current.userData.tfocusx=Me),s.current.userData.tfocusx>Te&&(k&&(s.current.userData.focusx=Te),s.current.userData.tfocusx=Te)):s.current.userData.tfocusx=Me+we,Ce>=0?(s.current.userData.tfocusy<He&&(k&&(s.current.userData.focusy=He),s.current.userData.tfocusy=He),s.current.userData.tfocusy>Le&&(k&&(s.current.userData.focusy=Le),s.current.userData.tfocusy=Le)):s.current.userData.tfocusy=He+Ce,Yv(s.current.userData,"focusx",s.current.userData.tfocusx,p),Yv(s.current.userData,"focusy",s.current.userData.tfocusy,p)}),Eo(h=>{var d;return((d=h.gadget.over)==null?void 0:d.length)??0}),Eo(h=>{var d;return((d=h.gadget.under)==null?void 0:d.length)??0}),Eo(h=>{var d;return((d=h.gadget.layers)==null?void 0:d.length)??0});const{over:c=[],under:l=[],layers:u=[]}=Eo.getState().gadget;return Ae.jsx(Jve,{width:n,height:i,children:Ae.jsx("group",{ref:r,children:Ae.jsx("group",{ref:s,children:Ae.jsx("group",{ref:a,children:Ae.jsxs("group",{ref:o,children:[Ae.jsx(hmt,{}),l.map((h,d)=>Ae.jsx(oM,{from:"under",id:h.id,z:d*2},h.id)),u.map((h,d)=>Ae.jsx(oM,{from:"layers",id:h.id,z:l.length+d*2},h.id)),c.map((h,d)=>Ae.jsx(oM,{from:"over",id:h.id,z:l.length+u.length+d*2},h.id))]})})})})})}function hgt({id:t,z:e,from:n}){const i=qv(),r=Eo(ap(a=>{var o;return(o=a.gadget[n])==null?void 0:o.find(c=>c.id===t)})),s=(r==null?void 0:r.type)===Dd.MEDIA?r:void 0;switch(Be.useEffect(()=>{switch(s==null?void 0:s.mime){case"image/palette":Li(s.media)&&i.setpalette(fw(hT,h7,s.media));break;case"image/charset":Li(s.media)&&i.setcharset(fw(Fh*Cg,XM*Rg,s.media));break;case"image/altcharset":Li(s.media)&&i.setaltcharset(fw(Fh*Cg,XM*Rg,s.media));break;case"text/players":On(s.media)&&Vye(s.media.split(","));break}},[i,s]),r==null?void 0:r.type){default:case Dd.BLANK:case Dd.MEDIA:return null;case Dd.TILES:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(IY,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case Dd.SPRITES:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(Wye,{sprites:[...r.sprites],withbillboards:!0,fliptexture:!1})},r.id);case Dd.DITHER:return Ae.jsx("group",{position:[0,0,e],children:Ae.jsx(wI,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function dgt({viewwidth:t,viewheight:e,children:n}){return Ae.jsxs("mesh",{position:[t*.5,e*.5,0],children:[Ae.jsx("planeGeometry",{args:[t,e]}),Ae.jsx("meshBasicMaterial",{transparent:!0,children:Ae.jsx(Bft,{attach:"map",width:t,height:e,depthBuffer:!0,stencilBuffer:!1,generateMipmaps:!1,children:n})})]})}function kie(t){switch(t){case Zp.NEAR:return 128;default:case Zp.MID:return 256;case Zp.FAR:return 550}}function fgt(t){switch(t){case Zp.NEAR:return 0;default:case Zp.MID:return 1;case Zp.FAR:return-1}}function pgt(t){switch(t){case Zp.NEAR:return .777;default:case Zp.MID:return 1.11;case Zp.FAR:return .666}}function mgt({width:t,height:e}){const n=t*kn.DRAW_CHAR_WIDTH(),i=e*kn.DRAW_CHAR_HEIGHT(),r=Be.useRef(null),s=Be.useRef(null),a=Be.useRef(null),o=Be.useRef(null),c=Be.useRef(null);hy((p,g)=>{if(!r.current||!s.current||!a.current||!o.current||!c.current)return;const _=v2(Eo.getState().gadget.layers??[]),v=t*kn.DRAW_CHAR_WIDTH(),E=e*kn.DRAW_CHAR_HEIGHT(),T=fi*kn.DRAW_CHAR_WIDTH(),x=jr*kn.DRAW_CHAR_HEIGHT();ae(o.current.userData.focusx)||(o.current.userData={focusx:_.focusx,focusy:_.focusy,facing:_.facing,focusz:kie(_.viewscale)}),s.current.position.x=0,s.current.position.y=E-x;const N=Er(v/T,1,10);a.current.position.x=v-T*N,a.current.position.y=0,a.current.scale.setScalar(N);const A=.125,I=fgt(_.viewscale),k=o.current.userData.focusx,L=o.current.userData.focusy,U=(k+.5)*-kn.DRAW_CHAR_WIDTH(),$=(L+I)*-kn.DRAW_CHAR_HEIGHT();MU(c.current.position,[0,0,kie(_.viewscale)],A,g),Tft(r.current.rotation,[pgt(_.viewscale),0,0],A,g),MU(o.current.position,[U,$,0],A,g),Yv(o.current.userData,"focusx",_.focusx,A),Yv(o.current.userData,"focusy",_.focusy,A)}),Eo(p=>{var g;return((g=p.gadget.over)==null?void 0:g.length)??0}),Eo(p=>{var g;return((g=p.gadget.under)==null?void 0:g.length)??0}),Eo(p=>{var g;return((g=p.gadget.layers)==null?void 0:g.length)??0});const{over:l=[],under:u=[],layers:h=[]}=Eo.getState().gadget,d=u.length*2+2,f=d+2;return Ae.jsxs(Jve,{width:n,height:i,children:[Ae.jsx("group",{ref:a,children:u.map((p,g)=>Ae.jsx(oM,{from:"under",id:p.id,z:g*2},p.id))}),Ae.jsx("group",{"position-z":d,children:Ae.jsxs(dgt,{viewwidth:n,viewheight:i,children:[Ae.jsx(Mft,{ref:c,makeDefault:!0,manual:!0,near:1,far:2e3,aspect:n/i}),Ae.jsx("group",{ref:r,children:Ae.jsx("group",{ref:o,children:h.map(p=>Ae.jsx(hgt,{id:p.id,from:"layers",z:0},p.id))})})]})}),Ae.jsx("group",{ref:s,"position-z":f,children:l.map((p,g)=>Ae.jsx(oM,{from:"over",id:p.id,z:g*2},p.id))})]})}var kY={};Object.defineProperty(kY,"__esModule",{value:!0});var Yye=kY.GamepadHelper=void 0;const qa=class qa{static getButtonValue(e,n){var i,r;return(r=(i=qa.gamepads[e])==null?void 0:i.buttons[n])==null?void 0:r.value}static getAxisValue(e,n){var i;return(i=qa.gamepads[e])==null?void 0:i.axes[n]}static update(){qa.checkForNewGamepads(),!(!qa.gamepads||Object.keys(qa.gamepads).length<1)&&(qa.gamepadsLastUpdate&&Object.keys(qa.gamepadsLastUpdate).length>0&&Object.values(qa.gamepads).forEach(e=>{var n;for(let i=0;i<e.buttons.length;i++){const r=(n=qa.gamepadsLastUpdate[e.index])==null?void 0:n.buttons[i],s=e.buttons[i];(s==null?void 0:s.value)==1&&(r==null?void 0:r.value)==0?qa.dispatchButtonDownEvent(e.index,i):(s==null?void 0:s.value)==0&&(r==null?void 0:r.value)==1&&qa.dispatchButtonUpEvent(e.index,i)}}),qa.gamepadsLastUpdate=Object.assign({},qa.gamepads))}static checkForNewGamepads(){const e=navigator.getGamepads();for(const n of e)n&&(qa.gamepads[n.index]||qa.logOutput&&console.log("gamepad "+n.index+" connected"),qa.gamepads[n.index]=n)}static dispatchButtonDownEvent(e,n){qa.logOutput&&console.log(`gamepad ${e}: button ${n} is down`),document.dispatchEvent(new CustomEvent("gamepadbuttondown",{detail:{gamepad:e,button:n}}))}static dispatchButtonUpEvent(e,n){qa.logOutput&&console.log(`gamepad ${e}: button ${n} is up`),document.dispatchEvent(new CustomEvent("gamepadbuttonup",{detail:{gamepad:e,button:n}}))}};Qn(qa,"gamepads",{}),Qn(qa,"gamepadsLastUpdate"),Qn(qa,"logOutput",!1);let FG=qa;Yye=kY.GamepadHelper=FG;var xy={};Object.defineProperty(xy,"__esModule",{value:!0});var ggt=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),ej={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},Xye={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:ggt?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},DY={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222};for(var AD=1;AD<20;AD++)DY["f"+AD]=111+AD;function $6(t,e,n){e&&!("byKey"in e)&&(n=e,e=null),Array.isArray(t)||(t=[t]);var i=t.map(function(a){return Kye(a,e)}),r=function(o){return i.some(function(c){return Jye(c,o)})},s=n==null?r:r(n);return s}function vgt(t,e){return $6(t,e)}function ygt(t,e){return $6(t,{byKey:!0},e)}function Kye(t,e){var n=e&&e.byKey,i={};t=t.replace("++","+add");var r=t.split("+"),s=r.length;for(var a in ej)i[ej[a]]=!1;var o=!0,c=!1,l=void 0;try{for(var u=r[Symbol.iterator](),h;!(o=(h=u.next()).done);o=!0){var d=h.value,f=d.endsWith("?")&&d.length>1;f&&(d=d.slice(0,-1));var p=PY(d),g=ej[p];if(d.length>1&&!g&&!Xye[d]&&!DY[p])throw new TypeError('Unknown modifier: "'+d+'"');(s===1||!g)&&(n?i.key=p:i.which=Zye(d)),g&&(i[g]=f?null:!0)}}catch(_){c=!0,l=_}finally{try{!o&&u.return&&u.return()}finally{if(c)throw l}}return i}function Jye(t,e){for(var n in t){var i=t[n],r=void 0;if(i!=null&&(n==="key"&&e.key!=null?r=e.key.toLowerCase():n==="which"?r=i===91&&e.which===93?91:e.which:r=e[n],!(r==null&&i===!1)&&r!==i))return!1}return!0}function Zye(t){t=PY(t);var e=DY[t]||t.toUpperCase().charCodeAt(0);return e}function PY(t){return t=t.toLowerCase(),t=Xye[t]||t,t}var _gt=xy.default=$6;xy.isHotkey=$6;xy.isCodeHotkey=vgt;xy.isKeyHotkey=ygt;xy.parseHotkey=Kye;xy.compareHotkey=Jye;xy.toKeyCode=Zye;xy.toKeyName=PY;function Qye(t){return{all:t=t||new Map,on:function(e,n){var i=t.get(e);i?i.push(n):t.set(e,[n])},off:function(e,n){var i=t.get(e);i&&(n?i.splice(i.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var i=t.get(e);i&&i.slice().map(function(r){r(n)}),(i=t.get("*"))&&i.slice().map(function(r){r(e,n)})}}}const pg={[tn.NONE]:!1,[tn.ALT]:!1,[tn.CTRL]:!1,[tn.SHIFT]:!1,[tn.MOVE_UP]:!1,[tn.MOVE_DOWN]:!1,[tn.MOVE_LEFT]:!1,[tn.MOVE_RIGHT]:!1,[tn.OK_BUTTON]:!1,[tn.CANCEL_BUTTON]:!1,[tn.MENU_BUTTON]:!1};let DP=0,Die=performance.now();const BO=200;function e_e(){const t=performance.now(),e=t-Die;if(DP+=e,DP>=BO){DP%=BO;const n={alt:!!pg[tn.ALT],ctrl:!!pg[tn.CTRL],shift:!!pg[tn.SHIFT]};[tn.MOVE_UP,tn.MOVE_DOWN,tn.MOVE_LEFT,tn.MOVE_RIGHT,tn.OK_BUTTON,tn.CANCEL_BUTTON,tn.MENU_BUTTON].forEach(r=>{pg[r]&&n_e(r,n)})}Die=t,Yye.update(),setTimeout(e_e,100)}e_e();function ju(t){pg[t]||(DP=0,n_e(t,{alt:pg[tn.ALT],ctrl:pg[tn.CTRL],shift:pg[tn.SHIFT]})),pg[t]=!0}function Ac(t){pg[t]=!1}const ug={root:Qye(),ignorehotkeys:!1},t_e=Be.createContext(ug.root);function W6(t){return{alt:t.altKey,ctrl:Ab?t.metaKey:t.ctrlKey,shift:t.shiftKey}}function n_e(t,e){ug.root.emit(tn[t],e)}document.addEventListener("keydown",t=>{const e=ai(t.key),n=W6(t),i=nr();switch(e){case"s":case"j":case"o":case"f":case"z":case"y":case"e":case"k":case"p":case"arrowleft":case"arrowright":case"arrowup":case"arrowdown":n.ctrl&&t.preventDefault();break;case"tab":t.preventDefault();break}switch(n.alt?ju(tn.ALT):Ac(tn.ALT),n.ctrl?ju(tn.CTRL):Ac(tn.CTRL),n.shift?ju(tn.SHIFT):Ac(tn.SHIFT),e){case"arrowleft":ju(tn.MOVE_LEFT);break;case"arrowright":ju(tn.MOVE_RIGHT);break;case"arrowup":ju(tn.MOVE_UP);break;case"arrowdown":ju(tn.MOVE_DOWN);break;case"enter":ju(tn.OK_BUTTON);break;case"esc":case"escape":ju(tn.CANCEL_BUTTON);break;case"tab":ju(tn.MENU_BUTTON);break;case"s":n.ctrl&&Lv(Ge,i,"#save");break;case"j":n.ctrl&&Lv(Ge,i,n.shift?"#jointab hush":"#jointab");break;case"o":n.ctrl&&Lv(Ge,i,n.shift?"#joincode hush":"#joincode");break;case"l":break;case"f":n.ctrl&&Lv(Ge,i,"#fork");break}ug.root.emit("keydown",t)},{capture:!0});document.addEventListener("keyup",t=>{const e=ai(t.key),n=W6(t);switch(n.alt?ju(tn.ALT):Ac(tn.ALT),n.ctrl?ju(tn.CTRL):Ac(tn.CTRL),n.shift?ju(tn.SHIFT):Ac(tn.SHIFT),e){case"meta":Ac(tn.MOVE_LEFT),Ac(tn.MOVE_RIGHT),Ac(tn.MOVE_UP),Ac(tn.MOVE_DOWN);break;case"arrowleft":Ac(tn.MOVE_LEFT);break;case"arrowright":Ac(tn.MOVE_RIGHT);break;case"arrowup":Ac(tn.MOVE_UP);break;case"arrowdown":Ac(tn.MOVE_DOWN);break;case"enter":Ac(tn.OK_BUTTON);break;case"esc":case"escape":Ac(tn.CANCEL_BUTTON);break;case"tab":Ac(tn.MENU_BUTTON);break}},{capture:!0});qb("userinput",["tock"],t=>{switch(t.target){case"up":pn(t.data)&&Ac(t.data);break;case"down":pn(t.data)&&ju(t.data);break}});const bgt=0,Egt=1,Sgt=2,Tgt=3,xgt=4,wgt=5,Cgt=6,Rgt=7,Agt=9,Mgt=12,Ogt=13,Ngt=14,Igt=15,i_e={[bgt]:tn.OK_BUTTON,[Egt]:tn.CANCEL_BUTTON,[Sgt]:tn.OK_BUTTON,[Tgt]:tn.CANCEL_BUTTON,[xgt]:tn.ALT,[wgt]:tn.CTRL,[Cgt]:tn.SHIFT,[Rgt]:tn.SHIFT,[Agt]:tn.MENU_BUTTON,[Mgt]:tn.MOVE_UP,[Ogt]:tn.MOVE_DOWN,[Ngt]:tn.MOVE_LEFT,[Igt]:tn.MOVE_RIGHT};document.addEventListener("gamepadbuttondown",t=>{ju(i_e[t.detail.button])});document.addEventListener("gamepadbuttonup",t=>{Ac(i_e[t.detail.button])});const Pie="keyup";function Aw({hotkey:t,children:e}){return Be.useEffect(()=>{const n=_gt(t,{byKey:!0});function i(r){ug.ignorehotkeys===!1&&n(r)&&e()}return document.addEventListener(Pie,i,!1),()=>document.removeEventListener(Pie,i,!1)},[t,e]),null}function uc(t){const e=Be.useContext(t_e);return Be.useEffect(()=>{const n=Object.entries(t);return n.forEach(([i,r])=>e.on(i,r)),()=>{n.forEach(([i,r])=>e.off(i,r))}},[e,t]),null}function ax({blockhotkeys:t,children:e}){const[n]=Be.useState(()=>Qye());return Be.useEffect(()=>{const i=ug.root,r=ug.ignorehotkeys;return ug.root=n,ug.ignorehotkeys=!!t,()=>{ug.root=i,ug.ignorehotkeys=r}},[n,t]),Ae.jsx(t_e.Provider,{value:n,children:e})}function lS(t,e,n){let i=0;n.alt&&(i|=Xue),n.ctrl&&(i|=Kue),n.shift&&(i|=Jue),sb(t)&&KDe(Ge,t,e,i)}function kgt({width:t,height:e}){const n=nr();Eo(s=>{var a;return((a=s.gadget.layers)==null?void 0:a.length)??0}),Eo(s=>v2(s.gadget.layers??[]).graphics);const{layers:i=[]}=Eo.getState().gadget,r=v2(i);return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(uc,{MOVE_LEFT:s=>lS(n,tn.MOVE_LEFT,s),MOVE_RIGHT:s=>lS(n,tn.MOVE_RIGHT,s),MOVE_UP:s=>lS(n,tn.MOVE_UP,s),MOVE_DOWN:s=>lS(n,tn.MOVE_DOWN,s),OK_BUTTON:s=>lS(n,tn.OK_BUTTON,s),CANCEL_BUTTON:s=>lS(n,tn.CANCEL_BUTTON,s),MENU_BUTTON:s=>lS(n,tn.MENU_BUTTON,s),keydown:s=>{const{key:a}=s;switch(ai(a)){case"t":BDe(Ge,nr());break}}}),Ae.jsx(Fd,{visible:!0,color:new _n(.076,.076,0),width:t,height:e,z:-3}),r.graphics==="flat"&&Ae.jsx(ugt,{width:t,height:e}),r.graphics==="mode7"&&Ae.jsx(mgt,{width:t,height:e})]})}const l0=Be.createContext({sendmessage(){},sendclose(){},didclose(){}}),Lie={input:{color:"$white",active:"$yellow"}};function fp(t){return t?Lie.input.active:Lie.input.color}function CI(t,e){switch(t){case"touchkey":return`register:${t}:${e}`}return`vm:${t}:${e}`}function xA(t,e,n=0,i=""){return`${t.substring(0,e)}${i}${t.substring(e+n)}`}function Jd(t,e){ae(t)&&(e.x=1,e.y=t)}const x_=32,r_e=8,zG=new Re;function Dgt(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(zG.x/t),i=Math.floor(zG.y/e);return{x:x_*.5+n,y:r_e*.5+i}}function Pgt({chip:t,row:e,label:n,args:i,context:r}){Jd(e,r);const[s]=[ou(i[0],"")],a=Wb(t,s),c=jN(a)??0,l=Kd(),[u,h]=Be.useState(!1);Be.useLayoutEffect(()=>{h(!0)},[]);const d=`${c}`.padStart(3,"0"),f=n.trim(),p=r.x-1,g=r.y+2,_=[`$green${f} ${d}
$white`];for(let k=0;k<256;++k)if(k%x_===0&&_.push(`
`),k===c){const L=l?"$green$onwhite":"$white$ongreen";_.push(`${L}$${k}$white$ondkblue`)}else _.push(`$${k}`);const v=_.join("");ri(v,r,!0);const E=Be.useContext(l0),T=Be.useCallback(()=>{c>=x_&&ll(a,c-x_)},[a,c]),x=Be.useCallback(()=>{c>0&&ll(a,c-1)},[a,c]),N=Be.useCallback(()=>{c<255&&ll(a,c+1)},[a,c]),A=Be.useCallback(()=>{c<=255-x_&&ll(a,c+x_)},[a,c]),I=Be.useCallback(()=>{E.sendclose()},[E]);return Ae.jsx("group",{position:[p*kn.DRAW_CHAR_WIDTH(),g*kn.DRAW_CHAR_HEIGHT(),1],children:u&&Ae.jsxs(ax,{blockhotkeys:!0,children:[Ae.jsx(Fd,{blocking:!0,visible:!1,width:x_,height:r_e,onClick:k=>{k.intersections[0].object.worldToLocal(zG.copy(k.intersections[0].point));const L=mT(Dgt(),x_);L>=0&&L<=255&&(ll(a,L),E.sendclose())}}),Ae.jsx(uc,{MOVE_LEFT:x,MOVE_UP:T,MOVE_RIGHT:N,MOVE_DOWN:A,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}const w_=8,s_e=2,HG=new Re;function Lgt(){const t=kn.DRAW_CHAR_WIDTH(),e=kn.DRAW_CHAR_HEIGHT(),n=Math.floor(HG.x/t),i=Math.floor(HG.y/e);return{x:w_*.5+n,y:s_e*.5+i}}function Ugt({chip:t,row:e,label:n,args:i,context:r}){Jd(e,r);const[s]=[ou(i[0],"")],a=Wb(t,s),c=jN(a)??0,l=Kd(),[u,h]=Be.useState(!1);Be.useLayoutEffect(()=>{h(!0)},[]);const d=`${c}`.padStart(2,"0"),f=n.trim(),p=(Qt[c]||Qt[Qt.BLACK]).padEnd(12," ").toLowerCase(),g=r.x-1,_=r.y+2,v=[`$green${f} ${d} ${p}
$white`];for(let k=0;k<16;++k)if(k%w_===0&&v.push(`
`),k===c){const L=k<8?"$white":"$black",U=l?L:`$${Qt[k]}`;v.push(`${U}$219`)}else v.push(`$${Qt[k]}$219`);v.push("$white"),ri(v.join(""),r,!0);const E=Be.useContext(l0),T=Be.useCallback(()=>{c>=w_&&ll(a,c-w_)},[a,c]),x=Be.useCallback(()=>{c>0&&ll(a,c-1)},[a,c]),N=Be.useCallback(()=>{c<15&&ll(a,c+1)},[a,c]),A=Be.useCallback(()=>{c<=15-w_&&ll(a,c+w_)},[a,c]),I=Be.useCallback(()=>{E.sendclose()},[E]);return Ae.jsx("group",{position:[g*kn.DRAW_CHAR_WIDTH(),_*kn.DRAW_CHAR_HEIGHT(),1],children:u&&Ae.jsxs(ax,{blockhotkeys:!0,children:[Ae.jsx(Fd,{blocking:!0,visible:!1,width:w_,height:s_e,onClick:k=>{k.intersections[0].object.worldToLocal(HG.copy(k.intersections[0].point));const L=Lgt(),U=mT(L,w_);U>=0&&U<=16&&(ll(a,U),E.sendclose())}}),Ae.jsx(uc,{MOVE_LEFT:x,MOVE_UP:T,MOVE_RIGHT:N,MOVE_DOWN:A,OK_BUTTON:I,CANCEL_BUTTON:I})]})})}function Bgt({item:t,row:e,context:n}){return Jd(e,n),ri(`${t}${ae(e)?`
`:""}`,n,!0),null}function Fgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,o]=[ou(r[0],""),r[1]],c=fp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Be.useContext(l0),u=Be.useCallback(()=>{l.sendmessage(CI(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Ae.jsx(uc,{OK_BUTTON:u})}function zgt({chip:t,row:e,active:n,label:i,args:r,context:s}){var _;Jd(e,s);const[a,o,c,l]=[ou(r[0],""),ou(r[1],((_=r[1])==null?void 0:_.toString())??""),ou(r[2],""),ou(r[3],"")],u=c||` ${o.toUpperCase()} `,h=fp(n),d=s.x-.25,f=s.y-.25;ri(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${u}${h}$onclear ${i}${ae(e)?`
`:""}`,s,!0);const p=Be.useContext(l0),g=Be.useCallback(()=>{p.sendmessage(CI(t,a)),l||p.sendclose()},[t,p,a,l]);return Ae.jsxs("group",{position:[d*kn.DRAW_CHAR_WIDTH(),f*kn.DRAW_CHAR_HEIGHT(),1],children:[Ae.jsx(Fd,{visible:!1,width:u.length+.5,height:1.5,blocking:!0,onClick:g}),n&&Ae.jsx(uc,{OK_BUTTON:g}),o&&Ae.jsx(Aw,{hotkey:o,children:g})]})}function Hgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,o]=[ou(r[0],""),r[1]],c=fp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Be.useContext(l0),u=Be.useCallback(()=>{l.sendmessage(CI(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Ae.jsx(uc,{OK_BUTTON:u})}function jgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,o]=[ou(r[0],""),r[1]],c=fp(n);ri(`  $purple$16 ${c}${i}
`,s,!0);const l=Be.useContext(l0),u=Be.useCallback(()=>{l.sendmessage(CI(t,a),o),l.sendclose()},[l,t,a,o]);return n&&Ae.jsx(uc,{OK_BUTTON:u})}function Vgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,o,c]=[ou(r[0],""),DS(r[1],-1),DS(r[2],-1)];let l,u;o===-1?(l=0,u=31):c===-1?(l=0,u=o):(l=o,u=c);const h=Wb(t,a),d=jN(h),f=d??0,p=Kd(),[g,_]=Be.useState(""),[v,E]=Be.useState(0),[T,x]=Be.useState(!1);let N=`${f}`;const A=i.trim(),I=fp(n);T&&(N=p?xA(g,v,1,"$219+"):g),s.writefullwidth=32,ri(`  # ${I}${A} $green${N}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const k=Be.useCallback($=>{const q=$.alt?10:1;ll(h,Math.min(u,f+q))},[u,f,h]),L=Be.useCallback($=>{const q=$.alt?10:1;ll(h,Math.max(l,f-q))},[l,f,h]),U=Be.useCallback(()=>{x($=>{const q=!$;if(q){const G=`${d}`;_(G),E(G.length)}else{const G=parseFloat(g),X=isNaN(G)?0:G;ll(a,Math.min(u,Math.max(l,X)))}return q})},[u,l,g,a,d]);return d!==void 0&&Ae.jsxs(Ae.Fragment,{children:[n&&!T&&Ae.jsx(uc,{MOVE_LEFT:L,MOVE_RIGHT:k,OK_BUTTON:U}),T&&Ae.jsxs(ax,{blockhotkeys:!0,children:[Ae.jsx(Aw,{hotkey:"ctrl+c",children:()=>{console.info("copy")}}),Ae.jsx(Aw,{hotkey:"ctrl+v",children:()=>{console.info("paste")}}),Ae.jsx(Aw,{hotkey:"ctrl+a",children:()=>{console.info("select all")}}),Ae.jsx(uc,{MOVE_LEFT:()=>{E($=>Math.max(0,$-1))},MOVE_RIGHT:()=>{E($=>Math.min(g.length,$+1))},CANCEL_BUTTON:U,OK_BUTTON:U,keydown:$=>{switch(ai($.key)){case"delete":g.length>0&&_(q=>xA(q,v,1));break;case"backspace":v>0&&(_(q=>xA(q,v-1,1)),E(q=>Math.max(0,q-1)));break}$.key.length===1&&g.length<s.width*.5&&(_(q=>xA(q,v,0,$.key)),E(q=>q+1))}})]})]})}function Ggt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,o,c]=[ou(r[0],""),ou(r[1],""),ou(r[2],"")];let l,u;o===""?(l="L ",u=" H"):c===""?(l="L ",u=` ${o}`):(l=`${o} `,u=` ${c}`);const h=0,d=8,f=Wb(t,a),g=jN(f)??0,_=Kd(),v=i.trim(),E=fp(n);ri(` $red $29 ${E}${v} `,s,!1);const x=xA("----:----",g,1,`$green${n?_?"$26":"$27":"$4"}${E}`).replaceAll("-","$7").replaceAll(":","$9");ri(`${E}${l}${x}${u} $green${g+1}
`,s,!1);const N=Be.useCallback(I=>{const k=I.alt?10:1;ll(f,Math.min(d,g+k))},[d,g,f]),A=Be.useCallback(I=>{const k=I.alt?10:1;ll(f,Math.max(h,g-k))},[h,g,f]);return Ae.jsx(Ae.Fragment,{children:n&&Ae.jsx(uc,{MOVE_LEFT:A,MOVE_RIGHT:N})})}function qgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a,...o]=[ou(r[0],""),...r.slice(1)],c=[],l=[];for(let x=0;x<o.length;x+=2)c.push(o[x]),l.push(o[x+1]);const u=Wb(t,a),d=`${jN(u)??0}`;let f=l.indexOf(d);f<0&&(f=0);const p=Kd(),g=i.trim(),_=fp(n);ri(` $dkred ? ${_}${g} `,s,!1);const v=n?p?"$26":"$27":"/";ri(`${f+1}$green${v}${_}${l.length}`,s,!1),s.writefullwidth=32,ri(` $green${c[f]}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const E=Be.useCallback(()=>{const x=Math.min(0,f-1),N=parseFloat(l[x]);Number.isInteger(N)&&ll(u,N)},[f,u]),T=Be.useCallback(()=>{const x=Math.max(l.length-1,f+1),N=parseFloat(l[x]);Number.isInteger(N)&&ll(u,N)},[f,u]);return Ae.jsx(Ae.Fragment,{children:n&&Ae.jsx(uc,{MOVE_LEFT:E,MOVE_RIGHT:T})})}function $gt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const a=ou(r[0],""),o=Wb(t,a),c=ipe(o),l=(c==null?void 0:c.toJSON())??"",u=Kd(),[h,d]=Be.useState(0),[f,p]=Be.useState(!1),[g,_]=Be.useState(void 0),v=`${l} `,E=i.trim(),T=fp(n);ri(`$green  $20 ${T}${E} $green`,s,!1);const x=s.x,A=s.y*s.width;s.writefullwidth=32,ri(`${v}`,s,!1),s.writefullwidth=void 0,ri(`
`,s,!1);const I=ae(g),k=s.width-x-2,L=I?Math.min(g,h):h;let U=I?Math.max(g,h):h;I&&(U!==L&&U===h&&--U,pO(x+L+A,x+U+A,15,8,s)),f&&u&&AB(x+h+A,"",s);function $(){ae(c)&&(d(L),_(void 0),c.delete(L,U-L+1))}return Ae.jsxs(Ae.Fragment,{children:[n&&Ae.jsx(uc,{OK_BUTTON:()=>{c&&(p(!0),d(c.length),_(void 0))}}),f&&Ae.jsx(ax,{blockhotkeys:!0,children:Ae.jsx(uc,{MOVE_LEFT:q=>{q.shift?ae(g)||_(Er(h-1,0,l.length)):_(void 0),d(G=>Er(G-1,0,l.length))},MOVE_RIGHT:q=>{q.shift?ae(g)||_(h):_(void 0),d(G=>Er(G+1,0,l.length))},CANCEL_BUTTON:()=>{p(!1),d(l.length),_(void 0)},OK_BUTTON:()=>p(!1),keydown:q=>{if(!c)return;const{key:G}=q,X=ai(G),ie={alt:q.altKey,ctrl:Ab?q.metaKey:q.ctrlKey,shift:q.shiftKey},V=c.toJSON();switch(X){case"delete":I?$():V.length>0&&c.delete(h,1);break;case"backspace":I?$():h>0&&(c.delete(h-1,1),d(Z=>Math.max(0,Z-1)));break;default:if(ie.ctrl)switch(X){case"a":_(0),d(V.length);break;case"c":ae(Ia())&&Ia().writeText(c.toJSON()).catch(Z=>console.error(Z));break;case"v":ae(Ia())&&Ia().readText().then(Z=>{I&&$(),c.insert(h,Z),d(h+Z.length)}).catch(Z=>console.error(Z));break;case"x":ae(Ia())&&Ia().writeText(c.toJSON()).then(()=>$()).catch(Z=>console.error(Z));break}else ie.alt||G.length===1&&V.length<k&&(c.insert(h,G),d(Z=>Z+1));break}}})})]})}function Wgt({chip:t,row:e,active:n,label:i,args:r,context:s}){Jd(e,s);const[a]=[ou(r[0],"")],o="z",c=` ${o.toUpperCase()} `,l=fp(n),u=s.x-.25,h=s.y-.25;ri(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${c}${l}$onclear ${i}${ae(e)?`
`:""}`,s,!0);const d=Be.useContext(l0),f=Be.useCallback(()=>{d.sendmessage(CI(t,a),void 0)},[d,t,a]);return Ae.jsxs("group",{position:[u*kn.DRAW_CHAR_WIDTH(),h*kn.DRAW_CHAR_HEIGHT(),1],children:[Ae.jsx(Fd,{visible:!1,width:c.length+.5,height:1.5,blocking:!0,onClick:f}),n&&Ae.jsx(uc,{OK_BUTTON:f}),Ae.jsx(Aw,{hotkey:o,children:f})]})}function Ygt({row:t,item:e,active:n}){const i=nr(),r=dm();if(Jd(t,r),r.iseven=r.y%2===0,typeof e=="string")return Ae.jsx(Bgt,{player:i,item:e,row:t,context:r});if(Li(e)){const[s,a,o,c,...l]=e;if(typeof s!="string"||typeof a!="string"||typeof o!="string")return null;const u={player:i,chip:s,row:t,active:n,label:a,args:[o,...l],context:r},h=On(c)?c:"";switch(ai(h)){default:case"hyperlink":return Ae.jsx(Hgt,{...u});case"hk":case"hotkey":return Ae.jsx(zgt,{...u});case"rn":case"range":return Ae.jsx(Ggt,{...u});case"sl":case"select":return Ae.jsx(qgt,{...u});case"nm":case"number":return Ae.jsx(Vgt,{...u});case"tx":case"text":return Ae.jsx($gt,{...u});case"copyit":return Ae.jsx(Fgt,{...u});case"linkit":return Ae.jsx(jgt,{...u});case"zssedit":return Ae.jsx(Wgt,{...u});case"charedit":return Ae.jsx(Pgt,{...u});case"coloredit":return Ae.jsx(Ugt,{...u})}RB(r)}return null}function RI({store:t,children:e}){return Ae.jsx(r9.Provider,{value:t,children:e})}function AI({width:t,height:e}){const n=Be.useContext(r9),[i,r,s]=u7(n,ap(a=>[a.char,a.color,a.bg,a.render]));return t>0&&e>0&&Ae.jsx(IY,{char:i.slice(),color:r.slice(),bg:s.slice(),width:t,height:e})}function LY({inline:t=!1,xmargin:e=1,ymargin:n=1,selected:i=-1,width:r,height:s,color:a,bg:o,text:c}){const l=WN(r,s,0,a,o),u=l.getState(),h={...Zb(r,s,a,o,n,e,r-e,s-n),...l.getState(),x:e,y:n};return Gpe(u,0,a,o),Ae.jsxs(RI,{store:l,children:[Ae.jsx(AI,{width:r,height:s}),Ae.jsx(A_.Provider,{value:h,children:c.map((d,f)=>Ae.jsx(Ygt,{row:t?void 0:f,item:d,active:f===i},f))})]})}const Xgt=2,Kgt=14,a_e=Kgt*Xgt;function Jgt(t){return j3(t,a_e*.5)}function Zgt(t,e,n,i,r=1.235){function s(o){return Eft(o,i)}Yv(t.userData,e,n,r,i,a_e*12,s),t.position[e]=Jgt(t.userData[e]);const a=n-t.position.y;return Math.abs(a)<.1}function Qgt({name:t,width:e,height:n,context:i}){const r=qpe();for(let l=1;l<e-1;++l)l>2&&l<e-1&&ko(r,e,n,l,1,{char:205,color:15}),ko(r,e,n,l,n-1,{char:205,color:15});ko(r,e,n,e-2,0,{char:196,color:15}),ko(r,e,n,1,0,{char:205,color:15}),ko(r,e,n,2,0,{char:187,color:15}),ko(r,e,n,2,1,{char:200,color:15});for(let l=1;l<n-1;++l)ko(r,e,n,0,l,{char:179,color:15}),ko(r,e,n,e-1,l,{char:179,color:15});for(let l=2;l<n-1;++l)ko(r,e,n,1,l,{char:0,color:15}),ko(r,e,n,e-2,l,{char:0,color:15});ko(r,e,n,0,0,{char:213,color:15}),ko(r,e,n,e-1,0,{char:191,color:15}),ko(r,e,n,e-1,1,{char:181,color:15}),ko(r,e,n,0,n-1,{char:212,color:15}),ko(r,e,n,e-1,n-1,{char:190,color:15});const s=` ${t} `,a=$N(s,e,n),o=(a==null?void 0:a.x)??s.length,c=e-2;return i.x=2+Math.round(c*.5),i.x-=Math.round(o*.5),i.y++,ri(s,i,!0),null}function Uie({x:t,y:e,color:n,on:i=232,off:r=7,alt:s}){const a=Kd(),o=qpe(),c=Be.useRef(0),l=ae(s)?c.current%2===0?i:s:i;return ko(o,o.width,o.height,t,e,{char:a?l:r,color:n}),o.changed(),a&&++c.current,null}function e0t({store:t,children:e}){return Ae.jsx(jpe.Provider,{value:t,children:e})}function t0t({width:t,height:e}){const n=Be.useContext(jpe),[i]=u7(n,ap(r=>[r.dither,r.render]));return t>0&&e>0&&Ae.jsx(wI,{alphas:i.slice(),width:t,height:e})}function n0t({row:t,width:e,height:n,panelwidth:i,panelheight:r,children:s}){const a=aqe(i,r,0),o=[.001,.05,.1,.2],c=.4,{dither:l}=a.getState();sqe(l);for(let u=0;u<i;++u){fH(l,i,r,u,t,c);for(let h=0;h<o.length;++h){const d=o.length-h;fH(l,i,r,u,t-d,o[h]),fH(l,i,r,u,t+d,o[h])}}return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(AI,{width:e,height:n}),Ae.jsxs("group",{position:[2*kn.DRAW_CHAR_WIDTH(),2*kn.DRAW_CHAR_HEIGHT(),0],children:[Ae.jsx(e0t,{store:a,children:Ae.jsx(t0t,{width:i,height:r})}),s,Ae.jsx(Uie,{x:1,y:1}),Ae.jsx(Uie,{x:1,y:2+t,on:26,alt:27,off:45,color:12})]})]})}function UY({line:t,color:e,margin:n,y:i,leftedge:r,rightedge:s,context:a}){const o=Kd(),l=`$${(Qt[e]??"").toLowerCase()} ${t.replaceAll(`
`,"").trim()} --=--`,u=$N(l,1e4,1),h=(u==null?void 0:u.measuredwidth)??1,[d,f]=Be.useState(0);Be.useEffect(()=>{f(p=>o?p:(p-1)%h)},[o,h]),a.disablewrap=!0,a.active.leftedge=n,a.active.rightedge=s-n;for(let p=r+n+d;p<=s;p+=h)a.x=p,a.y=i,ri(l,a,!1);return a.active.leftedge=0,a.active.rightedge=s,a.disablewrap=!1,null}function i0t({name:t,width:e,height:n,color:i,bg:r,text:s,shouldclose:a}){const{viewport:o}=Zu(),c=e-3,l=n-3,u=WN(e,n,0,i,r),h=Be.useContext(l0),d={...Zb(e,n,i,r,0,0,e,n),...u.getState()},[f,p]=Be.useState(()=>{const A=s.findIndex(I=>Li(I));return A>=0&&A<=8?A:0});let g=f-Math.floor(l*.5);g=Math.min(s.length-l,g),g=Math.max(0,g);const _=s.slice(g,g+l),v=f-g,E=Be.useRef(null),T=Be.useCallback(()=>{a&&h.didclose()},[a,h]),x=Be.useCallback(A=>{const I=A.alt?10:1;p(k=>Math.max(0,k-I))},[p]),N=Be.useCallback(A=>{const I=A.alt?10:1;p(k=>Math.min(s.length,k+I))},[p,s.length]);return Be.useEffect(()=>{if(E.current&&!a){const A=o.height;E.current.position.y=A,E.current.userData.y=A,E.current.userData.vy=0}},[a]),hy(Be.useCallback((A,I)=>{if(ae(E.current)){const k=a?n*2*-kn.DRAW_CHAR_HEIGHT():0;Zgt(E.current,"y",k,I)&&T()}},[a,T,n])),Ae.jsx("group",{ref:E,"position-y":1e6,children:Ae.jsxs(ax,{children:[Ae.jsx(uc,{MOVE_UP:x,MOVE_DOWN:N,CANCEL_BUTTON:h.sendclose}),Ae.jsxs(RI,{store:u,children:[Ae.jsx(Qgt,{name:t,width:e,height:n,context:d}),Ae.jsx(UY,{margin:3,color:Qt.BLUE,y:0,leftedge:0,rightedge:e-1,line:`
   up/down$white.SCROLL UP/DOWN   $blue
esc/cancel$white.CLOSE SCROLL   $blue
alt+up/down$white.JUMP 10 LINES   $blue
`,context:d}),Ae.jsx(n0t,{row:v,width:e,height:n,panelwidth:c,panelheight:l,children:Ae.jsx(LY,{name:t,width:c,height:l,xmargin:0,ymargin:0,color:i,bg:Qt.ONCLEAR,text:_,selected:v})})]})]})})}const Bie=new Rt,Fie=[153,5,42,94,24,25,26,27,16,17,30,31,234,227,227].map((t,e)=>[t,e%3===0?176:177,e%3===0?178:176]).flat();function r0t({context:t,width:e,height:n,drawstick:i}){const{islandscape:r,sidebaropen:s,showkeyboard:a}=zh();if(Gpe(t,0,Qt.WHITE,Qt.ONCLEAR),!r){const o=e*n;for(let c=4*e;c<o;++c)t.char[c]=s?Fie[c%Fie.length]:0,t.color[c]=s?Qt.DKPURPLE:Qt.ONCLEAR}t.y=3;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,ri("$YELLOW$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,ri(`$WHITE$176$176$176$176$176
`,t,!1);t.y=n-5;for(let o=0;o<3;++o)t.x=t.active.leftedge=1,ri("$GREEN$176$176$176$176$176",t,!1),t.x=t.active.leftedge=e-7,ri(`$RED$176$176$176$176$176
`,t,!1);if(t.y=n-5,t.active.leftedge=1,t.active.bg=Qt.ONCLEAR,a?(++t.y,t.x=Math.round((e-8)*.5),ri("$GREY$221",t,!1),t.x+=5,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),ri("$GREY$221",t,!1),t.x+=3,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-4)*.5),ri("$GREY$221",t,!1),++t.x,ri(`$GREY$222
`,t,!1)):(t.x=Math.round((e-4)*.5),ri("$GREY$221",t,!1),++t.x,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-6)*.5),ri("$GREY$221",t,!1),t.x+=3,ri(`$GREY$222
`,t,!1),t.x=Math.round((e-8)*.5),ri("$GREY$221",t,!1),t.x+=5,ri(`$GREY$222
`,t,!1)),i.startx!==-1){t.active.leftedge=0,t.x=t.active.leftedge=i.startx-4,t.y=i.starty-3;for(let c=0;c<5;++c)ri(`$BLUE$176$176$176$176$176$176$176$176
`,t,!1);Bie.set(i.tipx-i.startx,i.tipy-i.starty);const o=Tue(j3(xue(Bie.angle()),45));t.x=t.active.leftedge=Math.round(i.startx+Math.cos(o)*4)-2,t.y=Math.round(i.starty+Math.sin(o)*3)-2;for(let c=0;c<3;++c)ri(`$BLUE$177$177$177$177
`,t,!1)}return r||(t.active.leftedge=1,t.y=4,t.x=2,ri("$YELLOW?",t,!1),t.x=e-7,ri("$WHITEMENU",t,!1),t.y=n-4,t.x=2,ri("$GREENOKAY",t,!1),t.x=e-9,ri("$REDCANCEL",t,!1)),null}function s0t(t,e){switch(t){case 0:Md.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(Vu);break;case 45:Md.keyboard(e?"{Shift>}[ArrowLeft][ArrowUp]{/Shift}":"[ArrowLeft][ArrowUp]").catch(Vu);break;case 90:Md.keyboard(e?"{Shift>}[ArrowUp]{/Shift}":"[ArrowUp]").catch(Vu);break;case 135:Md.keyboard(e?"{Shift>}[ArrowRight][ArrowUp]{/Shift}":"[ArrowRight][ArrowUp]").catch(Vu);break;case 180:Md.keyboard(e?"{Shift>}[ArrowRight]{/Shift}":"[ArrowRight]").catch(Vu);break;case 225:Md.keyboard(e?"{Shift>}[ArrowRight][ArrowDown]{/Shift}":"[ArrowRight][ArrowDown]").catch(Vu);break;case 270:Md.keyboard(e?"{Shift>}[ArrowDown]{/Shift}":"[ArrowDown]").catch(Vu);break;case 315:Md.keyboard(e?"{Shift>}[ArrowLeft][ArrowDown]{/Shift}":"[ArrowLeft][ArrowDown]").catch(Vu);break;case 360:Md.keyboard(e?"{Shift>}[ArrowLeft]{/Shift}":"[ArrowLeft]").catch(Vu);break}}const a0t=BO/1e3,aA=new Rt,tw=new Re;function oA(t,e){const n=kn.DRAW_CHAR_WIDTH(),i=kn.DRAW_CHAR_HEIGHT(),r=tw.x+n*.5,s=tw.y+i*.5;return{cx:Math.floor(t*.5)+Math.floor(r/n),cy:Math.floor(e*.5)+Math.floor(s/i)}}function o0t({width:t,height:e,player:n,onDrawStick:i}){const{islandscape:r}=zh(),[s]=Be.useState({startx:-1,starty:-1,tipx:-1,tipy:-1,pointerid:-1,presscount:0,inputacc:BO});function a(o,c){s.tipx===-1&&(E_(o,c,3,6,6,1)?FDe(Ge,n):E_(o,c,3,t-2,6,t-6)?Md.keyboard("[Tab]").catch(Vu):E_(o,c,e-5,6,e-2,1)?Md.keyboard("[Enter]").catch(Vu):E_(o,c,e-5,t-2,e-2,t-6)?Md.keyboard("[Escape]").catch(Vu):r&&E_(o,c,6,t,e-6,t-5)||!r&&E_(o,c,0,t-12,3,12)?zh.setState(l=>({...l,sidebaropen:!l.sidebaropen})):E_(o,c,e-4,t-12,e-2,12)&&zh.setState({showkeyboard:!0})),s.startx=-1,s.starty=-1,s.tipx=-1,s.tipy=-1,s.pointerid=-1,i(s.startx,s.starty,s.tipx,s.tipy)}return hy((o,c)=>{if(s.inputacc+=c,s.inputacc>=a0t&&s.presscount>0){s.inputacc=0;const{cx:l,cy:u}=oA(t,e);if(aA.set(s.startx-l,s.starty-u),s.tipx!==-1||aA.length()>3){const h=j3(xue(aA.angle()),45);s0t(h,s.presscount>1)}}}),Ae.jsx(Fd,{width:t,height:e,visible:!1,onPointerDown:o=>{if(iE(),++s.presscount,s.startx===-1){o.intersections[0].object.worldToLocal(tw.copy(o.intersections[0].point));const{cx:c,cy:l}=oA(t,e);s.startx=c,s.starty=l,s.tipx=-1,s.tipy=-1,s.pointerid=o.pointerId,s.inputacc=BO}},onPointerMove:o=>{if(o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(tw.copy(o.intersections[0].point));const{cx:c,cy:l}=oA(t,e);aA.set(s.startx-c,s.starty-l),(s.tipx!==-1||aA.length()>3)&&(s.tipx=c,s.tipy=l,i(s.startx,s.starty,s.tipx,s.tipy))}},onPointerCancel:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(tw.copy(o.intersections[0].point));const{cx:c,cy:l}=oA(t,e);a(c,l)}},onPointerUp:o=>{if(--s.presscount,o.pointerId===s.pointerid){o.intersections[0].object.worldToLocal(tw.copy(o.intersections[0].point));const{cx:c,cy:l}=oA(t,e);a(c,l)}}})}function c0t({width:t,height:e}){const n=nr(),[i,r]=Be.useState({startx:-1,starty:-1,tipx:-1,tipy:-1}),s=WN(t,e,0,Qt.WHITE,Qt.ONCLEAR),a={...Zb(t,e,Qt.WHITE,Qt.ONCLEAR),...s.getState()};return iqe(1,1,t-2,e-2,a),Ae.jsxs(RI,{store:s,children:[Ae.jsx(r0t,{context:a,width:t,height:e,drawstick:i}),Ae.jsx(o0t,{width:t,height:e,player:n,onDrawStick:(o,c,l,u)=>r({startx:o,starty:c,tipx:l,tipy:u})}),Ae.jsx(UO,{width:t,height:e,top:5,left:0,right:5,bottom:e-6,alpha:.47135}),Ae.jsx(UO,{width:t,height:e,top:5,left:t-6,right:t-1,bottom:e-6,alpha:.47135}),Ae.jsx(AI,{width:t,height:e})]})}const zie=1.5,Hie=56,l0t=16,u0t=[[`
`],["[Escape]","$","1","2","3","4","5","6","7","8","9","0","&",`
`],[" ","Q","W","E","R","T","Y","U","I","O","P","-","+","*",`
`,`
`],["A","S","D","F","G","H","J","K","L","[Backspace]","_","=","%",`
`],[" ","Z","X","C","V","B","N","M","!","[Enter]","(",")","|",`
`],["                                          ","<",">","`",`
`],["[Space]","#","/","?",":","'",";",'"',"  ","[ArrowUp]",`
`],["         ","[Shift]","[Ctrl]","[Alt]","@","[ArrowLeft]","    ","[ArrowRight]",`
`],["                                      ","[ArrowDown]",`
`],["$greenz s s k e y s"]].flat();function h0t(t){return t.replaceAll("{","").replaceAll("}","").replaceAll("[","").replaceAll("]","")}function d0t(t,e,n,i){let r=t,s=h0t(t);switch(t){case"$":s=" $$ ";break;case";":s=" $59 ";break;case"[Escape]":s=" esc ";break;case"[ArrowUp]":s=" $30 ";break;case"[ArrowDown]":s=" $31 ";break;case"[ArrowRight]":s=" $16 ";break;case"[ArrowLeft]":s=" $17 ";break;case"[Backspace]":s=" del ";break;case"[Shift]":s=i?" SHIFT ":" shift ";break;case"[Ctrl]":s=n?" CTRL ":" ctrl ";break;case"[Alt]":s=e?" ALT ":" alt ";break;default:if(!i)r=r.toLowerCase(),s=s.toLowerCase();else switch(s){case"(":s="[";break;case")":s="]";break;case"<":s="{";break;case">":s="}";break;case"`":s="~";break}s=` ${s} `;break}return["touchkey","",r,"hk","",s]}function f0t({width:t,height:e}){const n=nr(),{showkeyboard:i,keyboardalt:r,keyboardctrl:s,keyboardshift:a}=zh(),o=Be.useRef(null),[c]=Be.useState({}),l=16;return i&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(Fd,{blocking:!0,width:t,height:e,visible:!1,onPointerDown:u=>{iE(),c[u.pointerId]=u.point.x,ae(o.current)&&(o.current.userData.x=o.current.position.x)},onPointerMove:u=>{const h=c[u.pointerId],d=u.point.x;if(ae(h)&&o.current){const f=kn.DRAW_CHAR_WIDTH()*zie,p=Math.round(j3(d-h,f)/f);o.current.position.x=Er(o.current.userData.x+p*f,Hie*-f+t*kn.DRAW_CHAR_WIDTH(),0)}},onPointerUp:u=>{delete c[u.pointerId]}}),Ae.jsx(UO,{width:t,height:e,top:5,left:0,right:t-1,bottom:e-1,alpha:.753718}),Ae.jsx("group",{position:[0,0,1],children:Ae.jsx(Fd,{visible:!1,x:t*.5-l*.5,y:e-3.5,width:l,height:4,onClick:()=>{zh.setState({showkeyboard:!1})}})}),Ae.jsx("group",{ref:o,scale:zie,children:Ae.jsx(l0.Provider,{value:{sendmessage(u,h){Ge.emit(n,u,h)},sendclose(){},didclose(){}},children:Ae.jsx(LY,{name:"keyboard",inline:!0,ymargin:1,color:Qt.WHITE,bg:Qt.ONCLEAR,width:Hie,height:l0t,text:u0t.map(u=>{switch(u){case`
`:return u;default:if(u.includes(" "))return u}return d0t(u,r,s,a)})})})})]})}function p0t({width:t,height:e}){const n=Y6();return n.cols<10||n.rows<10?null:Ae.jsxs(Ae.Fragment,{children:[Ae.jsx("group",{position:[0,0,800],children:Ae.jsx(c0t,{width:t,height:e})}),Ae.jsx("group",{position:[0,0,850],children:Ae.jsx(f0t,{width:t,height:e})})]})}const o_e=Be.createContext({cols:1,rows:1});function Y6(){return Be.useContext(o_e)}function m0t({children:t}){const{viewport:e}=Zu(),{width:n,height:i}=e.getCurrentViewport(),{islandscape:r,showtouchcontrols:s}=zh(),a=n/kn.DRAW_CHAR_WIDTH();let o=Math.floor(a);const c=i/kn.DRAW_CHAR_HEIGHT();let l=Math.floor(c);const u=(n-o*kn.DRAW_CHAR_WIDTH())*.5,h=(i-l*kn.DRAW_CHAR_HEIGHT())*.5;let d=0,f=0;const p=Math.round(a);let g=Math.round(c);if(s)if(r)d=5*kn.DRAW_CHAR_WIDTH(),o-=5*2;else{l=Math.round(l*.666);const _=l-4;g-=_,f=_*kn.DRAW_CHAR_HEIGHT()}return Be.useEffect(()=>{zh.setState(_=>({..._,insetcols:p,insetrows:g}))},[p,g]),Ae.jsxs(o_e.Provider,{value:{cols:o,rows:l},children:[Ae.jsx(Rft,{makeDefault:!0,near:1,far:2e3,position:[0,0,1e3]}),o>=10&&l>=10&&Ae.jsx("group",{"scale-x":-1,"rotation-z":Math.PI,children:Ae.jsxs("group",{position:[n*-.5+u,i*-.5+h,0],children:[Ae.jsx("group",{position:[d,0,0],children:t}),s&&Ae.jsx("group",{position:[0,f,0],children:Ae.jsx(p0t,{width:p,height:g},p*g)})]})})]})}function jie({rect:t,islandscape:e=!0,sidebaropen:n=!0,shouldclose:i=!1}){switch(t.type){case 0:return Ae.jsx(LY,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,xmargin:e?1:n?3:10,ymargin:e&&!n?6:0});case 1:return Ae.jsx(i0t,{name:t.name,width:t.width,height:t.height,color:14,bg:1,text:t.text,shouldclose:i});case 2:return Ae.jsx(kgt,{width:t.width,height:t.height})}return null}const g1=20;function g0t(){const t=Y6(),{islandscape:e,sidebaropen:n,insetrows:i,showtouchcontrols:r}=zh(),s=Eo(OZ(p=>p.gadget.scroll??[])),a=s.length===0,[o,c]=Be.useState(!1),l=Eo(OZ(p=>p.gadget.sidebar??[]));if(t.cols<10||t.rows<10)return null;const u={name:"main",type:2,x:0,y:0,text:[],width:t.cols,height:t.rows},h=[];if(l.length)if(r)if(e){const p=n?g1+5:g1,g=n?g1:4,_={name:"sidebar",type:0,x:u.x+u.width-g,y:u.y,width:p,height:u.height,text:l};u.width-=g,h.push(_)}else{const p=n?i-7:i,g=n?p:4,_={name:"sidebar",type:0,x:0,y:u.y+u.height-g,width:u.width,height:p,text:l};u.height-=g,h.push(_)}else{const p={name:"sidebar",type:0,x:u.x+u.width-g1,y:u.y,width:g1,height:u.height,text:l};u.width-=g1,h.push(p)}const d={name:"scroll",type:1,x:0,y:0,width:Er(50,24,u.width-2),height:Er(18,8,u.height-8),text:s};d.x=u.x+Math.floor((u.width-d.width)*.5),d.y=u.y+Math.floor((u.height-d.height)*.5),!a&&!o&&c(!0),h.unshift(u);const f=nr();return Ae.jsx(l0.Provider,{value:{sendmessage(p,g){Ge.emit(f,p,g)},sendclose(){wDe(Ge,f)},didclose(){c(!1)}},children:Ae.jsxs("group",{position:[0,0,-512],children:[h.map(p=>Ae.jsx("group",{position:[p.x*kn.DRAW_CHAR_WIDTH(),p.y*kn.DRAW_CHAR_HEIGHT(),0],children:Ae.jsx(jie,{islandscape:!r||e,sidebaropen:!r||n,rect:p})},p.name)),o&&Ae.jsxs(Eg.Fragment,{children:[Ae.jsx("group",{position:[0,0,800],children:Ae.jsx(tgt,{width:t.cols,height:t.rows,alpha:.14})}),Ae.jsx("group",{position:[d.x*kn.DRAW_CHAR_WIDTH(),d.y*kn.DRAW_CHAR_HEIGHT(),900],children:Ae.jsx(jie,{rect:d,shouldclose:a})})]},"scroll")]})})}const v0t=250,y0t=249,FO=Qt.BLUE,_0t=Qt.WHITE,b0t=Qt.DKGRAY,BY=Qt.BLACK;function lR(t){return t?Qt.ONCLEAR:Qt.DKBLUE}const c_e=Be.createContext({sendmessage(){}});function ZS(t,e,n,i,r){const s=hm(r);r.iseven=r.y%2===0,r.active.bg=e&&!t?BY:r.reset.bg,r.active.leftedge=s.left,r.active.rightedge=s.right,r.active.topedge=s.top,r.active.bottomedge=s.bottom,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function RS(t,e,n,i,r,s,a,o){const c=hm(r);r.iseven=r.y%2===0,r.active.color=Qt.WHITE,r.active.bg=r.reset.bg,r.active.leftedge=c.left+s,r.active.rightedge=c.right-s,r.active.topedge=c.top+a,r.active.bottomedge=c.bottom-o,r.x=r.active.leftedge+n,r.y=r.active.topedge+i}function E0t(t){let e=0;return t.split(/\r?\n/).map(i=>{const r=e,s=`${i}
`;return e+=s.length,{start:r,code:s,end:r+i.length}})}function S0t(t){return t.reduce((e,n)=>{const i=n.code.length;return i>e?i:e},0)}function T0t(t,e){for(let n=0;n<e.length;++n)if(t<=e[n].end)return n;return 0}function FY({bump:t,context:e}){const n=hm(e),{quickterminal:i}=Us(),r=lR(i);if(t&&n.top++,i){for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a)ko(e,e.width,e.height,a,s,{char:0,color:FO,bg:r});return null}for(let s=n.top;s<=n.bottom;++s)for(let a=n.left;a<=n.right;++a){let o=0;(a+s)%2===0&&(o=Math.abs(Math.round(Math.cos(a*s*.01)))?v0t:y0t),ko(e,e.width,e.height,a,s,{char:o,color:FO,bg:r})}return null}const tj=Qt.WHITE,nw=Qt.GREEN,Tc=Qt.YELLOW,x0t=Qt.CYAN,Id=Qt.DKGREEN;Qt.DKGREEN;const Vie=Qt.DKCYAN,w0t=Qt.GREEN,PP=Qt.BLUE,l_e=Qt.DKPURPLE,u_e=Qt.WHITE,C0t=Qt.DKRED,nj=Qt.DKYELLOW,R0t={[aC.tokenTypeIdx??0]:tj,[Vde.tokenTypeIdx??0]:tj,[Gde.tokenTypeIdx??0]:tj,[PN.tokenTypeIdx??0]:PP,[CS.tokenTypeIdx??0]:Tc,[fB.tokenTypeIdx??0]:nw,[Y7.tokenTypeIdx??0]:x0t,[X7.tokenTypeIdx??0]:C0t,[K7.tokenTypeIdx??0]:Tc,[J7.tokenTypeIdx??0]:nw,[gl.tokenTypeIdx??0]:nw,[Z7.tokenTypeIdx??0]:nw,[Q7.tokenTypeIdx??0]:u_e,[eW.tokenTypeIdx??0]:Tc,[tW.tokenTypeIdx??0]:Tc,[nW.tokenTypeIdx??0]:Tc,[iW.tokenTypeIdx??0]:Tc,[rW.tokenTypeIdx??0]:Tc,[sW.tokenTypeIdx??0]:Tc,[N2.tokenTypeIdx??0]:nj,[I2.tokenTypeIdx??0]:nj,[k2.tokenTypeIdx??0]:nj,[D2.tokenTypeIdx??0]:Tc,[P2.tokenTypeIdx??0]:Tc,[aW.tokenTypeIdx??0]:Tc,[oW.tokenTypeIdx??0]:Tc,[L2.tokenTypeIdx??0]:Tc,[cW.tokenTypeIdx??0]:Tc,[lW.tokenTypeIdx??0]:Tc,[uW.tokenTypeIdx??0]:Tc,[hW.tokenTypeIdx??0]:Tc,[dW.tokenTypeIdx??0]:Tc,[fW.tokenTypeIdx??0]:w0t,[U2.tokenTypeIdx??0]:Id,[eM.tokenTypeIdx??0]:Vie,[B2.tokenTypeIdx??0]:Vie,[F2.tokenTypeIdx??0]:Id,[pW.tokenTypeIdx??0]:Id,[mW.tokenTypeIdx??0]:Id,[gW.tokenTypeIdx??0]:Id,[vW.tokenTypeIdx??0]:Id,[yW.tokenTypeIdx??0]:Id,[_W.tokenTypeIdx??0]:Id};Qt.DKPURPLE;const A0t=Qt.DKYELLOW,M0t=l_e,O0t=Qt.CYAN,N0t=Qt.DKCYAN,I0t=Qt.RED,k0t=Qt.WHITE,D0t=Qt.LTGRAY,h_e=new Map;function Qm(t,e){h_e.set(t,e)}function P0t(t){if(t.startsWith("play ")){const e=[];for(let n=0;n<t.length;++n)n<5?e.push(Id):e.push(Wie(t[n]));return e.push(Qt.BLUE),e}else if(t.startsWith("bgplay ")){const e=[];for(let n=0;n<t.length;++n)n<7?e.push(Id):e.push(Wie(t[n]));return e.push(Qt.BLUE),e}return h_e.get(t)??Qt.GREEN}const uS=Qt.GREEN,L0t=Qt.DKGREEN,eg=Qt.PURPLE,hS=Qt.DKCYAN,Gie=Qt.CYAN,qie=Qt.YELLOW,$ie=Qt.DKYELLOW,d_e=new Map;function is(t,e){d_e.set(t,e)}function Wie(t){return d_e.get(t)??Qt.GREEN}function U0t(){const t=dm(),e=hm(t),[n,i,r]=Us(ap(v=>[v.quickterminal,v.editor.type,v.editor.title])),s=Qt.WHITE,a=lR(n);for(let v=e.top;v<e.bottom;++v)ko(t,t.width,t.height,e.left,v,{char:179,color:s,bg:a}),ko(t,t.width,t.height,e.right,v,{char:179,color:s,bg:a});RS(!1,!1,0,0,t,0,0,0),ri("$213$205$187",t,!0),RS(!1,!1,t.width-3,0,t,0,0,0),ri("$196$196$191",t,!0);const o="$205".repeat(e.width-2);RS(!1,!1,0,e.height-1,t,0,0,0),ri(`$212${o}$190`,t,!0);const c=Kd(),l="$205".repeat(e.width-4);RS(!1,!1,0,1,t,0,0,0),ri(`$179$${c?"7":"232"}$200${l}$181`,t,!0);const h=` ${`$blue[${i}] `}$green${r}$white `,d=$N(h,e.width,e.height),f=(d==null?void 0:d.measuredwidth)??1,p=e.width-2,g=2+Math.round(p*.5)-Math.round(f*.5);RS(!1,!1,g,1,t,0,0,0),ri(h,t,!0);const _=Ab?`shift+${Cd}+z`:`${Cd}+y`;return Ae.jsx(UY,{margin:3,color:Qt.BLUE,y:e.top,leftedge:0,rightedge:e.width-1,line:`
    esc/cancel$white.CLOSE   $blue
    tab$white.CHANGE LAYOUT   $blue
    hold shift$white.SELECT TEXT   $blue
    alt+up/down$white.JUMP 10 LINES   $blue
    alt+left/right$white.JUMP 10 COLS   $blue
    ${Cd}+up/down$white.JUMP TOP/BOTTOM   $blue
    ${Cd}+left/right$white.JUMP TO START/END OF LINE   $blue
    ${Cd}+a$white.SELECT ALL   $blue
    ${Cd}+c$white.COPY   $blue
    ${Cd}+x$white.CUT   $blue
    ${Cd}+v$white.PASTE   $blue
    ${Cd}+z$white.UNDO   $blue
    ${_}$white.REDO   $blue
    ${Cd}+p$white.TEST SELECTED CODE   $blue
    ${Cd}+k$white.PICK REFSHEET   $blue
    ${Cd}+e$white.COPY CODEPAGE TO CLIPBOARD AS JSON   $blue
    `,context:t})}const B0t=t=>{const e="nativeEvent"in t?t.nativeEvent:t;return{deltaX:e.deltaX||0,deltaY:e.deltaY||0,deltaZ:e.deltaZ||0,timeStamp:e.timeStamp}},F0t=t=>[t.deltaX,t.deltaY,t.deltaZ],MD=t=>{const e=F0t(t).map(Math.abs);return Math.max(...e)};var D_;(function(t){t.ALL_OTHER_CHECKS_FAILED="ALL_OTHER_CHECKS_FAILED",t.NO_PREVIOUS_EVENT_TO_COMPARE="NO_PREVIOUS_EVENT_TO_COMPARE",t.PAST_TIMESTAMP_EVENT="PAST_TIMESTAMP_EVENT",t.ENOUGH_TIME_PASSED="ENOUGH_TIME_PASSED",t.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN="NON_DECREASING_DELTAS_OF_KNOWN_HUMAN",t.DELTA_MODULE_HAS_BEEN_INCREASING="DELTA_MODULE_HAS_BEEN_INCREASING"})(D_||(D_={}));class z0t{constructor({sensitivity:e=2,delay:n=100,increasingDeltasThreshold:i=3}={}){Qn(this,"sensitivity");Qn(this,"delay");Qn(this,"increasingDeltasThreshold");Qn(this,"previousEvents");this.sensitivity=Math.max(1,e),this.delay=Math.max(1,n),this.increasingDeltasThreshold=Math.max(2,i),this.previousEvents=[]}check(e){var s;if(!(("nativeEvent"in e?e.nativeEvent:e)instanceof Event))throw new Error(`"${e}" is not a valid event`);const i=B0t(e);if(MD(i)<this.sensitivity)return!1;const{isHuman:r}=this.isHuman(i);return r?this.previousEvents=[i]:i.timeStamp>(((s=this.previousEvents.at(-1))==null?void 0:s.timeStamp)||0)&&this.previousEvents.push(i),r}isHuman(e){const n=this.previousEvents.at(-1);if(!n)return{isHuman:!0,reason:D_.NO_PREVIOUS_EVENT_TO_COMPARE};if(e.timeStamp<n.timeStamp)return{isHuman:!1,reason:D_.PAST_TIMESTAMP_EVENT};if(e.timeStamp>n.timeStamp+this.delay)return{isHuman:!0,reason:D_.ENOUGH_TIME_PASSED};const s=MD(e),a=MD(n);if(s>=a){if(this.previousEvents.length===1)return{isHuman:!0,reason:D_.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN};if(this.increasingDeltasThreshold<=2||this.previousEvents.length>=this.increasingDeltasThreshold&&this.previousEvents.slice(-this.increasingDeltasThreshold).map(MD).every((u,h,d)=>h===0||u>d[h-1]))return{isHuman:!0,reason:D_.DELTA_MODULE_HAS_BEEN_INCREASING}}return{isHuman:!1,reason:D_.ALL_OTHER_CHECKS_FAILED}}}const H0t=new z0t({sensitivity:Ab?7:2}),Yie=4,j0t=.75;function V0t(t){const e=Er(t,-Yie,Yie);return Math.round(e*j0t)}function f_e({debug:t=!1,disabled:e=!1,blocking:n=!0,cursor:i="pointer",x:r=0,y:s=0,width:a=30,height:o=10,children:c,onScroll:l,...u}){return Ae.jsxs("group",{...u,children:[Ae.jsx(Fd,{blocking:n,cursor:i,visible:t,x:r,y:s,width:a,height:o,onWheel:h=>{e||!H0t.check(h)||l==null||l(V0t(h.deltaY))}}),c]})}function G0t({xcursor:t,ycursor:e,xoffset:n,yoffset:i,rows:r,codepage:s}){var X,ie;const a=Kd(),o=dm(),c=Be.useRef(),l=ho(),u=hm(o),h=Us(V=>V.editor.path),d=nr(),f=ae(s)?s.toJSON():"",p=r.length-1,g=t+1-n,_=e+2-i;if(ae(s)){const V=((X=c.current)==null?void 0:X.x)!==g||((ie=c.current)==null?void 0:ie.y)!==_;if(a||V){const Z=u.left+g,Y=u.top+_;Y>u.top+1&&Y<u.bottom&&Z>u.left&&Z<u.right&&AB(Z+Y*o.width,"",o)}}c.current={x:g,y:_};const v=r[p].end,E=r[e];let T=l.cursor,x=l.cursor,N=!1;ae(l.select)&&(N=!0,T=Math.min(l.cursor,l.select),x=Math.max(l.cursor,l.select),l.cursor!==l.select&&--x);const A=x-T+1,I=N?f.substring(T,x+1):f;function k(V){V?ae(l.select)||ho.setState({select:l.cursor}):ho.setState({select:void 0})}function L(V,Z,Y){Z>0&&(s==null||s.delete(V,Z)),ae(Y)&&(s==null||s.insert(V,Y)),ho.setState({cursor:V+(Y??"").length,select:void 0})}function U(){ae(l.select)&&(ho.setState({cursor:T}),L(T,A))}function $(){ho.setState({cursor:v,select:void 0})}const q=Be.useCallback(function(Z){const Y=Math.round(e+Z);if(Y<0)ho.setState({cursor:0});else if(Y>p)ho.setState({cursor:v});else{const ee=r[Y];ho.setState({cursor:ee.start+Math.min(t,ee.code.length-1)})}},[v,r,p,t,e]),G=Be.useMemo(()=>s?new qje(s):void 0,[s]);return Be.useEffect(()=>{function V(Y){Y.stackItem.meta.set("cursor",l.cursor)}function Z(Y){if(Y.stackItem.meta.has("cursor")){const ee=Y.stackItem.meta.get("cursor");ho.setState({cursor:ee})}}return G==null||G.on("stack-item-added",V),G==null||G.on("stack-item-popped",Z),()=>{G==null||G.off("stack-item-added",V),G==null||G.off("stack-item-popped",Z)}},[G,l.cursor]),Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(f_e,{blocking:!0,x:u.left,y:u.top,width:u.width,height:u.height,onScroll:V=>q(V*.75)}),Ae.jsx(uc,{keydown:V=>{if(!ae(s))return;const{key:Z}=V,Y=ai(Z),ee=W6(V);switch(Y){case"arrowleft":if(k(ee.shift),ee.ctrl)ho.setState({cursor:E.start});else{const oe=l.cursor-(ee.alt?10:1);ho.setState({cursor:Er(oe,0,v)})}break;case"arrowright":if(k(ee.shift),ee.ctrl)ho.setState({cursor:E.end});else{const oe=l.cursor+(ee.alt?10:1);ho.setState({cursor:Er(oe,0,v)})}break;case"arrowup":k(ee.shift),ee.ctrl?ho.setState({cursor:0}):q(ee.alt?-10:-1);break;case"arrowdown":k(ee.shift),ee.ctrl?ho.setState({cursor:v}):q(ee.alt?10:1);break;case"enter":ae(s)&&(s.insert(l.cursor,`
`),ho.setState({cursor:l.cursor+1}));break;case"esc":case"escape":ee.shift||ee.alt||ee.ctrl?m2(Ge,d):HDe(Ge,d);break;case"tab":Mue(Ge,d,!ee.shift);break;case"delete":N?U():L(l.cursor,1);break;case"backspace":N?U():f.length>0&&L(Math.max(l.cursor-1,0),1);break;default:if(ee.ctrl)switch(Y){case"e":JDe(Ge,d,h);break;case"k":ZDe(Ge,d,h);break;case"z":Ab&&ee.shift?G==null||G.redo():G==null||G.undo();break;case"y":Ab||G==null||G.redo();break;case"a":ho.setState({cursor:v,select:0});break;case"c":ae(Ia())?Ia().writeText(I).catch(oe=>Hi(Ge,d,"clipboard",oe)):$();break;case"v":ae(Ia())?Ia().readText().then(oe=>{const de=oe.replaceAll("\r","");N?L(T,A,de):L(l.cursor,0,de)}).catch(oe=>Hi(Ge,d,"clipboard",oe)):$();break;case"x":ae(Ia())?Ia().writeText(I).then(()=>U()).catch(oe=>Hi(Ge,d,"clipboard",oe)):$();break;case"p":Lv(Ge,d,I),$a(Ge,d,`running: ${I.substring(0,18)}`);break}else if(!ee.alt){if(Z.length===1)if(N)L(T,A,Z);else{const oe=l.cursor+Z.length;s.insert(l.cursor,Z),ho.setState({cursor:oe})}}break}}})]})}function q0t({ycursor:t,xoffset:e,yoffset:n,rows:i,codepage:r}){const s=Kd(),a=dm(),o=ho(),{editor:c,quickterminal:l}=Us();if(!ae(r)){const v=(s?"|":"-").repeat(3);return RS(!1,!1,0,0,a,1,2,1),ri(` ${v} LOADING ${v}`,a,!0),null}const u=c.refsheet.length>0,h=a.width-(u?28:3),d=hm(a);d.right=h;let f=o.cursor,p=o.cursor,g=!1;ae(o.select)&&(g=!0,f=Math.min(o.cursor,o.select),p=Math.max(o.cursor,o.select),o.cursor!==o.select&&--p);const _=d.left+1;RS(!1,!1,-e,-n,a,1,2,1);for(let v=0;v<i.length;++v){if(a.y<=d.top+1){++a.y;continue}const E=i[v],T=v===t,x=E.code.replaceAll(`
`,"");a.x=_-e,a.iseven=a.y%2===0,a.active.bg=T?BY:lR(l),a.disablewrap=!0,a.active.rightedge=h,Fpe(`${x} `,a,!1);const N=1+a.y*a.width;if(ae(E.tokens))for(let A=0;A<E.tokens.length;++A){const I=E.tokens[A],k=(I.startColumn??1)-1-e,L=(I.endColumn??1)-1-e,U=R0t[I.tokenTypeIdx];if(ae(U))switch(U){case PP:{const $=I.image.substring(1).split(" ");switch(Xde("",$,!!I.payload).type){case cn.LOADER:case cn.BOARD:case cn.OBJECT:case cn.TERRAIN:case cn.CHARSET:case cn.PALETTE:{const[G]=$;Jm(N,d.right,k,k+G.length,PP,a.active.bg,a),$.length>1&&Jm(N,d.right,k+G.length+1,L,nw,a.active.bg,a);break}case cn.CONST:{const[G]=$;Jm(N,d.right,k,k+G.length,l_e,a.active.bg,a),$.length>1&&Jm(N,d.right,k+G.length+1,L,u_e,a.active.bg,a);break}case cn.RANGE:case cn.SELECT:case cn.NUMBER:case cn.TEXT:case cn.LINK:case cn.HOTKEY:case cn.COPYIT:case cn.OPENIT:case cn.ZSSEDIT:case cn.CHAREDIT:case cn.COLOREDIT:{const[G]=$;Jm(N,d.right,k,k+G.length,PP,a.active.bg,a);break}default:Jm(N,d.right,k,L,Qt.DKRED,a.active.bg,a);break}break}case nw:{const $=P0t(I.image);if(Li($))for(let q=0;q<$.length;++q)Jm(N,d.right,k+q,L+q,$[q],a.active.bg,a);else Jm(N,d.right,k,L,$,a.active.bg,a);break}default:Jm(N,d.right,k,L,U,a.active.bg,a);break}}if(g&&E.start<=p&&E.end>=f){const A=Math.max(E.start,f)-E.start-e,I=Math.min(E.end,p)-E.start-e,k=d.width-3,L=Math.max(0,A),U=Math.min(k,I);L<=k&&U>=_&&Jm(N,d.right,L,U,_0t,b0t,a)}if(++a.y,a.y>=d.bottom)break}if(u){let v=0;for(let E=d.top+2;E<d.bottom;++E){a.active.rightedge=a.width-2,a.active.leftedge=d.right+2,ko(a,a.width,a.height,d.right+1,E,{char:179,color:FO,bg:Qt.DKBLUE});const T=c.refsheet[v++];ae(T)&&(a.x=a.active.leftedge-1,a.y=E,ri(`$white$ondkblue ${T}`,a,!0))}}return a.disablewrap=!1,a.active.rightedge=a.width,null}function ij(t){switch(t){case"stat":case"text":case"hyperlink":return!1;default:return!0}}function rj(){const t=nr(),[e]=Us(ap(U=>[U.editor])),[n,i,r,s,a,o,c,l,u,h]=Eo(ap(U=>[U.zsswords.cli,U.zsswords.loader,U.zsswords.runtime,U.zsswords.flags,U.zsswords.stats,U.zsswords.kinds,U.zsswords.altkinds,U.zsswords.colors,U.zsswords.dirs,U.zsswords.dirmods]));Be.useEffect(()=>{n.filter(ij).forEach(U=>Qm(U,Id)),i.filter(ij).forEach(U=>Qm(U,Id)),r.filter(ij).forEach(U=>Qm(U,Id)),s.forEach(U=>Qm(U,A0t)),a.forEach(U=>Qm(U,M0t)),o.forEach(U=>Qm(U,O0t)),c.forEach(U=>Qm(U,N0t)),l.forEach(U=>Qm(U,I0t)),u.forEach(U=>Qm(U,k0t)),h.forEach(U=>Qm(U,D0t)),is("a",uS),is("b",uS),is("c",uS),is("d",uS),is("e",uS),is("f",uS),is("g",uS),is("x",L0t),is("#",$ie),is("!",$ie),is("y",hS),is("t",hS),is("s",hS),is("i",hS),is("q",hS),is("h",hS),is("w",hS),is("3",Gie),is(".",Gie),is("+",qie),is("-",qie),is("0",eg),is("1",eg),is("2",eg),is("p",eg),is("4",eg),is("5",eg),is("6",eg),is("7",eg),is("8",eg),is("9",eg),is(";",Tc)},[n,i,r,s,a,o,c,l,u,h]);const d=dm(),f=ho(),p=ipe(Oue(e.book,e.path)),g=hm(d);Be.useEffect(()=>(ePe(Ge,t,e.book,e.path),()=>{tPe(Ge,t,e.book,e.path)}),[e.book,e.path,t]);const _=ae(p)?p.toJSON():"",v=E0t(_),E=T0t(f.cursor,v),T=f.cursor-v[E].start,x=S0t(v),N=Npe(_);if(ae(N.tokens)){let U=!0;for(let $=0;$<N.tokens.length;++$){const q=N.tokens[$];q.tokenTypeIdx===PN.tokenTypeIdx&&(q.payload=U,U=!1);const G=v[(q.startLine??1)-1];ae(G)&&(G.tokens=G.tokens??[],G.tokens.push(q))}}if(ae(N.errors))for(let U=0;U<N.errors.length;++U){const $=N.errors[U],q=v[($.line??1)-1];ae(q)&&(q.errors=q.errors??[],q.errors.push($))}const A={rows:v,xcursor:T,ycursor:E,codepage:p,xoffset:f.xscroll,yoffset:f.yscroll},I=32,k=(Math.round(x/I)+1)*I,L=v.length;return Be.useEffect(()=>{let U=f.xscroll;const $=T-U,q=g.width-3;let G=Math.round(Er(Math.abs($)*.5,1,I));G<8&&(G=1),$>q-8&&(U+=G),$<8&&(U-=G);let X=f.yscroll;const ie=E-X,V=g.height-4,Z=Math.round(V*.5);let Y=Math.round(Er(Math.abs(ie)*.25,1,Z));Y<8&&(Y=1),ie>V-4&&(X+=Y),ie<4&&(X-=Y),setTimeout(()=>ho.setState({xscroll:Math.round(Er(U,0,k)),yscroll:Math.round(Er(X,0,L))}),16)},[T,k,f.xscroll,E,L,f.yscroll,g.width,g.height]),Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(FY,{bump:!0,context:d}),Ae.jsx(U0t,{}),Ae.jsx(q0t,{...A}),Ae.jsx(G0t,{...A})]})}function $0t({tapeycursor:t,logrowtotalheight:e}){const n=Kd(),i=dm(),{quickterminal:r}=Us(),s=nc(),a=nr(),o=hm(i),c=s.buffer[s.bufferindex];let l=s.xcursor,u=s.xcursor,h=!1;ae(s.xselect)&&ae(s.yselect)&&(h=!0,l=Math.min(s.xcursor,s.xselect),u=Math.max(s.xcursor,s.xselect),s.xcursor!==s.xselect&&--u);const d=u-l+1,f=s.ycursor===0,p=h?c.substring(l,u+1):c;function g(k,L,U){s.bufferindex>0&&nc.setState({bufferindex:0}),s.buffer[0]=q5e(c,k,L,U),nc.setState({buffer:s.buffer,xselect:void 0,xcursor:k+(U??"").length})}function _(k){const L=s.buffer.length-1,U=Er(k,0,L);nc.setState({bufferindex:U,xcursor:s.buffer[U].length,ycursor:0,xselect:void 0,yselect:void 0})}function v(k){k?ae(s.xselect)||nc.setState({xselect:s.xcursor,yselect:s.ycursor}):nc.setState({xselect:void 0,yselect:void 0})}function E(){ae(s.xselect)&&(nc.setState({xcursor:l,xselect:void 0,yselect:void 0}),g(l,d))}function T(){nc.setState({xcursor:c.length,ycursor:0,xselect:void 0,yselect:void 0})}if(i.reset.bg=lR(r),!r){ZS(!1,!1,0,0,i);const k="main:0.47.0 - if lost try #help";i.x=o.right-k.length,ri(`$dkcyan${k}`,i,!0)}const x="$196",A="$205".repeat(o.width-6);ZS(!1,!1,0,o.height-2,i),i.active.color=Qt.WHITE,ri(`  ${x}${A}${x}  `,i,!0);const I=c.padEnd(o.width," ");if(ZS(!1,!1,0,o.height-1,i),i.active.color=Qt.WHITE,Fpe(I,i,!0),ae(s.xselect)&&ae(s.yselect)&&s.xcursor!==s.xselect){const k=Math.min(s.xcursor,s.xselect),L=Math.min(s.ycursor,s.yselect),U=Math.max(s.xcursor,s.xselect)-1,$=Math.max(s.ycursor,s.yselect);for(let q=L;q<=$;++q){const G=k+(o.bottom-q)*o.width,X=U+(o.bottom-q)*o.width;pO(G,X,15,8,i)}}if(n){const k=o.left+s.xcursor,L=o.top+t,U=k+L*i.width;AB(U,"",i),pO(U,U,15,i.reset.bg,i)}return Be.useEffect(()=>{let k=s.scroll;t<4&&k++,t>o.bottom-4&&k--,nc.setState({scroll:Math.round(Er(k,0,e))})},[s.scroll,t,e,o.bottom]),Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(f_e,{blocking:!0,x:o.left,y:o.top,width:o.width,height:o.height,onScroll:k=>{v(!1),nc.setState({ycursor:Er(Math.round(s.ycursor-k),0,e)})}}),Ae.jsx(uc,{keydown:k=>{const{key:L}=k,U=ai(L),$=W6(k);switch(U){case"arrowleft":v($.shift),$.ctrl?nc.setState({xcursor:0}):nc.setState({xcursor:Er(s.xcursor-($.alt?10:1),0,o.right)});break;case"arrowright":v($.shift),$.ctrl?nc.setState({xcursor:f?c.length:o.right}):nc.setState({xcursor:Er(s.xcursor+($.alt?10:1),0,o.right)});break;case"arrowup":$.ctrl?_(s.bufferindex+1):(v($.shift),nc.setState({ycursor:Er(Math.round(s.ycursor+($.alt?10:1)),0,e)}));break;case"arrowdown":$.ctrl?_(s.bufferindex-1):(v($.shift),nc.setState({ycursor:Er(Math.round(s.ycursor-($.alt?10:1)),0,e)}));break;case"enter":{const q=h?p:c;q.length&&(f?(nc.setState({xcursor:0,bufferindex:0,xselect:void 0,yselect:void 0,buffer:["",q,...s.buffer.slice(1).filter(G=>G!==q)]}),Lv(Ge,a,q),r&&m2(Ge,a)):T());break}case"esc":case"escape":m2(Ge,a);break;case"tab":Mue(Ge,a,!$.shift);break;case"delete":f?h?E():c.length>0&&g(s.xcursor,1):T();break;case"backspace":f?h?E():s.xcursor>0&&g(s.xcursor-1,1):T();break;default:if($.ctrl)switch(U){case"e":Lv(Ge,a,"#export");break;case"a":nc.setState({xselect:0,yselect:0,xcursor:c.length,ycursor:0});break;case"c":f&&ae(Ia())?Ia().writeText(p).catch(q=>console.error(q)):T();break;case"v":f&&ae(Ia())?Ia().readText().then(q=>{try{const X=JSON.parse(q);if(On(X.exported)&&ae(X.data)){wg(Ge,a,void 0,"json",`file:${X.exported}`,JSON.stringify(X));return}}catch(X){console.error(X)}const G=q.replaceAll("\r","");h?g(l,d,G):g(s.xcursor,0,G)}).catch(q=>console.error(q)):T();break;case"x":f&&ae(Ia())?Ia().writeText(p).then(()=>E()).catch(q=>console.error(q)):T();break}else $.alt||L.length===1&&(f&&s.xcursor<=c.length?h?(g(l,d,L),nc.setState({xselect:void 0})):g(s.xcursor,0,L):T());break}}})]})}function W0t({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=dm(),o=Be.useCallback(()=>{setTimeout(()=>{if(ae(Ia())){const[,...l]=r,u=l.join(" ");Ia().writeText(u).then(()=>$a(Ge,nr(),"copied!")).catch(h=>console.error(h))}},100)},[r]),c=fp(!!e);return ZS(!!t,!!e,0,s,a),ri(`${n} $purple$16 $yellowCOPYIT ${c}${i}`,a,!0),e&&Ae.jsx(uc,{OK_BUTTON:o})}function Y0t({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=dm(),o=Be.useContext(c_e),c=Be.useCallback(()=>{const[u,...h]=r;setTimeout(()=>{o.sendmessage(u,h)},100)},[r,o]),l=fp(!!e);return ZS(!!t,!!e,0,s,a),ri(`${n} $purple$16 ${l}${i}`,a,!0),e&&Ae.jsx(uc,{OK_BUTTON:c})}function X0t({blink:t,active:e,prefix:n,label:i,words:r,y:s}){const a=dm(),o=Be.useCallback(()=>{const[,...l]=r,u=l.join(" ");setTimeout(()=>{window.open(u,"_blank")},100)},[r]),c=fp(!!e);return ZS(!!t,!!e,0,s,a),ri(`${n} $purple$16 $yellowOPENIT ${c}${i}`,a,!0),e&&Ae.jsx(uc,{OK_BUTTON:o})}function p_e({blink:t,active:e,text:n,y:i}){const r=dm(),{quickterminal:s}=Us(),a=hm(r),o=n.startsWith("!");if(ZS(!!t,!!e,0,i,r),r.reset.bg=e?BY:lR(s),r.active.bottomedge=a.bottom,ri(o?"":n,r,!0),o){const[c,...l]=n.slice(1).split("!"),u=`${l.join("!")}`;let h="PRESS ME";const d=[],f=CB(u,!0);for(let v=0;v<f.tokens.length;v++){const E=f.tokens[v];switch(E.tokenType){case n9:h=E.image.slice(1);break;default:d.push(E.image);break}}const[p,...g]=d,_={blink:t,active:e,prefix:c,label:h,words:g,y:i};switch(ai(p)){case"copyit":return Ae.jsx(W0t,{..._,words:d});case"openit":return Ae.jsx(X0t,{..._,words:d});default:case"hyperlink":return Ae.jsx(Y0t,{..._,words:d});case"hk":case"hotkey":return null;case"rn":case"range":return null;case"sl":case"select":return null;case"nm":case"number":return null;case"tx":case"text":return null;case"zssedit":return null;case"charedit":return null;case"coloredit":return null}}return null}function K0t(t){const e=Kd();return Ae.jsx(p_e,{active:!0,blink:e,...t})}function sj(){const t=nr(),[e]=Us(ap(f=>[f.editor.open])),n=Us(ap(f=>f.terminal.logs)),i=dm(),r=nc(),s=hm(i),a=n.map(f=>{const[,p,g,..._]=f;let v="$white";switch(p){case"debug":v="$yellow";break;case"error":v="$red";break}const E=_.map(N=>`${N}`).join(" "),T=E.startsWith("!"),x=`$onclear${v}${g}$white$180$blue`;return`${T?"!":""}${x}${E}`}),o=a.map(f=>{if(f.startsWith("!"))return 1;const p=$N(f,s.width,s.height);return(p==null?void 0:p.y)??1}),c=s.bottom-s.top-(e?0:2);let l=0,u=c+1;const h=o.map(f=>(u-=f,l+=f,u));++l;const d=s.bottom-r.ycursor+r.scroll;return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(FY,{context:i}),Ae.jsxs(c_e.Provider,{value:{sendmessage(f,p){const[g,_]=jW(f);if(g==="self"){const v=`#${_} ${p.join(" ")}`;Lv(Ge,t,v)}else Ge.emit(t,`${g}:${_}`,p)}},children:[a.map((f,p)=>{const g=h[p]+r.scroll,_=o[p],v=g+_;return v<0||g>c?null:!e&&d>=g&&d<v?Ae.jsx(K0t,{text:f,y:g},p):Ae.jsx(p_e,{text:f,y:g},p)}),!e&&Ae.jsx($0t,{tapeycursor:d,logrowtotalheight:l})]})]})}function Xie(t,e,n,i,r){return{...r,x:t,y:e,reset:{...ol(r.reset),topedge:e,leftedge:t,rightedge:n,bottomedge:i},active:{...ol(r.active),topedge:e,leftedge:t,rightedge:n,bottomedge:i}}}function J0t({context:t}){const[e,n]=Us(ap(h=>[h.layout,h.editor.open])),i=0,r=0,s=t.width-1,a=t.height-1,o=hm(t),c=Math.floor(o.height*.5),l=Be.useMemo(()=>Xie(r,i,s,c-1,t),[c,s,t]),u=Be.useMemo(()=>Xie(r,c,s,a,t),[c,s,a,t]);if(n)switch(e){case kd.SPLIT_Y:return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(A_.Provider,{value:l,children:Ae.jsx(sj,{})}),Ae.jsx(A_.Provider,{value:u,children:Ae.jsx(rj,{})})]});case kd.SPLIT_Y_ALT:return Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(A_.Provider,{value:l,children:Ae.jsx(rj,{})}),Ae.jsx(A_.Provider,{value:u,children:Ae.jsx(sj,{})})]});default:return Ae.jsx(A_.Provider,{value:t,children:Ae.jsx(rj,{})})}return Ae.jsx(A_.Provider,{value:t,children:Ae.jsx(sj,{})},"single")}function Z0t(){const t=Y6();let e=0,n=t.rows-2;const[i,r,s,a]=Us(ap(d=>[d.layout,d.quickterminal,d.terminal.open,d.editor.open]));switch(i){case kd.TOP:n=Math.floor(t.rows*.5);break;case kd.BOTTOM:n=Math.ceil(t.rows*.5),e=t.rows-n;break;default:case kd.FULL:break}const o=lR(r),c=WN(t.cols,n,0,FO,o),l={...Zb(t.cols,n,FO,o),...c.getState()};if(t.cols<10||t.rows<10)return null;const u=nr(),h=r||s||a;return Ae.jsxs(RI,{store:c,children:[h&&Ae.jsx(UO,{width:t.cols,height:t.rows,top:e,left:0,right:t.cols-1,bottom:e+n-1}),h?Ae.jsxs(ax,{blockhotkeys:!0,children:[Ae.jsx(FY,{context:l}),Ae.jsx(J0t,{context:l}),Ae.jsx("group",{position:[0,e*kn.DRAW_CHAR_HEIGHT(),0],children:Ae.jsx(AI,{width:t.cols,height:n})})]}):Ae.jsx(Aw,{hotkey:"Shift+?",children:()=>UDe(Ge,u)})]})}function Q0t({context:t}){return Ae.jsx("group",{position:[0,0,999],children:Ae.jsx(AI,{width:t.width,height:t.height})})}function evt(){const{toast:t}=Us(),e=Y6(),n=WN(e.cols,1,0,Qt.GREEN,Qt.ONCLEAR),i={...Zb(e.cols,1,Qt.GREEN,Qt.ONCLEAR,0,0,e.cols-1,1),...n.getState()};if(e.cols<10||e.rows<10)return null;const r=e.cols-1;return Ae.jsx(RI,{store:n,children:t&&Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(UY,{margin:1,color:Qt.YELLOW,y:0,leftedge:0,rightedge:r,line:t,context:i}),Ae.jsx("group",{position:[0,0,998],children:Ae.jsx(UO,{alpha:.4,width:e.cols,height:10,top:0,left:0,right:r,bottom:0})}),Ae.jsx(Q0t,{context:i})]})})}const Kie=qb("gadgetclient",[],t=>{if(!Kie.session(t)||t.player!==nr())return;const{desync:e}=Eo.getState();switch(t.target){case"paint":Eo.setState({desync:!1,gadget:t.data});break;case"patch":e||Eo.setState(n=>{let i;try{i=e7(t.data,n.gadget)}catch(s){i=s}if(ae(i))return Kie.replynext(t,"desync"),{...n,desync:!0};const r=V3(n.gadget,t.data,!0,!1);return{...n,gadget:r.newDocument}});break}}),zY=Object.prototype.toString.call(typeof zn<"u"?zn:0)==="[object process]";var p_,pi;(function(t){t[t.CRITICAL=0]="CRITICAL",t[t.ERROR=1]="ERROR",t[t.WARNING=2]="WARNING",t[t.INFO=3]="INFO",t[t.DEBUG=4]="DEBUG",t[t.TRACE=7]="TRACE"})(pi||(pi={}));function HY(t){if(typeof t=="number"){if(Object.prototype.hasOwnProperty.call(pi,t))return t;var e=Object.keys(pi).map(function(i){return parseInt(i,10)}).filter(function(i){return!isNaN(i)&&i<t});return e.length?Math.max.apply(Math,e):pi.WARNING}var n=t.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(pi,n))throw new Error("Unknown log level string: ".concat(t));return pi[n]}var tvt=zY?console.log.bind(console):console.debug.bind(console),m_e=(p_={},p_[pi.CRITICAL]=console.error.bind(console),p_[pi.ERROR]=console.error.bind(console),p_[pi.WARNING]=console.warn.bind(console),p_[pi.INFO]=console.info.bind(console),p_[pi.DEBUG]=tvt.bind(console),p_[pi.TRACE]=console.trace.bind(console),p_);function rE(t){return function(e,n){Object.defineProperty(e,n,{get:function(){},set:function(i){Object.defineProperty(this,n,{value:i,writable:!0,enumerable:t})},enumerable:t})}}function jG(t){return Ja(this,void 0,Promise,function(){return q9(this,function(e){switch(e.label){case 0:return typeof t!="function"?[3,2]:[4,t()];case 1:return[2,e.sent()];case 2:return[2,t]}})})}function nvt(t){return typeof t=="function"?t():t}function g_e(t){var e,n,i;return q9(this,function(r){switch(r.label){case 0:e=0,n=1,r.label=1;case 1:return e<t?[4,e]:[3,3];case 2:return r.sent(),i=w6([n,e+n],2),e=i[0],n=i[1],[3,1];case 3:return[4,t];case 4:return r.sent(),[3,3];case 5:return[2]}})}function OD(t,e){return Object.assign.apply(Object,yG([{}],w6(t.map(e)),!1))}function VG(t,e){Object.entries(t).forEach(function(n){var i=w6(n,2),r=i[0],s=i[1];return e(s,r)})}function v_e(t){return t==null}function zO(t,e){return v_e(t)?null:e(t)}function y_e(t,e){return v_e(t)?void 0:e(t)}function ivt(t){return Ja(this,void 0,Promise,function(){return q9(this,function(e){switch(e.label){case 0:return[4,new Promise(function(n){return setTimeout(n,t)})];case 1:return e.sent(),[2]}})})}function GG(){var t,e,n=new Promise(function(i,r){t=i,e=r});return{promise:n,resolve:t,reject:e}}function rvt(t,e,n){if(typeof t=="number"&&(t=t.toString()),e=e-t.length,e<=0)return t;n===void 0&&(n=" ");var i="";do(e&1)===1&&(i+=n),e>>=1,e&&(n+=n);while(e);return i+t}function QS(t,e,n){var i=t.split(e);return i.length<=n?i:yG(yG([],w6(i.slice(0,n-1)),!1),[i.slice(n-1).join(e)],!1)}var svt={},aj,oj,PU=typeof zn>"u"?[]:(oj=(aj=svt.LOGGING)===null||aj===void 0?void 0:aj.split(";").map(function(t){var e=t.split("=",2),n=e[0],i=e[1];return i?[n==="default"?void 0:n.split(":"),HY(i)]:null}).filter(function(t){return!!t}).sort(function(t,e){var n,i,r=t[0],s=e[0];return((n=s==null?void 0:s.length)!==null&&n!==void 0?n:0)-((i=r==null?void 0:r.length)!==null&&i!==void 0?i:0)}))!==null&&oj!==void 0?oj:[],cj=PU.findIndex(function(t){var e=t[0];return!e}),__e=void 0;cj!==-1&&(__e=PU[cj][1],PU.splice(cj));function avt(t,e){return e.length<=t.length&&e.every(function(n,i){return n===t[i]})}function b_e(t){for(var e=t.split(":"),n=0,i=PU;n<i.length;n++){var r=i[n],s=r[0],a=r[1];if(avt(e,s))return a}return __e}var E_e=function(){function t(e){var n=e.name,i=e.minLevel,r=e.emoji,s=r===void 0?!1:r,a=e.colors,o=e.timestamps,c=o===void 0?zY:o,l,u;this._name=n,this._minLevel=(u=(l=y_e(i,function(h){return HY(h)}))!==null&&l!==void 0?l:b_e(n))!==null&&u!==void 0?u:pi.WARNING,this._emoji=s,this._colors=a,this._timestamps=c}return t.prototype.crit=function(e){this.log(pi.CRITICAL,e)},t.prototype.error=function(e){this.log(pi.ERROR,e)},t.prototype.warn=function(e){this.log(pi.WARNING,e)},t.prototype.info=function(e){this.log(pi.INFO,e)},t.prototype.debug=function(e){this.log(pi.DEBUG,e)},t.prototype.trace=function(e){this.log(pi.TRACE,e)},t}(),ovt=function(t){ive(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){if(!(n>this._minLevel)){var r=m_e[n],s="[".concat(this._name,"] ").concat(i);this._timestamps&&(s="[".concat(new Date().toISOString(),"] ").concat(i)),r(s)}},e}(E_e),cvt=function(){function t(e){var n=e.name,i=e.minLevel,r=e.custom,s;this._minLevel=(s=y_e(i,function(a){return HY(a)}))!==null&&s!==void 0?s:b_e(n),this._override=typeof r=="function"?{log:r}:r}return t.prototype.log=function(e,n){this._shouldLog(e)&&this._override.log(e,n)},t.prototype.crit=function(e){this._override.crit?this._shouldLog(pi.CRITICAL)&&this._override.crit(e):this.log(pi.CRITICAL,e)},t.prototype.error=function(e){this._override.error?this._shouldLog(pi.ERROR)&&this._override.error(e):this.log(pi.ERROR,e)},t.prototype.warn=function(e){this._override.warn?this._shouldLog(pi.WARNING)&&this._override.warn(e):this.log(pi.WARNING,e)},t.prototype.info=function(e){this._override.info?this._shouldLog(pi.INFO)&&this._override.info(e):this.log(pi.INFO,e)},t.prototype.debug=function(e){this._override.debug?this._shouldLog(pi.DEBUG)&&this._override.debug(e):this.log(pi.DEBUG,e)},t.prototype.trace=function(e){this._override.trace?this._shouldLog(pi.TRACE)&&this._override.trace(e):this.log(pi.TRACE,e)},t.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},t}(),m_,g_,v_,lvt=(m_={},m_[pi.CRITICAL]="",m_[pi.ERROR]="",m_[pi.WARNING]=" ",m_[pi.INFO]=" ",m_[pi.DEBUG]="",m_[pi.TRACE]="",m_),uvt={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},hvt={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function X6(t,e,n){return function(i){return"\x1B[".concat(t,"m").concat(n?n(i):i,"\x1B[").concat(e,"m")}}function mg(t){return X6(uvt[t],39)}function cA(t,e){return X6(hvt[t],49,e)}var dvt=(g_={},g_[pi.CRITICAL]=mg("red"),g_[pi.ERROR]=mg("redBright"),g_[pi.WARNING]=mg("yellow"),g_[pi.INFO]=mg("blue"),g_[pi.DEBUG]=mg("magenta"),g_[pi.TRACE]=X6(0,0),g_),Jie=(v_={},v_[pi.CRITICAL]=cA("bgRed",mg("white")),v_[pi.ERROR]=cA("bgRedBright",mg("white")),v_[pi.WARNING]=cA("bgYellow",mg("black")),v_[pi.INFO]=cA("bgBlue",mg("white")),v_[pi.DEBUG]=cA("bgMagenta",mg("black")),v_[pi.TRACE]=X6(7,27),v_),fvt=function(t){ive(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.log=function(n,i){var r,s,a;if(!(n>this._minLevel)){var o=m_e[n],c="";if(this._timestamps&&(c+="[".concat(new Date().toISOString(),"] ")),this._emoji){var l=lvt[n];c+="".concat(l," ")}var u=(a=(r=this._colors)!==null&&r!==void 0?r:(s=zn.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&a!==void 0?a:!0;u?c+="".concat(Jie[n](this._name)," ").concat(Jie[n](pi[n])," ").concat(dvt[n](i)):c+="[".concat(this._name,":").concat(pi[n].toLowerCase(),"] ").concat(i),o(c)}},e}(E_e);function K6(t){return t.custom?new cvt(t):zY?new fvt(t):new ovt(t)}let pvt=class extends Error{constructor(...e){var n;super(...e),Object.setPrototypeOf(this,new.target.prototype),(n=Error.captureStackTrace)===null||n===void 0||n.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}};class S_e extends pvt{}class mvt{constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r,getPartitionKey:s}){this._partitionedQueue=new Map,this._usedFromBucket=new Map,this._paused=!1,this._logger=K6({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r,this._partitionKeyCallback=s}async request(e,n){return await new Promise((i,r)=>{var s,a;const o={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"},c=this._partitionKeyCallback(e),l=(a=this._usedFromBucket.get(c))!==null&&a!==void 0?a:0;if(l>=this._bucketSize||this._paused)switch(o.limitReachedBehavior){case"enqueue":{const u=this._getPartitionedQueue(c);u.push(o),l+u.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${u.length}`):this._logger.info(`Enqueueing request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused; queue size is ${u.length}`);break}case"null":{o.resolve(null),this._paused?this._logger.info(`Returning null for request for ${c?`partition ${c}`:"default partition"} because the rate limiter is paused`):this._logger.warn(`Rate limit of ${this._bucketSize} for ${c?`partition ${c}`:"default partition"} was reached, dropping request and returning null`);break}case"throw":{o.reject(new S_e(`Request dropped because ${this._paused?"the rate limiter is paused":`the rate limit for ${c?`partition ${c}`:"default partition"} was reached`}`));break}default:throw new Error("this should never happen")}else this._runRequest(o,c)})}clear(){this._partitionedQueue.clear()}pause(){this._paused=!0}resume(){this._paused=!1;for(const e of this._partitionedQueue.keys())this._runNextRequest(e)}_getPartitionedQueue(e){if(this._partitionedQueue.has(e))return this._partitionedQueue.get(e);const n=[];return this._partitionedQueue.set(e,n),n}async _runRequest(e,n){var i;const r=this._getPartitionedQueue(n);this._logger.debug(`doing a request for ${n?`partition ${n}`:"default partition"}, new queue length is ${r.length}`),this._usedFromBucket.set(n,((i=this._usedFromBucket.get(n))!==null&&i!==void 0?i:0)+1);const{req:s,resolve:a,reject:o}=e;try{a(await this._callback(s))}catch(c){o(c)}finally{setTimeout(()=>{const c=this._usedFromBucket.get(n)-1;this._usedFromBucket.set(n,c),r.length&&c<this._bucketSize&&this._runNextRequest(n)},this._timeFrame)}}_runNextRequest(e){if(this._paused)return;const i=this._getPartitionedQueue(e).shift();i&&this._runRequest(i,e)}}class qG{constructor({logger:e,bucketSize:n,timeFrame:i,doRequest:r}){this._queue=[],this._usedFromBucket=0,this._paused=!1,this._logger=K6({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=n,this._timeFrame=i,this._callback=r}async request(e,n){return await new Promise((i,r)=>{var s;const a={req:e,resolve:i,reject:r,limitReachedBehavior:(s=n==null?void 0:n.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"};if(this._usedFromBucket>=this._bucketSize||this._paused)switch(a.limitReachedBehavior){case"enqueue":{this._queue.push(a),this._usedFromBucket+this._queue.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${this._queue.length}`):this._logger.info(`Enqueueing request because the rate limiter is paused; queue size is ${this._queue.length}`);break}case"null":{a.resolve(null),this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`),this._paused?this._logger.info("Returning null for request because the rate limiter is paused"):this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`);break}case"throw":{a.reject(new S_e(`Request dropped because ${this._paused?"the rate limiter is paused":"the rate limit was reached"}`));break}default:throw new Error("this should never happen")}else this._runRequest(a)})}clear(){this._queue=[]}pause(){this._paused=!0}resume(){this._paused=!1,this._runNextRequest()}async _runRequest(e){this._logger.debug(`doing a request, new queue length is ${this._queue.length}`),this._usedFromBucket+=1;const{req:n,resolve:i,reject:r}=e;try{i(await this._callback(n))}catch(s){r(s)}finally{setTimeout(()=>{this._usedFromBucket-=1,this._queue.length&&this._usedFromBucket<this._bucketSize&&this._runNextRequest()},this._timeFrame)}}_runNextRequest(){if(this._paused)return;const e=this._queue.shift();e&&this._runRequest(e)}}class gvt extends qG{constructor(e,n){super({...n,async doRequest(i,r){return await e.request(i,r)}})}}class vvt{constructor(e,n,i,r=!1){this.owner=e,this.event=n,this.listener=i,this._internal=r}unbind(){this.owner.removeListener(this)}}let MI=class{constructor(){this._eventListeners=new Map,this._internalEventListeners=new Map}on(e,n){return this._addListener(!1,e,n)}addListener(e,n){return this._addListener(!1,e,n)}removeListener(e,n){this._removeListener(!1,e,n)}registerEvent(){const e=n=>this.addListener(e,n);return e}emit(e,...n){if(this._eventListeners.has(e))for(const i of this._eventListeners.get(e))i(...n);if(this._internalEventListeners.has(e))for(const i of this._internalEventListeners.get(e))i(...n)}registerInternalEvent(){const e=n=>this.addInternalListener(e,n);return e}addInternalListener(e,n){return this._addListener(!0,e,n)}removeInternalListener(e,n){this._removeListener(!0,e,n)}_addListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;return r.has(n)?r.get(n).push(i):r.set(n,[i]),new vvt(this,n,i,e)}_removeListener(e,n,i){const r=e?this._eventListeners:this._internalEventListeners;if(!n)r.clear();else if(typeof n=="object"){const s=n;this._removeListener(s._internal,s.event,s.listener)}else{const s=n;if(r.has(s))if(i){const a=r.get(s);let o=0;for(;(o=a.indexOf(i))!==-1;)a.splice(o,1)}else r.delete(s)}}};const yvt=6e4;function _vt(t){return zO(t.expiresIn,e=>t.obtainmentTimestamp+e*1e3-yvt)}function LP(t){var e;return(e=zO(_vt(t),n=>Date.now()>n))!==null&&e!==void 0?e:!1}var $G={exports:{}};(function(t,e){var n=typeof self<"u"?self:Ll,i=function(){function s(){this.fetch=!1,this.DOMException=n.DOMException}return s.prototype=n,new s}();(function(s){(function(a){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function c(X){return X&&DataView.prototype.isPrototypeOf(X)}if(o.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(X){return X&&l.indexOf(Object.prototype.toString.call(X))>-1};function h(X){if(typeof X!="string"&&(X=String(X)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(X))throw new TypeError("Invalid character in header field name");return X.toLowerCase()}function d(X){return typeof X!="string"&&(X=String(X)),X}function f(X){var ie={next:function(){var V=X.shift();return{done:V===void 0,value:V}}};return o.iterable&&(ie[Symbol.iterator]=function(){return ie}),ie}function p(X){this.map={},X instanceof p?X.forEach(function(ie,V){this.append(V,ie)},this):Array.isArray(X)?X.forEach(function(ie){this.append(ie[0],ie[1])},this):X&&Object.getOwnPropertyNames(X).forEach(function(ie){this.append(ie,X[ie])},this)}p.prototype.append=function(X,ie){X=h(X),ie=d(ie);var V=this.map[X];this.map[X]=V?V+", "+ie:ie},p.prototype.delete=function(X){delete this.map[h(X)]},p.prototype.get=function(X){return X=h(X),this.has(X)?this.map[X]:null},p.prototype.has=function(X){return this.map.hasOwnProperty(h(X))},p.prototype.set=function(X,ie){this.map[h(X)]=d(ie)},p.prototype.forEach=function(X,ie){for(var V in this.map)this.map.hasOwnProperty(V)&&X.call(ie,this.map[V],V,this)},p.prototype.keys=function(){var X=[];return this.forEach(function(ie,V){X.push(V)}),f(X)},p.prototype.values=function(){var X=[];return this.forEach(function(ie){X.push(ie)}),f(X)},p.prototype.entries=function(){var X=[];return this.forEach(function(ie,V){X.push([V,ie])}),f(X)},o.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function g(X){if(X.bodyUsed)return Promise.reject(new TypeError("Already read"));X.bodyUsed=!0}function _(X){return new Promise(function(ie,V){X.onload=function(){ie(X.result)},X.onerror=function(){V(X.error)}})}function v(X){var ie=new FileReader,V=_(ie);return ie.readAsArrayBuffer(X),V}function E(X){var ie=new FileReader,V=_(ie);return ie.readAsText(X),V}function T(X){for(var ie=new Uint8Array(X),V=new Array(ie.length),Z=0;Z<ie.length;Z++)V[Z]=String.fromCharCode(ie[Z]);return V.join("")}function x(X){if(X.slice)return X.slice(0);var ie=new Uint8Array(X.byteLength);return ie.set(new Uint8Array(X)),ie.buffer}function N(){return this.bodyUsed=!1,this._initBody=function(X){this._bodyInit=X,X?typeof X=="string"?this._bodyText=X:o.blob&&Blob.prototype.isPrototypeOf(X)?this._bodyBlob=X:o.formData&&FormData.prototype.isPrototypeOf(X)?this._bodyFormData=X:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(X)?this._bodyText=X.toString():o.arrayBuffer&&o.blob&&c(X)?(this._bodyArrayBuffer=x(X.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(X)||u(X))?this._bodyArrayBuffer=x(X):this._bodyText=X=Object.prototype.toString.call(X):this._bodyText="",this.headers.get("content-type")||(typeof X=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(X)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var X=g(this);if(X)return X;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var X=g(this);if(X)return X;if(this._bodyBlob)return E(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(T(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(L)}),this.json=function(){return this.text().then(JSON.parse)},this}var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(X){var ie=X.toUpperCase();return A.indexOf(ie)>-1?ie:X}function k(X,ie){ie=ie||{};var V=ie.body;if(X instanceof k){if(X.bodyUsed)throw new TypeError("Already read");this.url=X.url,this.credentials=X.credentials,ie.headers||(this.headers=new p(X.headers)),this.method=X.method,this.mode=X.mode,this.signal=X.signal,!V&&X._bodyInit!=null&&(V=X._bodyInit,X.bodyUsed=!0)}else this.url=String(X);if(this.credentials=ie.credentials||this.credentials||"same-origin",(ie.headers||!this.headers)&&(this.headers=new p(ie.headers)),this.method=I(ie.method||this.method||"GET"),this.mode=ie.mode||this.mode||null,this.signal=ie.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&V)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(V)}k.prototype.clone=function(){return new k(this,{body:this._bodyInit})};function L(X){var ie=new FormData;return X.trim().split("&").forEach(function(V){if(V){var Z=V.split("="),Y=Z.shift().replace(/\+/g," "),ee=Z.join("=").replace(/\+/g," ");ie.append(decodeURIComponent(Y),decodeURIComponent(ee))}}),ie}function U(X){var ie=new p,V=X.replace(/\r?\n[\t ]+/g," ");return V.split(/\r?\n/).forEach(function(Z){var Y=Z.split(":"),ee=Y.shift().trim();if(ee){var oe=Y.join(":").trim();ie.append(ee,oe)}}),ie}N.call(k.prototype);function $(X,ie){ie||(ie={}),this.type="default",this.status=ie.status===void 0?200:ie.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in ie?ie.statusText:"OK",this.headers=new p(ie.headers),this.url=ie.url||"",this._initBody(X)}N.call($.prototype),$.prototype.clone=function(){return new $(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},$.error=function(){var X=new $(null,{status:0,statusText:""});return X.type="error",X};var q=[301,302,303,307,308];$.redirect=function(X,ie){if(q.indexOf(ie)===-1)throw new RangeError("Invalid status code");return new $(null,{status:ie,headers:{location:X}})},a.DOMException=s.DOMException;try{new a.DOMException}catch{a.DOMException=function(ie,V){this.message=ie,this.name=V;var Z=Error(ie);this.stack=Z.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function G(X,ie){return new Promise(function(V,Z){var Y=new k(X,ie);if(Y.signal&&Y.signal.aborted)return Z(new a.DOMException("Aborted","AbortError"));var ee=new XMLHttpRequest;function oe(){ee.abort()}ee.onload=function(){var de={status:ee.status,statusText:ee.statusText,headers:U(ee.getAllResponseHeaders()||"")};de.url="responseURL"in ee?ee.responseURL:de.headers.get("X-Request-URL");var Me="response"in ee?ee.response:ee.responseText;V(new $(Me,de))},ee.onerror=function(){Z(new TypeError("Network request failed"))},ee.ontimeout=function(){Z(new TypeError("Network request failed"))},ee.onabort=function(){Z(new a.DOMException("Aborted","AbortError"))},ee.open(Y.method,Y.url,!0),Y.credentials==="include"?ee.withCredentials=!0:Y.credentials==="omit"&&(ee.withCredentials=!1),"responseType"in ee&&o.blob&&(ee.responseType="blob"),Y.headers.forEach(function(de,Me){ee.setRequestHeader(Me,de)}),Y.signal&&(Y.signal.addEventListener("abort",oe),ee.onreadystatechange=function(){ee.readyState===4&&Y.signal.removeEventListener("abort",oe)}),ee.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return G.polyfill=!0,s.fetch||(s.fetch=G,s.Headers=p,s.Request=k,s.Response=$),a.Headers=p,a.Request=k,a.Response=$,a.fetch=G,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(i),i.fetch.ponyfill=!0,delete i.fetch.polyfill;var r=i;e=r.fetch,e.default=r.fetch,e.fetch=r.fetch,e.Headers=r.Headers,e.Request=r.Request,e.Response=r.Response,t.exports=e})($G,$G.exports);var T_e=$G.exports;const bvt=Gc(T_e);var lj=Object.prototype.hasOwnProperty,C1=Array.isArray,tg=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Evt=function(e){for(;e.length>1;){var n=e.pop(),i=n.obj[n.prop];if(C1(i)){for(var r=[],s=0;s<i.length;++s)typeof i[s]<"u"&&r.push(i[s]);n.obj[n.prop]=r}}},x_e=function(e,n){for(var i=n&&n.plainObjects?Object.create(null):{},r=0;r<e.length;++r)typeof e[r]<"u"&&(i[r]=e[r]);return i},Svt=function t(e,n,i){if(!n)return e;if(typeof n!="object"){if(C1(e))e.push(n);else if(e&&typeof e=="object")(i&&(i.plainObjects||i.allowPrototypes)||!lj.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var r=e;return C1(e)&&!C1(n)&&(r=x_e(e,i)),C1(e)&&C1(n)?(n.forEach(function(s,a){if(lj.call(e,a)){var o=e[a];o&&typeof o=="object"&&s&&typeof s=="object"?e[a]=t(o,s,i):e.push(s)}else e[a]=s}),e):Object.keys(n).reduce(function(s,a){var o=n[a];return lj.call(s,a)?s[a]=t(s[a],o,i):s[a]=o,s},r)},Tvt=function(e,n){return Object.keys(n).reduce(function(i,r){return i[r]=n[r],i},e)},xvt=function(t,e,n){var i=t.replace(/\+/g," ");if(n==="iso-8859-1")return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch{return i}},wvt=function(e,n,i){if(e.length===0)return e;var r=e;if(typeof e=="symbol"?r=Symbol.prototype.toString.call(e):typeof e!="string"&&(r=String(e)),i==="iso-8859-1")return escape(r).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var s="",a=0;a<r.length;++a){var o=r.charCodeAt(a);if(o===45||o===46||o===95||o===126||o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122){s+=r.charAt(a);continue}if(o<128){s=s+tg[o];continue}if(o<2048){s=s+(tg[192|o>>6]+tg[128|o&63]);continue}if(o<55296||o>=57344){s=s+(tg[224|o>>12]+tg[128|o>>6&63]+tg[128|o&63]);continue}a+=1,o=65536+((o&1023)<<10|r.charCodeAt(a)&1023),s+=tg[240|o>>18]+tg[128|o>>12&63]+tg[128|o>>6&63]+tg[128|o&63]}return s},Cvt=function(e){for(var n=[{obj:{o:e},prop:"o"}],i=[],r=0;r<n.length;++r)for(var s=n[r],a=s.obj[s.prop],o=Object.keys(a),c=0;c<o.length;++c){var l=o[c],u=a[l];typeof u=="object"&&u!==null&&i.indexOf(u)===-1&&(n.push({obj:a,prop:l}),i.push(u))}return Evt(n),e},Rvt=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},Avt=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},Mvt=function(e,n){return[].concat(e,n)},jY={arrayToObject:x_e,assign:Tvt,combine:Mvt,compact:Cvt,decode:xvt,encode:wvt,isBuffer:Avt,isRegExp:Rvt,merge:Svt},Ovt=String.prototype.replace,Nvt=/%20/g,Ivt=jY,Zie={RFC1738:"RFC1738",RFC3986:"RFC3986"},kvt=Ivt.assign({default:Zie.RFC3986,formatters:{RFC1738:function(t){return Ovt.call(t,Nvt,"+")},RFC3986:function(t){return String(t)}}},Zie),w_e=jY,cM=kvt,Dvt=Object.prototype.hasOwnProperty,Qie={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},Mw=Array.isArray,Pvt=Array.prototype.push,WG=function(t,e){Pvt.apply(t,Mw(e)?e:[e])},Lvt=Date.prototype.toISOString,ere=cM.default,tu={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:w_e.encode,encodeValuesOnly:!1,format:ere,formatter:cM.formatters[ere],indices:!1,serializeDate:function(e){return Lvt.call(e)},skipNulls:!1,strictNullHandling:!1},Uvt=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Bvt=function t(e,n,i,r,s,a,o,c,l,u,h,d,f){var p=e;if(typeof o=="function"?p=o(n,p):p instanceof Date?p=u(p):i==="comma"&&Mw(p)&&(p=p.join(",")),p===null){if(r)return a&&!d?a(n,tu.encoder,f,"key"):n;p=""}if(Uvt(p)||w_e.isBuffer(p)){if(a){var g=d?n:a(n,tu.encoder,f,"key");return[h(g)+"="+h(a(p,tu.encoder,f,"value"))]}return[h(n)+"="+h(String(p))]}var _=[];if(typeof p>"u")return _;var v;if(Mw(o))v=o;else{var E=Object.keys(p);v=c?E.sort(c):E}for(var T=0;T<v.length;++T){var x=v[T];s&&p[x]===null||(Mw(p)?WG(_,t(p[x],typeof i=="function"?i(n,x):n,i,r,s,a,o,c,l,u,h,d,f)):WG(_,t(p[x],n+(l?"."+x:"["+x+"]"),i,r,s,a,o,c,l,u,h,d,f)))}return _},Fvt=function(e){if(!e)return tu;if(e.encoder!==null&&e.encoder!==void 0&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||tu.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var i=cM.default;if(typeof e.format<"u"){if(!Dvt.call(cM.formatters,e.format))throw new TypeError("Unknown format option provided.");i=e.format}var r=cM.formatters[i],s=tu.filter;return(typeof e.filter=="function"||Mw(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:tu.addQueryPrefix,allowDots:typeof e.allowDots>"u"?tu.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:tu.charsetSentinel,delimiter:typeof e.delimiter>"u"?tu.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:tu.encode,encoder:typeof e.encoder=="function"?e.encoder:tu.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:tu.encodeValuesOnly,filter:s,formatter:r,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:tu.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:tu.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:tu.strictNullHandling}},zvt=function(t,e){var n=t,i=Fvt(e),r,s;typeof i.filter=="function"?(s=i.filter,n=s("",n)):Mw(i.filter)&&(s=i.filter,r=s);var a=[];if(typeof n!="object"||n===null)return"";var o;e&&e.arrayFormat in Qie?o=e.arrayFormat:e&&"indices"in e?o=e.indices?"indices":"repeat":o="indices";var c=Qie[o];r||(r=Object.keys(n)),i.sort&&r.sort(i.sort);for(var l=0;l<r.length;++l){var u=r[l];i.skipNulls&&n[u]===null||WG(a,Bvt(n[u],u,c,i.strictNullHandling,i.skipNulls,i.encode?i.encoder:null,i.filter,i.sort,i.allowDots,i.serializeDate,i.formatter,i.encodeValuesOnly,i.charset))}var h=a.join(i.delimiter),d=i.addQueryPrefix===!0?"?":"";return i.charsetSentinel&&(i.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),h.length>0?d+h:""};const C_e=Gc(zvt);var Hvt=jY;Hvt.decode;const R1=Symbol("twurpleRawData");class jvt{constructor(e){this[R1]=e}}class ox extends Error{constructor(e,n){var i;super(e,n),Object.setPrototypeOf(this,new.target.prototype),(i=Error.captureStackTrace)===null||i===void 0||i.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}function OI(t,e,n){return i=>{const r=n?function(){return`[${e}#${this[n]} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${t}/classes/${e}.html for available properties]`};Object.defineProperty(i.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:r,enumerable:!1})}}class tre extends ox{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function yv(t){return typeof t=="string"?t:typeof t=="number"?t.toString(10):t.id}class R_e extends ox{constructor(e,n,i,r,s,a){super(`Encountered HTTP status code ${e}: ${n}

URL: ${i}
Method: ${r}
Body:
${!a&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=i,this._method=r,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function Vvt(t,e){var n;if(!t.ok){const i=t.headers.get("Content-Type")==="application/json",r=i?JSON.stringify(await t.json(),null,2):await t.text(),s=C_e(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),a=`${e.url}${s}`;throw new R_e(t.status,t.statusText,a,(n=e.method)!==null&&n!==void 0?n:"GET",r,i)}}async function Gvt(t){if(t.status===204)return;const e=await t.text();if(e)return JSON.parse(e)}function qvt(t,e,n){switch(e){case"helix":return`https://api.twitch.tv/helix/${t.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${t.replace(/^\//,"")}`;case"custom":return t;default:return t}}async function $vt(t,e,n,i,r={},s){var a,o;const c=(a=t.type)!==null&&a!==void 0?a:"helix",l=qvt(t.url,c),u=C_e(t.query,{arrayFormat:"repeat",addQueryPrefix:!0}),h=new T_e.Headers({Accept:"application/json"});let d;t.jsonBody&&(d=JSON.stringify(t.jsonBody),h.append("Content-Type","application/json")),e&&c!=="auth"&&h.append("Client-ID",e),n&&h.append("Authorization",`${c==="helix"?"Bearer":"OAuth"} ${n}`);const f={...r,method:(o=t.method)!==null&&o!==void 0?o:"GET",headers:h,body:d};return await bvt(`${l}${u}`,f)}async function J6(t,e,n,i,r={}){const s=await $vt(t,e,n,i,r);return await Vvt(s,t),await Gvt(s)}class Ow extends ox{constructor(e){super("Invalid token supplied",e)}}class UP extends ox{}function Wvt(t,e,n,i){return{grant_type:"authorization_code",client_id:t,client_secret:e,code:n,redirect_uri:i}}function Yvt(t,e){return{grant_type:"client_credentials",client_id:t,client_secret:e}}function Xvt(t,e,n){return{grant_type:"refresh_token",client_id:t,client_secret:e,refresh_token:n}}let YG=class extends jvt{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[R1].client_id}get userId(){var e;return(e=this[R1].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[R1].login)!==null&&e!==void 0?e:null}get scopes(){return this[R1].scopes}get expiryDate(){return zO(this[R1].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};YG=aa([OI("auth","TokenInfo","clientId")],YG);function VY(t){var e,n;return{accessToken:t.access_token,refreshToken:t.refresh_token||null,scope:(e=t.scope)!==null&&e!==void 0?e:[],expiresIn:(n=t.expires_in)!==null&&n!==void 0?n:null,obtainmentTimestamp:Date.now()}}async function Kvt(t,e,n,i){return VY(await J6({type:"auth",url:"token",method:"POST",query:Wvt(t,e,n,i)}))}async function Jvt(t,e){return VY(await J6({type:"auth",url:"token",method:"POST",query:Yvt(t,e)}))}async function nre(t,e,n){return VY(await J6({type:"auth",url:"token",method:"POST",query:Xvt(t,e,n)}))}async function HO(t,e){try{const n=await J6({type:"auth",url:"validate"},e,t);return new YG(n)}catch(n){throw n instanceof R_e&&n.statusCode===401?new Ow({cause:n}):n}}const Zvt=new Map([["channel_commercial",["channel:edit:commercial"]],["channel_editor",["channel:manage:broadcast"]],["channel_read",["channel:read:stream_key"]],["channel_subscriptions",["channel:read:subscriptions"]],["user_blocks_read",["user:read:blocked_users"]],["user_blocks_edit",["user:manage:blocked_users"]],["user_follows_edit",["user:edit:follows"]],["user_read",["user:read:email"]],["user_subscriptions",["user:read:subscriptions"]],["user:edit:broadcast",["channel:manage:broadcast","channel:manage:extensions"]]]);function Qvt(t,e){if(e!=null&&e.length){const n=new Set(t.flatMap(i=>{var r;return[i,...(r=Zvt.get(i))!==null&&r!==void 0?r:[]]}));if(e.every(i=>!n.has(i))){const i=e.join(", ");throw new Error(`This token does not have any of the requested scopes (${i}) and can not be upgraded.
If you need dynamically upgrading scopes, please implement the AuthProvider interface accordingly:

	https://twurple.js.org/reference/auth/interfaces/AuthProvider.html`)}}}function BP(t,e){for(const n of e)Qvt(t,n)}async function eyt(t,e,n,i,r){if(r!=null&&r.length||!n){const s=await HO(e,t);if(!s.userId)throw new Error("Trying to use an app access token as a user access token");const a=i??s.scopes;return r&&BP(a,r.filter(o=>!!o)),[a,s.userId]}return[i,n]}class ire{constructor(e){this._newTokenScopeSets=[],this._newTokenPromise=null,this._queuedScopeSets=[],this._queueExecutor=null,this._queuePromise=null,this._executor=e}async fetch(...e){var n;const i=e.filter(o=>!!o);if(this._newTokenPromise){if(!i.length)return await this._newTokenPromise;if(this._queueExecutor?this._queuedScopeSets.push(...i):this._queuedScopeSets=[...i],!this._queuePromise){const{promise:o,resolve:c,reject:l}=GG();this._queuePromise=o,this._queueExecutor=async()=>{var u;if(this._queuePromise){this._newTokenScopeSets=this._queuedScopeSets,this._queuedScopeSets=[],this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{c(await this._executor(this._newTokenScopeSets))}catch(h){l(h)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(u=this._queueExecutor)===null||u===void 0||u.call(this)}}}}return await this._queuePromise}this._newTokenScopeSets=[...i];const{promise:r,resolve:s,reject:a}=GG();this._newTokenPromise=r;try{s(await this._executor(this._newTokenScopeSets))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(n=this._queueExecutor)===null||n===void 0||n.call(this)}return await r}}class rre extends ox{constructor(e){super(`The user context for the user ${e} has been disabled.
This happened because the access token became invalid (e.g. by expiry) and refreshing it failed (e.g. because the account's password was changed).

Use .addUser(), .addUserForToken() or .addUserForCode() for the same user context to re-enable the user with a new, valid token.`),this.userId=e}}class tyt extends ox{constructor(e){super(`User ${e} was removed while trying to fetch a token.

Make sure you're not executing any actions when you want to remove a user.`),this.userId=e}}class nyt extends ox{constructor(e){super(`Unknown intent: ${e}`),this.intent=e}}let Db=class extends MI{constructor(e){var n;super(),this._userAccessTokens=new Map,this._userTokenFetchers=new Map,this._intentToUserId=new Map,this._userIdToIntents=new Map,this._cachedRefreshFailures=new Set,this.onRefresh=this.registerEvent(),this.onRefreshFailure=this.registerEvent(),this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._redirectUri=e.redirectUri,this._appImpliedScopes=(n=e.appImpliedScopes)!==null&&n!==void 0?n:[],this._appTokenFetcher=new ire(async i=>await this._fetchAppToken(i))}addUser(e,n,i){const r=yv(e);if(!n.refreshToken)throw new Error(`Trying to add user ${r} without refresh token`);this._cachedRefreshFailures.delete(r),this._userAccessTokens.set(r,{...n,userId:r}),this._userTokenFetchers.has(r)||this._userTokenFetchers.set(r,new ire(async s=>await this._fetchUserToken(r,s))),i&&this.addIntentsToUser(e,i)}async addUserForToken(e,n){let i=null;if(e.accessToken&&!LP(e))try{const o=await HO(e.accessToken);i=[e,o]}catch(o){if(!(o instanceof Ow))throw o}if(!i){if(!e.refreshToken)throw new Ow;const o=await nre(this._clientId,this._clientSecret,e.refreshToken),c=await HO(o.accessToken);this.emit(this.onRefresh,c.userId,o),i=[o,c]}const[r,s]=i;if(!s.userId)throw new UP("Could not determine a user ID for your token; you might be trying to disguise an app token as a user token.");const a=r.scope?r:{...r,scope:s.scopes};return this.addUser(s.userId,a,n),s.userId}async addUserForCode(e,n){if(!this._redirectUri)throw new Error("This method requires you to pass a `redirectUri` as a configuration property");const i=await Kvt(this._clientId,this._clientSecret,e,this._redirectUri);return await this.addUserForToken(i,n)}hasUser(e){return this._userTokenFetchers.has(yv(e))}removeUser(e){const n=yv(e);if(this._userIdToIntents.has(n)){const i=this._userIdToIntents.get(n);for(const r of i)this._intentToUserId.delete(r);this._userIdToIntents.delete(n)}this._userAccessTokens.delete(n),this._userTokenFetchers.delete(n),this._cachedRefreshFailures.delete(n)}addIntentsToUser(e,n){const i=yv(e);if(!this._userAccessTokens.has(i))throw new Error("Trying to add intents to a user that was not added to this provider");for(const r of n)this._intentToUserId.has(r)&&this._userIdToIntents.get(this._intentToUserId.get(r)).delete(r),this._intentToUserId.set(r,i),this._userIdToIntents.has(i)?this._userIdToIntents.get(i).add(r):this._userIdToIntents.set(i,new Set([r]))}getIntentsForUser(e){const n=yv(e);return this._userIdToIntents.has(n)?Array.from(this._userIdToIntents.get(n)):[]}removeIntents(e){var n;for(const i of e)if(this._intentToUserId.has(i)){const r=this._intentToUserId.get(i);(n=this._userIdToIntents.get(r))===null||n===void 0||n.delete(i),this._intentToUserId.delete(i)}}async refreshAccessTokenForUser(e){const n=yv(e);if(this._cachedRefreshFailures.has(n))throw new rre(n);const i=this._userAccessTokens.get(n);if(!i)throw new Error("Trying to refresh token for user that was not added to the provider");const r=await this._refreshUserTokenWithCallback(n,i.refreshToken);return this._checkIntermediateUserRemoval(n),this._userAccessTokens.set(n,{...r,userId:n}),this.emit(this.onRefresh,n,r),{...r,userId:n}}async refreshAccessTokenForIntent(e){if(!this._intentToUserId.has(e))throw new nyt(e);const n=this._intentToUserId.get(e);return await this.refreshAccessTokenForUser(n)}get clientId(){return this._clientId}getCurrentScopesForUser(e){var n;const i=this._userAccessTokens.get(yv(e));if(!i)throw new Error("Trying to get scopes for user that was not added to the provider");return(n=i.scope)!==null&&n!==void 0?n:[]}async getAccessTokenForUser(e,...n){const i=yv(e),r=this._userTokenFetchers.get(i);if(!r)return null;if(this._cachedRefreshFailures.has(i))throw new rre(i);return BP(this.getCurrentScopesForUser(i),n.filter(Boolean)),await r.fetch(...n)}async getAccessTokenForIntent(e,...n){if(!this._intentToUserId.has(e))return null;const i=this._intentToUserId.get(e),r=await this.getAccessTokenForUser(i,...n);if(!r)throw new tre(`Found intent ${e} corresponding to user ID ${i} but no token was found`);return{...r,userId:i}}async getAnyAccessToken(e){if(e){const n=yv(e);if(this._userAccessTokens.has(n)){const i=await this.getAccessTokenForUser(n);if(!i)throw new tre(`Token for user ID ${n} exists but nothing was returned by getAccessTokenForUser`);return{...i,userId:n}}}return await this.getAppAccessToken()}async getAppAccessToken(e=!1){return e&&(this._appAccessToken=void 0),await this._appTokenFetcher.fetch(...this._appImpliedScopes.map(n=>[n]))}_checkIntermediateUserRemoval(e){if(!this._userTokenFetchers.has(e))throw this._cachedRefreshFailures.delete(e),new tyt(e)}async _fetchUserToken(e,n){const i=this._userAccessTokens.get(e);if(!i)throw new Error("Trying to get token for user that was not added to the provider");if(i.accessToken&&!LP(i))try{if(i.scope)return BP(i.scope,n),i;const[s=[]]=await eyt(this._clientId,i.accessToken,e,i.scope,n),a={...i,scope:s};return this._checkIntermediateUserRemoval(e),this._userAccessTokens.set(e,a),a}catch(s){if(!(s instanceof Ow))throw s}this._checkIntermediateUserRemoval(e);const r=await this.refreshAccessTokenForUser(e);return BP(r.scope,n),r}async _refreshUserTokenWithCallback(e,n){try{return await nre(this.clientId,this._clientSecret,n)}catch(i){throw this._cachedRefreshFailures.add(e),this.emit(this.onRefreshFailure,e,i),i}}async _fetchAppToken(e){if(e.length>0)for(const n of e)if(this._appImpliedScopes.length){if(n.every(i=>!this._appImpliedScopes.includes(i)))throw new Error(`One of the scopes ${n.join(", ")} requested but only the scope ${this._appImpliedScopes.join(", ")} is implied`)}else throw new Error(`One of the scopes ${n.join(", ")} requested but the client credentials flow does not support scopes`);return!this._appAccessToken||LP(this._appAccessToken)?await this._refreshAppToken():this._appAccessToken}async _refreshAppToken(){return this._appAccessToken=await Jvt(this._clientId,this._clientSecret)}};aa([rE(!1)],Db.prototype,"_clientSecret",void 0);aa([rE(!1)],Db.prototype,"_userAccessTokens",void 0);aa([rE(!1)],Db.prototype,"_userTokenFetchers",void 0);aa([rE(!1)],Db.prototype,"_appAccessToken",void 0);aa([rE(!1)],Db.prototype,"_appTokenFetcher",void 0);Db=aa([OI("auth","RefreshingAuthProvider","clientId")],Db);class iyt extends MI{constructor({lineBased:e,logger:n,additionalOptions:i}={}){super(),this._currentLine="",this._connecting=!1,this._connected=!1,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._lineBased=e??!1,this._logger=n,this._additionalOptions=i}get isConnecting(){return this._connecting}get isConnected(){return this._connected}sendLine(e){this._connected&&(e=e.replace(/[\0\r\n]/g,""),this.sendRaw(`${e}\r
`))}assumeExternalDisconnect(){var e;(e=this._logger)===null||e===void 0||e.trace("AbstractConnection assumeExternalDisconnect"),this._connected=!1,this._connecting=!1,this.clearSocket(),this.emit(this.onDisconnect,!1)}receiveRaw(e){var n,i;if(!this._lineBased){this.emit(this.onReceive,e);return}const r=e.split(`\r
`);if(this._currentLine+=(n=r.shift())!==null&&n!==void 0?n:"",r.length){this.emit(this.onReceive,this._currentLine),this._currentLine=(i=r.pop())!==null&&i!==void 0?i:"";for(const s of r)this.emit(this.onReceive,s)}}}class ryt{constructor(){throw new Error("DirectConnection is not implemented in a browser environment")}}class syt extends MI{constructor(e,n,i={}){var r;super(),this._type=e,this._target=n,this._config=i,this._retryLimit=1/0,this._initialRetryLimit=3,this._connecting=!1,this._connectionRetryCount=0,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._retryLimit=(r=i.retryLimit)!==null&&r!==void 0?r:1/0,this._logger=i.logger}get isConnected(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnected)!==null&&n!==void 0?n:!1}get isConnecting(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnecting)!==null&&n!==void 0?n:this._connecting}get hasSocket(){var e,n;return(n=(e=this._currentConnection)===null||e===void 0?void 0:e.hasSocket)!==null&&n!==void 0?n:!1}sendLine(e){var n;(n=this._currentConnection)===null||n===void 0||n.sendLine(e)}connect(){if(this._currentConnection||this._connecting)throw new Error("Connection already present");this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(!0)}disconnect(){var e;if((e=this._logger)===null||e===void 0||e.trace(`PersistentConnection disconnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`),this._connecting=!1,this._currentConnection){const n=this._currentConnection;this._currentConnection=void 0,n.disconnect()}}assumeExternalDisconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("PersistentConnection assumeExternalDisconnect"),(n=this._currentConnection)===null||n===void 0||n.assumeExternalDisconnect()}reconnect(){this._reconnect(!0)}acknowledgeSuccessfulReconnect(){this._previousConnection&&(this._previousConnection.disconnect(),this._previousConnection=void 0)}_startTryingToConnect(e=!1){this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(e)}_tryConnect(e=!1){var n,i;(n=this._logger)===null||n===void 0||n.trace(`PersistentConnection tryConnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`);const r=e?this._initialRetryLimit:this._retryLimit;(i=this._retryTimerGenerator)!==null&&i!==void 0||(this._retryTimerGenerator=g_e(120));const s=this._currentConnection=new this._type(nvt(this._target),this._config);s.onReceive(a=>this.emit(this.onReceive,a)),s.onConnect(()=>{this.emit(this.onConnect),this._connecting=!1,this._retryTimerGenerator=void 0}),s.onDisconnect((a,o)=>{var c,l,u;if(this.emit(this.onDisconnect,a,o),a)this.emit(this.onEnd,!0),this._connecting=!1,this._retryTimerGenerator=void 0,s.disconnect(),this._currentConnection===s&&(this._currentConnection=void 0),this._previousConnection===s&&(this._previousConnection=void 0);else if(this._connecting){if((c=this._logger)===null||c===void 0||c.debug(`Connection error caught: ${(l=o==null?void 0:o.message)!==null&&l!==void 0?l:"unknown error"}`),this._connectionRetryCount>=r)return;this._connectionRetryCount++;const h=this._retryTimerGenerator.next().value;h!==0&&((u=this._logger)===null||u===void 0||u.info(`Retrying in ${h} seconds`)),setTimeout(()=>{var d;this._connecting&&((d=this._logger)===null||d===void 0||d.info(e?"Retrying connection":"Trying to reconnect"),this._tryConnect())},h*1e3)}else this._reconnect()}),s.connect()}_reconnect(e=!1){e&&this._config.overlapManualReconnect?(this._previousConnection=this._currentConnection,this._currentConnection=void 0):this.disconnect(),this._startTryingToConnect(e)}}var A1=null;typeof WebSocket<"u"?A1=WebSocket:typeof MozWebSocket<"u"?A1=MozWebSocket:typeof Xp<"u"?A1=Xp.WebSocket||Xp.MozWebSocket:typeof window<"u"?A1=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(A1=self.WebSocket||self.MozWebSocket);class ayt extends iyt{constructor(e,n){if(super(n),this._socket=null,this._closingOnDemand=!1,e.hostName&&e.port)this._url=`ws${e.secure?"s":""}://${e.hostName}:${e.port}`;else if(e.url)this._url=e.url;else throw new Error("WebSocketConnection requires either hostName & port or url to be set")}get hasSocket(){return!!this._socket}sendRaw(e){var n;(n=this._socket)===null||n===void 0||n.send(e)}connect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection connect"),this._connecting=!0,this._socket=new A1(this._url,(n=this._additionalOptions)===null||n===void 0?void 0:n.wsOptions),this._socket.onopen=()=>{var i;(i=this._logger)===null||i===void 0||i.trace("WebSocketConnection onOpen"),this._connected=!0,this._connecting=!1,this._closingOnDemand=!1,this.emit(this.onConnect)},this._socket.onmessage=({data:i})=>{this.receiveRaw(i.toString())},this._socket.onerror=i=>{var r;(r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onError message:${i.message}`)},this._socket.onclose=i=>{var r;const s=this._connected,a=this._connecting;if((r=this._logger)===null||r===void 0||r.trace(`WebSocketConnection onClose wasConnected:${s.toString()} wasConnecting:${a.toString()} closingOnDemand:${this._closingOnDemand.toString()} wasClean:${i.wasClean.toString()}`),this._connected=!1,this._connecting=!1,this._closingOnDemand)this._closingOnDemand=!1,this.emit(this.onDisconnect,!0),this.emit(this.onEnd,!0);else{const o=new Error(`[${i.code}] ${i.reason}`);this.emit(this.onDisconnect,!1,o),this.emit(this.onEnd,!1,o)}this.clearSocket()}}disconnect(){var e,n;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection disconnect"),this._closingOnDemand=!0,(n=this._socket)===null||n===void 0||n.close()}clearSocket(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onerror=null,this._socket.onclose=null,this._socket=null)}}function lM(t){var e,n,i;if(Array.isArray(t)){for(n=Array(e=t.length);e--;)n[e]=(i=t[e])&&typeof i=="object"?lM(i):i;return n}if(Object.prototype.toString.call(t)==="[object Object]"){n={};for(e in t)e==="__proto__"?Object.defineProperty(n,e,{value:lM(t[e]),configurable:!0,enumerable:!0,writable:!0}):n[e]=(i=t[e])&&typeof i=="object"?lM(i):i;return n}return t}const oyt={name:"away-notify"};class LU extends Error{constructor(e,n,i){super(`command "${e}" expected ${n} or more parameters, got ${i}`),this._command=e,this._expectedParams=n,this._actualParams=i,Object.setPrototypeOf(this,LU.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,LU)}get command(){return this._command}get expectedParams(){return this._expectedParams}get actualParams(){return this._actualParams}}class UU extends Error{constructor(e,n,i,r){var s;super(`required parameter "${n}" did not validate against ${(s=i.type)!==null&&s!==void 0?s:"regex"} validation: "${r}"`),this._command=e,this._paramName=n,this._paramSpec=i,this._givenValue=r,Object.setPrototypeOf(this,UU.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,UU)}get command(){return this._command}get paramName(){return this._paramName}get paramSpec(){return this._paramSpec}get givenValue(){return this._givenValue}}const Nw={channelTypes:"#&",supportedUserModes:"iwso",supportedChannelModes:{prefix:"ov",list:"b",alwaysWithParam:"ovk",paramWhenSet:"l",noParam:"imnpst"},prefixes:[{modeChar:"v",prefix:"+"},{modeChar:"o",prefix:"@"}]};var A_e={exports:{}};(function(t){t.exports=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},t.exports.default=t.exports})(A_e);var cyt=A_e.exports;const lyt=Gc(cyt);function XG(t,e="#&"){return new RegExp(`^[${lyt(e)}][^ \b\0
\r,]+$`).test(t)}const sre={0:"\0",n:`
`,r:"\r","":""};function are(t){if(!t.startsWith("")||(t=t.substring(1),t.endsWith("")&&(t=t.slice(0,-1)),!t))return!1;t=t.replace(/\x10(.)/,(i,r)=>r in sre?sre[r]:"");let[e,n=""]=QS(t," ",2);return e=e?e.toUpperCase():"",{command:e,params:n}}const uyt={"\\":"\\",";":":","\n":"n","\r":"r"," ":"s"};function hyt(t){return t.replace(/[\\;\n\r ]/g,e=>`\\${uyt[e]}`)}function dyt(t){let e=`${t.nick}`;return t.user&&(e+=`!${t.user}`),t.host&&(e+=`@${t.host}`),e}function fyt(t,e,n,i,r=Nw,s=!1){const a=new t(t.COMMAND,void 0,{serverProperties:r}),o={};if(a._paramSpec&&VG(a._paramSpec,(c,l)=>{if(!(s&&c.noServer)&&!(!s&&c.noClient)){if(l in e){const u=e[l];if(u!==void 0){if(t.checkParam(u,c,r))o[l]={value:u,trailing:!!c.trailing};else if(!c.optional)throw new Error(`required parameter "${l}" did not suit requirements: "${u}"`)}}if(!(l in o)&&!c.optional)throw new Error(`required parameter "${l}" not found in command "${t.COMMAND}"`)}}),a._parsedParams=o,a._paramSpec)for(const c of Object.keys(a._paramSpec))Object.defineProperty(a,c,{get(){var l,u;return(u=(l=this._parsedParams)===null||l===void 0?void 0:l[c])===null||u===void 0?void 0:u.value}});return a._initPrefixAndTags(n,i),a}class zt{static checkParam(e,n,i=Nw){return!(n.type==="channel"&&!XG(e,i.channelTypes)||n.type==="channelList"&&!e.split(",").every(s=>XG(s,i.channelTypes))||n.match&&!n.match.test(e))}constructor(e,{params:n,tags:i,prefix:r,rawLine:s}={},{serverProperties:a=Nw,isServer:o=!1,shouldParseParams:c=!0}={},l){this._params=[],this._serverProperties=Nw,this._paramSpec=l,this._command=e,this._params=n,this._tags=i??new Map,this._prefix=r,this._serverProperties=a,this._raw=s,c&&this.parseParams(o)}getMinParamCount(e=!1){return this._paramSpec?Object.values(this._paramSpec).filter(n=>n.noServer&&e||n.noClient&&!e?!1:!n.optional).length:0}get paramCount(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.length)!==null&&n!==void 0?n:0}prefixToString(){return this._prefix?dyt(this._prefix):""}tagsToString(){return[...this._tags.entries()].map(([e,n])=>n?`${e}=${hyt(n)}`:e).join(";")}toString(e=!1,n=!1){const r=[n?this._buildCommandFromRawParams():this._buildCommandFromNamedParams()];if(e){const a=this.prefixToString();a&&r.unshift(`:${a}`)}const s=this.tagsToString();return s&&r.unshift(`@${s}`),r.join(" ")}_initPrefixAndTags(e,n){this._prefix=e,n&&(this._tags=n)}parseParams(e=!1){if(this._params){let n=this.getMinParamCount(e);if(n>this._params.length)throw new LU(this._command,n,this._params.length);const i=this._paramSpec;if(!i)return;let r=0;const s={};for(const[a,o]of Object.entries(i)){if(o.noServer&&e||o.noClient&&!e)continue;if(this._params.length-r<=n){if(o.optional)continue;if(this._params.length-r!==n)throw new Error("not enough parameters left for required parameters parsing (this is a library bug)")}let c=this._params[r];if(!c){if(o.optional)break;throw new Error("unexpected parameter underflow")}if(o.rest){const l=[];for(;this._params[r]&&!this._params[r].trailing;)l.push(this._params[r].value),++r;if(!l.length){if(o.optional)continue;throw new Error(`no parameters left for required rest parameter "${a}"`)}c={value:l.join(" "),trailing:!1}}if(zt.checkParam(c.value,o))s[a]={...c},o.optional||--n,o.rest||++r;else if(!o.optional)throw new UU(this._command,a,o,c.value);if(o.trailing)break}if(this._parsedParams=s,this._paramSpec)for(const a of Object.keys(this._paramSpec))Object.defineProperty(this,a,{get(){var o,c;return(c=(o=this._parsedParams)===null||o===void 0?void 0:o[a])===null||c===void 0?void 0:c.value}})}}get rawParamValues(){var e,n;return(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>i.value))!==null&&n!==void 0?n:[]}get prefix(){return this._prefix}get command(){return this._command}get tags(){return this._tags}get rawLine(){return this._raw}isResponseTo(e){return!1}endsResponseTo(e){return!1}_acceptsInReplyCollection(e){return e.isResponseTo(this)}_buildCommandFromNamedParams(){const e=this._paramSpec?Object.keys(this._paramSpec):[];return[this._command,...e.map(n=>{var i;const r=(i=this._parsedParams)===null||i===void 0?void 0:i[n];if(r)return(r.trailing?":":"")+r.value}).filter(n=>n!==void 0)].join(" ")}_buildCommandFromRawParams(){var e,n;return[this._command,...(n=(e=this._params)===null||e===void 0?void 0:e.map(i=>`${i.trailing?":":""}${i.value}`))!==null&&n!==void 0?n:[]].join(" ")}}zt.COMMAND="";zt.SUPPORTS_CAPTURE=!1;class M_e extends zt{constructor(e,n,i){super(e,n,i,{reference:{},type:{optional:!0},additionalParams:{optional:!0}})}}M_e.COMMAND="BATCH";const pyt={name:"batch",messageTypes:[M_e],usesTags:!0},myt={name:"cap-notify"};class O_e extends zt{constructor(e,n,i){super(e,n,i,{newUser:{},newHost:{}})}}O_e.COMMAND="CHGHOST";const gyt={name:"chghost",messageTypes:[O_e]},vyt={name:"invite-notify"};class N_e extends zt{}N_e.COMMAND="ACK";const yyt={name:"labeled-response",messageTypes:[N_e],usesTags:!0},_yt={name:"message-tags",usesTags:!0},byt={name:"multi-prefix"},Eyt=Object.freeze(Object.defineProperty({__proto__:null,AwayNotify:oyt,Batch:pyt,CapNotify:myt,ChgHost:gyt,InviteNotify:vyt,LabeledResponse:yyt,MessageTags:_yt,MultiPrefix:byt},Symbol.toStringTag,{value:"Module"}));class Syt{constructor(e,n,...i){this._client=e,this._originalMessage=n,this._messages=[],this._endEventHandlers=new Map,this._types=new Set(i)}untilEvent(e){this._cleanEndEventHandler(e);const n=this._client.on(e,()=>this.end());this._endEventHandlers.set(e,n)}async promise(){return this._promise||(this._promise=new Promise(e=>{this._promiseResolve=e})),await this._promise}collect(e){return this._originalMessage._acceptsInReplyCollection(e)?(this._messages.push(e),e.endsResponseTo(this._originalMessage)&&this.end(),!0):!1}end(){this._client.stopCollect(this),this._cleanEndEventHandlers(),this._promiseResolve&&this._promiseResolve(this._messages)}_cleanEndEventHandlers(){this._endEventHandlers.forEach(e=>{this._client.removeListener(e)}),this._endEventHandlers.clear()}_cleanEndEventHandler(e){this._endEventHandlers.has(e)&&(this._client.removeListener(this._endEventHandlers.get(e)),this._endEventHandlers.delete(e))}}class GY extends zt{constructor(e,n,i){super(e,n,i,{password:{}})}}GY.COMMAND="PASS";class uM extends zt{constructor(e,n,i){super(e,n,i,{nick:{}})}}uM.COMMAND="NICK";class qY extends zt{constructor(e,n,i){super(e,n,i,{user:{},mode:{},unused:{},realName:{trailing:!0}})}}qY.COMMAND="USER";class I_e extends zt{constructor(e,n,i){super(e,n,i,{name:{},password:{}})}}I_e.COMMAND="OPER";class $Y extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}$Y.COMMAND="QUIT";class k_e extends zt{constructor(e,n,i){super(e,n,i,{server:{},reason:{trailing:!0}})}}k_e.COMMAND="SQUIT";class jO extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},key:{optional:!0}})}}jO.COMMAND="JOIN";class VO extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},reason:{trailing:!0,optional:!0}})}}VO.COMMAND="PART";class BU extends Error{constructor(e){super(`Unknown channel mode character ${e}`),this._char=e,Object.setPrototypeOf(this,BU.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,BU)}get char(){return this._char}}class D_e extends zt{constructor(e,n,i){super(e,n,i,{target:{},modes:{rest:!0,optional:!0}})}get isChannel(){return XG(this.target,this._serverProperties.channelTypes)}separate(){const e=[],n=this.modes;if(!n)throw new Error("can't separate a channel mode request, just set actions");const i=n.split(" "),r=i.shift();let s="add";for(const a of r){let o=s;switch(a){case"+":{s="add";break}case"-":{s="remove";break}default:{let c=!1,l=!0;if(this.isChannel){if(this._serverProperties.supportedChannelModes.alwaysWithParam.includes(a)||this._serverProperties.supportedChannelModes.prefix.includes(a))c=!0;else if(this._serverProperties.supportedChannelModes.paramWhenSet.includes(a))s==="add"&&(c=!0);else if(this._serverProperties.supportedChannelModes.list.includes(a))i.length?c=!0:o="getList";else if(!this._serverProperties.supportedChannelModes.noParam.includes(a))throw new BU(a)}else l=this._serverProperties.supportedUserModes.includes(a);if(c&&!i.length)continue;e.push({prefix:this._prefix,action:o,letter:a,param:c?i.shift():void 0,known:l})}}}return e}}D_e.COMMAND="MODE";class P_e extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},newTopic:{optional:!0,trailing:!0}})}}P_e.COMMAND="TOPIC";class NI extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channelList",optional:!0}})}}NI.COMMAND="NAMES";NI.SUPPORTS_CAPTURE=!0;class L_e extends zt{constructor(e,n,i){super(e,n,i,{channel:{optional:!0},server:{optional:!0}})}}L_e.COMMAND="LIST";class U_e extends zt{constructor(e,n,i){super(e,n,i,{target:{},channel:{type:"channel"}})}}U_e.COMMAND="INVITE";class B_e extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},target:{},reason:{trailing:!0,optional:!0}})}}B_e.COMMAND="KICK";class F_e extends zt{constructor(e,n,i){super(e,n,i,{server:{optional:!0}})}}F_e.COMMAND="TIME";class GO extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}GO.COMMAND="PRIVMSG";class Z6 extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}}Z6.COMMAND="NOTICE";class Q6 extends zt{constructor(e,n,i){super(e,n,i,{mask:{},flags:{optional:!0},extendedMask:{optional:!0,trailing:!0}})}}Q6.COMMAND="WHO";class z_e extends zt{constructor(e,n,i){super(e,n,i,{server:{optional:!0},nickMask:{}})}}z_e.COMMAND="WHOIS";class H_e extends zt{constructor(e,n,i){super(e,n,i,{nick:{},count:{optional:!0},server:{optional:!0}})}}H_e.COMMAND="WHOWAS";class j_e extends zt{constructor(e,n,i){super(e,n,i,{target:{},reason:{trailing:!0,optional:!0}})}}j_e.COMMAND="KILL";class FU extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}FU.COMMAND="PING";class zU extends zt{constructor(e,n,i){super(e,n,i,{server:{noClient:!0},text:{trailing:!0}})}}zU.COMMAND="PONG";class V_e extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}V_e.COMMAND="ERROR";class G_e extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0,optional:!0}})}}G_e.COMMAND="AWAY";class q_e extends zt{}q_e.COMMAND="REHASH";class $_e extends zt{}$_e.COMMAND="RESTART";class W_e extends zt{constructor(e,n,i){super(e,n,i,{text:{trailing:!0}})}}W_e.COMMAND="WALLOPS";class Y_e extends zt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}Y_e.COMMAND="USERHOST";class X_e extends zt{constructor(e,n,i){super(e,n,i,{nicks:{rest:!0}})}}X_e.COMMAND="ISON";class Df extends zt{constructor(e,n,i){super(e,n,i,{target:{match:/^(?:[a-z_\-\[\]\\^{}|`][a-z0-9_\-\[\]\\^{}|`]+|\*)$/i,optional:!0,noClient:!0},subCommand:{match:/^(?:LS|LIST|REQ|ACK|NAK|END|NEW|DEL)$/i},version:{match:/^\d+$/,optional:!0},continued:{match:/^\*$/,optional:!0},capabilities:{trailing:!0,optional:!0}})}isResponseTo(e){if(!(e instanceof Df))return!1;switch(this.subCommand){case"ACK":case"NAK":return e.subCommand==="REQ"&&e.capabilities===this.capabilities.trim();case"LS":case"LIST":return e.subCommand===this.subCommand;default:return!1}}endsResponseTo(e){if(!(e instanceof Df))return!1;switch(this.subCommand){case"LS":case"LIST":return!this.continued;default:return!0}}}Df.COMMAND="CAP";Df.SUPPORTS_CAPTURE=!0;class K_e extends zt{constructor(e,n,i){super(e,n,i,{target:{}})}}K_e.COMMAND="TAGMSG";const J_e=Object.freeze(Object.defineProperty({__proto__:null,Away:G_e,CapabilityNegotiation:Df,ChannelInvite:U_e,ChannelJoin:jO,ChannelKick:B_e,ChannelList:L_e,ChannelPart:VO,ClientQuit:$Y,ErrorMessage:V_e,IsOnQuery:X_e,Kill:j_e,Mode:D_e,Names:NI,NickChange:uM,Notice:Z6,OperLogin:I_e,Password:GY,Ping:FU,Pong:zU,PrivateMessage:GO,Rehash:q_e,Restart:$_e,ServerQuit:k_e,TagMessage:K_e,Time:F_e,Topic:P_e,UserHostQuery:Y_e,UserRegistration:qY,Wallops:W_e,WhoIsQuery:z_e,WhoQuery:Q6,WhoWasQuery:H_e},Symbol.toStringTag,{value:"Module"}));class WY extends zt{constructor(e,n,i){super(e,n,i,{me:{},welcomeText:{trailing:!0}})}}WY.COMMAND="001";class Z_e extends zt{constructor(e,n,i){super(e,n,i,{me:{},yourHost:{trailing:!0}})}}Z_e.COMMAND="002";class Q_e extends zt{constructor(e,n,i){super(e,n,i,{me:{},createdText:{trailing:!0}})}}Q_e.COMMAND="003";class YY extends zt{constructor(e,n,i){super(e,n,i,{me:{},serverName:{},version:{},userModes:{},channelModes:{},channelModesWithParam:{optional:!0}})}}YY.COMMAND="004";class XY extends zt{constructor(e,n,i){super(e,n,i,{me:{},supports:{rest:!0},suffix:{trailing:!0}})}}XY.COMMAND="005";class ebe extends zt{constructor(e,n,i){super(e,n,i,{me:{},modes:{}})}}ebe.COMMAND="221";class tbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},text:{trailing:!0}})}}tbe.COMMAND="301";class nbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},hosts:{trailing:!0}})}}nbe.COMMAND="302";class ibe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}ibe.COMMAND="305";class rbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}rbe.COMMAND="306";class sbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},username:{},host:{},_unused:{},realname:{trailing:!0}})}}sbe.COMMAND="311";class abe extends zt{constructor(e,n,i){super(e,n,i,{me:{},query:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof Q6}endsResponseTo(){return!0}}abe.COMMAND="315";class obe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nickMask:{},suffix:{trailing:!0}})}}obe.COMMAND="318";class cbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channels:{trailing:!0}})}}cbe.COMMAND="319";class lbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},memberCount:{},topic:{trailing:!0}})}}lbe.COMMAND="322";class ube extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}ube.COMMAND="323";class hbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},modes:{rest:!0}})}}hbe.COMMAND="324";class dbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}dbe.COMMAND="331";class fbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},topic:{trailing:!0}})}}fbe.COMMAND="332";class pbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},who:{},ts:{}})}}pbe.COMMAND="333";class mbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"}})}}mbe.COMMAND="341";class gbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}gbe.COMMAND="348";class vbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}vbe.COMMAND="349";class ybe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},user:{},host:{},server:{},nick:{},flags:{},hopsAndRealName:{trailing:!0}})}get isAway(){return this.flags.includes("G")}get isOper(){return this.flags.includes("*")}get isBot(){return this.flags.includes("B")}isResponseTo(e){return e instanceof Q6}}ybe.COMMAND="352";class _be extends zt{constructor(e,n,i){super(e,n,i,{me:{},channelType:{},channel:{type:"channel"},names:{trailing:!0}})}isResponseTo(e){return e instanceof NI}}_be.COMMAND="353";class bbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof NI}endsResponseTo(){return!0}}bbe.COMMAND="366";class Ebe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}Ebe.COMMAND="367";class Sbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Sbe.COMMAND="368";class Tbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}Tbe.COMMAND="372";class xbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},line:{trailing:!0}})}}xbe.COMMAND="375";class KY extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}KY.COMMAND="376";class wbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}wbe.COMMAND="381";class Cbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},server:{optional:!0},timestamp:{trailing:!0}})}}Cbe.COMMAND="391";class Rbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}}Rbe.COMMAND="401";class Abe extends zt{constructor(e,n,i){super(e,n,i,{me:{},server:{},suffix:{trailing:!0}})}}Abe.COMMAND="402";class Mbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}Mbe.COMMAND="403";class Obe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Obe.COMMAND="404";class Nbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Nbe.COMMAND="405";class Ibe extends zt{constructor(e,n,i){super(e,n,i,{me:{},subCommand:{},suffix:{trailing:!0}})}}Ibe.COMMAND="410";class kbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command===this.originalCommand}endsResponseTo(){return!0}}kbe.COMMAND="421";class JY extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}JY.COMMAND="422";class Dbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Dbe.COMMAND="431";class Pbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Pbe.COMMAND="432";class Lbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Lbe.COMMAND="433";class Ube extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Ube.COMMAND="436";class Bbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Bbe.COMMAND="441";class Fbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Fbe.COMMAND="442";class zbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}zbe.COMMAND="443";class Hbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}Hbe.COMMAND="451";class jbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},originalCommand:{},suffix:{trailing:!0}})}}jbe.COMMAND="461";class ZY extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}ZY.COMMAND="462";class Vbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Vbe.COMMAND="471";class Gbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},char:{},suffix:{trailing:!0}})}}Gbe.COMMAND="472";class qbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}qbe.COMMAND="473";class $be extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}$be.COMMAND="474";class Wbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Wbe.COMMAND="475";class Ybe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}Ybe.COMMAND="479";class Xbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}Xbe.COMMAND="481";class Kbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},channel:{},suffix:{trailing:!0}})}}Kbe.COMMAND="482";class Jbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}Jbe.COMMAND="491";class Zbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},modeChar:{optional:!0,match:/^\w$/},suffix:{trailing:!0}})}}Zbe.COMMAND="501";class Qbe extends zt{constructor(e,n,i){super(e,n,i,{me:{},suffix:{trailing:!0}})}}Qbe.COMMAND="502";const eEe=Object.freeze(Object.defineProperty({__proto__:null,Error401NoSuchNick:Rbe,Error402NoSuchServer:Abe,Error403NoSuchChannel:Mbe,Error404CanNotSendToChan:Obe,Error405TooManyChannels:Nbe,Error410InvalidCapCmd:Ibe,Error421UnknownCommand:kbe,Error422NoMotd:JY,Error431NoNickNameGiven:Dbe,Error432ErroneusNickname:Pbe,Error433NickNameInUse:Lbe,Error436NickCollision:Ube,Error441UserNotInChannel:Bbe,Error442NotOnChannel:Fbe,Error443UserOnChannel:zbe,Error451NotRegistered:Hbe,Error461NeedMoreParams:jbe,Error462AlreadyRegistered:ZY,Error471ChannelIsFull:Vbe,Error472UnknownMode:Gbe,Error473InviteOnlyChan:qbe,Error474BannedFromChan:$be,Error475BadChannelKey:Wbe,Error479BadChanName:Ybe,Error481NoPrivileges:Xbe,Error482ChanOpPrivsNeeded:Kbe,Error491NoOperHost:Jbe,Error501UmodeUnknownFlag:Zbe,Error502UsersDontMatch:Qbe,Reply001Welcome:WY,Reply002YourHost:Z_e,Reply003Created:Q_e,Reply004ServerInfo:YY,Reply005Isupport:XY,Reply221UmodeIs:ebe,Reply301Away:tbe,Reply302UserHost:nbe,Reply305UnAway:ibe,Reply306NowAway:rbe,Reply311WhoisUser:sbe,Reply315EndOfWho:abe,Reply318EndOfWhois:obe,Reply319WhoisChannels:cbe,Reply322List:lbe,Reply323ListEnd:ube,Reply324ChannelModeIs:hbe,Reply331NoTopic:dbe,Reply332Topic:fbe,Reply333TopicWhoTime:pbe,Reply341Inviting:mbe,Reply348ExceptList:gbe,Reply349EndOfExceptList:vbe,Reply352WhoReply:ybe,Reply353NamesReply:_be,Reply366EndOfNames:bbe,Reply367BanList:Ebe,Reply368EndOfBanList:Sbe,Reply372Motd:Tbe,Reply375MotdStart:xbe,Reply376EndOfMotd:KY,Reply381YoureOper:wbe,Reply391Time:Cbe},Symbol.toStringTag,{value:"Module"})),Tyt=new Map([...Object.values(J_e),...Object.values(eEe)].map(t=>[t.COMMAND,t]));function xyt(t){const[e,n]=QS(t,"!",2);if(n){const[i,r]=QS(n,"@",2);return r?{nick:e,user:i,host:r}:{nick:e,host:i}}return{nick:e}}const ore={":":";",n:`
`,r:"\r",s:" "};function wyt(t){const e=new Map,n=t.split(";");for(const i of n){const[r,s]=QS(i,"=",2);r!==""&&e.set(r,s?s.replace(/\\(.?)/g,(a,o)=>Object.prototype.hasOwnProperty.call(ore,o)?ore[o]:o):"")}return e}function Cyt(t,e=Nw,n=Tyt,i=!1,r=[],s=!0){const a=t.split(" ");let o,c;const l=[];let u,h;for(;a.length;){if([o]=a,o.startsWith("@")&&!u&&!c&&!h)u=wyt(o.slice(1));else if(o.startsWith(":"))if(!h&&!c)o.length>1&&(h=xyt(o.slice(1)));else{l.push({value:a.join(" ").slice(1),trailing:!0});break}else c?l.push({value:o,trailing:!1}):c=o.toUpperCase();a.shift()}if(u||(u=new Map),!c)throw new Error(`line without command received: ${t}`);s&&(s=!r.includes(c));let d=zt;return n.has(c)&&(d=n.get(c)),new d(c,{params:l,tags:u,prefix:h,rawLine:t},{serverProperties:e,isServer:i,shouldParseParams:s})}class tEe extends MI{constructor(e){super(),this._registered=!1,this._supportsCapabilities=!0,this._events=new Map,this._registeredMessageTypes=new Map,this.onConnect=this.registerEvent(),this.onRegister=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onPrivmsg=this.registerEvent(),this.onAction=this.registerEvent(),this.onNotice=this.registerEvent(),this.onNickChange=this.registerEvent(),this.onCtcp=this.registerEvent(),this.onCtcpReply=this.registerEvent(),this.onPasswordError=this.registerEvent(),this.onAnyMessage=this.registerEvent(),this._serverProperties=lM(Nw),this._supportedFeatures={},this._collectors=[],this._clientCapabilities=new Map,this._serverCapabilities=new Map,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._hasRegisteredBefore=!1,this._channelsFromLastRegister=new Set,this._initialConnectionSetupDone=!1;const{connection:n,credentials:i,channels:r,channelTypes:s,webSocket:a,logger:o={}}=e;this._options=e;const{pingOnInactivity:c=60,pingTimeout:l=10}=n;this._pingOnInactivity=c,this._pingTimeout=l,this._currentNick=i.nick,this._logger=K6({name:"ircv3",emoji:!0,...o}),this.registerCoreMessageTypes();const{hostName:u,secure:h,reconnect:d=!0}=n,f={hostName:u,port:this.port,secure:h},p={lineBased:!0,logger:this._logger,additionalOptions:e.connectionOptions},g=a?ayt:ryt;d?this._connection=new syt(g,f,p):this._connection=new g(p,this._logger,e.connectionOptions);for(const _ of Object.values(Eyt))this.addCapability(_);this.addInternalListener(this.onRegister,async()=>{const _=this._hasRegisteredBefore,v=this._channelsFromLastRegister;this._hasRegisteredBefore=!0,this._channelsFromLastRegister=new Set;const E=_&&this._options.rejoinChannelsOnReconnect?v:await jG(r);if(E)for(const T of E)this.join(T)}),this.onTypedMessage(Df,async({subCommand:_,capabilities:v})=>{const E=v.split(" ");switch(_.toUpperCase()){case"NEW":{this._logger.debug(`Server registered new capabilities: ${E.join(", ")}`);const T=OD(E,N=>{if(!N)return{};const[A,I]=QS(N,"=",2);return{[A]:{name:A,param:I||!0}}});for(const[N,A]of Object.entries(T))this._serverCapabilities.set(N,A);const x=Object.keys(T);await this._negotiateCapabilities(Array.from(this._clientCapabilities.entries()).filter(([N])=>x.includes(N)).map(([,N])=>N));break}case"DEL":{this._logger.debug(`Server removed capabilities: ${E.join(", ")}`);for(const T of E)this._serverCapabilities.delete(T),this._negotiatedCapabilities.delete(T)}}}),this.onTypedMessage(FU,({text:_})=>{this.sendMessage(zU,{text:_})}),this.onTypedMessage(WY,({me:_})=>this._handleReceivedClientNick(_)),this.onTypedMessage(YY,({userModes:_})=>{_&&(this._serverProperties.supportedUserModes=_)}),this.onTypedMessage(XY,({supports:_})=>{const v=OD(_.split(" "),E=>{const[T,x]=QS(E,"=",2);return{[T]:x||!0}});this._supportedFeatures={...this._supportedFeatures,...v}}),this.onTypedMessage(KY,({me:_})=>{this._registered||(this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(JY,({me:_})=>{this._registered||(this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(ZY,({me:_})=>{this._registered||(this._logger.warn("We thought we're not registered yet, but we actually are"),this._handleReceivedClientNick(_),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(GO,_=>{var v;const{target:E,text:T}=_,x=are(T),N=(v=_.prefix)===null||v===void 0?void 0:v.nick;x?x.command==="ACTION"?this.emit(this.onAction,E,N,x.params,_):this.emit(this.onCtcp,E,N,x.command,x.params,_):this.emit(this.onPrivmsg,E,N,T,_)}),this.onTypedMessage(uM,_=>{var v;const{nick:E}=_,T=(v=_.prefix)===null||v===void 0?void 0:v.nick;T===this._currentNick&&(this._currentNick=E),this.emit(this.onNickChange,T,E,_)}),this.onTypedMessage(Z6,_=>{var v;const{target:E,text:T}=_,x=are(T),N=(v=_.prefix)===null||v===void 0?void 0:v.nick;x&&this.emit(this.onCtcpReply,E,N,x.command,x.params,_),this.emit(this.onNotice,E,N,T,_)}),this._options.manuallyAcknowledgeJoins||this.onTypedMessage(jO,({channel:_,prefix:v})=>{(v==null?void 0:v.nick)===this._currentNick&&this.acknowledgeJoin(_)}),this.onTypedMessage(VO,_=>{var v;((v=_.prefix)===null||v===void 0?void 0:v.nick)===this._currentNick&&(this._currentChannels.delete(_.channel),this._channelsFromLastRegister.delete(_.channel))}),this.addInternalListener(this.onRegister,()=>this._startPingCheckTimer()),this._desiredNick=i.nick,this._userName=i.userName,this._realName=i.realName,s&&(this._serverProperties.channelTypes=s)}receiveLine(e){var n;this._logger.debug(`Received message: ${e}`);let i;try{i=Cyt(e,this._serverProperties,this._registeredMessageTypes,!0,this._options.nonConformingCommands)}catch(r){this._logger.error(`Error parsing message: ${r.message}`),this._logger.trace((n=r.stack)!==null&&n!==void 0?n:"No stack available");return}this._logger.trace(`Parsed message: ${JSON.stringify(i)}`),this._startPingCheckTimer(),this.emit(this.onAnyMessage,i),this._handleEvents(i)}get serverProperties(){return lM(this._serverProperties)}get port(){const{webSocket:e,connection:{port:n,secure:i}}=this._options;return n||(e?i?443:80:i?6697:6667)}pingCheck(){const e=Date.now(),n=e.toString(),i=this.onTypedMessage(zU,r=>{const{text:s}=r;s===n&&(this._logger.debug(`Current ping: ${Date.now()-e}ms`),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),this.removeMessageListener(i))});this._pingTimeoutTimer=setTimeout(()=>{this.removeMessageListener(i),this._options.connection.reconnect===!1?this._logger.error(`Disconnecting because the last ping took over ${this._pingTimeout} seconds`):this._logger.warn(`Reconnecting because the last ping took over ${this._pingTimeout} seconds`),this._connection.assumeExternalDisconnect()},this._pingTimeout*1e3),this.sendMessage(FU,{text:n})}reconnect(e){this.quit(e),this.connect()}registerMessageType(e){e.COMMAND!==""&&(this._logger.trace(`Registering message type ${e.COMMAND}`),this._registeredMessageTypes.set(e.COMMAND.toUpperCase(),e))}knowsCommand(e){return this._registeredMessageTypes.has(e.toUpperCase())}getCommandClass(e){return this._registeredMessageTypes.get(e.toUpperCase())}acknowledgeJoin(e){this._currentChannels.add(e),this._channelsFromLastRegister.add(e)}connect(){this._supportsCapabilities=!1,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._currentNick=this._desiredNick,this._setupConnection(),this._logger.info(`Connecting to ${this._options.connection.hostName}:${this.port}`),this._connection.connect()}addCapability(e){if(this._clientCapabilities.set(e.name,e),e.messageTypes)for(const n of Object.values(e.messageTypes))this.registerMessageType(n)}async registerCapability(e){return this.addCapability(e),this._serverCapabilities.has(e.name)?await this._negotiateCapabilities([e]):[]}send(e){this.sendRaw(e.toString())}sendRaw(e){this._connection.isConnected&&(this._logger.debug(`Sending message: ${e}`),this._connection.sendLine(e))}onNamedMessage(e,n,i){this._events.has(e)||this._events.set(e,new Map);const r=this._events.get(e);if(!i)do i=`${e}:${rvt(Math.random()*1e4,4,"0")}`;while(r.has(i));return r.set(i,n),i}onTypedMessage(e,n,i){return this.onNamedMessage(e.COMMAND,n,i)}removeMessageListener(e){const[n]=e.split(":");this._events.has(n)&&this._events.get(n).delete(e)}createMessage(e,n,i){const r=i?new Map(Object.entries(i)):void 0;return fyt(e,n,void 0,r,this.serverProperties)}sendMessage(e,n,i){this.send(this.createMessage(e,n,i))}async sendMessageAndCaptureReply(e,n){if(!e.SUPPORTS_CAPTURE)throw new Error(`The command "${e.COMMAND}" does not support reply capture`);const i=this.createMessage(e,n),r=this.collect(i).promise();return this.send(i),await r}get isConnected(){return this._connection.isConnected}get isConnecting(){return this._connection.isConnecting}get isRegistered(){return this._registered}get currentNick(){return this._currentNick}get currentChannels(){return Array.from(this._currentChannels)}collect(e,...n){const i=new Syt(this,e,...n);return this._collectors.push(i),i}stopCollect(e){this._collectors.splice(this._collectors.findIndex(n=>n===e),1)}join(e,n){this.sendMessage(jO,{channel:e,key:n})}part(e){this.sendMessage(VO,{channel:e})}quit(e){this.sendMessage($Y,{text:e}),this.quitAbruptly()}quitAbruptly(){this._registered=!1,this._connection.disconnect()}say(e,n,i={}){this.sendMessage(GO,{target:e,text:n},i)}sendCtcp(e,n,i){this.say(e,`${n.toUpperCase()} ${i}`)}action(e,n){this.sendCtcp(e,"ACTION",n)}changeNick(e){this._currentNick!==e&&(this._desiredNick=e,this.isRegistered&&this.sendMessage(uM,{nick:e}))}registerCoreMessageTypes(){VG(J_e,e=>{this.registerMessageType(e)}),VG(eEe,e=>{this.registerMessageType(e)})}async _negotiateCapabilityBatch(e){return await Promise.all(e.filter(n=>n.length).map(async n=>await this._negotiateCapabilities(n)))}async _negotiateCapabilities(e){const n=OD(e,a=>({[a.name]:a})),r=(await this.sendMessageAndCaptureReply(Df,{subCommand:"REQ",capabilities:e.map(a=>a.name).join(" ")})).shift();if(!r)throw new Error("capability negotiation failed unexpectedly without any reply");if(!(r instanceof Df))throw new Error(`capability negotiation failed unexpectedly with "${r.command}" command`);const s=r.capabilities.split(" ").filter(a=>a);if(r.subCommand==="ACK"){this._logger.debug(`Successfully negotiated capabilities: ${s.join(", ")}`);const a=s.map(o=>n[o]);for(const o of a){const c=this._clientCapabilities.get(o.name);c.param=o.param,this._negotiatedCapabilities.set(c.name,c)}return a}return this._logger.warn(`Failed to negotiate capabilities: ${s.join(", ")}`),new Error("capabilities failed to negotiate")}_setupConnection(){this._initialConnectionSetupDone||(this._connection.onConnect(async()=>{var e,n;this._logger.info(`Connection to server ${this._options.connection.hostName}:${this.port} established`),this.emit(this.onConnect),this._logger.debug("Determining connection password");try{const[i]=await Promise.all([jG(this._options.credentials.password),this.sendMessageAndCaptureReply(Df,{subCommand:"LS",version:"302"}).then(async r=>{if(!r.length||!(r[0]instanceof Df))return this._logger.debug("Server does not support capabilities"),[];this._supportsCapabilities=!0;const s=r.map(o=>OD(o.capabilities.split(" "),c=>{if(!c)return{};const[l,u]=QS(c,"=",2);return{[l]:{name:l,param:u||!0}}}));this._serverCapabilities=new Map(Object.entries(Object.assign({},...s))),this._logger.debug(`Capabilities supported by server: ${Array.from(this._serverCapabilities.keys()).join(", ")}`);const a=s.map(o=>{const c=Object.keys(o);return Array.from(this._clientCapabilities.entries()).filter(([l])=>c.includes(l)).map(([,l])=>l)});return await this._negotiateCapabilityBatch(a)}).then(()=>{this.sendMessage(Df,{subCommand:"END"})})]);i&&this.sendMessage(GY,{password:i}),this.sendMessage(uM,{nick:this._desiredNick}),this.sendMessage(qY,{user:(e=this._userName)!==null&&e!==void 0?e:this._desiredNick,mode:"8",unused:"*",realName:(n=this._realName)!==null&&n!==void 0?n:this._desiredNick})}catch(i){this.emit(this.onPasswordError,i),this.quit()}}),this._initialConnectionSetupDone=!0,this._connection.onReceive(e=>{this.receiveLine(e)}),this._connection.onDisconnect((e,n)=>{var i;if(this._registered=!1,this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),e)this._logger.info("Disconnected");else{const r=(i=this._options.connection.reconnect)!==null&&i!==void 0?i:!0,s=n?`Disconnected unexpectedly: ${n.message}`:"Disconnected unexpectedly";r?this._logger.warn(`${s}; trying to reconnect`):this._logger.error(s)}this.emit(this.onDisconnect,e,n)}),this._connection.onEnd(e=>{e||this._logger.warn("No further retries will be made")}))}_handleReceivedClientNick(e){this._currentNick!==e&&(this._currentNick!==""&&this._logger.warn(`Mismatching nicks: passed ${this._currentNick}, but you're actually ${e}`),this._currentNick=e)}_handleEvents(e){this._collectors.some(i=>i.collect(e));const n=this._events.get(e.constructor.COMMAND);if(n)for(const i of n.values())i(e)}_startPingCheckTimer(){this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._connection.isConnected?this._pingCheckTimer=setTimeout(()=>this.pingCheck(),this._pingOnInactivity*1e3):this._pingCheckTimer=void 0}}aa([rE(!1)],tEe.prototype,"_options",void 0);class QY extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},user:{trailing:!0,optional:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get channelId(){return this._tags.get("room-id")}get targetUserId(){var e;return(e=this._tags.get("target-user-id"))!==null&&e!==void 0?e:null}}QY.COMMAND="CLEARCHAT";class nEe extends zt{}nEe.COMMAND="RECONNECT";class eX extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}eX.COMMAND="ROOMSTATE";function Ryt(t){switch(typeof t){case"undefined":return"";case"object":{if(t===null)return"";if("cacheKey"in t)return t.cacheKey;const e=JSON.stringify(t);if(e!=="{}")return e}default:return t.toString()}}function iEe(t,e,n){return[t,...e.map(Ryt)].join("/")+(n?"/":"")}const _v=Symbol("cache");function Ayt(t){var e,n;return n=class extends t{constructor(){super(...arguments),this[e]=new Map}getFromCache(i){if(this._cleanCache(),this[_v].has(i)){const r=this[_v].get(i);if(r)return r.value}}setCache(i,r,s){this[_v].set(i,{value:r,expires:Date.now()+s*1e3})}removeFromCache(i,r){const s=this._getInternalCacheKey(i,r);r?this[_v].forEach((a,o)=>{o.startsWith(s)&&this[_v].delete(o)}):this[_v].delete(s)}_cleanCache(){const i=Date.now();this[_v].forEach((r,s)=>{r.expires<i&&this[_v].delete(s)})}_getInternalCacheKey(i,r){if(typeof i=="string"){let s=i;return s.endsWith("/")||(s+="/"),s}else{const s=i.shift();return iEe(s,i,r)}}},e=_v,n}function rEe(t=1/0){return function(e,n,i){if(i.get){const r=i.get;i.get=function(){const s=iEe(n,[]),a=this.getFromCache(s);if(a)return a;const o=r.call(this);return this.setCache(s,o,t),o}}return i}}var FP;let Pb=FP=class{constructor(e,n){this._userName=e.toLowerCase(),this._userData=n?new Map(n):new Map}static _parseBadgesLike(e){return e?new Map(e.split(",").map(n=>{const i=n.indexOf("/");return i===-1?[n,""]:[n.slice(0,i),n.slice(i+1)]})):new Map}get userName(){return this._userName}get displayName(){var e;return(e=this._userData.get("display-name"))!==null&&e!==void 0?e:this._userName}get color(){return this._userData.get("color")}get badges(){const e=this._userData.get("badges");return FP._parseBadgesLike(e)}get badgeInfo(){const e=this._userData.get("badge-info");return FP._parseBadgesLike(e)}get userId(){return this._userData.get("user-id")}get userType(){return this._userData.get("user-type")}get isBroadcaster(){return this.badges.has("broadcaster")}get isSubscriber(){return this.badges.has("subscriber")||this.isFounder}get isFounder(){return this.badges.has("founder")}get isMod(){return this.badges.has("moderator")}get isVip(){const e=this._userData.get("vip");return e!=null&&e!=="0"}get isArtist(){return this.badges.has("artist-badge")}};aa([rE(!1)],Pb.prototype,"_userData",void 0);aa([rEe()],Pb.prototype,"badges",null);aa([rEe()],Pb.prototype,"badgeInfo",null);Pb=FP=aa([Ayt,OI("chat","ChatUser","userId")],Pb);function tX(t){return t?new Map(t.split("/").map(e=>{const[n,i]=e.split(":",2);return i?[n,i.split(",")]:null}).filter(e=>e!==null)):new Map}class nX extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0,optional:!0}})}get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new Pb(this._tags.get("login"),this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get emoteOffsets(){return tX(this._tags.get("emotes"))}}nX.COMMAND="USERNOTICE";class sEe extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"}})}}sEe.COMMAND="USERSTATE";class iX extends zt{constructor(e,n,i){super(e,n,i,{target:{},text:{trailing:!0}})}get userInfo(){return new Pb(this._prefix.nick,this._tags)}get emoteOffsets(){return tX(this._tags.get("emotes"))}}iX.COMMAND="WHISPER";const Myt={name:"twitch.tv/commands",messageTypes:[QY,nEe,eX,nX,sEe,iX]},Oyt={name:"twitch.tv/membership"};class rX extends zt{constructor(e,n,i){super(e,n,i,{channel:{type:"channel"},text:{trailing:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userName(){return this._tags.get("login")}get channelId(){return this._tags.get("room-id")}get targetMessageId(){return this._tags.get("target-msg-id")}}rX.COMMAND="CLEARMSG";class aEe extends zt{}aEe.COMMAND="GLOBALUSERSTATE";const Nyt={name:"twitch.tv/tags",messageTypes:[aEe,rX]},Iyt=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN"];let HU=class extends GO{get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new Pb(this._prefix.nick,this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get isCheer(){return this._tags.has("bits")}get isRedemption(){return!!this._tags.get("custom-reward-id")}get rewardId(){return this._tags.get("custom-reward-id")||null}get isFirst(){return this._tags.get("first-msg")==="1"}get isReturningChatter(){return this._tags.get("returning-chatter")==="1"}get isHighlight(){return this._tags.get("msg-id")==="highlighted-message"}get isReply(){return this._tags.has("reply-parent-msg-id")}get parentMessageId(){var e;return(e=this._tags.get("reply-parent-msg-id"))!==null&&e!==void 0?e:null}get parentMessageText(){var e;return(e=this._tags.get("reply-parent-msg-body"))!==null&&e!==void 0?e:null}get parentMessageUserId(){var e;return(e=this._tags.get("reply-parent-user-id"))!==null&&e!==void 0?e:null}get parentMessageUserName(){var e;return(e=this._tags.get("reply-parent-user-login"))!==null&&e!==void 0?e:null}get parentMessageUserDisplayName(){var e;return(e=this._tags.get("reply-parent-display-name"))!==null&&e!==void 0?e:null}get threadMessageId(){var e;return(e=this._tags.get("reply-thread-parent-msg-id"))!==null&&e!==void 0?e:null}get threadMessageUserId(){var e;return(e=this._tags.get("reply-thread-parent-user-id"))!==null&&e!==void 0?e:null}get bits(){var e;return Number((e=this._tags.get("bits"))!==null&&e!==void 0?e:0)}get emoteOffsets(){return tX(this._tags.get("emotes"))}get isHypeChat(){return this._tags.has("pinned-chat-paid-amount")}get hypeChatAmount(){return zO(this._tags.get("pinned-chat-paid-amount"),Number)}get hypeChatDecimalPlaces(){return zO(this._tags.get("pinned-chat-paid-exponent"),Number)}get hypeChatLocalizedAmount(){const e=this.hypeChatAmount;return e?e/10**this.hypeChatDecimalPlaces:null}get hypeChatCurrency(){var e;return(e=this._tags.get("pinned-chat-paid-currency"))!==null&&e!==void 0?e:null}get hypeChatLevel(){const e=this._tags.get("pinned-chat-paid-level");return e?Iyt.indexOf(e)+1:null}get hypeChatIsSystemMessage(){const e=this._tags.get("pinned-chat-paid-is-system-message");return e?!!Number(e):null}};HU=aa([OI("chat","ChatMessage","id")],HU);function kyt(t){return t instanceof HU?t.tags.get("id"):t}function cre(t,e){if(t.length<=e)return[t];t=t.trim();const n=[];let i=0,r=e;for(;i<t.length;){let s=t.lastIndexOf(" ",r);(s===-1||s<=i||t.length-i+1<=e)&&(s=i+e);const a=t.slice(i,s).trim();a.length&&n.push(a),i=s+(t[s]===" "?1:0),r=i+e}return n}const Dyt=/^[a-z0-9][a-z0-9_]{0,24}$/;function xc(t){const e=t.replace(/^#/,"").toLowerCase();if(!Dyt.test(e))throw new Error(`"${e}" is not a valid user or channel name. It must be at most 25 characters long, can only include letters, numbers and underscores, and can not start with an underscore.`);return e}function ND(t){return`#${xc(t)}`}var KG;let jU=KG=class extends MI{constructor(e={}){var n,i,r,s,a;if(e.authProvider&&!e.authProvider.getAccessTokenForIntent)throw new UP("You can not connect to chat using an AuthProvider that does not support intents.\nTo get an anonymous, read-only connection, please don't pass an `AuthProvider` at all.\nTo get a read-write connection, please provide an auth provider that provides user access tokens via intents, such as `RefreshingAuthProvider`.");super(),this._authVerified=!1,this._authRetryCount=0,this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onTimeout=this.registerEvent(),this.onBan=this.registerEvent(),this.onBitsBadgeUpgrade=this.registerEvent(),this.onChatClear=this.registerEvent(),this.onEmoteOnly=this.registerEvent(),this.onFollowersOnly=this.registerEvent(),this.onJoin=this.registerEvent(),this.onJoinFailure=this.registerEvent(),this.onPart=this.registerEvent(),this.onMessageRemove=this.registerEvent(),this.onUniqueChat=this.registerEvent(),this.onRaid=this.registerEvent(),this.onRaidCancel=this.registerEvent(),this.onRitual=this.registerEvent(),this.onSlow=this.registerEvent(),this.onSubsOnly=this.registerEvent(),this.onSub=this.registerEvent(),this.onResub=this.registerEvent(),this.onSubGift=this.registerEvent(),this.onCommunitySub=this.registerEvent(),this.onSubExtend=this.registerEvent(),this.onRewardGift=this.registerEvent(),this.onPrimePaidUpgrade=this.registerEvent(),this.onGiftPaidUpgrade=this.registerEvent(),this.onPrimeCommunityGift=this.registerEvent(),this.onStandardPayForward=this.registerEvent(),this.onCommunityPayForward=this.registerEvent(),this.onAnnouncement=this.registerEvent(),this.onWhisper=this.registerEvent(),this.onNoPermission=this.registerEvent(),this.onMessageRatelimit=this.registerEvent(),this.onAuthenticationSuccess=this.registerEvent(),this.onAuthenticationFailure=this.registerEvent(),this.onTokenFetchFailure=this.registerEvent(),this.onMessageFailed=this.registerEvent(),this.onMessage=this.registerEvent(),this.onAction=this.registerEvent(),this._onJoinResult=this.registerInternalEvent(),this._ircClient=new tEe({connection:{hostName:(n=e.hostName)!==null&&n!==void 0?n:!((i=e.webSocket)!==null&&i!==void 0)||i?"irc-ws.chat.twitch.tv":"irc.chat.twitch.tv",secure:(r=e.ssl)!==null&&r!==void 0?r:!0},credentials:{nick:"",password:async()=>await this._getAuthToken()},webSocket:(s=e.webSocket)!==null&&s!==void 0?s:!0,connectionOptions:e.connectionOptions,logger:{name:"twurple:chat:irc",...e.logger},nonConformingCommands:["004"],manuallyAcknowledgeJoins:!0,rejoinChannelsOnReconnect:e.rejoinChannelsOnReconnect}),this._ircClient.onDisconnect((l,u)=>{this._messageRateLimiter.clear(),this._messageRateLimiter.pause(),this._joinRateLimiter.clear(),this._joinRateLimiter.pause(),this.emit(this.onDisconnect,l,u)}),this._ircClient.registerMessageType(HU),this._chatLogger=K6({name:"twurple:chat:twitch",...e.logger}),this._authProvider=e.authProvider,this._useLegacyScopes=!!e.legacyScopes,this._readOnly=!!e.readOnly,this._authIntents=[...(a=e.authIntents)!==null&&a!==void 0?a:[],"chat"];const o=async({type:l,text:u,channel:h,tags:d})=>{l==="say"?this._ircClient.say(h,u,d):this._ircClient.action(h,u)},c=async l=>{const{promise:u,resolve:h,reject:d}=GG();let f;const p=this.addInternalListener(this._onJoinResult,(g,_,v)=>{g===l&&(clearTimeout(f),v?d(v):h(),this.removeListener(p))});f=setTimeout(()=>{this.removeListener(p),this.emit(this._onJoinResult,l,void 0,"twurple_timeout"),d(new Error(`Did not receive a reply to join ${l} in time; assuming that the join failed`))},1e4),this._ircClient.join(l),await u};if(e.isAlwaysMod)this._messageRateLimiter=new qG({bucketSize:e.botLevel==="verified"?7500:100,timeFrame:32e3,doRequest:o});else{let l=20;e.botLevel==="verified"?l=7500:e.botLevel==="known"&&(l=50),this._messageRateLimiter=new gvt(new mvt({bucketSize:1,timeFrame:1200,logger:{minLevel:pi.ERROR},doRequest:o,getPartitionKey:({channel:u})=>u}),{bucketSize:l,timeFrame:32e3})}this._joinRateLimiter=new qG({bucketSize:e.botLevel==="verified"?2e3:20,timeFrame:11e3,doRequest:c}),this._messageRateLimiter.pause(),this._joinRateLimiter.pause(),this._ircClient.addCapability(Nyt),this._ircClient.addCapability(Myt),e.requestMembershipEvents&&this._ircClient.addCapability(Oyt),this._ircClient.onConnect(()=>{this.emit(this.onConnect)}),this._ircClient.onRegister(async()=>{this._messageRateLimiter.resume(),this._joinRateLimiter.resume(),this._authVerified=!0,this._authRetryTimer=void 0,this._authRetryCount=0,this.emit(this.onAuthenticationSuccess);const l=await jG(e.channels);l&&await Promise.all(l.map(async u=>{var h;try{await this.join(u)}catch(d){this._chatLogger.warn(`Failed to join configured channel ${u}; original message: ${(h=d==null?void 0:d.message)!==null&&h!==void 0?h:d}`)}}))}),this._ircClient.onPasswordError(l=>{this._chatLogger.error(`Error fetching a token for connecting to the server: ${l.message}`),this.emit(this.onTokenFetchFailure,l)}),this._ircClient.onPrivmsg((l,u,h,d)=>{u!=="jtv"&&this.emit(this.onMessage,xc(l),u,h,d)}),this._ircClient.onAction((l,u,h,d)=>{this.emit(this.onAction,xc(l),u,h,d)}),this.addInternalListener(this._onJoinResult,(l,u,h)=>{h?this.emit(this.onJoinFailure,xc(l),h):this._ircClient.acknowledgeJoin(l)}),this._ircClient.onTypedMessage(QY,l=>{const{channel:u,user:h,tags:d}=l,f=xc(u);if(h){const p=d.get("ban-duration");p===void 0?this.emit(this.onBan,f,h,l):this.emit(this.onTimeout,f,h,Number(p),l)}else this.emit(this.onChatClear,f,l)}),this._ircClient.onTypedMessage(rX,l=>{const{channel:u,targetMessageId:h}=l;this.emit(this.onMessageRemove,xc(u),h,l)}),this._ircClient.onTypedMessage(jO,({prefix:l,channel:u})=>{this.emit(this.onJoin,xc(u),l.nick)}),this._ircClient.onTypedMessage(VO,({prefix:l,channel:u})=>{this.emit(this.onPart,xc(u),l.nick)}),this._ircClient.onTypedMessage(eX,({channel:l,tags:u})=>{let h=!1;if(u.has("subs-only")&&u.has("slow")&&(this.emit(this._onJoinResult,l,u),h=!0),!h){const d=xc(l);if(u.has("slow")){const f=Number(u.get("slow"));f?this.emit(this.onSlow,d,!0,f):this.emit(this.onSlow,d,!1)}if(u.has("followers-only")){const f=Number(u.get("followers-only"));f===-1?this.emit(this.onFollowersOnly,d,!1):this.emit(this.onFollowersOnly,d,!0,f)}}}),this._ircClient.onTypedMessage(nX,l=>{const{channel:u,text:h,tags:d}=l,f=d.get("msg-id"),p=xc(u);switch(f){case"sub":case"resub":{const g=f==="sub"?this.onSub:this.onResub,_=d.get("msg-param-sub-plan"),v=d.get("msg-param-streak-months"),E={userId:d.get("user-id"),displayName:d.get("display-name"),plan:_,planName:d.get("msg-param-sub-plan-name"),isPrime:_==="Prime",months:Number(d.get("msg-param-cumulative-months")),streak:v?Number(v):void 0,message:h};if(d.get("msg-param-was-gifted")==="true"){const x=d.get("msg-param-anon-gift")==="true",N=Number(d.get("msg-param-gift-months")),A=Number(d.get("msg-param-gift-month-being-redeemed"));x?E.originalGiftInfo={anonymous:!0,duration:N,redeemedMonth:A}:E.originalGiftInfo={anonymous:!1,duration:N,redeemedMonth:A,userId:d.get("msg-param-gifter-id"),userName:d.get("msg-param-gifter-login"),userDisplayName:d.get("msg-param-gifter-name")}}this.emit(g,p,d.get("login"),E,l);break}case"subgift":{const g=d.get("msg-param-sub-plan"),_=d.get("login"),v=_==="ananonymousgifter",E={userId:d.get("msg-param-recipient-id"),displayName:d.get("msg-param-recipient-display-name"),gifter:v?void 0:_,gifterUserId:v?void 0:d.get("user-id"),gifterDisplayName:v?void 0:d.get("display-name"),gifterGiftCount:v?void 0:Number(d.get("msg-param-sender-count")),giftDuration:Number(d.get("msg-param-gift-months")),plan:g,planName:d.get("msg-param-sub-plan-name"),isPrime:g==="Prime",months:Number(d.get("msg-param-months"))};this.emit(this.onSubGift,p,d.get("msg-param-recipient-user-name"),E,l);break}case"submysterygift":{const g=d.get("login"),_=g==="ananonymousgifter",v={gifter:_?void 0:g,gifterUserId:_?void 0:d.get("user-id"),gifterDisplayName:_?void 0:d.get("display-name"),gifterGiftCount:_?void 0:Number(d.get("msg-param-sender-count")),count:Number(d.get("msg-param-mass-gift-count")),plan:d.get("msg-param-sub-plan")};this.emit(this.onCommunitySub,p,d.get("login"),v,l);break}case"primepaidupgrade":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan")};this.emit(this.onPrimePaidUpgrade,p,d.get("login"),g,l);break}case"giftpaidupgrade":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),gifter:d.get("msg-param-sender-login"),gifterDisplayName:d.get("msg-param-sender-name")};this.emit(this.onGiftPaidUpgrade,p,d.get("login"),g,l);break}case"standardpayforward":{const g=d.get("msg-param-prior-gifter-anonymous")==="true",_={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:g?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:d.get("msg-param-prior-gifter-display-name"),recipientUserId:d.get("msg-param-recipient-id"),recipientDisplayName:d.get("msg-param-recipient-display-name")};this.emit(this.onStandardPayForward,p,d.get("login"),_,l);break}case"communitypayforward":{const g=d.get("msg-param-prior-gifter-anonymous")==="true",_={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:g?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:g?void 0:d.get("msg-param-prior-gifter-display-name")};this.emit(this.onCommunityPayForward,p,d.get("login"),_,l);break}case"primecommunitygiftreceived":{const g={name:d.get("msg-param-gift-name"),gifter:d.get("login"),gifterDisplayName:d.get("display-name")};this.emit(this.onPrimeCommunityGift,p,d.get("msg-param-recipient"),g,l);break}case"raid":{const g={displayName:d.get("msg-param-displayName"),viewerCount:Number(d.get("msg-param-viewerCount"))};this.emit(this.onRaid,p,d.get("login"),g,l);break}case"unraid":{this.emit(this.onRaidCancel,p,l);break}case"ritual":{const g={ritualName:d.get("msg-param-ritual-name"),message:h};this.emit(this.onRitual,p,d.get("login"),g,l);break}case"bitsbadgetier":{const g={displayName:d.get("display-name"),threshold:Number(d.get("msg-param-threshold"))};this.emit(this.onBitsBadgeUpgrade,p,d.get("login"),g,l);break}case"extendsub":{const g={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan"),months:Number(d.get("msg-param-cumulative-months")),endMonth:Number(d.get("msg-param-sub-benefit-end-month"))};this.emit(this.onSubExtend,p,d.get("login"),g,l);break}case"rewardgift":{const g={domain:d.get("msg-param-domain"),gifterId:d.get("user-id"),gifterDisplayName:d.get("display-name"),count:Number(d.get("msg-param-selected-count")),gifterGiftCount:Number(d.get("msg-param-total-reward-count")),triggerType:d.get("msg-param-trigger-type")};this.emit(this.onRewardGift,p,d.get("login"),g,l);break}case"announcement":{const g={color:d.get("msg-param-color")};this.emit(this.onAnnouncement,p,d.get("login"),g,l);break}default:this._chatLogger.warn(`Unrecognized usernotice ID: ${f}`)}}),this._ircClient.onTypedMessage(iX,l=>{this.emit(this.onWhisper,l.prefix.nick,l.text,l)}),this._ircClient.onTypedMessage(Z6,async({target:l,text:u,tags:h})=>{const d=h.get("msg-id");switch(d){case"emote_only_on":{this.emit(this.onEmoteOnly,xc(l),!0);break}case"emote_only_off":{this.emit(this.onEmoteOnly,xc(l),!1);break}case"msg_channel_suspended":case"msg_banned":{this.emit(this._onJoinResult,l,void 0,d);break}case"r9k_on":{this.emit(this.onUniqueChat,xc(l),!0);break}case"r9k_off":{this.emit(this.onUniqueChat,xc(l),!1);break}case"subs_on":{this.emit(this.onSubsOnly,xc(l),!0);break}case"subs_off":{this.emit(this.onSubsOnly,xc(l),!1);break}case"cmds_available":break;case"followers_on":case"followers_on_zero":case"followers_off":case"slow_on":case"slow_off":break;case"timeout_success":break;case"unrecognized_cmd":break;case"no_permission":{this.emit(this.onNoPermission,xc(l),u);break}case"msg_ratelimit":{this.emit(this.onMessageRatelimit,xc(l),u);break}case"msg_duplicate":case"msg_emoteonly":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_subsonly":case"msg_slowmode":case"msg_r9k":case"msg_verified_email":case"msg_timedout":case"msg_rejected_mandatory":case"msg_channel_blocked":{this.emit(this.onMessageFailed,xc(l),d);break}case void 0:{if(u==="Login authentication failed"||u==="Improperly formatted AUTH"||u==="Invalid NICK"){this._authVerified=!1,this._authRetryTimer||(this._authRetryTimer=g_e(120),this._authRetryCount=0);const f=this._authRetryTimer.next().value,p=++this._authRetryCount;this.emit(this.onAuthenticationFailure,u,p),f!==0&&this._chatLogger.info(`Retrying authentication in ${f} seconds`),await ivt(f*1e3),this._ircClient.reconnect()}break}default:d.startsWith("usage_")||this._chatLogger.warn(`Unrecognized notice ID: '${d}'`)}})}connect(){this._authProvider||this._ircClient.changeNick(KG._generateJustinfanNick()),this._ircClient.connect()}get irc(){return this._ircClient}get isConnected(){return this._ircClient.isConnected}get isConnecting(){return this._ircClient.isConnecting}get currentChannels(){return this._ircClient.currentChannels}async say(e,n,i={},r){const s={};i.replyTo&&(s["reply-parent-msg-id"]=kyt(i.replyTo));const a=cre(n,500);await Promise.all(a.map(async o=>await this._messageRateLimiter.request({type:"say",channel:ND(e),text:o,tags:s},r)))}async action(e,n,i){const r=cre(n,490);await Promise.all(r.map(async s=>await this._messageRateLimiter.request({type:"action",channel:ND(e),text:s},i)))}async join(e){await this._joinRateLimiter.request(ND(e))}part(e){this._ircClient.part(ND(e))}quit(){this._ircClient.quitAbruptly()}reconnect(){this.quit(),this.connect()}async _getAuthToken(){var e,n;if(!this._authProvider){this._chatLogger.debug("No authProvider given; connecting anonymously");return}if(this._authToken&&!LP(this._authToken)&&this._authVerified)return this._chatLogger.debug("AccessToken assumed to be correct from last connection"),`oauth:${this._authToken.accessToken}`;const i=this._getNecessaryScopes();let r,s=!1;for(const a of this._authIntents){try{if(this._authToken=await this._authProvider.getAccessTokenForIntent(a,i),!this._authToken)continue;s=!0;const o=await HO(this._authToken.accessToken);if(!o.userName)throw new UP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}catch(o){o instanceof Ow?r=o:this._chatLogger.error(`Retrieving an access token failed: ${o.message}`)}this._chatLogger.warn("No valid token available; trying to refresh");try{if(this._authToken=await((n=(e=this._authProvider).refreshAccessTokenForIntent)===null||n===void 0?void 0:n.call(e,a)),this._authToken){const o=await HO(this._authToken.accessToken);if(!o.userName)throw new UP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}}catch(o){o instanceof Ow?r=o:this._chatLogger.error(`Refreshing the access token failed: ${o.message}`)}}throw this._authVerified=!1,r??new Error(s?"Could not retrieve a valid token":`None of the queried intents (${this._authIntents.join(", ")}) are known by the auth provider${this._authProvider instanceof Db?".\nPlease add one of these to the user you want to connect with using the `addIntentToUser` method or the additional parameter to `addUser` or `addUserForToken`.":""}`)}_getNecessaryScopes(){return this._useLegacyScopes?["chat_login"]:this._readOnly?["chat:read"]:["chat:read","chat:edit"]}static _generateJustinfanNick(){return`justinfan${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}`}};aa([rE(!1)],jU.prototype,"_authProvider",void 0);jU=KG=aa([OI("chat","ChatClient")],jU);var oEe={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={9669:(a,o,c)=>{a.exports=c(1609)},5448:(a,o,c)=>{var l=c(4867),u=c(6026),h=c(4372),d=c(5327),f=c(4097),p=c(4109),g=c(7985),_=c(7874),v=c(2648),E=c(644),T=c(205);a.exports=function(x){return new Promise(function(N,A){var I,k=x.data,L=x.headers,U=x.responseType;function $(){x.cancelToken&&x.cancelToken.unsubscribe(I),x.signal&&x.signal.removeEventListener("abort",I)}l.isFormData(k)&&l.isStandardBrowserEnv()&&delete L["Content-Type"];var q=new XMLHttpRequest;if(x.auth){var G=x.auth.username||"",X=x.auth.password?unescape(encodeURIComponent(x.auth.password)):"";L.Authorization="Basic "+btoa(G+":"+X)}var ie=f(x.baseURL,x.url);function V(){if(q){var ee="getAllResponseHeaders"in q?p(q.getAllResponseHeaders()):null,oe={data:U&&U!=="text"&&U!=="json"?q.response:q.responseText,status:q.status,statusText:q.statusText,headers:ee,config:x,request:q};u(function(de){N(de),$()},function(de){A(de),$()},oe),q=null}}if(q.open(x.method.toUpperCase(),d(ie,x.params,x.paramsSerializer),!0),q.timeout=x.timeout,"onloadend"in q?q.onloadend=V:q.onreadystatechange=function(){q&&q.readyState===4&&(q.status!==0||q.responseURL&&q.responseURL.indexOf("file:")===0)&&setTimeout(V)},q.onabort=function(){q&&(A(new v("Request aborted",v.ECONNABORTED,x,q)),q=null)},q.onerror=function(){A(new v("Network Error",v.ERR_NETWORK,x,q,q)),q=null},q.ontimeout=function(){var ee=x.timeout?"timeout of "+x.timeout+"ms exceeded":"timeout exceeded",oe=x.transitional||_;x.timeoutErrorMessage&&(ee=x.timeoutErrorMessage),A(new v(ee,oe.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,x,q)),q=null},l.isStandardBrowserEnv()){var Z=(x.withCredentials||g(ie))&&x.xsrfCookieName?h.read(x.xsrfCookieName):void 0;Z&&(L[x.xsrfHeaderName]=Z)}"setRequestHeader"in q&&l.forEach(L,function(ee,oe){k===void 0&&oe.toLowerCase()==="content-type"?delete L[oe]:q.setRequestHeader(oe,ee)}),l.isUndefined(x.withCredentials)||(q.withCredentials=!!x.withCredentials),U&&U!=="json"&&(q.responseType=x.responseType),typeof x.onDownloadProgress=="function"&&q.addEventListener("progress",x.onDownloadProgress),typeof x.onUploadProgress=="function"&&q.upload&&q.upload.addEventListener("progress",x.onUploadProgress),(x.cancelToken||x.signal)&&(I=function(ee){q&&(A(!ee||ee&&ee.type?new E:ee),q.abort(),q=null)},x.cancelToken&&x.cancelToken.subscribe(I),x.signal&&(x.signal.aborted?I():x.signal.addEventListener("abort",I))),k||(k=null);var Y=T(ie);Y&&["http","https","file"].indexOf(Y)===-1?A(new v("Unsupported protocol "+Y+":",v.ERR_BAD_REQUEST,x)):q.send(k)})}},1609:(a,o,c)=>{var l=c(4867),u=c(1849),h=c(321),d=c(7185),f=function p(g){var _=new h(g),v=u(h.prototype.request,_);return l.extend(v,h.prototype,_),l.extend(v,_),v.create=function(E){return p(d(g,E))},v}(c(5546));f.Axios=h,f.CanceledError=c(644),f.CancelToken=c(4972),f.isCancel=c(6502),f.VERSION=c(7288).version,f.toFormData=c(7675),f.AxiosError=c(2648),f.Cancel=f.CanceledError,f.all=function(p){return Promise.all(p)},f.spread=c(8713),f.isAxiosError=c(6268),a.exports=f,a.exports.default=f},4972:(a,o,c)=>{var l=c(644);function u(h){if(typeof h!="function")throw new TypeError("executor must be a function.");var d;this.promise=new Promise(function(p){d=p});var f=this;this.promise.then(function(p){if(f._listeners){var g,_=f._listeners.length;for(g=0;g<_;g++)f._listeners[g](p);f._listeners=null}}),this.promise.then=function(p){var g,_=new Promise(function(v){f.subscribe(v),g=v}).then(p);return _.cancel=function(){f.unsubscribe(g)},_},h(function(p){f.reason||(f.reason=new l(p),d(f.reason))})}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.prototype.subscribe=function(h){this.reason?h(this.reason):this._listeners?this._listeners.push(h):this._listeners=[h]},u.prototype.unsubscribe=function(h){if(this._listeners){var d=this._listeners.indexOf(h);d!==-1&&this._listeners.splice(d,1)}},u.source=function(){var h;return{token:new u(function(d){h=d}),cancel:h}},a.exports=u},644:(a,o,c)=>{var l=c(2648);function u(h){l.call(this,h??"canceled",l.ERR_CANCELED),this.name="CanceledError"}c(4867).inherits(u,l,{__CANCEL__:!0}),a.exports=u},6502:a=>{a.exports=function(o){return!(!o||!o.__CANCEL__)}},321:(a,o,c)=>{var l=c(4867),u=c(5327),h=c(782),d=c(3572),f=c(7185),p=c(4097),g=c(4875),_=g.validators;function v(E){this.defaults=E,this.interceptors={request:new h,response:new h}}v.prototype.request=function(E,T){typeof E=="string"?(T=T||{}).url=E:T=E||{},(T=f(this.defaults,T)).method?T.method=T.method.toLowerCase():this.defaults.method?T.method=this.defaults.method.toLowerCase():T.method="get";var x=T.transitional;x!==void 0&&g.assertOptions(x,{silentJSONParsing:_.transitional(_.boolean),forcedJSONParsing:_.transitional(_.boolean),clarifyTimeoutError:_.transitional(_.boolean)},!1);var N=[],A=!0;this.interceptors.request.forEach(function(G){typeof G.runWhen=="function"&&G.runWhen(T)===!1||(A=A&&G.synchronous,N.unshift(G.fulfilled,G.rejected))});var I,k=[];if(this.interceptors.response.forEach(function(G){k.push(G.fulfilled,G.rejected)}),!A){var L=[d,void 0];for(Array.prototype.unshift.apply(L,N),L=L.concat(k),I=Promise.resolve(T);L.length;)I=I.then(L.shift(),L.shift());return I}for(var U=T;N.length;){var $=N.shift(),q=N.shift();try{U=$(U)}catch(G){q(G);break}}try{I=d(U)}catch(G){return Promise.reject(G)}for(;k.length;)I=I.then(k.shift(),k.shift());return I},v.prototype.getUri=function(E){E=f(this.defaults,E);var T=p(E.baseURL,E.url);return u(T,E.params,E.paramsSerializer)},l.forEach(["delete","get","head","options"],function(E){v.prototype[E]=function(T,x){return this.request(f(x||{},{method:E,url:T,data:(x||{}).data}))}}),l.forEach(["post","put","patch"],function(E){function T(x){return function(N,A,I){return this.request(f(I||{},{method:E,headers:x?{"Content-Type":"multipart/form-data"}:{},url:N,data:A}))}}v.prototype[E]=T(),v.prototype[E+"Form"]=T(!0)}),a.exports=v},2648:(a,o,c)=>{var l=c(4867);function u(f,p,g,_,v){Error.call(this),this.message=f,this.name="AxiosError",p&&(this.code=p),g&&(this.config=g),_&&(this.request=_),v&&(this.response=v)}l.inherits(u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var h=u.prototype,d={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach(function(f){d[f]={value:f}}),Object.defineProperties(u,d),Object.defineProperty(h,"isAxiosError",{value:!0}),u.from=function(f,p,g,_,v,E){var T=Object.create(h);return l.toFlatObject(f,T,function(x){return x!==Error.prototype}),u.call(T,f.message,p,g,_,v),T.name=f.name,E&&Object.assign(T,E),T},a.exports=u},782:(a,o,c)=>{var l=c(4867);function u(){this.handlers=[]}u.prototype.use=function(h,d,f){return this.handlers.push({fulfilled:h,rejected:d,synchronous:!!f&&f.synchronous,runWhen:f?f.runWhen:null}),this.handlers.length-1},u.prototype.eject=function(h){this.handlers[h]&&(this.handlers[h]=null)},u.prototype.forEach=function(h){l.forEach(this.handlers,function(d){d!==null&&h(d)})},a.exports=u},4097:(a,o,c)=>{var l=c(1793),u=c(7303);a.exports=function(h,d){return h&&!l(d)?u(h,d):d}},3572:(a,o,c)=>{var l=c(4867),u=c(8527),h=c(6502),d=c(5546),f=c(644);function p(g){if(g.cancelToken&&g.cancelToken.throwIfRequested(),g.signal&&g.signal.aborted)throw new f}a.exports=function(g){return p(g),g.headers=g.headers||{},g.data=u.call(g,g.data,g.headers,g.transformRequest),g.headers=l.merge(g.headers.common||{},g.headers[g.method]||{},g.headers),l.forEach(["delete","get","head","post","put","patch","common"],function(_){delete g.headers[_]}),(g.adapter||d.adapter)(g).then(function(_){return p(g),_.data=u.call(g,_.data,_.headers,g.transformResponse),_},function(_){return h(_)||(p(g),_&&_.response&&(_.response.data=u.call(g,_.response.data,_.response.headers,g.transformResponse))),Promise.reject(_)})}},7185:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||{};var d={};function f(T,x){return l.isPlainObject(T)&&l.isPlainObject(x)?l.merge(T,x):l.isPlainObject(x)?l.merge({},x):l.isArray(x)?x.slice():x}function p(T){return l.isUndefined(h[T])?l.isUndefined(u[T])?void 0:f(void 0,u[T]):f(u[T],h[T])}function g(T){if(!l.isUndefined(h[T]))return f(void 0,h[T])}function _(T){return l.isUndefined(h[T])?l.isUndefined(u[T])?void 0:f(void 0,u[T]):f(void 0,h[T])}function v(T){return T in h?f(u[T],h[T]):T in u?f(void 0,u[T]):void 0}var E={url:g,method:g,data:g,baseURL:_,transformRequest:_,transformResponse:_,paramsSerializer:_,timeout:_,timeoutMessage:_,withCredentials:_,adapter:_,responseType:_,xsrfCookieName:_,xsrfHeaderName:_,onUploadProgress:_,onDownloadProgress:_,decompress:_,maxContentLength:_,maxBodyLength:_,beforeRedirect:_,transport:_,httpAgent:_,httpsAgent:_,cancelToken:_,socketPath:_,responseEncoding:_,validateStatus:v};return l.forEach(Object.keys(u).concat(Object.keys(h)),function(T){var x=E[T]||p,N=x(T);l.isUndefined(N)&&x!==v||(d[T]=N)}),d}},6026:(a,o,c)=>{var l=c(2648);a.exports=function(u,h,d){var f=d.config.validateStatus;d.status&&f&&!f(d.status)?h(new l("Request failed with status code "+d.status,[l.ERR_BAD_REQUEST,l.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d)):u(d)}},8527:(a,o,c)=>{var l=c(4867),u=c(5546);a.exports=function(h,d,f){var p=this||u;return l.forEach(f,function(g){h=g.call(p,h,d)}),h}},5546:(a,o,c)=>{var l=c(4867),u=c(6016),h=c(2648),d=c(7874),f=c(7675),p={"Content-Type":"application/x-www-form-urlencoded"};function g(E,T){!l.isUndefined(E)&&l.isUndefined(E["Content-Type"])&&(E["Content-Type"]=T)}var _,v={transitional:d,adapter:((typeof XMLHttpRequest<"u"||typeof zn<"u"&&Object.prototype.toString.call(zn)==="[object process]")&&(_=c(5448)),_),transformRequest:[function(E,T){if(u(T,"Accept"),u(T,"Content-Type"),l.isFormData(E)||l.isArrayBuffer(E)||l.isBuffer(E)||l.isStream(E)||l.isFile(E)||l.isBlob(E))return E;if(l.isArrayBufferView(E))return E.buffer;if(l.isURLSearchParams(E))return g(T,"application/x-www-form-urlencoded;charset=utf-8"),E.toString();var x,N=l.isObject(E),A=T&&T["Content-Type"];if((x=l.isFileList(E))||N&&A==="multipart/form-data"){var I=this.env&&this.env.FormData;return f(x?{"files[]":E}:E,I&&new I)}return N||A==="application/json"?(g(T,"application/json"),function(k,L,U){if(l.isString(k))try{return(L||JSON.parse)(k),l.trim(k)}catch($){if($.name!=="SyntaxError")throw $}return(0,JSON.stringify)(k)}(E)):E}],transformResponse:[function(E){var T=this.transitional||v.transitional,x=T&&T.silentJSONParsing,N=T&&T.forcedJSONParsing,A=!x&&this.responseType==="json";if(A||N&&l.isString(E)&&E.length)try{return JSON.parse(E)}catch(I){if(A)throw I.name==="SyntaxError"?h.from(I,h.ERR_BAD_RESPONSE,this,null,this.response):I}return E}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:c(1623)},validateStatus:function(E){return E>=200&&E<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};l.forEach(["delete","get","head"],function(E){v.headers[E]={}}),l.forEach(["post","put","patch"],function(E){v.headers[E]=l.merge(p)}),a.exports=v},7874:a=>{a.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},7288:a=>{a.exports={version:"0.27.2"}},1849:a=>{a.exports=function(o,c){return function(){for(var l=new Array(arguments.length),u=0;u<l.length;u++)l[u]=arguments[u];return o.apply(c,l)}}},5327:(a,o,c)=>{var l=c(4867);function u(h){return encodeURIComponent(h).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}a.exports=function(h,d,f){if(!d)return h;var p;if(f)p=f(d);else if(l.isURLSearchParams(d))p=d.toString();else{var g=[];l.forEach(d,function(v,E){v!=null&&(l.isArray(v)?E+="[]":v=[v],l.forEach(v,function(T){l.isDate(T)?T=T.toISOString():l.isObject(T)&&(T=JSON.stringify(T)),g.push(u(E)+"="+u(T))}))}),p=g.join("&")}if(p){var _=h.indexOf("#");_!==-1&&(h=h.slice(0,_)),h+=(h.indexOf("?")===-1?"?":"&")+p}return h}},7303:a=>{a.exports=function(o,c){return c?o.replace(/\/+$/,"")+"/"+c.replace(/^\/+/,""):o}},4372:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?{write:function(u,h,d,f,p,g){var _=[];_.push(u+"="+encodeURIComponent(h)),l.isNumber(d)&&_.push("expires="+new Date(d).toGMTString()),l.isString(f)&&_.push("path="+f),l.isString(p)&&_.push("domain="+p),g===!0&&_.push("secure"),document.cookie=_.join("; ")},read:function(u){var h=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return h?decodeURIComponent(h[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:a=>{a.exports=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}},6268:(a,o,c)=>{var l=c(4867);a.exports=function(u){return l.isObject(u)&&u.isAxiosError===!0}},7985:(a,o,c)=>{var l=c(4867);a.exports=l.isStandardBrowserEnv()?function(){var u,h=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a");function f(p){var g=p;return h&&(d.setAttribute("href",g),g=d.href),d.setAttribute("href",g),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return u=f(window.location.href),function(p){var g=l.isString(p)?f(p):p;return g.protocol===u.protocol&&g.host===u.host}}():function(){return!0}},6016:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){l.forEach(u,function(d,f){f!==h&&f.toUpperCase()===h.toUpperCase()&&(u[h]=d,delete u[f])})}},1623:a=>{a.exports=null},4109:(a,o,c)=>{var l=c(4867),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];a.exports=function(h){var d,f,p,g={};return h&&l.forEach(h.split(`
`),function(_){if(p=_.indexOf(":"),d=l.trim(_.substr(0,p)).toLowerCase(),f=l.trim(_.substr(p+1)),d){if(g[d]&&u.indexOf(d)>=0)return;g[d]=d==="set-cookie"?(g[d]?g[d]:[]).concat([f]):g[d]?g[d]+", "+f:f}}),g}},205:a=>{a.exports=function(o){var c=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return c&&c[1]||""}},8713:a=>{a.exports=function(o){return function(c){return o.apply(null,c)}}},7675:(a,o,c)=>{var l=c(4867);a.exports=function(u,h){h=h||new FormData;var d=[];function f(p){return p===null?"":l.isDate(p)?p.toISOString():l.isArrayBuffer(p)||l.isTypedArray(p)?typeof Blob=="function"?new Blob([p]):kl.from(p):p}return function p(g,_){if(l.isPlainObject(g)||l.isArray(g)){if(d.indexOf(g)!==-1)throw Error("Circular reference detected in "+_);d.push(g),l.forEach(g,function(v,E){if(!l.isUndefined(v)){var T,x=_?_+"."+E:E;if(v&&!_&&typeof v=="object"){if(l.endsWith(E,"{}"))v=JSON.stringify(v);else if(l.endsWith(E,"[]")&&(T=l.toArray(v)))return void T.forEach(function(N){!l.isUndefined(N)&&h.append(x,f(N))})}p(v,x)}}),d.pop()}else h.append(_,f(g))}(u),h}},4875:(a,o,c)=>{var l=c(7288).version,u=c(2648),h={};["object","boolean","number","function","string","symbol"].forEach(function(f,p){h[f]=function(g){return typeof g===f||"a"+(p<1?"n ":" ")+f}});var d={};h.transitional=function(f,p,g){function _(v,E){return"[Axios v"+l+"] Transitional option '"+v+"'"+E+(g?". "+g:"")}return function(v,E,T){if(f===!1)throw new u(_(E," has been removed"+(p?" in "+p:"")),u.ERR_DEPRECATED);return p&&!d[E]&&(d[E]=!0,console.warn(_(E," has been deprecated since v"+p+" and will be removed in the near future"))),!f||f(v,E,T)}},a.exports={assertOptions:function(f,p,g){if(typeof f!="object")throw new u("options must be an object",u.ERR_BAD_OPTION_VALUE);for(var _=Object.keys(f),v=_.length;v-- >0;){var E=_[v],T=p[E];if(T){var x=f[E],N=x===void 0||T(x,E,f);if(N!==!0)throw new u("option "+E+" must be "+N,u.ERR_BAD_OPTION_VALUE)}else if(g!==!0)throw new u("Unknown option "+E,u.ERR_BAD_OPTION)}},validators:h}},4867:(a,o,c)=>{var l,u=c(1849),h=Object.prototype.toString,d=(l=Object.create(null),function(q){var G=h.call(q);return l[G]||(l[G]=G.slice(8,-1).toLowerCase())});function f(q){return q=q.toLowerCase(),function(G){return d(G)===q}}function p(q){return Array.isArray(q)}function g(q){return q===void 0}var _=f("ArrayBuffer");function v(q){return q!==null&&typeof q=="object"}function E(q){if(d(q)!=="object")return!1;var G=Object.getPrototypeOf(q);return G===null||G===Object.prototype}var T=f("Date"),x=f("File"),N=f("Blob"),A=f("FileList");function I(q){return h.call(q)==="[object Function]"}var k=f("URLSearchParams");function L(q,G){if(q!=null)if(typeof q!="object"&&(q=[q]),p(q))for(var X=0,ie=q.length;X<ie;X++)G.call(null,q[X],X,q);else for(var V in q)Object.prototype.hasOwnProperty.call(q,V)&&G.call(null,q[V],V,q)}var U,$=(U=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(q){return U&&q instanceof U});a.exports={isArray:p,isArrayBuffer:_,isBuffer:function(q){return q!==null&&!g(q)&&q.constructor!==null&&!g(q.constructor)&&typeof q.constructor.isBuffer=="function"&&q.constructor.isBuffer(q)},isFormData:function(q){var G="[object FormData]";return q&&(typeof FormData=="function"&&q instanceof FormData||h.call(q)===G||I(q.toString)&&q.toString()===G)},isArrayBufferView:function(q){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(q):q&&q.buffer&&_(q.buffer)},isString:function(q){return typeof q=="string"},isNumber:function(q){return typeof q=="number"},isObject:v,isPlainObject:E,isUndefined:g,isDate:T,isFile:x,isBlob:N,isFunction:I,isStream:function(q){return v(q)&&I(q.pipe)},isURLSearchParams:k,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:L,merge:function q(){var G={};function X(Z,Y){E(G[Y])&&E(Z)?G[Y]=q(G[Y],Z):E(Z)?G[Y]=q({},Z):p(Z)?G[Y]=Z.slice():G[Y]=Z}for(var ie=0,V=arguments.length;ie<V;ie++)L(arguments[ie],X);return G},extend:function(q,G,X){return L(G,function(ie,V){q[V]=X&&typeof ie=="function"?u(ie,X):ie}),q},trim:function(q){return q.trim?q.trim():q.replace(/^\s+|\s+$/g,"")},stripBOM:function(q){return q.charCodeAt(0)===65279&&(q=q.slice(1)),q},inherits:function(q,G,X,ie){q.prototype=Object.create(G.prototype,ie),q.prototype.constructor=q,X&&Object.assign(q.prototype,X)},toFlatObject:function(q,G,X){var ie,V,Z,Y={};G=G||{};do{for(V=(ie=Object.getOwnPropertyNames(q)).length;V-- >0;)Y[Z=ie[V]]||(G[Z]=q[Z],Y[Z]=!0);q=Object.getPrototypeOf(q)}while(q&&(!X||X(q,G))&&q!==Object.prototype);return G},kindOf:d,kindOfTest:f,endsWith:function(q,G,X){q=String(q),(X===void 0||X>q.length)&&(X=q.length),X-=G.length;var ie=q.indexOf(G,X);return ie!==-1&&ie===X},toArray:function(q){if(!q)return null;var G=q.length;if(g(G))return null;for(var X=new Array(G);G-- >0;)X[G]=q[G];return X},isTypedArray:$,isFileList:A}},1206:function(a){a.exports=function(o){var c={};function l(u){if(c[u])return c[u].exports;var h=c[u]={i:u,l:!1,exports:{}};return o[u].call(h.exports,h,h.exports,l),h.l=!0,h.exports}return l.m=o,l.c=c,l.d=function(u,h,d){l.o(u,h)||Object.defineProperty(u,h,{enumerable:!0,get:d})},l.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},l.t=function(u,h){if(1&h&&(u=l(u)),8&h||4&h&&typeof u=="object"&&u&&u.__esModule)return u;var d=Object.create(null);if(l.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:u}),2&h&&typeof u!="string")for(var f in u)l.d(d,f,(function(p){return u[p]}).bind(null,f));return d},l.n=function(u){var h=u&&u.__esModule?function(){return u.default}:function(){return u};return l.d(h,"a",h),h},l.o=function(u,h){return Object.prototype.hasOwnProperty.call(u,h)},l.p="",l(l.s=90)}({17:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=l(18),h=function(){function d(){}return d.getFirstMatch=function(f,p){var g=p.match(f);return g&&g.length>0&&g[1]||""},d.getSecondMatch=function(f,p){var g=p.match(f);return g&&g.length>1&&g[2]||""},d.matchAndReturnConst=function(f,p,g){if(f.test(p))return g},d.getWindowsVersionName=function(f){switch(f){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},d.getMacOSVersionName=function(f){var p=f.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),p[0]===10)switch(p[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},d.getAndroidVersionName=function(f){var p=f.split(".").splice(0,2).map(function(g){return parseInt(g,10)||0});if(p.push(0),!(p[0]===1&&p[1]<5))return p[0]===1&&p[1]<6?"Cupcake":p[0]===1&&p[1]>=6?"Donut":p[0]===2&&p[1]<2?"Eclair":p[0]===2&&p[1]===2?"Froyo":p[0]===2&&p[1]>2?"Gingerbread":p[0]===3?"Honeycomb":p[0]===4&&p[1]<1?"Ice Cream Sandwich":p[0]===4&&p[1]<4?"Jelly Bean":p[0]===4&&p[1]>=4?"KitKat":p[0]===5?"Lollipop":p[0]===6?"Marshmallow":p[0]===7?"Nougat":p[0]===8?"Oreo":p[0]===9?"Pie":void 0},d.getVersionPrecision=function(f){return f.split(".").length},d.compareVersions=function(f,p,g){g===void 0&&(g=!1);var _=d.getVersionPrecision(f),v=d.getVersionPrecision(p),E=Math.max(_,v),T=0,x=d.map([f,p],function(N){var A=E-d.getVersionPrecision(N),I=N+new Array(A+1).join(".0");return d.map(I.split("."),function(k){return new Array(20-k.length).join("0")+k}).reverse()});for(g&&(T=E-Math.min(_,v)),E-=1;E>=T;){if(x[0][E]>x[1][E])return 1;if(x[0][E]===x[1][E]){if(E===T)return 0;E-=1}else if(x[0][E]<x[1][E])return-1}},d.map=function(f,p){var g,_=[];if(Array.prototype.map)return Array.prototype.map.call(f,p);for(g=0;g<f.length;g+=1)_.push(p(f[g]));return _},d.find=function(f,p){var g,_;if(Array.prototype.find)return Array.prototype.find.call(f,p);for(g=0,_=f.length;g<_;g+=1){var v=f[g];if(p(v,g))return v}},d.assign=function(f){for(var p,g,_=f,v=arguments.length,E=new Array(v>1?v-1:0),T=1;T<v;T++)E[T-1]=arguments[T];if(Object.assign)return Object.assign.apply(Object,[f].concat(E));var x=function(){var N=E[p];typeof N=="object"&&N!==null&&Object.keys(N).forEach(function(A){_[A]=N[A]})};for(p=0,g=E.length;p<g;p+=1)x();return f},d.getBrowserAlias=function(f){return u.BROWSER_ALIASES_MAP[f]},d.getBrowserTypeByAlias=function(f){return u.BROWSER_MAP[f]||""},d}();c.default=h,o.exports=c.default},18:function(o,c,l){c.__esModule=!0,c.ENGINE_MAP=c.OS_MAP=c.PLATFORMS_MAP=c.BROWSER_MAP=c.BROWSER_ALIASES_MAP=void 0,c.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},c.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},c.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},c.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},c.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(91))&&u.__esModule?u:{default:u},d=l(18);function f(g,_){for(var v=0;v<_.length;v++){var E=_[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(g,E.key,E)}}var p=function(){function g(){}var _,v,E;return g.getParser=function(T,x){if(x===void 0&&(x=!1),typeof T!="string")throw new Error("UserAgent should be a string");return new h.default(T,x)},g.parse=function(T){return new h.default(T).getResult()},_=g,E=[{key:"BROWSER_MAP",get:function(){return d.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return d.ENGINE_MAP}},{key:"OS_MAP",get:function(){return d.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return d.PLATFORMS_MAP}}],(v=null)&&f(_.prototype,v),E&&f(_,E),g}();c.default=p,o.exports=c.default},91:function(o,c,l){c.__esModule=!0,c.default=void 0;var u=g(l(92)),h=g(l(93)),d=g(l(94)),f=g(l(95)),p=g(l(17));function g(v){return v&&v.__esModule?v:{default:v}}var _=function(){function v(T,x){if(x===void 0&&(x=!1),T==null||T==="")throw new Error("UserAgent parameter can't be empty");this._ua=T,this.parsedResult={},x!==!0&&this.parse()}var E=v.prototype;return E.getUA=function(){return this._ua},E.test=function(T){return T.test(this._ua)},E.parseBrowser=function(){var T=this;this.parsedResult.browser={};var x=p.default.find(u.default,function(N){if(typeof N.test=="function")return N.test(T);if(N.test instanceof Array)return N.test.some(function(A){return T.test(A)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.browser=x.describe(this.getUA())),this.parsedResult.browser},E.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},E.getBrowserName=function(T){return T?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},E.getBrowserVersion=function(){return this.getBrowser().version},E.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},E.parseOS=function(){var T=this;this.parsedResult.os={};var x=p.default.find(h.default,function(N){if(typeof N.test=="function")return N.test(T);if(N.test instanceof Array)return N.test.some(function(A){return T.test(A)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.os=x.describe(this.getUA())),this.parsedResult.os},E.getOSName=function(T){var x=this.getOS().name;return T?String(x).toLowerCase()||"":x||""},E.getOSVersion=function(){return this.getOS().version},E.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},E.getPlatformType=function(T){T===void 0&&(T=!1);var x=this.getPlatform().type;return T?String(x).toLowerCase()||"":x||""},E.parsePlatform=function(){var T=this;this.parsedResult.platform={};var x=p.default.find(d.default,function(N){if(typeof N.test=="function")return N.test(T);if(N.test instanceof Array)return N.test.some(function(A){return T.test(A)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.platform=x.describe(this.getUA())),this.parsedResult.platform},E.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},E.getEngineName=function(T){return T?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},E.parseEngine=function(){var T=this;this.parsedResult.engine={};var x=p.default.find(f.default,function(N){if(typeof N.test=="function")return N.test(T);if(N.test instanceof Array)return N.test.some(function(A){return T.test(A)});throw new Error("Browser's test function is not valid")});return x&&(this.parsedResult.engine=x.describe(this.getUA())),this.parsedResult.engine},E.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},E.getResult=function(){return p.default.assign({},this.parsedResult)},E.satisfies=function(T){var x=this,N={},A=0,I={},k=0;if(Object.keys(T).forEach(function(V){var Z=T[V];typeof Z=="string"?(I[V]=Z,k+=1):typeof Z=="object"&&(N[V]=Z,A+=1)}),A>0){var L=Object.keys(N),U=p.default.find(L,function(V){return x.isOS(V)});if(U){var $=this.satisfies(N[U]);if($!==void 0)return $}var q=p.default.find(L,function(V){return x.isPlatform(V)});if(q){var G=this.satisfies(N[q]);if(G!==void 0)return G}}if(k>0){var X=Object.keys(I),ie=p.default.find(X,function(V){return x.isBrowser(V,!0)});if(ie!==void 0)return this.compareVersion(I[ie])}},E.isBrowser=function(T,x){x===void 0&&(x=!1);var N=this.getBrowserName().toLowerCase(),A=T.toLowerCase(),I=p.default.getBrowserTypeByAlias(A);return x&&I&&(A=I.toLowerCase()),A===N},E.compareVersion=function(T){var x=[0],N=T,A=!1,I=this.getBrowserVersion();if(typeof I=="string")return T[0]===">"||T[0]==="<"?(N=T.substr(1),T[1]==="="?(A=!0,N=T.substr(2)):x=[],T[0]===">"?x.push(1):x.push(-1)):T[0]==="="?N=T.substr(1):T[0]==="~"&&(A=!0,N=T.substr(1)),x.indexOf(p.default.compareVersions(I,N,A))>-1},E.isOS=function(T){return this.getOSName(!0)===String(T).toLowerCase()},E.isPlatform=function(T){return this.getPlatformType(!0)===String(T).toLowerCase()},E.isEngine=function(T){return this.getEngineName(!0)===String(T).toLowerCase()},E.is=function(T,x){return x===void 0&&(x=!1),this.isBrowser(T,x)||this.isOS(T)||this.isPlatform(T)},E.some=function(T){var x=this;return T===void 0&&(T=[]),T.some(function(N){return x.is(N)})},v}();c.default=_,o.exports=c.default},92:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=/version\/(\d+(\.?_?\d+)+)/i,f=[{test:[/googlebot/i],describe:function(p){var g={name:"Googlebot"},_=h.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/opera/i],describe:function(p){var g={name:"Opera"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/opr\/|opios/i],describe:function(p){var g={name:"Opera"},_=h.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/SamsungBrowser/i],describe:function(p){var g={name:"Samsung Internet for Android"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/Whale/i],describe:function(p){var g={name:"NAVER Whale Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/MZBrowser/i],describe:function(p){var g={name:"MZ Browser"},_=h.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/focus/i],describe:function(p){var g={name:"Focus"},_=h.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/swing/i],describe:function(p){var g={name:"Swing"},_=h.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/coast/i],describe:function(p){var g={name:"Opera Coast"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(p){var g={name:"Opera Touch"},_=h.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/yabrowser/i],describe:function(p){var g={name:"Yandex Browser"},_=h.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/ucbrowser/i],describe:function(p){var g={name:"UC Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/Maxthon|mxios/i],describe:function(p){var g={name:"Maxthon"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/epiphany/i],describe:function(p){var g={name:"Epiphany"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/puffin/i],describe:function(p){var g={name:"Puffin"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/sleipnir/i],describe:function(p){var g={name:"Sleipnir"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/k-meleon/i],describe:function(p){var g={name:"K-Meleon"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/micromessenger/i],describe:function(p){var g={name:"WeChat"},_=h.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/qqbrowser/i],describe:function(p){var g={name:/qqbrowserlite/i.test(p)?"QQ Browser Lite":"QQ Browser"},_=h.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/msie|trident/i],describe:function(p){var g={name:"Internet Explorer"},_=h.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/\sedg\//i],describe:function(p){var g={name:"Microsoft Edge"},_=h.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/edg([ea]|ios)/i],describe:function(p){var g={name:"Microsoft Edge"},_=h.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/vivaldi/i],describe:function(p){var g={name:"Vivaldi"},_=h.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/seamonkey/i],describe:function(p){var g={name:"SeaMonkey"},_=h.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/sailfish/i],describe:function(p){var g={name:"Sailfish"},_=h.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,p);return _&&(g.version=_),g}},{test:[/silk/i],describe:function(p){var g={name:"Amazon Silk"},_=h.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/phantom/i],describe:function(p){var g={name:"PhantomJS"},_=h.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/slimerjs/i],describe:function(p){var g={name:"SlimerJS"},_=h.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g={name:"BlackBerry"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g={name:"WebOS Browser"},_=h.default.getFirstMatch(d,p)||h.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/bada/i],describe:function(p){var g={name:"Bada"},_=h.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/tizen/i],describe:function(p){var g={name:"Tizen"},_=h.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/qupzilla/i],describe:function(p){var g={name:"QupZilla"},_=h.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/firefox|iceweasel|fxios/i],describe:function(p){var g={name:"Firefox"},_=h.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/electron/i],describe:function(p){var g={name:"Electron"},_=h.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/MiuiBrowser/i],describe:function(p){var g={name:"Miui"},_=h.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/chromium/i],describe:function(p){var g={name:"Chromium"},_=h.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,p)||h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/chrome|crios|crmo/i],describe:function(p){var g={name:"Chrome"},_=h.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/GSA/i],describe:function(p){var g={name:"Google Search"},_=h.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){var g=!p.test(/like android/i),_=p.test(/android/i);return g&&_},describe:function(p){var g={name:"Android Browser"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/playstation 4/i],describe:function(p){var g={name:"PlayStation 4"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/safari|applewebkit/i],describe:function(p){var g={name:"Safari"},_=h.default.getFirstMatch(d,p);return _&&(g.version=_),g}},{test:[/.*/i],describe:function(p){var g=p.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:h.default.getFirstMatch(g,p),version:h.default.getSecondMatch(g,p)}}}];c.default=f,o.exports=c.default},93:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:[/Roku\/DVP/],describe:function(p){var g=h.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,p);return{name:d.OS_MAP.Roku,version:g}}},{test:[/windows phone/i],describe:function(p){var g=h.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.WindowsPhone,version:g}}},{test:[/windows /i],describe:function(p){var g=h.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,p),_=h.default.getWindowsVersionName(g);return{name:d.OS_MAP.Windows,version:g,versionName:_}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(p){var g={name:d.OS_MAP.iOS},_=h.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,p);return _&&(g.version=_),g}},{test:[/macintosh/i],describe:function(p){var g=h.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,p).replace(/[_\s]/g,"."),_=h.default.getMacOSVersionName(g),v={name:d.OS_MAP.MacOS,version:g};return _&&(v.versionName=_),v}},{test:[/(ipod|iphone|ipad)/i],describe:function(p){var g=h.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,p).replace(/[_\s]/g,".");return{name:d.OS_MAP.iOS,version:g}}},{test:function(p){var g=!p.test(/like android/i),_=p.test(/android/i);return g&&_},describe:function(p){var g=h.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,p),_=h.default.getAndroidVersionName(g),v={name:d.OS_MAP.Android,version:g};return _&&(v.versionName=_),v}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var g=h.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,p),_={name:d.OS_MAP.WebOS};return g&&g.length&&(_.version=g),_}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var g=h.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,p)||h.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,p)||h.default.getFirstMatch(/\bbb(\d+)/i,p);return{name:d.OS_MAP.BlackBerry,version:g}}},{test:[/bada/i],describe:function(p){var g=h.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Bada,version:g}}},{test:[/tizen/i],describe:function(p){var g=h.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Tizen,version:g}}},{test:[/linux/i],describe:function(){return{name:d.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:d.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(p){var g=h.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.PlayStation4,version:g}}}];c.default=f,o.exports=c.default},94:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(p){var g=h.default.getFirstMatch(/(can-l01)/i,p)&&"Nova",_={type:d.PLATFORMS_MAP.mobile,vendor:"Huawei"};return g&&(_.model=g),_}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){var g=p.test(/ipod|iphone/i),_=p.test(/like (ipod|iphone)/i);return g&&!_},describe:function(p){var g=h.default.getFirstMatch(/(ipod|iphone)/i,p);return{type:d.PLATFORMS_MAP.mobile,vendor:"Apple",model:g}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName(!0)==="blackberry"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(p){return p.getBrowserName(!0)==="bada"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName()==="windows phone"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(p){var g=Number(String(p.getOSVersion()).split(".")[0]);return p.getOSName(!0)==="android"&&g>=3},describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){return p.getOSName(!0)==="android"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getOSName(!0)==="macos"},describe:function(){return{type:d.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(p){return p.getOSName(!0)==="windows"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="linux"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="playstation 4"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}},{test:function(p){return p.getOSName(!0)==="roku"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}}];c.default=f,o.exports=c.default},95:function(o,c,l){c.__esModule=!0,c.default=void 0;var u,h=(u=l(17))&&u.__esModule?u:{default:u},d=l(18),f=[{test:function(p){return p.getBrowserName(!0)==="microsoft edge"},describe:function(p){if(/\sedg\//i.test(p))return{name:d.ENGINE_MAP.Blink};var g=h.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,p);return{name:d.ENGINE_MAP.EdgeHTML,version:g}}},{test:[/trident/i],describe:function(p){var g={name:d.ENGINE_MAP.Trident},_=h.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){return p.test(/presto/i)},describe:function(p){var g={name:d.ENGINE_MAP.Presto},_=h.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:function(p){var g=p.test(/gecko/i),_=p.test(/like gecko/i);return g&&!_},describe:function(p){var g={name:d.ENGINE_MAP.Gecko},_=h.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:d.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(p){var g={name:d.ENGINE_MAP.WebKit},_=h.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,p);return _&&(g.version=_),g}}];c.default=f,o.exports=c.default}})},6729:a=>{var o=Object.prototype.hasOwnProperty,c="~";function l(){}function u(p,g,_){this.fn=p,this.context=g,this.once=_||!1}function h(p,g,_,v,E){if(typeof _!="function")throw new TypeError("The listener must be a function");var T=new u(_,v||p,E),x=c?c+g:g;return p._events[x]?p._events[x].fn?p._events[x]=[p._events[x],T]:p._events[x].push(T):(p._events[x]=T,p._eventsCount++),p}function d(p,g){--p._eventsCount==0?p._events=new l:delete p._events[g]}function f(){this._events=new l,this._eventsCount=0}Object.create&&(l.prototype=Object.create(null),new l().__proto__||(c=!1)),f.prototype.eventNames=function(){var p,g,_=[];if(this._eventsCount===0)return _;for(g in p=this._events)o.call(p,g)&&_.push(c?g.slice(1):g);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(p)):_},f.prototype.listeners=function(p){var g=c?c+p:p,_=this._events[g];if(!_)return[];if(_.fn)return[_.fn];for(var v=0,E=_.length,T=new Array(E);v<E;v++)T[v]=_[v].fn;return T},f.prototype.listenerCount=function(p){var g=c?c+p:p,_=this._events[g];return _?_.fn?1:_.length:0},f.prototype.emit=function(p,g,_,v,E,T){var x=c?c+p:p;if(!this._events[x])return!1;var N,A,I=this._events[x],k=arguments.length;if(I.fn){switch(I.once&&this.removeListener(p,I.fn,void 0,!0),k){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,g),!0;case 3:return I.fn.call(I.context,g,_),!0;case 4:return I.fn.call(I.context,g,_,v),!0;case 5:return I.fn.call(I.context,g,_,v,E),!0;case 6:return I.fn.call(I.context,g,_,v,E,T),!0}for(A=1,N=new Array(k-1);A<k;A++)N[A-1]=arguments[A];I.fn.apply(I.context,N)}else{var L,U=I.length;for(A=0;A<U;A++)switch(I[A].once&&this.removeListener(p,I[A].fn,void 0,!0),k){case 1:I[A].fn.call(I[A].context);break;case 2:I[A].fn.call(I[A].context,g);break;case 3:I[A].fn.call(I[A].context,g,_);break;case 4:I[A].fn.call(I[A].context,g,_,v);break;default:if(!N)for(L=1,N=new Array(k-1);L<k;L++)N[L-1]=arguments[L];I[A].fn.apply(I[A].context,N)}}return!0},f.prototype.on=function(p,g,_){return h(this,p,g,_,!1)},f.prototype.once=function(p,g,_){return h(this,p,g,_,!0)},f.prototype.removeListener=function(p,g,_,v){var E=c?c+p:p;if(!this._events[E])return this;if(!g)return d(this,E),this;var T=this._events[E];if(T.fn)T.fn!==g||v&&!T.once||_&&T.context!==_||d(this,E);else{for(var x=0,N=[],A=T.length;x<A;x++)(T[x].fn!==g||v&&!T[x].once||_&&T[x].context!==_)&&N.push(T[x]);N.length?this._events[E]=N.length===1?N[0]:N:d(this,E)}return this},f.prototype.removeAllListeners=function(p){var g;return p?(g=c?c+p:p,this._events[g]&&d(this,g)):(this._events=new l,this._eventsCount=0),this},f.prototype.off=f.prototype.removeListener,f.prototype.addListener=f.prototype.on,f.prefixed=c,f.EventEmitter=f,a.exports=f},1564:a=>{var o;o=()=>(()=>{var c={228:u=>{var h=Object.prototype.hasOwnProperty,d="~";function f(){}function p(E,T,x){this.fn=E,this.context=T,this.once=x||!1}function g(E,T,x,N,A){if(typeof x!="function")throw new TypeError("The listener must be a function");var I=new p(x,N||E,A),k=d?d+T:T;return E._events[k]?E._events[k].fn?E._events[k]=[E._events[k],I]:E._events[k].push(I):(E._events[k]=I,E._eventsCount++),E}function _(E,T){--E._eventsCount==0?E._events=new f:delete E._events[T]}function v(){this._events=new f,this._eventsCount=0}Object.create&&(f.prototype=Object.create(null),new f().__proto__||(d=!1)),v.prototype.eventNames=function(){var E,T,x=[];if(this._eventsCount===0)return x;for(T in E=this._events)h.call(E,T)&&x.push(d?T.slice(1):T);return Object.getOwnPropertySymbols?x.concat(Object.getOwnPropertySymbols(E)):x},v.prototype.listeners=function(E){var T=d?d+E:E,x=this._events[T];if(!x)return[];if(x.fn)return[x.fn];for(var N=0,A=x.length,I=new Array(A);N<A;N++)I[N]=x[N].fn;return I},v.prototype.listenerCount=function(E){var T=d?d+E:E,x=this._events[T];return x?x.fn?1:x.length:0},v.prototype.emit=function(E,T,x,N,A,I){var k=d?d+E:E;if(!this._events[k])return!1;var L,U,$=this._events[k],q=arguments.length;if($.fn){switch($.once&&this.removeListener(E,$.fn,void 0,!0),q){case 1:return $.fn.call($.context),!0;case 2:return $.fn.call($.context,T),!0;case 3:return $.fn.call($.context,T,x),!0;case 4:return $.fn.call($.context,T,x,N),!0;case 5:return $.fn.call($.context,T,x,N,A),!0;case 6:return $.fn.call($.context,T,x,N,A,I),!0}for(U=1,L=new Array(q-1);U<q;U++)L[U-1]=arguments[U];$.fn.apply($.context,L)}else{var G,X=$.length;for(U=0;U<X;U++)switch($[U].once&&this.removeListener(E,$[U].fn,void 0,!0),q){case 1:$[U].fn.call($[U].context);break;case 2:$[U].fn.call($[U].context,T);break;case 3:$[U].fn.call($[U].context,T,x);break;case 4:$[U].fn.call($[U].context,T,x,N);break;default:if(!L)for(G=1,L=new Array(q-1);G<q;G++)L[G-1]=arguments[G];$[U].fn.apply($[U].context,L)}}return!0},v.prototype.on=function(E,T,x){return g(this,E,T,x,!1)},v.prototype.once=function(E,T,x){return g(this,E,T,x,!0)},v.prototype.removeListener=function(E,T,x,N){var A=d?d+E:E;if(!this._events[A])return this;if(!T)return _(this,A),this;var I=this._events[A];if(I.fn)I.fn!==T||N&&!I.once||x&&I.context!==x||_(this,A);else{for(var k=0,L=[],U=I.length;k<U;k++)(I[k].fn!==T||N&&!I[k].once||x&&I[k].context!==x)&&L.push(I[k]);L.length?this._events[A]=L.length===1?L[0]:L:_(this,A)}return this},v.prototype.removeAllListeners=function(E){var T;return E?(T=d?d+E:E,this._events[T]&&_(this,T)):(this._events=new f,this._eventsCount=0),this},v.prototype.off=v.prototype.removeListener,v.prototype.addListener=v.prototype.on,v.prefixed=d,v.EventEmitter=v,u.exports=v},815:function(u,h){var d,f,p=this&&this.__extends||(d=function(Y,ee){return d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(oe,de){oe.__proto__=de}||function(oe,de){for(var Me in de)Object.prototype.hasOwnProperty.call(de,Me)&&(oe[Me]=de[Me])},d(Y,ee)},function(Y,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Class extends value "+String(ee)+" is not a constructor or null");function oe(){this.constructor=Y}d(Y,ee),Y.prototype=ee===null?Object.create(ee):(oe.prototype=ee.prototype,new oe)});function g(Y){return 60*Y*60}function _(Y){return 60*Y*60*24}Object.defineProperty(h,"__esModule",{value:!0}),h.daysToSeconds=h.hoursToSeconds=h.ConfigurationHolder=h.ConfigurationManager=h.Env=void 0,function(Y){Y.BETA="beta",Y.PROD="prod",Y.CUSTOM="custom"}(f||(h.Env=f={})),h.hoursToSeconds=g,h.daysToSeconds=_;var v=function(Y){function ee(oe){return Y.call(this,oe)||this}return p(ee,Y),ee}(Error),E="data",T="metrics",x=g(1),N=_(3),A=g(2),I="base64",k=function(){function Y(ee,oe){var de,Me,He,Te,Le,we,Ce,ke;if(!oe.fileKey)throw new Error("options.fileKey cannot be empty");var St=(de=oe.clock)!==null&&de!==void 0?de:new ie,At=St.getMillis();switch(this.context=ee,this.fileKey=oe.fileKey,this.env=oe.standardEnv,oe.standardEnv){case f.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case f.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case f.CUSTOM:if(!oe.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=oe.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(oe.standardEnv))}this.trace=(Me=oe.trace)!==null&&Me!==void 0?Me:new q(this.env),this.fetch=(He=oe.fetch)!==null&&He!==void 0?He:new $(ee),this.storage=new X("amazon_ivs_device_config_v1_"+oe.fileKey,ee.localStorage),this.state=new Z(this.storage,"state"),this.refresh={refreshIntervalSeconds:(Te=oe.refresh.refreshIntervalSeconds)!==null&&Te!==void 0?Te:x,retryCount:(Le=oe.refresh.retryCount)!==null&&Le!==void 0?Le:3,retryIntervalSeconds:(we=oe.refresh.retryIntervalSeconds)!==null&&we!==void 0?we:10,maxCacheAgeSeconds:(Ce=oe.refresh.maxCacheAgeSeconds)!==null&&Ce!==void 0?Ce:N,stopRefreshAfterSeconds:(ke=oe.refresh.stopRefreshAfterSeconds)!==null&&ke!==void 0?ke:A,canRefreshNow:oe.refresh.canRefreshNow},this.clock=St,this.isInitialRefreshDone=!1;var Ee=0,ye=this.state.getState();ye&&ye.fetchServer===this.fetchServer&&ye.lastFetchWhenMs&&(Ee=ye.lastFetchWhenMs);var et=St.getMillis(),fe=(et-Ee)/1e3;if(fe<=this.refresh.maxCacheAgeSeconds){var Fe=this.storage.getJson(E);Fe&&Fe.fetchServer===this.fetchServer&&this.setData(Fe.json)}if(this.lastUseMs=et,fe>=this.refresh.refreshIntervalSeconds||Ee==0)this.trace.onTrace("Will start refresh right now"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),0);else{var Ie=Math.round(this.refresh.refreshIntervalSeconds-fe);this.trace.onTrace("Will start refresh in "+Ie+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*Ie),this.isInitialRefreshDone=!0}var it=St.getMillis();this.initialLoadTime=it-At}return Y.getInstance=function(ee,oe){try{if(!(ee.fetch&&ee.setTimeout&&ee.clearTimeout&&ee.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(de){return void console.error("Error checking for context properties "+de)}if(this.gInstance){if(this.gInstance.fileKey!=oe.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(oe.fileKey));return this.gInstance}return this.gInstance=new Y(ee,oe),this.gInstance},Y.prototype.getConfigurationHolder=function(ee){var oe,de=this,Me=this.clock.getMillis();this.lastUseMs=Me;var He=(oe=ee.analytics)!==null&&oe!==void 0?oe:new G(this.env);this.context.setTimeout(function(){de.emitMetrics(He)});var Te=0,Le=this.state.getState();return Le&&Le.fetchServer===this.fetchServer&&Le.lastFetchWhenMs&&(Te=Le.lastFetchWhenMs),(Me-Te)/1e3<=this.refresh.maxCacheAgeSeconds?new L(He,this.properties):new L(He,void 0)},Y.prototype.getFetchUrl=function(){var ee="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),oe=new URL(ee);return oe.searchParams.set("version","1.0"),oe},Y.clearInstance=function(){var ee;(ee=this.gInstance)===null||ee===void 0||ee.clearInstanceImpl(),this.gInstance=void 0},Y.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},Y.prototype.startRefresh=function(){var ee=this;this.trace.onTrace("Starting refresh request..."),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0);var oe=this.clock.getMillis();return(oe-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds?(this.trace.onTrace("Actually will not refresh due to refresh timeout"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):this.isInitialRefreshDone&&!this.refresh.canRefreshNow()?(this.trace.onTrace("Will not refresh due to callback having returned false"),void(this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds))):void this.fetchData().then(function(de){ee.processResponse(de,oe)}).catch(function(de){ee.exceptionMetrics(de),ee.trace.onTrace("Fetch error: "+de),ee.refresh.retryCount>0&&ee.scheduleRetry(1)}).finally(function(){ee.isInitialRefreshDone=!0,ee.fetchTask=ee.context.setTimeout(ee.startRefresh.bind(ee),1e3*ee.refresh.refreshIntervalSeconds)})},Y.prototype.fetchData=function(){var ee=this.getFetchUrl(),oe=new Headers,de=this.state.getState();return de.fetchServer===this.fetchServer&&(de.lastFetchWhenFullMs&&this.clock.getMillis()-de.lastFetchWhenFullMs>1e3*g(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&de.lastFetchEtagHeader&&oe.set("If-None-Match",de.lastFetchEtagHeader)),this.incrementMetrics("fetch_attempt_count"),this.fetch.fetchUrl(ee,oe)},Y.prototype.processResponse=function(ee,oe){var de={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},Me=ee.headers.get("etag");Me&&(de.lastFetchEtagHeader=Me);try{if(ee.status<300&&ee.json)if(this.setData(ee.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(E,{fetchServer:this.fetchServer,json:ee.json});var He=this.clock.getMillis();de.lastFetchWhenFullMs=He,this.incrementMetricsWithDuration("success_new_data_count",He-oe)}else this.incrementMetrics("fail_invalid_data_count");else{if(ee.status!==304){var Te="Unexpected http fetch status: "+ee.status;throw this.trace.onTrace(Te),new v(Te)}this.trace.onTrace("Server said no change in data"),He=this.clock.getMillis(),this.incrementMetricsWithDuration("success_no_change_count",He-oe)}}finally{this.state.setState(de)}},Y.prototype.scheduleRetry=function(ee){var oe=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var de=ee*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout(function(){oe.retryTask=void 0,oe.fetchRetry(ee)},1e3*de)},Y.prototype.fetchRetry=function(ee){var oe=this;this.trace.onTrace("Starting retry request ".concat(ee,"..."));var de=this.clock.getMillis();this.fetchData().then(function(Me){oe.processResponse(Me,de)}).catch(function(Me){oe.exceptionMetrics(Me),oe.trace.onTrace("Fetch error: "+Me),oe.refresh.retryCount>ee&&oe.scheduleRetry(ee+1)})},Y.prototype.setData=function(ee){if(!ee)return!1;if(ee.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var oe=ee.properties;if(!oe||!Array.isArray(oe))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var de=new Map,Me=0,He=oe;Me<He.length;Me++){var Te=He[Me];if(Te.name&&Te.type&&this.isValidValueType(Te.type)){if(Te.value_string&&typeof Te.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof Te.value_string);continue}if(Te.value_number&&typeof Te.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof Te.value_number);continue}if(Te.value_boolean&&typeof Te.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof Te.value_boolean);continue}if(Te.value_json&&typeof Te.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof Te.value_json);continue}if(Te.value_analytics&&typeof Te.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof Te.value_analytics);continue}var Le=new V(Te.name,this.parseValueType(Te.type),Te.value_string,Te.value_number,Te.value_boolean,Te.value_json,Te.value_analytics,Te.encoding);de.set(Le.name,Le)}}return de.size!=0&&(this.properties=de,!0)},Y.prototype.isValidValueType=function(ee){return ee==="string"||ee==="number"||ee==="boolean"||ee=="json"},Y.prototype.parseValueType=function(ee){switch(ee){case"string":return U.STRING;case"number":return U.NUMBER;case"boolean":return U.BOOLEAN;case"json":return U.JSON;default:throw new Error("Unsupported value type ".concat(ee))}},Y.prototype.emitMetrics=function(ee){var oe,de,Me,He,Te,Le,we,Ce,ke=(oe=this.storage.getJson(T))!==null&&oe!==void 0?oe:{},St={initial_load_time:this.initialLoadTime,fetch_attempt_count:(de=ke.fetch_attempt_count)!==null&&de!==void 0?de:0,fetch_duration_average:(Me=ke.fetch_duration_average)!==null&&Me!==void 0?Me:0,success_no_change_count:(He=ke.success_no_change_count)!==null&&He!==void 0?He:0,success_new_data_count:(Te=ke.success_new_data_count)!==null&&Te!==void 0?Te:0,fail_exception_count:(Le=ke.fail_exception_count)!==null&&Le!==void 0?Le:0,fail_http_error_count:(we=ke.fail_http_error_count)!==null&&we!==void 0?we:0,fail_invalid_data_count:(Ce=ke.fail_invalid_data_count)!==null&&Ce!==void 0?Ce:0};ee.onMetrics(St),ke.fetch_attempt_count=0,ke.success_no_change_count=0,ke.success_new_data_count=0,ke.fail_exception_count=0,ke.fail_http_error_count=0,ke.fail_invalid_data_count=0,this.storage.setJson(T,ke)},Y.prototype.exceptionMetrics=function(ee){ee instanceof v||ee.message.startsWith("http error")?this.incrementMetrics("fail_http_error_count"):this.incrementMetrics("fail_exception_count")},Y.prototype.incrementMetrics=function(ee){var oe,de,Me=(oe=this.storage.getJson(T))!==null&&oe!==void 0?oe:{};Me[ee]=((de=Me[ee])!==null&&de!==void 0?de:0)+1,this.storage.setJson(T,Me)},Y.prototype.incrementMetricsWithDuration=function(ee,oe){var de,Me,He=(de=this.storage.getJson(T))!==null&&de!==void 0?de:{};He[ee]=((Me=He[ee])!==null&&Me!==void 0?Me:0)+1,oe>0&&(He.fetch_duration_average!==void 0?He.fetch_duration_average=.9*He.fetch_duration_average+.1*oe|0:He.fetch_duration_average=oe),this.storage.setJson(T,He)},Y}();h.ConfigurationManager=k;var L=function(){function Y(ee,oe){this.analytics=ee,this.properties=oe}return Y.prototype.getSize=function(){return this.properties?this.properties.size:-1},Y.prototype.getStringValue=function(ee){var oe,de;if(this.properties){var Me=this.properties.get(ee);if(Me){if(Me.type===U.STRING){var He=(oe=Me.valueString)!==null&&oe!==void 0?oe:"";return this.analytics.onValue(ee,(de=Me.valueAnalytics)!==null&&de!==void 0?de:He),He}this.analytics.onError(ee,"Type is not string")}}else this.analytics.onTrace(ee,"Configuration is not available")},Y.prototype.getNumberValue=function(ee){var oe,de;if(this.properties){var Me=this.properties.get(ee);if(Me){if(Me.type===U.NUMBER){var He=(oe=Me.valueNumber)!==null&&oe!==void 0?oe:0;return this.analytics.onValue(ee,(de=Me.valueAnalytics)!==null&&de!==void 0?de:He.toString()),He}this.analytics.onError(ee,"Type is not number")}}else this.analytics.onTrace(ee,"Configuration is not available")},Y.prototype.getBooleanValue=function(ee){var oe,de;if(this.properties){var Me=this.properties.get(ee);if(Me){if(Me.type===U.BOOLEAN){var He=(oe=Me.valueBoolean)!==null&&oe!==void 0&&oe;return this.analytics.onValue(ee,(de=Me.valueAnalytics)!==null&&de!==void 0?de:He.toString()),He}this.analytics.onError(ee,"Type is not boolean")}}else this.analytics.onTrace(ee,"Configuration is not available")},Y.prototype.getJsonValue=function(ee){var oe,de;if(this.properties){var Me=this.properties.get(ee);if(Me){if(Me.type===U.JSON){var He=Me.valueJson;if(!He)return this.analytics.onValue(ee,(oe=Me.valueAnalytics)!==null&&oe!==void 0?oe:""),null;try{var Te=JSON.parse(He);return this.analytics.onValue(ee,(de=Me.valueAnalytics)!==null&&de!==void 0?de:He),Te}catch{return void this.analytics.onError(ee,"Json parse error")}}this.analytics.onError(ee,"Type is not json")}}else this.analytics.onTrace(ee,"Configuration is not available")},Y}();h.ConfigurationHolder=L;var U,$=function(){function Y(ee){this.context=ee}return Y.prototype.fetchUrl=function(ee,oe){var de=this;return new Promise(function(Me,He){de.context.fetch(ee,{headers:oe,cache:"no-store"}).then(function(Te){if(Te.status>=400)He(new v("http error ".concat(Te.status,", ").concat(Te.statusText)));else{var Le={status:Te.status,headers:Te.headers};Te.json().then(function(we){Le.json=we}).catch(function(){}).finally(function(){Me(Le)})}}).catch(function(Te){He(Te)})})},Y}(),q=function(){function Y(ee){this.env=ee}return Y.prototype.onTrace=function(ee){this.env!=f.PROD&&console.log("Configuration: "+ee)},Y}(),G=function(){function Y(ee){this.env=ee}return Y.prototype.onMetrics=function(ee){this.env!=f.PROD&&console.log("Metrics",ee)},Y.prototype.onValue=function(ee,oe){this.env!=f.PROD&&console.log("Configuration for ".concat(ee,": value = ").concat(oe))},Y.prototype.onError=function(ee,oe){this.env!=f.PROD&&console.error("Configuration for ".concat(ee,": error = ").concat(oe))},Y.prototype.onTrace=function(ee,oe){this.env!=f.PROD&&console.log("Configuration for ".concat(ee,": trace = ").concat(oe))},Y}(),X=function(){function Y(ee,oe){this.prefix=ee,this.storage=oe}return Y.prototype.getJson=function(ee){var oe=this.prefix+"_"+ee;try{var de=this.storage.getItem(oe);if(de)return JSON.parse(de)}catch(Me){console.error("Error getting local storage key ".concat(oe)+Me)}return null},Y.prototype.setJson=function(ee,oe){var de=this.prefix+"_"+ee;try{this.storage.setItem(de,JSON.stringify(oe))}catch(Me){console.error("Error setting local storage key ".concat(de,": ")+Me)}},Y}(),ie=function(){function Y(){}return Y.prototype.getMillis=function(){return Date.now()},Y}();(function(Y){Y[Y.STRING=0]="STRING",Y[Y.NUMBER=1]="NUMBER",Y[Y.BOOLEAN=2]="BOOLEAN",Y[Y.JSON=3]="JSON"})(U||(U={}));var V=function(Y,ee,oe,de,Me,He,Te,Le){switch(this.name=Y,this.type=ee,this.valueString=oe,this.valueNumber=de,this.valueBoolean=Me,this.valueJson=He,this.valueAnalytics=Te,this.type){case U.STRING:Le===I&&oe&&(this.valueString=atob(oe));break;case U.JSON:Le===I&&He&&(this.valueJson=atob(He))}},Z=function(){function Y(ee,oe){var de;this.storage=ee,this.key=oe,this.state=(de=ee.getJson(oe))!==null&&de!==void 0?de:{}}return Y.prototype.getState=function(){return this.state},Y.prototype.setState=function(ee){Object.assign(this.state,ee),this.storage.setJson(this.key,this.state)},Y}()},456:function(u,h,d){var f=this&&this.__createBinding||(Object.create?function(g,_,v,E){E===void 0&&(E=v);var T=Object.getOwnPropertyDescriptor(_,v);T&&!("get"in T?!_.__esModule:T.writable||T.configurable)||(T={enumerable:!0,get:function(){return _[v]}}),Object.defineProperty(g,E,T)}:function(g,_,v,E){E===void 0&&(E=v),g[E]=_[v]}),p=this&&this.__exportStar||function(g,_){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(_,v)||f(_,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),p(d(903),h)},903:function(u,h,d){var f=this&&this.__spreadArray||function(_,v,E){if(E||arguments.length===2)for(var T,x=0,N=v.length;x<N;x++)!T&&x in v||(T||(T=Array.prototype.slice.call(v,0,x)),T[x]=v[x]);return _.concat(T||Array.prototype.slice.call(v))};Object.defineProperty(h,"__esModule",{value:!0}),h.TypedEmitter=void 0;var p=d(228),g=function(){function _(v){var E=v.propagateErrors;this.emitter=new p.EventEmitter,this.propagateErrors=E!=null&&E}return _.prototype.on=function(v,E){E.call=this.wrapCall(v,E),this.emitter.on(v,E)},_.prototype.off=function(v,E){this.emitter.off(v,E)},_.prototype.emit=function(v){for(var E,T=[],x=1;x<arguments.length;x++)T[x-1]=arguments[x];(E=this.emitter).emit.apply(E,f([v],T,!1))},_.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},_.prototype.wrapCall=function(v,E){var T=this;return function(x){for(var N=[],A=1;A<arguments.length;A++)N[A-1]=arguments[A];if(T.propagateErrors)E.apply(x,N);else try{E.apply(x,N)}catch(L){var I="Error in callback for ".concat(v),k=E.name;return k&&(I+=" for function ".concat(k)),void console.error(I,L)}}},_}();h.TypedEmitter=g},987:function(u,h,d){var f,p=this&&this.__extends||(f=function(N,A){return f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,k){I.__proto__=k}||function(I,k){for(var L in k)Object.prototype.hasOwnProperty.call(k,L)&&(I[L]=k[L])},f(N,A)},function(N,A){if(typeof A!="function"&&A!==null)throw new TypeError("Class extends value "+String(A)+" is not a constructor or null");function I(){this.constructor=N}f(N,A),N.prototype=A===null?Object.create(A):(I.prototype=A.prototype,new I)}),g=this&&this.__createBinding||(Object.create?function(N,A,I,k){k===void 0&&(k=I);var L=Object.getOwnPropertyDescriptor(A,I);L&&!("get"in L?!A.__esModule:L.writable||L.configurable)||(L={enumerable:!0,get:function(){return A[I]}}),Object.defineProperty(N,k,L)}:function(N,A,I,k){k===void 0&&(k=I),N[k]=A[I]}),_=this&&this.__setModuleDefault||(Object.create?function(N,A){Object.defineProperty(N,"default",{enumerable:!0,value:A})}:function(N,A){N.default=A}),v=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var A={};if(N!=null)for(var I in N)I!=="default"&&Object.prototype.hasOwnProperty.call(N,I)&&g(A,N,I);return _(A,N),A};Object.defineProperty(h,"__esModule",{value:!0}),h.createFsm=h.FsmWildcardState=h.RejectedTransitionError=h.InvalidStateTransitionError=void 0;var E=v(d(293)),T=function(N){function A(I,k){var L=N.call(this,"Invalid transition from '".concat(k,"' via event '").concat(I,"'"))||this;return L.name="InvalidStateTransitionError",L}return p(A,N),A}(Error);h.InvalidStateTransitionError=T;var x=function(N){function A(I,k,L){var U=N.call(this,"Transition from '".concat(k,"' via event '").concat(I,"' was rejected for: ").concat(L))||this;return U.name="RejectedTransitionError",U}return p(A,N),A}(Error);h.RejectedTransitionError=x,h.FsmWildcardState="*",h.createFsm=function(N){var A,I=N.transitions,k=N.callbacks,L=N.initialState,U=function($){var q,G=(q=I[$])===null||q===void 0?void 0:q.from;return!!G&&(typeof G=="string"?G===h.FsmWildcardState:G.includes(L))};return{canTransition:U,transition:function($,q){var G,X,ie,V,Z,Y;if(!U($))return E.err(new T(String(L),String($)));var ee=I[$];return ee.shouldTransition===void 0||ee.shouldTransition(L)?((X=(G=k==null?void 0:k[L])===null||G===void 0?void 0:G.onExiting)===null||X===void 0||X.call(G),(ie=k==null?void 0:k.onStateExiting)===null||ie===void 0||ie.call(k,L),A=L,L=ee.to,(Z=(V=k==null?void 0:k[L])===null||V===void 0?void 0:V.onChanged)===null||Z===void 0||Z.call(V,A,q),(Y=k==null?void 0:k.onStateChanged)===null||Y===void 0||Y.call(k,A,L,q),E.ok(L)):E.err(new x(String(L),String($),"shouldTransition returned false"))},previousState:function(){return A},currentState:function(){return L}}}},156:function(u,h,d){var f=this&&this.__createBinding||(Object.create?function(g,_,v,E){E===void 0&&(E=v);var T=Object.getOwnPropertyDescriptor(_,v);T&&!("get"in T?!_.__esModule:T.writable||T.configurable)||(T={enumerable:!0,get:function(){return _[v]}}),Object.defineProperty(g,E,T)}:function(g,_,v,E){E===void 0&&(E=v),g[E]=_[v]}),p=this&&this.__exportStar||function(g,_){for(var v in g)v==="default"||Object.prototype.hasOwnProperty.call(_,v)||f(_,g,v)};Object.defineProperty(h,"__esModule",{value:!0}),h.VERSION=void 0,h.VERSION="0.2.0",p(d(815),h),p(d(456),h),p(d(987),h),p(d(293),h)},293:(u,h)=>{Object.defineProperty(h,"__esModule",{value:!0}),h.getErr=h.getOk_or=h.getOk=h.isNotOk=h.isOk=h.err=h.ok=void 0,h.ok=function(d){return{ok:!0,value:d}},h.err=function(d){return{ok:!1,error:d}},h.isOk=function(d){return d.ok===!0},h.isNotOk=function(d){return!(0,h.isOk)(d)},h.getOk=function(d){return d.ok===!0?d.value:void 0},h.getOk_or=function(d,f){return d.ok===!0?d.value:f},h.getErr=function(d){return d.ok===!0?void 0:d.error}}},l={};return function u(h){var d=l[h];if(d!==void 0)return d.exports;var f=l[h]={exports:{}};return c[h].call(f.exports,f,f.exports,u),f.exports}(156)})(),a.exports=o()},1989:(a,o,c)=>{var l=c(1789),u=c(401),h=c(7667),d=c(1327),f=c(1866);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var E=g[_];this.set(E[0],E[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},8407:(a,o,c)=>{var l=c(7040),u=c(4125),h=c(2117),d=c(7518),f=c(4705);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var E=g[_];this.set(E[0],E[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},7071:(a,o,c)=>{var l=c(852)(c(5639),"Map");a.exports=l},3369:(a,o,c)=>{var l=c(4785),u=c(1285),h=c(6e3),d=c(9916),f=c(5265);function p(g){var _=-1,v=g==null?0:g.length;for(this.clear();++_<v;){var E=g[_];this.set(E[0],E[1])}}p.prototype.clear=l,p.prototype.delete=u,p.prototype.get=h,p.prototype.has=d,p.prototype.set=f,a.exports=p},6384:(a,o,c)=>{var l=c(8407),u=c(7465),h=c(3779),d=c(7599),f=c(4758),p=c(4309);function g(_){var v=this.__data__=new l(_);this.size=v.size}g.prototype.clear=u,g.prototype.delete=h,g.prototype.get=d,g.prototype.has=f,g.prototype.set=p,a.exports=g},2705:(a,o,c)=>{var l=c(5639).Symbol;a.exports=l},1149:(a,o,c)=>{var l=c(5639).Uint8Array;a.exports=l},6874:a=>{a.exports=function(o,c,l){switch(l.length){case 0:return o.call(c);case 1:return o.call(c,l[0]);case 2:return o.call(c,l[0],l[1]);case 3:return o.call(c,l[0],l[1],l[2])}return o.apply(c,l)}},4636:(a,o,c)=>{var l=c(2545),u=c(5694),h=c(1469),d=c(4144),f=c(5776),p=c(6719),g=Object.prototype.hasOwnProperty;a.exports=function(_,v){var E=h(_),T=!E&&u(_),x=!E&&!T&&d(_),N=!E&&!T&&!x&&p(_),A=E||T||x||N,I=A?l(_.length,String):[],k=I.length;for(var L in _)!v&&!g.call(_,L)||A&&(L=="length"||x&&(L=="offset"||L=="parent")||N&&(L=="buffer"||L=="byteLength"||L=="byteOffset")||f(L,k))||I.push(L);return I}},6556:(a,o,c)=>{var l=c(9465),u=c(7813);a.exports=function(h,d,f){(f!==void 0&&!u(h[d],f)||f===void 0&&!(d in h))&&l(h,d,f)}},4865:(a,o,c)=>{var l=c(9465),u=c(7813),h=Object.prototype.hasOwnProperty;a.exports=function(d,f,p){var g=d[f];h.call(d,f)&&u(g,p)&&(p!==void 0||f in d)||l(d,f,p)}},8470:(a,o,c)=>{var l=c(7813);a.exports=function(u,h){for(var d=u.length;d--;)if(l(u[d][0],h))return d;return-1}},9465:(a,o,c)=>{var l=c(8777);a.exports=function(u,h,d){h=="__proto__"&&l?l(u,h,{configurable:!0,enumerable:!0,value:d,writable:!0}):u[h]=d}},3118:(a,o,c)=>{var l=c(3218),u=Object.create,h=function(){function d(){}return function(f){if(!l(f))return{};if(u)return u(f);d.prototype=f;var p=new d;return d.prototype=void 0,p}}();a.exports=h},8483:(a,o,c)=>{var l=c(5063)();a.exports=l},4239:(a,o,c)=>{var l=c(2705),u=c(9607),h=c(2333),d="[object Null]",f="[object Undefined]",p=l?l.toStringTag:void 0;a.exports=function(g){return g==null?g===void 0?f:d:p&&p in Object(g)?u(g):h(g)}},9454:(a,o,c)=>{var l=c(4239),u=c(7005),h="[object Arguments]";a.exports=function(d){return u(d)&&l(d)==h}},8458:(a,o,c)=>{var l=c(3560),u=c(5346),h=c(3218),d=c(346),f=/^\[object .+?Constructor\]$/,p=Function.prototype,g=Object.prototype,_=p.toString,v=g.hasOwnProperty,E=RegExp("^"+_.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(T){return!(!h(T)||u(T))&&(l(T)?E:f).test(d(T))}},8749:(a,o,c)=>{var l=c(4239),u=c(1780),h=c(7005),d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Arguments]"]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d["[object Map]"]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1,a.exports=function(f){return h(f)&&u(f.length)&&!!d[l(f)]}},313:(a,o,c)=>{var l=c(3218),u=c(5726),h=c(3498),d=Object.prototype.hasOwnProperty;a.exports=function(f){if(!l(f))return h(f);var p=u(f),g=[];for(var _ in f)(_!="constructor"||!p&&d.call(f,_))&&g.push(_);return g}},2980:(a,o,c)=>{var l=c(6384),u=c(6556),h=c(8483),d=c(9783),f=c(3218),p=c(1704),g=c(6390);a.exports=function _(v,E,T,x,N){v!==E&&h(E,function(A,I){if(N||(N=new l),f(A))d(v,E,I,T,_,x,N);else{var k=x?x(g(v,I),A,I+"",v,E,N):void 0;k===void 0&&(k=A),u(v,I,k)}},p)}},9783:(a,o,c)=>{var l=c(6556),u=c(4626),h=c(7133),d=c(278),f=c(8517),p=c(5694),g=c(1469),_=c(9246),v=c(4144),E=c(3560),T=c(3218),x=c(8630),N=c(6719),A=c(6390),I=c(9881);a.exports=function(k,L,U,$,q,G,X){var ie=A(k,U),V=A(L,U),Z=X.get(V);if(Z)l(k,U,Z);else{var Y=G?G(ie,V,U+"",k,L,X):void 0,ee=Y===void 0;if(ee){var oe=g(V),de=!oe&&v(V),Me=!oe&&!de&&N(V);Y=V,oe||de||Me?g(ie)?Y=ie:_(ie)?Y=d(ie):de?(ee=!1,Y=u(V,!0)):Me?(ee=!1,Y=h(V,!0)):Y=[]:x(V)||p(V)?(Y=ie,p(ie)?Y=I(ie):T(ie)&&!E(ie)||(Y=f(V))):ee=!1}ee&&(X.set(V,Y),q(Y,V,$,G,X),X.delete(V)),l(k,U,Y)}}},5976:(a,o,c)=>{var l=c(6557),u=c(5357),h=c(61);a.exports=function(d,f){return h(u(d,f,l),d+"")}},6560:(a,o,c)=>{var l=c(5703),u=c(8777),h=c(6557),d=u?function(f,p){return u(f,"toString",{configurable:!0,enumerable:!1,value:l(p),writable:!0})}:h;a.exports=d},2545:a=>{a.exports=function(o,c){for(var l=-1,u=Array(o);++l<o;)u[l]=c(l);return u}},1717:a=>{a.exports=function(o){return function(c){return o(c)}}},4318:(a,o,c)=>{var l=c(1149);a.exports=function(u){var h=new u.constructor(u.byteLength);return new l(h).set(new l(u)),h}},4626:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,d=h&&h.exports===u?l.Buffer:void 0,f=d?d.allocUnsafe:void 0;a.exports=function(p,g){if(g)return p.slice();var _=p.length,v=f?f(_):new p.constructor(_);return p.copy(v),v}},7133:(a,o,c)=>{var l=c(4318);a.exports=function(u,h){var d=h?l(u.buffer):u.buffer;return new u.constructor(d,u.byteOffset,u.length)}},278:a=>{a.exports=function(o,c){var l=-1,u=o.length;for(c||(c=Array(u));++l<u;)c[l]=o[l];return c}},8363:(a,o,c)=>{var l=c(4865),u=c(9465);a.exports=function(h,d,f,p){var g=!f;f||(f={});for(var _=-1,v=d.length;++_<v;){var E=d[_],T=p?p(f[E],h[E],E,f,h):void 0;T===void 0&&(T=h[E]),g?u(f,E,T):l(f,E,T)}return f}},4429:(a,o,c)=>{var l=c(5639)["__core-js_shared__"];a.exports=l},1463:(a,o,c)=>{var l=c(5976),u=c(6612);a.exports=function(h){return l(function(d,f){var p=-1,g=f.length,_=g>1?f[g-1]:void 0,v=g>2?f[2]:void 0;for(_=h.length>3&&typeof _=="function"?(g--,_):void 0,v&&u(f[0],f[1],v)&&(_=g<3?void 0:_,g=1),d=Object(d);++p<g;){var E=f[p];E&&h(d,E,p,_)}return d})}},5063:a=>{a.exports=function(o){return function(c,l,u){for(var h=-1,d=Object(c),f=u(c),p=f.length;p--;){var g=f[o?p:++h];if(l(d[g],g,d)===!1)break}return c}}},8777:(a,o,c)=>{var l=c(852),u=function(){try{var h=l(Object,"defineProperty");return h({},"",{}),h}catch{}}();a.exports=u},1957:(a,o,c)=>{var l=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g;a.exports=l},5050:(a,o,c)=>{var l=c(7019);a.exports=function(u,h){var d=u.__data__;return l(h)?d[typeof h=="string"?"string":"hash"]:d.map}},852:(a,o,c)=>{var l=c(8458),u=c(7801);a.exports=function(h,d){var f=u(h,d);return l(f)?f:void 0}},5924:(a,o,c)=>{var l=c(5569)(Object.getPrototypeOf,Object);a.exports=l},9607:(a,o,c)=>{var l=c(2705),u=Object.prototype,h=u.hasOwnProperty,d=u.toString,f=l?l.toStringTag:void 0;a.exports=function(p){var g=h.call(p,f),_=p[f];try{p[f]=void 0;var v=!0}catch{}var E=d.call(p);return v&&(g?p[f]=_:delete p[f]),E}},7801:a=>{a.exports=function(o,c){return o==null?void 0:o[c]}},1789:(a,o,c)=>{var l=c(4536);a.exports=function(){this.__data__=l?l(null):{},this.size=0}},401:a=>{a.exports=function(o){var c=this.has(o)&&delete this.__data__[o];return this.size-=c?1:0,c}},7667:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__",h=Object.prototype.hasOwnProperty;a.exports=function(d){var f=this.__data__;if(l){var p=f[d];return p===u?void 0:p}return h.call(f,d)?f[d]:void 0}},1327:(a,o,c)=>{var l=c(4536),u=Object.prototype.hasOwnProperty;a.exports=function(h){var d=this.__data__;return l?d[h]!==void 0:u.call(d,h)}},1866:(a,o,c)=>{var l=c(4536),u="__lodash_hash_undefined__";a.exports=function(h,d){var f=this.__data__;return this.size+=this.has(h)?0:1,f[h]=l&&d===void 0?u:d,this}},8517:(a,o,c)=>{var l=c(3118),u=c(5924),h=c(5726);a.exports=function(d){return typeof d.constructor!="function"||h(d)?{}:l(u(d))}},5776:a=>{var o=9007199254740991,c=/^(?:0|[1-9]\d*)$/;a.exports=function(l,u){var h=typeof l;return!!(u=u??o)&&(h=="number"||h!="symbol"&&c.test(l))&&l>-1&&l%1==0&&l<u}},6612:(a,o,c)=>{var l=c(7813),u=c(8612),h=c(5776),d=c(3218);a.exports=function(f,p,g){if(!d(g))return!1;var _=typeof p;return!!(_=="number"?u(g)&&h(p,g.length):_=="string"&&p in g)&&l(g[p],f)}},7019:a=>{a.exports=function(o){var c=typeof o;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?o!=="__proto__":o===null}},5346:(a,o,c)=>{var l,u=c(4429),h=(l=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+l:"";a.exports=function(d){return!!h&&h in d}},5726:a=>{var o=Object.prototype;a.exports=function(c){var l=c&&c.constructor;return c===(typeof l=="function"&&l.prototype||o)}},7040:a=>{a.exports=function(){this.__data__=[],this.size=0}},4125:(a,o,c)=>{var l=c(8470),u=Array.prototype.splice;a.exports=function(h){var d=this.__data__,f=l(d,h);return!(f<0)&&(f==d.length-1?d.pop():u.call(d,f,1),--this.size,!0)}},2117:(a,o,c)=>{var l=c(8470);a.exports=function(u){var h=this.__data__,d=l(h,u);return d<0?void 0:h[d][1]}},7518:(a,o,c)=>{var l=c(8470);a.exports=function(u){return l(this.__data__,u)>-1}},4705:(a,o,c)=>{var l=c(8470);a.exports=function(u,h){var d=this.__data__,f=l(d,u);return f<0?(++this.size,d.push([u,h])):d[f][1]=h,this}},4785:(a,o,c)=>{var l=c(1989),u=c(8407),h=c(7071);a.exports=function(){this.size=0,this.__data__={hash:new l,map:new(h||u),string:new l}}},1285:(a,o,c)=>{var l=c(5050);a.exports=function(u){var h=l(this,u).delete(u);return this.size-=h?1:0,h}},6e3:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).get(u)}},9916:(a,o,c)=>{var l=c(5050);a.exports=function(u){return l(this,u).has(u)}},5265:(a,o,c)=>{var l=c(5050);a.exports=function(u,h){var d=l(this,u),f=d.size;return d.set(u,h),this.size+=d.size==f?0:1,this}},4536:(a,o,c)=>{var l=c(852)(Object,"create");a.exports=l},3498:a=>{a.exports=function(o){var c=[];if(o!=null)for(var l in Object(o))c.push(l);return c}},1167:(a,o,c)=>{a=c.nmd(a);var l=c(1957),u=o&&!o.nodeType&&o,h=u&&a&&!a.nodeType&&a,d=h&&h.exports===u&&l.process,f=function(){try{var p=h&&h.require&&h.require("util").types;return p||d&&d.binding&&d.binding("util")}catch{}}();a.exports=f},2333:a=>{var o=Object.prototype.toString;a.exports=function(c){return o.call(c)}},5569:a=>{a.exports=function(o,c){return function(l){return o(c(l))}}},5357:(a,o,c)=>{var l=c(6874),u=Math.max;a.exports=function(h,d,f){return d=u(d===void 0?h.length-1:d,0),function(){for(var p=arguments,g=-1,_=u(p.length-d,0),v=Array(_);++g<_;)v[g]=p[d+g];g=-1;for(var E=Array(d+1);++g<d;)E[g]=p[g];return E[d]=f(v),l(h,this,E)}}},5639:(a,o,c)=>{var l=c(1957),u=typeof self=="object"&&self&&self.Object===Object&&self,h=l||u||Function("return this")();a.exports=h},6390:a=>{a.exports=function(o,c){if((c!=="constructor"||typeof o[c]!="function")&&c!="__proto__")return o[c]}},61:(a,o,c)=>{var l=c(6560),u=c(1275)(l);a.exports=u},1275:a=>{var o=800,c=16,l=Date.now;a.exports=function(u){var h=0,d=0;return function(){var f=l(),p=c-(f-d);if(d=f,p>0){if(++h>=o)return arguments[0]}else h=0;return u.apply(void 0,arguments)}}},7465:(a,o,c)=>{var l=c(8407);a.exports=function(){this.__data__=new l,this.size=0}},3779:a=>{a.exports=function(o){var c=this.__data__,l=c.delete(o);return this.size=c.size,l}},7599:a=>{a.exports=function(o){return this.__data__.get(o)}},4758:a=>{a.exports=function(o){return this.__data__.has(o)}},4309:(a,o,c)=>{var l=c(8407),u=c(7071),h=c(3369),d=200;a.exports=function(f,p){var g=this.__data__;if(g instanceof l){var _=g.__data__;if(!u||_.length<d-1)return _.push([f,p]),this.size=++g.size,this;g=this.__data__=new h(_)}return g.set(f,p),this.size=g.size,this}},346:a=>{var o=Function.prototype.toString;a.exports=function(c){if(c!=null){try{return o.call(c)}catch{}try{return c+""}catch{}}return""}},5703:a=>{a.exports=function(o){return function(){return o}}},7813:a=>{a.exports=function(o,c){return o===c||o!=o&&c!=c}},6557:a=>{a.exports=function(o){return o}},5694:(a,o,c)=>{var l=c(9454),u=c(7005),h=Object.prototype,d=h.hasOwnProperty,f=h.propertyIsEnumerable,p=l(function(){return arguments}())?l:function(g){return u(g)&&d.call(g,"callee")&&!f.call(g,"callee")};a.exports=p},1469:a=>{var o=Array.isArray;a.exports=o},8612:(a,o,c)=>{var l=c(3560),u=c(1780);a.exports=function(h){return h!=null&&u(h.length)&&!l(h)}},9246:(a,o,c)=>{var l=c(8612),u=c(7005);a.exports=function(h){return u(h)&&l(h)}},4144:(a,o,c)=>{a=c.nmd(a);var l=c(5639),u=c(5062),h=o&&!o.nodeType&&o,d=h&&a&&!a.nodeType&&a,f=d&&d.exports===h?l.Buffer:void 0,p=(f?f.isBuffer:void 0)||u;a.exports=p},3560:(a,o,c)=>{var l=c(4239),u=c(3218),h="[object AsyncFunction]",d="[object Function]",f="[object GeneratorFunction]",p="[object Proxy]";a.exports=function(g){if(!u(g))return!1;var _=l(g);return _==d||_==f||_==h||_==p}},1780:a=>{var o=9007199254740991;a.exports=function(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=o}},3218:a=>{a.exports=function(o){var c=typeof o;return o!=null&&(c=="object"||c=="function")}},7005:a=>{a.exports=function(o){return o!=null&&typeof o=="object"}},8630:(a,o,c)=>{var l=c(4239),u=c(5924),h=c(7005),d="[object Object]",f=Function.prototype,p=Object.prototype,g=f.toString,_=p.hasOwnProperty,v=g.call(Object);a.exports=function(E){if(!h(E)||l(E)!=d)return!1;var T=u(E);if(T===null)return!0;var x=_.call(T,"constructor")&&T.constructor;return typeof x=="function"&&x instanceof x&&g.call(x)==v}},6719:(a,o,c)=>{var l=c(8749),u=c(1717),h=c(1167),d=h&&h.isTypedArray,f=d?u(d):l;a.exports=f},1704:(a,o,c)=>{var l=c(4636),u=c(313),h=c(8612);a.exports=function(d){return h(d)?l(d,!0):u(d)}},6486:function(a,o,c){var l;a=c.nmd(a),(function(){var u,h="Expected a function",d="__lodash_hash_undefined__",f="__lodash_placeholder__",p=16,g=32,_=64,v=128,E=256,T=1/0,x=9007199254740991,N=NaN,A=4294967295,I=[["ary",v],["bind",1],["bindKey",2],["curry",8],["curryRight",p],["flip",512],["partial",g],["partialRight",_],["rearg",E]],k="[object Arguments]",L="[object Array]",U="[object Boolean]",$="[object Date]",q="[object Error]",G="[object Function]",X="[object GeneratorFunction]",ie="[object Map]",V="[object Number]",Z="[object Object]",Y="[object Promise]",ee="[object RegExp]",oe="[object Set]",de="[object String]",Me="[object Symbol]",He="[object WeakMap]",Te="[object ArrayBuffer]",Le="[object DataView]",we="[object Float32Array]",Ce="[object Float64Array]",ke="[object Int8Array]",St="[object Int16Array]",At="[object Int32Array]",Ee="[object Uint8Array]",ye="[object Uint8ClampedArray]",et="[object Uint16Array]",fe="[object Uint32Array]",Fe=/\b__p \+= '';/g,Ie=/\b(__p \+=) '' \+/g,it=/(__e\(.*?\)|\b__t\)) \+\n'';/g,dt=/&(?:amp|lt|gt|quot|#39);/g,gt=/[&<>"']/g,bt=RegExp(dt.source),be=RegExp(gt.source),ue=/<%-([\s\S]+?)%>/g,Xe=/<%([\s\S]+?)%>/g,nt=/<%=([\s\S]+?)%>/g,$e=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ue=/^\w*$/,qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mt=/[\\^$.*+?()[\]{}|]/g,Yt=RegExp(Mt.source),ce=/^\s+/,j=/\s/,W=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,me=/\{\n\/\* \[wrapped with (.+)\] \*/,De=/,? & /,je=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,mt=/[()=,{}\[\]\/\s]/,xt=/\\(\\)?/g,Vn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qe=/\w*$/,Vt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,Pt=/^\[object .+?Constructor\]$/,hn=/^0o[0-7]+$/i,an=/^(?:0|[1-9]\d*)$/,Ve=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ot=/($^)/,Ct=/['\n\r\u2028\u2029\\]/g,Nt="\\ud800-\\udfff",Wn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",sr="\\u2700-\\u27bf",Si="a-z\\xdf-\\xf6\\xf8-\\xff",si="A-Z\\xc0-\\xd6\\xd8-\\xde",En="\\ufe0e\\ufe0f",sn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ln="[']",Nn="["+Nt+"]",di="["+sn+"]",ur="["+Wn+"]",ei="\\d+",La="["+sr+"]",gu="["+Si+"]",Zd="[^"+Nt+sn+ei+sr+Si+si+"]",mp="\\ud83c[\\udffb-\\udfff]",u0="[^"+Nt+"]",Qd="(?:\\ud83c[\\udde6-\\uddff]){2}",ef="[\\ud800-\\udbff][\\udc00-\\udfff]",vu="["+si+"]",ve="\\u200d",Ke="(?:"+gu+"|"+Zd+")",vt="(?:"+vu+"|"+Zd+")",yt="(?:['](?:d|ll|m|re|s|t|ve))?",Ze="(?:['](?:D|LL|M|RE|S|T|VE))?",Ht="(?:"+ur+"|"+mp+")?",nn="["+En+"]?",mn=nn+Ht+("(?:"+ve+"(?:"+[u0,Qd,ef].join("|")+")"+nn+Ht+")*"),Sn="(?:"+[La,Qd,ef].join("|")+")"+mn,oi="(?:"+[u0+ur+"?",ur,Qd,ef,Nn].join("|")+")",ci=RegExp(Ln,"g"),Cn=RegExp(ur,"g"),gi=RegExp(mp+"(?="+mp+")|"+oi+mn,"g"),ar=RegExp([vu+"?"+gu+"+"+yt+"(?="+[di,vu,"$"].join("|")+")",vt+"+"+Ze+"(?="+[di,vu+Ke,"$"].join("|")+")",vu+"?"+Ke+"+"+yt,vu+"+"+Ze,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ei,Sn].join("|"),"g"),As=RegExp("["+ve+Nt+Wn+En+"]"),vs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ki=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Yn=-1,Ti={};Ti[we]=Ti[Ce]=Ti[ke]=Ti[St]=Ti[At]=Ti[Ee]=Ti[ye]=Ti[et]=Ti[fe]=!0,Ti[k]=Ti[L]=Ti[Te]=Ti[U]=Ti[Le]=Ti[$]=Ti[q]=Ti[G]=Ti[ie]=Ti[V]=Ti[Z]=Ti[ee]=Ti[oe]=Ti[de]=Ti[He]=!1;var Bn={};Bn[k]=Bn[L]=Bn[Te]=Bn[Le]=Bn[U]=Bn[$]=Bn[we]=Bn[Ce]=Bn[ke]=Bn[St]=Bn[At]=Bn[ie]=Bn[V]=Bn[Z]=Bn[ee]=Bn[oe]=Bn[de]=Bn[Me]=Bn[Ee]=Bn[ye]=Bn[et]=Bn[fe]=!0,Bn[q]=Bn[G]=Bn[He]=!1;var Ho={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},zl=parseFloat,eo=parseInt,sh=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g,cs=typeof self=="object"&&self&&self.Object===Object&&self,bn=sh||cs||Function("return this")(),to=o&&!o.nodeType&&o,Hs=to&&a&&!a.nodeType&&a,qn=Hs&&Hs.exports===to,_l=qn&&sh.process,oa=function(){try{var ft=Hs&&Hs.require&&Hs.require("util").types;return ft||_l&&_l.binding&&_l.binding("util")}catch{}}(),gp=oa&&oa.isArrayBuffer,rd=oa&&oa.isDate,ah=oa&&oa.isMap,h0=oa&&oa.isRegExp,wy=oa&&oa.isSet,d0=oa&&oa.isTypedArray;function jo(ft,at,Ft){switch(Ft.length){case 0:return ft.call(at);case 1:return ft.call(at,Ft[0]);case 2:return ft.call(at,Ft[0],Ft[1]);case 3:return ft.call(at,Ft[0],Ft[1],Ft[2])}return ft.apply(at,Ft)}function f0(ft,at,Ft,fn){for(var Xt=-1,ji=ft==null?0:ft.length;++Xt<ji;){var la=ft[Xt];at(fn,la,Ft(la),ft)}return fn}function Vo(ft,at){for(var Ft=-1,fn=ft==null?0:ft.length;++Ft<fn&&at(ft[Ft],Ft,ft)!==!1;);return ft}function lx(ft,at){for(var Ft=ft==null?0:ft.length;Ft--&&at(ft[Ft],Ft,ft)!==!1;);return ft}function sE(ft,at){for(var Ft=-1,fn=ft==null?0:ft.length;++Ft<fn;)if(!at(ft[Ft],Ft,ft))return!1;return!0}function yu(ft,at){for(var Ft=-1,fn=ft==null?0:ft.length,Xt=0,ji=[];++Ft<fn;){var la=ft[Ft];at(la,Ft,ft)&&(ji[Xt++]=la)}return ji}function vm(ft,at){return!!(ft!=null&&ft.length)&&nf(ft,at,0)>-1}function sd(ft,at,Ft){for(var fn=-1,Xt=ft==null?0:ft.length;++fn<Xt;)if(Ft(at,ft[fn]))return!0;return!1}function Ss(ft,at){for(var Ft=-1,fn=ft==null?0:ft.length,Xt=Array(fn);++Ft<fn;)Xt[Ft]=at(ft[Ft],Ft,ft);return Xt}function oh(ft,at){for(var Ft=-1,fn=at.length,Xt=ft.length;++Ft<fn;)ft[Xt+Ft]=at[Ft];return ft}function Cy(ft,at,Ft,fn){var Xt=-1,ji=ft==null?0:ft.length;for(fn&&ji&&(Ft=ft[++Xt]);++Xt<ji;)Ft=at(Ft,ft[Xt],Xt,ft);return Ft}function aE(ft,at,Ft,fn){var Xt=ft==null?0:ft.length;for(fn&&Xt&&(Ft=ft[--Xt]);Xt--;)Ft=at(Ft,ft[Xt],Xt,ft);return Ft}function Ry(ft,at){for(var Ft=-1,fn=ft==null?0:ft.length;++Ft<fn;)if(at(ft[Ft],Ft,ft))return!0;return!1}var ux=p0("length");function oE(ft,at,Ft){var fn;return Ft(ft,function(Xt,ji,la){if(at(Xt,ji,la))return fn=ji,!1}),fn}function tf(ft,at,Ft,fn){for(var Xt=ft.length,ji=Ft+(fn?1:-1);fn?ji--:++ji<Xt;)if(at(ft[ji],ji,ft))return ji;return-1}function nf(ft,at,Ft){return at==at?function(fn,Xt,ji){for(var la=ji-1,lh=fn.length;++la<lh;)if(fn[la]===Xt)return la;return-1}(ft,at,Ft):tf(ft,cE,Ft)}function Ay(ft,at,Ft,fn){for(var Xt=Ft-1,ji=ft.length;++Xt<ji;)if(fn(ft[Xt],at))return Xt;return-1}function cE(ft){return ft!=ft}function lE(ft,at){var Ft=ft==null?0:ft.length;return Ft?ch(ft,at)/Ft:N}function p0(ft){return function(at){return at==null?u:at[ft]}}function My(ft){return function(at){return ft==null?u:ft[at]}}function uE(ft,at,Ft,fn,Xt){return Xt(ft,function(ji,la,lh){Ft=fn?(fn=!1,ji):at(Ft,ji,la,lh)}),Ft}function ch(ft,at){for(var Ft,fn=-1,Xt=ft.length;++fn<Xt;){var ji=at(ft[fn]);ji!==u&&(Ft=Ft===u?ji:Ft+ji)}return Ft}function ym(ft,at){for(var Ft=-1,fn=Array(ft);++Ft<ft;)fn[Ft]=at(Ft);return fn}function hE(ft){return ft&&ft.slice(0,g0(ft)+1).replace(ce,"")}function hc(ft){return function(at){return ft(at)}}function Ms(ft,at){return Ss(at,function(Ft){return ft[Ft]})}function ad(ft,at){return ft.has(at)}function hx(ft,at){for(var Ft=-1,fn=ft.length;++Ft<fn&&nf(at,ft[Ft],0)>-1;);return Ft}function ca(ft,at){for(var Ft=ft.length;Ft--&&nf(at,ft[Ft],0)>-1;);return Ft}var dx=My({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),m0=My({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function fx(ft){return"\\"+Ho[ft]}function rf(ft){return As.test(ft)}function _m(ft){var at=-1,Ft=Array(ft.size);return ft.forEach(function(fn,Xt){Ft[++at]=[Xt,fn]}),Ft}function no(ft,at){return function(Ft){return ft(at(Ft))}}function dc(ft,at){for(var Ft=-1,fn=ft.length,Xt=0,ji=[];++Ft<fn;){var la=ft[Ft];la!==at&&la!==f||(ft[Ft]=f,ji[Xt++]=Ft)}return ji}function bm(ft){var at=-1,Ft=Array(ft.size);return ft.forEach(function(fn){Ft[++at]=fn}),Ft}function px(ft){var at=-1,Ft=Array(ft.size);return ft.forEach(function(fn){Ft[++at]=[fn,fn]}),Ft}function Ta(ft){return rf(ft)?function(at){for(var Ft=gi.lastIndex=0;gi.test(at);)++Ft;return Ft}(ft):ux(ft)}function Ys(ft){return rf(ft)?function(at){return at.match(gi)||[]}(ft):function(at){return at.split("")}(ft)}function g0(ft){for(var at=ft.length;at--&&j.test(ft.charAt(at)););return at}var od=My({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),vp=function ft(at){var Ft,fn=(at=at==null?bn:vp.defaults(bn.Object(),at,vp.pick(bn,Ki))).Array,Xt=at.Date,ji=at.Error,la=at.Function,lh=at.Math,Ji=at.Object,Hl=at.RegExp,uh=at.String,$c=at.TypeError,Em=fn.prototype,v0=la.prototype,_u=Ji.prototype,Wc=at["__core-js_shared__"],Ua=v0.toString,Ar=_u.hasOwnProperty,y0=0,Oy=(Ft=/[^.]+$/.exec(Wc&&Wc.keys&&Wc.keys.IE_PROTO||""))?"Symbol(src)_1."+Ft:"",sf=_u.toString,af=Ua.call(Ji),Ny=bn._,mx=Hl("^"+Ua.call(Ar).replace(Mt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Go=qn?at.Buffer:u,cd=at.Symbol,hh=at.Uint8Array,dE=Go?Go.allocUnsafe:u,Sm=no(Ji.getPrototypeOf,Ji),Tm=Ji.create,_0=_u.propertyIsEnumerable,of=Em.splice,b0=cd?cd.isConcatSpreadable:u,bu=cd?cd.iterator:u,Fr=cd?cd.toStringTag:u,E0=function(){try{var b=wl(Ji,"defineProperty");return b({},"",{}),b}catch{}}(),dn=at.clearTimeout!==bn.clearTimeout&&at.clearTimeout,ua=Xt&&Xt.now!==bn.Date.now&&Xt.now,S0=at.setTimeout!==bn.setTimeout&&at.setTimeout,Eu=lh.ceil,Yc=lh.floor,T0=Ji.getOwnPropertySymbols,yp=Go?Go.isBuffer:u,xa=at.isFinite,fE=Em.join,fc=no(Ji.keys,Ji),Ts=lh.max,Xs=lh.min,Ii=Xt.now,pc=at.parseInt,To=lh.random,_p=Em.reverse,x0=wl(at,"DataView"),xo=wl(at,"Map"),Bt=wl(at,"Promise"),wa=wl(at,"Set"),xm=wl(at,"WeakMap"),cf=wl(Ji,"create"),ld=xm&&new xm,ha={},w0=Op(x0),mc=Op(xo),gx=Op(Bt),bl=Op(wa),bp=Op(xm),jl=cd?cd.prototype:u,lf=jl?jl.valueOf:u,wm=jl?jl.toString:u;function ge(b){if(P(b)&&!Jn(b)&&!(b instanceof Bi)){if(b instanceof io)return b;if(Ar.call(b,"__wrapped__"))return IE(b)}return new io(b)}var ud=function(){function b(){}return function(w){if(!M(w))return{};if(Tm)return Tm(w);b.prototype=w;var F=new b;return b.prototype=u,F}}();function dh(){}function io(b,w){this.__wrapped__=b,this.__actions__=[],this.__chain__=!!w,this.__index__=0,this.__values__=u}function Bi(b){this.__wrapped__=b,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=A,this.__views__=[]}function hd(b){var w=-1,F=b==null?0:b.length;for(this.clear();++w<F;){var Q=b[w];this.set(Q[0],Q[1])}}function Su(b){var w=-1,F=b==null?0:b.length;for(this.clear();++w<F;){var Q=b[w];this.set(Q[0],Q[1])}}function Xc(b){var w=-1,F=b==null?0:b.length;for(this.clear();++w<F;){var Q=b[w];this.set(Q[0],Q[1])}}function Tu(b){var w=-1,F=b==null?0:b.length;for(this.__data__=new Xc;++w<F;)this.add(b[w])}function gc(b){var w=this.__data__=new Su(b);this.size=w.size}function Iy(b,w){var F=Jn(b),Q=!F&&Hr(b),le=!F&&!Q&&mf(b),xe=!F&&!Q&&!le&&pe(b),Pe=F||Q||le||xe,We=Pe?ym(b.length,uh):[],ct=We.length;for(var kt in b)!w&&!Ar.call(b,kt)||Pe&&(kt=="length"||le&&(kt=="offset"||kt=="parent")||xe&&(kt=="buffer"||kt=="byteLength"||kt=="byteOffset")||Os(kt,ct))||We.push(kt);return We}function Vl(b){var w=b.length;return w?b[EE(0,w-1)]:u}function ky(b,w){return W0(_c(b),dd(w,0,b.length))}function C0(b){return W0(_c(b))}function R0(b,w,F){(F!==u&&!Ns(b[w],F)||F===u&&!(w in b))&&xu(b,w,F)}function uf(b,w,F){var Q=b[w];Ar.call(b,w)&&Ns(Q,F)&&(F!==u||w in b)||xu(b,w,F)}function wo(b,w){for(var F=b.length;F--;)if(Ns(b[F][0],w))return F;return-1}function pE(b,w,F,Q){return El(b,function(le,xe,Pe){w(Q,le,F(le),Pe)}),Q}function qo(b,w){return b&&Ou(w,Tn(w),b)}function xu(b,w,F){w=="__proto__"&&E0?E0(b,w,{configurable:!0,enumerable:!0,value:F,writable:!0}):b[w]=F}function A0(b,w){for(var F=-1,Q=w.length,le=fn(Q),xe=b==null;++F<Q;)le[F]=xe?u:Ri(b,w[F]);return le}function dd(b,w,F){return b==b&&(F!==u&&(b=b<=F?b:F),w!==u&&(b=b>=w?b:w)),b}function vc(b,w,F,Q,le,xe){var Pe,We=1&w,ct=2&w,kt=4&w;if(F&&(Pe=le?F(b,Q,le,xe):F(b)),Pe!==u)return Pe;if(!M(b))return b;var Lt=Jn(b);if(Lt){if(Pe=function(Ut){var Zt=Ut.length,mi=new Ut.constructor(Zt);return Zt&&typeof Ut[0]=="string"&&Ar.call(Ut,"index")&&(mi.index=Ut.index,mi.input=Ut.input),mi}(b),!We)return _c(b,Pe)}else{var Wt=Fa(b),An=Wt==G||Wt==X;if(mf(b))return vi(b,We);if(Wt==Z||Wt==k||An&&!le){if(Pe=ct||An?{}:xx(b),!We)return ct?function(Ut,Zt){return Ou(Ut,AE(Ut),Zt)}(b,function(Ut,Zt){return Ut&&Ou(Zt,$n(Zt),Ut)}(Pe,b)):function(Ut,Zt){return Ou(Ut,G0(Ut),Zt)}(b,qo(Pe,b))}else{if(!Bn[Wt])return le?b:{};Pe=function(Ut,Zt,mi){var Gt=Ut.constructor;switch(Zt){case Te:return km(Ut);case U:case $:return new Gt(+Ut);case Le:return function(on,In){var ln=In?km(on.buffer):on.buffer;return new on.constructor(ln,on.byteOffset,on.byteLength)}(Ut,mi);case we:case Ce:case ke:case St:case At:case Ee:case ye:case et:case fe:return Fy(Ut,mi);case ie:return new Gt;case V:case de:return new Gt(Ut);case ee:return function(on){var In=new on.constructor(on.source,qe.exec(on));return In.lastIndex=on.lastIndex,In}(Ut);case oe:return new Gt;case Me:return Mn=Ut,lf?Ji(lf.call(Mn)):{}}var Mn}(b,Wt,We)}}xe||(xe=new gc);var Un=xe.get(b);if(Un)return Un;xe.set(b,Pe),K(b)?b.forEach(function(Ut){Pe.add(vc(Ut,w,F,Ut,b,xe))}):B(b)&&b.forEach(function(Ut,Zt){Pe.set(Zt,vc(Ut,w,F,Zt,b,xe))});var ni=Lt?u:(kt?ct?Hy:CE:ct?$n:Tn)(b);return Vo(ni||b,function(Ut,Zt){ni&&(Ut=b[Zt=Ut]),uf(Pe,Zt,vc(Ut,w,F,Zt,b,xe))}),Pe}function ls(b,w,F){var Q=F.length;if(b==null)return!Q;for(b=Ji(b);Q--;){var le=F[Q],xe=w[le],Pe=b[le];if(Pe===u&&!(le in b)||!xe(Pe))return!1}return!0}function Dy(b,w,F){if(typeof b!="function")throw new $c(h);return Um(function(){b.apply(u,F)},w)}function hf(b,w,F,Q){var le=-1,xe=vm,Pe=!0,We=b.length,ct=[],kt=w.length;if(!We)return ct;F&&(w=Ss(w,hc(F))),Q?(xe=sd,Pe=!1):w.length>=200&&(xe=ad,Pe=!1,w=new Tu(w));e:for(;++le<We;){var Lt=b[le],Wt=F==null?Lt:F(Lt);if(Lt=Q||Lt!==0?Lt:0,Pe&&Wt==Wt){for(var An=kt;An--;)if(w[An]===Wt)continue e;ct.push(Lt)}else xe(w,Wt,Q)||ct.push(Lt)}return ct}ge.templateSettings={escape:ue,evaluate:Xe,interpolate:nt,variable:"",imports:{_:ge}},ge.prototype=dh.prototype,ge.prototype.constructor=ge,io.prototype=ud(dh.prototype),io.prototype.constructor=io,Bi.prototype=ud(dh.prototype),Bi.prototype.constructor=Bi,hd.prototype.clear=function(){this.__data__=cf?cf(null):{},this.size=0},hd.prototype.delete=function(b){var w=this.has(b)&&delete this.__data__[b];return this.size-=w?1:0,w},hd.prototype.get=function(b){var w=this.__data__;if(cf){var F=w[b];return F===d?u:F}return Ar.call(w,b)?w[b]:u},hd.prototype.has=function(b){var w=this.__data__;return cf?w[b]!==u:Ar.call(w,b)},hd.prototype.set=function(b,w){var F=this.__data__;return this.size+=this.has(b)?0:1,F[b]=cf&&w===u?d:w,this},Su.prototype.clear=function(){this.__data__=[],this.size=0},Su.prototype.delete=function(b){var w=this.__data__,F=wo(w,b);return!(F<0)&&(F==w.length-1?w.pop():of.call(w,F,1),--this.size,!0)},Su.prototype.get=function(b){var w=this.__data__,F=wo(w,b);return F<0?u:w[F][1]},Su.prototype.has=function(b){return wo(this.__data__,b)>-1},Su.prototype.set=function(b,w){var F=this.__data__,Q=wo(F,b);return Q<0?(++this.size,F.push([b,w])):F[Q][1]=w,this},Xc.prototype.clear=function(){this.size=0,this.__data__={hash:new hd,map:new(xo||Su),string:new hd}},Xc.prototype.delete=function(b){var w=jy(this,b).delete(b);return this.size-=w?1:0,w},Xc.prototype.get=function(b){return jy(this,b).get(b)},Xc.prototype.has=function(b){return jy(this,b).has(b)},Xc.prototype.set=function(b,w){var F=jy(this,b),Q=F.size;return F.set(b,w),this.size+=F.size==Q?0:1,this},Tu.prototype.add=Tu.prototype.push=function(b){return this.__data__.set(b,d),this},Tu.prototype.has=function(b){return this.__data__.has(b)},gc.prototype.clear=function(){this.__data__=new Su,this.size=0},gc.prototype.delete=function(b){var w=this.__data__,F=w.delete(b);return this.size=w.size,F},gc.prototype.get=function(b){return this.__data__.get(b)},gc.prototype.has=function(b){return this.__data__.has(b)},gc.prototype.set=function(b,w){var F=this.__data__;if(F instanceof Su){var Q=F.__data__;if(!xo||Q.length<199)return Q.push([b,w]),this.size=++F.size,this;F=this.__data__=new Xc(Q)}return F.set(b,w),this.size=F.size,this};var El=bx(wu),M0=bx(vE,!0);function mE(b,w){var F=!0;return El(b,function(Q,le,xe){return F=!!w(Q,le,xe)}),F}function Cm(b,w,F){for(var Q=-1,le=b.length;++Q<le;){var xe=b[Q],Pe=w(xe);if(Pe!=null&&(We===u?Pe==Pe&&!he(Pe):F(Pe,We)))var We=Pe,ct=xe}return ct}function Rm(b,w){var F=[];return El(b,function(Q,le,xe){w(Q,le,xe)&&F.push(Q)}),F}function Ba(b,w,F,Q,le){var xe=-1,Pe=b.length;for(F||(F=ME),le||(le=[]);++xe<Pe;){var We=b[xe];w>0&&F(We)?w>1?Ba(We,w-1,F,Q,le):oh(le,We):Q||(le[le.length]=We)}return le}var O0=Ex(),gE=Ex(!0);function wu(b,w){return b&&O0(b,w,Tn)}function vE(b,w){return b&&gE(b,w,Tn)}function Cu(b,w){return yu(w,function(F){return O(b[F])})}function js(b,w){for(var F=0,Q=(w=vh(w,b)).length;b!=null&&F<Q;)b=b[Du(w[F++])];return F&&F==Q?b:u}function Gl(b,w,F){var Q=w(b);return Jn(b)?Q:oh(Q,F(b))}function da(b){return b==null?b===u?"[object Undefined]":"[object Null]":Fr&&Fr in Ji(b)?function(w){var F=Ar.call(w,Fr),Q=w[Fr];try{w[Fr]=u;var le=!0}catch{}var xe=sf.call(w);return le&&(F?w[Fr]=Q:delete w[Fr]),xe}(b):function(w){return sf.call(w)}(b)}function zr(b,w){return b>w}function Am(b,w){return b!=null&&Ar.call(b,w)}function Mm(b,w){return b!=null&&w in Ji(b)}function Py(b,w,F){for(var Q=F?sd:vm,le=b[0].length,xe=b.length,Pe=xe,We=fn(xe),ct=1/0,kt=[];Pe--;){var Lt=b[Pe];Pe&&w&&(Lt=Ss(Lt,hc(w))),ct=Xs(Lt.length,ct),We[Pe]=!F&&(w||le>=120&&Lt.length>=120)?new Tu(Pe&&Lt):u}Lt=b[0];var Wt=-1,An=We[0];e:for(;++Wt<le&&kt.length<ct;){var Un=Lt[Wt],ni=w?w(Un):Un;if(Un=F||Un!==0?Un:0,!(An?ad(An,ni):Q(kt,ni,F))){for(Pe=xe;--Pe;){var Ut=We[Pe];if(!(Ut?ad(Ut,ni):Q(b[Pe],ni,F)))continue e}An&&An.push(ni),kt.push(Un)}}return kt}function yc(b,w,F){var Q=(b=NE(b,w=vh(w,b)))==null?b:b[Du(Ao(w))];return Q==null?u:jo(Q,b,F)}function N0(b){return P(b)&&da(b)==k}function or(b,w,F,Q,le){return b===w||(b==null||w==null||!P(b)&&!P(w)?b!=b&&w!=w:function(xe,Pe,We,ct,kt,Lt){var Wt=Jn(xe),An=Jn(Pe),Un=Wt?L:Fa(xe),ni=An?L:Fa(Pe),Ut=(Un=Un==k?Z:Un)==Z,Zt=(ni=ni==k?Z:ni)==Z,mi=Un==ni;if(mi&&mf(xe)){if(!mf(Pe))return!1;Wt=!0,Ut=!1}if(mi&&!Ut)return Lt||(Lt=new gc),Wt||pe(xe)?wE(xe,Pe,We,ct,kt,Lt):function(ln,Fn,xs,Ds,Ec,kr,fr){switch(xs){case Le:if(ln.byteLength!=Fn.byteLength||ln.byteOffset!=Fn.byteOffset)return!1;ln=ln.buffer,Fn=Fn.buffer;case Te:return!(ln.byteLength!=Fn.byteLength||!kr(new hh(ln),new hh(Fn)));case U:case $:case V:return Ns(+ln,+Fn);case q:return ln.name==Fn.name&&ln.message==Fn.message;case ee:case de:return ln==Fn+"";case ie:var Sc=_m;case oe:var Wl=1&Ds;if(Sc||(Sc=bm),ln.size!=Fn.size&&!Wl)return!1;var Jy=fr.get(ln);if(Jy)return Jy==Fn;Ds|=2,fr.set(ln,Fn);var Yl=wE(Sc(ln),Sc(Fn),Ds,Ec,kr,fr);return fr.delete(ln),Yl;case Me:if(lf)return lf.call(ln)==lf.call(Fn)}return!1}(xe,Pe,Un,We,ct,kt,Lt);if(!(1&We)){var Gt=Ut&&Ar.call(xe,"__wrapped__"),Mn=Zt&&Ar.call(Pe,"__wrapped__");if(Gt||Mn){var on=Gt?xe.value():xe,In=Mn?Pe.value():Pe;return Lt||(Lt=new gc),kt(on,In,We,ct,Lt)}}return mi?(Lt||(Lt=new gc),function(ln,Fn,xs,Ds,Ec,kr){var fr=1&xs,Sc=CE(ln),Wl=Sc.length,Jy=CE(Fn),Yl=Jy.length;if(Wl!=Yl&&!fr)return!1;for(var Ip=Wl;Ip--;){var _d=Sc[Ip];if(!(fr?_d in Fn:Ar.call(Fn,_d)))return!1}var bd=kr.get(ln),Ix=kr.get(Fn);if(bd&&Ix)return bd==Fn&&Ix==ln;var Zy=!0;kr.set(ln,Fn),kr.set(Fn,ln);for(var ev=fr;++Ip<Wl;){var tv=ln[_d=Sc[Ip]],Ed=Fn[_d];if(Ds)var HE=fr?Ds(Ed,tv,_d,Fn,ln,kr):Ds(tv,Ed,_d,ln,Fn,kr);if(!(HE===u?tv===Ed||Ec(tv,Ed,xs,Ds,kr):HE)){Zy=!1;break}ev||(ev=_d=="constructor")}if(Zy&&!ev){var yf=ln.constructor,$m=Fn.constructor;yf==$m||!("constructor"in ln)||!("constructor"in Fn)||typeof yf=="function"&&yf instanceof yf&&typeof $m=="function"&&$m instanceof $m||(Zy=!1)}return kr.delete(ln),kr.delete(Fn),Zy}(xe,Pe,We,ct,kt,Lt)):!1}(b,w,F,Q,or,le))}function I0(b,w,F,Q){var le=F.length,xe=le,Pe=!Q;if(b==null)return!xe;for(b=Ji(b);le--;){var We=F[le];if(Pe&&We[2]?We[1]!==b[We[0]]:!(We[0]in b))return!1}for(;++le<xe;){var ct=(We=F[le])[0],kt=b[ct],Lt=We[1];if(Pe&&We[2]){if(kt===u&&!(ct in b))return!1}else{var Wt=new gc;if(Q)var An=Q(kt,Lt,ct,b,w,Wt);if(!(An===u?or(Lt,kt,3,Q,Wt):An))return!1}}return!0}function vx(b){return!(!M(b)||(w=b,Oy&&Oy in w))&&(O(b)?mx:Pt).test(Op(b));var w}function yE(b){return typeof b=="function"?b:b==null?ps:typeof b=="object"?Jn(b)?fh(b[0],b[1]):k0(b):vf(b)}function _E(b){if(!q0(b))return fc(b);var w=[];for(var F in Ji(b))Ar.call(b,F)&&F!="constructor"&&w.push(F);return w}function yx(b){if(!M(b))return function(le){var xe=[];if(le!=null)for(var Pe in Ji(le))xe.push(Pe);return xe}(b);var w=q0(b),F=[];for(var Q in b)(Q!="constructor"||!w&&Ar.call(b,Q))&&F.push(Q);return F}function Ly(b,w){return b<w}function Ru(b,w){var F=-1,Q=co(b)?fn(b.length):[];return El(b,function(le,xe,Pe){Q[++F]=w(le,xe,Pe)}),Q}function k0(b){var w=ti(b);return w.length==1&&w[0][2]?Cx(w[0][0],w[0][1]):function(F){return F===b||I0(F,b,w)}}function fh(b,w){return Vy(b)&&wx(w)?Cx(Du(b),w):function(F){var Q=Ri(F,b);return Q===u&&Q===w?Di(F,b):or(w,Q,3)}}function D0(b,w,F,Q,le){b!==w&&O0(w,function(xe,Pe){if(le||(le=new gc),M(xe))(function(ct,kt,Lt,Wt,An,Un,ni){var Ut=$0(ct,Lt),Zt=$0(kt,Lt),mi=ni.get(Zt);if(mi)return void R0(ct,Lt,mi);var Gt=Un?Un(Ut,Zt,Lt+"",ct,kt,ni):u,Mn=Gt===u;if(Mn){var on=Jn(Zt),In=!on&&mf(Zt),ln=!on&&!In&&pe(Zt);Gt=Zt,on||In||ln?Jn(Ut)?Gt=Ut:Is(Ut)?Gt=_c(Ut):In?(Mn=!1,Gt=vi(Zt,!0)):ln?(Mn=!1,Gt=Fy(Zt,!0)):Gt=[]:te(Zt)||Hr(Zt)?(Gt=Ut,Hr(Ut)?Gt=Kt(Ut):M(Ut)&&!O(Ut)||(Gt=xx(Zt))):Mn=!1}Mn&&(ni.set(Zt,Gt),An(Gt,Zt,Wt,Un,ni),ni.delete(Zt)),R0(ct,Lt,Gt)})(b,w,Pe,F,D0,Q,le);else{var We=Q?Q($0(b,Pe),xe,Pe+"",b,w,le):u;We===u&&(We=xe),R0(b,Pe,We)}},$n)}function P0(b,w){var F=b.length;if(F)return Os(w+=w<0?F:0,F)?b[w]:u}function df(b,w,F){w=w.length?Ss(w,function(xe){return Jn(xe)?function(Pe){return js(Pe,xe.length===1?xe[0]:xe)}:xe}):[ps];var Q=-1;w=Ss(w,hc(li()));var le=Ru(b,function(xe,Pe,We){var ct=Ss(w,function(kt){return kt(xe)});return{criteria:ct,index:++Q,value:xe}});return function(xe,Pe){var We=xe.length;for(xe.sort(Pe);We--;)xe[We]=xe[We].value;return xe}(le,function(xe,Pe){return function(We,ct,kt){for(var Lt=-1,Wt=We.criteria,An=ct.criteria,Un=Wt.length,ni=kt.length;++Lt<Un;){var Ut=Cp(Wt[Lt],An[Lt]);if(Ut)return Lt>=ni?Ut:Ut*(kt[Lt]=="desc"?-1:1)}return We.index-ct.index}(xe,Pe,F)})}function bE(b,w,F){for(var Q=-1,le=w.length,xe={};++Q<le;){var Pe=w[Q],We=js(b,Pe);F(We,Pe)&&Om(xe,vh(Pe,b),We)}return xe}function L0(b,w,F,Q){var le=Q?Ay:nf,xe=-1,Pe=w.length,We=b;for(b===w&&(w=_c(w)),F&&(We=Ss(b,hc(F)));++xe<Pe;)for(var ct=0,kt=w[xe],Lt=F?F(kt):kt;(ct=le(We,Lt,ct,Q))>-1;)We!==b&&of.call(We,ct,1),of.call(b,ct,1);return b}function Uy(b,w){for(var F=b?w.length:0,Q=F-1;F--;){var le=w[F];if(F==Q||le!==xe){var xe=le;Os(le)?of.call(b,le,1):xp(b,le)}}return b}function EE(b,w){return b+Yc(To()*(w-b+1))}function By(b,w){var F="";if(!b||w<1||w>x)return F;do w%2&&(F+=b),(w=Yc(w/2))&&(b+=b);while(w);return F}function qi(b,w){return Gy(Lm(b,w,ps),b+"")}function U0(b){return Vl(hr(b))}function _x(b,w){var F=hr(b);return W0(F,dd(w,0,F.length))}function Om(b,w,F,Q){if(!M(b))return b;for(var le=-1,xe=(w=vh(w,b)).length,Pe=xe-1,We=b;We!=null&&++le<xe;){var ct=Du(w[le]),kt=F;if(ct==="__proto__"||ct==="constructor"||ct==="prototype")return b;if(le!=Pe){var Lt=We[ct];(kt=Q?Q(Lt,ct,We):u)===u&&(kt=M(Lt)?Lt:Os(w[le+1])?[]:{})}uf(We,ct,kt),We=We[ct]}return b}var fd=ld?function(b,w){return ld.set(b,w),b}:ps,Vi=E0?function(b,w){return E0(b,"toString",{configurable:!0,enumerable:!1,value:Mo(w),writable:!0})}:ps;function Ep(b){return W0(hr(b))}function us(b,w,F){var Q=-1,le=b.length;w<0&&(w=-w>le?0:le+w),(F=F>le?le:F)<0&&(F+=le),le=w>F?0:F-w>>>0,w>>>=0;for(var xe=fn(le);++Q<le;)xe[Q]=b[Q+w];return xe}function ph(b,w){var F;return El(b,function(Q,le,xe){return!(F=w(Q,le,xe))}),!!F}function Sp(b,w,F){var Q=0,le=b==null?Q:b.length;if(typeof w=="number"&&w==w&&le<=2147483647){for(;Q<le;){var xe=Q+le>>>1,Pe=b[xe];Pe!==null&&!he(Pe)&&(F?Pe<=w:Pe<w)?Q=xe+1:le=xe}return le}return Nm(b,w,ps,F)}function Nm(b,w,F,Q){var le=0,xe=b==null?0:b.length;if(xe===0)return 0;for(var Pe=(w=F(w))!=w,We=w===null,ct=he(w),kt=w===u;le<xe;){var Lt=Yc((le+xe)/2),Wt=F(b[Lt]),An=Wt!==u,Un=Wt===null,ni=Wt==Wt,Ut=he(Wt);if(Pe)var Zt=Q||ni;else Zt=kt?ni&&(Q||An):We?ni&&An&&(Q||!Un):ct?ni&&An&&!Un&&(Q||!Ut):!Un&&!Ut&&(Q?Wt<=w:Wt<w);Zt?le=Lt+1:xe=Lt}return Xs(xe,4294967294)}function Tp(b,w){for(var F=-1,Q=b.length,le=0,xe=[];++F<Q;){var Pe=b[F],We=w?w(Pe):Pe;if(!F||!Ns(We,ct)){var ct=We;xe[le++]=Pe===0?0:Pe}}return xe}function mh(b){return typeof b=="number"?b:he(b)?N:+b}function Kc(b){if(typeof b=="string")return b;if(Jn(b))return Ss(b,Kc)+"";if(he(b))return wm?wm.call(b):"";var w=b+"";return w=="0"&&1/b==-1/0?"-0":w}function gh(b,w,F){var Q=-1,le=vm,xe=b.length,Pe=!0,We=[],ct=We;if(F)Pe=!1,le=sd;else if(xe>=200){var kt=w?null:dR(b);if(kt)return bm(kt);Pe=!1,le=ad,ct=new Tu}else ct=w?[]:We;e:for(;++Q<xe;){var Lt=b[Q],Wt=w?w(Lt):Lt;if(Lt=F||Lt!==0?Lt:0,Pe&&Wt==Wt){for(var An=ct.length;An--;)if(ct[An]===Wt)continue e;w&&ct.push(Wt),We.push(Lt)}else le(ct,Wt,F)||(ct!==We&&ct.push(Wt),We.push(Lt))}return We}function xp(b,w){return(b=NE(b,w=vh(w,b)))==null||delete b[Du(Ao(w))]}function SE(b,w,F,Q){return Om(b,w,F(js(b,w)),Q)}function Au(b,w,F,Q){for(var le=b.length,xe=Q?le:-1;(Q?xe--:++xe<le)&&w(b[xe],xe,b););return F?us(b,Q?0:xe,Q?xe+1:le):us(b,Q?xe+1:0,Q?le:xe)}function Im(b,w){var F=b;return F instanceof Bi&&(F=F.value()),Cy(w,function(Q,le){return le.func.apply(le.thisArg,oh([Q],le.args))},F)}function B0(b,w,F){var Q=b.length;if(Q<2)return Q?gh(b[0]):[];for(var le=-1,xe=fn(Q);++le<Q;)for(var Pe=b[le],We=-1;++We<Q;)We!=le&&(xe[le]=hf(xe[le]||Pe,b[We],w,F));return gh(Ba(xe,1),w,F)}function wp(b,w,F){for(var Q=-1,le=b.length,xe=w.length,Pe={};++Q<le;){var We=Q<xe?w[Q]:u;F(Pe,b[Q],We)}return Pe}function F0(b){return Is(b)?b:[]}function Mu(b){return typeof b=="function"?b:ps}function vh(b,w){return Jn(b)?b:Vy(b,w)?[b]:qy(It(b))}var hR=qi;function ro(b,w,F){var Q=b.length;return F=F===u?Q:F,!w&&F>=Q?b:us(b,w,F)}var TE=dn||function(b){return bn.clearTimeout(b)};function vi(b,w){if(w)return b.slice();var F=b.length,Q=dE?dE(F):new b.constructor(F);return b.copy(Q),Q}function km(b){var w=new b.constructor(b.byteLength);return new hh(w).set(new hh(b)),w}function Fy(b,w){var F=w?km(b.buffer):b.buffer;return new b.constructor(F,b.byteOffset,b.length)}function Cp(b,w){if(b!==w){var F=b!==u,Q=b===null,le=b==b,xe=he(b),Pe=w!==u,We=w===null,ct=w==w,kt=he(w);if(!We&&!kt&&!xe&&b>w||xe&&Pe&&ct&&!We&&!kt||Q&&Pe&&ct||!F&&ct||!le)return 1;if(!Q&&!xe&&!kt&&b<w||kt&&F&&le&&!Q&&!xe||We&&F&&le||!Pe&&le||!ct)return-1}return 0}function pd(b,w,F,Q){for(var le=-1,xe=b.length,Pe=F.length,We=-1,ct=w.length,kt=Ts(xe-Pe,0),Lt=fn(ct+kt),Wt=!Q;++We<ct;)Lt[We]=w[We];for(;++le<Pe;)(Wt||le<xe)&&(Lt[F[le]]=b[le]);for(;kt--;)Lt[We++]=b[le++];return Lt}function z0(b,w,F,Q){for(var le=-1,xe=b.length,Pe=-1,We=F.length,ct=-1,kt=w.length,Lt=Ts(xe-We,0),Wt=fn(Lt+kt),An=!Q;++le<Lt;)Wt[le]=b[le];for(var Un=le;++ct<kt;)Wt[Un+ct]=w[ct];for(;++Pe<We;)(An||le<xe)&&(Wt[Un+F[Pe]]=b[le++]);return Wt}function _c(b,w){var F=-1,Q=b.length;for(w||(w=fn(Q));++F<Q;)w[F]=b[F];return w}function Ou(b,w,F,Q){var le=!F;F||(F={});for(var xe=-1,Pe=w.length;++xe<Pe;){var We=w[xe],ct=Q?Q(F[We],b[We],We,F,b):u;ct===u&&(ct=b[We]),le?xu(F,We,ct):uf(F,We,ct)}return F}function ff(b,w){return function(F,Q){var le=Jn(F)?f0:pE,xe=w?w():{};return le(F,b,li(Q,2),xe)}}function Dm(b){return qi(function(w,F){var Q=-1,le=F.length,xe=le>1?F[le-1]:u,Pe=le>2?F[2]:u;for(xe=b.length>3&&typeof xe=="function"?(le--,xe):u,Pe&&Wo(F[0],F[1],Pe)&&(xe=le<3?u:xe,le=1),w=Ji(w);++Q<le;){var We=F[Q];We&&b(w,We,Q,xe)}return w})}function bx(b,w){return function(F,Q){if(F==null)return F;if(!co(F))return b(F,Q);for(var le=F.length,xe=w?le:-1,Pe=Ji(F);(w?xe--:++xe<le)&&Q(Pe[xe],xe,Pe)!==!1;);return F}}function Ex(b){return function(w,F,Q){for(var le=-1,xe=Ji(w),Pe=Q(w),We=Pe.length;We--;){var ct=Pe[b?We:++le];if(F(xe[ct],ct,xe)===!1)break}return w}}function Sx(b){return function(w){var F=rf(w=It(w))?Ys(w):u,Q=F?F[0]:w.charAt(0),le=F?ro(F,1).join(""):w.slice(1);return Q[b]()+le}}function Rp(b){return function(w){return Cy(Gi(fs(w).replace(ci,"")),b,"")}}function Ap(b){return function(){var w=arguments;switch(w.length){case 0:return new b;case 1:return new b(w[0]);case 2:return new b(w[0],w[1]);case 3:return new b(w[0],w[1],w[2]);case 4:return new b(w[0],w[1],w[2],w[3]);case 5:return new b(w[0],w[1],w[2],w[3],w[4]);case 6:return new b(w[0],w[1],w[2],w[3],w[4],w[5]);case 7:return new b(w[0],w[1],w[2],w[3],w[4],w[5],w[6])}var F=ud(b.prototype),Q=b.apply(F,w);return M(Q)?Q:F}}function xE(b){return function(w,F,Q){var le=Ji(w);if(!co(w)){var xe=li(F,3);w=Tn(w),F=function(We){return xe(le[We],We,le)}}var Pe=b(w,F,Q);return Pe>-1?le[xe?w[Pe]:Pe]:u}}function Pm(b){return ku(function(w){var F=w.length,Q=F,le=io.prototype.thru;for(b&&w.reverse();Q--;){var xe=w[Q];if(typeof xe!="function")throw new $c(h);if(le&&!Pe&&md(xe)=="wrapper")var Pe=new io([],!0)}for(Q=Pe?Q:F;++Q<F;){var We=md(xe=w[Q]),ct=We=="wrapper"?RE(xe):u;Pe=ct&&OE(ct[0])&&ct[1]==424&&!ct[4].length&&ct[9]==1?Pe[md(ct[0])].apply(Pe,ct[3]):xe.length==1&&OE(xe)?Pe[We]():Pe.thru(xe)}return function(){var kt=arguments,Lt=kt[0];if(Pe&&kt.length==1&&Jn(Lt))return Pe.plant(Lt).value();for(var Wt=0,An=F?w[Wt].apply(this,kt):Lt;++Wt<F;)An=w[Wt].call(this,An);return An}})}function H0(b,w,F,Q,le,xe,Pe,We,ct,kt){var Lt=w&v,Wt=1&w,An=2&w,Un=24&w,ni=512&w,Ut=An?u:Ap(b);return function Zt(){for(var mi=arguments.length,Gt=fn(mi),Mn=mi;Mn--;)Gt[Mn]=arguments[Mn];if(Un)var on=xl(Zt),In=function(Ds,Ec){for(var kr=Ds.length,fr=0;kr--;)Ds[kr]===Ec&&++fr;return fr}(Gt,on);if(Q&&(Gt=pd(Gt,Q,le,Un)),xe&&(Gt=z0(Gt,xe,Pe,Un)),mi-=In,Un&&mi<kt){var ln=dc(Gt,on);return Sl(b,w,H0,Zt.placeholder,F,Gt,ln,We,ct,kt-mi)}var Fn=Wt?F:this,xs=An?Fn[b]:b;return mi=Gt.length,We?Gt=function(Ds,Ec){for(var kr=Ds.length,fr=Xs(Ec.length,kr),Sc=_c(Ds);fr--;){var Wl=Ec[fr];Ds[fr]=Os(Wl,kr)?Sc[Wl]:u}return Ds}(Gt,We):ni&&mi>1&&Gt.reverse(),Lt&&ct<mi&&(Gt.length=ct),this&&this!==bn&&this instanceof Zt&&(xs=Ut||Ap(xs)),xs.apply(Fn,Gt)}}function Tx(b,w){return function(F,Q){return function(le,xe,Pe,We){return wu(le,function(ct,kt,Lt){xe(We,Pe(ct),kt,Lt)}),We}(F,b,w(Q),{})}}function zy(b,w){return function(F,Q){var le;if(F===u&&Q===u)return w;if(F!==u&&(le=F),Q!==u){if(le===u)return Q;typeof F=="string"||typeof Q=="string"?(F=Kc(F),Q=Kc(Q)):(F=mh(F),Q=mh(Q)),le=b(F,Q)}return le}}function j0(b){return ku(function(w){return w=Ss(w,hc(li())),qi(function(F){var Q=this;return b(w,function(le){return jo(le,Q,F)})})})}function ql(b,w){var F=(w=w===u?" ":Kc(w)).length;if(F<2)return F?By(w,b):w;var Q=By(w,Eu(b/Ta(w)));return rf(w)?ro(Ys(Q),0,b).join(""):Q.slice(0,b)}function Co(b){return function(w,F,Q){return Q&&typeof Q!="number"&&Wo(w,F,Q)&&(F=Q=u),w=Oe(w),F===u?(F=w,w=0):F=Oe(F),function(le,xe,Pe,We){for(var ct=-1,kt=Ts(Eu((xe-le)/(Pe||1)),0),Lt=fn(kt);kt--;)Lt[We?kt:++ct]=le,le+=Pe;return Lt}(w,F,Q=Q===u?w<F?1:-1:Oe(Q),b)}}function Nu(b){return function(w,F){return typeof w=="string"&&typeof F=="string"||(w=wt(w),F=wt(F)),b(w,F)}}function Sl(b,w,F,Q,le,xe,Pe,We,ct,kt){var Lt=8&w;w|=Lt?g:_,4&(w&=~(Lt?_:g))||(w&=-4);var Wt=[b,w,le,Lt?xe:u,Lt?Pe:u,Lt?u:xe,Lt?u:Pe,We,ct,kt],An=F.apply(u,Wt);return OE(b)&&Jc(An,Wt),An.placeholder=Q,za(An,b,w)}function V0(b){var w=lh[b];return function(F,Q){if(F=wt(F),(Q=Q==null?0:Xs(_e(Q),292))&&xa(F)){var le=(It(F)+"e").split("e");return+((le=(It(w(le[0]+"e"+(+le[1]+Q)))+"e").split("e"))[0]+"e"+(+le[1]-Q))}return w(F)}}var dR=wa&&1/bm(new wa([,-0]))[1]==T?function(b){return new wa(b)}:lo;function $o(b){return function(w){var F=Fa(w);return F==ie?_m(w):F==oe?px(w):function(Q,le){return Ss(le,function(xe){return[xe,Q[xe]]})}(w,b(w))}}function so(b,w,F,Q,le,xe,Pe,We){var ct=2&w;if(!ct&&typeof b!="function")throw new $c(h);var kt=Q?Q.length:0;if(kt||(w&=-97,Q=le=u),Pe=Pe===u?Pe:Ts(_e(Pe),0),We=We===u?We:_e(We),kt-=le?le.length:0,w&_){var Lt=Q,Wt=le;Q=le=u}var An=ct?u:RE(b),Un=[b,w,F,Q,le,Lt,Wt,xe,Pe,We];if(An&&function(Ut,Zt){var mi=Ut[1],Gt=Zt[1],Mn=mi|Gt,on=Mn<131,In=Gt==v&&mi==8||Gt==v&&mi==E&&Ut[7].length<=Zt[8]||Gt==384&&Zt[7].length<=Zt[8]&&mi==8;if(!on&&!In)return Ut;1&Gt&&(Ut[2]=Zt[2],Mn|=1&mi?0:4);var ln=Zt[3];if(ln){var Fn=Ut[3];Ut[3]=Fn?pd(Fn,ln,Zt[4]):ln,Ut[4]=Fn?dc(Ut[3],f):Zt[4]}(ln=Zt[5])&&(Fn=Ut[5],Ut[5]=Fn?z0(Fn,ln,Zt[6]):ln,Ut[6]=Fn?dc(Ut[5],f):Zt[6]),(ln=Zt[7])&&(Ut[7]=ln),Gt&v&&(Ut[8]=Ut[8]==null?Zt[8]:Xs(Ut[8],Zt[8])),Ut[9]==null&&(Ut[9]=Zt[9]),Ut[0]=Zt[0],Ut[1]=Mn}(Un,An),b=Un[0],w=Un[1],F=Un[2],Q=Un[3],le=Un[4],!(We=Un[9]=Un[9]===u?ct?0:b.length:Ts(Un[9]-kt,0))&&24&w&&(w&=-25),w&&w!=1)ni=w==8||w==p?function(Ut,Zt,mi){var Gt=Ap(Ut);return function Mn(){for(var on=arguments.length,In=fn(on),ln=on,Fn=xl(Mn);ln--;)In[ln]=arguments[ln];var xs=on<3&&In[0]!==Fn&&In[on-1]!==Fn?[]:dc(In,Fn);return(on-=xs.length)<mi?Sl(Ut,Zt,H0,Mn.placeholder,u,In,xs,u,u,mi-on):jo(this&&this!==bn&&this instanceof Mn?Gt:Ut,this,In)}}(b,w,We):w!=g&&w!=33||le.length?H0.apply(u,Un):function(Ut,Zt,mi,Gt){var Mn=1&Zt,on=Ap(Ut);return function In(){for(var ln=-1,Fn=arguments.length,xs=-1,Ds=Gt.length,Ec=fn(Ds+Fn),kr=this&&this!==bn&&this instanceof In?on:Ut;++xs<Ds;)Ec[xs]=Gt[xs];for(;Fn--;)Ec[xs++]=arguments[++ln];return jo(kr,Mn?mi:this,Ec)}}(b,w,F,Q);else var ni=function(Ut,Zt,mi){var Gt=1&Zt,Mn=Ap(Ut);return function on(){return(this&&this!==bn&&this instanceof on?Mn:Ut).apply(Gt?mi:this,arguments)}}(b,w,F);return za((An?fd:Jc)(ni,Un),b,w)}function Iu(b,w,F,Q){return b===u||Ns(b,_u[F])&&!Ar.call(Q,F)?w:b}function Tl(b,w,F,Q,le,xe){return M(b)&&M(w)&&(xe.set(w,b),D0(b,w,u,Tl,xe),xe.delete(w)),b}function hs(b){return te(b)?u:b}function wE(b,w,F,Q,le,xe){var Pe=1&F,We=b.length,ct=w.length;if(We!=ct&&!(Pe&&ct>We))return!1;var kt=xe.get(b),Lt=xe.get(w);if(kt&&Lt)return kt==w&&Lt==b;var Wt=-1,An=!0,Un=2&F?new Tu:u;for(xe.set(b,w),xe.set(w,b);++Wt<We;){var ni=b[Wt],Ut=w[Wt];if(Q)var Zt=Pe?Q(Ut,ni,Wt,w,b,xe):Q(ni,Ut,Wt,b,w,xe);if(Zt!==u){if(Zt)continue;An=!1;break}if(Un){if(!Ry(w,function(mi,Gt){if(!ad(Un,Gt)&&(ni===mi||le(ni,mi,F,Q,xe)))return Un.push(Gt)})){An=!1;break}}else if(ni!==Ut&&!le(ni,Ut,F,Q,xe)){An=!1;break}}return xe.delete(b),xe.delete(w),An}function ku(b){return Gy(Lm(b,u,Rx),b+"")}function CE(b){return Gl(b,Tn,G0)}function Hy(b){return Gl(b,$n,AE)}var RE=ld?function(b){return ld.get(b)}:lo;function md(b){for(var w=b.name+"",F=ha[w],Q=Ar.call(ha,w)?F.length:0;Q--;){var le=F[Q],xe=le.func;if(xe==null||xe==b)return le.name}return w}function xl(b){return(Ar.call(ge,"placeholder")?ge:b).placeholder}function li(){var b=ge.iteratee||Zo;return b=b===Zo?yE:b,arguments.length?b(arguments[0],arguments[1]):b}function jy(b,w){var F,Q,le=b.__data__;return((Q=typeof(F=w))=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?F!=="__proto__":F===null)?le[typeof w=="string"?"string":"hash"]:le.map}function ti(b){for(var w=Tn(b),F=w.length;F--;){var Q=w[F],le=b[Q];w[F]=[Q,le,wx(le)]}return w}function wl(b,w){var F=function(Q,le){return Q==null?u:Q[le]}(b,w);return vx(F)?F:u}var G0=T0?function(b){return b==null?[]:(b=Ji(b),yu(T0(b),function(w){return _0.call(b,w)}))}:yd,AE=T0?function(b){for(var w=[];b;)oh(w,G0(b)),b=Sm(b);return w}:yd,Fa=da;function Mp(b,w,F){for(var Q=-1,le=(w=vh(w,b)).length,xe=!1;++Q<le;){var Pe=Du(w[Q]);if(!(xe=b!=null&&F(b,Pe)))break;b=b[Pe]}return xe||++Q!=le?xe:!!(le=b==null?0:b.length)&&R(le)&&Os(Pe,le)&&(Jn(b)||Hr(b))}function xx(b){return typeof b.constructor!="function"||q0(b)?{}:ud(Sm(b))}function ME(b){return Jn(b)||Hr(b)||!!(b0&&b&&b[b0])}function Os(b,w){var F=typeof b;return!!(w=w??x)&&(F=="number"||F!="symbol"&&an.test(b))&&b>-1&&b%1==0&&b<w}function Wo(b,w,F){if(!M(F))return!1;var Q=typeof w;return!!(Q=="number"?co(F)&&Os(w,F.length):Q=="string"&&w in F)&&Ns(F[w],b)}function Vy(b,w){if(Jn(b))return!1;var F=typeof b;return!(F!="number"&&F!="symbol"&&F!="boolean"&&b!=null&&!he(b))||Ue.test(b)||!$e.test(b)||w!=null&&b in Ji(w)}function OE(b){var w=md(b),F=ge[w];if(typeof F!="function"||!(w in Bi.prototype))return!1;if(b===F)return!0;var Q=RE(F);return!!Q&&b===Q[0]}(x0&&Fa(new x0(new ArrayBuffer(1)))!=Le||xo&&Fa(new xo)!=ie||Bt&&Fa(Bt.resolve())!=Y||wa&&Fa(new wa)!=oe||xm&&Fa(new xm)!=He)&&(Fa=function(b){var w=da(b),F=w==Z?b.constructor:u,Q=F?Op(F):"";if(Q)switch(Q){case w0:return Le;case mc:return ie;case gx:return Y;case bl:return oe;case bp:return He}return w});var fR=Wc?O:Th;function q0(b){var w=b&&b.constructor;return b===(typeof w=="function"&&w.prototype||_u)}function wx(b){return b==b&&!M(b)}function Cx(b,w){return function(F){return F!=null&&F[b]===w&&(w!==u||b in Ji(F))}}function Lm(b,w,F){return w=Ts(w===u?b.length-1:w,0),function(){for(var Q=arguments,le=-1,xe=Ts(Q.length-w,0),Pe=fn(xe);++le<xe;)Pe[le]=Q[w+le];le=-1;for(var We=fn(w+1);++le<w;)We[le]=Q[le];return We[w]=F(Pe),jo(b,this,We)}}function NE(b,w){return w.length<2?b:js(b,us(w,0,-1))}function $0(b,w){if((w!=="constructor"||typeof b[w]!="function")&&w!="__proto__")return b[w]}var Jc=Bm(fd),Um=S0||function(b,w){return bn.setTimeout(b,w)},Gy=Bm(Vi);function za(b,w,F){var Q=w+"";return Gy(b,function(le,xe){var Pe=xe.length;if(!Pe)return le;var We=Pe-1;return xe[We]=(Pe>1?"& ":"")+xe[We],xe=xe.join(Pe>2?", ":" "),le.replace(W,`{
/* [wrapped with `+xe+`] */
`)}(Q,function(le,xe){return Vo(I,function(Pe){var We="_."+Pe[0];xe&Pe[1]&&!vm(le,We)&&le.push(We)}),le.sort()}(function(le){var xe=le.match(me);return xe?xe[1].split(De):[]}(Q),F)))}function Bm(b){var w=0,F=0;return function(){var Q=Ii(),le=16-(Q-F);if(F=Q,le>0){if(++w>=800)return arguments[0]}else w=0;return b.apply(u,arguments)}}function W0(b,w){var F=-1,Q=b.length,le=Q-1;for(w=w===u?Q:w;++F<w;){var xe=EE(F,le),Pe=b[xe];b[xe]=b[F],b[F]=Pe}return b.length=w,b}var qy=function(b){var w=Ko(b,function(Q){return F.size===500&&F.clear(),Q}),F=w.cache;return w}(function(b){var w=[];return b.charCodeAt(0)===46&&w.push(""),b.replace(qt,function(F,Q,le,xe){w.push(le?xe.replace(xt,"$1"):Q||F)}),w});function Du(b){if(typeof b=="string"||he(b))return b;var w=b+"";return w=="0"&&1/b==-1/0?"-0":w}function Op(b){if(b!=null){try{return Ua.call(b)}catch{}try{return b+""}catch{}}return""}function IE(b){if(b instanceof Bi)return b.clone();var w=new io(b.__wrapped__,b.__chain__);return w.__actions__=_c(b.__actions__),w.__index__=b.__index__,w.__values__=b.__values__,w}var Fm=qi(function(b,w){return Is(b)?hf(b,Ba(w,1,Is,!0)):[]}),Ha=qi(function(b,w){var F=Ao(w);return Is(F)&&(F=u),Is(b)?hf(b,Ba(w,1,Is,!0),li(F,2)):[]}),zm=qi(function(b,w){var F=Ao(w);return Is(F)&&(F=u),Is(b)?hf(b,Ba(w,1,Is,!0),u,F):[]});function fa(b,w,F){var Q=b==null?0:b.length;if(!Q)return-1;var le=F==null?0:_e(F);return le<0&&(le=Ts(Q+le,0)),tf(b,li(w,3),le)}function yh(b,w,F){var Q=b==null?0:b.length;if(!Q)return-1;var le=Q-1;return F!==u&&(le=_e(F),le=F<0?Ts(Q+le,0):Xs(le,Q-1)),tf(b,li(w,3),le,!0)}function Rx(b){return b!=null&&b.length?Ba(b,1):[]}function Hm(b){return b&&b.length?b[0]:u}var $y=qi(function(b){var w=Ss(b,F0);return w.length&&w[0]===b[0]?Py(w):[]}),Yo=qi(function(b){var w=Ao(b),F=Ss(b,F0);return w===Ao(F)?w=u:F.pop(),F.length&&F[0]===b[0]?Py(F,li(w,2)):[]}),Ro=qi(function(b){var w=Ao(b),F=Ss(b,F0);return(w=typeof w=="function"?w:u)&&F.pop(),F.length&&F[0]===b[0]?Py(F,u,w):[]});function Ao(b){var w=b==null?0:b.length;return w?b[w-1]:u}var kE=qi(Ax);function Ax(b,w){return b&&b.length&&w&&w.length?L0(b,w):b}var gd=ku(function(b,w){var F=b==null?0:b.length,Q=A0(b,w);return Uy(b,Ss(w,function(le){return Os(le,F)?+le:le}).sort(Cp)),Q});function br(b){return b==null?b:_p.call(b)}var pR=qi(function(b){return gh(Ba(b,1,Is,!0))}),mR=qi(function(b){var w=Ao(b);return Is(w)&&(w=u),gh(Ba(b,1,Is,!0),li(w,2))}),gR=qi(function(b){var w=Ao(b);return w=typeof w=="function"?w:u,gh(Ba(b,1,Is,!0),u,w)});function jm(b){if(!b||!b.length)return[];var w=0;return b=yu(b,function(F){if(Is(F))return w=Ts(F.length,w),!0}),ym(w,function(F){return Ss(b,p0(F))})}function Vm(b,w){if(!b||!b.length)return[];var F=jm(b);return w==null?F:Ss(F,function(Q){return jo(w,u,Q)})}var Y0=qi(function(b,w){return Is(b)?hf(b,w):[]}),vR=qi(function(b){return B0(yu(b,Is))}),yR=qi(function(b){var w=Ao(b);return Is(w)&&(w=u),B0(yu(b,Is),li(w,2))}),Mx=qi(function(b){var w=Ao(b);return w=typeof w=="function"?w:u,B0(yu(b,Is),u,w)}),Pu=qi(jm),Lu=qi(function(b){var w=b.length,F=w>1?b[w-1]:u;return F=typeof F=="function"?(b.pop(),F):u,Vm(b,F)});function ao(b){var w=ge(b);return w.__chain__=!0,w}function _h(b,w){return w(b)}var vd=ku(function(b){var w=b.length,F=w?b[0]:0,Q=this.__wrapped__,le=function(xe){return A0(xe,b)};return!(w>1||this.__actions__.length)&&Q instanceof Bi&&Os(F)?((Q=Q.slice(F,+F+(w?1:0))).__actions__.push({func:_h,args:[le],thisArg:u}),new io(Q,this.__chain__).thru(function(xe){return w&&!xe.length&&xe.push(u),xe})):this.thru(le)}),bh=ff(function(b,w,F){Ar.call(b,F)?++b[F]:xu(b,F,1)}),Vs=xE(fa),Xo=xE(yh);function DE(b,w){return(Jn(b)?Vo:El)(b,li(w,3))}function X0(b,w){return(Jn(b)?lx:M0)(b,li(w,3))}var PE=ff(function(b,w,F){Ar.call(b,F)?b[F].push(w):xu(b,F,[w])}),_R=qi(function(b,w,F){var Q=-1,le=typeof w=="function",xe=co(b)?fn(b.length):[];return El(b,function(Pe){xe[++Q]=le?jo(w,Pe,F):yc(Pe,w,F)}),xe}),Ox=ff(function(b,w,F){xu(b,F,w)});function Wy(b,w){return(Jn(b)?Ss:Ru)(b,li(w,3))}var LE=ff(function(b,w,F){b[F?0:1].push(w)},function(){return[[],[]]}),bR=qi(function(b,w){if(b==null)return[];var F=w.length;return F>1&&Wo(b,w[0],w[1])?w=[]:F>2&&Wo(w[0],w[1],w[2])&&(w=[w[0]]),df(b,Ba(w,1),[])}),Ca=ua||function(){return bn.Date.now()};function Gm(b,w,F){return w=F?u:w,w=b&&w==null?b.length:w,so(b,v,u,u,u,u,w)}function Yy(b,w){var F;if(typeof w!="function")throw new $c(h);return b=_e(b),function(){return--b>0&&(F=w.apply(this,arguments)),b<=1&&(w=u),F}}var UE=qi(function(b,w,F){var Q=1;if(F.length){var le=dc(F,xl(UE));Q|=g}return so(b,Q,w,F,le)}),BE=qi(function(b,w,F){var Q=3;if(F.length){var le=dc(F,xl(BE));Q|=g}return so(w,Q,b,F,le)});function FE(b,w,F){var Q,le,xe,Pe,We,ct,kt=0,Lt=!1,Wt=!1,An=!0;if(typeof b!="function")throw new $c(h);function Un(Gt){var Mn=Q,on=le;return Q=le=u,kt=Gt,Pe=b.apply(on,Mn)}function ni(Gt){var Mn=Gt-ct;return ct===u||Mn>=w||Mn<0||Wt&&Gt-kt>=xe}function Ut(){var Gt=Ca();if(ni(Gt))return Zt(Gt);We=Um(Ut,function(Mn){var on=w-(Mn-ct);return Wt?Xs(on,xe-(Mn-kt)):on}(Gt))}function Zt(Gt){return We=u,An&&Q?Un(Gt):(Q=le=u,Pe)}function mi(){var Gt=Ca(),Mn=ni(Gt);if(Q=arguments,le=this,ct=Gt,Mn){if(We===u)return function(on){return kt=on,We=Um(Ut,w),Lt?Un(on):Pe}(ct);if(Wt)return TE(We),We=Um(Ut,w),Un(ct)}return We===u&&(We=Um(Ut,w)),Pe}return w=wt(w)||0,M(F)&&(Lt=!!F.leading,xe=(Wt="maxWait"in F)?Ts(wt(F.maxWait)||0,w):xe,An="trailing"in F?!!F.trailing:An),mi.cancel=function(){We!==u&&TE(We),kt=0,Q=ct=le=We=u},mi.flush=function(){return We===u?Pe:Zt(Ca())},mi}var oo=qi(function(b,w){return Dy(b,1,w)}),pf=qi(function(b,w,F){return Dy(b,wt(w)||0,F)});function Ko(b,w){if(typeof b!="function"||w!=null&&typeof w!="function")throw new $c(h);var F=function(){var Q=arguments,le=w?w.apply(this,Q):Q[0],xe=F.cache;if(xe.has(le))return xe.get(le);var Pe=b.apply(this,Q);return F.cache=xe.set(le,Pe)||xe,Pe};return F.cache=new(Ko.Cache||Xc),F}function Jo(b){if(typeof b!="function")throw new $c(h);return function(){var w=arguments;switch(w.length){case 0:return!b.call(this);case 1:return!b.call(this,w[0]);case 2:return!b.call(this,w[0],w[1]);case 3:return!b.call(this,w[0],w[1],w[2])}return!b.apply(this,w)}}Ko.Cache=Xc;var ER=hR(function(b,w){var F=(w=w.length==1&&Jn(w[0])?Ss(w[0],hc(li())):Ss(Ba(w,1),hc(li()))).length;return qi(function(Q){for(var le=-1,xe=Xs(Q.length,F);++le<xe;)Q[le]=w[le].call(this,Q[le]);return jo(b,this,Q)})}),Xy=qi(function(b,w){var F=dc(w,xl(Xy));return so(b,g,u,w,F)}),K0=qi(function(b,w){var F=dc(w,xl(K0));return so(b,_,u,w,F)}),ja=ku(function(b,w){return so(b,E,u,u,u,w)});function Ns(b,w){return b===w||b!=b&&w!=w}var Eh=Nu(zr),SR=Nu(function(b,w){return b>=w}),Hr=N0(function(){return arguments}())?N0:function(b){return P(b)&&Ar.call(b,"callee")&&!_0.call(b,"callee")},Jn=fn.isArray,Nx=gp?hc(gp):function(b){return P(b)&&da(b)==Te};function co(b){return b!=null&&R(b.length)&&!O(b)}function Is(b){return P(b)&&co(b)}var mf=yp||Th,qm=rd?hc(rd):function(b){return P(b)&&da(b)==$};function zE(b){if(!P(b))return!1;var w=da(b);return w==q||w=="[object DOMException]"||typeof b.message=="string"&&typeof b.name=="string"&&!te(b)}function O(b){if(!M(b))return!1;var w=da(b);return w==G||w==X||w=="[object AsyncFunction]"||w=="[object Proxy]"}function S(b){return typeof b=="number"&&b==_e(b)}function R(b){return typeof b=="number"&&b>-1&&b%1==0&&b<=x}function M(b){var w=typeof b;return b!=null&&(w=="object"||w=="function")}function P(b){return b!=null&&typeof b=="object"}var B=ah?hc(ah):function(b){return P(b)&&Fa(b)==ie};function H(b){return typeof b=="number"||P(b)&&da(b)==V}function te(b){if(!P(b)||da(b)!=Z)return!1;var w=Sm(b);if(w===null)return!0;var F=Ar.call(w,"constructor")&&w.constructor;return typeof F=="function"&&F instanceof F&&Ua.call(F)==af}var re=h0?hc(h0):function(b){return P(b)&&da(b)==ee},K=wy?hc(wy):function(b){return P(b)&&Fa(b)==oe};function se(b){return typeof b=="string"||!Jn(b)&&P(b)&&da(b)==de}function he(b){return typeof b=="symbol"||P(b)&&da(b)==Me}var pe=d0?hc(d0):function(b){return P(b)&&R(b.length)&&!!Ti[da(b)]},Ne=Nu(Ly),Je=Nu(function(b,w){return b<=w});function Ye(b){if(!b)return[];if(co(b))return se(b)?Ys(b):_c(b);if(bu&&b[bu])return function(F){for(var Q,le=[];!(Q=F.next()).done;)le.push(Q.value);return le}(b[bu]());var w=Fa(b);return(w==ie?_m:w==oe?bm:hr)(b)}function Oe(b){return b?(b=wt(b))===T||b===-1/0?17976931348623157e292*(b<0?-1:1):b==b?b:0:b===0?b:0}function _e(b){var w=Oe(b),F=w%1;return w==w?F?w-F:w:0}function lt(b){return b?dd(_e(b),0,A):0}function wt(b){if(typeof b=="number")return b;if(he(b))return N;if(M(b)){var w=typeof b.valueOf=="function"?b.valueOf():b;b=M(w)?w+"":w}if(typeof b!="string")return b===0?b:+b;b=hE(b);var F=ht.test(b);return F||hn.test(b)?eo(b.slice(2),F?2:8):Vt.test(b)?N:+b}function Kt(b){return Ou(b,$n(b))}function It(b){return b==null?"":Kc(b)}var Xn=Dm(function(b,w){if(q0(w)||co(w))Ou(w,Tn(w),b);else for(var F in w)Ar.call(w,F)&&uf(b,F,w[F])}),wn=Dm(function(b,w){Ou(w,$n(w),b)}),yi=Dm(function(b,w,F,Q){Ou(w,$n(w),b,Q)}),Fi=Dm(function(b,w,F,Q){Ou(w,Tn(w),b,Q)}),ki=ku(A0),xi=qi(function(b,w){b=Ji(b);var F=-1,Q=w.length,le=Q>2?w[2]:u;for(le&&Wo(w[0],w[1],le)&&(Q=1);++F<Q;)for(var xe=w[F],Pe=$n(xe),We=-1,ct=Pe.length;++We<ct;){var kt=Pe[We],Lt=b[kt];(Lt===u||Ns(Lt,_u[kt])&&!Ar.call(b,kt))&&(b[kt]=xe[kt])}return b}),_i=qi(function(b){return b.push(u,Tl),jo(Jr,u,b)});function Ri(b,w,F){var Q=b==null?u:js(b,w);return Q===u?F:Q}function Di(b,w){return b!=null&&Mp(b,w,Mm)}var bi=Tx(function(b,w,F){w!=null&&typeof w.toString!="function"&&(w=sf.call(w)),b[w]=F},Mo(ps)),Ai=Tx(function(b,w,F){w!=null&&typeof w.toString!="function"&&(w=sf.call(w)),Ar.call(b,w)?b[w].push(F):b[w]=[F]},li),ui=qi(yc);function Tn(b){return co(b)?Iy(b):_E(b)}function $n(b){return co(b)?Iy(b,!0):yx(b)}var $i=Dm(function(b,w,F){D0(b,w,F)}),Jr=Dm(function(b,w,F,Q){D0(b,w,F,Q)}),ys=ku(function(b,w){var F={};if(b==null)return F;var Q=!1;w=Ss(w,function(xe){return xe=vh(xe,b),Q||(Q=xe.length>1),xe}),Ou(b,Hy(b),F),Q&&(F=vc(F,7,hs));for(var le=w.length;le--;)xp(F,w[le]);return F}),Zr=ku(function(b,w){return b==null?{}:function(F,Q){return bE(F,Q,function(le,xe){return Di(F,xe)})}(b,w)});function ds(b,w){if(b==null)return{};var F=Ss(Hy(b),function(Q){return[Q]});return w=li(w),bE(b,F,function(Q,le){return w(Q,le[0])})}var Qr=$o(Tn),Ir=$o($n);function hr(b){return b==null?[]:Ms(b,Tn(b))}var $r=Rp(function(b,w,F){return w=w.toLowerCase(),b+(F?es(w):w)});function es(b){return Zn(It(b).toLowerCase())}function fs(b){return(b=It(b))&&b.replace(Ve,dx).replace(Cn,"")}var Ks=Rp(function(b,w,F){return b+(F?"-":"")+w.toLowerCase()}),pa=Rp(function(b,w,F){return b+(F?" ":"")+w.toLowerCase()}),_s=Sx("toLowerCase"),ks=Rp(function(b,w,F){return b+(F?"_":"")+w.toLowerCase()}),dr=Rp(function(b,w,F){return b+(F?" ":"")+Zn(w)}),Ra=Rp(function(b,w,F){return b+(F?" ":"")+w.toUpperCase()}),Zn=Sx("toUpperCase");function Gi(b,w,F){return b=It(b),(w=F?u:w)===u?function(Q){return vs.test(Q)}(b)?function(Q){return Q.match(ar)||[]}(b):function(Q){return Q.match(je)||[]}(b):b.match(w)||[]}var Mr=qi(function(b,w){try{return jo(b,u,w)}catch(F){return zE(F)?F:new ji(F)}}),Va=ku(function(b,w){return Vo(w,function(F){F=Du(F),xu(b,F,UE(b[F],b))}),b});function Mo(b){return function(){return b}}var bc=Pm(),Zc=Pm(!0);function ps(b){return b}function Zo(b){return yE(typeof b=="function"?b:vc(b,1))}var Sh=qi(function(b,w){return function(F){return yc(F,b,w)}}),$l=qi(function(b,w){return function(F){return yc(b,F,w)}});function Aa(b,w,F){var Q=Tn(w),le=Cu(w,Q);F!=null||M(w)&&(le.length||!Q.length)||(F=w,w=b,b=this,le=Cu(w,Tn(w)));var xe=!(M(F)&&"chain"in F&&!F.chain),Pe=O(b);return Vo(le,function(We){var ct=w[We];b[We]=ct,Pe&&(b.prototype[We]=function(){var kt=this.__chain__;if(xe||kt){var Lt=b(this.__wrapped__);return(Lt.__actions__=_c(this.__actions__)).push({func:ct,args:arguments,thisArg:b}),Lt.__chain__=kt,Lt}return ct.apply(b,oh([this.value()],arguments))})}),b}function lo(){}var Oo=j0(Ss),Qo=j0(sE),gf=j0(Ry);function vf(b){return Vy(b)?p0(Du(b)):function(w){return function(F){return js(F,w)}}(b)}var Np=Co(),Gs=Co(!0);function yd(){return[]}function Th(){return!1}var Uu=zy(function(b,w){return b+w},0),Cl=V0("ceil"),J0=zy(function(b,w){return b/w},1),Ky=V0("floor"),Z0,Wr=zy(function(b,w){return b*w},1),Q0=V0("round"),xh=zy(function(b,w){return b-w},0);return ge.after=function(b,w){if(typeof w!="function")throw new $c(h);return b=_e(b),function(){if(--b<1)return w.apply(this,arguments)}},ge.ary=Gm,ge.assign=Xn,ge.assignIn=wn,ge.assignInWith=yi,ge.assignWith=Fi,ge.at=ki,ge.before=Yy,ge.bind=UE,ge.bindAll=Va,ge.bindKey=BE,ge.castArray=function(){if(!arguments.length)return[];var b=arguments[0];return Jn(b)?b:[b]},ge.chain=ao,ge.chunk=function(b,w,F){w=(F?Wo(b,w,F):w===u)?1:Ts(_e(w),0);var Q=b==null?0:b.length;if(!Q||w<1)return[];for(var le=0,xe=0,Pe=fn(Eu(Q/w));le<Q;)Pe[xe++]=us(b,le,le+=w);return Pe},ge.compact=function(b){for(var w=-1,F=b==null?0:b.length,Q=0,le=[];++w<F;){var xe=b[w];xe&&(le[Q++]=xe)}return le},ge.concat=function(){var b=arguments.length;if(!b)return[];for(var w=fn(b-1),F=arguments[0],Q=b;Q--;)w[Q-1]=arguments[Q];return oh(Jn(F)?_c(F):[F],Ba(w,1))},ge.cond=function(b){var w=b==null?0:b.length,F=li();return b=w?Ss(b,function(Q){if(typeof Q[1]!="function")throw new $c(h);return[F(Q[0]),Q[1]]}):[],qi(function(Q){for(var le=-1;++le<w;){var xe=b[le];if(jo(xe[0],this,Q))return jo(xe[1],this,Q)}})},ge.conforms=function(b){return function(w){var F=Tn(w);return function(Q){return ls(Q,w,F)}}(vc(b,1))},ge.constant=Mo,ge.countBy=bh,ge.create=function(b,w){var F=ud(b);return w==null?F:qo(F,w)},ge.curry=function b(w,F,Q){var le=so(w,8,u,u,u,u,u,F=Q?u:F);return le.placeholder=b.placeholder,le},ge.curryRight=function b(w,F,Q){var le=so(w,p,u,u,u,u,u,F=Q?u:F);return le.placeholder=b.placeholder,le},ge.debounce=FE,ge.defaults=xi,ge.defaultsDeep=_i,ge.defer=oo,ge.delay=pf,ge.difference=Fm,ge.differenceBy=Ha,ge.differenceWith=zm,ge.drop=function(b,w,F){var Q=b==null?0:b.length;return Q?us(b,(w=F||w===u?1:_e(w))<0?0:w,Q):[]},ge.dropRight=function(b,w,F){var Q=b==null?0:b.length;return Q?us(b,0,(w=Q-(w=F||w===u?1:_e(w)))<0?0:w):[]},ge.dropRightWhile=function(b,w){return b&&b.length?Au(b,li(w,3),!0,!0):[]},ge.dropWhile=function(b,w){return b&&b.length?Au(b,li(w,3),!0):[]},ge.fill=function(b,w,F,Q){var le=b==null?0:b.length;return le?(F&&typeof F!="number"&&Wo(b,w,F)&&(F=0,Q=le),function(xe,Pe,We,ct){var kt=xe.length;for((We=_e(We))<0&&(We=-We>kt?0:kt+We),(ct=ct===u||ct>kt?kt:_e(ct))<0&&(ct+=kt),ct=We>ct?0:lt(ct);We<ct;)xe[We++]=Pe;return xe}(b,w,F,Q)):[]},ge.filter=function(b,w){return(Jn(b)?yu:Rm)(b,li(w,3))},ge.flatMap=function(b,w){return Ba(Wy(b,w),1)},ge.flatMapDeep=function(b,w){return Ba(Wy(b,w),T)},ge.flatMapDepth=function(b,w,F){return F=F===u?1:_e(F),Ba(Wy(b,w),F)},ge.flatten=Rx,ge.flattenDeep=function(b){return b!=null&&b.length?Ba(b,T):[]},ge.flattenDepth=function(b,w){return b!=null&&b.length?Ba(b,w=w===u?1:_e(w)):[]},ge.flip=function(b){return so(b,512)},ge.flow=bc,ge.flowRight=Zc,ge.fromPairs=function(b){for(var w=-1,F=b==null?0:b.length,Q={};++w<F;){var le=b[w];Q[le[0]]=le[1]}return Q},ge.functions=function(b){return b==null?[]:Cu(b,Tn(b))},ge.functionsIn=function(b){return b==null?[]:Cu(b,$n(b))},ge.groupBy=PE,ge.initial=function(b){return b!=null&&b.length?us(b,0,-1):[]},ge.intersection=$y,ge.intersectionBy=Yo,ge.intersectionWith=Ro,ge.invert=bi,ge.invertBy=Ai,ge.invokeMap=_R,ge.iteratee=Zo,ge.keyBy=Ox,ge.keys=Tn,ge.keysIn=$n,ge.map=Wy,ge.mapKeys=function(b,w){var F={};return w=li(w,3),wu(b,function(Q,le,xe){xu(F,w(Q,le,xe),Q)}),F},ge.mapValues=function(b,w){var F={};return w=li(w,3),wu(b,function(Q,le,xe){xu(F,le,w(Q,le,xe))}),F},ge.matches=function(b){return k0(vc(b,1))},ge.matchesProperty=function(b,w){return fh(b,vc(w,1))},ge.memoize=Ko,ge.merge=$i,ge.mergeWith=Jr,ge.method=Sh,ge.methodOf=$l,ge.mixin=Aa,ge.negate=Jo,ge.nthArg=function(b){return b=_e(b),qi(function(w){return P0(w,b)})},ge.omit=ys,ge.omitBy=function(b,w){return ds(b,Jo(li(w)))},ge.once=function(b){return Yy(2,b)},ge.orderBy=function(b,w,F,Q){return b==null?[]:(Jn(w)||(w=w==null?[]:[w]),Jn(F=Q?u:F)||(F=F==null?[]:[F]),df(b,w,F))},ge.over=Oo,ge.overArgs=ER,ge.overEvery=Qo,ge.overSome=gf,ge.partial=Xy,ge.partialRight=K0,ge.partition=LE,ge.pick=Zr,ge.pickBy=ds,ge.property=vf,ge.propertyOf=function(b){return function(w){return b==null?u:js(b,w)}},ge.pull=kE,ge.pullAll=Ax,ge.pullAllBy=function(b,w,F){return b&&b.length&&w&&w.length?L0(b,w,li(F,2)):b},ge.pullAllWith=function(b,w,F){return b&&b.length&&w&&w.length?L0(b,w,u,F):b},ge.pullAt=gd,ge.range=Np,ge.rangeRight=Gs,ge.rearg=ja,ge.reject=function(b,w){return(Jn(b)?yu:Rm)(b,Jo(li(w,3)))},ge.remove=function(b,w){var F=[];if(!b||!b.length)return F;var Q=-1,le=[],xe=b.length;for(w=li(w,3);++Q<xe;){var Pe=b[Q];w(Pe,Q,b)&&(F.push(Pe),le.push(Q))}return Uy(b,le),F},ge.rest=function(b,w){if(typeof b!="function")throw new $c(h);return qi(b,w=w===u?w:_e(w))},ge.reverse=br,ge.sampleSize=function(b,w,F){return w=(F?Wo(b,w,F):w===u)?1:_e(w),(Jn(b)?ky:_x)(b,w)},ge.set=function(b,w,F){return b==null?b:Om(b,w,F)},ge.setWith=function(b,w,F,Q){return Q=typeof Q=="function"?Q:u,b==null?b:Om(b,w,F,Q)},ge.shuffle=function(b){return(Jn(b)?C0:Ep)(b)},ge.slice=function(b,w,F){var Q=b==null?0:b.length;return Q?(F&&typeof F!="number"&&Wo(b,w,F)?(w=0,F=Q):(w=w==null?0:_e(w),F=F===u?Q:_e(F)),us(b,w,F)):[]},ge.sortBy=bR,ge.sortedUniq=function(b){return b&&b.length?Tp(b):[]},ge.sortedUniqBy=function(b,w){return b&&b.length?Tp(b,li(w,2)):[]},ge.split=function(b,w,F){return F&&typeof F!="number"&&Wo(b,w,F)&&(w=F=u),(F=F===u?A:F>>>0)?(b=It(b))&&(typeof w=="string"||w!=null&&!re(w))&&!(w=Kc(w))&&rf(b)?ro(Ys(b),0,F):b.split(w,F):[]},ge.spread=function(b,w){if(typeof b!="function")throw new $c(h);return w=w==null?0:Ts(_e(w),0),qi(function(F){var Q=F[w],le=ro(F,0,w);return Q&&oh(le,Q),jo(b,this,le)})},ge.tail=function(b){var w=b==null?0:b.length;return w?us(b,1,w):[]},ge.take=function(b,w,F){return b&&b.length?us(b,0,(w=F||w===u?1:_e(w))<0?0:w):[]},ge.takeRight=function(b,w,F){var Q=b==null?0:b.length;return Q?us(b,(w=Q-(w=F||w===u?1:_e(w)))<0?0:w,Q):[]},ge.takeRightWhile=function(b,w){return b&&b.length?Au(b,li(w,3),!1,!0):[]},ge.takeWhile=function(b,w){return b&&b.length?Au(b,li(w,3)):[]},ge.tap=function(b,w){return w(b),b},ge.throttle=function(b,w,F){var Q=!0,le=!0;if(typeof b!="function")throw new $c(h);return M(F)&&(Q="leading"in F?!!F.leading:Q,le="trailing"in F?!!F.trailing:le),FE(b,w,{leading:Q,maxWait:w,trailing:le})},ge.thru=_h,ge.toArray=Ye,ge.toPairs=Qr,ge.toPairsIn=Ir,ge.toPath=function(b){return Jn(b)?Ss(b,Du):he(b)?[b]:_c(qy(It(b)))},ge.toPlainObject=Kt,ge.transform=function(b,w,F){var Q=Jn(b),le=Q||mf(b)||pe(b);if(w=li(w,4),F==null){var xe=b&&b.constructor;F=le?Q?new xe:[]:M(b)&&O(xe)?ud(Sm(b)):{}}return(le?Vo:wu)(b,function(Pe,We,ct){return w(F,Pe,We,ct)}),F},ge.unary=function(b){return Gm(b,1)},ge.union=pR,ge.unionBy=mR,ge.unionWith=gR,ge.uniq=function(b){return b&&b.length?gh(b):[]},ge.uniqBy=function(b,w){return b&&b.length?gh(b,li(w,2)):[]},ge.uniqWith=function(b,w){return w=typeof w=="function"?w:u,b&&b.length?gh(b,u,w):[]},ge.unset=function(b,w){return b==null||xp(b,w)},ge.unzip=jm,ge.unzipWith=Vm,ge.update=function(b,w,F){return b==null?b:SE(b,w,Mu(F))},ge.updateWith=function(b,w,F,Q){return Q=typeof Q=="function"?Q:u,b==null?b:SE(b,w,Mu(F),Q)},ge.values=hr,ge.valuesIn=function(b){return b==null?[]:Ms(b,$n(b))},ge.without=Y0,ge.words=Gi,ge.wrap=function(b,w){return Xy(Mu(w),b)},ge.xor=vR,ge.xorBy=yR,ge.xorWith=Mx,ge.zip=Pu,ge.zipObject=function(b,w){return wp(b||[],w||[],uf)},ge.zipObjectDeep=function(b,w){return wp(b||[],w||[],Om)},ge.zipWith=Lu,ge.entries=Qr,ge.entriesIn=Ir,ge.extend=wn,ge.extendWith=yi,Aa(ge,ge),ge.add=Uu,ge.attempt=Mr,ge.camelCase=$r,ge.capitalize=es,ge.ceil=Cl,ge.clamp=function(b,w,F){return F===u&&(F=w,w=u),F!==u&&(F=(F=wt(F))==F?F:0),w!==u&&(w=(w=wt(w))==w?w:0),dd(wt(b),w,F)},ge.clone=function(b){return vc(b,4)},ge.cloneDeep=function(b){return vc(b,5)},ge.cloneDeepWith=function(b,w){return vc(b,5,w=typeof w=="function"?w:u)},ge.cloneWith=function(b,w){return vc(b,4,w=typeof w=="function"?w:u)},ge.conformsTo=function(b,w){return w==null||ls(b,w,Tn(w))},ge.deburr=fs,ge.defaultTo=function(b,w){return b==null||b!=b?w:b},ge.divide=J0,ge.endsWith=function(b,w,F){b=It(b),w=Kc(w);var Q=b.length,le=F=F===u?Q:dd(_e(F),0,Q);return(F-=w.length)>=0&&b.slice(F,le)==w},ge.eq=Ns,ge.escape=function(b){return(b=It(b))&&be.test(b)?b.replace(gt,m0):b},ge.escapeRegExp=function(b){return(b=It(b))&&Yt.test(b)?b.replace(Mt,"\\$&"):b},ge.every=function(b,w,F){var Q=Jn(b)?sE:mE;return F&&Wo(b,w,F)&&(w=u),Q(b,li(w,3))},ge.find=Vs,ge.findIndex=fa,ge.findKey=function(b,w){return oE(b,li(w,3),wu)},ge.findLast=Xo,ge.findLastIndex=yh,ge.findLastKey=function(b,w){return oE(b,li(w,3),vE)},ge.floor=Ky,ge.forEach=DE,ge.forEachRight=X0,ge.forIn=function(b,w){return b==null?b:O0(b,li(w,3),$n)},ge.forInRight=function(b,w){return b==null?b:gE(b,li(w,3),$n)},ge.forOwn=function(b,w){return b&&wu(b,li(w,3))},ge.forOwnRight=function(b,w){return b&&vE(b,li(w,3))},ge.get=Ri,ge.gt=Eh,ge.gte=SR,ge.has=function(b,w){return b!=null&&Mp(b,w,Am)},ge.hasIn=Di,ge.head=Hm,ge.identity=ps,ge.includes=function(b,w,F,Q){b=co(b)?b:hr(b),F=F&&!Q?_e(F):0;var le=b.length;return F<0&&(F=Ts(le+F,0)),se(b)?F<=le&&b.indexOf(w,F)>-1:!!le&&nf(b,w,F)>-1},ge.indexOf=function(b,w,F){var Q=b==null?0:b.length;if(!Q)return-1;var le=F==null?0:_e(F);return le<0&&(le=Ts(Q+le,0)),nf(b,w,le)},ge.inRange=function(b,w,F){return w=Oe(w),F===u?(F=w,w=0):F=Oe(F),function(Q,le,xe){return Q>=Xs(le,xe)&&Q<Ts(le,xe)}(b=wt(b),w,F)},ge.invoke=ui,ge.isArguments=Hr,ge.isArray=Jn,ge.isArrayBuffer=Nx,ge.isArrayLike=co,ge.isArrayLikeObject=Is,ge.isBoolean=function(b){return b===!0||b===!1||P(b)&&da(b)==U},ge.isBuffer=mf,ge.isDate=qm,ge.isElement=function(b){return P(b)&&b.nodeType===1&&!te(b)},ge.isEmpty=function(b){if(b==null)return!0;if(co(b)&&(Jn(b)||typeof b=="string"||typeof b.splice=="function"||mf(b)||pe(b)||Hr(b)))return!b.length;var w=Fa(b);if(w==ie||w==oe)return!b.size;if(q0(b))return!_E(b).length;for(var F in b)if(Ar.call(b,F))return!1;return!0},ge.isEqual=function(b,w){return or(b,w)},ge.isEqualWith=function(b,w,F){var Q=(F=typeof F=="function"?F:u)?F(b,w):u;return Q===u?or(b,w,u,F):!!Q},ge.isError=zE,ge.isFinite=function(b){return typeof b=="number"&&xa(b)},ge.isFunction=O,ge.isInteger=S,ge.isLength=R,ge.isMap=B,ge.isMatch=function(b,w){return b===w||I0(b,w,ti(w))},ge.isMatchWith=function(b,w,F){return F=typeof F=="function"?F:u,I0(b,w,ti(w),F)},ge.isNaN=function(b){return H(b)&&b!=+b},ge.isNative=function(b){if(fR(b))throw new ji("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return vx(b)},ge.isNil=function(b){return b==null},ge.isNull=function(b){return b===null},ge.isNumber=H,ge.isObject=M,ge.isObjectLike=P,ge.isPlainObject=te,ge.isRegExp=re,ge.isSafeInteger=function(b){return S(b)&&b>=-9007199254740991&&b<=x},ge.isSet=K,ge.isString=se,ge.isSymbol=he,ge.isTypedArray=pe,ge.isUndefined=function(b){return b===u},ge.isWeakMap=function(b){return P(b)&&Fa(b)==He},ge.isWeakSet=function(b){return P(b)&&da(b)=="[object WeakSet]"},ge.join=function(b,w){return b==null?"":fE.call(b,w)},ge.kebabCase=Ks,ge.last=Ao,ge.lastIndexOf=function(b,w,F){var Q=b==null?0:b.length;if(!Q)return-1;var le=Q;return F!==u&&(le=(le=_e(F))<0?Ts(Q+le,0):Xs(le,Q-1)),w==w?function(xe,Pe,We){for(var ct=We+1;ct--;)if(xe[ct]===Pe)return ct;return ct}(b,w,le):tf(b,cE,le,!0)},ge.lowerCase=pa,ge.lowerFirst=_s,ge.lt=Ne,ge.lte=Je,ge.max=function(b){return b&&b.length?Cm(b,ps,zr):u},ge.maxBy=function(b,w){return b&&b.length?Cm(b,li(w,2),zr):u},ge.mean=function(b){return lE(b,ps)},ge.meanBy=function(b,w){return lE(b,li(w,2))},ge.min=function(b){return b&&b.length?Cm(b,ps,Ly):u},ge.minBy=function(b,w){return b&&b.length?Cm(b,li(w,2),Ly):u},ge.stubArray=yd,ge.stubFalse=Th,ge.stubObject=function(){return{}},ge.stubString=function(){return""},ge.stubTrue=function(){return!0},ge.multiply=Wr,ge.nth=function(b,w){return b&&b.length?P0(b,_e(w)):u},ge.noConflict=function(){return bn._===this&&(bn._=Ny),this},ge.noop=lo,ge.now=Ca,ge.pad=function(b,w,F){b=It(b);var Q=(w=_e(w))?Ta(b):0;if(!w||Q>=w)return b;var le=(w-Q)/2;return ql(Yc(le),F)+b+ql(Eu(le),F)},ge.padEnd=function(b,w,F){b=It(b);var Q=(w=_e(w))?Ta(b):0;return w&&Q<w?b+ql(w-Q,F):b},ge.padStart=function(b,w,F){b=It(b);var Q=(w=_e(w))?Ta(b):0;return w&&Q<w?ql(w-Q,F)+b:b},ge.parseInt=function(b,w,F){return F||w==null?w=0:w&&(w=+w),pc(It(b).replace(ce,""),w||0)},ge.random=function(b,w,F){if(F&&typeof F!="boolean"&&Wo(b,w,F)&&(w=F=u),F===u&&(typeof w=="boolean"?(F=w,w=u):typeof b=="boolean"&&(F=b,b=u)),b===u&&w===u?(b=0,w=1):(b=Oe(b),w===u?(w=b,b=0):w=Oe(w)),b>w){var Q=b;b=w,w=Q}if(F||b%1||w%1){var le=To();return Xs(b+le*(w-b+zl("1e-"+((le+"").length-1))),w)}return EE(b,w)},ge.reduce=function(b,w,F){var Q=Jn(b)?Cy:uE,le=arguments.length<3;return Q(b,li(w,4),F,le,El)},ge.reduceRight=function(b,w,F){var Q=Jn(b)?aE:uE,le=arguments.length<3;return Q(b,li(w,4),F,le,M0)},ge.repeat=function(b,w,F){return w=(F?Wo(b,w,F):w===u)?1:_e(w),By(It(b),w)},ge.replace=function(){var b=arguments,w=It(b[0]);return b.length<3?w:w.replace(b[1],b[2])},ge.result=function(b,w,F){var Q=-1,le=(w=vh(w,b)).length;for(le||(le=1,b=u);++Q<le;){var xe=b==null?u:b[Du(w[Q])];xe===u&&(Q=le,xe=F),b=O(xe)?xe.call(b):xe}return b},ge.round=Q0,ge.runInContext=ft,ge.sample=function(b){return(Jn(b)?Vl:U0)(b)},ge.size=function(b){if(b==null)return 0;if(co(b))return se(b)?Ta(b):b.length;var w=Fa(b);return w==ie||w==oe?b.size:_E(b).length},ge.snakeCase=ks,ge.some=function(b,w,F){var Q=Jn(b)?Ry:ph;return F&&Wo(b,w,F)&&(w=u),Q(b,li(w,3))},ge.sortedIndex=function(b,w){return Sp(b,w)},ge.sortedIndexBy=function(b,w,F){return Nm(b,w,li(F,2))},ge.sortedIndexOf=function(b,w){var F=b==null?0:b.length;if(F){var Q=Sp(b,w);if(Q<F&&Ns(b[Q],w))return Q}return-1},ge.sortedLastIndex=function(b,w){return Sp(b,w,!0)},ge.sortedLastIndexBy=function(b,w,F){return Nm(b,w,li(F,2),!0)},ge.sortedLastIndexOf=function(b,w){if(b!=null&&b.length){var F=Sp(b,w,!0)-1;if(Ns(b[F],w))return F}return-1},ge.startCase=dr,ge.startsWith=function(b,w,F){return b=It(b),F=F==null?0:dd(_e(F),0,b.length),w=Kc(w),b.slice(F,F+w.length)==w},ge.subtract=xh,ge.sum=function(b){return b&&b.length?ch(b,ps):0},ge.sumBy=function(b,w){return b&&b.length?ch(b,li(w,2)):0},ge.template=function(b,w,F){var Q=ge.templateSettings;F&&Wo(b,w,F)&&(w=u),b=It(b),w=yi({},w,Q,Iu);var le,xe,Pe=yi({},w.imports,Q.imports,Iu),We=Tn(Pe),ct=Ms(Pe,We),kt=0,Lt=w.interpolate||ot,Wt="__p += '",An=Hl((w.escape||ot).source+"|"+Lt.source+"|"+(Lt===nt?Vn:ot).source+"|"+(w.evaluate||ot).source+"|$","g"),Un="//# sourceURL="+(Ar.call(w,"sourceURL")?(w.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Yn+"]")+`
`;b.replace(An,function(Zt,mi,Gt,Mn,on,In){return Gt||(Gt=Mn),Wt+=b.slice(kt,In).replace(Ct,fx),mi&&(le=!0,Wt+=`' +
__e(`+mi+`) +
'`),on&&(xe=!0,Wt+=`';
`+on+`;
__p += '`),Gt&&(Wt+=`' +
((__t = (`+Gt+`)) == null ? '' : __t) +
'`),kt=In+Zt.length,Zt}),Wt+=`';
`;var ni=Ar.call(w,"variable")&&w.variable;if(ni){if(mt.test(ni))throw new ji("Invalid `variable` option passed into `_.template`")}else Wt=`with (obj) {
`+Wt+`
}
`;Wt=(xe?Wt.replace(Fe,""):Wt).replace(Ie,"$1").replace(it,"$1;"),Wt="function("+(ni||"obj")+`) {
`+(ni?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(le?", __e = _.escape":"")+(xe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Wt+`return __p
}`;var Ut=Mr(function(){return la(We,Un+"return "+Wt).apply(u,ct)});if(Ut.source=Wt,zE(Ut))throw Ut;return Ut},ge.times=function(b,w){if((b=_e(b))<1||b>x)return[];var F=A,Q=Xs(b,A);w=li(w),b-=A;for(var le=ym(Q,w);++F<b;)w(F);return le},ge.toFinite=Oe,ge.toInteger=_e,ge.toLength=lt,ge.toLower=function(b){return It(b).toLowerCase()},ge.toNumber=wt,ge.toSafeInteger=function(b){return b?dd(_e(b),-9007199254740991,x):b===0?b:0},ge.toString=It,ge.toUpper=function(b){return It(b).toUpperCase()},ge.trim=function(b,w,F){if((b=It(b))&&(F||w===u))return hE(b);if(!b||!(w=Kc(w)))return b;var Q=Ys(b),le=Ys(w);return ro(Q,hx(Q,le),ca(Q,le)+1).join("")},ge.trimEnd=function(b,w,F){if((b=It(b))&&(F||w===u))return b.slice(0,g0(b)+1);if(!b||!(w=Kc(w)))return b;var Q=Ys(b);return ro(Q,0,ca(Q,Ys(w))+1).join("")},ge.trimStart=function(b,w,F){if((b=It(b))&&(F||w===u))return b.replace(ce,"");if(!b||!(w=Kc(w)))return b;var Q=Ys(b);return ro(Q,hx(Q,Ys(w))).join("")},ge.truncate=function(b,w){var F=30,Q="...";if(M(w)){var le="separator"in w?w.separator:le;F="length"in w?_e(w.length):F,Q="omission"in w?Kc(w.omission):Q}var xe=(b=It(b)).length;if(rf(b)){var Pe=Ys(b);xe=Pe.length}if(F>=xe)return b;var We=F-Ta(Q);if(We<1)return Q;var ct=Pe?ro(Pe,0,We).join(""):b.slice(0,We);if(le===u)return ct+Q;if(Pe&&(We+=ct.length-We),re(le)){if(b.slice(We).search(le)){var kt,Lt=ct;for(le.global||(le=Hl(le.source,It(qe.exec(le))+"g")),le.lastIndex=0;kt=le.exec(Lt);)var Wt=kt.index;ct=ct.slice(0,Wt===u?We:Wt)}}else if(b.indexOf(Kc(le),We)!=We){var An=ct.lastIndexOf(le);An>-1&&(ct=ct.slice(0,An))}return ct+Q},ge.unescape=function(b){return(b=It(b))&&bt.test(b)?b.replace(dt,od):b},ge.uniqueId=function(b){var w=++y0;return It(b)+w},ge.upperCase=Ra,ge.upperFirst=Zn,ge.each=DE,ge.eachRight=X0,ge.first=Hm,Aa(ge,(Z0={},wu(ge,function(b,w){Ar.call(ge.prototype,w)||(Z0[w]=b)}),Z0),{chain:!1}),ge.VERSION="4.17.21",Vo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(b){ge[b].placeholder=ge}),Vo(["drop","take"],function(b,w){Bi.prototype[b]=function(F){F=F===u?1:Ts(_e(F),0);var Q=this.__filtered__&&!w?new Bi(this):this.clone();return Q.__filtered__?Q.__takeCount__=Xs(F,Q.__takeCount__):Q.__views__.push({size:Xs(F,A),type:b+(Q.__dir__<0?"Right":"")}),Q},Bi.prototype[b+"Right"]=function(F){return this.reverse()[b](F).reverse()}}),Vo(["filter","map","takeWhile"],function(b,w){var F=w+1,Q=F==1||F==3;Bi.prototype[b]=function(le){var xe=this.clone();return xe.__iteratees__.push({iteratee:li(le,3),type:F}),xe.__filtered__=xe.__filtered__||Q,xe}}),Vo(["head","last"],function(b,w){var F="take"+(w?"Right":"");Bi.prototype[b]=function(){return this[F](1).value()[0]}}),Vo(["initial","tail"],function(b,w){var F="drop"+(w?"":"Right");Bi.prototype[b]=function(){return this.__filtered__?new Bi(this):this[F](1)}}),Bi.prototype.compact=function(){return this.filter(ps)},Bi.prototype.find=function(b){return this.filter(b).head()},Bi.prototype.findLast=function(b){return this.reverse().find(b)},Bi.prototype.invokeMap=qi(function(b,w){return typeof b=="function"?new Bi(this):this.map(function(F){return yc(F,b,w)})}),Bi.prototype.reject=function(b){return this.filter(Jo(li(b)))},Bi.prototype.slice=function(b,w){b=_e(b);var F=this;return F.__filtered__&&(b>0||w<0)?new Bi(F):(b<0?F=F.takeRight(-b):b&&(F=F.drop(b)),w!==u&&(F=(w=_e(w))<0?F.dropRight(-w):F.take(w-b)),F)},Bi.prototype.takeRightWhile=function(b){return this.reverse().takeWhile(b).reverse()},Bi.prototype.toArray=function(){return this.take(A)},wu(Bi.prototype,function(b,w){var F=/^(?:filter|find|map|reject)|While$/.test(w),Q=/^(?:head|last)$/.test(w),le=ge[Q?"take"+(w=="last"?"Right":""):w],xe=Q||/^find/.test(w);le&&(ge.prototype[w]=function(){var Pe=this.__wrapped__,We=Q?[1]:arguments,ct=Pe instanceof Bi,kt=We[0],Lt=ct||Jn(Pe),Wt=function(mi){var Gt=le.apply(ge,oh([mi],We));return Q&&An?Gt[0]:Gt};Lt&&F&&typeof kt=="function"&&kt.length!=1&&(ct=Lt=!1);var An=this.__chain__,Un=!!this.__actions__.length,ni=xe&&!An,Ut=ct&&!Un;if(!xe&&Lt){Pe=Ut?Pe:new Bi(this);var Zt=b.apply(Pe,We);return Zt.__actions__.push({func:_h,args:[Wt],thisArg:u}),new io(Zt,An)}return ni&&Ut?b.apply(this,We):(Zt=this.thru(Wt),ni?Q?Zt.value()[0]:Zt.value():Zt)})}),Vo(["pop","push","shift","sort","splice","unshift"],function(b){var w=Em[b],F=/^(?:push|sort|unshift)$/.test(b)?"tap":"thru",Q=/^(?:pop|shift)$/.test(b);ge.prototype[b]=function(){var le=arguments;if(Q&&!this.__chain__){var xe=this.value();return w.apply(Jn(xe)?xe:[],le)}return this[F](function(Pe){return w.apply(Jn(Pe)?Pe:[],le)})}}),wu(Bi.prototype,function(b,w){var F=ge[w];if(F){var Q=F.name+"";Ar.call(ha,Q)||(ha[Q]=[]),ha[Q].push({name:w,func:F})}}),ha[H0(u,2).name]=[{name:"wrapper",func:u}],Bi.prototype.clone=function(){var b=new Bi(this.__wrapped__);return b.__actions__=_c(this.__actions__),b.__dir__=this.__dir__,b.__filtered__=this.__filtered__,b.__iteratees__=_c(this.__iteratees__),b.__takeCount__=this.__takeCount__,b.__views__=_c(this.__views__),b},Bi.prototype.reverse=function(){if(this.__filtered__){var b=new Bi(this);b.__dir__=-1,b.__filtered__=!0}else(b=this.clone()).__dir__*=-1;return b},Bi.prototype.value=function(){var b=this.__wrapped__.value(),w=this.__dir__,F=Jn(b),Q=w<0,le=F?b.length:0,xe=function(In,ln,Fn){for(var xs=-1,Ds=Fn.length;++xs<Ds;){var Ec=Fn[xs],kr=Ec.size;switch(Ec.type){case"drop":In+=kr;break;case"dropRight":ln-=kr;break;case"take":ln=Xs(ln,In+kr);break;case"takeRight":In=Ts(In,ln-kr)}}return{start:In,end:ln}}(0,le,this.__views__),Pe=xe.start,We=xe.end,ct=We-Pe,kt=Q?We:Pe-1,Lt=this.__iteratees__,Wt=Lt.length,An=0,Un=Xs(ct,this.__takeCount__);if(!F||!Q&&le==ct&&Un==ct)return Im(b,this.__actions__);var ni=[];e:for(;ct--&&An<Un;){for(var Ut=-1,Zt=b[kt+=w];++Ut<Wt;){var mi=Lt[Ut],Gt=mi.iteratee,Mn=mi.type,on=Gt(Zt);if(Mn==2)Zt=on;else if(!on){if(Mn==1)continue e;break e}}ni[An++]=Zt}return ni},ge.prototype.at=vd,ge.prototype.chain=function(){return ao(this)},ge.prototype.commit=function(){return new io(this.value(),this.__chain__)},ge.prototype.next=function(){this.__values__===u&&(this.__values__=Ye(this.value()));var b=this.__index__>=this.__values__.length;return{done:b,value:b?u:this.__values__[this.__index__++]}},ge.prototype.plant=function(b){for(var w,F=this;F instanceof dh;){var Q=IE(F);Q.__index__=0,Q.__values__=u,w?le.__wrapped__=Q:w=Q;var le=Q;F=F.__wrapped__}return le.__wrapped__=b,w},ge.prototype.reverse=function(){var b=this.__wrapped__;if(b instanceof Bi){var w=b;return this.__actions__.length&&(w=new Bi(this)),(w=w.reverse()).__actions__.push({func:_h,args:[br],thisArg:u}),new io(w,this.__chain__)}return this.thru(br)},ge.prototype.toJSON=ge.prototype.valueOf=ge.prototype.value=function(){return Im(this.__wrapped__,this.__actions__)},ge.prototype.first=ge.prototype.head,bu&&(ge.prototype[bu]=function(){return this}),ge}();bn._=vp,(l=(function(){return vp}).call(o,c,o,a))===u||(a.exports=l)}).call(this)},2492:(a,o,c)=>{var l=c(2980),u=c(1463)(function(h,d,f){l(h,d,f)});a.exports=u},5062:a=>{a.exports=function(){return!1}},9881:(a,o,c)=>{var l=c(8363),u=c(1704);a.exports=function(h){return l(h,u(h))}},6692:a=>{var o=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(c){return c.encoding?"rtpmap:%d %s/%s/%s":c.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(c){return c.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(c){return c.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(c){return"extmap:%d"+(c.direction?"/%s":"%v")+(c["encrypt-uri"]?" %s":"%v")+" %s"+(c.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(c){return c.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(c){var l="candidate:%s %d %s %d %s %d typ %s";return l+=c.raddr!=null?" raddr %s rport %d":"%v%v",l+=c.tcptype!=null?" tcptype %s":"%v",c.generation!=null&&(l+=" generation %d"),l+=c["network-id"]!=null?" network-id %d":"%v",l+=c["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(c){var l="ssrc:%d";return c.attribute!=null&&(l+=" %s",c.value!=null&&(l+=":%s")),l}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(c){return c.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(c){return c.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(c){return"imageattr:%s %s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(c){return"simulcast:%s %s"+(c.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(c){return"ts-refclk:%s"+(c.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(c){var l="mediaclk:";return l+=c.id!=null?"id=%s %s":"%v%s",l+=c.mediaClockValue!=null?"=%s":"",l+=c.rateNumerator!=null?" rate=%s":"",l+=c.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(o).forEach(function(c){o[c].forEach(function(l){l.reg||(l.reg=/(.*)/),l.format||(l.format="%s")})})},766:(a,o,c)=>{var l=c(962),u=c(8627);o.cW=u,o.Qc=l.parse,o.rz=l.parseParams,l.parseFmtpConfig,l.parsePayloads,l.parseRemoteCandidates,l.parseImageAttributes,l.parseSimulcastStreamList},962:(a,o,c)=>{var l=function(p){return String(Number(p))===p?Number(p):p},u=function(p,g,_){var v=p.name&&p.names;p.push&&!g[p.push]?g[p.push]=[]:v&&!g[p.name]&&(g[p.name]={});var E=p.push?{}:v?g[p.name]:g;(function(T,x,N,A){if(A&&!N)x[A]=l(T[1]);else for(var I=0;I<N.length;I+=1)T[I+1]!=null&&(x[N[I]]=l(T[I+1]))})(_.match(p.reg),E,p.names,p.name),p.push&&g[p.push].push(E)},h=c(6692),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);o.parse=function(p){var g={},_=[],v=g;return p.split(/(\r\n|\r|\n)/).filter(d).forEach(function(E){var T=E[0],x=E.slice(2);T==="m"&&(_.push({rtp:[],fmtp:[]}),v=_[_.length-1]);for(var N=0;N<(h[T]||[]).length;N+=1){var A=h[T][N];if(A.reg.test(x))return u(A,v,x)}}),g.media=_,g};var f=function(p,g){var _=g.split(/=(.+)/,2);return _.length===2?p[_[0]]=l(_[1]):_.length===1&&g.length>1&&(p[_[0]]=void 0),p};o.parseParams=function(p){return p.split(/;\s?/).reduce(f,{})},o.parseFmtpConfig=o.parseParams,o.parsePayloads=function(p){return p.toString().split(" ").map(Number)},o.parseRemoteCandidates=function(p){for(var g=[],_=p.split(" ").map(l),v=0;v<_.length;v+=3)g.push({component:_[v],ip:_[v+1],port:_[v+2]});return g},o.parseImageAttributes=function(p){return p.split(" ").map(function(g){return g.substring(1,g.length-1).split(",").reduce(f,{})})},o.parseSimulcastStreamList=function(p){return p.split(";").map(function(g){return g.split(",").map(function(_){var v,E=!1;return _[0]!=="~"?v=l(_):(v=l(_.substring(1,_.length)),E=!0),{scid:v,paused:E}})})}},8627:(a,o,c)=>{var l=c(6692),u=/%[sdv%]/g,h=function(g){var _=1,v=arguments,E=v.length;return g.replace(u,function(T){if(_>=E)return T;var x=v[_];switch(_+=1,T){case"%%":return"%";case"%s":return String(x);case"%d":return Number(x);case"%v":return""}})},d=function(g,_,v){var E=[g+"="+(_.format instanceof Function?_.format(_.push?v:v[_.name]):_.format)];if(_.names)for(var T=0;T<_.names.length;T+=1){var x=_.names[T];_.name?E.push(v[_.name][x]):E.push(v[_.names[T]])}else E.push(v[_.name]);return h.apply(null,E)},f=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];a.exports=function(g,_){_=_||{},g.version==null&&(g.version=0),g.name==null&&(g.name=" "),g.media.forEach(function(x){x.payloads==null&&(x.payloads="")});var v=_.outerOrder||f,E=_.innerOrder||p,T=[];return v.forEach(function(x){l[x].forEach(function(N){N.name in g&&g[N.name]!=null?T.push(d(x,N,g)):N.push in g&&g[N.push]!=null&&g[N.push].forEach(function(A){T.push(d(x,N,A))})})}),g.media.forEach(function(x){T.push(d("m",l.m[0],x)),E.forEach(function(N){l[N].forEach(function(A){A.name in x&&x[A.name]!=null?T.push(d(N,A,x)):A.push in x&&x[A.push]!=null&&x[A.push].forEach(function(I){T.push(d(N,A,I))})})})}),T.join(`\r
`)+`\r
`}},7539:a=>{const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(c){return c.trim().split(`
`).map(l=>l.trim())},o.splitSections=function(c){return c.split(`
m=`).map((l,u)=>(u>0?"m="+l:l).trim()+`\r
`)},o.getDescription=function(c){const l=o.splitSections(c);return l&&l[0]},o.getMediaSections=function(c){const l=o.splitSections(c);return l.shift(),l},o.matchPrefix=function(c,l){return o.splitLines(c).filter(u=>u.indexOf(l)===0)},o.parseCandidate=function(c){let l;l=c.indexOf("a=candidate:")===0?c.substring(12).split(" "):c.substring(10).split(" ");const u={foundation:l[0],component:{1:"rtp",2:"rtcp"}[l[1]]||l[1],protocol:l[2].toLowerCase(),priority:parseInt(l[3],10),ip:l[4],address:l[4],port:parseInt(l[5],10),type:l[7]};for(let h=8;h<l.length;h+=2)switch(l[h]){case"raddr":u.relatedAddress=l[h+1];break;case"rport":u.relatedPort=parseInt(l[h+1],10);break;case"tcptype":u.tcpType=l[h+1];break;case"ufrag":u.ufrag=l[h+1],u.usernameFragment=l[h+1];break;default:u[l[h]]===void 0&&(u[l[h]]=l[h+1])}return u},o.writeCandidate=function(c){const l=[];l.push(c.foundation);const u=c.component;u==="rtp"?l.push(1):u==="rtcp"?l.push(2):l.push(u),l.push(c.protocol.toUpperCase()),l.push(c.priority),l.push(c.address||c.ip),l.push(c.port);const h=c.type;return l.push("typ"),l.push(h),h!=="host"&&c.relatedAddress&&c.relatedPort&&(l.push("raddr"),l.push(c.relatedAddress),l.push("rport"),l.push(c.relatedPort)),c.tcpType&&c.protocol.toLowerCase()==="tcp"&&(l.push("tcptype"),l.push(c.tcpType)),(c.usernameFragment||c.ufrag)&&(l.push("ufrag"),l.push(c.usernameFragment||c.ufrag)),"candidate:"+l.join(" ")},o.parseIceOptions=function(c){return c.substring(14).split(" ")},o.parseRtpMap=function(c){let l=c.substring(9).split(" ");const u={payloadType:parseInt(l.shift(),10)};return l=l[0].split("/"),u.name=l[0],u.clockRate=parseInt(l[1],10),u.channels=l.length===3?parseInt(l[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(c){let l=c.payloadType;c.preferredPayloadType!==void 0&&(l=c.preferredPayloadType);const u=c.channels||c.numChannels||1;return"a=rtpmap:"+l+" "+c.name+"/"+c.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(c){const l=c.substring(9).split(" ");return{id:parseInt(l[0],10),direction:l[0].indexOf("/")>0?l[0].split("/")[1]:"sendrecv",uri:l[1],attributes:l.slice(2).join(" ")}},o.writeExtmap=function(c){return"a=extmap:"+(c.id||c.preferredId)+(c.direction&&c.direction!=="sendrecv"?"/"+c.direction:"")+" "+c.uri+(c.attributes?" "+c.attributes:"")+`\r
`},o.parseFmtp=function(c){const l={};let u;const h=c.substring(c.indexOf(" ")+1).split(";");for(let d=0;d<h.length;d++)u=h[d].trim().split("="),l[u[0].trim()]=u[1];return l},o.writeFmtp=function(c){let l="",u=c.payloadType;if(c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.parameters&&Object.keys(c.parameters).length){const h=[];Object.keys(c.parameters).forEach(d=>{c.parameters[d]!==void 0?h.push(d+"="+c.parameters[d]):h.push(d)}),l+="a=fmtp:"+u+" "+h.join(";")+`\r
`}return l},o.parseRtcpFb=function(c){const l=c.substring(c.indexOf(" ")+1).split(" ");return{type:l.shift(),parameter:l.join(" ")}},o.writeRtcpFb=function(c){let l="",u=c.payloadType;return c.preferredPayloadType!==void 0&&(u=c.preferredPayloadType),c.rtcpFeedback&&c.rtcpFeedback.length&&c.rtcpFeedback.forEach(h=>{l+="a=rtcp-fb:"+u+" "+h.type+(h.parameter&&h.parameter.length?" "+h.parameter:"")+`\r
`}),l},o.parseSsrcMedia=function(c){const l=c.indexOf(" "),u={ssrc:parseInt(c.substring(7,l),10)},h=c.indexOf(":",l);return h>-1?(u.attribute=c.substring(l+1,h),u.value=c.substring(h+1)):u.attribute=c.substring(l+1),u},o.parseSsrcGroup=function(c){const l=c.substring(13).split(" ");return{semantics:l.shift(),ssrcs:l.map(u=>parseInt(u,10))}},o.getMid=function(c){const l=o.matchPrefix(c,"a=mid:")[0];if(l)return l.substring(6)},o.parseFingerprint=function(c){const l=c.substring(14).split(" ");return{algorithm:l[0].toLowerCase(),value:l[1].toUpperCase()}},o.getDtlsParameters=function(c,l){return{role:"auto",fingerprints:o.matchPrefix(c+l,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(c,l){let u="a=setup:"+l+`\r
`;return c.fingerprints.forEach(h=>{u+="a=fingerprint:"+h.algorithm+" "+h.value+`\r
`}),u},o.parseCryptoLine=function(c){const l=c.substring(9).split(" ");return{tag:parseInt(l[0],10),cryptoSuite:l[1],keyParams:l[2],sessionParams:l.slice(3)}},o.writeCryptoLine=function(c){return"a=crypto:"+c.tag+" "+c.cryptoSuite+" "+(typeof c.keyParams=="object"?o.writeCryptoKeyParams(c.keyParams):c.keyParams)+(c.sessionParams?" "+c.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(c){if(c.indexOf("inline:")!==0)return null;const l=c.substring(7).split("|");return{keyMethod:"inline",keySalt:l[0],lifeTime:l[1],mkiValue:l[2]?l[2].split(":")[0]:void 0,mkiLength:l[2]?l[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(c){return c.keyMethod+":"+c.keySalt+(c.lifeTime?"|"+c.lifeTime:"")+(c.mkiValue&&c.mkiLength?"|"+c.mkiValue+":"+c.mkiLength:"")},o.getCryptoParameters=function(c,l){return o.matchPrefix(c+l,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(c,l){const u=o.matchPrefix(c+l,"a=ice-ufrag:")[0],h=o.matchPrefix(c+l,"a=ice-pwd:")[0];return u&&h?{usernameFragment:u.substring(12),password:h.substring(10)}:null},o.writeIceParameters=function(c){let l="a=ice-ufrag:"+c.usernameFragment+`\r
a=ice-pwd:`+c.password+`\r
`;return c.iceLite&&(l+=`a=ice-lite\r
`),l},o.parseRtpParameters=function(c){const l={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(c)[0].split(" ");l.profile=u[2];for(let d=3;d<u.length;d++){const f=u[d],p=o.matchPrefix(c,"a=rtpmap:"+f+" ")[0];if(p){const g=o.parseRtpMap(p),_=o.matchPrefix(c,"a=fmtp:"+f+" ");switch(g.parameters=_.length?o.parseFmtp(_[0]):{},g.rtcpFeedback=o.matchPrefix(c,"a=rtcp-fb:"+f+" ").map(o.parseRtcpFb),l.codecs.push(g),g.name.toUpperCase()){case"RED":case"ULPFEC":l.fecMechanisms.push(g.name.toUpperCase())}}}o.matchPrefix(c,"a=extmap:").forEach(d=>{l.headerExtensions.push(o.parseExtmap(d))});const h=o.matchPrefix(c,"a=rtcp-fb:* ").map(o.parseRtcpFb);return l.codecs.forEach(d=>{h.forEach(f=>{d.rtcpFeedback.find(p=>p.type===f.type&&p.parameter===f.parameter)||d.rtcpFeedback.push(f)})}),l},o.writeRtpDescription=function(c,l){let u="";u+="m="+c+" ",u+=l.codecs.length>0?"9":"0",u+=" "+(l.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=l.codecs.map(d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,l.codecs.forEach(d=>{u+=o.writeRtpMap(d),u+=o.writeFmtp(d),u+=o.writeRtcpFb(d)});let h=0;return l.codecs.forEach(d=>{d.maxptime>h&&(h=d.maxptime)}),h>0&&(u+="a=maxptime:"+h+`\r
`),l.headerExtensions&&l.headerExtensions.forEach(d=>{u+=o.writeExtmap(d)}),u},o.parseRtpEncodingParameters=function(c){const l=[],u=o.parseRtpParameters(c),h=u.fecMechanisms.indexOf("RED")!==-1,d=u.fecMechanisms.indexOf("ULPFEC")!==-1,f=o.matchPrefix(c,"a=ssrc:").map(E=>o.parseSsrcMedia(E)).filter(E=>E.attribute==="cname"),p=f.length>0&&f[0].ssrc;let g;const _=o.matchPrefix(c,"a=ssrc-group:FID").map(E=>E.substring(17).split(" ").map(T=>parseInt(T,10)));_.length>0&&_[0].length>1&&_[0][0]===p&&(g=_[0][1]),u.codecs.forEach(E=>{if(E.name.toUpperCase()==="RTX"&&E.parameters.apt){let T={ssrc:p,codecPayloadType:parseInt(E.parameters.apt,10)};p&&g&&(T.rtx={ssrc:g}),l.push(T),h&&(T=JSON.parse(JSON.stringify(T)),T.fec={ssrc:p,mechanism:d?"red+ulpfec":"red"},l.push(T))}}),l.length===0&&p&&l.push({ssrc:p});let v=o.matchPrefix(c,"b=");return v.length&&(v=v[0].indexOf("b=TIAS:")===0?parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?1e3*parseInt(v[0].substring(5),10)*.95-16e3:void 0,l.forEach(E=>{E.maxBitrate=v})),l},o.parseRtcpParameters=function(c){const l={},u=o.matchPrefix(c,"a=ssrc:").map(f=>o.parseSsrcMedia(f)).filter(f=>f.attribute==="cname")[0];u&&(l.cname=u.value,l.ssrc=u.ssrc);const h=o.matchPrefix(c,"a=rtcp-rsize");l.reducedSize=h.length>0,l.compound=h.length===0;const d=o.matchPrefix(c,"a=rtcp-mux");return l.mux=d.length>0,l},o.writeRtcpParameters=function(c){let l="";return c.reducedSize&&(l+=`a=rtcp-rsize\r
`),c.mux&&(l+=`a=rtcp-mux\r
`),c.ssrc!==void 0&&c.cname&&(l+="a=ssrc:"+c.ssrc+" cname:"+c.cname+`\r
`),l},o.parseMsid=function(c){let l;const u=o.matchPrefix(c,"a=msid:");if(u.length===1)return l=u[0].substring(7).split(" "),{stream:l[0],track:l[1]};const h=o.matchPrefix(c,"a=ssrc:").map(d=>o.parseSsrcMedia(d)).filter(d=>d.attribute==="msid");return h.length>0?(l=h[0].value.split(" "),{stream:l[0],track:l[1]}):void 0},o.parseSctpDescription=function(c){const l=o.parseMLine(c),u=o.matchPrefix(c,"a=max-message-size:");let h;u.length>0&&(h=parseInt(u[0].substring(19),10)),isNaN(h)&&(h=65536);const d=o.matchPrefix(c,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:l.fmt,maxMessageSize:h};const f=o.matchPrefix(c,"a=sctpmap:");if(f.length>0){const p=f[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:h}}},o.writeSctpDescription=function(c,l){let u=[];return u=c.protocol!=="DTLS/SCTP"?["m="+c.kind+" 9 "+c.protocol+" "+l.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+l.port+`\r
`]:["m="+c.kind+" 9 "+c.protocol+" "+l.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+l.port+" "+l.protocol+` 65535\r
`],l.maxMessageSize!==void 0&&u.push("a=max-message-size:"+l.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(c,l,u){let h;const d=l!==void 0?l:2;return h=c||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+h+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(c,l){const u=o.splitLines(c);for(let h=0;h<u.length;h++)switch(u[h]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[h].substring(2)}return l?o.getDirection(l):"sendrecv"},o.getKind=function(c){return o.splitLines(c)[0].split(" ")[0].substring(2)},o.isRejected=function(c){return c.split(" ",2)[1]==="0"},o.parseMLine=function(c){const l=o.splitLines(c)[0].substring(2).split(" ");return{kind:l[0],port:parseInt(l[1],10),protocol:l[2],fmt:l.slice(3).join(" ")}},o.parseOLine=function(c){const l=o.matchPrefix(c,"o=")[0].substring(2).split(" ");return{username:l[0],sessionId:l[1],sessionVersion:parseInt(l[2],10),netType:l[3],addressType:l[4],address:l[5]}},o.isValidSDP=function(c){if(typeof c!="string"||c.length===0)return!1;const l=o.splitLines(c);for(let u=0;u<l.length;u++)if(l[u].length<2||l[u].charAt(1)!=="=")return!1;return!0},a.exports=o},477:a=>{a.exports=function(o,c,l,u){var h=self||window;try{try{var d;try{d=new h.Blob([o])}catch{(d=new(h.BlobBuilder||h.WebKitBlobBuilder||h.MozBlobBuilder||h.MSBlobBuilder)).append(o),d=d.getBlob()}var f=h.URL||h.webkitURL,p=f.createObjectURL(d),g=new h[c](p,l);return f.revokeObjectURL(p),g}catch{return new h[c]("data:application/javascript,".concat(encodeURIComponent(o)),l)}}catch{if(!u)throw Error("Inline worker is not supported");return new h[c](u,l)}}},8520:(a,o,c)=>{var l;(function(u){(function(h){var d=typeof globalThis=="object"?globalThis:typeof c.g=="object"?c.g:typeof self=="object"?self:typeof this=="object"?this:function(){try{return Function("return this;")()}catch{}}()||function(){try{return(0,eval)("(function() { return this; })()")}catch{}}(),f=p(u);function p(g,_){return function(v,E){Object.defineProperty(g,v,{configurable:!0,writable:!0,value:E}),_&&_(v,E)}}d.Reflect!==void 0&&(f=p(d.Reflect,f)),function(g,_){var v=Object.prototype.hasOwnProperty,E=typeof Symbol=="function",T=E&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",x=E&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",N=typeof Object.create=="function",A={__proto__:[]}instanceof Array,I=!N&&!A,k={create:N?function(){return an(Object.create(null))}:A?function(){return an({__proto__:null})}:function(){return an({})},has:I?function(Ve,ot){return v.call(Ve,ot)}:function(Ve,ot){return ot in Ve},get:I?function(Ve,ot){return v.call(Ve,ot)?Ve[ot]:void 0}:function(Ve,ot){return Ve[ot]}},L=Object.getPrototypeOf(Function),U=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ht(),$=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Pt(),q=typeof WeakMap=="function"?WeakMap:hn(),G=E?Symbol.for("@reflect-metadata:registry"):void 0,X=xt(),ie=Vn(X);function V(Ve,ot,Ct,Nt){if(Ie(Ct)){if(!$e(Ve))throw new TypeError;if(!qt(ot))throw new TypeError;return we(Ve,ot)}if(!$e(Ve))throw new TypeError;if(!gt(ot))throw new TypeError;if(!gt(Nt)&&!Ie(Nt)&&!it(Nt))throw new TypeError;return it(Nt)&&(Nt=void 0),Ce(Ve,ot,Ct=nt(Ct),Nt)}function Z(Ve,ot){function Ct(Nt,Wn){if(!gt(Nt))throw new TypeError;if(!Ie(Wn)&&!Mt(Wn))throw new TypeError;ye(Ve,ot,Nt,Wn)}return Ct}function Y(Ve,ot,Ct,Nt){if(!gt(Ct))throw new TypeError;return Ie(Nt)||(Nt=nt(Nt)),ye(Ve,ot,Ct,Nt)}function ee(Ve,ot,Ct){if(!gt(ot))throw new TypeError;return Ie(Ct)||(Ct=nt(Ct)),ke(Ve,ot,Ct)}function oe(Ve,ot,Ct){if(!gt(ot))throw new TypeError;return Ie(Ct)||(Ct=nt(Ct)),St(Ve,ot,Ct)}function de(Ve,ot,Ct){if(!gt(ot))throw new TypeError;return Ie(Ct)||(Ct=nt(Ct)),At(Ve,ot,Ct)}function Me(Ve,ot,Ct){if(!gt(ot))throw new TypeError;return Ie(Ct)||(Ct=nt(Ct)),Ee(Ve,ot,Ct)}function He(Ve,ot){if(!gt(Ve))throw new TypeError;return Ie(ot)||(ot=nt(ot)),et(Ve,ot)}function Te(Ve,ot){if(!gt(Ve))throw new TypeError;return Ie(ot)||(ot=nt(ot)),fe(Ve,ot)}function Le(Ve,ot,Ct){if(!gt(ot))throw new TypeError;if(Ie(Ct)||(Ct=nt(Ct)),!gt(ot))throw new TypeError;Ie(Ct)||(Ct=nt(Ct));var Nt=Vt(ot,Ct,!1);return!Ie(Nt)&&Nt.OrdinaryDeleteMetadata(Ve,ot,Ct)}function we(Ve,ot){for(var Ct=Ve.length-1;Ct>=0;--Ct){var Nt=(0,Ve[Ct])(ot);if(!Ie(Nt)&&!it(Nt)){if(!qt(Nt))throw new TypeError;ot=Nt}}return ot}function Ce(Ve,ot,Ct,Nt){for(var Wn=Ve.length-1;Wn>=0;--Wn){var sr=(0,Ve[Wn])(ot,Ct,Nt);if(!Ie(sr)&&!it(sr)){if(!gt(sr))throw new TypeError;Nt=sr}}return Nt}function ke(Ve,ot,Ct){if(St(Ve,ot,Ct))return!0;var Nt=je(ot);return!it(Nt)&&ke(Ve,Nt,Ct)}function St(Ve,ot,Ct){var Nt=Vt(ot,Ct,!1);return!Ie(Nt)&&ue(Nt.OrdinaryHasOwnMetadata(Ve,ot,Ct))}function At(Ve,ot,Ct){if(St(Ve,ot,Ct))return Ee(Ve,ot,Ct);var Nt=je(ot);return it(Nt)?void 0:At(Ve,Nt,Ct)}function Ee(Ve,ot,Ct){var Nt=Vt(ot,Ct,!1);if(!Ie(Nt))return Nt.OrdinaryGetOwnMetadata(Ve,ot,Ct)}function ye(Ve,ot,Ct,Nt){Vt(Ct,Nt,!0).OrdinaryDefineOwnMetadata(Ve,ot,Ct,Nt)}function et(Ve,ot){var Ct=fe(Ve,ot),Nt=je(Ve);if(Nt===null)return Ct;var Wn=et(Nt,ot);if(Wn.length<=0)return Ct;if(Ct.length<=0)return Wn;for(var sr=new $,Si=[],si=0,En=Ct;si<En.length;si++){var sn=En[si];sr.has(sn)||(sr.add(sn),Si.push(sn))}for(var Ln=0,Nn=Wn;Ln<Nn.length;Ln++)sn=Nn[Ln],sr.has(sn)||(sr.add(sn),Si.push(sn));return Si}function fe(Ve,ot){var Ct=Vt(Ve,ot,!1);return Ct?Ct.OrdinaryOwnMetadataKeys(Ve,ot):[]}function Fe(Ve){if(Ve===null)return 1;switch(typeof Ve){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Ve===null?1:6;default:return 6}}function Ie(Ve){return Ve===void 0}function it(Ve){return Ve===null}function dt(Ve){return typeof Ve=="symbol"}function gt(Ve){return typeof Ve=="object"?Ve!==null:typeof Ve=="function"}function bt(Ve,ot){switch(Fe(Ve)){case 0:case 1:case 2:case 3:case 4:case 5:return Ve}var Ct="string",Nt=ce(Ve,T);if(Nt!==void 0){var Wn=Nt.call(Ve,Ct);if(gt(Wn))throw new TypeError;return Wn}return be(Ve)}function be(Ve,ot){var Ct,Nt;{var Wn=Ve.toString;if(Ue(Wn)&&!gt(Nt=Wn.call(Ve))||Ue(Ct=Ve.valueOf)&&!gt(Nt=Ct.call(Ve)))return Nt}throw new TypeError}function ue(Ve){return!!Ve}function Xe(Ve){return""+Ve}function nt(Ve){var ot=bt(Ve);return dt(ot)?ot:Xe(ot)}function $e(Ve){return Array.isArray?Array.isArray(Ve):Ve instanceof Object?Ve instanceof Array:Object.prototype.toString.call(Ve)==="[object Array]"}function Ue(Ve){return typeof Ve=="function"}function qt(Ve){return typeof Ve=="function"}function Mt(Ve){switch(Fe(Ve)){case 3:case 4:return!0;default:return!1}}function Yt(Ve,ot){return Ve===ot||Ve!=Ve&&ot!=ot}function ce(Ve,ot){var Ct=Ve[ot];if(Ct!=null){if(!Ue(Ct))throw new TypeError;return Ct}}function j(Ve){var ot=ce(Ve,x);if(!Ue(ot))throw new TypeError;var Ct=ot.call(Ve);if(!gt(Ct))throw new TypeError;return Ct}function W(Ve){return Ve.value}function me(Ve){var ot=Ve.next();return!ot.done&&ot}function De(Ve){var ot=Ve.return;ot&&ot.call(Ve)}function je(Ve){var ot=Object.getPrototypeOf(Ve);if(typeof Ve!="function"||Ve===L||ot!==L)return ot;var Ct=Ve.prototype,Nt=Ct&&Object.getPrototypeOf(Ct);if(Nt==null||Nt===Object.prototype)return ot;var Wn=Nt.constructor;return typeof Wn!="function"||Wn===Ve?ot:Wn}function mt(){var Ve,ot,Ct,Nt;Ie(G)||_.Reflect===void 0||G in _.Reflect||typeof _.Reflect.defineMetadata!="function"||(Ve=qe(_.Reflect));var Wn=new q,sr={registerProvider:Si,getProvider:En,setProvider:Ln};return sr;function Si(Nn){if(!Object.isExtensible(sr))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Ve===Nn:break;case Ie(ot):ot=Nn;break;case ot===Nn:break;case Ie(Ct):Ct=Nn;break;case Ct===Nn:break;default:Nt===void 0&&(Nt=new $),Nt.add(Nn)}}function si(Nn,di){if(!Ie(ot)){if(ot.isProviderFor(Nn,di))return ot;if(!Ie(Ct)){if(Ct.isProviderFor(Nn,di))return ot;if(!Ie(Nt))for(var ur=j(Nt);;){var ei=me(ur);if(!ei)return;var La=W(ei);if(La.isProviderFor(Nn,di))return De(ur),La}}}if(!Ie(Ve)&&Ve.isProviderFor(Nn,di))return Ve}function En(Nn,di){var ur,ei=Wn.get(Nn);return Ie(ei)||(ur=ei.get(di)),Ie(ur)&&(Ie(ur=si(Nn,di))||(Ie(ei)&&(ei=new U,Wn.set(Nn,ei)),ei.set(di,ur))),ur}function sn(Nn){if(Ie(Nn))throw new TypeError;return ot===Nn||Ct===Nn||!Ie(Nt)&&Nt.has(Nn)}function Ln(Nn,di,ur){if(!sn(ur))throw new Error("Metadata provider not registered.");var ei=En(Nn,di);if(ei!==ur){if(!Ie(ei))return!1;var La=Wn.get(Nn);Ie(La)&&(La=new U,Wn.set(Nn,La)),La.set(di,ur)}return!0}}function xt(){var Ve;return!Ie(G)&&gt(_.Reflect)&&Object.isExtensible(_.Reflect)&&(Ve=_.Reflect[G]),Ie(Ve)&&(Ve=mt()),!Ie(G)&&gt(_.Reflect)&&Object.isExtensible(_.Reflect)&&Object.defineProperty(_.Reflect,G,{enumerable:!1,configurable:!1,writable:!1,value:Ve}),Ve}function Vn(Ve){var ot=new q,Ct={isProviderFor:function(sn,Ln){var Nn=ot.get(sn);return!Ie(Nn)&&Nn.has(Ln)},OrdinaryDefineOwnMetadata:Si,OrdinaryHasOwnMetadata:Wn,OrdinaryGetOwnMetadata:sr,OrdinaryOwnMetadataKeys:si,OrdinaryDeleteMetadata:En};return X.registerProvider(Ct),Ct;function Nt(sn,Ln,Nn){var di=ot.get(sn),ur=!1;if(Ie(di)){if(!Nn)return;di=new U,ot.set(sn,di),ur=!0}var ei=di.get(Ln);if(Ie(ei)){if(!Nn)return;if(ei=new U,di.set(Ln,ei),!Ve.setProvider(sn,Ln,Ct))throw di.delete(Ln),ur&&ot.delete(sn),new Error("Wrong provider for target.")}return ei}function Wn(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);return!Ie(di)&&ue(di.has(sn))}function sr(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);if(!Ie(di))return di.get(sn)}function Si(sn,Ln,Nn,di){Nt(Nn,di,!0).set(sn,Ln)}function si(sn,Ln){var Nn=[],di=Nt(sn,Ln,!1);if(Ie(di))return Nn;for(var ur=j(di.keys()),ei=0;;){var La=me(ur);if(!La)return Nn.length=ei,Nn;var gu=W(La);try{Nn[ei]=gu}catch(Zd){try{De(ur)}finally{throw Zd}}ei++}}function En(sn,Ln,Nn){var di=Nt(Ln,Nn,!1);if(Ie(di)||!di.delete(sn))return!1;if(di.size===0){var ur=ot.get(Ln);Ie(ur)||(ur.delete(Nn),ur.size===0&&ot.delete(ur))}return!0}}function qe(Ve){var ot=Ve.defineMetadata,Ct=Ve.hasOwnMetadata,Nt=Ve.getOwnMetadata,Wn=Ve.getOwnMetadataKeys,sr=Ve.deleteMetadata,Si=new q;return{isProviderFor:function(si,En){var sn=Si.get(si);return!(Ie(sn)||!sn.has(En))||!!Wn(si,En).length&&(Ie(sn)&&(sn=new $,Si.set(si,sn)),sn.add(En),!0)},OrdinaryDefineOwnMetadata:ot,OrdinaryHasOwnMetadata:Ct,OrdinaryGetOwnMetadata:Nt,OrdinaryOwnMetadataKeys:Wn,OrdinaryDeleteMetadata:sr}}function Vt(Ve,ot,Ct){var Nt=X.getProvider(Ve,ot);if(!Ie(Nt))return Nt;if(Ct){if(X.setProvider(Ve,ot,ie))return ie;throw new Error("Illegal state.")}}function ht(){var Ve={},ot=[],Ct=function(){function Si(si,En,sn){this._index=0,this._keys=si,this._values=En,this._selector=sn}return Si.prototype["@@iterator"]=function(){return this},Si.prototype[x]=function(){return this},Si.prototype.next=function(){var si=this._index;if(si>=0&&si<this._keys.length){var En=this._selector(this._keys[si],this._values[si]);return si+1>=this._keys.length?(this._index=-1,this._keys=ot,this._values=ot):this._index++,{value:En,done:!1}}return{value:void 0,done:!0}},Si.prototype.throw=function(si){throw this._index>=0&&(this._index=-1,this._keys=ot,this._values=ot),si},Si.prototype.return=function(si){return this._index>=0&&(this._index=-1,this._keys=ot,this._values=ot),{value:si,done:!0}},Si}();return function(){function Si(){this._keys=[],this._values=[],this._cacheKey=Ve,this._cacheIndex=-2}return Object.defineProperty(Si.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Si.prototype.has=function(si){return this._find(si,!1)>=0},Si.prototype.get=function(si){var En=this._find(si,!1);return En>=0?this._values[En]:void 0},Si.prototype.set=function(si,En){var sn=this._find(si,!0);return this._values[sn]=En,this},Si.prototype.delete=function(si){var En=this._find(si,!1);if(En>=0){for(var sn=this._keys.length,Ln=En+1;Ln<sn;Ln++)this._keys[Ln-1]=this._keys[Ln],this._values[Ln-1]=this._values[Ln];return this._keys.length--,this._values.length--,Yt(si,this._cacheKey)&&(this._cacheKey=Ve,this._cacheIndex=-2),!0}return!1},Si.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Ve,this._cacheIndex=-2},Si.prototype.keys=function(){return new Ct(this._keys,this._values,Nt)},Si.prototype.values=function(){return new Ct(this._keys,this._values,Wn)},Si.prototype.entries=function(){return new Ct(this._keys,this._values,sr)},Si.prototype["@@iterator"]=function(){return this.entries()},Si.prototype[x]=function(){return this.entries()},Si.prototype._find=function(si,En){if(!Yt(this._cacheKey,si)){this._cacheIndex=-1;for(var sn=0;sn<this._keys.length;sn++)if(Yt(this._keys[sn],si)){this._cacheIndex=sn;break}}return this._cacheIndex<0&&En&&(this._cacheIndex=this._keys.length,this._keys.push(si),this._values.push(void 0)),this._cacheIndex},Si}();function Nt(Si,si){return Si}function Wn(Si,si){return si}function sr(Si,si){return[Si,si]}}function Pt(){return function(){function Ve(){this._map=new U}return Object.defineProperty(Ve.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Ve.prototype.has=function(ot){return this._map.has(ot)},Ve.prototype.add=function(ot){return this._map.set(ot,ot),this},Ve.prototype.delete=function(ot){return this._map.delete(ot)},Ve.prototype.clear=function(){this._map.clear()},Ve.prototype.keys=function(){return this._map.keys()},Ve.prototype.values=function(){return this._map.keys()},Ve.prototype.entries=function(){return this._map.entries()},Ve.prototype["@@iterator"]=function(){return this.keys()},Ve.prototype[x]=function(){return this.keys()},Ve}()}function hn(){var Ve=16,ot=k.create(),Ct=Nt();return function(){function En(){this._key=Nt()}return En.prototype.has=function(sn){var Ln=Wn(sn,!1);return Ln!==void 0&&k.has(Ln,this._key)},En.prototype.get=function(sn){var Ln=Wn(sn,!1);return Ln!==void 0?k.get(Ln,this._key):void 0},En.prototype.set=function(sn,Ln){return Wn(sn,!0)[this._key]=Ln,this},En.prototype.delete=function(sn){var Ln=Wn(sn,!1);return Ln!==void 0&&delete Ln[this._key]},En.prototype.clear=function(){this._key=Nt()},En}();function Nt(){var En;do En="@@WeakMap@@"+si();while(k.has(ot,En));return ot[En]=!0,En}function Wn(En,sn){if(!v.call(En,Ct)){if(!sn)return;Object.defineProperty(En,Ct,{value:k.create()})}return En[Ct]}function sr(En,sn){for(var Ln=0;Ln<sn;++Ln)En[Ln]=255*Math.random()|0;return En}function Si(En){if(typeof Uint8Array=="function"){var sn=new Uint8Array(En);return typeof crypto<"u"?crypto.getRandomValues(sn):typeof msCrypto<"u"?msCrypto.getRandomValues(sn):sr(sn,En),sn}return sr(new Array(En),En)}function si(){var En=Si(Ve);En[6]=79&En[6]|64,En[8]=191&En[8]|128;for(var sn="",Ln=0;Ln<Ve;++Ln){var Nn=En[Ln];Ln!==4&&Ln!==6&&Ln!==8||(sn+="-"),Nn<16&&(sn+="0"),sn+=Nn.toString(16).toLowerCase()}return sn}}function an(Ve){return Ve.__=void 0,delete Ve.__,Ve}g("decorate",V),g("metadata",Z),g("defineMetadata",Y),g("hasMetadata",ee),g("hasOwnMetadata",oe),g("getMetadata",de),g("getOwnMetadata",Me),g("getMetadataKeys",He),g("getOwnMetadataKeys",Te),g("deleteMetadata",Le)}(f,d),d.Reflect===void 0&&(d.Reflect=u)})()})(l||(l={}))}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var c=i[a]={id:a,loaded:!1,exports:{}};return n[a].call(c.exports,c,c.exports,r),c.loaded=!0,c.exports}r.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return r.d(o,{a:o}),o},r.d=(a,o)=>{for(var c in o)r.o(o,c)&&!r.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:o[c]})},r.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),r.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),r.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},r.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var s={};return(()=>{r.r(s),r.d(s,{BASIC_FULL_HD_LANDSCAPE:()=>Ti,BASIC_FULL_HD_PORTRAIT:()=>Bn,BASIC_LANDSCAPE:()=>Ki,BASIC_PORTRAIT:()=>Yn,BroadcastClientError:()=>xt,BroadcastClientEvents:()=>Ta,ConnectionState:()=>at,Errors:()=>u,InitialLayerPreference:()=>Gl,JitterBufferMinDelay:()=>js,LOG_LEVEL:()=>W,LocalStageStream:()=>PE,LocalStageStreamEvents:()=>vd,LogLevels:()=>W,RemoteStageStream:()=>BE,RemoteStageStreamEvents:()=>ao,STANDARD_LANDSCAPE:()=>Ho,STANDARD_PORTRAIT:()=>zl,Stage:()=>mf,StageConnectionState:()=>hs,StageErrorCategory:()=>gd,StageErrorCode:()=>br,StageEvents:()=>Hr,StageLeftReason:()=>qm,StageParticipantPublishState:()=>Vs,StageParticipantSubscribeState:()=>Xo,StageStream:()=>X0,StageStreamLayerSelectedReason:()=>_h,StreamType:()=>Xt,SubscribeType:()=>Ro,__version:()=>E0,create:()=>Fr,default:()=>zE,isSupported:()=>j});var a={};r.r(a),r.d(a,{fixNegotiationNeeded:()=>ee,shimAddTrackRemoveTrack:()=>Z,shimAddTrackRemoveTrackWithNative:()=>V,shimGetDisplayMedia:()=>U,shimGetSendersWithDtmf:()=>G,shimGetStats:()=>X,shimGetUserMedia:()=>L,shimMediaStream:()=>$,shimOnTrack:()=>q,shimPeerConnection:()=>Y,shimSenderReceiverGetStats:()=>ie});var o={};r.r(o),r.d(o,{shimAddTransceiver:()=>ke,shimCreateAnswer:()=>Ee,shimCreateOffer:()=>At,shimGetDisplayMedia:()=>de,shimGetParameters:()=>St,shimGetUserMedia:()=>oe,shimOnTrack:()=>Me,shimPeerConnection:()=>He,shimRTCDataChannel:()=>Ce,shimReceiverGetStats:()=>Le,shimRemoveStream:()=>we,shimSenderGetStats:()=>Te});var c={};r.r(c),r.d(c,{shimAudioContext:()=>bt,shimCallbacksAPI:()=>fe,shimConstraints:()=>Ie,shimCreateOfferLegacy:()=>gt,shimGetUserMedia:()=>Fe,shimLocalStreamsAPI:()=>ye,shimRTCIceServerUrls:()=>it,shimRemoteStreamsAPI:()=>et,shimTrackEventTransceiver:()=>dt});var l={};r.r(l),r.d(l,{removeExtmapAllowMixed:()=>Mt,shimAddIceCandidateNullOrEmpty:()=>Yt,shimConnectionState:()=>qt,shimMaxMessageSize:()=>$e,shimParameterlessSetLocalDescription:()=>ce,shimRTCIceCandidate:()=>Xe,shimRTCIceCandidateRelayProtocol:()=>nt,shimSendThrowTypeError:()=>Ue});var u={};r.r(u),r.d(u,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>an,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>hn,ADD_DEVICE_CONSTRAINTS_ERROR:()=>Ct,ADD_DEVICE_DEVICE_ERROR:()=>ht,ADD_DEVICE_NAME_EXISTS_ERROR:()=>Pt,ADD_DEVICE_NAME_MISSING_ERROR:()=>Ve,ADD_DEVICE_UNSUPPORTED:()=>ot,BROADCAST_CONFIGURATION_ERROR:()=>ur,BROADCAST_ERROR:()=>Vn,CAMERA_ERROR:()=>qe,CLIENT_INVALID_ERROR:()=>u0,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>En,FAILED_TO_ADD_IMAGE_ERROR:()=>sn,INGEST_ENDPOINT_TYPE_ERROR:()=>La,INGEST_ENDPOINT_URL_ERROR:()=>gu,INPUT_ERROR:()=>Vt,INVALID_STREAM_KEY:()=>di,LOGGER_TYPE_ERROR:()=>mp,LOG_LEVEL_TYPE_ERROR:()=>Zd,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>Qd,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>ef,PEER_CONNECTION_ERROR:()=>Nn,PEER_SETUP_ERROR:()=>Ln,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>Nt,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>Wn,STAGE_TOKEN_TYPE_ERROR:()=>ve,STAGE_WHIP_OVERRIDE_ERROR:()=>Ke,STREAM_CONFIGURATION_ERROR:()=>ei,STREAM_KEY_INVALID_CHAR_ERROR:()=>vu,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Si,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>sr,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>si});var h={};r.r(h),r.d(h,{BASIC_FULL_HD_LANDSCAPE:()=>Ti,BASIC_FULL_HD_PORTRAIT:()=>Bn,BASIC_LANDSCAPE:()=>Ki,BASIC_PORTRAIT:()=>Yn,BroadcastClientError:()=>xt,BroadcastClientEvents:()=>Ta,ConnectionState:()=>at,Errors:()=>u,LOG_LEVEL:()=>W,LogLevels:()=>W,STANDARD_LANDSCAPE:()=>Ho,STANDARD_PORTRAIT:()=>zl,__version:()=>E0,create:()=>Fr,isSupported:()=>j});let d=!0,f=!0;function p(O,S,R){const M=O.match(S);return M&&M.length>=R&&parseInt(M[R],10)}function g(O,S,R){if(!O.RTCPeerConnection)return;const M=O.RTCPeerConnection.prototype,P=M.addEventListener;M.addEventListener=function(H,te){if(H!==S)return P.apply(this,arguments);const re=K=>{const se=R(K);se&&(te.handleEvent?te.handleEvent(se):te(se))};return this._eventMap=this._eventMap||{},this._eventMap[S]||(this._eventMap[S]=new Map),this._eventMap[S].set(te,re),P.apply(this,[H,re])};const B=M.removeEventListener;M.removeEventListener=function(H,te){if(H!==S||!this._eventMap||!this._eventMap[S])return B.apply(this,arguments);if(!this._eventMap[S].has(te))return B.apply(this,arguments);const re=this._eventMap[S].get(te);return this._eventMap[S].delete(te),this._eventMap[S].size===0&&delete this._eventMap[S],Object.keys(this._eventMap).length===0&&delete this._eventMap,B.apply(this,[H,re])},Object.defineProperty(M,"on"+S,{get(){return this["_on"+S]},set(H){this["_on"+S]&&(this.removeEventListener(S,this["_on"+S]),delete this["_on"+S]),H&&this.addEventListener(S,this["_on"+S]=H)},enumerable:!0,configurable:!0})}function _(O){return typeof O!="boolean"?new Error("Argument type: "+typeof O+". Please use a boolean."):(d=O,O?"adapter.js logging disabled":"adapter.js logging enabled")}function v(O){return typeof O!="boolean"?new Error("Argument type: "+typeof O+". Please use a boolean."):(f=!O,"adapter.js deprecation warnings "+(O?"disabled":"enabled"))}function E(){if(typeof window=="object"){if(d)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function T(O,S){f&&console.warn(O+" is deprecated, please use "+S+" instead.")}function x(O){return Object.prototype.toString.call(O)==="[object Object]"}function N(O){return x(O)?Object.keys(O).reduce(function(S,R){const M=x(O[R]),P=M?N(O[R]):O[R],B=M&&!Object.keys(P).length;return P===void 0||B?S:Object.assign(S,{[R]:P})},{}):O}function A(O,S,R){S&&!R.has(S.id)&&(R.set(S.id,S),Object.keys(S).forEach(M=>{M.endsWith("Id")?A(O,O.get(S[M]),R):M.endsWith("Ids")&&S[M].forEach(P=>{A(O,O.get(P),R)})}))}function I(O,S,R){const M=R?"outbound-rtp":"inbound-rtp",P=new Map;if(S===null)return P;const B=[];return O.forEach(H=>{H.type==="track"&&H.trackIdentifier===S.id&&B.push(H)}),B.forEach(H=>{O.forEach(te=>{te.type===M&&te.trackId===H.id&&A(O,te,P)})}),P}const k=E;function L(O,S){const R=O&&O.navigator;if(!R.mediaDevices)return;const M=function(H){if(typeof H!="object"||H.mandatory||H.optional)return H;const te={};return Object.keys(H).forEach(re=>{if(re==="require"||re==="advanced"||re==="mediaSource")return;const K=typeof H[re]=="object"?H[re]:{ideal:H[re]};K.exact!==void 0&&typeof K.exact=="number"&&(K.min=K.max=K.exact);const se=function(he,pe){return he?he+pe.charAt(0).toUpperCase()+pe.slice(1):pe==="deviceId"?"sourceId":pe};if(K.ideal!==void 0){te.optional=te.optional||[];let he={};typeof K.ideal=="number"?(he[se("min",re)]=K.ideal,te.optional.push(he),he={},he[se("max",re)]=K.ideal,te.optional.push(he)):(he[se("",re)]=K.ideal,te.optional.push(he))}K.exact!==void 0&&typeof K.exact!="number"?(te.mandatory=te.mandatory||{},te.mandatory[se("",re)]=K.exact):["min","max"].forEach(he=>{K[he]!==void 0&&(te.mandatory=te.mandatory||{},te.mandatory[se(he,re)]=K[he])})}),H.advanced&&(te.optional=(te.optional||[]).concat(H.advanced)),te},P=function(H,te){if(S.version>=61)return te(H);if((H=JSON.parse(JSON.stringify(H)))&&typeof H.audio=="object"){const re=function(K,se,he){se in K&&!(he in K)&&(K[he]=K[se],delete K[se])};re((H=JSON.parse(JSON.stringify(H))).audio,"autoGainControl","googAutoGainControl"),re(H.audio,"noiseSuppression","googNoiseSuppression"),H.audio=M(H.audio)}if(H&&typeof H.video=="object"){let re=H.video.facingMode;re=re&&(typeof re=="object"?re:{ideal:re});const K=S.version<66;if(re&&(re.exact==="user"||re.exact==="environment"||re.ideal==="user"||re.ideal==="environment")&&(!R.mediaDevices.getSupportedConstraints||!R.mediaDevices.getSupportedConstraints().facingMode||K)){let se;if(delete H.video.facingMode,re.exact==="environment"||re.ideal==="environment"?se=["back","rear"]:re.exact!=="user"&&re.ideal!=="user"||(se=["front"]),se)return R.mediaDevices.enumerateDevices().then(he=>{let pe=(he=he.filter(Ne=>Ne.kind==="videoinput")).find(Ne=>se.some(Je=>Ne.label.toLowerCase().includes(Je)));return!pe&&he.length&&se.includes("back")&&(pe=he[he.length-1]),pe&&(H.video.deviceId=re.exact?{exact:pe.deviceId}:{ideal:pe.deviceId}),H.video=M(H.video),k("chrome: "+JSON.stringify(H)),te(H)})}H.video=M(H.video)}return k("chrome: "+JSON.stringify(H)),te(H)},B=function(H){return S.version>=64?H:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[H.name]||H.name,message:H.message,constraint:H.constraint||H.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(R.getUserMedia=(function(H,te,re){P(H,K=>{R.webkitGetUserMedia(K,te,se=>{re&&re(B(se))})})}).bind(R),R.mediaDevices.getUserMedia){const H=R.mediaDevices.getUserMedia.bind(R.mediaDevices);R.mediaDevices.getUserMedia=function(te){return P(te,re=>H(re).then(K=>{if(re.audio&&!K.getAudioTracks().length||re.video&&!K.getVideoTracks().length)throw K.getTracks().forEach(se=>{se.stop()}),new DOMException("","NotFoundError");return K},K=>Promise.reject(B(K))))}}}function U(O,S){O.navigator.mediaDevices&&"getDisplayMedia"in O.navigator.mediaDevices||O.navigator.mediaDevices&&(typeof S=="function"?O.navigator.mediaDevices.getDisplayMedia=function(R){return S(R).then(M=>{const P=R.video&&R.video.width,B=R.video&&R.video.height,H=R.video&&R.video.frameRate;return R.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:M,maxFrameRate:H||3}},P&&(R.video.mandatory.maxWidth=P),B&&(R.video.mandatory.maxHeight=B),O.navigator.mediaDevices.getUserMedia(R)})}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function $(O){O.MediaStream=O.MediaStream||O.webkitMediaStream}function q(O){if(typeof O=="object"&&O.RTCPeerConnection&&!("ontrack"in O.RTCPeerConnection.prototype)){Object.defineProperty(O.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(R){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=R)},enumerable:!0,configurable:!0});const S=O.RTCPeerConnection.prototype.setRemoteDescription;O.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=R=>{R.stream.addEventListener("addtrack",M=>{let P;P=O.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===M.track.id):{track:M.track};const B=new Event("track");B.track=M.track,B.receiver=P,B.transceiver={receiver:P},B.streams=[R.stream],this.dispatchEvent(B)}),R.stream.getTracks().forEach(M=>{let P;P=O.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(H=>H.track&&H.track.id===M.id):{track:M};const B=new Event("track");B.track=M,B.receiver=P,B.transceiver={receiver:P},B.streams=[R.stream],this.dispatchEvent(B)})},this.addEventListener("addstream",this._ontrackpoly)),S.apply(this,arguments)}}else g(O,"track",S=>(S.transceiver||Object.defineProperty(S,"transceiver",{value:{receiver:S.receiver}}),S))}function G(O){if(typeof O=="object"&&O.RTCPeerConnection&&!("getSenders"in O.RTCPeerConnection.prototype)&&"createDTMFSender"in O.RTCPeerConnection.prototype){const S=function(P,B){return{track:B,get dtmf(){return this._dtmf===void 0&&(B.kind==="audio"?this._dtmf=P.createDTMFSender(B):this._dtmf=null),this._dtmf},_pc:P}};if(!O.RTCPeerConnection.prototype.getSenders){O.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const P=O.RTCPeerConnection.prototype.addTrack;O.RTCPeerConnection.prototype.addTrack=function(H,te){let re=P.apply(this,arguments);return re||(re=S(this,H),this._senders.push(re)),re};const B=O.RTCPeerConnection.prototype.removeTrack;O.RTCPeerConnection.prototype.removeTrack=function(H){B.apply(this,arguments);const te=this._senders.indexOf(H);te!==-1&&this._senders.splice(te,1)}}const R=O.RTCPeerConnection.prototype.addStream;O.RTCPeerConnection.prototype.addStream=function(P){this._senders=this._senders||[],R.apply(this,[P]),P.getTracks().forEach(B=>{this._senders.push(S(this,B))})};const M=O.RTCPeerConnection.prototype.removeStream;O.RTCPeerConnection.prototype.removeStream=function(P){this._senders=this._senders||[],M.apply(this,[P]),P.getTracks().forEach(B=>{const H=this._senders.find(te=>te.track===B);H&&this._senders.splice(this._senders.indexOf(H),1)})}}else if(typeof O=="object"&&O.RTCPeerConnection&&"getSenders"in O.RTCPeerConnection.prototype&&"createDTMFSender"in O.RTCPeerConnection.prototype&&O.RTCRtpSender&&!("dtmf"in O.RTCRtpSender.prototype)){const S=O.RTCPeerConnection.prototype.getSenders;O.RTCPeerConnection.prototype.getSenders=function(){const R=S.apply(this,[]);return R.forEach(M=>M._pc=this),R},Object.defineProperty(O.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function X(O){if(!O.RTCPeerConnection)return;const S=O.RTCPeerConnection.prototype.getStats;O.RTCPeerConnection.prototype.getStats=function(){const[R,M,P]=arguments;if(arguments.length>0&&typeof R=="function")return S.apply(this,arguments);if(S.length===0&&(arguments.length===0||typeof R!="function"))return S.apply(this,[]);const B=function(te){const re={};return te.result().forEach(K=>{const se={id:K.id,timestamp:K.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[K.type]||K.type};K.names().forEach(he=>{se[he]=K.stat(he)}),re[se.id]=se}),re},H=function(te){return new Map(Object.keys(te).map(re=>[re,te[re]]))};if(arguments.length>=2){const te=function(re){M(H(B(re)))};return S.apply(this,[te,R])}return new Promise((te,re)=>{S.apply(this,[function(K){te(H(B(K)))},re])}).then(M,P)}}function ie(O){if(!(typeof O=="object"&&O.RTCPeerConnection&&O.RTCRtpSender&&O.RTCRtpReceiver))return;if(!("getStats"in O.RTCRtpSender.prototype)){const R=O.RTCPeerConnection.prototype.getSenders;R&&(O.RTCPeerConnection.prototype.getSenders=function(){const P=R.apply(this,[]);return P.forEach(B=>B._pc=this),P});const M=O.RTCPeerConnection.prototype.addTrack;M&&(O.RTCPeerConnection.prototype.addTrack=function(){const P=M.apply(this,arguments);return P._pc=this,P}),O.RTCRtpSender.prototype.getStats=function(){const P=this;return this._pc.getStats().then(B=>I(B,P.track,!0))}}if(!("getStats"in O.RTCRtpReceiver.prototype)){const R=O.RTCPeerConnection.prototype.getReceivers;R&&(O.RTCPeerConnection.prototype.getReceivers=function(){const M=R.apply(this,[]);return M.forEach(P=>P._pc=this),M}),g(O,"track",M=>(M.receiver._pc=M.srcElement,M)),O.RTCRtpReceiver.prototype.getStats=function(){const M=this;return this._pc.getStats().then(P=>I(P,M.track,!1))}}if(!("getStats"in O.RTCRtpSender.prototype)||!("getStats"in O.RTCRtpReceiver.prototype))return;const S=O.RTCPeerConnection.prototype.getStats;O.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof O.MediaStreamTrack){const R=arguments[0];let M,P,B;return this.getSenders().forEach(H=>{H.track===R&&(M?B=!0:M=H)}),this.getReceivers().forEach(H=>(H.track===R&&(P?B=!0:P=H),H.track===R)),B||M&&P?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):M?M.getStats():P?P.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return S.apply(this,arguments)}}function V(O){O.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(B=>this._shimmedLocalStreams[B][0])};const S=O.RTCPeerConnection.prototype.addTrack;O.RTCPeerConnection.prototype.addTrack=function(B,H){if(!H)return S.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const te=S.apply(this,arguments);return this._shimmedLocalStreams[H.id]?this._shimmedLocalStreams[H.id].indexOf(te)===-1&&this._shimmedLocalStreams[H.id].push(te):this._shimmedLocalStreams[H.id]=[H,te],te};const R=O.RTCPeerConnection.prototype.addStream;O.RTCPeerConnection.prototype.addStream=function(B){this._shimmedLocalStreams=this._shimmedLocalStreams||{},B.getTracks().forEach(re=>{if(this.getSenders().find(K=>K.track===re))throw new DOMException("Track already exists.","InvalidAccessError")});const H=this.getSenders();R.apply(this,arguments);const te=this.getSenders().filter(re=>H.indexOf(re)===-1);this._shimmedLocalStreams[B.id]=[B].concat(te)};const M=O.RTCPeerConnection.prototype.removeStream;O.RTCPeerConnection.prototype.removeStream=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[B.id],M.apply(this,arguments)};const P=O.RTCPeerConnection.prototype.removeTrack;O.RTCPeerConnection.prototype.removeTrack=function(B){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},B&&Object.keys(this._shimmedLocalStreams).forEach(H=>{const te=this._shimmedLocalStreams[H].indexOf(B);te!==-1&&this._shimmedLocalStreams[H].splice(te,1),this._shimmedLocalStreams[H].length===1&&delete this._shimmedLocalStreams[H]}),P.apply(this,arguments)}}function Z(O,S){if(!O.RTCPeerConnection)return;if(O.RTCPeerConnection.prototype.addTrack&&S.version>=65)return V(O);const R=O.RTCPeerConnection.prototype.getLocalStreams;O.RTCPeerConnection.prototype.getLocalStreams=function(){const re=R.apply(this);return this._reverseStreams=this._reverseStreams||{},re.map(K=>this._reverseStreams[K.id])};const M=O.RTCPeerConnection.prototype.addStream;O.RTCPeerConnection.prototype.addStream=function(re){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},re.getTracks().forEach(K=>{if(this.getSenders().find(se=>se.track===K))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[re.id]){const K=new O.MediaStream(re.getTracks());this._streams[re.id]=K,this._reverseStreams[K.id]=re,re=K}M.apply(this,[re])};const P=O.RTCPeerConnection.prototype.removeStream;function B(re,K){let se=K.sdp;return Object.keys(re._reverseStreams||[]).forEach(he=>{const pe=re._reverseStreams[he],Ne=re._streams[pe.id];se=se.replace(new RegExp(Ne.id,"g"),pe.id)}),new RTCSessionDescription({type:K.type,sdp:se})}O.RTCPeerConnection.prototype.removeStream=function(re){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},P.apply(this,[this._streams[re.id]||re]),delete this._reverseStreams[this._streams[re.id]?this._streams[re.id].id:re.id],delete this._streams[re.id]},O.RTCPeerConnection.prototype.addTrack=function(re,K){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const se=[].slice.call(arguments,1);if(se.length!==1||!se[0].getTracks().find(pe=>pe===re))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(pe=>pe.track===re))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const he=this._streams[K.id];if(he)he.addTrack(re),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const pe=new O.MediaStream([re]);this._streams[K.id]=pe,this._reverseStreams[pe.id]=K,this.addStream(pe)}return this.getSenders().find(pe=>pe.track===re)},["createOffer","createAnswer"].forEach(function(re){const K=O.RTCPeerConnection.prototype[re],se={[re](){const he=arguments;return arguments.length&&typeof arguments[0]=="function"?K.apply(this,[pe=>{const Ne=B(this,pe);he[0].apply(null,[Ne])},pe=>{he[1]&&he[1].apply(null,pe)},arguments[2]]):K.apply(this,arguments).then(pe=>B(this,pe))}};O.RTCPeerConnection.prototype[re]=se[re]});const H=O.RTCPeerConnection.prototype.setLocalDescription;O.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(re,K){let se=K.sdp;return Object.keys(re._reverseStreams||[]).forEach(he=>{const pe=re._reverseStreams[he],Ne=re._streams[pe.id];se=se.replace(new RegExp(pe.id,"g"),Ne.id)}),new RTCSessionDescription({type:K.type,sdp:se})}(this,arguments[0]),H.apply(this,arguments)):H.apply(this,arguments)};const te=Object.getOwnPropertyDescriptor(O.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(O.RTCPeerConnection.prototype,"localDescription",{get(){const re=te.get.apply(this);return re.type===""?re:B(this,re)}}),O.RTCPeerConnection.prototype.removeTrack=function(re){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!re._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(re._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let K;this._streams=this._streams||{},Object.keys(this._streams).forEach(se=>{this._streams[se].getTracks().find(he=>re.track===he)&&(K=this._streams[se])}),K&&(K.getTracks().length===1?this.removeStream(this._reverseStreams[K.id]):K.removeTrack(re.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Y(O,S){!O.RTCPeerConnection&&O.webkitRTCPeerConnection&&(O.RTCPeerConnection=O.webkitRTCPeerConnection),O.RTCPeerConnection&&S.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(R){const M=O.RTCPeerConnection.prototype[R],P={[R](){return arguments[0]=new(R==="addIceCandidate"?O.RTCIceCandidate:O.RTCSessionDescription)(arguments[0]),M.apply(this,arguments)}};O.RTCPeerConnection.prototype[R]=P[R]})}function ee(O,S){g(O,"negotiationneeded",R=>{const M=R.target;if(!(S.version<72||M.getConfiguration&&M.getConfiguration().sdpSemantics==="plan-b")||M.signalingState==="stable")return R})}function oe(O,S){const R=O&&O.navigator,M=O&&O.MediaStreamTrack;if(R.getUserMedia=function(P,B,H){T("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),R.mediaDevices.getUserMedia(P).then(B,H)},!(S.version>55&&"autoGainControl"in R.mediaDevices.getSupportedConstraints())){const P=function(H,te,re){te in H&&!(re in H)&&(H[re]=H[te],delete H[te])},B=R.mediaDevices.getUserMedia.bind(R.mediaDevices);if(R.mediaDevices.getUserMedia=function(H){return typeof H=="object"&&typeof H.audio=="object"&&(H=JSON.parse(JSON.stringify(H)),P(H.audio,"autoGainControl","mozAutoGainControl"),P(H.audio,"noiseSuppression","mozNoiseSuppression")),B(H)},M&&M.prototype.getSettings){const H=M.prototype.getSettings;M.prototype.getSettings=function(){const te=H.apply(this,arguments);return P(te,"mozAutoGainControl","autoGainControl"),P(te,"mozNoiseSuppression","noiseSuppression"),te}}if(M&&M.prototype.applyConstraints){const H=M.prototype.applyConstraints;M.prototype.applyConstraints=function(te){return this.kind==="audio"&&typeof te=="object"&&(te=JSON.parse(JSON.stringify(te)),P(te,"autoGainControl","mozAutoGainControl"),P(te,"noiseSuppression","mozNoiseSuppression")),H.apply(this,[te])}}}}function de(O,S){O.navigator.mediaDevices&&"getDisplayMedia"in O.navigator.mediaDevices||O.navigator.mediaDevices&&(O.navigator.mediaDevices.getDisplayMedia=function(R){if(!R||!R.video){const M=new DOMException("getDisplayMedia without video constraints is undefined");return M.name="NotFoundError",M.code=8,Promise.reject(M)}return R.video===!0?R.video={mediaSource:S}:R.video.mediaSource=S,O.navigator.mediaDevices.getUserMedia(R)})}function Me(O){typeof O=="object"&&O.RTCTrackEvent&&"receiver"in O.RTCTrackEvent.prototype&&!("transceiver"in O.RTCTrackEvent.prototype)&&Object.defineProperty(O.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function He(O,S){if(typeof O!="object"||!O.RTCPeerConnection&&!O.mozRTCPeerConnection)return;!O.RTCPeerConnection&&O.mozRTCPeerConnection&&(O.RTCPeerConnection=O.mozRTCPeerConnection),S.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(P){const B=O.RTCPeerConnection.prototype[P],H={[P](){return arguments[0]=new(P==="addIceCandidate"?O.RTCIceCandidate:O.RTCSessionDescription)(arguments[0]),B.apply(this,arguments)}};O.RTCPeerConnection.prototype[P]=H[P]});const R={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},M=O.RTCPeerConnection.prototype.getStats;O.RTCPeerConnection.prototype.getStats=function(){const[P,B,H]=arguments;return M.apply(this,[P||null]).then(te=>{if(S.version<53&&!B)try{te.forEach(re=>{re.type=R[re.type]||re.type})}catch(re){if(re.name!=="TypeError")throw re;te.forEach((K,se)=>{te.set(se,Object.assign({},K,{type:R[K.type]||K.type}))})}return te}).then(B,H)}}function Te(O){if(typeof O!="object"||!O.RTCPeerConnection||!O.RTCRtpSender||O.RTCRtpSender&&"getStats"in O.RTCRtpSender.prototype)return;const S=O.RTCPeerConnection.prototype.getSenders;S&&(O.RTCPeerConnection.prototype.getSenders=function(){const M=S.apply(this,[]);return M.forEach(P=>P._pc=this),M});const R=O.RTCPeerConnection.prototype.addTrack;R&&(O.RTCPeerConnection.prototype.addTrack=function(){const M=R.apply(this,arguments);return M._pc=this,M}),O.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Le(O){if(typeof O!="object"||!O.RTCPeerConnection||!O.RTCRtpSender||O.RTCRtpSender&&"getStats"in O.RTCRtpReceiver.prototype)return;const S=O.RTCPeerConnection.prototype.getReceivers;S&&(O.RTCPeerConnection.prototype.getReceivers=function(){const R=S.apply(this,[]);return R.forEach(M=>M._pc=this),R}),g(O,"track",R=>(R.receiver._pc=R.srcElement,R)),O.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function we(O){O.RTCPeerConnection&&!("removeStream"in O.RTCPeerConnection.prototype)&&(O.RTCPeerConnection.prototype.removeStream=function(S){T("removeStream","removeTrack"),this.getSenders().forEach(R=>{R.track&&S.getTracks().includes(R.track)&&this.removeTrack(R)})})}function Ce(O){O.DataChannel&&!O.RTCDataChannel&&(O.RTCDataChannel=O.DataChannel)}function ke(O){if(typeof O!="object"||!O.RTCPeerConnection)return;const S=O.RTCPeerConnection.prototype.addTransceiver;S&&(O.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let R=arguments[1]&&arguments[1].sendEncodings;R===void 0&&(R=[]),R=[...R];const M=R.length>0;M&&R.forEach(B=>{if("rid"in B&&!/^[a-z0-9]{0,16}$/i.test(B.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in B&&!(parseFloat(B.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in B&&!(parseFloat(B.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const P=S.apply(this,arguments);if(M){const{sender:B}=P,H=B.getParameters();(!("encodings"in H)||H.encodings.length===1&&Object.keys(H.encodings[0]).length===0)&&(H.encodings=R,B.sendEncodings=R,this.setParametersPromises.push(B.setParameters(H).then(()=>{delete B.sendEncodings}).catch(()=>{delete B.sendEncodings})))}return P})}function St(O){if(typeof O!="object"||!O.RTCRtpSender)return;const S=O.RTCRtpSender.prototype.getParameters;S&&(O.RTCRtpSender.prototype.getParameters=function(){const R=S.apply(this,arguments);return"encodings"in R||(R.encodings=[].concat(this.sendEncodings||[{}])),R})}function At(O){if(typeof O!="object"||!O.RTCPeerConnection)return;const S=O.RTCPeerConnection.prototype.createOffer;O.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>S.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):S.apply(this,arguments)}}function Ee(O){if(typeof O!="object"||!O.RTCPeerConnection)return;const S=O.RTCPeerConnection.prototype.createAnswer;O.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>S.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):S.apply(this,arguments)}}function ye(O){if(typeof O=="object"&&O.RTCPeerConnection){if("getLocalStreams"in O.RTCPeerConnection.prototype||(O.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in O.RTCPeerConnection.prototype)){const S=O.RTCPeerConnection.prototype.addTrack;O.RTCPeerConnection.prototype.addStream=function(R){this._localStreams||(this._localStreams=[]),this._localStreams.includes(R)||this._localStreams.push(R),R.getAudioTracks().forEach(M=>S.call(this,M,R)),R.getVideoTracks().forEach(M=>S.call(this,M,R))},O.RTCPeerConnection.prototype.addTrack=function(R,...M){return M&&M.forEach(P=>{this._localStreams?this._localStreams.includes(P)||this._localStreams.push(P):this._localStreams=[P]}),S.apply(this,arguments)}}"removeStream"in O.RTCPeerConnection.prototype||(O.RTCPeerConnection.prototype.removeStream=function(S){this._localStreams||(this._localStreams=[]);const R=this._localStreams.indexOf(S);if(R===-1)return;this._localStreams.splice(R,1);const M=S.getTracks();this.getSenders().forEach(P=>{M.includes(P.track)&&this.removeTrack(P)})})}}function et(O){if(typeof O=="object"&&O.RTCPeerConnection&&("getRemoteStreams"in O.RTCPeerConnection.prototype||(O.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in O.RTCPeerConnection.prototype))){Object.defineProperty(O.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(R){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=R),this.addEventListener("track",this._onaddstreampoly=M=>{M.streams.forEach(P=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(P))return;this._remoteStreams.push(P);const B=new Event("addstream");B.stream=P,this.dispatchEvent(B)})})}});const S=O.RTCPeerConnection.prototype.setRemoteDescription;O.RTCPeerConnection.prototype.setRemoteDescription=function(){const R=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(M){M.streams.forEach(P=>{if(R._remoteStreams||(R._remoteStreams=[]),R._remoteStreams.indexOf(P)>=0)return;R._remoteStreams.push(P);const B=new Event("addstream");B.stream=P,R.dispatchEvent(B)})}),S.apply(R,arguments)}}}function fe(O){if(typeof O!="object"||!O.RTCPeerConnection)return;const S=O.RTCPeerConnection.prototype,R=S.createOffer,M=S.createAnswer,P=S.setLocalDescription,B=S.setRemoteDescription,H=S.addIceCandidate;S.createOffer=function(re,K){const se=arguments.length>=2?arguments[2]:arguments[0],he=R.apply(this,[se]);return K?(he.then(re,K),Promise.resolve()):he},S.createAnswer=function(re,K){const se=arguments.length>=2?arguments[2]:arguments[0],he=M.apply(this,[se]);return K?(he.then(re,K),Promise.resolve()):he};let te=function(re,K,se){const he=P.apply(this,[re]);return se?(he.then(K,se),Promise.resolve()):he};S.setLocalDescription=te,te=function(re,K,se){const he=B.apply(this,[re]);return se?(he.then(K,se),Promise.resolve()):he},S.setRemoteDescription=te,te=function(re,K,se){const he=H.apply(this,[re]);return se?(he.then(K,se),Promise.resolve()):he},S.addIceCandidate=te}function Fe(O){const S=O&&O.navigator;if(S.mediaDevices&&S.mediaDevices.getUserMedia){const R=S.mediaDevices,M=R.getUserMedia.bind(R);S.mediaDevices.getUserMedia=P=>M(Ie(P))}!S.getUserMedia&&S.mediaDevices&&S.mediaDevices.getUserMedia&&(S.getUserMedia=(function(R,M,P){S.mediaDevices.getUserMedia(R).then(M,P)}).bind(S))}function Ie(O){return O&&O.video!==void 0?Object.assign({},O,{video:N(O.video)}):O}function it(O){if(!O.RTCPeerConnection)return;const S=O.RTCPeerConnection;O.RTCPeerConnection=function(R,M){if(R&&R.iceServers){const P=[];for(let B=0;B<R.iceServers.length;B++){let H=R.iceServers[B];H.urls===void 0&&H.url?(T("RTCIceServer.url","RTCIceServer.urls"),H=JSON.parse(JSON.stringify(H)),H.urls=H.url,delete H.url,P.push(H)):P.push(R.iceServers[B])}R.iceServers=P}return new S(R,M)},O.RTCPeerConnection.prototype=S.prototype,"generateCertificate"in S&&Object.defineProperty(O.RTCPeerConnection,"generateCertificate",{get:()=>S.generateCertificate})}function dt(O){typeof O=="object"&&O.RTCTrackEvent&&"receiver"in O.RTCTrackEvent.prototype&&!("transceiver"in O.RTCTrackEvent.prototype)&&Object.defineProperty(O.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function gt(O){const S=O.RTCPeerConnection.prototype.createOffer;O.RTCPeerConnection.prototype.createOffer=function(R){if(R){R.offerToReceiveAudio!==void 0&&(R.offerToReceiveAudio=!!R.offerToReceiveAudio);const M=this.getTransceivers().find(B=>B.receiver.track.kind==="audio");R.offerToReceiveAudio===!1&&M?M.direction==="sendrecv"?M.setDirection?M.setDirection("sendonly"):M.direction="sendonly":M.direction==="recvonly"&&(M.setDirection?M.setDirection("inactive"):M.direction="inactive"):R.offerToReceiveAudio!==!0||M||this.addTransceiver("audio",{direction:"recvonly"}),R.offerToReceiveVideo!==void 0&&(R.offerToReceiveVideo=!!R.offerToReceiveVideo);const P=this.getTransceivers().find(B=>B.receiver.track.kind==="video");R.offerToReceiveVideo===!1&&P?P.direction==="sendrecv"?P.setDirection?P.setDirection("sendonly"):P.direction="sendonly":P.direction==="recvonly"&&(P.setDirection?P.setDirection("inactive"):P.direction="inactive"):R.offerToReceiveVideo!==!0||P||this.addTransceiver("video",{direction:"recvonly"})}return S.apply(this,arguments)}}function bt(O){typeof O!="object"||O.AudioContext||(O.AudioContext=O.webkitAudioContext)}var be=r(7539),ue=r.n(be);function Xe(O){if(!O.RTCIceCandidate||O.RTCIceCandidate&&"foundation"in O.RTCIceCandidate.prototype)return;const S=O.RTCIceCandidate;O.RTCIceCandidate=function(R){if(typeof R=="object"&&R.candidate&&R.candidate.indexOf("a=")===0&&((R=JSON.parse(JSON.stringify(R))).candidate=R.candidate.substring(2)),R.candidate&&R.candidate.length){const M=new S(R),P=ue().parseCandidate(R.candidate);for(const B in P)B in M||Object.defineProperty(M,B,{value:P[B]});return M.toJSON=function(){return{candidate:M.candidate,sdpMid:M.sdpMid,sdpMLineIndex:M.sdpMLineIndex,usernameFragment:M.usernameFragment}},M}return new S(R)},O.RTCIceCandidate.prototype=S.prototype,g(O,"icecandidate",R=>(R.candidate&&Object.defineProperty(R,"candidate",{value:new O.RTCIceCandidate(R.candidate),writable:"false"}),R))}function nt(O){!O.RTCIceCandidate||O.RTCIceCandidate&&"relayProtocol"in O.RTCIceCandidate.prototype||g(O,"icecandidate",S=>{if(S.candidate){const R=ue().parseCandidate(S.candidate.candidate);R.type==="relay"&&(S.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[R.priority>>24])}return S})}function $e(O,S){if(!O.RTCPeerConnection)return;"sctp"in O.RTCPeerConnection.prototype||Object.defineProperty(O.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const R=O.RTCPeerConnection.prototype.setRemoteDescription;O.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,S.browser==="chrome"&&S.version>=76){const{sdpSemantics:M}=this.getConfiguration();M==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if(function(M){if(!M||!M.sdp)return!1;const P=ue().splitSections(M.sdp);return P.shift(),P.some(B=>{const H=ue().parseMLine(B);return H&&H.kind==="application"&&H.protocol.indexOf("SCTP")!==-1})}(arguments[0])){const M=function(re){const K=re.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(K===null||K.length<2)return-1;const se=parseInt(K[1],10);return se!=se?-1:se}(arguments[0]),P=function(re){let K=65536;return S.browser==="firefox"&&(K=S.version<57?re===-1?16384:2147483637:S.version<60?S.version===57?65535:65536:2147483637),K}(M),B=function(re,K){let se=65536;S.browser==="firefox"&&S.version===57&&(se=65535);const he=ue().matchPrefix(re.sdp,"a=max-message-size:");return he.length>0?se=parseInt(he[0].substring(19),10):S.browser==="firefox"&&K!==-1&&(se=2147483637),se}(arguments[0],M);let H;H=P===0&&B===0?Number.POSITIVE_INFINITY:P===0||B===0?Math.max(P,B):Math.min(P,B);const te={};Object.defineProperty(te,"maxMessageSize",{get:()=>H}),this._sctp=te}return R.apply(this,arguments)}}function Ue(O){if(!O.RTCPeerConnection||!("createDataChannel"in O.RTCPeerConnection.prototype))return;function S(M,P){const B=M.send;M.send=function(){const H=arguments[0],te=H.length||H.size||H.byteLength;if(M.readyState==="open"&&P.sctp&&te>P.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+P.sctp.maxMessageSize+" bytes)");return B.apply(M,arguments)}}const R=O.RTCPeerConnection.prototype.createDataChannel;O.RTCPeerConnection.prototype.createDataChannel=function(){const M=R.apply(this,arguments);return S(M,this),M},g(O,"datachannel",M=>(S(M.channel,M.target),M))}function qt(O){if(!O.RTCPeerConnection||"connectionState"in O.RTCPeerConnection.prototype)return;const S=O.RTCPeerConnection.prototype;Object.defineProperty(S,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(S,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(R){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),R&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=R)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(R=>{const M=S[R];S[R]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=P=>{const B=P.target;if(B._lastConnectionState!==B.connectionState){B._lastConnectionState=B.connectionState;const H=new Event("connectionstatechange",P);B.dispatchEvent(H)}return P},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),M.apply(this,arguments)}})}function Mt(O,S){if(!O.RTCPeerConnection||S.browser==="chrome"&&S.version>=71||S.browser==="safari"&&S.version>=605)return;const R=O.RTCPeerConnection.prototype.setRemoteDescription;O.RTCPeerConnection.prototype.setRemoteDescription=function(M){if(M&&M.sdp&&M.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const P=M.sdp.split(`
`).filter(B=>B.trim()!=="a=extmap-allow-mixed").join(`
`);O.RTCSessionDescription&&M instanceof O.RTCSessionDescription?arguments[0]=new O.RTCSessionDescription({type:M.type,sdp:P}):M.sdp=P}return R.apply(this,arguments)}}function Yt(O,S){if(!O.RTCPeerConnection||!O.RTCPeerConnection.prototype)return;const R=O.RTCPeerConnection.prototype.addIceCandidate;R&&R.length!==0&&(O.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(S.browser==="chrome"&&S.version<78||S.browser==="firefox"&&S.version<68||S.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():R.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function ce(O,S){if(!O.RTCPeerConnection||!O.RTCPeerConnection.prototype)return;const R=O.RTCPeerConnection.prototype.setLocalDescription;R&&R.length!==0&&(O.RTCPeerConnection.prototype.setLocalDescription=function(){let M=arguments[0]||{};if(typeof M!="object"||M.type&&M.sdp)return R.apply(this,arguments);if(M={type:M.type,sdp:M.sdp},!M.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":M.type="offer";break;default:M.type="answer"}return M.sdp||M.type!=="offer"&&M.type!=="answer"?R.apply(this,[M]):(M.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(P=>R.apply(this,[P]))})}(function({window:O}={},S={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const R=E,M=function(B){const H={browser:null,version:null};if(B===void 0||!B.navigator||!B.navigator.userAgent)return H.browser="Not a browser.",H;const{navigator:te}=B;if(te.mozGetUserMedia)H.browser="firefox",H.version=p(te.userAgent,/Firefox\/(\d+)\./,1);else if(te.webkitGetUserMedia||B.isSecureContext===!1&&B.webkitRTCPeerConnection)H.browser="chrome",H.version=p(te.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!B.RTCPeerConnection||!te.userAgent.match(/AppleWebKit\/(\d+)\./))return H.browser="Not a supported browser.",H;H.browser="safari",H.version=p(te.userAgent,/AppleWebKit\/(\d+)\./,1),H.supportsUnifiedPlan=B.RTCRtpTransceiver&&"currentDirection"in B.RTCRtpTransceiver.prototype}return H}(O),P={browserDetails:M,commonShim:l,extractVersion:p,disableLog:_,disableWarnings:v,sdp:be};switch(M.browser){case"chrome":if(!a||!Y||!S.shimChrome)return R("Chrome shim is not included in this adapter release."),P;if(M.version===null)return R("Chrome shim can not determine version, not shimming."),P;R("adapter.js shimming chrome."),P.browserShim=a,Yt(O,M),ce(O),L(O,M),$(O),Y(O,M),q(O),Z(O,M),G(O),X(O),ie(O),ee(O,M),Xe(O),nt(O),qt(O),$e(O,M),Ue(O),Mt(O,M);break;case"firefox":if(!o||!He||!S.shimFirefox)return R("Firefox shim is not included in this adapter release."),P;R("adapter.js shimming firefox."),P.browserShim=o,Yt(O,M),ce(O),oe(O,M),He(O,M),Me(O),we(O),Te(O),Le(O),Ce(O),ke(O),St(O),At(O),Ee(O),Xe(O),qt(O),$e(O,M),Ue(O);break;case"safari":if(!c||!S.shimSafari)return R("Safari shim is not included in this adapter release."),P;R("adapter.js shimming safari."),P.browserShim=c,Yt(O,M),ce(O),it(O),gt(O),fe(O),ye(O),et(O),dt(O),Fe(O),bt(O),Xe(O),nt(O),$e(O,M),Ue(O),Mt(O,M);break;default:R("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),r(8520);const j=()=>typeof RTCPeerConnection=="function";var W,me;(function(O){O[O.TRACE=0]="TRACE",O[O.DEBUG=1]="DEBUG",O[O.INFO=2]="INFO",O[O.WARN=3]="WARN",O[O.ERROR=4]="ERROR",O[O.SILENT=5]="SILENT"})(W||(W={})),function(O){O.SPADE="SPADE",O.TIME="Time",O.WEBRTC="WebRTC",O.EMITTER="Emitter",O.MEDIA="Media",O.SUBSCRIPTION="StageSubscription",O.PUBLICATION="StagePublication",O.CONNECTION="StageConnection",O.SOCKET="StageSocket",O.BROADCAST_STAGE_CLIENT="BroadcastStageClient",O.STAGE="Stage",O.REMOTE_PARTICIPANT="RemoteParticipant",O.LOCAL_PARTICIPANT="LocalParticipant",O.CONFIGURATION="Configuration",O.REMOTE_PLAYBACK="RemotePlaybackController",O.REMOTE_STAGE_STREAM="RemoteStageStream"}(me||(me={}));const De=1007,je=12e4,mt=3e5;class xt extends Error{constructor({name:S,message:R,code:M,details:P,cause:B,params:H}){super(R),Error.captureStackTrace&&Error.captureStackTrace(this,xt),this.name=S||"BroadcastClientError",this.message=R,this.code=M,this.details=P,this.cause=B,this.params=H}}const Vn={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},qe={name:"CameraError",code:2e3,message:"Camera could not be captured"},Vt={name:"InputError",code:3e3,message:"Input could not be attached"},ht={name:"AddDeviceError",code:4e3,message:"Device is missing"},Pt={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},hn={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},an={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},Ve={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},ot={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},Ct={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},Nt={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},Wn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},sr={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},Si={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},si={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},En={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},sn={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},Ln={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},Nn={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},di={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},ur={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},ei={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},La={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},gu={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},Zd={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},mp={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},u0={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},Qd={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},ef={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},vu={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},ve={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},Ke={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var vt,yt,Ze,Ht,nn,mn,Sn,oi,ci,Cn=function(O,S,R,M){if(R==="a"&&!M)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?O!==S||!M:!S.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return R==="m"?M:R==="a"?M.call(O):M?M.value:S.get(O)},gi=function(O,S,R,M,P){if(typeof S=="function"?O!==S||!P:!S.has(O))throw new TypeError("Cannot write private member to an object whose class did not declare it");return S.set(O,R),R};const ar=1920,As=1080,vs=W.ERROR,Ki={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},Yn={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},Ti={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},Bn={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},Ho={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},zl={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},eo={reconnect:!1,timeout:je};function sh(O){var S,R;if(typeof O!="string"&&O!==void 0)throw new xt(La);if(O){if(O.startsWith("https"))return O;{const M=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(O);if(((S=M==null?void 0:M.groups)===null||S===void 0?void 0:S.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(R=M==null?void 0:M.groups)===null||R===void 0?void 0:R.id)return`https://${M.groups.id}.webrtc.live-video.net:4443`;throw new xt(gu)}}return""}class cs{constructor(S,R,M=Ki,P,B=eo){this.LOG_LEVEL=W,this.BASIC_LANDSCAPE=Ki,this.BASIC_PORTRAIT=Yn,this.BASIC_FULL_HD_LANDSCAPE=Ti,this.BASIC_FULL_HD_PORTRAIT=Bn,this.STANDARD_LANDSCAPE=Ho,this.STANDARD_PORTRAIT=zl,vt.set(this,void 0),yt.set(this,void 0),Ze.set(this,Ki),Ht.set(this,void 0),nn.set(this,eo),mn.set(this,H=>{if(!H)throw new xt(Object.assign(Object.assign({},ei),{details:"missing stream configuration"}));if(!(H.maxBitrate<=8500&&H.maxBitrate>=200))throw new xt(Object.assign(Object.assign({},ei),{details:"maxBitrate must be between 200 and 8500"}));if(!(H.maxFramerate<=60&&H.maxFramerate>=10))throw new xt(Object.assign(Object.assign({},ei),{details:"maxFramerate must be between 10 and 60"}));const te=H.maxResolution.width,re=H.maxResolution.height;if(te>ar||re>ar||te<160||re<160||te===ar&&re>As||re===ar&&te>As)throw new xt(Object.assign(Object.assign({},ei),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))}),Sn.set(this,H=>{if(!H)return;const te=Number(H),re=Number.isInteger(te),K=te>=W.TRACE,se=te<=W.SILENT;if(!re||!K||!se)throw new xt(Zd)}),oi.set(this,H=>{if(H&&typeof H!="object")throw new xt(mp)}),ci.set(this,H=>{if(!H)return;if(typeof H!="object"||typeof H.reconnect!="boolean")throw new xt(Qd);const{timeout:te}=H;if(te!==void 0&&(Number.isNaN(te)||typeof te!="number"||te<1e4||te>mt))throw new xt(ef)}),Cn(this,oi,"f").call(this,P),Cn(this,Sn,"f").call(this,R),Cn(this,mn,"f").call(this,M),gi(this,vt,S),gi(this,yt,R),gi(this,Ze,M),gi(this,Ht,P),gi(this,nn,B)}get ingestEndpoint(){return Cn(this,vt,"f")}set ingestEndpoint(S){gi(this,vt,sh(S))}get streamConfig(){return Cn(this,Ze,"f")}set streamConfig(S){Cn(this,mn,"f").call(this,S),gi(this,Ze,S)}get logLevel(){return Cn(this,yt,"f")}set logLevel(S){Cn(this,Sn,"f").call(this,S),gi(this,yt,S)}get logger(){return Cn(this,Ht,"f")}set logger(S){Cn(this,oi,"f").call(this,S),gi(this,Ht,S)}get networkReconnectConfig(){return Cn(this,nn,"f")}set networkReconnectConfig(S){Cn(this,ci,"f").call(this,S),gi(this,nn,S)}}vt=new WeakMap,yt=new WeakMap,Ze=new WeakMap,Ht=new WeakMap,nn=new WeakMap,mn=new WeakMap,Sn=new WeakMap,oi=new WeakMap,ci=new WeakMap;var bn,to=r(6729),Hs=r(1206);(function(O){O.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",O.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",O.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",O.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",O.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",O.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",O.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",O.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",O.PUBLISH="ivs_broadcast_multihost_publish",O.UNPUBLISH="ivs_broadcast_multihost_unpublish",O.SUBSCRIBE="ivs_broadcast_multihost_subscribe",O.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",O.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",O.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",O.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",O.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",O.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",O.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",O.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",O.FIRST_FRAME="ivs_broadcast_multihost_first_frame",O.JOIN="ivs_broadcast_multihost_join",O.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",O.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",O.JOIN_ENDED="ivs_broadcast_multihost_join_ended",O.LEAVE="ivs_broadcast_multihost_leave",O.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",O.SERVER_REQUEST="ivs_broadcast_multihost_server_request",O.TRACE="ivs_broadcast_stage_trace",O.ERROR="ivs_broadcast_error",O.MINUTE="ivs_broadcast_multihost_minute",O.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",O.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",O.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",O.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",O.EDP_PONG="ivs_broadcast_multihost_edp_rtt",O.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",O.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",O.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",O.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",O.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state"})(bn||(bn={}));class qn{constructor(S,R,M,P){let B="unknown";if(R.stageARN&&R.stageARN.startsWith("arn:aws:ivs:")){const H=R.stageARN.split(":");H.length===6&&(B=H[4])}this.event=S,this.properties={client_time:new Date().toISOString(),customer_id:B,device_software:window.navigator.userAgent,multihost_id:R.stageARN,participant_id:R.participantID,participant_user_id:R.userID,platform:"web",sdk_version:"1.19.0",stage_arn:R.stageARN,trace_id:M.value},R.attrGsRole&&(this.properties.token_attribute_0=R.attrGsRole),R.attrGsSessionId&&(this.properties.token_attribute_1=R.attrGsSessionId),this.critical=P}}class _l extends qn{constructor(S){super(bn.ERROR,S.token,S.traceId,!0),Object.assign(this.properties,{code:S.code,tag:S.tag,description:S.message,remote_participant_id:S.remoteParticipantId,request_uuid:S.requestUUID,is_nominal:S.nominal,is_fatal:S.fatal,details:S.details,location:S.location})}}const oa="IVS_CLIENT_OVERRIDES";function gp(O){const S=window[oa];return typeof S=="object"?S[O]:O==="logLevel"?window.STAGES_LOG_LEVEL:O==="appLabel"?window.IVS_APP_LABEL:O==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function rd(O){const S=gp(O);if(typeof S=="string")return S}function ah(O){const S=gp(O);if(typeof S=="boolean")return S}function h0(){const O=gp("logLevel");if(typeof O=="number"&&Object.values(W).includes(O))return O}function wy(){return ah("disableXdp")}function d0(){return ah("enableXdpPublish")}function jo(){return ah("preferMainProfile")}function f0(){return ah("enableInitialLayerOnSdp")}var Vo=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};const lx=4;class sE{constructor(S="https://broadcast.stats.live-video.net/"){this.spadeUrl=S}send(S,R=!1){return Vo(this,void 0,void 0,function*(){const M=Date.now();for(const te of S)te.properties.batch_time_millis=M;const P=this.b64EncodeUnicode(JSON.stringify(S)),B={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},H=`data=${P}`;R?navigator.sendBeacon(this.spadeUrl,H):Vo(this,void 0,void 0,function*(){try{yield function(te,re,K={},se=""){return Vo(this,void 0,void 0,function*(){const he=new XMLHttpRequest;return he.open(te,re,!0),K&&Object.keys(K).forEach(pe=>{K.hasOwnProperty(pe)&&he.setRequestHeader(pe,K[pe])}),new Promise((pe,Ne)=>{he.onreadystatechange=()=>{he.readyState===lx&&(he.status>=200&&he.status<300?pe(he.responseText):Ne(new Error(`Spade ${te} ${re} responded ${he.status}
${he.responseText}`)))},he.send(se)})})}("POST",this.spadeUrl,B,H)}catch{}})})}b64EncodeUnicode(S){return btoa(encodeURIComponent(S).replace(/%([0-9A-F]{2})/g,(R,M)=>String.fromCharCode(+`0x${M}`)))}}function yu(O){if(!O)throw new Error("SpadeClient is not defined")}function vm(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,O=>{const S=16*Math.random()|0;return(O==="x"?S:3&S|8).toString(16)})}class sd{constructor(){this.sharedProperties={},this.spadeClient={},this.queuedEvents=[],this.genSessionId();const S=function(){const M=rd("analyticsPostUrl");if(M!==void 0)return M}()||"https://broadcast.stats.live-video.net/",R=function(){const M=rd("appLabel");if(M!==void 0)return M.substring(0,64)}();this.spadeClient=new sE(S),this.initSharedProperties({appLabel:R})}start(){this.flushInterval||(this.flushInterval=window.setInterval(()=>{this.flushEvents()},1e3))}stop(S){let R=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,S&&(this.queuedEvents=this.queuedEvents.filter(M=>M.critical),R=!0),this.flushEvents(R),this.genSessionId()}trackEvent(S,R=!1){let M=this.sharedProperties;R&&(M={global_session_id:sd.globalSessionId,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version}),"data"in S?(S.data.properties=Object.assign({},M,S.data.properties),this.queuedEvents.push(S.data)):(S.properties=Object.assign({},M,S.properties),this.queuedEvents.push(S))}trackEventNoSharedProps(S){this.trackEvent(S,!0)}trackErrorAndThrow(S){throw this.trackError(S),S}trackError(S){this.trackEvent(new _l(S))}batchEvents(S){yu(this.spadeClient);const R=S.map(M=>(M.data.properties=Object.assign({},this.sharedProperties,M.data.properties),M.data));this.spadeClient.send(R)}initSharedProperties({appLabel:S}){const R=Hs.getParser(navigator.userAgent),M=this.parseSemver(String(R.getBrowserVersion()));this.sharedProperties={browser:navigator.appVersion,browser_family:R.getBrowserName().toLowerCase(),browser_version:`${M.major}.${M.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:R.getOSName(),os_version:String(R.getOSVersion()),platform:"web",global_session_id:sd.globalSessionId,session_id:this.sessionId,sdk_version:"1.19.0",user_agent:navigator.userAgent},S&&(this.sharedProperties.app_label=S)}genSessionId(){this.sessionId=vm(),this.sharedProperties.session_id=this.sessionId}flushEvents(S=!1){yu(this.spadeClient),this.queuedEvents.length>0&&this.spadeClient.send(this.queuedEvents,S),this.queuedEvents=[]}parseSemver(S){const R=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(S)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(S)||/^(\d+)$/.exec(S)||[];return{major:parseInt(R[1],10)||0,minor:parseInt(R[2],10)||0,patch:parseInt(R[3],10)||0}}getSessionId(){return this.sessionId}}sd.globalSessionId=vm();class Ss{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.CONGESTION_TIME,properties:M}}}class oh{constructor(S,R,M){this.transformProperties=(B,H,te)=>({duration:(B.getTime()-((H==null?void 0:H.getTime())||0))/1e3,ecn_negotiated:!1,ingest_session_id:te});const P=this.transformProperties(S,R,M);this.data={event:Ms.CONNECTION_ESTABLISHED,properties:P}}}class Cy{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.CONNECTION_RTT,properties:M}}}class aE{constructor(S){this.transformProperties=M=>{var P;return{is_fatal:(P=M.isFatal)!==null&&P!==void 0&&P,value:M.value,code:M.code,description:M.description}};const R=this.transformProperties(S);this.data={event:Ms.ERROR,properties:R}}}class Ry{constructor(S,R){this.transformProperties=(P,B)=>({type:P,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const M=this.transformProperties(S,R);this.data={event:Ms.INPUT_DEVICE_ATTACHED,properties:M}}}class ux{constructor(S,R){this.transformProperties=(P,B)=>({type:P,input_device_id:B.deviceId,position:B.facingMode||"unknown"});const M=this.transformProperties(S,R);this.data={event:Ms.INPUT_DEVICE_DETACHED,properties:M}}}class oE{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.MEASURED_BITRATE,properties:M}}}class tf{constructor(S,R){this.transformProperties=(P,B)=>({minutes_logged:Math.round((P.timestamp-B)/6e4)});const M=this.transformProperties(S,R);this.data={event:Ms.MINUTE_BROADCAST,properties:M}}}class nf{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.RECOMMENDED_BITRATE,properties:M}}}class Ay{constructor(S){this.transformProperties=M=>({codec:M.mimeType,bitrate:0,sample_rate:M.clockRate,channel_count:M.channels});const R=this.transformProperties(S);this.data={event:Ms.SESSION_AUDIO_ENCODER_CONFIGURED,properties:R}}}class cE{constructor(S){this.transformProperties=M=>({codec:"audio",bitrate:32e3,sample_rate:M.sampleRate,channel_count:M.channelCount});const R=this.transformProperties(S);this.data={event:Ms.SESSION_AUDIO_PROPERTIES,properties:R}}}class lE{constructor(S,R,M){this.transformProperties=(B,H,te)=>({codec:te.mimeType,codec_profile:H.profile,codec_level:H.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:B.width,height:B.height,bframe_count:0,target_fps:B.frameRate});const P=this.transformProperties(S,R,M);this.data={event:Ms.SESSION_VIDEO_ENCODER_CONFIGURED,properties:P}}}class p0{constructor(S){this.transformProperties=M=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:M.width,height:M.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:M.frameRate});const R=this.transformProperties(S);this.data={event:Ms.SESSION_VIDEO_PROPERTIES,properties:R}}}class My{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.SOURCE_AUDIO_LATENCY,properties:M}}}class uE{constructor(S,R){this.transformProperties=(P,B)=>({sum:P.sum,median:P.median(),min:P.min,max:P.max,p90:P.percentile(.9),event_count:P.data.length,period:B});const M=this.transformProperties(S,R);this.data={event:Ms.SOURCE_VIDEO_LATENCY,properties:M}}}class ch{constructor(S,R){this.transformProperties=({protocol:P,hostname:B,port:H},te)=>({protocol:P,endpoint_host:B,endpoint_port:H,reason:te});const M=this.transformProperties(S,R);this.data={event:Ms.START_BROADCAST,properties:M}}}class ym{constructor(S){this.transformProperties=({protocol:M,hostname:P,port:B})=>({protocol:M,endpoint_host:P,endpoint_port:B});const R=this.transformProperties(S);this.data={event:Ms.STOP_BROADCAST,properties:R}}}class hE{constructor(S){this.transformProperties=M=>({bytes_sent:M.bytesSent,header_bytes_sent:M.headerBytesSent,nack_count:M.nackCount,packets_sent:M.packetsSent,retransmitted_bytes_sent:M.retransmittedBytesSent,retransmitted_packets_sent:M.retransmittedPacketsSent});const R=this.transformProperties(S);this.data={event:Ms.WEBRTC_AUDIO_STATS,properties:R}}}class hc{constructor(S){this.transformProperties=M=>({bytes_sent:M.bytesSent,fir_count:M.firCount,frames_encoded:M.framesEncoded,frames_sent:M.framesSent,header_bytes_sent:M.headerBytesSent,huge_frames_sent:M.hugeFramesSent,key_frames_encoded:M.keyFramesEncoded,nack_count:M.nackCount,packets_sent:M.packetsSent,pli_count:M.pliCount,quality_limitation_reason:M.qualityLimitationReason,quality_limitation_resolution_changes:M.qualityLimitationResolutionChanges,retransmitted_bytes_sent:M.retransmittedBytesSent,retransmitted_packets_sent:M.retransmittedPacketsSent,total_encode_time:M.totalEncodeTime,total_encoded_bytes_target:M.totalEncodedBytesTarget,total_packet_send_delay:M.totalPacketSendDelay});const R=this.transformProperties(S);this.data={event:Ms.WEBRTC_VIDEO_STATS,properties:R}}}var Ms,ad;(function(O){O.START_BROADCAST="ivs_broadcast_start_broadcast",O.STOP_BROADCAST="ivs_broadcast_stop_broadcast",O.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",O.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",O.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",O.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",O.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",O.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",O.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",O.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",O.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",O.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",O.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",O.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",O.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",O.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",O.CONGESTION_TIME="ivs_broadcast_congestion_time",O.BUFFER_DURATION="ivs_broadcast_buffer_duration",O.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",O.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",O.CONNECTION_RTT="ivs_broadcast_connection_rtt",O.ERROR="ivs_broadcast_error"})(Ms||(Ms={})),function(O){O.USER_INITIATED="user-initiated",O.NETWORK_DISCONNECT="network-disconnect"}(ad||(ad={}));const hx={[W.INFO]:"#528bff",[W.WARN]:"#ffb31a",[W.DEBUG]:"#00f593",[W.ERROR]:"#ff4f4d",[W.TRACE]:"",[W.SILENT]:"",[me.SPADE]:"#a970ff",[me.TIME]:"#53535f",[me.WEBRTC]:"#0e9bd8",[me.SUBSCRIPTION]:"#ffc400",[me.CONNECTION]:"#ff5edb",[me.SOCKET]:"#8585ff",[me.EMITTER]:"#adadb8",[me.LOCAL_PARTICIPANT]:"#1DD21D",[me.STAGE]:"#EC9806",[me.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},ca=({label:O})=>`background: ${hx[O]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,dx=Object.entries(W),m0=(O,S,R)=>{const M=ca({label:O}),[P]=dx.find(([,Je])=>Je===Number(O))||[],B=`%c${P}`,H=ca({label:S}),te=`%c${S}`,re=ca({label:me.TIME}),K=`%c[${new Date().toISOString()}]`,se=ca({label:"details"}),he=`%c[${R}]`,pe=[K,B,te],Ne=[re,M,H];return R&&(pe.push(he),Ne.push(se)),[pe.join(""),...Ne]},fx={debug(O){console.groupCollapsed(...m0(W.DEBUG,O.scope,O.label)),console.debug(O.msg,Object.assign(Object.assign({},O),{level:"debug"})),console.groupEnd()},info(O){console.groupCollapsed(...m0(W.INFO,O.scope,O.label)),console.info(O.msg,Object.assign(Object.assign({},O),{level:"info"})),console.groupEnd()},warn(O){console.groupCollapsed(...m0(W.WARN,O.scope,O.label)),console.warn(O.msg,Object.assign(Object.assign({},O),{level:"warn"})),console.groupEnd()},error(O){console.groupCollapsed(...m0(W.ERROR,O.scope,O.label)),console.error(O),console.groupEnd()}};var rf=function(O,S){var R={};for(var M in O)Object.prototype.hasOwnProperty.call(O,M)&&S.indexOf(M)<0&&(R[M]=O[M]);if(O!=null&&typeof Object.getOwnPropertySymbols=="function"){var P=0;for(M=Object.getOwnPropertySymbols(O);P<M.length;P++)S.indexOf(M[P])<0&&Object.prototype.propertyIsEnumerable.call(O,M[P])&&(R[M[P]]=O[M[P]])}return R};Object.entries(W);class _m{constructor(S=vs,R=fx){this.logLevel=S,this.loggerInstance=R}debug(S){var R,M;this.logLevel>W.DEBUG||(M=(R=this.loggerInstance).debug)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"debug"}))))}info(S){var R,M;this.logLevel>W.INFO||(M=(R=this.loggerInstance).info)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"info"}))))}warn(S){var R,M;this.logLevel>W.WARN||(M=(R=this.loggerInstance).warn)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{level:"warn"}))))}error(S){var R,M,{err:P}=S,B=rf(S,["err"]);this.logLevel>W.ERROR||(M=(R=this.loggerInstance).error)===null||M===void 0||M.call(R,Object.assign({err:P},B))}}class no{constructor(S,R){this.logger=S,this.scope=R}debug(S){var R,M;(M=(R=this.logger).debug)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}info(S){var R,M;(M=(R=this.logger).info)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}warn(S){var R,M;(M=(R=this.logger).warn)===null||M===void 0||M.call(R,JSON.parse(JSON.stringify(Object.assign(Object.assign({},S),{scope:this.scope}))))}error(S){var R,M,{err:P}=S,B=rf(S,["err"]);(M=(R=this.logger).error)===null||M===void 0||M.call(R,Object.assign(Object.assign({err:P},B),{scope:this.scope}))}unwrap(){return this.logger}}class dc{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(S){(this.min===0||S<this.min)&&(this.min=S),S>=this.max&&(this.max=S),this.data.push(S),this.sum+=S}median(){this.data.sort();const S=this.data.length>>1;return this.data.length%2==0?this.data[S-1]+this.data[S]>>1:this.data[S]}percentile(S){if(this.data.length===0)return 0;if(S<=0)return this.data[0];if(S>=1)return this.data[this.data.length-1];const R=(this.data.length-1)*S,M=Math.floor(R),P=M+1,B=R%1;return P>=this.data.length?this.data[M]:this.data[M]*(1-B)+this.data[P]*B}}var bm=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class px{constructor(S,R,M,P){this.peerClient=S,this.broadcastCanvasManager=R,this.analyticsTracker=P,this.logger=new no(M,me.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval(()=>{this.collectSamples()},1e3),this.trackSamplesTimerId=window.setInterval(()=>{this.trackSamples()},3e4),this.trackPeerConnectionStatsTimerId=window.setInterval(()=>{this.trackPeerConnectionStats()},6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return bm(this,void 0,void 0,function*(){(yield this.peerClient.getReports()).forEach(S=>{if(S.type==="outbound-rtp")switch(S.kind){case"audio":this.analyticsTracker.trackEvent(new hE(S));break;case"video":{const R=new hc(S),M=new tf(S,this.startTimestamp);this.analyticsTracker.batchEvents([R,M]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:S.kind})}})})}collectSamples(){return bm(this,void 0,void 0,function*(){let S=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach(M=>{switch(M.type){case"candidate-pair":M.nominated&&(this.rttSamples.push(M.currentRoundTripTime),this.recommendedBitrateSamples.push(M.availableOutgoingBitrate));break;case"outbound-rtp":S+=M.bytesSent||0,this.startTimestamp===0&&M.kind==="video"&&(this.startTimestamp=M.timestamp)}});const R=8*Math.round(S-this.previousBytesSent);this.previousBytesSent=S,this.measuredBitrateSamples.push(R)})}trackSamples(){const R=new My(this.audioLatencySamples,30),M=new uE(this.videoLatencySamples,30),P=new Ss(this.congestionTimeSamples,30),B=new oE(this.measuredBitrateSamples,30),H=new nf(this.recommendedBitrateSamples,30),te=new Cy(this.rttSamples,30);this.analyticsTracker.batchEvents([R,M,P,B,H,te]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new dc,this.videoLatencySamples=new dc,this.congestionTimeSamples=new dc,this.measuredBitrateSamples=new dc,this.recommendedBitrateSamples=new dc,this.rttSamples=new dc}}const Ta={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},Ys="connectionStateChange",g0="sdpNegotiated",od="clientError",vp="seiMessageReceived",ft="transformError";var at;(function(O){O.CLOSED="closed",O.COMPLETED="completed",O.CONNECTED="connected",O.CONNECTING="connecting",O.DISCONNECTED="disconnected",O.FAILED="failed",O.IDLE="idle",O.NEW="new",O.NONE="none"})(at||(at={}));const Ft=O=>{const S=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("web-contents-media-stream")?"tab":void 0},R=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("window")&&B.displaySurface==="window"?"window":void 0},M=B=>{var H;return!((H=B.deviceId)===null||H===void 0)&&H.startsWith("screen")&&B.displaySurface==="monitor"?"screen":void 0};return(S(P=O)||R(P)||M(P)?void 0:"camera")||M(O)||R(O)||S(O)||"unknown";var P};function fn(O,S){return O.find(R=>R.kind===S)}var Xt;(function(O){O.VIDEO="video",O.AUDIO="audio"})(Xt||(Xt={}));class ji{constructor(){this.mediaTracks=new Map([[Xt.VIDEO,void 0],[Xt.AUDIO,void 0]])}setTrack(S,R){this.mediaTracks.set(S,R)}getTrack(S){return this.mediaTracks.get(S)}}class la{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(S){return S?(S.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map(R=>R.trim()).filter(Boolean).forEach(R=>{const M=R.split("=");if(M.length===2)switch(M[0]){case"level-asymmetry-allowed":M[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":M[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(M[1]),this.level=this.getLevelFromId(M[1])}}),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(S){const R=S.substr(0,2),M=S.substr(2,2);switch(R.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return M==="00"?"high 10":"high 10 intra";case"7a":return M==="00"?"high 42":"high 42 intra";case"f4":return M==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(S){return parseInt(S.substr(4,2),16)}}function lh(O){return btoa(JSON.stringify(O))}var Ji,Hl=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};(function(O){O.IDLE="idle",O.EXECUTING="executing",O.RECONNECTING="reconnecting"})(Ji||(Ji={}));class uh{constructor(S,R=12e4,M,P){this.state=Ji.IDLE,this.failureCallback=()=>{},this.peerClient=S,this.timeout=R,this.logger=M,this.emitter=P}onFailure(S){this.failureCallback=S}setStartConfig(S,R){this.ingestEndpoint=S,this.streamKey=R}execute(){const{id:S}=this;this.state===Ji.IDLE&&(this.state=Ji.EXECUTING,this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,at.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:S}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(S){this.timeoutTimerId=window.setTimeout(()=>{this.state!==Ji.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,at.FAILED),this.failureCallback())},S)}stop(){this.state=Ji.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return Hl(this,void 0,void 0,function*(){if(this.ingestEndpoint&&this.streamKey){const S=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),S===at.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(R){throw this.logger.error({err:R}),R}}})}isActive(){return this.state!==Ji.IDLE}}class $c extends uh{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let S=5e3;const R=()=>Hl(this,void 0,void 0,function*(){if(this.state===Ji.EXECUTING)try{this.state=Ji.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:S}),this.state=Ji.EXECUTING,this.currentTimeoutId=window.setTimeout(R,S),S*=2}});this.currentTimeoutId=window.setTimeout(R,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class Em extends uh{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>Hl(this,void 0,void 0,function*(){if(navigator.onLine&&this.state===Ji.EXECUTING){this.state=Ji.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=Ji.EXECUTING}}})}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class v0{static create(S,R=eo,M,P){const{reconnect:B,timeout:H}=R;if(B){const te=Hs.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(te)&&navigator.connection?new Em(S,H,M,P):new $c(S,H,M,P)}}}var _u,Wc=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})},Ua=function(O,S,R,M){if(R==="a"&&!M)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?O!==S||!M:!S.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return R==="m"?M:R==="a"?M.call(O):M?M.value:S.get(O)};const Ar=O=>!!O;function y0(O){if(!O)throw new Error("PeerConnection is not defined")}const Oy={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class sf{constructor(S,R,M,P,B){this.config=S,this.emitter=R,this.mediaStreamManager=M,this.analyticsTracker=B,this.establishConnection=(H,te)=>Wc(this,void 0,void 0,function*(){var re,K,se;y0(this.peerConnection);try{const he=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(he),yield this.sendSetupRequest(H,te,he)}catch(he){if(he instanceof Error){(re=(se=he).code)!==null&&re!==void 0||(se.code=Ln.code);const pe=new xt(Object.assign(Object.assign({},Ln),{name:he.name,message:he.message,code:he==null?void 0:he.code,cause:he}));throw!((K=this.reconnectStrategy)===null||K===void 0)&&K.isActive()||this.handleError(he.code,he.message),this.stop(),pe}}}),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var H;if(!this.peerConnection)return at.NONE;const te=(H=this.reconnectStrategy)===null||H===void 0?void 0:H.isActive(),re=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(re){case"new":return at.NEW;case"closed":return at.CLOSED;case"disconnected":return te?at.CONNECTING:at.DISCONNECTED;case"failed":return te?at.CONNECTING:at.FAILED;case"idle":return at.IDLE;case"checking":case"connecting":return at.CONNECTING;case"completed":case"connected":return at.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:re}),at.IDLE}},this.onConnectionStateChange=()=>{var H;const te=this.getConnectionState();switch(te){case at.CONNECTED:{this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,te);const re=new Date;this.analyticsTracker.trackEvent(new oh(re,this.connectionStartDate,this.ingestSessionId));const K=this.mediaStreamManager.getTrack(Xt.AUDIO),se=this.mediaStreamManager.getTrack(Xt.VIDEO);if(se){const he=se.getSettings();this.analyticsTracker.trackEvent(new p0(he))}if(K){const he=K.getSettings();this.analyticsTracker.trackEvent(new cE(he))}(((H=this.peerConnection)===null||H===void 0?void 0:H.getSenders())||[]).forEach(he=>{var pe;(((pe=he.getParameters())===null||pe===void 0?void 0:pe.codecs)||[]).forEach(Ne=>{var Je;switch((Je=he.track)===null||Je===void 0?void 0:Je.kind){case"video":{if(!se)break;const Ye=new la().extractVideoSdpFmtpLine(Ne.sdpFmtpLine),Oe=se.getSettings();this.analyticsTracker.trackEvent(new lE(Oe,Ye,Ne));break}case"audio":if(!K)break;this.analyticsTracker.trackEvent(new Ay(Ne))}})});break}case at.CONNECTING:this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,te),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case at.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,te),this.handleTerminalConnectionFailure());break;case at.DISCONNECTED:this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,te),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,te)}},this.handleLocalDescription=H=>Wc(this,void 0,void 0,function*(){var te;return(te=this.peerConnection)===null||te===void 0?void 0:te.setLocalDescription(H)}),_u.set(this,H=>{if(typeof H!="string")throw new xt(La);try{new URL(H)}catch{throw new xt(gu)}}),this.logger=new no(P,me.WEBRTC),this.createReconnectStrategy(S)}start(S,R){var M;return Wc(this,void 0,void 0,function*(){Ua(this,_u,"f").call(this,S);const P=[this.mediaStreamManager.getTrack(Xt.VIDEO),this.mediaStreamManager.getTrack(Xt.AUDIO)].filter(Ar);if(this.createPeerConnection(),this.addTracks({tracks:P}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(S,R),yield this.establishConnection(S,R),!((M=this.reconnectStrategy)===null||M===void 0)&&M.isActive()){const B=new URL(S);this.analyticsTracker.trackEvent(new ch({protocol:"webrtc",hostname:B.hostname,port:B.port},ad.NETWORK_DISCONNECT))}})}stop(){var S,R,M,P;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[at.NEW,at.CONNECTING,at.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(Ta.CONNECTION_STATE_CHANGE,at.CLOSED),(S=this.peerConnection)===null||S===void 0||S.close(),(R=this.peerConnection)===null||R===void 0||R.removeEventListener("connectionstatechange",this.onConnectionStateChange),(M=this.peerConnection)===null||M===void 0||M.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(P=this.reconnectStrategy)===null||P===void 0||P.stop()}addTracks(S){var R;if(y0(this.peerConnection),!S)return;const M=this.peerConnection.getSenders().map(B=>{var H;return(H=B.track)===null||H===void 0?void 0:H.id}),P=S.tracks.filter(B=>!M.includes(B.id));for(const B of P)(R=this.peerConnection)===null||R===void 0||R.addTrack(B)}getReports(){var S;return Wc(this,void 0,void 0,function*(){try{const R=(yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats())||[],M=[];return R.forEach(P=>{M.push(P)}),M}catch{return[]}})}sendSetupRequest(S,R,M){var P;return Wc(this,void 0,void 0,function*(){const B=yield fetch(`${S}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:lh(M),streamKey:R},this.config.streamConfig))});if(!B.ok)throw function(te){let re=new xt(Object.assign({},Ln));return(te==null?void 0:te.code)===De&&(re=new xt(Object.assign({},di))),te!=null&&te.message&&(re.message=te.message),re}(yield B.json());const H=yield B.json();H!=null&&H.answer&&(yield(P=this.peerConnection)===null||P===void 0?void 0:P.setRemoteDescription(function(te){return JSON.parse(atob(te))}(H.answer)),this.ingestSessionId=H.ingestSessionId)})}handleTerminalConnectionFailure(){const S=new xt(Nn);this.handleError(S.code,S.message)}handleError(S,R){this.analyticsTracker.trackEvent(new aE({code:S,description:R,isFatal:!0})),this.emitter.emit(Ta.ERROR,{code:S,message:R})}createPeerConnection(){var S;const R=this.getConnectionState(),M=R!==at.NONE,P=R!==at.CLOSED,B=(S=this.reconnectStrategy)===null||S===void 0?void 0:S.isActive();M&&P&&!B||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval(()=>{const H=this.getConnectionState();if(this.reconnectStrategy&&H===at.DISCONNECTED&&this.disconnectionStartDate){const te=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:te}),te>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else H===at.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)},1e3),this.peerConnection=new RTCPeerConnection(Oy),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(S){if(this.reconnectStrategy=v0.create(this,S.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const R=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:R})}}}_u=new WeakMap;var af,Ny=r(2492);(function(O){O.CONFIG="config",O.UPDATE="update",O.START="start",O.STOP="stop"})(af||(af={}));var mx=r(477),Go=r.n(mx);function cd(){return Go()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var t;!function(t){t.CONFIG="config",t.UPDATE="update",t.START="start",t.STOP="stop"}(t||(t={}));const i=self;const s=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(t){this.config=Object.assign(Object.assign({},this.config),t),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{i.postMessage({type:t.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};i.addEventListener("message",(function(i){var n;if(null===(n=null==i?void 0:i.data)||void 0===n?void 0:n.type)switch(i.data.type){case t.CONFIG:s.setConfig(i.data.payload||{});break;case t.START:s.start();break;case t.STOP:s.stop()}}))})();`,"Worker",void 0,void 0)}var hh=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class dE{constructor(S,R,M){this.config=S,this.mediaStreamManager=R,this.analyticsTracker=M,this.handleWorkerEvent=te=>{var re;((re=te.data)===null||re===void 0?void 0:re.type)===af.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new cd,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const P=this.compositeEl.getContext("2d");if(P===null)throw new xt(Object.assign({},Vn));this.compositeContext=P,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const B=fn(this.compositeStream.getTracks(),Xt.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const H=fn(this.audioDestination.stream.getTracks(),Xt.AUDIO);B&&this.mediaStreamManager.setTrack(Xt.VIDEO,B),H&&this.mediaStreamManager.setTrack(Xt.AUDIO,H),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:af.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(S){this.previewElement=S;const{width:R,height:M}=this.config.streamConfig.maxResolution;this.previewElement.width=R,this.previewElement.height=M,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const S=this.audioContext.createConstantSource(),R=this.audioContext.createGain();R.gain.value=.001,S.connect(R),R.connect(this.audioDestination),S.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const S=document.body,R=["touchstart","touchend","mousedown","keydown"],M=()=>{R.forEach(B=>{S.removeEventListener(B,P)})},P=()=>{this.audioContext.resume().then(M)};R.forEach(B=>{S.addEventListener(B,P,!1)})}getTracks(){return[this.mediaStreamManager.getTrack(Xt.VIDEO),this.mediaStreamManager.getTrack(Xt.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(Xt.VIDEO)}getAudioInputDevice(S){if(typeof S!="string")return;const R=this.mixer.audio.find(M=>{if(M.name===S)return M.source});return R==null?void 0:R.source}getVideoInputDevice(S){if(typeof S=="string")return this.mixer.video.find(R=>R.name===S)}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(S,R,M){var P;return hh(this,void 0,void 0,function*(){if(typeof S!="object")throw new xt(Object.assign({},ht));if(!R||typeof R!="string")throw new xt(Object.assign({},Ve));if(this.mixer.video.some(pe=>pe.name===R))throw new xt(Object.assign({},Pt));if(!M)throw new xt(Object.assign({},hn));if(typeof M.index!="number")throw new xt(Object.assign({},an));const B=function(){const pe=document.createElement("video");return pe.autoplay=!0,pe.muted=!0,pe.setAttribute("playsinline",""),pe.setAttribute("webkit-playsinline",""),pe}(),H=S.getVideoTracks(),[te]=H;if(!H.length)throw new xt(Object.assign({},qe));const re=te.getConstraints(),K=Ny({},re,{frameRate:this.config.streamConfig.maxFramerate});try{yield te.applyConstraints(K)}catch(pe){let Ne="Unknown constraints error";pe instanceof Error&&(Ne=pe.message),this.analyticsTracker.trackEvent(new aE({description:`${Ct.message}: ${Ne}`,isFatal:!1,code:Ct.code}))}const se=()=>hh(this,void 0,void 0,function*(){let pe=0;for(;pe<5;)try{return void(yield B.play())}catch(Ne){if(!(Ne instanceof Error))throw new Error("unknown error trying to add video to broadcast");pe++,yield new Promise(Je=>setTimeout(Je,150))}throw new Error("Error playing video, tries exceeded")}),he=new MediaStream([te]);B.srcObject=he;try{yield se();const pe={name:R,element:B,position:M,source:he,render:!0},Ne=((P=te.getSettings)===null||P===void 0?void 0:P.call(te))||{};this.analyticsTracker.trackEvent(new Ry(Ft(Ne),Ne)),this.mixer.video.push(pe)}catch(pe){throw new xt(Object.assign(Object.assign({},qe),{cause:pe}))}})}addImageSource(S,R,M){var P;return hh(this,void 0,void 0,function*(){if(!S)throw new xt(Object.assign({},ht));if(!R||typeof R!="string")throw new xt(Object.assign({},Ve));if(S.tagName==="image")throw new xt(Object.assign({},ot));if(this.mixer.video.some(H=>H.name===R))throw new xt(Object.assign({},Pt));if(!M)throw new xt(Object.assign({},hn));if(typeof M.index!="number")throw new xt(Object.assign({},an));if(S instanceof Image){const H=(P=S.src)===null||P===void 0?void 0:P.slice();try{const te=S.src?new URL(S.src):{};if(te.host&&te.hostname){const re=yield fetch(S.src).then(se=>hh(this,void 0,void 0,function*(){return se.blob()})),K=yield new Promise(se=>{const he=new FileReader;he.onload=()=>{se(he.result)},he.readAsDataURL(re)});S.src=K}}catch{throw new xt(Object.assign(Object.assign({},sn),{params:{details:`Image URL: ${H}`}}))}}const B={name:R,element:S,position:M,render:!0};this.mixer.video.push(B)})}addAudioInputDevice(S,R){return hh(this,void 0,void 0,function*(){if(typeof S!="object")throw new xt(Object.assign({},ht));if(!R||typeof R!="string")throw new xt(Object.assign({},Ve));if(this.mixer.audio.some(te=>te.name===R))throw new xt(Object.assign({},Pt));const M=S.getAudioTracks();if(!M.length)throw new xt(Object.assign({},Vt));const P=this.audioContext.createMediaStreamSource(new MediaStream(M)),B=this.audioContext.createGain();B.gain.value=1,P.connect(B),B.connect(this.audioDestination);const H={name:R,source:S,audioTrackSource:P,gainNode:B};this.analyticsTracker.trackEvent(new Ry("audio",{deviceId:S.id})),this.mixer.audio.push(H)})}removeImage(S){const R=this.mixer.video.findIndex(M=>M.name===S);if(R<0)throw new xt(Object.assign({},Wn));this.mixer.video.splice(R,1)}removeVideoInputDevice(S){var R;const M=this.removeDevice(S,this.mixer.video);if(!M)throw new xt(Object.assign({},Nt));{const P=fn(M.source.getTracks(),Xt.VIDEO);if(!P)throw new xt(Object.assign({},Nt));M.element.srcObject=null,P.stop();const B=((R=P==null?void 0:P.getSettings)===null||R===void 0?void 0:R.call(P))||{};this.analyticsTracker.trackEvent(new ux(Ft(B),B))}}removeAudioInputDevice(S){const R=this.removeDevice(S,this.mixer.audio);if(R!=null&&R.audioTrackSource){for(const M of R.source.getTracks())M.stop(),this.analyticsTracker.trackEvent(new ux("audio",{deviceId:M.id}));R.gainNode.disconnect(this.audioDestination)}else if(!R)throw new xt(Object.assign({},Nt))}updateVideoDeviceComposition(S,R){if(!S||typeof S!="string")throw new xt(Object.assign({},si));if(!R)throw new xt(Object.assign({},sr));if(typeof R.index!="number")throw new xt(Object.assign({},Si));this.mixer.video.forEach((M,P)=>{M.name===S&&(M.position=R)})}exchangeVideoDevicePositions(S,R){const M=this.getVideoInputDevice(S),P=this.getVideoInputDevice(R);if(!M)throw new xt(Object.assign(Object.assign({},En),{params:{details:`device with name: "${S}" not found`}}));if(!P)throw new xt(Object.assign(Object.assign({},En),{params:{details:`device with name: "${R}" not found`}}));const B=Object.assign({},M.position),H=Object.assign({},P.position);for(const te of this.mixer.video)te.name===S&&(Sm(H.x)?te.position=Object.assign(Object.assign({},te.position),H):te.position={index:H.index}),te.name===R&&(Sm(B.x)?te.position=Object.assign(Object.assign({},te.position),B):te.position={index:B.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:af.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:af.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var S;return((S=this.mediaStreamManager.getTrack(Xt.VIDEO))===null||S===void 0?void 0:S.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach(S=>{S.render=!1})}enableVideo(){this.mixer.video.forEach(S=>{S.render=!0})}disableAudio(){this.mixer.audio.forEach(S=>{S.audioTrackSource&&(S.gainNode.gain.value=0)})}enableAudio(){this.mixer.audio.forEach(S=>{S.audioTrackSource&&(S.gainNode.gain.value=1)})}getDrawRegion(S,R,M){var P,B,H,te;let re=(P=S.position.x)!==null&&P!==void 0?P:0,K=(B=S.position.y)!==null&&B!==void 0?B:0;const se=(H=S.position.width)!==null&&H!==void 0?H:R-re,he=(te=S.position.height)!==null&&te!==void 0?te:M-K,pe=se/he;let Ne=S.element.width,Je=S.element.height;S.element instanceof HTMLVideoElement&&(Ne=S.element.videoWidth,Je=S.element.videoHeight);const Ye=Ne/Je;let Oe=se,_e=he;return Ye>pe?(Oe=se,_e=2*Math.round(se/Ye/2),K+=(he-_e)/2):Ye<pe&&(_e=he,Oe=2*Math.round(he*Ye/2),re+=(se-Oe)/2),{x:re,y:K,width:Oe,height:_e}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const S=this.mixer.video.filter(R=>R.render);S.sort((R,M)=>R.position.index-M.position.index);for(const R of S){const{x:M,y:P,width:B,height:H}=this.getDrawRegion(R,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(R.element,M,P,B,H)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(Xt.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(S,R){const M=R.findIndex(P=>(B=>B.name===S)(P));if(!(M<0))return R.splice(M,1)[0]}shouldMix(S){if(S.getTime()<this.nextMix)return!1;for(;this.nextMix<=S.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function Sm(O){return Number.isSafeInteger(O)}var Tm,_0,of=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})},b0=function(O,S,R,M){if(R==="a"&&!M)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?O!==S||!M:!S.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return R==="m"?M:R==="a"?M.call(O):M?M.value:S.get(O)};class bu{constructor(S){this.config=S,Tm.add(this),this.emitter=new to,this.isValid=!0,this.emitter.on(Ta.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new sd,this.mediaStreamManager=new ji;const R=new _m(S.logLevel,S.logger);this.peerClient=new sf(this.config,this.emitter,this.mediaStreamManager,R,this.analyticsTracker),this.broadcastCanvasManager=new dE(S,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new px(this.peerClient,this.broadcastCanvasManager,R,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(bu.prototype).forEach(M=>{this[M]=new Proxy(this[M],{apply:(P,B,H)=>{if(!B.isValid)throw new xt(Object.assign({},u0));return Reflect.apply(P,B,H)}})}),window.addEventListener("beforeunload",()=>{this.analyticsTracker.stop(!0)})}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(S,R){return of(this,void 0,void 0,function*(){b0(this,Tm,"m",_0).call(this,S);const M=sh(R||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(M,S),this.emitter.emit(Ta.ACTIVE_STATE_CHANGE,!0),this.url=new URL(M),this.url&&this.analyticsTracker.trackEvent(new ch({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},ad.USER_INITIATED))})}stopBroadcast(){var S,R,M;this.url&&this.analyticsTracker.trackEvent(new ym({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(S=this.peerStatsTracker)===null||S===void 0||S.stop(),(R=this.peerClient)===null||R===void 0||R.stop(),(M=this.emitter)===null||M===void 0||M.emit(Ta.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(S,R,M){return of(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addVideoInputDevice(S,R,M)})}addImageSource(S,R,M){return of(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addImageSource(S,R,M)})}addAudioInputDevice(S,R){return of(this,void 0,void 0,function*(){return this.broadcastCanvasManager.addAudioInputDevice(S,R)})}removeVideoInputDevice(S){this.broadcastCanvasManager.removeVideoInputDevice(S)}removeAudioInputDevice(S){this.broadcastCanvasManager.removeAudioInputDevice(S)}removeImage(S){this.broadcastCanvasManager.removeImage(S)}updateVideoDeviceComposition(S,R){this.broadcastCanvasManager.updateVideoDeviceComposition(S,R)}exchangeVideoDevicePositions(S,R){this.broadcastCanvasManager.exchangeVideoDevicePositions(S,R)}getAudioInputDevice(S){return this.broadcastCanvasManager.getAudioInputDevice(S)}getVideoInputDevice(S){return this.broadcastCanvasManager.getVideoInputDevice(S)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(S,R){this.emitter.on(S,R)}off(S,R){this.emitter.off(S,R)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(S){this.broadcastCanvasManager.attachPreview(S)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function Fr(O){return new bu(function(S){const R=new cs;return R.streamConfig=S.streamConfig,R.ingestEndpoint=S.ingestEndpoint,R.logger=S.logger,R.logLevel=S.logLevel,R.networkReconnectConfig=S.networkReconnectConfig,R}(O))}Tm=new WeakSet,_0=function(O){if(typeof O!="string"||!/^[a-zA-Z0-9_-]+$/.test(O))throw new xt(vu)};const E0="1.19.0";var dn,ua=r(6486);(function(O){O.PUBLISH="publish",O.SUBSCRIBE="subscribe",O.JOIN="join",O.LEAVE="leave"})(dn||(dn={}));const S0=2;class Eu extends qn{constructor(S){super(bn.LEAVE,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.LEAVE,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint,reason:S.reason}),this.critical=!0}}class Yc{constructor(){this.emitter=new to}on(S,R,M){R.call=function(P,B){return function(H,...te){try{B.apply(H,te)}catch(re){let K=`Error in callback for ${P}`;const se=B.name;return se&&(K+=` for function ${se}`),void console.error(`${K}
`,re)}}}(S,R),this.emitter.on(S,R,M)}off(S,R,M){this.emitter.off(S,R,M)}emit(S,...R){this.emitter.emit(S,...R)}removeAllListeners(){this.emitter.removeAllListeners()}}function T0(O){const S="0123456789abcdef";let R="";for(let M=0;M<O;M+=1)R+=S.charAt(Math.floor(Math.random()*S.length));return R}class yp{constructor(){const S=T0;this.value=`${S(8)}-${S(4)}-${S(4)}-${S(4)}-${S(12)}`}}function xa(){return new yp}class fE{constructor(){const S=(Date.now()/1e3|0).toString(16);this.value=`1-${S}-${T0(24)}`}}function fc(){return new fE}var Ts=r(9669),Xs=r.n(Ts);class Ii extends xt{constructor({token:S,traceId:R,code:M,tag:P,location:B,message:H,details:te,remoteParticipantId:re,requestUUID:K,fatal:se,nominal:he,action:pe}){super({name:"StageClientError",message:H,code:M}),Error.captureStackTrace&&Error.captureStackTrace(this,Ii),this.action=pe,this.token=S,this.traceId=R,this.code=M,this.tag=P,this.location=B,this.message=H,this.details=te,this.remoteParticipantId=re,this.requestUUID=K,this.fatal=se,this.nominal=he}}const pc={JOIN_RELATED:"signalling_session",PUBLISH_RELATED:"webrtc_sink",UNPUBLISH_RELATED:"webrtc_unsink",SUBSCRIBE_RELATED:"webrtc_source"};function To(O,S){switch(O){case dn.PUBLISH:return pc.PUBLISH_RELATED;case dn.SUBSCRIBE:return`webrtc_source:${S}`;default:return"unknown"}}function _p(O,S){var R,M,P,B;const H={code:O.code,message:`${O.message}: ${S.name} ${S.message}`,fatal:(R=O.fatal)!==null&&R!==void 0&&R,nominal:(M=O.nominal)!==null&&M!==void 0&&M};return S instanceof Ii&&(H.fatal=(P=S.fatal)!==null&&P!==void 0&&P,H.nominal=(B=S.nominal)!==null&&B!==void 0&&B),H}function x0(O,S){if(O===0)return Bt.UNKNOWN_SERVER_ERROR;if(!(O<400))if(O>=400&&O<=403)switch(S){case xo.TokenExpired:return Bt.EXPIRED_TOKEN;case xo.NoPermissions:return Bt.TOKEN_PERMISSIONS_DENIED;case xo.StageAtCapacity:return Bt.STAGE_AT_CAPACITY;case xo.NoMatchingCodec:return Bt.NO_MATCHING_CODEC;default:return Bt.UNKNOWN_SERVER_ERROR}else{if(O===404)return S===xo.RemoteStreamNotFound?Bt.REMOTE_STREAM_NOT_FOUND:Bt.UNKNOWN_SERVER_ERROR;if(O===412)return S===xo.AbortedMHCPError?Bt.MHCP_ABORTED:Bt.UNKNOWN_SERVER_ERROR;if(O===429)return S===xo.StageAuthThrottled?Bt.STAGE_AUTH_THROTTLED:Bt.WHIP_TOO_MANY_REQUESTS;if(O!==500)return Bt.UNKNOWN_SERVER_ERROR;switch(S){case xo.InternalMHCPError:return Bt.INTERNAL_MHCP_ERROR;case xo.UnreachableMHCP:return Bt.UNREACHABLE_MHCP;case xo.InvalidSessionStatus:return Bt.INVALID_SESSION_STATUS;default:return Bt.INTERNAL_SERVER_ERROR}}}var xo;(function(O){O[O.Unspecified=2001]="Unspecified",O[O.TokenExpired=2002]="TokenExpired",O[O.NoPermissions=2003]="NoPermissions",O[O.RemoteStreamNotFound=2004]="RemoteStreamNotFound",O[O.StageAtCapacity=2005]="StageAtCapacity",O[O.InternalMHCPError=2006]="InternalMHCPError",O[O.UncategorizedMHCPError=2007]="UncategorizedMHCPError",O[O.UnreachableMHCP=2008]="UnreachableMHCP",O[O.InvalidSessionStatus=2010]="InvalidSessionStatus",O[O.PostWithoutOptions=2011]="PostWithoutOptions",O[O.AbortedMHCPError=2012]="AbortedMHCPError",O[O.StageAuthThrottled=2013]="StageAuthThrottled",O[O.NoMatchingCodec=2014]="NoMatchingCodec"})(xo||(xo={}));const Bt={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},NO_CANDIDATES:{code:1022,message:"No ICE candidates",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNCATEGORIZED_MHCP_ERROR:{code:1029,message:"Authorization failed due to uncategorized MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},POST_WITHOUT_OPTIONS:{code:1032,message:"Cannot POST without OPTIONS in mandatory TURN",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},CHIME_MEETING_NOT_FOUND:{code:1098,message:"Meeting or Attendee was deleted",fatal:!0,nominal:!0},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message",fatal:!1,nominal:!1},WHIP_SESSION_RESOURCE_DELETED:{code:1206,message:"WHIP signaling session resource not found",fatal:!0,nominal:!0},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_OPTIONS_FAILURE:{code:1501,message:"Failed to get ICE Servers from OPTIONS",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PING_SEND_FAIL:{code:1303,message:"Ping send fail",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var wa;(function(O){O.UNPUBLISH="unpublish",O.UNSUBSCRIBE="unsubscribe",O.UNLOAD="unload",O.CONNECTION_FAIL="connection fail",O.REASSIGNMENT="reassignment"})(wa||(wa={}));const xm="stageJoined",cf="stageParticipantJoined",ld="stageParticipantLeft",ha="stageParticipantKicked",w0="stageParticipantUpdated",mc="localPublishingChanged",gx="stageRefresh",bl="stateChange",bp="error",jl="reassignmentRequest",lf="incompatibleCodecs",wm="connectionStateChange",ge="stageStreamUpdate",ud="error",dh="stageStreamSeiMessageReceived",io="transformError",Bi="reassignmentStarted",hd="reassignmentSuccess",Su="reassignmentFailed",Xc="open",Tu="closed",gc="messageParseError",Iy="refresh",Vl="error",ky="stageStateMessage",C0="sdpAnswer",R0="disconnectMessage",uf="reassignmentMessage",wo="incompatibleCodecs";function pE(O){return R=function(M){return M.replace(/-/g,"+").replace(/_/g,"/").padEnd(M.length+(4-M.length%4)%4,"=")}(O),window.atob(R);var R}class qo{constructor(S,R){this.analyticsTracker=R,this.rawToken=S;const M=S.split(".");if(M.length!==3)throw Error(`Token format incorrect. length: ${M.length}`);try{this.header=JSON.parse(pE(M[0]))}catch(H){const te=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token header${te}`)}try{this.claims=JSON.parse(pE(M[1]))}catch(H){const te=H instanceof Error?`: ${H.message}`:"";throw Error(`Error parsing Stage Token claims${te}`)}this.signature=M[2];const{claims:P}=this;this.stageARN=P.resource,this.participantID=P.jti,this.eventsURL=P.events_url,this.whipURL=rd("whipUrl")||P.whip_url,this.userID=P.user_id,this.expirationTime=P.exp,this.topic=P.topic,this.parseVersionFlags(P.version);const{attributes:B}=P;B&&(this.attrGsRole=B.gs_role,this.attrGsSessionId=B.gs_session_id)}getPublishEndpoint(){let S="";return this.whipURL&&this.participantID&&(S=`${this.whipURL}/publish/${this.participantID}`),S}getSubscribeEndpoint(S){let R="";return this.whipURL&&(R=`${this.whipURL}/subscribe/${S}`),R}assertTokenIsUnexpired(S,R,M,P){(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},Bt.EXPIRED_TOKEN),{action:dn.JOIN,location:M,tag:R,token:this,traceId:S,remoteParticipantId:P,message:Bt.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(S){if(!S)return;const R=S.split(".");R.length===2&&(this.versionFlags=parseInt(R[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||(this.versionFlags&S0)!=0}}function xu(O,S){return new qo(O,S)}class A0{constructor(S,R){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=S,this.trailing=!(R&&R.skipTrailing)}invoke(S,...R){return this.throttled?(this.trailingFn=S,this.trailingFnArgs=R,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),S(...R),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}class dd extends qn{constructor(S,R,M,P,B,H,te,re){super(bn.SERVER_REQUEST,R,te,!0),Object.assign(this.properties,{action:S,http_method:P,remote_participant_id:H,request_uuid:B,url:M,transport:re})}}const vc="draft-ietf-wish-whip-04";var ls,Dy=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};function hf(O,S){return Dy(this,void 0,void 0,function*(){O.validateStatus=M=>M>=200&&M<300||M===403;const R=yield Xs()(O);if(R.status===403){if(R.data.code===2003)throw new Ts.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",O,R.request,R);return O.url===R.request.responseURL?(O.validateStatus=M=>M>=200&&M<300,Xs()(O)):(O.url=R.request.responseURL,S<5?hf(O,S+1):(O.validateStatus=M=>M>=200&&M<300,Xs()(O)))}return R})}function El(O){return Dy(this,void 0,void 0,function*(){return hf(O,0)})}function M0(){}function mE(O){switch(O){case"new":return at.NEW;case"closed":return at.CLOSED;case"disconnected":return at.DISCONNECTED;case"failed":return at.FAILED;case"idle":return at.IDLE;case"checking":case"connecting":return at.CONNECTING;case"completed":case"connected":return at.CONNECTED;default:throw new Error(`unknown connecion state: ${O}`)}}function Cm(O,S,R){let M=document.createElement(S);const P=()=>{M&&(M.removeEventListener("loadeddata",B),M.removeEventListener("error",P),M.srcObject=null,M.src="",M=null)},B=()=>{P(),R(S)};return M.addEventListener("loadeddata",B),M.addEventListener("error",P),M.srcObject=O,P}class Rm extends qn{constructor(S,R,M,P,B){super(bn.TRACE,S,R,!1),Object.assign(this.properties,{action:P,message:M,remote_participant_id:B})}}class Ba extends qn{constructor(S,R,M,P,B){super(bn.CONNECTION_STATE,R,M,!1),Object.assign(this.properties,{action:S,remote_participant_id:B,state:P})}}class O0 extends qn{constructor(S,R,M,P,B){super(bn.ICE_GATHERING_STATE,R,M,!1),Object.assign(this.properties,{action:S,remote_participant_id:B,state:P})}}(function(O){O.POST="post",O.CONNECTED="connected",O.ICE_GATHERING="icegathering",O.SDP_EXCHANGE="sdpExchange",O.SET_REMOTE_DESC="setRemoteDesc",O.PEER_CONNECTION="peerConnection"})(ls||(ls={}));const gE="start",wu="stop";class vE{constructor(S,R){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=S,this.traceId=R}markActionStart(){this.markStart(ls.CONNECTED)}markPostStart(){this.markStart(ls.POST)}markPostStop(){this.markStop(ls.POST),this.postDuration=this.measure(ls.POST)}markIceGatheringStart(){this.markStart(ls.ICE_GATHERING)}markIceGatheringStop(){this.markStop(ls.ICE_GATHERING),this.timeToCandidate=this.measure(ls.ICE_GATHERING)}markActionStop(){this.markStop(ls.CONNECTED),this.timeToConnected=this.measure(ls.CONNECTED),this.markStop(ls.PEER_CONNECTION),this.peerConnectionDuration=this.measure(ls.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(ls.SET_REMOTE_DESC)}markSetRemoteDescStop(){const S=ls.SET_REMOTE_DESC;this.markStop(S),this.setRemoteDescDuration=this.measure(S),this.markStart(ls.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(ls.SDP_EXCHANGE)}markSdpExchangeStop(){const S=ls.SDP_EXCHANGE;this.markStop(S),this.sdpExchangeDuration=this.measure(S)}setTransport(S){this.sdpExchangeTransport=S}markStart(S){this.marks[`${this.namespace}.${S}.${gE}`]=performance.now()}markStop(S){this.marks[`${this.namespace}.${S}.${wu}`]=performance.now()}measure(S){const R=`${this.namespace}.${S}.${gE}`,M=`${this.namespace}.${S}.${wu}`,P=this.marks[R],B=this.marks[M];return P===void 0||B===void 0?0:B-P}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:S,postDuration:R,timeToCandidate:M,timeToConnected:P,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:te,peerConnectionDuration:re}=this;return{optionsDuration:S,postDuration:R,timeToCandidate:M,timeToConnected:P,sdpExchangeDuration:B,sdpExchangeTransport:H,setRemoteDescDuration:te,peerConnectionDuration:re}}resetMeasurements(S){this.traceId=S,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var Cu,js,Gl;(function(O){O.VIDEO="video",O.AUDIO="audio"})(Cu||(Cu={})),function(O){O.DEFAULT="default",O.LOW="low",O.MEDIUM="medium",O.HIGH="high"}(js||(js={})),function(O){O.LOWEST_QUALITY="lowest_quality",O.HIGHEST_QUALITY="highest_quality"}(Gl||(Gl={}));var da=r(766);class zr{constructor(S){this.sdp=S}static splitLines(S){return S.trim().split(`
`).map(R=>R.trim())}static splitSections(S){return S.split(`
m=`).map((R,M)=>(M>0?`m=${R}`:R).trim()+zr.CRLF)}getUniqueRtpHeaderExtensionId(S){const R=[];for(const P of S)if(/^a=extmap:/.test(P.trim())){const B=+P.split("a=extmap:")[1].split(" ")[0];R.includes(B)||R.push(B)}R.sort((P,B)=>P-B);let M=0;for(const P of R){if(P-M>1)return M+1;M=P}return M===14?-1:M+1}withVideoLayersAllocationRtpHeaderExtension(S){const R="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",M=S?S.getRtpHeaderExtensionId(R):-1,P=M===-1?this.getUniqueRtpHeaderExtensionId(zr.splitLines(this.sdp)):M,B=zr.splitSections(this.sdp),H=[];for(let re of B){if(/^m=video/.test(re)&&zr.getRtpHeaderExtensionIdInSection(re,R)===-1){const K=zr.splitLines(re),se=[];if(P===-1||this.hasRtpHeaderExtensionId(P)){H.push(re);continue}for(const he of K)if(se.push(he),/^a=sendrecv/.test(he.trim())){const pe=`a=extmap:${P} ${R}`;se.push(pe)}re=se.join(zr.CRLF)+zr.CRLF}else if(M!==-1&&/^m=video/.test(re)&&zr.getRtpHeaderExtensionIdInSection(re,R)!==M){const K=zr.splitLines(re),se=[];for(const he of K){if(/^a=extmap:/.test(he.trim())&&he.split("a=extmap:")[1].split(" ")[1]===R){if(!this.hasRtpHeaderExtensionId(M)){const pe=`a=extmap:${M} ${R}`;se.push(pe)}continue}se.push(he)}re=se.join(zr.CRLF)+zr.CRLF}H.push(re)}const te=H.join("");return new zr(te)}withOpusAudioConfig(S,R){const M=da.Qc(this.sdp);for(const P of M.media)if(P.type==="audio"){const{payload:B}=P.rtp.find(K=>K.codec==="opus");if(!B)continue;let H=P.fmtp.find(K=>K.payload===B);H||(H={payload:B,config:""});const te=da.rz(H.config);if(te.maxaveragebitrate=S,typeof R=="boolean"){const K=R?1:0;te["sprop-stereo"]=K,te.stereo=K}let re="";for(const K of Object.keys(te))re+=`${K}=${te[K]}; `;H.config=re.trim()}return new zr(da.cW(M))}static getRtpHeaderExtensionIdInSection(S,R){const M=zr.splitLines(S);for(const P of M)if(/^a=extmap:/.test(P.trim())){const B=P.split("a=extmap:")[1].split(" "),H=+B[0];if(B[1]===R)return H}return-1}getRtpHeaderExtensionId(S){const R=zr.splitSections(this.sdp);for(const M of R)if(/^m=video/.test(M)){const P=zr.getRtpHeaderExtensionIdInSection(M,S);if(P!==-1)return P}return-1}hasRtpHeaderExtensionId(S){const R=zr.splitLines(this.sdp);for(const M of R)if(/^a=extmap:/.test(M.trim())&&+M.split("a=extmap:")[1].split(" ")[0]===S)return!0;return!1}hasAudioNacksEnabled(){var S,R,M;return((M=(R=((S=da.Qc(this.sdp).media.filter(P=>P.type==="audio")[0])!==null&&S!==void 0?S:{}).rtcpFb)===null||R===void 0?void 0:R.filter(P=>P.type==="nack"))!==null&&M!==void 0?M:[]).length>0}}zr.CRLF=`\r
`,zr.rfc7587LowestBitrate=6e3,zr.rfc7587HighestBitrate=51e4;const Am=200,Mm=2500,Py=10,yc=30,N0=12,or=128,I0={[js.DEFAULT]:0,[js.LOW]:50,[js.MEDIUM]:150,[js.HIGH]:250},vx={[js.DEFAULT]:0,[js.LOW]:100,[js.MEDIUM]:200,[js.HIGH]:300},yE=()=>({minBitrate:Am,maxBitrate:Mm,maxFramerate:yc,simulcast:{enabled:!1},maxAudioBitrateKbps:64,stereo:!1});var _E=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};const yx="H264",Ly=O=>{const S=O==null?void 0:O.split("/");if((S==null?void 0:S.length)===2)return S[1]},Ru=(O,S)=>{const R=Ly(O);if(O===void 0||R===void 0)return;const M={mimeSubtype:R};if(S){const P=(B=>{const H=B.split(";"),te=new Map;for(const re of H){const[K,se]=re.split("=");te.set(K,se)}return te})(S);switch(R){case yx:{const B=P.get("profile-level-id");B&&((H,te)=>{if(te.length<6)return;const re=te.substring(0,4),K=parseInt(te.substring(4,6),16);H.profile=re,H.level=K})(M,B);break}case"H265":((B,H)=>{const te=H.get("profile-id")||"0",re=H.get("tier-flag")||"0",K=parseInt(H.get("level-id")||"0",10),se=[re,te].join("_");B.profile=se,B.level=K})(M,P)}}return M},k0=(O,S)=>O.sort((R,M)=>{if(Ly(R.mimeType)===yx){const P=Ru(R.mimeType,R.sdpFmtpLine);if((P==null?void 0:P.profile)===S)return-1}return 0}),fh=(O,S)=>{var R;const M=Ru(O.mimeType,O.sdpFmtpLine);return(M==null?void 0:M.mimeSubtype.toLowerCase())===S.mime.toLowerCase()&&((R=M==null?void 0:M.profile)===null||R===void 0?void 0:R.toLowerCase().indexOf(S.config.toLowerCase()))===0},D0=(O,S)=>S.filter(R=>!R.mimeType.endsWith("rtx")).filter(R=>R.mimeType.indexOf("packetization-mode=0")===-1).find(R=>O.reduce((M,P)=>M&&fh(R,P)===!1,!0));class P0 extends qn{constructor(S,R,M,P,B,H,te,re,K){var se,he;super(bn.PUBLISHED_VIDEO_STATS,S,R,!1),Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(se=M==null?void 0:M.node)!==null&&se!==void 0?se:"",cluster:(he=M==null?void 0:M.cluster)!==null&&he!==void 0?he:""},((pe,Ne,Je,Ye,Oe,_e)=>{var lt,wt,Kt,It,Xn,wn,yi,Fi,ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr,ys,Zr,ds,Qr,Ir,hr,$r,es,fs,Ks,pa;const _s=(wt=(lt=pe==null?void 0:pe.qualityLimitationDurations)===null||lt===void 0?void 0:lt.cpu)!==null&&wt!==void 0?wt:0,ks=(It=(Kt=pe==null?void 0:pe.qualityLimitationDurations)===null||Kt===void 0?void 0:Kt.bandwidth)!==null&&It!==void 0?It:0,dr=Math.max((Xn=pe==null?void 0:pe.bytesSent)!==null&&Xn!==void 0?Xn:0,0),Ra=8*dr/(_e??1),Zn=Math.max((wn=Ne==null?void 0:Ne.packetsLost)!==null&&wn!==void 0?wn:0,0),Gi=Math.max((yi=pe==null?void 0:pe.packetsSent)!==null&&yi!==void 0?yi:0,0),Mr=Zn/Math.max(Gi,1),Va=Ru(Ye==null?void 0:Ye.mimeType,Ye==null?void 0:Ye.sdpFmtpLine);return{active:!!(pe!=null&&pe.framesPerSecond)&&pe.framesPerSecond!==0,bytes_sent:dr,codec_mime_type:Va==null?void 0:Va.mimeSubtype,codec_profile:Va==null?void 0:Va.profile,codec_level:Va==null?void 0:Va.level,configured_bitrate:Oe==null?void 0:Oe.max_bitrate,connection_bandwidth:(Fi=Je==null?void 0:Je.availableOutgoingBitrate)!==null&&Fi!==void 0?Fi:0,encode_bitrate:Ra,encoder_implementation:(ki=pe==null?void 0:pe.encoderImplementation)!==null&&ki!==void 0?ki:"unknown",fir_count:(xi=pe==null?void 0:pe.firCount)!==null&&xi!==void 0?xi:0,fraction_packets_lost:Mr,frame_height:Math.max((_i=pe==null?void 0:pe.frameHeight)!==null&&_i!==void 0?_i:0,0),frame_width:Math.max((Ri=pe==null?void 0:pe.frameWidth)!==null&&Ri!==void 0?Ri:0,0),frames_encoded:(Di=pe==null?void 0:pe.framesEncoded)!==null&&Di!==void 0?Di:0,frames_per_second:Math.max((bi=pe==null?void 0:pe.framesPerSecond)!==null&&bi!==void 0?bi:0,0),frames_sent:(Ai=pe==null?void 0:pe.framesSent)!==null&&Ai!==void 0?Ai:0,header_bytes_sent:(ui=pe==null?void 0:pe.headerBytesSent)!==null&&ui!==void 0?ui:0,huge_frames_sent:(Tn=pe==null?void 0:pe.hugeFramesSent)!==null&&Tn!==void 0?Tn:0,key_frames_encoded:($n=pe==null?void 0:pe.keyFramesEncoded)!==null&&$n!==void 0?$n:0,nack_count:($i=pe==null?void 0:pe.nackCount)!==null&&$i!==void 0?$i:0,packets_lost:Zn,packets_sent:Gi,power_efficient_encoder:(Jr=pe==null?void 0:pe.powerEfficientEncoder)!==null&&Jr!==void 0&&Jr,pli_count:(ys=pe==null?void 0:pe.pliCount)!==null&&ys!==void 0?ys:0,quality_limitation_reason:(Zr=pe==null?void 0:pe.qualityLimitationReason)!==null&&Zr!==void 0?Zr:"none",quality_limitation_resolution_changes:(ds=pe==null?void 0:pe.qualityLimitationResolutionChanges)!==null&&ds!==void 0?ds:0,quality_limitation_cpu_duration:_s,quality_limitation_bandwidth_duration:ks,retransmitted_bytes_sent:(Qr=pe==null?void 0:pe.retransmittedBytesSent)!==null&&Qr!==void 0?Qr:0,retransmitted_packets_sent:(Ir=pe==null?void 0:pe.retransmittedPacketsSent)!==null&&Ir!==void 0?Ir:0,rid:(hr=pe==null?void 0:pe.rid)!==null&&hr!==void 0?hr:"no-rid",scalability_mode:($r=pe==null?void 0:pe.scalabilityMode)!==null&&$r!==void 0?$r:"unknown",target_bitrate:Math.max((es=pe==null?void 0:pe.targetBitrate)!==null&&es!==void 0?es:0,0),total_encode_time:(fs=pe==null?void 0:pe.totalEncodeTime)!==null&&fs!==void 0?fs:0,total_encoded_bytes_target:(Ks=pe==null?void 0:pe.totalEncodedBytesTarget)!==null&&Ks!==void 0?Ks:0,total_packet_send_delay:(pa=pe==null?void 0:pe.totalPacketSendDelay)!==null&&pa!==void 0?pa:0}})(P,B,H,te,re,K)))}}class df extends qn{constructor(S,R,M,P,B,H,te,re,K,se){var he,pe,Ne,Je;super(bn.PUBLISHED_VIDEO_STATS_WINDOW,S,R,!1);const Ye=Math.max(((he=P==null?void 0:P.timestamp)!==null&&he!==void 0?he:0)-((pe=B==null?void 0:B.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(Ne=M==null?void 0:M.node)!==null&&Ne!==void 0?Ne:"",cluster:(Je=M==null?void 0:M.cluster)!==null&&Je!==void 0?Je:"",window_size_ms:Ye},((Oe,_e,lt,wt,Kt,It,Xn,wn)=>{var yi,Fi,ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr,ys,Zr,ds,Qr,Ir,hr,$r,es,fs,Ks,pa,_s,ks,dr,Ra,Zn,Gi,Mr,Va,Mo,bc,Zc,ps,Zo,Sh,$l,Aa,lo,Oo,Qo,gf,vf,Np,Gs,yd,Th,Uu,Cl;const J0=(Fi=(yi=Oe==null?void 0:Oe.qualityLimitationDurations)===null||yi===void 0?void 0:yi.cpu)!==null&&Fi!==void 0?Fi:0,Ky=(xi=(ki=_e==null?void 0:_e.qualityLimitationDurations)===null||ki===void 0?void 0:ki.cpu)!==null&&xi!==void 0?xi:0,Z0=(Ri=(_i=Oe==null?void 0:Oe.qualityLimitationDurations)===null||_i===void 0?void 0:_i.bandwidth)!==null&&Ri!==void 0?Ri:0,Wr=(bi=(Di=_e==null?void 0:_e.qualityLimitationDurations)===null||Di===void 0?void 0:Di.bandwidth)!==null&&bi!==void 0?bi:0,Q0=Math.max(((Ai=Oe==null?void 0:Oe.bytesSent)!==null&&Ai!==void 0?Ai:0)-((ui=_e==null?void 0:_e.bytesSent)!==null&&ui!==void 0?ui:0),0),xh=8*Q0/(typeof wn!="number"?1:wn/1e3),b=Math.max(((Tn=lt==null?void 0:lt.packetsLost)!==null&&Tn!==void 0?Tn:0)-(($n=wt==null?void 0:wt.packetsLost)!==null&&$n!==void 0?$n:0),0),w=Math.max((($i=Oe==null?void 0:Oe.packetsSent)!==null&&$i!==void 0?$i:0)-((Jr=_e==null?void 0:_e.packetsSent)!==null&&Jr!==void 0?Jr:0),0),F=b/Math.max(w,1),Q=Ru(It==null?void 0:It.mimeType,It==null?void 0:It.sdpFmtpLine);return{active:!!(Oe!=null&&Oe.framesPerSecond)&&(Oe==null?void 0:Oe.framesPerSecond)!==0,bytes_sent:Q0,codec_mime_type:Q==null?void 0:Q.mimeSubtype,codec_profile:Q==null?void 0:Q.profile,codec_level:Q==null?void 0:Q.level,configured_bitrate:Xn==null?void 0:Xn.max_bitrate,connection_bandwidth:(ys=Kt==null?void 0:Kt.availableOutgoingBitrate)!==null&&ys!==void 0?ys:0,encode_bitrate:xh,encoder_implementation:(Zr=Oe==null?void 0:Oe.encoderImplementation)!==null&&Zr!==void 0?Zr:"unknown",fir_count:Math.max(((ds=Oe==null?void 0:Oe.firCount)!==null&&ds!==void 0?ds:0)-((Qr=_e==null?void 0:_e.firCount)!==null&&Qr!==void 0?Qr:0),0),fraction_packets_lost:F,frame_height:Math.max((Ir=Oe==null?void 0:Oe.frameHeight)!==null&&Ir!==void 0?Ir:0,0),frame_width:Math.max((hr=Oe==null?void 0:Oe.frameWidth)!==null&&hr!==void 0?hr:0,0),frames_encoded:Math.max((($r=Oe==null?void 0:Oe.framesEncoded)!==null&&$r!==void 0?$r:0)-((es=_e==null?void 0:_e.framesEncoded)!==null&&es!==void 0?es:0),0),frames_per_second:Math.max((fs=Oe==null?void 0:Oe.framesPerSecond)!==null&&fs!==void 0?fs:0,0),frames_sent:Math.max(((Ks=Oe==null?void 0:Oe.framesSent)!==null&&Ks!==void 0?Ks:0)-((pa=_e==null?void 0:_e.framesSent)!==null&&pa!==void 0?pa:0),0),header_bytes_sent:Math.max(((_s=Oe==null?void 0:Oe.headerBytesSent)!==null&&_s!==void 0?_s:0)-((ks=_e==null?void 0:_e.headerBytesSent)!==null&&ks!==void 0?ks:0),0),huge_frames_sent:Math.max(((dr=Oe==null?void 0:Oe.hugeFramesSent)!==null&&dr!==void 0?dr:0)-((Ra=_e==null?void 0:_e.hugeFramesSent)!==null&&Ra!==void 0?Ra:0),0),key_frames_encoded:Math.max(((Zn=Oe==null?void 0:Oe.keyFramesEncoded)!==null&&Zn!==void 0?Zn:0)-((Gi=_e==null?void 0:_e.keyFramesEncoded)!==null&&Gi!==void 0?Gi:0),0),nack_count:Math.max(((Mr=Oe==null?void 0:Oe.nackCount)!==null&&Mr!==void 0?Mr:0)-((Va=_e==null?void 0:_e.nackCount)!==null&&Va!==void 0?Va:0),0),packets_lost:b,packets_sent:w,power_efficient_encoder:(Mo=Oe==null?void 0:Oe.powerEfficientEncoder)!==null&&Mo!==void 0&&Mo,pli_count:Math.max(((bc=Oe==null?void 0:Oe.pliCount)!==null&&bc!==void 0?bc:0)-((Zc=_e==null?void 0:_e.pliCount)!==null&&Zc!==void 0?Zc:0),0),quality_limitation_reason:(ps=Oe==null?void 0:Oe.qualityLimitationReason)!==null&&ps!==void 0?ps:"none",quality_limitation_resolution_changes:Math.max(((Zo=Oe==null?void 0:Oe.qualityLimitationResolutionChanges)!==null&&Zo!==void 0?Zo:0)-((Sh=_e==null?void 0:_e.qualityLimitationResolutionChanges)!==null&&Sh!==void 0?Sh:0),0),quality_limitation_cpu_duration:Math.max(J0-Ky,0),quality_limitation_bandwidth_duration:Math.max(Z0-Wr,0),retransmitted_bytes_sent:Math.max((($l=Oe==null?void 0:Oe.retransmittedBytesSent)!==null&&$l!==void 0?$l:0)-((Aa=_e==null?void 0:_e.retransmittedBytesSent)!==null&&Aa!==void 0?Aa:0),0),rid:(lo=Oe==null?void 0:Oe.rid)!==null&&lo!==void 0?lo:"no-rid",retransmitted_packets_sent:Math.max(((Oo=Oe==null?void 0:Oe.retransmittedPacketsSent)!==null&&Oo!==void 0?Oo:0)-((Qo=_e==null?void 0:_e.retransmittedPacketsSent)!==null&&Qo!==void 0?Qo:0),0),scalability_mode:(gf=Oe==null?void 0:Oe.scalabilityMode)!==null&&gf!==void 0?gf:"unknown",target_bitrate:Math.max((vf=Oe==null?void 0:Oe.targetBitrate)!==null&&vf!==void 0?vf:0,0),total_encode_time:Math.max(((Np=Oe==null?void 0:Oe.totalEncodeTime)!==null&&Np!==void 0?Np:0)-((Gs=_e==null?void 0:_e.totalEncodeTime)!==null&&Gs!==void 0?Gs:0),0),total_encoded_bytes_target:Math.max(((yd=Oe==null?void 0:Oe.totalEncodedBytesTarget)!==null&&yd!==void 0?yd:0)-((Th=_e==null?void 0:_e.totalEncodedBytesTarget)!==null&&Th!==void 0?Th:0),0),total_packet_send_delay:Math.max(((Uu=Oe==null?void 0:Oe.totalPacketSendDelay)!==null&&Uu!==void 0?Uu:0)-((Cl=_e==null?void 0:_e.totalPacketSendDelay)!==null&&Cl!==void 0?Cl:0),0)}})(P,B,H,te,re,K,se,Ye)))}}class bE extends qn{constructor(S,R,M,P,B,H,te,re,K,se){var he,pe;super(bn.PUBLISHED_AUDIO_STATS,S,R,!1),Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(he=M==null?void 0:M.node)!==null&&he!==void 0?he:"",cluster:(pe=M==null?void 0:M.cluster)!==null&&pe!==void 0?pe:""},((Ne,Je,Ye,Oe,_e,lt,wt)=>{var Kt,It,Xn,wn,yi,Fi,ki,xi,_i,Ri,Di;const bi=Math.max((Kt=Ne==null?void 0:Ne.bytesSent)!==null&&Kt!==void 0?Kt:0,0),Ai=8*bi/(lt??1),ui=Math.max((It=Je==null?void 0:Je.packetsLost)!==null&&It!==void 0?It:0,0),Tn=Math.max((Xn=Ne==null?void 0:Ne.packetsSent)!==null&&Xn!==void 0?Xn:0,0),$n=ui/Math.max(Tn,1),$i=Ru(Oe==null?void 0:Oe.mimeType,Oe==null?void 0:Oe.sdpFmtpLine);return{audio_nacks_enabled:(wn=wt==null?void 0:wt.audioNacks)!==null&&wn!==void 0&&wn,bytes_sent:bi,codec_mime_type:$i==null?void 0:$i.mimeSubtype,configured_bitrate:(yi=_e==null?void 0:_e.max_audio_bitrate_bps)!==null&&yi!==void 0?yi:0,connection_bandwidth:(Fi=Ye==null?void 0:Ye.availableOutgoingBitrate)!==null&&Fi!==void 0?Fi:0,encode_bitrate:Ai,fraction_packets_lost:$n,header_bytes_sent:(ki=Ne==null?void 0:Ne.headerBytesSent)!==null&&ki!==void 0?ki:0,nack_count:(xi=Ne==null?void 0:Ne.nackCount)!==null&&xi!==void 0?xi:0,packets_lost:ui,packets_sent:Tn,retransmitted_bytes_sent:(_i=Ne==null?void 0:Ne.retransmittedBytesSent)!==null&&_i!==void 0?_i:0,retransmitted_packets_sent:(Ri=Ne==null?void 0:Ne.retransmittedPacketsSent)!==null&&Ri!==void 0?Ri:0,target_bitrate:(Di=Ne==null?void 0:Ne.targetBitrate)!==null&&Di!==void 0?Di:0}})(P,B,H,te,re,K,se)))}}class L0 extends qn{constructor(S,R,M,P,B,H,te,re,K,se,he){var pe,Ne,Je,Ye;super(bn.PUBLISHED_AUDIO_STATS_WINDOW,S,R,!1);const Oe=Math.max(((pe=P==null?void 0:P.timestamp)!==null&&pe!==void 0?pe:0)-((Ne=B==null?void 0:B.timestamp)!==null&&Ne!==void 0?Ne:0),0);Object.assign(this.properties,Object.assign({action:dn.PUBLISH,node:(Je=M==null?void 0:M.node)!==null&&Je!==void 0?Je:"",cluster:(Ye=M==null?void 0:M.cluster)!==null&&Ye!==void 0?Ye:"",window_size_ms:Oe},((_e,lt,wt,Kt,It,Xn,wn,yi,Fi)=>{var ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr,ys,Zr,ds,Qr,Ir,hr,$r,es;const fs=Math.max(((ki=_e==null?void 0:_e.bytesSent)!==null&&ki!==void 0?ki:0)-((xi=lt==null?void 0:lt.bytesSent)!==null&&xi!==void 0?xi:0),0),Ks=8*fs/(typeof yi!="number"?1:yi/1e3),pa=Math.max(((_i=wt==null?void 0:wt.packetsLost)!==null&&_i!==void 0?_i:0)-((Ri=Kt==null?void 0:Kt.packetsLost)!==null&&Ri!==void 0?Ri:0),0),_s=Math.max(((Di=_e==null?void 0:_e.packetsSent)!==null&&Di!==void 0?Di:0)-((bi=lt==null?void 0:lt.packetsSent)!==null&&bi!==void 0?bi:0),0),ks=pa/Math.max(_s,1),dr=Ru(Xn==null?void 0:Xn.mimeType,Xn==null?void 0:Xn.sdpFmtpLine);return{audio_nacks_enabled:(Ai=Fi==null?void 0:Fi.audioNacks)!==null&&Ai!==void 0&&Ai,bytes_sent:fs,codec_mime_type:dr==null?void 0:dr.mimeSubtype,configured_bitrate:(ui=wn==null?void 0:wn.max_audio_bitrate_bps)!==null&&ui!==void 0?ui:0,connection_bandwidth:(Tn=It==null?void 0:It.availableOutgoingBitrate)!==null&&Tn!==void 0?Tn:0,encode_bitrate:Ks,fraction_packets_lost:ks,header_bytes_sent:Math.max((($n=_e==null?void 0:_e.headerBytesSent)!==null&&$n!==void 0?$n:0)-(($i=lt==null?void 0:lt.headerBytesSent)!==null&&$i!==void 0?$i:0),0),nack_count:Math.max(((Jr=_e==null?void 0:_e.nackCount)!==null&&Jr!==void 0?Jr:0)-((ys=lt==null?void 0:lt.nackCount)!==null&&ys!==void 0?ys:0),0),packets_lost:pa,packets_sent:Math.max(((Zr=_e==null?void 0:_e.packetsSent)!==null&&Zr!==void 0?Zr:0)-((ds=lt==null?void 0:lt.packetsSent)!==null&&ds!==void 0?ds:0),0),retransmitted_bytes_sent:Math.max(((Qr=_e==null?void 0:_e.retransmittedBytesSent)!==null&&Qr!==void 0?Qr:0)-((Ir=lt==null?void 0:lt.retransmittedBytesSent)!==null&&Ir!==void 0?Ir:0),0),retransmitted_packets_sent:Math.max(((hr=_e==null?void 0:_e.retransmittedPacketsSent)!==null&&hr!==void 0?hr:0)-(($r=lt==null?void 0:lt.retransmittedPacketsSent)!==null&&$r!==void 0?$r:0),0),target_bitrate:Math.max((es=_e==null?void 0:_e.targetBitrate)!==null&&es!==void 0?es:0,0)}})(P,B,H,te,re,K,se,Oe,he)))}}class Uy extends qn{constructor(S,R,M,P,B,H,te,re){var K,se;super(bn.SUBSCRIBED_VIDEO_STATS,S,R,!1),Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(K=P==null?void 0:P.node)!==null&&K!==void 0?K:"",cluster:(se=P==null?void 0:P.cluster)!==null&&se!==void 0?se:"",remote_participant_id:M},((he,pe,Ne,Je)=>{var Ye,Oe,_e,lt,wt,Kt,It,Xn,wn,yi,Fi,ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr;let ys=0;he!=null&&he.jitterBufferDelay&&(he!=null&&he.jitterBufferEmittedCount)&&he.jitterBufferEmittedCount>0&&(ys=he.jitterBufferDelay/he.jitterBufferEmittedCount);const Zr=Je??1,ds=Math.max((Ye=he==null?void 0:he.bytesReceived)!==null&&Ye!==void 0?Ye:0,0),Qr=8*ds/Zr;let Ir=0;he!=null&&he.totalDecodeTime&&(he!=null&&he.framesDecoded)&&(Ir=he.totalDecodeTime/Math.max(he==null?void 0:he.framesDecoded,1));const hr=Math.max((Oe=he==null?void 0:he.packetsLost)!==null&&Oe!==void 0?Oe:0,0),$r=Math.max((_e=he==null?void 0:he.packetsReceived)!==null&&_e!==void 0?_e:0,0),es=hr/Math.max($r+hr,1),fs=Ru(Ne==null?void 0:Ne.mimeType,Ne==null?void 0:Ne.sdpFmtpLine);return{bytes_received:ds,codec_mime_type:fs==null?void 0:fs.mimeSubtype,codec_profile:fs==null?void 0:fs.profile,codec_level:fs==null?void 0:fs.level,connection_bandwidth:(lt=pe==null?void 0:pe.availableIncomingBitrate)!==null&&lt!==void 0?lt:0,decode_bitrate:Qr,decoder_implementation:(wt=he==null?void 0:he.decoderImplementation)!==null&&wt!==void 0?wt:"unknown",fir_count:Math.max((Kt=he==null?void 0:he.firCount)!==null&&Kt!==void 0?Kt:0,0),fraction_packets_lost:es,frame_decode_time_avg:Ir,frame_height:Math.max((It=he==null?void 0:he.frameHeight)!==null&&It!==void 0?It:0,0),frame_width:Math.max((Xn=he==null?void 0:he.frameWidth)!==null&&Xn!==void 0?Xn:0,0),frames_decoded:Math.max((wn=he==null?void 0:he.framesDecoded)!==null&&wn!==void 0?wn:0,0),frames_dropped:Math.max((yi=he==null?void 0:he.framesDropped)!==null&&yi!==void 0?yi:0,0),frames_received:Math.max((Fi=he==null?void 0:he.framesReceived)!==null&&Fi!==void 0?Fi:0,0),freeze_count:Math.max((ki=he==null?void 0:he.freezeCount)!==null&&ki!==void 0?ki:0,0),frames_rendered:Math.max((xi=he==null?void 0:he.framesRendered)!==null&&xi!==void 0?xi:0,0),frames_per_second:Math.max((_i=he==null?void 0:he.framesPerSecond)!==null&&_i!==void 0?_i:0,0),header_bytes_received:Math.max((Ri=he==null?void 0:he.headerBytesReceived)!==null&&Ri!==void 0?Ri:0,0),jitter_buffer_delay_avg:ys,key_frames_decoded:Math.max((Di=he==null?void 0:he.keyFramesDecoded)!==null&&Di!==void 0?Di:0,0),nack_count:Math.max((bi=he==null?void 0:he.nackCount)!==null&&bi!==void 0?bi:0,0),packets_discarded:Math.max((Ai=he==null?void 0:he.packetsDiscarded)!==null&&Ai!==void 0?Ai:0,0),packets_lost:hr,packets_received:$r,pause_count:Math.max((ui=he==null?void 0:he.pauseCount)!==null&&ui!==void 0?ui:0,0),pli_count:Math.max((Tn=he==null?void 0:he.pliCount)!==null&&Tn!==void 0?Tn:0,0),power_efficient_decoder:($n=he==null?void 0:he.powerEfficientDecoder)!==null&&$n!==void 0&&$n,total_freezes_duration:Math.max(($i=he==null?void 0:he.totalFreezesDuration)!==null&&$i!==void 0?$i:0,0),total_pauses_duration:Math.max((Jr=he==null?void 0:he.totalPausesDuration)!==null&&Jr!==void 0?Jr:0,0)}})(B,H,te,re)))}}class EE extends qn{constructor(S,R,M,P,B,H,te,re,K,se,he){var pe,Ne,Je,Ye;super(bn.SUBSCRIBED_VIDEO_STATS_WINDOW,S,R,!1);const Oe=Math.max(((pe=B==null?void 0:B.timestamp)!==null&&pe!==void 0?pe:0)-((Ne=H==null?void 0:H.timestamp)!==null&&Ne!==void 0?Ne:0),0);Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(Je=P==null?void 0:P.node)!==null&&Je!==void 0?Je:"",cluster:(Ye=P==null?void 0:P.cluster)!==null&&Ye!==void 0?Ye:"",window_size_ms:Oe,remote_participant_id:M},((_e,lt,wt,Kt,It,Xn,wn,yi)=>{var Fi,ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr,ys,Zr,ds,Qr,Ir,hr,$r,es,fs,Ks,pa,_s,ks,dr,Ra,Zn,Gi,Mr,Va,Mo,bc,Zc,ps,Zo,Sh,$l,Aa,lo,Oo,Qo;let gf=0,vf=0;if(_e!=null&&_e.jitterBufferEmittedCount&&(lt!=null&&lt.jitterBufferEmittedCount)&&_e.jitterBufferEmittedCount>lt.jitterBufferEmittedCount){_e!=null&&_e.jitterBufferDelay&&(lt!=null&&lt.jitterBufferDelay)&&(gf=(_e.jitterBufferDelay-lt.jitterBufferDelay)/(_e.jitterBufferEmittedCount-lt.jitterBufferEmittedCount));const xh=lt==null?void 0:lt.jitterBufferMinimumDelay,b=_e==null?void 0:_e.jitterBufferMinimumDelay;xh&&b&&(vf=(b-xh)/(_e.jitterBufferEmittedCount-lt.jitterBufferEmittedCount))}const Np=Math.max(((Fi=_e==null?void 0:_e.bytesReceived)!==null&&Fi!==void 0?Fi:0)-((ki=lt==null?void 0:lt.bytesReceived)!==null&&ki!==void 0?ki:0),0),Gs=typeof It!="number"?1:It/1e3,yd=8*Np/Gs,Th=Math.max(((xi=_e==null?void 0:_e.totalDecodeTime)!==null&&xi!==void 0?xi:0)-((_i=lt==null?void 0:lt.totalDecodeTime)!==null&&_i!==void 0?_i:0),0),Uu=Math.max(((Ri=_e==null?void 0:_e.framesDecoded)!==null&&Ri!==void 0?Ri:0)-((Di=lt==null?void 0:lt.framesDecoded)!==null&&Di!==void 0?Di:0),0),Cl=Th/Math.max(Uu,1),J0=Math.max(((bi=_e==null?void 0:_e.packetsLost)!==null&&bi!==void 0?bi:0)-((Ai=lt==null?void 0:lt.packetsLost)!==null&&Ai!==void 0?Ai:0),0),Ky=Math.max(((ui=_e==null?void 0:_e.packetsReceived)!==null&&ui!==void 0?ui:0)-((Tn=lt==null?void 0:lt.packetsReceived)!==null&&Tn!==void 0?Tn:0),0),Z0=J0/Math.max(Ky+J0,1),Wr=Ru(Kt==null?void 0:Kt.mimeType,Kt==null?void 0:Kt.sdpFmtpLine),Q0=8*(yi||0)/Gs;return{bytes_received:Np,codec_mime_type:Wr==null?void 0:Wr.mimeSubtype,codec_profile:Wr==null?void 0:Wr.profile,codec_level:Wr==null?void 0:Wr.level,connection_bandwidth:($n=wt==null?void 0:wt.availableIncomingBitrate)!==null&&$n!==void 0?$n:0,decode_bitrate:yd,decoder_implementation:($i=_e==null?void 0:_e.decoderImplementation)!==null&&$i!==void 0?$i:"unknown",fir_count:Math.max(((Jr=_e==null?void 0:_e.firCount)!==null&&Jr!==void 0?Jr:0)-((ys=lt==null?void 0:lt.firCount)!==null&&ys!==void 0?ys:0),0),fraction_packets_lost:Z0,frame_decode_time_avg:Cl,frame_height:Math.max((Zr=_e==null?void 0:_e.frameHeight)!==null&&Zr!==void 0?Zr:0,0),frame_width:Math.max((ds=_e==null?void 0:_e.frameWidth)!==null&&ds!==void 0?ds:0,0),frames_decoded:Math.max(((Qr=_e==null?void 0:_e.framesDecoded)!==null&&Qr!==void 0?Qr:0)-((Ir=lt==null?void 0:lt.framesDecoded)!==null&&Ir!==void 0?Ir:0),0),frames_dropped:Math.max(((hr=_e==null?void 0:_e.framesDropped)!==null&&hr!==void 0?hr:0)-(($r=lt==null?void 0:lt.framesDropped)!==null&&$r!==void 0?$r:0),0),frames_received:Math.max(((es=_e==null?void 0:_e.framesReceived)!==null&&es!==void 0?es:0)-((fs=lt==null?void 0:lt.framesReceived)!==null&&fs!==void 0?fs:0),0),freeze_count:Math.max(((Ks=_e==null?void 0:_e.freezeCount)!==null&&Ks!==void 0?Ks:0)-((pa=lt==null?void 0:lt.freezeCount)!==null&&pa!==void 0?pa:0),0),frames_rendered:Math.max((_s=_e==null?void 0:_e.framesRendered)!==null&&_s!==void 0?_s:0,0),frames_per_second:Math.max((ks=_e==null?void 0:_e.framesPerSecond)!==null&&ks!==void 0?ks:0,0),header_bytes_received:Math.max(((dr=_e==null?void 0:_e.headerBytesReceived)!==null&&dr!==void 0?dr:0)-((Ra=lt==null?void 0:lt.headerBytesReceived)!==null&&Ra!==void 0?Ra:0),0),configured_jitter_buffer_min_delay_ms:Xn??0,jitter_buffer_min_obtainable_delay:vf,jitter_buffer_delay_avg:gf,key_frames_decoded:Math.max(((Zn=_e==null?void 0:_e.keyFramesDecoded)!==null&&Zn!==void 0?Zn:0)-((Gi=lt==null?void 0:lt.keyFramesDecoded)!==null&&Gi!==void 0?Gi:0),0),nack_count:Math.max(((Mr=_e==null?void 0:_e.nackCount)!==null&&Mr!==void 0?Mr:0)-((Va=lt==null?void 0:lt.nackCount)!==null&&Va!==void 0?Va:0),0),packets_discarded:Math.max(((Mo=_e==null?void 0:_e.packetsDiscarded)!==null&&Mo!==void 0?Mo:0)-((bc=lt==null?void 0:lt.packetsDiscarded)!==null&&bc!==void 0?bc:0),0),packets_lost:J0,packets_received:Ky,pause_count:Math.max(((Zc=_e==null?void 0:_e.pauseCount)!==null&&Zc!==void 0?Zc:0)-((ps=lt==null?void 0:lt.pauseCount)!==null&&ps!==void 0?ps:0),0),pli_count:Math.max(((Zo=_e==null?void 0:_e.pliCount)!==null&&Zo!==void 0?Zo:0)-((Sh=lt==null?void 0:lt.pliCount)!==null&&Sh!==void 0?Sh:0),0),power_efficient_decoder:($l=_e==null?void 0:_e.powerEfficientDecoder)!==null&&$l!==void 0&&$l,total_freezes_duration:Math.max(((Aa=_e==null?void 0:_e.totalFreezesDuration)!==null&&Aa!==void 0?Aa:0)-((lo=lt==null?void 0:lt.totalFreezesDuration)!==null&&lo!==void 0?lo:0),0),total_pauses_duration:Math.max(((Oo=_e==null?void 0:_e.totalPausesDuration)!==null&&Oo!==void 0?Oo:0)-((Qo=lt==null?void 0:lt.totalPausesDuration)!==null&&Qo!==void 0?Qo:0),0),sei_read_count:wn,sei_bytes_received:yi,sei_bitrate:Q0}})(B,H,te,re,Oe,K,se,he)))}}class By extends qn{constructor(S,R,M,P,B,H,te,re,K){var se,he;super(bn.SUBSCRIBED_AUDIO_STATS,S,R,!1),Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,node:(se=P==null?void 0:P.node)!==null&&se!==void 0?se:"",cluster:(he=P==null?void 0:P.cluster)!==null&&he!==void 0?he:"",remote_participant_id:M},((pe,Ne,Je,Ye,Oe)=>{var _e,lt,wt,Kt,It,Xn,wn,yi,Fi,ki,xi,_i,Ri,Di,bi,Ai,ui;let Tn=0;pe!=null&&pe.jitterBufferDelay&&(pe!=null&&pe.jitterBufferEmittedCount)&&pe.jitterBufferEmittedCount>0&&(Tn=pe.jitterBufferDelay/pe.jitterBufferEmittedCount);const $n=Ye??1,$i=Math.max((_e=pe==null?void 0:pe.bytesReceived)!==null&&_e!==void 0?_e:0,0),Jr=8*$i/$n,ys=Math.max((lt=pe==null?void 0:pe.packetsLost)!==null&&lt!==void 0?lt:0,0),Zr=Math.max((wt=pe==null?void 0:pe.packetsReceived)!==null&&wt!==void 0?wt:0,0),ds=ys/Math.max(Zr+ys,1),Qr=Math.max((Kt=pe==null?void 0:pe.concealedSamples)!==null&&Kt!==void 0?Kt:0,0),Ir=Math.max((It=pe==null?void 0:pe.totalSamplesReceived)!==null&&It!==void 0?It:0,0),hr=Qr/Math.max(Ir,1),$r=Ru(Je==null?void 0:Je.mimeType,Je==null?void 0:Je.sdpFmtpLine);return{audio_level:(Xn=pe==null?void 0:pe.audioLevel)!==null&&Xn!==void 0?Xn:0,audio_nacks_enabled:(wn=Oe==null?void 0:Oe.audioNacks)!==null&&wn!==void 0&&wn,bytes_received:$i,codec_mime_type:$r==null?void 0:$r.mimeSubtype,connection_bandwidth:(yi=Ne==null?void 0:Ne.availableIncomingBitrate)!==null&&yi!==void 0?yi:0,concealed_samples:Qr,concealment_events:Math.max((Fi=pe==null?void 0:pe.concealmentEvents)!==null&&Fi!==void 0?Fi:0,0),silent_concealed_samples:Math.max((ki=pe==null?void 0:pe.silentConcealedSamples)!==null&&ki!==void 0?ki:0,0),decode_bitrate:Jr,fraction_audio_concealed:hr,fraction_packets_lost:ds,header_bytes_received:Math.max((xi=pe==null?void 0:pe.headerBytesReceived)!==null&&xi!==void 0?xi:0,0),inserted_samples_for_deceleration:Math.max((_i=pe==null?void 0:pe.insertedSamplesForDeceleration)!==null&&_i!==void 0?_i:0,0),jitter_buffer_delay_avg:Tn,packets_discarded:Math.max((Ri=pe==null?void 0:pe.packetsDiscarded)!==null&&Ri!==void 0?Ri:0,0),retransmitted_packets_received:Math.max((Di=pe==null?void 0:pe.retransmittedPacketsReceived)!==null&&Di!==void 0?Di:0,0),retransmitted_bytes_received:Math.max((bi=pe==null?void 0:pe.retransmittedBytesReceived)!==null&&bi!==void 0?bi:0,0),packets_lost:ys,packets_received:Zr,nack_count:Math.max((Ai=pe==null?void 0:pe.nackCount)!==null&&Ai!==void 0?Ai:0,0),removed_samples_for_acceleration:Math.max((ui=pe==null?void 0:pe.removedSamplesForAcceleration)!==null&&ui!==void 0?ui:0,0),total_samples_received:Ir}})(B,H,te,re,K)))}}class qi extends qn{constructor(S,R,M,P,B,H,te,re,K,se){var he,pe,Ne,Je;super(bn.SUBSCRIBED_AUDIO_STATS_WINDOW,S,R,!1);const Ye=Math.max(((he=B==null?void 0:B.timestamp)!==null&&he!==void 0?he:0)-((pe=H==null?void 0:H.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:dn.SUBSCRIBE,window_size_ms:Ye,node:(Ne=P==null?void 0:P.node)!==null&&Ne!==void 0?Ne:"",cluster:(Je=P==null?void 0:P.cluster)!==null&&Je!==void 0?Je:"",remote_participant_id:M},((Oe,_e,lt,wt,Kt,It,Xn)=>{var wn,yi,Fi,ki,xi,_i,Ri,Di,bi,Ai,ui,Tn,$n,$i,Jr,ys,Zr,ds,Qr,Ir,hr,$r,es,fs,Ks,pa,_s,ks,dr,Ra,Zn;let Gi=0,Mr=0;if(Oe!=null&&Oe.jitterBufferEmittedCount&&(_e!=null&&_e.jitterBufferEmittedCount)&&Oe.jitterBufferEmittedCount>_e.jitterBufferEmittedCount){Oe!=null&&Oe.jitterBufferDelay&&(_e!=null&&_e.jitterBufferDelay)&&(Gi=(Oe.jitterBufferDelay-_e.jitterBufferDelay)/(Oe.jitterBufferEmittedCount-_e.jitterBufferEmittedCount));const Oo=_e==null?void 0:_e.jitterBufferMinimumDelay,Qo=Oe==null?void 0:Oe.jitterBufferMinimumDelay;Oo&&Qo&&(Mr=(Qo-Oo)/(Oe.jitterBufferEmittedCount-_e.jitterBufferEmittedCount))}const Va=typeof Kt!="number"?1:Kt/1e3,Mo=Math.max(((wn=Oe==null?void 0:Oe.bytesReceived)!==null&&wn!==void 0?wn:0)-((yi=_e==null?void 0:_e.bytesReceived)!==null&&yi!==void 0?yi:0),0),bc=8*Mo/Va,Zc=Math.max(((Fi=Oe==null?void 0:Oe.packetsLost)!==null&&Fi!==void 0?Fi:0)-((ki=_e==null?void 0:_e.packetsLost)!==null&&ki!==void 0?ki:0),0),ps=Math.max(((xi=Oe==null?void 0:Oe.packetsReceived)!==null&&xi!==void 0?xi:0)-((_i=_e==null?void 0:_e.packetsReceived)!==null&&_i!==void 0?_i:0),0),Zo=Zc/Math.max(ps+Zc,1),Sh=Math.max(((Ri=Oe==null?void 0:Oe.concealedSamples)!==null&&Ri!==void 0?Ri:0)-((Di=_e==null?void 0:_e.concealedSamples)!==null&&Di!==void 0?Di:0),0),$l=Math.max(((bi=Oe==null?void 0:Oe.totalSamplesReceived)!==null&&bi!==void 0?bi:0)-((Ai=_e==null?void 0:_e.totalSamplesReceived)!==null&&Ai!==void 0?Ai:0),0),Aa=Sh/Math.max($l,1),lo=Ru(wt==null?void 0:wt.mimeType,wt==null?void 0:wt.sdpFmtpLine);return{audio_level:(ui=Oe==null?void 0:Oe.audioLevel)!==null&&ui!==void 0?ui:0,audio_nacks_enabled:(Tn=It==null?void 0:It.audioNacks)!==null&&Tn!==void 0&&Tn,bytes_received:Mo,codec_mime_type:lo==null?void 0:lo.mimeSubtype,connection_bandwidth:($n=lt==null?void 0:lt.availableIncomingBitrate)!==null&&$n!==void 0?$n:0,decode_bitrate:bc,concealed_samples:Sh,concealment_events:Math.max((($i=Oe==null?void 0:Oe.concealmentEvents)!==null&&$i!==void 0?$i:0)-((Jr=_e==null?void 0:_e.concealmentEvents)!==null&&Jr!==void 0?Jr:0),0),silent_concealed_samples:Math.max(((ys=Oe==null?void 0:Oe.silentConcealedSamples)!==null&&ys!==void 0?ys:0)-((Zr=_e==null?void 0:_e.silentConcealedSamples)!==null&&Zr!==void 0?Zr:0),0),fraction_audio_concealed:Aa,fraction_packets_lost:Zo,header_bytes_received:Math.max(((ds=Oe==null?void 0:Oe.headerBytesReceived)!==null&&ds!==void 0?ds:0)-((Qr=_e==null?void 0:_e.headerBytesReceived)!==null&&Qr!==void 0?Qr:0),0),inserted_samples_for_deceleration:Math.max(((Ir=Oe==null?void 0:Oe.insertedSamplesForDeceleration)!==null&&Ir!==void 0?Ir:0)-((hr=_e==null?void 0:_e.insertedSamplesForDeceleration)!==null&&hr!==void 0?hr:0),0),configured_jitter_buffer_min_delay_ms:Xn??0,jitter_buffer_min_obtainable_delay:Mr,jitter_buffer_delay_avg:Gi,packets_discarded:Math.max((($r=Oe==null?void 0:Oe.packetsDiscarded)!==null&&$r!==void 0?$r:0)-((es=_e==null?void 0:_e.packetsDiscarded)!==null&&es!==void 0?es:0),0),packets_lost:Zc,packets_received:ps,nack_count:Math.max(((fs=Oe==null?void 0:Oe.nackCount)!==null&&fs!==void 0?fs:0)-((Ks=_e==null?void 0:_e.nackCount)!==null&&Ks!==void 0?Ks:0),0),removed_samples_for_acceleration:Math.max(((pa=Oe==null?void 0:Oe.removedSamplesForAcceleration)!==null&&pa!==void 0?pa:0)-((_s=_e==null?void 0:_e.removedSamplesForAcceleration)!==null&&_s!==void 0?_s:0),0),retransmitted_packets_received:Math.max(((ks=Oe==null?void 0:Oe.retransmittedPacketsReceived)!==null&&ks!==void 0?ks:0)-((dr=_e==null?void 0:_e.retransmittedPacketsReceived)!==null&&dr!==void 0?dr:0),0),retransmitted_bytes_received:Math.max(((Ra=Oe==null?void 0:Oe.retransmittedBytesReceived)!==null&&Ra!==void 0?Ra:0)-((Zn=_e==null?void 0:_e.retransmittedBytesReceived)!==null&&Zn!==void 0?Zn:0),0),total_samples_received:$l}})(B,H,te,re,Ye,K,se)))}}class U0 extends qn{constructor(S,R,M,P,B=dn.PUBLISH,H=!1,te=""){super(bn.SIMULCAST_LAYER_INFO,S,R,!1),Object.assign(this.properties,{rid:M,active:P,selected:H,source:B===dn.PUBLISH?"publisher":"subscriber",remote_participant_id:te})}}class _x extends qn{constructor(S,R,M,P){super(bn.MULTIHOST_CONFIGURATION,S,R,!1),Object.assign(this.properties,Object.assign(Object.assign({},M),{action:P}))}}class Om extends qn{constructor(S,R,M){super(bn.MULTIHOST_SUBSCRIBE_CONFIGURATION,S,R,!1),Object.assign(this.properties,Object.assign({},M))}}var fd,Vi,Ep;(function(O){O.Mobile="mobile",O.Tablet="tablet",O.Desktop="desktop",O.Tv="tv"})(fd||(fd={})),function(O){O.IOS="iOS",O.MacOS="macOS",O.Windows="Windows",O.Android="Android"}(Vi||(Vi={})),function(O){O.Safari="Safari",O.Firefox="Firefox",O.Chrome="Chrome",O.IE="Internet Explorer",O.Edge="Microsoft Edge"}(Ep||(Ep={}));const us=function(O){const S=ph(O);return{platform:{isMobile:Sp(fd.Mobile,S),isTablet:Sp(fd.Tablet,S),isDesktop:Sp(fd.Desktop,S),isTv:Sp(fd.Tv,S)},os:{name:Tp(S),version:Nm(S),isIOS:mh(Vi.IOS,S),isMacOS:mh(Vi.MacOS,S),isWindows:mh(Vi.Windows,S),isAndroid:mh(Vi.Android,S)},browser:{name:gh(S),version:Kc(S),isSafari:xp(Ep.Safari,S),isFirefox:xp(Ep.Firefox,S),isChrome:xp(Ep.Chrome,S),isIE:xp(Ep.IE,S),isEdge:xp(Ep.Edge,S)}}}(window.navigator.userAgent);function ph(O){try{return Hs.getParser(O||window.navigator.userAgent)}catch{}}function Sp(O,S){return()=>(S||(S=ph()),!(!S||S.getPlatformType(!0)!==O.toLowerCase()))}function Nm(O){return()=>(O||(O=ph()),O&&O.getOSVersion()||"")}function Tp(O){return()=>(O||(O=ph()),O&&O.getOSName()||"")}function mh(O,S){return()=>(S||(S=ph()),!(!S||S.getOSName(!0)!==O.toLowerCase()))}function Kc(O){return()=>(O||(O=ph()),O&&O.getBrowserVersion()||"")}function gh(O){return()=>(O||(O=ph()),O&&O.getBrowserName()||"")}function xp(O,S){return()=>(S||(S=ph()),!(!S||S.getBrowserName().toLowerCase()!==O.toLowerCase()))}const SE={active:!1,maxBitrate:2e5,rid:"low",maxFramerate:15,scaleResolutionDownBy:4},Au={width:320,height:180},Im={active:!1,maxBitrate:7e5,rid:"mid",maxFramerate:20,scaleResolutionDownBy:2},B0={width:640,height:360},wp={active:!1,maxBitrate:17e5,rid:"hi",maxFramerate:30,scaleResolutionDownBy:1},F0={width:1280,height:720};function Mu(O){const{config:S}=O;return[{maxBitrate:S.maxBitrateBps}]}function vh(O,S){var R,M;const P=S==null?void 0:S.track,B=S==null?void 0:S.config;if(O&&P){const H=(0,ua.cloneDeep)([{encodingParams:SE,targetResolution:Au},{encodingParams:Im,targetResolution:B0},{encodingParams:wp,targetResolution:F0}]),{height:te,width:re}=P.getSettings(),K=te&&re?{width:re,height:te}:void 0;for(const pe of H){pe.encodingParams.active=!0;let Ne=1;K&&(Ne=Math.floor(Math.sqrt(K.width*K.height/(pe.targetResolution.width*pe.targetResolution.height))),Ne=Math.max(Ne,1)),pe.encodingParams.scaleResolutionDownBy=Ne}let se=(R=B==null?void 0:B.maxBitrateBps)!==null&&R!==void 0?R:wp.maxBitrate;const he=(M=B==null?void 0:B.maxFramerate)!==null&&M!==void 0?M:wp.maxFramerate;return se<Im.maxBitrate&&(se=wp.maxBitrate),H[2].encodingParams.maxBitrate=se,H[2].encodingParams.maxFramerate=he,H[2].encodingParams.scaleResolutionDownBy=1,H.map(pe=>pe.encodingParams)}return B?[{maxBitrate:B.maxBitrateBps,maxFramerate:B.maxFramerate}]:[{maxBitrate:ro(Mm),maxFramerate:yc}]}const hR=1e3;function ro(O){return O*hR}const TE=(O,...S)=>{const R=S.map(M=>typeof M!="object").filter(Boolean).length>0;if(typeof O=="object"&&!R)return(0,ua.merge)({},O,...S)},vi=O=>km(O),km=O=>(0,ua.cloneDeep)(O),Fy=O=>{switch(O){case Gl.HIGHEST_QUALITY:return"highest";case Gl.LOWEST_QUALITY:default:return"lowest"}};var Cp=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};const pd="no-rid";class z0{constructor(S,R,M,P,B,H){this.analyticsTracker=B,this.receiveVideoTransformer=H,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new zr(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=z0.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case at.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case at.FAILED:this.flushStats()}},this.action=S,this.token=R,this.traceId=M,this.identifier=P}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:ro(or)}}set sdpAnswer(S){try{this.sdp=new zr(S),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(S,R=!1){this.peerConnection=S,this.simulcastEnabled=R,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var S;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(S=this.peerConnection)===null||S===void 0||S.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(S){this.sfuResource=S}updateMultihostConfiguration(S,R){var M,P,B,H,te,re;return Cp(this,void 0,void 0,function*(){if(this.action!==dn.PUBLISH||!this.peerConnection)return;const K=z0.defaultMultihostConfiguration();if(R){const se=this.peerConnection.getSenders().filter(pe=>pe.track!==null&&pe.track.kind==="video");se.length>0&&(yield se[0].getStats()).forEach(pe=>{pe.type==="codec"&&(K.video_codec=pe.mimeType)});const he=R.track.getSettings();K.width=(M=he.width)!==null&&M!==void 0?M:0,K.height=(P=he.height)!==null&&P!==void 0?P:0,K.target_fps=(B=he.frameRate)!==null&&B!==void 0?B:0,R.config?(K.max_bitrate=R.config.maxBitrateBps,K.min_bitrate=R.config.minBitrateBps,K.enable_simulcast=R.config.simulcastEnabled):(K.max_bitrate=ro(Mm),K.min_bitrate=ro(Am),K.enable_simulcast=!1)}if(S){const se=S.track.getSettings();K.auto_gain=(H=se.autoGainControl)!==null&&H!==void 0&&H,K.echo_cancellation=(te=se.echoCancellation)!==null&&te!==void 0&&te,K.noise_suppression=(re=se.noiseSuppression)!==null&&re!==void 0&&re,K.max_audio_bitrate_bps=S.config.maxBitrateBps,K.stereo=S.config.stereo}(0,ua.isEqual)(K,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new _x(this.token,this.traceId,K,this.action)),this.multihostConfiguration=K)})}updateJitterBufferMinDelay(S){this.jitterBufferMinDelayInMs=S}setupIntervals(){this.action===dn.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(S,R){return setInterval(S.bind(this),R)}getConnectionState(){var S;if(!this.peerConnection)return at.NONE;const R=(S=this.peerConnection.connectionState)!==null&&S!==void 0?S:this.peerConnection.iceConnectionState;try{return mE(R)}catch{return at.IDLE}}pollSimulcastLayers(){var S;return Cp(this,void 0,void 0,function*(){if(this.getConnectionState()===at.CONNECTED){const R=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();if(!R)return;R.forEach(M=>{var P;if(M.type==="outbound-rtp"){const B=((P=M.framesPerSecond)!==null&&P!==void 0?P:0)!==0;switch(M.rid){case"low":B!==this.simulcastState.low&&(this.simulcastState.low=B,this.analyticsTracker.trackEventNoSharedProps(new U0(this.token,this.traceId,M.rid,B)));break;case"mid":B!==this.simulcastState.mid&&(this.simulcastState.mid=B,this.analyticsTracker.trackEventNoSharedProps(new U0(this.token,this.traceId,M.rid,B)));break;case"hi":B!==this.simulcastState.hi&&(this.simulcastState.hi=B,this.analyticsTracker.trackEventNoSharedProps(new U0(this.token,this.traceId,M.rid,B)))}}})}})}flushStats(){var S;return Cp(this,void 0,void 0,function*(){const R=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();R&&(this.action===dn.PUBLISH?this.uploadPublisherStats(R):this.action===dn.SUBSCRIBE&&this.uploadSubscriberStats(R))})}uploadStats(){var S;return Cp(this,void 0,void 0,function*(){if(this.getConnectionState()===at.CONNECTED){const R=yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats();if(!R)return;this.action===dn.PUBLISH?this.uploadPublisherStats(R):this.action===dn.SUBSCRIBE&&this.uploadSubscriberStats(R)}})}uploadPublisherStats(S){const R={audio:{},video:[]},M=new Map,P=(Date.now()-this.connectionStartedTimestamp)/1e3,B=Object.assign({},this.multihostConfiguration);S.forEach(H=>{if(H.type==="outbound-rtp"){const te=S.get(H.remoteId),re=this.prevRemoteInboundStats.get(H.remoteId);switch(te&&this.prevRemoteInboundStats.set(te.id,te),H.kind){case"audio":R.audio=this.updateOutboundAudio(H),R.audio.remoteInbound=te,R.audio.prevRemoteInbound=re,R.audio.codec=M.get(H.codecId);break;case"video":R.video.push(Object.assign({},this.updateOutboundVideo(H),{remoteInbound:te,prevRemoteInbound:re,codec:M.get(H.codecId)}))}}H.type==="candidate-pair"&&H.nominated&&(R.candidatePair=H),H.type==="codec"&&M.set(H.id,H)}),this.analyticsTracker.trackEventNoSharedProps(new bE(this.token,this.traceId,this.sfuResource,R.audio.outbound,R.audio.remoteInbound,R.candidatePair,R.audio.codec,B,P,this.sdpFeatures)),R.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new L0(this.token,this.traceId,this.sfuResource,R.audio.outbound,R.audio.prevOutbound,R.audio.remoteInbound,R.audio.prevRemoteInbound,R.candidatePair,R.audio.codec,B,this.sdpFeatures)),R.video.forEach(H=>{this.analyticsTracker.trackEventNoSharedProps(new P0(this.token,this.traceId,this.sfuResource,H.outbound,H.remoteInbound,R.candidatePair,H.codec,B,P)),H.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new df(this.token,this.traceId,this.sfuResource,H.outbound,H.prevOutbound,H.remoteInbound,H.prevRemoteInbound,R.candidatePair,H.codec,B))})}uploadSubscriberStats(S){var R;const M={audio:{},video:{}},P=new Map,B=(Date.now()-this.connectionStartedTimestamp)/1e3,H=(R=this.jitterBufferMinDelayInMs)!==null&&R!==void 0?R:0,{seiReadCnt:te,seiBytesRead:re}=this.updateAndDiffSinceLastUpdate(this.receiveVideoTransformer.getReceiverStats());S.forEach(K=>{if(K.type==="inbound-rtp")switch(K.kind){case"audio":M.audio=this.updateInboundAudio(K),M.audio.codec=P.get(K.codecId);break;case"video":M.video=this.updateInboundVideo(K),M.video.codec=P.get(K.codecId)}K.type==="candidate-pair"&&K.nominated&&(M.candidatePair=K),K.type==="codec"&&P.set(K.id,K)}),this.analyticsTracker.trackEventNoSharedProps(new By(this.token,this.traceId,this.identifier,this.sfuResource,M.audio.inbound,M.candidatePair,M.audio.codec,B,this.sdpFeatures)),M.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new qi(this.token,this.traceId,this.identifier,this.sfuResource,M.audio.inbound,M.audio.prevInbound,M.candidatePair,M.audio.codec,this.sdpFeatures,H)),this.analyticsTracker.trackEventNoSharedProps(new Uy(this.token,this.traceId,this.identifier,this.sfuResource,M.video.inbound,M.candidatePair,M.video.codec,B)),M.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new EE(this.token,this.traceId,this.identifier,this.sfuResource,M.video.inbound,M.video.prevInbound,M.candidatePair,M.video.codec,H,te,re))}updateAndDiffSinceLastUpdate(S){const R=this.prevVideoReceiverTransformerStats,M=S.seiReadCnt-R.seiReadCnt,P=S.seiBytesRead-R.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:S.seiReadCnt,seiBytesRead:S.seiBytesRead},{seiReadCnt:M,seiBytesRead:P}}updateOutboundAudio(S){const R=S,M=this.prevOutboundAudioStats,P=S.id===(M==null?void 0:M.id)?M:void 0;return this.prevOutboundAudioStats=S,{outbound:R,prevOutbound:P}}updateInboundAudio(S){const R=S,M=this.prevInboundAudioStats,P=S.id===(M==null?void 0:M.id)?M:void 0;return this.prevInboundAudioStats=S,{inbound:R,prevInbound:P}}updateInboundVideo(S){const R=S,M=this.prevInboundVideoStats.get(pd),P=S.id===(M==null?void 0:M.id)?M:void 0;return this.prevInboundVideoStats.set(pd,S),{inbound:R,prevInbound:P}}updateOutboundVideo(S){const R=S,M=this.getPrevOutboundVideo(S),P=S.id===(M==null?void 0:M.id)?M:void 0;return this.setPrevVideoStat(S),{outbound:R,prevOutbound:P}}getPrevOutboundVideo(S){return this.simulcastEnabled&&S.rid&&this.prevOutboundVideoStats.has(S.rid)?this.prevOutboundVideoStats.get(S.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(pd)?this.prevOutboundVideoStats.get(pd):void 0}setPrevVideoStat(S){this.simulcastEnabled&&S.rid?this.prevOutboundVideoStats.set(S.rid,S):this.simulcastEnabled||this.prevOutboundVideoStats.set(pd,S)}}class _c extends qn{constructor(S,R,M,P,B){super(bn.MINUTE,S,R,!1),Object.assign(this.properties,{action:P?dn.PUBLISH:dn.SUBSCRIBE,is_publishing:P,minutes_logged:M,subscribed_number:B})}}class Ou extends qn{constructor(S){super(bn.PUBLISH,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:S.token.participantID})}}class ff extends qn{constructor(S){super(bn.UNPUBLISH,S.token,S.traceId,!0),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:S.token.participantID})}}class Dm extends qn{constructor(S){var R,M,P,B;super(bn.SUBSCRIBE,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:S.subscribedId,subscribed_id:S.subscribedId,is_edp_connected:S.isEdpConnected,is_reassignment:S.isReassignment,node:(M=(R=S.preAttemptSfuResource)===null||R===void 0?void 0:R.node)!==null&&M!==void 0?M:"",cluster:(B=(P=S.preAttemptSfuResource)===null||P===void 0?void 0:P.cluster)!==null&&B!==void 0?B:""})}}class bx extends qn{constructor(S){super(bn.UNSUBSCRIBE,S.token,S.traceId,!0),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:S.unsubscribedId,unsubscribed_id:S.unsubscribedId})}}class Ex extends qn{constructor(S){var R,M,P,B;super(bn.PUBLISH_STARTED,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,options_duration:S.optionsDuration,post_duration:S.postDuration,remote_participant_id:S.token.participantID,time_to_candidate:S.timeToCandidate,total_duration:S.totalDuration,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(M=(R=S.sfuResource)===null||R===void 0?void 0:R.node)!==null&&M!==void 0?M:"",cluster:(B=(P=S.sfuResource)===null||P===void 0?void 0:P.cluster)!==null&&B!==void 0?B:"",publish_retry_times:S.publishRetries,total_duration_with_retries:S.totalDurationWithRetries})}}class Sx extends qn{constructor(S){super(bn.PUBLISH_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.PUBLISH,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal})}}class Rp extends qn{constructor(S){super(bn.PUBLISH_ENDED,S.token,S.traceId,!0),Object.assign(this.properties,{action:dn.PUBLISH,remote_participant_id:S.token.participantID,unpublish_successful:S.isUnpublishSuccessful,reason:S.reason})}}class Ap extends qn{constructor(S){var R,M,P,B;super(bn.SUBSCRIBE_STARTED,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,options_duration:S.optionsDuration,post_duration:S.postDuration,remote_participant_id:S.remoteParticipantId,time_to_candidate:S.timeToCandidate,total_duration:S.totalDuration,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_initial_state_publishing_count:S.edpInitialStatePublishingCount,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(M=(R=S.sfuResource)===null||R===void 0?void 0:R.node)!==null&&M!==void 0?M:"",cluster:(B=(P=S.sfuResource)===null||P===void 0?void 0:P.cluster)!==null&&B!==void 0?B:"",total_duration_with_retries:S.totalDurationWithRetries,subscribe_retry_times:S.subscribeRetryTimes,is_reassignment:S.isReassignment})}}class xE extends qn{constructor(S){super(bn.SUBSCRIBE_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal,is_reassignment:S.isReassignment})}}class Pm extends qn{constructor(S){super(bn.SUBSCRIBE_ENDED,S.token,S.traceId,!0),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,unsubscribe_successful:S.isUnsubscribeSuccessful,reason:S.reason}),this.critical=!0}}class H0 extends qn{constructor(S){super(bn.STATE_UPDATED,S.token,S.traceId,!1),Object.assign(this.properties,{audio_muted:S.isAudioMuted,is_disconnected:S.isDisconnected,is_publishing:S.isPublishing,other_participant_id:S.otherParticipantId,other_participant_user_id:S.otherParticipantUserId,video_stopped:S.isVideoStopped})}}class Tx extends qn{constructor(S){var R,M,P,B,H;super(bn.FIRST_FRAME,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.SUBSCRIBE,remote_participant_id:S.remoteParticipantId,edp_initial_connect_duration:S.edpInitialConnectDuration,edp_initial_connect_retry_times:S.edpInitialConnectRetries,edp_initial_state_duration:S.edpInitialStateDuration,edp_initial_state_publishing_count:S.edpInitialStatePublishingCount,edp_state_update_count:S.edpStateUpdateCount,sdp_exchange_duration:S.sdpExchangeDuration,sdp_exchange_transport:S.sdpExchangeTransport,set_remote_desc_duration:S.setRemoteDescDuration,peer_connection_duration:S.peerConnectionDuration,node:(M=(R=S.sfuResource)===null||R===void 0?void 0:R.node)!==null&&M!==void 0?M:"",cluster:(B=(P=S.sfuResource)===null||P===void 0?void 0:P.cluster)!==null&&B!==void 0?B:"",video_was_paused:S.videoWasPaused,first_frame_duration:S.firstFrameDuration,total_duration_with_retries:S.totalDurationWithRetries,subscribe_retry_times:S.subscribeRetryTimes,media_type:S.mediaType,configured_jitter_buffer_min_delay_ms:(H=S.currentJitterBufferMinDelayInMs)!==null&&H!==void 0?H:0})}}class zy extends qn{constructor(S){super(bn.EDP_PONG,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol,edp_rtt:S.edpRttMs})}}class j0 extends qn{constructor(S){super(bn.JOIN,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint})}}class ql extends qn{constructor(S){super(bn.JOIN_ATTEMPT,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint})}}class Co extends qn{constructor(S){super(bn.JOIN_ATTEMPT_FAILED,S.token,S.traceId,!1),Object.assign(this.properties,{action:dn.JOIN,event_endpoint:S.eventEndpoint,whip_endpoint:S.whipEndpoint,code:S.code,message:S.message,fatal:S.fatal,nominal:S.nominal,connect_retry_times:S.retryCnt})}}class Nu extends qn{constructor(S){super(bn.EDP_DISCONNECTED,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol}),this.critical=!0}}class Sl extends qn{constructor(S){super(bn.EDP_CONNECTED,S.token,S.traceId,!1),Object.assign(this.properties,{event_endpoint:S.eventEndpoint,protocol:S.protocol,connect_retry_times:S.numRetries}),this.critical=!0}}var V0;(function(O){O.MESSAGE="message",O.RESPONSE="response"})(V0||(V0={}));class dR{constructor(S,R,M){this.token=S,this.analyticsTracker=M,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.latestPingTimestamp=0,this.pongCount=0,this.latestSequenceNumber=0,this.nextConnectionAttempt=0,this.pingInterval=0,this.pongTimeout=0,this.connectTimeout=0,this.beforeUnload=()=>{this.emitter.emit(Tu,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(P,B,H,te,re,K,se,he)=>{var pe;const Ne={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:B,requestId:te,traceId:H,platform:"web",sdk:"1.19.0",whipVersion:vc,content:P,contentType:"application/sdp"}};re&&(Ne.payload.forceNode=re),K&&(Ne.payload.assignmentToken=K),se&&(Ne.payload.multiCodec=se);const Je=f0()===void 0,Ye=f0()||Je;he&&Ye&&(Ne.payload.initialLayerPref=Fy(he)),(pe=this.socket)===null||pe===void 0||pe.send(JSON.stringify(Ne))},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new Nu({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.logger=new no(R,me.SOCKET),this.emitter=new to.EventEmitter,this.connectionAttempts=0,this.sentPing=!1,this.receivedPong=!1,this.traceId=fc(),this.id=`[${xa().value}] `,window.addEventListener("beforeunload",this.beforeUnload)}connect(S,R,M=!1){this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=S,this.traceId=R,M&&!this.connecting&&(window.clearTimeout(this.connectTimeout),this.connectTimeout=window.setTimeout(this.connectTimedOut.bind(this),1e4)),this.attemptConnect(R)}attemptConnect(S){this.traceId=S||fc(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:R,rawToken:M}=this.token;this.connecting=!0,this.closing=!1;try{const P=encodeURIComponent(this.traceId.value);this.socket=this.createWebSocket(`${this.addr}?topic=${R}/publishers&traceid=${P}`,M),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(P){const B=P instanceof Error?P.message:void 0,H=this.createError(Bt.EVENT_PLANE_WS_CREATE_FAILED,B);this.trackJoinFailed(H,this.getRetryCount()),this.emitter.emit(Vl,H)}}send(S){var R;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(S)}`}),this.isReady()?(R=this.socket)===null||R===void 0||R.send(JSON.stringify(S)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const S=this.connecting,R=this.socket&&this.socket.readyState===this.socket.OPEN,M=this.socket&&this.socket.readyState===this.socket.CLOSING,P=this.getRetryCount();if(this.closing=!0,this.connecting=!1,this.cleanPingPongTimeouts(),window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.connectionAttempts=0,this.connectTimeout=0,this.socket){if(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,R)this.trackJoinEnded(),this.emitter.emit(Tu,"intentional-close");else if(S&&!M){const B=this.createError(Bt.OPERATION_ABORTED);this.trackJoinFailed(B,P),this.analyticsTracker.trackError(B),this.emitter.emit(Vl,B)}}}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(S,R){return new WebSocket(S,R)}createError(S,R){return new Ii(Object.assign({action:dn.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:pc.JOIN_RELATED,details:R},S))}on(S,R){this.emitter.on(S,R)}off(S,R){this.emitter.off(S,R)}isReady(){return this.logger.debug({msg:`${this.id}isReady called`}),!!this.socket&&this.socket.readyState===this.socket.OPEN}onMessage(S){this.logger.debug({msg:`${this.id}received message: ${S.data}`});try{const R=JSON.parse(S.data);switch(R.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const M=R.payload.sequenceNumber;M>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&d0()&&this.connectTimeout>0&&this.triggerSocketOpen(R),this.emitter.emit(ky,R),this.latestSequenceNumber=M);break}case"PONG":this.receivedPong=!0,this.pongCount%2==0&&this.analyticsTracker.trackEventNoSharedProps(new zy({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp})),this.pongCount++;break;case"REFRESH":this.emitter.emit(Iy);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(C0,R.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(R0,R.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(uf,R.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(wo,R.payload);break;default:(0,ua.noop)()}}catch(R){this.logger.debug({msg:`onMessage JSON Parse error: ${R}`}),this.emitter.emit(gc,R)}}onError(S){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(S)}`})}onClose(S){if(this.logger.debug({msg:`${this.id}onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.cleanPingPongTimeouts(),this.closing)this.closing=!1;else if(!this.windowUnloading)if(this.connecting){let R=Math.pow(2,this.connectionAttempts-1);R>64&&(R=64),this.logger.debug({msg:`${this.id}reconnecting in ${R} seconds`}),window.clearTimeout(this.nextConnectionAttempt),this.nextConnectionAttempt=window.setTimeout(this.attemptConnect.bind(this),1e3*R);const M=this.createError(Bt.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,`code: ${S==null?void 0:S.code}, reason: ${S==null?void 0:S.reason}, wasClean: ${S==null?void 0:S.wasClean}`);this.trackJoinFailed(M,this.getRetryCount()),this.analyticsTracker.trackError(M)}else{this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(Tu,"unknown");const R=this.createError(Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE,`code: ${S==null?void 0:S.code}, reason: ${S==null?void 0:S.reason}, wasClean: ${S==null?void 0:S.wasClean}`);this.trackJoinEnded(),this.emitter.emit(Vl,R)}}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),d0()?this.connectTimeout=window.setTimeout(()=>{this.triggerSocketOpen()},1e4):this.triggerSocketOpen()}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttempt),window.clearTimeout(this.connectTimeout),this.nextConnectionAttempt=0,this.connectTimeout=0}triggerSocketOpen(S){this.clearConnectionAttemptTimeouts();const R=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(),this.emitter.emit(Xc,{retryCnt:R,traceId:this.traceId,initialStageState:S}),this.pingInterval=window.setInterval(this.ping.bind(this),3e4)}ping(){var S;this.logger.debug({msg:`${this.id}sending PING`});try{this.latestPingTimestamp=performance.now(),(S=this.socket)===null||S===void 0||S.send(JSON.stringify({type:"PING"})),this.sentPing=!0,this.receivedPong=!1,this.pongTimeout&&clearTimeout(this.pongTimeout),this.pongTimeout=window.setTimeout(this.pongTimedOut.bind(this),5e3)}catch(R){const M=R instanceof Error?R.message:void 0,P=this.createError(Bt.EVENT_PLANE_PING_SEND_FAIL,M);this.emitter.emit(Vl,P)}}connectTimedOut(){const S=this.socket&&this.socket.readyState===this.socket.CONNECTING;this.connecting=!1,this.logger.debug({msg:`${this.id}Connect timed out!`});const R=this.createError(Bt.JOIN_TIMED_OUT);S&&this.trackJoinFailed(R,this.getRetryCount()),this.createError(Bt.JOIN_TIMED_OUT),this.emitter.emit(Vl,R),this.close()}pongTimedOut(){if(this.sentPing&&!this.receivedPong){this.logger.debug({msg:`${this.id}Pong timed out!`});const S=this.createError(Bt.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(Vl,S)}}cleanPingPongTimeouts(){this.sentPing=this.receivedPong=!1,window.clearTimeout(this.pongTimeout),window.clearInterval(this.pingInterval)}trackJoinAttempt(S){const{token:R,traceId:M}=this;this.analyticsTracker.trackEvent(new ql({token:R,eventEndpoint:(R==null?void 0:R.eventsURL)||"",whipEndpoint:(R==null?void 0:R.whipURL)||"",traceId:M}))}trackJoinFailed(S,R){const{token:M,traceId:P,code:B,message:H,fatal:te,nominal:re}=S;this.analyticsTracker.trackEvent(new Co({token:M,eventEndpoint:M.eventsURL,whipEndpoint:M.whipURL,traceId:P,code:B,message:H,fatal:te,nominal:re,retryCnt:R}))}trackJoinStarted(){this.analyticsTracker.trackEventNoSharedProps(new Sl({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:this.getRetryCount(),protocol:this.protocol,traceId:this.traceId}))}}var $o=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})},so,Iu,Tl,hs;(function(O){O.SDP_EXCHANGE="xdp",O.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(so||(so={})),function(O){O.USER_INITIATED="user-initiated",O.CLIENT_RECONNECT="reconnect",O.TOKEN_REUSED="token-reused",O.UNKNOWN="unknown",O.PARTICIPANT_DISCONNECTED="participant-disconnected",O.STAGE_DELETED="stage-deleted"}(Iu||(Iu={})),function(O){O[O.NOT_CONNECTED=0]="NOT_CONNECTED",O[O.CONNECTION_LOST=1]="CONNECTION_LOST",O[O.TIMEDOUT=2]="TIMEDOUT",O[O.ABORTED=3]="ABORTED",O[O.INVALID_MESSAGE=4]="INVALID_MESSAGE",O[O.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"}(Tl||(Tl={})),function(O){O.DISCONNECTED="disconnected",O.CONNECTING="connecting",O.CONNECTED="connected",O.ERRORED="errored"}(hs||(hs={}));class wE extends Yc{constructor(S,R,M){super(),this.token=S,this.nonScopedLogger=R,this.analyticsTracker=M,this.participants=new Map,this.disconnected=[],this.state={value:hs.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(P,B)=>{this.logger.debug({msg:"onConnecting",context:P,event:B}),P.connectStartTime=performance.now();const H=B.type==="RECONNECT";H&&this.stageSocket.close();const{eventsURL:te}=this.token;this.emit(bl,hs.CONNECTING),this.state.value=hs.CONNECTING;const re=!H;this.stageSocket.connect(te,this.traceId,re)},this.onConnected=(P,B)=>{this.logger.debug({msg:"onConnected",context:P,event:B}),P.hasConnected=!0,this.emit(xm),this.emit(bl,hs.CONNECTED),this.state.value=hs.CONNECTED},this.onDisconnected=(P,B)=>{this.logger.debug({msg:"onDisconnected",context:P}),this.state.value=hs.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),P.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(bl,hs.DISCONNECTED,B)},this.onErrored=(P,B)=>{this.logger.error({msg:"Connection failure occurred",err:B.payload.error}),this.emit(bl,hs.ERRORED),this.emit(bp,B.payload.error),this.state.value=hs.ERRORED,P.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=P=>{const B=this.state.value,H=this.state.context;switch(B){case hs.DISCONNECTED:P.type==="CONNECT"&&this.onConnecting(H,P);break;case hs.CONNECTING:P.type==="RECONNECT"?this.onConnecting(H,P):P.type==="DISCONNECT"?this.onDisconnected(H,P.reason):P.type==="CONNECT_SUCCESS"?this.onConnected(H,P):P.type==="ERROR"&&this.onErrored(H,P);break;case hs.CONNECTED:P.type==="RECONNECT"?this.onConnecting(H,P):P.type==="DISCONNECT"?this.onDisconnected(H,P.reason):P.type==="ERROR"&&this.onErrored(H,P);break;case hs.ERRORED:P.type==="RECONNECT"?this.onConnecting(H,P):P.type==="DISCONNECT"&&this.onDisconnected(H,P.reason)}},this.measureConnect=(P,B)=>{const H=this.stats.edpConnectCount,te=H+1,re=performance.now(),K=re-B;return Object.assign(this.stats,{edpConnectCount:te,edpConnectDuration:K}),H===0&&Object.assign(this.stats,{edpInitialStartConnectTime:B,edpInitialFinishConnectTime:re,edpInitialConnectDuration:K,edpInitialConnectRetries:P}),this.stats},this.measureStateUpdate=P=>{const{edpInitialFinishConnectTime:B}=this.stats,H=this.stats.edpStateUpdateCount,te=H+1;return Object.assign(this.stats,{edpStateUpdateCount:te}),H===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-B,edpInitialStatePublishingCount:P}),this.stats},this.trackMessageParseError=P=>{this.logger.error({msg:"Message Parse Error occurred",err:P.err});const B=new Ii({token:P.token,traceId:P.traceId,code:Bt.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:P.tag,location:P.location,message:P.message,details:P.err.message});this.analyticsTracker.trackEvent(new _l(B))},this.trackStageSocketMessageParseError=(P,B,H)=>{this.trackMessageParseError({token:P,traceId:B,tag:pc.JOIN_RELATED,location:"StageConnection.onMessage",message:Bt.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:H})},this.trackStageStateMessageParseError=(P,B,H,te)=>{this.trackMessageParseError({token:P,traceId:B,tag:pc.JOIN_RELATED,location:"StageConnection.onStageStateMessage",message:te,err:H})},this.onDisconnectMessage=P=>{this.analyticsTracker.trackEventNoSharedProps(new Rm(this.token,this.traceId,`DISCONNECT message received: ${P.code}:${P.reason}`,dn.JOIN));let B=Iu.UNKNOWN;if(P.code==="PARTICIPANT_DISCONNECTED")B=Iu.PARTICIPANT_DISCONNECTED;else if(P.code==="STAGE_DELETED")B=Iu.STAGE_DELETED;else if(P.code==="TOKEN_REUSED"&&(B=Iu.TOKEN_REUSED,ah("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${P.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:B})},this.onReassignmentMessage=P=>{this.emit(jl,P)},this.onIncompatibleCodecsMessage=P=>{this.emit(lf,P)},this.onStageStateMessage=(P,B,H)=>{var te,re;this.logger.debug({msg:"State Stage Message occurred",state:H});const K=H.payload,se=(te=K.participants)!==null&&te!==void 0?te:[],he=(re=K.disconnected)!==null&&re!==void 0?re:[],pe=[],Ne=[];this.measureStateUpdate(se.length),this.enableFeaturesBasedOnServerFeatures(K.serverFeatures||[]);const Je=(Ye,Oe)=>{this.analyticsTracker.trackEventNoSharedProps(new H0({token:P,otherParticipantId:Ye.id,otherParticipantUserId:Ye.userId,isAudioMuted:Ye.audioMuted,isVideoStopped:Ye.videoStopped,isPublishing:Ye.isPublishing,isDisconnected:Oe,traceId:B}))};this.participants.forEach(Ye=>{const Oe=se.find(_e=>_e.id===Ye.id);if(Oe){let _e=!0,lt=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach(wt=>{_e=_e&&Oe[wt.toString()]===Ye[wt.toString()],_e||(Ye[wt.toString()]=Oe[wt.toString()],lt=!0)}),Object.keys(Ye.attributes).forEach(wt=>{_e=_e&&Oe.attributes[wt]===Ye.attributes[wt],_e||(Ye.attributes=Oe.attributes,lt=!0)}),lt&&(Je(Ye,!1),this.emit(w0,Oe))}else Ne.push(Ye)}),se.forEach(Ye=>{this.participants.get(Ye.id)||pe.push(Ye)}),Ne.forEach(Ye=>{this.participants.delete(Ye.id),Je(Ye,!0),this.emit(ld,Ye)}),pe.forEach(Ye=>{this.participants.set(Ye.id,Ye),Je(Ye,!1),this.emit(cf,Ye)}),he.forEach(Ye=>{this.disconnected.find(Oe=>Oe.id===Ye.id)||(this.disconnected.push(Ye),Ye.status==="KICKED"&&this.emit(ha,Ye))}),this.disconnected=he},this.nonScopedLogger=R,this.logger=new no(R,me.CONNECTION),this.stageSocket=new dR(S,this.nonScopedLogger,M),this.token=S,this.traceId=fc()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(S){return $o(this,void 0,void 0,function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:S}),this.traceId=S,this.state.value!==hs.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:Iu.CLIENT_RECONNECT})),new Promise((R,M)=>{this.stageSocket.on(Xc,P=>{var B,H;const{retryCnt:te,initialStageState:re}=P;re&&this.enableFeaturesBasedOnServerFeatures((H=(B=re.payload)===null||B===void 0?void 0:B.serverFeatures)!==null&&H!==void 0?H:[]),this.traceId=P.traceId||fc(),this.measureConnect(te,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),R(this.traceId)}),this.stageSocket.on(Vl,P=>{M(P),this.processStateUpdate({type:"ERROR",payload:{error:P}})}),this.stageSocket.on(Iy,()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(gx),this.processStateUpdate({type:"RECONNECT"})}),this.stageSocket.on(ky,P=>this.onStageStateMessage(this.token,this.traceId,P)),this.stageSocket.on(gc,P=>this.trackStageSocketMessageParseError(this.token,this.traceId,P)),this.stageSocket.on(R0,this.onDisconnectMessage),this.stageSocket.on(uf,this.onReassignmentMessage),this.stageSocket.on(wo,this.onIncompatibleCodecsMessage),this.stageSocket.on(Tu,P=>{this.stopStageMinuteLoggedInterval()}),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:S}})})})}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:Iu.USER_INITIATED}),this.traceId}getParticipant(S){return this.participants.get(S)}listConnectedParticipants(){const S=[];return this.participants.forEach(R=>{R.subscribed&&S.push(R)}),S}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(S,R){this.stageSocket.send({audioMuted:S,type:"SET_STATE",version:"0",videoStopped:R})}setStagePublishing(S){this.isStagePublishing=S,this.emit(mc,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(S,R){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new _c(S,R,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval(()=>{this.analyticsTracker.trackEvent(new _c(S,R??fc(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++},6e4))}stopStageMinuteLoggedInterval(S=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),S&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(S){const R=(H,te)=>{this.trackStageStateMessageParseError(this.token,this.traceId,te,`Could not parse "${H}" from the Eevee server features list`)},M=S.includes(so.SDP_EXCHANGE);this.features.sdpExchange!==M&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${M}`}),this.features.sdpExchange=M);const P=S.find(H=>H.indexOf(so.JITTER_BUFFER_MIN_DELAY_MS)!==-1),B=H=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${H}`}),this.features.jitterBufferMinDelayInMs=H};if(P!==void 0)try{const H=P.split("=")[1],te=parseInt(H,10);if(isNaN(te))throw new Error("Unable to parse - result is NaN");if(te<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===te||B(te)}catch(H){R(P,H),B(void 0)}else B(void 0)}isConnected(){return this.state.value===hs.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(S,R,M,P,B,H,te,re,K){return $o(this,void 0,void 0,function*(){return this.isConnected()?new Promise((se,he)=>{const pe=window.setTimeout(()=>{Ne(),he(Tl.TIMEDOUT)},8e3),Ne=()=>{window.clearTimeout(pe),this.stageSocket.off(C0,Je),this.stageSocket.off(Vl,Ye)},Je=Oe=>{Oe.requestId===P&&(Ne(),se(Oe))},Ye=()=>{Ne(),he(Tl.CONNECTION_LOST)};B==null||B.addEventListener("abort",()=>{Ne(),he(Tl.ABORTED)}),this.stageSocket.on(C0,Je),this.stageSocket.on(Vl,Ye),this.stageSocket.sendSdpOffer(S,R,M,P,H,te,re,K)}):Promise.reject(Tl.NOT_CONNECTED)})}}class ku{constructor(S){this.token=S}}var CE=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};const Hy={[Tl.ABORTED]:Bt.OPERATION_ABORTED,[Tl.NOT_CONNECTED]:Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Tl.CONNECTION_LOST]:Bt.XDP_CONNECTION_LOST,[Tl.TIMEDOUT]:Bt.XDP_TIMEOUT,[Tl.INVALID_MESSAGE]:Bt.XDP_INVALID_ANSWER_MSG,[Tl.UNEXPECTED_ERROR]:Bt.XDP_UNEXPECTED_ERROR};class RE extends ku{constructor(S,R,M,P){super(S),this.token=S,this.stageConnection=R,this.contextData=M,this.analyticsTracker=P}exchange(S){return CE(this,void 0,void 0,function*(){const R=xa(),{action:M}=this.contextData,{sdpOffer:P,url:B,traceId:H,forceNode:te,assignmentToken:re,multiCodec:K,abortController:se,initialLayerPreference:he}=S;let pe;this.trackAttempt(B,R,H);try{pe=yield this.stageConnection.exchangeSdp(P,B,H.value,R.value,se==null?void 0:se.signal,te,re,K,he)}catch(Kt){if(typeof Kt=="number")throw this.createClientSideErrorFromReasonCode(Kt,H,R,M)}if(!pe)return;const{httpStatusCode:Ne,errorCode:Je,location:Ye,content:Oe,sessionDeleteLink:_e,subscriberControlLink:lt,videoLayersLink:wt}=pe;if(Ne>=200&&Ne<300)return{sdpAnswer:Oe,url:B,location:Ye,sessionDeleteLink:_e,mediaControls:lt,layerControls:wt};throw this.createServerSideError(H,R,Ne,Je,M)})}trackAttempt(S,R,M){const{remoteParticipantId:P,action:B}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new dd(B,this.token,S,"POST",R.value,P,M,"xdp"))}createServerSideError(S,R,M,P,B){const H=this.baseErrorProps(S,R);let te=x0(M,P);return te||(te=Bt.UNKNOWN_SERVER_ERROR),new Ii(Object.assign(Object.assign({action:B},H),te))}baseErrorProps(S,R){const{remoteParticipantId:M,action:P}=this.contextData;return{token:this.token,traceId:S,tag:To(P,M),location:"EdpSdpExchanger.exchange",requestUUID:R,remoteParticipantId:M}}createClientSideErrorFromReasonCode(S,R,M,P){const B=this.baseErrorProps(R,M),H=Hy[S];return new Ii(H?Object.assign(Object.assign({action:P},B),H):Object.assign(Object.assign({action:P},B),Bt.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}const md=new RegExp("^(?:[a-z+]+:)?//","i");function xl(O){return md.test(O)}var li=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class jy extends ku{constructor(S,R,M){super(S),this.contextData=R,this.analyticsTracker=M}exchange(S){return li(this,void 0,void 0,function*(){const R=xa(),{token:M}=this,{action:P,remoteParticipantId:B}=this.contextData,{sdpOffer:H,url:te,traceId:re,forceNode:K,assignmentToken:se,multiCodec:he,abortController:pe,initialLayerPreference:Ne}=S;try{const Ye="POST",Oe="http";this.analyticsTracker.trackEventNoSharedProps(new dd(P,M,te,Ye,R.value,B,re,Oe));const _e={data:H,headers:{Authorization:`Bearer ${M.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":R.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":re.value,"X-Stages-WHIP-Version":vc,"X-Stages-Options":(Je=JSON.stringify({cap:["sau"]}),btoa(Je).replace(/[^A-Za-z0-9+/]/g,""))},method:Ye,responseType:"text",url:te,signal:pe==null?void 0:pe.signal,params:{}};K&&(_e.params.force_node=K),se&&(_e.params.assignment_token=se),he&&(_e.params.multi_codec=!0);const lt=f0()===void 0,wt=f0()||lt;Ne&&_e.headers&&wt&&(_e.headers["X-Stages-Initial-Layer-Pref"]=Fy(Ne));const{data:Kt,headers:It,request:Xn}=yield El(_e),wn=this.parseWhipResource(te,It.location,It.link);return{url:Xn.responseURL,sdpAnswer:Kt,location:wn==null?void 0:wn.location,sessionDeleteLink:wn==null?void 0:wn.sessionDeleteLink,mediaControls:wn==null?void 0:wn.mediaControls,layerControls:wn==null?void 0:wn.layerControls}}catch(Ye){if(Xs().isCancel(Ye))throw new Ii(Object.assign(Object.assign({},_p(Bt.OPERATION_ABORTED,Ye)),{action:P,token:M,traceId:re,tag:To(P,B),location:"StagePeerClient.start",requestUUID:R,remoteParticipantId:B}));const Oe=function(_e,lt){var wt;return _e instanceof Ts.AxiosError&&_e.response&&typeof _e.response.status=="number"?_e instanceof Ts.AxiosError&&_e.code==="ERR_NETWORK"?Bt.NETWORK_FAILURE:x0(Number(_e.response.status),(wt=_e.response.data)===null||wt===void 0?void 0:wt.code)||lt:lt}(Ye,Bt.WHIP_POST_FAILURE);throw new Ii(Object.assign(Object.assign({},_p(Oe,Ye)),{action:P,token:M,traceId:re,tag:To(P,B),location:"StagePeerClient.start",requestUUID:R,remoteParticipantId:B}))}var Je})}parseWhipResource(S,R,M){const P=new URL(S);let B;return B=function(H,te,re){if(!re)return H;if(H||(H={}),xl(re))return H.location=re,H;const K=te.port?`:${te.port}`:"";return H.location=`${te.protocol}//${te.hostname}${K}${re}`,H}(B,P,R),B=function(H,te,re){if(!re)return H;H||(H={});const K=H;return re.split(",").forEach(se=>{const he=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(se);if((he==null?void 0:he.length)!==3)return;let pe;if(xl(he[1]))pe=he[1];else{const Ne=te.port?`:${te.port}`:"";pe=`${te.protocol}//${te.hostname}${Ne}${he[1]}`}switch(he[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":K.sessionDeleteLink=pe;break;case"urn:ietf:params:whep:core:playback-controls":K.mediaControls=pe;break;case"urn:ietf:params:whep:ext:core:layer":K.layerControls=pe;break;default:return}}),K}(B,P,M),B}getTransport(){return"http"}}var ti=r(1564);function wl(O){return O.track.kind===Cu.AUDIO}function G0(O){return O.track.kind===Cu.VIDEO&&typeof O.config=="object"}const AE=(O,S)=>function(R){return R.kind===Cu.AUDIO}(O)?((R,M)=>{var P;const B={maxBitrateBps:ro((P=M==null?void 0:M.maxAudioBitrateKbps)!==null&&P!==void 0?P:64)},H=M==null?void 0:M.stereo;return typeof H=="boolean"&&(B.stereo=H),{track:R,config:B}})(O,S):((R,M)=>{var P,B,H,te;const re=(P=M==null?void 0:M.minBitrate)!==null&&P!==void 0?P:Am,K=(B=M==null?void 0:M.maxBitrate)!==null&&B!==void 0?B:Mm,se=(H=M==null?void 0:M.maxFramerate)!==null&&H!==void 0?H:yc,he=!!(!((te=M==null?void 0:M.simulcast)===null||te===void 0)&&te.enabled);return{track:R,config:{minBitrateBps:ro(re),maxBitrateBps:ro(K),maxFramerate:se,simulcastEnabled:he,inBandMessagingEnabled:!1}}})(O,S),Fa=(O,S)=>{if(typeof O=="number")return O;const R=S?I0:vx;return R[O]!==void 0?R[O]:0};function Mp(O){if(O<Am||O>Mm)throw new Error(`Stage bitrate must be between ${Am} kbps and ${Mm} kbps`)}function xx(O,S){const R=yE();let M=Object.assign({},R,(0,ua.cloneDeep)(S));return M=function(P,B){var H,te,re;const K=Object.assign({},(0,ua.cloneDeep)(B)),se=!us.browser.isChrome()&&!us.browser.isEdge(),he=(re=(te=(H=P.getSettings)===null||H===void 0?void 0:H.call(P))===null||te===void 0?void 0:te.displaySurface)!==null&&re!==void 0&&re,pe=ro(K.maxBitrate)<Im.maxBitrate;return(se||he||pe)&&(K.simulcast.enabled=!1),K}(O,M),Mp(M.maxBitrate),Mp(M.minBitrate),function(P){if(P&&(P>yc||P<Py))throw new Error(`framerate cannot exceed ${yc} fps`)}(M.maxFramerate),function(P){if(P<N0||P>or)throw new Error(`Stage audio bitrate must be between ${N0} kbps and ${or} kbps`)}(M.maxAudioBitrateKbps),function(P){if(typeof P!="boolean")throw new Error("Stage stereo prop must be a boolean")}(M.stereo),M}function ME({stageErrorValue:O,action:S,token:R,traceId:M,tag:P,identifier:B,details:H}){return new Ii(Object.assign(Object.assign({},O),{token:R,traceId:M,location:"peer-client",tag:P,action:S,remoteParticipantId:B,details:H}))}var Os;function Wo(O){var S;return!((S=O==null?void 0:O.sender)===null||S===void 0)&&S.createEncodedStreams?Os.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?Os.ENCODED_TRANSFORMS:Os.NONE}function Vy(O){var S;return!((S=O==null?void 0:O.receiver)===null||S===void 0)&&S.createEncodedStreams?Os.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?Os.ENCODED_TRANSFORMS:Os.NONE}function OE(O){let S=[];const R=new Map;function M(P){const B="0123456789abcdef";let H="";for(let te=0;te<P;te+=1)H+=B.charAt(Math.floor(Math.random()*B.length));return H}return{add(P){const B=M,H=`${B(8)}-${B(4)}-${B(4)}-${B(4)}-${B(12)}`,te=Date.now();return S.push({id:H,enqueuedAt:te,payload:P}),H},poll(P){return R.has(P)||R.set(P,[]),R.size>=O&&(R.forEach(B=>{B.push(...S)}),S=[]),(R.get(P)||[]).splice(0,1)}}}function fR(O,S){return S.type==="sei"?function(R,M){const te=new Uint8Array([1,2,1,8,1,2,3,4,2,2,2,4,4,3,2,1]);function re(he,pe,Ne){return Ne+pe.length<=he.byteLength&&pe.every((Je,Ye)=>he.getUint8(Ne+Ye)===Je)}function K(he,pe){const Ne=function(Ye,Oe){return new Uint8Array([0,0,1,6,5,...Oe,...Ye])}(he,function(Ye){const Oe=[];for(;Ye>=255;)Oe.push(255),Ye-=255;return Oe.push(Ye),new Uint8Array(Oe)}(pe.length+he.length)),Je=function(Ye){const Oe=[...Ye];let _e=3;for(;_e<Oe.length-2;)Oe[_e]!==0||Oe[_e+1]!==0||Oe[_e+2]!==0&&Oe[_e+2]!==1&&Oe[_e+2]!==2&&Oe[_e+2]!==3?_e+=1:(Oe.splice(_e+2,0,3),_e+=3);return Oe}(new Uint8Array([...Ne,...pe,128]));return new Uint8Array(Je)}function se(he,pe){const Ne=function(Je){const Ye=new DataView(Je);for(let Oe=0;Oe<Ye.byteLength-4;Oe++)if(re(Ye,[0,0,1],Oe)){const _e=31&Ye.getUint8(Oe+3);if(_e>=1&&_e<=5)return Oe}return-1}(R.data);if(Ne>=0){const Je=new ArrayBuffer(R.data.byteLength+pe.byteLength),Ye=new Uint8Array(Je);return Ye.set(new Uint8Array(R.data.slice(0,Ne)),0),Ye.set(pe,Ne),Ye.set(new Uint8Array(R.data.slice(Ne)),Ne+pe.byteLength),Je}return he}return function(){for(let he=0;he<M.length;he+=1){const pe=K(te,new Uint8Array(M[he]));R.data=se(R.data,pe)}return R}()}(O,S.payloads||[]):O}function q0(O,S){const{type:R,transformerId:M}=S;if(R==="sei"){const P=function(te){function se(Ne,Je,Ye){return Ye+Je.length<Ne.byteLength&&Je.every((Oe,_e)=>Ne.getUint8(Ye+_e)===Oe)}function he(Ne){const Je=[];let Ye=0;for(;Ye<Ne.length;)Ne[Ye]===0&&Ne[Ye+1]===0&&Ne[Ye+2]===3?(Je.push(Ne[Ye]),Je.push(Ne[Ye+1]),Ye+=3):(Je.push(Ne[Ye]),Ye+=1);return new Uint8Array(Je)}function pe(Ne){let Je=2;const Ye=Ne.byteLength;for(;Je<Ye;){let Oe=0;for(;Je<Ye&&Ne[Je]===255;)Oe+=255,Je++;Oe+=Ne[Je],Je++;const _e=Math.min(Je+Oe,Ye),lt=new Uint8Array(Ne.slice(Je,_e));return{uuid:lt.slice(0,16),payload:lt.slice(16)}}}return{messages:function(Ne){const Je=new DataView(Ne.data),Ye=[];let Oe=0;if(!se(Je,[0,0,1],0)&&!se(Je,[0,0,0,1],0))return[];for(;Oe<Je.byteLength-5;)if(se(Je,[0,0,1],Oe)){const _e=Oe+3;Oe=_e;const lt=31&Je.getUint8(Oe),wt=31&Je.getUint8(Oe+1);if(lt===6&&wt===5){for(;Oe<Je.byteLength&&!se(Je,[0,0,1],Oe);)Oe++;const Kt=Oe,It=pe(he(new Uint8Array(Ne.data.slice(_e,Kt))));It&&Ye.push(Object.assign(Object.assign({},It),{timestamp:Ne.timestamp,type:Ne.type}))}else Oe++}else Oe++;return Ye}(te),frame:te}}(O),{frame:B,messages:H}=P;return{success:!0,frame:B,type:R,transformerId:M,seiResult:H}}return{success:!0,frame:O,transformerId:M,type:R}}function wx(){let O;const S=P=>(B,H)=>{const te=B.getMetadata().synchronizationSource,re=(O?O.poll(te):[]).map(K=>K.payload);H.enqueue("<SEND_TRANSFORMER_IMPL>"(B,Object.assign(Object.assign({},P),{payloads:re})))},R=P=>(B,H)=>{try{const te="<RECEIVE_TRANSFORMER_IMPL>"(B,P);H.enqueue(te.frame),self.postMessage(Object.assign(Object.assign({success:te.success},P),{seiResult:te.seiResult}))}catch{self.postMessage(Object.assign({success:!1},P))}};function M(P,B,H,te){const re=new TransformStream({transform:P==="video/send"?S(B):R(B)});H.pipeThrough(re).pipeTo(te)}return self.onrtctransform=P=>{const B=P.transformer;B&&M(B.options.method,B.options,B.readable,B.writable)},self.onmessage=P=>{var B;const{operation:H,transformerId:te}=P.data;H==="insert"?(O||(O="<CREATE_MESSAGE_QUEUE>"(1)),O.add((B=P.data)===null||B===void 0?void 0:B.payload)):H!=="video/receive"&&H!=="video/send"||M(H,{method:H,transformerId:te,type:"sei"},P.data.readable,P.data.writable)},{videoReceiveTransform:R,videoSendTransform:S}}(function(O){O.NONE="none",O.ENCODED_TRANSFORMS="encodedTransforms",O.INSERTABLE_STREAMS="insertableStreams"})(Os||(Os={}));const Cx=()=>{let O=wx.toString();return O=O.replace('"<SEND_TRANSFORMER_IMPL>"',fR.toString()),O=O.replace('"<RECEIVE_TRANSFORMER_IMPL>"',q0.toString()),O=O.replace('"<CREATE_MESSAGE_QUEUE>"',OE.toString()),O},Lm=(()=>{let O;return{getWorker:()=>(O||(O=function(){const S=new Blob([`(${Cx()})()`],{type:"text/javascript"}),R=URL.createObjectURL(S);return new Worker(R)}()),O),destroy:()=>{O&&O.terminate(),O=void 0}}})(),NE="seiMessageReceived",$0="error";var Jc;(function(O){O.CREATED="created",O.INITIALIZED="initialized",O.DESTROYED="destroyed"})(Jc||(Jc={}));class Um extends Yc{constructor({enabled:S}){super(),this.state=Jc.CREATED,this.transformerId=xa().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=R=>{this.onTransformResult(R.data)},S||this.destroy()}initializeInsertableStreams(S){var R;this.worker=Lm.getWorker();const M=S.receiver.createEncodedStreams(),{readable:P,writable:B}=M;(R=this.worker)===null||R===void 0||R.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:P,writable:B},[P,B]),this.worker.addEventListener("message",this.onMessage)}initializeEncodedTransforms(S){this.worker=Lm.getWorker();const R={method:"video/receive",type:"sei",transformerId:this.transformerId};S.receiver.transform=new RTCRtpScriptTransform(this.worker,R),this.worker.addEventListener("message",this.onMessage)}initialize(S,R){if(this.state!==Jc.CREATED)return!1;const M=Vy(S);if(M===Os.NONE)return!1;if(R&&M===Os.INSERTABLE_STREAMS)this.initializeInsertableStreams(S);else{if(R||M!==Os.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(S)}return this.transceiver=S,this.state=Jc.INITIALIZED,!0}onTransceiverAdd(S){return this.initialize(S,!0)}onTrackEvent(S){return S.track.kind==="video"&&this.initialize(S.transceiver,!1)}static isSupported(S){return Vy(S)!==Os.NONE}onTransformResult(S){return S.transformerId===this.transformerId&&(S.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!S.seiResult&&(S.seiResult.forEach(R=>{const{payload:M,uuid:P}=R;this.updateReadStats(R),this.emit(NE,{uuid:P,payload:M})}),S.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(S,Bt.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(S,Bt.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(S){this.seiReadCnt++,this.seiBytesRead+=S.payload.byteLength}getReceiverStats(){const{seiBytesRead:S,seiReadCnt:R}=this;return{seiReadCnt:R,seiBytesRead:S}}onError(S,R){const{type:M}=S;this.emit($0,{type:M,stageErrorValue:R})}destroy(){var S,R;this.state!==Jc.DESTROYED&&(this.removeAllListeners(),(S=this.worker)===null||S===void 0||S.removeEventListener("message",this.onMessage),!((R=this.transceiver)===null||R===void 0)&&R.receiver&&(this.transceiver.receiver.transform=null),this.state=Jc.DESTROYED)}getState(){return this.state}}class Gy{constructor({enabled:S}){this.state=Jc.CREATED,this.transformerId=xa().value,S||this.destroy()}initializeInsertableStreams(S,R){var M;this.worker=Lm.getWorker();const P=S.sender.createEncodedStreams(),{readable:B,writable:H}=P;(M=this.worker)===null||M===void 0||M.postMessage({operation:"video/send",transformerId:this.transformerId,readable:B,writable:H},[B,H])}initializeEncodedTransforms(S,R){this.worker=Lm.getWorker();const M={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:R};S.sender.transform=new RTCRtpScriptTransform(this.worker,M)}initialize(S){var R;if(this.state!==Jc.CREATED)return!1;const M=Wo(S);if(M===Os.NONE)return!1;const P=S.sender.getParameters(),B=((R=P==null?void 0:P.encodings)===null||R===void 0?void 0:R.length)||1;if(M===Os.INSERTABLE_STREAMS)this.initializeInsertableStreams(S,B);else{if(M!==Os.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(S,B)}return this.transceiver=S,this.state=Jc.INITIALIZED,!0}static isSupported(S){return Wo(S)!==Os.NONE}sendSeiMessage(S){var R;this.state===Jc.INITIALIZED&&this.transceiver&&((R=this.worker)===null||R===void 0||R.postMessage({operation:"insert",transformerId:this.transformerId,payload:S}))}onTransceiverAdd(S){return this.initialize(S)}onTrackEvent(S){return!1}destroy(){var S;this.state!==Jc.DESTROYED&&(!((S=this.transceiver)===null||S===void 0)&&S.receiver&&(this.transceiver.receiver.transform=null),this.state=Jc.DESTROYED)}getState(){return this.state}}var za=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};let Bm=null;class W0 extends Yc{constructor(S,R,M,P,B,H,te,re,K){var se,he;if(super(),this.analyticsTracker=H,this.sfuResource={node:"",cluster:""},this.stageCapabilities={simulcastNegotiated:!1},this.incompatibleCodecs=new Set,this.connect=({audioOnly:pe=!1,traceId:Ne,iceRestartOptions:Je})=>za(this,void 0,void 0,function*(){const{token:Ye,tag:Oe,identifier:_e,action:lt}=this,wt=!!Je,Kt=new AbortController;let It,Xn,wn;this.abortController=Kt,this.traceId=Ne,this.perfTracker.resetMeasurements(Ne);const yi=()=>{It&&this.off(od,It),Xn&&this.off(Ys,Xn)},Fi=new Promise((ki,xi)=>{const _i=function({action:bi,token:Ai,traceId:ui,tag:Tn,identifier:$n}){const $i=bi===dn.SUBSCRIBE?Bt.SUBSCRIBE_TIMED_OUT:Bt.PUBLISH_TIMED_OUT;return new Ii(Object.assign(Object.assign({},$i),{action:bi,token:Ai,traceId:ui,tag:Tn,location:"connect",remoteParticipantId:$n}))}({action:lt,token:Ye,traceId:Ne,tag:Oe,identifier:_e}),Ri=function({action:bi,token:Ai,traceId:ui,tag:Tn}){const $n=Bt.OPERATION_ABORTED;return new Ii(Object.assign(Object.assign({},$n),{token:Ai,traceId:ui,location:"peer-client.connect",tag:Tn,action:bi}))}({action:lt,token:Ye,traceId:Ne,tag:Oe}),Di=setTimeout(()=>{this.stop(),this.analyticsTracker.trackError(_i),xi(_i)},1e4);It=bi=>{clearTimeout(Di),wt||this.stop(),xi(bi)},Xn=bi=>{if(bi===at.CONNECTED)clearTimeout(Di),ki();else if(bi===at.FAILED){const Ai=function({action:ui,token:Tn,traceId:$n,tag:$i}){return new Ii(Object.assign(Object.assign({},Bt.PEER_CONNECTION_NETWORK_FAILURE),{token:Tn,traceId:$n,location:"peer-client.connect",tag:$i,action:ui}))}({action:lt,token:Ye,traceId:Ne,tag:Oe});clearTimeout(Di),xi(Ai)}},this.on(od,It),this.on(Ys,Xn),wn=()=>{clearTimeout(Di)},Kt.signal.aborted&&(clearTimeout(Di),xi(Ri)),Kt.signal.addEventListener("abort",()=>{clearTimeout(Di),xi(Ri)})});try{const ki=yield Promise.all([za(this,void 0,void 0,function*(){wt||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(pe));const _i=Je==null?void 0:Je.assignmentToken,Ri=Je==null?void 0:Je.nodeOverride;return yield this.exchangeSdp({iceRestart:wt,nodeOverride:Ri,assignmentToken:_i,abortController:Kt}),this.mediaStream}),Fi]);this.statsReporter.traceId=Ne;const xi=ki[0];if(this.abortController=void 0,!wt&&lt===dn.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(_i){this.logger.error({err:_i,msg:"error syncing transceivers"})}return{mediaStream:xi}}catch(ki){throw wn&&wn(),ki}finally{yi()}}),this.disconnect=(pe=!1)=>za(this,void 0,void 0,function*(){var Ne;const{token:Je,action:Ye}=this;(Ne=this.abortController)===null||Ne===void 0||Ne.abort(),this.stop(),pe?this.cleanup(Ye,Je.participantID,Je,pe):yield this.cleanup(Ye,Je.participantID,Je,pe)}),this.onTrack=pe=>{const{token:Ne,action:Je,traceId:Ye,identifier:Oe}=this;this.trace(Ne,Ye,`onTrack: ${pe.track.kind}`,Je,Oe),this.videoSenderTransformer.onTrackEvent(pe),this.videoReceiverTransformer.onTrackEvent(pe)},this.onIceGatheringStateChange=()=>{var pe,Ne,Je;const{token:Ye,action:Oe,traceId:_e,identifier:lt}=this;if(((pe=this.peerConnection)===null||pe===void 0?void 0:pe.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((Ne=this.peerConnection)===null||Ne===void 0?void 0:Ne.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const wt=this.peerConnection.iceGatheringState,Kt=new O0(Oe,Ye,_e,wt,lt);this.analyticsTracker.trackEventNoSharedProps(Kt)}this.trace(Ye,_e,`ICE gathering state change: ${(Je=this.peerConnection)===null||Je===void 0?void 0:Je.iceGatheringState}`,Oe,lt)},this.onSelectedCandidatePairChange=()=>{var pe,Ne;const{token:Je,action:Ye,traceId:Oe,identifier:_e}=this,lt=(Ne=(pe=this.peerConnection)===null||pe===void 0?void 0:pe.getReceivers()[0].transport)===null||Ne===void 0?void 0:Ne.iceTransport,wt=lt==null?void 0:lt.getSelectedCandidatePair();if(wt){const{local:Kt,remote:It}=wt,Xn=`Selected candidate pair change (local, remote): ${Kt==null?void 0:Kt.candidate}, ${It==null?void 0:It.candidate}`;this.logger.debug({msg:Xn}),this.trace(Je,Oe,Xn,Ye,_e)}},this.onIceCandidate=pe=>za(this,void 0,void 0,function*(){var Ne,Je;const{identifier:Ye,action:Oe,traceId:_e}=this,lt=(Ne=pe.target.localDescription)===null||Ne===void 0?void 0:Ne.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new Rm(this.token,_e,`ice candidate: hasRelay = ${lt}, candidate = ${(Je=pe.candidate)===null||Je===void 0?void 0:Je.candidate}`,Oe,Ye))}),this.onMute=()=>za(this,void 0,void 0,function*(){const{token:pe,action:Ne,traceId:Je,identifier:Ye}=this;this.trace(pe,Je,"Track has muted",Ne,Ye)}),this.onUnMute=()=>za(this,void 0,void 0,function*(){const{token:pe,action:Ne,traceId:Je,identifier:Ye}=this;this.trace(pe,Je,"Track has unmuted",Ne,Ye)}),this.fetchAndSetRemoteDescription=pe=>za(this,void 0,void 0,function*(){var Ne,Je,Ye,Oe;const _e=(Je=(Ne=this.peerConnection)===null||Ne===void 0?void 0:Ne.localDescription)===null||Je===void 0?void 0:Je.sdp;_e||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:lt,traceId:wt,action:Kt,identifier:It,tag:Xn}=this,{endpointURL:wn,nodeOverride:yi,assignmentToken:Fi,multiCodec:ki,abortController:xi}=pe;let _i;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{this.perfTracker.setTransport(this.sdpExchanger.getTransport());const ui=yi||rd("node")||rd("dataPlaneEndpoint");_i=yield this.sdpExchanger.exchange({sdpOffer:_e,url:wn,traceId:wt,forceNode:ui,assignmentToken:Fi,multiCodec:ki,abortController:xi,initialLayerPreference:(Ye=this.simulcastSubscribeConfig)===null||Ye===void 0?void 0:Ye.initialLayerPreference})}catch(ui){let Tn=ui;Tn instanceof Ii||(Tn=new Ii(Object.assign(Object.assign({},Bt.UNEXPECTED_ERROR),{action:Kt,token:lt,traceId:wt,tag:Xn,details:ui instanceof Error?ui.message:"",location:"sdp-exchange"}))),Tn instanceof Ii&&(this.analyticsTracker.trackError(Tn),this.emit(od,Tn))}if(this.perfTracker.markSdpExchangeStop(),!_i)return;const{location:Ri,sessionDeleteLink:Di,mediaControls:bi}=_i;let Ai=_i.sdpAnswer;try{Ai=this.mungeSdpAnswer(Ai),_i.sdpAnswer=Ai}catch(ui){this.logger.error({err:ui,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=Ai,this.emit(g0,_i),Ri&&(this.whipResource={location:Ri,sessionDeleteLink:Di,mediaControls:bi},this.sfuResource=function(ui){const Tn=ui.match(/https:\/\/([^/]+)\//);if(Tn){const $n=Tn[1].split(".");if($n[0].includes("video-rtx"))return{node:`${$n[0]}.${$n[1]}`,cluster:$n[1]}}}(Ri)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(Oe=this.peerConnection)===null||Oe===void 0?void 0:Oe.setRemoteDescription({sdp:Ai,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(ui){const Tn=new Ii(Object.assign(Object.assign({},Bt.SET_ANSWER_FAILURE),{action:Kt,token:lt,traceId:wt,tag:To(Kt,It),location:"setRemoteDescription",remoteParticipantId:It,details:ui instanceof Error?ui.message:""}));this.analyticsTracker.trackError(Tn),this.emit(od,Tn)}}),this.cleanup=(pe,Ne,Je,Ye=!1)=>za(this,void 0,void 0,function*(){var Oe,_e,lt;const wt=xa();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,!(!((Oe=this.whipResource)===null||Oe===void 0)&&Oe.location))return this.trace(Je,this.traceId,"whipResource location not known, exiting cleanup",pe,Ne),void this.analyticsTracker.trackError(new Ii(Object.assign(Object.assign({},Bt.WHIP_URL_MISSING),{action:pe,token:Je,traceId:this.traceId,tag:To(pe,Ne),location:pe===dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})));let Kt=this.whipResource.location;if(this.trace(Je,this.traceId,`use hostnamecachedurl: ${Kt}`,pe,Ne),Ye){if(!((lt=this.whipResource)===null||lt===void 0)&&lt.sessionDeleteLink){Kt=this.whipResource.sessionDeleteLink,this.trace(Je,this.traceId,`DELETE via session-delete beacon path: ${Kt}`,pe,Ne);try{navigator.sendBeacon(Kt,JSON.stringify({authorization:Je.rawToken}))}catch(It){this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},_p(Bt.WHIP_DELETE_FAILURE,It)),{action:pe,token:Je,traceId:this.traceId,tag:To(pe,Ne),location:dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})))}}}else try{yield Xs().delete(Kt,{headers:{Authorization:`Bearer ${Je.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":wt.value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":vc}})}catch(It){((_e=It.response)===null||_e===void 0?void 0:_e.status)===404?this.trace(Je,this.traceId,`DELETE returned 404, ignoring, action = ${pe}, uuid = ${wt.value}`,pe,Ne):this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},_p(Bt.WHIP_DELETE_FAILURE,It)),{action:pe,token:Je,traceId:this.traceId,tag:To(pe,Ne),location:dn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:wt,remoteParticipantId:Ne})))}}),this.getConnectionState=()=>{if(!this.peerConnection)return at.NONE;const pe=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return mE(pe)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:pe}),at.IDLE}},this.onIceCandidateError=pe=>{const{token:Ne,traceId:Je,tag:Ye}=this;if(pe.errorCode!==701){const Oe=new Ii(Object.assign(Object.assign({},Bt.ICE_CANDIDATE_ERROR),{action:this.action,token:Ne,traceId:Je,tag:Ye,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(Oe),this.emit(od,Oe)}},this.onIceConnectionStateChange=()=>{var pe;const{token:Ne,traceId:Je,action:Ye,identifier:Oe}=this;this.trace(Ne,Je,`ICE connection state change: ${(pe=this.peerConnection)===null||pe===void 0?void 0:pe.iceConnectionState}`,Ye,Oe),this.onConnectionStateChange()},this.createVideoReceiverTransformer=({enabled:pe})=>{const Ne=new Um({enabled:pe}),{token:Je,tag:Ye,identifier:Oe,action:_e,traceId:lt}=this;Ne.on(NE,It=>{this.emit(vp,It)});const wt=function(It,Xn){let wn=0;return function(...yi){const Fi=Date.now();Fi-wn>=Xn&&(wn=Fi,It(...yi))}}(It=>{const Xn=`Transform error occurred: ${It.type}`,wn=ME({traceId:lt,token:Je,tag:Ye,identifier:Oe,action:_e,details:Xn,stageErrorValue:Bt.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:wn,msg:"Error encountered when transforming receiver",error:It})},1e3),Kt=It=>{const Xn=`Too many errors occurred: ${It.type}`,wn=ME({traceId:lt,token:Je,tag:Ye,identifier:Oe,action:_e,details:Xn,stageErrorValue:Bt.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:wn,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:It}),Ne.destroy(),this.analyticsTracker.trackError(wn),this.emit(ft,wn)};return Ne.on($0,It=>{It.stageErrorValue.code!==Bt.TRANSFORM_TOO_MANY_ERRORS.code?wt(It):Kt(It)}),Ne},this.onConnectionStateChange=()=>{var pe;if(this.peerConnection){const Je=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:Ye,traceId:Oe,identifier:_e,action:lt}=this,wt=new Ba(lt,Ye,Oe,Je,_e);this.analyticsTracker.trackEventNoSharedProps(wt),this.trace(Ye,Oe,`connection state change: ${Je}`,lt,_e)}const Ne=this.getConnectionState();switch(Ne){case at.CONNECTED:this.perfTracker.markActionStop(),this.emit(Ys,Ne),this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub),(pe=this.peerConnection)===null||pe===void 0||pe.getTransceivers().forEach(Je=>{var Ye,Oe;!((Oe=(Ye=Je.receiver)===null||Ye===void 0?void 0:Ye.transport)===null||Oe===void 0)&&Oe.iceTransport&&Je.receiver.transport.iceTransport.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)});break;case at.FAILED:this.emit(Ys,Ne),this.handleConnectionFailure();break;default:this.emit(Ys,Ne)}},this.onIncompatibleCodecs=pe=>za(this,void 0,void 0,function*(){if(pe.forEach(Ye=>{let Oe=!1;this.incompatibleCodecs.forEach(_e=>{_e.config===Ye.config&&_e.mime===Ye.mime&&(Oe=!0)}),Oe||this.incompatibleCodecs.add(Ye)}),this.peerConnection)try{yield(Ne=this.peerConnection,Je=[...this.incompatibleCodecs],_E(void 0,void 0,void 0,function*(){var Ye;for(const Oe of Ne.getSenders()){const _e=Oe.getParameters();if(_e.codecs.length>1){const lt=_e.codecs[0];let wt=!1;for(const Kt of Je)fh(lt,Kt)&&(wt=!0);if(wt){const Kt=D0(Je,_e.codecs);(Ye=_e.encodings)===null||Ye===void 0||Ye.forEach(It=>{It.active&&(It.codec=Kt)}),yield Oe.setParameters(_e)}}}}))}catch(Ye){const{token:Oe,action:_e,traceId:lt,identifier:wt}=this,Kt=new Ii(Object.assign(Object.assign({},Bt.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:_e,token:Oe,traceId:lt,tag:To(_e,wt),location:"onIncompatibleCodecs",remoteParticipantId:wt,details:Ye instanceof Error?Ye.message:""}));this.analyticsTracker.trackError(Kt),this.emit(od,Kt)}var Ne,Je}),this.token=S,this.logger=new no(R,me.WEBRTC),this.action=M,this.tag=P,this.traceId=B,M===dn.SUBSCRIBE&&!te)throw new Error("Subscribe action provided without subscriber Id");this.inBandMessagingEnabled=M===dn.SUBSCRIBE?!!(!((se=K==null?void 0:K.inBandMessaging)===null||se===void 0)&&se.enabled):(he=ah("enableInBandMessaging"))!==null&&he!==void 0&&he,this.jitterBufferConfig=K==null?void 0:K.jitterBuffer,this.simulcastSubscribeConfig=K==null?void 0:K.simulcast,this.subscriberId=te,this.stageConnection=re,this.videoSenderTransformer=new Gy({enabled:this.action===dn.PUBLISH&&this.inBandMessagingEnabled}),this.videoReceiverTransformer=this.createVideoReceiverTransformer({enabled:this.action===dn.SUBSCRIBE&&this.inBandMessagingEnabled}),this.perfTracker=new vE(this.action,this.traceId),this.statsReporter=new z0(M,S,B,this.identifier,this.analyticsTracker,this.videoReceiverTransformer),this.sdpExchanger=function(pe){const{connection:Ne,token:Je,action:Ye,identifier:Oe,tracker:_e}=pe,lt=Ne&&Ne.supportsSdpExchange(),wt=Ye===dn.SUBSCRIBE&&lt&&!wy(),Kt=Ye===dn.PUBLISH&&lt&&d0()&&!wy();return wt||Kt?new RE(Je,Ne,{action:Ye,remoteParticipantId:Oe},_e):new jy(Je,{action:Ye,remoteParticipantId:Oe},_e)}({connection:re,action:M,token:S,identifier:this.identifier,tracker:H}),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var S,R;return(R=(S=this.videoTransceiver)===null||S===void 0?void 0:S.mid)!==null&&R!==void 0?R:null}toggleStageConnectionListeners(S){var R,M;S?(R=this.stageConnection)===null||R===void 0||R.on(mc,this.handlePublishingChangedBinding):(M=this.stageConnection)===null||M===void 0||M.off(mc,this.handlePublishingChangedBinding)}updateSubscribeConfig(S){var R,M;this.jitterBufferConfig=S.jitterBuffer,this.simulcastSubscribeConfig=S.simulcast,this.action===dn.SUBSCRIBE&&(this.inBandMessagingEnabled=S.inBandMessaging.enabled),this.applyJitterBufferMinDelayConditionally((M=(R=this.stageConnection)===null||R===void 0?void 0:R.getIsStagePublishing())!==null&&M!==void 0&&M)}verifyOrUpdateTransceiverSync(){var S,R;return za(this,void 0,void 0,function*(){if(this.videoTrackForPub){const M=this.getTransceiverForKind("video");M?this.videoTrackForPub.track.id!==((S=M.sender.track)===null||S===void 0?void 0:S.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateTrack(this.videoTrackForPub)):this.logger.warn({msg:"missing transceiver for video"})}if(this.audioTrackForPub){const M=this.getTransceiverForKind("audio");M?this.audioTrackForPub.track.id!==((R=M.sender.track)===null||R===void 0?void 0:R.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateTrack(this.audioTrackForPub)):this.logger.warn({msg:"missing transceiver for audio"})}})}start(){var S,R,M;return za(this,void 0,void 0,function*(){const{token:P,action:B,traceId:H,identifier:te}=this;B!==dn.PUBLISH||P.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new Ii(Object.assign(Object.assign({},_p(Bt.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:B,token:P,traceId:H,tag:To(B,te),location:"StagePeerClient.start",remoteParticipantId:te})));const re=function({action:K,identifier:se,token:he,analyticsTracker:pe}){let Ne="";const Je=xu(he,pe);switch(K){case dn.PUBLISH:Ne=Je.getPublishEndpoint();break;case dn.SUBSCRIBE:se&&(Ne=Je.getSubscribeEndpoint(se))}return Ne}({action:B,identifier:te,token:P.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.stageCapabilities={simulcastNegotiated:(M=(R=(S=this.videoTrackForPub)===null||S===void 0?void 0:S.config)===null||R===void 0?void 0:R.simulcastEnabled)!==null&&M!==void 0&&M},this.endpointURL=re,this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,this.stageCapabilities.simulcastNegotiated),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute),this.trace(P,H,"peer connection created",B,te)}catch(K){const se=new Ii(Object.assign(Object.assign({action:B},_p(Bt.CREATE_PEER_CONNECTION_FAILURE,K)),{token:P,traceId:H,tag:To(B,te),location:"StagePeerClient.start",remoteParticipantId:te}));B===dn.PUBLISH&&this.emit(Ys,at.FAILED),this.emit(od,se),this.analyticsTracker.trackErrorAndThrow(se)}})}mungeSdpOffer(S,R,M){if(M.simulcastNegotiated&&(S=new zr(S).withVideoLayersAllocationRtpHeaderExtension().sdp),R===dn.SUBSCRIBE)S=new zr(S).withOpusAudioConfig(ro(or),!0).sdp;else if(R===dn.PUBLISH&&M.audioConfig){const{maxBitrateBps:P,stereo:B}=M.audioConfig;S=new zr(S).withOpusAudioConfig(P,B).sdp}return S}mungeSdpAnswer(S){return us.browser.isFirefox()&&this.audioTrackForPub&&this.action===dn.PUBLISH&&(S=new zr(S).withOpusAudioConfig(this.audioTrackForPub.config.maxBitrateBps,void 0).sdp),S}stop(){var S,R,M,P,B,H,te,re,K;this.statsReporter.stop(),this.videoReceiverTransformer.destroy(),this.videoSenderTransformer.destroy(),(S=this.peerConnection)===null||S===void 0||S.removeEventListener("connectionstatechange",this.onConnectionStateChange),(R=this.peerConnection)===null||R===void 0||R.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(M=this.peerConnection)===null||M===void 0||M.removeEventListener("icecandidateerror",this.onIceCandidateError),(P=this.peerConnection)===null||P===void 0||P.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(B=this.peerConnection)===null||B===void 0||B.removeEventListener("track",this.onTrack),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("mute",this.onMute),(te=this.peerConnection)===null||te===void 0||te.removeEventListener("unmute",this.onUnMute),(re=this.peerConnection)===null||re===void 0||re.removeEventListener("icecandidate",this.onIceCandidate),(K=this.peerConnection)===null||K===void 0||K.close()}getTransceiverForKind(S){if(!this.peerConnection)return;const R=this.peerConnection.getTransceivers();return S==="audio"?R.find(M=>M.mid==="0"):S==="video"?R.find(M=>M.mid==="1"):void 0}removeTrack(S){return za(this,void 0,void 0,function*(){if(S==="audio"||S==="video")if(this.peerConnection)try{const R=this.getTransceiverForKind(S);if(!R)return void this.logger.warn({msg:`tried removing track type ${S} but couldn't find transceiver`});yield R.sender.replaceTrack(null),S===Cu.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0,yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(R){this.logger.warn({msg:"error replacing track",err:R})}else S===Cu.AUDIO?this.audioTrackForPub=void 0:this.videoTrackForPub=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:S})})}replaceOrUpdateTrack(S){return za(this,void 0,void 0,function*(){if(S.track){if(wl(S)?this.audioTrackForPub=S:G0(S)&&(this.videoTrackForPub=S),this.peerConnection)try{const R=this.getTransceiverForKind(S.track.kind);if(!R)return void this.logger.warn({msg:`tried replacing track type ${S.track.kind} but couldn't find transceiver`,track:S.track});if(G0(S)){const M=R.sender.getParameters(),P=vh(this.stageCapabilities.simulcastNegotiated,S);M.encodings=M.encodings.map(B=>{var H;const te=(H=B.rid)!==null&&H!==void 0?H:"",re=P.find(K=>{var se;return((se=K.rid)!==null&&se!==void 0?se:"")===te});return re?Object.assign(Object.assign({},B),re):B}),yield R.sender.setParameters(M)}else if(wl(S)){const M=R.sender.getParameters(),P=Mu(S)[0];M.encodings=M.encodings.map(B=>Object.assign(Object.assign({},B),P)),yield R.sender.setParameters(M)}yield R.sender.replaceTrack(S.track),yield this.statsReporter.updateMultihostConfiguration(this.audioTrackForPub,this.videoTrackForPub)}catch(R){this.logger.warn({msg:"error replacing track",err:R})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateTrack with no track"})})}initializePeerConnection(S=!1){var R,M,P;return za(this,void 0,void 0,function*(){const{traceId:B,token:H,action:te,identifier:re}=this;y0(this.peerConnection);let K=new MediaStream;if(te===dn.PUBLISH){this.audioTrackForPub||(this.audioTrackForPub={track:this.getSilentAudio(),config:{maxBitrateBps:ro(N0),stereo:!1}});const se=this.peerConnection.getTransceivers(),he=[];se.forEach(_e=>{var lt;he.concat((lt=_e.sender.track)===null||lt===void 0?void 0:lt.id)}),K=new MediaStream([this.audioTrackForPub.track,(R=this.videoTrackForPub)===null||R===void 0?void 0:R.track].filter(_e=>!!_e&&!he.includes(_e.id)));const pe=K.getAudioTracks()[0]||"audio",Ne=K.getVideoTracks()[0]||"video",Je={direction:"sendonly",streams:[K],sendEncodings:Mu(this.audioTrackForPub)},Ye={direction:"sendrecv",streams:[K],sendEncodings:vh(this.stageCapabilities.simulcastNegotiated,this.videoTrackForPub)};this.peerConnection.addTransceiver(pe,Je),this.trace(H,B,`track added, type: ${pe.kind||pe}`,te,re);const Oe=this.peerConnection.addTransceiver(Ne,Ye);this.trace(H,B,`track added, type: ${Ne.kind||Ne}`,te,re),this.inBandMessagingEnabled&&!Gy.isSupported(Oe)&&this.handleTransformNotSupported(),this.videoSenderTransformer.onTransceiverAdd(Oe)}else te===dn.SUBSCRIBE&&(H.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(H,B,"track added, type: audio",te,re),S||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(H,B,"track added, type: video",te,re),this.inBandMessagingEnabled&&!Um.isSupported(this.videoTransceiver)&&this.handleTransformNotSupported(),this.videoReceiverTransformer.onTransceiverAdd(this.videoTransceiver)),this.peerConnection.getTransceivers().forEach(se=>{se.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),K==null||K.addTrack(se.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})}),this.applyJitterBufferMinDelayConditionally((P=(M=this.stageConnection)===null||M===void 0?void 0:M.getIsStagePublishing())!==null&&P!==void 0&&P));return K})}handlePublishingChanged(S){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${S}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===dn.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(S)}applyJitterBufferMinDelayConditionally(S){const R=this.currentJitterBufferMinDelayInMs,M=this.calcJitterBufferMinDelay(S,this.jitterBufferConfig);if(S){if(R===void 0||R>M){const P=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${M}`;this.logger.debug({msg:P}),this.trace(this.token,this.traceId,P,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(M)}}else if(R===void 0||M!==R){const P=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${M}`;this.logger.debug({msg:P}),this.trace(this.token,this.traceId,P,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(M)}}calcJitterBufferMinDelay(S,R){var M,P,B;let H=0;if(!(()=>{const te=RTCRtpReceiver.prototype;return!(!te||typeof te!="object")&&("jitterBufferTarget"in te||"playoutDelayHint"in te)})())return 0;if(S)H=Fa((M=R==null?void 0:R.minDelayWhenPublishing)!==null&&M!==void 0?M:js.DEFAULT,S);else{H=Fa((P=R==null?void 0:R.minDelayWhenSubscribeOnly)!==null&&P!==void 0?P:js.DEFAULT,S);const te=(B=this.stageConnection)===null||B===void 0?void 0:B.jitterBufferMinDelayInMs();(R==null?void 0:R.minDelayWhenSubscribeOnly)===js.DEFAULT&&te!==void 0&&(H=te,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${H}`}))}return H}applyAndTrackJitterBufferMinDelay(S){var R,M;this.currentJitterBufferMinDelayInMs=S,this.statsReporter.updateJitterBufferMinDelay(S),S!==void 0&&((M=(R=this.peerConnection)===null||R===void 0?void 0:R.getTransceivers())===null||M===void 0||M.forEach(P=>{P.receiver&&this.applyJitterBufferMinDelay(P.receiver,S)}))}applyJitterBufferMinDelay(S,R){let M="Unable to set jitter buffer min delay";if("jitterBufferTarget"in S)M=`setting jitterBufferTarget to: ${R} for track: ${S.track.kind}`,this.logger.debug({msg:M}),S.jitterBufferTarget=R;else if("playoutDelayHint"in S){const P=R/1e3;M=`setting playoutDelayHint to: ${R} for track: ${S.track.kind}`,this.logger.debug({msg:M}),S.playoutDelayHint=P}else this.logger.warn({msg:M});this.trace(this.token,this.traceId,M,this.action,this.identifier)}exchangeSdp(S){var R;return za(this,void 0,void 0,function*(){const{traceId:M,token:P,action:B,identifier:H,tag:te,endpointURL:re}=this,{iceRestart:K=!1,nodeOverride:se,assignmentToken:he,abortController:pe}=S;let Ne;this.logger.debug({msg:`Exchanging SDP: ${M.value}, iceRestart=${K}, nodeOverride=${se}, assignmentToken=${he}`}),y0(this.peerConnection),B===dn.PUBLISH&&jo()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((Ye,Oe)=>{var _e,lt;const wt=(_e=RTCRtpReceiver.getCapabilities("video"))===null||_e===void 0?void 0:_e.codecs;if(!wt)return;let Kt=wt;Kt=k0(wt,"42e0"),Oe.preferMainProfile&&(Kt=k0(wt,"4d00")),(lt=Ye.getTransceivers().find(It=>It.receiver.track.kind==="video"))===null||lt===void 0||lt.setCodecPreferences(Kt)})(this.peerConnection,{preferMainProfile:jo()}));try{this.trace(P,M,"Creating offer",B,H),Ne=yield this.peerConnection.createOffer({iceRestart:K})}catch(Ye){const Oe=new Ii(Object.assign(Object.assign({},_p(Bt.CREATE_OFFER_FAILURE,Ye)),{action:B,token:P,traceId:M,tag:te,location:"exchangeSdp",remoteParticipantId:H}));this.emit(od,Oe),this.analyticsTracker.trackErrorAndThrow(Oe)}Ne.sdp&&(Ne.sdp=this.mungeSdpOffer(Ne.sdp,B,{simulcastNegotiated:this.stageCapabilities.simulcastNegotiated,audioConfig:(R=this.audioTrackForPub)===null||R===void 0?void 0:R.config})),this.trace(P,M,"Setting local description",B,H),yield this.peerConnection.setLocalDescription(Ne),this.trace(P,M,"local description set",B,H),re||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const Je=B===dn.PUBLISH&&jo()||B===dn.SUBSCRIBE&&ah("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:re,nodeOverride:se,assignmentToken:he,multiCodec:Je,abortController:pe})})}getReports(){var S;return za(this,void 0,void 0,function*(){try{const R=(yield(S=this.peerConnection)===null||S===void 0?void 0:S.getStats())||[],M=[];return R.forEach(P=>{M.push(P)}),M}catch{return[]}})}requestRTCStats(S){return za(this,void 0,void 0,function*(){if(this.peerConnection)return this.peerConnection.getStats(S)})}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:S,tag:R,identifier:M,action:P,traceId:B}=this,H=ME({traceId:B,token:S,tag:R,identifier:M,action:P,stageErrorValue:Bt.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:H,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(H),this.emit(ft,H)}handleConnectionFailure(){return za(this,void 0,void 0,function*(){const{token:S,traceId:R,tag:M}=this;this.analyticsTracker.trackError(new Ii(Object.assign(Object.assign({},Bt.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:S,traceId:R,tag:M,location:"onIceCandidateError",remoteParticipantId:this.identifier})))})}getSilentAudio(){Bm||(Bm=new AudioContext);const S=Bm.createOscillator(),R=Bm.createGain();S.connect(R);const M=Bm.createMediaStreamDestination();return R.connect(M),R.gain.value=0,S.start(),M.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}initTracksToPublish(S){this.videoTrackForPub=S.find(G0),this.audioTrackForPub=S.find(wl)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var S,R;return this.calcJitterBufferMinDelay((R=(S=this.stageConnection)===null||S===void 0?void 0:S.getIsStagePublishing())!==null&&R!==void 0&&R,this.jitterBufferConfig)}trace(S,R,M,P,B){this.analyticsTracker.trackEventNoSharedProps(new Rm(S,R,M,P,B))}sendSeiMessage(S){var R;this.action===dn.PUBLISH&&((R=this.videoSenderTransformer)===null||R===void 0||R.sendSeiMessage(S))}}const qy=dn.SUBSCRIBE;class Du{constructor(S,R,M){this.analyticsTracker=S,this.token=R,this.remoteId=M,this.action=qy}trackAttempt({stageConnectionStats:S,isReassignment:R=!1,traceIdOverride:M,preAttemptSfuResource:P}){const{action:B,analyticsTracker:H,token:te,remoteId:re}=this,K=M||fc();return H.trackEvent(new Dm({token:this.token,subscribedId:this.remoteId,traceId:K,isEdpConnected:S.isConnected,isReassignment:R,preAttemptSfuResource:P})),{getTraceId:()=>K,trackSubscribeStarted({totalDurationWithRetries:se,retryTimes:he,sfuResource:pe,peerClientPerfStats:Ne}){const{optionsDuration:Je,postDuration:Ye,timeToCandidate:Oe,timeToConnected:_e,sdpExchangeDuration:lt,sdpExchangeTransport:wt,setRemoteDescDuration:Kt,peerConnectionDuration:It}=Ne,{edpInitialConnectDuration:Xn,edpInitialConnectRetries:wn,edpInitialStateDuration:yi,edpInitialStatePublishingCount:Fi,edpStateUpdateCount:ki}=S;H.trackEvent(new Ap({token:te,traceId:K,remoteParticipantId:re,optionsDuration:Je,postDuration:Ye,timeToCandidate:Oe,totalDuration:_e,edpInitialConnectDuration:Xn,edpInitialConnectRetries:wn,edpInitialStateDuration:yi,edpInitialStatePublishingCount:Fi,edpStateUpdateCount:ki,sdpExchangeDuration:lt,sdpExchangeTransport:wt,setRemoteDescDuration:Kt,peerConnectionDuration:It,sfuResource:pe,totalDurationWithRetries:se,subscribeRetryTimes:he,isReassignment:R}))},trackSubscribeFirstFrame:({peerClientPerfStats:se,totalDurationWithRetries:he,sfuResource:pe,retryTimes:Ne,currentJitterBufferMinDelayInMs:Je,mediaType:Ye,firstFrameDuration:Oe})=>{const{sdpExchangeDuration:_e,sdpExchangeTransport:lt,setRemoteDescDuration:wt,peerConnectionDuration:Kt}=se,{edpInitialConnectDuration:It,edpInitialConnectRetries:Xn,edpInitialStateDuration:wn,edpInitialStatePublishingCount:yi,edpStateUpdateCount:Fi}=S;this.analyticsTracker.trackEvent(new Tx({token:this.token,traceId:K,remoteParticipantId:re,edpInitialConnectDuration:It,edpInitialConnectRetries:Xn,edpInitialStateDuration:wn,edpInitialStatePublishingCount:yi,edpStateUpdateCount:Fi,sdpExchangeDuration:_e,sdpExchangeTransport:lt,setRemoteDescDuration:wt,peerConnectionDuration:Kt,videoWasPaused:!1,firstFrameDuration:Oe,mediaType:Ye,sfuResource:pe,totalDurationWithRetries:he,subscribeRetryTimes:Ne,currentJitterBufferMinDelayInMs:Je}))},trackSubscribeFailed(se,he){const pe=((Ye,Oe,_e)=>{if(Ye instanceof Ii)return Ye;let lt="";return Ye instanceof Ts.AxiosError&&(lt+=`AxiosError - ${Ye.code}`),new Ii(Object.assign(Object.assign(Object.assign({},Bt.SUBSCRIBE_FAILURE),{action:qy,token:Oe,traceId:_e,tag:pc.SUBSCRIBE_RELATED,location:"subscribe",details:`${lt} ${Ye==null?void 0:Ye.message}`}),{fatal:!0}))})(se,te,K);H.trackEvent(new xE({token:te,traceId:K,remoteParticipantId:re,code:pe.code,message:pe.message,fatal:pe.fatal,nominal:pe.nominal,isReassignment:R}));const{isConnected:Ne}=S,Je=new Ii(Object.assign(Object.assign({},Bt.SUBSCRIBE_FAILURE),{action:B,token:te,traceId:K,tag:To(dn.SUBSCRIBE,re),location:"subscribe",remoteParticipantId:re,isEdpConnected:Ne,details:he}));return se instanceof Ii&&(Je.fatal=se.fatal,Je.nominal=se.nominal,Je.location=`subscribe > ${se.location}`),H.trackError(Je),pe},trackUnsubscribe:()=>{H.trackEvent(new bx({token:te,unsubscribedId:re,traceId:K}))},trackEndSucceeded:se=>{H.trackEvent(new Pm({token:te,traceId:K,remoteParticipantId:re,isUnsubscribeSuccessful:!0,reason:se}))},trackEndFailed:se=>{const he=new Ii(Object.assign(Object.assign({},Bt.UNSUBSCRIBE_FAILURE),{token:te,traceId:K,tag:To(dn.SUBSCRIBE,re),location:"unsubscribe",remoteParticipantId:re}));return se!==wa.UNLOAD&&se!==wa.UNSUBSCRIBE||H.trackError(he),H.trackEvent(new Pm({token:te,traceId:K,remoteParticipantId:re,isUnsubscribeSuccessful:!0,reason:se})),he}}}}class Op extends qn{constructor(S,R,M,P,B,H){super(bn.PLAYBACK_LAYER_REQUEST,S,R,!1),Object.assign(this.properties,{media_type:M,remote_participant_id:P,track_id:B,layer_id:H})}}class IE extends qn{constructor(S,R,M,P,B,H=1){super(bn.PLAYBACK_LAYER_STATE,S,R,!1),Object.assign(this.properties,{media_type:M,remote_participant_id:P,track_id:B,request_count:H})}}var Fm,Ha,zm,fa;(function(O){O.PAUSE="pause",O.PLAY="play"})(Fm||(Fm={})),function(O){O.IDLE="idle",O.ACTIVE="active",O.ERRORED="errored",O.DESTROYED="destroyed"}(Ha||(Ha={})),function(O){O.SUCCESS="success"}(zm||(zm={})),function(O){O.FAILED="failed",O.DESTROYED="destroyed",O.THROTTLED="throttled"}(fa||(fa={}));var yh=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class Rx{constructor(S){this.state=Ha.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>yh(this,void 0,void 0,function*(){return this.state!==Ha.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(Fm.PAUSE)}),this.startVideo=()=>yh(this,void 0,void 0,function*(){return this.state!==Ha.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(Fm.PLAY)}),this.setLayer=R=>yh(this,void 0,void 0,function*(){return this.state!==Ha.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(R)}),this.unsetLayer=()=>yh(this,void 0,void 0,function*(){return this.state!==Ha.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()}),this.getLayers=()=>yh(this,void 0,void 0,function*(){return this.state!==Ha.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()}),this.sendPlaybackRequest=R=>yh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(fa.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,ti.err)(fa.FAILED);this.logger.info({msg:`Sending ${R} request to ${this.playbackEndpoint}`});const M=R===Fm.PAUSE?{pause:[this.mid]}:{play:[this.mid]},P=this.createPostWhepRequest(M);return fetch(this.playbackEndpoint,P).then(B=>B.status>=300?(new Error(`Error sending media controls request: ${B.status}:${B.statusText}`),this.logger.error({err:ti.err}),(0,ti.err)(fa.FAILED)):(this.logger.debug({msg:`Request to ${R} was successful: ${B.status}`}),(0,ti.ok)(zm.SUCCESS))).catch(B=>(this.logger.error({err:B,msg:"Error sending media controls request"}),(0,ti.err)(fa.FAILED)))}),this.sendLayerRequest=R=>yh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(fa.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ti.err)(fa.FAILED);const M=typeof R=="string",P=M?{mediaId:this.mid,encodingId:R}:{},B=M?`set : ${R}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${B} at ${this.layersEndpoint}`});const H=this.createPostWhepRequest(P);return this.trackLayerRequest(R??"auto"),fetch(this.layersEndpoint,H).then(te=>this.state===Ha.DESTROYED?(0,ti.err)(fa.DESTROYED):te.status>=300?this.handleLayerRequestError(te.status,te.statusText):(this.logger.debug({msg:`Request to ${B} was successful: ${te.status}`}),(0,ti.ok)(zm.SUCCESS))).catch(te=>this.handleLayerRequestError(0,te.message))}),this.sendLayerStateRequest=()=>yh(this,void 0,void 0,function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,ti.err)(fa.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,ti.err)(fa.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const R=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,R).then(M=>yh(this,void 0,void 0,function*(){var P;if(this.state===Ha.DESTROYED)return(0,ti.err)(fa.DESTROYED);if(M.status>=300)return this.handleLayerStateRequestError(M.status,M.statusText);const B=yield M.json(),H=(P=B==null?void 0:B.layers)!==null&&P!==void 0?P:[],te=JSON.stringify(H,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${te}`}),(0,ti.ok)(H)})).catch(M=>this.handleLayerStateRequestError(0,M.message))}),this.logger=new no(S.logger,me.REMOTE_PLAYBACK),this.token=S.token,this.traceId=S.traceId,this.analyticsTracker=S.analyticsTracker,this.remoteParticipantId=S.remoteParticipantId}set mediaId(S){if(this.state!==Ha.DESTROYED){if(this.mid=S,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Ha.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Ha.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(S){var R,M;if(this.state!==Ha.DESTROYED){if(this.playbackEndpoint=(R=S.playback)!==null&&R!==void 0?R:null,this.layersEndpoint=(M=S.layers)!==null&&M!==void 0?M:null,!this.playbackEndpoint||!this.layersEndpoint){const P={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(P,null)}`}),void(this.state=Ha.IDLE)}this.mid&&(this.state=Ha.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Ha.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(S="command"){this.logger.info({msg:`skipping ${S}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(S){return S===Ha.DESTROYED?(0,ti.err)(fa.DESTROYED):(0,ti.err)(fa.FAILED)}createPostWhepRequest(S){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(S)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var S,R;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":xa().value,"X-Stages-SDK":"1.19.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(R=(S=this.traceId)===null||S===void 0?void 0:S.value)!==null&&R!==void 0?R:"","X-Stages-WHIP-Version":vc}}trackLayerRequest(S){var R;this.analyticsTracker.trackEventNoSharedProps(new Op(this.token,this.traceId,Xt.VIDEO,this.remoteParticipantId,(R=this.mid)!==null&&R!==void 0?R:"unknown",S))}trackLayerStateRequest(S=1){var R;this.analyticsTracker.trackEventNoSharedProps(new IE(this.token,this.traceId,Xt.VIDEO,this.remoteParticipantId,(R=this.mid)!==null&&R!==void 0?R:"unknown",S))}handleLayerRequestError(S,R){const M=`sendLayerRequest failed for reason: ${S} ${R}`;let P,B;return S===429?(P=fa.THROTTLED,B=Bt.WHEP_SET_LAYER_REQUEST_THROTTLED):(P=fa.FAILED,B=Bt.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(B,M),(0,ti.err)(P)}handleLayerStateRequestError(S,R){const M=`sendLayerStateRequest failed for reason: ${S} ${R}`;let P,B;return S===429?(P=fa.THROTTLED,B=Bt.WHEP_GET_LAYER_STATE_THROTTLED):(P=fa.FAILED,B=Bt.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(B,M),(0,ti.err)(P)}trackRequestError(S,R){const M=new Error(R);this.logger.error({err:M}),S.message=R;const P=this.createError(S);this.analyticsTracker.trackError(P)}createError(S,R){return new Ii(Object.assign({action:dn.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:pc.SUBSCRIBE_RELATED,details:R},S))}}var Hm,$y,Yo,Ro,Ao=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})},kE=function(O,S,R,M){if(R==="a"&&!M)throw new TypeError("Private accessor was defined without a getter");if(typeof S=="function"?O!==S||!M:!S.has(O))throw new TypeError("Cannot read private member from an object whose class did not declare it");return R==="m"?M:R==="a"?M.call(O):M?M.value:S.get(O)};(function(O){O.DISCONNECTED="disconnected",O.CONNECTING="connecting",O.CONNECTED="connected",O.ERRORED="errored"})(Yo||(Yo={})),function(O){O.NONE="none",O.AUDIO_ONLY="audio_only",O.AUDIO_VIDEO="audio_video"}(Ro||(Ro={}));class Ax extends Yc{constructor(S,R,M,P,B,H,te){super(),this.id=S,this.token=R,this.stageConnection=M,this.nonScopedLogger=P,this.analyticsTracker=B,this.desiredSubscribeType=H,Hm.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:Yo.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new A0(1e3),this.cleanupFirstFrameTracking=M0,this.actualSubscribeType=Ro.NONE,this.action=dn.SUBSCRIBE,this.updateDesiredSubscribeType=K=>{this.desiredSubscribeType=K,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=K=>{this.peerClient.updateSubscribeConfig(K)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const K=this.actualSubscribeType,se=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${se}`}),this.subscriptionState.connectionState===Yo.CONNECTED&&se!==Ro.NONE&&K!==se&&this.applyVideoControlsBySubscribeType(se,K)},this.onParticipantUpdated=K=>{kE(this,Hm,"m",$y).call(this,K)&&(this.logger.debug({msg:"onParticipantUpdated",participant:K}),this.processStateUpdate({isTargetPublishing:K.isPublishing}))},this.onParticipantJoined=K=>{kE(this,Hm,"m",$y).call(this,K)&&(this.logger.debug({msg:"onParticipantJoined",participant:K}),this.processStateUpdate({isTargetPublishing:K.isPublishing}))},this.onParticipantLeft=K=>{kE(this,Hm,"m",$y).call(this,K)&&(this.logger.debug({msg:"onParticipantLeft",participant:K}),this.processStateUpdate({isTargetPublishing:!1}))},this.requestRTCStats=K=>Ao(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(K)}),this.trySubscribe=K=>Ao(this,void 0,void 0,function*(){if(this.logger.debug({msg:`Subscribe attempt started: ${K}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==Yo.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:Yo.CONNECTING}));const se=this.stageConnection.getConnectionStats(),he=this.peerClient.getExpectedJitterBufferMinDelayInMs(),pe=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:se,preAttemptSfuResource:pe});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:Ne}=yield this.subscribe(this.attemptTracker.getTraceId()),Je=performance.now()-this.startConnectingTimestamp,Ye=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const Oe=this.failedRetries;this.attemptToActualizeSubscribeType();const _e=this.peerClient.getActionMeasurements();if(this.attemptTracker.trackSubscribeStarted({sfuResource:Ye,totalDurationWithRetries:Je,retryTimes:Oe,peerClientPerfStats:_e}),Ne){this.cleanupFirstFrameTracking();const lt=this.actualSubscribeType,wt=this.attemptTracker,Kt=(It,Xn)=>{wt.trackSubscribeFirstFrame({peerClientPerfStats:_e,sfuResource:Ye,totalDurationWithRetries:Je,retryTimes:Oe,currentJitterBufferMinDelayInMs:he,mediaType:Xn,firstFrameDuration:It})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:Ne,subscribeType:lt,callback:Kt})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,Ne&&this.emit(ge,Ne,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(Ne){const Je=this.attemptTracker.trackSubscribeFailed(Ne);this.logger.error({log:"Subscribe attempt failed",err:Ne}),this.onTrySubscribeFailure(Je,K)}return!1});const re=fc();this.peerClient=new W0(R,this.nonScopedLogger,this.action,To(this.action,S),re,B,S,M,te),this.logger=new no(P,me.SUBSCRIPTION),this.subscribeTracker=new Du(this.analyticsTracker,R,S),this.remotePlaybackController=new Rx({token:R,analyticsTracker:B,traceId:re,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(S,R){try{S===Ro.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch(M=>{this.logger.error({err:M,msg:"Remote playback request to stop video failed"})}):S===Ro.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch(M=>{this.logger.error({err:M,msg:"Remote playback request to start video failed"})}),this.actualSubscribeType=S,this.logger.debug({msg:`Desired subscribe type actualized from ${R} to ${S}.`})}catch(M){this.logger.error({err:M,msg:`Error updating subscribe type from ${R} to ${S}.`})}}onPeerClientConnectionStateChange(S){const R=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${S}`,state:S,targetParticipant:R}),this.processStateUpdate({peerClientState:S})}onPeerClientTransformError(S){this.emit(io,S)}processStateUpdate(S){const R=this.previousSignalState,M=Object.assign({},R,S);this.isSubscriptionActive?(M.isTargetPublishing?S.peerClientState===at.CONNECTED?this.updateState({connectionState:Yo.CONNECTED,subscribeInProgress:!0}):S.peerClientState===at.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(wa.CONNECTION_FAIL),this.updateState({subscribeInProgress:!1})):(R.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:Yo.DISCONNECTED})),(!R.isTargetPublishing&&S.isTargetPublishing||S.peerClientState===at.FAILED)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,S)):this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"})}onTrySubscribeFailure(S,R){this.logger.debug({msg:"Changing/keeping state FAILED"});const M=S.fatal,P=S.code===Bt.OPERATION_ABORTED.code,B=this.failedRetries<=4;if(!P&&!M&&B){const H=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${H}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout(()=>Ao(this,void 0,void 0,function*(){this.throttledTrySubscribe(R)}),H)}else this.updateState({connectionState:Yo.ERRORED}),this.emit(ud,S),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(Ys,this.onPeerClientConnectionStateChange,this),this.peerClient.on(g0,R=>{this.remotePlaybackController.endpoints={playback:R.mediaControls,layers:R.layerControls}}),this.peerClient.on(vp,R=>{this.emit(dh,R)}),this.peerClient.on(ft,this.onPeerClientTransformError,this),this.stageConnection.on(w0,this.onParticipantUpdated),this.stageConnection.on(cf,this.onParticipantJoined),this.stageConnection.on(ld,this.onParticipantLeft),this.stageConnection.on(ha,this.onParticipantLeft);let S=!0;if(this.stageConnection.isConnected()){const R=this.stageConnection.getParticipant(this.id);S=!!(R!=null&&R.isPublishing)}this.processStateUpdate({isTargetPublishing:S})}throttledTrySubscribe(S){return this.throttler.invoke(this.trySubscribe,S)}updateState(S){S.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=S.subscribeInProgress),S.connectionState&&this.subscriptionState.connectionState!==S.connectionState&&(this.subscriptionState.connectionState=S.connectionState,this.emit(wm,this.subscriptionState.connectionState))}stop(S=!1){this.peerClient.off(Ys,this.onPeerClientConnectionStateChange,this),this.peerClient.off(ft,this.onPeerClientTransformError,this),this.unsubscribe(S),this.throttler.clear(),this.stageConnection.off(w0,this.onParticipantUpdated),this.stageConnection.off(cf,this.onParticipantJoined),this.stageConnection.off(ld,this.onParticipantLeft),this.stageConnection.off(ha,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:Yo.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(S,R){return Ao(this,void 0,void 0,function*(){const{token:M,id:P}=this;M.assertTokenIsUnexpired(S,To(dn.SUBSCRIBE,P),"subscribe",P);const{mediaStream:B}=yield this.peerClient.connect({audioOnly:R,traceId:S});return{peerClient:this.peerClient,mediaStream:B}})}unsubscribe(S=!1){return Ao(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===Yo.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const R=S?wa.UNLOAD:wa.UNSUBSCRIBE;try{S?this.peerClient.disconnect(S):yield this.peerClient.disconnect(S),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(R)}catch{this.attemptTracker.trackEndFailed(R)}})}triggerIceRestart(S){var R;return Ao(this,void 0,void 0,function*(){const M=this.stageConnection.getConnectionStats(),P=this.peerClient.getSfuResource(),B=this.subscribeTracker.trackAttempt({stageConnectionStats:M,isReassignment:!0,traceIdOverride:S.traceId,preAttemptSfuResource:P}),H=performance.now();try{this.emit(Bi),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:S,traceId:S.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const te=performance.now()-H,re=this.peerClient.getSfuResource(),K=this.peerClient.getActionMeasurements();(R=this.attemptTracker)===null||R===void 0||R.trackEndSucceeded(wa.REASSIGNMENT),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),B.trackSubscribeStarted({totalDurationWithRetries:te,sfuResource:re,retryTimes:0,peerClientPerfStats:K}),this.emit(hd)}catch(te){this.emit(Su),this.logger.error({msg:"ICE restart attempt failed",err:te});const re=this.peerClient.getSfuResource(),K=B.trackSubscribeFailed(te,`iceRestart=true, startNode=${P.node}, endNode=${re==null?void 0:re.node}`);throw K.code===Bt.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(K,"ice restart timeout"),te}})}measureFirstFrameDuration({mediaStream:S,subscribeType:R,callback:M}){const P=performance.now(),B=re=>{const K=performance.now()-P;M(K,re),re==="audio"?te():H()};let H=M0,te=M0;return R!==Ro.AUDIO_ONLY&&(H=function(re,K){return Cm(re,"video",K)}(S,B)),te=function(re,K){return Cm(re,"audio",K)}(S,B),()=>{H(),te()}}}var gd,br;Hm=new WeakSet,$y=function(O){return O.id===this.id},function(O){O.JOIN_ERROR="JOIN_ERROR",O.PUBLISH_ERROR="PUBLISH_ERROR",O.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"}(gd||(gd={})),function(O){O[O.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",O[O.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",O[O.TIMEOUT=3]="TIMEOUT",O[O.FAILED=4]="FAILED",O[O.CANCELED=5]="CANCELED",O[O.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",O[O.CODEC_MISMATCH=7]="CODEC_MISMATCH",O[O.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED"}(br||(br={}));const pR={[br.TOKEN_MALFORMED]:"Token is malformed",[br.TOKEN_EXPIRED]:"Token expired and is no longer valid",[br.TIMEOUT]:"Operation timed out",[br.FAILED]:"Operation failed",[br.CANCELED]:"Operation canceled",[br.STAGE_AT_CAPACITY]:"Stage at capacity",[br.CODEC_MISMATCH]:"Client codec is not supported",[br.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation"},mR={[Bt.EXPIRED_TOKEN.code]:br.TOKEN_EXPIRED,[Bt.MALFORMED_TOKEN.code]:br.TOKEN_MALFORMED,[Bt.TOKEN_PERMISSIONS_DENIED.code]:br.TOKEN_NOT_ALLOWED,[Bt.OPERATION_ABORTED.code]:br.CANCELED,[Bt.JOIN_TIMED_OUT.code]:br.TIMEOUT,[Bt.EVENT_PLANE_WS_CREATE_FAILED.code]:br.FAILED,[Bt.EVENT_PLANE_PONG_TIMEOUT.code]:br.FAILED,[Bt.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:br.FAILED,[Bt.PUBLISH_TIMED_OUT.code]:br.TIMEOUT,[Bt.PUBLISH_FAILURE.code]:br.FAILED,[Bt.SUBSCRIBE_TIMED_OUT.code]:br.TIMEOUT,[Bt.SUBSCRIBE_FAILURE.code]:br.FAILED,[Bt.STAGE_AT_CAPACITY.code]:br.STAGE_AT_CAPACITY,[Bt.NO_MATCHING_CODEC.code]:br.CODEC_MISMATCH,[Bt.NETWORK_FAILURE.code]:br.FAILED,[Bt.INTERNAL_SERVER_ERROR.code]:br.FAILED,[Bt.REMOTE_STREAM_NOT_FOUND.code]:br.FAILED,[Bt.INTERNAL_MHCP_ERROR.code]:br.FAILED,[Bt.UNREACHABLE_MHCP.code]:br.FAILED,[Bt.INVALID_SESSION_STATUS.code]:br.FAILED,[Bt.MHCP_ABORTED.code]:br.FAILED};class gR extends Error{constructor(S,R,M){super(),this.code=S,this.category=R,this.message=M,this.name="StageError",this.errorDetails=[],this.message=`[${R}] ${M}`}addDetails(S){this.errorDetails.push(S)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var jm,Vm,Y0;(function(O){O.ERROR="error"})(jm||(jm={}));class vR extends Yc{constructor(){super(...arguments),this.handleError=(S,R,M=!0)=>{let P;if(S instanceof Ii){const B=mR[S.code];B&&(P=function(H,te,re){var K,se;const he=pR[H],pe=new gR(H,te,he);return pe.addDetails({stageErrorMessage:he,stageErrorCode:H,stageErrorCategory:te,stageArn:(K=re.token)===null||K===void 0?void 0:K.stageARN,traceId:(se=re.traceId)===null||se===void 0?void 0:se.value,causeCode:re.code,causeDetails:re.details,causeMessage:re.message,causeLocation:re.location}),pe}(B,R,S))}if(P)return M&&this.emit(jm.ERROR,P),P}}}(function(O){O.INTERNAL="internal",O.API="api"})(Vm||(Vm={})),function(O){O.ADDITIVE="additive",O.REPLACE="replace"}(Y0||(Y0={}));class yR{constructor(S){this.logger=new no(S.logger,me.CONNECTION),this.subscribeConfig={defaults:S.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(S,R,M,P=Y0.REPLACE){R=(se=>{const he=km(se);if(he.jitterBuffer!==void 0){const pe=Ne=>{if(typeof Ne=="number"){if(Ne<0)return 0;if(Ne>4e3)return 4e3}return Ne};he.jitterBuffer.minDelayWhenPublishing!==void 0&&(he.jitterBuffer.minDelayWhenPublishing=pe(he.jitterBuffer.minDelayWhenPublishing)),he.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(he.jitterBuffer.minDelayWhenSubscribeOnly=pe(he.jitterBuffer.minDelayWhenSubscribeOnly))}return he})(R),this.subscribeConfig.participants[S]===void 0&&(this.subscribeConfig.participants[S]={internalOverrides:{},apiOverrides:{},lastMerged:this.subscribeConfig.defaults});const B=this.subscribeConfig.participants[S];switch(M){case Vm.INTERNAL:B.internalOverrides=this.handleSubscribeConfigLevelMerging(B.internalOverrides,R,P);break;case Vm.API:B.apiOverrides=this.handleSubscribeConfigLevelMerging(B.apiOverrides,R,P);break;default:(function(se){throw new Error(`Unknown case kind: ${se}`)})(M)}const H=TE(this.subscribeConfig.defaults,B.internalOverrides,B.apiOverrides);if(H===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${S} | ${B}, ${R}`}),!1;const te=(re=B.lastMerged,K=H,(typeof re=="object"&&typeof K=="object"&&(0,ua.isEqual)(re,K))===!1);var re,K;return B.lastMerged=H,this.subscribeConfig.participants[S]=B,te}handleExternalSubscribeConfigUpdate(S,R,M,P=Y0.REPLACE){const B=(H=>{const te={};return typeof H!="object"?ti.err(new Error("Invalid input")):(H.jitterBuffer!==void 0&&(te.jitterBuffer={},H.jitterBuffer.minDelay!==void 0&&(te.jitterBuffer.minDelayWhenSubscribeOnly=H.jitterBuffer.minDelay)),H.inBandMessaging!==void 0&&(te.inBandMessaging={enabled:H.inBandMessaging.enabled===!0}),H.simulcast!==void 0&&(te.simulcast={},H.simulcast.initialLayerPreference!==void 0&&(te.simulcast.initialLayerPreference=H.simulcast.initialLayerPreference)),ti.ok(te))})(R);return B.ok===!0&&this.handleSubscribeConfigUpdate(S,B.value,M,P)}handleSubscribeConfigLevelMerging(S,R,M){if(M===Y0.REPLACE)return R;{const P=TE(S,R);return P===void 0?(this.logger.warn({msg:`Unable to merge '${S}' and '${R}' with type ${M}`}),S):P}}getSubscribeConfigSnapshot(S){return this.subscribeConfig.participants[S]===void 0?vi(this.subscribeConfig.defaults):vi(this.subscribeConfig.participants[S].lastMerged)}}class Mx extends qn{constructor(S){super(bn.REASSIGNMENT_REQUEST,S.token,S.traceId,!1),Object.assign(this.properties,{target_local_participant_id:S.targetLocalParticipantId,target_remote_participant_id:S.targetRemoteParticipantId}),this.critical=!0}}var Pu,Lu,ao,_h,vd,bh,Vs,Xo,DE=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class X0 extends Yc{constructor(S,R){super(),this.setGetStats=M=>{this.getInternalStats=M},this.getStats=()=>DE(this,void 0,void 0,function*(){return this.requestRTCStats()}),this.requestRTCStats=()=>DE(this,void 0,void 0,function*(){if(this.getInternalStats)return this.getInternalStats(this.mediaStreamTrack)}),this.getInternalStats=R,this.id=S.id,this.isMuted=!S.enabled,this.mediaStreamTrack=S,this.streamType=this.mediaStreamTrack.kind==="audio"?Xt.AUDIO:Xt.VIDEO}cleanup(){this.removeAllListeners(),this.getInternalStats=void 0}}(function(O){O.IDLE="IDLE",O.INITIALIZING="INITIALIZING",O.ACTIVE="ACTIVE",O.CONTROLS_PAUSED="CONTROLS_PAUSED",O.DESTROYED="DESTROYED"})(Pu||(Pu={})),function(O){O.LAYERS_CHANGED="LAYERS_CHANGED",O.LAYER_SELECTED="LAYER_SELECTED",O.ADAPTION_CHANGED="ADAPTION_CHANGED"}(Lu||(Lu={})),function(O){O.LAYERS_CHANGED="LAYERS_CHANGED",O.LAYER_SELECTED="LAYER_SELECTED",O.ADAPTION_CHANGED="ADAPTION_CHANGED"}(ao||(ao={})),function(O){O.UNAVAILABLE="unavailable",O.SELECTED="selected"}(_h||(_h={})),function(O){O.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged"}(vd||(vd={}));class PE extends X0{constructor(S,R){super(S),this.setMuted=M=>{M!==this.isMuted&&(this.mediaStreamTrack.enabled=!M,this.isMuted=M,this.emit(vd.LOCAL_STREAM_MUTE_CHANGED,this))},this.mediaConfig=xx(S,R)}}class _R{constructor(S,R){this.strategy=S,this.logger=R}setStrategy(S){this.strategy=S}stageStreamsToPublish(){let S=[];try{S=this.strategy.stageStreamsToPublish(),S=S.filter(P=>P instanceof PE)}catch(P){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:P}),console.error("Error executing stageStreamsToPublish",P),ti.err(P)}let R=0,M=0;for(const P of S)P.mediaStreamTrack.kind==="audio"?R++:P.mediaStreamTrack.kind==="video"&&M++;if(R>1||M>1){const P=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return ti.err(P)}return ti.ok(S)}shouldPublishParticipant(S){try{return ti.ok(this.strategy.shouldPublishParticipant(S))}catch(R){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:R}),console.error("Error executing shouldPublishParticipant",R),ti.err(R)}}shouldSubscribeToParticipant(S){try{return ti.ok(this.strategy.shouldSubscribeToParticipant(S))}catch(R){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:R}),console.error("Error executing shouldSubscribeToParticipant",R),ti.err(R)}}subscribeConfiguration(S){var R,M;try{return ti.ok((M=(R=this.strategy).subscribeConfiguration)===null||M===void 0?void 0:M.call(R,S))}catch(P){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:P}),console.error("Error executing subscribeConfiguration",P),ti.err(P)}}preferredLayerForStream(S,R){var M,P;try{return ti.ok((P=(M=this.strategy).preferredLayerForStream)===null||P===void 0?void 0:P.call(M,S,R))}catch(B){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:B}),console.error("Error executing preferredLayerForStream",B),ti.err(B)}}}class Ox extends Yc{constructor(S,R){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=Vs.NOT_PUBLISHED,this.logger=R,this.info=S,this.audioMuted=S.audioMuted,this.videoStopped=S.videoStopped}}(function(O){O.PUBLISH="publish",O.SUBSCRIBE="subscribe"})(bh||(bh={})),function(O){O.NOT_PUBLISHED="not_published",O.ATTEMPTING_PUBLISH="attempting_publish",O.PUBLISHED="published",O.ERRORED="errored"}(Vs||(Vs={})),function(O){O.NOT_SUBSCRIBED="not_subscribed",O.ATTEMPTING_SUBSCRIBE="attempting_subscribe",O.SUBSCRIBED="subscribed",O.ERRORED="errored"}(Xo||(Xo={}));const Wy=1e3;function LE(O){return O.map(S=>S.remote)}function bR(O){return{label:O.encodingId,bitrateBps:O.bitrate*Wy,width:O.width,height:O.height,framesPerSecond:O.framesPerSecond,selected:O.selected}}function Ca(O,S){const R=O.width*O.height,M=S.width*S.height;return R>M||O.bitrateBps>S.bitrateBps||O.framesPerSecond>S.framesPerSecond?1:R===M||O.bitrateBps===S.bitrateBps||O.framesPerSecond>S.framesPerSecond?0:-1}var Gm,Yy,UE=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class BE extends Yc{constructor(S){super(),this.setGetStats=()=>{},this.requestRTCStats=()=>this.internalStream.requestRTCStats(),this.getStats=()=>UE(this,void 0,void 0,function*(){return this.internalStream.requestRTCStats()}),this.setMuted=R=>{this.internalStream.setMuted(R)},this.getLayers=()=>this.internalStream.layers,this.getSelectedLayer=()=>this.internalStream.selectedLayer,this.getLowestQualityLayer=()=>this.internalStream.lowestQualityLayer,this.getHighestQualityLayer=()=>this.internalStream.highestQualityLayer,this.internalStream=S,this.internalStream.on(Lu.ADAPTION_CHANGED,R=>{this.emit(ao.ADAPTION_CHANGED,R)}),this.internalStream.on(Lu.LAYERS_CHANGED,R=>{this.emit(ao.LAYERS_CHANGED,R)}),this.internalStream.on(Lu.LAYER_SELECTED,(R,M)=>{this.emit(ao.LAYER_SELECTED,R,M)})}get id(){return this.internalStream.id}get participantInfo(){return this.internalStream.participantInfo}get streamType(){return this.internalStream.streamType}get mediaStreamTrack(){return this.internalStream.mediaStreamTrack}get isMuted(){return this.internalStream.isMuted}set isMuted(S){this.internalStream.setMuted(S)}get isAdapting(){return this.internalStream.isAdapting}cleanup(){this.removeAllListeners()}}class FE extends X0{constructor({track:S,info:R,getStats:M,remotePlaybackController:P,analyticsTracker:B,token:H}){super(S,M),this.setMuted=re=>{this.isMuted=re},this.setLayer=re=>{const K=(0,ua.cloneDeep)(re);if(this.queueLayerUpdateForValidState(K))return void this.logger.debug({msg:`setLayer:${K} queued, skipping for now`});const se=function(pe,Ne){if(!pe)return(0,ti.ok)(void 0);const Je=typeof pe=="string"?pe:pe.label,Ye=Ne.filter(Oe=>Oe.label===Je)[0];return Ye?(0,ti.ok)(Ye):(0,ti.err)(`Provided layer with id ${Je} does not exist`)}(K,this._layers);if(!se.ok){const pe=se.error;return void this.logger.error({err:pe,msg:"Unable to select layer, skipping skipping selection"})}const he=se.value;if(this.isNextUpdateAdaptionOnly(he))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(he)||this.isAdapting?he&&(this.logger.warn({msg:`setLayer:${JSON.stringify(he)} `}),this.handleManualUpdate(he)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=Pu.INITIALIZING,this.prevState=Pu.IDLE,this.analyticsTracker=B,this.token=H,this.id=S.id,this.info=R,this.mediaStreamTrack=S,this.remotePlaybackController=P,this.layerPollingTimeoutId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const te=h0();this.logger=new no(new _m(te),me.REMOTE_STAGE_STREAM),this.streamType===Xt.AUDIO?this.isMuted=R.audioMuted:this.isMuted=R.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers()}transitionStateTo(S){this.state!==S&&(this.prevState=this.state,this.state=S)}initializeLayerPolling(){this.streamType!==Xt.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingTimeoutId=setInterval(()=>{this.pollInternalLayers()},3e3)):this.logger.debug({msg:"Skipping initializing polling for audio streams"})}startLayerPolling(){this.layerPollingTimeoutId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingTimeoutId!==null?(clearInterval(this.layerPollingTimeoutId),this.layerPollingTimeoutId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(){this.streamType!==Xt.AUDIO?this.remotePlaybackController.getLayers().then(S=>{if(this.isStateValidForLayerUpdates()){if(!S.ok)throw Error(S.error);this.updateInternalLayersFromRemote(S.value),this.transitionStateTo(Pu.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})}).catch(S=>{this.logger.error({err:S,msg:"Error calling getLayers, returning current layers"})}):this.logger.debug({msg:"Skipping layer poll request for audio stream"})}updateInternalLayersFromRemote(S){const R=this._layers,M=S.map(bR).sort(Ca),P=!(0,ua.isEqual)(M,R);this._layers=M;const B=this._selectedLayer,H=this._layers.filter(re=>re.selected)[0],te=!(0,ua.isEqual)(H,B);B&&(B.selected=!1),this._selectedLayer=H,te&&(this.trackLayerUpdate(B),this.trackLayerUpdate(H)),this.isCommandQueueEmpty()&&(P&&this.emitLayersChanged(),te&&this.emitLayerSelected(H))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const S=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${S}`});for(const R of this.commandMap.keys()){const M=this.commandMap.get(R);M==null||M()}this.commandMap.clear()}queueLayerUpdateForValidState(S){if(!S)return this.commandMap.delete("setLayer"),!1;if(this.state===Pu.INITIALIZING){const R=this.setLayer.bind(this,S);return this.commandMap.set("setLayer",R),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const S=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then(R=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(S,`Stream in invalid state: ${this.state}`);R.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(S,R.error)}).catch(()=>{})}resetAdaptionStateOnError(S,R){this._isAdapting=S,this.emitAdaptionChanged(),this.logger.error({err:R,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(S){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const R=this._isAdapting,M=this._selectedLayer;M&&(M.selected=!1),this._isAdapting=!1,this._selectedLayer=S,S.selected=!0,R!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(S,M),this.trackLayerUpdate(M),this.trackLayerUpdate(S),this.emitLayersChanged(),this.emitLayerSelected(S),this.remotePlaybackController.setLayer(S.label).then(P=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const B=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(R,B),void this.resetLayerOnError(M,S,B)}if(!P.ok){const B=P.error;return this.resetAdaptionStateOnError(R,B),void this.resetLayerOnError(M,S,B)}this.logger.debug({msg:`Layer successfully selected: ${S.label}`})}).catch(()=>{})}applyExistingControlState(){var S;this._isAdapting?this.remotePlaybackController.unsetLayer().then(()=>{}).catch(()=>{}):!((S=this._selectedLayer)===null||S===void 0)&&S.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then(()=>{}).catch(()=>{})}resetLayerOnError(S,R,M){R&&(R.selected=!1),S&&(S.selected=!0),this._selectedLayer=S,this.logger.error({err:M,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(S,R),this.emitLayersChanged(),S!==null&&this.emitLayerSelected(S,_h.UNAVAILABLE),this.trackLayerUpdate(R),this.trackLayerUpdate(S)}updateLocalLayerStateBeforeRemote(S,R){this._layers=this._layers.map(M=>M.label===(S==null?void 0:S.label)?S:M.label===(R==null?void 0:R.label)?R:M).sort(Ca)}trackLayerUpdate(S){var R,M;this.analyticsTracker.trackEventNoSharedProps(new U0(this.token,fc(),(R=S==null?void 0:S.label)!==null&&R!==void 0?R:"auto",!0,dn.SUBSCRIBE,(M=S==null?void 0:S.selected)!==null&&M!==void 0&&M,this.info.id))}isNextUpdateAdaptionOnly(S){return S===void 0&&this.isFirstLayerUpdate()||S===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(S){var R;return((R=this._selectedLayer)===null||R===void 0?void 0:R.label)===(S==null?void 0:S.label)}isStateValidForLayerUpdates(){return this.state===Pu.ACTIVE||this.state===Pu.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(S,R=_h.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(S,null,2)}`}),this.emit(Lu.LAYER_SELECTED,(0,ua.cloneDeep)(S),R)}emitLayersChanged(){this.emit(Lu.LAYERS_CHANGED,(0,ua.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(Lu.ADAPTION_CHANGED,this._isAdapting)}get remote(){const S=this.weakRemoteMap.get(this.weakRemoteKey);if(S)return S;const R=new BE(this);return this.weakRemoteMap.set(this.weakRemoteKey,R),R}get participantInfo(){return(0,ua.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,ua.cloneDeep)(this._layers)}get selectedLayer(){var S;return(0,ua.cloneDeep)((S=this._selectedLayer)!==null&&S!==void 0?S:void 0)}get highestQualityLayer(){return(0,ua.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,ua.cloneDeep)(this.layers[0])}pauseControls(){this.transitionStateTo(Pu.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(Pu.ACTIVE)}cleanup(){this.transitionStateTo(Pu.DESTROYED),super.cleanup(),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(O){O.STATE_CHANGE="stateChange",O.MEDIA_STREAM_ADDED="mediaStreamAdded",O.MEDIA_STREAM_REMOVED="mediaStreamRemoved",O.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",O.ERROR="error"})(Gm||(Gm={})),function(O){O.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",O.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"}(Yy||(Yy={}));const oo=Object.assign(Object.assign({},Gm),Yy);var pf;(function(O){O.PUBLICATION_STATE_CHANGE="publicationStateChange"})(pf||(pf={}));const Ko=Object.assign(Object.assign({},Gm),pf);var Jo=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class ER extends Ox{constructor(S,R,M,P,B,H,te,re=!1){super(S,new no(P,me.REMOTE_PARTICIPANT)),this.subscribeState=Xo.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=K=>{this.logger.debug({msg:"subscriptionStateChange",state:K}),K===Yo.DISCONNECTED?this.updateSubscriptionState(Xo.NOT_SUBSCRIBED):K===Yo.CONNECTED?this.updateSubscriptionState(Xo.SUBSCRIBED):K===Yo.CONNECTING?this.updateSubscriptionState(Xo.ATTEMPTING_SUBSCRIBE):K===Yo.ERRORED?this.updateSubscriptionState(Xo.ERRORED):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:K})},this.onSubscriptionMediaStream=(K,se)=>{this.logger.debug({msg:"onSubscriptionMediaStream",stream:K});let he=K.getTracks().map(pe=>{const Ne=new FE({track:pe,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:se,analyticsTracker:this.analyticsTracker,token:this.token});return this.streams.push(Ne),Ne});this.subscription.getDesiredSubscribeType()===Ro.AUDIO_ONLY&&(he=he.filter(pe=>pe.streamType!==Xt.VIDEO)),this.emit(oo.MEDIA_STREAM_ADDED,he)},this.onSubscriptionError=K=>{this.emit(oo.ERROR,K)},this.onSubscriptionSeiMessageReceived=K=>{this.emit(oo.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,K)},this.onSubscriptionTransformError=K=>{this.emit(oo.ERROR,K)},this.onSubscriptionReassignmentStart=()=>{for(const K of this.streams)K.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const K of this.streams)K.resumeControls()},this.updateSubscribeStateIfNecessary=(K,se)=>{if(!this.info.capabilities.has(bh.SUBSCRIBE))return;se!==void 0&&this.subscription.updateSubscribeConfig(se);const he=K!==Ro.NONE&&this.publishState===Vs.PUBLISHED,pe=this.subscribeState!==Xo.NOT_SUBSCRIBED&&this.subscribeState!==Xo.ERRORED;if(he&&!pe)this.subscription.updateDesiredSubscribeType(K),this.subscribe();else if(!he&&pe)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(K);else if(this.subscribeState===Xo.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==K)try{K===Ro.AUDIO_ONLY?this.emit(oo.MEDIA_STREAM_REMOVED,this.streams.filter(Ne=>Ne.streamType===Xt.VIDEO)):K===Ro.AUDIO_VIDEO&&this.emit(oo.MEDIA_STREAM_ADDED,this.streams.filter(Ne=>Ne.streamType===Xt.VIDEO)),this.subscription.updateDesiredSubscribeType(K)}catch(Ne){this.logger.error({err:Ne,msg:"error updating subscribe type"})}},this.updatePublishState=K=>{const se=K&&this.publishState===Vs.PUBLISHED,he=!K&&this.publishState===Vs.NOT_PUBLISHED;return!se&&!he&&(this.info.isPublishing=K,this.publishState=K?Vs.PUBLISHED:Vs.NOT_PUBLISHED,!0)},this.updateStreamState=(K,se)=>{this.audioMuted!==K&&(this.audioMuted=K,this.info.audioMuted=K,this.updateStreamMuteState(Xt.AUDIO,K)),this.videoStopped!==se&&(this.videoStopped=se,this.info.videoStopped=se,this.updateStreamMuteState(Xt.VIDEO,se))},this.updateStreamMuteState=(K,se)=>{const he=this.streams.find(pe=>pe.streamType===K);he?(he.setMuted(se),this.emit(oo.MEDIA_STREAM_MUTE_CHANGED,he)):this.logger.warn({msg:`tried to update mute state for ${K} stream on participant ${this.info.id} that didn't exist`})},this.cleanup=()=>{for(const K of this.streams)K.remote.removeAllListeners(),K.removeAllListeners();this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==Xo.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=te,this.token=R,this.createSubscription=()=>{const K=new Ax(S.id,R,M,P,te,B,H);return K.on(wm,this.onSubscriptionStateChange),K.on(ge,this.onSubscriptionMediaStream),K.on(ud,this.onSubscriptionError),K.on(dh,this.onSubscriptionSeiMessageReceived),K.on(io,this.onSubscriptionTransformError),K.on(Bi,this.onSubscriptionReassignmentStart),K.on(hd,this.onSubscriptionReassignmentDone),K.on(Su,this.onSubscriptionReassignmentDone),K},this.subscription=this.createSubscription(),re&&(this.publishState=Vs.PUBLISHED)}updateSubscriptionState(S){S!==this.subscribeState&&(this.subscribeState=S,this.emit(oo.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(Xo.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===Xo.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(wm,this.onSubscriptionStateChange),this.subscription.off(ge,this.onSubscriptionMediaStream),this.subscription.off(ud,this.onSubscriptionError),this.subscription.off(io,this.onSubscriptionTransformError);const S=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),S===Ro.AUDIO_ONLY?this.emit(oo.MEDIA_STREAM_REMOVED,this.streams.filter(R=>R.streamType===Xt.AUDIO)):this.emit(oo.MEDIA_STREAM_REMOVED,this.streams),this.updateSubscriptionState(Xo.NOT_SUBSCRIBED),this.streams.forEach(R=>{R.cleanup()}),this.streams=[]}triggerIceRestart(S){return Jo(this,void 0,void 0,function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(S)}finally{this.reassigning=!1}})}}const Xy=dn.PUBLISH;class K0{constructor(S,R){this.analyticsTracker=S,this.token=R,this.action=Xy,this.traceId=fc()}trackPublish(S){const{action:R,traceId:M,analyticsTracker:P,token:B}=this;return P.trackEvent(new Ou({token:B,traceId:M})),{getTraceId:()=>M,trackPublishStarted({totalDurationWithRetries:H,retryTimes:te,sfuResource:re,peerClientPerfStats:K}){const{optionsDuration:se,postDuration:he,timeToCandidate:pe,timeToConnected:Ne,sdpExchangeDuration:Je,sdpExchangeTransport:Ye,setRemoteDescDuration:Oe,peerConnectionDuration:_e}=K,{edpInitialConnectDuration:lt,edpInitialConnectRetries:wt,edpInitialStateDuration:Kt,edpStateUpdateCount:It}=S;P.trackEvent(new Ex({token:B,traceId:M,optionsDuration:se,postDuration:he,timeToCandidate:pe,totalDuration:Ne,edpInitialConnectDuration:lt,edpInitialConnectRetries:wt,edpInitialStateDuration:Kt,edpStateUpdateCount:It,sdpExchangeDuration:Je,sdpExchangeTransport:Ye,setRemoteDescDuration:Oe,peerConnectionDuration:_e,publishRetries:te,totalDurationWithRetries:H,sfuResource:re}))},trackPublishFailed(H){const te=((K,se,he)=>{if(K instanceof Ii)return K;let pe="";return K instanceof Ts.AxiosError&&(pe+=`AxiosError - ${K.code}`),new Ii(Object.assign(Object.assign(Object.assign({},Bt.PUBLISH_FAILURE),{action:Xy,token:se,traceId:he,tag:pc.PUBLISH_RELATED,location:"publish",details:`${pe} ${K.message}`}),{fatal:!0}))})(H,B,M);P.trackEvent(new Sx({token:B,traceId:M,code:te.code,message:te.message,fatal:te.fatal,nominal:te.nominal}));const re=new Ii(Object.assign(Object.assign({},Bt.PUBLISH_FAILURE),{action:R,token:B,traceId:M,tag:pc.PUBLISH_RELATED,location:"publish"}));return H instanceof Ii&&(re.fatal=H.fatal,re.nominal=H.nominal,re.location=`publish > ${H.location}`),P.trackError(re),te},trackUnpublish:()=>{P.trackEvent(new ff({token:B,traceId:M}))},trackEndSucceeded:H=>{P.trackEvent(new Rp({token:B,isUnpublishSuccessful:!0,traceId:M,reason:H}))},trackEndFailed:H=>{const te=new Ii(Object.assign(Object.assign({},Bt.UNPUBLISH_FAILURE),{token:B,traceId:M,tag:pc.UNPUBLISH_RELATED,location:"unpublish"}));return H!==wa.UNLOAD&&H!==wa.UNPUBLISH||this.analyticsTracker.trackError(te),P.trackEvent(new Rp({token:B,isUnpublishSuccessful:!1,traceId:M,reason:H})),te}}}}var ja,Ns,Eh=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};(function(O){O.DISCONNECTED="disconnected",O.CONNECTING="connecting",O.CONNECTED="connected",O.ERRORED="errored"})(ja||(ja={})),function(O){O.STATE_CHANGE="stateChange",O.ERROR="error",O.TRANSFORM_ERROR="transformError"}(Ns||(Ns={}));class SR extends Yc{constructor(S,R,M,P){super(),this.token=S,this.stageConnection=R,this.nonScopedLogger=M,this.analyticsTracker=P,this.tracksToPublish=[],this.publicationState=ja.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=dn.PUBLISH,this.start=B=>{this.publicationState===ja.DISCONNECTED||this.publicationState===ja.ERRORED?(this.tracksToPublish=B,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=B=>Eh(this,void 0,void 0,function*(){return this.peerClient.requestRTCStats(B)}),this.stop=(B=!1)=>Eh(this,void 0,void 0,function*(){this.peerClient.off(Ys,this.onPeerClientConnectionStateChange,this),this.peerClient.off(ft,this.onPeerClientTransformError,this),yield this.unpublish(B),this.updateState(ja.DISCONNECTED)}),this.processStateUpdate=B=>{const{publicationState:H}=this;H===ja.DISCONNECTED||H===ja.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(ja.CONNECTING),this.tryPublish()):H===ja.CONNECTING?B===at.CONNECTED&&this.updateState(ja.CONNECTED):H===ja.CONNECTED&&B===at.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(wa.CONNECTION_FAIL),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(ja.CONNECTING),this.tryPublish()))},this.updateState=B=>{this.publicationState=B,this.emit(Ns.STATE_CHANGE,B)},this.tryPublish=()=>Eh(this,void 0,void 0,function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const B=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(B);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.tracksToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const H=this.peerClient.getSfuResource(),te=this.latestPubAttemptNum-1,re=performance.now()-this.startConnectingTimestamp,K=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:H,totalDurationWithRetries:re,retryTimes:te,peerClientPerfStats:K}),this.latestPubAttemptNum=0}catch(H){this.logger.error({msg:"publish failed!",err:H});const te=this.attemptTracker.trackPublishFailed(H),re=te.code===Bt.OPERATION_ABORTED.code,K=te.fatal,se=this.latestPubAttemptNum===4;if(re)return;if(K||se)return this.logger.error({msg:`Stopping attempts: isFatal=${K}, isLastAttempt=${se}`,err:H}),this.updateState(ja.ERRORED),void this.emit(Ns.ERROR,te);const he=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${he}ms`}),this.nextAttemptTimerId=window.setTimeout(()=>{this.tryPublish()},he)}}}),this.publish=(B,H)=>Eh(this,void 0,void 0,function*(){this.peerClient.initTracksToPublish(B),yield this.peerClient.connect({audioOnly:!1,traceId:H})}),this.unpublish=(B=!1)=>Eh(this,void 0,void 0,function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===ja.DISCONNECTED||this.publicationState===ja.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const H=B?wa.UNLOAD:wa.UNPUBLISH;try{B?this.peerClient.disconnect(B):yield this.peerClient.disconnect(B),this.attemptTracker.trackEndSucceeded(H)}catch{this.attemptTracker.trackEndFailed(H)}}),this.replaceOrUpdateTrack=B=>Eh(this,void 0,void 0,function*(){this.tracksToPublish.find(H=>H.track.kind===B.track.kind)?this.tracksToPublish=this.tracksToPublish.map(H=>H.track.kind===B.track.kind?B:H):this.tracksToPublish.push(B),yield this.peerClient.replaceOrUpdateTrack(B)}),this.onPeerClientConnectionStateChange=B=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${B}`,state:B}),this.processStateUpdate(B)},this.onPeerClientTransformError=B=>{this.emit(Ns.TRANSFORM_ERROR,B)},this.onIncompatibleCodecs=B=>Eh(this,void 0,void 0,function*(){yield this.peerClient.onIncompatibleCodecs(B)}),this.sendSeiMessage=B=>{this.peerClient.sendSeiMessage(B)},this.peerClient=new W0(S,this.nonScopedLogger,this.action,To(this.action),fc(),this.analyticsTracker,void 0,R,void 0),this.logger=new no(M,me.PUBLICATION),this.peerClient.on(Ys,this.onPeerClientConnectionStateChange,this),this.peerClient.on(ft,this.onPeerClientTransformError,this),this.publishTracker=new K0(this.analyticsTracker,this.token)}removeTrack(S){return Eh(this,void 0,void 0,function*(){this.tracksToPublish=this.tracksToPublish.filter(R=>R.track.kind!==S),yield this.peerClient.removeTrack(S)})}}var Hr,Jn=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};class Nx extends Ox{constructor(S,R,M,P,B){super(S,new no(M,me.LOCAL_PARTICIPANT)),this.onPublicationStateChange=H=>{switch(this.logger.debug({msg:"publicationStateChange",state:H}),H){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(Vs.PUBLISHED);break;case"connecting":this.updatePublishState(Vs.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(Vs.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:H})}},this.onPublicationError=H=>{this.emit(Ko.ERROR,H)},this.updatePublishState=H=>{this.info.isPublishing=H===Vs.PUBLISHED,this.publishState=H,this.emit(Ko.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=H=>{H.streamType===Xt.AUDIO&&(this.audioMuted=H.isMuted,this.info.audioMuted=H.isMuted),H.streamType===Xt.VIDEO&&(this.videoStopped=H.isMuted,this.info.videoStopped=H.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit(Ko.MEDIA_STREAM_MUTE_CHANGED,H)},this.publish=H=>{this.logger.debug({msg:"publish"}),H.forEach(re=>{re&&(this.setupStreamListener(re),re.streamType===Xt.AUDIO?(this.audioStream=re,this.audioMuted=!re.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):re.streamType===Xt.VIDEO&&(this.videoStream=re,this.videoStopped=!re.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),re.setGetStats(this.publication.requestRTCStats))}),this.connection.emitStageState(this.audioMuted,this.videoStopped);const te=H.map(re=>AE(re.mediaStreamTrack,re.mediaConfig));this.publication.start(te)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==Vs.NOT_PUBLISHED&&this.publishState!==Vs.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=H=>Jn(this,void 0,void 0,function*(){yield this.publication.onIncompatibleCodecs(H)}),this.sendSeiMessage=H=>{this.publication.sendSeiMessage(H)},this.sendSeiMessageString=H=>{const te=new TextEncoder().encode(H);this.publication.sendSeiMessage(te)},this.connection=P,this.createPublication=()=>{const H=new SR(R,P,M,B);return H.on(Ns.STATE_CHANGE,this.onPublicationStateChange),H.on(Ns.ERROR,this.onPublicationError),H.on(Ns.TRANSFORM_ERROR,this.onPublicationError),H},this.publication=this.createPublication()}setupStreamListener(S){S.on(vd.LOCAL_STREAM_MUTE_CHANGED,this.handleMute)}removeTrack(S){var R,M;S.streamType===Xt.AUDIO?((R=this.audioStream)===null||R===void 0||R.off(vd.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):S.streamType===Xt.VIDEO&&((M=this.videoStream)===null||M===void 0||M.off(vd.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(S.streamType)}replaceOrAddTrack(S){return Jn(this,void 0,void 0,function*(){this.setupStreamListener(S),S.setGetStats(this.publication.requestRTCStats),S.streamType===Xt.AUDIO?(this.audioStream=S,this.audioMuted=!S.mediaStreamTrack.enabled):S.streamType===Xt.VIDEO&&(this.videoStream=S,this.videoStopped=!S.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const R=AE(S.mediaStreamTrack,S.mediaConfig);yield this.publication.replaceOrUpdateTrack(R)})}unpublish(){if(this.publishState===Vs.NOT_PUBLISHED||this.publishState===Vs.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(Ns.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(Ns.ERROR,this.onPublicationError),this.publication.off(Ns.TRANSFORM_ERROR,this.onPublicationError);const S=[this.audioStream,this.videoStream].filter(R=>!!R);S.forEach(R=>{R.cleanup()}),this.audioStream=void 0,this.videoStream=void 0,this.emit(Ko.MEDIA_STREAM_REMOVED,S),this.updatePublishState(Vs.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(O){O.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",O.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",O.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",O.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",O.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",O.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",O.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",O.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",O.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",O.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",O.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",O.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",O.ERROR="error",O.STAGE_LEFT="stageLeft"})(Hr||(Hr={}));var co=function(O,S,R,M){return new(R||(R=Promise))(function(P,B){function H(K){try{re(M.next(K))}catch(se){B(se)}}function te(K){try{re(M.throw(K))}catch(se){B(se)}}function re(K){var se;K.done?P(K.value):(se=K.value,se instanceof R?se:new R(function(he){he(se)})).then(H,te)}re((M=M.apply(O,[])).next())})};const Is=O=>!!O;class mf extends Yc{constructor(S,R){super(),this.connectionState=hs.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(P,B)=>{var H,te;if(this.connectionState=P,P===hs.ERRORED&&(this.connectionStateErrored=!0),P===hs.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==Vs.NOT_PUBLISHED&&this.stageConnection.emitStageState((H=this.localParticipant)===null||H===void 0?void 0:H.audioMuted,(te=this.localParticipant)===null||te===void 0?void 0:te.videoStopped),P===hs.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),P===hs.DISCONNECTED){if(B&&B!==Iu.CLIENT_RECONNECT&&B!==Iu.USER_INITIATED){let re=qm.UNKNOWN;(function(K){return Object.values(qm).includes(K)})(B)?re=B:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${B}`}),this.cleanup(re)}}else this.emit(Hr.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var P;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new Rm(this.token,(P=this.joinTraceId)!==null&&P!==void 0?P:new fE,"reusing local participant from repeat join",dn.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const P=function(B){var H,te;const re=new Set;return B.token.claims.capabilities.allow_publish&&re.add(bh.PUBLISH),B.token.claims.capabilities.allow_subscribe&&re.add(bh.SUBSCRIBE),{id:B.token.participantID,userId:(H=B.token.userID)!==null&&H!==void 0?H:"",attributes:(te=B.token.claims.attributes)!==null&&te!==void 0?te:{},capabilities:re,isLocal:!0,userInfo:{},videoStopped:B.videoStopped,audioMuted:B.audioMuted,isPublishing:B.isPublishing}}({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new Nx(P,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on(Ko.PUBLICATION_STATE_CHANGE,B=>{this.onPublishStateChanged(this.localParticipant.info,B)}),this.localParticipant.on(Ko.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on(Ko.MEDIA_STREAM_MUTE_CHANGED,B=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,B):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})}),this.localParticipant.on(Ko.ERROR,B=>{this.errorManager.handleError(B,gd.PUBLISH_ERROR)}),this.emit(Hr.STAGE_PARTICIPANT_JOINED,P)},this.onRemoteParticipantJoined=P=>{var B;if(P.id!==((B=this.localParticipant)===null||B===void 0?void 0:B.info.id)){const H=function(se){return{id:se.id,userId:se.userId,attributes:se.attributes,capabilities:new Set([bh.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:se.videoStopped,audioMuted:se.audioMuted,isPublishing:se.isPublishing}}(P);if(this.participants.has(H.id))return void this.logger.warn({msg:"Remote participant already tracked"});let te=Ro.NONE;H.capabilities.has(bh.SUBSCRIBE)&&(te=ti.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(H),te),this.updateManagerWithExternalSubscribeConfig(H,"joined"));const re=this.configManager.getSubscribeConfigSnapshot(H.id),K=new ER(H,this.token,this.stageConnection,this.logger.unwrap(),te,re,this.analyticsTracker,P.isPublishing);this.participants.set(H.id,K),this.setupRemoteParticipantListeners(K),this.emit(Hr.STAGE_PARTICIPANT_JOINED,K.info),K.updateSubscribeStateIfNecessary(te)}},this.setupRemoteParticipantListeners=P=>{P.on(oo.SUBSCRIPTION_STATE_CHANGE,B=>{this.onParticipantSubscribeStateChanged(P.info.id,B)}),P.on(oo.MEDIA_STREAM_ADDED,B=>{const H=this.participants.get(P.info.id);if(H){for(const te of B)this.setupRemoteParticipantStreamEvents(H.info,te);this.emit(Hr.STAGE_PARTICIPANT_STREAMS_ADDED,H.info,LE(B)),this.updateStreamLayerForParticipant(P)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})}),P.on(oo.MEDIA_STREAM_REMOVED,B=>{const H=this.participants.get(P.info.id);H?this.emit(Hr.STAGE_PARTICIPANT_STREAMS_REMOVED,H.info,LE(B)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})}),P.on(oo.MEDIA_STREAM_MUTE_CHANGED,B=>{this.onStreamMuteChange(P.info,B.remote)}),P.on(oo.ERROR,B=>{this.errorManager.handleError(B,gd.SUBSCRIBE_ERROR)}),P.on(oo.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,B=>{this.onSeiMessageReceived(P.info,B)})},this.onRemoteParticipantLeft=P=>{if(this.connectionState!==hs.CONNECTED)return;const B=this.participants.get(P);B?(B.participantLeave(),B.unsubscribe(),B.cleanup(),this.participants.delete(P),this.emitParticipantLeave(B.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=P=>{this.emit(Hr.STAGE_PARTICIPANT_LEFT,P)},this.onRemoteParticipantStateChanged=P=>{const B=this.participants.get(P.id);if(!B)return void this.logger.warn({msg:"Remote participant updated but not tracked"});B.updatePublishState(P.isPublishing)&&this.onPublishStateChanged(B.info,B.publishState),B.updateStreamState(P.audioMuted,P.videoStopped);const H=this.strategyWrapper.shouldSubscribeToParticipant(B.info);if(ti.isNotOk(H))return;this.updateManagerWithExternalSubscribeConfig(B.info,"updated");const te=this.configManager.getSubscribeConfigSnapshot(B.info.id),re=ti.getOk_or(H,Ro.NONE);B.updateSubscribeStateIfNecessary(re,te)},this.onPublishStateChanged=(P,B)=>{this.emit(Hr.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,P,B)},this.onParticipantSubscribeStateChanged=(P,B)=>{const H=this.participants.get(P);H?this.emit(Hr.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,H.info,B):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=P=>{this.localParticipant&&this.emit(Hr.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,P)},this.onLocalStreamsRemoved=P=>{this.localParticipant&&this.emit(Hr.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,P)},this.onStreamMuteChange=(P,B)=>{this.emit(Hr.STAGE_STREAM_MUTE_CHANGED,P,B)},this.onSeiMessageReceived=(P,B)=>{this.emit(Hr.STAGE_STREAM_SEI_MESSAGE_RECEIVED,P,B)},this.leave=()=>{this.cleanup(qm.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var P;this.participants.forEach(B=>{B.quickUnsubscribe()}),(P=this.localParticipant)===null||P===void 0||P.quickUnpublish(),this.stageConnection.disconnect(),this.emit(Hr.STAGE_CONNECTION_STATE_CHANGED,hs.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=P=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new Eu({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:P})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const B=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(B);const H=this.participants.entries();for(const[te,re]of H)re.unsubscribe(),this.participants.delete(te),re.cleanup(),this.emitParticipantLeave(re.info);Lm.destroy(),this.stageConnection.disconnect(),this.emit(Hr.STAGE_CONNECTION_STATE_CHANGED,hs.DISCONNECTED),this.emit(Hr.STAGE_LEFT,P),this.stageConnection.removeAllListeners(),this.stageConnection=new wE(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners(),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach(P=>{if(P.info.capabilities.has(bh.SUBSCRIBE)){const B=this.strategyWrapper.shouldSubscribeToParticipant(P.info);if(ti.isNotOk(B))return;const H=ti.getOk_or(B,Ro.NONE);this.updateManagerWithExternalSubscribeConfig(P.info,"updated");const te=this.configManager.getSubscribeConfigSnapshot(P.info.id);P.updateSubscribeStateIfNecessary(H,te),this.updateStreamLayerForParticipant(P)}}),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var P;if(!this.localParticipant||!(!((P=this.localParticipant)===null||P===void 0)&&P.info.capabilities.has(bh.PUBLISH)))return;const B=this.localParticipant.publishState!==Vs.NOT_PUBLISHED&&this.localParticipant.publishState!==Vs.ERRORED,H=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(ti.isNotOk(H))return;let te=ti.getOk_or(H,!1);if(!B&&!te)return;if(B&&!te)return void this.localParticipant.unpublish();const re=this.strategyWrapper.stageStreamsToPublish();if(ti.isNotOk(re)){const se=ti.getErr(re);if(se instanceof Error&&se.cause==="UserStrategy")throw se;return}const K=ti.getOk_or(re,[]);te=te&&K.length>0,!B&&te?(this.localParticipant.publish(K),this.onLocalStreamsAdded(K)):this.syncTracksToPublish(K)},this.syncTracksToPublish=P=>{var B;if(!this.localParticipant)return;const H=this.localParticipant.audioStream,te=this.localParticipant.videoStream,{updates:re,streamsToAdd:K,streamsToRemove:se}=this.determineStreamUpdates(H,te,P);if(re.length){for(const he of re)he.newStream?(B=this.localParticipant)===null||B===void 0||B.replaceOrAddTrack(he.newStream):he.oldStream&&this.localParticipant.removeTrack(he.oldStream);se.length!==0&&this.onLocalStreamsRemoved(se),K.length!==0&&this.onLocalStreamsAdded(K)}},this.determineStreamUpdates=(P,B,H=[])=>{const te=[],re=H.slice(0,2);if(re.sort((he,pe)=>he.streamType===Xt.AUDIO?-1:1),re.length===0)P&&te.push({oldStream:P}),B&&te.push({oldStream:B});else if(re.length===1){const he=re[0];he.streamType===Xt.AUDIO?B&&te.push({oldStream:B}):he.streamType===Xt.VIDEO&&P&&te.push({oldStream:P})}re.forEach(he=>{var pe,Ne;he.streamType===Xt.AUDIO?P?P.id===he.id&&(0,ua.isEqual)(P.mediaConfig,he.mediaConfig)||(!!(!((pe=P.mediaConfig)===null||pe===void 0)&&pe.stereo)!=!!(!((Ne=he.mediaConfig)===null||Ne===void 0)&&Ne.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),te.push({oldStream:P,newStream:he})):te.push({newStream:he}):he.streamType===Xt.VIDEO&&(B?B.id===he.id&&(0,ua.isEqual)(B.mediaConfig,he.mediaConfig)||te.push({oldStream:B,newStream:he}):te.push({newStream:he}))});const K=te.map(he=>he.newStream).filter(Is),se=te.map(he=>he.oldStream).filter(Is);return{updates:te,streamsToAdd:K,streamsToRemove:se}},this.onReassignmentMessage=P=>co(this,void 0,void 0,function*(){if(ah("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!us.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const B=fc();this.trackReassignmentRequest(P,B);const H=this.participants.get(P.remoteParticipantId),te=this.token.participantID,re=function(K,{localParticipantId:se,remoteParticipant:he}){const{participantId:pe}=K;if(se!==pe)return ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${pe}`}));if(!he)return ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${he}`}));if(he.isReassigning())return ti.err(Bt.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const Ne=he.subscription.peerClient.getConnectionState();return[at.CONNECTED,at.DISCONNECTED].includes(Ne)?ti.ok(he):ti.err(Object.assign(Object.assign({},Bt.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${Ne}`}))}(P,{localParticipantId:te,remoteParticipant:H});if(!re.ok)this.trackReassignmentRequestRejected(re.error,B);else try{const{token:K,nodeOverride:se}=P;yield re.value.triggerIceRestart({assignmentToken:K,traceId:B,nodeOverride:se})}catch(K){this.logger.error({msg:"Reassignment failed.",err:K})}}),this.onIncompatibleCodecsMessage=P=>co(this,void 0,void 0,function*(){var B;yield(B=this.localParticipant)===null||B===void 0?void 0:B.onIncompatibleCodecs(P.codecs)}),this.analyticsTracker=new sd;const M=h0();this.logger=new no(new _m(M),me.STAGE),this.strategyWrapper=new _R(R,this.logger),this.configManager=new yR({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:js.DEFAULT,minDelayWhenSubscribeOnly:js.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:Gl.LOWEST_QUALITY}}}),this.errorManager=new vR;try{this.token=xu(S,this.analyticsTracker)}catch(P){const B=new Ii(Object.assign({action:dn.JOIN,token:S,traceId:fc(),tag:pc.JOIN_RELATED,location:"Stage.constructor"},Bt.MALFORMED_TOKEN));throw P instanceof Error&&(B.details=P.message),this.errorManager.handleError(B,gd.JOIN_ERROR)||P}this.stageConnection=new wE(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(bl,(S,R)=>{this.onConnectionStateChanged(S,R)}),this.stageConnection.on(cf,S=>{this.onRemoteParticipantJoined(S)}),this.stageConnection.on(ld,S=>{this.onRemoteParticipantLeft(S.id)}),this.stageConnection.on(w0,S=>{var R;S.id!==((R=this.localParticipant)===null||R===void 0?void 0:R.info.id)&&this.onRemoteParticipantStateChanged(S)}),this.stageConnection.on(jl,S=>co(this,void 0,void 0,function*(){yield this.onReassignmentMessage(S)})),this.stageConnection.on(lf,S=>co(this,void 0,void 0,function*(){yield this.onIncompatibleCodecsMessage(S)})),this.stageConnection.on(bp,S=>{S instanceof Ii&&this.analyticsTracker.trackError(S),this.errorManager.handleError(S,gd.JOIN_ERROR)}),this.errorManager.on(jm.ERROR,S=>{this.emit(Hr.ERROR,S)})}setupRemoteParticipantStreamEvents(S,R){const M=R.remote;R.on(Lu.ADAPTION_CHANGED,P=>{this.emit(Hr.STAGE_STREAM_ADAPTION_CHANGED,S,M,P)}),R.on(Lu.LAYERS_CHANGED,P=>{this.emit(Hr.STAGE_STREAM_LAYERS_CHANGED,S,M,P)}),R.on(Lu.LAYER_SELECTED,(P,B)=>{this.emit(Hr.STAGE_STREAM_LAYER_SELECTED,S,M,P,B)}),R.layers.length>0&&(this.emit(Hr.STAGE_STREAM_LAYERS_CHANGED,S,M,M.getLayers()),this.emit(Hr.STAGE_STREAM_LAYER_SELECTED,S,M,M.getSelectedLayer(),_h.SELECTED))}join(){return co(this,void 0,void 0,function*(){this.analyticsTracker.start(),this.joinTraceId=fc(),this.analyticsTracker.trackEvent(new j0({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(fc(),pc.JOIN_RELATED,"join")}catch(S){throw this.errorManager.handleError(S,gd.JOIN_ERROR)||S}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===hs.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(S){throw this.logger.error({err:S,msg:"error joining stage"}),this.errorManager.handleError(S,gd.JOIN_ERROR,!1)||S}})}replaceStrategy(S){this.strategyWrapper.setStrategy(S),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(S,R){const M=ti.getOk(this.strategyWrapper.subscribeConfiguration(S));if(M===void 0)return;const P=S.id;if(this.configManager.handleExternalSubscribeConfigUpdate(P,M,Vm.API)){const B=this.configManager.getSubscribeConfigSnapshot(P);this.analyticsTracker.trackEventNoSharedProps(new Om(this.token,this.joinTraceId,{trigger:R==="joined"?"initial":"ad-hoc",remote_participant_id:P,min_delay_when_publishing:Fa(B.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:Fa(B.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:B.inBandMessaging.enabled,simulcast_initial_layer_preference:B.simulcast.initialLayerPreference}))}}updateStreamLayerForParticipant(S){S.streams.forEach(R=>{if(R.streamType==="audio")return;const M=this.strategyWrapper.preferredLayerForStream(S.info,R.remote),P=ti.getOk_or(M,void 0);R.setLayer(P)})}trackReassignmentRequestRejected(S,R){const{token:M}=this,P=new Ii(Object.assign(Object.assign({},S),{token:M,action:dn.JOIN,traceId:R,tag:pc.SUBSCRIBE_RELATED,location:"publish"}));this.logger.error({err:P,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(P)}trackReassignmentRequest(S,R){const{token:M}=this;this.analyticsTracker.trackEvent(new Mx({token:M,traceId:R,targetLocalParticipantId:S.participantId,targetRemoteParticipantId:S.remoteParticipantId}))}}var qm;(function(O){O.UNKNOWN="unknown",O.USER_INITIATED="user-initiated",O.TOKEN_REUSED="token-reused",O.PARTICIPANT_DISCONNECTED="participant-disconnected",O.STAGE_DELETED="stage-deleted"})(qm||(qm={}));const zE=h})(),s})())})(oEe);var Pyt=oEe.exports;const dS=Gc(Pyt),cEe="0123456789abcdefABCDEF";cEe.split("").map(t=>t.codePointAt(0));Array(256).fill(!0).map((t,e)=>{const n=String.fromCodePoint(e),i=cEe.indexOf(n);return i<0?void 0:i<16?i:i-6});new TextEncoder;new TextDecoder;function v1(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;++i)if(t[i]!==e[i])return t[i]<e[i]?-1:1;return t.length===e.length?0:t.length>e.length?1:-1}var Lyt=(t,e,n=Math.min(t.length,e.length))=>{for(let i=0;i<n;i++){const r=t[i],s=e[i];if(r!==s)return 8*n-(i*8+Math.clz32(r^s)-24)}return 0},Uyt=class{constructor(t,e){this.id=t,this.bucketSize=e.bucketSize||20,this.buckets=new Array(t.length*8+1).fill(void 0).map(()=>[]),this.compare=e.compare||(()=>0),this.getId=e.getId}get length(){return this.buckets.reduce((t,e)=>t+e.length,0)}*[Symbol.iterator](){for(const t of this.buckets)for(const e of t)yield e}add(t,e=this.getBitwiseDistance(this.getId(t))){if(this.has(this.getId(t),e))return!1;if(this.buckets[e].length<this.bucketSize)return this.buckets[e].push(t),!0;const n=this.buckets[e].slice(0);n.push(t);const i=n.sort(this.compare);this.buckets[e]=i.slice(0,this.bucketSize);const r=i.at(-1);return v1(this.getId(t),this.getId(r))!==0}clear(){for(let t=0;t<this.buckets.length;t++)this.buckets[t]=[]}listClosestToId(t,e=this.buckets.length*this.bucketSize){const n=this.getBitwiseDistance(t);return this.getNodes(n,e)}get(t){const e=this.buckets[t].shift();return e&&this.buckets[t].push(e),e}getById(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(r=>v1(this.getId(r),t)===0);if(n===-1)return;const i=this.buckets[e][n];return this.buckets[e]=this.buckets[e].splice(n,1).concat(i),i}getBitwiseDistance(t){return Lyt(this.id,t)}getNodes(t,e,n=0){const i=(n%2===0?1:-1)*Math.ceil(n/2);if(Math.abs(i)>Math.max(t,this.buckets.length-1-t))return[];const r=t+i;if(0>r||r>this.buckets.length-1)return this.getNodes(t,e,n+1);const s=this.buckets[r].slice(0,e);return s.length>=e?(this.buckets[r]=this.buckets[r].slice(s.length).concat(this.buckets[r].slice(0,s.length)),s):s.concat(this.getNodes(t,e-s.length,n+1))}has(t,e=this.getBitwiseDistance(t)){return!!this.buckets[e].find(n=>v1(this.getId(n),t)===0)}peek(t){return this.buckets[t].at(0)}peekById(t,e=this.getBitwiseDistance(t)){return this.buckets[e].find(n=>v1(this.getId(n),t)===0)}update(t,e=this.getBitwiseDistance(this.getId(t))){const n=this.buckets[e].findIndex(i=>v1(this.getId(i),this.getId(t))===0);return n===-1?!1:(this.buckets[e][n]=t,!0)}remove(t,e=this.getBitwiseDistance(t)){const n=this.buckets[e].findIndex(i=>v1(this.getId(i),t)===0);return n===-1?!1:(this.buckets[e].splice(n,1),!0)}},lEe={exports:{}};(function(t){var e=function(){function n(d,f){return f!=null&&d instanceof f}var i;try{i=Map}catch{i=function(){}}var r;try{r=Set}catch{r=function(){}}var s;try{s=Promise}catch{s=function(){}}function a(d,f,p,g,_){typeof f=="object"&&(p=f.depth,g=f.prototype,_=f.includeNonEnumerable,f=f.circular);var v=[],E=[],T=typeof kl<"u";typeof f>"u"&&(f=!0),typeof p>"u"&&(p=1/0);function x(N,A){if(N===null)return null;if(A===0)return N;var I,k;if(typeof N!="object")return N;if(n(N,i))I=new i;else if(n(N,r))I=new r;else if(n(N,s))I=new s(function(Z,Y){N.then(function(ee){Z(x(ee,A-1))},function(ee){Y(x(ee,A-1))})});else if(a.__isArray(N))I=[];else if(a.__isRegExp(N))I=new RegExp(N.source,h(N)),N.lastIndex&&(I.lastIndex=N.lastIndex);else if(a.__isDate(N))I=new Date(N.getTime());else{if(T&&kl.isBuffer(N))return kl.allocUnsafe?I=kl.allocUnsafe(N.length):I=new kl(N.length),N.copy(I),I;n(N,Error)?I=Object.create(N):typeof g>"u"?(k=Object.getPrototypeOf(N),I=Object.create(k)):(I=Object.create(g),k=g)}if(f){var L=v.indexOf(N);if(L!=-1)return E[L];v.push(N),E.push(I)}n(N,i)&&N.forEach(function(Z,Y){var ee=x(Y,A-1),oe=x(Z,A-1);I.set(ee,oe)}),n(N,r)&&N.forEach(function(Z){var Y=x(Z,A-1);I.add(Y)});for(var U in N){var $;k&&($=Object.getOwnPropertyDescriptor(k,U)),!($&&$.set==null)&&(I[U]=x(N[U],A-1))}if(Object.getOwnPropertySymbols)for(var q=Object.getOwnPropertySymbols(N),U=0;U<q.length;U++){var G=q[U],X=Object.getOwnPropertyDescriptor(N,G);X&&!X.enumerable&&!_||(I[G]=x(N[G],A-1),X.enumerable||Object.defineProperty(I,G,{enumerable:!1}))}if(_)for(var ie=Object.getOwnPropertyNames(N),U=0;U<ie.length;U++){var V=ie[U],X=Object.getOwnPropertyDescriptor(N,V);X&&X.enumerable||(I[V]=x(N[V],A-1),Object.defineProperty(I,V,{enumerable:!1}))}return I}return x(d,p)}a.clonePrototype=function(f){if(f===null)return null;var p=function(){};return p.prototype=f,new p};function o(d){return Object.prototype.toString.call(d)}a.__objToStr=o;function c(d){return typeof d=="object"&&o(d)==="[object Date]"}a.__isDate=c;function l(d){return typeof d=="object"&&o(d)==="[object Array]"}a.__isArray=l;function u(d){return typeof d=="object"&&o(d)==="[object RegExp]"}a.__isRegExp=u;function h(d){var f="";return d.global&&(f+="g"),d.ignoreCase&&(f+="i"),d.multiline&&(f+="m"),f}return a.__getRegExpFlags=h,a}();t.exports&&(t.exports=e)})(lEe);var Byt=lEe.exports,JG={exports:{}},uj,lre;function Fyt(){if(lre)return uj;lre=1;var t=1e3,e=t*60,n=e*60,i=n*24,r=i*7,s=i*365.25;uj=function(u,h){h=h||{};var d=typeof u;if(d==="string"&&u.length>0)return a(u);if(d==="number"&&isFinite(u))return h.long?c(u):o(u);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(u))};function a(u){if(u=String(u),!(u.length>100)){var h=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(u);if(h){var d=parseFloat(h[1]),f=(h[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return d*s;case"weeks":case"week":case"w":return d*r;case"days":case"day":case"d":return d*i;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*e;case"seconds":case"second":case"secs":case"sec":case"s":return d*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function o(u){var h=Math.abs(u);return h>=i?Math.round(u/i)+"d":h>=n?Math.round(u/n)+"h":h>=e?Math.round(u/e)+"m":h>=t?Math.round(u/t)+"s":u+"ms"}function c(u){var h=Math.abs(u);return h>=i?l(u,h,i,"day"):h>=n?l(u,h,n,"hour"):h>=e?l(u,h,e,"minute"):h>=t?l(u,h,t,"second"):u+" ms"}function l(u,h,d,f){var p=h>=d*1.5;return Math.round(u/d)+" "+f+(p?"s":"")}return uj}function zyt(t){n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=r,n.enabled=a,n.humanize=Fyt(),n.destroy=l,Object.keys(t).forEach(u=>{n[u]=t[u]}),n.names=[],n.skips=[],n.formatters={};function e(u){let h=0;for(let d=0;d<u.length;d++)h=(h<<5)-h+u.charCodeAt(d),h|=0;return n.colors[Math.abs(h)%n.colors.length]}n.selectColor=e;function n(u){let h,d=null,f,p;function g(..._){if(!g.enabled)return;const v=g,E=Number(new Date),T=E-(h||E);v.diff=T,v.prev=h,v.curr=E,h=E,_[0]=n.coerce(_[0]),typeof _[0]!="string"&&_.unshift("%O");let x=0;_[0]=_[0].replace(/%([a-zA-Z%])/g,(A,I)=>{if(A==="%%")return"%";x++;const k=n.formatters[I];if(typeof k=="function"){const L=_[x];A=k.call(v,L),_.splice(x,1),x--}return A}),n.formatArgs.call(v,_),(v.log||n.log).apply(v,_)}return g.namespace=u,g.useColors=n.useColors(),g.color=n.selectColor(u),g.extend=i,g.destroy=n.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==n.namespaces&&(f=n.namespaces,p=n.enabled(u)),p),set:_=>{d=_}}),typeof n.init=="function"&&n.init(g),g}function i(u,h){const d=n(this.namespace+(typeof h>"u"?":":h)+u);return d.log=this.log,d}function r(u){n.save(u),n.namespaces=u,n.names=[],n.skips=[];let h;const d=(typeof u=="string"?u:"").split(/[\s,]+/),f=d.length;for(h=0;h<f;h++)d[h]&&(u=d[h].replace(/\*/g,".*?"),u[0]==="-"?n.skips.push(new RegExp("^"+u.slice(1)+"$")):n.names.push(new RegExp("^"+u+"$")))}function s(){const u=[...n.names.map(o),...n.skips.map(o).map(h=>"-"+h)].join(",");return n.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,d;for(h=0,d=n.skips.length;h<d;h++)if(n.skips[h].test(u))return!1;for(h=0,d=n.names.length;h<d;h++)if(n.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack||u.message:u}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var Hyt=zyt;(function(t,e){var n={};e.formatArgs=r,e.save=s,e.load=a,e.useColors=i,e.storage=o(),e.destroy=(()=>{let l=!1;return()=>{l||(l=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function i(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let l;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(l=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(l[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(l){if(l[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+l[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const u="color: "+this.color;l.splice(1,0,u,"color: inherit");let h=0,d=0;l[0].replace(/%[a-zA-Z%]/g,f=>{f!=="%%"&&(h++,f==="%c"&&(d=h))}),l.splice(d,0,u)}e.log=console.debug||console.log||(()=>{});function s(l){try{l?e.storage.setItem("debug",l):e.storage.removeItem("debug")}catch{}}function a(){let l;try{l=e.storage.getItem("debug")}catch{}return!l&&typeof zn<"u"&&"env"in zn&&(l=n.DEBUG),l}function o(){try{return localStorage}catch{}}t.exports=Hyt(e);const{formatters:c}=t.exports;c.j=function(l){try{return JSON.stringify(l)}catch(u){return"[UnexpectedJSONParseError]: "+u.message}}})(JG,JG.exports);var ez=JG.exports,jyt=function(){if(typeof globalThis>"u")return null;var e={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return e.RTCPeerConnection?e:null},ZG={exports:{}},QG={exports:{}};const II=jre(y8e);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var n=II,i=n.Buffer;function r(a,o){for(var c in a)o[c]=a[c]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=n:(r(n,e),e.Buffer=s);function s(a,o,c){return i(a,o,c)}s.prototype=Object.create(i.prototype),r(i,s),s.from=function(a,o,c){if(typeof a=="number")throw new TypeError("Argument must not be a number");return i(a,o,c)},s.alloc=function(a,o,c){if(typeof a!="number")throw new TypeError("Argument must be a number");var l=i(a);return o!==void 0?typeof c=="string"?l.fill(o,c):l.fill(o):l.fill(0),l},s.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return i(a)},s.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}})(QG,QG.exports);var uEe=QG.exports,hj=65536,Vyt=4294967295;function Gyt(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var qyt=uEe.Buffer,VU=Ll.crypto||Ll.msCrypto;VU&&VU.getRandomValues?ZG.exports=$yt:ZG.exports=Gyt;function $yt(t,e){if(t>Vyt)throw new RangeError("requested too many random bytes");var n=qyt.allocUnsafe(t);if(t>0)if(t>hj)for(var i=0;i<t;i+=hj)VU.getRandomValues(n.slice(i,i+hj));else VU.getRandomValues(n);return typeof e=="function"?zn.nextTick(function(){e(null,n)}):n}var tz=ZG.exports,eq={exports:{}},sX={exports:{}},Iw=typeof Reflect=="object"?Reflect:null,ure=Iw&&typeof Iw.apply=="function"?Iw.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},zP;Iw&&typeof Iw.ownKeys=="function"?zP=Iw.ownKeys:Object.getOwnPropertySymbols?zP=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:zP=function(e){return Object.getOwnPropertyNames(e)};function Wyt(t){console&&console.warn&&console.warn(t)}var hEe=Number.isNaN||function(e){return e!==e};function zs(){zs.init.call(this)}sX.exports=zs;sX.exports.once=Jyt;zs.EventEmitter=zs;zs.prototype._events=void 0;zs.prototype._eventsCount=0;zs.prototype._maxListeners=void 0;var hre=10;function nz(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(zs,"defaultMaxListeners",{enumerable:!0,get:function(){return hre},set:function(t){if(typeof t!="number"||t<0||hEe(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");hre=t}});zs.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};zs.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||hEe(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function dEe(t){return t._maxListeners===void 0?zs.defaultMaxListeners:t._maxListeners}zs.prototype.getMaxListeners=function(){return dEe(this)};zs.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var c=s[e];if(c===void 0)return!1;if(typeof c=="function")ure(c,this,n);else for(var l=c.length,u=vEe(c,l),i=0;i<l;++i)ure(u[i],this,n);return!0};function fEe(t,e,n,i){var r,s,a;if(nz(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=dEe(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,Wyt(o)}return t}zs.prototype.addListener=function(e,n){return fEe(this,e,n,!1)};zs.prototype.on=zs.prototype.addListener;zs.prototype.prependListener=function(e,n){return fEe(this,e,n,!0)};function Yyt(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function pEe(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=Yyt.bind(i);return r.listener=n,i.wrapFn=r,r}zs.prototype.once=function(e,n){return nz(n),this.on(e,pEe(this,e,n)),this};zs.prototype.prependOnceListener=function(e,n){return nz(n),this.prependListener(e,pEe(this,e,n)),this};zs.prototype.removeListener=function(e,n){var i,r,s,a,o;if(nz(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():Xyt(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};zs.prototype.off=zs.prototype.removeListener;zs.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(r=0;r<s.length;++r)a=s[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function mEe(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?Kyt(r):vEe(r,r.length)}zs.prototype.listeners=function(e){return mEe(this,e,!0)};zs.prototype.rawListeners=function(e){return mEe(this,e,!1)};zs.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):gEe.call(t,e)};zs.prototype.listenerCount=gEe;function gEe(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}zs.prototype.eventNames=function(){return this._eventsCount>0?zP(this._events):[]};function vEe(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function Xyt(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Kyt(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Jyt(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}yEe(t,e,s,{once:!0}),e!=="error"&&Zyt(t,r,{once:!0})})}function Zyt(t,e,n){typeof t.on=="function"&&yEe(t,"error",e,n)}function yEe(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var kI=sX.exports;const $Et=Gc(kI);var _Ee=kI.EventEmitter,dj,dre;function Qyt(){if(dre)return dj;dre=1;function t(p,g){var _=Object.keys(p);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(p);g&&(v=v.filter(function(E){return Object.getOwnPropertyDescriptor(p,E).enumerable})),_.push.apply(_,v)}return _}function e(p){for(var g=1;g<arguments.length;g++){var _=arguments[g]!=null?arguments[g]:{};g%2?t(Object(_),!0).forEach(function(v){n(p,v,_[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(p,Object.getOwnPropertyDescriptors(_)):t(Object(_)).forEach(function(v){Object.defineProperty(p,v,Object.getOwnPropertyDescriptor(_,v))})}return p}function n(p,g,_){return g=a(g),g in p?Object.defineProperty(p,g,{value:_,enumerable:!0,configurable:!0,writable:!0}):p[g]=_,p}function i(p,g){if(!(p instanceof g))throw new TypeError("Cannot call a class as a function")}function r(p,g){for(var _=0;_<g.length;_++){var v=g[_];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(p,a(v.key),v)}}function s(p,g,_){return g&&r(p.prototype,g),Object.defineProperty(p,"prototype",{writable:!1}),p}function a(p){var g=o(p,"string");return typeof g=="symbol"?g:String(g)}function o(p,g){if(typeof p!="object"||p===null)return p;var _=p[Symbol.toPrimitive];if(_!==void 0){var v=_.call(p,g||"default");if(typeof v!="object")return v;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(p)}var c=II,l=c.Buffer,u=xT,h=u.inspect,d=h&&h.custom||"inspect";function f(p,g,_){l.prototype.copy.call(p,g,_)}return dj=function(){function p(){i(this,p),this.head=null,this.tail=null,this.length=0}return s(p,[{key:"push",value:function(_){var v={data:_,next:null};this.length>0?this.tail.next=v:this.head=v,this.tail=v,++this.length}},{key:"unshift",value:function(_){var v={data:_,next:this.head};this.length===0&&(this.tail=v),this.head=v,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var v=this.head,E=""+v.data;v=v.next;)E+=_+v.data;return E}},{key:"concat",value:function(_){if(this.length===0)return l.alloc(0);for(var v=l.allocUnsafe(_>>>0),E=this.head,T=0;E;)f(E.data,v,T),T+=E.data.length,E=E.next;return v}},{key:"consume",value:function(_,v){var E;return _<this.head.data.length?(E=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?E=this.shift():E=v?this._getString(_):this._getBuffer(_),E}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var v=this.head,E=1,T=v.data;for(_-=T.length;v=v.next;){var x=v.data,N=_>x.length?x.length:_;if(N===x.length?T+=x:T+=x.slice(0,_),_-=N,_===0){N===x.length?(++E,v.next?this.head=v.next:this.head=this.tail=null):(this.head=v,v.data=x.slice(N));break}++E}return this.length-=E,T}},{key:"_getBuffer",value:function(_){var v=l.allocUnsafe(_),E=this.head,T=1;for(E.data.copy(v),_-=E.data.length;E=E.next;){var x=E.data,N=_>x.length?x.length:_;if(x.copy(v,v.length-_,0,N),_-=N,_===0){N===x.length?(++T,E.next?this.head=E.next:this.head=this.tail=null):(this.head=E,E.data=x.slice(N));break}++T}return this.length-=T,v}},{key:d,value:function(_,v){return h(this,e(e({},v),{},{depth:0,customInspect:!1}))}}]),p}(),dj}function e_t(t,e){var n=this,i=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return i||r?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,zn.nextTick(tq,this,t)):zn.nextTick(tq,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(s){!e&&s?n._writableState?n._writableState.errorEmitted?zn.nextTick(HP,n):(n._writableState.errorEmitted=!0,zn.nextTick(fre,n,s)):zn.nextTick(fre,n,s):e?(zn.nextTick(HP,n),e(s)):zn.nextTick(HP,n)}),this)}function fre(t,e){tq(t,e),HP(t)}function HP(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function t_t(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function tq(t,e){t.emit("error",e)}function n_t(t,e){var n=t._readableState,i=t._writableState;n&&n.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}var bEe={destroy:e_t,undestroy:t_t,errorOrDestroy:n_t},cx={};function i_t(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var EEe={};function pp(t,e,n){n||(n=Error);function i(s,a,o){return typeof e=="string"?e:e(s,a,o)}var r=function(s){i_t(a,s);function a(o,c,l){return s.call(this,i(o,c,l))||this}return a}(n);r.prototype.name=n.name,r.prototype.code=t,EEe[t]=r}function pre(t,e){if(Array.isArray(t)){var n=t.length;return t=t.map(function(i){return String(i)}),n>2?"one of ".concat(e," ").concat(t.slice(0,n-1).join(", "),", or ")+t[n-1]:n===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function r_t(t,e,n){return t.substr(0,e.length)===e}function s_t(t,e,n){return(n===void 0||n>t.length)&&(n=t.length),t.substring(n-e.length,n)===e}function a_t(t,e,n){return typeof n!="number"&&(n=0),n+e.length>t.length?!1:t.indexOf(e,n)!==-1}pp("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);pp("ERR_INVALID_ARG_TYPE",function(t,e,n){var i;typeof e=="string"&&r_t(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be";var r;if(s_t(t," argument"))r="The ".concat(t," ").concat(i," ").concat(pre(e,"type"));else{var s=a_t(t,".")?"property":"argument";r='The "'.concat(t,'" ').concat(s," ").concat(i," ").concat(pre(e,"type"))}return r+=". Received type ".concat(typeof n),r},TypeError);pp("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");pp("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});pp("ERR_STREAM_PREMATURE_CLOSE","Premature close");pp("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});pp("ERR_MULTIPLE_CALLBACK","Callback called multiple times");pp("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");pp("ERR_STREAM_WRITE_AFTER_END","write after end");pp("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);pp("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);pp("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");cx.codes=EEe;var o_t=cx.codes.ERR_INVALID_OPT_VALUE;function c_t(t,e,n){return t.highWaterMark!=null?t.highWaterMark:e?t[n]:null}function l_t(t,e,n,i){var r=c_t(e,i,n);if(r!=null){if(!(isFinite(r)&&Math.floor(r)===r)||r<0){var s=i?n:"highWaterMark";throw new o_t(s,r)}return Math.floor(r)}return t.objectMode?16:16*1024}var SEe={getHighWaterMark:l_t},nq={exports:{}};typeof Object.create=="function"?nq.exports=function(e,n){n&&(e.super_=n,e.prototype=Object.create(n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:nq.exports=function(e,n){if(n){e.super_=n;var i=function(){};i.prototype=n.prototype,e.prototype=new i,e.prototype.constructor=e}};var DI=nq.exports,u_t=h_t;function h_t(t,e){if(fj("noDeprecation"))return t;var n=!1;function i(){if(!n){if(fj("throwDeprecation"))throw new Error(e);fj("traceDeprecation")?console.trace(e):console.warn(e),n=!0}return t.apply(this,arguments)}return i}function fj(t){try{if(!Ll.localStorage)return!1}catch{return!1}var e=Ll.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}var pj,mre;function TEe(){if(mre)return pj;mre=1,pj=k;function t(we){var Ce=this;this.next=null,this.entry=null,this.finish=function(){Le(Ce,we)}}var e;k.WritableState=A;var n={deprecate:u_t},i=_Ee,r=II.Buffer,s=(typeof Ll<"u"?Ll:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function a(we){return r.from(we)}function o(we){return r.isBuffer(we)||we instanceof s}var c=bEe,l=SEe,u=l.getHighWaterMark,h=cx.codes,d=h.ERR_INVALID_ARG_TYPE,f=h.ERR_METHOD_NOT_IMPLEMENTED,p=h.ERR_MULTIPLE_CALLBACK,g=h.ERR_STREAM_CANNOT_PIPE,_=h.ERR_STREAM_DESTROYED,v=h.ERR_STREAM_NULL_VALUES,E=h.ERR_STREAM_WRITE_AFTER_END,T=h.ERR_UNKNOWN_ENCODING,x=c.errorOrDestroy;DI(k,i);function N(){}function A(we,Ce,ke){e=e||NC(),we=we||{},typeof ke!="boolean"&&(ke=Ce instanceof e),this.objectMode=!!we.objectMode,ke&&(this.objectMode=this.objectMode||!!we.writableObjectMode),this.highWaterMark=u(this,we,"writableHighWaterMark",ke),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var St=we.decodeStrings===!1;this.decodeStrings=!St,this.defaultEncoding=we.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(At){V(Ce,At)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=we.emitClose!==!1,this.autoDestroy=!!we.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}A.prototype.getBuffer=function(){for(var Ce=this.bufferedRequest,ke=[];Ce;)ke.push(Ce),Ce=Ce.next;return ke},function(){try{Object.defineProperty(A.prototype,"buffer",{get:n.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var I;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(I=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(Ce){return I.call(this,Ce)?!0:this!==k?!1:Ce&&Ce._writableState instanceof A}})):I=function(Ce){return Ce instanceof this};function k(we){e=e||NC();var Ce=this instanceof e;if(!Ce&&!I.call(k,this))return new k(we);this._writableState=new A(we,this,Ce),this.writable=!0,we&&(typeof we.write=="function"&&(this._write=we.write),typeof we.writev=="function"&&(this._writev=we.writev),typeof we.destroy=="function"&&(this._destroy=we.destroy),typeof we.final=="function"&&(this._final=we.final)),i.call(this)}k.prototype.pipe=function(){x(this,new g)};function L(we,Ce){var ke=new E;x(we,ke),zn.nextTick(Ce,ke)}function U(we,Ce,ke,St){var At;return ke===null?At=new v:typeof ke!="string"&&!Ce.objectMode&&(At=new d("chunk",["string","Buffer"],ke)),At?(x(we,At),zn.nextTick(St,At),!1):!0}k.prototype.write=function(we,Ce,ke){var St=this._writableState,At=!1,Ee=!St.objectMode&&o(we);return Ee&&!r.isBuffer(we)&&(we=a(we)),typeof Ce=="function"&&(ke=Ce,Ce=null),Ee?Ce="buffer":Ce||(Ce=St.defaultEncoding),typeof ke!="function"&&(ke=N),St.ending?L(this,ke):(Ee||U(this,St,we,ke))&&(St.pendingcb++,At=q(this,St,Ee,we,Ce,ke)),At},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var we=this._writableState;we.corked&&(we.corked--,!we.writing&&!we.corked&&!we.bufferProcessing&&we.bufferedRequest&&ee(this,we))},k.prototype.setDefaultEncoding=function(Ce){if(typeof Ce=="string"&&(Ce=Ce.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Ce+"").toLowerCase())>-1))throw new T(Ce);return this._writableState.defaultEncoding=Ce,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function $(we,Ce,ke){return!we.objectMode&&we.decodeStrings!==!1&&typeof Ce=="string"&&(Ce=r.from(Ce,ke)),Ce}Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function q(we,Ce,ke,St,At,Ee){if(!ke){var ye=$(Ce,St,At);St!==ye&&(ke=!0,At="buffer",St=ye)}var et=Ce.objectMode?1:St.length;Ce.length+=et;var fe=Ce.length<Ce.highWaterMark;if(fe||(Ce.needDrain=!0),Ce.writing||Ce.corked){var Fe=Ce.lastBufferedRequest;Ce.lastBufferedRequest={chunk:St,encoding:At,isBuf:ke,callback:Ee,next:null},Fe?Fe.next=Ce.lastBufferedRequest:Ce.bufferedRequest=Ce.lastBufferedRequest,Ce.bufferedRequestCount+=1}else G(we,Ce,!1,et,St,At,Ee);return fe}function G(we,Ce,ke,St,At,Ee,ye){Ce.writelen=St,Ce.writecb=ye,Ce.writing=!0,Ce.sync=!0,Ce.destroyed?Ce.onwrite(new _("write")):ke?we._writev(At,Ce.onwrite):we._write(At,Ee,Ce.onwrite),Ce.sync=!1}function X(we,Ce,ke,St,At){--Ce.pendingcb,ke?(zn.nextTick(At,St),zn.nextTick(He,we,Ce),we._writableState.errorEmitted=!0,x(we,St)):(At(St),we._writableState.errorEmitted=!0,x(we,St),He(we,Ce))}function ie(we){we.writing=!1,we.writecb=null,we.length-=we.writelen,we.writelen=0}function V(we,Ce){var ke=we._writableState,St=ke.sync,At=ke.writecb;if(typeof At!="function")throw new p;if(ie(ke),Ce)X(we,ke,St,Ce,At);else{var Ee=oe(ke)||we.destroyed;!Ee&&!ke.corked&&!ke.bufferProcessing&&ke.bufferedRequest&&ee(we,ke),St?zn.nextTick(Z,we,ke,Ee,At):Z(we,ke,Ee,At)}}function Z(we,Ce,ke,St){ke||Y(we,Ce),Ce.pendingcb--,St(),He(we,Ce)}function Y(we,Ce){Ce.length===0&&Ce.needDrain&&(Ce.needDrain=!1,we.emit("drain"))}function ee(we,Ce){Ce.bufferProcessing=!0;var ke=Ce.bufferedRequest;if(we._writev&&ke&&ke.next){var St=Ce.bufferedRequestCount,At=new Array(St),Ee=Ce.corkedRequestsFree;Ee.entry=ke;for(var ye=0,et=!0;ke;)At[ye]=ke,ke.isBuf||(et=!1),ke=ke.next,ye+=1;At.allBuffers=et,G(we,Ce,!0,Ce.length,At,"",Ee.finish),Ce.pendingcb++,Ce.lastBufferedRequest=null,Ee.next?(Ce.corkedRequestsFree=Ee.next,Ee.next=null):Ce.corkedRequestsFree=new t(Ce),Ce.bufferedRequestCount=0}else{for(;ke;){var fe=ke.chunk,Fe=ke.encoding,Ie=ke.callback,it=Ce.objectMode?1:fe.length;if(G(we,Ce,!1,it,fe,Fe,Ie),ke=ke.next,Ce.bufferedRequestCount--,Ce.writing)break}ke===null&&(Ce.lastBufferedRequest=null)}Ce.bufferedRequest=ke,Ce.bufferProcessing=!1}k.prototype._write=function(we,Ce,ke){ke(new f("_write()"))},k.prototype._writev=null,k.prototype.end=function(we,Ce,ke){var St=this._writableState;return typeof we=="function"?(ke=we,we=null,Ce=null):typeof Ce=="function"&&(ke=Ce,Ce=null),we!=null&&this.write(we,Ce),St.corked&&(St.corked=1,this.uncork()),St.ending||Te(this,St,ke),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function oe(we){return we.ending&&we.length===0&&we.bufferedRequest===null&&!we.finished&&!we.writing}function de(we,Ce){we._final(function(ke){Ce.pendingcb--,ke&&x(we,ke),Ce.prefinished=!0,we.emit("prefinish"),He(we,Ce)})}function Me(we,Ce){!Ce.prefinished&&!Ce.finalCalled&&(typeof we._final=="function"&&!Ce.destroyed?(Ce.pendingcb++,Ce.finalCalled=!0,zn.nextTick(de,we,Ce)):(Ce.prefinished=!0,we.emit("prefinish")))}function He(we,Ce){var ke=oe(Ce);if(ke&&(Me(we,Ce),Ce.pendingcb===0&&(Ce.finished=!0,we.emit("finish"),Ce.autoDestroy))){var St=we._readableState;(!St||St.autoDestroy&&St.endEmitted)&&we.destroy()}return ke}function Te(we,Ce,ke){Ce.ending=!0,He(we,Ce),ke&&(Ce.finished?zn.nextTick(ke):we.once("finish",ke)),Ce.ended=!0,we.writable=!1}function Le(we,Ce,ke){var St=we.entry;for(we.entry=null;St;){var At=St.callback;Ce.pendingcb--,At(ke),St=St.next}Ce.corkedRequestsFree.next=we}return Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Ce){this._writableState&&(this._writableState.destroyed=Ce)}}),k.prototype.destroy=c.destroy,k.prototype._undestroy=c.undestroy,k.prototype._destroy=function(we,Ce){Ce(we)},pj}var mj,gre;function NC(){if(gre)return mj;gre=1;var t=Object.keys||function(l){var u=[];for(var h in l)u.push(h);return u};mj=a;var e=wEe(),n=TEe();DI(a,e);for(var i=t(n.prototype),r=0;r<i.length;r++){var s=i[r];a.prototype[s]||(a.prototype[s]=n.prototype[s])}function a(l){if(!(this instanceof a))return new a(l);e.call(this,l),n.call(this,l),this.allowHalfOpen=!0,l&&(l.readable===!1&&(this.readable=!1),l.writable===!1&&(this.writable=!1),l.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",o)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function o(){this._writableState.ended||zn.nextTick(c,this)}function c(l){l.end()}return Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(u){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=u,this._writableState.destroyed=u)}}),mj}var gj={},vre;function yre(){if(vre)return gj;vre=1;var t=uEe.Buffer,e=t.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(v){if(!v)return"utf8";for(var E;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(E)return;v=(""+v).toLowerCase(),E=!0}}function i(v){var E=n(v);if(typeof E!="string"&&(t.isEncoding===e||!e(v)))throw new Error("Unknown encoding: "+v);return E||v}gj.StringDecoder=r;function r(v){this.encoding=i(v);var E;switch(this.encoding){case"utf16le":this.text=h,this.end=d,E=4;break;case"utf8":this.fillLast=c,E=4;break;case"base64":this.text=f,this.end=p,E=3;break;default:this.write=g,this.end=_;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(E)}r.prototype.write=function(v){if(v.length===0)return"";var E,T;if(this.lastNeed){if(E=this.fillLast(v),E===void 0)return"";T=this.lastNeed,this.lastNeed=0}else T=0;return T<v.length?E?E+this.text(v,T):this.text(v,T):E||""},r.prototype.end=u,r.prototype.text=l,r.prototype.fillLast=function(v){if(this.lastNeed<=v.length)return v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),this.lastNeed-=v.length};function s(v){return v<=127?0:v>>5===6?2:v>>4===14?3:v>>3===30?4:v>>6===2?-1:-2}function a(v,E,T){var x=E.length-1;if(x<T)return 0;var N=s(E[x]);return N>=0?(N>0&&(v.lastNeed=N-1),N):--x<T||N===-2?0:(N=s(E[x]),N>=0?(N>0&&(v.lastNeed=N-2),N):--x<T||N===-2?0:(N=s(E[x]),N>=0?(N>0&&(N===2?N=0:v.lastNeed=N-3),N):0))}function o(v,E,T){if((E[0]&192)!==128)return v.lastNeed=0,"";if(v.lastNeed>1&&E.length>1){if((E[1]&192)!==128)return v.lastNeed=1,"";if(v.lastNeed>2&&E.length>2&&(E[2]&192)!==128)return v.lastNeed=2,""}}function c(v){var E=this.lastTotal-this.lastNeed,T=o(this,v);if(T!==void 0)return T;if(this.lastNeed<=v.length)return v.copy(this.lastChar,E,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,E,0,v.length),this.lastNeed-=v.length}function l(v,E){var T=a(this,v,E);if(!this.lastNeed)return v.toString("utf8",E);this.lastTotal=T;var x=v.length-(T-this.lastNeed);return v.copy(this.lastChar,0,x),v.toString("utf8",E,x)}function u(v){var E=v&&v.length?this.write(v):"";return this.lastNeed?E+"":E}function h(v,E){if((v.length-E)%2===0){var T=v.toString("utf16le",E);if(T){var x=T.charCodeAt(T.length-1);if(x>=55296&&x<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],T.slice(0,-1)}return T}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",E,v.length-1)}function d(v){var E=v&&v.length?this.write(v):"";if(this.lastNeed){var T=this.lastTotal-this.lastNeed;return E+this.lastChar.toString("utf16le",0,T)}return E}function f(v,E){var T=(v.length-E)%3;return T===0?v.toString("base64",E):(this.lastNeed=3-T,this.lastTotal=3,T===1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",E,v.length-T))}function p(v){var E=v&&v.length?this.write(v):"";return this.lastNeed?E+this.lastChar.toString("base64",0,3-this.lastNeed):E}function g(v){return v.toString(this.encoding)}function _(v){return v&&v.length?this.write(v):""}return gj}var _re=cx.codes.ERR_STREAM_PREMATURE_CLOSE;function d_t(t){var e=!1;return function(){if(!e){e=!0;for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];t.apply(this,i)}}}function f_t(){}function p_t(t){return t.setHeader&&typeof t.abort=="function"}function xEe(t,e,n){if(typeof e=="function")return xEe(t,null,e);e||(e={}),n=d_t(n||f_t);var i=e.readable||e.readable!==!1&&t.readable,r=e.writable||e.writable!==!1&&t.writable,s=function(){t.writable||o()},a=t._writableState&&t._writableState.finished,o=function(){r=!1,a=!0,i||n.call(t)},c=t._readableState&&t._readableState.endEmitted,l=function(){i=!1,c=!0,r||n.call(t)},u=function(p){n.call(t,p)},h=function(){var p;if(i&&!c)return(!t._readableState||!t._readableState.ended)&&(p=new _re),n.call(t,p);if(r&&!a)return(!t._writableState||!t._writableState.ended)&&(p=new _re),n.call(t,p)},d=function(){t.req.on("finish",o)};return p_t(t)?(t.on("complete",o),t.on("abort",h),t.req?d():t.on("request",d)):r&&!t._writableState&&(t.on("end",s),t.on("close",s)),t.on("end",l),t.on("finish",o),e.error!==!1&&t.on("error",u),t.on("close",h),function(){t.removeListener("complete",o),t.removeListener("abort",h),t.removeListener("request",d),t.req&&t.req.removeListener("finish",o),t.removeListener("end",s),t.removeListener("close",s),t.removeListener("finish",o),t.removeListener("end",l),t.removeListener("error",u),t.removeListener("close",h)}}var aX=xEe,vj,bre;function m_t(){if(bre)return vj;bre=1;var t;function e(T,x,N){return x=n(x),x in T?Object.defineProperty(T,x,{value:N,enumerable:!0,configurable:!0,writable:!0}):T[x]=N,T}function n(T){var x=i(T,"string");return typeof x=="symbol"?x:String(x)}function i(T,x){if(typeof T!="object"||T===null)return T;var N=T[Symbol.toPrimitive];if(N!==void 0){var A=N.call(T,x||"default");if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(T)}var r=aX,s=Symbol("lastResolve"),a=Symbol("lastReject"),o=Symbol("error"),c=Symbol("ended"),l=Symbol("lastPromise"),u=Symbol("handlePromise"),h=Symbol("stream");function d(T,x){return{value:T,done:x}}function f(T){var x=T[s];if(x!==null){var N=T[h].read();N!==null&&(T[l]=null,T[s]=null,T[a]=null,x(d(N,!1)))}}function p(T){zn.nextTick(f,T)}function g(T,x){return function(N,A){T.then(function(){if(x[c]){N(d(void 0,!0));return}x[u](N,A)},A)}}var _=Object.getPrototypeOf(function(){}),v=Object.setPrototypeOf((t={get stream(){return this[h]},next:function(){var x=this,N=this[o];if(N!==null)return Promise.reject(N);if(this[c])return Promise.resolve(d(void 0,!0));if(this[h].destroyed)return new Promise(function(L,U){zn.nextTick(function(){x[o]?U(x[o]):L(d(void 0,!0))})});var A=this[l],I;if(A)I=new Promise(g(A,this));else{var k=this[h].read();if(k!==null)return Promise.resolve(d(k,!1));I=new Promise(this[u])}return this[l]=I,I}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var x=this;return new Promise(function(N,A){x[h].destroy(null,function(I){if(I){A(I);return}N(d(void 0,!0))})})}),t),_),E=function(x){var N,A=Object.create(v,(N={},e(N,h,{value:x,writable:!0}),e(N,s,{value:null,writable:!0}),e(N,a,{value:null,writable:!0}),e(N,o,{value:null,writable:!0}),e(N,c,{value:x._readableState.endEmitted,writable:!0}),e(N,u,{value:function(k,L){var U=A[h].read();U?(A[l]=null,A[s]=null,A[a]=null,k(d(U,!1))):(A[s]=k,A[a]=L)},writable:!0}),N));return A[l]=null,r(x,function(I){if(I&&I.code!=="ERR_STREAM_PREMATURE_CLOSE"){var k=A[a];k!==null&&(A[l]=null,A[s]=null,A[a]=null,k(I)),A[o]=I;return}var L=A[s];L!==null&&(A[l]=null,A[s]=null,A[a]=null,L(d(void 0,!0))),A[c]=!0}),x.on("readable",p.bind(null,A)),A};return vj=E,vj}var yj,Ere;function g_t(){return Ere||(Ere=1,yj=function(){throw new Error("Readable.from is not available in the browser")}),yj}var _j,Sre;function wEe(){if(Sre)return _j;Sre=1,_j=L;var t;L.ReadableState=k,kI.EventEmitter;var e=function(ye,et){return ye.listeners(et).length},n=_Ee,i=II.Buffer,r=(typeof Ll<"u"?Ll:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function s(Ee){return i.from(Ee)}function a(Ee){return i.isBuffer(Ee)||Ee instanceof r}var o=xT,c;o&&o.debuglog?c=o.debuglog("stream"):c=function(){};var l=Qyt(),u=bEe,h=SEe,d=h.getHighWaterMark,f=cx.codes,p=f.ERR_INVALID_ARG_TYPE,g=f.ERR_STREAM_PUSH_AFTER_EOF,_=f.ERR_METHOD_NOT_IMPLEMENTED,v=f.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,E,T,x;DI(L,n);var N=u.errorOrDestroy,A=["error","close","destroy","pause","resume"];function I(Ee,ye,et){if(typeof Ee.prependListener=="function")return Ee.prependListener(ye,et);!Ee._events||!Ee._events[ye]?Ee.on(ye,et):Array.isArray(Ee._events[ye])?Ee._events[ye].unshift(et):Ee._events[ye]=[et,Ee._events[ye]]}function k(Ee,ye,et){t=t||NC(),Ee=Ee||{},typeof et!="boolean"&&(et=ye instanceof t),this.objectMode=!!Ee.objectMode,et&&(this.objectMode=this.objectMode||!!Ee.readableObjectMode),this.highWaterMark=d(this,Ee,"readableHighWaterMark",et),this.buffer=new l,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=Ee.emitClose!==!1,this.autoDestroy=!!Ee.autoDestroy,this.destroyed=!1,this.defaultEncoding=Ee.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,Ee.encoding&&(E||(E=yre().StringDecoder),this.decoder=new E(Ee.encoding),this.encoding=Ee.encoding)}function L(Ee){if(t=t||NC(),!(this instanceof L))return new L(Ee);var ye=this instanceof t;this._readableState=new k(Ee,this,ye),this.readable=!0,Ee&&(typeof Ee.read=="function"&&(this._read=Ee.read),typeof Ee.destroy=="function"&&(this._destroy=Ee.destroy)),n.call(this)}Object.defineProperty(L.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(ye){this._readableState&&(this._readableState.destroyed=ye)}}),L.prototype.destroy=u.destroy,L.prototype._undestroy=u.undestroy,L.prototype._destroy=function(Ee,ye){ye(Ee)},L.prototype.push=function(Ee,ye){var et=this._readableState,fe;return et.objectMode?fe=!0:typeof Ee=="string"&&(ye=ye||et.defaultEncoding,ye!==et.encoding&&(Ee=i.from(Ee,ye),ye=""),fe=!0),U(this,Ee,ye,!1,fe)},L.prototype.unshift=function(Ee){return U(this,Ee,null,!0,!1)};function U(Ee,ye,et,fe,Fe){c("readableAddChunk",ye);var Ie=Ee._readableState;if(ye===null)Ie.reading=!1,V(Ee,Ie);else{var it;if(Fe||(it=q(Ie,ye)),it)N(Ee,it);else if(Ie.objectMode||ye&&ye.length>0)if(typeof ye!="string"&&!Ie.objectMode&&Object.getPrototypeOf(ye)!==i.prototype&&(ye=s(ye)),fe)Ie.endEmitted?N(Ee,new v):$(Ee,Ie,ye,!0);else if(Ie.ended)N(Ee,new g);else{if(Ie.destroyed)return!1;Ie.reading=!1,Ie.decoder&&!et?(ye=Ie.decoder.write(ye),Ie.objectMode||ye.length!==0?$(Ee,Ie,ye,!1):ee(Ee,Ie)):$(Ee,Ie,ye,!1)}else fe||(Ie.reading=!1,ee(Ee,Ie))}return!Ie.ended&&(Ie.length<Ie.highWaterMark||Ie.length===0)}function $(Ee,ye,et,fe){ye.flowing&&ye.length===0&&!ye.sync?(ye.awaitDrain=0,Ee.emit("data",et)):(ye.length+=ye.objectMode?1:et.length,fe?ye.buffer.unshift(et):ye.buffer.push(et),ye.needReadable&&Z(Ee)),ee(Ee,ye)}function q(Ee,ye){var et;return!a(ye)&&typeof ye!="string"&&ye!==void 0&&!Ee.objectMode&&(et=new p("chunk",["string","Buffer","Uint8Array"],ye)),et}L.prototype.isPaused=function(){return this._readableState.flowing===!1},L.prototype.setEncoding=function(Ee){E||(E=yre().StringDecoder);var ye=new E(Ee);this._readableState.decoder=ye,this._readableState.encoding=this._readableState.decoder.encoding;for(var et=this._readableState.buffer.head,fe="";et!==null;)fe+=ye.write(et.data),et=et.next;return this._readableState.buffer.clear(),fe!==""&&this._readableState.buffer.push(fe),this._readableState.length=fe.length,this};var G=1073741824;function X(Ee){return Ee>=G?Ee=G:(Ee--,Ee|=Ee>>>1,Ee|=Ee>>>2,Ee|=Ee>>>4,Ee|=Ee>>>8,Ee|=Ee>>>16,Ee++),Ee}function ie(Ee,ye){return Ee<=0||ye.length===0&&ye.ended?0:ye.objectMode?1:Ee!==Ee?ye.flowing&&ye.length?ye.buffer.head.data.length:ye.length:(Ee>ye.highWaterMark&&(ye.highWaterMark=X(Ee)),Ee<=ye.length?Ee:ye.ended?ye.length:(ye.needReadable=!0,0))}L.prototype.read=function(Ee){c("read",Ee),Ee=parseInt(Ee,10);var ye=this._readableState,et=Ee;if(Ee!==0&&(ye.emittedReadable=!1),Ee===0&&ye.needReadable&&((ye.highWaterMark!==0?ye.length>=ye.highWaterMark:ye.length>0)||ye.ended))return c("read: emitReadable",ye.length,ye.ended),ye.length===0&&ye.ended?ke(this):Z(this),null;if(Ee=ie(Ee,ye),Ee===0&&ye.ended)return ye.length===0&&ke(this),null;var fe=ye.needReadable;c("need readable",fe),(ye.length===0||ye.length-Ee<ye.highWaterMark)&&(fe=!0,c("length less than watermark",fe)),ye.ended||ye.reading?(fe=!1,c("reading or ended",fe)):fe&&(c("do read"),ye.reading=!0,ye.sync=!0,ye.length===0&&(ye.needReadable=!0),this._read(ye.highWaterMark),ye.sync=!1,ye.reading||(Ee=ie(et,ye)));var Fe;return Ee>0?Fe=Ce(Ee,ye):Fe=null,Fe===null?(ye.needReadable=ye.length<=ye.highWaterMark,Ee=0):(ye.length-=Ee,ye.awaitDrain=0),ye.length===0&&(ye.ended||(ye.needReadable=!0),et!==Ee&&ye.ended&&ke(this)),Fe!==null&&this.emit("data",Fe),Fe};function V(Ee,ye){if(c("onEofChunk"),!ye.ended){if(ye.decoder){var et=ye.decoder.end();et&&et.length&&(ye.buffer.push(et),ye.length+=ye.objectMode?1:et.length)}ye.ended=!0,ye.sync?Z(Ee):(ye.needReadable=!1,ye.emittedReadable||(ye.emittedReadable=!0,Y(Ee)))}}function Z(Ee){var ye=Ee._readableState;c("emitReadable",ye.needReadable,ye.emittedReadable),ye.needReadable=!1,ye.emittedReadable||(c("emitReadable",ye.flowing),ye.emittedReadable=!0,zn.nextTick(Y,Ee))}function Y(Ee){var ye=Ee._readableState;c("emitReadable_",ye.destroyed,ye.length,ye.ended),!ye.destroyed&&(ye.length||ye.ended)&&(Ee.emit("readable"),ye.emittedReadable=!1),ye.needReadable=!ye.flowing&&!ye.ended&&ye.length<=ye.highWaterMark,we(Ee)}function ee(Ee,ye){ye.readingMore||(ye.readingMore=!0,zn.nextTick(oe,Ee,ye))}function oe(Ee,ye){for(;!ye.reading&&!ye.ended&&(ye.length<ye.highWaterMark||ye.flowing&&ye.length===0);){var et=ye.length;if(c("maybeReadMore read 0"),Ee.read(0),et===ye.length)break}ye.readingMore=!1}L.prototype._read=function(Ee){N(this,new _("_read()"))},L.prototype.pipe=function(Ee,ye){var et=this,fe=this._readableState;switch(fe.pipesCount){case 0:fe.pipes=Ee;break;case 1:fe.pipes=[fe.pipes,Ee];break;default:fe.pipes.push(Ee);break}fe.pipesCount+=1,c("pipe count=%d opts=%j",fe.pipesCount,ye);var Fe=(!ye||ye.end!==!1)&&Ee!==zn.stdout&&Ee!==zn.stderr,Ie=Fe?dt:Ue;fe.endEmitted?zn.nextTick(Ie):et.once("end",Ie),Ee.on("unpipe",it);function it(qt,Mt){c("onunpipe"),qt===et&&Mt&&Mt.hasUnpiped===!1&&(Mt.hasUnpiped=!0,be())}function dt(){c("onend"),Ee.end()}var gt=de(et);Ee.on("drain",gt);var bt=!1;function be(){c("cleanup"),Ee.removeListener("close",nt),Ee.removeListener("finish",$e),Ee.removeListener("drain",gt),Ee.removeListener("error",Xe),Ee.removeListener("unpipe",it),et.removeListener("end",dt),et.removeListener("end",Ue),et.removeListener("data",ue),bt=!0,fe.awaitDrain&&(!Ee._writableState||Ee._writableState.needDrain)&&gt()}et.on("data",ue);function ue(qt){c("ondata");var Mt=Ee.write(qt);c("dest.write",Mt),Mt===!1&&((fe.pipesCount===1&&fe.pipes===Ee||fe.pipesCount>1&&At(fe.pipes,Ee)!==-1)&&!bt&&(c("false write response, pause",fe.awaitDrain),fe.awaitDrain++),et.pause())}function Xe(qt){c("onerror",qt),Ue(),Ee.removeListener("error",Xe),e(Ee,"error")===0&&N(Ee,qt)}I(Ee,"error",Xe);function nt(){Ee.removeListener("finish",$e),Ue()}Ee.once("close",nt);function $e(){c("onfinish"),Ee.removeListener("close",nt),Ue()}Ee.once("finish",$e);function Ue(){c("unpipe"),et.unpipe(Ee)}return Ee.emit("pipe",et),fe.flowing||(c("pipe resume"),et.resume()),Ee};function de(Ee){return function(){var et=Ee._readableState;c("pipeOnDrain",et.awaitDrain),et.awaitDrain&&et.awaitDrain--,et.awaitDrain===0&&e(Ee,"data")&&(et.flowing=!0,we(Ee))}}L.prototype.unpipe=function(Ee){var ye=this._readableState,et={hasUnpiped:!1};if(ye.pipesCount===0)return this;if(ye.pipesCount===1)return Ee&&Ee!==ye.pipes?this:(Ee||(Ee=ye.pipes),ye.pipes=null,ye.pipesCount=0,ye.flowing=!1,Ee&&Ee.emit("unpipe",this,et),this);if(!Ee){var fe=ye.pipes,Fe=ye.pipesCount;ye.pipes=null,ye.pipesCount=0,ye.flowing=!1;for(var Ie=0;Ie<Fe;Ie++)fe[Ie].emit("unpipe",this,{hasUnpiped:!1});return this}var it=At(ye.pipes,Ee);return it===-1?this:(ye.pipes.splice(it,1),ye.pipesCount-=1,ye.pipesCount===1&&(ye.pipes=ye.pipes[0]),Ee.emit("unpipe",this,et),this)},L.prototype.on=function(Ee,ye){var et=n.prototype.on.call(this,Ee,ye),fe=this._readableState;return Ee==="data"?(fe.readableListening=this.listenerCount("readable")>0,fe.flowing!==!1&&this.resume()):Ee==="readable"&&!fe.endEmitted&&!fe.readableListening&&(fe.readableListening=fe.needReadable=!0,fe.flowing=!1,fe.emittedReadable=!1,c("on readable",fe.length,fe.reading),fe.length?Z(this):fe.reading||zn.nextTick(He,this)),et},L.prototype.addListener=L.prototype.on,L.prototype.removeListener=function(Ee,ye){var et=n.prototype.removeListener.call(this,Ee,ye);return Ee==="readable"&&zn.nextTick(Me,this),et},L.prototype.removeAllListeners=function(Ee){var ye=n.prototype.removeAllListeners.apply(this,arguments);return(Ee==="readable"||Ee===void 0)&&zn.nextTick(Me,this),ye};function Me(Ee){var ye=Ee._readableState;ye.readableListening=Ee.listenerCount("readable")>0,ye.resumeScheduled&&!ye.paused?ye.flowing=!0:Ee.listenerCount("data")>0&&Ee.resume()}function He(Ee){c("readable nexttick read 0"),Ee.read(0)}L.prototype.resume=function(){var Ee=this._readableState;return Ee.flowing||(c("resume"),Ee.flowing=!Ee.readableListening,Te(this,Ee)),Ee.paused=!1,this};function Te(Ee,ye){ye.resumeScheduled||(ye.resumeScheduled=!0,zn.nextTick(Le,Ee,ye))}function Le(Ee,ye){c("resume",ye.reading),ye.reading||Ee.read(0),ye.resumeScheduled=!1,Ee.emit("resume"),we(Ee),ye.flowing&&!ye.reading&&Ee.read(0)}L.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function we(Ee){var ye=Ee._readableState;for(c("flow",ye.flowing);ye.flowing&&Ee.read()!==null;);}L.prototype.wrap=function(Ee){var ye=this,et=this._readableState,fe=!1;Ee.on("end",function(){if(c("wrapped end"),et.decoder&&!et.ended){var it=et.decoder.end();it&&it.length&&ye.push(it)}ye.push(null)}),Ee.on("data",function(it){if(c("wrapped data"),et.decoder&&(it=et.decoder.write(it)),!(et.objectMode&&it==null)&&!(!et.objectMode&&(!it||!it.length))){var dt=ye.push(it);dt||(fe=!0,Ee.pause())}});for(var Fe in Ee)this[Fe]===void 0&&typeof Ee[Fe]=="function"&&(this[Fe]=function(dt){return function(){return Ee[dt].apply(Ee,arguments)}}(Fe));for(var Ie=0;Ie<A.length;Ie++)Ee.on(A[Ie],this.emit.bind(this,A[Ie]));return this._read=function(it){c("wrapped _read",it),fe&&(fe=!1,Ee.resume())},this},typeof Symbol=="function"&&(L.prototype[Symbol.asyncIterator]=function(){return T===void 0&&(T=m_t()),T(this)}),Object.defineProperty(L.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(L.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(L.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(ye){this._readableState&&(this._readableState.flowing=ye)}}),L._fromList=Ce,Object.defineProperty(L.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Ce(Ee,ye){if(ye.length===0)return null;var et;return ye.objectMode?et=ye.buffer.shift():!Ee||Ee>=ye.length?(ye.decoder?et=ye.buffer.join(""):ye.buffer.length===1?et=ye.buffer.first():et=ye.buffer.concat(ye.length),ye.buffer.clear()):et=ye.buffer.consume(Ee,ye.decoder),et}function ke(Ee){var ye=Ee._readableState;c("endReadable",ye.endEmitted),ye.endEmitted||(ye.ended=!0,zn.nextTick(St,ye,Ee))}function St(Ee,ye){if(c("endReadableNT",Ee.endEmitted,Ee.length),!Ee.endEmitted&&Ee.length===0&&(Ee.endEmitted=!0,ye.readable=!1,ye.emit("end"),Ee.autoDestroy)){var et=ye._writableState;(!et||et.autoDestroy&&et.finished)&&ye.destroy()}}typeof Symbol=="function"&&(L.from=function(Ee,ye){return x===void 0&&(x=g_t()),x(L,Ee,ye)});function At(Ee,ye){for(var et=0,fe=Ee.length;et<fe;et++)if(Ee[et]===ye)return et;return-1}return _j}var CEe=ly,iz=cx.codes,v_t=iz.ERR_METHOD_NOT_IMPLEMENTED,y_t=iz.ERR_MULTIPLE_CALLBACK,__t=iz.ERR_TRANSFORM_ALREADY_TRANSFORMING,b_t=iz.ERR_TRANSFORM_WITH_LENGTH_0,rz=NC();DI(ly,rz);function E_t(t,e){var n=this._transformState;n.transforming=!1;var i=n.writecb;if(i===null)return this.emit("error",new y_t);n.writechunk=null,n.writecb=null,e!=null&&this.push(e),i(t);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function ly(t){if(!(this instanceof ly))return new ly(t);rz.call(this,t),this._transformState={afterTransform:E_t.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",S_t)}function S_t(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,n){Tre(t,e,n)}):Tre(this,null,null)}ly.prototype.push=function(t,e){return this._transformState.needTransform=!1,rz.prototype.push.call(this,t,e)};ly.prototype._transform=function(t,e,n){n(new v_t("_transform()"))};ly.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}};ly.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};ly.prototype._destroy=function(t,e){rz.prototype._destroy.call(this,t,function(n){e(n)})};function Tre(t,e,n){if(e)return t.emit("error",e);if(n!=null&&t.push(n),t._writableState.length)throw new b_t;if(t._transformState.transforming)throw new __t;return t.push(null)}var T_t=qO,REe=CEe;DI(qO,REe);function qO(t){if(!(this instanceof qO))return new qO(t);REe.call(this,t)}qO.prototype._transform=function(t,e,n){n(null,t)};var bj;function x_t(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var AEe=cx.codes,w_t=AEe.ERR_MISSING_ARGS,C_t=AEe.ERR_STREAM_DESTROYED;function xre(t){if(t)throw t}function R_t(t){return t.setHeader&&typeof t.abort=="function"}function A_t(t,e,n,i){i=x_t(i);var r=!1;t.on("close",function(){r=!0}),bj===void 0&&(bj=aX),bj(t,{readable:e,writable:n},function(a){if(a)return i(a);r=!0,i()});var s=!1;return function(a){if(!r&&!s){if(s=!0,R_t(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();i(a||new C_t("pipe"))}}}function wre(t){t()}function M_t(t,e){return t.pipe(e)}function O_t(t){return!t.length||typeof t[t.length-1]!="function"?xre:t.pop()}function N_t(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=O_t(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new w_t("streams");var r,s=e.map(function(a,o){var c=o<e.length-1,l=o>0;return A_t(a,c,l,function(u){r||(r=u),u&&s.forEach(wre),!c&&(s.forEach(wre),i(r))})});return e.reduce(M_t)}var I_t=N_t;(function(t,e){e=t.exports=wEe(),e.Stream=e,e.Readable=e,e.Writable=TEe(),e.Duplex=NC(),e.Transform=CEe,e.PassThrough=T_t,e.finished=aX,e.pipeline=I_t})(eq,eq.exports);var MEe=eq.exports;/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let Cre;var OEe=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:Ll):t=>(Cre||(Cre=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0));function Rre(t,e){for(const n in e)Object.defineProperty(t,n,{value:e[n],enumerable:!0,configurable:!0});return t}function k_t(t,e,n){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");n||(n={}),typeof e=="object"&&(n=e,e=""),e&&(n.code=e);try{return Rre(t,n)}catch{n.message=t.message,n.stack=t.stack;const r=function(){};return r.prototype=Object.create(Object.getPrototypeOf(t)),Rre(new r,n)}}var D_t=k_t;/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const P_t=ez("simple-peer"),NEe=jyt,Are=tz,L_t=MEe,Ej=OEe,Dr=D_t,{Buffer:U_t}=II,Sj=64*1024,B_t=5*1e3,F_t=5*1e3;function Mre(t){return t.replace(/a=ice-options:trickle\s\n/g,"")}function z_t(t){console.warn(t)}let sz=class iq extends L_t.Duplex{constructor(e){if(e=Object.assign({allowHalfOpen:!1},e),super(e),this._id=Are(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Are(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||iq.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},iq.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(n=>n),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=e.trickle!==void 0?e.trickle:!0,this.allowHalfTrickle=e.allowHalfTrickle!==void 0?e.allowHalfTrickle:!1,this.iceCompleteTimeout=e.iceCompleteTimeout||B_t,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&typeof e.wrtc=="object"?e.wrtc:NEe(),!this._wrtc)throw Dr(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(n){this.destroy(Dr(n,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=n=>{this._onIceCandidate(n)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(n=>{this.destroy(Dr(n,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=n=>{this._setupData(n)},this.streams&&this.streams.forEach(n=>{this.addStream(n)}),this._pc.ontrack=n=>{this._onTrack(n)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof e=="string")try{e=JSON.parse(e)}catch{e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(n=>{this._addIceCandidate(n)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(n=>{this.destroy(Dr(n,"ERR_SET_REMOTE_DESCRIPTION"))}),!e.sdp&&!e.candidate&&!e.renegotiate&&!e.transceiverRequest&&this.destroy(Dr(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(e){const n=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(n).catch(i=>{!n.address||n.address.endsWith(".local")?z_t("Ignoring unsupported ICE candidate."):this.destroy(Dr(i,"ERR_ADD_ICE_CANDIDATE"))})}send(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(e)}}addTransceiver(e,n){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,n),this._needsNegotiation()}catch(i){this.destroy(Dr(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:n}})}}addStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),e.getTracks().forEach(n=>{this.addTrack(n,e)})}}addTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const i=this._senderMap.get(e)||new Map;let r=i.get(n);if(!r)r=this._pc.addTrack(e,n),i.set(n,r),this._senderMap.set(e,i),this._needsNegotiation();else throw r.removed?Dr(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):Dr(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(e,n,i){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const r=this._senderMap.get(e),s=r?r.get(i):null;if(!s)throw Dr(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");n&&this._senderMap.set(n,r),s.replaceTrack!=null?s.replaceTrack(n):this.destroy(Dr(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,n){if(this.destroying)return;if(this.destroyed)throw Dr(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const i=this._senderMap.get(e),r=i?i.get(n):null;if(!r)throw Dr(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{r.removed=!0,this._pc.removeTrack(r)}catch(s){s.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(r):this.destroy(Dr(s,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),e.getTracks().forEach(n=>{this.removeTrack(n,e)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,Ej(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw Dr(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),Ej(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),n()}))}_setupData(e){if(!e.channel)return this.destroy(Dr(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=Sj),this.channelName=this._channel.label,this._channel.onmessage=i=>{this._onChannelMessage(i)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=i=>{const r=i.error instanceof Error?i.error:new Error(`Datachannel error: ${i.message} ${i.filename}:${i.lineno}:${i.colno}`);this.destroy(Dr(r,"ERR_DATA_CHANNEL"))};let n=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(n&&this._onChannelClose(),n=!0):n=!1},F_t)}_read(){}_write(e,n,i){if(this.destroyed)return i(Dr(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(r){return this.destroy(Dr(r,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>Sj?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Mre(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp})},i=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{!e.mid&&e.sender.track&&!e.requested&&(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(e.sdp=Mre(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const n=()=>{if(this.destroyed)return;const s=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:s.type,sdp:s.sdp}),this.initiator||this._requestMissingTransceivers()},i=()=>{this.destroyed||(this.trickle||this._iceComplete?n():this.once("_iceComplete",n))},r=s=>{this.destroy(Dr(s,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(e).then(i).catch(r)}).catch(e=>{this.destroy(Dr(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(Dr(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,n=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,n),this.emit("iceStateChange",e,n),(e==="connected"||e==="completed")&&(this._pcReady=!0,this._maybeReady()),e==="failed"&&this.destroy(Dr(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),e==="closed"&&this.destroy(Dr(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const n=i=>(Object.prototype.toString.call(i.values)==="[object Array]"&&i.values.forEach(r=>{Object.assign(i,r)}),i);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{const r=[];i.forEach(s=>{r.push(n(s))}),e(null,r)},i=>e(i)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(this.destroyed)return;const r=[];i.result().forEach(s=>{const a={};s.names().forEach(o=>{a[o]=s.stat(o)}),a.id=s.id,a.type=s.type,a.timestamp=s.timestamp,r.push(n(a))}),e(null,r)},i=>e(i)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((n,i)=>{if(this.destroyed)return;n&&(i=[]);const r={},s={},a={};let o=!1;i.forEach(l=>{(l.type==="remotecandidate"||l.type==="remote-candidate")&&(r[l.id]=l),(l.type==="localcandidate"||l.type==="local-candidate")&&(s[l.id]=l),(l.type==="candidatepair"||l.type==="candidate-pair")&&(a[l.id]=l)});const c=l=>{o=!0;let u=s[l.localCandidateId];u&&(u.ip||u.address)?(this.localAddress=u.ip||u.address,this.localPort=Number(u.port)):u&&u.ipAddress?(this.localAddress=u.ipAddress,this.localPort=Number(u.portNumber)):typeof l.googLocalAddress=="string"&&(u=l.googLocalAddress.split(":"),this.localAddress=u[0],this.localPort=Number(u[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let h=r[l.remoteCandidateId];h&&(h.ip||h.address)?(this.remoteAddress=h.ip||h.address,this.remotePort=Number(h.port)):h&&h.ipAddress?(this.remoteAddress=h.ipAddress,this.remotePort=Number(h.portNumber)):typeof l.googRemoteAddress=="string"&&(h=l.googRemoteAddress.split(":"),this.remoteAddress=h[0],this.remotePort=Number(h[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(l=>{l.type==="transport"&&l.selectedCandidatePairId&&c(a[l.selectedCandidatePairId]),(l.type==="googCandidatePair"&&l.googActiveConnection==="true"||(l.type==="candidatepair"||l.type==="candidate-pair")&&l.selected)&&c(l)}),!o&&(!Object.keys(a).length||Object.keys(s).length)){setTimeout(e,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(u){return this.destroy(Dr(u,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const l=this._cb;this._cb=null,l(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>Sj||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):!e.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=U_t.from(n)),this.push(n)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(n=>{this._debug("on track"),this.emit("track",e.track,n),this._remoteTracks.push({track:e.track,stream:n}),!this._remoteStreams.some(i=>i.id===n.id)&&(this._remoteStreams.push(n),Ej(()=>{this._debug("on stream"),this.emit("stream",n)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],P_t.apply(null,e)}};sz.WEBRTC_SUPPORT=!!NEe();sz.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"};sz.channelConfig={};var H_t=sz;const j_t=ez("simple-websocket"),V_t=tz,G_t=MEe,Ore=OEe,hM=xT,wA=typeof hM!="function"?WebSocket:hM,Nre=64*1024;let IEe=class extends G_t.Duplex{constructor(e={}){if(typeof e=="string"&&(e={url:e}),e=Object.assign({allowHalfOpen:!1},e),super(e),e.url==null&&e.socket==null)throw new Error("Missing required `url` or `socket` option");if(e.url!=null&&e.socket!=null)throw new Error("Must specify either `url` or `socket` option, not both");if(this._id=V_t(4).toString("hex").slice(0,7),this._debug("new websocket: %o",e),this.connected=!1,this.destroyed=!1,this._chunk=null,this._cb=null,this._interval=null,e.socket)this.url=e.socket.url,this._ws=e.socket,this.connected=e.socket.readyState===wA.OPEN;else{this.url=e.url;try{typeof hM=="function"?this._ws=new wA(e.url,null,{...e,encoding:void 0}):this._ws=new wA(e.url)}catch(n){Ore(()=>this.destroy(n));return}}this._ws.binaryType="arraybuffer",e.socket&&this.connected?Ore(()=>this._handleOpen()):this._ws.onopen=()=>this._handleOpen(),this._ws.onmessage=n=>this._handleMessage(n),this._ws.onclose=()=>this._handleClose(),this._ws.onerror=n=>this._handleError(n),this._handleFinishBound=()=>this._handleFinish(),this.once("finish",this._handleFinishBound)}send(e){this._ws.send(e)}destroy(e){this._destroy(e,()=>{})}_destroy(e,n){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.connected=!1,this.destroyed=!0,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._handleFinishBound&&this.removeListener("finish",this._handleFinishBound),this._handleFinishBound=null,this._ws){const i=this._ws,r=()=>{i.onclose=null};if(i.readyState===wA.CLOSED)r();else try{i.onclose=r,i.close()}catch{r()}i.onopen=null,i.onmessage=null,i.onerror=()=>{}}this._ws=null,e&&this.emit("error",e),this.emit("close"),n()}}_read(){}_write(e,n,i){if(this.destroyed)return i(new Error("cannot write after socket is destroyed"));if(this.connected){try{this.send(e)}catch(r){return this.destroy(r)}typeof hM!="function"&&this._ws.bufferedAmount>Nre?(this._debug("start backpressure: bufferedAmount %d",this._ws.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_handleOpen(){if(!(this.connected||this.destroyed)){if(this.connected=!0,this._chunk){try{this.send(this._chunk)}catch(n){return this.destroy(n)}this._chunk=null,this._debug('sent chunk from "write before connect"');const e=this._cb;this._cb=null,e(null)}typeof hM!="function"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}}_handleMessage(e){if(this.destroyed)return;let n=e.data;n instanceof ArrayBuffer&&(n=kl.from(n)),this.push(n)}_handleClose(){this.destroyed||(this._debug("on close"),this.destroy())}_handleError(e){this.destroy(new Error(`Error connecting to ${this.url}`))}_handleFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this.connected?e():this.once("connect",e)}_onInterval(){if(!this._cb||!this._ws||this._ws.bufferedAmount>Nre)return;this._debug("ending backpressure: bufferedAmount %d",this._ws.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],j_t.apply(null,e)}};IEe.WEBSOCKET_SUPPORT=!!wA;var q_t=IEe,kEe={};(function(t){t.DEFAULT_ANNOUNCE_PEERS=50,t.MAX_ANNOUNCE_PEERS=82,t.binaryToHex=n=>(typeof n!="string"&&(n=String(n)),kl.from(n,"binary").toString("hex")),t.hexToBinary=n=>(typeof n!="string"&&(n=String(n)),kl.from(n,"hex").toString("binary")),t.parseUrl=n=>{const i=new URL(n.replace(/^udp:/,"http:"));return n.match(/^udp:/)&&Object.defineProperties(i,{href:{value:i.href.replace(/^http/,"udp")},protocol:{value:i.protocol.replace(/^http/,"udp")},origin:{value:i.origin.replace(/^http/,"udp")}}),i},Object.assign(t,xT)})(kEe);const $_t=kI;let W_t=class extends $_t{constructor(e,n){super(),this.client=e,this.announceUrl=n,this.interval=null,this.destroyed=!1}setInterval(e){e==null&&(e=this.DEFAULT_ANNOUNCE_INTERVAL),clearInterval(this.interval),e&&(this.interval=setInterval(()=>{this.announce(this.client._defaultAnnounceOpts())},e),this.interval.unref&&this.interval.unref())}};var Y_t=W_t;const X_t=Byt,Lp=ez("bittorrent-tracker:websocket-tracker"),K_t=H_t,J_t=tz,Z_t=q_t,Q_t=xT,y_=kEe,ebt=Y_t,bv={},tbt=10*1e3,nbt=60*60*1e3,ibt=5*60*1e3,rbt=50*1e3;let oX=class extends ebt{constructor(e,n){super(e,n),Lp("new websocket tracker %s",n),this.peers={},this.socket=null,this.reconnecting=!1,this.retries=0,this.reconnectTimer=null,this.expectingResponse=!1,this._openSocket()}announce(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.announce(e)});return}const n=Object.assign({},e,{action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary});if(this._trackerId&&(n.trackerid=this._trackerId),e.event==="stopped"||e.event==="completed")this._send(n);else{const i=Math.min(e.numwant,5);this._generateOffers(i,r=>{n.numwant=i,n.offers=r,this._send(n)})}}scrape(e){if(this.destroyed||this.reconnecting)return;if(!this.socket.connected){this.socket.once("connect",()=>{this.scrape(e)});return}const i={action:"scrape",info_hash:Array.isArray(e.infoHash)&&e.infoHash.length>0?e.infoHash.map(r=>r.toString("binary")):e.infoHash&&e.infoHash.toString("binary")||this.client._infoHashBinary};this._send(i)}destroy(e=Ire){if(this.destroyed)return e(null);this.destroyed=!0,clearInterval(this.interval),clearTimeout(this.reconnectTimer);for(const s in this.peers){const a=this.peers[s];clearTimeout(a.trackerTimeout),a.destroy()}if(this.peers=null,this.socket&&(this.socket.removeListener("connect",this._onSocketConnectBound),this.socket.removeListener("data",this._onSocketDataBound),this.socket.removeListener("close",this._onSocketCloseBound),this.socket.removeListener("error",this._onSocketErrorBound),this.socket=null),this._onSocketConnectBound=null,this._onSocketErrorBound=null,this._onSocketDataBound=null,this._onSocketCloseBound=null,bv[this.announceUrl]&&(bv[this.announceUrl].consumers-=1),bv[this.announceUrl].consumers>0)return e();let n=bv[this.announceUrl];delete bv[this.announceUrl],n.on("error",Ire),n.once("close",e);let i;if(!this.expectingResponse)return r();i=setTimeout(r,y_.DESTROY_TIMEOUT),n.once("data",r);function r(){i&&(clearTimeout(i),i=null),n.removeListener("data",r),n.destroy(),n=null}}_openSocket(){if(this.destroyed=!1,this.peers||(this.peers={}),this._onSocketConnectBound=()=>{this._onSocketConnect()},this._onSocketErrorBound=e=>{this._onSocketError(e)},this._onSocketDataBound=e=>{this._onSocketData(e)},this._onSocketCloseBound=()=>{this._onSocketClose()},this.socket=bv[this.announceUrl],this.socket)bv[this.announceUrl].consumers+=1,this.socket.connected&&this._onSocketConnectBound();else{const e=new URL(this.announceUrl);let n;this.client._proxyOpts&&(n=e.protocol==="wss:"?this.client._proxyOpts.httpsAgent:this.client._proxyOpts.httpAgent,!n&&this.client._proxyOpts.socksProxy&&(n=new Q_t.Agent(X_t(this.client._proxyOpts.socksProxy),e.protocol==="wss:"))),this.socket=bv[this.announceUrl]=new Z_t({url:this.announceUrl,agent:n}),this.socket.consumers=1,this.socket.once("connect",this._onSocketConnectBound)}this.socket.on("data",this._onSocketDataBound),this.socket.once("close",this._onSocketCloseBound),this.socket.once("error",this._onSocketErrorBound)}_onSocketConnect(){this.destroyed||this.reconnecting&&(this.reconnecting=!1,this.retries=0,this.announce(this.client._defaultAnnounceOpts()))}_onSocketData(e){if(!this.destroyed){this.expectingResponse=!1;try{e=JSON.parse(e)}catch{this.client.emit("warning",new Error("Invalid tracker response"));return}e.action==="announce"?this._onAnnounceResponse(e):e.action==="scrape"?this._onScrapeResponse(e):this._onSocketError(new Error(`invalid action in WS response: ${e.action}`))}}_onAnnounceResponse(e){if(e.info_hash!==this.client._infoHashBinary){Lp("ignoring websocket data from %s for %s (looking for %s: reused socket)",this.announceUrl,y_.binaryToHex(e.info_hash),this.client.infoHash);return}if(e.peer_id&&e.peer_id===this.client._peerIdBinary)return;Lp("received %s from %s for %s",JSON.stringify(e),this.announceUrl,this.client.infoHash);const n=e["failure reason"];if(n)return this.client.emit("warning",new Error(n));const i=e["warning message"];i&&this.client.emit("warning",new Error(i));const r=e.interval||e["min interval"];r&&this.setInterval(r*1e3);const s=e["tracker id"];if(s&&(this._trackerId=s),e.complete!=null){const o=Object.assign({},e,{announce:this.announceUrl,infoHash:y_.binaryToHex(e.info_hash)});this.client.emit("update",o)}let a;if(e.offer&&e.peer_id&&(Lp("creating peer (from remote offer)"),a=this._createPeer(),a.id=y_.binaryToHex(e.peer_id),a.once("signal",o=>{const c={action:"announce",info_hash:this.client._infoHashBinary,peer_id:this.client._peerIdBinary,to_peer_id:e.peer_id,answer:o,offer_id:e.offer_id};this._trackerId&&(c.trackerid=this._trackerId),this._send(c)}),this.client.emit("peer",a),a.signal(e.offer)),e.answer&&e.peer_id){const o=y_.binaryToHex(e.offer_id);a=this.peers[o],a?(a.id=y_.binaryToHex(e.peer_id),this.client.emit("peer",a),a.signal(e.answer),clearTimeout(a.trackerTimeout),a.trackerTimeout=null,delete this.peers[o]):Lp(`got unexpected answer: ${JSON.stringify(e.answer)}`)}}_onScrapeResponse(e){e=e.files||{};const n=Object.keys(e);if(n.length===0){this.client.emit("warning",new Error("invalid scrape response"));return}n.forEach(i=>{const r=Object.assign(e[i],{announce:this.announceUrl,infoHash:y_.binaryToHex(i)});this.client.emit("scrape",r)})}_onSocketClose(){this.destroyed||(this.destroy(),this._startReconnectTimer())}_onSocketError(e){this.destroyed||(this.destroy(),this.client.emit("warning",e),this._startReconnectTimer())}_startReconnectTimer(){const e=Math.floor(Math.random()*ibt)+Math.min(Math.pow(2,this.retries)*tbt,nbt);this.reconnecting=!0,clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout(()=>{this.retries++,this._openSocket()},e),this.reconnectTimer.unref&&this.reconnectTimer.unref(),Lp("reconnecting socket in %s ms",e)}_send(e){if(this.destroyed)return;this.expectingResponse=!0;const n=JSON.stringify(e);Lp("send %s",n),this.socket.send(n)}_generateOffers(e,n){const i=this,r=[];Lp("generating %s offers",e);for(let o=0;o<e;++o)s();a();function s(){const o=J_t(20).toString("hex");Lp("creating peer (from _generateOffers)");const c=i.peers[o]=i._createPeer({initiator:!0});c.once("signal",l=>{r.push({offer:l,offer_id:y_.hexToBinary(o)}),a()}),c.trackerTimeout=setTimeout(()=>{Lp("tracker timeout: destroying peer"),c.trackerTimeout=null,delete i.peers[o],c.destroy()},rbt),c.trackerTimeout.unref&&c.trackerTimeout.unref()}function a(){r.length===e&&(Lp("generated %s offers",e),n(r))}}_createPeer(e){const n=this;e=Object.assign({trickle:!1,config:n.client._rtcConfig,wrtc:n.client._wrtc},e);const i=new K_t(e);return i.once("error",r),i.once("connect",s),i;function r(a){n.client.emit("warning",new Error(`Connection error: ${a.message}`)),i.destroy()}function s(){i.removeListener("error",r),i.removeListener("connect",s)}}};oX.prototype.DEFAULT_ANNOUNCE_INTERVAL=30*1e3;oX._socketPool=bv;function Ire(){}var sbt=oX,cX={exports:{}},DEe={exports:{}};(function(t,e){(function(i,r){t.exports=r()})(typeof self<"u"?self:Ll,function(){return function(n){var i={};function r(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=n,r.c=i,r.d=function(s,a,o){r.o(s,a)||Object.defineProperty(s,a,{configurable:!1,enumerable:!0,get:o})},r.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(a,"a",a),a},r.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},r.p="",r(r.s=3)}([function(n,i,r){function s(_,v){if(!(_ instanceof v))throw new TypeError("Cannot call a class as a function")}var a=r(5),o=r(1),c=o.toHex,l=o.ceilHeapSize,u=r(6),h=function(_){for(_+=9;_%64>0;_+=1);return _},d=function(_,v){var E=new Uint8Array(_.buffer),T=v%4,x=v-T;switch(T){case 0:E[x+3]=0;case 1:E[x+2]=0;case 2:E[x+1]=0;case 3:E[x+0]=0}for(var N=(v>>2)+1;N<_.length;N++)_[N]=0},f=function(_,v,E){_[v>>2]|=128<<24-(v%4<<3),_[((v>>2)+2&-16)+14]=E/(1<<29)|0,_[((v>>2)+2&-16)+15]=E<<3},p=function(_,v){var E=new Int32Array(_,v+320,5),T=new Int32Array(5),x=new DataView(T.buffer);return x.setInt32(0,E[0],!1),x.setInt32(4,E[1],!1),x.setInt32(8,E[2],!1),x.setInt32(12,E[3],!1),x.setInt32(16,E[4],!1),T},g=function(){function _(v){if(s(this,_),v=v||64*1024,v%64>0)throw new Error("Chunk size must be a multiple of 128 bit");this._offset=0,this._maxChunkLen=v,this._padMaxChunkLen=h(v),this._heap=new ArrayBuffer(l(this._padMaxChunkLen+320+20)),this._h32=new Int32Array(this._heap),this._h8=new Int8Array(this._heap),this._core=new a({Int32Array},{},this._heap)}return _.prototype._initState=function(E,T){this._offset=0;var x=new Int32Array(E,T+320,5);x[0]=1732584193,x[1]=-271733879,x[2]=-1732584194,x[3]=271733878,x[4]=-1009589776},_.prototype._padChunk=function(E,T){var x=h(E),N=new Int32Array(this._heap,0,x>>2);return d(N,E),f(N,E,T),x},_.prototype._write=function(E,T,x,N){u(E,this._h8,this._h32,T,x,N||0)},_.prototype._coreCall=function(E,T,x,N,A){var I=x;this._write(E,T,x),A&&(I=this._padChunk(x,N)),this._core.hash(I,this._padMaxChunkLen)},_.prototype.rawDigest=function(E){var T=E.byteLength||E.length||E.size||0;this._initState(this._heap,this._padMaxChunkLen);var x=0,N=this._maxChunkLen;for(x=0;T>x+N;x+=N)this._coreCall(E,x,N,T,!1);return this._coreCall(E,x,T-x,T,!0),p(this._heap,this._padMaxChunkLen)},_.prototype.digest=function(E){return c(this.rawDigest(E).buffer)},_.prototype.digestFromString=function(E){return this.digest(E)},_.prototype.digestFromBuffer=function(E){return this.digest(E)},_.prototype.digestFromArrayBuffer=function(E){return this.digest(E)},_.prototype.resetState=function(){return this._initState(this._heap,this._padMaxChunkLen),this},_.prototype.append=function(E){var T=0,x=E.byteLength||E.length||E.size||0,N=this._offset%this._maxChunkLen,A=void 0;for(this._offset+=x;T<x;)A=Math.min(x-T,this._maxChunkLen-N),this._write(E,T,A,N),N+=A,T+=A,N===this._maxChunkLen&&(this._core.hash(this._maxChunkLen,this._padMaxChunkLen),N=0);return this},_.prototype.getState=function(){var E=this._offset%this._maxChunkLen,T=void 0;if(E)T=this._heap.slice(0);else{var x=new Int32Array(this._heap,this._padMaxChunkLen+320,5);T=x.buffer.slice(x.byteOffset,x.byteOffset+x.byteLength)}return{offset:this._offset,heap:T}},_.prototype.setState=function(E){if(this._offset=E.offset,E.heap.byteLength===20){var T=new Int32Array(this._heap,this._padMaxChunkLen+320,5);T.set(new Int32Array(E.heap))}else this._h32.set(new Int32Array(E.heap));return this},_.prototype.rawEnd=function(){var E=this._offset,T=E%this._maxChunkLen,x=this._padChunk(T,E);this._core.hash(x,this._padMaxChunkLen);var N=p(this._heap,this._padMaxChunkLen);return this._initState(this._heap,this._padMaxChunkLen),N},_.prototype.end=function(){return c(this.rawEnd().buffer)},_}();n.exports=g,n.exports._core=a},function(n,i){for(var r=new Array(256),s=0;s<256;s++)r[s]=(s<16?"0":"")+s.toString(16);n.exports.toHex=function(a){for(var o=new Uint8Array(a),c=new Array(a.byteLength),l=0;l<c.length;l++)c[l]=r[o[l]];return c.join("")},n.exports.ceilHeapSize=function(a){var o=0;if(a<=65536)return 65536;if(a<16777216)for(o=1;o<a;o=o<<1);else for(o=16777216;o<a;o+=16777216);return o},n.exports.isDedicatedWorkerScope=function(a){var o="WorkerGlobalScope"in a&&a instanceof a.WorkerGlobalScope,c="SharedWorkerGlobalScope"in a&&a instanceof a.SharedWorkerGlobalScope,l="ServiceWorkerGlobalScope"in a&&a instanceof a.ServiceWorkerGlobalScope;return o&&!c&&!l}},function(n,i,r){n.exports=function(){var s=r(0),a=function(l,u,h){try{return h(null,l.digest(u))}catch(d){return h(d)}},o=function(l,u,h,d,f){var p=new self.FileReader;p.onloadend=function(){if(p.error)return f(p.error);var _=p.result;u+=p.result.byteLength;try{l.append(_)}catch(v){f(v);return}u<d.size?o(l,u,h,d,f):f(null,l.end())},p.readAsArrayBuffer(d.slice(u,u+h))},c=!0;return self.onmessage=function(l){if(c){var u=l.data.data,h=l.data.file,d=l.data.id;if(!(typeof d>"u")&&!(!h&&!u)){var f=l.data.blockSize||4*1024*1024,p=new s(f);p.resetState();var g=function(_,v){_?self.postMessage({id:d,error:_.name}):self.postMessage({id:d,hash:v})};u&&a(p,u,g),h&&o(p,0,f,h,g)}}},function(){c=!1}}},function(n,i,r){var s=r(4),a=r(0),o=r(7),c=r(2),l=r(1),u=l.isDedicatedWorkerScope,h=typeof self<"u"&&u(self);a.disableWorkerBehaviour=h?c():function(){},a.createWorker=function(){var d=s(2),f=d.terminate;return d.terminate=function(){URL.revokeObjectURL(d.objectURL),f.call(d)},d},a.createHash=o,n.exports=a},function(n,i,r){function s(d){var f={};function p(_){if(f[_])return f[_].exports;var v=f[_]={i:_,l:!1,exports:{}};return d[_].call(v.exports,v,v.exports,p),v.l=!0,v.exports}p.m=d,p.c=f,p.i=function(_){return _},p.d=function(_,v,E){p.o(_,v)||Object.defineProperty(_,v,{configurable:!1,enumerable:!0,get:E})},p.r=function(_){Object.defineProperty(_,"__esModule",{value:!0})},p.n=function(_){var v=_&&_.__esModule?function(){return _.default}:function(){return _};return p.d(v,"a",v),v},p.o=function(_,v){return Object.prototype.hasOwnProperty.call(_,v)},p.p="/",p.oe=function(_){throw console.error(_),_};var g=p(p.s=ENTRY_MODULE);return g.default||g}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\((/\\*.*?\\*/)?s?.*?("+a+").*?\\)";function c(d){return(d+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function l(d,f,p){var g={};g[p]=[];var _=f.toString(),v=_.match(/^function\s?\(\w+,\s*\w+,\s*(\w+)\)/);if(!v)return g;for(var E=v[1],T=new RegExp("(\\\\n|\\W)"+c(E)+o,"g"),x;x=T.exec(_);)x[3]!=="dll-reference"&&g[p].push(x[3]);for(T=new RegExp("\\("+c(E)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");x=T.exec(_);)d[x[2]]||(g[p].push(x[1]),d[x[2]]=r(x[1]).m),g[x[2]]=g[x[2]]||[],g[x[2]].push(x[4]);return g}function u(d){var f=Object.keys(d);return f.reduce(function(p,g){return p||d[g].length>0},!1)}function h(d,f){for(var p={main:[f]},g={main:[]},_={main:{}};u(p);)for(var v=Object.keys(p),E=0;E<v.length;E++){var T=v[E],x=p[T],N=x.pop();if(_[T]=_[T]||{},!(_[T][N]||!d[T][N])){_[T][N]=!0,g[T]=g[T]||[],g[T].push(N);for(var A=l(d,d[T][N],T),I=Object.keys(A),k=0;k<I.length;k++)p[I[k]]=p[I[k]]||[],p[I[k]]=p[I[k]].concat(A[I[k]])}}return g}n.exports=function(d,f){f=f||{};var p={main:r.m},g=f.all?{main:Object.keys(p)}:h(p,d),_="";Object.keys(g).filter(function(N){return N!=="main"}).forEach(function(N){for(var A=0;g[N][A];)A++;g[N].push(A),p[N][A]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",_=_+"var "+N+" = ("+s.toString().replace("ENTRY_MODULE",JSON.stringify(A))+")({"+g[N].map(function(I){return""+JSON.stringify(I)+": "+p[N][I].toString()}).join(",")+`});
`}),_=_+"("+s.toString().replace("ENTRY_MODULE",JSON.stringify(d))+")({"+g.main.map(function(N){return""+JSON.stringify(N)+": "+p.main[N].toString()}).join(",")+"})(self);";var v=new window.Blob([_],{type:"text/javascript"});if(f.bare)return v;var E=window.URL||window.webkitURL||window.mozURL||window.msURL,T=E.createObjectURL(v),x=new window.Worker(T);return x.objectURL=T,x}},function(n,i){n.exports=function(s,a,o){var c=new s.Int32Array(o);function l(u,h){u=u|0,h=h|0;var d=0,f=0,p=0,g=0,_=0,v=0,E=0,T=0,x=0,N=0,A=0,I=0,k=0,L=0;for(p=c[h+320>>2]|0,_=c[h+324>>2]|0,E=c[h+328>>2]|0,x=c[h+332>>2]|0,A=c[h+336>>2]|0,d=0;(d|0)<(u|0);d=d+64|0){for(g=p,v=_,T=E,N=x,I=A,f=0;(f|0)<64;f=f+4|0)L=c[d+f>>2]|0,k=((p<<5|p>>>27)+(_&E|~_&x)|0)+((L+A|0)+1518500249|0)|0,A=x,x=E,E=_<<30|_>>>2,_=p,p=k,c[u+f>>2]=L;for(f=u+64|0;(f|0)<(u+80|0);f=f+4|0)L=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_&E|~_&x)|0)+((L+A|0)+1518500249|0)|0,A=x,x=E,E=_<<30|_>>>2,_=p,p=k,c[f>>2]=L;for(f=u+80|0;(f|0)<(u+160|0);f=f+4|0)L=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_^E^x)|0)+((L+A|0)+1859775393|0)|0,A=x,x=E,E=_<<30|_>>>2,_=p,p=k,c[f>>2]=L;for(f=u+160|0;(f|0)<(u+240|0);f=f+4|0)L=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_&E|_&x|E&x)|0)+((L+A|0)-1894007588|0)|0,A=x,x=E,E=_<<30|_>>>2,_=p,p=k,c[f>>2]=L;for(f=u+240|0;(f|0)<(u+320|0);f=f+4|0)L=(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])<<1|(c[f-12>>2]^c[f-32>>2]^c[f-56>>2]^c[f-64>>2])>>>31,k=((p<<5|p>>>27)+(_^E^x)|0)+((L+A|0)-899497514|0)|0,A=x,x=E,E=_<<30|_>>>2,_=p,p=k,c[f>>2]=L;p=p+g|0,_=_+v|0,E=E+T|0,x=x+N|0,A=A+I|0}c[h+320>>2]=p,c[h+324>>2]=_,c[h+328>>2]=E,c[h+332>>2]=x,c[h+336>>2]=A}return{hash:l}}},function(n,i){var r=this,s=void 0;typeof self<"u"&&typeof self.FileReaderSync<"u"&&(s=new self.FileReaderSync);var a=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,E=f-v;switch(_){case 0:u[p]=l.charCodeAt(d+3);case 1:u[p+1-(_<<1)|0]=l.charCodeAt(d+2);case 2:u[p+2-(_<<1)|0]=l.charCodeAt(d+1);case 3:u[p+3-(_<<1)|0]=l.charCodeAt(d)}if(!(f<v+(4-_))){for(g=4-_;g<E;g=g+4|0)h[p+g>>2]=l.charCodeAt(d+g)<<24|l.charCodeAt(d+g+1)<<16|l.charCodeAt(d+g+2)<<8|l.charCodeAt(d+g+3);switch(v){case 3:u[p+E+1|0]=l.charCodeAt(d+E+2);case 2:u[p+E+2|0]=l.charCodeAt(d+E+1);case 1:u[p+E+3|0]=l.charCodeAt(d+E)}}},o=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,E=f-v;switch(_){case 0:u[p]=l[d+3];case 1:u[p+1-(_<<1)|0]=l[d+2];case 2:u[p+2-(_<<1)|0]=l[d+1];case 3:u[p+3-(_<<1)|0]=l[d]}if(!(f<v+(4-_))){for(g=4-_;g<E;g=g+4|0)h[p+g>>2|0]=l[d+g]<<24|l[d+g+1]<<16|l[d+g+2]<<8|l[d+g+3];switch(v){case 3:u[p+E+1|0]=l[d+E+2];case 2:u[p+E+2|0]=l[d+E+1];case 1:u[p+E+3|0]=l[d+E]}}},c=function(l,u,h,d,f,p){var g=void 0,_=p%4,v=(f+_)%4,E=f-v,T=new Uint8Array(s.readAsArrayBuffer(l.slice(d,d+f)));switch(_){case 0:u[p]=T[3];case 1:u[p+1-(_<<1)|0]=T[2];case 2:u[p+2-(_<<1)|0]=T[1];case 3:u[p+3-(_<<1)|0]=T[0]}if(!(f<v+(4-_))){for(g=4-_;g<E;g=g+4|0)h[p+g>>2|0]=T[g]<<24|T[g+1]<<16|T[g+2]<<8|T[g+3];switch(v){case 3:u[p+E+1|0]=T[E+2];case 2:u[p+E+2|0]=T[E+1];case 1:u[p+E+3|0]=T[E]}}};n.exports=function(l,u,h,d,f,p){if(typeof l=="string")return a(l,u,h,d,f,p);if(l instanceof Array||r&&r.Buffer&&r.Buffer.isBuffer(l))return o(l,u,h,d,f,p);if(l instanceof ArrayBuffer)return o(new Uint8Array(l),u,h,d,f,p);if(l.buffer instanceof ArrayBuffer)return o(new Uint8Array(l.buffer,l.byteOffset,l.byteLength),u,h,d,f,p);if(l instanceof Blob)return c(l,u,h,d,f,p);throw new Error("Unsupported data type.")}},function(n,i,r){var s=function(){function h(d,f){for(var p=0;p<f.length;p++){var g=f[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(d,g.key,g)}}return function(d,f,p){return f&&h(d.prototype,f),p&&h(d,p),d}}();function a(h,d){if(!(h instanceof d))throw new TypeError("Cannot call a class as a function")}var o=r(0),c=r(1),l=c.toHex,u=function(){function h(){a(this,h),this._rusha=new o,this._rusha.resetState()}return h.prototype.update=function(f){return this._rusha.append(f),this},h.prototype.digest=function(f){var p=this._rusha.rawEnd().buffer;if(!f)return p;if(f==="hex")return l(p);throw new Error("unsupported digest encoding")},s(h,[{key:"state",get:function(){return this._rusha.getState()},set:function(d){this._rusha.setState(d)}}]),h}();n.exports=function(){return new u}}])})})(DEe);var PEe=DEe.exports;const abt=PEe;let GU,jP,VP;function obt(){GU=abt.createWorker(),jP=1,VP={},GU.onmessage=function(e){const n=e.data.id,i=VP[n];delete VP[n],e.data.error!=null?i(new Error("Rusha worker error: "+e.data.error)):i(null,e.data.hash)}}function cbt(t,e){GU||obt(),VP[jP]=e,GU.postMessage({id:jP,data:t}),jP+=1}var lbt=cbt;const ubt=PEe,hbt=lbt,dbt=new ubt,kre=typeof window<"u"?window:self,Dre=kre.crypto||kre.msCrypto||{};let dM=Dre.subtle||Dre.webkitSubtle;function GP(t){return dbt.digest(t)}try{dM.digest({name:"sha-1"},new Uint8Array).catch(function(){dM=!1})}catch{dM=!1}function fbt(t,e){if(!dM){typeof window<"u"?hbt(t,function(i,r){if(i){e(GP(t));return}e(r)}):queueMicrotask(()=>e(GP(t)));return}typeof t=="string"&&(t=pbt(t)),dM.digest({name:"sha-1"},t).then(function(i){e(mbt(new Uint8Array(i)))},function(){e(GP(t))})}function pbt(t){const e=t.length,n=new Uint8Array(e);for(let i=0;i<e;i++)n[i]=t.charCodeAt(i);return n}function mbt(t){const e=t.length,n=[];for(let i=0;i<e;i++){const r=t[i];n.push((r>>>4).toString(16)),n.push((r&15).toString(16))}return n.join("")}cX.exports=fbt;cX.exports.sync=GP;var gbt=cX.exports;const Pre=sbt,vbt=tz,ybt=kI,_bt=gbt,lA=ez("p2pt"),Lre="^",Ure=16e3;class bbt extends ybt{constructor(e=[],n=""){super(),this.announceURLs=e,this.trackers={},this.peers={},this.msgChunks={},this.responseWaiting={},n&&this.setIdentifier(n),this._peerIdBuffer=vbt(20),this._peerId=this._peerIdBuffer.toString("hex"),this._peerIdBinary=this._peerIdBuffer.toString("binary"),lA("my peer id: "+this._peerId)}setIdentifier(e){this.identifierString=e,this.infoHash=_bt.sync(e).toLowerCase(),this._infoHashBuffer=kl.from(this.infoHash,"hex"),this._infoHashBinary=this._infoHashBuffer.toString("binary")}start(){this.on("peer",e=>{let n=!1;this.peers[e.id]||(n=!0,this.peers[e.id]={},this.responseWaiting[e.id]={}),e.on("connect",()=>{this.peers[e.id][e.channelName]=e,n&&this.emit("peerconnect",e)}),e.on("data",i=>{if(this.emit("data",e,i),i=i.toString(),lA("got a message from "+e.id),i[0]===Lre)try{i=JSON.parse(i.slice(1)),e.respond=this._peerRespond(e,i.id);let r=this._chunkHandler(i);r!==!1&&(i.o&&(r=JSON.parse(r)),this.responseWaiting[e.id][i.id]?(this.responseWaiting[e.id][i.id]([e,r]),delete this.responseWaiting[e.id][i.id]):this.emit("msg",e,r),this._destroyChunks(i.id))}catch(r){console.log(r)}}),e.on("error",i=>{this._removePeer(e),lA("Error in connection : "+i)}),e.on("close",()=>{this._removePeer(e),lA("Connection closed with "+e.id)})}),this.on("update",e=>{const n=this.trackers[this.announceURLs.indexOf(e.announce)];this.emit("trackerconnect",n,this.getTrackerStats())}),this.on("warning",e=>{this.emit("trackerwarning",e,this.getTrackerStats())}),this._fetchPeers()}addTracker(e){if(this.announceURLs.indexOf(e)!==-1)throw new Error("Tracker already added");const n=this.announceURLs.push(e);this.trackers[n]=new Pre(this,e),this.trackers[n].announce(this._defaultAnnounceOpts())}removeTracker(e){const n=this.announceURLs.indexOf(e);if(n===-1)throw new Error("Tracker does not exist");this.trackers[n].peers=[],this.trackers[n].destroy(),delete this.trackers[n],delete this.announceURLs[n]}_removePeer(e){if(!this.peers[e.id])return!1;delete this.peers[e.id][e.channelName],Object.keys(this.peers[e.id]).length===0&&(this.emit("peerclose",e),delete this.responseWaiting[e.id],delete this.peers[e.id])}send(e,n,i=""){return new Promise((r,s)=>{const a={id:i!==""?i:Math.floor(Math.random()*1e5+1e5),msg:n};typeof n=="object"&&(a.msg=JSON.stringify(n),a.o=1);try{if(!e.connected){for(const l in this.peers[e.id])if(e=this.peers[e.id][l],e.connected)break}this.responseWaiting[e.id]||(this.responseWaiting[e.id]={}),this.responseWaiting[e.id][a.id]=r}catch(l){return s(Error("Connection to peer closed"+l))}let o=0,c="";for(;a.msg.length>0;)a.c=o,c=a.msg.slice(Ure),a.msg=a.msg.slice(0,Ure),c||(a.last=!0),e.send(Lre+JSON.stringify(a)),a.msg=c,o++;lA("sent a message to "+e.id)})}requestMorePeers(){return new Promise(e=>{for(const n in this.trackers)this.trackers[n].announce(this._defaultAnnounceOpts());e(this.peers)})}getTrackerStats(){let e=0;for(const n in this.trackers)this.trackers[n].socket&&this.trackers[n].socket.connected&&e++;return{connected:e,total:this.announceURLs.length}}destroy(){let e;for(e in this.peers)for(const n in this.peers[e])this.peers[e][n].destroy();for(e in this.trackers)this.trackers[e].destroy()}_peerRespond(e,n){return i=>this.send(e,i,n)}_chunkHandler(e){return this.msgChunks[e.id]||(this.msgChunks[e.id]=[]),this.msgChunks[e.id][e.c]=e.msg,e.last?this.msgChunks[e.id].join(""):!1}_destroyChunks(e){delete this.msgChunks[e]}_defaultAnnounceOpts(e={}){return e.numwant==null&&(e.numwant=50),e.uploaded==null&&(e.uploaded=0),e.downloaded==null&&(e.downloaded=0),e}_fetchPeers(){for(const e in this.announceURLs)this.trackers[e]=new Pre(this,this.announceURLs[e]),this.trackers[e].announce(this._defaultAnnounceOpts())}}var Ebt=bbt;const Sbt=Gc(Ebt),Tbt=`
wss://tracker.btorrent.xyz
wss://tracker.webtorrent.dev
wss://tracker.openwebtorrent.com
`.split(`
`).map(t=>t.trim()).filter(t=>t);function uR(t){return KM(t)}const xbt="hubworld_3f59c99d4a34d880d1fcce9b7e4024abc4f00f70",Zf=new Sbt(Tbt,xbt),PI=new Uyt(uR(Zf._peerId),{getId(t){return t.id}});Zf.on("peerconnect",t=>{wi(Ge,nr(),`remote connected ${t.id}`),PI.add({id:uR(t.id),peer:t})});Zf.on("peerclose",t=>{wi(Ge,nr(),`remote closed ${t.id}`),PI.remove(uR(t.id))});let qP="";const Bre=new Map;Zf.on("msg",(t,e)=>{const n=Date.now(),i=Bre.get(e.topic)??new Map;if("pub"in e){e.topic===qP&&(P_==null||P_.forward({...e.gme,session:Ge.session()}));for(const[r,s]of i)if(n-s>1e3*60)i.delete(r);else{const[o]=PI.listClosestToId(uR(r),1);ae(o)&&Zf.send(o.peer,e).catch(console.error)}}else"sub"in e&&(i.set(e.sub,n),e.topic===qP&&Zf._peerId===qP?(P_==null||P_.forward({...e.gme,session:Ge.session()}),Cbt()):ae(e.gme)&&BEe(e.topic,e.sub,e.gme));Bre.set(e.topic,i)});Zf.on("trackerconnect",(t,e)=>{wi(Ge,nr(),`looking for players ${APe(t.announceUrl)} [${e.connected}]`)});let Fre=!1,P_,LEe;function wbt(t){function e(){$De(Ge,t)}e(),LEe=setInterval(e,5*1e3)}function Cbt(){clearInterval(LEe)}function UEe(t){Fre||(Fre=!0,qP=t,Zf.start(),wi(Ge,nr(),`connecting to hubworld for ${t}`))}function Rbt(t,e){const[n]=PI.listClosestToId(uR(t),1);ae(n)&&Zf.send(n.peer,{topic:t,pub:!0,gme:e}).catch(()=>{})}function zre(t,e){const n=Zf._peerId;UEe(n),TDe(Ge,nr(),t,n),e&&SDe(Ge,nr(),n),P_=C9(i=>{nst(i)&&tst(i)===!1&&Rbt(n,i)})}function BEe(t,e,n){const[i]=PI.listClosestToId(uR(t),1);ae(i)&&Zf.send(i.peer,{topic:t,sub:e,gme:n}).catch(console.error)}function Abt(t,e){UEe(t),P_=C9(n=>{r0e(n)&&ist()===!1&&BEe(t,Zf._peerId,n)}),setTimeout(()=>wbt(e),1e3)}let ng,eu;async function Mbt(t,e,n,i,r,s){let a;switch(ai(r)){case"get":{a=await fetch(i);break}case"post:json":{const l=[];for(let u=0;u<s.length;u+=2)l.push([s[u],s[u+1]]);a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(sDe(l))});break}}if(!(a!=null&&a.ok))return;const o=`fetch:${n}`,[c]=(a.headers.get("content-type")??"").split(";");switch(c){case"text/plain":{const l=await a.text();wi(Ge,t,JSON.stringify(l)),wg(Ge,t,e,"text",o,l);break}case"application/json":{const l=await a.json();wi(Ge,t,JSON.stringify(l)),wg(Ge,t,e,"json",o,l);break}case"application/octet-stream":{const l=await a.arrayBuffer();wg(Ge,t,e,"binary",o,new Uint8Array(l));break}}}const Zs=qb("bridge",[],t=>{if(!Zs.session(t))return;const e=nr();switch(t.target){default:if(t.player!==e)return;break}switch(t.target){case"fetch":if(Li(t.data)){const[n,i,r,s,a]=t.data;qu(Ge,t.player,async()=>{await Mbt(t.player,n,i,r,s,a)})}break;case"start":zre(!!t.data,!1);break;case"tab":zre(!!t.data,!0);break;case"tabopen":On(t.data)&&window.open(`${location.origin}/join/#${t.data}`,"_blank","noopener,noreferrer");break;case"join":On(t.data)&&Abt(t.data,t.player);break;case"showjoincode":qu(Zs,t.player,async()=>{if(Li(t.data)){const[n,i]=t.data,r=`${location.origin}/join/#${i}`,s=await J5(r);n?g2(Zs,t.player,s,"secret join url",!1):g2(Zs,t.player,s,s)}});break;case"talkstart":Umt();break;case"talkstop":Bmt();break;case"mediastart":zmt();break;case"mediastop":Hmt();break;case"chatstart":ae(ng)?Hi(Zs,t.player,"bridge","chat is already started"):On(t.data)&&(wi(Zs,t.player,`connecting to ${t.data}`),ng=new jU({channels:[t.data]}),ng.connect(),ng.onConnect(()=>{wi(Zs,t.player,"connected")}),ng.onDisconnect(()=>{wi(Zs,t.player,"disconnected")}),ng.onMessage((n,i,r)=>{wg(Zs,t.player,void 0,"text",`chat:message:${t.data}`,`${i}:${r}`)}),ng.onAction((n,i,r)=>{wg(Zs,t.player,void 0,"text",`chat:action:${t.data}`,`${i}:${r}`)}));break;case"chatstop":ae(ng)?(ng.quit(),ng=void 0,wi(Zs,t.player,"chat stopped")):Hi(Zs,t.player,"bridge","chat is already stoped");break;case"streamstart":qu(Zs,t.player,async()=>{if(ae(eu))Hi(Zs,t.player,"bridge","stream is already open");else{const n=window.innerHeight>window.innerWidth;eu=dS.create({streamConfig:n?dS.STANDARD_PORTRAIT:dS.STANDARD_LANDSCAPE,logLevel:dS.LOG_LEVEL.DEBUG}),eu.on(dS.BroadcastClientEvents.ACTIVE_STATE_CHANGE,function(s){console.info({activestate:s})}),eu.on(dS.BroadcastClientEvents.CONNECTION_STATE_CHANGE,function(s){wi(Zs,t.player,s)}),eu.on(dS.BroadcastClientEvents.ERROR,function(s){Hi(Zs,t.player,"bridge",s),eu=void 0});const i=document.querySelector("canvas");if(ae(i))await eu.addImageSource(i,"video",{index:1});else{Hi(Zs,t.player,"video","unabled to find canvas element"),eu=void 0;return}const r=bft();if(ae(r))await eu.addAudioInputDevice(r.stream,"audio");else{Hi(Zs,t.player,"video","unable create media audio node destination"),eu=void 0;return}wi(Zs,t.player,"created client")}On(t.data)&&ae(eu)&&(jp(Zs,t.player,"broadcasting in"),cr(Zs,t.player,"3","..."),await zp(1e3),cr(Zs,t.player,"2","..."),await zp(1e3),cr(Zs,t.player,"1","..."),await zp(1e3),jp(Zs,t.player,"GOING LIVE"),await eu.startBroadcast(t.data,"https://g.webrtc.live-video.net:4443"))});break;case"streamstop":ae(eu)?(eu.stopBroadcast(),eu.delete(),eu=void 0,wi(Zs,t.player,"stream stopped")):Hi(Zs,t.player,"bridge","stream already stopped");break}});function Obt(){const{viewport:t}=Zu(),{width:e,height:n}=t.getCurrentViewport(),[i]=Be.useState(()=>new Nft);Be.useEffect(()=>{if(!Ize)return;document.body.appendChild(i.dom),i.showPanel(0),i.dom.style.cssText="position:fixed;bottom:0;left:0;";const u=zOe(()=>i.begin()),h=HOe(()=>i.end());return()=>{document.body.removeChild(i.dom),u(),h()}},[i]);const r=Uft(),a=Math.min(e,n)<600||Pze;kn.DRAW_CHAR_SCALE=a?1:2;const o=e>n,c=Lze||AG==="touchOnly"||emt==="touch",l=!Dze&&!a&&!c&&r&&r.tier>2&&!r.isMobile;return Be.useEffect(()=>{zh.setState(u=>({...u,islowrez:a,islandscape:o,showtouchcontrols:c}))},[a,o,c]),Ae.jsxs(Ae.Fragment,{children:[Ae.jsx(ax,{children:Ae.jsxs(m0t,{children:[Ae.jsx(g0t,{}),Ae.jsx(Z0t,{}),Ae.jsx(evt,{})]})}),l&&Ae.jsx($pt,{children:Ae.jsx(cmt,{viewheight:n})})]})}document.addEventListener("keydown",()=>{iE()});window.addEventListener("touchstart",()=>{iE()});window.addEventListener("click",()=>{iE()});window.addEventListener("dragover",t=>{t.preventDefault()});window.addEventListener("contextmenu",t=>{iE(),t.preventDefault()});window.addEventListener("paste",t=>{var n;if(!((n=t.clipboardData)!=null&&n.files.length))return;iE(),t.preventDefault(),[...t.clipboardData.files].forEach(i=>wg(Ge,nr(),void 0,"file",`file:${i.name}`,i))});window.addEventListener("drop",t=>{var e,n;iE(),t.preventDefault(),(e=t.dataTransfer)!=null&&e.items?[...t.dataTransfer.items].forEach(r=>{if(r.kind==="file"){const s=r.getAsFile();ae(s)&&wg(Ge,nr(),void 0,"file",s.name,s)}}):[...((n=t.dataTransfer)==null?void 0:n.files)??[]].forEach(r=>wg(Ge,nr(),void 0,"file",r.name,r))});function Nbt(){return Ae.jsx(Obt,{})}Ike();const ID=new Re,Hre=new Re,Ibt=t=>({...Ioe(t),filter:e=>{const n=e.filter(a=>!(!a.object.visible||(a.object.userData.clippingPlanes??[]).some(c=>(c.projectPoint(a.point,ID),Hre.subVectors(a.point,ID).normalize().round(),ID.copy(c.normal).round(),ID.equals(Hre)===!1)))),i=n.findIndex(a=>a.object.userData.blocking),r=i===-1?n:n.slice(0,i+1);let s="default";return r.some(a=>a.object.userData.cursor?(s=a.object.userData.cursor,!0):!1),document.querySelectorAll("html, body").forEach(a=>{a.style.cursor=s}),r}});let Tj;function kbt(t,e){const n=document.getElementById("frame");if(!ae(n))return;const i=TZ(t),r=TZ(e);n.style.width=`${i}px`,n.style.height=`${r}px`,ae(Tj)||(Tj=Mke.createRoot(n),Tj.render(Ae.jsx(YOe,{flat:!0,linear:!0,shadows:!1,events:Ibt,gl:{alpha:!0,stencil:!1,antialias:!1,preserveDrawingBuffer:!0},onCreated:({gl:s})=>{s.localClippingEnabled=!0},children:Ae.jsx(Nbt,{})})))}const FEe=KOe(kbt,256);window.addEventListener("resize",()=>FEe(window.innerWidth,window.innerHeight));FEe(window.innerWidth,window.innerHeight);export{kl as B,$Et as a,lGe as b,Ll as c,zn as p,xT as r};
