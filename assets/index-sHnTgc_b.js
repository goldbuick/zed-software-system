var lSe=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var a_t=lSe((Pg,Ih)=>{function cSe(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in n)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(n,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var C0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Bh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function uSe(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var i=!1;try{i=this instanceof r}catch{}return i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:function(){return n[r]}})}),t}var N5={exports:{}},TR={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KG;function fSe(){if(KG)return TR;KG=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:n,type:r,key:a,ref:i!==void 0?i:null,props:s}}return TR.Fragment=e,TR.jsx=t,TR.jsxs=t,TR}var ZG;function hSe(){return ZG||(ZG=1,N5.exports=fSe()),N5.exports}var we=hSe();function dSe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var yse={exports:{}},Vu=yse.exports={},fv,hv;function BF(){throw new Error("setTimeout has not been defined")}function FF(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?fv=setTimeout:fv=BF}catch{fv=BF}try{typeof clearTimeout=="function"?hv=clearTimeout:hv=FF}catch{hv=FF}})();function bse(n){if(fv===setTimeout)return setTimeout(n,0);if((fv===BF||!fv)&&setTimeout)return fv=setTimeout,setTimeout(n,0);try{return fv(n,0)}catch{try{return fv.call(null,n,0)}catch{return fv.call(this,n,0)}}}function pSe(n){if(hv===clearTimeout)return clearTimeout(n);if((hv===FF||!hv)&&clearTimeout)return hv=clearTimeout,clearTimeout(n);try{return hv(n)}catch{try{return hv.call(null,n)}catch{return hv.call(this,n)}}}var jy=[],xT=!1,GS,wN=-1;function mSe(){!xT||!GS||(xT=!1,GS.length?jy=GS.concat(jy):wN=-1,jy.length&&Sse())}function Sse(){if(!xT){var n=bse(mSe);xT=!0;for(var e=jy.length;e;){for(GS=jy,jy=[];++wN<e;)GS&&GS[wN].run();wN=-1,e=jy.length}GS=null,xT=!1,pSe(n)}}Vu.nextTick=function(n){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];jy.push(new Ese(n,e)),jy.length===1&&!xT&&bse(Sse)};function Ese(n,e){this.fun=n,this.array=e}Ese.prototype.run=function(){this.fun.apply(null,this.array)};Vu.title="browser";Vu.browser=!0;Vu.env={};Vu.argv=[];Vu.version="";Vu.versions={};function hb(){}Vu.on=hb;Vu.addListener=hb;Vu.once=hb;Vu.off=hb;Vu.removeListener=hb;Vu.removeAllListeners=hb;Vu.emit=hb;Vu.prependListener=hb;Vu.prependOnceListener=hb;Vu.listeners=function(n){return[]};Vu.binding=function(n){throw new Error("process.binding is not supported")};Vu.cwd=function(){return"/"};Vu.chdir=function(n){throw new Error("process.chdir is not supported")};Vu.umask=function(){return 0};var gSe=yse.exports;const xl=dSe(gSe);var P5={exports:{}},ms={},QG;function _Se(){if(QG)return ms;QG=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;function d(Z){return Z===null||typeof Z!="object"?null:(Z=f&&Z[f]||Z["@@iterator"],typeof Z=="function"?Z:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,_={};function y(Z,K,ne){this.props=Z,this.context=K,this.refs=_,this.updater=ne||g}y.prototype.isReactComponent={},y.prototype.setState=function(Z,K){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,K,"setState")},y.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")};function v(){}v.prototype=y.prototype;function x(Z,K,ne){this.props=Z,this.context=K,this.refs=_,this.updater=ne||g}var E=x.prototype=new v;E.constructor=x,p(E,y.prototype),E.isPureReactComponent=!0;var M=Array.isArray,O={H:null,A:null,T:null,S:null,V:null},N=Object.prototype.hasOwnProperty;function I(Z,K,ne,le,ce,de){return ne=de.ref,{$$typeof:n,type:Z,key:K,ref:ne!==void 0?ne:null,props:de}}function D(Z,K){return I(Z.type,K,void 0,void 0,void 0,Z.props)}function V(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===n}function G(Z){var K={"=":"=0",":":"=2"};return"$"+Z.replace(/[=:]/g,function(ne){return K[ne]})}var Q=/\/+/g;function B(Z,K){return typeof Z=="object"&&Z!==null&&Z.key!=null?G(""+Z.key):K.toString(36)}function $(){}function U(Z){switch(Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason;default:switch(typeof Z.status=="string"?Z.then($,$):(Z.status="pending",Z.then(function(K){Z.status==="pending"&&(Z.status="fulfilled",Z.value=K)},function(K){Z.status==="pending"&&(Z.status="rejected",Z.reason=K)})),Z.status){case"fulfilled":return Z.value;case"rejected":throw Z.reason}}throw Z}function J(Z,K,ne,le,ce){var de=typeof Z;(de==="undefined"||de==="boolean")&&(Z=null);var Me=!1;if(Z===null)Me=!0;else switch(de){case"bigint":case"string":case"number":Me=!0;break;case"object":switch(Z.$$typeof){case n:case e:Me=!0;break;case u:return Me=Z._init,J(Me(Z._payload),K,ne,le,ce)}}if(Me)return ce=ce(Z),Me=le===""?"."+B(Z,0):le,M(ce)?(ne="",Me!=null&&(ne=Me.replace(Q,"$&/")+"/"),J(ce,K,ne,"",function(Ce){return Ce})):ce!=null&&(V(ce)&&(ce=D(ce,ne+(ce.key==null||Z&&Z.key===ce.key?"":(""+ce.key).replace(Q,"$&/")+"/")+Me)),K.push(ce)),1;Me=0;var qe=le===""?".":le+":";if(M(Z))for(var Pe=0;Pe<Z.length;Pe++)le=Z[Pe],de=qe+B(le,Pe),Me+=J(le,K,ne,de,ce);else if(Pe=d(Z),typeof Pe=="function")for(Z=Pe.call(Z),Pe=0;!(le=Z.next()).done;)le=le.value,de=qe+B(le,Pe++),Me+=J(le,K,ne,de,ce);else if(de==="object"){if(typeof Z.then=="function")return J(U(Z),K,ne,le,ce);throw K=String(Z),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(Z).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.")}return Me}function W(Z,K,ne){if(Z==null)return Z;var le=[],ce=0;return J(Z,le,"","",function(de){return K.call(ne,de,ce++)}),le}function q(Z){if(Z._status===-1){var K=Z._result;K=K(),K.then(function(ne){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=ne)},function(ne){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=ne)}),Z._status===-1&&(Z._status=0,Z._result=K)}if(Z._status===1)return Z._result.default;throw Z._result}var Y=typeof reportError=="function"?reportError:function(Z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var K=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Z=="object"&&Z!==null&&typeof Z.message=="string"?String(Z.message):String(Z),error:Z});if(!window.dispatchEvent(K))return}else if(typeof xl=="object"&&typeof xl.emit=="function"){xl.emit("uncaughtException",Z);return}console.error(Z)};function ae(){}return ms.Children={map:W,forEach:function(Z,K,ne){W(Z,function(){K.apply(this,arguments)},ne)},count:function(Z){var K=0;return W(Z,function(){K++}),K},toArray:function(Z){return W(Z,function(K){return K})||[]},only:function(Z){if(!V(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},ms.Component=y,ms.Fragment=t,ms.Profiler=i,ms.PureComponent=x,ms.StrictMode=r,ms.Suspense=l,ms.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=O,ms.__COMPILER_RUNTIME={__proto__:null,c:function(Z){return O.H.useMemoCache(Z)}},ms.cache=function(Z){return function(){return Z.apply(null,arguments)}},ms.cloneElement=function(Z,K,ne){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var le=p({},Z.props),ce=Z.key,de=void 0;if(K!=null)for(Me in K.ref!==void 0&&(de=void 0),K.key!==void 0&&(ce=""+K.key),K)!N.call(K,Me)||Me==="key"||Me==="__self"||Me==="__source"||Me==="ref"&&K.ref===void 0||(le[Me]=K[Me]);var Me=arguments.length-2;if(Me===1)le.children=ne;else if(1<Me){for(var qe=Array(Me),Pe=0;Pe<Me;Pe++)qe[Pe]=arguments[Pe+2];le.children=qe}return I(Z.type,ce,void 0,void 0,de,le)},ms.createContext=function(Z){return Z={$$typeof:a,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null},Z.Provider=Z,Z.Consumer={$$typeof:s,_context:Z},Z},ms.createElement=function(Z,K,ne){var le,ce={},de=null;if(K!=null)for(le in K.key!==void 0&&(de=""+K.key),K)N.call(K,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(ce[le]=K[le]);var Me=arguments.length-2;if(Me===1)ce.children=ne;else if(1<Me){for(var qe=Array(Me),Pe=0;Pe<Me;Pe++)qe[Pe]=arguments[Pe+2];ce.children=qe}if(Z&&Z.defaultProps)for(le in Me=Z.defaultProps,Me)ce[le]===void 0&&(ce[le]=Me[le]);return I(Z,de,void 0,void 0,null,ce)},ms.createRef=function(){return{current:null}},ms.forwardRef=function(Z){return{$$typeof:o,render:Z}},ms.isValidElement=V,ms.lazy=function(Z){return{$$typeof:u,_payload:{_status:-1,_result:Z},_init:q}},ms.memo=function(Z,K){return{$$typeof:c,type:Z,compare:K===void 0?null:K}},ms.startTransition=function(Z){var K=O.T,ne={};O.T=ne;try{var le=Z(),ce=O.S;ce!==null&&ce(ne,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(ae,Y)}catch(de){Y(de)}finally{O.T=K}},ms.unstable_useCacheRefresh=function(){return O.H.useCacheRefresh()},ms.use=function(Z){return O.H.use(Z)},ms.useActionState=function(Z,K,ne){return O.H.useActionState(Z,K,ne)},ms.useCallback=function(Z,K){return O.H.useCallback(Z,K)},ms.useContext=function(Z){return O.H.useContext(Z)},ms.useDebugValue=function(){},ms.useDeferredValue=function(Z,K){return O.H.useDeferredValue(Z,K)},ms.useEffect=function(Z,K,ne){var le=O.H;if(typeof ne=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return le.useEffect(Z,K)},ms.useId=function(){return O.H.useId()},ms.useImperativeHandle=function(Z,K,ne){return O.H.useImperativeHandle(Z,K,ne)},ms.useInsertionEffect=function(Z,K){return O.H.useInsertionEffect(Z,K)},ms.useLayoutEffect=function(Z,K){return O.H.useLayoutEffect(Z,K)},ms.useMemo=function(Z,K){return O.H.useMemo(Z,K)},ms.useOptimistic=function(Z,K){return O.H.useOptimistic(Z,K)},ms.useReducer=function(Z,K,ne){return O.H.useReducer(Z,K,ne)},ms.useRef=function(Z){return O.H.useRef(Z)},ms.useState=function(Z){return O.H.useState(Z)},ms.useSyncExternalStore=function(Z,K,ne){return O.H.useSyncExternalStore(Z,K,ne)},ms.useTransition=function(){return O.H.useTransition()},ms.version="19.1.1",ms}var JG;function Mw(){return JG||(JG=1,P5.exports=_Se()),P5.exports}var it=Mw();const Og=Bh(it);var D5={exports:{}},ly={};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e$;function vSe(){return e$||(e$=1,ly.ConcurrentRoot=1,ly.ContinuousEventPriority=8,ly.DefaultEventPriority=32,ly.DiscreteEventPriority=2,ly.IdleEventPriority=268435456,ly.LegacyRoot=0,ly.NoEventPriority=0),ly}var t$;function ySe(){return t$||(t$=1,D5.exports=vSe()),D5.exports}var RN=ySe();/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const kw="176",bSe={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},SSe={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},xse=0,zF=1,Tse=2,ESe=3,wse=0,YL=1,l2=2,d_=3,Lv=0,Yf=1,$f=2,Nh=0,nE=1,jF=2,HF=3,qF=4,Rse=5,i1=100,Ase=101,Cse=102,Mse=103,kse=104,Ose=200,Ise=201,Nse=202,Pse=203,xP=204,TP=205,Dse=206,Lse=207,Use=208,Bse=209,Fse=210,zse=211,jse=212,Hse=213,qse=214,wP=0,RP=1,AP=2,mE=3,CP=4,MP=5,kP=6,OP=7,Wk=0,Vse=1,Gse=2,kv=0,$se=1,Wse=2,Yse=3,dz=4,Xse=5,Kse=6,Zse=7,VF="attached",Qse="detached",XL=300,rb=301,E1=302,I2=303,N2=304,Ow=306,BT=1e3,M0=1001,P2=1002,bf=1003,pz=1004,xSe=1004,hT=1005,TSe=1005,nc=1006,c2=1007,wSe=1007,Tv=1008,RSe=1008,zl=1009,mz=1010,gz=1011,FT=1012,KL=1013,Uv=1014,Dp=1015,db=1016,ZL=1017,QL=1018,gE=1020,_z=35902,vz=1021,yz=1022,Xf=1023,zT=1026,_E=1027,Iw=1028,Yk=1029,JL=1030,e4=1031,ASe=1032,Xk=1033,u2=33776,f2=33777,h2=33778,d2=33779,IP=35840,NP=35841,PP=35842,DP=35843,LP=36196,UP=37492,BP=37496,FP=37808,zP=37809,jP=37810,HP=37811,qP=37812,VP=37813,GP=37814,$P=37815,WP=37816,YP=37817,XP=37818,KP=37819,ZP=37820,QP=37821,p2=36492,JP=36494,eD=36495,bz=36283,tD=36284,nD=36285,rD=36286,Jse=2200,eae=2201,tae=2202,D2=2300,iD=2301,AN=2302,$S=2400,WS=2401,L2=2402,t4=2500,Sz=2501,CSe=0,MSe=1,kSe=2,U1=3200,nae=3201,OSe=3202,ISe=3203,B1=0,rae=1,v_="",ta="srgb",Bv="srgb-linear",U2="linear",No="srgb",NSe=0,OS=7680,PSe=7681,DSe=7682,LSe=7683,USe=34055,BSe=34056,FSe=5386,zSe=512,jSe=513,HSe=514,qSe=515,VSe=516,GSe=517,$Se=518,GF=519,iae=512,sae=513,aae=514,Ez=515,oae=516,lae=517,cae=518,uae=519,B2=35044,$F=35048,WSe=35040,YSe=35045,XSe=35049,KSe=35041,ZSe=35046,QSe=35050,JSe=35042,eEe="100",WF="300 es",k0=2e3,F2=2001,tEe={COMPUTE:"compute",RENDER:"render"},nEe={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},rEe={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FLAT_FIRST:"flat first",FLAT_EITHER:"flat either"};class Vg{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(t)===-1&&r[e].push(t)}hasEventListener(e,t){const r=this._listeners;return r===void 0?!1:r[e]!==void 0&&r[e].indexOf(t)!==-1}removeEventListener(e,t){const r=this._listeners;if(r===void 0)return;const i=r[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const r=t[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const qd=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let n$=1234567;const rE=Math.PI/180,jT=180/Math.PI;function Dg(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(qd[n&255]+qd[n>>8&255]+qd[n>>16&255]+qd[n>>24&255]+"-"+qd[e&255]+qd[e>>8&255]+"-"+qd[e>>16&15|64]+qd[e>>24&255]+"-"+qd[t&63|128]+qd[t>>8&255]+"-"+qd[t>>16&255]+qd[t>>24&255]+qd[r&255]+qd[r>>8&255]+qd[r>>16&255]+qd[r>>24&255]).toLowerCase()}function Gi(n,e,t){return Math.max(e,Math.min(t,n))}function xz(n,e){return(n%e+e)%e}function iEe(n,e,t,r,i){return r+(n-e)*(i-r)/(t-e)}function sEe(n,e,t){return n!==e?(t-n)/(e-n):0}function m2(n,e,t){return(1-t)*n+t*e}function aEe(n,e,t,r){return m2(n,e,1-Math.exp(-t*r))}function oEe(n,e=1){return e-Math.abs(xz(n,e*2)-e)}function lEe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function cEe(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function uEe(n,e){return n+Math.floor(Math.random()*(e-n+1))}function fEe(n,e){return n+Math.random()*(e-n)}function hEe(n){return n*(.5-Math.random())}function dEe(n){n!==void 0&&(n$=n);let e=n$+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pEe(n){return n*rE}function mEe(n){return n*jT}function gEe(n){return(n&n-1)===0&&n!==0}function _Ee(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function vEe(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function yEe(n,e,t,r,i){const s=Math.cos,a=Math.sin,o=s(t/2),l=a(t/2),c=s((e+r)/2),u=a((e+r)/2),f=s((e-r)/2),d=a((e-r)/2),g=s((r-e)/2),p=a((r-e)/2);switch(i){case"XYX":n.set(o*u,l*f,l*d,o*c);break;case"YZY":n.set(l*d,o*u,l*f,o*c);break;case"ZXZ":n.set(l*f,l*d,o*u,o*c);break;case"XZX":n.set(o*u,l*p,l*g,o*c);break;case"YXY":n.set(l*g,o*u,l*p,o*c);break;case"ZYZ":n.set(l*p,l*g,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Ip(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function is(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const fae={DEG2RAD:rE,RAD2DEG:jT,generateUUID:Dg,clamp:Gi,euclideanModulo:xz,mapLinear:iEe,inverseLerp:sEe,lerp:m2,damp:aEe,pingpong:oEe,smoothstep:lEe,smootherstep:cEe,randInt:uEe,randFloat:fEe,randFloatSpread:hEe,seededRandom:dEe,degToRad:pEe,radToDeg:mEe,isPowerOfTwo:gEe,ceilPowerOfTwo:_Ee,floorPowerOfTwo:vEe,setQuaternionFromProperEuler:yEe,normalize:is,denormalize:Ip};class an{constructor(e=0,t=0){an.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,r=this.y,i=e.elements;return this.x=i[0]*t+i[3]*r+i[6],this.y=i[1]*t+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Gi(this.x,e.x,t.x),this.y=Gi(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Gi(this.x,e,t),this.y=Gi(this.y,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Gi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Gi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y;return t*t+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const r=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ji{constructor(e,t,r,i,s,a,o,l,c){Ji.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c)}set(e,t,r,i,s,a,o,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=t,u[4]=s,u[5]=l,u[6]=r,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],this}extractBasis(e,t,r){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[3],l=r[6],c=r[1],u=r[4],f=r[7],d=r[2],g=r[5],p=r[8],_=i[0],y=i[3],v=i[6],x=i[1],E=i[4],M=i[7],O=i[2],N=i[5],I=i[8];return s[0]=a*_+o*x+l*O,s[3]=a*y+o*E+l*N,s[6]=a*v+o*M+l*I,s[1]=c*_+u*x+f*O,s[4]=c*y+u*E+f*N,s[7]=c*v+u*M+f*I,s[2]=d*_+g*x+p*O,s[5]=d*y+g*E+p*N,s[8]=d*v+g*M+p*I,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return t*a*u-t*o*c-r*s*u+r*o*l+i*s*c-i*a*l}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=u*a-o*c,d=o*l-u*s,g=c*s-a*l,p=t*f+r*d+i*g;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/p;return e[0]=f*_,e[1]=(i*c-u*r)*_,e[2]=(o*r-i*a)*_,e[3]=d*_,e[4]=(u*t-i*l)*_,e[5]=(i*s-o*t)*_,e[6]=g*_,e[7]=(r*l-c*t)*_,e[8]=(a*t-r*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,r,i,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*a+c*o)+a+e,-i*c,i*l,-i*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(L5.makeScale(e,t)),this}rotate(e){return this.premultiply(L5.makeRotation(-e)),this}translate(e,t){return this.premultiply(L5.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,r,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<9;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<9;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const L5=new Ji;function hae(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const bEe={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function dT(n,e){return new bEe[n](e)}function z2(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function dae(){const n=z2("canvas");return n.style.display="block",n}const r$={};function CN(n){n in r$||(r$[n]=!0,console.warn(n))}function SEe(n,e,t){return new Promise(function(r,i){function s(){switch(n.clientWaitSync(e,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:i();break;case n.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:r()}}setTimeout(s,t)})}function EEe(n){const e=n.elements;e[2]=.5*e[2]+.5*e[3],e[6]=.5*e[6]+.5*e[7],e[10]=.5*e[10]+.5*e[11],e[14]=.5*e[14]+.5*e[15]}function xEe(n){const e=n.elements;e[11]===-1?(e[10]=-e[10]-1,e[14]=-e[14]):(e[10]=-e[10],e[14]=-e[14]+1)}const i$=new Ji().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),s$=new Ji().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function TEe(){const n={enabled:!0,workingColorSpace:Bv,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===No&&(i.r=Yy(i.r),i.g=Yy(i.g),i.b=Yy(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===No&&(i.r=TT(i.r),i.g=TT(i.g),i.b=TT(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===v_?U2:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],r=[.3127,.329];return n.define({[Bv]:{primaries:e,whitePoint:r,transfer:U2,toXYZ:i$,fromXYZ:s$,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ta},outputColorSpaceConfig:{drawingBufferColorSpace:ta}},[ta]:{primaries:e,whitePoint:r,transfer:No,toXYZ:i$,fromXYZ:s$,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ta}}}),n}const Sa=TEe();function Yy(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function TT(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let bx;class pae{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let r;if(e instanceof HTMLCanvasElement)r=e;else{bx===void 0&&(bx=z2("canvas")),bx.width=e.width,bx.height=e.height;const i=bx.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),r=bx}return r.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=z2("canvas");t.width=e.width,t.height=e.height;const r=t.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Yy(s[a]/255)*255;return r.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let r=0;r<t.length;r++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[r]=Math.floor(Yy(t[r]/255)*255):t[r]=Yy(t[r]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let wEe=0,c1=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:wEe++}),this.uuid=Dg(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(U5(i[a].image)):s.push(U5(i[a]))}else s=U5(i);r.url=s}return t||(e.images[this.uuid]=r),r}};function U5(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?pae.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let REe=0;class xc extends Vg{constructor(e=xc.DEFAULT_IMAGE,t=xc.DEFAULT_MAPPING,r=M0,i=M0,s=nc,a=Tv,o=Xf,l=zl,c=xc.DEFAULT_ANISOTROPY,u=v_){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:REe++}),this.uuid=Dg(),this.name="",this.source=new c1(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new an(0,0),this.repeat=new an(1,1),this.center=new an(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ji,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=u,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isTextureArray=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isTextureArray=e.isTextureArray,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),t||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==XL)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case BT:e.x=e.x-Math.floor(e.x);break;case M0:e.x=e.x<0?0:1;break;case P2:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case BT:e.y=e.y-Math.floor(e.y);break;case M0:e.y=e.y<0?0:1;break;case P2:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}xc.DEFAULT_IMAGE=null;xc.DEFAULT_MAPPING=XL;xc.DEFAULT_ANISOTROPY=1;class xa{constructor(e=0,t=0,r=0,i=1){xa.prototype.isVector4=!0,this.x=e,this.y=t,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,r,i){return this.x=e,this.y=t,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*r+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,r,i,s;const l=e.elements,c=l[0],u=l[4],f=l[8],d=l[1],g=l[5],p=l[9],_=l[2],y=l[6],v=l[10];if(Math.abs(u-d)<.01&&Math.abs(f-_)<.01&&Math.abs(p-y)<.01){if(Math.abs(u+d)<.1&&Math.abs(f+_)<.1&&Math.abs(p+y)<.1&&Math.abs(c+g+v-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const E=(c+1)/2,M=(g+1)/2,O=(v+1)/2,N=(u+d)/4,I=(f+_)/4,D=(p+y)/4;return E>M&&E>O?E<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(E),i=N/r,s=I/r):M>O?M<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(M),r=N/i,s=D/i):O<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(O),r=I/s,i=D/s),this.set(r,i,s,t),this}let x=Math.sqrt((y-p)*(y-p)+(f-_)*(f-_)+(d-u)*(d-u));return Math.abs(x)<.001&&(x=1),this.x=(y-p)/x,this.y=(f-_)/x,this.z=(d-u)/x,this.w=Math.acos((c+g+v-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Gi(this.x,e.x,t.x),this.y=Gi(this.y,e.y,t.y),this.z=Gi(this.z,e.z,t.z),this.w=Gi(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Gi(this.x,e,t),this.y=Gi(this.y,e,t),this.z=Gi(this.z,e,t),this.w=Gi(this.w,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Gi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this.w=e.w+(t.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class n4 extends Vg{constructor(e=1,t=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=r.depth?r.depth:1,this.scissor=new xa(0,0,e,t),this.scissorTest=!1,this.viewport=new xa(0,0,e,t);const i={width:e,height:t,depth:this.depth};r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:nc,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,multiview:!1},r);const s=new xc(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace);s.flipY=!1,s.generateMipmaps=r.generateMipmaps,s.internalFormat=r.internalFormat,this.textures=[];const a=r.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.resolveDepthBuffer=r.resolveDepthBuffer,this.resolveStencilBuffer=r.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=r.depthTexture,this.samples=r.samples,this.multiview=r.multiview}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,r=1){if(this.width!==e||this.height!==t||this.depth!==r){this.width=e,this.height=t,this.depth=r;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,r=e.textures.length;t<r;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new c1(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sf extends n4{constructor(e=1,t=1,r={}){super(e,t,r),this.isWebGLRenderTarget=!0}}class Kk extends xc{constructor(e=null,t=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=bf,this.minFilter=bf,this.wrapR=M0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class AEe extends Sf{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new Kk(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class r4 extends xc{constructor(e=null,t=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:r,depth:i},this.magFilter=bf,this.minFilter=bf,this.wrapR=M0,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class CEe extends Sf{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new r4(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class jp{constructor(e=0,t=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=r,this._w=i}static slerpFlat(e,t,r,i,s,a,o){let l=r[i+0],c=r[i+1],u=r[i+2],f=r[i+3];const d=s[a+0],g=s[a+1],p=s[a+2],_=s[a+3];if(o===0){e[t+0]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f;return}if(o===1){e[t+0]=d,e[t+1]=g,e[t+2]=p,e[t+3]=_;return}if(f!==_||l!==d||c!==g||u!==p){let y=1-o;const v=l*d+c*g+u*p+f*_,x=v>=0?1:-1,E=1-v*v;if(E>Number.EPSILON){const O=Math.sqrt(E),N=Math.atan2(O,v*x);y=Math.sin(y*N)/O,o=Math.sin(o*N)/O}const M=o*x;if(l=l*y+d*M,c=c*y+g*M,u=u*y+p*M,f=f*y+_*M,y===1-o){const O=1/Math.sqrt(l*l+c*c+u*u+f*f);l*=O,c*=O,u*=O,f*=O}}e[t]=l,e[t+1]=c,e[t+2]=u,e[t+3]=f}static multiplyQuaternionsFlat(e,t,r,i,s,a){const o=r[i],l=r[i+1],c=r[i+2],u=r[i+3],f=s[a],d=s[a+1],g=s[a+2],p=s[a+3];return e[t]=o*p+u*f+l*g-c*d,e[t+1]=l*p+u*d+c*f-o*g,e[t+2]=c*p+u*g+o*d-l*f,e[t+3]=u*p-o*f-l*d-c*g,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,r,i){return this._x=e,this._y=t,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(r/2),u=o(i/2),f=o(s/2),d=l(r/2),g=l(i/2),p=l(s/2);switch(a){case"XYZ":this._x=d*u*f+c*g*p,this._y=c*g*f-d*u*p,this._z=c*u*p+d*g*f,this._w=c*u*f-d*g*p;break;case"YXZ":this._x=d*u*f+c*g*p,this._y=c*g*f-d*u*p,this._z=c*u*p-d*g*f,this._w=c*u*f+d*g*p;break;case"ZXY":this._x=d*u*f-c*g*p,this._y=c*g*f+d*u*p,this._z=c*u*p+d*g*f,this._w=c*u*f-d*g*p;break;case"ZYX":this._x=d*u*f-c*g*p,this._y=c*g*f+d*u*p,this._z=c*u*p-d*g*f,this._w=c*u*f+d*g*p;break;case"YZX":this._x=d*u*f+c*g*p,this._y=c*g*f+d*u*p,this._z=c*u*p-d*g*f,this._w=c*u*f-d*g*p;break;case"XZY":this._x=d*u*f-c*g*p,this._y=c*g*f-d*u*p,this._z=c*u*p+d*g*f,this._w=c*u*f+d*g*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const r=t/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,r=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],u=t[6],f=t[10],d=r+o+f;if(d>0){const g=.5/Math.sqrt(d+1);this._w=.25/g,this._x=(u-l)*g,this._y=(s-c)*g,this._z=(a-i)*g}else if(r>o&&r>f){const g=2*Math.sqrt(1+r-o-f);this._w=(u-l)/g,this._x=.25*g,this._y=(i+a)/g,this._z=(s+c)/g}else if(o>f){const g=2*Math.sqrt(1+o-r-f);this._w=(s-c)/g,this._x=(i+a)/g,this._y=.25*g,this._z=(l+u)/g}else{const g=2*Math.sqrt(1+f-r-o);this._w=(a-i)/g,this._x=(s+c)/g,this._y=(l+u)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let r=e.dot(t)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Gi(this.dot(e),-1,1)))}rotateTowards(e,t){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,t/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const r=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,u=t._w;return this._x=r*u+a*o+i*c-s*l,this._y=i*u+a*l+s*o-r*c,this._z=s*u+a*c+r*l-i*o,this._w=a*u-r*o-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let o=a*e._w+r*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const g=1-t;return this._w=g*a+t*this._w,this._x=g*r+t*this._x,this._y=g*i+t*this._y,this._z=g*s+t*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,o),f=Math.sin((1-t)*u)/c,d=Math.sin(t*u)/c;return this._w=a*f+this._w*d,this._x=r*f+this._x*d,this._y=i*f+this._y*d,this._z=s*f+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,r){return this.copy(e).slerp(t,r)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ut{constructor(e=0,t=0,r=0){ut.prototype.isVector3=!0,this.x=e,this.y=t,this.z=r}set(e,t,r){return r===void 0&&(r=this.z),this.x=e,this.y=t,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(a$.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(a$.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*r+s[6]*i,this.y=s[1]*t+s[4]*r+s[7]*i,this.z=s[2]*t+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*i-o*r),u=2*(o*t-s*i),f=2*(s*r-a*t);return this.x=t+l*c+a*f-o*u,this.y=r+l*u+o*c-s*f,this.z=i+l*f+s*u-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*r+s[8]*i,this.y=s[1]*t+s[5]*r+s[9]*i,this.z=s[2]*t+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Gi(this.x,e.x,t.x),this.y=Gi(this.y,e.y,t.y),this.z=Gi(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Gi(this.x,e,t),this.y=Gi(this.y,e,t),this.z=Gi(this.z,e,t),this}clampLength(e,t){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Gi(r,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,r){return this.x=e.x+(t.x-e.x)*r,this.y=e.y+(t.y-e.y)*r,this.z=e.z+(t.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const r=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const r=e.dot(this)/t;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return B5.copy(this).projectOnVector(e),this.sub(B5)}reflect(e){return this.sub(B5.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const r=this.dot(e)/t;return Math.acos(Gi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return t*t+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,r){const i=Math.sin(t)*e;return this.x=i*Math.sin(r),this.y=Math.cos(t)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,r){return this.x=e*Math.sin(t),this.y=r,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=r,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,r=Math.sqrt(1-t*t);return this.x=r*Math.cos(e),this.y=t,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const B5=new ut,a$=new jp;class Qd{constructor(e=new ut(1/0,1/0,1/0),t=new ut(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t+=3)this.expandByPoint(s_.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,r=e.count;t<r;t++)this.expandByPoint(s_.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=s_.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,s_):s_.fromBufferAttribute(s,a),s_.applyMatrix4(e.matrixWorld),this.expandByPoint(s_);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),k3.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),k3.copy(r.boundingBox)),k3.applyMatrix4(e.matrixWorld),this.union(k3)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,s_),s_.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,r;return e.normal.x>0?(t=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),t<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(wR),O3.subVectors(this.max,wR),Sx.subVectors(e.a,wR),Ex.subVectors(e.b,wR),xx.subVectors(e.c,wR),Nb.subVectors(Ex,Sx),Pb.subVectors(xx,Ex),rS.subVectors(Sx,xx);let t=[0,-Nb.z,Nb.y,0,-Pb.z,Pb.y,0,-rS.z,rS.y,Nb.z,0,-Nb.x,Pb.z,0,-Pb.x,rS.z,0,-rS.x,-Nb.y,Nb.x,0,-Pb.y,Pb.x,0,-rS.y,rS.x,0];return!F5(t,Sx,Ex,xx,O3)||(t=[1,0,0,0,1,0,0,0,1],!F5(t,Sx,Ex,xx,O3))?!1:(I3.crossVectors(Nb,Pb),t=[I3.x,I3.y,I3.z],F5(t,Sx,Ex,xx,O3))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,s_).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(s_).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(cy[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),cy[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),cy[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),cy[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),cy[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),cy[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),cy[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),cy[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(cy),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const cy=[new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut],s_=new ut,k3=new Qd,Sx=new ut,Ex=new ut,xx=new ut,Nb=new ut,Pb=new ut,rS=new ut,wR=new ut,O3=new ut,I3=new ut,iS=new ut;function F5(n,e,t,r,i){for(let s=0,a=n.length-3;s<=a;s+=3){iS.fromArray(n,s);const o=i.x*Math.abs(iS.x)+i.y*Math.abs(iS.y)+i.z*Math.abs(iS.z),l=e.dot(iS),c=t.dot(iS),u=r.dot(iS);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const MEe=new Qd,RR=new ut,z5=new ut;class xd{constructor(e=new ut,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const r=this.center;t!==void 0?r.copy(t):MEe.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const r=this.center.distanceToSquared(e);return t.copy(e),r>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;RR.subVectors(e,this.center);const t=RR.lengthSq();if(t>this.radius*this.radius){const r=Math.sqrt(t),i=(r-this.radius)*.5;this.center.addScaledVector(RR,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(z5.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(RR.copy(e.center).add(z5)),this.expandByPoint(RR.copy(e.center).sub(z5))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const uy=new ut,j5=new ut,N3=new ut,Db=new ut,H5=new ut,P3=new ut,q5=new ut;class Nw{constructor(e=new ut,t=new ut(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,uy)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const r=t.dot(this.direction);return r<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=uy.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(uy.copy(this.origin).addScaledVector(this.direction,t),uy.distanceToSquared(e))}distanceSqToSegment(e,t,r,i){j5.copy(e).add(t).multiplyScalar(.5),N3.copy(t).sub(e).normalize(),Db.copy(this.origin).sub(j5);const s=e.distanceTo(t)*.5,a=-this.direction.dot(N3),o=Db.dot(this.direction),l=-Db.dot(N3),c=Db.lengthSq(),u=Math.abs(1-a*a);let f,d,g,p;if(u>0)if(f=a*l-o,d=a*o-l,p=s*u,f>=0)if(d>=-p)if(d<=p){const _=1/u;f*=_,d*=_,g=f*(f+a*d+2*o)+d*(a*f+d+2*l)+c}else d=s,f=Math.max(0,-(a*d+o)),g=-f*f+d*(d+2*l)+c;else d=-s,f=Math.max(0,-(a*d+o)),g=-f*f+d*(d+2*l)+c;else d<=-p?(f=Math.max(0,-(-a*s+o)),d=f>0?-s:Math.min(Math.max(-s,-l),s),g=-f*f+d*(d+2*l)+c):d<=p?(f=0,d=Math.min(Math.max(-s,-l),s),g=d*(d+2*l)+c):(f=Math.max(0,-(a*s+o)),d=f>0?s:Math.min(Math.max(-s,-l),s),g=-f*f+d*(d+2*l)+c);else d=a>0?-s:s,f=Math.max(0,-(a*d+o)),g=-f*f+d*(d+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(j5).addScaledVector(N3,d),g}intersectSphere(e,t){uy.subVectors(e.center,this.origin);const r=uy.dot(this.direction),i=uy.dot(uy)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/t;return r>=0?r:null}intersectPlane(e,t){const r=this.distanceToPlane(e);return r===null?null:this.at(r,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let r,i,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,f=1/this.direction.z,d=this.origin;return c>=0?(r=(e.min.x-d.x)*c,i=(e.max.x-d.x)*c):(r=(e.max.x-d.x)*c,i=(e.min.x-d.x)*c),u>=0?(s=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),f>=0?(o=(e.min.z-d.z)*f,l=(e.max.z-d.z)*f):(o=(e.max.z-d.z)*f,l=(e.min.z-d.z)*f),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,t)}intersectsBox(e){return this.intersectBox(e,uy)!==null}intersectTriangle(e,t,r,i,s){H5.subVectors(t,e),P3.subVectors(r,e),q5.crossVectors(H5,P3);let a=this.direction.dot(q5),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Db.subVectors(this.origin,e);const l=o*this.direction.dot(P3.crossVectors(Db,P3));if(l<0)return null;const c=o*this.direction.dot(H5.cross(Db));if(c<0||l+c>a)return null;const u=-o*Db.dot(q5);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Qr{constructor(e,t,r,i,s,a,o,l,c,u,f,d,g,p,_,y){Qr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,r,i,s,a,o,l,c,u,f,d,g,p,_,y)}set(e,t,r,i,s,a,o,l,c,u,f,d,g,p,_,y){const v=this.elements;return v[0]=e,v[4]=t,v[8]=r,v[12]=i,v[1]=s,v[5]=a,v[9]=o,v[13]=l,v[2]=c,v[6]=u,v[10]=f,v[14]=d,v[3]=g,v[7]=p,v[11]=_,v[15]=y,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Qr().fromArray(this.elements)}copy(e){const t=this.elements,r=e.elements;return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],this}copyPosition(e){const t=this.elements,r=e.elements;return t[12]=r[12],t[13]=r[13],t[14]=r[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,r){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,t,r){return this.set(e.x,t.x,r.x,0,e.y,t.y,r.y,0,e.z,t.z,r.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,r=e.elements,i=1/Tx.setFromMatrixColumn(e,0).length(),s=1/Tx.setFromMatrixColumn(e,1).length(),a=1/Tx.setFromMatrixColumn(e,2).length();return t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t[3]=0,t[4]=r[4]*s,t[5]=r[5]*s,t[6]=r[6]*s,t[7]=0,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),f=Math.sin(s);if(e.order==="XYZ"){const d=a*u,g=a*f,p=o*u,_=o*f;t[0]=l*u,t[4]=-l*f,t[8]=c,t[1]=g+p*c,t[5]=d-_*c,t[9]=-o*l,t[2]=_-d*c,t[6]=p+g*c,t[10]=a*l}else if(e.order==="YXZ"){const d=l*u,g=l*f,p=c*u,_=c*f;t[0]=d+_*o,t[4]=p*o-g,t[8]=a*c,t[1]=a*f,t[5]=a*u,t[9]=-o,t[2]=g*o-p,t[6]=_+d*o,t[10]=a*l}else if(e.order==="ZXY"){const d=l*u,g=l*f,p=c*u,_=c*f;t[0]=d-_*o,t[4]=-a*f,t[8]=p+g*o,t[1]=g+p*o,t[5]=a*u,t[9]=_-d*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const d=a*u,g=a*f,p=o*u,_=o*f;t[0]=l*u,t[4]=p*c-g,t[8]=d*c+_,t[1]=l*f,t[5]=_*c+d,t[9]=g*c-p,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const d=a*l,g=a*c,p=o*l,_=o*c;t[0]=l*u,t[4]=_-d*f,t[8]=p*f+g,t[1]=f,t[5]=a*u,t[9]=-o*u,t[2]=-c*u,t[6]=g*f+p,t[10]=d-_*f}else if(e.order==="XZY"){const d=a*l,g=a*c,p=o*l,_=o*c;t[0]=l*u,t[4]=-f,t[8]=c*u,t[1]=d*f+_,t[5]=a*u,t[9]=g*f-p,t[2]=p*f-g,t[6]=o*u,t[10]=_*f+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(kEe,e,OEe)}lookAt(e,t,r){const i=this.elements;return yg.subVectors(e,t),yg.lengthSq()===0&&(yg.z=1),yg.normalize(),Lb.crossVectors(r,yg),Lb.lengthSq()===0&&(Math.abs(r.z)===1?yg.x+=1e-4:yg.z+=1e-4,yg.normalize(),Lb.crossVectors(r,yg)),Lb.normalize(),D3.crossVectors(yg,Lb),i[0]=Lb.x,i[4]=D3.x,i[8]=yg.x,i[1]=Lb.y,i[5]=D3.y,i[9]=yg.y,i[2]=Lb.z,i[6]=D3.z,i[10]=yg.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const r=e.elements,i=t.elements,s=this.elements,a=r[0],o=r[4],l=r[8],c=r[12],u=r[1],f=r[5],d=r[9],g=r[13],p=r[2],_=r[6],y=r[10],v=r[14],x=r[3],E=r[7],M=r[11],O=r[15],N=i[0],I=i[4],D=i[8],V=i[12],G=i[1],Q=i[5],B=i[9],$=i[13],U=i[2],J=i[6],W=i[10],q=i[14],Y=i[3],ae=i[7],Z=i[11],K=i[15];return s[0]=a*N+o*G+l*U+c*Y,s[4]=a*I+o*Q+l*J+c*ae,s[8]=a*D+o*B+l*W+c*Z,s[12]=a*V+o*$+l*q+c*K,s[1]=u*N+f*G+d*U+g*Y,s[5]=u*I+f*Q+d*J+g*ae,s[9]=u*D+f*B+d*W+g*Z,s[13]=u*V+f*$+d*q+g*K,s[2]=p*N+_*G+y*U+v*Y,s[6]=p*I+_*Q+y*J+v*ae,s[10]=p*D+_*B+y*W+v*Z,s[14]=p*V+_*$+y*q+v*K,s[3]=x*N+E*G+M*U+O*Y,s[7]=x*I+E*Q+M*J+O*ae,s[11]=x*D+E*B+M*W+O*Z,s[15]=x*V+E*$+M*q+O*K,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],u=e[2],f=e[6],d=e[10],g=e[14],p=e[3],_=e[7],y=e[11],v=e[15];return p*(+s*l*f-i*c*f-s*o*d+r*c*d+i*o*g-r*l*g)+_*(+t*l*g-t*c*d+s*a*d-i*a*g+i*c*u-s*l*u)+y*(+t*c*f-t*o*g-s*a*f+r*a*g+s*o*u-r*c*u)+v*(-i*o*u-t*l*f+t*o*d+i*a*f-r*a*d+r*l*u)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=r),this}invert(){const e=this.elements,t=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],f=e[9],d=e[10],g=e[11],p=e[12],_=e[13],y=e[14],v=e[15],x=f*y*c-_*d*c+_*l*g-o*y*g-f*l*v+o*d*v,E=p*d*c-u*y*c-p*l*g+a*y*g+u*l*v-a*d*v,M=u*_*c-p*f*c+p*o*g-a*_*g-u*o*v+a*f*v,O=p*f*l-u*_*l-p*o*d+a*_*d+u*o*y-a*f*y,N=t*x+r*E+i*M+s*O;if(N===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const I=1/N;return e[0]=x*I,e[1]=(_*d*s-f*y*s-_*i*g+r*y*g+f*i*v-r*d*v)*I,e[2]=(o*y*s-_*l*s+_*i*c-r*y*c-o*i*v+r*l*v)*I,e[3]=(f*l*s-o*d*s-f*i*c+r*d*c+o*i*g-r*l*g)*I,e[4]=E*I,e[5]=(u*y*s-p*d*s+p*i*g-t*y*g-u*i*v+t*d*v)*I,e[6]=(p*l*s-a*y*s-p*i*c+t*y*c+a*i*v-t*l*v)*I,e[7]=(a*d*s-u*l*s+u*i*c-t*d*c-a*i*g+t*l*g)*I,e[8]=M*I,e[9]=(p*f*s-u*_*s-p*r*g+t*_*g+u*r*v-t*f*v)*I,e[10]=(a*_*s-p*o*s+p*r*c-t*_*c-a*r*v+t*o*v)*I,e[11]=(u*o*s-a*f*s-u*r*c+t*f*c+a*r*g-t*o*g)*I,e[12]=O*I,e[13]=(u*_*i-p*f*i+p*r*d-t*_*d-u*r*y+t*f*y)*I,e[14]=(p*o*i-a*_*i-p*r*l+t*_*l+a*r*y-t*o*y)*I,e[15]=(a*f*i-u*o*i+u*r*l-t*f*l-a*r*d+t*o*d)*I,this}scale(e){const t=this.elements,r=e.x,i=e.y,s=e.z;return t[0]*=r,t[4]*=i,t[8]*=s,t[1]*=r,t[5]*=i,t[9]*=s,t[2]*=r,t[6]*=i,t[10]*=s,t[3]*=r,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,r,i))}makeTranslation(e,t,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,r,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,t,-r,0,0,r,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,0,r,0,0,1,0,0,-r,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),r=Math.sin(e);return this.set(t,-r,0,0,r,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const r=Math.cos(t),i=Math.sin(t),s=1-r,a=e.x,o=e.y,l=e.z,c=s*a,u=s*o;return this.set(c*a+r,c*o-i*l,c*l+i*o,0,c*o+i*l,u*o+r,u*l-i*a,0,c*l-i*o,u*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,t,r){return this.set(e,0,0,0,0,t,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,t,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,r){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,u=a+a,f=o+o,d=s*c,g=s*u,p=s*f,_=a*u,y=a*f,v=o*f,x=l*c,E=l*u,M=l*f,O=r.x,N=r.y,I=r.z;return i[0]=(1-(_+v))*O,i[1]=(g+M)*O,i[2]=(p-E)*O,i[3]=0,i[4]=(g-M)*N,i[5]=(1-(d+v))*N,i[6]=(y+x)*N,i[7]=0,i[8]=(p+E)*I,i[9]=(y-x)*I,i[10]=(1-(d+_))*I,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,r){const i=this.elements;let s=Tx.set(i[0],i[1],i[2]).length();const a=Tx.set(i[4],i[5],i[6]).length(),o=Tx.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],a_.copy(this);const c=1/s,u=1/a,f=1/o;return a_.elements[0]*=c,a_.elements[1]*=c,a_.elements[2]*=c,a_.elements[4]*=u,a_.elements[5]*=u,a_.elements[6]*=u,a_.elements[8]*=f,a_.elements[9]*=f,a_.elements[10]*=f,t.setFromRotationMatrix(a_),r.x=s,r.y=a,r.z=o,this}makePerspective(e,t,r,i,s,a,o=k0){const l=this.elements,c=2*s/(t-e),u=2*s/(r-i),f=(t+e)/(t-e),d=(r+i)/(r-i);let g,p;if(o===k0)g=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===F2)g=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=u,l[9]=d,l[13]=0,l[2]=0,l[6]=0,l[10]=g,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,r,i,s,a,o=k0){const l=this.elements,c=1/(t-e),u=1/(r-i),f=1/(a-s),d=(t+e)*c,g=(r+i)*u;let p,_;if(o===k0)p=(a+s)*f,_=-2*f;else if(o===F2)p=s*f,_=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-d,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-g,l[2]=0,l[6]=0,l[10]=_,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,r=e.elements;for(let i=0;i<16;i++)if(t[i]!==r[i])return!1;return!0}fromArray(e,t=0){for(let r=0;r<16;r++)this.elements[r]=e[r+t];return this}toArray(e=[],t=0){const r=this.elements;return e[t]=r[0],e[t+1]=r[1],e[t+2]=r[2],e[t+3]=r[3],e[t+4]=r[4],e[t+5]=r[5],e[t+6]=r[6],e[t+7]=r[7],e[t+8]=r[8],e[t+9]=r[9],e[t+10]=r[10],e[t+11]=r[11],e[t+12]=r[12],e[t+13]=r[13],e[t+14]=r[14],e[t+15]=r[15],e}}const Tx=new ut,a_=new Qr,kEe=new ut(0,0,0),OEe=new ut(1,1,1),Lb=new ut,D3=new ut,yg=new ut,o$=new Qr,l$=new jp;class Um{constructor(e=0,t=0,r=0,i=Um.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,r,i=this._order){return this._x=e,this._y=t,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],c=i[5],u=i[9],f=i[2],d=i[6],g=i[10];switch(t){case"XYZ":this._y=Math.asin(Gi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,g),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Gi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,g),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-f,s),this._z=0);break;case"ZXY":this._x=Math.asin(Gi(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-f,g),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Gi(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(d,g),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Gi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-f,s)):(this._x=0,this._y=Math.atan2(o,g));break;case"XZY":this._z=Math.asin(-Gi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,r){return o$.makeRotationFromQuaternion(e),this.setFromRotationMatrix(o$,t,r)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return l$.setFromEuler(this),this.setFromQuaternion(l$,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Um.DEFAULT_ORDER="XYZ";class HT{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let IEe=0;const c$=new ut,wx=new jp,fy=new Qr,L3=new ut,AR=new ut,NEe=new ut,PEe=new jp,u$=new ut(1,0,0),f$=new ut(0,1,0),h$=new ut(0,0,1),d$={type:"added"},DEe={type:"removed"},Rx={type:"childadded",child:null},V5={type:"childremoved",child:null};class za extends Vg{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:IEe++}),this.uuid=Dg(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=za.DEFAULT_UP.clone();const e=new ut,t=new Um,r=new jp,i=new ut(1,1,1);function s(){r.setFromEuler(t,!1)}function a(){t.setFromQuaternion(r,void 0,!1)}t._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Qr},normalMatrix:{value:new Ji}}),this.matrix=new Qr,this.matrixWorld=new Qr,this.matrixAutoUpdate=za.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=za.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new HT,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return wx.setFromAxisAngle(e,t),this.quaternion.multiply(wx),this}rotateOnWorldAxis(e,t){return wx.setFromAxisAngle(e,t),this.quaternion.premultiply(wx),this}rotateX(e){return this.rotateOnAxis(u$,e)}rotateY(e){return this.rotateOnAxis(f$,e)}rotateZ(e){return this.rotateOnAxis(h$,e)}translateOnAxis(e,t){return c$.copy(e).applyQuaternion(this.quaternion),this.position.add(c$.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(u$,e)}translateY(e){return this.translateOnAxis(f$,e)}translateZ(e){return this.translateOnAxis(h$,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(fy.copy(this.matrixWorld).invert())}lookAt(e,t,r){e.isVector3?L3.copy(e):L3.set(e,t,r);const i=this.parent;this.updateWorldMatrix(!0,!1),AR.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?fy.lookAt(AR,L3,this.up):fy.lookAt(L3,AR,this.up),this.quaternion.setFromRotationMatrix(fy),i&&(fy.extractRotation(i.matrixWorld),wx.setFromRotationMatrix(fy),this.quaternion.premultiply(wx.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(d$),Rx.child=e,this.dispatchEvent(Rx),Rx.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DEe),V5.child=e,this.dispatchEvent(V5),V5.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),fy.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),fy.multiply(e.parent.matrixWorld)),e.applyMatrix4(fy),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(d$),Rx.child=e,this.dispatchEvent(Rx),Rx.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,r=[]){this[e]===t&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(AR,e,NEe),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(AR,PEe,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let r=0,i=t.length;r<i;r++)t[r].updateMatrixWorld(e)}updateWorldMatrix(e,t){const r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",r={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?{min:o.boundingBox.min.toArray(),max:o.boundingBox.max.toArray()}:void 0,boundingSphere:o.boundingSphere?{radius:o.boundingSphere.radius,center:o.boundingSphere.center.toArray()}:void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere={center:this.boundingSphere.center.toArray(),radius:this.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:this.boundingBox.min.toArray(),max:this.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const f=l[c];s(e.shapes,f)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),u=a(e.images),f=a(e.shapes),d=a(e.skeletons),g=a(e.animations),p=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),f.length>0&&(r.shapes=f),d.length>0&&(r.skeletons=d),g.length>0&&(r.animations=g),p.length>0&&(r.nodes=p)}return r.object=i,r;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}za.DEFAULT_UP=new ut(0,1,0);za.DEFAULT_MATRIX_AUTO_UPDATE=!0;za.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const o_=new ut,hy=new ut,G5=new ut,dy=new ut,Ax=new ut,Cx=new ut,p$=new ut,$5=new ut,W5=new ut,Y5=new ut,X5=new xa,K5=new xa,Z5=new xa;class Rm{constructor(e=new ut,t=new ut,r=new ut){this.a=e,this.b=t,this.c=r}static getNormal(e,t,r,i){i.subVectors(r,t),o_.subVectors(e,t),i.cross(o_);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,r,i,s){o_.subVectors(i,t),hy.subVectors(r,t),G5.subVectors(e,t);const a=o_.dot(o_),o=o_.dot(hy),l=o_.dot(G5),c=hy.dot(hy),u=hy.dot(G5),f=a*c-o*o;if(f===0)return s.set(0,0,0),null;const d=1/f,g=(c*l-o*u)*d,p=(a*u-o*l)*d;return s.set(1-g-p,p,g)}static containsPoint(e,t,r,i){return this.getBarycoord(e,t,r,i,dy)===null?!1:dy.x>=0&&dy.y>=0&&dy.x+dy.y<=1}static getInterpolation(e,t,r,i,s,a,o,l){return this.getBarycoord(e,t,r,i,dy)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,dy.x),l.addScaledVector(a,dy.y),l.addScaledVector(o,dy.z),l)}static getInterpolatedAttribute(e,t,r,i,s,a){return X5.setScalar(0),K5.setScalar(0),Z5.setScalar(0),X5.fromBufferAttribute(e,t),K5.fromBufferAttribute(e,r),Z5.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector(X5,s.x),a.addScaledVector(K5,s.y),a.addScaledVector(Z5,s.z),a}static isFrontFacing(e,t,r,i){return o_.subVectors(r,t),hy.subVectors(e,t),o_.cross(hy).dot(i)<0}set(e,t,r){return this.a.copy(e),this.b.copy(t),this.c.copy(r),this}setFromPointsAndIndices(e,t,r,i){return this.a.copy(e[t]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,r,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return o_.subVectors(this.c,this.b),hy.subVectors(this.a,this.b),o_.cross(hy).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Rm.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Rm.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,r,i,s){return Rm.getInterpolation(e,this.a,this.b,this.c,t,r,i,s)}containsPoint(e){return Rm.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Rm.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const r=this.a,i=this.b,s=this.c;let a,o;Ax.subVectors(i,r),Cx.subVectors(s,r),$5.subVectors(e,r);const l=Ax.dot($5),c=Cx.dot($5);if(l<=0&&c<=0)return t.copy(r);W5.subVectors(e,i);const u=Ax.dot(W5),f=Cx.dot(W5);if(u>=0&&f<=u)return t.copy(i);const d=l*f-u*c;if(d<=0&&l>=0&&u<=0)return a=l/(l-u),t.copy(r).addScaledVector(Ax,a);Y5.subVectors(e,s);const g=Ax.dot(Y5),p=Cx.dot(Y5);if(p>=0&&g<=p)return t.copy(s);const _=g*c-l*p;if(_<=0&&c>=0&&p<=0)return o=c/(c-p),t.copy(r).addScaledVector(Cx,o);const y=u*p-g*f;if(y<=0&&f-u>=0&&g-p>=0)return p$.subVectors(s,i),o=(f-u)/(f-u+(g-p)),t.copy(i).addScaledVector(p$,o);const v=1/(y+_+d);return a=_*v,o=d*v,t.copy(r).addScaledVector(Ax,a).addScaledVector(Cx,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const mae={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ub={h:0,s:0,l:0},U3={h:0,s:0,l:0};function Q5(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class cr{constructor(e,t,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,r)}set(e,t,r){if(t===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ta){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Sa.toWorkingColorSpace(this,t),this}setRGB(e,t,r,i=Sa.workingColorSpace){return this.r=e,this.g=t,this.b=r,Sa.toWorkingColorSpace(this,i),this}setHSL(e,t,r,i=Sa.workingColorSpace){if(e=xz(e,1),t=Gi(t,0,1),r=Gi(r,0,1),t===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+t):r+t-r*t,a=2*r-s;this.r=Q5(a,s,e+1/3),this.g=Q5(a,s,e),this.b=Q5(a,s,e-1/3)}return Sa.toWorkingColorSpace(this,i),this}setStyle(e,t=ta){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ta){const r=mae[e.toLowerCase()];return r!==void 0?this.setHex(r,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Yy(e.r),this.g=Yy(e.g),this.b=Yy(e.b),this}copyLinearToSRGB(e){return this.r=TT(e.r),this.g=TT(e.g),this.b=TT(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ta){return Sa.fromWorkingColorSpace(Vd.copy(this),e),Math.round(Gi(Vd.r*255,0,255))*65536+Math.round(Gi(Vd.g*255,0,255))*256+Math.round(Gi(Vd.b*255,0,255))}getHexString(e=ta){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Sa.workingColorSpace){Sa.fromWorkingColorSpace(Vd.copy(this),t);const r=Vd.r,i=Vd.g,s=Vd.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const f=a-o;switch(c=u<=.5?f/(a+o):f/(2-a-o),a){case r:l=(i-s)/f+(i<s?6:0);break;case i:l=(s-r)/f+2;break;case s:l=(r-i)/f+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,t=Sa.workingColorSpace){return Sa.fromWorkingColorSpace(Vd.copy(this),t),e.r=Vd.r,e.g=Vd.g,e.b=Vd.b,e}getStyle(e=ta){Sa.fromWorkingColorSpace(Vd.copy(this),e);const t=Vd.r,r=Vd.g,i=Vd.b;return e!==ta?`color(${e} ${t.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,t,r){return this.getHSL(Ub),this.setHSL(Ub.h+e,Ub.s+t,Ub.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,r){return this.r=e.r+(t.r-e.r)*r,this.g=e.g+(t.g-e.g)*r,this.b=e.b+(t.b-e.b)*r,this}lerpHSL(e,t){this.getHSL(Ub),e.getHSL(U3);const r=m2(Ub.h,U3.h,t),i=m2(Ub.s,U3.s,t),s=m2(Ub.l,U3.l,t);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*r+s[6]*i,this.g=s[1]*t+s[4]*r+s[7]*i,this.b=s[2]*t+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Vd=new cr;cr.NAMES=mae;let LEe=0;class nh extends Vg{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:LEe++}),this.uuid=Dg(),this.name="",this.type="Material",this.blending=nE,this.side=Lv,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xP,this.blendDst=TP,this.blendEquation=i1,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new cr(0,0,0),this.blendAlpha=0,this.depthFunc=mE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=GF,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=OS,this.stencilZFail=OS,this.stencilZPass=OS,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const r=e[t];if(r===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[t]=r}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==nE&&(r.blending=this.blending),this.side!==Lv&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==xP&&(r.blendSrc=this.blendSrc),this.blendDst!==TP&&(r.blendDst=this.blendDst),this.blendEquation!==i1&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==mE&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==GF&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==OS&&(r.stencilFail=this.stencilFail),this.stencilZFail!==OS&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==OS&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let r=null;if(t!==null){const i=t.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=t[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class F1 extends nh{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Um,this.combine=Wk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ly=UEe();function UEe(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;(c&8388608)===0;)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function vm(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=Gi(n,-65504,65504),Ly.floatView[0]=n;const e=Ly.uint32View[0],t=e>>23&511;return Ly.baseTable[t]+((e&8388607)>>Ly.shiftTable[t])}function $M(n){const e=n>>10;return Ly.uint32View[0]=Ly.mantissaTable[Ly.offsetTable[e]+(n&1023)]+Ly.exponentTable[e],Ly.floatView[0]}class BEe{static toHalfFloat(e){return vm(e)}static fromHalfFloat(e){return $M(e)}}const uf=new ut,B3=new an;let FEe=0;class Ps{constructor(e,t,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:FEe++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=r,this.usage=B2,this.updateRanges=[],this.gpuType=Dp,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,r){e*=this.itemSize,r*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,r=this.count;t<r;t++)B3.fromBufferAttribute(this,t),B3.applyMatrix3(e),this.setXY(t,B3.x,B3.y);else if(this.itemSize===3)for(let t=0,r=this.count;t<r;t++)uf.fromBufferAttribute(this,t),uf.applyMatrix3(e),this.setXYZ(t,uf.x,uf.y,uf.z);return this}applyMatrix4(e){for(let t=0,r=this.count;t<r;t++)uf.fromBufferAttribute(this,t),uf.applyMatrix4(e),this.setXYZ(t,uf.x,uf.y,uf.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)uf.fromBufferAttribute(this,t),uf.applyNormalMatrix(e),this.setXYZ(t,uf.x,uf.y,uf.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)uf.fromBufferAttribute(this,t),uf.transformDirection(e),this.setXYZ(t,uf.x,uf.y,uf.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let r=this.array[e*this.itemSize+t];return this.normalized&&(r=Ip(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=is(r,this.array)),this.array[e*this.itemSize+t]=r,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ip(t,this.array)),t}setX(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ip(t,this.array)),t}setY(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ip(t,this.array)),t}setZ(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ip(t,this.array)),t}setW(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array)),this.array[e+0]=t,this.array[e+1]=r,this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array),s=is(s,this.array)),this.array[e+0]=t,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==B2&&(e.usage=this.usage),e}}class zEe extends Ps{constructor(e,t,r){super(new Int8Array(e),t,r)}}class jEe extends Ps{constructor(e,t,r){super(new Uint8Array(e),t,r)}}class HEe extends Ps{constructor(e,t,r){super(new Uint8ClampedArray(e),t,r)}}class qEe extends Ps{constructor(e,t,r){super(new Int16Array(e),t,r)}}class Tz extends Ps{constructor(e,t,r){super(new Uint16Array(e),t,r)}}class VEe extends Ps{constructor(e,t,r){super(new Int32Array(e),t,r)}}class wz extends Ps{constructor(e,t,r){super(new Uint32Array(e),t,r)}}class GEe extends Ps{constructor(e,t,r){super(new Uint16Array(e),t,r),this.isFloat16BufferAttribute=!0}getX(e){let t=$M(this.array[e*this.itemSize]);return this.normalized&&(t=Ip(t,this.array)),t}setX(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize]=vm(t),this}getY(e){let t=$M(this.array[e*this.itemSize+1]);return this.normalized&&(t=Ip(t,this.array)),t}setY(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+1]=vm(t),this}getZ(e){let t=$M(this.array[e*this.itemSize+2]);return this.normalized&&(t=Ip(t,this.array)),t}setZ(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+2]=vm(t),this}getW(e){let t=$M(this.array[e*this.itemSize+3]);return this.normalized&&(t=Ip(t,this.array)),t}setW(e,t){return this.normalized&&(t=is(t,this.array)),this.array[e*this.itemSize+3]=vm(t),this}setXY(e,t,r){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this}setXYZ(e,t,r,i){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this.array[e+2]=vm(i),this}setXYZW(e,t,r,i,s){return e*=this.itemSize,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array),s=is(s,this.array)),this.array[e+0]=vm(t),this.array[e+1]=vm(r),this.array[e+2]=vm(i),this.array[e+3]=vm(s),this}}class Or extends Ps{constructor(e,t,r){super(new Float32Array(e),t,r)}}let $Ee=0;const u0=new Qr,J5=new za,Mx=new ut,bg=new Qd,CR=new Qd,xh=new ut;class ts extends Vg{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:$Ee++}),this.uuid=Dg(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(hae(e)?wz:Tz)(e,1):this.index=e,this}setIndirect(e){return this.indirect=e,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,r=0){this.groups.push({start:e,count:t,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Ji().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return u0.makeRotationFromQuaternion(e),this.applyMatrix4(u0),this}rotateX(e){return u0.makeRotationX(e),this.applyMatrix4(u0),this}rotateY(e){return u0.makeRotationY(e),this.applyMatrix4(u0),this}rotateZ(e){return u0.makeRotationZ(e),this.applyMatrix4(u0),this}translate(e,t,r){return u0.makeTranslation(e,t,r),this.applyMatrix4(u0),this}scale(e,t,r){return u0.makeScale(e,t,r),this.applyMatrix4(u0),this}lookAt(e){return J5.lookAt(e),J5.updateMatrix(),this.applyMatrix4(J5.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Mx).negate(),this.translate(Mx.x,Mx.y,Mx.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const r=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];r.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Or(r,3))}else{const r=Math.min(e.length,t.count);for(let i=0;i<r;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Qd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ut(-1/0,-1/0,-1/0),new ut(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let r=0,i=t.length;r<i;r++){const s=t[r];bg.setFromBufferAttribute(s),this.morphTargetsRelative?(xh.addVectors(this.boundingBox.min,bg.min),this.boundingBox.expandByPoint(xh),xh.addVectors(this.boundingBox.max,bg.max),this.boundingBox.expandByPoint(xh)):(this.boundingBox.expandByPoint(bg.min),this.boundingBox.expandByPoint(bg.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xd);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ut,1/0);return}if(e){const r=this.boundingSphere.center;if(bg.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];CR.setFromBufferAttribute(o),this.morphTargetsRelative?(xh.addVectors(bg.min,CR.min),bg.expandByPoint(xh),xh.addVectors(bg.max,CR.max),bg.expandByPoint(xh)):(bg.expandByPoint(CR.min),bg.expandByPoint(CR.max))}bg.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)xh.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(xh));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)xh.fromBufferAttribute(o,c),l&&(Mx.fromBufferAttribute(e,c),xh.add(Mx)),i=Math.max(i,r.distanceToSquared(xh))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ps(new Float32Array(4*r.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let D=0;D<r.count;D++)o[D]=new ut,l[D]=new ut;const c=new ut,u=new ut,f=new ut,d=new an,g=new an,p=new an,_=new ut,y=new ut;function v(D,V,G){c.fromBufferAttribute(r,D),u.fromBufferAttribute(r,V),f.fromBufferAttribute(r,G),d.fromBufferAttribute(s,D),g.fromBufferAttribute(s,V),p.fromBufferAttribute(s,G),u.sub(c),f.sub(c),g.sub(d),p.sub(d);const Q=1/(g.x*p.y-p.x*g.y);isFinite(Q)&&(_.copy(u).multiplyScalar(p.y).addScaledVector(f,-g.y).multiplyScalar(Q),y.copy(f).multiplyScalar(g.x).addScaledVector(u,-p.x).multiplyScalar(Q),o[D].add(_),o[V].add(_),o[G].add(_),l[D].add(y),l[V].add(y),l[G].add(y))}let x=this.groups;x.length===0&&(x=[{start:0,count:e.count}]);for(let D=0,V=x.length;D<V;++D){const G=x[D],Q=G.start,B=G.count;for(let $=Q,U=Q+B;$<U;$+=3)v(e.getX($+0),e.getX($+1),e.getX($+2))}const E=new ut,M=new ut,O=new ut,N=new ut;function I(D){O.fromBufferAttribute(i,D),N.copy(O);const V=o[D];E.copy(V),E.sub(O.multiplyScalar(O.dot(V))).normalize(),M.crossVectors(N,V);const Q=M.dot(l[D])<0?-1:1;a.setXYZW(D,E.x,E.y,E.z,Q)}for(let D=0,V=x.length;D<V;++D){const G=x[D],Q=G.start,B=G.count;for(let $=Q,U=Q+B;$<U;$+=3)I(e.getX($+0)),I(e.getX($+1)),I(e.getX($+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ps(new Float32Array(t.count*3),3),this.setAttribute("normal",r);else for(let d=0,g=r.count;d<g;d++)r.setXYZ(d,0,0,0);const i=new ut,s=new ut,a=new ut,o=new ut,l=new ut,c=new ut,u=new ut,f=new ut;if(e)for(let d=0,g=e.count;d<g;d+=3){const p=e.getX(d+0),_=e.getX(d+1),y=e.getX(d+2);i.fromBufferAttribute(t,p),s.fromBufferAttribute(t,_),a.fromBufferAttribute(t,y),u.subVectors(a,s),f.subVectors(i,s),u.cross(f),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,_),c.fromBufferAttribute(r,y),o.add(u),l.add(u),c.add(u),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(_,l.x,l.y,l.z),r.setXYZ(y,c.x,c.y,c.z)}else for(let d=0,g=t.count;d<g;d+=3)i.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),u.subVectors(a,s),f.subVectors(i,s),u.cross(f),r.setXYZ(d+0,u.x,u.y,u.z),r.setXYZ(d+1,u.x,u.y,u.z),r.setXYZ(d+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,r=e.count;t<r;t++)xh.fromBufferAttribute(e,t),xh.normalize(),e.setXYZ(t,xh.x,xh.y,xh.z)}toNonIndexed(){function e(o,l){const c=o.array,u=o.itemSize,f=o.normalized,d=new c.constructor(l.length*u);let g=0,p=0;for(let _=0,y=l.length;_<y;_++){o.isInterleavedBufferAttribute?g=l[_]*o.data.stride+o.offset:g=l[_]*u;for(let v=0;v<u;v++)d[p++]=c[g++]}return new Ps(d,u,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new ts,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],c=e(l,r);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,f=c.length;u<f;u++){const d=c[u],g=e(d,r);l.push(g)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let f=0,d=c.length;f<d;f++){const g=c[f];u.push(g.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone());const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(t))}const s=e.morphAttributes;for(const c in s){const u=[],f=s[c];for(let d=0,g=f.length;d<g;d++)u.push(f[d].clone(t));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,u=a.length;c<u;c++){const f=a[c];this.addGroup(f.start,f.count,f.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const m$=new Qr,sS=new Nw,F3=new xd,g$=new ut,z3=new ut,j3=new ut,H3=new ut,e6=new ut,q3=new ut,_$=new ut,V3=new ut;class vu extends za{constructor(e=new ts,t=new F1){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){q3.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],f=s[l];u!==0&&(e6.fromBufferAttribute(f,e),a?q3.addScaledVector(e6,u):q3.addScaledVector(e6.sub(t),u))}t.add(q3)}return t}raycast(e,t){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),F3.copy(r.boundingSphere),F3.applyMatrix4(s),sS.copy(e.ray).recast(e.near),!(F3.containsPoint(sS.origin)===!1&&(sS.intersectSphere(F3,g$)===null||sS.origin.distanceToSquared(g$)>(e.far-e.near)**2))&&(m$.copy(s).invert(),sS.copy(e.ray).applyMatrix4(m$),!(r.boundingBox!==null&&sS.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,t,sS)))}_computeIntersections(e,t,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,f=s.attributes.normal,d=s.groups,g=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,_=d.length;p<_;p++){const y=d[p],v=a[y.materialIndex],x=Math.max(y.start,g.start),E=Math.min(o.count,Math.min(y.start+y.count,g.start+g.count));for(let M=x,O=E;M<O;M+=3){const N=o.getX(M),I=o.getX(M+1),D=o.getX(M+2);i=G3(this,v,e,r,c,u,f,N,I,D),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,g.start),_=Math.min(o.count,g.start+g.count);for(let y=p,v=_;y<v;y+=3){const x=o.getX(y),E=o.getX(y+1),M=o.getX(y+2);i=G3(this,a,e,r,c,u,f,x,E,M),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let p=0,_=d.length;p<_;p++){const y=d[p],v=a[y.materialIndex],x=Math.max(y.start,g.start),E=Math.min(l.count,Math.min(y.start+y.count,g.start+g.count));for(let M=x,O=E;M<O;M+=3){const N=M,I=M+1,D=M+2;i=G3(this,v,e,r,c,u,f,N,I,D),i&&(i.faceIndex=Math.floor(M/3),i.face.materialIndex=y.materialIndex,t.push(i))}}else{const p=Math.max(0,g.start),_=Math.min(l.count,g.start+g.count);for(let y=p,v=_;y<v;y+=3){const x=y,E=y+1,M=y+2;i=G3(this,a,e,r,c,u,f,x,E,M),i&&(i.faceIndex=Math.floor(y/3),t.push(i))}}}}function WEe(n,e,t,r,i,s,a,o){let l;if(e.side===Yf?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===Lv,o),l===null)return null;V3.copy(o),V3.applyMatrix4(n.matrixWorld);const c=t.ray.origin.distanceTo(V3);return c<t.near||c>t.far?null:{distance:c,point:V3.clone(),object:n}}function G3(n,e,t,r,i,s,a,o,l,c){n.getVertexPosition(o,z3),n.getVertexPosition(l,j3),n.getVertexPosition(c,H3);const u=WEe(n,e,t,r,z3,j3,H3,_$);if(u){const f=new ut;Rm.getBarycoord(_$,z3,j3,H3,f),i&&(u.uv=Rm.getInterpolatedAttribute(i,o,l,c,f,new an)),s&&(u.uv1=Rm.getInterpolatedAttribute(s,o,l,c,f,new an)),a&&(u.normal=Rm.getInterpolatedAttribute(a,o,l,c,f,new ut),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const d={a:o,b:l,c,normal:new ut,materialIndex:0};Rm.getNormal(z3,j3,H3,d.normal),u.face=d,u.barycoord=f}return u}class $E extends ts{constructor(e=1,t=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],f=[];let d=0,g=0;p("z","y","x",-1,-1,r,t,e,a,s,0),p("z","y","x",1,-1,r,t,-e,a,s,1),p("x","z","y",1,1,e,r,t,i,a,2),p("x","z","y",1,-1,e,r,-t,i,a,3),p("x","y","z",1,-1,e,t,r,i,s,4),p("x","y","z",-1,-1,e,t,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Or(c,3)),this.setAttribute("normal",new Or(u,3)),this.setAttribute("uv",new Or(f,2));function p(_,y,v,x,E,M,O,N,I,D,V){const G=M/I,Q=O/D,B=M/2,$=O/2,U=N/2,J=I+1,W=D+1;let q=0,Y=0;const ae=new ut;for(let Z=0;Z<W;Z++){const K=Z*Q-$;for(let ne=0;ne<J;ne++){const le=ne*G-B;ae[_]=le*x,ae[y]=K*E,ae[v]=U,c.push(ae.x,ae.y,ae.z),ae[_]=0,ae[y]=0,ae[v]=N>0?1:-1,u.push(ae.x,ae.y,ae.z),f.push(ne/I),f.push(1-Z/D),q+=1}}for(let Z=0;Z<D;Z++)for(let K=0;K<I;K++){const ne=d+K+J*Z,le=d+K+J*(Z+1),ce=d+(K+1)+J*(Z+1),de=d+(K+1)+J*Z;l.push(ne,le,de),l.push(le,ce,de),Y+=6}o.addGroup(g,Y,V),g+=Y,d+=q}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $E(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function qT(n){const e={};for(const t in n){e[t]={};for(const r in n[t]){const i=n[t][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][r]=null):e[t][r]=i.clone():Array.isArray(i)?e[t][r]=i.slice():e[t][r]=i}}return e}function Rp(n){const e={};for(let t=0;t<n.length;t++){const r=qT(n[t]);for(const i in r)e[i]=r[i]}return e}function YEe(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function gae(n){const e=n.getRenderTarget();return e===null?n.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Sa.workingColorSpace}const _ae={clone:qT,merge:Rp};var XEe=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,KEe=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class jl extends nh{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=XEe,this.fragmentShader=KEe,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=qT(e.uniforms),this.uniformsGroups=YEe(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(t.extensions=r),t}}class Zk extends za{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Qr,this.projectionMatrix=new Qr,this.projectionMatrixInverse=new Qr,this.coordinateSystem=k0}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Bb=new ut,v$=new an,y$=new an;class vf extends Zk{constructor(e=50,t=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=jT*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(rE*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jT*2*Math.atan(Math.tan(rE*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,r){Bb.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Bb.x,Bb.y).multiplyScalar(-e/Bb.z),Bb.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(Bb.x,Bb.y).multiplyScalar(-e/Bb.z)}getViewSize(e,t){return this.getViewBounds(e,v$,y$),t.subVectors(y$,v$)}setViewOffset(e,t,r,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(rE*.5*this.fov)/this.zoom,r=2*t,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*r/c,i*=a.width/l,r*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const kx=-90,Ox=1;class vae extends za{constructor(e,t,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new vf(kx,Ox,e,t);i.layers=this.layers,this.add(i);const s=new vf(kx,Ox,e,t);s.layers=this.layers,this.add(s);const a=new vf(kx,Ox,e,t);a.layers=this.layers,this.add(a);const o=new vf(kx,Ox,e,t);o.layers=this.layers,this.add(o);const l=new vf(kx,Ox,e,t);l.layers=this.layers,this.add(l);const c=new vf(kx,Ox,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[r,i,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===k0)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===F2)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,u]=this.children,f=e.getRenderTarget(),d=e.getActiveCubeFace(),g=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const _=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(t,s),e.setRenderTarget(r,1,i),e.render(t,a),e.setRenderTarget(r,2,i),e.render(t,o),e.setRenderTarget(r,3,i),e.render(t,l),e.setRenderTarget(r,4,i),e.render(t,c),r.texture.generateMipmaps=_,e.setRenderTarget(r,5,i),e.render(t,u),e.setRenderTarget(f,d,g),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class Qk extends xc{constructor(e=[],t=rb,r,i,s,a,o,l,c,u){super(e,t,r,i,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class yae extends Sf{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];this.texture=new Qk(i,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:nc}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new $E(5,5,5),s=new jl({name:"CubemapFromEquirect",uniforms:qT(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Yf,blending:Nh});s.uniforms.tEquirect.value=t;const a=new vu(i,s),o=t.minFilter;return t.minFilter===Tv&&(t.minFilter=nc),new vae(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,r=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,r,i);e.setRenderTarget(s)}}class YS extends za{constructor(){super(),this.isGroup=!0,this.type="Group"}}const ZEe={type:"move"};class MN{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new YS,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new YS,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ut,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ut),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new YS,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ut,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ut),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const r of e.hand.values())this._getHandJoint(t,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const _ of e.hand.values()){const y=t.getJointPose(_,r),v=this._getHandJoint(c,_);y!==null&&(v.matrix.fromArray(y.transform.matrix),v.matrix.decompose(v.position,v.rotation,v.scale),v.matrixWorldNeedsUpdate=!0,v.jointRadius=y.radius),v.visible=y!==null}const u=c.joints["index-finger-tip"],f=c.joints["thumb-tip"],d=u.position.distanceTo(f.position),g=.02,p=.005;c.inputState.pinching&&d>g+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&d<=g-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(ZEe)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const r=new YS;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[t.jointName]=r,e.add(r)}return e.joints[t.jointName]}}class i4{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new cr(e),this.density=t}clone(){return new i4(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class s4{constructor(e,t=1,r=1e3){this.isFog=!0,this.name="",this.color=new cr(e),this.near=t,this.far=r}clone(){return new s4(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class VT extends za{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Um,this.environmentIntensity=1,this.environmentRotation=new Um,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class a4{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=B2,this.updateRanges=[],this.version=0,this.uuid=Dg()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,r){e*=this.stride,r*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[r+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Dg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(t,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Dg()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Tp=new ut;class vE{constructor(e,t,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,r=this.data.count;t<r;t++)Tp.fromBufferAttribute(this,t),Tp.applyMatrix4(e),this.setXYZ(t,Tp.x,Tp.y,Tp.z);return this}applyNormalMatrix(e){for(let t=0,r=this.count;t<r;t++)Tp.fromBufferAttribute(this,t),Tp.applyNormalMatrix(e),this.setXYZ(t,Tp.x,Tp.y,Tp.z);return this}transformDirection(e){for(let t=0,r=this.count;t<r;t++)Tp.fromBufferAttribute(this,t),Tp.transformDirection(e),this.setXYZ(t,Tp.x,Tp.y,Tp.z);return this}getComponent(e,t){let r=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(r=Ip(r,this.array)),r}setComponent(e,t,r){return this.normalized&&(r=is(r,this.array)),this.data.array[e*this.data.stride+this.offset+t]=r,this}setX(e,t){return this.normalized&&(t=is(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=is(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=is(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=is(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ip(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ip(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ip(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ip(t,this.array)),t}setXY(e,t,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=is(t,this.array),r=is(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this}setXYZ(e,t,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,t,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=is(t,this.array),r=is(r,this.array),i=is(i,this.array),s=is(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Ps(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new vE(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class Rz extends nh{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new cr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let Ix;const MR=new ut,Nx=new ut,Px=new ut,Dx=new an,kR=new an,bae=new Qr,$3=new ut,OR=new ut,W3=new ut,b$=new an,t6=new an,S$=new an;class Sae extends za{constructor(e=new Rz){if(super(),this.isSprite=!0,this.type="Sprite",Ix===void 0){Ix=new ts;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new a4(t,5);Ix.setIndex([0,1,2,0,2,3]),Ix.setAttribute("position",new vE(r,3,0,!1)),Ix.setAttribute("uv",new vE(r,2,3,!1))}this.geometry=Ix,this.material=e,this.center=new an(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Nx.setFromMatrixScale(this.matrixWorld),bae.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Px.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Nx.multiplyScalar(-Px.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;Y3($3.set(-.5,-.5,0),Px,a,Nx,i,s),Y3(OR.set(.5,-.5,0),Px,a,Nx,i,s),Y3(W3.set(.5,.5,0),Px,a,Nx,i,s),b$.set(0,0),t6.set(1,0),S$.set(1,1);let o=e.ray.intersectTriangle($3,OR,W3,!1,MR);if(o===null&&(Y3(OR.set(-.5,.5,0),Px,a,Nx,i,s),t6.set(0,1),o=e.ray.intersectTriangle($3,W3,OR,!1,MR),o===null))return;const l=e.ray.origin.distanceTo(MR);l<e.near||l>e.far||t.push({distance:l,point:MR.clone(),uv:Rm.getInterpolation(MR,$3,OR,W3,b$,t6,S$,new an),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function Y3(n,e,t,r,i,s){Dx.subVectors(n,t).addScalar(.5).multiply(r),i!==void 0?(kR.x=s*Dx.x-i*Dx.y,kR.y=i*Dx.x+s*Dx.y):kR.copy(Dx),n.copy(e),n.x+=kR.x,n.y+=kR.y,n.applyMatrix4(bae)}const X3=new ut,E$=new ut;class Eae extends za{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let r=0,i=t.length;r<i;r++){const s=t[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,r=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:r,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let r=0;r<t.length;r++)if(t[r].distance===e){const i=t.splice(r,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let r,i;for(r=1,i=t.length;r<i;r++){let s=t[r].distance;if(t[r].object.visible&&(s-=s*t[r].hysteresis),e<s)break}return t[r-1].object}return null}raycast(e,t){if(this.levels.length>0){X3.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(X3);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){X3.setFromMatrixPosition(e.matrixWorld),E$.setFromMatrixPosition(this.matrixWorld);const r=X3.distanceTo(E$)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),r>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const a=r[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const x$=new ut,T$=new xa,w$=new xa,QEe=new ut,R$=new Qr,K3=new ut,n6=new xd,A$=new Qr,r6=new Nw;class xae extends vu{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=VF,this.bindMatrix=new Qr,this.bindMatrixInverse=new Qr,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Qd),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,K3),this.boundingBox.expandByPoint(K3)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new xd),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let r=0;r<t.count;r++)this.getVertexPosition(r,K3),this.boundingSphere.expandByPoint(K3)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),n6.copy(this.boundingSphere),n6.applyMatrix4(i),e.ray.intersectsSphere(n6)!==!1&&(A$.copy(i).invert(),r6.copy(e.ray).applyMatrix4(A$),!(this.boundingBox!==null&&r6.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,r6)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new xa,t=this.geometry.attributes.skinWeight;for(let r=0,i=t.count;r<i;r++){e.fromBufferAttribute(t,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===VF?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===Qse?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const r=this.skeleton,i=this.geometry;T$.fromBufferAttribute(i.attributes.skinIndex,e),w$.fromBufferAttribute(i.attributes.skinWeight,e),x$.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=w$.getComponent(s);if(a!==0){const o=T$.getComponent(s);R$.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),t.addScaledVector(QEe.copy(x$).applyMatrix4(R$),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class Az extends za{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Lg extends xc{constructor(e=null,t=1,r=1,i,s,a,o,l,c=bf,u=bf,f,d){super(null,a,o,l,c,u,i,s,f,d),this.isDataTexture=!0,this.image={data:e,width:t,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const C$=new Qr,JEe=new Qr;class o4{constructor(e=[],t=[]){this.uuid=Dg(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new Qr)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const r=new Qr;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,t=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:JEe;C$.multiplyMatrices(o,t[s]),C$.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new o4(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const r=new Lg(t,e,e,Xf,Dp);return r.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=r,this}getBoneByName(e){for(let t=0,r=this.bones.length;t<r;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new Az),this.bones.push(a),this.boneInverses.push(new Qr().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,r=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const o=r[i];e.boneInverses.push(o.toArray())}return e}}class GT extends Ps{constructor(e,t,r,i=1){super(e,t,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Lx=new Qr,M$=new Qr,Z3=[],k$=new Qd,exe=new Qr,IR=new vu,NR=new xd;class Tae extends vu{constructor(e,t,r){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new GT(new Float32Array(r*16),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,exe)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Qd),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Lx),k$.copy(e.boundingBox).applyMatrix4(Lx),this.boundingBox.union(k$)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new xd),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<t;r++)this.getMatrixAt(r,Lx),NR.copy(e.boundingSphere).applyMatrix4(Lx),this.boundingSphere.union(NR)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const r=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=r.length+1,a=e*s+1;for(let o=0;o<r.length;o++)r[o]=i[a+o]}raycast(e,t){const r=this.matrixWorld,i=this.count;if(IR.geometry=this.geometry,IR.material=this.material,IR.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),NR.copy(this.boundingSphere),NR.applyMatrix4(r),e.ray.intersectsSphere(NR)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,Lx),M$.multiplyMatrices(r,Lx),IR.matrixWorld=M$,IR.raycast(e,Z3);for(let a=0,o=Z3.length;a<o;a++){const l=Z3[a];l.instanceId=s,l.object=this,t.push(l)}Z3.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new GT(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const r=t.morphTargetInfluences,i=r.length+1;this.morphTexture===null&&(this.morphTexture=new Lg(new Float32Array(i*this.count),i,this.count,Iw,Dp));const s=this.morphTexture.source.data.data;let a=0;for(let c=0;c<r.length;c++)a+=r[c];const o=this.geometry.morphTargetsRelative?1:1-a,l=i*e;s[l]=o,s.set(r,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const i6=new ut,txe=new ut,nxe=new Ji;let Qb=class{constructor(e=new ut(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,r,i){return this.normal.set(e,t,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,r){const i=i6.subVectors(r,t).cross(txe.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const r=e.delta(i6),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return t<0&&r>0||r<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const r=t||nxe.getNormalMatrix(e),i=this.coplanarPoint(i6).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}};const aS=new xd,Q3=new ut;class Pw{constructor(e=new Qb,t=new Qb,r=new Qb,i=new Qb,s=new Qb,a=new Qb){this.planes=[e,t,r,i,s,a]}set(e,t,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let r=0;r<6;r++)t[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,t=k0){const r=this.planes,i=e.elements,s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],f=i[6],d=i[7],g=i[8],p=i[9],_=i[10],y=i[11],v=i[12],x=i[13],E=i[14],M=i[15];if(r[0].setComponents(l-s,d-c,y-g,M-v).normalize(),r[1].setComponents(l+s,d+c,y+g,M+v).normalize(),r[2].setComponents(l+a,d+u,y+p,M+x).normalize(),r[3].setComponents(l-a,d-u,y-p,M-x).normalize(),r[4].setComponents(l-o,d-f,y-_,M-E).normalize(),t===k0)r[5].setComponents(l+o,d+f,y+_,M+E).normalize();else if(t===F2)r[5].setComponents(o,f,_,E).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),aS.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),aS.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(aS)}intersectsSprite(e){return aS.center.set(0,0,0),aS.radius=.7071067811865476,aS.applyMatrix4(e.matrixWorld),this.intersectsSphere(aS)}intersectsSphere(e){const t=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let r=0;r<6;r++){const i=t[r];if(Q3.x=i.normal.x>0?e.max.x:e.min.x,Q3.y=i.normal.y>0?e.max.y:e.min.y,Q3.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Q3)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let r=0;r<6;r++)if(t[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const ev=new Qr,tv=new Pw;class l4{constructor(){this.coordinateSystem=k0}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(ev.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),tv.setFromProjectionMatrix(ev,this.coordinateSystem),tv.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(ev.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),tv.setFromProjectionMatrix(ev,this.coordinateSystem),tv.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(ev.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),tv.setFromProjectionMatrix(ev,this.coordinateSystem),tv.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(ev.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),tv.setFromProjectionMatrix(ev,this.coordinateSystem),tv.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let r=0;r<t.cameras.length;r++){const i=t.cameras[r];if(ev.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),tv.setFromProjectionMatrix(ev,this.coordinateSystem),tv.containsPoint(e))return!0}return!1}clone(){return new l4}}function s6(n,e){return n-e}function rxe(n,e){return n.z-e.z}function ixe(n,e){return e.z-n.z}class sxe{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,r,i){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=r,o.index=i}reset(){this.list.length=0,this.index=0}}const dm=new Qr,axe=new cr(1,1,1),O$=new Pw,oxe=new l4,J3=new Qd,oS=new xd,PR=new ut,I$=new ut,lxe=new ut,a6=new sxe,Gd=new vu,eI=[];function cxe(n,e,t=0){const r=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const i=n.count;for(let s=0;s<i;s++)for(let a=0;a<r;a++)e.setComponent(s+t,a,n.getComponent(s,a))}else e.array.set(n.array,t*r);e.needsUpdate=!0}function lS(n,e){if(n.constructor!==e.constructor){const t=Math.min(n.length,e.length);for(let r=0;r<t;r++)e[r]=n[r]}else{const t=Math.min(n.length,e.length);e.set(new n.constructor(n.buffer,0,t))}}class wae extends vu{constructor(e,t,r=t*2,i){super(new ts,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=r,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),r=new Lg(t,e,e,Xf,Dp);this._matricesTexture=r}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),r=new Lg(t,e,e,Yk,Uv);this._indirectTexture=r}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),r=new Lg(t,e,e,Xf,Dp);r.colorSpace=Sa.workingColorSpace,this._colorsTexture=r}_initializeGeometry(e){const t=this.geometry,r=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:l,normalized:c}=a,u=new o.constructor(r*l),f=new Ps(u,l,c);t.setAttribute(s,f)}if(e.getIndex()!==null){const s=r>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Ps(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const r in t.attributes){if(!e.hasAttribute(r))throw new Error(`THREE.BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=t.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Qd);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,dm),this.getBoundingBoxAt(s,J3).applyMatrix4(dm),e.union(J3)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new xd);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let r=0,i=t.length;r<i;r++){if(t[r].active===!1)continue;const s=t[r].geometryIndex;this.getMatrixAt(r,dm),this.getBoundingSphereAt(s,oS).applyMatrix4(dm),e.union(oS)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const r={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(s6),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=r):(i=this._instanceInfo.length,this._instanceInfo.push(r));const s=this._matricesTexture;dm.identity().toArray(s.image.data,i*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(axe.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,r=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=r===-1?a.count:r),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(s6),l=this._availableGeometryIds.shift(),s[l]=i):(l=this._geometryCount,this._geometryCount++,s.push(i)),this.setGeometryAt(l,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(i&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const u in r.attributes){const f=t.getAttribute(u),d=r.getAttribute(u);cxe(f,d,l);const g=f.itemSize;for(let p=f.count,_=c;p<_;p++){const y=l+p;for(let v=0;v<g;v++)d.setComponent(y,v,0)}d.needsUpdate=!0,d.addUpdateRange(l*g,c*g)}if(i){const u=o.indexStart,f=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let d=0;d<a.count;d++)s.setX(u+d,l+a.getX(d));for(let d=a.count,g=f;d<g;d++)s.setX(u+d,l);s.needsUpdate=!0,s.addUpdateRange(u,o.reservedIndexCount)}return o.start=i?o.indexStart:o.vertexStart,o.count=i?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const r=this._instanceInfo;for(let i=0,s=r.length;i<s;i++)r[i].active&&r[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const r=this._geometryInfo,i=r.map((a,o)=>o).sort((a,o)=>r[a].vertexStart-r[o].vertexStart),s=this.geometry;for(let a=0,o=r.length;a<o;a++){const l=i[a],c=r[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==t){const{indexStart:u,vertexStart:f,reservedIndexCount:d}=c,g=s.index,p=g.array,_=e-f;for(let y=u;y<u+d;y++)p[y]=p[y]+_;g.array.copyWithin(t,u,u+d),g.addUpdateRange(t,d),c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:u,reservedVertexCount:f}=c,d=s.attributes;for(const g in d){const p=d[g],{array:_,itemSize:y}=p;_.copyWithin(e*y,u*y,(u+f)*y),p.addUpdateRange(e*y,f*y)}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const s=new Qd,a=r.index,o=r.attributes.position;for(let l=i.start,c=i.start+i.count;l<c;l++){let u=l;a&&(u=a.getX(u)),s.expandByPoint(PR.fromBufferAttribute(o,u))}i.boundingBox=s}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const r=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const s=new xd;this.getBoundingBoxAt(e,J3),J3.getCenter(s.center);const a=r.index,o=r.attributes.position;let l=0;for(let c=i.start,u=i.start+i.count;c<u;c++){let f=c;a&&(f=a.getX(f)),PR.fromBufferAttribute(o,f),l=Math.max(l,s.center.distanceToSquared(PR))}s.radius=Math.sqrt(l),i.boundingSphere=s}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const r=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),r.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const r=this._geometryInfo[e];return t.vertexStart=r.vertexStart,t.vertexCount=r.vertexCount,t.reservedVertexCount=r.reservedVertexCount,t.indexStart=r.indexStart,t.indexCount=r.indexCount,t.reservedIndexCount=r.reservedIndexCount,t.start=r.start,t.count=r.count,t}setInstanceCount(e){const t=this._availableInstanceIds,r=this._instanceInfo;for(t.sort(s6);t[t.length-1]===r.length;)r.pop(),t.pop();if(e<r.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),s=new Int32Array(e);lS(this._multiDrawCounts,i),lS(this._multiDrawStarts,s),this._multiDrawCounts=i,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),lS(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),lS(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),lS(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const r=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...r.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...r.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new ts,this._initializeGeometry(s));const a=this.geometry;s.index&&lS(s.index.array,a.index.array);for(const o in s.attributes)lS(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const r=this._instanceInfo,i=this._geometryInfo,s=this.matrixWorld,a=this.geometry;Gd.material=this.material,Gd.geometry.index=a.index,Gd.geometry.attributes=a.attributes,Gd.geometry.boundingBox===null&&(Gd.geometry.boundingBox=new Qd),Gd.geometry.boundingSphere===null&&(Gd.geometry.boundingSphere=new xd);for(let o=0,l=r.length;o<l;o++){if(!r[o].visible||!r[o].active)continue;const c=r[o].geometryIndex,u=i[c];Gd.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(o,Gd.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,Gd.geometry.boundingBox),this.getBoundingSphereAt(c,Gd.geometry.boundingSphere),Gd.raycast(e,eI);for(let f=0,d=eI.length;f<d;f++){const g=eI[f];g.object=this,g.batchId=o,t.push(g)}eI.length=0}Gd.material=null,Gd.geometry.index=null,Gd.geometry.attributes={},Gd.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,u=this._multiDrawCounts,f=this._geometryInfo,d=this.perObjectFrustumCulled,g=this._indirectTexture,p=g.image.data,_=r.isArrayCamera?oxe:O$;d&&!r.isArrayCamera&&(dm.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),O$.setFromProjectionMatrix(dm,e.coordinateSystem));let y=0;if(this.sortObjects){dm.copy(this.matrixWorld).invert(),PR.setFromMatrixPosition(r.matrixWorld).applyMatrix4(dm),I$.set(0,0,-1).transformDirection(r.matrixWorld).transformDirection(dm);for(let E=0,M=l.length;E<M;E++)if(l[E].visible&&l[E].active){const O=l[E].geometryIndex;this.getMatrixAt(E,dm),this.getBoundingSphereAt(O,oS).applyMatrix4(dm);let N=!1;if(d&&(N=!_.intersectsSphere(oS,r)),!N){const I=f[O],D=lxe.subVectors(oS.center,PR).dot(I$);a6.push(I.start,I.count,D,E)}}const v=a6.list,x=this.customSort;x===null?v.sort(s.transparent?ixe:rxe):x.call(this,v,r);for(let E=0,M=v.length;E<M;E++){const O=v[E];c[y]=O.start*o,u[y]=O.count,p[y]=O.index,y++}a6.reset()}else for(let v=0,x=l.length;v<x;v++)if(l[v].visible&&l[v].active){const E=l[v].geometryIndex;let M=!1;if(d&&(this.getMatrixAt(v,dm),this.getBoundingSphereAt(E,oS).applyMatrix4(dm),M=!_.intersectsSphere(oS,r)),!M){const O=f[E];c[y]=O.start*o,u[y]=O.count,p[y]=v,y++}}g.needsUpdate=!0,this._multiDrawCount=y,this._visibilityChanged=!1}onBeforeShadow(e,t,r,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class Vp extends nh{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new cr(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const sD=new ut,aD=new ut,N$=new Qr,DR=new Nw,tI=new xd,o6=new ut,P$=new ut;class x1 extends za{constructor(e=new ts,t=new Vp){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[0];for(let i=1,s=t.count;i<s;i++)sD.fromBufferAttribute(t,i-1),aD.fromBufferAttribute(t,i),r[i]=r[i-1],r[i]+=sD.distanceTo(aD);e.setAttribute("lineDistance",new Or(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),tI.copy(r.boundingSphere),tI.applyMatrix4(i),tI.radius+=s,e.ray.intersectsSphere(tI)===!1)return;N$.copy(i).invert(),DR.copy(e.ray).applyMatrix4(N$);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,u=r.index,d=r.attributes.position;if(u!==null){const g=Math.max(0,a.start),p=Math.min(u.count,a.start+a.count);for(let _=g,y=p-1;_<y;_+=c){const v=u.getX(_),x=u.getX(_+1),E=nI(this,e,DR,l,v,x,_);E&&t.push(E)}if(this.isLineLoop){const _=u.getX(p-1),y=u.getX(g),v=nI(this,e,DR,l,_,y,p-1);v&&t.push(v)}}else{const g=Math.max(0,a.start),p=Math.min(d.count,a.start+a.count);for(let _=g,y=p-1;_<y;_+=c){const v=nI(this,e,DR,l,_,_+1,_);v&&t.push(v)}if(this.isLineLoop){const _=nI(this,e,DR,l,p-1,g,p-1);_&&t.push(_)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function nI(n,e,t,r,i,s,a){const o=n.geometry.attributes.position;if(sD.fromBufferAttribute(o,i),aD.fromBufferAttribute(o,s),t.distanceSqToSegment(sD,aD,o6,P$)>r)return;o6.applyMatrix4(n.matrixWorld);const c=e.ray.origin.distanceTo(o6);if(!(c<e.near||c>e.far))return{distance:c,point:P$.clone().applyMatrix4(n.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:n}}const D$=new ut,L$=new ut;class Wv extends x1{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,r=[];for(let i=0,s=t.count;i<s;i+=2)D$.fromBufferAttribute(t,i),L$.fromBufferAttribute(t,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+D$.distanceTo(L$);e.setAttribute("lineDistance",new Or(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Rae extends x1{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Cz extends nh{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new cr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const U$=new Qr,YF=new Nw,rI=new xd,iI=new ut;class Aae extends za{constructor(e=new ts,t=new Cz){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),rI.copy(r.boundingSphere),rI.applyMatrix4(i),rI.radius+=s,e.ray.intersectsSphere(rI)===!1)return;U$.copy(i).invert(),YF.copy(e.ray).applyMatrix4(U$);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=r.index,f=r.attributes.position;if(c!==null){const d=Math.max(0,a.start),g=Math.min(c.count,a.start+a.count);for(let p=d,_=g;p<_;p++){const y=c.getX(p);iI.fromBufferAttribute(f,y),B$(iI,y,l,i,e,t,this)}}else{const d=Math.max(0,a.start),g=Math.min(f.count,a.start+a.count);for(let p=d,_=g;p<_;p++)iI.fromBufferAttribute(f,p),B$(iI,p,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,r=Object.keys(t);if(r.length>0){const i=t[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function B$(n,e,t,r,i,s,a){const o=YF.distanceSqToPoint(n);if(o<t){const l=new ut;YF.closestPointToPoint(n,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class Cae extends xc{constructor(e,t,r,i,s=nc,a=nc,o,l,c){super(e,t,r,i,s,a,o,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1;const u=this;function f(){u.needsUpdate=!0,e.requestVideoFrameCallback(f)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(f)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class uxe extends Cae{constructor(e,t,r,i,s,a,o,l){super({},e,t,r,i,s,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class fxe extends xc{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=bf,this.minFilter=bf,this.generateMipmaps=!1,this.needsUpdate=!0}}class c4 extends xc{constructor(e,t,r,i,s,a,o,l,c,u,f,d){super(null,a,o,l,c,u,i,s,f,d),this.isCompressedTexture=!0,this.image={width:t,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class hxe extends c4{constructor(e,t,r,i,s,a){super(e,t,r,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=M0,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class dxe extends c4{constructor(e,t,r){super(void 0,e[0].width,e[0].height,t,r,rb),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class Mae extends xc{constructor(e,t,r,i,s,a,o,l,c){super(e,t,r,i,s,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Dw extends xc{constructor(e,t,r=Uv,i,s,a,o=bf,l=bf,c,u=zT){if(u!==zT&&u!==_E)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");super(null,i,s,a,o,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:t},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new c1(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class pxe extends Dw{constructor(e=1,t=1,r=1){super(e,t),this.isDepthArrayTexture=!0,this.image={width:e,height:t,depth:r},this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class u4 extends ts{constructor(e=1,t=1,r=4,i=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:r,radialSegments:i,heightSegments:s},t=Math.max(0,t),r=Math.max(1,Math.floor(r)),i=Math.max(3,Math.floor(i)),s=Math.max(1,Math.floor(s));const a=[],o=[],l=[],c=[],u=t/2,f=Math.PI/2*e,d=t,g=2*f+d,p=r*2+s,_=i+1,y=new ut,v=new ut;for(let x=0;x<=p;x++){let E=0,M=0,O=0,N=0;if(x<=r){const V=x/r,G=V*Math.PI/2;M=-u-e*Math.cos(G),O=e*Math.sin(G),N=-e*Math.cos(G),E=V*f}else if(x<=r+s){const V=(x-r)/s;M=-u+V*t,O=e,N=0,E=f+V*d}else{const V=(x-r-s)/r,G=V*Math.PI/2;M=u+e*Math.sin(G),O=e*Math.cos(G),N=e*Math.sin(G),E=f+d+V*f}const I=Math.max(0,Math.min(1,E/g));let D=0;x===0?D=.5/i:x===p&&(D=-.5/i);for(let V=0;V<=i;V++){const G=V/i,Q=G*Math.PI*2,B=Math.sin(Q),$=Math.cos(Q);v.x=-O*$,v.y=M,v.z=O*B,o.push(v.x,v.y,v.z),y.set(-O*$,N,O*B),y.normalize(),l.push(y.x,y.y,y.z),c.push(G+D,I)}if(x>0){const V=(x-1)*_;for(let G=0;G<i;G++){const Q=V+G,B=V+G+1,$=x*_+G,U=x*_+G+1;a.push(Q,B,$),a.push(B,U,$)}}}this.setIndex(a),this.setAttribute("position",new Or(o,3)),this.setAttribute("normal",new Or(l,3)),this.setAttribute("uv",new Or(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new u4(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class f4 extends ts{constructor(e=1,t=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:r,thetaLength:i},t=Math.max(3,t);const s=[],a=[],o=[],l=[],c=new ut,u=new an;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let f=0,d=3;f<=t;f++,d+=3){const g=r+f/t*i;c.x=e*Math.cos(g),c.y=e*Math.sin(g),a.push(c.x,c.y,c.z),o.push(0,0,1),u.x=(a[d]/e+1)/2,u.y=(a[d+1]/e+1)/2,l.push(u.x,u.y)}for(let f=1;f<=t;f++)s.push(f,f+1,0);this.setIndex(s),this.setAttribute("position",new Or(a,3)),this.setAttribute("normal",new Or(o,3)),this.setAttribute("uv",new Or(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new f4(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Jk extends ts{constructor(e=1,t=1,r=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],f=[],d=[],g=[];let p=0;const _=[],y=r/2;let v=0;x(),a===!1&&(e>0&&E(!0),t>0&&E(!1)),this.setIndex(u),this.setAttribute("position",new Or(f,3)),this.setAttribute("normal",new Or(d,3)),this.setAttribute("uv",new Or(g,2));function x(){const M=new ut,O=new ut;let N=0;const I=(t-e)/r;for(let D=0;D<=s;D++){const V=[],G=D/s,Q=G*(t-e)+e;for(let B=0;B<=i;B++){const $=B/i,U=$*l+o,J=Math.sin(U),W=Math.cos(U);O.x=Q*J,O.y=-G*r+y,O.z=Q*W,f.push(O.x,O.y,O.z),M.set(J,I,W).normalize(),d.push(M.x,M.y,M.z),g.push($,1-G),V.push(p++)}_.push(V)}for(let D=0;D<i;D++)for(let V=0;V<s;V++){const G=_[V][D],Q=_[V+1][D],B=_[V+1][D+1],$=_[V][D+1];(e>0||V!==0)&&(u.push(G,Q,$),N+=3),(t>0||V!==s-1)&&(u.push(Q,B,$),N+=3)}c.addGroup(v,N,0),v+=N}function E(M){const O=p,N=new an,I=new ut;let D=0;const V=M===!0?e:t,G=M===!0?1:-1;for(let B=1;B<=i;B++)f.push(0,y*G,0),d.push(0,G,0),g.push(.5,.5),p++;const Q=p;for(let B=0;B<=i;B++){const U=B/i*l+o,J=Math.cos(U),W=Math.sin(U);I.x=V*W,I.y=y*G,I.z=V*J,f.push(I.x,I.y,I.z),d.push(0,G,0),N.x=J*.5+.5,N.y=W*.5*G+.5,g.push(N.x,N.y),p++}for(let B=0;B<i;B++){const $=O+B,U=Q+B;M===!0?u.push(U,U+1,$):u.push(U+1,U,$),D+=3}c.addGroup(v,D,M===!0?1:2),v+=D}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Jk(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class eO extends Jk{constructor(e=1,t=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new eO(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class z1 extends ts{constructor(e=[],t=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:r,detail:i};const s=[],a=[];o(i),c(r),u(),this.setAttribute("position",new Or(s,3)),this.setAttribute("normal",new Or(s.slice(),3)),this.setAttribute("uv",new Or(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(x){const E=new ut,M=new ut,O=new ut;for(let N=0;N<t.length;N+=3)g(t[N+0],E),g(t[N+1],M),g(t[N+2],O),l(E,M,O,x)}function l(x,E,M,O){const N=O+1,I=[];for(let D=0;D<=N;D++){I[D]=[];const V=x.clone().lerp(M,D/N),G=E.clone().lerp(M,D/N),Q=N-D;for(let B=0;B<=Q;B++)B===0&&D===N?I[D][B]=V:I[D][B]=V.clone().lerp(G,B/Q)}for(let D=0;D<N;D++)for(let V=0;V<2*(N-D)-1;V++){const G=Math.floor(V/2);V%2===0?(d(I[D][G+1]),d(I[D+1][G]),d(I[D][G])):(d(I[D][G+1]),d(I[D+1][G+1]),d(I[D+1][G]))}}function c(x){const E=new ut;for(let M=0;M<s.length;M+=3)E.x=s[M+0],E.y=s[M+1],E.z=s[M+2],E.normalize().multiplyScalar(x),s[M+0]=E.x,s[M+1]=E.y,s[M+2]=E.z}function u(){const x=new ut;for(let E=0;E<s.length;E+=3){x.x=s[E+0],x.y=s[E+1],x.z=s[E+2];const M=y(x)/2/Math.PI+.5,O=v(x)/Math.PI+.5;a.push(M,1-O)}p(),f()}function f(){for(let x=0;x<a.length;x+=6){const E=a[x+0],M=a[x+2],O=a[x+4],N=Math.max(E,M,O),I=Math.min(E,M,O);N>.9&&I<.1&&(E<.2&&(a[x+0]+=1),M<.2&&(a[x+2]+=1),O<.2&&(a[x+4]+=1))}}function d(x){s.push(x.x,x.y,x.z)}function g(x,E){const M=x*3;E.x=e[M+0],E.y=e[M+1],E.z=e[M+2]}function p(){const x=new ut,E=new ut,M=new ut,O=new ut,N=new an,I=new an,D=new an;for(let V=0,G=0;V<s.length;V+=9,G+=6){x.set(s[V+0],s[V+1],s[V+2]),E.set(s[V+3],s[V+4],s[V+5]),M.set(s[V+6],s[V+7],s[V+8]),N.set(a[G+0],a[G+1]),I.set(a[G+2],a[G+3]),D.set(a[G+4],a[G+5]),O.copy(x).add(E).add(M).divideScalar(3);const Q=y(O);_(N,G+0,x,Q),_(I,G+2,E,Q),_(D,G+4,M,Q)}}function _(x,E,M,O){O<0&&x.x===1&&(a[E]=x.x-1),M.x===0&&M.z===0&&(a[E]=O/2/Math.PI+.5)}function y(x){return Math.atan2(x.z,-x.x)}function v(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new z1(e.vertices,e.indices,e.radius,e.details)}}class h4 extends z1{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new h4(e.radius,e.detail)}}const sI=new ut,aI=new ut,l6=new ut,oI=new Rm;class kae extends ts{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(rE*t),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],u=["a","b","c"],f=new Array(3),d={},g=[];for(let p=0;p<l;p+=3){a?(c[0]=a.getX(p),c[1]=a.getX(p+1),c[2]=a.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:_,b:y,c:v}=oI;if(_.fromBufferAttribute(o,c[0]),y.fromBufferAttribute(o,c[1]),v.fromBufferAttribute(o,c[2]),oI.getNormal(l6),f[0]=`${Math.round(_.x*i)},${Math.round(_.y*i)},${Math.round(_.z*i)}`,f[1]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,f[2]=`${Math.round(v.x*i)},${Math.round(v.y*i)},${Math.round(v.z*i)}`,!(f[0]===f[1]||f[1]===f[2]||f[2]===f[0]))for(let x=0;x<3;x++){const E=(x+1)%3,M=f[x],O=f[E],N=oI[u[x]],I=oI[u[E]],D=`${M}_${O}`,V=`${O}_${M}`;V in d&&d[V]?(l6.dot(d[V].normal)<=s&&(g.push(N.x,N.y,N.z),g.push(I.x,I.y,I.z)),d[V]=null):D in d||(d[D]={index0:c[x],index1:c[E],normal:l6.clone()})}}for(const p in d)if(d[p]){const{index0:_,index1:y}=d[p];sI.fromBufferAttribute(o,_),aI.fromBufferAttribute(o,y),g.push(sI.x,sI.y,sI.z),g.push(aI.x,aI.y,aI.z)}this.setAttribute("position",new Or(g,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class U_{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(e,t){const r=this.getUtoTmapping(e);return this.getPoint(r,t)}getPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return t}getSpacedPoints(e=5){const t=[];for(let r=0;r<=e;r++)t.push(this.getPointAt(r/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let r,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),s+=r.distanceTo(i),t.push(s),i=r;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const r=this.getLengths();let i=0;const s=r.length;let a;t?a=t:a=e*r[s-1];let o=0,l=s-1,c;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),c=r[i]-a,c<0)o=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===a)return i/(s-1);const u=r[i],d=r[i+1]-u,g=(a-u)/d;return(i+g)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),l=t||(a.isVector2?new an:new ut);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const r=this.getUtoTmapping(e);return this.getTangent(r,t)}computeFrenetFrames(e,t=!1){const r=new ut,i=[],s=[],a=[],o=new ut,l=new Qr;for(let g=0;g<=e;g++){const p=g/e;i[g]=this.getTangentAt(p,new ut)}s[0]=new ut,a[0]=new ut;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),f=Math.abs(i[0].y),d=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),f<=c&&(c=f,r.set(0,1,0)),d<=c&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let g=1;g<=e;g++){if(s[g]=s[g-1].clone(),a[g]=a[g-1].clone(),o.crossVectors(i[g-1],i[g]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(Gi(i[g-1].dot(i[g]),-1,1));s[g].applyMatrix4(l.makeRotationAxis(o,p))}a[g].crossVectors(i[g],s[g])}if(t===!0){let g=Math.acos(Gi(s[0].dot(s[e]),-1,1));g/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(g=-g);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],g*p)),a[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class d4 extends U_{constructor(e=0,t=0,r=1,i=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new an){const r=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),f=Math.sin(this.aRotation),d=l-this.aX,g=c-this.aY;l=d*u-g*f+this.aX,c=d*f+g*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Oae extends d4{constructor(e,t,r,i,s,a){super(e,t,r,r,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Mz(){let n=0,e=0,t=0,r=0;function i(s,a,o,l){n=s,e=o,t=-3*s+3*a-2*o-l,r=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){i(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,f){let d=(a-s)/c-(o-s)/(c+u)+(o-a)/u,g=(o-a)/u-(l-a)/(u+f)+(l-o)/f;d*=u,g*=u,i(a,o,d,g)},calc:function(s){const a=s*s,o=a*s;return n+e*s+t*a+r*o}}}const lI=new ut,c6=new Mz,u6=new Mz,f6=new Mz;class Iae extends U_{constructor(e=[],t=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=r,this.tension=i}getPoint(e,t=new ut){const r=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,u;this.closed||o>0?c=i[(o-1)%s]:(lI.subVectors(i[0],i[1]).add(i[0]),c=lI);const f=i[o%s],d=i[(o+1)%s];if(this.closed||o+2<s?u=i[(o+2)%s]:(lI.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=lI),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(f),g),_=Math.pow(f.distanceToSquared(d),g),y=Math.pow(d.distanceToSquared(u),g);_<1e-4&&(_=1),p<1e-4&&(p=_),y<1e-4&&(y=_),c6.initNonuniformCatmullRom(c.x,f.x,d.x,u.x,p,_,y),u6.initNonuniformCatmullRom(c.y,f.y,d.y,u.y,p,_,y),f6.initNonuniformCatmullRom(c.z,f.z,d.z,u.z,p,_,y)}else this.curveType==="catmullrom"&&(c6.initCatmullRom(c.x,f.x,d.x,u.x,this.tension),u6.initCatmullRom(c.y,f.y,d.y,u.y,this.tension),f6.initCatmullRom(c.z,f.z,d.z,u.z,this.tension));return r.set(c6.calc(l),u6.calc(l),f6.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new ut().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function F$(n,e,t,r,i){const s=(r-e)*.5,a=(i-t)*.5,o=n*n,l=n*o;return(2*t-2*r+s+a)*l+(-3*t+3*r-2*s-a)*o+s*n+t}function mxe(n,e){const t=1-n;return t*t*e}function gxe(n,e){return 2*(1-n)*n*e}function _xe(n,e){return n*n*e}function g2(n,e,t,r){return mxe(n,e)+gxe(n,t)+_xe(n,r)}function vxe(n,e){const t=1-n;return t*t*t*e}function yxe(n,e){const t=1-n;return 3*t*t*n*e}function bxe(n,e){return 3*(1-n)*n*n*e}function Sxe(n,e){return n*n*n*e}function _2(n,e,t,r,i){return vxe(n,e)+yxe(n,t)+bxe(n,r)+Sxe(n,i)}class kz extends U_{constructor(e=new an,t=new an,r=new an,i=new an){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new an){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(_2(e,i.x,s.x,a.x,o.x),_2(e,i.y,s.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Nae extends U_{constructor(e=new ut,t=new ut,r=new ut,i=new ut){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=r,this.v3=i}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(_2(e,i.x,s.x,a.x,o.x),_2(e,i.y,s.y,a.y,o.y),_2(e,i.z,s.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Oz extends U_{constructor(e=new an,t=new an){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new an){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new an){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Pae extends U_{constructor(e=new ut,t=new ut){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ut){const r=t;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ut){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Iz extends U_{constructor(e=new an,t=new an,r=new an){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new an){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(g2(e,i.x,s.x,a.x),g2(e,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Nz extends U_{constructor(e=new ut,t=new ut,r=new ut){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=r}getPoint(e,t=new ut){const r=t,i=this.v0,s=this.v1,a=this.v2;return r.set(g2(e,i.x,s.x,a.x),g2(e,i.y,s.y,a.y),g2(e,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Pz extends U_{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new an){const r=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,l=i[a===0?a:a-1],c=i[a],u=i[a>i.length-2?i.length-1:a+1],f=i[a>i.length-3?i.length-1:a+2];return r.set(F$(o,l.x,c.x,u.x,f.x),F$(o,l.y,c.y,u.y,f.y)),r}copy(e){super.copy(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,r=this.points.length;t<r;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,r=e.points.length;t<r;t++){const i=e.points[t];this.points.push(new an().fromArray(i))}return this}}var oD=Object.freeze({__proto__:null,ArcCurve:Oae,CatmullRomCurve3:Iae,CubicBezierCurve:kz,CubicBezierCurve3:Nae,EllipseCurve:d4,LineCurve:Oz,LineCurve3:Pae,QuadraticBezierCurve:Iz,QuadraticBezierCurve3:Nz,SplineCurve:Pz});class Dae extends U_{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new oD[r](t,e))}return this}getPoint(e,t){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const a=i[s]-r,o=this.curves[s],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let r=0,i=this.curves.length;r<i;r++)t+=this.curves[r].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let r=0;r<=e;r++)t.push(this.getPoint(r/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(t.push(u),r=u)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,r=this.curves.length;t<r;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,r=e.curves.length;t<r;t++){const i=e.curves[t];this.curves.push(new oD[i.type]().fromJSON(i))}return this}}class lD extends Dae{constructor(e){super(),this.type="Path",this.currentPoint=new an,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,r=e.length;t<r;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const r=new Oz(this.currentPoint.clone(),new an(e,t));return this.curves.push(r),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,r,i){const s=new Iz(this.currentPoint.clone(),new an(e,t),new an(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,t,r,i,s,a){const o=new kz(this.currentPoint.clone(),new an(e,t),new an(r,i),new an(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),r=new Pz(t);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,r,i,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,r,i,s,a),this}absarc(e,t,r,i,s,a){return this.absellipse(e,t,r,r,i,s,a),this}ellipse(e,t,r,i,s,a,o,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,r,i,s,a,o,l),this}absellipse(e,t,r,i,s,a,o,l){const c=new d4(e,t,r,i,s,a,o,l);if(this.curves.length>0){const f=c.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class iE extends lD{constructor(e){super(e),this.uuid=Dg(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let r=0,i=this.holes.length;r<i;r++)t[r]=this.holes[r].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,r=this.holes.length;t<r;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,r=e.holes.length;t<r;t++){const i=e.holes[t];this.holes.push(new lD().fromJSON(i))}return this}}function Exe(n,e,t=2){const r=e&&e.length,i=r?e[0]*t:n.length;let s=Lae(n,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(r&&(s=Axe(n,e,s,t)),n.length>80*t){o=1/0,l=1/0;let u=-1/0,f=-1/0;for(let d=t;d<i;d+=t){const g=n[d],p=n[d+1];g<o&&(o=g),p<l&&(l=p),g>u&&(u=g),p>f&&(f=p)}c=Math.max(u-o,f-l),c=c!==0?32767/c:0}return j2(s,a,t,o,l,c,0),a}function Lae(n,e,t,r,i){let s;if(i===Bxe(n,e,t,r)>0)for(let a=e;a<t;a+=r)s=z$(a/r|0,n[a],n[a+1],s);else for(let a=t-r;a>=e;a-=r)s=z$(a/r|0,n[a],n[a+1],s);return s&&$T(s,s.next)&&(q2(s),s=s.next),s}function yE(n,e){if(!n)return n;e||(e=n);let t=n,r;do if(r=!1,!t.steiner&&($T(t,t.next)||jc(t.prev,t,t.next)===0)){if(q2(t),t=e=t.prev,t===t.next)break;r=!0}else t=t.next;while(r||t!==e);return e}function j2(n,e,t,r,i,s,a){if(!n)return;!a&&s&&Ixe(n,r,i,s);let o=n;for(;n.prev!==n.next;){const l=n.prev,c=n.next;if(s?Txe(n,r,i,s):xxe(n)){e.push(l.i,n.i,c.i),q2(n),n=c.next,o=c.next;continue}if(n=c,n===o){a?a===1?(n=wxe(yE(n),e),j2(n,e,t,r,i,s,2)):a===2&&Rxe(n,e,t,r,i,s):j2(yE(n),e,t,r,i,s,1);break}}}function xxe(n){const e=n.prev,t=n,r=n.next;if(jc(e,t,r)>=0)return!1;const i=e.x,s=t.x,a=r.x,o=e.y,l=t.y,c=r.y,u=Math.min(i,s,a),f=Math.min(o,l,c),d=Math.max(i,s,a),g=Math.max(o,l,c);let p=r.next;for(;p!==e;){if(p.x>=u&&p.x<=d&&p.y>=f&&p.y<=g&&WM(i,o,s,l,a,c,p.x,p.y)&&jc(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Txe(n,e,t,r){const i=n.prev,s=n,a=n.next;if(jc(i,s,a)>=0)return!1;const o=i.x,l=s.x,c=a.x,u=i.y,f=s.y,d=a.y,g=Math.min(o,l,c),p=Math.min(u,f,d),_=Math.max(o,l,c),y=Math.max(u,f,d),v=XF(g,p,e,t,r),x=XF(_,y,e,t,r);let E=n.prevZ,M=n.nextZ;for(;E&&E.z>=v&&M&&M.z<=x;){if(E.x>=g&&E.x<=_&&E.y>=p&&E.y<=y&&E!==i&&E!==a&&WM(o,u,l,f,c,d,E.x,E.y)&&jc(E.prev,E,E.next)>=0||(E=E.prevZ,M.x>=g&&M.x<=_&&M.y>=p&&M.y<=y&&M!==i&&M!==a&&WM(o,u,l,f,c,d,M.x,M.y)&&jc(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;E&&E.z>=v;){if(E.x>=g&&E.x<=_&&E.y>=p&&E.y<=y&&E!==i&&E!==a&&WM(o,u,l,f,c,d,E.x,E.y)&&jc(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;M&&M.z<=x;){if(M.x>=g&&M.x<=_&&M.y>=p&&M.y<=y&&M!==i&&M!==a&&WM(o,u,l,f,c,d,M.x,M.y)&&jc(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function wxe(n,e){let t=n;do{const r=t.prev,i=t.next.next;!$T(r,i)&&Bae(r,t,t.next,i)&&H2(r,i)&&H2(i,r)&&(e.push(r.i,t.i,i.i),q2(t),q2(t.next),t=n=i),t=t.next}while(t!==n);return yE(t)}function Rxe(n,e,t,r,i,s){let a=n;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Dxe(a,o)){let l=Fae(a,o);a=yE(a,a.next),l=yE(l,l.next),j2(a,e,t,r,i,s,0),j2(l,e,t,r,i,s,0);return}o=o.next}a=a.next}while(a!==n)}function Axe(n,e,t,r){const i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*r,l=s<a-1?e[s+1]*r:n.length,c=Lae(n,o,l,r,!1);c===c.next&&(c.steiner=!0),i.push(Pxe(c))}i.sort(Cxe);for(let s=0;s<i.length;s++)t=Mxe(i[s],t);return t}function Cxe(n,e){let t=n.x-e.x;if(t===0&&(t=n.y-e.y,t===0)){const r=(n.next.y-n.y)/(n.next.x-n.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=r-i}return t}function Mxe(n,e){const t=kxe(n,e);if(!t)return e;const r=Fae(t,n);return yE(r,r.next),yE(t,t.next)}function kxe(n,e){let t=e;const r=n.x,i=n.y;let s=-1/0,a;if($T(n,t))return t;do{if($T(n,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const f=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(f<=r&&f>s&&(s=f,a=t.x<t.next.x?t:t.next,f===r))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let u=1/0;t=a;do{if(r>=t.x&&t.x>=l&&r!==t.x&&Uae(i<c?r:s,i,l,c,i<c?s:r,i,t.x,t.y)){const f=Math.abs(i-t.y)/(r-t.x);H2(t,n)&&(f<u||f===u&&(t.x>a.x||t.x===a.x&&Oxe(a,t)))&&(a=t,u=f)}t=t.next}while(t!==o);return a}function Oxe(n,e){return jc(n.prev,n,e.prev)<0&&jc(e.next,n,n.next)<0}function Ixe(n,e,t,r){let i=n;do i.z===0&&(i.z=XF(i.x,i.y,e,t,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==n);i.prevZ.nextZ=null,i.prevZ=null,Nxe(i)}function Nxe(n){let e,t=1;do{let r=n,i;n=null;let s=null;for(e=0;r;){e++;let a=r,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,l--),s?s.nextZ=i:n=i,i.prevZ=s,s=i;r=a}s.nextZ=null,t*=2}while(e>1);return n}function XF(n,e,t,r,i){return n=(n-t)*i|0,e=(e-r)*i|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function Pxe(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Uae(n,e,t,r,i,s,a,o){return(i-a)*(e-o)>=(n-a)*(s-o)&&(n-a)*(r-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(i-a)*(r-o)}function WM(n,e,t,r,i,s,a,o){return!(n===a&&e===o)&&Uae(n,e,t,r,i,s,a,o)}function Dxe(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!Lxe(n,e)&&(H2(n,e)&&H2(e,n)&&Uxe(n,e)&&(jc(n.prev,n,e.prev)||jc(n,e.prev,e))||$T(n,e)&&jc(n.prev,n,n.next)>0&&jc(e.prev,e,e.next)>0)}function jc(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function $T(n,e){return n.x===e.x&&n.y===e.y}function Bae(n,e,t,r){const i=uI(jc(n,e,t)),s=uI(jc(n,e,r)),a=uI(jc(t,r,n)),o=uI(jc(t,r,e));return!!(i!==s&&a!==o||i===0&&cI(n,t,e)||s===0&&cI(n,r,e)||a===0&&cI(t,n,r)||o===0&&cI(t,e,r))}function cI(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function uI(n){return n>0?1:n<0?-1:0}function Lxe(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&Bae(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function H2(n,e){return jc(n.prev,n,n.next)<0?jc(n,e,n.next)>=0&&jc(n,n.prev,e)>=0:jc(n,e,n.prev)<0||jc(n,n.next,e)<0}function Uxe(n,e){let t=n,r=!1;const i=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(r=!r),t=t.next;while(t!==n);return r}function Fae(n,e){const t=KF(n.i,n.x,n.y),r=KF(e.i,e.x,e.y),i=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=i,i.prev=t,r.next=t,t.prev=r,s.next=r,r.prev=s,r}function z$(n,e,t,r){const i=KF(n,e,t);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function q2(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function KF(n,e,t){return{i:n,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Bxe(n,e,t,r){let i=0;for(let s=e,a=t-r;s<t;s+=r)i+=(n[a]-n[s])*(n[s+1]+n[a+1]),a=s;return i}class Fxe{static triangulate(e,t,r=2){return Exe(e,t,r)}}class E_{static area(e){const t=e.length;let r=0;for(let i=t-1,s=0;s<t;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return E_.area(e)<0}static triangulateShape(e,t){const r=[],i=[],s=[];j$(e),H$(r,e);let a=e.length;t.forEach(j$);for(let l=0;l<t.length;l++)i.push(a),a+=t[l].length,H$(r,t[l]);const o=Fxe.triangulate(r,i);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function j$(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function H$(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class p4 extends ts{constructor(e=new iE([new an(.5,.5),new an(-.5,.5),new an(-.5,-.5),new an(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new Or(i,3)),this.setAttribute("uv",new Or(s,2)),this.computeVertexNormals();function a(o){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,u=t.steps!==void 0?t.steps:1,f=t.depth!==void 0?t.depth:1;let d=t.bevelEnabled!==void 0?t.bevelEnabled:!0,g=t.bevelThickness!==void 0?t.bevelThickness:.2,p=t.bevelSize!==void 0?t.bevelSize:g-.1,_=t.bevelOffset!==void 0?t.bevelOffset:0,y=t.bevelSegments!==void 0?t.bevelSegments:3;const v=t.extrudePath,x=t.UVGenerator!==void 0?t.UVGenerator:zxe;let E,M=!1,O,N,I,D;v&&(E=v.getSpacedPoints(u),M=!0,d=!1,O=v.computeFrenetFrames(u,!1),N=new ut,I=new ut,D=new ut),d||(y=0,g=0,p=0,_=0);const V=o.extractPoints(c);let G=V.shape;const Q=V.holes;if(!E_.isClockWise(G)){G=G.reverse();for(let oe=0,Ue=Q.length;oe<Ue;oe++){const Ge=Q[oe];E_.isClockWise(Ge)&&(Q[oe]=Ge.reverse())}}function $(oe){const Ge=10000000000000001e-36;let ze=oe[0];for(let Be=1;Be<=oe.length;Be++){const me=Be%oe.length,Se=oe[me],Ie=Se.x-ze.x,be=Se.y-ze.y,Ke=Ie*Ie+be*be,ot=Math.max(Math.abs(Se.x),Math.abs(Se.y),Math.abs(ze.x),Math.abs(ze.y)),lt=Ge*ot*ot;if(Ke<=lt){oe.splice(me,1),Be--;continue}ze=Se}}$(G),Q.forEach($);const U=Q.length,J=G;for(let oe=0;oe<U;oe++){const Ue=Q[oe];G=G.concat(Ue)}function W(oe,Ue,Ge){return Ue||console.error("THREE.ExtrudeGeometry: vec does not exist"),oe.clone().addScaledVector(Ue,Ge)}const q=G.length;function Y(oe,Ue,Ge){let ze,Be,me;const Se=oe.x-Ue.x,Ie=oe.y-Ue.y,be=Ge.x-oe.x,Ke=Ge.y-oe.y,ot=Se*Se+Ie*Ie,lt=Se*Ke-Ie*be;if(Math.abs(lt)>Number.EPSILON){const ct=Math.sqrt(ot),Vt=Math.sqrt(be*be+Ke*Ke),kt=Ue.x-Ie/ct,Ut=Ue.y+Se/ct,je=Ge.x-Ke/Vt,ge=Ge.y+be/Vt,se=((je-kt)*Ke-(ge-Ut)*be)/(Se*Ke-Ie*be);ze=kt+Se*se-oe.x,Be=Ut+Ie*se-oe.y;const _e=ze*ze+Be*Be;if(_e<=2)return new an(ze,Be);me=Math.sqrt(_e/2)}else{let ct=!1;Se>Number.EPSILON?be>Number.EPSILON&&(ct=!0):Se<-Number.EPSILON?be<-Number.EPSILON&&(ct=!0):Math.sign(Ie)===Math.sign(Ke)&&(ct=!0),ct?(ze=-Ie,Be=Se,me=Math.sqrt(ot)):(ze=Se,Be=Ie,me=Math.sqrt(ot/2))}return new an(ze/me,Be/me)}const ae=[];for(let oe=0,Ue=J.length,Ge=Ue-1,ze=oe+1;oe<Ue;oe++,Ge++,ze++)Ge===Ue&&(Ge=0),ze===Ue&&(ze=0),ae[oe]=Y(J[oe],J[Ge],J[ze]);const Z=[];let K,ne=ae.concat();for(let oe=0,Ue=U;oe<Ue;oe++){const Ge=Q[oe];K=[];for(let ze=0,Be=Ge.length,me=Be-1,Se=ze+1;ze<Be;ze++,me++,Se++)me===Be&&(me=0),Se===Be&&(Se=0),K[ze]=Y(Ge[ze],Ge[me],Ge[Se]);Z.push(K),ne=ne.concat(K)}let le;if(y===0)le=E_.triangulateShape(J,Q);else{const oe=[],Ue=[];for(let Ge=0;Ge<y;Ge++){const ze=Ge/y,Be=g*Math.cos(ze*Math.PI/2),me=p*Math.sin(ze*Math.PI/2)+_;for(let Se=0,Ie=J.length;Se<Ie;Se++){const be=W(J[Se],ae[Se],me);Ce(be.x,be.y,-Be),ze===0&&oe.push(be)}for(let Se=0,Ie=U;Se<Ie;Se++){const be=Q[Se];K=Z[Se];const Ke=[];for(let ot=0,lt=be.length;ot<lt;ot++){const ct=W(be[ot],K[ot],me);Ce(ct.x,ct.y,-Be),ze===0&&Ke.push(ct)}ze===0&&Ue.push(Ke)}}le=E_.triangulateShape(oe,Ue)}const ce=le.length,de=p+_;for(let oe=0;oe<q;oe++){const Ue=d?W(G[oe],ne[oe],de):G[oe];M?(I.copy(O.normals[0]).multiplyScalar(Ue.x),N.copy(O.binormals[0]).multiplyScalar(Ue.y),D.copy(E[0]).add(I).add(N),Ce(D.x,D.y,D.z)):Ce(Ue.x,Ue.y,0)}for(let oe=1;oe<=u;oe++)for(let Ue=0;Ue<q;Ue++){const Ge=d?W(G[Ue],ne[Ue],de):G[Ue];M?(I.copy(O.normals[oe]).multiplyScalar(Ge.x),N.copy(O.binormals[oe]).multiplyScalar(Ge.y),D.copy(E[oe]).add(I).add(N),Ce(D.x,D.y,D.z)):Ce(Ge.x,Ge.y,f/u*oe)}for(let oe=y-1;oe>=0;oe--){const Ue=oe/y,Ge=g*Math.cos(Ue*Math.PI/2),ze=p*Math.sin(Ue*Math.PI/2)+_;for(let Be=0,me=J.length;Be<me;Be++){const Se=W(J[Be],ae[Be],ze);Ce(Se.x,Se.y,f+Ge)}for(let Be=0,me=Q.length;Be<me;Be++){const Se=Q[Be];K=Z[Be];for(let Ie=0,be=Se.length;Ie<be;Ie++){const Ke=W(Se[Ie],K[Ie],ze);M?Ce(Ke.x,Ke.y+E[u-1].y,E[u-1].x+Ge):Ce(Ke.x,Ke.y,f+Ge)}}}Me(),qe();function Me(){const oe=i.length/3;if(d){let Ue=0,Ge=q*Ue;for(let ze=0;ze<ce;ze++){const Be=le[ze];Xe(Be[2]+Ge,Be[1]+Ge,Be[0]+Ge)}Ue=u+y*2,Ge=q*Ue;for(let ze=0;ze<ce;ze++){const Be=le[ze];Xe(Be[0]+Ge,Be[1]+Ge,Be[2]+Ge)}}else{for(let Ue=0;Ue<ce;Ue++){const Ge=le[Ue];Xe(Ge[2],Ge[1],Ge[0])}for(let Ue=0;Ue<ce;Ue++){const Ge=le[Ue];Xe(Ge[0]+q*u,Ge[1]+q*u,Ge[2]+q*u)}}r.addGroup(oe,i.length/3-oe,0)}function qe(){const oe=i.length/3;let Ue=0;Pe(J,Ue),Ue+=J.length;for(let Ge=0,ze=Q.length;Ge<ze;Ge++){const Be=Q[Ge];Pe(Be,Ue),Ue+=Be.length}r.addGroup(oe,i.length/3-oe,1)}function Pe(oe,Ue){let Ge=oe.length;for(;--Ge>=0;){const ze=Ge;let Be=Ge-1;Be<0&&(Be=oe.length-1);for(let me=0,Se=u+y*2;me<Se;me++){const Ie=q*me,be=q*(me+1),Ke=Ue+ze+Ie,ot=Ue+Be+Ie,lt=Ue+Be+be,ct=Ue+ze+be;$e(Ke,ot,lt,ct)}}}function Ce(oe,Ue,Ge){l.push(oe),l.push(Ue),l.push(Ge)}function Xe(oe,Ue,Ge){at(oe),at(Ue),at(Ge);const ze=i.length/3,Be=x.generateTopUV(r,i,ze-3,ze-2,ze-1);pt(Be[0]),pt(Be[1]),pt(Be[2])}function $e(oe,Ue,Ge,ze){at(oe),at(Ue),at(ze),at(Ue),at(Ge),at(ze);const Be=i.length/3,me=x.generateSideWallUV(r,i,Be-6,Be-3,Be-2,Be-1);pt(me[0]),pt(me[1]),pt(me[3]),pt(me[1]),pt(me[2]),pt(me[3])}function at(oe){i.push(l[oe*3+0]),i.push(l[oe*3+1]),i.push(l[oe*3+2])}function pt(oe){s.push(oe.x),s.push(oe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,r=this.parameters.options;return jxe(t,r,e)}static fromJSON(e,t){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];r.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new oD[i.type]().fromJSON(i)),new p4(r,e.options)}}const zxe={generateTopUV:function(n,e,t,r,i){const s=e[t*3],a=e[t*3+1],o=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new an(s,a),new an(o,l),new an(c,u)]},generateSideWallUV:function(n,e,t,r,i,s){const a=e[t*3],o=e[t*3+1],l=e[t*3+2],c=e[r*3],u=e[r*3+1],f=e[r*3+2],d=e[i*3],g=e[i*3+1],p=e[i*3+2],_=e[s*3],y=e[s*3+1],v=e[s*3+2];return Math.abs(o-u)<Math.abs(a-c)?[new an(a,1-l),new an(c,1-f),new an(d,1-p),new an(_,1-v)]:[new an(o,1-l),new an(u,1-f),new an(g,1-p),new an(y,1-v)]}};function jxe(n,e,t){if(t.shapes=[],Array.isArray(n))for(let r=0,i=n.length;r<i;r++){const s=n[r];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class m4 extends z1{constructor(e=1,t=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new m4(e.radius,e.detail)}}class g4 extends ts{constructor(e=[new an(0,-.5),new an(.5,0),new an(0,.5)],t=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:r,phiLength:i},t=Math.floor(t),i=Gi(i,0,Math.PI*2);const s=[],a=[],o=[],l=[],c=[],u=1/t,f=new ut,d=new an,g=new ut,p=new ut,_=new ut;let y=0,v=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:y=e[x+1].x-e[x].x,v=e[x+1].y-e[x].y,g.x=v*1,g.y=-y,g.z=v*0,_.copy(g),g.normalize(),l.push(g.x,g.y,g.z);break;case e.length-1:l.push(_.x,_.y,_.z);break;default:y=e[x+1].x-e[x].x,v=e[x+1].y-e[x].y,g.x=v*1,g.y=-y,g.z=v*0,p.copy(g),g.x+=_.x,g.y+=_.y,g.z+=_.z,g.normalize(),l.push(g.x,g.y,g.z),_.copy(p)}for(let x=0;x<=t;x++){const E=r+x*u*i,M=Math.sin(E),O=Math.cos(E);for(let N=0;N<=e.length-1;N++){f.x=e[N].x*M,f.y=e[N].y,f.z=e[N].x*O,a.push(f.x,f.y,f.z),d.x=x/t,d.y=N/(e.length-1),o.push(d.x,d.y);const I=l[3*N+0]*M,D=l[3*N+1],V=l[3*N+0]*O;c.push(I,D,V)}}for(let x=0;x<t;x++)for(let E=0;E<e.length-1;E++){const M=E+x*e.length,O=M,N=M+e.length,I=M+e.length+1,D=M+1;s.push(O,N,D),s.push(I,D,N)}this.setIndex(s),this.setAttribute("position",new Or(a,3)),this.setAttribute("uv",new Or(o,2)),this.setAttribute("normal",new Or(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new g4(e.points,e.segments,e.phiStart,e.phiLength)}}class tO extends z1{constructor(e=1,t=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new tO(e.radius,e.detail)}}class Lw extends ts{constructor(e=1,t=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:r,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(r),l=Math.floor(i),c=o+1,u=l+1,f=e/o,d=t/l,g=[],p=[],_=[],y=[];for(let v=0;v<u;v++){const x=v*d-a;for(let E=0;E<c;E++){const M=E*f-s;p.push(M,-x,0),_.push(0,0,1),y.push(E/o),y.push(1-v/l)}}for(let v=0;v<l;v++)for(let x=0;x<o;x++){const E=x+c*v,M=x+c*(v+1),O=x+1+c*(v+1),N=x+1+c*v;g.push(E,M,N),g.push(M,O,N)}this.setIndex(g),this.setAttribute("position",new Or(p,3)),this.setAttribute("normal",new Or(_,3)),this.setAttribute("uv",new Or(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Lw(e.width,e.height,e.widthSegments,e.heightSegments)}}class _4 extends ts{constructor(e=.5,t=1,r=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:a},r=Math.max(3,r),i=Math.max(1,i);const o=[],l=[],c=[],u=[];let f=e;const d=(t-e)/i,g=new ut,p=new an;for(let _=0;_<=i;_++){for(let y=0;y<=r;y++){const v=s+y/r*a;g.x=f*Math.cos(v),g.y=f*Math.sin(v),l.push(g.x,g.y,g.z),c.push(0,0,1),p.x=(g.x/t+1)/2,p.y=(g.y/t+1)/2,u.push(p.x,p.y)}f+=d}for(let _=0;_<i;_++){const y=_*(r+1);for(let v=0;v<r;v++){const x=v+y,E=x,M=x+r+1,O=x+r+2,N=x+1;o.push(E,M,N),o.push(M,O,N)}}this.setIndex(o),this.setAttribute("position",new Or(l,3)),this.setAttribute("normal",new Or(c,3)),this.setAttribute("uv",new Or(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new _4(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class v4 extends ts{constructor(e=new iE([new an(0,.5),new an(-.5,-.5),new an(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],i=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(o,l,u),o+=l,l=0;this.setIndex(r),this.setAttribute("position",new Or(i,3)),this.setAttribute("normal",new Or(s,3)),this.setAttribute("uv",new Or(a,2));function c(u){const f=i.length/3,d=u.extractPoints(t);let g=d.shape;const p=d.holes;E_.isClockWise(g)===!1&&(g=g.reverse());for(let y=0,v=p.length;y<v;y++){const x=p[y];E_.isClockWise(x)===!0&&(p[y]=x.reverse())}const _=E_.triangulateShape(g,p);for(let y=0,v=p.length;y<v;y++){const x=p[y];g=g.concat(x)}for(let y=0,v=g.length;y<v;y++){const x=g[y];i.push(x.x,x.y,0),s.push(0,0,1),a.push(x.x,x.y)}for(let y=0,v=_.length;y<v;y++){const x=_[y],E=x[0]+f,M=x[1]+f,O=x[2]+f;r.push(E,M,O),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return Hxe(t,e)}static fromJSON(e,t){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];r.push(a)}return new v4(r,e.curveSegments)}}function Hxe(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,r=n.length;t<r;t++){const i=n[t];e.shapes.push(i.uuid)}else e.shapes.push(n.uuid);return e}class nO extends ts{constructor(e=1,t=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),r=Math.max(2,Math.floor(r));const l=Math.min(a+o,Math.PI);let c=0;const u=[],f=new ut,d=new ut,g=[],p=[],_=[],y=[];for(let v=0;v<=r;v++){const x=[],E=v/r;let M=0;v===0&&a===0?M=.5/t:v===r&&l===Math.PI&&(M=-.5/t);for(let O=0;O<=t;O++){const N=O/t;f.x=-e*Math.cos(i+N*s)*Math.sin(a+E*o),f.y=e*Math.cos(a+E*o),f.z=e*Math.sin(i+N*s)*Math.sin(a+E*o),p.push(f.x,f.y,f.z),d.copy(f).normalize(),_.push(d.x,d.y,d.z),y.push(N+M,1-E),x.push(c++)}u.push(x)}for(let v=0;v<r;v++)for(let x=0;x<t;x++){const E=u[v][x+1],M=u[v][x],O=u[v+1][x],N=u[v+1][x+1];(v!==0||a>0)&&g.push(E,M,N),(v!==r-1||l<Math.PI)&&g.push(M,O,N)}this.setIndex(g),this.setAttribute("position",new Or(p,3)),this.setAttribute("normal",new Or(_,3)),this.setAttribute("uv",new Or(y,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new nO(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class y4 extends z1{constructor(e=1,t=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new y4(e.radius,e.detail)}}class b4 extends ts{constructor(e=1,t=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],l=[],c=[],u=new ut,f=new ut,d=new ut;for(let g=0;g<=r;g++)for(let p=0;p<=i;p++){const _=p/i*s,y=g/r*Math.PI*2;f.x=(e+t*Math.cos(y))*Math.cos(_),f.y=(e+t*Math.cos(y))*Math.sin(_),f.z=t*Math.sin(y),o.push(f.x,f.y,f.z),u.x=e*Math.cos(_),u.y=e*Math.sin(_),d.subVectors(f,u).normalize(),l.push(d.x,d.y,d.z),c.push(p/i),c.push(g/r)}for(let g=1;g<=r;g++)for(let p=1;p<=i;p++){const _=(i+1)*g+p-1,y=(i+1)*(g-1)+p-1,v=(i+1)*(g-1)+p,x=(i+1)*g+p;a.push(_,y,x),a.push(y,v,x)}this.setIndex(a),this.setAttribute("position",new Or(o,3)),this.setAttribute("normal",new Or(l,3)),this.setAttribute("uv",new Or(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new b4(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class S4 extends ts{constructor(e=1,t=.4,r=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:r,radialSegments:i,p:s,q:a},r=Math.floor(r),i=Math.floor(i);const o=[],l=[],c=[],u=[],f=new ut,d=new ut,g=new ut,p=new ut,_=new ut,y=new ut,v=new ut;for(let E=0;E<=r;++E){const M=E/r*s*Math.PI*2;x(M,s,a,e,g),x(M+.01,s,a,e,p),y.subVectors(p,g),v.addVectors(p,g),_.crossVectors(y,v),v.crossVectors(_,y),_.normalize(),v.normalize();for(let O=0;O<=i;++O){const N=O/i*Math.PI*2,I=-t*Math.cos(N),D=t*Math.sin(N);f.x=g.x+(I*v.x+D*_.x),f.y=g.y+(I*v.y+D*_.y),f.z=g.z+(I*v.z+D*_.z),l.push(f.x,f.y,f.z),d.subVectors(f,g).normalize(),c.push(d.x,d.y,d.z),u.push(E/r),u.push(O/i)}}for(let E=1;E<=r;E++)for(let M=1;M<=i;M++){const O=(i+1)*(E-1)+(M-1),N=(i+1)*E+(M-1),I=(i+1)*E+M,D=(i+1)*(E-1)+M;o.push(O,N,D),o.push(N,I,D)}this.setIndex(o),this.setAttribute("position",new Or(l,3)),this.setAttribute("normal",new Or(c,3)),this.setAttribute("uv",new Or(u,2));function x(E,M,O,N,I){const D=Math.cos(E),V=Math.sin(E),G=O/M*E,Q=Math.cos(G);I.x=N*(2+Q)*.5*D,I.y=N*(2+Q)*V*.5,I.z=N*Math.sin(G)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new S4(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class E4 extends ts{constructor(e=new Nz(new ut(-1,-1,0),new ut(-1,1,0),new ut(1,1,0)),t=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:r,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new ut,l=new ut,c=new an;let u=new ut;const f=[],d=[],g=[],p=[];_(),this.setIndex(p),this.setAttribute("position",new Or(f,3)),this.setAttribute("normal",new Or(d,3)),this.setAttribute("uv",new Or(g,2));function _(){for(let E=0;E<t;E++)y(E);y(s===!1?t:0),x(),v()}function y(E){u=e.getPointAt(E/t,u);const M=a.normals[E],O=a.binormals[E];for(let N=0;N<=i;N++){const I=N/i*Math.PI*2,D=Math.sin(I),V=-Math.cos(I);l.x=V*M.x+D*O.x,l.y=V*M.y+D*O.y,l.z=V*M.z+D*O.z,l.normalize(),d.push(l.x,l.y,l.z),o.x=u.x+r*l.x,o.y=u.y+r*l.y,o.z=u.z+r*l.z,f.push(o.x,o.y,o.z)}}function v(){for(let E=1;E<=t;E++)for(let M=1;M<=i;M++){const O=(i+1)*(E-1)+(M-1),N=(i+1)*E+(M-1),I=(i+1)*E+M,D=(i+1)*(E-1)+M;p.push(O,N,D),p.push(N,I,D)}}function x(){for(let E=0;E<=t;E++)for(let M=0;M<=i;M++)c.x=E/t,c.y=M/i,g.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new E4(new oD[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class zae extends ts{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],r=new Set,i=new ut,s=new ut;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const f=l[c],d=f.start,g=f.count;for(let p=d,_=d+g;p<_;p+=3)for(let y=0;y<3;y++){const v=o.getX(p+y),x=o.getX(p+(y+1)%3);i.fromBufferAttribute(a,v),s.fromBufferAttribute(a,x),q$(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const u=3*o+c,f=3*o+(c+1)%3;i.fromBufferAttribute(a,u),s.fromBufferAttribute(a,f),q$(i,s,r)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new Or(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function q$(n,e,t){const r=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(r)===!0||t.has(i)===!0?!1:(t.add(r),t.add(i),!0)}var V$=Object.freeze({__proto__:null,BoxGeometry:$E,CapsuleGeometry:u4,CircleGeometry:f4,ConeGeometry:eO,CylinderGeometry:Jk,DodecahedronGeometry:h4,EdgesGeometry:kae,ExtrudeGeometry:p4,IcosahedronGeometry:m4,LatheGeometry:g4,OctahedronGeometry:tO,PlaneGeometry:Lw,PolyhedronGeometry:z1,RingGeometry:_4,ShapeGeometry:v4,SphereGeometry:nO,TetrahedronGeometry:y4,TorusGeometry:b4,TorusKnotGeometry:S4,TubeGeometry:E4,WireframeGeometry:zae});class jae extends nh{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new cr(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Hae extends jl{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class Dz extends nh{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new cr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Um,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class qae extends Dz{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new an(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Gi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new cr(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new cr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new cr(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class Vae extends nh{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new cr(16777215),this.specular=new cr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Um,this.combine=Wk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Gae extends nh{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new cr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class $ae extends nh{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class Wae extends nh{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new cr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Um,this.combine=Wk,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Lz extends nh{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=U1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class Uz extends nh{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class Yae extends nh{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new cr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=B1,this.normalScale=new an(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Xae extends Vp{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function XS(n,e){return!n||n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function Kae(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function Zae(n){function e(i,s){return n[i]-n[s]}const t=n.length,r=new Array(t);for(let i=0;i!==t;++i)r[i]=i;return r.sort(e),r}function ZF(n,e,t){const r=n.length,i=new n.constructor(r);for(let s=0,a=0;a!==r;++s){const o=t[s]*e;for(let l=0;l!==e;++l)i[a++]=n[o+l]}return i}function Bz(n,e,t,r){let i=1,s=n[0];for(;s!==void 0&&s[r]===void 0;)s=n[i++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(e.push(s.time),t.push(...a)),s=n[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=n[i++];while(s!==void 0);else do a=s[r],a!==void 0&&(e.push(s.time),t.push(a)),s=n[i++];while(s!==void 0)}function qxe(n,e,t,r,i=30){const s=n.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),f=[],d=[];for(let g=0;g<c.times.length;++g){const p=c.times[g]*i;if(!(p<t||p>=r)){f.push(c.times[g]);for(let _=0;_<u;++_)d.push(c.values[g*u+_])}}f.length!==0&&(c.times=XS(f,c.times.constructor),c.values=XS(d,c.values.constructor),a.push(c))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function Vxe(n,e=0,t=n,r=30){r<=0&&(r=30);const i=t.tracks.length,s=e/r;for(let a=0;a<i;++a){const o=t.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=n.tracks.find(function(v){return v.name===o.name&&v.ValueTypeName===l});if(c===void 0)continue;let u=0;const f=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=f/3);let d=0;const g=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=g/3);const p=o.times.length-1;let _;if(s<=o.times[0]){const v=u,x=f-u;_=o.values.slice(v,x)}else if(s>=o.times[p]){const v=p*f+u,x=v+f-u;_=o.values.slice(v,x)}else{const v=o.createInterpolant(),x=u,E=f-u;v.evaluate(s),_=v.resultBuffer.slice(x,E)}l==="quaternion"&&new jp().fromArray(_).normalize().conjugate().toArray(_);const y=c.times.length;for(let v=0;v<y;++v){const x=v*g+d;if(l==="quaternion")jp.multiplyQuaternionsFlat(c.values,x,_,0,c.values,x);else{const E=g-d*2;for(let M=0;M<E;++M)c.values[x+M]-=_[M]}}}return n.blendMode=Sz,n}class Gxe{static convertArray(e,t){return XS(e,t)}static isTypedArray(e){return Kae(e)}static getKeyframeOrder(e){return Zae(e)}static sortedArray(e,t,r){return ZF(e,t,r)}static flattenJSON(e,t,r,i){Bz(e,t,r,i)}static subclip(e,t,r,i,s=30){return qxe(e,t,r,i,s)}static makeClipAdditive(e,t=0,r=e,i=30){return Vxe(e,t,r,i)}}class rO{constructor(e,t,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(r),this.sampleValues=t,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let r=this._cachedIndex,i=t[r],s=t[r-1];e:{t:{let a;n:{r:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<s)break r;return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(s=i,i=t[++r],e<i)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(r=2,s=o);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=t[--r-1],e>=s)break t}a=r,r=0;break n}break e}for(;r<a;){const o=r+a>>>1;e<t[o]?a=o:r=o+1}if(i=t[r],s=t[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=t.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=r[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Qae extends rO{constructor(e,t,r,i){super(e,t,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:$S,endingEnd:$S}}intervalChanged_(e,t,r){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],l=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case WS:s=e,o=2*t-r;break;case L2:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=r}if(l===void 0)switch(this.getSettings_().endingEnd){case WS:a=e,l=2*r-t;break;case L2:a=1,l=r+i[1]-i[0];break;default:a=e-1,l=t}const c=(r-t)*.5,u=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=this._offsetPrev,f=this._offsetNext,d=this._weightPrev,g=this._weightNext,p=(r-t)/(i-t),_=p*p,y=_*p,v=-d*y+2*d*_-d*p,x=(1+d)*y+(-1.5-2*d)*_+(-.5+d)*p+1,E=(-1-g)*y+(1.5+g)*_+.5*p,M=g*y-g*_;for(let O=0;O!==o;++O)s[O]=v*a[u+O]+x*a[c+O]+E*a[l+O]+M*a[f+O];return s}}class Fz extends rO{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=(r-t)/(i-t),f=1-u;for(let d=0;d!==o;++d)s[d]=a[c+d]*f+a[l+d]*u;return s}}class Jae extends rO{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class V0{constructor(e,t,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=XS(t,this.TimeBufferType),this.values=XS(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let r;if(t.toJSON!==this.toJSON)r=t.toJSON(e);else{r={name:e.name,times:XS(e.times,Array),values:XS(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Jae(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new Fz(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Qae(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case D2:t=this.InterpolantFactoryMethodDiscrete;break;case iD:t=this.InterpolantFactoryMethodLinear;break;case AN:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return D2;case this.InterpolantFactoryMethodLinear:return iD;case this.InterpolantFactoryMethodSmooth:return AN}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let r=0,i=t.length;r!==i;++r)t[r]*=e}return this}trim(e,t){const r=this.times,i=r.length;let s=0,a=i-1;for(;s!==i&&r[s]<e;)++s;for(;a!==-1&&r[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=r[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(i!==void 0&&Kae(i))for(let o=0,l=i.length;o!==l;++o){const c=i[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===AN,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const c=e[o],u=e[o+1];if(c!==u&&(o!==1||c!==e[0]))if(i)l=!0;else{const f=o*r,d=f-r,g=f+r;for(let p=0;p!==r;++p){const _=t[f+p];if(_!==t[d+p]||_!==t[g+p]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const f=o*r,d=a*r;for(let g=0;g!==r;++g)t[d+g]=t[f+g]}++a}}if(s>0){e[a]=e[s];for(let o=s*r,l=a*r,c=0;c!==r;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*r)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),r=this.constructor,i=new r(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}V0.prototype.ValueTypeName="";V0.prototype.TimeBufferType=Float32Array;V0.prototype.ValueBufferType=Float32Array;V0.prototype.DefaultInterpolation=iD;class WE extends V0{constructor(e,t,r){super(e,t,r)}}WE.prototype.ValueTypeName="bool";WE.prototype.ValueBufferType=Array;WE.prototype.DefaultInterpolation=D2;WE.prototype.InterpolantFactoryMethodLinear=void 0;WE.prototype.InterpolantFactoryMethodSmooth=void 0;class zz extends V0{constructor(e,t,r,i){super(e,t,r,i)}}zz.prototype.ValueTypeName="color";class V2 extends V0{constructor(e,t,r,i){super(e,t,r,i)}}V2.prototype.ValueTypeName="number";class eoe extends rO{constructor(e,t,r,i){super(e,t,r,i)}interpolate_(e,t,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(r-t)/(i-t);let c=e*o;for(let u=c+o;c!==u;c+=4)jp.slerpFlat(s,0,a,c-o,a,c,l);return s}}class iO extends V0{constructor(e,t,r,i){super(e,t,r,i)}InterpolantFactoryMethodLinear(e){return new eoe(this.times,this.values,this.getValueSize(),e)}}iO.prototype.ValueTypeName="quaternion";iO.prototype.InterpolantFactoryMethodSmooth=void 0;class YE extends V0{constructor(e,t,r){super(e,t,r)}}YE.prototype.ValueTypeName="string";YE.prototype.ValueBufferType=Array;YE.prototype.DefaultInterpolation=D2;YE.prototype.InterpolantFactoryMethodLinear=void 0;YE.prototype.InterpolantFactoryMethodSmooth=void 0;class G2 extends V0{constructor(e,t,r,i){super(e,t,r,i)}}G2.prototype.ValueTypeName="vector";class $2{constructor(e="",t=-1,r=[],i=t4){this.name=e,this.tracks=r,this.duration=t,this.blendMode=i,this.uuid=Dg(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)t.push(Wxe(r[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=r.length;s!==a;++s)t.push(V0.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,t,r,i){const s=t.length,a=[];for(let o=0;o<s;o++){let l=[],c=[];l.push((o+s-1)%s,o,(o+1)%s),c.push(0,1,0);const u=Zae(l);l=ZF(l,1,u),c=ZF(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),a.push(new V2(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/r))}return new this(e,-1,a)}static findByName(e,t){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===t)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,t,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],u=c.name.match(s);if(u&&u.length>1){const f=u[1];let d=i[f];d||(i[f]=d=[]),d.push(c)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,r));return a}static parseAnimation(e,t){if(console.warn("THREE.AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(f,d,g,p,_){if(g.length!==0){const y=[],v=[];Bz(g,y,v,p),y.length!==0&&_.push(new f(d,y,v))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let f=0;f<c.length;f++){const d=c[f].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const g={};let p;for(p=0;p<d.length;p++)if(d[p].morphTargets)for(let _=0;_<d[p].morphTargets.length;_++)g[d[p].morphTargets[_]]=-1;for(const _ in g){const y=[],v=[];for(let x=0;x!==d[p].morphTargets.length;++x){const E=d[p];y.push(E.time),v.push(E.morphTarget===_?1:0)}i.push(new V2(".morphTargetInfluence["+_+"]",y,v))}l=g.length*a}else{const g=".bones["+t[f].name+"]";r(G2,g+".position",d,"pos",i),r(iO,g+".quaternion",d,"rot",i),r(G2,g+".scale",d,"scl",i)}}return i.length===0?null:new this(s,l,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function $xe(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return V2;case"vector":case"vector2":case"vector3":case"vector4":return G2;case"color":return zz;case"quaternion":return iO;case"bool":case"boolean":return WE;case"string":return YE}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function Wxe(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=$xe(n.type);if(n.times===void 0){const t=[],r=[];Bz(n.keys,t,r,"value"),n.times=t,n.values=r}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const Hy={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class jz{constructor(e,t,r){const i=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=r,this.itemStart=function(u){o++,s===!1&&i.onStart!==void 0&&i.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,i.onProgress!==void 0&&i.onProgress(u,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,f){return c.push(u,f),this},this.removeHandler=function(u){const f=c.indexOf(u);return f!==-1&&c.splice(f,2),this},this.getHandler=function(u){for(let f=0,d=c.length;f<d;f+=2){const g=c[f],p=c[f+1];if(g.global&&(g.lastIndex=0),g.test(u))return p}return null}}}const toe=new jz;class Wm{constructor(e){this.manager=e!==void 0?e:toe,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const r=this;return new Promise(function(i,s){r.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Wm.DEFAULT_MATERIAL_NAME="__DEFAULT";const py={};class Yxe extends Error{constructor(e,t){super(e),this.response=t}}class ib extends Wm{constructor(e){super(e),this.mimeType="",this.responseType=""}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=Hy.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(py[e]!==void 0){py[e].push({onLoad:t,onProgress:r,onError:i});return}py[e]=[],py[e].push({onLoad:t,onProgress:r,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=py[e],f=c.body.getReader(),d=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),g=d?parseInt(d):0,p=g!==0;let _=0;const y=new ReadableStream({start(v){x();function x(){f.read().then(({done:E,value:M})=>{if(E)v.close();else{_+=M.byteLength;const O=new ProgressEvent("progress",{lengthComputable:p,loaded:_,total:g});for(let N=0,I=u.length;N<I;N++){const D=u[N];D.onProgress&&D.onProgress(O)}v.enqueue(M),x()}},E=>{v.error(E)})}}});return new Response(y)}else throw new Yxe(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return c.json();default:if(o==="")return c.text();{const f=/charset="?([^;"\s]*)"?/i.exec(o),d=f&&f[1]?f[1].toLowerCase():void 0,g=new TextDecoder(d);return c.arrayBuffer().then(p=>g.decode(p))}}}).then(c=>{Hy.add(e,c);const u=py[e];delete py[e];for(let f=0,d=u.length;f<d;f++){const g=u[f];g.onLoad&&g.onLoad(c)}}).catch(c=>{const u=py[e];if(u===void 0)throw this.manager.itemError(e),c;delete py[e];for(let f=0,d=u.length;f<d;f++){const g=u[f];g.onError&&g.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class Xxe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new ib(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=[];for(let r=0;r<e.length;r++){const i=$2.parse(e[r]);t.push(i)}return t}}class Kxe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=[],o=new c4,l=new ib(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(f){l.load(e[f],function(d){const g=s.parse(d,!0);a[f]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},c+=1,c===6&&(g.mipmapCount===1&&(o.minFilter=nc),o.image=a,o.format=g.format,o.needsUpdate=!0,t&&t(o))},r,i)}if(Array.isArray(e))for(let f=0,d=e.length;f<d;++f)u(f);else l.load(e,function(f){const d=s.parse(f,!0);if(d.isCubemap){const g=d.mipmaps.length/d.mipmapCount;for(let p=0;p<g;p++){a[p]={mipmaps:[]};for(let _=0;_<d.mipmapCount;_++)a[p].mipmaps.push(d.mipmaps[p*d.mipmapCount+_]),a[p].format=d.format,a[p].width=d.width,a[p].height=d.height}o.image=a}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=nc),o.format=d.format,o.needsUpdate=!0,t&&t(o)},r,i);return o}}class W2 extends Wm{constructor(e){super(e)}load(e,t,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Hy.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o=z2("img");function l(){u(),Hy.add(e,this),t&&t(this),s.manager.itemEnd(e)}function c(f){u(),i&&i(f),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class Zxe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=new Qk;s.colorSpace=ta;const a=new W2(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(u){s.images[c]=u,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class Qxe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new Lg,o=new ib(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:M0,a.wrapT=c.wrapT!==void 0?c.wrapT:M0,a.magFilter=c.magFilter!==void 0?c.magFilter:nc,a.minFilter=c.minFilter!==void 0?c.minFilter:nc,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=Tv),c.mipmapCount===1&&(a.minFilter=nc),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,t&&t(a,c)},r,i),a}}class noe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=new xc,a=new W2(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},r,i),s}}class j1 extends za{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new cr(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(t.object.target=this.target.uuid),t}}class roe extends j1{constructor(e,t,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(za.DEFAULT_UP),this.updateMatrix(),this.groundColor=new cr(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const h6=new Qr,G$=new ut,$$=new ut;class Hz{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new an(512,512),this.mapType=zl,this.map=null,this.mapPass=null,this.matrix=new Qr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Pw,this._frameExtents=new an(1,1),this._viewportCount=1,this._viewports=[new xa(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,r=this.matrix;G$.setFromMatrixPosition(e.matrixWorld),t.position.copy(G$),$$.setFromMatrixPosition(e.target.matrixWorld),t.lookAt($$),t.updateMatrixWorld(),h6.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(h6),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(h6)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Jxe extends Hz{constructor(){super(new vf(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,r=jT*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(r!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=r,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class ioe extends j1{constructor(e,t,r=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(za.DEFAULT_UP),this.updateMatrix(),this.target=new za,this.distance=r,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new Jxe}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const W$=new Qr,LR=new ut,d6=new ut;class eTe extends Hz{constructor(){super(new vf(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new an(4,2),this._viewportCount=6,this._viewports=[new xa(2,1,1,1),new xa(0,1,1,1),new xa(3,1,1,1),new xa(1,1,1,1),new xa(3,0,1,1),new xa(1,0,1,1)],this._cubeDirections=[new ut(1,0,0),new ut(-1,0,0),new ut(0,0,1),new ut(0,0,-1),new ut(0,1,0),new ut(0,-1,0)],this._cubeUps=[new ut(0,1,0),new ut(0,1,0),new ut(0,1,0),new ut(0,1,0),new ut(0,0,1),new ut(0,0,-1)]}updateMatrices(e,t=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),LR.setFromMatrixPosition(e.matrixWorld),r.position.copy(LR),d6.copy(r.position),d6.add(this._cubeDirections[t]),r.up.copy(this._cubeUps[t]),r.lookAt(d6),r.updateMatrixWorld(),i.makeTranslation(-LR.x,-LR.y,-LR.z),W$.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(W$)}}class soe extends j1{constructor(e,t,r=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new eTe}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}let sO=class extends Zk{constructor(e=-1,t=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}};class tTe extends Hz{constructor(){super(new sO(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class aoe extends j1{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(za.DEFAULT_UP),this.updateMatrix(),this.target=new za,this.shadow=new tTe}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class ooe extends j1{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class loe extends j1{constructor(e,t,r=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class coe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ut)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*r),t.addScaledVector(a[4],1.092548*(r*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(r*s)),t.addScaledVector(a[8],.546274*(r*r-i*i)),t}getIrradianceAt(e,t){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*r),t.addScaledVector(a[4],2*.429043*r*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*r*s),t.addScaledVector(a[8],.429043*(r*r-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const r=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*r,t[4]=1.092548*r*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*r*s,t[8]=.546274*(r*r-i*i)}}class uoe extends j1{constructor(e=new coe,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class x4 extends Wm{constructor(e){super(e),this.textures={}}load(e,t,r,i){const s=this,a=new ib(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t=this.textures;function r(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new cr().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=r(a.value);break;case"c":i.uniforms[s].value=new cr().setHex(a.value);break;case"v2":i.uniforms[s].value=new an().fromArray(a.value);break;case"v3":i.uniforms[s].value=new ut().fromArray(a.value);break;case"v4":i.uniforms[s].value=new xa().fromArray(a.value);break;case"m3":i.uniforms[s].value=new Ji().fromArray(a.value);break;case"m4":i.uniforms[s].value=new Qr().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new an().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new an().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return x4.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:jae,SpriteMaterial:Rz,RawShaderMaterial:Hae,ShaderMaterial:jl,PointsMaterial:Cz,MeshPhysicalMaterial:qae,MeshStandardMaterial:Dz,MeshPhongMaterial:Vae,MeshToonMaterial:Gae,MeshNormalMaterial:$ae,MeshLambertMaterial:Wae,MeshDepthMaterial:Lz,MeshDistanceMaterial:Uz,MeshBasicMaterial:F1,MeshMatcapMaterial:Yae,LineDashedMaterial:Xae,LineBasicMaterial:Vp,Material:nh};return new t[e]}}class QF{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class foe extends ts{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class hoe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new ib(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const t={},r={};function i(g,p){if(t[p]!==void 0)return t[p];const y=g.interleavedBuffers[p],v=s(g,y.buffer),x=dT(y.type,v),E=new a4(x,y.stride);return E.uuid=y.uuid,t[p]=E,E}function s(g,p){if(r[p]!==void 0)return r[p];const y=g.arrayBuffers[p],v=new Uint32Array(y).buffer;return r[p]=v,v}const a=e.isInstancedBufferGeometry?new foe:new ts,o=e.data.index;if(o!==void 0){const g=dT(o.type,o.array);a.setIndex(new Ps(g,1))}const l=e.data.attributes;for(const g in l){const p=l[g];let _;if(p.isInterleavedBufferAttribute){const y=i(e.data,p.data);_=new vE(y,p.itemSize,p.offset,p.normalized)}else{const y=dT(p.type,p.array),v=p.isInstancedBufferAttribute?GT:Ps;_=new v(y,p.itemSize,p.normalized)}p.name!==void 0&&(_.name=p.name),p.usage!==void 0&&_.setUsage(p.usage),a.setAttribute(g,_)}const c=e.data.morphAttributes;if(c)for(const g in c){const p=c[g],_=[];for(let y=0,v=p.length;y<v;y++){const x=p[y];let E;if(x.isInterleavedBufferAttribute){const M=i(e.data,x.data);E=new vE(M,x.itemSize,x.offset,x.normalized)}else{const M=dT(x.type,x.array);E=new Ps(M,x.itemSize,x.normalized)}x.name!==void 0&&(E.name=x.name),_.push(E)}a.morphAttributes[g]=_}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const f=e.data.groups||e.data.drawcalls||e.data.offsets;if(f!==void 0)for(let g=0,p=f.length;g!==p;++g){const _=f[g];a.addGroup(_.start,_.count,_.materialIndex)}const d=e.data.boundingSphere;if(d!==void 0){const g=new ut;d.center!==void 0&&g.fromArray(d.center),a.boundingSphere=new xd(g,d.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class nTe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=this.path===""?QF.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new ib(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(f){i!==void 0&&i(f),console.error("THREE:ObjectLoader: Can't parse "+e+".",f.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,t)},r,i)}async loadAsync(e,t){const r=this,i=this.path===""?QF.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new ib(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(o)}parse(e,t){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),this.bindLightTargets(c),t!==void 0){let f=!1;for(const d in a)if(a[d].data instanceof HTMLImageElement){f=!0;break}f===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,o,a,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new iE().fromJSON(e[r]);t[s.uuid]=s}return t}parseSkeletons(e,t){const r={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new o4().fromJSON(e[s],i);r[o.uuid]=o}return r}parseGeometries(e,t){const r={};if(e!==void 0){const i=new hoe;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(l);break;default:l.type in V$?o=V$[l.type].fromJSON(l,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),r[l.uuid]=o}}return r}parseMaterials(e,t){const r={},i={};if(e!==void 0){const s=new x4;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const l=e[a];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=$2.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const r=this,i={};let s;function a(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return a(u)}else return l.data?{data:dT(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new jz(t);s=new W2(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const f=e[c],d=f.url;if(Array.isArray(d)){const g=[];for(let p=0,_=d.length;p<_;p++){const y=d[p],v=o(y);v!==null&&(v instanceof HTMLImageElement?g.push(v):g.push(new Lg(v.data,v.width,v.height)))}i[f.uuid]=new c1(g)}else{const g=o(f.url);i[f.uuid]=new c1(g)}}}return i}async parseImagesAsync(e){const t=this,r={};let i;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await i.loadAsync(l)}else return a.data?{data:dT(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new W2(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const u=[];for(let f=0,d=c.length;f<d;f++){const g=c[f],p=await s(g);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new Lg(p.data,p.width,p.height)))}r[l.uuid]=new c1(u)}else{const u=await s(l.url);r[l.uuid]=new c1(u)}}}return r}parseTextures(e,t){function r(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const l=t[o.image],c=l.data;let u;Array.isArray(c)?(u=new Qk,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new Lg:u=new xc,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=r(o.mapping,rTe)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=r(o.wrap[0],Y$),u.wrapT=r(o.wrap[1],Y$)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.minFilter!==void 0&&(u.minFilter=r(o.minFilter,X$)),o.magFilter!==void 0&&(u.magFilter=r(o.magFilter,X$)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),i[o.uuid]=u}return i}parseObject(e,t,r,i,s){let a;function o(d){return t[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",d),t[d]}function l(d){if(d!==void 0){if(Array.isArray(d)){const g=[];for(let p=0,_=d.length;p<_;p++){const y=d[p];r[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),g.push(r[y])}return g}return r[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",d),r[d]}}function c(d){return i[d]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",d),i[d]}let u,f;switch(e.type){case"Scene":a=new VT,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new cr(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new s4(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new i4(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new vf(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new sO(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new ooe(e.color,e.intensity);break;case"DirectionalLight":a=new aoe(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new soe(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new loe(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new ioe(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new roe(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new uoe().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),f=l(e.material),a=new xae(u,f),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),f=l(e.material),a=new vu(u,f);break;case"InstancedMesh":u=o(e.geometry),f=l(e.material);const d=e.count,g=e.instanceMatrix,p=e.instanceColor;a=new Tae(u,f,d),a.instanceMatrix=new GT(new Float32Array(g.array),16),p!==void 0&&(a.instanceColor=new GT(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),f=l(e.material),a=new wae(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,f),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(_=>{let y=null,v=null;return _.boundingBox!==void 0&&(y=new Qd,y.min.fromArray(_.boundingBox.min),y.max.fromArray(_.boundingBox.max)),_.boundingSphere!==void 0&&(v=new xd,v.radius=_.boundingSphere.radius,v.center.fromArray(_.boundingSphere.center)),{..._,boundingBox:y,boundingSphere:v}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new xd,a.boundingSphere.center.fromArray(e.boundingSphere.center),a.boundingSphere.radius=e.boundingSphere.radius),e.boundingBox!==void 0&&(a.boundingBox=new Qd,a.boundingBox.min.fromArray(e.boundingBox.min),a.boundingBox.max.fromArray(e.boundingBox.max));break;case"LOD":a=new Eae;break;case"Line":a=new x1(o(e.geometry),l(e.material));break;case"LineLoop":a=new Rae(o(e.geometry),l(e.material));break;case"LineSegments":a=new Wv(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new Aae(o(e.geometry),l(e.material));break;case"Sprite":a=new Sae(l(e.material));break;case"Group":a=new YS;break;case"Bone":a=new Az;break;default:a=new za}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const d=e.children;for(let g=0;g<d.length;g++)a.add(this.parseObject(d[g],t,r,i,s))}if(e.animations!==void 0){const d=e.animations;for(let g=0;g<d.length;g++){const p=d[g];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const d=e.levels;for(let g=0;g<d.length;g++){const p=d[g],_=a.getObjectByProperty("uuid",p.object);_!==void 0&&a.addLevel(_,p.distance,p.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=t[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const r=t.target,i=e.getObjectByProperty("uuid",r);i!==void 0?t.target=i:t.target=new za}})}}const rTe={UVMapping:XL,CubeReflectionMapping:rb,CubeRefractionMapping:E1,EquirectangularReflectionMapping:I2,EquirectangularRefractionMapping:N2,CubeUVReflectionMapping:Ow},Y$={RepeatWrapping:BT,ClampToEdgeWrapping:M0,MirroredRepeatWrapping:P2},X$={NearestFilter:bf,NearestMipmapNearestFilter:pz,NearestMipmapLinearFilter:hT,LinearFilter:nc,LinearMipmapNearestFilter:c2,LinearMipmapLinearFilter:Tv};class iTe extends Wm{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=Hy.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(c=>{t&&t(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return Hy.add(e,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),Hy.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});Hy.add(e,l),s.manager.itemStart(e)}}let fI,qz=class{static getContext(){return fI===void 0&&(fI=new(window.AudioContext||window.webkitAudioContext)),fI}static setContext(e){fI=e}};class sTe extends Wm{constructor(e){super(e)}load(e,t,r,i){const s=this,a=new ib(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);qz.getContext().decodeAudioData(c,function(f){t(f)}).catch(o)}catch(c){o(c)}},r,i);function o(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const K$=new Qr,Z$=new Qr,cS=new Qr;class aTe{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new vf,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new vf,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,cS.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(rE*t.fov*.5)/t.zoom;let o,l;Z$.elements[12]=-i,K$.elements[12]=i,o=-a*t.aspect+s,l=a*t.aspect+s,cS.elements[0]=2*t.near/(l-o),cS.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(cS),o=-a*t.aspect-s,l=a*t.aspect-s,cS.elements[0]=2*t.near/(l-o),cS.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(cS)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Z$),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(K$)}}class doe extends vf{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}let Vz=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Q$(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Q$();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}};function Q$(){return performance.now()}const uS=new ut,J$=new jp,oTe=new ut,fS=new ut;class lTe extends za{constructor(){super(),this.type="AudioListener",this.context=qz.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Vz}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(uS,J$,oTe),fS.set(0,0,-1).applyQuaternion(J$),t.positionX){const i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(uS.x,i),t.positionY.linearRampToValueAtTime(uS.y,i),t.positionZ.linearRampToValueAtTime(uS.z,i),t.forwardX.linearRampToValueAtTime(fS.x,i),t.forwardY.linearRampToValueAtTime(fS.y,i),t.forwardZ.linearRampToValueAtTime(fS.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(uS.x,uS.y,uS.z),t.setOrientation(fS.x,fS.y,fS.z,r.x,r.y,r.z)}}class poe extends za{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(console.warn("THREE.Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const hS=new ut,eW=new jp,cTe=new ut,dS=new ut;class uTe extends poe{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(hS,eW,cTe),dS.set(0,0,1).applyQuaternion(eW);const t=this.panner;if(t.positionX){const r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(hS.x,r),t.positionY.linearRampToValueAtTime(hS.y,r),t.positionZ.linearRampToValueAtTime(hS.z,r),t.orientationX.linearRampToValueAtTime(dS.x,r),t.orientationY.linearRampToValueAtTime(dS.y,r),t.orientationZ.linearRampToValueAtTime(dS.z,r)}else t.setPosition(hS.x,hS.y,hS.z),t.setOrientation(dS.x,dS.y,dS.z)}}class fTe{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let r=0;r<t.length;r++)e+=t[r];return e/t.length}}class moe{constructor(e,t,r){this.binding=e,this.valueSize=r;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const r=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[s+o]=r[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(r,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,r=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(r,i,l,1-s,t)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(r[l]!==r[l+t]){o.setValue(r,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(t,i);for(let s=r,a=i;s!==a;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let r=e;r<t;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[t+r]=this.buffer[e+r]}_select(e,t,r,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[r+a]}_slerp(e,t,r,i){jp.slerpFlat(e,t,e,t,e,r,i)}_slerpAdditive(e,t,r,i,s){const a=this._workIndex*s;jp.multiplyQuaternionsFlat(e,a,e,t,e,r),jp.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,r,i,s){const a=1-i;for(let o=0;o!==s;++o){const l=t+o;e[l]=e[l]*a+e[r+o]*i}}_lerpAdditive(e,t,r,i,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[r+a]*i}}}const Gz="\\[\\]\\.:\\/",hTe=new RegExp("["+Gz+"]","g"),$z="[^"+Gz+"]",dTe="[^"+Gz.replace("\\.","")+"]",pTe=/((?:WC+[\/:])*)/.source.replace("WC",$z),mTe=/(WCOD+)?/.source.replace("WCOD",dTe),gTe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",$z),_Te=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",$z),vTe=new RegExp("^"+pTe+mTe+gTe+_Te+"$"),yTe=["material","materials","bones","map"];class bTe{constructor(e,t,r){const i=r||Ba.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,t)}setValue(e,t){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,r=e.length;t!==r;++t)e[t].unbind()}}class Ba{constructor(e,t,r){this.path=t,this.parsedPath=r||Ba.parseTrackName(t),this.node=Ba.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,r){return e&&e.isAnimationObjectGroup?new Ba.Composite(e,t,r):new Ba(e,t,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(hTe,"")}static parseTrackName(e){const t=vTe.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);yTe.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(t);if(r!==void 0)return r}if(e.children){const r=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const l=r(o.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[t++]=r[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,r=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=Ba.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=t.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[i];if(a===void 0){const c=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ba.Composite=bTe;Ba.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ba.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ba.prototype.GetterByBindingType=[Ba.prototype._getValue_direct,Ba.prototype._getValue_array,Ba.prototype._getValue_arrayElement,Ba.prototype._getValue_toArray];Ba.prototype.SetterByBindingTypeAndVersioning=[[Ba.prototype._setValue_direct,Ba.prototype._setValue_direct_setNeedsUpdate,Ba.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ba.prototype._setValue_array,Ba.prototype._setValue_array_setNeedsUpdate,Ba.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ba.prototype._setValue_arrayElement,Ba.prototype._setValue_arrayElement_setNeedsUpdate,Ba.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ba.prototype._setValue_fromArray,Ba.prototype._setValue_fromArray_setNeedsUpdate,Ba.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class STe{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Dg(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let u=0,f=arguments.length;u!==f;++u){const d=arguments[u],g=d.uuid;let p=t[g];if(p===void 0){p=l++,t[g]=p,e.push(d);for(let _=0,y=a;_!==y;++_)s[_].push(new Ba(d,r[_],i[_]))}else if(p<c){o=e[p];const _=--c,y=e[_];t[y.uuid]=p,e[p]=y,t[g]=_,e[_]=d;for(let v=0,x=a;v!==x;++v){const E=s[v],M=E[_];let O=E[p];E[p]=M,O===void 0&&(O=new Ba(d,r[v],i[v])),E[_]=O}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,u=t[c];if(u!==void 0&&u>=s){const f=s++,d=e[f];t[d.uuid]=u,e[u]=d,t[c]=f,e[f]=l;for(let g=0,p=i;g!==p;++g){const _=r[g],y=_[f],v=_[u];_[u]=y,_[f]=v}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],u=c.uuid,f=t[u];if(f!==void 0)if(delete t[u],f<s){const d=--s,g=e[d],p=--a,_=e[p];t[g.uuid]=f,e[f]=g,t[_.uuid]=d,e[d]=_,e.pop();for(let y=0,v=i;y!==v;++y){const x=r[y],E=x[d],M=x[p];x[f]=E,x[d]=M,x.pop()}}else{const d=--a,g=e[d];d>0&&(t[g.uuid]=f),e[f]=g,e.pop();for(let p=0,_=i;p!==_;++p){const y=r[p];y[f]=y[d],y.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,f=new Array(c);i=s.length,r[e]=i,a.push(e),o.push(t),s.push(f);for(let d=u,g=l.length;d!==g;++d){const p=l[d];f[d]=new Ba(p,e,t)}return f}unsubscribe_(e){const t=this._bindingsIndicesByPath,r=t[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=r,a[r]=l,a.pop(),s[r]=s[o],s.pop(),i[r]=i[o],i.pop()}}}class goe{constructor(e,t,r=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=r,this.blendMode=i;const s=t.tracks,a=s.length,o=new Array(a),l={endingStart:$S,endingEnd:$S};for(let c=0;c!==a;++c){const u=s[c].createInterpolant(null);o[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=eae,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,r=!1){if(e.fadeOut(t),this.fadeIn(t),r===!0){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,r=!1){return e.crossFadeFrom(this,t,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,r){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/a,c[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?t=0:(this._startTime=null,t=r*l)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case Sz:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(a),c[u].accumulateAdditive(o);break;case t4:default:for(let u=0,f=l.length;u!==f;++u)l[u].evaluate(a),c[u].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];t*=i,e>r.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const a=r===tae;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(r===Jse){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const o=Math.floor(i/t);i-=t*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,r){const i=this._interpolantSettings;r?(i.endingStart=WS,i.endingEnd=WS):(e?i.endingStart=this.zeroSlopeAtStart?WS:$S:i.endingStart=L2,t?i.endingEnd=this.zeroSlopeAtEnd?WS:$S:i.endingEnd=L2)}_scheduleFading(e,t,r){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=t,o[1]=s+e,l[1]=r,this}}const ETe=new Float32Array(1);class xTe extends Vg{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let f=0;f!==s;++f){const d=i[f],g=d.name;let p=u[g];if(p!==void 0)++p.referenceCount,a[f]=p;else{if(p=a[f],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,g));continue}const _=t&&t._propertyBindings[f].binding.parsedPath;p=new moe(Ba.create(r,g,_),d.ValueTypeName,d.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,g),a[f]=p}o[f].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,r){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){const t=this._actions,r=t[t.length-1],i=e._cacheIndex;r._cacheIndex=i,t[i]=r,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const f=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete f[d],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let r=0,i=t.length;r!==i;++r){const s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackAction(e){const t=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_addInactiveBinding(e,t,r){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,o=a[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_takeBackBinding(e){const t=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=r,t[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let r=e[t];return r===void 0&&(r=new Fz(new Float32Array(2),new Float32Array(2),1,ETe),r.__cacheIndex=t,e[t]=r),r}_takeBackControlInterpolant(e){const t=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=r,t[r]=s}clipAction(e,t,r){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?$2.findByName(i,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(r===void 0&&(a!==null?r=a.blendMode:r=t4),l!==void 0){const f=l.actionByRoot[s];if(f!==void 0&&f.blendMode===r)return f;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const u=new goe(this,a,t,r);return this._bindAction(u,c),this._addInactiveAction(u,o,s),u}existingAction(e,t){const r=t||this._root,i=r.uuid,s=typeof e=="string"?$2.findByName(r,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let r=t-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const t=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==r;++c)t[c]._update(i,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const u=c._cacheIndex,f=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,f._cacheIndex=u,t[u]=f,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const t=e.uuid,r=this._actionsByClip;for(const a in r){const o=r[a].actionByRoot,l=o[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const r=this.existingAction(e,t);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class TTe extends n4{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=r,this.texture=new r4(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class wTe extends n4{constructor(e=1,t=1,r=1,i={}){super(e,t,i),this.isRenderTargetArray=!0,this.depth=r,this.texture=new Kk(null,e,t,r),this.texture.isRenderTargetTexture=!0}}class jn{constructor(e){this.value=e}clone(){return new jn(this.value.clone===void 0?this.value:this.value.clone())}}let RTe=0;class ATe extends Vg{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:RTe++}),this.name="",this.usage=B2,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let r=0,i=t.length;r<i;r++){const s=Array.isArray(t[r])?t[r]:[t[r]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class CTe extends a4{constructor(e,t,r=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class MTe{constructor(e,t,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const tW=new Qr;class Wz{constructor(e,t,r=0,i=1/0){this.ray=new Nw(e,t),this.near=r,this.far=i,this.camera=null,this.layers=new HT,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return tW.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(tW),this}intersectObject(e,t=!0,r=[]){return JF(e,this,r,t),r.sort(nW),r}intersectObjects(e,t=!0,r=[]){for(let i=0,s=e.length;i<s;i++)JF(e[i],this,r,t);return r.sort(nW),r}}function nW(n,e){return n.distance-e.distance}function JF(n,e,t,r){let i=!0;if(n.layers.test(e.layers)&&n.raycast(e,t)===!1&&(i=!1),i===!0&&r===!0){const s=n.children;for(let a=0,o=s.length;a<o;a++)JF(s[a],e,t,!0)}}class kTe{constructor(e=1,t=0,r=0){this.radius=e,this.phi=t,this.theta=r}set(e,t,r){return this.radius=e,this.phi=t,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Gi(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+t*t+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(Gi(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class OTe{constructor(e=1,t=0,r=0){this.radius=e,this.theta=t,this.y=r}set(e,t,r){return this.radius=e,this.theta=t,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=t,this}clone(){return new this.constructor().copy(this)}}class Yz{constructor(e,t,r,i){Yz.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,r,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let r=0;r<4;r++)this.elements[r]=e[r+t];return this}set(e,t,r,i){const s=this.elements;return s[0]=e,s[2]=t,s[1]=r,s[3]=i,this}}const rW=new an;class _oe{constructor(e=new an(1/0,1/0),t=new an(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,r=e.length;t<r;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const r=rW.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,rW).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const iW=new ut,hI=new ut;class ITe{constructor(e=new ut,t=new ut){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){iW.subVectors(e,this.start),hI.subVectors(this.end,this.start);const r=hI.dot(hI);let s=hI.dot(iW)/r;return t&&(s=Gi(s,0,1)),s}closestPointToPoint(e,t,r){const i=this.closestPointToPointParameter(e,t);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const sW=new ut;class NTe extends za{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const r=new ts,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,u=o/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Or(i,3));const s=new Vp({fog:!1,toneMapped:!1});this.cone=new Wv(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),sW.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(sW),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Fb=new ut,dI=new Qr,p6=new Qr;class PTe extends Wv{constructor(e){const t=voe(e),r=new ts,i=[],s=[],a=new cr(0,0,1),o=new cr(0,1,0);for(let c=0;c<t.length;c++){const u=t[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}r.setAttribute("position",new Or(i,3)),r.setAttribute("color",new Or(s,3));const l=new Vp({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,r=this.geometry,i=r.getAttribute("position");p6.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(dI.multiplyMatrices(p6,o.matrixWorld),Fb.setFromMatrixPosition(dI),i.setXYZ(a,Fb.x,Fb.y,Fb.z),dI.multiplyMatrices(p6,o.parent.matrixWorld),Fb.setFromMatrixPosition(dI),i.setXYZ(a+1,Fb.x,Fb.y,Fb.z),a+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function voe(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push(...voe(n.children[t]));return e}class DTe extends vu{constructor(e,t,r){const i=new nO(t,4,2),s=new F1({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const LTe=new ut,aW=new cr,oW=new cr;class UTe extends za{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new tO(t);i.rotateY(Math.PI*.5),this.material=new F1({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new Ps(a,3)),this.add(new vu(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");aW.copy(this.light.color),oW.copy(this.light.groundColor);for(let r=0,i=t.count;r<i;r++){const s=r<i/2?aW:oW;t.setXYZ(r,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(LTe.setFromMatrixPosition(this.light.matrixWorld).negate())}}class BTe extends Wv{constructor(e=10,t=10,r=4473924,i=8947848){r=new cr(r),i=new cr(i);const s=t/2,a=e/t,o=e/2,l=[],c=[];for(let d=0,g=0,p=-o;d<=t;d++,p+=a){l.push(-o,0,p,o,0,p),l.push(p,0,-o,p,0,o);const _=d===s?r:i;_.toArray(c,g),g+=3,_.toArray(c,g),g+=3,_.toArray(c,g),g+=3,_.toArray(c,g),g+=3}const u=new ts;u.setAttribute("position",new Or(l,3)),u.setAttribute("color",new Or(c,3));const f=new Vp({vertexColors:!0,toneMapped:!1});super(u,f),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class FTe extends Wv{constructor(e=10,t=16,r=8,i=64,s=4473924,a=8947848){s=new cr(s),a=new cr(a);const o=[],l=[];if(t>1)for(let f=0;f<t;f++){const d=f/t*(Math.PI*2),g=Math.sin(d)*e,p=Math.cos(d)*e;o.push(0,0,0),o.push(g,0,p);const _=f&1?s:a;l.push(_.r,_.g,_.b),l.push(_.r,_.g,_.b)}for(let f=0;f<r;f++){const d=f&1?s:a,g=e-e/r*f;for(let p=0;p<i;p++){let _=p/i*(Math.PI*2),y=Math.sin(_)*g,v=Math.cos(_)*g;o.push(y,0,v),l.push(d.r,d.g,d.b),_=(p+1)/i*(Math.PI*2),y=Math.sin(_)*g,v=Math.cos(_)*g,o.push(y,0,v),l.push(d.r,d.g,d.b)}}const c=new ts;c.setAttribute("position",new Or(o,3)),c.setAttribute("color",new Or(l,3));const u=new Vp({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const lW=new ut,pI=new ut,cW=new ut;class zTe extends za{constructor(e,t,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new ts;i.setAttribute("position",new Or([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Vp({fog:!1,toneMapped:!1});this.lightPlane=new x1(i,s),this.add(this.lightPlane),i=new ts,i.setAttribute("position",new Or([0,0,0,0,0,1],3)),this.targetLine=new x1(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),lW.setFromMatrixPosition(this.light.matrixWorld),pI.setFromMatrixPosition(this.light.target.matrixWorld),cW.subVectors(pI,lW),this.lightPlane.lookAt(pI),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(pI),this.targetLine.scale.z=cW.length()}}const mI=new ut,cu=new Zk;class jTe extends Wv{constructor(e){const t=new ts,r=new Vp({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,_){l(p),l(_)}function l(p){i.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(i.length/3-1)}t.setAttribute("position",new Or(i,3)),t.setAttribute("color",new Or(s,3)),super(t,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new cr(16755200),u=new cr(16711680),f=new cr(43775),d=new cr(16777215),g=new cr(3355443);this.setColors(c,u,f,d,g)}setColors(e,t,r,i,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,r.r,r.g,r.b),o.setXYZ(33,r.r,r.g,r.b),o.setXYZ(34,r.r,r.g,r.b),o.setXYZ(35,r.r,r.g,r.b),o.setXYZ(36,r.r,r.g,r.b),o.setXYZ(37,r.r,r.g,r.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,r=1,i=1;cu.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse);const s=this.camera.coordinateSystem===k0?-1:0;Uu("c",t,e,cu,0,0,s),Uu("t",t,e,cu,0,0,1),Uu("n1",t,e,cu,-1,-1,s),Uu("n2",t,e,cu,r,-1,s),Uu("n3",t,e,cu,-1,i,s),Uu("n4",t,e,cu,r,i,s),Uu("f1",t,e,cu,-1,-1,1),Uu("f2",t,e,cu,r,-1,1),Uu("f3",t,e,cu,-1,i,1),Uu("f4",t,e,cu,r,i,1),Uu("u1",t,e,cu,r*.7,i*1.1,s),Uu("u2",t,e,cu,-1*.7,i*1.1,s),Uu("u3",t,e,cu,0,i*2,s),Uu("cf1",t,e,cu,-1,0,1),Uu("cf2",t,e,cu,r,0,1),Uu("cf3",t,e,cu,0,-1,1),Uu("cf4",t,e,cu,0,i,1),Uu("cn1",t,e,cu,-1,0,s),Uu("cn2",t,e,cu,r,0,s),Uu("cn3",t,e,cu,0,-1,s),Uu("cn4",t,e,cu,0,i,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Uu(n,e,t,r,i,s,a){mI.set(i,s,a).unproject(r);const o=e[n];if(o!==void 0){const l=t.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],mI.x,mI.y,mI.z)}}const gI=new Qd;class HTe extends Wv{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),s=new ts;s.setIndex(new Ps(r,1)),s.setAttribute("position",new Ps(i,3)),super(s,new Vp({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&gI.setFromObject(this.object),gI.isEmpty())return;const e=gI.min,t=gI.max,r=this.geometry.attributes.position,i=r.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class qTe extends Wv{constructor(e,t=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new ts;s.setIndex(new Ps(r,1)),s.setAttribute("position",new Or(i,3)),super(s,new Vp({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class VTe extends x1{constructor(e,t=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new ts;a.setAttribute("position",new Or(s,3)),a.computeBoundingSphere(),super(a,new Vp({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new ts;l.setAttribute("position",new Or(o,3)),l.computeBoundingSphere(),this.add(new vu(l,new F1({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const uW=new ut;let _I,m6;class GTe extends za{constructor(e=new ut(0,0,1),t=new ut(0,0,0),r=1,i=16776960,s=r*.2,a=s*.2){super(),this.type="ArrowHelper",_I===void 0&&(_I=new ts,_I.setAttribute("position",new Or([0,0,0,0,1,0],3)),m6=new eO(.5,1,5,1),m6.translate(0,-.5,0)),this.position.copy(t),this.line=new x1(_I,new Vp({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new vu(m6,new F1({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{uW.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(uW,t)}}setLength(e,t=e*.2,r=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(r,t,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class $Te extends Wv{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new ts;i.setAttribute("position",new Or(t,3)),i.setAttribute("color",new Or(r,3));const s=new Vp({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,r){const i=new cr,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class WTe{constructor(){this.type="ShapePath",this.color=new cr,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new lD,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,r,i){return this.currentPath.quadraticCurveTo(e,t,r,i),this}bezierCurveTo(e,t,r,i,s,a){return this.currentPath.bezierCurveTo(e,t,r,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(v){const x=[];for(let E=0,M=v.length;E<M;E++){const O=v[E],N=new iE;N.curves=O.curves,x.push(N)}return x}function r(v,x){const E=x.length;let M=!1;for(let O=E-1,N=0;N<E;O=N++){let I=x[O],D=x[N],V=D.x-I.x,G=D.y-I.y;if(Math.abs(G)>Number.EPSILON){if(G<0&&(I=x[N],V=-V,D=x[O],G=-G),v.y<I.y||v.y>D.y)continue;if(v.y===I.y){if(v.x===I.x)return!0}else{const Q=G*(v.x-I.x)-V*(v.y-I.y);if(Q===0)return!0;if(Q<0)continue;M=!M}}else{if(v.y!==I.y)continue;if(D.x<=v.x&&v.x<=I.x||I.x<=v.x&&v.x<=D.x)return!0}}return M}const i=E_.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const c=[];if(s.length===1)return o=s[0],l=new iE,l.curves=o.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const f=[],d=[];let g=[],p=0,_;d[p]=void 0,g[p]=[];for(let v=0,x=s.length;v<x;v++)o=s[v],_=o.getPoints(),a=i(_),a=e?!a:a,a?(!u&&d[p]&&p++,d[p]={s:new iE,p:_},d[p].s.curves=o.curves,u&&p++,g[p]=[]):g[p].push({h:o,p:_[0]});if(!d[0])return t(s);if(d.length>1){let v=!1,x=0;for(let E=0,M=d.length;E<M;E++)f[E]=[];for(let E=0,M=d.length;E<M;E++){const O=g[E];for(let N=0;N<O.length;N++){const I=O[N];let D=!0;for(let V=0;V<d.length;V++)r(I.p,d[V].p)&&(E!==V&&x++,D?(D=!1,f[V].push(I)):v=!0);D&&f[E].push(I)}}x>0&&v===!1&&(g=f)}let y;for(let v=0,x=d.length;v<x;v++){l=d[v].s,c.push(l),y=g[v];for(let E=0,M=y.length;E<M;E++)l.holes.push(y[E].h)}return c}}class YTe extends Vg{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){console.warn("THREE.Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function XTe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2):(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0),n}function KTe(n,e){const t=n.image&&n.image.width?n.image.width/n.image.height:1;return t>e?(n.repeat.x=e/t,n.repeat.y=1,n.offset.x=(1-n.repeat.x)/2,n.offset.y=0):(n.repeat.x=1,n.repeat.y=t/e,n.offset.x=0,n.offset.y=(1-n.repeat.y)/2),n}function ZTe(n){return n.repeat.x=1,n.repeat.y=1,n.offset.x=0,n.offset.y=0,n}function e7(n,e,t,r){const i=QTe(r);switch(t){case vz:return n*e;case Iw:return n*e/i.components*i.byteLength;case Yk:return n*e/i.components*i.byteLength;case JL:return n*e*2/i.components*i.byteLength;case e4:return n*e*2/i.components*i.byteLength;case yz:return n*e*3/i.components*i.byteLength;case Xf:return n*e*4/i.components*i.byteLength;case Xk:return n*e*4/i.components*i.byteLength;case u2:case f2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case h2:case d2:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case NP:case DP:return Math.max(n,16)*Math.max(e,8)/4;case IP:case PP:return Math.max(n,8)*Math.max(e,8)/2;case LP:case UP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*8;case BP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case FP:return Math.floor((n+3)/4)*Math.floor((e+3)/4)*16;case zP:return Math.floor((n+4)/5)*Math.floor((e+3)/4)*16;case jP:return Math.floor((n+4)/5)*Math.floor((e+4)/5)*16;case HP:return Math.floor((n+5)/6)*Math.floor((e+4)/5)*16;case qP:return Math.floor((n+5)/6)*Math.floor((e+5)/6)*16;case VP:return Math.floor((n+7)/8)*Math.floor((e+4)/5)*16;case GP:return Math.floor((n+7)/8)*Math.floor((e+5)/6)*16;case $P:return Math.floor((n+7)/8)*Math.floor((e+7)/8)*16;case WP:return Math.floor((n+9)/10)*Math.floor((e+4)/5)*16;case YP:return Math.floor((n+9)/10)*Math.floor((e+5)/6)*16;case XP:return Math.floor((n+9)/10)*Math.floor((e+7)/8)*16;case KP:return Math.floor((n+9)/10)*Math.floor((e+9)/10)*16;case ZP:return Math.floor((n+11)/12)*Math.floor((e+9)/10)*16;case QP:return Math.floor((n+11)/12)*Math.floor((e+11)/12)*16;case p2:case JP:case eD:return Math.ceil(n/4)*Math.ceil(e/4)*16;case bz:case tD:return Math.ceil(n/4)*Math.ceil(e/4)*8;case nD:case rD:return Math.ceil(n/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function QTe(n){switch(n){case zl:case mz:return{byteLength:1,components:1};case FT:case gz:case db:return{byteLength:2,components:1};case ZL:case QL:return{byteLength:2,components:4};case Uv:case KL:case Dp:return{byteLength:4,components:1};case _z:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}class JTe{static contain(e,t){return XTe(e,t)}static cover(e,t){return KTe(e,t)}static fill(e){return ZTe(e)}static getByteLength(e,t,r,i){return e7(e,t,r,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:kw}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=kw);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function yoe(){let n=null,e=!1,t=null,r=null;function i(s,a){t(s,a),r=n.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(r=n.requestAnimationFrame(i),e=!0)},stop:function(){n.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function ewe(n){const e=new WeakMap;function t(o,l){const c=o.array,u=o.usage,f=c.byteLength,d=n.createBuffer();n.bindBuffer(l,d),n.bufferData(l,c,u),o.onUploadCallback();let g;if(c instanceof Float32Array)g=n.FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?g=n.HALF_FLOAT:g=n.UNSIGNED_SHORT;else if(c instanceof Int16Array)g=n.SHORT;else if(c instanceof Uint32Array)g=n.UNSIGNED_INT;else if(c instanceof Int32Array)g=n.INT;else if(c instanceof Int8Array)g=n.BYTE;else if(c instanceof Uint8Array)g=n.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)g=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:d,type:g,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:f}}function r(o,l,c){const u=l.array,f=l.updateRanges;if(n.bindBuffer(c,o),f.length===0)n.bufferSubData(c,0,u);else{f.sort((g,p)=>g.start-p.start);let d=0;for(let g=1;g<f.length;g++){const p=f[d],_=f[g];_.start<=p.start+p.count+1?p.count=Math.max(p.count,_.start+_.count-p.start):(++d,f[d]=_)}f.length=d+1;for(let g=0,p=f.length;g<p;g++){const _=f[g];n.bufferSubData(c,_.start*u.BYTES_PER_ELEMENT,u,_.start,_.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(n.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const u=e.get(o);(!u||u.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");r(c.buffer,o,l),c.version=o.version}}return{get:i,remove:s,update:a}}var twe=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,nwe=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,rwe=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,iwe=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,swe=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,awe=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,owe=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,lwe=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,cwe=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,uwe=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,fwe=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,hwe=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,dwe=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,pwe=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,mwe=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,gwe=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,_we=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,vwe=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,ywe=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,bwe=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Swe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ewe=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,xwe=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Twe=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,wwe=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Rwe=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Awe=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Cwe=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,Mwe=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,kwe=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Owe="gl_FragColor = linearToOutputTexel( gl_FragColor );",Iwe=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Nwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Pwe=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Dwe=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Lwe=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,Uwe=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Bwe=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,Fwe=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,zwe=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,jwe=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Hwe=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,qwe=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Vwe=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,Gwe=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,$we=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,Wwe=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,Ywe=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,Xwe=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,Kwe=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Zwe=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,Qwe=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,Jwe=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,eRe=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,tRe=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,nRe=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,rRe=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,iRe=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,sRe=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,aRe=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,oRe=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,lRe=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,cRe=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uRe=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,fRe=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,hRe=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dRe=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,pRe=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,mRe=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,gRe=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,_Re=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,vRe=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,yRe=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,bRe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,SRe=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,ERe=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,xRe=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,TRe=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,wRe=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,RRe=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,ARe=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,CRe=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,MRe=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,kRe=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,ORe=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,IRe=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,NRe=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,PRe=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,DRe=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,LRe=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,URe=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,BRe=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,FRe=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,zRe=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,jRe=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,HRe=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,qRe=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,VRe=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,GRe=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,$Re=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,WRe=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,YRe=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,XRe=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,KRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ZRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,QRe=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,JRe=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const eAe=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,tAe=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,rAe=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,sAe=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,aAe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,oAe=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,lAe=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,cAe=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,uAe=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fAe=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,hAe=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,dAe=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,pAe=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,mAe=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gAe=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,_Ae=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vAe=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,yAe=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,bAe=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,SAe=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,EAe=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,xAe=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,TAe=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,wAe=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RAe=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AAe=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,CAe=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,MAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,kAe=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,OAe=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,IAe=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,NAe=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,gs={alphahash_fragment:twe,alphahash_pars_fragment:nwe,alphamap_fragment:rwe,alphamap_pars_fragment:iwe,alphatest_fragment:swe,alphatest_pars_fragment:awe,aomap_fragment:owe,aomap_pars_fragment:lwe,batching_pars_vertex:cwe,batching_vertex:uwe,begin_vertex:fwe,beginnormal_vertex:hwe,bsdfs:dwe,iridescence_fragment:pwe,bumpmap_pars_fragment:mwe,clipping_planes_fragment:gwe,clipping_planes_pars_fragment:_we,clipping_planes_pars_vertex:vwe,clipping_planes_vertex:ywe,color_fragment:bwe,color_pars_fragment:Swe,color_pars_vertex:Ewe,color_vertex:xwe,common:Twe,cube_uv_reflection_fragment:wwe,defaultnormal_vertex:Rwe,displacementmap_pars_vertex:Awe,displacementmap_vertex:Cwe,emissivemap_fragment:Mwe,emissivemap_pars_fragment:kwe,colorspace_fragment:Owe,colorspace_pars_fragment:Iwe,envmap_fragment:Nwe,envmap_common_pars_fragment:Pwe,envmap_pars_fragment:Dwe,envmap_pars_vertex:Lwe,envmap_physical_pars_fragment:Wwe,envmap_vertex:Uwe,fog_vertex:Bwe,fog_pars_vertex:Fwe,fog_fragment:zwe,fog_pars_fragment:jwe,gradientmap_pars_fragment:Hwe,lightmap_pars_fragment:qwe,lights_lambert_fragment:Vwe,lights_lambert_pars_fragment:Gwe,lights_pars_begin:$we,lights_toon_fragment:Ywe,lights_toon_pars_fragment:Xwe,lights_phong_fragment:Kwe,lights_phong_pars_fragment:Zwe,lights_physical_fragment:Qwe,lights_physical_pars_fragment:Jwe,lights_fragment_begin:eRe,lights_fragment_maps:tRe,lights_fragment_end:nRe,logdepthbuf_fragment:rRe,logdepthbuf_pars_fragment:iRe,logdepthbuf_pars_vertex:sRe,logdepthbuf_vertex:aRe,map_fragment:oRe,map_pars_fragment:lRe,map_particle_fragment:cRe,map_particle_pars_fragment:uRe,metalnessmap_fragment:fRe,metalnessmap_pars_fragment:hRe,morphinstance_vertex:dRe,morphcolor_vertex:pRe,morphnormal_vertex:mRe,morphtarget_pars_vertex:gRe,morphtarget_vertex:_Re,normal_fragment_begin:vRe,normal_fragment_maps:yRe,normal_pars_fragment:bRe,normal_pars_vertex:SRe,normal_vertex:ERe,normalmap_pars_fragment:xRe,clearcoat_normal_fragment_begin:TRe,clearcoat_normal_fragment_maps:wRe,clearcoat_pars_fragment:RRe,iridescence_pars_fragment:ARe,opaque_fragment:CRe,packing:MRe,premultiplied_alpha_fragment:kRe,project_vertex:ORe,dithering_fragment:IRe,dithering_pars_fragment:NRe,roughnessmap_fragment:PRe,roughnessmap_pars_fragment:DRe,shadowmap_pars_fragment:LRe,shadowmap_pars_vertex:URe,shadowmap_vertex:BRe,shadowmask_pars_fragment:FRe,skinbase_vertex:zRe,skinning_pars_vertex:jRe,skinning_vertex:HRe,skinnormal_vertex:qRe,specularmap_fragment:VRe,specularmap_pars_fragment:GRe,tonemapping_fragment:$Re,tonemapping_pars_fragment:WRe,transmission_fragment:YRe,transmission_pars_fragment:XRe,uv_pars_fragment:KRe,uv_pars_vertex:ZRe,uv_vertex:QRe,worldpos_vertex:JRe,background_vert:eAe,background_frag:tAe,backgroundCube_vert:nAe,backgroundCube_frag:rAe,cube_vert:iAe,cube_frag:sAe,depth_vert:aAe,depth_frag:oAe,distanceRGBA_vert:lAe,distanceRGBA_frag:cAe,equirect_vert:uAe,equirect_frag:fAe,linedashed_vert:hAe,linedashed_frag:dAe,meshbasic_vert:pAe,meshbasic_frag:mAe,meshlambert_vert:gAe,meshlambert_frag:_Ae,meshmatcap_vert:vAe,meshmatcap_frag:yAe,meshnormal_vert:bAe,meshnormal_frag:SAe,meshphong_vert:EAe,meshphong_frag:xAe,meshphysical_vert:TAe,meshphysical_frag:wAe,meshtoon_vert:RAe,meshtoon_frag:AAe,points_vert:CAe,points_frag:MAe,shadow_vert:kAe,shadow_frag:OAe,sprite_vert:IAe,sprite_frag:NAe},or={common:{diffuse:{value:new cr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Ji}},envmap:{envMap:{value:null},envMapRotation:{value:new Ji},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Ji}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Ji}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Ji},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Ji},normalScale:{value:new an(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Ji},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Ji}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Ji}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Ji}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new cr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new cr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0},uvTransform:{value:new Ji}},sprite:{diffuse:{value:new cr(16777215)},opacity:{value:1},center:{value:new an(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Ji},alphaMap:{value:null},alphaMapTransform:{value:new Ji},alphaTest:{value:0}}},m_={basic:{uniforms:Rp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.fog]),vertexShader:gs.meshbasic_vert,fragmentShader:gs.meshbasic_frag},lambert:{uniforms:Rp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new cr(0)}}]),vertexShader:gs.meshlambert_vert,fragmentShader:gs.meshlambert_frag},phong:{uniforms:Rp([or.common,or.specularmap,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.fog,or.lights,{emissive:{value:new cr(0)},specular:{value:new cr(1118481)},shininess:{value:30}}]),vertexShader:gs.meshphong_vert,fragmentShader:gs.meshphong_frag},standard:{uniforms:Rp([or.common,or.envmap,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.roughnessmap,or.metalnessmap,or.fog,or.lights,{emissive:{value:new cr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:gs.meshphysical_vert,fragmentShader:gs.meshphysical_frag},toon:{uniforms:Rp([or.common,or.aomap,or.lightmap,or.emissivemap,or.bumpmap,or.normalmap,or.displacementmap,or.gradientmap,or.fog,or.lights,{emissive:{value:new cr(0)}}]),vertexShader:gs.meshtoon_vert,fragmentShader:gs.meshtoon_frag},matcap:{uniforms:Rp([or.common,or.bumpmap,or.normalmap,or.displacementmap,or.fog,{matcap:{value:null}}]),vertexShader:gs.meshmatcap_vert,fragmentShader:gs.meshmatcap_frag},points:{uniforms:Rp([or.points,or.fog]),vertexShader:gs.points_vert,fragmentShader:gs.points_frag},dashed:{uniforms:Rp([or.common,or.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gs.linedashed_vert,fragmentShader:gs.linedashed_frag},depth:{uniforms:Rp([or.common,or.displacementmap]),vertexShader:gs.depth_vert,fragmentShader:gs.depth_frag},normal:{uniforms:Rp([or.common,or.bumpmap,or.normalmap,or.displacementmap,{opacity:{value:1}}]),vertexShader:gs.meshnormal_vert,fragmentShader:gs.meshnormal_frag},sprite:{uniforms:Rp([or.sprite,or.fog]),vertexShader:gs.sprite_vert,fragmentShader:gs.sprite_frag},background:{uniforms:{uvTransform:{value:new Ji},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:gs.background_vert,fragmentShader:gs.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Ji}},vertexShader:gs.backgroundCube_vert,fragmentShader:gs.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:gs.cube_vert,fragmentShader:gs.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gs.equirect_vert,fragmentShader:gs.equirect_frag},distanceRGBA:{uniforms:Rp([or.common,or.displacementmap,{referencePosition:{value:new ut},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gs.distanceRGBA_vert,fragmentShader:gs.distanceRGBA_frag},shadow:{uniforms:Rp([or.lights,or.fog,{color:{value:new cr(0)},opacity:{value:1}}]),vertexShader:gs.shadow_vert,fragmentShader:gs.shadow_frag}};m_.physical={uniforms:Rp([m_.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Ji},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Ji},clearcoatNormalScale:{value:new an(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Ji},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Ji},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Ji},sheen:{value:0},sheenColor:{value:new cr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Ji},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Ji},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Ji},transmissionSamplerSize:{value:new an},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Ji},attenuationDistance:{value:0},attenuationColor:{value:new cr(0)},specularColor:{value:new cr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Ji},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Ji},anisotropyVector:{value:new an},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Ji}}]),vertexShader:gs.meshphysical_vert,fragmentShader:gs.meshphysical_frag};const vI={r:0,b:0,g:0},pS=new Um,PAe=new Qr;function DAe(n,e,t,r,i,s,a){const o=new cr(0);let l=s===!0?0:1,c,u,f=null,d=0,g=null;function p(E){let M=E.isScene===!0?E.background:null;return M&&M.isTexture&&(M=(E.backgroundBlurriness>0?t:e).get(M)),M}function _(E){let M=!1;const O=p(E);O===null?v(o,l):O&&O.isColor&&(v(O,1),M=!0);const N=n.xr.getEnvironmentBlendMode();N==="additive"?r.buffers.color.setClear(0,0,0,1,a):N==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(n.autoClear||M)&&(r.buffers.depth.setTest(!0),r.buffers.depth.setMask(!0),r.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function y(E,M){const O=p(M);O&&(O.isCubeTexture||O.mapping===Ow)?(u===void 0&&(u=new vu(new $E(1,1,1),new jl({name:"BackgroundCubeMaterial",uniforms:qT(m_.backgroundCube.uniforms),vertexShader:m_.backgroundCube.vertexShader,fragmentShader:m_.backgroundCube.fragmentShader,side:Yf,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(N,I,D){this.matrixWorld.copyPosition(D.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),pS.copy(M.backgroundRotation),pS.x*=-1,pS.y*=-1,pS.z*=-1,O.isCubeTexture&&O.isRenderTargetTexture===!1&&(pS.y*=-1,pS.z*=-1),u.material.uniforms.envMap.value=O,u.material.uniforms.flipEnvMap.value=O.isCubeTexture&&O.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=M.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,u.material.uniforms.backgroundRotation.value.setFromMatrix4(PAe.makeRotationFromEuler(pS)),u.material.toneMapped=Sa.getTransfer(O.colorSpace)!==No,(f!==O||d!==O.version||g!==n.toneMapping)&&(u.material.needsUpdate=!0,f=O,d=O.version,g=n.toneMapping),u.layers.enableAll(),E.unshift(u,u.geometry,u.material,0,0,null)):O&&O.isTexture&&(c===void 0&&(c=new vu(new Lw(2,2),new jl({name:"BackgroundMaterial",uniforms:qT(m_.background.uniforms),vertexShader:m_.background.vertexShader,fragmentShader:m_.background.fragmentShader,side:Lv,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=O,c.material.uniforms.backgroundIntensity.value=M.backgroundIntensity,c.material.toneMapped=Sa.getTransfer(O.colorSpace)!==No,O.matrixAutoUpdate===!0&&O.updateMatrix(),c.material.uniforms.uvTransform.value.copy(O.matrix),(f!==O||d!==O.version||g!==n.toneMapping)&&(c.material.needsUpdate=!0,f=O,d=O.version,g=n.toneMapping),c.layers.enableAll(),E.unshift(c,c.geometry,c.material,0,0,null))}function v(E,M){E.getRGB(vI,gae(n)),r.buffers.color.setClear(vI.r,vI.g,vI.b,M,a)}function x(){u!==void 0&&(u.geometry.dispose(),u.material.dispose(),u=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(E,M=1){o.set(E),l=M,v(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(E){l=E,v(o,l)},render:_,addToRenderList:y,dispose:x}}function LAe(n,e){const t=n.getParameter(n.MAX_VERTEX_ATTRIBS),r={},i=d(null);let s=i,a=!1;function o(G,Q,B,$,U){let J=!1;const W=f($,B,Q);s!==W&&(s=W,c(s.object)),J=g(G,$,B,U),J&&p(G,$,B,U),U!==null&&e.update(U,n.ELEMENT_ARRAY_BUFFER),(J||a)&&(a=!1,M(G,Q,B,$),U!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.get(U).buffer))}function l(){return n.createVertexArray()}function c(G){return n.bindVertexArray(G)}function u(G){return n.deleteVertexArray(G)}function f(G,Q,B){const $=B.wireframe===!0;let U=r[G.id];U===void 0&&(U={},r[G.id]=U);let J=U[Q.id];J===void 0&&(J={},U[Q.id]=J);let W=J[$];return W===void 0&&(W=d(l()),J[$]=W),W}function d(G){const Q=[],B=[],$=[];for(let U=0;U<t;U++)Q[U]=0,B[U]=0,$[U]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:B,attributeDivisors:$,object:G,attributes:{},index:null}}function g(G,Q,B,$){const U=s.attributes,J=Q.attributes;let W=0;const q=B.getAttributes();for(const Y in q)if(q[Y].location>=0){const Z=U[Y];let K=J[Y];if(K===void 0&&(Y==="instanceMatrix"&&G.instanceMatrix&&(K=G.instanceMatrix),Y==="instanceColor"&&G.instanceColor&&(K=G.instanceColor)),Z===void 0||Z.attribute!==K||K&&Z.data!==K.data)return!0;W++}return s.attributesNum!==W||s.index!==$}function p(G,Q,B,$){const U={},J=Q.attributes;let W=0;const q=B.getAttributes();for(const Y in q)if(q[Y].location>=0){let Z=J[Y];Z===void 0&&(Y==="instanceMatrix"&&G.instanceMatrix&&(Z=G.instanceMatrix),Y==="instanceColor"&&G.instanceColor&&(Z=G.instanceColor));const K={};K.attribute=Z,Z&&Z.data&&(K.data=Z.data),U[Y]=K,W++}s.attributes=U,s.attributesNum=W,s.index=$}function _(){const G=s.newAttributes;for(let Q=0,B=G.length;Q<B;Q++)G[Q]=0}function y(G){v(G,0)}function v(G,Q){const B=s.newAttributes,$=s.enabledAttributes,U=s.attributeDivisors;B[G]=1,$[G]===0&&(n.enableVertexAttribArray(G),$[G]=1),U[G]!==Q&&(n.vertexAttribDivisor(G,Q),U[G]=Q)}function x(){const G=s.newAttributes,Q=s.enabledAttributes;for(let B=0,$=Q.length;B<$;B++)Q[B]!==G[B]&&(n.disableVertexAttribArray(B),Q[B]=0)}function E(G,Q,B,$,U,J,W){W===!0?n.vertexAttribIPointer(G,Q,B,U,J):n.vertexAttribPointer(G,Q,B,$,U,J)}function M(G,Q,B,$){_();const U=$.attributes,J=B.getAttributes(),W=Q.defaultAttributeValues;for(const q in J){const Y=J[q];if(Y.location>=0){let ae=U[q];if(ae===void 0&&(q==="instanceMatrix"&&G.instanceMatrix&&(ae=G.instanceMatrix),q==="instanceColor"&&G.instanceColor&&(ae=G.instanceColor)),ae!==void 0){const Z=ae.normalized,K=ae.itemSize,ne=e.get(ae);if(ne===void 0)continue;const le=ne.buffer,ce=ne.type,de=ne.bytesPerElement,Me=ce===n.INT||ce===n.UNSIGNED_INT||ae.gpuType===KL;if(ae.isInterleavedBufferAttribute){const qe=ae.data,Pe=qe.stride,Ce=ae.offset;if(qe.isInstancedInterleavedBuffer){for(let Xe=0;Xe<Y.locationSize;Xe++)v(Y.location+Xe,qe.meshPerAttribute);G.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=qe.meshPerAttribute*qe.count)}else for(let Xe=0;Xe<Y.locationSize;Xe++)y(Y.location+Xe);n.bindBuffer(n.ARRAY_BUFFER,le);for(let Xe=0;Xe<Y.locationSize;Xe++)E(Y.location+Xe,K/Y.locationSize,ce,Z,Pe*de,(Ce+K/Y.locationSize*Xe)*de,Me)}else{if(ae.isInstancedBufferAttribute){for(let qe=0;qe<Y.locationSize;qe++)v(Y.location+qe,ae.meshPerAttribute);G.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=ae.meshPerAttribute*ae.count)}else for(let qe=0;qe<Y.locationSize;qe++)y(Y.location+qe);n.bindBuffer(n.ARRAY_BUFFER,le);for(let qe=0;qe<Y.locationSize;qe++)E(Y.location+qe,K/Y.locationSize,ce,Z,K*de,K/Y.locationSize*qe*de,Me)}}else if(W!==void 0){const Z=W[q];if(Z!==void 0)switch(Z.length){case 2:n.vertexAttrib2fv(Y.location,Z);break;case 3:n.vertexAttrib3fv(Y.location,Z);break;case 4:n.vertexAttrib4fv(Y.location,Z);break;default:n.vertexAttrib1fv(Y.location,Z)}}}}x()}function O(){D();for(const G in r){const Q=r[G];for(const B in Q){const $=Q[B];for(const U in $)u($[U].object),delete $[U];delete Q[B]}delete r[G]}}function N(G){if(r[G.id]===void 0)return;const Q=r[G.id];for(const B in Q){const $=Q[B];for(const U in $)u($[U].object),delete $[U];delete Q[B]}delete r[G.id]}function I(G){for(const Q in r){const B=r[Q];if(B[G.id]===void 0)continue;const $=B[G.id];for(const U in $)u($[U].object),delete $[U];delete B[G.id]}}function D(){V(),a=!0,s!==i&&(s=i,c(s.object))}function V(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:D,resetDefaultState:V,dispose:O,releaseStatesOfGeometry:N,releaseStatesOfProgram:I,initAttributes:_,enableAttribute:y,disableUnusedAttributes:x}}function UAe(n,e,t){let r;function i(c){r=c}function s(c,u){n.drawArrays(r,c,u),t.update(u,r,1)}function a(c,u,f){f!==0&&(n.drawArraysInstanced(r,c,u,f),t.update(u,r,f))}function o(c,u,f){if(f===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(r,c,0,u,0,f);let g=0;for(let p=0;p<f;p++)g+=u[p];t.update(g,r,1)}function l(c,u,f,d){if(f===0)return;const g=e.get("WEBGL_multi_draw");if(g===null)for(let p=0;p<c.length;p++)a(c[p],u[p],d[p]);else{g.multiDrawArraysInstancedWEBGL(r,c,0,u,0,d,0,f);let p=0;for(let _=0;_<f;_++)p+=u[_]*d[_];t.update(p,r,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function BAe(n,e,t,r){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const I=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(I.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(I){return!(I!==Xf&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(I){const D=I===db&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(I!==zl&&r.convert(I)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&I!==Dp&&!D)}function l(I){if(I==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";I="mediump"}return I==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const u=l(c);u!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",u,"instead."),c=u);const f=t.logarithmicDepthBuffer===!0,d=t.reverseDepthBuffer===!0&&e.has("EXT_clip_control"),g=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),p=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),_=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),v=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),E=n.getParameter(n.MAX_VARYING_VECTORS),M=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),O=p>0,N=n.getParameter(n.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:f,reverseDepthBuffer:d,maxTextures:g,maxVertexTextures:p,maxTextureSize:_,maxCubemapSize:y,maxAttributes:v,maxVertexUniforms:x,maxVaryings:E,maxFragmentUniforms:M,vertexTextures:O,maxSamples:N}}function FAe(n){const e=this;let t=null,r=0,i=!1,s=!1;const a=new Qb,o=new Ji,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,d){const g=f.length!==0||d||r!==0||i;return i=d,r=f.length,g},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(f,d){t=u(f,d,0)},this.setState=function(f,d,g){const p=f.clippingPlanes,_=f.clipIntersection,y=f.clipShadows,v=n.get(f);if(!i||p===null||p.length===0||s&&!y)s?u(null):c();else{const x=s?0:r,E=x*4;let M=v.clippingState||null;l.value=M,M=u(p,d,E,g);for(let O=0;O!==E;++O)M[O]=t[O];v.clippingState=M,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(f,d,g,p){const _=f!==null?f.length:0;let y=null;if(_!==0){if(y=l.value,p!==!0||y===null){const v=g+_*4,x=d.matrixWorldInverse;o.getNormalMatrix(x),(y===null||y.length<v)&&(y=new Float32Array(v));for(let E=0,M=g;E!==_;++E,M+=4)a.copy(f[E]).applyMatrix4(x,o),a.normal.toArray(y,M),y[M+3]=a.constant}l.value=y,l.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,y}}function zAe(n){let e=new WeakMap;function t(a,o){return o===I2?a.mapping=rb:o===N2&&(a.mapping=E1),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===I2||o===N2)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new yae(l.height);return c.fromEquirectangularTexture(n,a),e.set(a,c),a.addEventListener("dispose",i),t(c.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}const pT=4,fW=[.125,.215,.35,.446,.526,.582],jS=20,g6=new sO,hW=new cr;let _6=null,v6=0,y6=0,b6=!1;const IS=(1+Math.sqrt(5))/2,Ux=1/IS,dW=[new ut(-IS,Ux,0),new ut(IS,Ux,0),new ut(-Ux,0,IS),new ut(Ux,0,IS),new ut(0,IS,-Ux),new ut(0,IS,Ux),new ut(-1,1,-1),new ut(1,1,-1),new ut(-1,1,1),new ut(1,1,1)],jAe=new ut;class t7{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,r=.1,i=100,s={}){const{size:a=256,position:o=jAe}=s;_6=this._renderer.getRenderTarget(),v6=this._renderer.getActiveCubeFace(),y6=this._renderer.getActiveMipmapLevel(),b6=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,r,i,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=gW(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=mW(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(_6,v6,y6),this._renderer.xr.enabled=b6,e.scissorTest=!1,yI(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===rb||e.mapping===E1?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),_6=this._renderer.getRenderTarget(),v6=this._renderer.getActiveCubeFace(),y6=this._renderer.getActiveMipmapLevel(),b6=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const r=t||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,r={magFilter:nc,minFilter:nc,generateMipmaps:!1,type:db,format:Xf,colorSpace:Bv,depthBuffer:!1},i=pW(e,t,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=pW(e,t,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=HAe(s)),this._blurMaterial=qAe(s,e,t)}return i}_compileMaterial(e){const t=new vu(this._lodPlanes[0],e);this._renderer.compile(t,g6)}_sceneToCubeUV(e,t,r,i,s){const l=new vf(90,1,t,r),c=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],f=this._renderer,d=f.autoClear,g=f.toneMapping;f.getClearColor(hW),f.toneMapping=kv,f.autoClear=!1;const p=new F1({name:"PMREM.Background",side:Yf,depthWrite:!1,depthTest:!1}),_=new vu(new $E,p);let y=!1;const v=e.background;v?v.isColor&&(p.color.copy(v),e.background=null,y=!0):(p.color.copy(hW),y=!0);for(let x=0;x<6;x++){const E=x%3;E===0?(l.up.set(0,c[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+u[x],s.y,s.z)):E===1?(l.up.set(0,0,c[x]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+u[x],s.z)):(l.up.set(0,c[x],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+u[x]));const M=this._cubeSize;yI(i,E*M,x>2?M:0,M,M),f.setRenderTarget(i),y&&f.render(_,l),f.render(e,l)}_.geometry.dispose(),_.material.dispose(),f.toneMapping=g,f.autoClear=d,e.background=v}_textureToCubeUV(e,t){const r=this._renderer,i=e.mapping===rb||e.mapping===E1;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=gW()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=mW());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new vu(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;yI(t,0,0,3*l,2*l),r.setRenderTarget(t),r.render(a,g6)}_applyPMREM(e){const t=this._renderer,r=t.autoClear;t.autoClear=!1;const i=this._lodPlanes.length;for(let s=1;s<i;s++){const a=Math.sqrt(this._sigmas[s]*this._sigmas[s]-this._sigmas[s-1]*this._sigmas[s-1]),o=dW[(i-s-1)%dW.length];this._blur(e,s-1,s,a,o)}t.autoClear=r}_blur(e,t,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,t,r,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,f=new vu(this._lodPlanes[i],c),d=c.uniforms,g=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*jS-1),_=s/p,y=isFinite(s)?1+Math.floor(u*_):jS;y>jS&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${y} samples when the maximum is set to ${jS}`);const v=[];let x=0;for(let I=0;I<jS;++I){const D=I/_,V=Math.exp(-D*D/2);v.push(V),I===0?x+=V:I<y&&(x+=2*V)}for(let I=0;I<v.length;I++)v[I]=v[I]/x;d.envMap.value=e.texture,d.samples.value=y,d.weights.value=v,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:E}=this;d.dTheta.value=p,d.mipInt.value=E-r;const M=this._sizeLods[i],O=3*M*(i>E-pT?i-E+pT:0),N=4*(this._cubeSize-M);yI(t,O,N,3*M,2*M),l.setRenderTarget(t),l.render(f,g6)}}function HAe(n){const e=[],t=[],r=[];let i=n;const s=n-pT+1+fW.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);t.push(o);let l=1/o;a>n-pT?l=fW[a-n+pT-1]:a===0&&(l=0),r.push(l);const c=1/(o-2),u=-c,f=1+c,d=[u,u,f,u,f,f,u,u,f,f,u,f],g=6,p=6,_=3,y=2,v=1,x=new Float32Array(_*p*g),E=new Float32Array(y*p*g),M=new Float32Array(v*p*g);for(let N=0;N<g;N++){const I=N%3*2/3-1,D=N>2?0:-1,V=[I,D,0,I+2/3,D,0,I+2/3,D+1,0,I,D,0,I+2/3,D+1,0,I,D+1,0];x.set(V,_*p*N),E.set(d,y*p*N);const G=[N,N,N,N,N,N];M.set(G,v*p*N)}const O=new ts;O.setAttribute("position",new Ps(x,_)),O.setAttribute("uv",new Ps(E,y)),O.setAttribute("faceIndex",new Ps(M,v)),e.push(O),i>pT&&i--}return{lodPlanes:e,sizeLods:t,sigmas:r}}function pW(n,e,t){const r=new Sf(n,e,t);return r.texture.mapping=Ow,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function yI(n,e,t,r,i){n.viewport.set(e,t,r,i),n.scissor.set(e,t,r,i)}function qAe(n,e,t){const r=new Float32Array(jS),i=new ut(0,1,0);return new jl({name:"SphericalGaussianBlur",defines:{n:jS,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:Xz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Nh,depthTest:!1,depthWrite:!1})}function mW(){return new jl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Xz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Nh,depthTest:!1,depthWrite:!1})}function gW(){return new jl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Xz(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Nh,depthTest:!1,depthWrite:!1})}function Xz(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function VAe(n){let e=new WeakMap,t=null;function r(o){if(o&&o.isTexture){const l=o.mapping,c=l===I2||l===N2,u=l===rb||l===E1;if(c||u){let f=e.get(o);const d=f!==void 0?f.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==d)return t===null&&(t=new t7(n)),f=c?t.fromEquirectangular(o,f):t.fromCubemap(o,f),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),f.texture;if(f!==void 0)return f.texture;{const g=o.image;return c&&g&&g.height>0||u&&g&&i(g)?(t===null&&(t=new t7(n)),f=c?t.fromEquirectangular(o):t.fromCubemap(o),f.texture.pmremVersion=o.pmremVersion,e.set(o,f),o.addEventListener("dispose",s),f.texture):null}}}return o}function i(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:r,dispose:a}}function GAe(n){const e={};function t(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=n.getExtension(r)}return e[r]=i,i}return{has:function(r){return t(r)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(r){const i=t(r);return i===null&&CN("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function $Ae(n,e,t,r){const i={},s=new WeakMap;function a(f){const d=f.target;d.index!==null&&e.remove(d.index);for(const p in d.attributes)e.remove(d.attributes[p]);d.removeEventListener("dispose",a),delete i[d.id];const g=s.get(d);g&&(e.remove(g),s.delete(d)),r.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function o(f,d){return i[d.id]===!0||(d.addEventListener("dispose",a),i[d.id]=!0,t.memory.geometries++),d}function l(f){const d=f.attributes;for(const g in d)e.update(d[g],n.ARRAY_BUFFER)}function c(f){const d=[],g=f.index,p=f.attributes.position;let _=0;if(g!==null){const x=g.array;_=g.version;for(let E=0,M=x.length;E<M;E+=3){const O=x[E+0],N=x[E+1],I=x[E+2];d.push(O,N,N,I,I,O)}}else if(p!==void 0){const x=p.array;_=p.version;for(let E=0,M=x.length/3-1;E<M;E+=3){const O=E+0,N=E+1,I=E+2;d.push(O,N,N,I,I,O)}}else return;const y=new(hae(d)?wz:Tz)(d,1);y.version=_;const v=s.get(f);v&&e.remove(v),s.set(f,y)}function u(f){const d=s.get(f);if(d){const g=f.index;g!==null&&d.version<g.version&&c(f)}else c(f);return s.get(f)}return{get:o,update:l,getWireframeAttribute:u}}function WAe(n,e,t){let r;function i(d){r=d}let s,a;function o(d){s=d.type,a=d.bytesPerElement}function l(d,g){n.drawElements(r,g,s,d*a),t.update(g,r,1)}function c(d,g,p){p!==0&&(n.drawElementsInstanced(r,g,s,d*a,p),t.update(g,r,p))}function u(d,g,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(r,g,0,s,d,0,p);let y=0;for(let v=0;v<p;v++)y+=g[v];t.update(y,r,1)}function f(d,g,p,_){if(p===0)return;const y=e.get("WEBGL_multi_draw");if(y===null)for(let v=0;v<d.length;v++)c(d[v]/a,g[v],_[v]);else{y.multiDrawElementsInstancedWEBGL(r,g,0,s,d,0,_,0,p);let v=0;for(let x=0;x<p;x++)v+=g[x]*_[x];t.update(v,r,1)}}this.setMode=i,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=u,this.renderMultiDrawInstances=f}function YAe(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(t.calls++,a){case n.TRIANGLES:t.triangles+=o*(s/3);break;case n.LINES:t.lines+=o*(s/2);break;case n.LINE_STRIP:t.lines+=o*(s-1);break;case n.LINE_LOOP:t.lines+=o*s;break;case n.POINTS:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:r}}function XAe(n,e,t){const r=new WeakMap,i=new xa;function s(a,o,l){const c=a.morphTargetInfluences,u=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,f=u!==void 0?u.length:0;let d=r.get(o);if(d===void 0||d.count!==f){let G=function(){D.dispose(),r.delete(o),o.removeEventListener("dispose",G)};var g=G;d!==void 0&&d.texture.dispose();const p=o.morphAttributes.position!==void 0,_=o.morphAttributes.normal!==void 0,y=o.morphAttributes.color!==void 0,v=o.morphAttributes.position||[],x=o.morphAttributes.normal||[],E=o.morphAttributes.color||[];let M=0;p===!0&&(M=1),_===!0&&(M=2),y===!0&&(M=3);let O=o.attributes.position.count*M,N=1;O>e.maxTextureSize&&(N=Math.ceil(O/e.maxTextureSize),O=e.maxTextureSize);const I=new Float32Array(O*N*4*f),D=new Kk(I,O,N,f);D.type=Dp,D.needsUpdate=!0;const V=M*4;for(let Q=0;Q<f;Q++){const B=v[Q],$=x[Q],U=E[Q],J=O*N*4*Q;for(let W=0;W<B.count;W++){const q=W*V;p===!0&&(i.fromBufferAttribute(B,W),I[J+q+0]=i.x,I[J+q+1]=i.y,I[J+q+2]=i.z,I[J+q+3]=0),_===!0&&(i.fromBufferAttribute($,W),I[J+q+4]=i.x,I[J+q+5]=i.y,I[J+q+6]=i.z,I[J+q+7]=0),y===!0&&(i.fromBufferAttribute(U,W),I[J+q+8]=i.x,I[J+q+9]=i.y,I[J+q+10]=i.z,I[J+q+11]=U.itemSize===4?i.w:1)}}d={count:f,texture:D,size:new an(O,N)},r.set(o,d),o.addEventListener("dispose",G)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(n,"morphTexture",a.morphTexture,t);else{let p=0;for(let y=0;y<c.length;y++)p+=c[y];const _=o.morphTargetsRelative?1:1-p;l.getUniforms().setValue(n,"morphTargetBaseInfluence",_),l.getUniforms().setValue(n,"morphTargetInfluences",c)}l.getUniforms().setValue(n,"morphTargetsTexture",d.texture,t),l.getUniforms().setValue(n,"morphTargetsTextureSize",d.size)}return{update:s}}function KAe(n,e,t,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,f=e.get(l,u);if(i.get(f)!==c&&(e.update(f),i.set(f,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==c&&(t.update(l.instanceMatrix,n.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,n.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const d=l.skeleton;i.get(d)!==c&&(d.update(),i.set(d,c))}return f}function a(){i=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}const boe=new xc,_W=new Dw(1,1),Soe=new Kk,Eoe=new r4,xoe=new Qk,vW=[],yW=[],bW=new Float32Array(16),SW=new Float32Array(9),EW=new Float32Array(4);function Uw(n,e,t){const r=n[0];if(r<=0||r>0)return n;const i=e*t;let s=vW[i];if(s===void 0&&(s=new Float32Array(i),vW[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,n[a].toArray(s,o)}return s}function Zf(n,e){if(n.length!==e.length)return!1;for(let t=0,r=n.length;t<r;t++)if(n[t]!==e[t])return!1;return!0}function Qf(n,e){for(let t=0,r=e.length;t<r;t++)n[t]=e[t]}function T4(n,e){let t=yW[e];t===void 0&&(t=new Int32Array(e),yW[e]=t);for(let r=0;r!==e;++r)t[r]=n.allocateTextureUnit();return t}function ZAe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function QAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2fv(this.addr,e),Qf(t,e)}}function JAe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Zf(t,e))return;n.uniform3fv(this.addr,e),Qf(t,e)}}function eCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4fv(this.addr,e),Qf(t,e)}}function tCe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),Qf(t,e)}else{if(Zf(t,r))return;EW.set(r),n.uniformMatrix2fv(this.addr,!1,EW),Qf(t,r)}}function nCe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),Qf(t,e)}else{if(Zf(t,r))return;SW.set(r),n.uniformMatrix3fv(this.addr,!1,SW),Qf(t,r)}}function rCe(n,e){const t=this.cache,r=e.elements;if(r===void 0){if(Zf(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),Qf(t,e)}else{if(Zf(t,r))return;bW.set(r),n.uniformMatrix4fv(this.addr,!1,bW),Qf(t,r)}}function iCe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function sCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2iv(this.addr,e),Qf(t,e)}}function aCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Zf(t,e))return;n.uniform3iv(this.addr,e),Qf(t,e)}}function oCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4iv(this.addr,e),Qf(t,e)}}function lCe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function cCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Zf(t,e))return;n.uniform2uiv(this.addr,e),Qf(t,e)}}function uCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Zf(t,e))return;n.uniform3uiv(this.addr,e),Qf(t,e)}}function fCe(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Zf(t,e))return;n.uniform4uiv(this.addr,e),Qf(t,e)}}function hCe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i);let s;this.type===n.SAMPLER_2D_SHADOW?(_W.compareFunction=Ez,s=_W):s=boe,t.setTexture2D(e||s,i)}function dCe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture3D(e||Eoe,i)}function pCe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTextureCube(e||xoe,i)}function mCe(n,e,t){const r=this.cache,i=t.allocateTextureUnit();r[0]!==i&&(n.uniform1i(this.addr,i),r[0]=i),t.setTexture2DArray(e||Soe,i)}function gCe(n){switch(n){case 5126:return ZAe;case 35664:return QAe;case 35665:return JAe;case 35666:return eCe;case 35674:return tCe;case 35675:return nCe;case 35676:return rCe;case 5124:case 35670:return iCe;case 35667:case 35671:return sCe;case 35668:case 35672:return aCe;case 35669:case 35673:return oCe;case 5125:return lCe;case 36294:return cCe;case 36295:return uCe;case 36296:return fCe;case 35678:case 36198:case 36298:case 36306:case 35682:return hCe;case 35679:case 36299:case 36307:return dCe;case 35680:case 36300:case 36308:case 36293:return pCe;case 36289:case 36303:case 36311:case 36292:return mCe}}function _Ce(n,e){n.uniform1fv(this.addr,e)}function vCe(n,e){const t=Uw(e,this.size,2);n.uniform2fv(this.addr,t)}function yCe(n,e){const t=Uw(e,this.size,3);n.uniform3fv(this.addr,t)}function bCe(n,e){const t=Uw(e,this.size,4);n.uniform4fv(this.addr,t)}function SCe(n,e){const t=Uw(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function ECe(n,e){const t=Uw(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function xCe(n,e){const t=Uw(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function TCe(n,e){n.uniform1iv(this.addr,e)}function wCe(n,e){n.uniform2iv(this.addr,e)}function RCe(n,e){n.uniform3iv(this.addr,e)}function ACe(n,e){n.uniform4iv(this.addr,e)}function CCe(n,e){n.uniform1uiv(this.addr,e)}function MCe(n,e){n.uniform2uiv(this.addr,e)}function kCe(n,e){n.uniform3uiv(this.addr,e)}function OCe(n,e){n.uniform4uiv(this.addr,e)}function ICe(n,e,t){const r=this.cache,i=e.length,s=T4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Qf(r,s));for(let a=0;a!==i;++a)t.setTexture2D(e[a]||boe,s[a])}function NCe(n,e,t){const r=this.cache,i=e.length,s=T4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Qf(r,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||Eoe,s[a])}function PCe(n,e,t){const r=this.cache,i=e.length,s=T4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Qf(r,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||xoe,s[a])}function DCe(n,e,t){const r=this.cache,i=e.length,s=T4(t,i);Zf(r,s)||(n.uniform1iv(this.addr,s),Qf(r,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||Soe,s[a])}function LCe(n){switch(n){case 5126:return _Ce;case 35664:return vCe;case 35665:return yCe;case 35666:return bCe;case 35674:return SCe;case 35675:return ECe;case 35676:return xCe;case 5124:case 35670:return TCe;case 35667:case 35671:return wCe;case 35668:case 35672:return RCe;case 35669:case 35673:return ACe;case 5125:return CCe;case 36294:return MCe;case 36295:return kCe;case 36296:return OCe;case 35678:case 36198:case 36298:case 36306:case 35682:return ICe;case 35679:case 36299:case 36307:return NCe;case 35680:case 36300:case 36308:case 36293:return PCe;case 36289:case 36303:case 36311:case 36292:return DCe}}class UCe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.setValue=gCe(t.type)}}class BCe{constructor(e,t,r){this.id=e,this.addr=r,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=LCe(t.type)}}class FCe{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],r)}}}const S6=/(\w+)(\])?(\[|\.)?/g;function xW(n,e){n.seq.push(e),n.map[e.id]=e}function zCe(n,e,t){const r=n.name,i=r.length;for(S6.lastIndex=0;;){const s=S6.exec(r),a=S6.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===i){xW(t,c===void 0?new UCe(o,n,e):new BCe(o,n,e));break}else{let f=t.map[o];f===void 0&&(f=new FCe(o),xW(t,f)),t=f}}}class kN{constructor(e,t){this.seq=[],this.map={};const r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(t,i),a=e.getUniformLocation(t,s.name);zCe(s,a,this)}}setValue(e,t,r,i){const s=this.map[t];s!==void 0&&s.setValue(e,r,i)}setOptional(e,t,r){const i=t[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,t,r,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&r.push(a)}return r}}function TW(n,e,t){const r=n.createShader(e);return n.shaderSource(r,t),n.compileShader(r),r}const jCe=37297;let HCe=0;function qCe(n,e){const t=n.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return r.join(`
`)}const wW=new Ji;function VCe(n){Sa._getMatrix(wW,Sa.workingColorSpace,n);const e=`mat3( ${wW.elements.map(t=>t.toFixed(4))} )`;switch(Sa.getTransfer(n)){case U2:return[e,"LinearTransferOETF"];case No:return[e,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",n),[e,"LinearTransferOETF"]}}function RW(n,e,t){const r=n.getShaderParameter(e,n.COMPILE_STATUS),i=n.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+i+`

`+qCe(n.getShaderSource(e),a)}else return i}function GCe(n,e){const t=VCe(e);return[`vec4 ${n}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}function $Ce(n,e){let t;switch(e){case $se:t="Linear";break;case Wse:t="Reinhard";break;case Yse:t="Cineon";break;case dz:t="ACESFilmic";break;case Kse:t="AgX";break;case Zse:t="Neutral";break;case Xse:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const bI=new ut;function WCe(){Sa.getLuminanceCoefficients(bI);const n=bI.x.toFixed(4),e=bI.y.toFixed(4),t=bI.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function YCe(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(YM).join(`
`)}function XCe(n){const e=[];for(const t in n){const r=n[t];r!==!1&&e.push("#define "+t+" "+r)}return e.join(`
`)}function KCe(n,e){const t={},r=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=n.getActiveAttrib(e,i),a=s.name;let o=1;s.type===n.FLOAT_MAT2&&(o=2),s.type===n.FLOAT_MAT3&&(o=3),s.type===n.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:n.getAttribLocation(e,a),locationSize:o}}return t}function YM(n){return n!==""}function AW(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function CW(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ZCe=/^[ \t]*#include +<([\w\d./]+)>/gm;function n7(n){return n.replace(ZCe,JCe)}const QCe=new Map;function JCe(n,e){let t=gs[e];if(t===void 0){const r=QCe.get(e);if(r!==void 0)t=gs[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return n7(t)}const eMe=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function MW(n){return n.replace(eMe,tMe)}function tMe(n,e,t,r){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function kW(n){let e=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function nMe(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===YL?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===l2?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===d_&&(e="SHADOWMAP_TYPE_VSM"),e}function rMe(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case rb:case E1:e="ENVMAP_TYPE_CUBE";break;case Ow:e="ENVMAP_TYPE_CUBE_UV";break}return e}function iMe(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case E1:e="ENVMAP_MODE_REFRACTION";break}return e}function sMe(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case Wk:e="ENVMAP_BLENDING_MULTIPLY";break;case Vse:e="ENVMAP_BLENDING_MIX";break;case Gse:e="ENVMAP_BLENDING_ADD";break}return e}function aMe(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:r,maxMip:t}}function oMe(n,e,t,r){const i=n.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=nMe(t),c=rMe(t),u=iMe(t),f=sMe(t),d=aMe(t),g=YCe(t),p=XCe(s),_=i.createProgram();let y,v,x=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(y=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(YM).join(`
`),y.length>0&&(y+=`
`),v=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p].filter(YM).join(`
`),v.length>0&&(v+=`
`)):(y=[kW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+u:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(YM).join(`
`),v=[kW(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,p,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+u:"",t.envMap?"#define "+f:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==kv?"#define TONE_MAPPING":"",t.toneMapping!==kv?gs.tonemapping_pars_fragment:"",t.toneMapping!==kv?$Ce("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",gs.colorspace_pars_fragment,GCe("linearToOutputTexel",t.outputColorSpace),WCe(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(YM).join(`
`)),a=n7(a),a=AW(a,t),a=CW(a,t),o=n7(o),o=AW(o,t),o=CW(o,t),a=MW(a),o=MW(o),t.isRawShaderMaterial!==!0&&(x=`#version 300 es
`,y=[g,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,v=["#define varying in",t.glslVersion===WF?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===WF?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v);const E=x+y+a,M=x+v+o,O=TW(i,i.VERTEX_SHADER,E),N=TW(i,i.FRAGMENT_SHADER,M);i.attachShader(_,O),i.attachShader(_,N),t.index0AttributeName!==void 0?i.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(_,0,"position"),i.linkProgram(_);function I(Q){if(n.debug.checkShaderErrors){const B=i.getProgramInfoLog(_).trim(),$=i.getShaderInfoLog(O).trim(),U=i.getShaderInfoLog(N).trim();let J=!0,W=!0;if(i.getProgramParameter(_,i.LINK_STATUS)===!1)if(J=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(i,_,O,N);else{const q=RW(i,O,"vertex"),Y=RW(i,N,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(_,i.VALIDATE_STATUS)+`

Material Name: `+Q.name+`
Material Type: `+Q.type+`

Program Info Log: `+B+`
`+q+`
`+Y)}else B!==""?console.warn("THREE.WebGLProgram: Program Info Log:",B):($===""||U==="")&&(W=!1);W&&(Q.diagnostics={runnable:J,programLog:B,vertexShader:{log:$,prefix:y},fragmentShader:{log:U,prefix:v}})}i.deleteShader(O),i.deleteShader(N),D=new kN(i,_),V=KCe(i,_)}let D;this.getUniforms=function(){return D===void 0&&I(this),D};let V;this.getAttributes=function(){return V===void 0&&I(this),V};let G=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return G===!1&&(G=i.getProgramParameter(_,jCe)),G},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(_),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=HCe++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=O,this.fragmentShader=N,this}let lMe=0;class cMe{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const r of t)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let r=t.get(e);return r===void 0&&(r=new Set,t.set(e,r)),r}_getShaderStage(e){const t=this.shaderCache;let r=t.get(e);return r===void 0&&(r=new uMe(e),t.set(e,r)),r}}class uMe{constructor(e){this.id=lMe++,this.code=e,this.usedTimes=0}}function fMe(n,e,t,r,i,s,a){const o=new HT,l=new cMe,c=new Set,u=[],f=i.logarithmicDepthBuffer,d=i.vertexTextures;let g=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(V){return c.add(V),V===0?"uv":`uv${V}`}function y(V,G,Q,B,$){const U=B.fog,J=$.geometry,W=V.isMeshStandardMaterial?B.environment:null,q=(V.isMeshStandardMaterial?t:e).get(V.envMap||W),Y=q&&q.mapping===Ow?q.image.height:null,ae=p[V.type];V.precision!==null&&(g=i.getMaxPrecision(V.precision),g!==V.precision&&console.warn("THREE.WebGLProgram.getParameters:",V.precision,"not supported, using",g,"instead."));const Z=J.morphAttributes.position||J.morphAttributes.normal||J.morphAttributes.color,K=Z!==void 0?Z.length:0;let ne=0;J.morphAttributes.position!==void 0&&(ne=1),J.morphAttributes.normal!==void 0&&(ne=2),J.morphAttributes.color!==void 0&&(ne=3);let le,ce,de,Me;if(ae){const _t=m_[ae];le=_t.vertexShader,ce=_t.fragmentShader}else le=V.vertexShader,ce=V.fragmentShader,l.update(V),de=l.getVertexShaderID(V),Me=l.getFragmentShaderID(V);const qe=n.getRenderTarget(),Pe=n.state.buffers.depth.getReversed(),Ce=$.isInstancedMesh===!0,Xe=$.isBatchedMesh===!0,$e=!!V.map,at=!!V.matcap,pt=!!q,oe=!!V.aoMap,Ue=!!V.lightMap,Ge=!!V.bumpMap,ze=!!V.normalMap,Be=!!V.displacementMap,me=!!V.emissiveMap,Se=!!V.metalnessMap,Ie=!!V.roughnessMap,be=V.anisotropy>0,Ke=V.clearcoat>0,ot=V.dispersion>0,lt=V.iridescence>0,ct=V.sheen>0,Vt=V.transmission>0,kt=be&&!!V.anisotropyMap,Ut=Ke&&!!V.clearcoatMap,je=Ke&&!!V.clearcoatNormalMap,ge=Ke&&!!V.clearcoatRoughnessMap,se=lt&&!!V.iridescenceMap,_e=lt&&!!V.iridescenceThicknessMap,Ne=ct&&!!V.sheenColorMap,Le=ct&&!!V.sheenRoughnessMap,ke=!!V.specularMap,Re=!!V.specularColorMap,st=!!V.specularIntensityMap,Ve=Vt&&!!V.transmissionMap,tt=Vt&&!!V.thicknessMap,Ze=!!V.gradientMap,nt=!!V.alphaMap,vt=V.alphaTest>0,Qe=!!V.alphaHash,ht=!!V.extensions;let mt=kv;V.toneMapped&&(qe===null||qe.isXRRenderTarget===!0)&&(mt=n.toneMapping);const ft={shaderID:ae,shaderType:V.type,shaderName:V.name,vertexShader:le,fragmentShader:ce,defines:V.defines,customVertexShaderID:de,customFragmentShaderID:Me,isRawShaderMaterial:V.isRawShaderMaterial===!0,glslVersion:V.glslVersion,precision:g,batching:Xe,batchingColor:Xe&&$._colorsTexture!==null,instancing:Ce,instancingColor:Ce&&$.instanceColor!==null,instancingMorph:Ce&&$.morphTexture!==null,supportsVertexTextures:d,outputColorSpace:qe===null?n.outputColorSpace:qe.isXRRenderTarget===!0?qe.texture.colorSpace:Bv,alphaToCoverage:!!V.alphaToCoverage,map:$e,matcap:at,envMap:pt,envMapMode:pt&&q.mapping,envMapCubeUVHeight:Y,aoMap:oe,lightMap:Ue,bumpMap:Ge,normalMap:ze,displacementMap:d&&Be,emissiveMap:me,normalMapObjectSpace:ze&&V.normalMapType===rae,normalMapTangentSpace:ze&&V.normalMapType===B1,metalnessMap:Se,roughnessMap:Ie,anisotropy:be,anisotropyMap:kt,clearcoat:Ke,clearcoatMap:Ut,clearcoatNormalMap:je,clearcoatRoughnessMap:ge,dispersion:ot,iridescence:lt,iridescenceMap:se,iridescenceThicknessMap:_e,sheen:ct,sheenColorMap:Ne,sheenRoughnessMap:Le,specularMap:ke,specularColorMap:Re,specularIntensityMap:st,transmission:Vt,transmissionMap:Ve,thicknessMap:tt,gradientMap:Ze,opaque:V.transparent===!1&&V.blending===nE&&V.alphaToCoverage===!1,alphaMap:nt,alphaTest:vt,alphaHash:Qe,combine:V.combine,mapUv:$e&&_(V.map.channel),aoMapUv:oe&&_(V.aoMap.channel),lightMapUv:Ue&&_(V.lightMap.channel),bumpMapUv:Ge&&_(V.bumpMap.channel),normalMapUv:ze&&_(V.normalMap.channel),displacementMapUv:Be&&_(V.displacementMap.channel),emissiveMapUv:me&&_(V.emissiveMap.channel),metalnessMapUv:Se&&_(V.metalnessMap.channel),roughnessMapUv:Ie&&_(V.roughnessMap.channel),anisotropyMapUv:kt&&_(V.anisotropyMap.channel),clearcoatMapUv:Ut&&_(V.clearcoatMap.channel),clearcoatNormalMapUv:je&&_(V.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:ge&&_(V.clearcoatRoughnessMap.channel),iridescenceMapUv:se&&_(V.iridescenceMap.channel),iridescenceThicknessMapUv:_e&&_(V.iridescenceThicknessMap.channel),sheenColorMapUv:Ne&&_(V.sheenColorMap.channel),sheenRoughnessMapUv:Le&&_(V.sheenRoughnessMap.channel),specularMapUv:ke&&_(V.specularMap.channel),specularColorMapUv:Re&&_(V.specularColorMap.channel),specularIntensityMapUv:st&&_(V.specularIntensityMap.channel),transmissionMapUv:Ve&&_(V.transmissionMap.channel),thicknessMapUv:tt&&_(V.thicknessMap.channel),alphaMapUv:nt&&_(V.alphaMap.channel),vertexTangents:!!J.attributes.tangent&&(ze||be),vertexColors:V.vertexColors,vertexAlphas:V.vertexColors===!0&&!!J.attributes.color&&J.attributes.color.itemSize===4,pointsUvs:$.isPoints===!0&&!!J.attributes.uv&&($e||nt),fog:!!U,useFog:V.fog===!0,fogExp2:!!U&&U.isFogExp2,flatShading:V.flatShading===!0,sizeAttenuation:V.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:Pe,skinning:$.isSkinnedMesh===!0,morphTargets:J.morphAttributes.position!==void 0,morphNormals:J.morphAttributes.normal!==void 0,morphColors:J.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:ne,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numSpotLightMaps:G.spotLightMap.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numSpotLightShadowsWithMaps:G.numSpotLightShadowsWithMaps,numLightProbes:G.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:V.dithering,shadowMapEnabled:n.shadowMap.enabled&&Q.length>0,shadowMapType:n.shadowMap.type,toneMapping:mt,decodeVideoTexture:$e&&V.map.isVideoTexture===!0&&Sa.getTransfer(V.map.colorSpace)===No,decodeVideoTextureEmissive:me&&V.emissiveMap.isVideoTexture===!0&&Sa.getTransfer(V.emissiveMap.colorSpace)===No,premultipliedAlpha:V.premultipliedAlpha,doubleSided:V.side===$f,flipSided:V.side===Yf,useDepthPacking:V.depthPacking>=0,depthPacking:V.depthPacking||0,index0AttributeName:V.index0AttributeName,extensionClipCullDistance:ht&&V.extensions.clipCullDistance===!0&&r.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(ht&&V.extensions.multiDraw===!0||Xe)&&r.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:V.customProgramCacheKey()};return ft.vertexUv1s=c.has(1),ft.vertexUv2s=c.has(2),ft.vertexUv3s=c.has(3),c.clear(),ft}function v(V){const G=[];if(V.shaderID?G.push(V.shaderID):(G.push(V.customVertexShaderID),G.push(V.customFragmentShaderID)),V.defines!==void 0)for(const Q in V.defines)G.push(Q),G.push(V.defines[Q]);return V.isRawShaderMaterial===!1&&(x(G,V),E(G,V),G.push(n.outputColorSpace)),G.push(V.customProgramCacheKey),G.join()}function x(V,G){V.push(G.precision),V.push(G.outputColorSpace),V.push(G.envMapMode),V.push(G.envMapCubeUVHeight),V.push(G.mapUv),V.push(G.alphaMapUv),V.push(G.lightMapUv),V.push(G.aoMapUv),V.push(G.bumpMapUv),V.push(G.normalMapUv),V.push(G.displacementMapUv),V.push(G.emissiveMapUv),V.push(G.metalnessMapUv),V.push(G.roughnessMapUv),V.push(G.anisotropyMapUv),V.push(G.clearcoatMapUv),V.push(G.clearcoatNormalMapUv),V.push(G.clearcoatRoughnessMapUv),V.push(G.iridescenceMapUv),V.push(G.iridescenceThicknessMapUv),V.push(G.sheenColorMapUv),V.push(G.sheenRoughnessMapUv),V.push(G.specularMapUv),V.push(G.specularColorMapUv),V.push(G.specularIntensityMapUv),V.push(G.transmissionMapUv),V.push(G.thicknessMapUv),V.push(G.combine),V.push(G.fogExp2),V.push(G.sizeAttenuation),V.push(G.morphTargetsCount),V.push(G.morphAttributeCount),V.push(G.numDirLights),V.push(G.numPointLights),V.push(G.numSpotLights),V.push(G.numSpotLightMaps),V.push(G.numHemiLights),V.push(G.numRectAreaLights),V.push(G.numDirLightShadows),V.push(G.numPointLightShadows),V.push(G.numSpotLightShadows),V.push(G.numSpotLightShadowsWithMaps),V.push(G.numLightProbes),V.push(G.shadowMapType),V.push(G.toneMapping),V.push(G.numClippingPlanes),V.push(G.numClipIntersection),V.push(G.depthPacking)}function E(V,G){o.disableAll(),G.supportsVertexTextures&&o.enable(0),G.instancing&&o.enable(1),G.instancingColor&&o.enable(2),G.instancingMorph&&o.enable(3),G.matcap&&o.enable(4),G.envMap&&o.enable(5),G.normalMapObjectSpace&&o.enable(6),G.normalMapTangentSpace&&o.enable(7),G.clearcoat&&o.enable(8),G.iridescence&&o.enable(9),G.alphaTest&&o.enable(10),G.vertexColors&&o.enable(11),G.vertexAlphas&&o.enable(12),G.vertexUv1s&&o.enable(13),G.vertexUv2s&&o.enable(14),G.vertexUv3s&&o.enable(15),G.vertexTangents&&o.enable(16),G.anisotropy&&o.enable(17),G.alphaHash&&o.enable(18),G.batching&&o.enable(19),G.dispersion&&o.enable(20),G.batchingColor&&o.enable(21),V.push(o.mask),o.disableAll(),G.fog&&o.enable(0),G.useFog&&o.enable(1),G.flatShading&&o.enable(2),G.logarithmicDepthBuffer&&o.enable(3),G.reverseDepthBuffer&&o.enable(4),G.skinning&&o.enable(5),G.morphTargets&&o.enable(6),G.morphNormals&&o.enable(7),G.morphColors&&o.enable(8),G.premultipliedAlpha&&o.enable(9),G.shadowMapEnabled&&o.enable(10),G.doubleSided&&o.enable(11),G.flipSided&&o.enable(12),G.useDepthPacking&&o.enable(13),G.dithering&&o.enable(14),G.transmission&&o.enable(15),G.sheen&&o.enable(16),G.opaque&&o.enable(17),G.pointsUvs&&o.enable(18),G.decodeVideoTexture&&o.enable(19),G.decodeVideoTextureEmissive&&o.enable(20),G.alphaToCoverage&&o.enable(21),V.push(o.mask)}function M(V){const G=p[V.type];let Q;if(G){const B=m_[G];Q=_ae.clone(B.uniforms)}else Q=V.uniforms;return Q}function O(V,G){let Q;for(let B=0,$=u.length;B<$;B++){const U=u[B];if(U.cacheKey===G){Q=U,++Q.usedTimes;break}}return Q===void 0&&(Q=new oMe(n,G,V,s),u.push(Q)),Q}function N(V){if(--V.usedTimes===0){const G=u.indexOf(V);u[G]=u[u.length-1],u.pop(),V.destroy()}}function I(V){l.remove(V)}function D(){l.dispose()}return{getParameters:y,getProgramCacheKey:v,getUniforms:M,acquireProgram:O,releaseProgram:N,releaseShaderCache:I,programs:u,dispose:D}}function hMe(){let n=new WeakMap;function e(a){return n.has(a)}function t(a){let o=n.get(a);return o===void 0&&(o={},n.set(a,o)),o}function r(a){n.delete(a)}function i(a,o,l){n.get(a)[o]=l}function s(){n=new WeakMap}return{has:e,get:t,remove:r,update:i,dispose:s}}function dMe(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function OW(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function IW(){const n=[];let e=0;const t=[],r=[],i=[];function s(){e=0,t.length=0,r.length=0,i.length=0}function a(f,d,g,p,_,y){let v=n[e];return v===void 0?(v={id:f.id,object:f,geometry:d,material:g,groupOrder:p,renderOrder:f.renderOrder,z:_,group:y},n[e]=v):(v.id=f.id,v.object=f,v.geometry=d,v.material=g,v.groupOrder=p,v.renderOrder=f.renderOrder,v.z=_,v.group=y),e++,v}function o(f,d,g,p,_,y){const v=a(f,d,g,p,_,y);g.transmission>0?r.push(v):g.transparent===!0?i.push(v):t.push(v)}function l(f,d,g,p,_,y){const v=a(f,d,g,p,_,y);g.transmission>0?r.unshift(v):g.transparent===!0?i.unshift(v):t.unshift(v)}function c(f,d){t.length>1&&t.sort(f||dMe),r.length>1&&r.sort(d||OW),i.length>1&&i.sort(d||OW)}function u(){for(let f=e,d=n.length;f<d;f++){const g=n[f];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:t,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:u,sort:c}}function pMe(){let n=new WeakMap;function e(r,i){const s=n.get(r);let a;return s===void 0?(a=new IW,n.set(r,[a])):i>=s.length?(a=new IW,s.push(a)):a=s[i],a}function t(){n=new WeakMap}return{get:e,dispose:t}}function mMe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ut,color:new cr};break;case"SpotLight":t={position:new ut,direction:new ut,color:new cr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ut,color:new cr,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ut,skyColor:new cr,groundColor:new cr};break;case"RectAreaLight":t={color:new cr,position:new ut,halfWidth:new ut,halfHeight:new ut};break}return n[e.id]=t,t}}}function gMe(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new an,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let _Me=0;function vMe(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function yMe(n){const e=new mMe,t=gMe(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)r.probe.push(new ut);const i=new ut,s=new Qr,a=new Qr;function o(c){let u=0,f=0,d=0;for(let V=0;V<9;V++)r.probe[V].set(0,0,0);let g=0,p=0,_=0,y=0,v=0,x=0,E=0,M=0,O=0,N=0,I=0;c.sort(vMe);for(let V=0,G=c.length;V<G;V++){const Q=c[V],B=Q.color,$=Q.intensity,U=Q.distance,J=Q.shadow&&Q.shadow.map?Q.shadow.map.texture:null;if(Q.isAmbientLight)u+=B.r*$,f+=B.g*$,d+=B.b*$;else if(Q.isLightProbe){for(let W=0;W<9;W++)r.probe[W].addScaledVector(Q.sh.coefficients[W],$);I++}else if(Q.isDirectionalLight){const W=e.get(Q);if(W.color.copy(Q.color).multiplyScalar(Q.intensity),Q.castShadow){const q=Q.shadow,Y=t.get(Q);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,r.directionalShadow[g]=Y,r.directionalShadowMap[g]=J,r.directionalShadowMatrix[g]=Q.shadow.matrix,x++}r.directional[g]=W,g++}else if(Q.isSpotLight){const W=e.get(Q);W.position.setFromMatrixPosition(Q.matrixWorld),W.color.copy(B).multiplyScalar($),W.distance=U,W.coneCos=Math.cos(Q.angle),W.penumbraCos=Math.cos(Q.angle*(1-Q.penumbra)),W.decay=Q.decay,r.spot[_]=W;const q=Q.shadow;if(Q.map&&(r.spotLightMap[O]=Q.map,O++,q.updateMatrices(Q),Q.castShadow&&N++),r.spotLightMatrix[_]=q.matrix,Q.castShadow){const Y=t.get(Q);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,r.spotShadow[_]=Y,r.spotShadowMap[_]=J,M++}_++}else if(Q.isRectAreaLight){const W=e.get(Q);W.color.copy(B).multiplyScalar($),W.halfWidth.set(Q.width*.5,0,0),W.halfHeight.set(0,Q.height*.5,0),r.rectArea[y]=W,y++}else if(Q.isPointLight){const W=e.get(Q);if(W.color.copy(Q.color).multiplyScalar(Q.intensity),W.distance=Q.distance,W.decay=Q.decay,Q.castShadow){const q=Q.shadow,Y=t.get(Q);Y.shadowIntensity=q.intensity,Y.shadowBias=q.bias,Y.shadowNormalBias=q.normalBias,Y.shadowRadius=q.radius,Y.shadowMapSize=q.mapSize,Y.shadowCameraNear=q.camera.near,Y.shadowCameraFar=q.camera.far,r.pointShadow[p]=Y,r.pointShadowMap[p]=J,r.pointShadowMatrix[p]=Q.shadow.matrix,E++}r.point[p]=W,p++}else if(Q.isHemisphereLight){const W=e.get(Q);W.skyColor.copy(Q.color).multiplyScalar($),W.groundColor.copy(Q.groundColor).multiplyScalar($),r.hemi[v]=W,v++}}y>0&&(n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=or.LTC_FLOAT_1,r.rectAreaLTC2=or.LTC_FLOAT_2):(r.rectAreaLTC1=or.LTC_HALF_1,r.rectAreaLTC2=or.LTC_HALF_2)),r.ambient[0]=u,r.ambient[1]=f,r.ambient[2]=d;const D=r.hash;(D.directionalLength!==g||D.pointLength!==p||D.spotLength!==_||D.rectAreaLength!==y||D.hemiLength!==v||D.numDirectionalShadows!==x||D.numPointShadows!==E||D.numSpotShadows!==M||D.numSpotMaps!==O||D.numLightProbes!==I)&&(r.directional.length=g,r.spot.length=_,r.rectArea.length=y,r.point.length=p,r.hemi.length=v,r.directionalShadow.length=x,r.directionalShadowMap.length=x,r.pointShadow.length=E,r.pointShadowMap.length=E,r.spotShadow.length=M,r.spotShadowMap.length=M,r.directionalShadowMatrix.length=x,r.pointShadowMatrix.length=E,r.spotLightMatrix.length=M+O-N,r.spotLightMap.length=O,r.numSpotLightShadowsWithMaps=N,r.numLightProbes=I,D.directionalLength=g,D.pointLength=p,D.spotLength=_,D.rectAreaLength=y,D.hemiLength=v,D.numDirectionalShadows=x,D.numPointShadows=E,D.numSpotShadows=M,D.numSpotMaps=O,D.numLightProbes=I,r.version=_Me++)}function l(c,u){let f=0,d=0,g=0,p=0,_=0;const y=u.matrixWorldInverse;for(let v=0,x=c.length;v<x;v++){const E=c[v];if(E.isDirectionalLight){const M=r.directional[f];M.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(y),f++}else if(E.isSpotLight){const M=r.spot[g];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),M.direction.setFromMatrixPosition(E.matrixWorld),i.setFromMatrixPosition(E.target.matrixWorld),M.direction.sub(i),M.direction.transformDirection(y),g++}else if(E.isRectAreaLight){const M=r.rectArea[p];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),a.identity(),s.copy(E.matrixWorld),s.premultiply(y),a.extractRotation(s),M.halfWidth.set(E.width*.5,0,0),M.halfHeight.set(0,E.height*.5,0),M.halfWidth.applyMatrix4(a),M.halfHeight.applyMatrix4(a),p++}else if(E.isPointLight){const M=r.point[d];M.position.setFromMatrixPosition(E.matrixWorld),M.position.applyMatrix4(y),d++}else if(E.isHemisphereLight){const M=r.hemi[_];M.direction.setFromMatrixPosition(E.matrixWorld),M.direction.transformDirection(y),_++}}}return{setup:o,setupView:l,state:r}}function NW(n){const e=new yMe(n),t=[],r=[];function i(u){c.camera=u,t.length=0,r.length=0}function s(u){t.push(u)}function a(u){r.push(u)}function o(){e.setup(t)}function l(u){e.setupView(t,u)}const c={lightsArray:t,shadowsArray:r,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function bMe(n){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new NW(n),e.set(i,[o])):s>=a.length?(o=new NW(n),a.push(o)):o=a[s],o}function r(){e=new WeakMap}return{get:t,dispose:r}}const SMe=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,EMe=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function xMe(n,e,t){let r=new Pw;const i=new an,s=new an,a=new xa,o=new Lz({depthPacking:nae}),l=new Uz,c={},u=t.maxTextureSize,f={[Lv]:Yf,[Yf]:Lv,[$f]:$f},d=new jl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new an},radius:{value:4}},vertexShader:SMe,fragmentShader:EMe}),g=d.clone();g.defines.HORIZONTAL_PASS=1;const p=new ts;p.setAttribute("position",new Ps(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new vu(p,d),y=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=YL;let v=this.type;this.render=function(N,I,D){if(y.enabled===!1||y.autoUpdate===!1&&y.needsUpdate===!1||N.length===0)return;const V=n.getRenderTarget(),G=n.getActiveCubeFace(),Q=n.getActiveMipmapLevel(),B=n.state;B.setBlending(Nh),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);const $=v!==d_&&this.type===d_,U=v===d_&&this.type!==d_;for(let J=0,W=N.length;J<W;J++){const q=N[J],Y=q.shadow;if(Y===void 0){console.warn("THREE.WebGLShadowMap:",q,"has no shadow.");continue}if(Y.autoUpdate===!1&&Y.needsUpdate===!1)continue;i.copy(Y.mapSize);const ae=Y.getFrameExtents();if(i.multiply(ae),s.copy(Y.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/ae.x),i.x=s.x*ae.x,Y.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/ae.y),i.y=s.y*ae.y,Y.mapSize.y=s.y)),Y.map===null||$===!0||U===!0){const K=this.type!==d_?{minFilter:bf,magFilter:bf}:{};Y.map!==null&&Y.map.dispose(),Y.map=new Sf(i.x,i.y,K),Y.map.texture.name=q.name+".shadowMap",Y.camera.updateProjectionMatrix()}n.setRenderTarget(Y.map),n.clear();const Z=Y.getViewportCount();for(let K=0;K<Z;K++){const ne=Y.getViewport(K);a.set(s.x*ne.x,s.y*ne.y,s.x*ne.z,s.y*ne.w),B.viewport(a),Y.updateMatrices(q,K),r=Y.getFrustum(),M(I,D,Y.camera,q,this.type)}Y.isPointLightShadow!==!0&&this.type===d_&&x(Y,D),Y.needsUpdate=!1}v=this.type,y.needsUpdate=!1,n.setRenderTarget(V,G,Q)};function x(N,I){const D=e.update(_);d.defines.VSM_SAMPLES!==N.blurSamples&&(d.defines.VSM_SAMPLES=N.blurSamples,g.defines.VSM_SAMPLES=N.blurSamples,d.needsUpdate=!0,g.needsUpdate=!0),N.mapPass===null&&(N.mapPass=new Sf(i.x,i.y)),d.uniforms.shadow_pass.value=N.map.texture,d.uniforms.resolution.value=N.mapSize,d.uniforms.radius.value=N.radius,n.setRenderTarget(N.mapPass),n.clear(),n.renderBufferDirect(I,null,D,d,_,null),g.uniforms.shadow_pass.value=N.mapPass.texture,g.uniforms.resolution.value=N.mapSize,g.uniforms.radius.value=N.radius,n.setRenderTarget(N.map),n.clear(),n.renderBufferDirect(I,null,D,g,_,null)}function E(N,I,D,V){let G=null;const Q=D.isPointLight===!0?N.customDistanceMaterial:N.customDepthMaterial;if(Q!==void 0)G=Q;else if(G=D.isPointLight===!0?l:o,n.localClippingEnabled&&I.clipShadows===!0&&Array.isArray(I.clippingPlanes)&&I.clippingPlanes.length!==0||I.displacementMap&&I.displacementScale!==0||I.alphaMap&&I.alphaTest>0||I.map&&I.alphaTest>0||I.alphaToCoverage===!0){const B=G.uuid,$=I.uuid;let U=c[B];U===void 0&&(U={},c[B]=U);let J=U[$];J===void 0&&(J=G.clone(),U[$]=J,I.addEventListener("dispose",O)),G=J}if(G.visible=I.visible,G.wireframe=I.wireframe,V===d_?G.side=I.shadowSide!==null?I.shadowSide:I.side:G.side=I.shadowSide!==null?I.shadowSide:f[I.side],G.alphaMap=I.alphaMap,G.alphaTest=I.alphaToCoverage===!0?.5:I.alphaTest,G.map=I.map,G.clipShadows=I.clipShadows,G.clippingPlanes=I.clippingPlanes,G.clipIntersection=I.clipIntersection,G.displacementMap=I.displacementMap,G.displacementScale=I.displacementScale,G.displacementBias=I.displacementBias,G.wireframeLinewidth=I.wireframeLinewidth,G.linewidth=I.linewidth,D.isPointLight===!0&&G.isMeshDistanceMaterial===!0){const B=n.properties.get(G);B.light=D}return G}function M(N,I,D,V,G){if(N.visible===!1)return;if(N.layers.test(I.layers)&&(N.isMesh||N.isLine||N.isPoints)&&(N.castShadow||N.receiveShadow&&G===d_)&&(!N.frustumCulled||r.intersectsObject(N))){N.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,N.matrixWorld);const $=e.update(N),U=N.material;if(Array.isArray(U)){const J=$.groups;for(let W=0,q=J.length;W<q;W++){const Y=J[W],ae=U[Y.materialIndex];if(ae&&ae.visible){const Z=E(N,ae,V,G);N.onBeforeShadow(n,N,I,D,$,Z,Y),n.renderBufferDirect(D,null,$,Z,N,Y),N.onAfterShadow(n,N,I,D,$,Z,Y)}}}else if(U.visible){const J=E(N,U,V,G);N.onBeforeShadow(n,N,I,D,$,J,null),n.renderBufferDirect(D,null,$,J,N,null),N.onAfterShadow(n,N,I,D,$,J,null)}}const B=N.children;for(let $=0,U=B.length;$<U;$++)M(B[$],I,D,V,G)}function O(N){N.target.removeEventListener("dispose",O);for(const D in c){const V=c[D],G=N.target.uuid;G in V&&(V[G].dispose(),delete V[G])}}}const TMe={[wP]:RP,[AP]:kP,[CP]:OP,[mE]:MP,[RP]:wP,[kP]:AP,[OP]:CP,[MP]:mE};function wMe(n,e){function t(){let Ve=!1;const tt=new xa;let Ze=null;const nt=new xa(0,0,0,0);return{setMask:function(vt){Ze!==vt&&!Ve&&(n.colorMask(vt,vt,vt,vt),Ze=vt)},setLocked:function(vt){Ve=vt},setClear:function(vt,Qe,ht,mt,ft){ft===!0&&(vt*=mt,Qe*=mt,ht*=mt),tt.set(vt,Qe,ht,mt),nt.equals(tt)===!1&&(n.clearColor(vt,Qe,ht,mt),nt.copy(tt))},reset:function(){Ve=!1,Ze=null,nt.set(-1,0,0,0)}}}function r(){let Ve=!1,tt=!1,Ze=null,nt=null,vt=null;return{setReversed:function(Qe){if(tt!==Qe){const ht=e.get("EXT_clip_control");Qe?ht.clipControlEXT(ht.LOWER_LEFT_EXT,ht.ZERO_TO_ONE_EXT):ht.clipControlEXT(ht.LOWER_LEFT_EXT,ht.NEGATIVE_ONE_TO_ONE_EXT),tt=Qe;const mt=vt;vt=null,this.setClear(mt)}},getReversed:function(){return tt},setTest:function(Qe){Qe?qe(n.DEPTH_TEST):Pe(n.DEPTH_TEST)},setMask:function(Qe){Ze!==Qe&&!Ve&&(n.depthMask(Qe),Ze=Qe)},setFunc:function(Qe){if(tt&&(Qe=TMe[Qe]),nt!==Qe){switch(Qe){case wP:n.depthFunc(n.NEVER);break;case RP:n.depthFunc(n.ALWAYS);break;case AP:n.depthFunc(n.LESS);break;case mE:n.depthFunc(n.LEQUAL);break;case CP:n.depthFunc(n.EQUAL);break;case MP:n.depthFunc(n.GEQUAL);break;case kP:n.depthFunc(n.GREATER);break;case OP:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}nt=Qe}},setLocked:function(Qe){Ve=Qe},setClear:function(Qe){vt!==Qe&&(tt&&(Qe=1-Qe),n.clearDepth(Qe),vt=Qe)},reset:function(){Ve=!1,Ze=null,nt=null,vt=null,tt=!1}}}function i(){let Ve=!1,tt=null,Ze=null,nt=null,vt=null,Qe=null,ht=null,mt=null,ft=null;return{setTest:function(_t){Ve||(_t?qe(n.STENCIL_TEST):Pe(n.STENCIL_TEST))},setMask:function(_t){tt!==_t&&!Ve&&(n.stencilMask(_t),tt=_t)},setFunc:function(_t,gn,_n){(Ze!==_t||nt!==gn||vt!==_n)&&(n.stencilFunc(_t,gn,_n),Ze=_t,nt=gn,vt=_n)},setOp:function(_t,gn,_n){(Qe!==_t||ht!==gn||mt!==_n)&&(n.stencilOp(_t,gn,_n),Qe=_t,ht=gn,mt=_n)},setLocked:function(_t){Ve=_t},setClear:function(_t){ft!==_t&&(n.clearStencil(_t),ft=_t)},reset:function(){Ve=!1,tt=null,Ze=null,nt=null,vt=null,Qe=null,ht=null,mt=null,ft=null}}}const s=new t,a=new r,o=new i,l=new WeakMap,c=new WeakMap;let u={},f={},d=new WeakMap,g=[],p=null,_=!1,y=null,v=null,x=null,E=null,M=null,O=null,N=null,I=new cr(0,0,0),D=0,V=!1,G=null,Q=null,B=null,$=null,U=null;const J=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let W=!1,q=0;const Y=n.getParameter(n.VERSION);Y.indexOf("WebGL")!==-1?(q=parseFloat(/^WebGL (\d)/.exec(Y)[1]),W=q>=1):Y.indexOf("OpenGL ES")!==-1&&(q=parseFloat(/^OpenGL ES (\d)/.exec(Y)[1]),W=q>=2);let ae=null,Z={};const K=n.getParameter(n.SCISSOR_BOX),ne=n.getParameter(n.VIEWPORT),le=new xa().fromArray(K),ce=new xa().fromArray(ne);function de(Ve,tt,Ze,nt){const vt=new Uint8Array(4),Qe=n.createTexture();n.bindTexture(Ve,Qe),n.texParameteri(Ve,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Ve,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ht=0;ht<Ze;ht++)Ve===n.TEXTURE_3D||Ve===n.TEXTURE_2D_ARRAY?n.texImage3D(tt,0,n.RGBA,1,1,nt,0,n.RGBA,n.UNSIGNED_BYTE,vt):n.texImage2D(tt+ht,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,vt);return Qe}const Me={};Me[n.TEXTURE_2D]=de(n.TEXTURE_2D,n.TEXTURE_2D,1),Me[n.TEXTURE_CUBE_MAP]=de(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Me[n.TEXTURE_2D_ARRAY]=de(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Me[n.TEXTURE_3D]=de(n.TEXTURE_3D,n.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),qe(n.DEPTH_TEST),a.setFunc(mE),Ge(!1),ze(zF),qe(n.CULL_FACE),oe(Nh);function qe(Ve){u[Ve]!==!0&&(n.enable(Ve),u[Ve]=!0)}function Pe(Ve){u[Ve]!==!1&&(n.disable(Ve),u[Ve]=!1)}function Ce(Ve,tt){return f[Ve]!==tt?(n.bindFramebuffer(Ve,tt),f[Ve]=tt,Ve===n.DRAW_FRAMEBUFFER&&(f[n.FRAMEBUFFER]=tt),Ve===n.FRAMEBUFFER&&(f[n.DRAW_FRAMEBUFFER]=tt),!0):!1}function Xe(Ve,tt){let Ze=g,nt=!1;if(Ve){Ze=d.get(tt),Ze===void 0&&(Ze=[],d.set(tt,Ze));const vt=Ve.textures;if(Ze.length!==vt.length||Ze[0]!==n.COLOR_ATTACHMENT0){for(let Qe=0,ht=vt.length;Qe<ht;Qe++)Ze[Qe]=n.COLOR_ATTACHMENT0+Qe;Ze.length=vt.length,nt=!0}}else Ze[0]!==n.BACK&&(Ze[0]=n.BACK,nt=!0);nt&&n.drawBuffers(Ze)}function $e(Ve){return p!==Ve?(n.useProgram(Ve),p=Ve,!0):!1}const at={[i1]:n.FUNC_ADD,[Ase]:n.FUNC_SUBTRACT,[Cse]:n.FUNC_REVERSE_SUBTRACT};at[Mse]=n.MIN,at[kse]=n.MAX;const pt={[Ose]:n.ZERO,[Ise]:n.ONE,[Nse]:n.SRC_COLOR,[xP]:n.SRC_ALPHA,[Fse]:n.SRC_ALPHA_SATURATE,[Use]:n.DST_COLOR,[Dse]:n.DST_ALPHA,[Pse]:n.ONE_MINUS_SRC_COLOR,[TP]:n.ONE_MINUS_SRC_ALPHA,[Bse]:n.ONE_MINUS_DST_COLOR,[Lse]:n.ONE_MINUS_DST_ALPHA,[zse]:n.CONSTANT_COLOR,[jse]:n.ONE_MINUS_CONSTANT_COLOR,[Hse]:n.CONSTANT_ALPHA,[qse]:n.ONE_MINUS_CONSTANT_ALPHA};function oe(Ve,tt,Ze,nt,vt,Qe,ht,mt,ft,_t){if(Ve===Nh){_===!0&&(Pe(n.BLEND),_=!1);return}if(_===!1&&(qe(n.BLEND),_=!0),Ve!==Rse){if(Ve!==y||_t!==V){if((v!==i1||M!==i1)&&(n.blendEquation(n.FUNC_ADD),v=i1,M=i1),_t)switch(Ve){case nE:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case jF:n.blendFunc(n.ONE,n.ONE);break;case HF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case qF:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}else switch(Ve){case nE:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case jF:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case HF:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case qF:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ve);break}x=null,E=null,O=null,N=null,I.set(0,0,0),D=0,y=Ve,V=_t}return}vt=vt||tt,Qe=Qe||Ze,ht=ht||nt,(tt!==v||vt!==M)&&(n.blendEquationSeparate(at[tt],at[vt]),v=tt,M=vt),(Ze!==x||nt!==E||Qe!==O||ht!==N)&&(n.blendFuncSeparate(pt[Ze],pt[nt],pt[Qe],pt[ht]),x=Ze,E=nt,O=Qe,N=ht),(mt.equals(I)===!1||ft!==D)&&(n.blendColor(mt.r,mt.g,mt.b,ft),I.copy(mt),D=ft),y=Ve,V=!1}function Ue(Ve,tt){Ve.side===$f?Pe(n.CULL_FACE):qe(n.CULL_FACE);let Ze=Ve.side===Yf;tt&&(Ze=!Ze),Ge(Ze),Ve.blending===nE&&Ve.transparent===!1?oe(Nh):oe(Ve.blending,Ve.blendEquation,Ve.blendSrc,Ve.blendDst,Ve.blendEquationAlpha,Ve.blendSrcAlpha,Ve.blendDstAlpha,Ve.blendColor,Ve.blendAlpha,Ve.premultipliedAlpha),a.setFunc(Ve.depthFunc),a.setTest(Ve.depthTest),a.setMask(Ve.depthWrite),s.setMask(Ve.colorWrite);const nt=Ve.stencilWrite;o.setTest(nt),nt&&(o.setMask(Ve.stencilWriteMask),o.setFunc(Ve.stencilFunc,Ve.stencilRef,Ve.stencilFuncMask),o.setOp(Ve.stencilFail,Ve.stencilZFail,Ve.stencilZPass)),me(Ve.polygonOffset,Ve.polygonOffsetFactor,Ve.polygonOffsetUnits),Ve.alphaToCoverage===!0?qe(n.SAMPLE_ALPHA_TO_COVERAGE):Pe(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ge(Ve){G!==Ve&&(Ve?n.frontFace(n.CW):n.frontFace(n.CCW),G=Ve)}function ze(Ve){Ve!==xse?(qe(n.CULL_FACE),Ve!==Q&&(Ve===zF?n.cullFace(n.BACK):Ve===Tse?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):Pe(n.CULL_FACE),Q=Ve}function Be(Ve){Ve!==B&&(W&&n.lineWidth(Ve),B=Ve)}function me(Ve,tt,Ze){Ve?(qe(n.POLYGON_OFFSET_FILL),($!==tt||U!==Ze)&&(n.polygonOffset(tt,Ze),$=tt,U=Ze)):Pe(n.POLYGON_OFFSET_FILL)}function Se(Ve){Ve?qe(n.SCISSOR_TEST):Pe(n.SCISSOR_TEST)}function Ie(Ve){Ve===void 0&&(Ve=n.TEXTURE0+J-1),ae!==Ve&&(n.activeTexture(Ve),ae=Ve)}function be(Ve,tt,Ze){Ze===void 0&&(ae===null?Ze=n.TEXTURE0+J-1:Ze=ae);let nt=Z[Ze];nt===void 0&&(nt={type:void 0,texture:void 0},Z[Ze]=nt),(nt.type!==Ve||nt.texture!==tt)&&(ae!==Ze&&(n.activeTexture(Ze),ae=Ze),n.bindTexture(Ve,tt||Me[Ve]),nt.type=Ve,nt.texture=tt)}function Ke(){const Ve=Z[ae];Ve!==void 0&&Ve.type!==void 0&&(n.bindTexture(Ve.type,null),Ve.type=void 0,Ve.texture=void 0)}function ot(){try{n.compressedTexImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function lt(){try{n.compressedTexImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function ct(){try{n.texSubImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Vt(){try{n.texSubImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function kt(){try{n.compressedTexSubImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ut(){try{n.compressedTexSubImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function je(){try{n.texStorage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function ge(){try{n.texStorage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function se(){try{n.texImage2D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function _e(){try{n.texImage3D(...arguments)}catch(Ve){console.error("THREE.WebGLState:",Ve)}}function Ne(Ve){le.equals(Ve)===!1&&(n.scissor(Ve.x,Ve.y,Ve.z,Ve.w),le.copy(Ve))}function Le(Ve){ce.equals(Ve)===!1&&(n.viewport(Ve.x,Ve.y,Ve.z,Ve.w),ce.copy(Ve))}function ke(Ve,tt){let Ze=c.get(tt);Ze===void 0&&(Ze=new WeakMap,c.set(tt,Ze));let nt=Ze.get(Ve);nt===void 0&&(nt=n.getUniformBlockIndex(tt,Ve.name),Ze.set(Ve,nt))}function Re(Ve,tt){const nt=c.get(tt).get(Ve);l.get(tt)!==nt&&(n.uniformBlockBinding(tt,nt,Ve.__bindingPointIndex),l.set(tt,nt))}function st(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),a.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),u={},ae=null,Z={},f={},d=new WeakMap,g=[],p=null,_=!1,y=null,v=null,x=null,E=null,M=null,O=null,N=null,I=new cr(0,0,0),D=0,V=!1,G=null,Q=null,B=null,$=null,U=null,le.set(0,0,n.canvas.width,n.canvas.height),ce.set(0,0,n.canvas.width,n.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:qe,disable:Pe,bindFramebuffer:Ce,drawBuffers:Xe,useProgram:$e,setBlending:oe,setMaterial:Ue,setFlipSided:Ge,setCullFace:ze,setLineWidth:Be,setPolygonOffset:me,setScissorTest:Se,activeTexture:Ie,bindTexture:be,unbindTexture:Ke,compressedTexImage2D:ot,compressedTexImage3D:lt,texImage2D:se,texImage3D:_e,updateUBOMapping:ke,uniformBlockBinding:Re,texStorage2D:je,texStorage3D:ge,texSubImage2D:ct,texSubImage3D:Vt,compressedTexSubImage2D:kt,compressedTexSubImage3D:Ut,scissor:Ne,viewport:Le,reset:st}}function RMe(n,e,t,r,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new an,u=new WeakMap;let f;const d=new WeakMap;let g=!1;try{g=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(Ie,be){return g?new OffscreenCanvas(Ie,be):z2("canvas")}function _(Ie,be,Ke){let ot=1;const lt=Se(Ie);if((lt.width>Ke||lt.height>Ke)&&(ot=Ke/Math.max(lt.width,lt.height)),ot<1)if(typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ie instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ie instanceof ImageBitmap||typeof VideoFrame<"u"&&Ie instanceof VideoFrame){const ct=Math.floor(ot*lt.width),Vt=Math.floor(ot*lt.height);f===void 0&&(f=p(ct,Vt));const kt=be?p(ct,Vt):f;return kt.width=ct,kt.height=Vt,kt.getContext("2d").drawImage(Ie,0,0,ct,Vt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+lt.width+"x"+lt.height+") to ("+ct+"x"+Vt+")."),kt}else return"data"in Ie&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+lt.width+"x"+lt.height+")."),Ie;return Ie}function y(Ie){return Ie.generateMipmaps}function v(Ie){n.generateMipmap(Ie)}function x(Ie){return Ie.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:Ie.isWebGL3DRenderTarget?n.TEXTURE_3D:Ie.isWebGLArrayRenderTarget||Ie.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function E(Ie,be,Ke,ot,lt=!1){if(Ie!==null){if(n[Ie]!==void 0)return n[Ie];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ie+"'")}let ct=be;if(be===n.RED&&(Ke===n.FLOAT&&(ct=n.R32F),Ke===n.HALF_FLOAT&&(ct=n.R16F),Ke===n.UNSIGNED_BYTE&&(ct=n.R8)),be===n.RED_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.R8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.R16UI),Ke===n.UNSIGNED_INT&&(ct=n.R32UI),Ke===n.BYTE&&(ct=n.R8I),Ke===n.SHORT&&(ct=n.R16I),Ke===n.INT&&(ct=n.R32I)),be===n.RG&&(Ke===n.FLOAT&&(ct=n.RG32F),Ke===n.HALF_FLOAT&&(ct=n.RG16F),Ke===n.UNSIGNED_BYTE&&(ct=n.RG8)),be===n.RG_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RG8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RG16UI),Ke===n.UNSIGNED_INT&&(ct=n.RG32UI),Ke===n.BYTE&&(ct=n.RG8I),Ke===n.SHORT&&(ct=n.RG16I),Ke===n.INT&&(ct=n.RG32I)),be===n.RGB_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RGB8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RGB16UI),Ke===n.UNSIGNED_INT&&(ct=n.RGB32UI),Ke===n.BYTE&&(ct=n.RGB8I),Ke===n.SHORT&&(ct=n.RGB16I),Ke===n.INT&&(ct=n.RGB32I)),be===n.RGBA_INTEGER&&(Ke===n.UNSIGNED_BYTE&&(ct=n.RGBA8UI),Ke===n.UNSIGNED_SHORT&&(ct=n.RGBA16UI),Ke===n.UNSIGNED_INT&&(ct=n.RGBA32UI),Ke===n.BYTE&&(ct=n.RGBA8I),Ke===n.SHORT&&(ct=n.RGBA16I),Ke===n.INT&&(ct=n.RGBA32I)),be===n.RGB&&Ke===n.UNSIGNED_INT_5_9_9_9_REV&&(ct=n.RGB9_E5),be===n.RGBA){const Vt=lt?U2:Sa.getTransfer(ot);Ke===n.FLOAT&&(ct=n.RGBA32F),Ke===n.HALF_FLOAT&&(ct=n.RGBA16F),Ke===n.UNSIGNED_BYTE&&(ct=Vt===No?n.SRGB8_ALPHA8:n.RGBA8),Ke===n.UNSIGNED_SHORT_4_4_4_4&&(ct=n.RGBA4),Ke===n.UNSIGNED_SHORT_5_5_5_1&&(ct=n.RGB5_A1)}return(ct===n.R16F||ct===n.R32F||ct===n.RG16F||ct===n.RG32F||ct===n.RGBA16F||ct===n.RGBA32F)&&e.get("EXT_color_buffer_float"),ct}function M(Ie,be){let Ke;return Ie?be===null||be===Uv||be===gE?Ke=n.DEPTH24_STENCIL8:be===Dp?Ke=n.DEPTH32F_STENCIL8:be===FT&&(Ke=n.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):be===null||be===Uv||be===gE?Ke=n.DEPTH_COMPONENT24:be===Dp?Ke=n.DEPTH_COMPONENT32F:be===FT&&(Ke=n.DEPTH_COMPONENT16),Ke}function O(Ie,be){return y(Ie)===!0||Ie.isFramebufferTexture&&Ie.minFilter!==bf&&Ie.minFilter!==nc?Math.log2(Math.max(be.width,be.height))+1:Ie.mipmaps!==void 0&&Ie.mipmaps.length>0?Ie.mipmaps.length:Ie.isCompressedTexture&&Array.isArray(Ie.image)?be.mipmaps.length:1}function N(Ie){const be=Ie.target;be.removeEventListener("dispose",N),D(be),be.isVideoTexture&&u.delete(be)}function I(Ie){const be=Ie.target;be.removeEventListener("dispose",I),G(be)}function D(Ie){const be=r.get(Ie);if(be.__webglInit===void 0)return;const Ke=Ie.source,ot=d.get(Ke);if(ot){const lt=ot[be.__cacheKey];lt.usedTimes--,lt.usedTimes===0&&V(Ie),Object.keys(ot).length===0&&d.delete(Ke)}r.remove(Ie)}function V(Ie){const be=r.get(Ie);n.deleteTexture(be.__webglTexture);const Ke=Ie.source,ot=d.get(Ke);delete ot[be.__cacheKey],a.memory.textures--}function G(Ie){const be=r.get(Ie);if(Ie.depthTexture&&(Ie.depthTexture.dispose(),r.remove(Ie.depthTexture)),Ie.isWebGLCubeRenderTarget)for(let ot=0;ot<6;ot++){if(Array.isArray(be.__webglFramebuffer[ot]))for(let lt=0;lt<be.__webglFramebuffer[ot].length;lt++)n.deleteFramebuffer(be.__webglFramebuffer[ot][lt]);else n.deleteFramebuffer(be.__webglFramebuffer[ot]);be.__webglDepthbuffer&&n.deleteRenderbuffer(be.__webglDepthbuffer[ot])}else{if(Array.isArray(be.__webglFramebuffer))for(let ot=0;ot<be.__webglFramebuffer.length;ot++)n.deleteFramebuffer(be.__webglFramebuffer[ot]);else n.deleteFramebuffer(be.__webglFramebuffer);if(be.__webglDepthbuffer&&n.deleteRenderbuffer(be.__webglDepthbuffer),be.__webglMultisampledFramebuffer&&n.deleteFramebuffer(be.__webglMultisampledFramebuffer),be.__webglColorRenderbuffer)for(let ot=0;ot<be.__webglColorRenderbuffer.length;ot++)be.__webglColorRenderbuffer[ot]&&n.deleteRenderbuffer(be.__webglColorRenderbuffer[ot]);be.__webglDepthRenderbuffer&&n.deleteRenderbuffer(be.__webglDepthRenderbuffer)}const Ke=Ie.textures;for(let ot=0,lt=Ke.length;ot<lt;ot++){const ct=r.get(Ke[ot]);ct.__webglTexture&&(n.deleteTexture(ct.__webglTexture),a.memory.textures--),r.remove(Ke[ot])}r.remove(Ie)}let Q=0;function B(){Q=0}function $(){const Ie=Q;return Ie>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Ie+" texture units while this GPU supports only "+i.maxTextures),Q+=1,Ie}function U(Ie){const be=[];return be.push(Ie.wrapS),be.push(Ie.wrapT),be.push(Ie.wrapR||0),be.push(Ie.magFilter),be.push(Ie.minFilter),be.push(Ie.anisotropy),be.push(Ie.internalFormat),be.push(Ie.format),be.push(Ie.type),be.push(Ie.generateMipmaps),be.push(Ie.premultiplyAlpha),be.push(Ie.flipY),be.push(Ie.unpackAlignment),be.push(Ie.colorSpace),be.join()}function J(Ie,be){const Ke=r.get(Ie);if(Ie.isVideoTexture&&Be(Ie),Ie.isRenderTargetTexture===!1&&Ie.version>0&&Ke.__version!==Ie.version){const ot=Ie.image;if(ot===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(ot.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ce(Ke,Ie,be);return}}t.bindTexture(n.TEXTURE_2D,Ke.__webglTexture,n.TEXTURE0+be)}function W(Ie,be){const Ke=r.get(Ie);if(Ie.version>0&&Ke.__version!==Ie.version){ce(Ke,Ie,be);return}t.bindTexture(n.TEXTURE_2D_ARRAY,Ke.__webglTexture,n.TEXTURE0+be)}function q(Ie,be){const Ke=r.get(Ie);if(Ie.version>0&&Ke.__version!==Ie.version){ce(Ke,Ie,be);return}t.bindTexture(n.TEXTURE_3D,Ke.__webglTexture,n.TEXTURE0+be)}function Y(Ie,be){const Ke=r.get(Ie);if(Ie.version>0&&Ke.__version!==Ie.version){de(Ke,Ie,be);return}t.bindTexture(n.TEXTURE_CUBE_MAP,Ke.__webglTexture,n.TEXTURE0+be)}const ae={[BT]:n.REPEAT,[M0]:n.CLAMP_TO_EDGE,[P2]:n.MIRRORED_REPEAT},Z={[bf]:n.NEAREST,[pz]:n.NEAREST_MIPMAP_NEAREST,[hT]:n.NEAREST_MIPMAP_LINEAR,[nc]:n.LINEAR,[c2]:n.LINEAR_MIPMAP_NEAREST,[Tv]:n.LINEAR_MIPMAP_LINEAR},K={[iae]:n.NEVER,[uae]:n.ALWAYS,[sae]:n.LESS,[Ez]:n.LEQUAL,[aae]:n.EQUAL,[cae]:n.GEQUAL,[oae]:n.GREATER,[lae]:n.NOTEQUAL};function ne(Ie,be){if(be.type===Dp&&e.has("OES_texture_float_linear")===!1&&(be.magFilter===nc||be.magFilter===c2||be.magFilter===hT||be.magFilter===Tv||be.minFilter===nc||be.minFilter===c2||be.minFilter===hT||be.minFilter===Tv)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(Ie,n.TEXTURE_WRAP_S,ae[be.wrapS]),n.texParameteri(Ie,n.TEXTURE_WRAP_T,ae[be.wrapT]),(Ie===n.TEXTURE_3D||Ie===n.TEXTURE_2D_ARRAY)&&n.texParameteri(Ie,n.TEXTURE_WRAP_R,ae[be.wrapR]),n.texParameteri(Ie,n.TEXTURE_MAG_FILTER,Z[be.magFilter]),n.texParameteri(Ie,n.TEXTURE_MIN_FILTER,Z[be.minFilter]),be.compareFunction&&(n.texParameteri(Ie,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(Ie,n.TEXTURE_COMPARE_FUNC,K[be.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(be.magFilter===bf||be.minFilter!==hT&&be.minFilter!==Tv||be.type===Dp&&e.has("OES_texture_float_linear")===!1)return;if(be.anisotropy>1||r.get(be).__currentAnisotropy){const Ke=e.get("EXT_texture_filter_anisotropic");n.texParameterf(Ie,Ke.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(be.anisotropy,i.getMaxAnisotropy())),r.get(be).__currentAnisotropy=be.anisotropy}}}function le(Ie,be){let Ke=!1;Ie.__webglInit===void 0&&(Ie.__webglInit=!0,be.addEventListener("dispose",N));const ot=be.source;let lt=d.get(ot);lt===void 0&&(lt={},d.set(ot,lt));const ct=U(be);if(ct!==Ie.__cacheKey){lt[ct]===void 0&&(lt[ct]={texture:n.createTexture(),usedTimes:0},a.memory.textures++,Ke=!0),lt[ct].usedTimes++;const Vt=lt[Ie.__cacheKey];Vt!==void 0&&(lt[Ie.__cacheKey].usedTimes--,Vt.usedTimes===0&&V(be)),Ie.__cacheKey=ct,Ie.__webglTexture=lt[ct].texture}return Ke}function ce(Ie,be,Ke){let ot=n.TEXTURE_2D;(be.isDataArrayTexture||be.isCompressedArrayTexture)&&(ot=n.TEXTURE_2D_ARRAY),be.isData3DTexture&&(ot=n.TEXTURE_3D);const lt=le(Ie,be),ct=be.source;t.bindTexture(ot,Ie.__webglTexture,n.TEXTURE0+Ke);const Vt=r.get(ct);if(ct.version!==Vt.__version||lt===!0){t.activeTexture(n.TEXTURE0+Ke);const kt=Sa.getPrimaries(Sa.workingColorSpace),Ut=be.colorSpace===v_?null:Sa.getPrimaries(be.colorSpace),je=be.colorSpace===v_||kt===Ut?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,be.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,be.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,je);let ge=_(be.image,!1,i.maxTextureSize);ge=me(be,ge);const se=s.convert(be.format,be.colorSpace),_e=s.convert(be.type);let Ne=E(be.internalFormat,se,_e,be.colorSpace,be.isVideoTexture);ne(ot,be);let Le;const ke=be.mipmaps,Re=be.isVideoTexture!==!0,st=Vt.__version===void 0||lt===!0,Ve=ct.dataReady,tt=O(be,ge);if(be.isDepthTexture)Ne=M(be.format===_E,be.type),st&&(Re?t.texStorage2D(n.TEXTURE_2D,1,Ne,ge.width,ge.height):t.texImage2D(n.TEXTURE_2D,0,Ne,ge.width,ge.height,0,se,_e,null));else if(be.isDataTexture)if(ke.length>0){Re&&st&&t.texStorage2D(n.TEXTURE_2D,tt,Ne,ke[0].width,ke[0].height);for(let Ze=0,nt=ke.length;Ze<nt;Ze++)Le=ke[Ze],Re?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,Le.width,Le.height,se,_e,Le.data):t.texImage2D(n.TEXTURE_2D,Ze,Ne,Le.width,Le.height,0,se,_e,Le.data);be.generateMipmaps=!1}else Re?(st&&t.texStorage2D(n.TEXTURE_2D,tt,Ne,ge.width,ge.height),Ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,ge.width,ge.height,se,_e,ge.data)):t.texImage2D(n.TEXTURE_2D,0,Ne,ge.width,ge.height,0,se,_e,ge.data);else if(be.isCompressedTexture)if(be.isCompressedArrayTexture){Re&&st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,tt,Ne,ke[0].width,ke[0].height,ge.depth);for(let Ze=0,nt=ke.length;Ze<nt;Ze++)if(Le=ke[Ze],be.format!==Xf)if(se!==null)if(Re){if(Ve)if(be.layerUpdates.size>0){const vt=e7(Le.width,Le.height,be.format,be.type);for(const Qe of be.layerUpdates){const ht=Le.data.subarray(Qe*vt/Le.data.BYTES_PER_ELEMENT,(Qe+1)*vt/Le.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,Qe,Le.width,Le.height,1,se,ht)}be.clearLayerUpdates()}else t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,0,Le.width,Le.height,ge.depth,se,Le.data)}else t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,Ze,Ne,Le.width,Le.height,ge.depth,0,Le.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Re?Ve&&t.texSubImage3D(n.TEXTURE_2D_ARRAY,Ze,0,0,0,Le.width,Le.height,ge.depth,se,_e,Le.data):t.texImage3D(n.TEXTURE_2D_ARRAY,Ze,Ne,Le.width,Le.height,ge.depth,0,se,_e,Le.data)}else{Re&&st&&t.texStorage2D(n.TEXTURE_2D,tt,Ne,ke[0].width,ke[0].height);for(let Ze=0,nt=ke.length;Ze<nt;Ze++)Le=ke[Ze],be.format!==Xf?se!==null?Re?Ve&&t.compressedTexSubImage2D(n.TEXTURE_2D,Ze,0,0,Le.width,Le.height,se,Le.data):t.compressedTexImage2D(n.TEXTURE_2D,Ze,Ne,Le.width,Le.height,0,Le.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Re?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,Le.width,Le.height,se,_e,Le.data):t.texImage2D(n.TEXTURE_2D,Ze,Ne,Le.width,Le.height,0,se,_e,Le.data)}else if(be.isDataArrayTexture)if(Re){if(st&&t.texStorage3D(n.TEXTURE_2D_ARRAY,tt,Ne,ge.width,ge.height,ge.depth),Ve)if(be.layerUpdates.size>0){const Ze=e7(ge.width,ge.height,be.format,be.type);for(const nt of be.layerUpdates){const vt=ge.data.subarray(nt*Ze/ge.data.BYTES_PER_ELEMENT,(nt+1)*Ze/ge.data.BYTES_PER_ELEMENT);t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,nt,ge.width,ge.height,1,se,_e,vt)}be.clearLayerUpdates()}else t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,ge.width,ge.height,ge.depth,se,_e,ge.data)}else t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ne,ge.width,ge.height,ge.depth,0,se,_e,ge.data);else if(be.isData3DTexture)Re?(st&&t.texStorage3D(n.TEXTURE_3D,tt,Ne,ge.width,ge.height,ge.depth),Ve&&t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,ge.width,ge.height,ge.depth,se,_e,ge.data)):t.texImage3D(n.TEXTURE_3D,0,Ne,ge.width,ge.height,ge.depth,0,se,_e,ge.data);else if(be.isFramebufferTexture){if(st)if(Re)t.texStorage2D(n.TEXTURE_2D,tt,Ne,ge.width,ge.height);else{let Ze=ge.width,nt=ge.height;for(let vt=0;vt<tt;vt++)t.texImage2D(n.TEXTURE_2D,vt,Ne,Ze,nt,0,se,_e,null),Ze>>=1,nt>>=1}}else if(ke.length>0){if(Re&&st){const Ze=Se(ke[0]);t.texStorage2D(n.TEXTURE_2D,tt,Ne,Ze.width,Ze.height)}for(let Ze=0,nt=ke.length;Ze<nt;Ze++)Le=ke[Ze],Re?Ve&&t.texSubImage2D(n.TEXTURE_2D,Ze,0,0,se,_e,Le):t.texImage2D(n.TEXTURE_2D,Ze,Ne,se,_e,Le);be.generateMipmaps=!1}else if(Re){if(st){const Ze=Se(ge);t.texStorage2D(n.TEXTURE_2D,tt,Ne,Ze.width,Ze.height)}Ve&&t.texSubImage2D(n.TEXTURE_2D,0,0,0,se,_e,ge)}else t.texImage2D(n.TEXTURE_2D,0,Ne,se,_e,ge);y(be)&&v(ot),Vt.__version=ct.version,be.onUpdate&&be.onUpdate(be)}Ie.__version=be.version}function de(Ie,be,Ke){if(be.image.length!==6)return;const ot=le(Ie,be),lt=be.source;t.bindTexture(n.TEXTURE_CUBE_MAP,Ie.__webglTexture,n.TEXTURE0+Ke);const ct=r.get(lt);if(lt.version!==ct.__version||ot===!0){t.activeTexture(n.TEXTURE0+Ke);const Vt=Sa.getPrimaries(Sa.workingColorSpace),kt=be.colorSpace===v_?null:Sa.getPrimaries(be.colorSpace),Ut=be.colorSpace===v_||Vt===kt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,be.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,be.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,be.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ut);const je=be.isCompressedTexture||be.image[0].isCompressedTexture,ge=be.image[0]&&be.image[0].isDataTexture,se=[];for(let nt=0;nt<6;nt++)!je&&!ge?se[nt]=_(be.image[nt],!0,i.maxCubemapSize):se[nt]=ge?be.image[nt].image:be.image[nt],se[nt]=me(be,se[nt]);const _e=se[0],Ne=s.convert(be.format,be.colorSpace),Le=s.convert(be.type),ke=E(be.internalFormat,Ne,Le,be.colorSpace),Re=be.isVideoTexture!==!0,st=ct.__version===void 0||ot===!0,Ve=lt.dataReady;let tt=O(be,_e);ne(n.TEXTURE_CUBE_MAP,be);let Ze;if(je){Re&&st&&t.texStorage2D(n.TEXTURE_CUBE_MAP,tt,ke,_e.width,_e.height);for(let nt=0;nt<6;nt++){Ze=se[nt].mipmaps;for(let vt=0;vt<Ze.length;vt++){const Qe=Ze[vt];be.format!==Xf?Ne!==null?Re?Ve&&t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,0,0,Qe.width,Qe.height,Ne,Qe.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,ke,Qe.width,Qe.height,0,Qe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Re?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,0,0,Qe.width,Qe.height,Ne,Le,Qe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt,ke,Qe.width,Qe.height,0,Ne,Le,Qe.data)}}}else{if(Ze=be.mipmaps,Re&&st){Ze.length>0&&tt++;const nt=Se(se[0]);t.texStorage2D(n.TEXTURE_CUBE_MAP,tt,ke,nt.width,nt.height)}for(let nt=0;nt<6;nt++)if(ge){Re?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,se[nt].width,se[nt].height,Ne,Le,se[nt].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,ke,se[nt].width,se[nt].height,0,Ne,Le,se[nt].data);for(let vt=0;vt<Ze.length;vt++){const ht=Ze[vt].image[nt].image;Re?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,0,0,ht.width,ht.height,Ne,Le,ht.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,ke,ht.width,ht.height,0,Ne,Le,ht.data)}}else{Re?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,0,0,Ne,Le,se[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,ke,Ne,Le,se[nt]);for(let vt=0;vt<Ze.length;vt++){const Qe=Ze[vt];Re?Ve&&t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,0,0,Ne,Le,Qe.image[nt]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+nt,vt+1,ke,Ne,Le,Qe.image[nt])}}}y(be)&&v(n.TEXTURE_CUBE_MAP),ct.__version=lt.version,be.onUpdate&&be.onUpdate(be)}Ie.__version=be.version}function Me(Ie,be,Ke,ot,lt,ct){const Vt=s.convert(Ke.format,Ke.colorSpace),kt=s.convert(Ke.type),Ut=E(Ke.internalFormat,Vt,kt,Ke.colorSpace),je=r.get(be),ge=r.get(Ke);if(ge.__renderTarget=be,!je.__hasExternalTextures){const se=Math.max(1,be.width>>ct),_e=Math.max(1,be.height>>ct);lt===n.TEXTURE_3D||lt===n.TEXTURE_2D_ARRAY?t.texImage3D(lt,ct,Ut,se,_e,be.depth,0,Vt,kt,null):t.texImage2D(lt,ct,Ut,se,_e,0,Vt,kt,null)}t.bindFramebuffer(n.FRAMEBUFFER,Ie),ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ot,lt,ge.__webglTexture,0,Ge(be)):(lt===n.TEXTURE_2D||lt>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&lt<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ot,lt,ge.__webglTexture,ct),t.bindFramebuffer(n.FRAMEBUFFER,null)}function qe(Ie,be,Ke){if(n.bindRenderbuffer(n.RENDERBUFFER,Ie),be.depthBuffer){const ot=be.depthTexture,lt=ot&&ot.isDepthTexture?ot.type:null,ct=M(be.stencilBuffer,lt),Vt=be.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,kt=Ge(be);ze(be)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,kt,ct,be.width,be.height):Ke?n.renderbufferStorageMultisample(n.RENDERBUFFER,kt,ct,be.width,be.height):n.renderbufferStorage(n.RENDERBUFFER,ct,be.width,be.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,Vt,n.RENDERBUFFER,Ie)}else{const ot=be.textures;for(let lt=0;lt<ot.length;lt++){const ct=ot[lt],Vt=s.convert(ct.format,ct.colorSpace),kt=s.convert(ct.type),Ut=E(ct.internalFormat,Vt,kt,ct.colorSpace),je=Ge(be);Ke&&ze(be)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,je,Ut,be.width,be.height):ze(be)?o.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,je,Ut,be.width,be.height):n.renderbufferStorage(n.RENDERBUFFER,Ut,be.width,be.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function Pe(Ie,be){if(be&&be.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Ie),!(be.depthTexture&&be.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const ot=r.get(be.depthTexture);ot.__renderTarget=be,(!ot.__webglTexture||be.depthTexture.image.width!==be.width||be.depthTexture.image.height!==be.height)&&(be.depthTexture.image.width=be.width,be.depthTexture.image.height=be.height,be.depthTexture.needsUpdate=!0),J(be.depthTexture,0);const lt=ot.__webglTexture,ct=Ge(be);if(be.depthTexture.format===zT)ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,lt,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,lt,0);else if(be.depthTexture.format===_E)ze(be)?o.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,lt,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,lt,0);else throw new Error("Unknown depthTexture format")}function Ce(Ie){const be=r.get(Ie),Ke=Ie.isWebGLCubeRenderTarget===!0;if(be.__boundDepthTexture!==Ie.depthTexture){const ot=Ie.depthTexture;if(be.__depthDisposeCallback&&be.__depthDisposeCallback(),ot){const lt=()=>{delete be.__boundDepthTexture,delete be.__depthDisposeCallback,ot.removeEventListener("dispose",lt)};ot.addEventListener("dispose",lt),be.__depthDisposeCallback=lt}be.__boundDepthTexture=ot}if(Ie.depthTexture&&!be.__autoAllocateDepthBuffer){if(Ke)throw new Error("target.depthTexture not supported in Cube render targets");const ot=Ie.texture.mipmaps;ot&&ot.length>0?Pe(be.__webglFramebuffer[0],Ie):Pe(be.__webglFramebuffer,Ie)}else if(Ke){be.__webglDepthbuffer=[];for(let ot=0;ot<6;ot++)if(t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer[ot]),be.__webglDepthbuffer[ot]===void 0)be.__webglDepthbuffer[ot]=n.createRenderbuffer(),qe(be.__webglDepthbuffer[ot],Ie,!1);else{const lt=Ie.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ct=be.__webglDepthbuffer[ot];n.bindRenderbuffer(n.RENDERBUFFER,ct),n.framebufferRenderbuffer(n.FRAMEBUFFER,lt,n.RENDERBUFFER,ct)}}else{const ot=Ie.texture.mipmaps;if(ot&&ot.length>0?t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer[0]):t.bindFramebuffer(n.FRAMEBUFFER,be.__webglFramebuffer),be.__webglDepthbuffer===void 0)be.__webglDepthbuffer=n.createRenderbuffer(),qe(be.__webglDepthbuffer,Ie,!1);else{const lt=Ie.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ct=be.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,ct),n.framebufferRenderbuffer(n.FRAMEBUFFER,lt,n.RENDERBUFFER,ct)}}t.bindFramebuffer(n.FRAMEBUFFER,null)}function Xe(Ie,be,Ke){const ot=r.get(Ie);be!==void 0&&Me(ot.__webglFramebuffer,Ie,Ie.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),Ke!==void 0&&Ce(Ie)}function $e(Ie){const be=Ie.texture,Ke=r.get(Ie),ot=r.get(be);Ie.addEventListener("dispose",I);const lt=Ie.textures,ct=Ie.isWebGLCubeRenderTarget===!0,Vt=lt.length>1;if(Vt||(ot.__webglTexture===void 0&&(ot.__webglTexture=n.createTexture()),ot.__version=be.version,a.memory.textures++),ct){Ke.__webglFramebuffer=[];for(let kt=0;kt<6;kt++)if(be.mipmaps&&be.mipmaps.length>0){Ke.__webglFramebuffer[kt]=[];for(let Ut=0;Ut<be.mipmaps.length;Ut++)Ke.__webglFramebuffer[kt][Ut]=n.createFramebuffer()}else Ke.__webglFramebuffer[kt]=n.createFramebuffer()}else{if(be.mipmaps&&be.mipmaps.length>0){Ke.__webglFramebuffer=[];for(let kt=0;kt<be.mipmaps.length;kt++)Ke.__webglFramebuffer[kt]=n.createFramebuffer()}else Ke.__webglFramebuffer=n.createFramebuffer();if(Vt)for(let kt=0,Ut=lt.length;kt<Ut;kt++){const je=r.get(lt[kt]);je.__webglTexture===void 0&&(je.__webglTexture=n.createTexture(),a.memory.textures++)}if(Ie.samples>0&&ze(Ie)===!1){Ke.__webglMultisampledFramebuffer=n.createFramebuffer(),Ke.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,Ke.__webglMultisampledFramebuffer);for(let kt=0;kt<lt.length;kt++){const Ut=lt[kt];Ke.__webglColorRenderbuffer[kt]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,Ke.__webglColorRenderbuffer[kt]);const je=s.convert(Ut.format,Ut.colorSpace),ge=s.convert(Ut.type),se=E(Ut.internalFormat,je,ge,Ut.colorSpace,Ie.isXRRenderTarget===!0),_e=Ge(Ie);n.renderbufferStorageMultisample(n.RENDERBUFFER,_e,se,Ie.width,Ie.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+kt,n.RENDERBUFFER,Ke.__webglColorRenderbuffer[kt])}n.bindRenderbuffer(n.RENDERBUFFER,null),Ie.depthBuffer&&(Ke.__webglDepthRenderbuffer=n.createRenderbuffer(),qe(Ke.__webglDepthRenderbuffer,Ie,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(ct){t.bindTexture(n.TEXTURE_CUBE_MAP,ot.__webglTexture),ne(n.TEXTURE_CUBE_MAP,be);for(let kt=0;kt<6;kt++)if(be.mipmaps&&be.mipmaps.length>0)for(let Ut=0;Ut<be.mipmaps.length;Ut++)Me(Ke.__webglFramebuffer[kt][Ut],Ie,be,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+kt,Ut);else Me(Ke.__webglFramebuffer[kt],Ie,be,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+kt,0);y(be)&&v(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Vt){for(let kt=0,Ut=lt.length;kt<Ut;kt++){const je=lt[kt],ge=r.get(je);t.bindTexture(n.TEXTURE_2D,ge.__webglTexture),ne(n.TEXTURE_2D,je),Me(Ke.__webglFramebuffer,Ie,je,n.COLOR_ATTACHMENT0+kt,n.TEXTURE_2D,0),y(je)&&v(n.TEXTURE_2D)}t.unbindTexture()}else{let kt=n.TEXTURE_2D;if((Ie.isWebGL3DRenderTarget||Ie.isWebGLArrayRenderTarget)&&(kt=Ie.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),t.bindTexture(kt,ot.__webglTexture),ne(kt,be),be.mipmaps&&be.mipmaps.length>0)for(let Ut=0;Ut<be.mipmaps.length;Ut++)Me(Ke.__webglFramebuffer[Ut],Ie,be,n.COLOR_ATTACHMENT0,kt,Ut);else Me(Ke.__webglFramebuffer,Ie,be,n.COLOR_ATTACHMENT0,kt,0);y(be)&&v(kt),t.unbindTexture()}Ie.depthBuffer&&Ce(Ie)}function at(Ie){const be=Ie.textures;for(let Ke=0,ot=be.length;Ke<ot;Ke++){const lt=be[Ke];if(y(lt)){const ct=x(Ie),Vt=r.get(lt).__webglTexture;t.bindTexture(ct,Vt),v(ct),t.unbindTexture()}}}const pt=[],oe=[];function Ue(Ie){if(Ie.samples>0){if(ze(Ie)===!1){const be=Ie.textures,Ke=Ie.width,ot=Ie.height;let lt=n.COLOR_BUFFER_BIT;const ct=Ie.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Vt=r.get(Ie),kt=be.length>1;if(kt)for(let je=0;je<be.length;je++)t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer);const Ut=Ie.texture.mipmaps;Ut&&Ut.length>0?t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglFramebuffer[0]):t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglFramebuffer);for(let je=0;je<be.length;je++){if(Ie.resolveDepthBuffer&&(Ie.depthBuffer&&(lt|=n.DEPTH_BUFFER_BIT),Ie.stencilBuffer&&Ie.resolveStencilBuffer&&(lt|=n.STENCIL_BUFFER_BIT)),kt){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Vt.__webglColorRenderbuffer[je]);const ge=r.get(be[je]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,ge,0)}n.blitFramebuffer(0,0,Ke,ot,0,0,Ke,ot,lt,n.NEAREST),l===!0&&(pt.length=0,oe.length=0,pt.push(n.COLOR_ATTACHMENT0+je),Ie.depthBuffer&&Ie.resolveDepthBuffer===!1&&(pt.push(ct),oe.push(ct),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,oe)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,pt))}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),kt)for(let je=0;je<be.length;je++){t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.RENDERBUFFER,Vt.__webglColorRenderbuffer[je]);const ge=r.get(be[je]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Vt.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+je,n.TEXTURE_2D,ge,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Vt.__webglMultisampledFramebuffer)}else if(Ie.depthBuffer&&Ie.resolveDepthBuffer===!1&&l){const be=Ie.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[be])}}}function Ge(Ie){return Math.min(i.maxSamples,Ie.samples)}function ze(Ie){const be=r.get(Ie);return Ie.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&be.__useRenderToTexture!==!1}function Be(Ie){const be=a.render.frame;u.get(Ie)!==be&&(u.set(Ie,be),Ie.update())}function me(Ie,be){const Ke=Ie.colorSpace,ot=Ie.format,lt=Ie.type;return Ie.isCompressedTexture===!0||Ie.isVideoTexture===!0||Ke!==Bv&&Ke!==v_&&(Sa.getTransfer(Ke)===No?(ot!==Xf||lt!==zl)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Ke)),be}function Se(Ie){return typeof HTMLImageElement<"u"&&Ie instanceof HTMLImageElement?(c.width=Ie.naturalWidth||Ie.width,c.height=Ie.naturalHeight||Ie.height):typeof VideoFrame<"u"&&Ie instanceof VideoFrame?(c.width=Ie.displayWidth,c.height=Ie.displayHeight):(c.width=Ie.width,c.height=Ie.height),c}this.allocateTextureUnit=$,this.resetTextureUnits=B,this.setTexture2D=J,this.setTexture2DArray=W,this.setTexture3D=q,this.setTextureCube=Y,this.rebindTextures=Xe,this.setupRenderTarget=$e,this.updateRenderTargetMipmap=at,this.updateMultisampleRenderTarget=Ue,this.setupDepthRenderbuffer=Ce,this.setupFrameBufferTexture=Me,this.useMultisampledRTT=ze}function Toe(n,e){function t(r,i=v_){let s;const a=Sa.getTransfer(i);if(r===zl)return n.UNSIGNED_BYTE;if(r===ZL)return n.UNSIGNED_SHORT_4_4_4_4;if(r===QL)return n.UNSIGNED_SHORT_5_5_5_1;if(r===_z)return n.UNSIGNED_INT_5_9_9_9_REV;if(r===mz)return n.BYTE;if(r===gz)return n.SHORT;if(r===FT)return n.UNSIGNED_SHORT;if(r===KL)return n.INT;if(r===Uv)return n.UNSIGNED_INT;if(r===Dp)return n.FLOAT;if(r===db)return n.HALF_FLOAT;if(r===vz)return n.ALPHA;if(r===yz)return n.RGB;if(r===Xf)return n.RGBA;if(r===zT)return n.DEPTH_COMPONENT;if(r===_E)return n.DEPTH_STENCIL;if(r===Iw)return n.RED;if(r===Yk)return n.RED_INTEGER;if(r===JL)return n.RG;if(r===e4)return n.RG_INTEGER;if(r===Xk)return n.RGBA_INTEGER;if(r===u2||r===f2||r===h2||r===d2)if(a===No)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(r===u2)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(r===f2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(r===h2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(r===d2)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(r===u2)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===f2)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===h2)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===d2)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(r===IP||r===NP||r===PP||r===DP)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(r===IP)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===NP)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===PP)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===DP)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(r===LP||r===UP||r===BP)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(r===LP||r===UP)return a===No?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(r===BP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(r===FP||r===zP||r===jP||r===HP||r===qP||r===VP||r===GP||r===$P||r===WP||r===YP||r===XP||r===KP||r===ZP||r===QP)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(r===FP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(r===zP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(r===jP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(r===HP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(r===qP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(r===VP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(r===GP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(r===$P)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(r===WP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(r===YP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(r===XP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(r===KP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(r===ZP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(r===QP)return a===No?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(r===p2||r===JP||r===eD)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(r===p2)return a===No?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(r===JP)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(r===eD)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(r===bz||r===tD||r===nD||r===rD)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(r===p2)return s.COMPRESSED_RED_RGTC1_EXT;if(r===tD)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(r===nD)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(r===rD)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return r===gE?n.UNSIGNED_INT_24_8:n[r]!==void 0?n[r]:null}return{convert:t}}const AMe=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,CMe=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class MMe{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t,r){if(this.texture===null){const i=new xc,s=e.properties.get(i);s.__webglTexture=t.texture,(t.depthNear!==r.depthNear||t.depthFar!==r.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,r=new jl({vertexShader:AMe,fragmentShader:CMe,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new vu(new Lw(20,20),r)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class kMe extends Vg{constructor(e,t){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,f=null,d=null,g=null,p=null;const _=new MMe,y=t.getContextAttributes();let v=null,x=null;const E=[],M=[],O=new an;let N=null;const I=new vf;I.viewport=new xa;const D=new vf;D.viewport=new xa;const V=[I,D],G=new doe;let Q=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ce){let de=E[ce];return de===void 0&&(de=new MN,E[ce]=de),de.getTargetRaySpace()},this.getControllerGrip=function(ce){let de=E[ce];return de===void 0&&(de=new MN,E[ce]=de),de.getGripSpace()},this.getHand=function(ce){let de=E[ce];return de===void 0&&(de=new MN,E[ce]=de),de.getHandSpace()};function $(ce){const de=M.indexOf(ce.inputSource);if(de===-1)return;const Me=E[de];Me!==void 0&&(Me.update(ce.inputSource,ce.frame,c||a),Me.dispatchEvent({type:ce.type,data:ce.inputSource}))}function U(){i.removeEventListener("select",$),i.removeEventListener("selectstart",$),i.removeEventListener("selectend",$),i.removeEventListener("squeeze",$),i.removeEventListener("squeezestart",$),i.removeEventListener("squeezeend",$),i.removeEventListener("end",U),i.removeEventListener("inputsourceschange",J);for(let ce=0;ce<E.length;ce++){const de=M[ce];de!==null&&(M[ce]=null,E[ce].disconnect(de))}Q=null,B=null,_.reset(),e.setRenderTarget(v),g=null,d=null,f=null,i=null,x=null,le.stop(),r.isPresenting=!1,e.setPixelRatio(N),e.setSize(O.width,O.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ce){s=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ce){o=ce,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(ce){c=ce},this.getBaseLayer=function(){return d!==null?d:g},this.getBinding=function(){return f},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(ce){if(i=ce,i!==null){if(v=e.getRenderTarget(),i.addEventListener("select",$),i.addEventListener("selectstart",$),i.addEventListener("selectend",$),i.addEventListener("squeeze",$),i.addEventListener("squeezestart",$),i.addEventListener("squeezeend",$),i.addEventListener("end",U),i.addEventListener("inputsourceschange",J),y.xrCompatible!==!0&&await t.makeXRCompatible(),N=e.getPixelRatio(),e.getSize(O),typeof XRWebGLBinding<"u"&&"createProjectionLayer"in XRWebGLBinding.prototype){let Me=null,qe=null,Pe=null;y.depth&&(Pe=y.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,Me=y.stencil?_E:zT,qe=y.stencil?gE:Uv);const Ce={colorFormat:t.RGBA8,depthFormat:Pe,scaleFactor:s};f=new XRWebGLBinding(i,t),d=f.createProjectionLayer(Ce),i.updateRenderState({layers:[d]}),e.setPixelRatio(1),e.setSize(d.textureWidth,d.textureHeight,!1),x=new Sf(d.textureWidth,d.textureHeight,{format:Xf,type:zl,depthTexture:new Dw(d.textureWidth,d.textureHeight,qe,void 0,void 0,void 0,void 0,void 0,void 0,Me),stencilBuffer:y.stencil,colorSpace:e.outputColorSpace,samples:y.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1})}else{const Me={antialias:y.antialias,alpha:!0,depth:y.depth,stencil:y.stencil,framebufferScaleFactor:s};g=new XRWebGLLayer(i,t,Me),i.updateRenderState({baseLayer:g}),e.setPixelRatio(1),e.setSize(g.framebufferWidth,g.framebufferHeight,!1),x=new Sf(g.framebufferWidth,g.framebufferHeight,{format:Xf,type:zl,colorSpace:e.outputColorSpace,stencilBuffer:y.stencil,resolveDepthBuffer:g.ignoreDepthValues===!1,resolveStencilBuffer:g.ignoreDepthValues===!1})}x.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await i.requestReferenceSpace(o),le.setContext(i),le.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return _.getDepthTexture()};function J(ce){for(let de=0;de<ce.removed.length;de++){const Me=ce.removed[de],qe=M.indexOf(Me);qe>=0&&(M[qe]=null,E[qe].disconnect(Me))}for(let de=0;de<ce.added.length;de++){const Me=ce.added[de];let qe=M.indexOf(Me);if(qe===-1){for(let Ce=0;Ce<E.length;Ce++)if(Ce>=M.length){M.push(Me),qe=Ce;break}else if(M[Ce]===null){M[Ce]=Me,qe=Ce;break}if(qe===-1)break}const Pe=E[qe];Pe&&Pe.connect(Me)}}const W=new ut,q=new ut;function Y(ce,de,Me){W.setFromMatrixPosition(de.matrixWorld),q.setFromMatrixPosition(Me.matrixWorld);const qe=W.distanceTo(q),Pe=de.projectionMatrix.elements,Ce=Me.projectionMatrix.elements,Xe=Pe[14]/(Pe[10]-1),$e=Pe[14]/(Pe[10]+1),at=(Pe[9]+1)/Pe[5],pt=(Pe[9]-1)/Pe[5],oe=(Pe[8]-1)/Pe[0],Ue=(Ce[8]+1)/Ce[0],Ge=Xe*oe,ze=Xe*Ue,Be=qe/(-oe+Ue),me=Be*-oe;if(de.matrixWorld.decompose(ce.position,ce.quaternion,ce.scale),ce.translateX(me),ce.translateZ(Be),ce.matrixWorld.compose(ce.position,ce.quaternion,ce.scale),ce.matrixWorldInverse.copy(ce.matrixWorld).invert(),Pe[10]===-1)ce.projectionMatrix.copy(de.projectionMatrix),ce.projectionMatrixInverse.copy(de.projectionMatrixInverse);else{const Se=Xe+Be,Ie=$e+Be,be=Ge-me,Ke=ze+(qe-me),ot=at*$e/Ie*Se,lt=pt*$e/Ie*Se;ce.projectionMatrix.makePerspective(be,Ke,ot,lt,Se,Ie),ce.projectionMatrixInverse.copy(ce.projectionMatrix).invert()}}function ae(ce,de){de===null?ce.matrixWorld.copy(ce.matrix):ce.matrixWorld.multiplyMatrices(de.matrixWorld,ce.matrix),ce.matrixWorldInverse.copy(ce.matrixWorld).invert()}this.updateCamera=function(ce){if(i===null)return;let de=ce.near,Me=ce.far;_.texture!==null&&(_.depthNear>0&&(de=_.depthNear),_.depthFar>0&&(Me=_.depthFar)),G.near=D.near=I.near=de,G.far=D.far=I.far=Me,(Q!==G.near||B!==G.far)&&(i.updateRenderState({depthNear:G.near,depthFar:G.far}),Q=G.near,B=G.far),I.layers.mask=ce.layers.mask|2,D.layers.mask=ce.layers.mask|4,G.layers.mask=I.layers.mask|D.layers.mask;const qe=ce.parent,Pe=G.cameras;ae(G,qe);for(let Ce=0;Ce<Pe.length;Ce++)ae(Pe[Ce],qe);Pe.length===2?Y(G,I,D):G.projectionMatrix.copy(I.projectionMatrix),Z(ce,G,qe)};function Z(ce,de,Me){Me===null?ce.matrix.copy(de.matrixWorld):(ce.matrix.copy(Me.matrixWorld),ce.matrix.invert(),ce.matrix.multiply(de.matrixWorld)),ce.matrix.decompose(ce.position,ce.quaternion,ce.scale),ce.updateMatrixWorld(!0),ce.projectionMatrix.copy(de.projectionMatrix),ce.projectionMatrixInverse.copy(de.projectionMatrixInverse),ce.isPerspectiveCamera&&(ce.fov=jT*2*Math.atan(1/ce.projectionMatrix.elements[5]),ce.zoom=1)}this.getCamera=function(){return G},this.getFoveation=function(){if(!(d===null&&g===null))return l},this.setFoveation=function(ce){l=ce,d!==null&&(d.fixedFoveation=ce),g!==null&&g.fixedFoveation!==void 0&&(g.fixedFoveation=ce)},this.hasDepthSensing=function(){return _.texture!==null},this.getDepthSensingMesh=function(){return _.getMesh(G)};let K=null;function ne(ce,de){if(u=de.getViewerPose(c||a),p=de,u!==null){const Me=u.views;g!==null&&(e.setRenderTargetFramebuffer(x,g.framebuffer),e.setRenderTarget(x));let qe=!1;Me.length!==G.cameras.length&&(G.cameras.length=0,qe=!0);for(let Xe=0;Xe<Me.length;Xe++){const $e=Me[Xe];let at=null;if(g!==null)at=g.getViewport($e);else{const oe=f.getViewSubImage(d,$e);at=oe.viewport,Xe===0&&(e.setRenderTargetTextures(x,oe.colorTexture,oe.depthStencilTexture),e.setRenderTarget(x))}let pt=V[Xe];pt===void 0&&(pt=new vf,pt.layers.enable(Xe),pt.viewport=new xa,V[Xe]=pt),pt.matrix.fromArray($e.transform.matrix),pt.matrix.decompose(pt.position,pt.quaternion,pt.scale),pt.projectionMatrix.fromArray($e.projectionMatrix),pt.projectionMatrixInverse.copy(pt.projectionMatrix).invert(),pt.viewport.set(at.x,at.y,at.width,at.height),Xe===0&&(G.matrix.copy(pt.matrix),G.matrix.decompose(G.position,G.quaternion,G.scale)),qe===!0&&G.cameras.push(pt)}const Pe=i.enabledFeatures;if(Pe&&Pe.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&f){const Xe=f.getDepthInformation(Me[0]);Xe&&Xe.isValid&&Xe.texture&&_.init(e,Xe,i.renderState)}}for(let Me=0;Me<E.length;Me++){const qe=M[Me],Pe=E[Me];qe!==null&&Pe!==void 0&&Pe.update(qe,de,c||a)}K&&K(ce,de),de.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:de}),p=null}const le=new yoe;le.setAnimationLoop(ne),this.setAnimationLoop=function(ce){K=ce},this.dispose=function(){}}}const mS=new Um,OMe=new Qr;function IMe(n,e){function t(y,v){y.matrixAutoUpdate===!0&&y.updateMatrix(),v.value.copy(y.matrix)}function r(y,v){v.color.getRGB(y.fogColor.value,gae(n)),v.isFog?(y.fogNear.value=v.near,y.fogFar.value=v.far):v.isFogExp2&&(y.fogDensity.value=v.density)}function i(y,v,x,E,M){v.isMeshBasicMaterial||v.isMeshLambertMaterial?s(y,v):v.isMeshToonMaterial?(s(y,v),f(y,v)):v.isMeshPhongMaterial?(s(y,v),u(y,v)):v.isMeshStandardMaterial?(s(y,v),d(y,v),v.isMeshPhysicalMaterial&&g(y,v,M)):v.isMeshMatcapMaterial?(s(y,v),p(y,v)):v.isMeshDepthMaterial?s(y,v):v.isMeshDistanceMaterial?(s(y,v),_(y,v)):v.isMeshNormalMaterial?s(y,v):v.isLineBasicMaterial?(a(y,v),v.isLineDashedMaterial&&o(y,v)):v.isPointsMaterial?l(y,v,x,E):v.isSpriteMaterial?c(y,v):v.isShadowMaterial?(y.color.value.copy(v.color),y.opacity.value=v.opacity):v.isShaderMaterial&&(v.uniformsNeedUpdate=!1)}function s(y,v){y.opacity.value=v.opacity,v.color&&y.diffuse.value.copy(v.color),v.emissive&&y.emissive.value.copy(v.emissive).multiplyScalar(v.emissiveIntensity),v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.bumpMap&&(y.bumpMap.value=v.bumpMap,t(v.bumpMap,y.bumpMapTransform),y.bumpScale.value=v.bumpScale,v.side===Yf&&(y.bumpScale.value*=-1)),v.normalMap&&(y.normalMap.value=v.normalMap,t(v.normalMap,y.normalMapTransform),y.normalScale.value.copy(v.normalScale),v.side===Yf&&y.normalScale.value.negate()),v.displacementMap&&(y.displacementMap.value=v.displacementMap,t(v.displacementMap,y.displacementMapTransform),y.displacementScale.value=v.displacementScale,y.displacementBias.value=v.displacementBias),v.emissiveMap&&(y.emissiveMap.value=v.emissiveMap,t(v.emissiveMap,y.emissiveMapTransform)),v.specularMap&&(y.specularMap.value=v.specularMap,t(v.specularMap,y.specularMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest);const x=e.get(v),E=x.envMap,M=x.envMapRotation;E&&(y.envMap.value=E,mS.copy(M),mS.x*=-1,mS.y*=-1,mS.z*=-1,E.isCubeTexture&&E.isRenderTargetTexture===!1&&(mS.y*=-1,mS.z*=-1),y.envMapRotation.value.setFromMatrix4(OMe.makeRotationFromEuler(mS)),y.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,y.reflectivity.value=v.reflectivity,y.ior.value=v.ior,y.refractionRatio.value=v.refractionRatio),v.lightMap&&(y.lightMap.value=v.lightMap,y.lightMapIntensity.value=v.lightMapIntensity,t(v.lightMap,y.lightMapTransform)),v.aoMap&&(y.aoMap.value=v.aoMap,y.aoMapIntensity.value=v.aoMapIntensity,t(v.aoMap,y.aoMapTransform))}function a(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform))}function o(y,v){y.dashSize.value=v.dashSize,y.totalSize.value=v.dashSize+v.gapSize,y.scale.value=v.scale}function l(y,v,x,E){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.size.value=v.size*x,y.scale.value=E*.5,v.map&&(y.map.value=v.map,t(v.map,y.uvTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function c(y,v){y.diffuse.value.copy(v.color),y.opacity.value=v.opacity,y.rotation.value=v.rotation,v.map&&(y.map.value=v.map,t(v.map,y.mapTransform)),v.alphaMap&&(y.alphaMap.value=v.alphaMap,t(v.alphaMap,y.alphaMapTransform)),v.alphaTest>0&&(y.alphaTest.value=v.alphaTest)}function u(y,v){y.specular.value.copy(v.specular),y.shininess.value=Math.max(v.shininess,1e-4)}function f(y,v){v.gradientMap&&(y.gradientMap.value=v.gradientMap)}function d(y,v){y.metalness.value=v.metalness,v.metalnessMap&&(y.metalnessMap.value=v.metalnessMap,t(v.metalnessMap,y.metalnessMapTransform)),y.roughness.value=v.roughness,v.roughnessMap&&(y.roughnessMap.value=v.roughnessMap,t(v.roughnessMap,y.roughnessMapTransform)),v.envMap&&(y.envMapIntensity.value=v.envMapIntensity)}function g(y,v,x){y.ior.value=v.ior,v.sheen>0&&(y.sheenColor.value.copy(v.sheenColor).multiplyScalar(v.sheen),y.sheenRoughness.value=v.sheenRoughness,v.sheenColorMap&&(y.sheenColorMap.value=v.sheenColorMap,t(v.sheenColorMap,y.sheenColorMapTransform)),v.sheenRoughnessMap&&(y.sheenRoughnessMap.value=v.sheenRoughnessMap,t(v.sheenRoughnessMap,y.sheenRoughnessMapTransform))),v.clearcoat>0&&(y.clearcoat.value=v.clearcoat,y.clearcoatRoughness.value=v.clearcoatRoughness,v.clearcoatMap&&(y.clearcoatMap.value=v.clearcoatMap,t(v.clearcoatMap,y.clearcoatMapTransform)),v.clearcoatRoughnessMap&&(y.clearcoatRoughnessMap.value=v.clearcoatRoughnessMap,t(v.clearcoatRoughnessMap,y.clearcoatRoughnessMapTransform)),v.clearcoatNormalMap&&(y.clearcoatNormalMap.value=v.clearcoatNormalMap,t(v.clearcoatNormalMap,y.clearcoatNormalMapTransform),y.clearcoatNormalScale.value.copy(v.clearcoatNormalScale),v.side===Yf&&y.clearcoatNormalScale.value.negate())),v.dispersion>0&&(y.dispersion.value=v.dispersion),v.iridescence>0&&(y.iridescence.value=v.iridescence,y.iridescenceIOR.value=v.iridescenceIOR,y.iridescenceThicknessMinimum.value=v.iridescenceThicknessRange[0],y.iridescenceThicknessMaximum.value=v.iridescenceThicknessRange[1],v.iridescenceMap&&(y.iridescenceMap.value=v.iridescenceMap,t(v.iridescenceMap,y.iridescenceMapTransform)),v.iridescenceThicknessMap&&(y.iridescenceThicknessMap.value=v.iridescenceThicknessMap,t(v.iridescenceThicknessMap,y.iridescenceThicknessMapTransform))),v.transmission>0&&(y.transmission.value=v.transmission,y.transmissionSamplerMap.value=x.texture,y.transmissionSamplerSize.value.set(x.width,x.height),v.transmissionMap&&(y.transmissionMap.value=v.transmissionMap,t(v.transmissionMap,y.transmissionMapTransform)),y.thickness.value=v.thickness,v.thicknessMap&&(y.thicknessMap.value=v.thicknessMap,t(v.thicknessMap,y.thicknessMapTransform)),y.attenuationDistance.value=v.attenuationDistance,y.attenuationColor.value.copy(v.attenuationColor)),v.anisotropy>0&&(y.anisotropyVector.value.set(v.anisotropy*Math.cos(v.anisotropyRotation),v.anisotropy*Math.sin(v.anisotropyRotation)),v.anisotropyMap&&(y.anisotropyMap.value=v.anisotropyMap,t(v.anisotropyMap,y.anisotropyMapTransform))),y.specularIntensity.value=v.specularIntensity,y.specularColor.value.copy(v.specularColor),v.specularColorMap&&(y.specularColorMap.value=v.specularColorMap,t(v.specularColorMap,y.specularColorMapTransform)),v.specularIntensityMap&&(y.specularIntensityMap.value=v.specularIntensityMap,t(v.specularIntensityMap,y.specularIntensityMapTransform))}function p(y,v){v.matcap&&(y.matcap.value=v.matcap)}function _(y,v){const x=e.get(v).light;y.referencePosition.value.setFromMatrixPosition(x.matrixWorld),y.nearDistance.value=x.shadow.camera.near,y.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function NMe(n,e,t,r){let i={},s={},a=[];const o=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function l(x,E){const M=E.program;r.uniformBlockBinding(x,M)}function c(x,E){let M=i[x.id];M===void 0&&(p(x),M=u(x),i[x.id]=M,x.addEventListener("dispose",y));const O=E.program;r.updateUBOMapping(x,O);const N=e.render.frame;s[x.id]!==N&&(d(x),s[x.id]=N)}function u(x){const E=f();x.__bindingPointIndex=E;const M=n.createBuffer(),O=x.__size,N=x.usage;return n.bindBuffer(n.UNIFORM_BUFFER,M),n.bufferData(n.UNIFORM_BUFFER,O,N),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,E,M),M}function f(){for(let x=0;x<o;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(x){const E=i[x.id],M=x.uniforms,O=x.__cache;n.bindBuffer(n.UNIFORM_BUFFER,E);for(let N=0,I=M.length;N<I;N++){const D=Array.isArray(M[N])?M[N]:[M[N]];for(let V=0,G=D.length;V<G;V++){const Q=D[V];if(g(Q,N,V,O)===!0){const B=Q.__offset,$=Array.isArray(Q.value)?Q.value:[Q.value];let U=0;for(let J=0;J<$.length;J++){const W=$[J],q=_(W);typeof W=="number"||typeof W=="boolean"?(Q.__data[0]=W,n.bufferSubData(n.UNIFORM_BUFFER,B+U,Q.__data)):W.isMatrix3?(Q.__data[0]=W.elements[0],Q.__data[1]=W.elements[1],Q.__data[2]=W.elements[2],Q.__data[3]=0,Q.__data[4]=W.elements[3],Q.__data[5]=W.elements[4],Q.__data[6]=W.elements[5],Q.__data[7]=0,Q.__data[8]=W.elements[6],Q.__data[9]=W.elements[7],Q.__data[10]=W.elements[8],Q.__data[11]=0):(W.toArray(Q.__data,U),U+=q.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,B,Q.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function g(x,E,M,O){const N=x.value,I=E+"_"+M;if(O[I]===void 0)return typeof N=="number"||typeof N=="boolean"?O[I]=N:O[I]=N.clone(),!0;{const D=O[I];if(typeof N=="number"||typeof N=="boolean"){if(D!==N)return O[I]=N,!0}else if(D.equals(N)===!1)return D.copy(N),!0}return!1}function p(x){const E=x.uniforms;let M=0;const O=16;for(let I=0,D=E.length;I<D;I++){const V=Array.isArray(E[I])?E[I]:[E[I]];for(let G=0,Q=V.length;G<Q;G++){const B=V[G],$=Array.isArray(B.value)?B.value:[B.value];for(let U=0,J=$.length;U<J;U++){const W=$[U],q=_(W),Y=M%O,ae=Y%q.boundary,Z=Y+ae;M+=ae,Z!==0&&O-Z<q.storage&&(M+=O-Z),B.__data=new Float32Array(q.storage/Float32Array.BYTES_PER_ELEMENT),B.__offset=M,M+=q.storage}}}const N=M%O;return N>0&&(M+=O-N),x.__size=M,x.__cache={},this}function _(x){const E={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(E.boundary=4,E.storage=4):x.isVector2?(E.boundary=8,E.storage=8):x.isVector3||x.isColor?(E.boundary=16,E.storage=12):x.isVector4?(E.boundary=16,E.storage=16):x.isMatrix3?(E.boundary=48,E.storage=48):x.isMatrix4?(E.boundary=64,E.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),E}function y(x){const E=x.target;E.removeEventListener("dispose",y);const M=a.indexOf(E.__bindingPointIndex);a.splice(M,1),n.deleteBuffer(i[E.id]),delete i[E.id],delete s[E.id]}function v(){for(const x in i)n.deleteBuffer(i[x]);a=[],i={},s={}}return{bind:l,update:c,dispose:v}}class woe{constructor(e={}){const{canvas:t=dae(),context:r=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:d=!1}=e;this.isWebGLRenderer=!0;let g;if(r!==null){if(typeof WebGLRenderingContext<"u"&&r instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");g=r.getContextAttributes().alpha}else g=a;const p=new Uint32Array(4),_=new Int32Array(4);let y=null,v=null;const x=[],E=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=kv,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const M=this;let O=!1;this._outputColorSpace=ta;let N=0,I=0,D=null,V=-1,G=null;const Q=new xa,B=new xa;let $=null;const U=new cr(0);let J=0,W=t.width,q=t.height,Y=1,ae=null,Z=null;const K=new xa(0,0,W,q),ne=new xa(0,0,W,q);let le=!1;const ce=new Pw;let de=!1,Me=!1;const qe=new Qr,Pe=new Qr,Ce=new ut,Xe=new xa,$e={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let at=!1;function pt(){return D===null?Y:1}let oe=r;function Ue(We,At){return t.getContext(We,At)}try{const We={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${kw}`),t.addEventListener("webglcontextlost",nt,!1),t.addEventListener("webglcontextrestored",vt,!1),t.addEventListener("webglcontextcreationerror",Qe,!1),oe===null){const At="webgl2";if(oe=Ue(At,We),oe===null)throw Ue(At)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(We){throw console.error("THREE.WebGLRenderer: "+We.message),We}let Ge,ze,Be,me,Se,Ie,be,Ke,ot,lt,ct,Vt,kt,Ut,je,ge,se,_e,Ne,Le,ke,Re,st,Ve;function tt(){Ge=new GAe(oe),Ge.init(),Re=new Toe(oe,Ge),ze=new BAe(oe,Ge,e,Re),Be=new wMe(oe,Ge),ze.reverseDepthBuffer&&d&&Be.buffers.depth.setReversed(!0),me=new YAe(oe),Se=new hMe,Ie=new RMe(oe,Ge,Be,Se,ze,Re,me),be=new zAe(M),Ke=new VAe(M),ot=new ewe(oe),st=new LAe(oe,ot),lt=new $Ae(oe,ot,me,st),ct=new KAe(oe,lt,ot,me),Ne=new XAe(oe,ze,Ie),ge=new FAe(Se),Vt=new fMe(M,be,Ke,Ge,ze,st,ge),kt=new IMe(M,Se),Ut=new pMe,je=new bMe(Ge),_e=new DAe(M,be,Ke,Be,ct,g,l),se=new xMe(M,ct,ze),Ve=new NMe(oe,me,ze,Be),Le=new UAe(oe,Ge,me),ke=new WAe(oe,Ge,me),me.programs=Vt.programs,M.capabilities=ze,M.extensions=Ge,M.properties=Se,M.renderLists=Ut,M.shadowMap=se,M.state=Be,M.info=me}tt();const Ze=new kMe(M,oe);this.xr=Ze,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const We=Ge.get("WEBGL_lose_context");We&&We.loseContext()},this.forceContextRestore=function(){const We=Ge.get("WEBGL_lose_context");We&&We.restoreContext()},this.getPixelRatio=function(){return Y},this.setPixelRatio=function(We){We!==void 0&&(Y=We,this.setSize(W,q,!1))},this.getSize=function(We){return We.set(W,q)},this.setSize=function(We,At,Wt=!0){if(Ze.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}W=We,q=At,t.width=Math.floor(We*Y),t.height=Math.floor(At*Y),Wt===!0&&(t.style.width=We+"px",t.style.height=At+"px"),this.setViewport(0,0,We,At)},this.getDrawingBufferSize=function(We){return We.set(W*Y,q*Y).floor()},this.setDrawingBufferSize=function(We,At,Wt){W=We,q=At,Y=Wt,t.width=Math.floor(We*Wt),t.height=Math.floor(At*Wt),this.setViewport(0,0,We,At)},this.getCurrentViewport=function(We){return We.copy(Q)},this.getViewport=function(We){return We.copy(K)},this.setViewport=function(We,At,Wt,Kt){We.isVector4?K.set(We.x,We.y,We.z,We.w):K.set(We,At,Wt,Kt),Be.viewport(Q.copy(K).multiplyScalar(Y).round())},this.getScissor=function(We){return We.copy(ne)},this.setScissor=function(We,At,Wt,Kt){We.isVector4?ne.set(We.x,We.y,We.z,We.w):ne.set(We,At,Wt,Kt),Be.scissor(B.copy(ne).multiplyScalar(Y).round())},this.getScissorTest=function(){return le},this.setScissorTest=function(We){Be.setScissorTest(le=We)},this.setOpaqueSort=function(We){ae=We},this.setTransparentSort=function(We){Z=We},this.getClearColor=function(We){return We.copy(_e.getClearColor())},this.setClearColor=function(){_e.setClearColor(...arguments)},this.getClearAlpha=function(){return _e.getClearAlpha()},this.setClearAlpha=function(){_e.setClearAlpha(...arguments)},this.clear=function(We=!0,At=!0,Wt=!0){let Kt=0;if(We){let Lt=!1;if(D!==null){const yn=D.texture.format;Lt=yn===Xk||yn===e4||yn===Yk}if(Lt){const yn=D.texture.type,zn=yn===zl||yn===Uv||yn===FT||yn===gE||yn===ZL||yn===QL,En=_e.getClearColor(),tr=_e.getClearAlpha(),Ir=En.r,Er=En.g,rr=En.b;zn?(p[0]=Ir,p[1]=Er,p[2]=rr,p[3]=tr,oe.clearBufferuiv(oe.COLOR,0,p)):(_[0]=Ir,_[1]=Er,_[2]=rr,_[3]=tr,oe.clearBufferiv(oe.COLOR,0,_))}else Kt|=oe.COLOR_BUFFER_BIT}At&&(Kt|=oe.DEPTH_BUFFER_BIT),Wt&&(Kt|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(Kt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nt,!1),t.removeEventListener("webglcontextrestored",vt,!1),t.removeEventListener("webglcontextcreationerror",Qe,!1),_e.dispose(),Ut.dispose(),je.dispose(),Se.dispose(),be.dispose(),Ke.dispose(),ct.dispose(),st.dispose(),Ve.dispose(),Vt.dispose(),Ze.dispose(),Ze.removeEventListener("sessionstart",Bt),Ze.removeEventListener("sessionend",Yt),Mt.stop()};function nt(We){We.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),O=!0}function vt(){console.log("THREE.WebGLRenderer: Context Restored."),O=!1;const We=me.autoReset,At=se.enabled,Wt=se.autoUpdate,Kt=se.needsUpdate,Lt=se.type;tt(),me.autoReset=We,se.enabled=At,se.autoUpdate=Wt,se.needsUpdate=Kt,se.type=Lt}function Qe(We){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",We.statusMessage)}function ht(We){const At=We.target;At.removeEventListener("dispose",ht),mt(At)}function mt(We){ft(We),Se.remove(We)}function ft(We){const At=Se.get(We).programs;At!==void 0&&(At.forEach(function(Wt){Vt.releaseProgram(Wt)}),We.isShaderMaterial&&Vt.releaseShaderCache(We))}this.renderBufferDirect=function(We,At,Wt,Kt,Lt,yn){At===null&&(At=$e);const zn=Lt.isMesh&&Lt.matrixWorld.determinant()<0,En=Oi(We,At,Wt,Kt,Lt);Be.setMaterial(Kt,zn);let tr=Wt.index,Ir=1;if(Kt.wireframe===!0){if(tr=lt.getWireframeAttribute(Wt),tr===void 0)return;Ir=2}const Er=Wt.drawRange,rr=Wt.attributes.position;let Dr=Er.start*Ir,ri=(Er.start+Er.count)*Ir;yn!==null&&(Dr=Math.max(Dr,yn.start*Ir),ri=Math.min(ri,(yn.start+yn.count)*Ir)),tr!==null?(Dr=Math.max(Dr,0),ri=Math.min(ri,tr.count)):rr!=null&&(Dr=Math.max(Dr,0),ri=Math.min(ri,rr.count));const ha=ri-Dr;if(ha<0||ha===1/0)return;st.setup(Lt,Kt,En,Wt,tr);let Cr,ii=Le;if(tr!==null&&(Cr=ot.get(tr),ii=ke,ii.setIndex(Cr)),Lt.isMesh)Kt.wireframe===!0?(Be.setLineWidth(Kt.wireframeLinewidth*pt()),ii.setMode(oe.LINES)):ii.setMode(oe.TRIANGLES);else if(Lt.isLine){let Tr=Kt.linewidth;Tr===void 0&&(Tr=1),Be.setLineWidth(Tr*pt()),Lt.isLineSegments?ii.setMode(oe.LINES):Lt.isLineLoop?ii.setMode(oe.LINE_LOOP):ii.setMode(oe.LINE_STRIP)}else Lt.isPoints?ii.setMode(oe.POINTS):Lt.isSprite&&ii.setMode(oe.TRIANGLES);if(Lt.isBatchedMesh)if(Lt._multiDrawInstances!==null)CN("THREE.WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),ii.renderMultiDrawInstances(Lt._multiDrawStarts,Lt._multiDrawCounts,Lt._multiDrawCount,Lt._multiDrawInstances);else if(Ge.get("WEBGL_multi_draw"))ii.renderMultiDraw(Lt._multiDrawStarts,Lt._multiDrawCounts,Lt._multiDrawCount);else{const Tr=Lt._multiDrawStarts,Pr=Lt._multiDrawCounts,Cn=Lt._multiDrawCount,zr=tr?ot.get(tr).bytesPerElement:1,Do=Se.get(Kt).currentProgram.getUniforms();for(let ls=0;ls<Cn;ls++)Do.setValue(oe,"_gl_DrawID",ls),ii.render(Tr[ls]/zr,Pr[ls])}else if(Lt.isInstancedMesh)ii.renderInstances(Dr,ha,Lt.count);else if(Wt.isInstancedBufferGeometry){const Tr=Wt._maxInstanceCount!==void 0?Wt._maxInstanceCount:1/0,Pr=Math.min(Wt.instanceCount,Tr);ii.renderInstances(Dr,ha,Pr)}else ii.render(Dr,ha)};function _t(We,At,Wt){We.transparent===!0&&We.side===$f&&We.forceSinglePass===!1?(We.side=Yf,We.needsUpdate=!0,er(We,At,Wt),We.side=Lv,We.needsUpdate=!0,er(We,At,Wt),We.side=$f):er(We,At,Wt)}this.compile=function(We,At,Wt=null){Wt===null&&(Wt=We),v=je.get(Wt),v.init(At),E.push(v),Wt.traverseVisible(function(Lt){Lt.isLight&&Lt.layers.test(At.layers)&&(v.pushLight(Lt),Lt.castShadow&&v.pushShadow(Lt))}),We!==Wt&&We.traverseVisible(function(Lt){Lt.isLight&&Lt.layers.test(At.layers)&&(v.pushLight(Lt),Lt.castShadow&&v.pushShadow(Lt))}),v.setupLights();const Kt=new Set;return We.traverse(function(Lt){if(!(Lt.isMesh||Lt.isPoints||Lt.isLine||Lt.isSprite))return;const yn=Lt.material;if(yn)if(Array.isArray(yn))for(let zn=0;zn<yn.length;zn++){const En=yn[zn];_t(En,Wt,Lt),Kt.add(En)}else _t(yn,Wt,Lt),Kt.add(yn)}),v=E.pop(),Kt},this.compileAsync=function(We,At,Wt=null){const Kt=this.compile(We,At,Wt);return new Promise(Lt=>{function yn(){if(Kt.forEach(function(zn){Se.get(zn).currentProgram.isReady()&&Kt.delete(zn)}),Kt.size===0){Lt(We);return}setTimeout(yn,10)}Ge.get("KHR_parallel_shader_compile")!==null?yn():setTimeout(yn,10)})};let gn=null;function _n(We){gn&&gn(We)}function Bt(){Mt.stop()}function Yt(){Mt.start()}const Mt=new yoe;Mt.setAnimationLoop(_n),typeof self<"u"&&Mt.setContext(self),this.setAnimationLoop=function(We){gn=We,Ze.setAnimationLoop(We),We===null?Mt.stop():Mt.start()},Ze.addEventListener("sessionstart",Bt),Ze.addEventListener("sessionend",Yt),this.render=function(We,At){if(At!==void 0&&At.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(O===!0)return;if(We.matrixWorldAutoUpdate===!0&&We.updateMatrixWorld(),At.parent===null&&At.matrixWorldAutoUpdate===!0&&At.updateMatrixWorld(),Ze.enabled===!0&&Ze.isPresenting===!0&&(Ze.cameraAutoUpdate===!0&&Ze.updateCamera(At),At=Ze.getCamera()),We.isScene===!0&&We.onBeforeRender(M,We,At,D),v=je.get(We,E.length),v.init(At),E.push(v),Pe.multiplyMatrices(At.projectionMatrix,At.matrixWorldInverse),ce.setFromProjectionMatrix(Pe),Me=this.localClippingEnabled,de=ge.init(this.clippingPlanes,Me),y=Ut.get(We,x.length),y.init(),x.push(y),Ze.enabled===!0&&Ze.isPresenting===!0){const yn=M.xr.getDepthSensingMesh();yn!==null&&fn(yn,At,-1/0,M.sortObjects)}fn(We,At,0,M.sortObjects),y.finish(),M.sortObjects===!0&&y.sort(ae,Z),at=Ze.enabled===!1||Ze.isPresenting===!1||Ze.hasDepthSensing()===!1,at&&_e.addToRenderList(y,We),this.info.render.frame++,de===!0&&ge.beginShadows();const Wt=v.state.shadowsArray;se.render(Wt,We,At),de===!0&&ge.endShadows(),this.info.autoReset===!0&&this.info.reset();const Kt=y.opaque,Lt=y.transmissive;if(v.setupLights(),At.isArrayCamera){const yn=At.cameras;if(Lt.length>0)for(let zn=0,En=yn.length;zn<En;zn++){const tr=yn[zn];cn(Kt,Lt,We,tr)}at&&_e.render(We);for(let zn=0,En=yn.length;zn<En;zn++){const tr=yn[zn];Bn(y,We,tr,tr.viewport)}}else Lt.length>0&&cn(Kt,Lt,We,At),at&&_e.render(We),Bn(y,We,At);D!==null&&I===0&&(Ie.updateMultisampleRenderTarget(D),Ie.updateRenderTargetMipmap(D)),We.isScene===!0&&We.onAfterRender(M,We,At),st.resetDefaultState(),V=-1,G=null,E.pop(),E.length>0?(v=E[E.length-1],de===!0&&ge.setGlobalState(M.clippingPlanes,v.state.camera)):v=null,x.pop(),x.length>0?y=x[x.length-1]:y=null};function fn(We,At,Wt,Kt){if(We.visible===!1)return;if(We.layers.test(At.layers)){if(We.isGroup)Wt=We.renderOrder;else if(We.isLOD)We.autoUpdate===!0&&We.update(At);else if(We.isLight)v.pushLight(We),We.castShadow&&v.pushShadow(We);else if(We.isSprite){if(!We.frustumCulled||ce.intersectsSprite(We)){Kt&&Xe.setFromMatrixPosition(We.matrixWorld).applyMatrix4(Pe);const zn=ct.update(We),En=We.material;En.visible&&y.push(We,zn,En,Wt,Xe.z,null)}}else if((We.isMesh||We.isLine||We.isPoints)&&(!We.frustumCulled||ce.intersectsObject(We))){const zn=ct.update(We),En=We.material;if(Kt&&(We.boundingSphere!==void 0?(We.boundingSphere===null&&We.computeBoundingSphere(),Xe.copy(We.boundingSphere.center)):(zn.boundingSphere===null&&zn.computeBoundingSphere(),Xe.copy(zn.boundingSphere.center)),Xe.applyMatrix4(We.matrixWorld).applyMatrix4(Pe)),Array.isArray(En)){const tr=zn.groups;for(let Ir=0,Er=tr.length;Ir<Er;Ir++){const rr=tr[Ir],Dr=En[rr.materialIndex];Dr&&Dr.visible&&y.push(We,zn,Dr,Wt,Xe.z,rr)}}else En.visible&&y.push(We,zn,En,Wt,Xe.z,null)}}const yn=We.children;for(let zn=0,En=yn.length;zn<En;zn++)fn(yn[zn],At,Wt,Kt)}function Bn(We,At,Wt,Kt){const Lt=We.opaque,yn=We.transmissive,zn=We.transparent;v.setupLightsView(Wt),de===!0&&ge.setGlobalState(M.clippingPlanes,Wt),Kt&&Be.viewport(Q.copy(Kt)),Lt.length>0&&In(Lt,At,Wt),yn.length>0&&In(yn,At,Wt),zn.length>0&&In(zn,At,Wt),Be.buffers.depth.setTest(!0),Be.buffers.depth.setMask(!0),Be.buffers.color.setMask(!0),Be.setPolygonOffset(!1)}function cn(We,At,Wt,Kt){if((Wt.isScene===!0?Wt.overrideMaterial:null)!==null)return;v.state.transmissionRenderTarget[Kt.id]===void 0&&(v.state.transmissionRenderTarget[Kt.id]=new Sf(1,1,{generateMipmaps:!0,type:Ge.has("EXT_color_buffer_half_float")||Ge.has("EXT_color_buffer_float")?db:zl,minFilter:Tv,samples:4,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Sa.workingColorSpace}));const yn=v.state.transmissionRenderTarget[Kt.id],zn=Kt.viewport||Q;yn.setSize(zn.z*M.transmissionResolutionScale,zn.w*M.transmissionResolutionScale);const En=M.getRenderTarget();M.setRenderTarget(yn),M.getClearColor(U),J=M.getClearAlpha(),J<1&&M.setClearColor(16777215,.5),M.clear(),at&&_e.render(Wt);const tr=M.toneMapping;M.toneMapping=kv;const Ir=Kt.viewport;if(Kt.viewport!==void 0&&(Kt.viewport=void 0),v.setupLightsView(Kt),de===!0&&ge.setGlobalState(M.clippingPlanes,Kt),In(We,Wt,Kt),Ie.updateMultisampleRenderTarget(yn),Ie.updateRenderTargetMipmap(yn),Ge.has("WEBGL_multisampled_render_to_texture")===!1){let Er=!1;for(let rr=0,Dr=At.length;rr<Dr;rr++){const ri=At[rr],ha=ri.object,Cr=ri.geometry,ii=ri.material,Tr=ri.group;if(ii.side===$f&&ha.layers.test(Kt.layers)){const Pr=ii.side;ii.side=Yf,ii.needsUpdate=!0,$n(ha,Wt,Kt,Cr,ii,Tr),ii.side=Pr,ii.needsUpdate=!0,Er=!0}}Er===!0&&(Ie.updateMultisampleRenderTarget(yn),Ie.updateRenderTargetMipmap(yn))}M.setRenderTarget(En),M.setClearColor(U,J),Ir!==void 0&&(Kt.viewport=Ir),M.toneMapping=tr}function In(We,At,Wt){const Kt=At.isScene===!0?At.overrideMaterial:null;for(let Lt=0,yn=We.length;Lt<yn;Lt++){const zn=We[Lt],En=zn.object,tr=zn.geometry,Ir=zn.group;let Er=zn.material;Er.allowOverride===!0&&Kt!==null&&(Er=Kt),En.layers.test(Wt.layers)&&$n(En,At,Wt,tr,Er,Ir)}}function $n(We,At,Wt,Kt,Lt,yn){We.onBeforeRender(M,At,Wt,Kt,Lt,yn),We.modelViewMatrix.multiplyMatrices(Wt.matrixWorldInverse,We.matrixWorld),We.normalMatrix.getNormalMatrix(We.modelViewMatrix),Lt.onBeforeRender(M,At,Wt,Kt,We,yn),Lt.transparent===!0&&Lt.side===$f&&Lt.forceSinglePass===!1?(Lt.side=Yf,Lt.needsUpdate=!0,M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),Lt.side=Lv,Lt.needsUpdate=!0,M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),Lt.side=$f):M.renderBufferDirect(Wt,At,Kt,Lt,We,yn),We.onAfterRender(M,At,Wt,Kt,Lt,yn)}function er(We,At,Wt){At.isScene!==!0&&(At=$e);const Kt=Se.get(We),Lt=v.state.lights,yn=v.state.shadowsArray,zn=Lt.state.version,En=Vt.getParameters(We,Lt.state,yn,At,Wt),tr=Vt.getProgramCacheKey(En);let Ir=Kt.programs;Kt.environment=We.isMeshStandardMaterial?At.environment:null,Kt.fog=At.fog,Kt.envMap=(We.isMeshStandardMaterial?Ke:be).get(We.envMap||Kt.environment),Kt.envMapRotation=Kt.environment!==null&&We.envMap===null?At.environmentRotation:We.envMapRotation,Ir===void 0&&(We.addEventListener("dispose",ht),Ir=new Map,Kt.programs=Ir);let Er=Ir.get(tr);if(Er!==void 0){if(Kt.currentProgram===Er&&Kt.lightsStateVersion===zn)return di(We,En),Er}else En.uniforms=Vt.getUniforms(We),We.onBeforeCompile(En,M),Er=Vt.acquireProgram(En,tr),Ir.set(tr,Er),Kt.uniforms=En.uniforms;const rr=Kt.uniforms;return(!We.isShaderMaterial&&!We.isRawShaderMaterial||We.clipping===!0)&&(rr.clippingPlanes=ge.uniform),di(We,En),Kt.needsLights=pi(We),Kt.lightsStateVersion=zn,Kt.needsLights&&(rr.ambientLightColor.value=Lt.state.ambient,rr.lightProbe.value=Lt.state.probe,rr.directionalLights.value=Lt.state.directional,rr.directionalLightShadows.value=Lt.state.directionalShadow,rr.spotLights.value=Lt.state.spot,rr.spotLightShadows.value=Lt.state.spotShadow,rr.rectAreaLights.value=Lt.state.rectArea,rr.ltc_1.value=Lt.state.rectAreaLTC1,rr.ltc_2.value=Lt.state.rectAreaLTC2,rr.pointLights.value=Lt.state.point,rr.pointLightShadows.value=Lt.state.pointShadow,rr.hemisphereLights.value=Lt.state.hemi,rr.directionalShadowMap.value=Lt.state.directionalShadowMap,rr.directionalShadowMatrix.value=Lt.state.directionalShadowMatrix,rr.spotShadowMap.value=Lt.state.spotShadowMap,rr.spotLightMatrix.value=Lt.state.spotLightMatrix,rr.spotLightMap.value=Lt.state.spotLightMap,rr.pointShadowMap.value=Lt.state.pointShadowMap,rr.pointShadowMatrix.value=Lt.state.pointShadowMatrix),Kt.currentProgram=Er,Kt.uniformsList=null,Er}function as(We){if(We.uniformsList===null){const At=We.currentProgram.getUniforms();We.uniformsList=kN.seqWithValue(At.seq,We.uniforms)}return We.uniformsList}function di(We,At){const Wt=Se.get(We);Wt.outputColorSpace=At.outputColorSpace,Wt.batching=At.batching,Wt.batchingColor=At.batchingColor,Wt.instancing=At.instancing,Wt.instancingColor=At.instancingColor,Wt.instancingMorph=At.instancingMorph,Wt.skinning=At.skinning,Wt.morphTargets=At.morphTargets,Wt.morphNormals=At.morphNormals,Wt.morphColors=At.morphColors,Wt.morphTargetsCount=At.morphTargetsCount,Wt.numClippingPlanes=At.numClippingPlanes,Wt.numIntersection=At.numClipIntersection,Wt.vertexAlphas=At.vertexAlphas,Wt.vertexTangents=At.vertexTangents,Wt.toneMapping=At.toneMapping}function Oi(We,At,Wt,Kt,Lt){At.isScene!==!0&&(At=$e),Ie.resetTextureUnits();const yn=At.fog,zn=Kt.isMeshStandardMaterial?At.environment:null,En=D===null?M.outputColorSpace:D.isXRRenderTarget===!0?D.texture.colorSpace:Bv,tr=(Kt.isMeshStandardMaterial?Ke:be).get(Kt.envMap||zn),Ir=Kt.vertexColors===!0&&!!Wt.attributes.color&&Wt.attributes.color.itemSize===4,Er=!!Wt.attributes.tangent&&(!!Kt.normalMap||Kt.anisotropy>0),rr=!!Wt.morphAttributes.position,Dr=!!Wt.morphAttributes.normal,ri=!!Wt.morphAttributes.color;let ha=kv;Kt.toneMapped&&(D===null||D.isXRRenderTarget===!0)&&(ha=M.toneMapping);const Cr=Wt.morphAttributes.position||Wt.morphAttributes.normal||Wt.morphAttributes.color,ii=Cr!==void 0?Cr.length:0,Tr=Se.get(Kt),Pr=v.state.lights;if(de===!0&&(Me===!0||We!==G)){const ur=We===G&&Kt.id===V;ge.setState(Kt,We,ur)}let Cn=!1;Kt.version===Tr.__version?(Tr.needsLights&&Tr.lightsStateVersion!==Pr.state.version||Tr.outputColorSpace!==En||Lt.isBatchedMesh&&Tr.batching===!1||!Lt.isBatchedMesh&&Tr.batching===!0||Lt.isBatchedMesh&&Tr.batchingColor===!0&&Lt.colorTexture===null||Lt.isBatchedMesh&&Tr.batchingColor===!1&&Lt.colorTexture!==null||Lt.isInstancedMesh&&Tr.instancing===!1||!Lt.isInstancedMesh&&Tr.instancing===!0||Lt.isSkinnedMesh&&Tr.skinning===!1||!Lt.isSkinnedMesh&&Tr.skinning===!0||Lt.isInstancedMesh&&Tr.instancingColor===!0&&Lt.instanceColor===null||Lt.isInstancedMesh&&Tr.instancingColor===!1&&Lt.instanceColor!==null||Lt.isInstancedMesh&&Tr.instancingMorph===!0&&Lt.morphTexture===null||Lt.isInstancedMesh&&Tr.instancingMorph===!1&&Lt.morphTexture!==null||Tr.envMap!==tr||Kt.fog===!0&&Tr.fog!==yn||Tr.numClippingPlanes!==void 0&&(Tr.numClippingPlanes!==ge.numPlanes||Tr.numIntersection!==ge.numIntersection)||Tr.vertexAlphas!==Ir||Tr.vertexTangents!==Er||Tr.morphTargets!==rr||Tr.morphNormals!==Dr||Tr.morphColors!==ri||Tr.toneMapping!==ha||Tr.morphTargetsCount!==ii)&&(Cn=!0):(Cn=!0,Tr.__version=Kt.version);let zr=Tr.currentProgram;Cn===!0&&(zr=er(Kt,At,Lt));let Do=!1,ls=!1,Lo=!1;const cs=zr.getUniforms(),Xn=Tr.uniforms;if(Be.useProgram(zr.program)&&(Do=!0,ls=!0,Lo=!0),Kt.id!==V&&(V=Kt.id,ls=!0),Do||G!==We){Be.buffers.depth.getReversed()?(qe.copy(We.projectionMatrix),EEe(qe),xEe(qe),cs.setValue(oe,"projectionMatrix",qe)):cs.setValue(oe,"projectionMatrix",We.projectionMatrix),cs.setValue(oe,"viewMatrix",We.matrixWorldInverse);const Fs=cs.map.cameraPosition;Fs!==void 0&&Fs.setValue(oe,Ce.setFromMatrixPosition(We.matrixWorld)),ze.logarithmicDepthBuffer&&cs.setValue(oe,"logDepthBufFC",2/(Math.log(We.far+1)/Math.LN2)),(Kt.isMeshPhongMaterial||Kt.isMeshToonMaterial||Kt.isMeshLambertMaterial||Kt.isMeshBasicMaterial||Kt.isMeshStandardMaterial||Kt.isShaderMaterial)&&cs.setValue(oe,"isOrthographic",We.isOrthographicCamera===!0),G!==We&&(G=We,ls=!0,Lo=!0)}if(Lt.isSkinnedMesh){cs.setOptional(oe,Lt,"bindMatrix"),cs.setOptional(oe,Lt,"bindMatrixInverse");const ur=Lt.skeleton;ur&&(ur.boneTexture===null&&ur.computeBoneTexture(),cs.setValue(oe,"boneTexture",ur.boneTexture,Ie))}Lt.isBatchedMesh&&(cs.setOptional(oe,Lt,"batchingTexture"),cs.setValue(oe,"batchingTexture",Lt._matricesTexture,Ie),cs.setOptional(oe,Lt,"batchingIdTexture"),cs.setValue(oe,"batchingIdTexture",Lt._indirectTexture,Ie),cs.setOptional(oe,Lt,"batchingColorTexture"),Lt._colorsTexture!==null&&cs.setValue(oe,"batchingColorTexture",Lt._colorsTexture,Ie));const Jr=Wt.morphAttributes;if((Jr.position!==void 0||Jr.normal!==void 0||Jr.color!==void 0)&&Ne.update(Lt,Wt,zr),(ls||Tr.receiveShadow!==Lt.receiveShadow)&&(Tr.receiveShadow=Lt.receiveShadow,cs.setValue(oe,"receiveShadow",Lt.receiveShadow)),Kt.isMeshGouraudMaterial&&Kt.envMap!==null&&(Xn.envMap.value=tr,Xn.flipEnvMap.value=tr.isCubeTexture&&tr.isRenderTargetTexture===!1?-1:1),Kt.isMeshStandardMaterial&&Kt.envMap===null&&At.environment!==null&&(Xn.envMapIntensity.value=At.environmentIntensity),ls&&(cs.setValue(oe,"toneMappingExposure",M.toneMappingExposure),Tr.needsLights&&Bs(Xn,Lo),yn&&Kt.fog===!0&&kt.refreshFogUniforms(Xn,yn),kt.refreshMaterialUniforms(Xn,Kt,Y,q,v.state.transmissionRenderTarget[We.id]),kN.upload(oe,as(Tr),Xn,Ie)),Kt.isShaderMaterial&&Kt.uniformsNeedUpdate===!0&&(kN.upload(oe,as(Tr),Xn,Ie),Kt.uniformsNeedUpdate=!1),Kt.isSpriteMaterial&&cs.setValue(oe,"center",Lt.center),cs.setValue(oe,"modelViewMatrix",Lt.modelViewMatrix),cs.setValue(oe,"normalMatrix",Lt.normalMatrix),cs.setValue(oe,"modelMatrix",Lt.matrixWorld),Kt.isShaderMaterial||Kt.isRawShaderMaterial){const ur=Kt.uniformsGroups;for(let Fs=0,bo=ur.length;Fs<bo;Fs++){const da=ur[Fs];Ve.update(da,zr),Ve.bind(da,zr)}}return zr}function Bs(We,At){We.ambientLightColor.needsUpdate=At,We.lightProbe.needsUpdate=At,We.directionalLights.needsUpdate=At,We.directionalLightShadows.needsUpdate=At,We.pointLights.needsUpdate=At,We.pointLightShadows.needsUpdate=At,We.spotLights.needsUpdate=At,We.spotLightShadows.needsUpdate=At,We.rectAreaLights.needsUpdate=At,We.hemisphereLights.needsUpdate=At}function pi(We){return We.isMeshLambertMaterial||We.isMeshToonMaterial||We.isMeshPhongMaterial||We.isMeshStandardMaterial||We.isShadowMaterial||We.isShaderMaterial&&We.lights===!0}this.getActiveCubeFace=function(){return N},this.getActiveMipmapLevel=function(){return I},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(We,At,Wt){const Kt=Se.get(We);Kt.__autoAllocateDepthBuffer=We.resolveDepthBuffer===!1,Kt.__autoAllocateDepthBuffer===!1&&(Kt.__useRenderToTexture=!1),Se.get(We.texture).__webglTexture=At,Se.get(We.depthTexture).__webglTexture=Kt.__autoAllocateDepthBuffer?void 0:Wt,Kt.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(We,At){const Wt=Se.get(We);Wt.__webglFramebuffer=At,Wt.__useDefaultFramebuffer=At===void 0};const ws=oe.createFramebuffer();this.setRenderTarget=function(We,At=0,Wt=0){D=We,N=At,I=Wt;let Kt=!0,Lt=null,yn=!1,zn=!1;if(We){const tr=Se.get(We);if(tr.__useDefaultFramebuffer!==void 0)Be.bindFramebuffer(oe.FRAMEBUFFER,null),Kt=!1;else if(tr.__webglFramebuffer===void 0)Ie.setupRenderTarget(We);else if(tr.__hasExternalTextures)Ie.rebindTextures(We,Se.get(We.texture).__webglTexture,Se.get(We.depthTexture).__webglTexture);else if(We.depthBuffer){const rr=We.depthTexture;if(tr.__boundDepthTexture!==rr){if(rr!==null&&Se.has(rr)&&(We.width!==rr.image.width||We.height!==rr.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");Ie.setupDepthRenderbuffer(We)}}const Ir=We.texture;(Ir.isData3DTexture||Ir.isDataArrayTexture||Ir.isCompressedArrayTexture)&&(zn=!0);const Er=Se.get(We).__webglFramebuffer;We.isWebGLCubeRenderTarget?(Array.isArray(Er[At])?Lt=Er[At][Wt]:Lt=Er[At],yn=!0):We.samples>0&&Ie.useMultisampledRTT(We)===!1?Lt=Se.get(We).__webglMultisampledFramebuffer:Array.isArray(Er)?Lt=Er[Wt]:Lt=Er,Q.copy(We.viewport),B.copy(We.scissor),$=We.scissorTest}else Q.copy(K).multiplyScalar(Y).floor(),B.copy(ne).multiplyScalar(Y).floor(),$=le;if(Wt!==0&&(Lt=ws),Be.bindFramebuffer(oe.FRAMEBUFFER,Lt)&&Kt&&Be.drawBuffers(We,Lt),Be.viewport(Q),Be.scissor(B),Be.setScissorTest($),yn){const tr=Se.get(We.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+At,tr.__webglTexture,Wt)}else if(zn){const tr=Se.get(We.texture),Ir=At;oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,tr.__webglTexture,Wt,Ir)}else if(We!==null&&Wt!==0){const tr=Se.get(We.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,tr.__webglTexture,Wt)}V=-1},this.readRenderTargetPixels=function(We,At,Wt,Kt,Lt,yn,zn){if(!(We&&We.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let En=Se.get(We).__webglFramebuffer;if(We.isWebGLCubeRenderTarget&&zn!==void 0&&(En=En[zn]),En){Be.bindFramebuffer(oe.FRAMEBUFFER,En);try{const tr=We.texture,Ir=tr.format,Er=tr.type;if(!ze.textureFormatReadable(Ir)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!ze.textureTypeReadable(Er)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}At>=0&&At<=We.width-Kt&&Wt>=0&&Wt<=We.height-Lt&&oe.readPixels(At,Wt,Kt,Lt,Re.convert(Ir),Re.convert(Er),yn)}finally{const tr=D!==null?Se.get(D).__webglFramebuffer:null;Be.bindFramebuffer(oe.FRAMEBUFFER,tr)}}},this.readRenderTargetPixelsAsync=async function(We,At,Wt,Kt,Lt,yn,zn){if(!(We&&We.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let En=Se.get(We).__webglFramebuffer;if(We.isWebGLCubeRenderTarget&&zn!==void 0&&(En=En[zn]),En)if(At>=0&&At<=We.width-Kt&&Wt>=0&&Wt<=We.height-Lt){Be.bindFramebuffer(oe.FRAMEBUFFER,En);const tr=We.texture,Ir=tr.format,Er=tr.type;if(!ze.textureFormatReadable(Ir))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!ze.textureTypeReadable(Er))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const rr=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,rr),oe.bufferData(oe.PIXEL_PACK_BUFFER,yn.byteLength,oe.STREAM_READ),oe.readPixels(At,Wt,Kt,Lt,Re.convert(Ir),Re.convert(Er),0);const Dr=D!==null?Se.get(D).__webglFramebuffer:null;Be.bindFramebuffer(oe.FRAMEBUFFER,Dr);const ri=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await SEe(oe,ri,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,rr),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,yn),oe.deleteBuffer(rr),oe.deleteSync(ri),yn}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(We,At=null,Wt=0){const Kt=Math.pow(2,-Wt),Lt=Math.floor(We.image.width*Kt),yn=Math.floor(We.image.height*Kt),zn=At!==null?At.x:0,En=At!==null?At.y:0;Ie.setTexture2D(We,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,Wt,0,0,zn,En,Lt,yn),Be.unbindTexture()};const na=oe.createFramebuffer(),os=oe.createFramebuffer();this.copyTextureToTexture=function(We,At,Wt=null,Kt=null,Lt=0,yn=null){yn===null&&(Lt!==0?(CN("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),yn=Lt,Lt=0):yn=0);let zn,En,tr,Ir,Er,rr,Dr,ri,ha;const Cr=We.isCompressedTexture?We.mipmaps[yn]:We.image;if(Wt!==null)zn=Wt.max.x-Wt.min.x,En=Wt.max.y-Wt.min.y,tr=Wt.isBox3?Wt.max.z-Wt.min.z:1,Ir=Wt.min.x,Er=Wt.min.y,rr=Wt.isBox3?Wt.min.z:0;else{const Jr=Math.pow(2,-Lt);zn=Math.floor(Cr.width*Jr),En=Math.floor(Cr.height*Jr),We.isDataArrayTexture?tr=Cr.depth:We.isData3DTexture?tr=Math.floor(Cr.depth*Jr):tr=1,Ir=0,Er=0,rr=0}Kt!==null?(Dr=Kt.x,ri=Kt.y,ha=Kt.z):(Dr=0,ri=0,ha=0);const ii=Re.convert(At.format),Tr=Re.convert(At.type);let Pr;At.isData3DTexture?(Ie.setTexture3D(At,0),Pr=oe.TEXTURE_3D):At.isDataArrayTexture||At.isCompressedArrayTexture?(Ie.setTexture2DArray(At,0),Pr=oe.TEXTURE_2D_ARRAY):(Ie.setTexture2D(At,0),Pr=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,At.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,At.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,At.unpackAlignment);const Cn=oe.getParameter(oe.UNPACK_ROW_LENGTH),zr=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Do=oe.getParameter(oe.UNPACK_SKIP_PIXELS),ls=oe.getParameter(oe.UNPACK_SKIP_ROWS),Lo=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Cr.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Cr.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Ir),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Er),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,rr);const cs=We.isDataArrayTexture||We.isData3DTexture,Xn=At.isDataArrayTexture||At.isData3DTexture;if(We.isDepthTexture){const Jr=Se.get(We),ur=Se.get(At),Fs=Se.get(Jr.__renderTarget),bo=Se.get(ur.__renderTarget);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,Fs.__webglFramebuffer),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,bo.__webglFramebuffer);for(let da=0;da<tr;da++)cs&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Se.get(We).__webglTexture,Lt,rr+da),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Se.get(At).__webglTexture,yn,ha+da)),oe.blitFramebuffer(Ir,Er,zn,En,Dr,ri,zn,En,oe.DEPTH_BUFFER_BIT,oe.NEAREST);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(Lt!==0||We.isRenderTargetTexture||Se.has(We)){const Jr=Se.get(We),ur=Se.get(At);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,na),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,os);for(let Fs=0;Fs<tr;Fs++)cs?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,Jr.__webglTexture,Lt,rr+Fs):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,Jr.__webglTexture,Lt),Xn?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ur.__webglTexture,yn,ha+Fs):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ur.__webglTexture,yn),Lt!==0?oe.blitFramebuffer(Ir,Er,zn,En,Dr,ri,zn,En,oe.COLOR_BUFFER_BIT,oe.NEAREST):Xn?oe.copyTexSubImage3D(Pr,yn,Dr,ri,ha+Fs,Ir,Er,zn,En):oe.copyTexSubImage2D(Pr,yn,Dr,ri,Ir,Er,zn,En);Be.bindFramebuffer(oe.READ_FRAMEBUFFER,null),Be.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Xn?We.isDataTexture||We.isData3DTexture?oe.texSubImage3D(Pr,yn,Dr,ri,ha,zn,En,tr,ii,Tr,Cr.data):At.isCompressedArrayTexture?oe.compressedTexSubImage3D(Pr,yn,Dr,ri,ha,zn,En,tr,ii,Cr.data):oe.texSubImage3D(Pr,yn,Dr,ri,ha,zn,En,tr,ii,Tr,Cr):We.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,yn,Dr,ri,zn,En,ii,Tr,Cr.data):We.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,yn,Dr,ri,Cr.width,Cr.height,ii,Cr.data):oe.texSubImage2D(oe.TEXTURE_2D,yn,Dr,ri,zn,En,ii,Tr,Cr);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,Cn),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,zr),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Do),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,ls),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Lo),yn===0&&At.generateMipmaps&&oe.generateMipmap(Pr),Be.unbindTexture()},this.copyTextureToTexture3D=function(We,At,Wt=null,Kt=null,Lt=0){return CN('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(We,At,Wt,Kt,Lt)},this.initRenderTarget=function(We){Se.get(We).__webglFramebuffer===void 0&&Ie.setupRenderTarget(We)},this.initTexture=function(We){We.isCubeTexture?Ie.setTextureCube(We,0):We.isData3DTexture?Ie.setTexture3D(We,0):We.isDataArrayTexture||We.isCompressedArrayTexture?Ie.setTexture2DArray(We,0):Ie.setTexture2D(We,0),Be.unbindTexture()},this.resetState=function(){N=0,I=0,D=null,Be.reset(),st.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return k0}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Sa._getDrawingBufferColorSpace(e),t.unpackColorSpace=Sa._getUnpackColorSpace()}}const PMe=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:dz,AddEquation:i1,AddOperation:Gse,AdditiveAnimationBlendMode:Sz,AdditiveBlending:jF,AgXToneMapping:Kse,AlphaFormat:vz,AlwaysCompare:uae,AlwaysDepth:RP,AlwaysStencilFunc:GF,AmbientLight:ooe,AnimationAction:goe,AnimationClip:$2,AnimationLoader:Xxe,AnimationMixer:xTe,AnimationObjectGroup:STe,AnimationUtils:Gxe,ArcCurve:Oae,ArrayCamera:doe,ArrowHelper:GTe,AttachedBindMode:VF,Audio:poe,AudioAnalyser:fTe,AudioContext:qz,AudioListener:lTe,AudioLoader:sTe,AxesHelper:$Te,BackSide:Yf,BasicDepthPacking:U1,BasicShadowMap:wse,BatchedMesh:wae,Bone:Az,BooleanKeyframeTrack:WE,Box2:_oe,Box3:Qd,Box3Helper:qTe,BoxGeometry:$E,BoxHelper:HTe,BufferAttribute:Ps,BufferGeometry:ts,BufferGeometryLoader:hoe,ByteType:mz,Cache:Hy,Camera:Zk,CameraHelper:jTe,CanvasTexture:Mae,CapsuleGeometry:u4,CatmullRomCurve3:Iae,CineonToneMapping:Yse,CircleGeometry:f4,ClampToEdgeWrapping:M0,Clock:Vz,Color:cr,ColorKeyframeTrack:zz,ColorManagement:Sa,CompressedArrayTexture:hxe,CompressedCubeTexture:dxe,CompressedTexture:c4,CompressedTextureLoader:Kxe,ConeGeometry:eO,ConstantAlphaFactor:Hse,ConstantColorFactor:zse,Controls:YTe,CubeCamera:vae,CubeReflectionMapping:rb,CubeRefractionMapping:E1,CubeTexture:Qk,CubeTextureLoader:Zxe,CubeUVReflectionMapping:Ow,CubicBezierCurve:kz,CubicBezierCurve3:Nae,CubicInterpolant:Qae,CullFaceBack:zF,CullFaceFront:Tse,CullFaceFrontBack:ESe,CullFaceNone:xse,Curve:U_,CurvePath:Dae,CustomBlending:Rse,CustomToneMapping:Xse,CylinderGeometry:Jk,Cylindrical:OTe,Data3DTexture:r4,DataArrayTexture:Kk,DataTexture:Lg,DataTextureLoader:Qxe,DataUtils:BEe,DecrementStencilOp:LSe,DecrementWrapStencilOp:BSe,DefaultLoadingManager:toe,DepthArrayTexture:pxe,DepthFormat:zT,DepthStencilFormat:_E,DepthTexture:Dw,DetachedBindMode:Qse,DirectionalLight:aoe,DirectionalLightHelper:zTe,DiscreteInterpolant:Jae,DodecahedronGeometry:h4,DoubleSide:$f,DstAlphaFactor:Dse,DstColorFactor:Use,DynamicCopyUsage:QSe,DynamicDrawUsage:$F,DynamicReadUsage:XSe,EdgesGeometry:kae,EllipseCurve:d4,EqualCompare:aae,EqualDepth:CP,EqualStencilFunc:HSe,EquirectangularReflectionMapping:I2,EquirectangularRefractionMapping:N2,Euler:Um,EventDispatcher:Vg,ExtrudeGeometry:p4,FileLoader:ib,Float16BufferAttribute:GEe,Float32BufferAttribute:Or,FloatType:Dp,Fog:s4,FogExp2:i4,FramebufferTexture:fxe,FrontSide:Lv,Frustum:Pw,FrustumArray:l4,GLBufferAttribute:MTe,GLSL1:eEe,GLSL3:WF,GreaterCompare:oae,GreaterDepth:kP,GreaterEqualCompare:cae,GreaterEqualDepth:MP,GreaterEqualStencilFunc:$Se,GreaterStencilFunc:VSe,GridHelper:BTe,Group:YS,HalfFloatType:db,HemisphereLight:roe,HemisphereLightHelper:UTe,IcosahedronGeometry:m4,ImageBitmapLoader:iTe,ImageLoader:W2,ImageUtils:pae,IncrementStencilOp:DSe,IncrementWrapStencilOp:USe,InstancedBufferAttribute:GT,InstancedBufferGeometry:foe,InstancedInterleavedBuffer:CTe,InstancedMesh:Tae,Int16BufferAttribute:qEe,Int32BufferAttribute:VEe,Int8BufferAttribute:zEe,IntType:KL,InterleavedBuffer:a4,InterleavedBufferAttribute:vE,Interpolant:rO,InterpolateDiscrete:D2,InterpolateLinear:iD,InterpolateSmooth:AN,InterpolationSamplingMode:rEe,InterpolationSamplingType:nEe,InvertStencilOp:FSe,KeepStencilOp:OS,KeyframeTrack:V0,LOD:Eae,LatheGeometry:g4,Layers:HT,LessCompare:sae,LessDepth:AP,LessEqualCompare:Ez,LessEqualDepth:mE,LessEqualStencilFunc:qSe,LessStencilFunc:jSe,Light:j1,LightProbe:uoe,Line:x1,Line3:ITe,LineBasicMaterial:Vp,LineCurve:Oz,LineCurve3:Pae,LineDashedMaterial:Xae,LineLoop:Rae,LineSegments:Wv,LinearFilter:nc,LinearInterpolant:Fz,LinearMipMapLinearFilter:RSe,LinearMipMapNearestFilter:wSe,LinearMipmapLinearFilter:Tv,LinearMipmapNearestFilter:c2,LinearSRGBColorSpace:Bv,LinearToneMapping:$se,LinearTransfer:U2,Loader:Wm,LoaderUtils:QF,LoadingManager:jz,LoopOnce:Jse,LoopPingPong:tae,LoopRepeat:eae,MOUSE:bSe,Material:nh,MaterialLoader:x4,MathUtils:fae,Matrix2:Yz,Matrix3:Ji,Matrix4:Qr,MaxEquation:kse,Mesh:vu,MeshBasicMaterial:F1,MeshDepthMaterial:Lz,MeshDistanceMaterial:Uz,MeshLambertMaterial:Wae,MeshMatcapMaterial:Yae,MeshNormalMaterial:$ae,MeshPhongMaterial:Vae,MeshPhysicalMaterial:qae,MeshStandardMaterial:Dz,MeshToonMaterial:Gae,MinEquation:Mse,MirroredRepeatWrapping:P2,MixOperation:Vse,MultiplyBlending:qF,MultiplyOperation:Wk,NearestFilter:bf,NearestMipMapLinearFilter:TSe,NearestMipMapNearestFilter:xSe,NearestMipmapLinearFilter:hT,NearestMipmapNearestFilter:pz,NeutralToneMapping:Zse,NeverCompare:iae,NeverDepth:wP,NeverStencilFunc:zSe,NoBlending:Nh,NoColorSpace:v_,NoToneMapping:kv,NormalAnimationBlendMode:t4,NormalBlending:nE,NotEqualCompare:lae,NotEqualDepth:OP,NotEqualStencilFunc:GSe,NumberKeyframeTrack:V2,Object3D:za,ObjectLoader:nTe,ObjectSpaceNormalMap:rae,OctahedronGeometry:tO,OneFactor:Ise,OneMinusConstantAlphaFactor:qse,OneMinusConstantColorFactor:jse,OneMinusDstAlphaFactor:Lse,OneMinusDstColorFactor:Bse,OneMinusSrcAlphaFactor:TP,OneMinusSrcColorFactor:Pse,OrthographicCamera:sO,PCFShadowMap:YL,PCFSoftShadowMap:l2,PMREMGenerator:t7,Path:lD,PerspectiveCamera:vf,Plane:Qb,PlaneGeometry:Lw,PlaneHelper:VTe,PointLight:soe,PointLightHelper:DTe,Points:Aae,PointsMaterial:Cz,PolarGridHelper:FTe,PolyhedronGeometry:z1,PositionalAudio:uTe,PropertyBinding:Ba,PropertyMixer:moe,QuadraticBezierCurve:Iz,QuadraticBezierCurve3:Nz,Quaternion:jp,QuaternionKeyframeTrack:iO,QuaternionLinearInterpolant:eoe,RED_GREEN_RGTC2_Format:nD,RED_RGTC1_Format:bz,REVISION:kw,RGBADepthPacking:nae,RGBAFormat:Xf,RGBAIntegerFormat:Xk,RGBA_ASTC_10x10_Format:KP,RGBA_ASTC_10x5_Format:WP,RGBA_ASTC_10x6_Format:YP,RGBA_ASTC_10x8_Format:XP,RGBA_ASTC_12x10_Format:ZP,RGBA_ASTC_12x12_Format:QP,RGBA_ASTC_4x4_Format:FP,RGBA_ASTC_5x4_Format:zP,RGBA_ASTC_5x5_Format:jP,RGBA_ASTC_6x5_Format:HP,RGBA_ASTC_6x6_Format:qP,RGBA_ASTC_8x5_Format:VP,RGBA_ASTC_8x6_Format:GP,RGBA_ASTC_8x8_Format:$P,RGBA_BPTC_Format:p2,RGBA_ETC2_EAC_Format:BP,RGBA_PVRTC_2BPPV1_Format:DP,RGBA_PVRTC_4BPPV1_Format:PP,RGBA_S3TC_DXT1_Format:f2,RGBA_S3TC_DXT3_Format:h2,RGBA_S3TC_DXT5_Format:d2,RGBDepthPacking:OSe,RGBFormat:yz,RGBIntegerFormat:ASe,RGB_BPTC_SIGNED_Format:JP,RGB_BPTC_UNSIGNED_Format:eD,RGB_ETC1_Format:LP,RGB_ETC2_Format:UP,RGB_PVRTC_2BPPV1_Format:NP,RGB_PVRTC_4BPPV1_Format:IP,RGB_S3TC_DXT1_Format:u2,RGDepthPacking:ISe,RGFormat:JL,RGIntegerFormat:e4,RawShaderMaterial:Hae,Ray:Nw,Raycaster:Wz,RectAreaLight:loe,RedFormat:Iw,RedIntegerFormat:Yk,ReinhardToneMapping:Wse,RenderTarget:n4,RenderTarget3D:TTe,RenderTargetArray:wTe,RepeatWrapping:BT,ReplaceStencilOp:PSe,ReverseSubtractEquation:Cse,RingGeometry:_4,SIGNED_RED_GREEN_RGTC2_Format:rD,SIGNED_RED_RGTC1_Format:tD,SRGBColorSpace:ta,SRGBTransfer:No,Scene:VT,ShaderChunk:gs,ShaderLib:m_,ShaderMaterial:jl,ShadowMaterial:jae,Shape:iE,ShapeGeometry:v4,ShapePath:WTe,ShapeUtils:E_,ShortType:gz,Skeleton:o4,SkeletonHelper:PTe,SkinnedMesh:xae,Source:c1,Sphere:xd,SphereGeometry:nO,Spherical:kTe,SphericalHarmonics3:coe,SplineCurve:Pz,SpotLight:ioe,SpotLightHelper:NTe,Sprite:Sae,SpriteMaterial:Rz,SrcAlphaFactor:xP,SrcAlphaSaturateFactor:Fse,SrcColorFactor:Nse,StaticCopyUsage:ZSe,StaticDrawUsage:B2,StaticReadUsage:YSe,StereoCamera:aTe,StreamCopyUsage:JSe,StreamDrawUsage:WSe,StreamReadUsage:KSe,StringKeyframeTrack:YE,SubtractEquation:Ase,SubtractiveBlending:HF,TOUCH:SSe,TangentSpaceNormalMap:B1,TetrahedronGeometry:y4,Texture:xc,TextureLoader:noe,TextureUtils:JTe,TimestampQuery:tEe,TorusGeometry:b4,TorusKnotGeometry:S4,Triangle:Rm,TriangleFanDrawMode:kSe,TriangleStripDrawMode:MSe,TrianglesDrawMode:CSe,TubeGeometry:E4,UVMapping:XL,Uint16BufferAttribute:Tz,Uint32BufferAttribute:wz,Uint8BufferAttribute:jEe,Uint8ClampedBufferAttribute:HEe,Uniform:jn,UniformsGroup:ATe,UniformsLib:or,UniformsUtils:_ae,UnsignedByteType:zl,UnsignedInt248Type:gE,UnsignedInt5999Type:_z,UnsignedIntType:Uv,UnsignedShort4444Type:ZL,UnsignedShort5551Type:QL,UnsignedShortType:FT,VSMShadowMap:d_,Vector2:an,Vector3:ut,Vector4:xa,VectorKeyframeTrack:G2,VideoFrameTexture:uxe,VideoTexture:Cae,WebGL3DRenderTarget:CEe,WebGLArrayRenderTarget:AEe,WebGLCoordinateSystem:k0,WebGLCubeRenderTarget:yae,WebGLRenderTarget:Sf,WebGLRenderer:woe,WebGLUtils:Toe,WebGPUCoordinateSystem:F2,WebXRController:MN,WireframeGeometry:zae,WrapAroundEnding:L2,ZeroCurvatureEnding:$S,ZeroFactor:Ose,ZeroSlopeEnding:WS,ZeroStencilOp:NSe,createCanvasElement:dae},Symbol.toStringTag,{value:"Module"}));var E6={exports:{}},x6={},T6={exports:{}},w6={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PW;function DMe(){if(PW)return w6;PW=1;var n=Mw();function e(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,a=n.useDebugValue;function o(f,d){var g=d(),p=r({inst:{value:g,getSnapshot:d}}),_=p[0].inst,y=p[1];return s(function(){_.value=g,_.getSnapshot=d,l(_)&&y({inst:_})},[f,g,d]),i(function(){return l(_)&&y({inst:_}),f(function(){l(_)&&y({inst:_})})},[f]),a(g),g}function l(f){var d=f.getSnapshot;f=f.value;try{var g=d();return!t(f,g)}catch{return!0}}function c(f,d){return d()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return w6.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,w6}var DW;function LMe(){return DW||(DW=1,T6.exports=DMe()),T6.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LW;function UMe(){if(LW)return x6;LW=1;var n=Mw(),e=LMe();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=n.useRef,a=n.useEffect,o=n.useMemo,l=n.useDebugValue;return x6.useSyncExternalStoreWithSelector=function(c,u,f,d,g){var p=s(null);if(p.current===null){var _={hasValue:!1,value:null};p.current=_}else _=p.current;p=o(function(){function v(N){if(!x){if(x=!0,E=N,N=d(N),g!==void 0&&_.hasValue){var I=_.value;if(g(I,N))return M=I}return M=N}if(I=M,r(E,N))return I;var D=d(N);return g!==void 0&&g(I,D)?(E=N,I):(E=N,M=D)}var x=!1,E,M,O=f===void 0?null:f;return[function(){return v(u())},O===null?void 0:function(){return v(O())}]},[u,f,d,g]);var y=i(c,p[0],p[1]);return a(function(){_.hasValue=!0,_.value=y},[y]),l(y),y},x6}var UW;function BMe(){return UW||(UW=1,E6.exports=UMe()),E6.exports}var FMe=BMe();const zMe=Bh(FMe),BW=n=>{let e;const t=new Set,r=(c,u)=>{const f=typeof c=="function"?c(e):c;if(!Object.is(f,e)){const d=e;e=u??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(g=>g(e,d))}},i=()=>e,o={setState:r,getState:i,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=n(r,i,o);return o},w4=n=>n?BW(n):BW,{useSyncExternalStoreWithSelector:jMe}=zMe,HMe=n=>n;function qMe(n,e=HMe,t){const r=jMe(n.subscribe,n.getState,n.getInitialState,e,t);return Og.useDebugValue(r),r}const FW=(n,e)=>{const t=w4(n),r=(i,s=e)=>qMe(t,i,s);return Object.assign(r,t),r},Roe=(n,e)=>n?FW(n,e):FW,VMe=n=>typeof n=="object"&&typeof n.then=="function",KS=[];function Aoe(n,e,t=(r,i)=>r===i){if(n===e)return!0;if(!n||!e)return!1;const r=n.length;if(e.length!==r)return!1;for(let i=0;i<r;i++)if(!t(n[i],e[i]))return!1;return!0}function Coe(n,e=null,t=!1,r={}){e===null&&(e=[n]);for(const s of KS)if(Aoe(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return r.lifespan&&r.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,r.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:r.equal,remove:()=>{const s=KS.indexOf(i);s!==-1&&KS.splice(s,1)},promise:(VMe(n)?n:n(...e)).then(s=>{i.response=s,r.lifespan&&r.lifespan>0&&(i.timeout=setTimeout(i.remove,r.lifespan))}).catch(s=>i.error=s)};if(KS.push(i),!t)throw i.promise}const Moe=(n,e,t)=>Coe(n,e,!1,t),GMe=(n,e,t)=>void Coe(n,e,!0,t),$Me=n=>{if(n===void 0||n.length===0)KS.splice(0,KS.length);else{const e=KS.find(t=>Aoe(n,t.keys,t.equal));e&&e.remove()}};var R6={exports:{}},A6={exports:{}},C6={exports:{}},M6={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zW;function WMe(){return zW||(zW=1,(function(n){function e(W,q){var Y=W.length;W.push(q);e:for(;0<Y;){var ae=Y-1>>>1,Z=W[ae];if(0<i(Z,q))W[ae]=q,W[Y]=Z,Y=ae;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var q=W[0],Y=W.pop();if(Y!==q){W[0]=Y;e:for(var ae=0,Z=W.length,K=Z>>>1;ae<K;){var ne=2*(ae+1)-1,le=W[ne],ce=ne+1,de=W[ce];if(0>i(le,Y))ce<Z&&0>i(de,le)?(W[ae]=de,W[ce]=Y,ae=ce):(W[ae]=le,W[ne]=Y,ae=ne);else if(ce<Z&&0>i(de,Y))W[ae]=de,W[ce]=Y,ae=ce;else break e}}return q}function i(W,q){var Y=W.sortIndex-q.sortIndex;return Y!==0?Y:W.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,d=3,g=!1,p=!1,_=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;function E(W){for(var q=t(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=W)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=t(c)}}function M(W){if(_=!1,E(W),!p)if(t(l)!==null)p=!0,U();else{var q=t(c);q!==null&&J(M,q.startTime-W)}}var O=!1,N=-1,I=5,D=-1;function V(){return!(n.unstable_now()-D<I)}function G(){if(O){var W=n.unstable_now();D=W;var q=!0;try{e:{p=!1,_&&(_=!1,v(N),N=-1),g=!0;var Y=d;try{t:{for(E(W),f=t(l);f!==null&&!(f.expirationTime>W&&V());){var ae=f.callback;if(typeof ae=="function"){f.callback=null,d=f.priorityLevel;var Z=ae(f.expirationTime<=W);if(W=n.unstable_now(),typeof Z=="function"){f.callback=Z,E(W),q=!0;break t}f===t(l)&&r(l),E(W)}else r(l);f=t(l)}if(f!==null)q=!0;else{var K=t(c);K!==null&&J(M,K.startTime-W),q=!1}}break e}finally{f=null,d=Y,g=!1}q=void 0}}finally{q?Q():O=!1}}}var Q;if(typeof x=="function")Q=function(){x(G)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,$=B.port2;B.port1.onmessage=G,Q=function(){$.postMessage(null)}}else Q=function(){y(G,0)};function U(){O||(O=!0,Q())}function J(W,q){N=y(function(){W(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_continueExecution=function(){p||g||(p=!0,U())},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(W){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var Y=d;d=q;try{return W()}finally{d=Y}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(W,q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=d;d=W;try{return q()}finally{d=Y}},n.unstable_scheduleCallback=function(W,q,Y){var ae=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,W={id:u++,callback:q,priorityLevel:W,startTime:Y,expirationTime:Z,sortIndex:-1},Y>ae?(W.sortIndex=Y,e(c,W),t(l)===null&&W===t(c)&&(_?(v(N),N=-1):_=!0,J(M,Y-ae))):(W.sortIndex=Z,e(l,W),p||g||(p=!0,U())),W},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(W){var q=d;return function(){var Y=d;d=q;try{return W.apply(this,arguments)}finally{d=Y}}}})(M6)),M6}var jW;function koe(){return jW||(jW=1,C6.exports=WMe()),C6.exports}var HW;function YMe(){return HW||(HW=1,(function(n){n.exports=function(e){function t(T,R,z,re){return new Jp(T,R,z,re)}function r(){}function i(T){var R="https://react.dev/errors/"+T;if(1<arguments.length){R+="?args[]="+encodeURIComponent(arguments[1]);for(var z=2;z<arguments.length;z++)R+="&args[]="+encodeURIComponent(arguments[z])}return"Minified React error #"+T+"; visit "+R+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(T){return T===null||typeof T!="object"?null:(T=Mo&&T[Mo]||T["@@iterator"],typeof T=="function"?T:null)}function a(T){if(T==null)return null;if(typeof T=="function")return T.$$typeof===em?null:T.displayName||T.name||null;if(typeof T=="string")return T;switch(T){case ja:return"Fragment";case Xl:return"Portal";case Pc:return"Profiler";case ra:return"StrictMode";case Dc:return"Suspense";case ef:return"SuspenseList"}if(typeof T=="object")switch(T.$$typeof){case eo:return(T.displayName||"Context")+".Provider";case wu:return(T._context.displayName||"Context")+".Consumer";case Ju:var R=T.render;return T=T.displayName,T||(T=R.displayName||R.name||"",T=T!==""?"ForwardRef("+T+")":"ForwardRef"),T;case Ru:return R=T.displayName||null,R!==null?R:a(T.type)||"Memo";case Co:R=T._payload,T=T._init;try{return a(T(R))}catch{}}return null}function o(T){if(Au===void 0)try{throw Error()}catch(z){var R=z.stack.trim().match(/\n( *(at )?)/);Au=R&&R[1]||"",Pf=-1<z.stack.indexOf(`
    at`)?" (<anonymous>)":-1<z.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Au+T+Pf}function l(T,R){if(!T||Zh)return"";Zh=!0;var z=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var re={DetermineComponentFrameRoot:function(){try{if(R){var Jn=function(){throw Error()};if(Object.defineProperty(Jn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Jn,[])}catch(Yr){var nr=Yr}Reflect.construct(T,[],Jn)}else{try{Jn.call()}catch(Yr){nr=Yr}T.call(Jn.prototype)}}else{try{throw Error()}catch(Yr){nr=Yr}(Jn=T())&&typeof Jn.catch=="function"&&Jn.catch(function(){})}}catch(Yr){if(Yr&&nr&&typeof Yr.stack=="string")return[Yr.stack,nr.stack]}return[null,null]}};re.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var he=Object.getOwnPropertyDescriptor(re.DetermineComponentFrameRoot,"name");he&&he.configurable&&Object.defineProperty(re.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Te=re.DetermineComponentFrameRoot(),et=Te[0],yt=Te[1];if(et&&yt){var zt=et.split(`
`),mn=yt.split(`
`);for(he=re=0;re<zt.length&&!zt[re].includes("DetermineComponentFrameRoot");)re++;for(;he<mn.length&&!mn[he].includes("DetermineComponentFrameRoot");)he++;if(re===zt.length||he===mn.length)for(re=zt.length-1,he=mn.length-1;1<=re&&0<=he&&zt[re]!==mn[he];)he--;for(;1<=re&&0<=he;re--,he--)if(zt[re]!==mn[he]){if(re!==1||he!==1)do if(re--,he--,0>he||zt[re]!==mn[he]){var Ln=`
`+zt[re].replace(" at new "," at ");return T.displayName&&Ln.includes("<anonymous>")&&(Ln=Ln.replace("<anonymous>",T.displayName)),Ln}while(1<=re&&0<=he);break}}}finally{Zh=!1,Error.prepareStackTrace=z}return(z=T?T.displayName||T.name:"")?o(z):""}function c(T){switch(T.tag){case 26:case 27:case 5:return o(T.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return T=l(T.type,!1),T;case 11:return T=l(T.type.render,!1),T;case 1:return T=l(T.type,!0),T;default:return""}}function u(T){try{var R="";do R+=c(T),T=T.return;while(T);return R}catch(z){return`
Error generating stack: `+z.message+`
`+z.stack}}function f(T){var R=T,z=T;if(T.alternate)for(;R.return;)R=R.return;else{T=R;do R=T,(R.flags&4098)!==0&&(z=R.return),T=R.return;while(T)}return R.tag===3?z:null}function d(T){if(f(T)!==T)throw Error(i(188))}function g(T){var R=T.alternate;if(!R){if(R=f(T),R===null)throw Error(i(188));return R!==T?null:T}for(var z=T,re=R;;){var he=z.return;if(he===null)break;var Te=he.alternate;if(Te===null){if(re=he.return,re!==null){z=re;continue}break}if(he.child===Te.child){for(Te=he.child;Te;){if(Te===z)return d(he),T;if(Te===re)return d(he),R;Te=Te.sibling}throw Error(i(188))}if(z.return!==re.return)z=he,re=Te;else{for(var et=!1,yt=he.child;yt;){if(yt===z){et=!0,z=he,re=Te;break}if(yt===re){et=!0,re=he,z=Te;break}yt=yt.sibling}if(!et){for(yt=Te.child;yt;){if(yt===z){et=!0,z=Te,re=he;break}if(yt===re){et=!0,re=Te,z=he;break}yt=yt.sibling}if(!et)throw Error(i(189))}}if(z.alternate!==re)throw Error(i(190))}if(z.tag!==3)throw Error(i(188));return z.stateNode.current===z?T:R}function p(T){var R=T.tag;if(R===5||R===26||R===27||R===6)return T;for(T=T.child;T!==null;){if(R=p(T),R!==null)return R;T=T.sibling}return null}function _(T){var R=T.tag;if(R===5||R===26||R===27||R===6)return T;for(T=T.child;T!==null;){if(T.tag!==4&&(R=_(T),R!==null))return R;T=T.sibling}return null}function y(T){return{current:T}}function v(T){0>ad||(T.current=go[ad],go[ad]=null,ad--)}function x(T,R){ad++,go[ad]=T.current,T.current=R}function E(T){return T>>>=0,T===0?32:31-(Vo(T)/gg|0)|0}function M(T){var R=T&42;if(R!==0)return R;switch(T&-T){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return T&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return T&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return T}}function O(T,R){var z=T.pendingLanes;if(z===0)return 0;var re=0,he=T.suspendedLanes,Te=T.pingedLanes,et=T.warmLanes;T=T.finishedLanes!==0;var yt=z&134217727;return yt!==0?(z=yt&~he,z!==0?re=M(z):(Te&=yt,Te!==0?re=M(Te):T||(et=yt&~et,et!==0&&(re=M(et))))):(yt=z&~he,yt!==0?re=M(yt):Te!==0?re=M(Te):T||(et=z&~et,et!==0&&(re=M(et)))),re===0?0:R!==0&&R!==re&&(R&he)===0&&(he=re&-re,et=R&-R,he>=et||he===32&&(et&4194176)!==0)?R:re}function N(T,R){return(T.pendingLanes&~(T.suspendedLanes&~T.pingedLanes)&R)===0}function I(T,R){switch(T){case 1:case 2:case 4:case 8:return R+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return R+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function D(){var T=eu;return eu<<=1,(eu&4194176)===0&&(eu=128),T}function V(){var T=zd;return zd<<=1,(zd&62914560)===0&&(zd=4194304),T}function G(T){for(var R=[],z=0;31>z;z++)R.push(T);return R}function Q(T,R){T.pendingLanes|=R,R!==268435456&&(T.suspendedLanes=0,T.pingedLanes=0,T.warmLanes=0)}function B(T,R,z,re,he,Te){var et=T.pendingLanes;T.pendingLanes=z,T.suspendedLanes=0,T.pingedLanes=0,T.warmLanes=0,T.expiredLanes&=z,T.entangledLanes&=z,T.errorRecoveryDisabledLanes&=z,T.shellSuspendCounter=0;var yt=T.entanglements,zt=T.expirationTimes,mn=T.hiddenUpdates;for(z=et&~z;0<z;){var Ln=31-ro(z),Jn=1<<Ln;yt[Ln]=0,zt[Ln]=-1;var nr=mn[Ln];if(nr!==null)for(mn[Ln]=null,Ln=0;Ln<nr.length;Ln++){var Yr=nr[Ln];Yr!==null&&(Yr.lane&=-536870913)}z&=~Jn}re!==0&&$(T,re,0),Te!==0&&he===0&&T.tag!==0&&(T.suspendedLanes|=Te&~(et&~R))}function $(T,R,z){T.pendingLanes|=R,T.suspendedLanes&=~R;var re=31-ro(R);T.entangledLanes|=R,T.entanglements[re]=T.entanglements[re]|1073741824|z&4194218}function U(T,R){var z=T.entangledLanes|=R;for(T=T.entanglements;z;){var re=31-ro(z),he=1<<re;he&R|T[re]&R&&(T[re]|=R),z&=~he}}function J(T){return T&=-T,2<T?8<T?(T&134217727)!==0?32:268435456:8:2}function W(T){if(Ga&&typeof Ga.onCommitFiberRoot=="function")try{Ga.onCommitFiberRoot(ys,T,void 0,(T.current.flags&128)===128)}catch{}}function q(T){if(typeof wa=="function"&&Va(T),Ga&&typeof Ga.setStrictMode=="function")try{Ga.setStrictMode(ys,T)}catch{}}function Y(T,R){return T===R&&(T!==0||1/T===1/R)||T!==T&&R!==R}function ae(T,R){if(typeof T=="object"&&T!==null){var z=oa.get(T);return z!==void 0?z:(R={value:T,source:R,stack:u(R)},oa.set(T,R),R)}return{value:T,source:R,stack:u(R)}}function Z(T,R){Hr[hs++]=tu,Hr[hs++]=Ra,Ra=T,tu=R}function K(T,R,z){qi[$a++]=Vs,qi[$a++]=Ms,qi[$a++]=of,of=T;var re=Vs;T=Ms;var he=32-ro(re)-1;re&=~(1<<he),z+=1;var Te=32-ro(R)+he;if(30<Te){var et=he-he%5;Te=(re&(1<<et)-1).toString(32),re>>=et,he-=et,Vs=1<<32-ro(R)+he|z<<he|re,Ms=Te+T}else Vs=1<<Te|z<<he|re,Ms=T}function ne(T){T.return!==null&&(Z(T,1),K(T,1,0))}function le(T){for(;T===Ra;)Ra=Hr[--hs],Hr[hs]=null,tu=Hr[--hs],Hr[hs]=null;for(;T===of;)of=qi[--$a],qi[$a]=null,Ms=qi[--$a],qi[$a]=null,Vs=qi[--$a],qi[$a]=null}function ce(T,R){x(mc,R),x(io,T),x(Ni,null),T=Nd(R),v(Ni),x(Ni,T)}function de(){v(Ni),v(io),v(mc)}function Me(T){T.memoizedState!==null&&x(Nl,T);var R=Ni.current,z=Pd(R,T.type);R!==z&&(x(io,T),x(Ni,z))}function qe(T){io.current===T&&(v(Ni),v(io)),Nl.current===T&&(v(Nl),ul?dr._currentValue=hc:dr._currentValue2=hc)}function Pe(T){var R=Error(i(418,""));throw pt(ae(R,T)),rs}function Ce(T,R){if(!jo)throw Error(i(175));s0(T.stateNode,T.type,T.memoizedProps,R,T)||Pe(T)}function Xe(T){for(mr=T.return;mr;)switch(mr.tag){case 3:case 27:$r=!0;return;case 5:case 13:$r=!1;return;default:mr=mr.return}}function $e(T){if(!jo||T!==mr)return!1;if(!Wn)return Xe(T),Wn=!0,!1;var R=!1;if(qs?T.tag!==3&&T.tag!==27&&(T.tag!==5||pg(T.type)&&!Kr(T.type,T.memoizedProps))&&(R=!0):T.tag!==3&&(T.tag!==5||pg(T.type)&&!Kr(T.type,T.memoizedProps))&&(R=!0),R&&fr&&Pe(T),Xe(T),T.tag===13){if(!jo)throw Error(i(316));if(T=T.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(i(317));fr=a0(T)}else fr=mr?um(T.stateNode):null;return!0}function at(){jo&&(fr=mr=null,Wn=!1)}function pt(T){Wa===null?Wa=[T]:Wa.push(T)}function oe(){for(var T=nu,R=ko=nu=0;R<T;){var z=Pu[R];Pu[R++]=null;var re=Pu[R];Pu[R++]=null;var he=Pu[R];Pu[R++]=null;var Te=Pu[R];if(Pu[R++]=null,re!==null&&he!==null){var et=re.pending;et===null?he.next=he:(he.next=et.next,et.next=he),re.pending=he}Te!==0&&Be(z,he,Te)}}function Ue(T,R,z,re){Pu[nu++]=T,Pu[nu++]=R,Pu[nu++]=z,Pu[nu++]=re,ko|=re,T.lanes|=re,T=T.alternate,T!==null&&(T.lanes|=re)}function Ge(T,R,z,re){return Ue(T,R,z,re),me(T)}function ze(T,R){return Ue(T,null,null,R),me(T)}function Be(T,R,z){T.lanes|=z;var re=T.alternate;re!==null&&(re.lanes|=z);for(var he=!1,Te=T.return;Te!==null;)Te.childLanes|=z,re=Te.alternate,re!==null&&(re.childLanes|=z),Te.tag===22&&(T=Te.stateNode,T===null||T._visibility&1||(he=!0)),T=Te,Te=Te.return;he&&R!==null&&T.tag===3&&(Te=T.stateNode,he=31-ro(z),Te=Te.hiddenUpdates,T=Te[he],T===null?Te[he]=[R]:T.push(R),R.lane=z|536870912)}function me(T){if(50<ou)throw ou=0,Lu=null,Error(i(185));for(var R=T.return;R!==null;)T=R,R=T.return;return T.tag===3?T.stateNode:null}function Se(T){T!==ld&&T.next===null&&(ld===null?od=ld=T:ld=ld.next=T),la=!0,Ep||(Ep=!0,ct(be))}function Ie(T,R){if(!xp&&la){xp=!0;do for(var z=!1,re=od;re!==null;){if(T!==0){var he=re.pendingLanes;if(he===0)var Te=0;else{var et=re.suspendedLanes,yt=re.pingedLanes;Te=(1<<31-ro(42|T)+1)-1,Te&=he&~(et&~yt),Te=Te&201326677?Te&201326677|1:Te?Te|2:0}Te!==0&&(z=!0,lt(re,Te))}else Te=Zt,Te=O(re,re===It?Te:0),(Te&3)===0||N(re,Te)||(z=!0,lt(re,Te));re=re.next}while(z);xp=!1}}function be(){la=Ep=!1;var T=0;gl!==0&&(nd()&&(T=gl),gl=0);for(var R=Sr(),z=null,re=od;re!==null;){var he=re.next,Te=Ke(re,R);Te===0?(re.next=null,z===null?od=he:z.next=he,he===null&&(ld=z)):(z=re,(T!==0||(Te&3)!==0)&&(la=!0)),re=he}Ie(T)}function Ke(T,R){for(var z=T.suspendedLanes,re=T.pingedLanes,he=T.expirationTimes,Te=T.pendingLanes&-62914561;0<Te;){var et=31-ro(Te),yt=1<<et,zt=he[et];zt===-1?((yt&z)===0||(yt&re)!==0)&&(he[et]=I(yt,R)):zt<=R&&(T.expiredLanes|=yt),Te&=~yt}if(R=It,z=Zt,z=O(T,T===R?z:0),re=T.callbackNode,z===0||T===R&&Gt===2||T.cancelPendingCommit!==null)return re!==null&&re!==null&&sa(re),T.callbackNode=null,T.callbackPriority=0;if((z&3)===0||N(T,z)){if(R=z&-z,R===T.callbackPriority)return R;switch(re!==null&&sa(re),J(z)){case 2:case 8:z=pc;break;case 32:z=Li;break;case 268435456:z=aa;break;default:z=Li}return re=ot.bind(null,T),z=ml(z,re),T.callbackPriority=R,T.callbackNode=z,R}return re!==null&&re!==null&&sa(re),T.callbackPriority=2,T.callbackNode=null,2}function ot(T,R){var z=T.callbackNode;if(al()&&T.callbackNode!==z)return null;var re=Zt;return re=O(T,T===It?re:0),re===0?null:(Ia(T,re,R),Ke(T,Sr()),T.callbackNode!=null&&T.callbackNode===z?ot.bind(null,T):null)}function lt(T,R){if(al())return null;Ia(T,R,!0)}function ct(T){rd?mo(function(){(wt&6)!==0?ml(wr,T):T()}):ml(wr,T)}function Vt(){return gl===0&&(gl=D()),gl}function kt(T,R){if(_l===null){var z=_l=[];Uc=0,Zi=Vt(),Zr={status:"pending",value:void 0,then:function(re){z.push(re)}}}return Uc++,R.then(Ut,Ut),R}function Ut(){if(--Uc===0&&_l!==null){Zr!==null&&(Zr.status="fulfilled");var T=_l;_l=null,Zi=0,Zr=null;for(var R=0;R<T.length;R++)(0,T[R])()}}function je(T,R){var z=[],re={status:"pending",value:null,reason:null,then:function(he){z.push(he)}};return T.then(function(){re.status="fulfilled",re.value=R;for(var he=0;he<z.length;he++)(0,z[he])(R)},function(he){for(re.status="rejected",re.reason=he,he=0;he<z.length;he++)(0,z[he])(void 0)}),re}function ge(T){T.updateQueue={baseState:T.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function se(T,R){T=T.updateQueue,R.updateQueue===T&&(R.updateQueue={baseState:T.baseState,firstBaseUpdate:T.firstBaseUpdate,lastBaseUpdate:T.lastBaseUpdate,shared:T.shared,callbacks:null})}function _e(T){return{lane:T,tag:0,payload:null,callback:null,next:null}}function Ne(T,R,z){var re=T.updateQueue;if(re===null)return null;if(re=re.shared,(wt&2)!==0){var he=re.pending;return he===null?R.next=R:(R.next=he.next,he.next=R),re.pending=R,R=me(T),Be(T,null,z),R}return Ue(T,re,R,z),me(T)}function Le(T,R,z){if(R=R.updateQueue,R!==null&&(R=R.shared,(z&4194176)!==0)){var re=R.lanes;re&=T.pendingLanes,z|=re,R.lanes=z,U(T,z)}}function ke(T,R){var z=T.updateQueue,re=T.alternate;if(re!==null&&(re=re.updateQueue,z===re)){var he=null,Te=null;if(z=z.firstBaseUpdate,z!==null){do{var et={lane:z.lane,tag:z.tag,payload:z.payload,callback:null,next:null};Te===null?he=Te=et:Te=Te.next=et,z=z.next}while(z!==null);Te===null?he=Te=R:Te=Te.next=R}else he=Te=R;z={baseState:re.baseState,firstBaseUpdate:he,lastBaseUpdate:Te,shared:re.shared,callbacks:re.callbacks},T.updateQueue=z;return}T=z.lastBaseUpdate,T===null?z.firstBaseUpdate=R:T.next=R,z.lastBaseUpdate=R}function Re(){if(vh){var T=Zr;if(T!==null)throw T}}function st(T,R,z,re){vh=!1;var he=T.updateQueue;so=!1;var Te=he.firstBaseUpdate,et=he.lastBaseUpdate,yt=he.shared.pending;if(yt!==null){he.shared.pending=null;var zt=yt,mn=zt.next;zt.next=null,et===null?Te=mn:et.next=mn,et=zt;var Ln=T.alternate;Ln!==null&&(Ln=Ln.updateQueue,yt=Ln.lastBaseUpdate,yt!==et&&(yt===null?Ln.firstBaseUpdate=mn:yt.next=mn,Ln.lastBaseUpdate=zt))}if(Te!==null){var Jn=he.baseState;et=0,Ln=mn=zt=null,yt=Te;do{var nr=yt.lane&-536870913,Yr=nr!==yt.lane;if(Yr?(Zt&nr)===nr:(re&nr)===nr){nr!==0&&nr===Zi&&(vh=!0),Ln!==null&&(Ln=Ln.next={lane:0,tag:yt.tag,payload:yt.payload,callback:null,next:null});e:{var lu=T,hd=yt;nr=R;var dd=z;switch(hd.tag){case 1:if(lu=hd.payload,typeof lu=="function"){Jn=lu.call(dd,Jn,nr);break e}Jn=lu;break e;case 3:lu.flags=lu.flags&-65537|128;case 0:if(lu=hd.payload,nr=typeof lu=="function"?lu.call(dd,Jn,nr):lu,nr==null)break e;Jn=Od({},Jn,nr);break e;case 2:so=!0}}nr=yt.callback,nr!==null&&(T.flags|=64,Yr&&(T.flags|=8192),Yr=he.callbacks,Yr===null?he.callbacks=[nr]:Yr.push(nr))}else Yr={lane:nr,tag:yt.tag,payload:yt.payload,callback:yt.callback,next:null},Ln===null?(mn=Ln=Yr,zt=Jn):Ln=Ln.next=Yr,et|=nr;if(yt=yt.next,yt===null){if(yt=he.shared.pending,yt===null)break;Yr=yt,yt=Yr.next,Yr.next=null,he.lastBaseUpdate=Yr,he.shared.pending=null}}while(!0);Ln===null&&(zt=Jn),he.baseState=zt,he.firstBaseUpdate=mn,he.lastBaseUpdate=Ln,Te===null&&(he.shared.lanes=0),gr|=et,T.lanes=et,T.memoizedState=Jn}}function Ve(T,R){if(typeof T!="function")throw Error(i(191,T));T.call(R)}function tt(T,R){var z=T.callbacks;if(z!==null)for(T.callbacks=null,T=0;T<z.length;T++)Ve(z[T],R)}function Ze(T,R){if(Il(T,R))return!0;if(typeof T!="object"||T===null||typeof R!="object"||R===null)return!1;var z=Object.keys(T),re=Object.keys(R);if(z.length!==re.length)return!1;for(re=0;re<z.length;re++){var he=z[re];if(!vl.call(R,he)||!Il(T[he],R[he]))return!1}return!0}function nt(T){return T=T.status,T==="fulfilled"||T==="rejected"}function vt(){}function Qe(T,R,z){switch(z=T[z],z===void 0?T.push(R):z!==R&&(R.then(vt,vt),R=z),R.status){case"fulfilled":return R.value;case"rejected":throw T=R.reason,T===_a?Error(i(483)):T;default:if(typeof R.status=="string")R.then(vt,vt);else{if(T=It,T!==null&&100<T.shellSuspendCounter)throw Error(i(482));T=R,T.status="pending",T.then(function(re){if(R.status==="pending"){var he=R;he.status="fulfilled",he.value=re}},function(re){if(R.status==="pending"){var he=R;he.status="rejected",he.reason=re}})}switch(R.status){case"fulfilled":return R.value;case"rejected":throw T=R.reason,T===_a?Error(i(483)):T}throw zf=R,_a}}function ht(){if(zf===null)throw Error(i(459));var T=zf;return zf=null,T}function mt(T){var R=iu;return iu+=1,ru===null&&(ru=[]),Qe(ru,T,R)}function ft(T,R){R=R.props.ref,T.ref=R!==void 0?R:null}function _t(T,R){throw R.$$typeof===gp?Error(i(525)):(T=Object.prototype.toString.call(R),Error(i(31,T==="[object Object]"?"object with keys {"+Object.keys(R).join(", ")+"}":T)))}function gn(T){var R=T._init;return R(T._payload)}function _n(T){function R(Qt,Ct){if(T){var nn=Qt.deletions;nn===null?(Qt.deletions=[Ct],Qt.flags|=16):nn.push(Ct)}}function z(Qt,Ct){if(!T)return null;for(;Ct!==null;)R(Qt,Ct),Ct=Ct.sibling;return null}function re(Qt){for(var Ct=new Map;Qt!==null;)Qt.key!==null?Ct.set(Qt.key,Qt):Ct.set(Qt.index,Qt),Qt=Qt.sibling;return Ct}function he(Qt,Ct){return Qt=Ao(Qt,Ct),Qt.index=0,Qt.sibling=null,Qt}function Te(Qt,Ct,nn){return Qt.index=nn,T?(nn=Qt.alternate,nn!==null?(nn=nn.index,nn<Ct?(Qt.flags|=33554434,Ct):nn):(Qt.flags|=33554434,Ct)):(Qt.flags|=1048576,Ct)}function et(Qt){return T&&Qt.alternate===null&&(Qt.flags|=33554434),Qt}function yt(Qt,Ct,nn,Un){return Ct===null||Ct.tag!==6?(Ct=pp(nn,Qt.mode,Un),Ct.return=Qt,Ct):(Ct=he(Ct,nn),Ct.return=Qt,Ct)}function zt(Qt,Ct,nn,Un){var Mr=nn.type;return Mr===ja?Ln(Qt,Ct,nn.props.children,Un,nn.key):Ct!==null&&(Ct.elementType===Mr||typeof Mr=="object"&&Mr!==null&&Mr.$$typeof===Co&&gn(Mr)===Ct.type)?(Ct=he(Ct,nn.props),ft(Ct,nn),Ct.return=Qt,Ct):(Ct=Zu(nn.type,nn.key,nn.props,null,Qt.mode,Un),ft(Ct,nn),Ct.return=Qt,Ct)}function mn(Qt,Ct,nn,Un){return Ct===null||Ct.tag!==4||Ct.stateNode.containerInfo!==nn.containerInfo||Ct.stateNode.implementation!==nn.implementation?(Ct=Qu(nn,Qt.mode,Un),Ct.return=Qt,Ct):(Ct=he(Ct,nn.children||[]),Ct.return=Qt,Ct)}function Ln(Qt,Ct,nn,Un,Mr){return Ct===null||Ct.tag!==7?(Ct=Na(nn,Qt.mode,Un,Mr),Ct.return=Qt,Ct):(Ct=he(Ct,nn),Ct.return=Qt,Ct)}function Jn(Qt,Ct,nn){if(typeof Ct=="string"&&Ct!==""||typeof Ct=="number"||typeof Ct=="bigint")return Ct=pp(""+Ct,Qt.mode,nn),Ct.return=Qt,Ct;if(typeof Ct=="object"&&Ct!==null){switch(Ct.$$typeof){case ll:return nn=Zu(Ct.type,Ct.key,Ct.props,null,Qt.mode,nn),ft(nn,Ct),nn.return=Qt,nn;case Xl:return Ct=Qu(Ct,Qt.mode,nn),Ct.return=Qt,Ct;case Co:var Un=Ct._init;return Ct=Un(Ct._payload),Jn(Qt,Ct,nn)}if(Qh(Ct)||s(Ct))return Ct=Na(Ct,Qt.mode,nn,null),Ct.return=Qt,Ct;if(typeof Ct.then=="function")return Jn(Qt,mt(Ct),nn);if(Ct.$$typeof===eo)return Jn(Qt,vr(Qt,Ct),nn);_t(Qt,Ct)}return null}function nr(Qt,Ct,nn,Un){var Mr=Ct!==null?Ct.key:null;if(typeof nn=="string"&&nn!==""||typeof nn=="number"||typeof nn=="bigint")return Mr!==null?null:yt(Qt,Ct,""+nn,Un);if(typeof nn=="object"&&nn!==null){switch(nn.$$typeof){case ll:return nn.key===Mr?zt(Qt,Ct,nn,Un):null;case Xl:return nn.key===Mr?mn(Qt,Ct,nn,Un):null;case Co:return Mr=nn._init,nn=Mr(nn._payload),nr(Qt,Ct,nn,Un)}if(Qh(nn)||s(nn))return Mr!==null?null:Ln(Qt,Ct,nn,Un,null);if(typeof nn.then=="function")return nr(Qt,Ct,mt(nn),Un);if(nn.$$typeof===eo)return nr(Qt,Ct,vr(Qt,nn),Un);_t(Qt,nn)}return null}function Yr(Qt,Ct,nn,Un,Mr){if(typeof Un=="string"&&Un!==""||typeof Un=="number"||typeof Un=="bigint")return Qt=Qt.get(nn)||null,yt(Ct,Qt,""+Un,Mr);if(typeof Un=="object"&&Un!==null){switch(Un.$$typeof){case ll:return Qt=Qt.get(Un.key===null?nn:Un.key)||null,zt(Ct,Qt,Un,Mr);case Xl:return Qt=Qt.get(Un.key===null?nn:Un.key)||null,mn(Ct,Qt,Un,Mr);case Co:var ya=Un._init;return Un=ya(Un._payload),Yr(Qt,Ct,nn,Un,Mr)}if(Qh(Un)||s(Un))return Qt=Qt.get(nn)||null,Ln(Ct,Qt,Un,Mr,null);if(typeof Un.then=="function")return Yr(Qt,Ct,nn,mt(Un),Mr);if(Un.$$typeof===eo)return Yr(Qt,Ct,nn,vr(Ct,Un),Mr);_t(Ct,Un)}return null}function lu(Qt,Ct,nn,Un){for(var Mr=null,ya=null,Xr=Ct,Ss=Ct=0,Aa=null;Xr!==null&&Ss<nn.length;Ss++){Xr.index>Ss?(Aa=Xr,Xr=null):Aa=Xr.sibling;var Qi=nr(Qt,Xr,nn[Ss],Un);if(Qi===null){Xr===null&&(Xr=Aa);break}T&&Xr&&Qi.alternate===null&&R(Qt,Xr),Ct=Te(Qi,Ct,Ss),ya===null?Mr=Qi:ya.sibling=Qi,ya=Qi,Xr=Aa}if(Ss===nn.length)return z(Qt,Xr),Wn&&Z(Qt,Ss),Mr;if(Xr===null){for(;Ss<nn.length;Ss++)Xr=Jn(Qt,nn[Ss],Un),Xr!==null&&(Ct=Te(Xr,Ct,Ss),ya===null?Mr=Xr:ya.sibling=Xr,ya=Xr);return Wn&&Z(Qt,Ss),Mr}for(Xr=re(Xr);Ss<nn.length;Ss++)Aa=Yr(Xr,Qt,Ss,nn[Ss],Un),Aa!==null&&(T&&Aa.alternate!==null&&Xr.delete(Aa.key===null?Ss:Aa.key),Ct=Te(Aa,Ct,Ss),ya===null?Mr=Aa:ya.sibling=Aa,ya=Aa);return T&&Xr.forEach(function(pd){return R(Qt,pd)}),Wn&&Z(Qt,Ss),Mr}function hd(Qt,Ct,nn,Un){if(nn==null)throw Error(i(151));for(var Mr=null,ya=null,Xr=Ct,Ss=Ct=0,Aa=null,Qi=nn.next();Xr!==null&&!Qi.done;Ss++,Qi=nn.next()){Xr.index>Ss?(Aa=Xr,Xr=null):Aa=Xr.sibling;var pd=nr(Qt,Xr,Qi.value,Un);if(pd===null){Xr===null&&(Xr=Aa);break}T&&Xr&&pd.alternate===null&&R(Qt,Xr),Ct=Te(pd,Ct,Ss),ya===null?Mr=pd:ya.sibling=pd,ya=pd,Xr=Aa}if(Qi.done)return z(Qt,Xr),Wn&&Z(Qt,Ss),Mr;if(Xr===null){for(;!Qi.done;Ss++,Qi=nn.next())Qi=Jn(Qt,Qi.value,Un),Qi!==null&&(Ct=Te(Qi,Ct,Ss),ya===null?Mr=Qi:ya.sibling=Qi,ya=Qi);return Wn&&Z(Qt,Ss),Mr}for(Xr=re(Xr);!Qi.done;Ss++,Qi=nn.next())Qi=Yr(Xr,Qt,Ss,Qi.value,Un),Qi!==null&&(T&&Qi.alternate!==null&&Xr.delete(Qi.key===null?Ss:Qi.key),Ct=Te(Qi,Ct,Ss),ya===null?Mr=Qi:ya.sibling=Qi,ya=Qi);return T&&Xr.forEach(function(r_){return R(Qt,r_)}),Wn&&Z(Qt,Ss),Mr}function dd(Qt,Ct,nn,Un){if(typeof nn=="object"&&nn!==null&&nn.type===ja&&nn.key===null&&(nn=nn.props.children),typeof nn=="object"&&nn!==null){switch(nn.$$typeof){case ll:e:{for(var Mr=nn.key;Ct!==null;){if(Ct.key===Mr){if(Mr=nn.type,Mr===ja){if(Ct.tag===7){z(Qt,Ct.sibling),Un=he(Ct,nn.props.children),Un.return=Qt,Qt=Un;break e}}else if(Ct.elementType===Mr||typeof Mr=="object"&&Mr!==null&&Mr.$$typeof===Co&&gn(Mr)===Ct.type){z(Qt,Ct.sibling),Un=he(Ct,nn.props),ft(Un,nn),Un.return=Qt,Qt=Un;break e}z(Qt,Ct);break}else R(Qt,Ct);Ct=Ct.sibling}nn.type===ja?(Un=Na(nn.props.children,Qt.mode,Un,nn.key),Un.return=Qt,Qt=Un):(Un=Zu(nn.type,nn.key,nn.props,null,Qt.mode,Un),ft(Un,nn),Un.return=Qt,Qt=Un)}return et(Qt);case Xl:e:{for(Mr=nn.key;Ct!==null;){if(Ct.key===Mr)if(Ct.tag===4&&Ct.stateNode.containerInfo===nn.containerInfo&&Ct.stateNode.implementation===nn.implementation){z(Qt,Ct.sibling),Un=he(Ct,nn.children||[]),Un.return=Qt,Qt=Un;break e}else{z(Qt,Ct);break}else R(Qt,Ct);Ct=Ct.sibling}Un=Qu(nn,Qt.mode,Un),Un.return=Qt,Qt=Un}return et(Qt);case Co:return Mr=nn._init,nn=Mr(nn._payload),dd(Qt,Ct,nn,Un)}if(Qh(nn))return lu(Qt,Ct,nn,Un);if(s(nn)){if(Mr=s(nn),typeof Mr!="function")throw Error(i(150));return nn=Mr.call(nn),hd(Qt,Ct,nn,Un)}if(typeof nn.then=="function")return dd(Qt,Ct,mt(nn),Un);if(nn.$$typeof===eo)return dd(Qt,Ct,vr(Qt,nn),Un);_t(Qt,nn)}return typeof nn=="string"&&nn!==""||typeof nn=="number"||typeof nn=="bigint"?(nn=""+nn,Ct!==null&&Ct.tag===6?(z(Qt,Ct.sibling),Un=he(Ct,nn),Un.return=Qt,Qt=Un):(z(Qt,Ct),Un=pp(nn,Qt.mode,Un),Un.return=Qt,Qt=Un),et(Qt)):z(Qt,Ct)}return function(Qt,Ct,nn,Un){try{iu=0;var Mr=dd(Qt,Ct,nn,Un);return ru=null,Mr}catch(Xr){if(Xr===_a)throw Xr;var ya=t(29,Xr,null,Qt.mode);return ya.lanes=Un,ya.return=Qt,ya}finally{}}}function Bt(T,R){T=qn,x(Hd,T),x(ca,R),qn=T|R.baseLanes}function Yt(){x(Hd,qn),x(ca,ca.current)}function Mt(){qn=Hd.current,v(ca),v(Hd)}function fn(T){var R=T.alternate;x(Oo,Oo.current&1),x(su,T),Gs===null&&(R===null||ca.current!==null||R.memoizedState!==null)&&(Gs=T)}function Bn(T){if(T.tag===22){if(x(Oo,Oo.current),x(su,T),Gs===null){var R=T.alternate;R!==null&&R.memoizedState!==null&&(Gs=T)}}else cn()}function cn(){x(Oo,Oo.current),x(su,su.current)}function In(T){v(su),Gs===T&&(Gs=null),v(Oo)}function $n(T){for(var R=T;R!==null;){if(R.tag===13){var z=R.memoizedState;if(z!==null&&(z=z.dehydrated,z===null||lm(z)||ug(z)))return R}else if(R.tag===19&&R.memoizedProps.revealOrder!==void 0){if((R.flags&128)!==0)return R}else if(R.child!==null){R.child.return=R,R=R.child;continue}if(R===T)break;for(;R.sibling===null;){if(R.return===null||R.return===T)return null;R=R.return}R.sibling.return=R.return,R=R.sibling}return null}function er(){throw Error(i(321))}function as(T,R){if(R===null)return!1;for(var z=0;z<R.length&&z<T.length;z++)if(!Il(T[z],R[z]))return!1;return!0}function di(T,R,z,re,he,Te){return cd=Te,_i=R,R.memoizedState=null,R.updateQueue=null,R.lanes=0,jr.H=T===null||T.memoizedState===null?cf:ui,bh=!1,Te=z(re,he),bh=!1,ud&&(Te=Bs(R,z,re,he)),Oi(T),Te}function Oi(T){jr.H=ks;var R=ar!==null&&ar.next!==null;if(cd=0,Ui=ar=_i=null,$o=!1,Io=0,ds=null,R)throw Error(i(300));T===null||va||(T=T.dependencies,T!==null&&sr(T)&&(va=!0))}function Bs(T,R,z,re){_i=T;var he=0;do{if(ud&&(ds=null),Io=0,ud=!1,25<=he)throw Error(i(301));if(he+=1,Ui=ar=null,T.updateQueue!=null){var Te=T.updateQueue;Te.lastEffect=null,Te.events=null,Te.stores=null,Te.memoCache!=null&&(Te.memoCache.index=0)}jr.H=au,Te=R(z,re)}while(ud);return Te}function pi(){var T=jr.H,R=T.useState()[0];return R=typeof R.then=="function"?Wt(R):R,T=T.useState()[0],(ar!==null?ar.memoizedState:null)!==T&&(_i.flags|=1024),R}function ws(){var T=_g!==0;return _g=0,T}function na(T,R,z){R.updateQueue=T.updateQueue,R.flags&=-2053,T.lanes&=~z}function os(T){if($o){for(T=T.memoizedState;T!==null;){var R=T.queue;R!==null&&(R.pending=null),T=T.next}$o=!1}cd=0,Ui=ar=_i=null,ud=!1,Io=_g=0,ds=null}function We(){var T={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ui===null?_i.memoizedState=Ui=T:Ui=Ui.next=T,Ui}function At(){if(ar===null){var T=_i.alternate;T=T!==null?T.memoizedState:null}else T=ar.next;var R=Ui===null?_i.memoizedState:Ui.next;if(R!==null)Ui=R,ar=T;else{if(T===null)throw _i.alternate===null?Error(i(467)):Error(i(310));ar=T,T={memoizedState:ar.memoizedState,baseState:ar.baseState,baseQueue:ar.baseQueue,queue:ar.queue,next:null},Ui===null?_i.memoizedState=Ui=T:Ui=Ui.next=T}return Ui}function Wt(T){var R=Io;return Io+=1,ds===null&&(ds=[]),T=Qe(ds,T,R),R=_i,(Ui===null?R.memoizedState:Ui.next)===null&&(R=R.alternate,jr.H=R===null||R.memoizedState===null?cf:ui),T}function Kt(T){if(T!==null&&typeof T=="object"){if(typeof T.then=="function")return Wt(T);if(T.$$typeof===eo)return Oa(T)}throw Error(i(438,String(T)))}function Lt(T){var R=null,z=_i.updateQueue;if(z!==null&&(R=z.memoCache),R==null){var re=_i.alternate;re!==null&&(re=re.updateQueue,re!==null&&(re=re.memoCache,re!=null&&(R={data:re.data.map(function(he){return he.slice()}),index:0})))}if(R==null&&(R={data:[],index:0}),z===null&&(z=ec(),_i.updateQueue=z),z.memoCache=R,z=R.data[R.index],z===void 0)for(z=R.data[R.index]=Array(T),re=0;re<T;re++)z[re]=nf;return R.index++,z}function yn(T,R){return typeof R=="function"?R(T):R}function zn(T){var R=At();return En(R,ar,T)}function En(T,R,z){var re=T.queue;if(re===null)throw Error(i(311));re.lastRenderedReducer=z;var he=T.baseQueue,Te=re.pending;if(Te!==null){if(he!==null){var et=he.next;he.next=Te.next,Te.next=et}R.baseQueue=he=Te,re.pending=null}if(Te=T.baseState,he===null)T.memoizedState=Te;else{R=he.next;var yt=et=null,zt=null,mn=R,Ln=!1;do{var Jn=mn.lane&-536870913;if(Jn!==mn.lane?(Zt&Jn)===Jn:(cd&Jn)===Jn){var nr=mn.revertLane;if(nr===0)zt!==null&&(zt=zt.next={lane:0,revertLane:0,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null}),Jn===Zi&&(Ln=!0);else if((cd&nr)===nr){mn=mn.next,nr===Zi&&(Ln=!0);continue}else Jn={lane:0,revertLane:mn.revertLane,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null},zt===null?(yt=zt=Jn,et=Te):zt=zt.next=Jn,_i.lanes|=nr,gr|=nr;Jn=mn.action,bh&&z(Te,Jn),Te=mn.hasEagerState?mn.eagerState:z(Te,Jn)}else nr={lane:Jn,revertLane:mn.revertLane,action:mn.action,hasEagerState:mn.hasEagerState,eagerState:mn.eagerState,next:null},zt===null?(yt=zt=nr,et=Te):zt=zt.next=nr,_i.lanes|=Jn,gr|=Jn;mn=mn.next}while(mn!==null&&mn!==R);if(zt===null?et=Te:zt.next=yt,!Il(Te,T.memoizedState)&&(va=!0,Ln&&(z=Zr,z!==null)))throw z;T.memoizedState=Te,T.baseState=et,T.baseQueue=zt,re.lastRenderedState=Te}return he===null&&(re.lanes=0),[T.memoizedState,re.dispatch]}function tr(T){var R=At(),z=R.queue;if(z===null)throw Error(i(311));z.lastRenderedReducer=T;var re=z.dispatch,he=z.pending,Te=R.memoizedState;if(he!==null){z.pending=null;var et=he=he.next;do Te=T(Te,et.action),et=et.next;while(et!==he);Il(Te,R.memoizedState)||(va=!0),R.memoizedState=Te,R.baseQueue===null&&(R.baseState=Te),z.lastRenderedState=Te}return[Te,re]}function Ir(T,R,z){var re=_i,he=At(),Te=Wn;if(Te){if(z===void 0)throw Error(i(407));z=z()}else z=R();var et=!Il((ar||he).memoizedState,z);if(et&&(he.memoizedState=z,va=!0),he=he.queue,Wp(Dr.bind(null,re,he,T),[T]),he.getSnapshot!==R||et||Ui!==null&&Ui.memoizedState.tag&1){if(re.flags|=2048,bo(9,rr.bind(null,re,he,z,R),{destroy:void 0},null),It===null)throw Error(i(349));Te||(cd&60)!==0||Er(re,R,z)}return z}function Er(T,R,z){T.flags|=16384,T={getSnapshot:R,value:z},R=_i.updateQueue,R===null?(R=ec(),_i.updateQueue=R,R.stores=[T]):(z=R.stores,z===null?R.stores=[T]:z.push(T))}function rr(T,R,z,re){R.value=z,R.getSnapshot=re,ri(R)&&ha(T)}function Dr(T,R,z){return z(function(){ri(R)&&ha(T)})}function ri(T){var R=T.getSnapshot;T=T.value;try{var z=R();return!Il(T,z)}catch{return!0}}function ha(T){var R=ze(T,2);R!==null&&wo(R,T,2)}function Cr(T){var R=We();if(typeof T=="function"){var z=T;if(T=z(),bh){q(!0);try{z()}finally{q(!1)}}}return R.memoizedState=R.baseState=T,R.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:T},R}function ii(T,R,z,re){return T.baseState=z,En(T,ar,typeof re=="function"?re:yn)}function Tr(T,R,z,re,he){if(ih(T))throw Error(i(485));if(T=R.action,T!==null){var Te={payload:he,action:T,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(et){Te.listeners.push(et)}};jr.T!==null?z(!0):Te.isTransition=!1,re(Te),z=R.pending,z===null?(Te.next=R.pending=Te,Pr(R,Te)):(Te.next=z.next,R.pending=z.next=Te)}}function Pr(T,R){var z=R.action,re=R.payload,he=T.state;if(R.isTransition){var Te=jr.T,et={};jr.T=et;try{var yt=z(he,re),zt=jr.S;zt!==null&&zt(et,yt),Cn(T,R,yt)}catch(mn){Do(T,R,mn)}finally{jr.T=Te}}else try{Te=z(he,re),Cn(T,R,Te)}catch(mn){Do(T,R,mn)}}function Cn(T,R,z){z!==null&&typeof z=="object"&&typeof z.then=="function"?z.then(function(re){zr(T,R,re)},function(re){return Do(T,R,re)}):zr(T,R,z)}function zr(T,R,z){R.status="fulfilled",R.value=z,ls(R),T.state=z,R=T.pending,R!==null&&(z=R.next,z===R?T.pending=null:(z=z.next,R.next=z,Pr(T,z)))}function Do(T,R,z){var re=T.pending;if(T.pending=null,re!==null){re=re.next;do R.status="rejected",R.reason=z,ls(R),R=R.next;while(R!==re)}T.action=null}function ls(T){T=T.listeners;for(var R=0;R<T.length;R++)(0,T[R])()}function Lo(T,R){return R}function cs(T,R){if(Wn){var z=It.formState;if(z!==null){e:{var re=_i;if(Wn){if(fr){var he=cm(fr,$r);if(he){fr=um(he),re=Q0(he);break e}}Pe(re)}re=!1}re&&(R=z[0])}}z=We(),z.memoizedState=z.baseState=R,re={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Lo,lastRenderedState:R},z.queue=re,z=co.bind(null,_i,re),re.dispatch=z,re=Cr(!1);var Te=Wc.bind(null,_i,!1,re.queue);return re=We(),he={state:R,dispatch:null,action:T,pending:null},re.queue=he,z=Tr.bind(null,_i,he,Te,z),he.dispatch=z,re.memoizedState=T,[R,z,!1]}function Xn(T){var R=At();return Jr(R,ar,T)}function Jr(T,R,z){R=En(T,R,Lo)[0],T=zn(yn)[0],R=typeof R=="object"&&R!==null&&typeof R.then=="function"?Wt(R):R;var re=At(),he=re.queue,Te=he.dispatch;return z!==re.memoizedState&&(_i.flags|=2048,bo(9,ur.bind(null,he,z),{destroy:void 0},null)),[R,Te,T]}function ur(T,R){T.action=R}function Fs(T){var R=At(),z=ar;if(z!==null)return Jr(R,z,T);At(),R=R.memoizedState,z=At();var re=z.queue.dispatch;return z.memoizedState=T,[R,re,!1]}function bo(T,R,z,re){return T={tag:T,create:R,inst:z,deps:re,next:null},R=_i.updateQueue,R===null&&(R=ec(),_i.updateQueue=R),z=R.lastEffect,z===null?R.lastEffect=T.next=T:(re=z.next,z.next=T,T.next=re,R.lastEffect=T),T}function da(){return At().memoizedState}function pa(T,R,z,re){var he=We();_i.flags|=T,he.memoizedState=bo(1|R,z,{destroy:void 0},re===void 0?null:re)}function zh(T,R,z,re){var he=At();re=re===void 0?null:re;var Te=he.memoizedState.inst;ar!==null&&re!==null&&as(re,ar.memoizedState.deps)?he.memoizedState=bo(R,z,Te,re):(_i.flags|=T,he.memoizedState=bo(1|R,z,Te,re))}function lp(T,R){pa(8390656,8,T,R)}function Wp(T,R){zh(2048,8,T,R)}function Yp(T,R){return zh(4,2,T,R)}function rh(T,R){return zh(4,4,T,R)}function Tl(T,R){if(typeof R=="function"){T=T();var z=R(T);return function(){typeof z=="function"?z():R(null)}}if(R!=null)return T=T(),R.current=T,function(){R.current=null}}function ac(T,R,z){z=z!=null?z.concat([T]):null,zh(4,4,Tl.bind(null,R,T),z)}function Uo(){}function rl(T,R){var z=At();R=R===void 0?null:R;var re=z.memoizedState;return R!==null&&as(R,re[1])?re[0]:(z.memoizedState=[T,R],T)}function Xp(T,R){var z=At();R=R===void 0?null:R;var re=z.memoizedState;if(R!==null&&as(R,re[1]))return re[0];if(re=T(),bh){q(!0);try{T()}finally{q(!1)}}return z.memoizedState=[re,R],re}function wc(T,R,z){return z===void 0||(cd&1073741824)!==0?T.memoizedState=R:(T.memoizedState=z,T=dp(),_i.lanes|=T,gr|=T,z)}function Gc(T,R,z,re){return Il(z,R)?z:ca.current!==null?(T=wc(T,z,re),Il(T,R)||(va=!0),T):(cd&42)===0?(va=!0,T.memoizedState=z):(T=dp(),_i.lanes|=T,gr|=T,R)}function $u(T,R,z,re,he){var Te=no();Zs(Te!==0&&8>Te?Te:8);var et=jr.T,yt={};jr.T=yt,Wc(T,!1,R,z);try{var zt=he(),mn=jr.S;if(mn!==null&&mn(yt,zt),zt!==null&&typeof zt=="object"&&typeof zt.then=="function"){var Ln=je(zt,re);$c(T,R,Ln,ga(T))}else $c(T,R,re,ga(T))}catch(Jn){$c(T,R,{then:function(){},status:"rejected",reason:Jn},ga())}finally{Zs(Te),jr.T=et}}function Wi(T){var R=T.memoizedState;if(R!==null)return R;R={memoizedState:hc,baseState:hc,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:hc},next:null};var z={};return R.next={memoizedState:z,baseState:z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yn,lastRenderedState:z},next:null},T.memoizedState=R,T=T.alternate,T!==null&&(T.memoizedState=R),R}function Yi(){return Oa(dr)}function Rc(){return At().memoizedState}function Ef(){return At().memoizedState}function Zm(T){for(var R=T.return;R!==null;){switch(R.tag){case 24:case 3:var z=ga();T=_e(z);var re=Ne(R,T,z);re!==null&&(wo(re,R,z),Le(re,R,z)),R={cache:ch()},T.payload=R;return}R=R.return}}function oc(T,R,z){var re=ga();z={lane:re,revertLane:0,action:z,hasEagerState:!1,eagerState:null,next:null},ih(T)?ma(R,z):(z=Ge(T,R,z,re),z!==null&&(wo(z,T,re),xf(z,R,re)))}function co(T,R,z){var re=ga();$c(T,R,z,re)}function $c(T,R,z,re){var he={lane:re,revertLane:0,action:z,hasEagerState:!1,eagerState:null,next:null};if(ih(T))ma(R,he);else{var Te=T.alternate;if(T.lanes===0&&(Te===null||Te.lanes===0)&&(Te=R.lastRenderedReducer,Te!==null))try{var et=R.lastRenderedState,yt=Te(et,z);if(he.hasEagerState=!0,he.eagerState=yt,Il(yt,et))return Ue(T,R,he,0),It===null&&oe(),!1}catch{}finally{}if(z=Ge(T,R,he,re),z!==null)return wo(z,T,re),xf(z,R,re),!0}return!1}function Wc(T,R,z,re){if(re={lane:2,revertLane:Vt(),action:re,hasEagerState:!1,eagerState:null,next:null},ih(T)){if(R)throw Error(i(479))}else R=Ge(T,z,re,2),R!==null&&wo(R,T,2)}function ih(T){var R=T.alternate;return T===_i||R!==null&&R===_i}function ma(T,R){ud=$o=!0;var z=T.pending;z===null?R.next=R:(R.next=z.next,z.next=R),T.pending=R}function xf(T,R,z){if((z&4194176)!==0){var re=R.lanes;re&=T.pendingLanes,z|=re,R.lanes=z,U(T,z)}}function sh(T,R,z,re){R=T.memoizedState,z=z(re,R),z=z==null?R:Od({},R,z),T.memoizedState=z,T.lanes===0&&(T.updateQueue.baseState=z)}function ah(T,R,z,re,he,Te,et){return T=T.stateNode,typeof T.shouldComponentUpdate=="function"?T.shouldComponentUpdate(re,Te,et):R.prototype&&R.prototype.isPureReactComponent?!Ze(z,re)||!Ze(he,Te):!0}function Qm(T,R,z,re){T=R.state,typeof R.componentWillReceiveProps=="function"&&R.componentWillReceiveProps(z,re),typeof R.UNSAFE_componentWillReceiveProps=="function"&&R.UNSAFE_componentWillReceiveProps(z,re),R.state!==T&&Sh.enqueueReplaceState(R,R.state,null)}function Wu(T,R){var z=R;if("ref"in R){z={};for(var re in R)re!=="ref"&&(z[re]=R[re])}if(T=T.defaultProps){z===R&&(z=Od({},z));for(var he in T)z[he]===void 0&&(z[he]=T[he])}return z}function Tf(T,R){try{var z=T.onUncaughtError;z(R.value,{componentStack:R.stack})}catch(re){setTimeout(function(){throw re})}}function oh(T,R,z){try{var re=T.onCaughtError;re(z.value,{componentStack:z.stack,errorBoundary:R.tag===1?R.stateNode:null})}catch(he){setTimeout(function(){throw he})}}function Bo(T,R,z){return z=_e(z),z.tag=3,z.payload={element:null},z.callback=function(){Tf(T,R)},z}function Vl(T){return T=_e(T),T.tag=3,T}function Ad(T,R,z,re){var he=z.type.getDerivedStateFromError;if(typeof he=="function"){var Te=re.value;T.payload=function(){return he(Te)},T.callback=function(){oh(R,z,re)}}var et=z.stateNode;et!==null&&typeof et.componentDidCatch=="function"&&(T.callback=function(){oh(R,z,re),typeof he!="function"&&(Js===null?Js=new Set([this]):Js.add(this));var yt=re.stack;this.componentDidCatch(re.value,{componentStack:yt!==null?yt:""})})}function Kp(T,R,z,re,he){if(z.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){if(R=z.alternate,R!==null&&lh(R,z,he,!0),z=su.current,z!==null){switch(z.tag){case 13:return Gs===null?si():z.alternate===null&&Dn===0&&(Dn=3),z.flags&=-257,z.flags|=65536,z.lanes=he,re===jd?z.flags|=16384:(R=z.updateQueue,R===null?z.updateQueue=new Set([re]):R.add(re),Xc(T,re,he)),!1;case 22:return z.flags|=65536,re===jd?z.flags|=16384:(R=z.updateQueue,R===null?(R={transitions:null,markerInstances:null,retryQueue:new Set([re])},z.updateQueue=R):(z=R.retryQueue,z===null?R.retryQueue=new Set([re]):z.add(re)),Xc(T,re,he)),!1}throw Error(i(435,z.tag))}return Xc(T,re,he),si(),!1}if(Wn)return R=su.current,R!==null?((R.flags&65536)===0&&(R.flags|=256),R.flags|=65536,R.lanes=he,re!==rs&&(T=Error(i(422),{cause:re}),pt(ae(T,z)))):(re!==rs&&(R=Error(i(423),{cause:re}),pt(ae(R,z))),T=T.current.alternate,T.flags|=65536,he&=-he,T.lanes|=he,re=ae(re,z),he=Bo(T.stateNode,re,he),ke(T,he),Dn!==4&&(Dn=2)),!1;var Te=Error(i(520),{cause:re});if(Te=ae(Te,z),Bi===null?Bi=[Te]:Bi.push(Te),Dn!==4&&(Dn=2),R===null)return!0;re=ae(re,z),z=R;do{switch(z.tag){case 3:return z.flags|=65536,T=he&-he,z.lanes|=T,T=Bo(z.stateNode,re,T),ke(z,T),!1;case 1:if(R=z.type,Te=z.stateNode,(z.flags&128)===0&&(typeof R.getDerivedStateFromError=="function"||Te!==null&&typeof Te.componentDidCatch=="function"&&(Js===null||!Js.has(Te))))return z.flags|=65536,he&=-he,z.lanes|=he,he=Vl(he),Ad(he,T,z,re),ke(z,he),!1}z=z.return}while(z!==null);return!1}function il(T,R,z,re){R.child=T===null?lf(R,null,z,re):yh(R,T.child,z,re)}function Jm(T,R,z,re,he){z=z.render;var Te=R.ref;if("ref"in re){var et={};for(var yt in re)yt!=="ref"&&(et[yt]=re[yt])}else et=re;return Cc(R),re=di(T,R,z,et,Te,he),yt=ws(),T!==null&&!va?(na(T,R,he),Zn(T,R,he)):(Wn&&yt&&ne(R),R.flags|=1,il(T,R,re,he),R.child)}function q_(T,R,z,re,he){if(T===null){var Te=z.type;return typeof Te=="function"&&!kd(Te)&&Te.defaultProps===void 0&&z.compare===null?(R.tag=15,R.type=Te,V_(T,R,Te,re,he)):(T=Zu(z.type,null,re,R,R.mode,he),T.ref=R.ref,T.return=R,R.child=T)}if(Te=T.child,!Ri(T,he)){var et=Te.memoizedProps;if(z=z.compare,z=z!==null?z:Ze,z(et,re)&&T.ref===R.ref)return Zn(T,R,he)}return R.flags|=1,T=Ao(Te,re),T.ref=R.ref,T.return=R,R.child=T}function V_(T,R,z,re,he){if(T!==null){var Te=T.memoizedProps;if(Ze(Te,re)&&T.ref===R.ref)if(va=!1,R.pendingProps=re=Te,Ri(T,he))(T.flags&131072)!==0&&(va=!0);else return R.lanes=T.lanes,Zn(T,R,he)}return Yu(T,R,z,re,he)}function cp(T,R,z){var re=R.pendingProps,he=re.children,Te=(R.stateNode._pendingVisibility&2)!==0,et=T!==null?T.memoizedState:null;if(Hh(T,R),re.mode==="hidden"||Te){if((R.flags&128)!==0){if(re=et!==null?et.baseLanes|z:z,T!==null){for(he=R.child=T.child,Te=0;he!==null;)Te=Te|he.lanes|he.childLanes,he=he.sibling;R.childLanes=Te&~re}else R.childLanes=0,R.child=null;return jh(T,R,re,z)}if((z&536870912)!==0)R.memoizedState={baseLanes:0,cachePool:null},T!==null&&Gl(R,et!==null?et.cachePool:null),et!==null?Bt(R,et):Yt(),Bn(R);else return R.lanes=R.childLanes=536870912,jh(T,R,et!==null?et.baseLanes|z:z,z)}else et!==null?(Gl(R,et.cachePool),Bt(R,et),cn(),R.memoizedState=null):(T!==null&&Gl(R,null),Yt(),cn());return il(T,R,he,z),R.child}function jh(T,R,z,re){var he=X0();return he=he===null?null:{parent:ul?te._currentValue:te._currentValue2,pool:he},R.memoizedState={baseLanes:z,cachePool:he},T!==null&&Gl(R,null),Yt(),Bn(R),T!==null&&lh(T,R,re,!0),null}function Hh(T,R){var z=R.ref;if(z===null)T!==null&&T.ref!==null&&(R.flags|=2097664);else{if(typeof z!="function"&&typeof z!="object")throw Error(i(284));(T===null||T.ref!==z)&&(R.flags|=2097664)}}function Yu(T,R,z,re,he){return Cc(R),z=di(T,R,z,re,void 0,he),re=ws(),T!==null&&!va?(na(T,R,he),Zn(T,R,he)):(Wn&&re&&ne(R),R.flags|=1,il(T,R,z,he),R.child)}function Xu(T,R,z,re,he,Te){return Cc(R),R.updateQueue=null,z=Bs(R,re,z,he),Oi(T),re=ws(),T!==null&&!va?(na(T,R,Te),Zn(T,R,Te)):(Wn&&re&&ne(R),R.flags|=1,il(T,R,z,Te),R.child)}function eg(T,R,z,re,he){if(Cc(R),R.stateNode===null){var Te=Bf,et=z.contextType;typeof et=="object"&&et!==null&&(Te=Oa(et)),Te=new z(re,Te),R.memoizedState=Te.state!==null&&Te.state!==void 0?Te.state:null,Te.updater=Sh,R.stateNode=Te,Te._reactInternals=R,Te=R.stateNode,Te.props=re,Te.state=R.memoizedState,Te.refs={},ge(R),et=z.contextType,Te.context=typeof et=="object"&&et!==null?Oa(et):Bf,Te.state=R.memoizedState,et=z.getDerivedStateFromProps,typeof et=="function"&&(sh(R,z,et,re),Te.state=R.memoizedState),typeof z.getDerivedStateFromProps=="function"||typeof Te.getSnapshotBeforeUpdate=="function"||typeof Te.UNSAFE_componentWillMount!="function"&&typeof Te.componentWillMount!="function"||(et=Te.state,typeof Te.componentWillMount=="function"&&Te.componentWillMount(),typeof Te.UNSAFE_componentWillMount=="function"&&Te.UNSAFE_componentWillMount(),et!==Te.state&&Sh.enqueueReplaceState(Te,Te.state,null),st(R,re,Te,he),Re(),Te.state=R.memoizedState),typeof Te.componentDidMount=="function"&&(R.flags|=4194308),re=!0}else if(T===null){Te=R.stateNode;var yt=R.memoizedProps,zt=Wu(z,yt);Te.props=zt;var mn=Te.context,Ln=z.contextType;et=Bf,typeof Ln=="object"&&Ln!==null&&(et=Oa(Ln));var Jn=z.getDerivedStateFromProps;Ln=typeof Jn=="function"||typeof Te.getSnapshotBeforeUpdate=="function",yt=R.pendingProps!==yt,Ln||typeof Te.UNSAFE_componentWillReceiveProps!="function"&&typeof Te.componentWillReceiveProps!="function"||(yt||mn!==et)&&Qm(R,Te,re,et),so=!1;var nr=R.memoizedState;Te.state=nr,st(R,re,Te,he),Re(),mn=R.memoizedState,yt||nr!==mn||so?(typeof Jn=="function"&&(sh(R,z,Jn,re),mn=R.memoizedState),(zt=so||ah(R,z,zt,re,nr,mn,et))?(Ln||typeof Te.UNSAFE_componentWillMount!="function"&&typeof Te.componentWillMount!="function"||(typeof Te.componentWillMount=="function"&&Te.componentWillMount(),typeof Te.UNSAFE_componentWillMount=="function"&&Te.UNSAFE_componentWillMount()),typeof Te.componentDidMount=="function"&&(R.flags|=4194308)):(typeof Te.componentDidMount=="function"&&(R.flags|=4194308),R.memoizedProps=re,R.memoizedState=mn),Te.props=re,Te.state=mn,Te.context=et,re=zt):(typeof Te.componentDidMount=="function"&&(R.flags|=4194308),re=!1)}else{Te=R.stateNode,se(T,R),et=R.memoizedProps,Ln=Wu(z,et),Te.props=Ln,Jn=R.pendingProps,nr=Te.context,mn=z.contextType,zt=Bf,typeof mn=="object"&&mn!==null&&(zt=Oa(mn)),yt=z.getDerivedStateFromProps,(mn=typeof yt=="function"||typeof Te.getSnapshotBeforeUpdate=="function")||typeof Te.UNSAFE_componentWillReceiveProps!="function"&&typeof Te.componentWillReceiveProps!="function"||(et!==Jn||nr!==zt)&&Qm(R,Te,re,zt),so=!1,nr=R.memoizedState,Te.state=nr,st(R,re,Te,he),Re();var Yr=R.memoizedState;et!==Jn||nr!==Yr||so||T!==null&&T.dependencies!==null&&sr(T.dependencies)?(typeof yt=="function"&&(sh(R,z,yt,re),Yr=R.memoizedState),(Ln=so||ah(R,z,Ln,re,nr,Yr,zt)||T!==null&&T.dependencies!==null&&sr(T.dependencies))?(mn||typeof Te.UNSAFE_componentWillUpdate!="function"&&typeof Te.componentWillUpdate!="function"||(typeof Te.componentWillUpdate=="function"&&Te.componentWillUpdate(re,Yr,zt),typeof Te.UNSAFE_componentWillUpdate=="function"&&Te.UNSAFE_componentWillUpdate(re,Yr,zt)),typeof Te.componentDidUpdate=="function"&&(R.flags|=4),typeof Te.getSnapshotBeforeUpdate=="function"&&(R.flags|=1024)):(typeof Te.componentDidUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=4),typeof Te.getSnapshotBeforeUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=1024),R.memoizedProps=re,R.memoizedState=Yr),Te.props=re,Te.state=Yr,Te.context=zt,re=Ln):(typeof Te.componentDidUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=4),typeof Te.getSnapshotBeforeUpdate!="function"||et===T.memoizedProps&&nr===T.memoizedState||(R.flags|=1024),re=!1)}return Te=re,Hh(T,R),re=(R.flags&128)!==0,Te||re?(Te=R.stateNode,z=re&&typeof z.getDerivedStateFromError!="function"?null:Te.render(),R.flags|=1,T!==null&&re?(R.child=yh(R,T.child,null,he),R.child=yh(R,null,z,he)):il(T,R,z,he),R.memoizedState=Te.state,T=R.child):T=Zn(T,R,he),T}function vs(T,R,z,re){return at(),R.flags|=256,il(T,R,z,re),R.child}function Ta(T){return{baseLanes:T,cachePool:ng()}}function up(T,R,z){return T=T!==null?T.childLanes&~z:0,R&&(T|=ai),T}function tg(T,R,z){var re=R.pendingProps,he=!1,Te=(R.flags&128)!==0,et;if((et=Te)||(et=T!==null&&T.memoizedState===null?!1:(Oo.current&2)!==0),et&&(he=!0,R.flags&=-129),et=(R.flags&32)!==0,R.flags&=-33,T===null){if(Wn){if(he?fn(R):cn(),Wn){var yt=fr,zt;(zt=yt)&&(yt=i0(yt,$r),yt!==null?(R.memoizedState={dehydrated:yt,treeContext:of!==null?{id:Vs,overflow:Ms}:null,retryLane:536870912},zt=t(18,null,null,0),zt.stateNode=yt,zt.return=R,R.child=zt,mr=R,fr=null,zt=!0):zt=!1),zt||Pe(R)}if(yt=R.memoizedState,yt!==null&&(yt=yt.dehydrated,yt!==null))return ug(yt)?R.lanes=16:R.lanes=536870912,null;In(R)}return yt=re.children,re=re.fallback,he?(cn(),he=R.mode,yt=rt({mode:"hidden",children:yt},he),re=Na(re,he,z,null),yt.return=R,re.return=R,yt.sibling=re,R.child=yt,he=R.child,he.memoizedState=Ta(z),he.childLanes=up(T,et,z),R.memoizedState=jf,re):(fn(R),qh(R,yt))}if(zt=T.memoizedState,zt!==null&&(yt=zt.dehydrated,yt!==null)){if(Te)R.flags&256?(fn(R),R.flags&=-257,R=Tt(T,R,z)):R.memoizedState!==null?(cn(),R.child=T.child,R.flags|=128,R=null):(cn(),he=re.fallback,yt=R.mode,re=rt({mode:"visible",children:re.children},yt),he=Na(he,yt,z,null),he.flags|=2,re.return=R,he.return=R,re.sibling=he,R.child=re,yh(R,T.child,null,z),re=R.child,re.memoizedState=Ta(z),re.childLanes=up(T,et,z),R.memoizedState=jf,R=he);else if(fn(R),ug(yt))et=t0(yt).digest,re=Error(i(419)),re.stack="",re.digest=et,pt({value:re,source:null,stack:null}),R=Tt(T,R,z);else if(va||lh(T,R,z,!1),et=(z&T.childLanes)!==0,va||et){if(et=It,et!==null){if(re=z&-z,(re&42)!==0)re=1;else switch(re){case 2:re=1;break;case 8:re=4;break;case 32:re=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:re=64;break;case 268435456:re=134217728;break;default:re=0}if(re=(re&(et.suspendedLanes|z))!==0?0:re,re!==0&&re!==zt.retryLane)throw zt.retryLane=re,ze(T,re),wo(et,T,re),hm}lm(yt)||si(),R=Tt(T,R,z)}else lm(yt)?(R.flags|=128,R.child=T.child,R=Kc.bind(null,T),n0(yt,R),R=null):(T=zt.treeContext,jo&&(fr=Ql(yt),mr=R,Wn=!0,Wa=null,$r=!1,T!==null&&(qi[$a++]=Vs,qi[$a++]=Ms,qi[$a++]=of,Vs=T.id,Ms=T.overflow,of=R)),R=qh(R,re.children),R.flags|=4096);return R}return he?(cn(),he=re.fallback,yt=R.mode,zt=T.child,Te=zt.sibling,re=Ao(zt,{mode:"hidden",children:re.children}),re.subtreeFlags=zt.subtreeFlags&31457280,Te!==null?he=Ao(Te,he):(he=Na(he,yt,z,null),he.flags|=2),he.return=R,re.return=R,re.sibling=he,R.child=re,re=he,he=R.child,yt=T.child.memoizedState,yt===null?yt=Ta(z):(zt=yt.cachePool,zt!==null?(Te=ul?te._currentValue:te._currentValue2,zt=zt.parent!==Te?{parent:Te,pool:Te}:zt):zt=ng(),yt={baseLanes:yt.baseLanes|z,cachePool:zt}),he.memoizedState=yt,he.childLanes=up(T,et,z),R.memoizedState=jf,re):(fn(R),z=T.child,T=z.sibling,z=Ao(z,{mode:"visible",children:re.children}),z.return=R,z.sibling=null,T!==null&&(et=R.deletions,et===null?(R.deletions=[T],R.flags|=16):et.push(T)),R.child=z,R.memoizedState=null,z)}function qh(T,R){return R=rt({mode:"visible",children:R},T.mode),R.return=T,T.child=R}function rt(T,R){return Kh(T,R,0,null)}function Tt(T,R,z){return yh(R,T.child,null,z),T=qh(R,R.pendingProps.children),T.flags|=2,R.memoizedState=null,T}function Rt(T,R,z){T.lanes|=R;var re=T.alternate;re!==null&&(re.lanes|=R),ns(T.return,R,z)}function tn(T,R,z,re,he){var Te=T.memoizedState;Te===null?T.memoizedState={isBackwards:R,rendering:null,renderingStartTime:0,last:re,tail:z,tailMode:he}:(Te.isBackwards=R,Te.rendering=null,Te.renderingStartTime=0,Te.last=re,Te.tail=z,Te.tailMode=he)}function wn(T,R,z){var re=R.pendingProps,he=re.revealOrder,Te=re.tail;if(il(T,R,re.children,z),re=Oo.current,(re&2)!==0)re=re&1|2,R.flags|=128;else{if(T!==null&&(T.flags&128)!==0)e:for(T=R.child;T!==null;){if(T.tag===13)T.memoizedState!==null&&Rt(T,z,R);else if(T.tag===19)Rt(T,z,R);else if(T.child!==null){T.child.return=T,T=T.child;continue}if(T===R)break e;for(;T.sibling===null;){if(T.return===null||T.return===R)break e;T=T.return}T.sibling.return=T.return,T=T.sibling}re&=1}switch(x(Oo,re),he){case"forwards":for(z=R.child,he=null;z!==null;)T=z.alternate,T!==null&&$n(T)===null&&(he=z),z=z.sibling;z=he,z===null?(he=R.child,R.child=null):(he=z.sibling,z.sibling=null),tn(R,!1,he,z,Te);break;case"backwards":for(z=null,he=R.child,R.child=null;he!==null;){if(T=he.alternate,T!==null&&$n(T)===null){R.child=he;break}T=he.sibling,he.sibling=z,z=he,he=T}tn(R,!0,z,null,Te);break;case"together":tn(R,!1,null,null,void 0);break;default:R.memoizedState=null}return R.child}function Zn(T,R,z){if(T!==null&&(R.dependencies=T.dependencies),gr|=R.lanes,(z&R.childLanes)===0)if(T!==null){if(lh(T,R,z,!1),(z&R.childLanes)===0)return null}else return null;if(T!==null&&R.child!==T.child)throw Error(i(153));if(R.child!==null){for(T=R.child,z=Ao(T,T.pendingProps),R.child=z,z.return=R;T.sibling!==null;)T=T.sibling,z=z.sibling=Ao(T,T.pendingProps),z.return=R;z.sibling=null}return R.child}function Ri(T,R){return(T.lanes&R)!==0?!0:(T=T.dependencies,!!(T!==null&&sr(T)))}function sl(T,R,z){switch(R.tag){case 3:ce(R,R.stateNode.containerInfo),So(R,te,T.memoizedState.cache),at();break;case 27:case 5:Me(R);break;case 4:ce(R,R.stateNode.containerInfo);break;case 10:So(R,R.type,R.memoizedProps.value);break;case 13:var re=R.memoizedState;if(re!==null)return re.dehydrated!==null?(fn(R),R.flags|=128,null):(z&R.child.childLanes)!==0?tg(T,R,z):(fn(R),T=Zn(T,R,z),T!==null?T.sibling:null);fn(R);break;case 19:var he=(T.flags&128)!==0;if(re=(z&R.childLanes)!==0,re||(lh(T,R,z,!1),re=(z&R.childLanes)!==0),he){if(re)return wn(T,R,z);R.flags|=128}if(he=R.memoizedState,he!==null&&(he.rendering=null,he.tail=null,he.lastEffect=null),x(Oo,Oo.current),re)break;return null;case 22:case 23:return R.lanes=0,cp(T,R,z);case 24:So(R,te,T.memoizedState.cache)}return Zn(T,R,z)}function _r(T,R,z){if(T!==null)if(T.memoizedProps!==R.pendingProps)va=!0;else{if(!Ri(T,z)&&(R.flags&128)===0)return va=!1,sl(T,R,z);va=(T.flags&131072)!==0}else va=!1,Wn&&(R.flags&1048576)!==0&&K(R,tu,R.index);switch(R.lanes=0,R.tag){case 16:e:{T=R.pendingProps;var re=R.elementType,he=re._init;if(re=he(re._payload),R.type=re,typeof re=="function")kd(re)?(T=Wu(re,T),R.tag=1,R=eg(null,R,re,T,z)):(R.tag=0,R=Yu(null,R,re,T,z));else{if(re!=null){if(he=re.$$typeof,he===Ju){R.tag=11,R=Jm(null,R,re,T,z);break e}else if(he===Ru){R.tag=14,R=q_(null,R,re,T,z);break e}}throw R=a(re)||re,Error(i(306,R,""))}}return R;case 0:return Yu(T,R,R.type,R.pendingProps,z);case 1:return re=R.type,he=Wu(re,R.pendingProps),eg(T,R,re,he,z);case 3:e:{if(ce(R,R.stateNode.containerInfo),T===null)throw Error(i(387));var Te=R.pendingProps;he=R.memoizedState,re=he.element,se(T,R),st(R,Te,null,z);var et=R.memoizedState;if(Te=et.cache,So(R,te,Te),Te!==he.cache&&Ac(R,[te],z,!0),Re(),Te=et.element,jo&&he.isDehydrated)if(he={element:Te,isDehydrated:!1,cache:et.cache},R.updateQueue.baseState=he,R.memoizedState=he,R.flags&256){R=vs(T,R,Te,z);break e}else if(Te!==re){re=ae(Error(i(424)),R),pt(re),R=vs(T,R,Te,z);break e}else for(jo&&(fr=Iu(R.stateNode.containerInfo),mr=R,Wn=!0,Wa=null,$r=!0),z=lf(R,null,Te,z),R.child=z;z;)z.flags=z.flags&-3|4096,z=z.sibling;else{if(at(),Te===re){R=Zn(T,R,z);break e}il(T,R,Te,z)}R=R.child}return R;case 26:if(Jc)return Hh(T,R),T===null?(z=t_(R.type,null,R.pendingProps,null))?R.memoizedState=z:Wn||(R.stateNode=Jl(R.type,R.pendingProps,mc.current,R)):R.memoizedState=t_(R.type,T.memoizedProps,R.pendingProps,T.memoizedState),null;case 27:if(qs)return Me(R),T===null&&qs&&Wn&&(re=R.stateNode=dc(R.type,R.pendingProps,mc.current,Ni.current,!1),mr=R,$r=!0,fr=r0(re)),re=R.pendingProps.children,T!==null||Wn?il(T,R,re,z):R.child=yh(R,null,re,z),Hh(T,R),R.child;case 5:return T===null&&Wn&&(l0(R.type,R.pendingProps,Ni.current),(he=re=fr)&&(re=fg(re,R.type,R.pendingProps,$r),re!==null?(R.stateNode=re,mr=R,fr=r0(re),$r=!1,he=!0):he=!1),he||Pe(R)),Me(R),he=R.type,Te=R.pendingProps,et=T!==null?T.memoizedProps:null,re=Te.children,Kr(he,Te)?re=null:et!==null&&Kr(he,et)&&(R.flags|=32),R.memoizedState!==null&&(he=di(T,R,pi,null,null,z),ul?dr._currentValue=he:dr._currentValue2=he),Hh(T,R),il(T,R,re,z),R.child;case 6:return T===null&&Wn&&(K_(R.pendingProps,Ni.current),(T=z=fr)&&(z=hg(z,R.pendingProps,$r),z!==null?(R.stateNode=z,mr=R,fr=null,T=!0):T=!1),T||Pe(R)),null;case 13:return tg(T,R,z);case 4:return ce(R,R.stateNode.containerInfo),re=R.pendingProps,T===null?R.child=yh(R,null,re,z):il(T,R,re,z),R.child;case 11:return Jm(T,R,R.type,R.pendingProps,z);case 7:return il(T,R,R.pendingProps,z),R.child;case 8:return il(T,R,R.pendingProps.children,z),R.child;case 12:return il(T,R,R.pendingProps.children,z),R.child;case 10:return re=R.pendingProps,So(R,R.type,re.value),il(T,R,re.children,z),R.child;case 9:return he=R.type._context,re=R.pendingProps.children,Cc(R),he=Oa(he),re=re(he),R.flags|=1,il(T,R,re,z),R.child;case 14:return q_(T,R,R.type,R.pendingProps,z);case 15:return V_(T,R,R.type,R.pendingProps,z);case 19:return wn(T,R,z);case 22:return cp(T,R,z);case 24:return Cc(R),re=Oa(te),T===null?(he=X0(),he===null&&(he=It,Te=ch(),he.pooledCache=Te,Te.refCount++,Te!==null&&(he.pooledCacheLanes|=z),he=Te),R.memoizedState={parent:re,cache:he},ge(R),So(R,te,he)):((T.lanes&z)!==0&&(se(T,R),st(R,null,null,z),Re()),he=T.memoizedState,Te=R.memoizedState,he.parent!==re?(he={parent:re,cache:re},R.memoizedState=he,R.lanes===0&&(R.memoizedState=R.updateQueue.baseState=he),So(R,te,re)):(re=Te.cache,So(R,te,re),re!==he.cache&&Ac(R,[te],z,!0))),il(T,R,R.pendingProps.children,z),R.child;case 29:throw R.pendingProps}throw Error(i(156,R.tag))}function So(T,R,z){ul?(x(Du,R._currentValue),R._currentValue=z):(x(Du,R._currentValue2),R._currentValue2=z)}function wf(T){var R=Du.current;ul?T._currentValue=R:T._currentValue2=R,v(Du)}function ns(T,R,z){for(;T!==null;){var re=T.alternate;if((T.childLanes&R)!==R?(T.childLanes|=R,re!==null&&(re.childLanes|=R)):re!==null&&(re.childLanes&R)!==R&&(re.childLanes|=R),T===z)break;T=T.return}}function Ac(T,R,z,re){var he=T.child;for(he!==null&&(he.return=T);he!==null;){var Te=he.dependencies;if(Te!==null){var et=he.child;Te=Te.firstContext;e:for(;Te!==null;){var yt=Te;Te=he;for(var zt=0;zt<R.length;zt++)if(yt.context===R[zt]){Te.lanes|=z,yt=Te.alternate,yt!==null&&(yt.lanes|=z),ns(Te.return,z,T),re||(et=null);break e}Te=yt.next}}else if(he.tag===18){if(et=he.return,et===null)throw Error(i(341));et.lanes|=z,Te=et.alternate,Te!==null&&(Te.lanes|=z),ns(et,z,T),et=null}else et=he.child;if(et!==null)et.return=he;else for(et=he;et!==null;){if(et===T){et=null;break}if(he=et.sibling,he!==null){he.return=et.return,et=he;break}et=et.return}he=et}}function lh(T,R,z,re){T=null;for(var he=R,Te=!1;he!==null;){if(!Te){if((he.flags&524288)!==0)Te=!0;else if((he.flags&262144)!==0)break}if(he.tag===10){var et=he.alternate;if(et===null)throw Error(i(387));if(et=et.memoizedProps,et!==null){var yt=he.type;Il(he.pendingProps.value,et.value)||(T!==null?T.push(yt):T=[yt])}}else if(he===Nl.current){if(et=he.alternate,et===null)throw Error(i(387));et.memoizedState.memoizedState!==he.memoizedState.memoizedState&&(T!==null?T.push(dr):T=[dr])}he=he.return}T!==null&&Ac(R,T,z,re),R.flags|=262144}function sr(T){for(T=T.firstContext;T!==null;){var R=T.context;if(!Il(ul?R._currentValue:R._currentValue2,T.memoizedValue))return!0;T=T.next}return!1}function Cc(T){j=T,C=null,T=T.dependencies,T!==null&&(T.firstContext=null)}function Oa(T){return Vr(j,T)}function vr(T,R){return j===null&&Cc(T),Vr(T,R)}function Vr(T,R){var z=ul?R._currentValue:R._currentValue2;if(R={context:R,memoizedValue:z,next:null},C===null){if(T===null)throw Error(i(308));C=R,T.dependencies={lanes:0,firstContext:R},T.flags|=524288}else C=C.next=R;return z}function ch(){return{controller:new P,data:new Map,refCount:0}}function Rf(T){T.refCount--,T.refCount===0&&H(X,function(){T.controller.abort()})}function X0(){var T=Ee.current;return T!==null?T:It.pooledCache}function Gl(T,R){R===null?x(Ee,Ee.current):x(Ee,R.pool)}function ng(){var T=X0();return T===null?null:{parent:ul?te._currentValue:te._currentValue2,pool:T}}function Eo(T){T.flags|=4}function Fo(T,R){if(T!==null&&T.child===R.child)return!1;if((R.flags&16)!==0)return!0;for(T=R.child;T!==null;){if((T.flags&13878)!==0||(T.subtreeFlags&13878)!==0)return!0;T=T.sibling}return!1}function Su(T,R,z,re){if(to)for(z=R.child;z!==null;){if(z.tag===5||z.tag===6)cl(T,z.stateNode);else if(!(z.tag===4||qs&&z.tag===27)&&z.child!==null){z.child.return=z,z=z.child;continue}if(z===R)break;for(;z.sibling===null;){if(z.return===null||z.return===R)return;z=z.return}z.sibling.return=z.return,z=z.sibling}else if(fc)for(var he=R.child;he!==null;){if(he.tag===5){var Te=he.stateNode;z&&re&&(Te=om(Te,he.type,he.memoizedProps)),cl(T,Te)}else if(he.tag===6)Te=he.stateNode,z&&re&&(Te=e0(Te,he.memoizedProps)),cl(T,Te);else if(he.tag!==4){if(he.tag===22&&he.memoizedState!==null)Te=he.child,Te!==null&&(Te.return=he),Su(T,he,!0,!0);else if(he.child!==null){he.child.return=he,he=he.child;continue}}if(he===R)break;for(;he.sibling===null;){if(he.return===null||he.return===R)return;he=he.return}he.sibling.return=he.return,he=he.sibling}}function Yg(T,R,z,re){if(fc)for(var he=R.child;he!==null;){if(he.tag===5){var Te=he.stateNode;z&&re&&(Te=om(Te,he.type,he.memoizedProps)),Ou(T,Te)}else if(he.tag===6)Te=he.stateNode,z&&re&&(Te=e0(Te,he.memoizedProps)),Ou(T,Te);else if(he.tag!==4){if(he.tag===22&&he.memoizedState!==null)Te=he.child,Te!==null&&(Te.return=he),Yg(T,he,!(he.memoizedProps!==null&&he.memoizedProps.mode==="manual"),!0);else if(he.child!==null){he.child.return=he,he=he.child;continue}}if(he===R)break;for(;he.sibling===null;){if(he.return===null||he.return===R)return;he=he.return}he.sibling.return=he.return,he=he.sibling}}function Eu(T,R){if(fc&&Fo(T,R)){T=R.stateNode;var z=T.containerInfo,re=Bd();Yg(re,R,!1,!1),T.pendingChildren=re,Eo(R),pl(z,re)}}function uh(T,R,z,re){if(to)T.memoizedProps!==re&&Eo(R);else if(fc){var he=T.stateNode,Te=T.memoizedProps;if((T=Fo(T,R))||Te!==re){var et=Ni.current;Te=Df(he,z,Te,re,!T,null),Te===he?R.stateNode=he:(rf(Te,z,re,et)&&Eo(R),R.stateNode=Te,T?Su(Te,R,!1,!1):Eo(R))}else R.stateNode=he}}function Zp(T,R,z){if(fl(R,z)){if(T.flags|=16777216,!Kl(R,z))if(Gh())T.flags|=8192;else throw zf=jd,Go}else T.flags&=-16777217}function fh(T,R){if(Cs(R)){if(T.flags|=16777216,!_h(R))if(Gh())T.flags|=8192;else throw zf=jd,Go}else T.flags&=-16777217}function Af(T,R){R!==null&&(T.flags|=4),T.flags&16384&&(R=T.tag!==22?V():536870912,T.lanes|=R,oi|=R)}function Yc(T,R){if(!Wn)switch(T.tailMode){case"hidden":R=T.tail;for(var z=null;R!==null;)R.alternate!==null&&(z=R),R=R.sibling;z===null?T.tail=null:z.sibling=null;break;case"collapsed":z=T.tail;for(var re=null;z!==null;)z.alternate!==null&&(re=z),z=z.sibling;re===null?R||T.tail===null?T.tail=null:T.tail.sibling=null:re.sibling=null}}function Hi(T){var R=T.alternate!==null&&T.alternate.child===T.child,z=0,re=0;if(R)for(var he=T.child;he!==null;)z|=he.lanes|he.childLanes,re|=he.subtreeFlags&31457280,re|=he.flags&31457280,he.return=T,he=he.sibling;else for(he=T.child;he!==null;)z|=he.lanes|he.childLanes,re|=he.subtreeFlags,re|=he.flags,he.return=T,he=he.sibling;return T.subtreeFlags|=re,T.childLanes=z,R}function xu(T,R,z){var re=R.pendingProps;switch(le(R),R.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hi(R),null;case 1:return Hi(R),null;case 3:return z=R.stateNode,re=null,T!==null&&(re=T.memoizedState.cache),R.memoizedState.cache!==re&&(R.flags|=2048),wf(te),de(),z.pendingContext&&(z.context=z.pendingContext,z.pendingContext=null),(T===null||T.child===null)&&($e(R)?Eo(R):T===null||T.memoizedState.isDehydrated&&(R.flags&256)===0||(R.flags|=1024,Wa!==null&&(dh(Wa),Wa=null))),Eu(T,R),Hi(R),null;case 26:if(Jc){z=R.type;var he=R.memoizedState;return T===null?(Eo(R),he!==null?(Hi(R),fh(R,he)):(Hi(R),Zp(R,z,re))):he?he!==T.memoizedState?(Eo(R),Hi(R),fh(R,he)):(Hi(R),R.flags&=-16777217):(to?T.memoizedProps!==re&&Eo(R):uh(T,R,z,re),Hi(R),Zp(R,z,re)),null}case 27:if(qs){if(qe(R),z=mc.current,he=R.type,T!==null&&R.stateNode!=null)to?T.memoizedProps!==re&&Eo(R):uh(T,R,he,re);else{if(!re){if(R.stateNode===null)throw Error(i(166));return Hi(R),null}T=Ni.current,$e(R)?Ce(R,T):(T=dc(he,re,z,T,!0),R.stateNode=T,Eo(R))}return Hi(R),null}case 5:if(qe(R),z=R.type,T!==null&&R.stateNode!=null)uh(T,R,z,re);else{if(!re){if(R.stateNode===null)throw Error(i(166));return Hi(R),null}T=Ni.current,$e(R)?Ce(R,T):(he=Cu(z,re,mc.current,T,R),Su(he,R,!1,!1),R.stateNode=he,rf(he,z,re,T)&&Eo(R))}return Hi(R),Zp(R,R.type,R.pendingProps),null;case 6:if(T&&R.stateNode!=null)z=T.memoizedProps,to?z!==re&&Eo(R):fc&&(z!==re?(R.stateNode=fs(re,mc.current,Ni.current,R),Eo(R)):R.stateNode=T.stateNode);else{if(typeof re!="string"&&R.stateNode===null)throw Error(i(166));if(T=mc.current,z=Ni.current,$e(R)){if(!jo)throw Error(i(176));if(T=R.stateNode,z=R.memoizedProps,re=null,he=mr,he!==null)switch(he.tag){case 27:case 5:re=he.memoizedProps}J0(T,z,R,re)||Pe(R)}else R.stateNode=fs(re,T,z,R)}return Hi(R),null;case 13:if(re=R.memoizedState,T===null||T.memoizedState!==null&&T.memoizedState.dehydrated!==null){if(he=$e(R),re!==null&&re.dehydrated!==null){if(T===null){if(!he)throw Error(i(318));if(!jo)throw Error(i(344));if(he=R.memoizedState,he=he!==null?he.dehydrated:null,!he)throw Error(i(317));Y_(he,R)}else at(),(R.flags&128)===0&&(R.memoizedState=null),R.flags|=4;Hi(R),he=!1}else Wa!==null&&(dh(Wa),Wa=null),he=!0;if(!he)return R.flags&256?(In(R),R):(In(R),null)}if(In(R),(R.flags&128)!==0)return R.lanes=z,R;if(z=re!==null,T=T!==null&&T.memoizedState!==null,z){re=R.child,he=null,re.alternate!==null&&re.alternate.memoizedState!==null&&re.alternate.memoizedState.cachePool!==null&&(he=re.alternate.memoizedState.cachePool.pool);var Te=null;re.memoizedState!==null&&re.memoizedState.cachePool!==null&&(Te=re.memoizedState.cachePool.pool),Te!==he&&(re.flags|=2048)}return z!==T&&z&&(R.child.flags|=8192),Af(R,R.updateQueue),Hi(R),null;case 4:return de(),Eu(T,R),T===null&&Da(R.stateNode.containerInfo),Hi(R),null;case 10:return wf(R.type),Hi(R),null;case 19:if(v(Oo),he=R.memoizedState,he===null)return Hi(R),null;if(re=(R.flags&128)!==0,Te=he.rendering,Te===null)if(re)Yc(he,!1);else{if(Dn!==0||T!==null&&(T.flags&128)!==0)for(T=R.child;T!==null;){if(Te=$n(T),Te!==null){for(R.flags|=128,Yc(he,!1),T=Te.updateQueue,R.updateQueue=T,Af(R,T),R.subtreeFlags=0,T=z,z=R.child;z!==null;)Xh(z,T),z=z.sibling;return x(Oo,Oo.current&1|2),R.child}T=T.sibling}he.tail!==null&&Sr()>Os&&(R.flags|=128,re=!0,Yc(he,!1),R.lanes=4194304)}else{if(!re)if(T=$n(Te),T!==null){if(R.flags|=128,re=!0,T=T.updateQueue,R.updateQueue=T,Af(R,T),Yc(he,!0),he.tail===null&&he.tailMode==="hidden"&&!Te.alternate&&!Wn)return Hi(R),null}else 2*Sr()-he.renderingStartTime>Os&&z!==536870912&&(R.flags|=128,re=!0,Yc(he,!1),R.lanes=4194304);he.isBackwards?(Te.sibling=R.child,R.child=Te):(T=he.last,T!==null?T.sibling=Te:R.child=Te,he.last=Te)}return he.tail!==null?(R=he.tail,he.rendering=R,he.tail=R.sibling,he.renderingStartTime=Sr(),R.sibling=null,T=Oo.current,x(Oo,re?T&1|2:T&1),R):(Hi(R),null);case 22:case 23:return In(R),Mt(),re=R.memoizedState!==null,T!==null?T.memoizedState!==null!==re&&(R.flags|=8192):re&&(R.flags|=8192),re?(z&536870912)!==0&&(R.flags&128)===0&&(Hi(R),R.subtreeFlags&6&&(R.flags|=8192)):Hi(R),z=R.updateQueue,z!==null&&Af(R,z.retryQueue),z=null,T!==null&&T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),re=null,R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(re=R.memoizedState.cachePool.pool),re!==z&&(R.flags|=2048),T!==null&&v(Ee),null;case 24:return z=null,T!==null&&(z=T.memoizedState.cache),R.memoizedState.cache!==z&&(R.flags|=2048),wf(te),Hi(R),null;case 25:return null}throw Error(i(156,R.tag))}function G_(T,R){switch(le(R),R.tag){case 1:return T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 3:return wf(te),de(),T=R.flags,(T&65536)!==0&&(T&128)===0?(R.flags=T&-65537|128,R):null;case 26:case 27:case 5:return qe(R),null;case 13:if(In(R),T=R.memoizedState,T!==null&&T.dehydrated!==null){if(R.alternate===null)throw Error(i(340));at()}return T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 19:return v(Oo),null;case 4:return de(),null;case 10:return wf(R.type),null;case 22:case 23:return In(R),Mt(),T!==null&&v(Ee),T=R.flags,T&65536?(R.flags=T&-65537|128,R):null;case 24:return wf(te),null;case 25:return null;default:return null}}function $_(T,R){switch(le(R),R.tag){case 3:wf(te),de();break;case 26:case 27:case 5:qe(R);break;case 4:de();break;case 13:In(R);break;case 19:v(Oo);break;case 10:wf(R.type);break;case 22:case 23:In(R),Mt(),T!==null&&v(Ee);break;case 24:wf(te)}}function rg(T,R){try{var z=R.updateQueue,re=z!==null?z.lastEffect:null;if(re!==null){var he=re.next;z=he;do{if((z.tag&T)===T){re=void 0;var Te=z.create,et=z.inst;re=Te(),et.destroy=re}z=z.next}while(z!==he)}}catch(yt){Ii(R,R.return,yt)}}function Mc(T,R,z){try{var re=R.updateQueue,he=re!==null?re.lastEffect:null;if(he!==null){var Te=he.next;re=Te;do{if((re.tag&T)===T){var et=re.inst,yt=et.destroy;if(yt!==void 0){et.destroy=void 0,he=R;var zt=z;try{yt()}catch(mn){Ii(he,zt,mn)}}}re=re.next}while(re!==Te)}}catch(mn){Ii(R,R.return,mn)}}function Cd(T){var R=T.updateQueue;if(R!==null){var z=T.stateNode;try{tt(R,z)}catch(re){Ii(T,T.return,re)}}}function uo(T,R,z){z.props=Wu(T.type,T.memoizedProps),z.state=T.memoizedState;try{z.componentWillUnmount()}catch(re){Ii(T,R,re)}}function Cf(T,R){try{var z=T.ref;if(z!==null){var re=T.stateNode;switch(T.tag){case 26:case 27:case 5:var he=Qc(re);break;default:he=re}typeof z=="function"?T.refCleanup=z(he):z.current=he}}catch(Te){Ii(T,R,Te)}}function $l(T,R){var z=T.ref,re=T.refCleanup;if(z!==null)if(typeof re=="function")try{re()}catch(he){Ii(T,R,he)}finally{T.refCleanup=null,T=T.alternate,T!=null&&(T.refCleanup=null)}else if(typeof z=="function")try{z(null)}catch(he){Ii(T,R,he)}else z.current=null}function ig(T){var R=T.type,z=T.memoizedProps,re=T.stateNode;try{nm(re,R,z,T)}catch(he){Ii(T,T.return,he)}}function Xg(T,R,z){try{qa(T.stateNode,T.type,z,R,T)}catch(re){Ii(T,T.return,re)}}function mi(T){return T.tag===5||T.tag===3||(Jc?T.tag===26:!1)||(qs?T.tag===27:!1)||T.tag===4}function Xi(T){e:for(;;){for(;T.sibling===null;){if(T.return===null||mi(T.return))return null;T=T.return}for(T.sibling.return=T.return,T=T.sibling;T.tag!==5&&T.tag!==6&&(!qs||T.tag!==27)&&T.tag!==18;){if(T.flags&2||T.child===null||T.tag===4)continue e;T.child.return=T,T=T.child}if(!(T.flags&2))return T.stateNode}}function sg(T,R,z){var re=T.tag;if(re===5||re===6)T=T.stateNode,R?Jg(z,T,R):Dd(z,T);else if(!(re===4||qs&&re===27)&&(T=T.child,T!==null))for(sg(T,R,z),T=T.sibling;T!==null;)sg(T,R,z),T=T.sibling}function hh(T,R,z){var re=T.tag;if(re===5||re===6)T=T.stateNode,R?rm(z,T,R):qo(z,T);else if(!(re===4||qs&&re===27)&&(T=T.child,T!==null))for(hh(T,R,z),T=T.sibling;T!==null;)hh(T,R,z),T=T.sibling}function fp(T,R,z){T=T.containerInfo;try{Lc(T,z)}catch(re){Ii(R,R.return,re)}}function Fn(T,R){for(tm(T.containerInfo),F=R;F!==null;)if(T=F,R=T.child,(T.subtreeFlags&1028)!==0&&R!==null)R.return=T,F=R;else for(;F!==null;){T=F;var z=T.alternate;switch(R=T.flags,T.tag){case 0:break;case 11:case 15:break;case 1:if((R&1024)!==0&&z!==null){R=void 0;var re=T,he=z.memoizedProps;z=z.memoizedState;var Te=re.stateNode;try{var et=Wu(re.type,he,re.elementType===re.type);R=Te.getSnapshotBeforeUpdate(et,z),Te.__reactInternalSnapshotBeforeUpdate=R}catch(yt){Ii(re,re.return,yt)}}break;case 3:(R&1024)!==0&&to&&am(T.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((R&1024)!==0)throw Error(i(163))}if(R=T.sibling,R!==null){R.return=T.return,F=R;break}F=T.return}return et=ie,ie=!1,et}function zs(T,R,z){var re=z.flags;switch(z.tag){case 0:case 11:case 15:Rl(T,z),re&4&&rg(5,z);break;case 1:if(Rl(T,z),re&4)if(T=z.stateNode,R===null)try{T.componentDidMount()}catch(yt){Ii(z,z.return,yt)}else{var he=Wu(z.type,R.memoizedProps);R=R.memoizedState;try{T.componentDidUpdate(he,R,T.__reactInternalSnapshotBeforeUpdate)}catch(yt){Ii(z,z.return,yt)}}re&64&&Cd(z),re&512&&Cf(z,z.return);break;case 3:if(Rl(T,z),re&64&&(re=z.updateQueue,re!==null)){if(T=null,z.child!==null)switch(z.child.tag){case 27:case 5:T=Qc(z.child.stateNode);break;case 1:T=z.child.stateNode}try{tt(re,T)}catch(yt){Ii(z,z.return,yt)}}break;case 26:if(Jc){Rl(T,z),re&512&&Cf(z,z.return);break}case 27:case 5:Rl(T,z),R===null&&re&4&&ig(z),re&512&&Cf(z,z.return);break;case 12:Rl(T,z);break;case 13:Rl(T,z),re&4&&Ku(T,z);break;case 22:if(he=z.memoizedState!==null||w,!he){R=R!==null&&R.memoizedState!==null||h;var Te=w,et=h;w=he,(h=R)&&!et?zo(T,z,(z.subtreeFlags&8772)!==0):Rl(T,z),w=Te,h=et}re&512&&(z.memoizedProps.mode==="manual"?Cf(z,z.return):$l(z,z.return));break;default:Rl(T,z)}}function Mf(T){var R=T.alternate;R!==null&&(T.alternate=null,Mf(R)),T.child=null,T.deletions=null,T.sibling=null,T.tag===5&&(R=T.stateNode,R!==null&&_p(R)),T.stateNode=null,T.return=null,T.dependencies=null,T.memoizedProps=null,T.memoizedState=null,T.pendingProps=null,T.stateNode=null,T.updateQueue=null}function xo(T,R,z){for(z=z.child;z!==null;)wl(T,R,z),z=z.sibling}function wl(T,R,z){if(Ga&&typeof Ga.onCommitFiberUnmount=="function")try{Ga.onCommitFiberUnmount(ys,z)}catch{}switch(z.tag){case 26:if(Jc){h||$l(z,R),xo(T,R,z),z.memoizedState?Sp(z.memoizedState):z.stateNode&&gh(z.stateNode);break}case 27:if(qs){h||$l(z,R);var re=pe,he=ye;pe=z.stateNode,xo(T,R,z),Uf(z.stateNode),pe=re,ye=he;break}case 5:h||$l(z,R);case 6:if(to){if(re=pe,he=ye,pe=null,xo(T,R,z),pe=re,ye=he,pe!==null)if(ye)try{sm(pe,z.stateNode)}catch(Te){Ii(z,R,Te)}else try{im(pe,z.stateNode)}catch(Te){Ii(z,R,Te)}}else xo(T,R,z);break;case 18:to&&pe!==null&&(ye?dg(pe,z.stateNode):X_(pe,z.stateNode));break;case 4:to?(re=pe,he=ye,pe=z.stateNode.containerInfo,ye=!0,xo(T,R,z),pe=re,ye=he):(fc&&fp(z.stateNode,z,Bd()),xo(T,R,z));break;case 0:case 11:case 14:case 15:h||Mc(2,z,R),h||Mc(4,z,R),xo(T,R,z);break;case 1:h||($l(z,R),re=z.stateNode,typeof re.componentWillUnmount=="function"&&uo(z,R,re)),xo(T,R,z);break;case 21:xo(T,R,z);break;case 22:h||$l(z,R),h=(re=h)||z.memoizedState!==null,xo(T,R,z),h=re;break;default:xo(T,R,z)}}function Ku(T,R){if(jo&&R.memoizedState===null&&(T=R.alternate,T!==null&&(T=T.memoizedState,T!==null&&(T=T.dehydrated,T!==null))))try{e_(T)}catch(z){Ii(R,R.return,z)}}function kf(T){switch(T.tag){case 13:case 19:var R=T.stateNode;return R===null&&(R=T.stateNode=new k),R;case 22:return T=T.stateNode,R=T._retryCache,R===null&&(R=T._retryCache=new k),R;default:throw Error(i(435,T.tag))}}function kc(T,R){var z=kf(T);R.forEach(function(re){var he=ph.bind(null,T,re);z.has(re)||(z.add(re),re.then(he,he))})}function Rs(T,R){var z=R.deletions;if(z!==null)for(var re=0;re<z.length;re++){var he=z[re],Te=T,et=R;if(to){var yt=et;e:for(;yt!==null;){switch(yt.tag){case 27:case 5:pe=yt.stateNode,ye=!1;break e;case 3:pe=yt.stateNode.containerInfo,ye=!0;break e;case 4:pe=yt.stateNode.containerInfo,ye=!0;break e}yt=yt.return}if(pe===null)throw Error(i(160));wl(Te,et,he),pe=null,ye=!1}else wl(Te,et,he);Te=he.alternate,Te!==null&&(Te.return=null),he.return=null}if(R.subtreeFlags&13878)for(R=R.child;R!==null;)Kg(R,T),R=R.sibling}function Kg(T,R){var z=T.alternate,re=T.flags;switch(T.tag){case 0:case 11:case 14:case 15:Rs(R,T),Xs(T),re&4&&(Mc(3,T,T.return),rg(3,T),Mc(5,T,T.return));break;case 1:Rs(R,T),Xs(T),re&512&&(h||z===null||$l(z,z.return)),re&64&&w&&(T=T.updateQueue,T!==null&&(re=T.callbacks,re!==null&&(z=T.shared.hiddenCallbacks,T.shared.hiddenCallbacks=z===null?re:z.concat(re))));break;case 26:if(Jc){var he=Ae;Rs(R,T),Xs(T),re&512&&(h||z===null||$l(z,z.return)),re&4&&(re=z!==null?z.memoizedState:null,R=T.memoizedState,z===null?R===null?T.stateNode===null?T.stateNode=fm(he,T.type,T.memoizedProps,T):Fd(he,T.type,T.stateNode):T.stateNode=Z_(he,R,T.memoizedProps):re!==R?(re===null?z.stateNode!==null&&gh(z.stateNode):Sp(re),R===null?Fd(he,T.type,T.stateNode):Z_(he,R,T.memoizedProps)):R===null&&T.stateNode!==null&&Xg(T,T.memoizedProps,z.memoizedProps));break}case 27:if(qs&&re&4&&T.alternate===null){he=T.stateNode;var Te=T.memoizedProps;try{Lf(he),mg(T.type,Te,he,T)}catch(Ln){Ii(T,T.return,Ln)}}case 5:if(Rs(R,T),Xs(T),re&512&&(h||z===null||$l(z,z.return)),to){if(T.flags&32){R=T.stateNode;try{Ld(R)}catch(Ln){Ii(T,T.return,Ln)}}re&4&&T.stateNode!=null&&(R=T.memoizedProps,Xg(T,R,z!==null?z.memoizedProps:R)),re&1024&&(b=!0)}break;case 6:if(Rs(R,T),Xs(T),re&4&&to){if(T.stateNode===null)throw Error(i(162));re=T.memoizedProps,z=z!==null?z.memoizedProps:re,R=T.stateNode;try{lg(R,z,re)}catch(Ln){Ii(T,T.return,Ln)}}break;case 3:if(Jc?(Nu(),he=Ae,Ae=bp(R.containerInfo),Rs(R,T),Ae=he):Rs(R,T),Xs(T),re&4){if(to&&jo&&z!==null&&z.memoizedState.isDehydrated)try{o0(R.containerInfo)}catch(Ln){Ii(T,T.return,Ln)}if(fc){re=R.containerInfo,z=R.pendingChildren;try{Lc(re,z)}catch(Ln){Ii(T,T.return,Ln)}}}b&&(b=!1,K0(T));break;case 4:Jc?(z=Ae,Ae=bp(T.stateNode.containerInfo),Rs(R,T),Xs(T),Ae=z):(Rs(R,T),Xs(T)),re&4&&fc&&fp(T.stateNode,T,T.stateNode.pendingChildren);break;case 12:Rs(R,T),Xs(T);break;case 13:Rs(R,T),Xs(T),T.child.flags&8192&&T.memoizedState!==null!=(z!==null&&z.memoizedState!==null)&&(li=Sr()),re&4&&(re=T.updateQueue,re!==null&&(T.updateQueue=null,kc(T,re)));break;case 22:re&512&&(h||z===null||$l(z,z.return)),he=T.memoizedState!==null;var et=z!==null&&z.memoizedState!==null,yt=w,zt=h;if(w=yt||he,h=zt||et,Rs(R,T),h=zt,w=yt,Xs(T),R=T.stateNode,R._current=T,R._visibility&=-3,R._visibility|=R._pendingVisibility&2,re&8192&&(R._visibility=he?R._visibility&-2:R._visibility|1,he&&(R=w||h,z===null||et||R||hp(T)),to&&(T.memoizedProps===null||T.memoizedProps.mode!=="manual"))){e:if(z=null,to)for(R=T;;){if(R.tag===5||Jc&&R.tag===26||qs&&R.tag===27){if(z===null){et=z=R;try{Te=et.stateNode,he?Ud(Te):cg(et.stateNode,et.memoizedProps)}catch(Ln){Ii(et,et.return,Ln)}}}else if(R.tag===6){if(z===null){et=R;try{var mn=et.stateNode;he?ku(mn):Z0(mn,et.memoizedProps)}catch(Ln){Ii(et,et.return,Ln)}}}else if((R.tag!==22&&R.tag!==23||R.memoizedState===null||R===T)&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===T)break e;for(;R.sibling===null;){if(R.return===null||R.return===T)break e;z===R&&(z=null),R=R.return}z===R&&(z=null),R.sibling.return=R.return,R=R.sibling}}re&4&&(re=T.updateQueue,re!==null&&(z=re.retryQueue,z!==null&&(re.retryQueue=null,kc(T,z))));break;case 19:Rs(R,T),Xs(T),re&4&&(re=T.updateQueue,re!==null&&(T.updateQueue=null,kc(T,re)));break;case 21:break;default:Rs(R,T),Xs(T)}}function Xs(T){var R=T.flags;if(R&2){try{if(to&&(!qs||T.tag!==27)){e:{for(var z=T.return;z!==null;){if(mi(z)){var re=z;break e}z=z.return}throw Error(i(160))}switch(re.tag){case 27:if(qs){var he=re.stateNode,Te=Xi(T);hh(T,Te,he);break}case 5:var et=re.stateNode;re.flags&32&&(Ld(et),re.flags&=-33);var yt=Xi(T);hh(T,yt,et);break;case 3:case 4:var zt=re.stateNode.containerInfo,mn=Xi(T);sg(T,mn,zt);break;default:throw Error(i(161))}}}catch(Ln){Ii(T,T.return,Ln)}T.flags&=-3}R&4096&&(T.flags&=-4097)}function K0(T){if(T.subtreeFlags&1024)for(T=T.child;T!==null;){var R=T;K0(R),R.tag===5&&R.flags&1024&&br(R.stateNode),T=T.sibling}}function Rl(T,R){if(R.subtreeFlags&8772)for(R=R.child;R!==null;)zs(T,R.alternate,R),R=R.sibling}function hp(T){for(T=T.child;T!==null;){var R=T;switch(R.tag){case 0:case 11:case 14:case 15:Mc(4,R,R.return),hp(R);break;case 1:$l(R,R.return);var z=R.stateNode;typeof z.componentWillUnmount=="function"&&uo(R,R.return,z),hp(R);break;case 26:case 27:case 5:$l(R,R.return),hp(R);break;case 22:$l(R,R.return),R.memoizedState===null&&hp(R);break;default:hp(R)}T=T.sibling}}function zo(T,R,z){for(z=z&&(R.subtreeFlags&8772)!==0,R=R.child;R!==null;){var re=R.alternate,he=T,Te=R,et=Te.flags;switch(Te.tag){case 0:case 11:case 15:zo(he,Te,z),rg(4,Te);break;case 1:if(zo(he,Te,z),re=Te,he=re.stateNode,typeof he.componentDidMount=="function")try{he.componentDidMount()}catch(mn){Ii(re,re.return,mn)}if(re=Te,he=re.updateQueue,he!==null){var yt=re.stateNode;try{var zt=he.shared.hiddenCallbacks;if(zt!==null)for(he.shared.hiddenCallbacks=null,he=0;he<zt.length;he++)Ve(zt[he],yt)}catch(mn){Ii(re,re.return,mn)}}z&&et&64&&Cd(Te),Cf(Te,Te.return);break;case 26:case 27:case 5:zo(he,Te,z),z&&re===null&&et&4&&ig(Te),Cf(Te,Te.return);break;case 12:zo(he,Te,z);break;case 13:zo(he,Te,z),z&&et&4&&Ku(he,Te);break;case 22:Te.memoizedState===null&&zo(he,Te,z),Cf(Te,Te.return);break;default:zo(he,Te,z)}R=R.sibling}}function lc(T,R){var z=null;T!==null&&T.memoizedState!==null&&T.memoizedState.cachePool!==null&&(z=T.memoizedState.cachePool.pool),T=null,R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(T=R.memoizedState.cachePool.pool),T!==z&&(T!=null&&T.refCount++,z!=null&&Rf(z))}function Br(T,R){T=null,R.alternate!==null&&(T=R.alternate.memoizedState.cache),R=R.memoizedState.cache,R!==T&&(R.refCount++,T!=null&&Rf(T))}function ve(T,R,z,re){if(R.subtreeFlags&10256)for(R=R.child;R!==null;)cc(T,R,z,re),R=R.sibling}function cc(T,R,z,re){var he=R.flags;switch(R.tag){case 0:case 11:case 15:ve(T,R,z,re),he&2048&&rg(9,R);break;case 3:ve(T,R,z,re),he&2048&&(T=null,R.alternate!==null&&(T=R.alternate.memoizedState.cache),R=R.memoizedState.cache,R!==T&&(R.refCount++,T!=null&&Rf(T)));break;case 12:if(he&2048){ve(T,R,z,re),T=R.stateNode;try{var Te=R.memoizedProps,et=Te.id,yt=Te.onPostCommit;typeof yt=="function"&&yt(et,R.alternate===null?"mount":"update",T.passiveEffectDuration,-0)}catch(zt){Ii(R,R.return,zt)}}else ve(T,R,z,re);break;case 23:break;case 22:Te=R.stateNode,R.memoizedState!==null?Te._visibility&4?ve(T,R,z,re):Ai(T,R):Te._visibility&4?ve(T,R,z,re):(Te._visibility|=4,Ja(T,R,z,re,(R.subtreeFlags&10256)!==0)),he&2048&&lc(R.alternate,R);break;case 24:ve(T,R,z,re),he&2048&&Br(R.alternate,R);break;default:ve(T,R,z,re)}}function Ja(T,R,z,re,he){for(he=he&&(R.subtreeFlags&10256)!==0,R=R.child;R!==null;){var Te=T,et=R,yt=z,zt=re,mn=et.flags;switch(et.tag){case 0:case 11:case 15:Ja(Te,et,yt,zt,he),rg(8,et);break;case 23:break;case 22:var Ln=et.stateNode;et.memoizedState!==null?Ln._visibility&4?Ja(Te,et,yt,zt,he):Ai(Te,et):(Ln._visibility|=4,Ja(Te,et,yt,zt,he)),he&&mn&2048&&lc(et.alternate,et);break;case 24:Ja(Te,et,yt,zt,he),he&&mn&2048&&Br(et.alternate,et);break;default:Ja(Te,et,yt,zt,he)}R=R.sibling}}function Ai(T,R){if(R.subtreeFlags&10256)for(R=R.child;R!==null;){var z=T,re=R,he=re.flags;switch(re.tag){case 22:Ai(z,re),he&2048&&lc(re.alternate,re);break;case 24:Ai(z,re),he&2048&&Br(re.alternate,re);break;default:Ai(z,re)}R=R.sibling}}function On(T){if(T.subtreeFlags&De)for(T=T.child;T!==null;)fo(T),T=T.sibling}function fo(T){switch(T.tag){case 26:On(T),T.flags&De&&(T.memoizedState!==null?n_(Ae,T.memoizedState,T.memoizedProps):hl(T.type,T.memoizedProps));break;case 5:On(T),T.flags&De&&hl(T.type,T.memoizedProps);break;case 3:case 4:if(Jc){var R=Ae;Ae=bp(T.stateNode.containerInfo),On(T),Ae=R}else On(T);break;case 22:T.memoizedState===null&&(R=T.alternate,R!==null&&R.memoizedState!==null?(R=De,De=16777216,On(T),De=R):On(T));break;default:On(T)}}function ho(T){var R=T.alternate;if(R!==null&&(T=R.child,T!==null)){R.child=null;do R=T.sibling,T.sibling=null,T=R;while(T!==null)}}function Ki(T){var R=T.deletions;if((T.flags&16)!==0){if(R!==null)for(var z=0;z<R.length;z++){var re=R[z];F=re,ag(re,T)}ho(T)}if(T.subtreeFlags&10256)for(T=T.child;T!==null;)hn(T),T=T.sibling}function hn(T){switch(T.tag){case 0:case 11:case 15:Ki(T),T.flags&2048&&Mc(9,T,T.return);break;case 3:Ki(T);break;case 12:Ki(T);break;case 22:var R=T.stateNode;T.memoizedState!==null&&R._visibility&4&&(T.return===null||T.return.tag!==13)?(R._visibility&=-5,Ei(T)):Ki(T);break;default:Ki(T)}}function Ei(T){var R=T.deletions;if((T.flags&16)!==0){if(R!==null)for(var z=0;z<R.length;z++){var re=R[z];F=re,ag(re,T)}ho(T)}for(T=T.child;T!==null;){switch(R=T,R.tag){case 0:case 11:case 15:Mc(8,R,R.return),Ei(R);break;case 22:z=R.stateNode,z._visibility&4&&(z._visibility&=-5,Ei(R));break;default:Ei(R)}T=T.sibling}}function ag(T,R){for(;F!==null;){var z=F;switch(z.tag){case 0:case 11:case 15:Mc(8,z,R);break;case 23:case 22:if(z.memoizedState!==null&&z.memoizedState.cachePool!==null){var re=z.memoizedState.cachePool.pool;re!=null&&re.refCount++}break;case 24:Rf(z.memoizedState.cache)}if(re=z.child,re!==null)re.return=z,F=re;else e:for(z=T;F!==null;){re=F;var he=re.sibling,Te=re.return;if(Mf(re),re===z){F=null;break e}if(he!==null){he.return=Te,F=he;break e}F=Te}}}function Of(T){var R=Zg(T);if(R!=null){if(typeof R.memoizedProps["data-testname"]!="string")throw Error(i(364));return R}if(T=yp(T),T===null)throw Error(i(362));return T.stateNode.current}function If(T,R){var z=T.tag;switch(R.$$typeof){case Ye:if(T.type===R.value)return!0;break;case dt:e:{for(R=R.value,T=[T,0],z=0;z<T.length;){var re=T[z++],he=re.tag,Te=T[z++],et=R[Te];if(he!==5&&he!==26&&he!==27||!id(re)){for(;et!=null&&If(re,et);)Te++,et=R[Te];if(Te===R.length){R=!0;break e}else for(re=re.child;re!==null;)T.push(re,Te),re=re.sibling}}R=!1}return R;case Et:if((z===5||z===26||z===27)&&Qg(T.stateNode,R.value))return!0;break;case bt:if((z===5||z===6||z===26||z===27)&&(T=dl(T),T!==null&&0<=T.indexOf(R.value)))return!0;break;case Pt:if((z===5||z===26||z===27)&&(T=T.memoizedProps["data-testname"],typeof T=="string"&&T.toLowerCase()===R.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function og(T){switch(T.$$typeof){case Ye:return"<"+(a(T.value)||"Unknown")+">";case dt:return":has("+(og(T)||"")+")";case Et:return'[role="'+T.value+'"]';case bt:return'"'+T.value+'"';case Pt:return'[data-testname="'+T.value+'"]';default:throw Error(i(365))}}function To(T,R){var z=[];T=[T,0];for(var re=0;re<T.length;){var he=T[re++],Te=he.tag,et=T[re++],yt=R[et];if(Te!==5&&Te!==26&&Te!==27||!id(he)){for(;yt!=null&&If(he,yt);)et++,yt=R[et];if(et===R.length)z.push(he);else for(he=he.child;he!==null;)T.push(he,et),he=he.sibling}}return z}function Oc(T,R){if(!Zl)throw Error(i(363));T=Of(T),T=To(T,R),R=[],T=Array.from(T);for(var z=0;z<T.length;){var re=T[z++],he=re.tag;if(he===5||he===26||he===27)id(re)||R.push(re.stateNode);else for(re=re.child;re!==null;)T.push(re),re=re.sibling}return R}function ga(){if((wt&2)!==0&&Zt!==0)return Zt&-Zt;if(jr.T!==null){var T=Zi;return T!==0?T:Vt()}return td()}function dp(){ai===0&&(ai=(Zt&536870912)===0||Wn?D():536870912);var T=su.current;return T!==null&&(T.flags|=32),ai}function wo(T,R,z){(T===It&&Gt===2||T.cancelPendingCommit!==null)&&(us(T,0),Cl(T,Zt,ai,!1)),Q(T,z),((wt&2)===0||T!==It)&&(T===It&&((wt&2)===0&&(Ur|=z),Dn===4&&Cl(T,Zt,ai,!1)),Se(T))}function Ia(T,R,z){if((wt&6)!==0)throw Error(i(327));var re=!z&&(R&60)===0&&(R&T.expiredLanes)===0||N(T,R),he=re?Ks(T,R):$h(T,R,!0),Te=re;do{if(he===0){Rn&&!re&&Cl(T,R,0,!1);break}else if(he===6)Cl(T,R,0,!dn);else{if(z=T.current.alternate,Te&&!js(z)){he=$h(T,R,!1),Te=!1;continue}if(he===2){if(Te=R,T.errorRecoveryDisabledLanes&Te)var et=0;else et=T.pendingLanes&-536870913,et=et!==0?et:et&536870912?536870912:0;if(et!==0){R=et;e:{var yt=T;he=Bi;var zt=jo&&yt.current.memoizedState.isDehydrated;if(zt&&(us(yt,et).flags|=256),et=$h(yt,et,!1),et!==2){if(Nn&&!zt){yt.errorRecoveryDisabledLanes|=Te,Ur|=Te,he=4;break e}Te=Wr,Wr=he,Te!==null&&dh(Te)}he=et}if(Te=!1,he!==2)continue}}if(he===1){us(T,0),Cl(T,R,0,!0);break}e:{switch(re=T,he){case 0:case 1:throw Error(i(345));case 4:if((R&4194176)===R){Cl(re,R,ai,!dn);break e}break;case 2:Wr=null;break;case 3:case 5:break;default:throw Error(i(329))}if(re.finishedWork=z,re.finishedLanes=R,(R&62914560)===R&&(Te=li+300-Sr(),10<Te)){if(Cl(re,R,ai,!dn),O(re,0)!==0)break e;re.timeoutHandle=Ha(Al.bind(null,re,z,Wr,Vi,bs,R,ai,Ur,oi,dn,2,-0,0),Te);break e}Al(re,z,Wr,Vi,bs,R,ai,Ur,oi,dn,0,-0,0)}}break}while(!0);Se(T)}function dh(T){Wr===null?Wr=T:Wr.push.apply(Wr,T)}function Al(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Jn,nr){var Yr=R.subtreeFlags;if((Yr&8192||(Yr&16785408)===16785408)&&(vp(),fo(R),R=ia(),R!==null)){T.cancelPendingCommit=R(Yh.bind(null,T,z,re,he,et,yt,zt,1,Jn,nr)),Cl(T,Te,et,!mn);return}Yh(T,z,re,he,et,yt,zt,Ln,Jn,nr)}function js(T){for(var R=T;;){var z=R.tag;if((z===0||z===11||z===15)&&R.flags&16384&&(z=R.updateQueue,z!==null&&(z=z.stores,z!==null)))for(var re=0;re<z.length;re++){var he=z[re],Te=he.getSnapshot;he=he.value;try{if(!Il(Te(),he))return!1}catch{return!1}}if(z=R.child,R.subtreeFlags&16384&&z!==null)z.return=R,R=z;else{if(R===T)break;for(;R.sibling===null;){if(R.return===null||R.return===T)return!0;R=R.return}R.sibling.return=R.return,R=R.sibling}}return!0}function Cl(T,R,z,re){R&=~Ci,R&=~Ur,T.suspendedLanes|=R,T.pingedLanes&=~R,re&&(T.warmLanes|=R),re=T.expirationTimes;for(var he=R;0<he;){var Te=31-ro(he),et=1<<Te;re[Te]=-1,he&=~et}z!==0&&$(T,z,R)}function Vh(){return(wt&6)===0?(Ie(0),!1):!0}function Ic(){if(Ft!==null){if(Gt===0)var T=Ft.return;else T=Ft,C=j=null,os(T),ru=null,iu=0,T=Ft;for(;T!==null;)$_(T.alternate,T),T=T.return;Ft=null}}function us(T,R){T.finishedWork=null,T.finishedLanes=0;var z=T.timeoutHandle;z!==Mu&&(T.timeoutHandle=Mu,ed(z)),z=T.cancelPendingCommit,z!==null&&(T.cancelPendingCommit=null,z()),Ic(),It=T,Ft=z=Ao(T.current,null),Zt=R,Gt=0,$t=null,dn=!1,Rn=N(T,R),Nn=!1,oi=ai=Ci=Ur=gr=Dn=0,Wr=Bi=null,bs=!1,(R&8)!==0&&(R|=R&32);var re=T.entangledLanes;if(re!==0)for(T=T.entanglements,re&=R;0<re;){var he=31-ro(re),Te=1<<he;R|=T[he],re&=~Te}return qn=R,oe(),z}function uc(T,R){_i=null,jr.H=ks,R===_a?(R=ht(),Gt=3):R===Go?(R=ht(),Gt=4):Gt=R===hm?8:R!==null&&typeof R=="object"&&typeof R.then=="function"?6:1,$t=R,Ft===null&&(Dn=1,Tf(T,ae(R,T.current)))}function Gh(){var T=su.current;return T===null?!0:(Zt&4194176)===Zt?Gs===null:(Zt&62914560)===Zt||(Zt&536870912)!==0?T===Gs:!1}function Wl(){var T=jr.H;return jr.H=ks,T===null?ks:T}function Tu(){var T=jr.A;return jr.A=Fe,T}function si(){Dn=4,dn||(Zt&4194176)!==Zt&&su.current!==null||(Rn=!0),(gr&134217727)===0&&(Ur&134217727)===0||It===null||Cl(It,Zt,ai,!1)}function $h(T,R,z){var re=wt;wt|=2;var he=Wl(),Te=Tu();(It!==T||Zt!==R)&&(Vi=null,us(T,R)),R=!1;var et=Dn;e:do try{if(Gt!==0&&Ft!==null){var yt=Ft,zt=$t;switch(Gt){case 8:Ic(),et=6;break e;case 3:case 2:case 6:su.current===null&&(R=!0);var mn=Gt;if(Gt=0,$t=null,Nc(T,yt,zt,mn),z&&Rn){et=0;break e}break;default:mn=Gt,Gt=0,$t=null,Nc(T,yt,zt,mn)}}Qp(),et=Dn;break}catch(Ln){uc(T,Ln)}while(!0);return R&&T.shellSuspendCounter++,C=j=null,wt=re,jr.H=he,jr.A=Te,Ft===null&&(It=null,Zt=0,oe()),et}function Qp(){for(;Ft!==null;)As(Ft)}function Ks(T,R){var z=wt;wt|=2;var re=Wl(),he=Tu();It!==T||Zt!==R?(Vi=null,Os=Sr()+500,us(T,R)):Rn=N(T,R);e:do try{if(Gt!==0&&Ft!==null){R=Ft;var Te=$t;t:switch(Gt){case 1:Gt=0,$t=null,Nc(T,R,Te,1);break;case 2:if(nt(Te)){Gt=0,$t=null,ei(R);break}R=function(){Gt===2&&It===T&&(Gt=7),Se(T)},Te.then(R,R);break e;case 3:Gt=7;break e;case 4:Gt=5;break e;case 7:nt(Te)?(Gt=0,$t=null,ei(R)):(Gt=0,$t=null,Nc(T,R,Te,7));break;case 5:var et=null;switch(Ft.tag){case 26:et=Ft.memoizedState;case 5:case 27:var yt=Ft,zt=yt.type,mn=yt.pendingProps;if(et?_h(et):Kl(zt,mn)){Gt=0,$t=null;var Ln=yt.sibling;if(Ln!==null)Ft=Ln;else{var Jn=yt.return;Jn!==null?(Ft=Jn,gi(Jn)):Ft=null}break t}}Gt=0,$t=null,Nc(T,R,Te,5);break;case 6:Gt=0,$t=null,Nc(T,R,Te,6);break;case 8:Ic(),Dn=6;break e;default:throw Error(i(462))}}Ro();break}catch(nr){uc(T,nr)}while(!0);return C=j=null,jr.H=re,jr.A=he,wt=z,Ft!==null?0:(It=null,Zt=0,oe(),Dn)}function Ro(){for(;Ft!==null&&!Q_();)As(Ft)}function As(T){var R=_r(T.alternate,T,qn);T.memoizedProps=T.pendingProps,R===null?gi(T):Ft=R}function ei(T){var R=T,z=R.alternate;switch(R.tag){case 15:case 0:R=Xu(z,R,R.pendingProps,R.type,void 0,Zt);break;case 11:R=Xu(z,R,R.pendingProps,R.type.render,R.ref,Zt);break;case 5:os(R);default:$_(z,R),R=Ft=Xh(R,qn),R=_r(z,R,qn)}T.memoizedProps=T.pendingProps,R===null?gi(T):Ft=R}function Nc(T,R,z,re){C=j=null,os(R),ru=null,iu=0;var he=R.return;try{if(Kp(T,he,R,z,Zt)){Dn=1,Tf(T,ae(z,T.current)),Ft=null;return}}catch(Te){if(he!==null)throw Ft=he,Te;Dn=1,Tf(T,ae(z,T.current)),Ft=null;return}R.flags&32768?(Wn||re===1?T=!0:Rn||(Zt&536870912)!==0?T=!1:(dn=T=!0,(re===2||re===3||re===6)&&(re=su.current,re!==null&&re.tag===13&&(re.flags|=16384))),Wh(R,T)):gi(R)}function gi(T){var R=T;do{if((R.flags&32768)!==0){Wh(R,dn);return}T=R.return;var z=xu(R.alternate,R,qn);if(z!==null){Ft=z;return}if(R=R.sibling,R!==null){Ft=R;return}Ft=R=T}while(R!==null);Dn===0&&(Dn=5)}function Wh(T,R){do{var z=G_(T.alternate,T);if(z!==null){z.flags&=32767,Ft=z;return}if(z=T.return,z!==null&&(z.flags|=32768,z.subtreeFlags=0,z.deletions=null),!R&&(T=T.sibling,T!==null)){Ft=T;return}Ft=T=z}while(T!==null);Dn=6,Ft=null}function Yh(T,R,z,re,he,Te,et,yt,zt,mn){var Ln=jr.T,Jn=no();try{Zs(2),jr.T=null,W_(T,R,z,re,Jn,he,Te,et,yt,zt,mn)}finally{jr.T=Ln,Zs(Jn)}}function W_(T,R,z,re,he,Te,et,yt){do al();while(ps!==null);if((wt&6)!==0)throw Error(i(327));var zt=T.finishedWork;if(re=T.finishedLanes,zt===null)return null;if(T.finishedWork=null,T.finishedLanes=0,zt===T.current)throw Error(i(177));T.callbackNode=null,T.callbackPriority=0,T.cancelPendingCommit=null;var mn=zt.lanes|zt.childLanes;if(mn|=ko,B(T,re,mn,Te,et,yt),T===It&&(Ft=It=null,Zt=0),(zt.subtreeFlags&10256)===0&&(zt.flags&10256)===0||Is||(Is=!0,Pl=mn,gc=z,Zc(Li,function(){return al(),null})),z=(zt.flags&15990)!==0,(zt.subtreeFlags&15990)!==0||z?(z=jr.T,jr.T=null,Te=no(),Zs(2),et=wt,wt|=4,Fn(T,zt),Kg(zt,T),Jh(T.containerInfo),T.current=zt,zs(T,zt.alternate,zt),Ff(),wt=et,Zs(Te),jr.T=z):T.current=zt,Is?(Is=!1,ps=T,_o=re):Md(T,mn),mn=T.pendingLanes,mn===0&&(Js=null),W(zt.stateNode),Se(T),R!==null)for(he=T.onRecoverableError,zt=0;zt<R.length;zt++)mn=R[zt],he(mn.value,{componentStack:mn.stack});return(_o&3)!==0&&al(),mn=T.pendingLanes,(re&4194218)!==0&&(mn&42)!==0?T===Lu?ou++:(ou=0,Lu=T):ou=0,Ie(0),null}function Md(T,R){(T.pooledCacheLanes&=R)===0&&(R=T.pooledCache,R!=null&&(T.pooledCache=null,Rf(R)))}function al(){if(ps!==null){var T=ps,R=Pl;Pl=0;var z=J(_o),re=32>z?32:z;z=jr.T;var he=no();try{if(Zs(re),jr.T=null,ps===null)var Te=!1;else{re=gc,gc=null;var et=ps,yt=_o;if(ps=null,_o=0,(wt&6)!==0)throw Error(i(331));var zt=wt;if(wt|=4,hn(et.current),cc(et,et.current,yt,re),wt=zt,Ie(0,!1),Ga&&typeof Ga.onPostCommitFiberRoot=="function")try{Ga.onPostCommitFiberRoot(ys,et)}catch{}Te=!0}return Te}finally{Zs(he),jr.T=z,Md(T,R)}}return!1}function Qn(T,R,z){R=ae(z,R),R=Bo(T.stateNode,R,2),T=Ne(T,R,2),T!==null&&(Q(T,2),Se(T))}function Ii(T,R,z){if(T.tag===3)Qn(T,T,z);else for(;R!==null;){if(R.tag===3){Qn(R,T,z);break}else if(R.tag===1){var re=R.stateNode;if(typeof R.type.getDerivedStateFromError=="function"||typeof re.componentDidCatch=="function"&&(Js===null||!Js.has(re))){T=ae(z,T),z=Vl(2),re=Ne(R,z,2),re!==null&&(Ad(z,re,R,T),Q(re,2),Se(re));break}}R=R.return}}function Xc(T,R,z){var re=T.pingCache;if(re===null){re=T.pingCache=new Ot;var he=new Set;re.set(R,he)}else he=re.get(R),he===void 0&&(he=new Set,re.set(R,he));he.has(z)||(Nn=!0,he.add(z),T=po.bind(null,T,R,z),R.then(T,T))}function po(T,R,z){var re=T.pingCache;re!==null&&re.delete(R),T.pingedLanes|=T.suspendedLanes&z,T.warmLanes&=~z,It===T&&(Zt&z)===z&&(Dn===4||Dn===3&&(Zt&62914560)===Zt&&300>Sr()-li?(wt&2)===0&&us(T,0):Ci|=z,oi===Zt&&(oi=0)),Se(T)}function Nf(T,R){R===0&&(R=V()),T=ze(T,R),T!==null&&(Q(T,R),Se(T))}function Kc(T){var R=T.memoizedState,z=0;R!==null&&(z=R.retryLane),Nf(T,z)}function ph(T,R){var z=0;switch(T.tag){case 13:var re=T.stateNode,he=T.memoizedState;he!==null&&(z=he.retryLane);break;case 19:re=T.stateNode;break;case 22:re=T.stateNode._retryCache;break;default:throw Error(i(314))}re!==null&&re.delete(R),Nf(T,z)}function Zc(T,R){return ml(T,R)}function Jp(T,R,z,re){this.tag=T,this.key=z,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=R,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=re,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kd(T){return T=T.prototype,!(!T||!T.isReactComponent)}function Ao(T,R){var z=T.alternate;return z===null?(z=t(T.tag,R,T.key,T.mode),z.elementType=T.elementType,z.type=T.type,z.stateNode=T.stateNode,z.alternate=T,T.alternate=z):(z.pendingProps=R,z.type=T.type,z.flags=0,z.subtreeFlags=0,z.deletions=null),z.flags=T.flags&31457280,z.childLanes=T.childLanes,z.lanes=T.lanes,z.child=T.child,z.memoizedProps=T.memoizedProps,z.memoizedState=T.memoizedState,z.updateQueue=T.updateQueue,R=T.dependencies,z.dependencies=R===null?null:{lanes:R.lanes,firstContext:R.firstContext},z.sibling=T.sibling,z.index=T.index,z.ref=T.ref,z.refCleanup=T.refCleanup,z}function Xh(T,R){T.flags&=31457282;var z=T.alternate;return z===null?(T.childLanes=0,T.lanes=R,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=z.childLanes,T.lanes=z.lanes,T.child=z.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=z.memoizedProps,T.memoizedState=z.memoizedState,T.updateQueue=z.updateQueue,T.type=z.type,R=z.dependencies,T.dependencies=R===null?null:{lanes:R.lanes,firstContext:R.firstContext}),T}function Zu(T,R,z,re,he,Te){var et=0;if(re=T,typeof T=="function")kd(T)&&(et=1);else if(typeof T=="string")et=Jc&&qs?sd(T,z,Ni.current)?26:af(T)?27:5:Jc?sd(T,z,Ni.current)?26:5:qs&&af(T)?27:5;else e:switch(T){case ja:return Na(z.children,he,Te,R);case ra:et=8,he|=24;break;case Pc:return T=t(12,z,R,he|2),T.elementType=Pc,T.lanes=Te,T;case Dc:return T=t(13,z,R,he),T.elementType=Dc,T.lanes=Te,T;case ef:return T=t(19,z,R,he),T.elementType=ef,T.lanes=Te,T;case tf:return Kh(z,he,Te,R);default:if(typeof T=="object"&&T!==null)switch(T.$$typeof){case Id:case eo:et=10;break e;case wu:et=9;break e;case Ju:et=11;break e;case Ru:et=14;break e;case Co:et=16,re=null;break e}et=29,z=Error(i(130,T===null?"null":typeof T,"")),re=null}return R=t(et,z,R,he),R.elementType=T,R.type=re,R.lanes=Te,R}function Na(T,R,z,re){return T=t(7,T,re,R),T.lanes=z,T}function Kh(T,R,z,re){T=t(22,T,re,R),T.elementType=tf,T.lanes=z;var he={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var Te=he._current;if(Te===null)throw Error(i(456));if((he._pendingVisibility&2)===0){var et=ze(Te,2);et!==null&&(he._pendingVisibility|=2,wo(et,Te,2))}},attach:function(){var Te=he._current;if(Te===null)throw Error(i(456));if((he._pendingVisibility&2)!==0){var et=ze(Te,2);et!==null&&(he._pendingVisibility&=-3,wo(et,Te,2))}}};return T.stateNode=he,T}function pp(T,R,z){return T=t(6,T,null,R),T.lanes=z,T}function Qu(T,R,z){return R=t(4,T.children!==null?T.children:[],T.key,R),R.lanes=z,R.stateNode={containerInfo:T.containerInfo,pendingChildren:null,implementation:T.implementation},R}function mh(T,R,z,re,he,Te,et,yt){this.tag=1,this.containerInfo=T,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Mu,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=G(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=G(0),this.hiddenUpdates=G(null),this.identifierPrefix=re,this.onUncaughtError=he,this.onCaughtError=Te,this.onRecoverableError=et,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=yt,this.incompleteTransitions=new Map}function Lr(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Jn){return T=new mh(T,R,z,et,yt,zt,mn,Jn),R=1,Te===!0&&(R|=24),Te=t(3,null,null,R),T.current=Te,Te.stateNode=T,R=ch(),R.refCount++,T.pooledCache=R,R.refCount++,Te.memoizedState={element:re,isDehydrated:z,cache:R},ge(Te),T}function yr(T){return T?(T=Bf,T):Bf}function ol(T){var R=T._reactInternals;if(R===void 0)throw typeof T.render=="function"?Error(i(188)):(T=Object.keys(T).join(","),Error(i(268,T)));return T=g(R),T=T!==null?p(T):null,T===null?null:Qc(T.stateNode)}function Yl(T,R,z,re,he,Te){he=yr(he),re.context===null?re.context=he:re.pendingContext=he,re=_e(R),re.payload={element:z},Te=Te===void 0?null:Te,Te!==null&&(re.callback=Te),z=Ne(T,re,R),z!==null&&(wo(z,T,R),Le(z,T,R))}function xi(T,R){if(T=T.memoizedState,T!==null&&T.dehydrated!==null){var z=T.retryLane;T.retryLane=z!==0&&z<R?z:R}}function mp(T,R){xi(T,R),(T=T.alternate)&&xi(T,R)}var Fr={},Ml=Mw(),Pa=koe(),Od=Object.assign,gp=Symbol.for("react.element"),ll=Symbol.for("react.transitional.element"),Xl=Symbol.for("react.portal"),ja=Symbol.for("react.fragment"),ra=Symbol.for("react.strict_mode"),Pc=Symbol.for("react.profiler"),Id=Symbol.for("react.provider"),wu=Symbol.for("react.consumer"),eo=Symbol.for("react.context"),Ju=Symbol.for("react.forward_ref"),Dc=Symbol.for("react.suspense"),ef=Symbol.for("react.suspense_list"),Ru=Symbol.for("react.memo"),Co=Symbol.for("react.lazy"),tf=Symbol.for("react.offscreen"),nf=Symbol.for("react.memo_cache_sentinel"),Mo=Symbol.iterator,em=Symbol.for("react.client.reference"),jr=Ml.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Au,Pf,Zh=!1,Qh=Array.isArray,kl=e.rendererVersion,Hs=e.rendererPackageName,Ol=e.extraDevToolsConfig,Qc=e.getPublicInstance,Nd=e.getRootHostContext,Pd=e.getChildHostContext,tm=e.prepareForCommit,Jh=e.resetAfterCommit,Cu=e.createInstance,cl=e.appendInitialChild,rf=e.finalizeInitialChildren,Kr=e.shouldSetTextContent,fs=e.createTextInstance,Ha=e.scheduleTimeout,ed=e.cancelTimeout,Mu=e.noTimeout,ul=e.isPrimaryRenderer;e.warnsIfNotActing;var to=e.supportsMutation,fc=e.supportsPersistence,jo=e.supportsHydration,Zg=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Da=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Zs=e.setCurrentUpdatePriority,no=e.getCurrentUpdatePriority,td=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var nd=e.shouldAttemptEagerTransition,_p=e.detachDeletedInstance;e.requestPostPaintCallback;var fl=e.maySuspendCommit,Kl=e.preloadInstance,vp=e.startSuspendingCommit,hl=e.suspendInstance,ia=e.waitForCommitToBeReady,hc=e.NotPendingTransition,dr=e.HostTransitionContext,br=e.resetFormInstance;e.bindToConsole;var rd=e.supportsMicrotasks,mo=e.scheduleMicrotask,Zl=e.supportsTestSelectors,yp=e.findFiberRoot,Ho=e.getBoundingRect,dl=e.getTextContent,id=e.isHiddenSubtree,Qg=e.matchAccessibilityRole,sf=e.setFocusIfFocusable,La=e.setupIntersectionObserver,qo=e.appendChild,Dd=e.appendChildToContainer,lg=e.commitTextUpdate,nm=e.commitMount,qa=e.commitUpdate,rm=e.insertBefore,Jg=e.insertInContainerBefore,im=e.removeChild,sm=e.removeChildFromContainer,Ld=e.resetTextContent,Ud=e.hideInstance,ku=e.hideTextInstance,cg=e.unhideInstance,Z0=e.unhideTextInstance,am=e.clearContainer,Df=e.cloneInstance,Bd=e.createContainerChildSet,Ou=e.appendChildToContainerChildSet,pl=e.finalizeContainerChildren,Lc=e.replaceContainerChildren,om=e.cloneHiddenInstance,e0=e.cloneHiddenTextInstance,lm=e.isSuspenseInstancePending,ug=e.isSuspenseInstanceFallback,t0=e.getSuspenseInstanceFallbackErrorDetails,n0=e.registerSuspenseInstanceRetry,cm=e.canHydrateFormStateMarker,Q0=e.isFormStateMarkerMatching,um=e.getNextHydratableSibling,r0=e.getFirstHydratableChild,Iu=e.getFirstHydratableChildWithinContainer,Ql=e.getFirstHydratableChildWithinSuspenseInstance,fg=e.canHydrateInstance,hg=e.canHydrateTextInstance,i0=e.canHydrateSuspenseInstance,s0=e.hydrateInstance,J0=e.hydrateTextInstance,Y_=e.hydrateSuspenseInstance,a0=e.getNextHydratableInstanceAfterSuspenseInstance,o0=e.commitHydratedContainer,e_=e.commitHydratedSuspenseInstance,X_=e.clearSuspenseBoundary,dg=e.clearSuspenseBoundaryFromContainer,pg=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var l0=e.validateHydratableInstance,K_=e.validateHydratableTextInstance,Jc=e.supportsResources,sd=e.isHostHoistableType,bp=e.getHoistableRoot,t_=e.getResource,Z_=e.acquireResource,Sp=e.releaseResource,fm=e.hydrateHoistable,Fd=e.mountHoistable,gh=e.unmountHoistable,Jl=e.createHoistableInstance,Nu=e.prepareToCommitHoistables,Cs=e.mayResourceSuspendCommit,_h=e.preloadResource,n_=e.suspendResource,qs=e.supportsSingletons,dc=e.resolveSingletonInstance,Lf=e.clearSingleton,mg=e.acquireSingletonInstance,Uf=e.releaseSingletonInstance,af=e.isHostSingletonType,go=[],ad=-1,Bf={},ro=Math.clz32?Math.clz32:E,Vo=Math.log,gg=Math.LN2,eu=128,zd=4194304,ml=Pa.unstable_scheduleCallback,sa=Pa.unstable_cancelCallback,Q_=Pa.unstable_shouldYield,Ff=Pa.unstable_requestPaint,Sr=Pa.unstable_now,wr=Pa.unstable_ImmediatePriority,pc=Pa.unstable_UserBlockingPriority,Li=Pa.unstable_NormalPriority,aa=Pa.unstable_IdlePriority,wa=Pa.log,Va=Pa.unstable_setDisableYieldValue,ys=null,Ga=null,Il=typeof Object.is=="function"?Object.is:Y,oa=new WeakMap,Hr=[],hs=0,Ra=null,tu=0,qi=[],$a=0,of=null,Vs=1,Ms="",Ni=y(null),io=y(null),mc=y(null),Nl=y(null),mr=null,fr=null,Wn=!1,Wa=null,$r=!1,rs=Error(i(519)),Pu=[],nu=0,ko=0,od=null,ld=null,Ep=!1,la=!1,xp=!1,gl=0,_l=null,Uc=0,Zi=0,Zr=null,so=!1,vh=!1,vl=Object.prototype.hasOwnProperty,_a=Error(i(460)),Go=Error(i(474)),jd={then:function(){}},zf=null,ru=null,iu=0,yh=_n(!0),lf=_n(!1),ca=y(null),Hd=y(0),su=y(null),Gs=null,Oo=y(0),cd=0,_i=null,ar=null,Ui=null,$o=!1,ud=!1,bh=!1,_g=0,Io=0,ds=null,Qs=0,ec=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},ks={readContext:Oa,use:Kt,useCallback:er,useContext:er,useEffect:er,useImperativeHandle:er,useLayoutEffect:er,useInsertionEffect:er,useMemo:er,useReducer:er,useRef:er,useState:er,useDebugValue:er,useDeferredValue:er,useTransition:er,useSyncExternalStore:er,useId:er};ks.useCacheRefresh=er,ks.useMemoCache=er,ks.useHostTransitionStatus=er,ks.useFormState=er,ks.useActionState=er,ks.useOptimistic=er;var cf={readContext:Oa,use:Kt,useCallback:function(T,R){return We().memoizedState=[T,R===void 0?null:R],T},useContext:Oa,useEffect:lp,useImperativeHandle:function(T,R,z){z=z!=null?z.concat([T]):null,pa(4194308,4,Tl.bind(null,R,T),z)},useLayoutEffect:function(T,R){return pa(4194308,4,T,R)},useInsertionEffect:function(T,R){pa(4,2,T,R)},useMemo:function(T,R){var z=We();R=R===void 0?null:R;var re=T();if(bh){q(!0);try{T()}finally{q(!1)}}return z.memoizedState=[re,R],re},useReducer:function(T,R,z){var re=We();if(z!==void 0){var he=z(R);if(bh){q(!0);try{z(R)}finally{q(!1)}}}else he=R;return re.memoizedState=re.baseState=he,T={pending:null,lanes:0,dispatch:null,lastRenderedReducer:T,lastRenderedState:he},re.queue=T,T=T.dispatch=oc.bind(null,_i,T),[re.memoizedState,T]},useRef:function(T){var R=We();return T={current:T},R.memoizedState=T},useState:function(T){T=Cr(T);var R=T.queue,z=co.bind(null,_i,R);return R.dispatch=z,[T.memoizedState,z]},useDebugValue:Uo,useDeferredValue:function(T,R){var z=We();return wc(z,T,R)},useTransition:function(){var T=Cr(!1);return T=$u.bind(null,_i,T.queue,!0,!1),We().memoizedState=T,[!1,T]},useSyncExternalStore:function(T,R,z){var re=_i,he=We();if(Wn){if(z===void 0)throw Error(i(407));z=z()}else{if(z=R(),It===null)throw Error(i(349));(Zt&60)!==0||Er(re,R,z)}he.memoizedState=z;var Te={value:z,getSnapshot:R};return he.queue=Te,lp(Dr.bind(null,re,Te,T),[T]),re.flags|=2048,bo(9,rr.bind(null,re,Te,z,R),{destroy:void 0},null),z},useId:function(){var T=We(),R=It.identifierPrefix;if(Wn){var z=Ms,re=Vs;z=(re&~(1<<32-ro(re)-1)).toString(32)+z,R=":"+R+"R"+z,z=_g++,0<z&&(R+="H"+z.toString(32)),R+=":"}else z=Qs++,R=":"+R+"r"+z.toString(32)+":";return T.memoizedState=R},useCacheRefresh:function(){return We().memoizedState=Zm.bind(null,_i)}};cf.useMemoCache=Lt,cf.useHostTransitionStatus=Yi,cf.useFormState=cs,cf.useActionState=cs,cf.useOptimistic=function(T){var R=We();R.memoizedState=R.baseState=T;var z={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return R.queue=z,R=Wc.bind(null,_i,!0,z),z.dispatch=R,[T,R]};var ui={readContext:Oa,use:Kt,useCallback:rl,useContext:Oa,useEffect:Wp,useImperativeHandle:ac,useInsertionEffect:Yp,useLayoutEffect:rh,useMemo:Xp,useReducer:zn,useRef:da,useState:function(){return zn(yn)},useDebugValue:Uo,useDeferredValue:function(T,R){var z=At();return Gc(z,ar.memoizedState,T,R)},useTransition:function(){var T=zn(yn)[0],R=At().memoizedState;return[typeof T=="boolean"?T:Wt(T),R]},useSyncExternalStore:Ir,useId:Rc};ui.useCacheRefresh=Ef,ui.useMemoCache=Lt,ui.useHostTransitionStatus=Yi,ui.useFormState=Xn,ui.useActionState=Xn,ui.useOptimistic=function(T,R){var z=At();return ii(z,ar,T,R)};var au={readContext:Oa,use:Kt,useCallback:rl,useContext:Oa,useEffect:Wp,useImperativeHandle:ac,useInsertionEffect:Yp,useLayoutEffect:rh,useMemo:Xp,useReducer:tr,useRef:da,useState:function(){return tr(yn)},useDebugValue:Uo,useDeferredValue:function(T,R){var z=At();return ar===null?wc(z,T,R):Gc(z,ar.memoizedState,T,R)},useTransition:function(){var T=tr(yn)[0],R=At().memoizedState;return[typeof T=="boolean"?T:Wt(T),R]},useSyncExternalStore:Ir,useId:Rc};au.useCacheRefresh=Ef,au.useMemoCache=Lt,au.useHostTransitionStatus=Yi,au.useFormState=Fs,au.useActionState=Fs,au.useOptimistic=function(T,R){var z=At();return ar!==null?ii(z,ar,T,R):(z.baseState=T,[T,z.queue.dispatch])};var Sh={isMounted:function(T){return(T=T._reactInternals)?f(T)===T:!1},enqueueSetState:function(T,R,z){T=T._reactInternals;var re=ga(),he=_e(re);he.payload=R,z!=null&&(he.callback=z),R=Ne(T,he,re),R!==null&&(wo(R,T,re),Le(R,T,re))},enqueueReplaceState:function(T,R,z){T=T._reactInternals;var re=ga(),he=_e(re);he.tag=1,he.payload=R,z!=null&&(he.callback=z),R=Ne(T,he,re),R!==null&&(wo(R,T,re),Le(R,T,re))},enqueueForceUpdate:function(T,R){T=T._reactInternals;var z=ga(),re=_e(z);re.tag=2,R!=null&&(re.callback=R),R=Ne(T,re,z),R!==null&&(wo(R,T,z),Le(R,T,z))}},fd=typeof reportError=="function"?reportError:function(T){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var R=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof T=="object"&&T!==null&&typeof T.message=="string"?String(T.message):String(T),error:T});if(!window.dispatchEvent(R))return}else if(typeof xl=="object"&&typeof xl.emit=="function"){xl.emit("uncaughtException",T);return}console.error(T)},hm=Error(i(461)),va=!1,jf={dehydrated:null,treeContext:null,retryLane:0},Du=y(null),j=null,C=null,P=typeof AbortController<"u"?AbortController:function(){var T=[],R=this.signal={aborted:!1,addEventListener:function(z,re){T.push(re)}};this.abort=function(){R.aborted=!0,T.forEach(function(z){return z()})}},H=Pa.unstable_scheduleCallback,X=Pa.unstable_NormalPriority,te={$$typeof:eo,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},ue=jr.S;jr.S=function(T,R){typeof R=="object"&&R!==null&&typeof R.then=="function"&&kt(T,R),ue!==null&&ue(T,R)};var Ee=y(null),w=!1,h=!1,b=!1,k=typeof WeakSet=="function"?WeakSet:Set,F=null,ie=!1,pe=null,ye=!1,Ae=null,De=8192,Fe={getCacheForType:function(T){var R=Oa(te),z=R.data.get(T);return z===void 0&&(z=T(),R.data.set(T,z)),z}},Ye=0,dt=1,Et=2,Pt=3,bt=4;if(typeof Symbol=="function"&&Symbol.for){var gt=Symbol.for;Ye=gt("selector.component"),dt=gt("selector.has_pseudo_class"),Et=gt("selector.role"),Pt=gt("selector.test_id"),bt=gt("selector.text")}var Ot=typeof WeakMap=="function"?WeakMap:Map,wt=0,It=null,Ft=null,Zt=0,Gt=0,$t=null,dn=!1,Rn=!1,Nn=!1,qn=0,Dn=0,gr=0,Ur=0,Ci=0,ai=0,oi=0,Bi=null,Wr=null,bs=!1,li=0,Os=1/0,Vi=null,Js=null,Is=!1,ps=null,_o=0,Pl=0,gc=null,ou=0,Lu=null;return Fr.attemptContinuousHydration=function(T){if(T.tag===13){var R=ze(T,67108864);R!==null&&wo(R,T,67108864),mp(T,67108864)}},Fr.attemptHydrationAtCurrentPriority=function(T){if(T.tag===13){var R=ga(),z=ze(T,R);z!==null&&wo(z,T,R),mp(T,R)}},Fr.attemptSynchronousHydration=function(T){switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var R=M(T.pendingLanes);if(R!==0){for(T.pendingLanes|=2,T.entangledLanes|=2;R;){var z=1<<31-ro(R);T.entanglements[1]|=z,R&=~z}Se(T),(wt&6)===0&&(Os=Sr()+500,Ie(0))}}break;case 13:R=ze(T,2),R!==null&&wo(R,T,2),Vh(),mp(T,2)}},Fr.batchedUpdates=function(T,R){return T(R)},Fr.createComponentSelector=function(T){return{$$typeof:Ye,value:T}},Fr.createContainer=function(T,R,z,re,he,Te,et,yt,zt,mn){return Lr(T,R,!1,null,z,re,Te,et,yt,zt,mn,null)},Fr.createHasPseudoClassSelector=function(T){return{$$typeof:dt,value:T}},Fr.createHydrationContainer=function(T,R,z,re,he,Te,et,yt,zt,mn,Ln,Jn,nr){return T=Lr(z,re,!0,T,he,Te,yt,zt,mn,Ln,Jn,nr),T.context=yr(null),z=T.current,re=ga(),he=_e(re),he.callback=R??null,Ne(z,he,re),T.current.lanes=re,Q(T,re),Se(T),T},Fr.createPortal=function(T,R,z){var re=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Xl,key:re==null?null:""+re,children:T,containerInfo:R,implementation:z}},Fr.createRoleSelector=function(T){return{$$typeof:Et,value:T}},Fr.createTestNameSelector=function(T){return{$$typeof:Pt,value:T}},Fr.createTextSelector=function(T){return{$$typeof:bt,value:T}},Fr.defaultOnCaughtError=function(T){console.error(T)},Fr.defaultOnRecoverableError=function(T){fd(T)},Fr.defaultOnUncaughtError=function(T){fd(T)},Fr.deferredUpdates=function(T){var R=jr.T,z=no();try{return Zs(32),jr.T=null,T()}finally{Zs(z),jr.T=R}},Fr.discreteUpdates=function(T,R,z,re,he){var Te=jr.T,et=no();try{return Zs(2),jr.T=null,T(R,z,re,he)}finally{Zs(et),jr.T=Te,wt===0&&(Os=Sr()+500)}},Fr.findAllNodes=Oc,Fr.findBoundingRects=function(T,R){if(!Zl)throw Error(i(363));R=Oc(T,R),T=[];for(var z=0;z<R.length;z++)T.push(Ho(R[z]));for(R=T.length-1;0<R;R--){z=T[R];for(var re=z.x,he=re+z.width,Te=z.y,et=Te+z.height,yt=R-1;0<=yt;yt--)if(R!==yt){var zt=T[yt],mn=zt.x,Ln=mn+zt.width,Jn=zt.y,nr=Jn+zt.height;if(re>=mn&&Te>=Jn&&he<=Ln&&et<=nr){T.splice(R,1);break}else if(re!==mn||z.width!==zt.width||nr<Te||Jn>et){if(!(Te!==Jn||z.height!==zt.height||Ln<re||mn>he)){mn>re&&(zt.width+=mn-re,zt.x=re),Ln<he&&(zt.width=he-mn),T.splice(R,1);break}}else{Jn>Te&&(zt.height+=Jn-Te,zt.y=Te),nr<et&&(zt.height=et-Jn),T.splice(R,1);break}}}return T},Fr.findHostInstance=ol,Fr.findHostInstanceWithNoPortals=function(T){return T=g(T),T=T!==null?_(T):null,T===null?null:Qc(T.stateNode)},Fr.findHostInstanceWithWarning=function(T){return ol(T)},Fr.flushPassiveEffects=al,Fr.flushSyncFromReconciler=function(T){var R=wt;wt|=1;var z=jr.T,re=no();try{if(Zs(2),jr.T=null,T)return T()}finally{Zs(re),jr.T=z,wt=R,(wt&6)===0&&Ie(0)}},Fr.flushSyncWork=Vh,Fr.focusWithin=function(T,R){if(!Zl)throw Error(i(363));for(T=Of(T),R=To(T,R),R=Array.from(R),T=0;T<R.length;){var z=R[T++],re=z.tag;if(!id(z)){if((re===5||re===26||re===27)&&sf(z.stateNode))return!0;for(z=z.child;z!==null;)R.push(z),z=z.sibling}}return!1},Fr.getFindAllNodesFailureDescription=function(T,R){if(!Zl)throw Error(i(363));var z=0,re=[];T=[Of(T),0];for(var he=0;he<T.length;){var Te=T[he++],et=Te.tag,yt=T[he++],zt=R[yt];if((et!==5&&et!==26&&et!==27||!id(Te))&&(If(Te,zt)&&(re.push(og(zt)),yt++,yt>z&&(z=yt)),yt<R.length))for(Te=Te.child;Te!==null;)T.push(Te,yt),Te=Te.sibling}if(z<R.length){for(T=[];z<R.length;z++)T.push(og(R[z]));return`findAllNodes was able to match part of the selector:
  `+(re.join(" > ")+`

No matching component was found for:
  `)+T.join(" > ")}return null},Fr.getPublicRootInstance=function(T){if(T=T.current,!T.child)return null;switch(T.child.tag){case 27:case 5:return Qc(T.child.stateNode);default:return T.child.stateNode}},Fr.injectIntoDevTools=function(){var T={bundleType:0,version:kl,rendererPackageName:Hs,currentDispatcherRef:jr,findFiberByHostInstance:Zg,reconcilerVersion:"19.0.0"};if(Ol!==null&&(T.rendererConfig=Ol),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")T=!1;else{var R=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(R.isDisabled||!R.supportsFiber)T=!0;else{try{ys=R.inject(T),Ga=R}catch{}T=!!R.checkDCE}}return T},Fr.isAlreadyRendering=function(){return!1},Fr.observeVisibleRects=function(T,R,z,re){if(!Zl)throw Error(i(363));T=Oc(T,R);var he=La(T,z,re).disconnect;return{disconnect:function(){he()}}},Fr.shouldError=function(){return null},Fr.shouldSuspend=function(){return!1},Fr.startHostTransition=function(T,R,z,re){if(T.tag!==5)throw Error(i(476));var he=Wi(T).queue;$u(T,he,R,hc,z===null?r:function(){var Te=Wi(T).next.queue;return $c(T,Te,{},ga()),z(re)})},Fr.updateContainer=function(T,R,z,re){var he=R.current,Te=ga();return Yl(he,Te,T,R,z,re),Te},Fr.updateContainerSync=function(T,R,z,re){return R.tag===0&&al(),Yl(R.current,2,T,R,z,re),2},Fr},n.exports.default=n.exports,Object.defineProperty(n.exports,"__esModule",{value:!0})})(A6)),A6.exports}var qW;function XMe(){return qW||(qW=1,R6.exports=YMe()),R6.exports}var KMe=XMe();const ZMe=Bh(KMe);var VW=koe();function Kz(n,e,t){if(!n)return;if(t(n)===!0)return n;let r=e?n.return:n.child;for(;r;){const i=Kz(r,e,t);if(i)return i;r=e?null:r.sibling}}function Ooe(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const Zz=Ooe(it.createContext(null));let Ioe=class extends it.Component{render(){return it.createElement(Zz.Provider,{value:this._reactInternals},this.props.children)}};function Noe(){const n=it.useContext(Zz);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=it.useId();return it.useMemo(()=>{for(const t of[n,n?.alternate]){if(!t)continue;const r=Kz(t,!1,i=>{let s=i.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(r)return r}},[n,e])}const QMe=Symbol.for("react.context"),JMe=n=>n!==null&&typeof n=="object"&&"$$typeof"in n&&n.$$typeof===QMe;function e2e(){const n=Noe(),[e]=it.useState(()=>new Map);e.clear();let t=n;for(;t;){const r=t.type;JMe(r)&&r!==Zz&&!e.has(r)&&e.set(r,it.use(Ooe(r))),t=t.return}return e}function t2e(){const n=e2e();return it.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>r=>it.createElement(e,null,it.createElement(t.Provider,{...r,value:n.get(t)})),e=>it.createElement(Ioe,{...e})),[n])}function Poe(n){let e=n.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const Doe=n=>n&&n.isOrthographicCamera,n2e=n=>n&&n.hasOwnProperty("current"),r2e=n=>n!=null&&(typeof n=="string"||typeof n=="number"||n.isColor),aO=((n,e)=>typeof window<"u"&&(((n=window.document)==null?void 0:n.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?it.useLayoutEffect:it.useEffect;function Qz(n){const e=it.useRef(n);return aO(()=>void(e.current=n),[n]),e}function i2e(){const n=Noe(),e=t2e();return it.useMemo(()=>({children:t})=>{const i=!!Kz(n,!0,s=>s.type===it.StrictMode)?it.StrictMode:it.Fragment;return we.jsx(i,{children:we.jsx(e,{children:t})})},[n,e])}function s2e({set:n}){return aO(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}const a2e=(n=>(n=class extends it.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},n.getDerivedStateFromError=()=>({error:!0}),n))();function Loe(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}function Bx(n){var e;return(e=n.__r3f)==null?void 0:e.root.getState()}const yc={obj:n=>n===Object(n)&&!yc.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,nul:n=>n===null,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:r="reference",strict:i=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(yc.str(n)||yc.num(n)||yc.boo(n))return n===e;const s=yc.obj(n);if(s&&r==="reference")return n===e;const a=yc.arr(n);if(a&&t==="reference")return n===e;if((a||s)&&n===e)return!0;let o;for(o in n)if(!(o in e))return!1;if(s&&t==="shallow"&&r==="shallow"){for(o in i?e:n)if(!yc.equ(n[o],e[o],{strict:i,objects:"reference"}))return!1}else for(o in i?e:n)if(n[o]!==e[o])return!1;if(yc.und(o)){if(a&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function o2e(n){const e={nodes:{},materials:{},meshes:{}};return n&&n.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function l2e(n){n.type!=="Scene"&&(n.dispose==null||n.dispose());for(const e in n){const t=n[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const Uoe=["children","key","ref"];function c2e(n){const e={};for(const t in n)Uoe.includes(t)||(e[t]=n[t]);return e}function cD(n,e,t,r){const i=n;let s=i?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:c2e(r),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=s)),s}function Y2(n,e){let t=n[e];if(!e.includes("-"))return{root:n,key:e,target:t};t=n;for(const i of e.split("-")){var r;e=i,n=t,t=(r=t)==null?void 0:r[e]}return{root:n,key:e,target:t}}const GW=/-\d+$/;function uD(n,e){if(yc.str(e.props.attach)){if(GW.test(e.props.attach)){const i=e.props.attach.replace(GW,""),{root:s,key:a}=Y2(n.object,i);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:r}=Y2(n.object,e.props.attach);e.previousAttach=t[r],t[r]=e.object}else yc.fun(e.props.attach)&&(e.previousAttach=e.props.attach(n.object,e.object))}function fD(n,e){if(yc.str(e.props.attach)){const{root:t,key:r}=Y2(n.object,e.props.attach),i=e.previousAttach;i===void 0?delete t[r]:t[r]=i}else e.previousAttach==null||e.previousAttach(n.object,e.object);delete e.previousAttach}const r7=[...Uoe,"args","dispose","attach","object","onUpdate","dispose"],$W=new Map;function u2e(n){let e=$W.get(n.constructor);try{e||(e=new n.constructor,$W.set(n.constructor,e))}catch{}return e}function f2e(n,e){const t={};for(const r in e)if(!r7.includes(r)&&!yc.equ(e[r],n.props[r])){t[r]=e[r];for(const i in e)i.startsWith(`${r}-`)&&(t[i]=e[i])}for(const r in n.props){if(r7.includes(r)||e.hasOwnProperty(r))continue;const{root:i,key:s}=Y2(n.object,r);if(i.constructor&&i.constructor.length===0){const a=u2e(i);yc.und(a)||(t[s]=a[s])}else t[s]=0}return t}const h2e=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],d2e=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function s1(n,e){var t;const r=n.__r3f,i=r&&Poe(r).getState(),s=r?.eventCount;for(const o in e){let l=e[o];if(r7.includes(o))continue;if(r&&d2e.test(o)){typeof l=="function"?r.handlers[o]=l:delete r.handlers[o],r.eventCount=Object.keys(r.handlers).length;continue}if(l===void 0)continue;let{root:c,key:u,target:f}=Y2(n,o);if(f instanceof HT&&l instanceof HT)f.mask=l.mask;else if(f instanceof cr&&r2e(l))f.set(l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof f.copy=="function"&&l!=null&&l.constructor&&f.constructor===l.constructor)f.copy(l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&Array.isArray(l))typeof f.fromArray=="function"?f.fromArray(l):f.set(...l);else if(f!==null&&typeof f=="object"&&typeof f.set=="function"&&typeof l=="number")typeof f.setScalar=="function"?f.setScalar(l):f.set(l);else{var a;c[u]=l,i&&!i.linear&&h2e.includes(u)&&(a=c[u])!=null&&a.isTexture&&c[u].format===Xf&&c[u].type===zl&&(c[u].colorSpace=ta)}}if(r!=null&&r.parent&&i!=null&&i.internal&&(t=r.object)!=null&&t.isObject3D&&s!==r.eventCount){const o=r.object,l=i.internal.interaction.indexOf(o);l>-1&&i.internal.interaction.splice(l,1),r.eventCount&&o.raycast!==null&&i.internal.interaction.push(o)}return r&&r.props.attach===void 0&&(r.object.isBufferGeometry?r.props.attach="geometry":r.object.isMaterial&&(r.props.attach="material")),r&&Bw(r),n}function Bw(n){var e;if(!n.parent)return;n.props.onUpdate==null||n.props.onUpdate(n.object);const t=(e=n.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function Boe(n,e){n.manual||(Doe(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix())}const Cp=n=>n?.isObject3D;function SI(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function Foe(n,e,t,r){const i=t.get(e);i&&(t.delete(e),t.size===0&&(n.delete(r),i.target.releasePointerCapture(r)))}function p2e(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(r=>r!==e),t.initialHits=t.initialHits.filter(r=>r!==e),t.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((r,i)=>{Foe(t.capturedMap,e,r,i)})}function m2e(n){function e(l){const{internal:c}=n.getState(),u=l.offsetX-c.initialClick[0],f=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+f*f))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var f;return(f=c.__r3f)==null?void 0:f.handlers["onPointer"+u]}))}function r(l,c){const u=n.getState(),f=new Set,d=[],g=c?c(u.internal.interaction):u.internal.interaction;for(let v=0;v<g.length;v++){const x=Bx(g[v]);x&&(x.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(v){const x=Bx(v);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var E;x.events.compute==null||x.events.compute(l,x,(E=x.previousRoot)==null?void 0:E.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(v,!0):[]}let _=g.flatMap(p).sort((v,x)=>{const E=Bx(v.object),M=Bx(x.object);return!E||!M?v.distance-x.distance:M.events.priority-E.events.priority||v.distance-x.distance}).filter(v=>{const x=SI(v);return f.has(x)?!1:(f.add(x),!0)});u.events.filter&&(_=u.events.filter(_,u));for(const v of _){let x=v.object;for(;x;){var y;(y=x.__r3f)!=null&&y.eventCount&&d.push({...v,eventObject:x}),x=x.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let v of u.internal.capturedMap.get(l.pointerId).values())f.has(SI(v.intersection))||d.push(v.intersection);return d}function i(l,c,u,f){if(l.length){const d={stopped:!1};for(const g of l){let p=Bx(g.object);if(p||g.object.traverseAncestors(_=>{const y=Bx(_);if(y)return p=y,!1}),p){const{raycaster:_,pointer:y,camera:v,internal:x}=p,E=new ut(y.x,y.y,0).unproject(v),M=V=>{var G,Q;return(G=(Q=x.capturedMap.get(V))==null?void 0:Q.has(g.eventObject))!=null?G:!1},O=V=>{const G={intersection:g,target:c.target};x.capturedMap.has(V)?x.capturedMap.get(V).set(g.eventObject,G):x.capturedMap.set(V,new Map([[g.eventObject,G]])),c.target.setPointerCapture(V)},N=V=>{const G=x.capturedMap.get(V);G&&Foe(x.capturedMap,g.eventObject,G,V)};let I={};for(let V in c){let G=c[V];typeof G!="function"&&(I[V]=G)}let D={...g,...I,pointer:y,intersections:l,stopped:d.stopped,delta:u,unprojectedPoint:E,ray:_.ray,camera:v,stopPropagation(){const V="pointerId"in c&&x.capturedMap.get(c.pointerId);if((!V||V.has(g.eventObject))&&(D.stopped=d.stopped=!0,x.hovered.size&&Array.from(x.hovered.values()).find(G=>G.eventObject===g.eventObject))){const G=l.slice(0,l.indexOf(g));s([...G,g])}},target:{hasPointerCapture:M,setPointerCapture:O,releasePointerCapture:N},currentTarget:{hasPointerCapture:M,setPointerCapture:O,releasePointerCapture:N},nativeEvent:c};if(f(D),d.stopped===!0)break}}}return l}function s(l){const{internal:c}=n.getState();for(const u of c.hovered.values())if(!l.length||!l.find(f=>f.object===u.object&&f.index===u.index&&f.instanceId===u.instanceId)){const d=u.eventObject.__r3f;if(c.hovered.delete(SI(u)),d!=null&&d.eventCount){const g=d.handlers,p={...u,intersections:l};g.onPointerOut==null||g.onPointerOut(p),g.onPointerLeave==null||g.onPointerLeave(p)}}}function a(l,c){for(let u=0;u<c.length;u++){const f=c[u].__r3f;f==null||f.handlers.onPointerMissed==null||f.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=n.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:f,internal:d}=n.getState();d.lastEvent.current=u;const g=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",y=r(u,g?t:void 0),v=p?e(u):0;l==="onPointerDown"&&(d.initialClick=[u.offsetX,u.offsetY],d.initialHits=y.map(E=>E.eventObject)),p&&!y.length&&v<=2&&(a(u,d.interaction),f&&f(u)),g&&s(y);function x(E){const M=E.eventObject,O=M.__r3f;if(!(O!=null&&O.eventCount))return;const N=O.handlers;if(g){if(N.onPointerOver||N.onPointerEnter||N.onPointerOut||N.onPointerLeave){const I=SI(E),D=d.hovered.get(I);D?D.stopped&&E.stopPropagation():(d.hovered.set(I,E),N.onPointerOver==null||N.onPointerOver(E),N.onPointerEnter==null||N.onPointerEnter(E))}N.onPointerMove==null||N.onPointerMove(E)}else{const I=N[l];I?(!p||d.initialHits.includes(M))&&(a(u,d.interaction.filter(D=>!d.initialHits.includes(D))),I(E)):p&&d.initialHits.includes(M)&&a(u,d.interaction.filter(D=>!d.initialHits.includes(D)))}}i(y,u,v,x)}}return{handlePointer:o}}const WW=n=>!!(n!=null&&n.render),Jz=it.createContext(null),g2e=(n,e)=>{const t=Roe((o,l)=>{const c=new ut,u=new ut,f=new ut;function d(v=l().camera,x=u,E=l().size){const{width:M,height:O,top:N,left:I}=E,D=M/O;x.isVector3?f.copy(x):f.set(...x);const V=v.getWorldPosition(c).distanceTo(f);if(Doe(v))return{width:M/v.zoom,height:O/v.zoom,top:N,left:I,factor:1,distance:V,aspect:D};{const G=v.fov*Math.PI/180,Q=2*Math.tan(G/2)*V,B=Q*(M/O);return{width:B,height:Q,top:N,left:I,factor:M/B,distance:V,aspect:D}}}let g;const p=v=>o(x=>({performance:{...x.performance,current:v}})),_=new an;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(v=1)=>n(l(),v),advance:(v,x)=>e(v,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Vz,pointer:_,mouse:_,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const v=l();g&&clearTimeout(g),v.performance.current!==v.performance.min&&p(v.performance.min),g=setTimeout(()=>p(l().performance.max),v.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:d},setEvents:v=>o(x=>({...x,events:{...x.events,...v}})),setSize:(v,x,E=0,M=0)=>{const O=l().camera,N={width:v,height:x,top:E,left:M};o(I=>({size:N,viewport:{...I.viewport,...d(O,u,N)}}))},setDpr:v=>o(x=>{const E=Loe(v);return{viewport:{...x.viewport,dpr:E,initialDpr:x.viewport.initialDpr||E}}}),setFrameloop:(v="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,v!=="never"&&(x.start(),x.elapsedTime=0),o(()=>({frameloop:v}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:it.createRef(),active:!1,frames:0,priority:0,subscribe:(v,x,E)=>{const M=l().internal;return M.priority=M.priority+(x>0?1:0),M.subscribers.push({ref:v,priority:x,store:E}),M.subscribers=M.subscribers.sort((O,N)=>O.priority-N.priority),()=>{const O=l().internal;O!=null&&O.subscribers&&(O.priority=O.priority-(x>0?1:0),O.subscribers=O.subscribers.filter(N=>N.ref!==v))}}}}}),r=t.getState();let i=r.size,s=r.viewport.dpr,a=r.camera;return t.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:u,set:f}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){i=l,s=c.dpr,Boe(o,l),c.dpr>0&&u.setPixelRatio(c.dpr);const d=typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,d)}o!==a&&(a=o,f(d=>({viewport:{...d.viewport,...d.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>n(o)),t};function ej(){const n=it.useContext(Jz);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function Im(n=t=>t,e){return ej()(n,e)}function Gg(n,e=0){const t=ej(),r=t.getState().internal.subscribe,i=Qz(n);return aO(()=>r(i,e,t),[e,r,t]),null}const YW=new WeakMap,_2e=n=>{var e;return typeof n=="function"&&(n==null||(e=n.prototype)==null?void 0:e.constructor)===n};function zoe(n,e){return function(t,...r){let i;return _2e(t)?(i=YW.get(t),i||(i=new t,YW.set(t,i))):i=t,n&&n(i),Promise.all(r.map(s=>new Promise((a,o)=>i.load(s,l=>{Cp(l?.scene)&&Object.assign(l,o2e(l.scene)),a(l)},e,l=>o(new Error(`Could not load ${s}: ${l?.message}`))))))}}function tj(n,e,t,r){const i=Array.isArray(e)?e:[e],s=Moe(zoe(t,r),[n,...i],{equal:yc.equ});return Array.isArray(e)?s:s[0]}tj.preload=function(n,e,t){const r=Array.isArray(e)?e:[e];return GMe(zoe(t),[n,...r])};tj.clear=function(n,e){const t=Array.isArray(e)?e:[e];return $Me([n,...t])};function v2e(n){const e=ZMe(n);return e.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:it.version}),e}const joe=0,WT={},y2e=/^three(?=[A-Z])/,R4=n=>`${n[0].toUpperCase()}${n.slice(1)}`;let b2e=0;const S2e=n=>typeof n=="function";function nj(n){if(S2e(n)){const e=`${b2e++}`;return WT[e]=n,e}else Object.assign(WT,n)}function Hoe(n,e){const t=R4(n),r=WT[t];if(n!=="primitive"&&!r)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(n==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function E2e(n,e,t){var r;return n=R4(n)in WT?n:n.replace(y2e,""),Hoe(n,e),n==="primitive"&&(r=e.object)!=null&&r.__r3f&&delete e.object.__r3f,cD(e.object,t,n,e)}function x2e(n){if(!n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?fD(n.parent,n):Cp(n.object)&&(n.object.visible=!1),n.isHidden=!0,Bw(n)}}function qoe(n){if(n.isHidden){var e;n.props.attach&&(e=n.parent)!=null&&e.object?uD(n.parent,n):Cp(n.object)&&n.props.visible!==!1&&(n.object.visible=!0),n.isHidden=!1,Bw(n)}}function rj(n,e,t){const r=e.root.getState();if(!(!n.parent&&n.object!==r.scene)){if(!e.object){var i,s;const a=WT[R4(e.type)];e.object=(i=e.props.object)!=null?i:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(s1(e.object,e.props),e.props.attach)uD(n,e);else if(Cp(e.object)&&Cp(n.object)){const a=n.object.children.indexOf(t?.object);if(t&&a!==-1){const o=n.object.children.indexOf(e.object);if(o!==-1){n.object.children.splice(o,1);const l=o<a?a-1:a;n.object.children.splice(l,0,e.object)}else e.object.parent=n.object,n.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),n.object.dispatchEvent({type:"childadded",child:e.object})}else n.object.add(e.object)}for(const a of e.children)rj(e,a);Bw(e)}}function k6(n,e){e&&(e.parent=n,n.children.push(e),rj(n,e))}function XW(n,e,t){if(!e||!t)return;e.parent=n;const r=n.children.indexOf(t);r!==-1?n.children.splice(r,0,e):n.children.push(e),rj(n,e,t)}function Voe(n){if(typeof n.dispose=="function"){const e=()=>{try{n.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():VW.unstable_scheduleCallback(VW.unstable_IdlePriority,e)}}function i7(n,e,t){if(!e)return;e.parent=null;const r=n.children.indexOf(e);r!==-1&&n.children.splice(r,1),e.props.attach?fD(n,e):Cp(e.object)&&Cp(n.object)&&(n.object.remove(e.object),p2e(Poe(e),e.object));const i=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];i7(e,a,i)}e.children.length=0,delete e.object.__r3f,i&&e.type!=="primitive"&&e.object.type!=="Scene"&&Voe(e.object),t===void 0&&Bw(e)}function T2e(n,e){for(const t of[n,n.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const r=t.ref(e);typeof r=="function"&&(t.refCleanup=r)}else t.ref&&(t.ref.current=e)}const ON=[];function w2e(){for(const[t]of ON){const r=t.parent;if(r){t.props.attach?fD(r,t):Cp(t.object)&&Cp(r.object)&&r.object.remove(t.object);for(const i of t.children)i.props.attach?fD(t,i):Cp(i.object)&&Cp(t.object)&&t.object.remove(i.object)}t.isHidden&&qoe(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&Voe(t.object)}for(const[t,r,i]of ON){t.props=r;const s=t.parent;if(s){var n,e;const a=WT[R4(t.type)];t.object=(n=t.props.object)!=null?n:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,T2e(i,t.object),s1(t.object,t.props),t.props.attach?uD(s,t):Cp(t.object)&&Cp(s.object)&&s.object.add(t.object);for(const o of t.children)o.props.attach?uD(t,o):Cp(o.object)&&Cp(t.object)&&t.object.add(o.object);Bw(t)}}ON.length=0}const O6=()=>{},KW={};let EI=joe;const R2e=0,A2e=4,hD=v2e({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:E2e,removeChild:i7,appendChild:k6,appendInitialChild:k6,insertBefore:XW,appendChildToContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||k6(t,e)},removeChildFromContainer(n,e){const t=n.getState().scene.__r3f;!e||!t||i7(t,e)},insertInContainerBefore(n,e,t){const r=n.getState().scene.__r3f;!e||!t||!r||XW(r,e,t)},getRootHostContext:()=>KW,getChildHostContext:()=>KW,commitUpdate(n,e,t,r,i){var s,a,o;Hoe(e,r);let l=!1;if((n.type==="primitive"&&t.object!==r.object||((s=r.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(o=r.args)!=null&&o.some((u,f)=>{var d;return u!==((d=t.args)==null?void 0:d[f])}))&&(l=!0),l)ON.push([n,{...r},i]);else{const u=f2e(n,r);Object.keys(u).length&&(Object.assign(n.props,u),s1(n.object,u))}(i.sibling===null||(i.flags&A2e)===R2e)&&w2e()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:n=>n?.object,prepareForCommit:()=>null,preparePortalMount:n=>cD(n.getState().scene,n,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:x2e,unhideInstance:qoe,createTextInstance:O6,hideTextInstance:O6,unhideTextInstance:O6,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:it.createContext(null),setCurrentUpdatePriority(n){EI=n},getCurrentUpdatePriority(){return EI},resolveUpdatePriority(){var n;if(EI!==joe)return EI;switch(typeof window<"u"&&((n=window.event)==null?void 0:n.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return RN.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return RN.ContinuousEventPriority;default:return RN.DefaultEventPriority}},resetFormInstance(){}}),bE=new Map,Fx={objects:"shallow",strict:!1};function C2e(n,e){if(!e&&typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:t,height:r,top:i,left:s}=n.parentElement.getBoundingClientRect();return{width:t,height:r,top:i,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function M2e(n){const e=bE.get(n),t=e?.fiber,r=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||g2e(o7,QW),a=t||hD.createContainer(s,RN.ConcurrentRoot,null,!1,null,"",i,i,i,null);e||bE.set(n,{fiber:a,store:s});let o,l,c=!1,u=null;return{async configure(f={}){let d;u=new Promise(K=>d=K);let{gl:g,size:p,scene:_,events:y,onCreated:v,shadows:x=!1,linear:E=!1,flat:M=!1,legacy:O=!1,orthographic:N=!1,frameloop:I="always",dpr:D=[1,2],performance:V,raycaster:G,camera:Q,onPointerMissed:B}=f,$=s.getState(),U=$.gl;if(!$.gl){const K={canvas:n,powerPreference:"high-performance",antialias:!0,alpha:!0},ne=typeof g=="function"?await g(K):g;WW(ne)?U=ne:U=new woe({...K,...g}),$.set({gl:U})}let J=$.raycaster;J||$.set({raycaster:J=new Wz});const{params:W,...q}=G||{};if(yc.equ(q,J,Fx)||s1(J,{...q}),yc.equ(W,J.params,Fx)||s1(J,{params:{...J.params,...W}}),!$.camera||$.camera===l&&!yc.equ(l,Q,Fx)){l=Q;const K=Q?.isCamera,ne=K?Q:N?new sO(0,0,0,0,.1,1e3):new vf(75,0,.1,1e3);K||(ne.position.z=5,Q&&(s1(ne,Q),ne.manual||("aspect"in Q||"left"in Q||"right"in Q||"bottom"in Q||"top"in Q)&&(ne.manual=!0,ne.updateProjectionMatrix())),!$.camera&&!(Q!=null&&Q.rotation)&&ne.lookAt(0,0,0)),$.set({camera:ne}),J.camera=ne}if(!$.scene){let K;_!=null&&_.isScene?(K=_,cD(K,s,"",{})):(K=new VT,cD(K,s,"",{}),_&&s1(K,_)),$.set({scene:K})}y&&!$.events.handlers&&$.set({events:y(s)});const Y=C2e(n,p);if(yc.equ(Y,$.size,Fx)||$.setSize(Y.width,Y.height,Y.top,Y.left),D&&$.viewport.dpr!==Loe(D)&&$.setDpr(D),$.frameloop!==I&&$.setFrameloop(I),$.onPointerMissed||$.set({onPointerMissed:B}),V&&!yc.equ(V,$.performance,Fx)&&$.set(K=>({performance:{...K.performance,...V}})),!$.xr){var ae;const K=(ce,de)=>{const Me=s.getState();Me.frameloop!=="never"&&QW(ce,!0,Me,de)},ne=()=>{const ce=s.getState();ce.gl.xr.enabled=ce.gl.xr.isPresenting,ce.gl.xr.setAnimationLoop(ce.gl.xr.isPresenting?K:null),ce.gl.xr.isPresenting||o7(ce)},le={connect(){const ce=s.getState().gl;ce.xr.addEventListener("sessionstart",ne),ce.xr.addEventListener("sessionend",ne)},disconnect(){const ce=s.getState().gl;ce.xr.removeEventListener("sessionstart",ne),ce.xr.removeEventListener("sessionend",ne)}};typeof((ae=U.xr)==null?void 0:ae.addEventListener)=="function"&&le.connect(),$.set({xr:le})}if(U.shadowMap){const K=U.shadowMap.enabled,ne=U.shadowMap.type;if(U.shadowMap.enabled=!!x,yc.boo(x))U.shadowMap.type=l2;else if(yc.str(x)){var Z;const le={basic:wse,percentage:YL,soft:l2,variance:d_};U.shadowMap.type=(Z=le[x])!=null?Z:l2}else yc.obj(x)&&Object.assign(U.shadowMap,x);(K!==U.shadowMap.enabled||ne!==U.shadowMap.type)&&(U.shadowMap.needsUpdate=!0)}return Sa.enabled=!O,c||(U.outputColorSpace=E?Bv:ta,U.toneMapping=M?kv:dz),$.legacy!==O&&$.set(()=>({legacy:O})),$.linear!==E&&$.set(()=>({linear:E})),$.flat!==M&&$.set(()=>({flat:M})),g&&!yc.fun(g)&&!WW(g)&&!yc.equ(g,U,Fx)&&s1(U,g),o=v,c=!0,d(),this},render(f){return!c&&!u&&this.configure(),u.then(()=>{hD.updateContainer(we.jsx(k2e,{store:s,children:f,onCreated:o,rootElement:n}),a,null,()=>{})}),s},unmount(){Goe(n)}}}function k2e({store:n,children:e,onCreated:t,rootElement:r}){return aO(()=>{const i=n.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),n.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),we.jsx(Jz.Provider,{value:n,children:e})}function Goe(n,e){const t=bE.get(n),r=t?.fiber;if(r){const i=t?.store.getState();i&&(i.internal.active=!1),hD.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,a,o,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=i.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),l2e(i.scene),bE.delete(n)}catch{}},500)})}}function O2e(n,e,t){return we.jsx(I2e,{children:n,container:e,state:t})}function I2e({state:n={},children:e,container:t}){const{events:r,size:i,...s}=n,a=ej(),[o]=it.useState(()=>new Wz),[l]=it.useState(()=>new an),c=Qz((f,d)=>{let g;if(d.camera&&i){const p=d.camera;g=f.viewport.getCurrentViewport(p,new ut,i),p!==f.camera&&Boe(p,i)}return{...f,...d,scene:t,raycaster:o,pointer:l,mouse:l,previousRoot:a,events:{...f.events,...d.events,...r},size:{...f.size,...i},viewport:{...f.viewport,...g},setEvents:p=>d.set(_=>({..._,events:{..._.events,...p}}))}}),u=it.useMemo(()=>{const f=Roe((g,p)=>({...s,set:g,get:p})),d=g=>f.setState(p=>c.current(g,p));return d(a.getState()),a.subscribe(d),f},[a,t]);return we.jsx(we.Fragment,{children:hD.createPortal(we.jsx(Jz.Provider,{value:u,children:e}),u,null)})}function $oe(n,e){const t={callback:n};return e.add(t),()=>void e.delete(t)}const Woe=new Set,Yoe=new Set,N2e=new Set,P2e=n=>$oe(n,Woe),D2e=n=>$oe(n,Yoe);function I6(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function v2(n,e){switch(n){case"before":return I6(Woe,e);case"after":return I6(Yoe,e);case"tail":return I6(N2e,e)}}let N6,P6;function s7(n,e,t){let r=e.clock.getDelta();e.frameloop==="never"&&typeof n=="number"&&(r=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),N6=e.internal.subscribers;for(let i=0;i<N6.length;i++)P6=N6[i],P6.ref.current(P6.store.getState(),r,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let dD=!1,a7=!1,D6,ZW,zx;function Xoe(n){ZW=requestAnimationFrame(Xoe),dD=!0,D6=0,v2("before",n),a7=!0;for(const t of bE.values()){var e;zx=t.store.getState(),zx.internal.active&&(zx.frameloop==="always"||zx.internal.frames>0)&&!((e=zx.gl.xr)!=null&&e.isPresenting)&&(D6+=s7(n,zx))}if(a7=!1,v2("after",n),D6===0)return v2("tail",n),dD=!1,cancelAnimationFrame(ZW)}function o7(n,e=1){var t;if(!n)return bE.forEach(r=>o7(r.store.getState(),e));(t=n.gl.xr)!=null&&t.isPresenting||!n.internal.active||n.frameloop==="never"||(e>1?n.internal.frames=Math.min(60,n.internal.frames+e):a7?n.internal.frames=2:n.internal.frames=1,dD||(dD=!0,requestAnimationFrame(Xoe)))}function QW(n,e=!0,t,r){if(e&&v2("before",n),t)s7(n,t,r);else for(const i of bE.values())s7(n,i.store.getState());e&&v2("after",n)}const L6={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Koe(n){const{handlePointer:e}=m2e(n);return{priority:1,enabled:!0,compute(t,r,i){r.pointer.set(t.offsetX/r.size.width*2-1,-(t.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(L6).reduce((t,r)=>({...t,[r]:e(r)}),{}),update:()=>{var t;const{events:r,internal:i}=n.getState();(t=i.lastEvent)!=null&&t.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{const{set:r,events:i}=n.getState();if(i.disconnect==null||i.disconnect(),r(s=>({events:{...s.events,connected:t}})),i.handlers)for(const s in i.handlers){const a=i.handlers[s],[o,l]=L6[s];t.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:t,events:r}=n.getState();if(r.connected){if(r.handlers)for(const i in r.handlers){const s=r.handlers[i],[a]=L6[i];r.connected.removeEventListener(a,s)}t(i=>({events:{...i.events,connected:void 0}}))}}}}function JW(n,e){let t;return(...r)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...r),e)}}function L2e({debounce:n,scroll:e,polyfill:t,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=it.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=it.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=n?typeof n=="number"?n:n.scroll:null,c=n?typeof n=="number"?n:n.resize:null,u=it.useRef(!1);it.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[f,d,g]=it.useMemo(()=>{const v=()=>{if(!o.current.element)return;const{left:x,top:E,width:M,height:O,bottom:N,right:I,x:D,y:V}=o.current.element.getBoundingClientRect(),G={left:x,top:E,width:M,height:O,bottom:N,right:I,x:D,y:V};o.current.element instanceof HTMLElement&&r&&(G.height=o.current.element.offsetHeight,G.width=o.current.element.offsetWidth),Object.freeze(G),u.current&&!z2e(o.current.lastBounds,G)&&a(o.current.lastBounds=G)};return[v,c?JW(v,c):v,l?JW(v,l):v]},[a,r,l,c]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(v=>v.removeEventListener("scroll",g,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function _(){o.current.element&&(o.current.resizeObserver=new i(g),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(v=>v.addEventListener("scroll",g,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{g()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const y=v=>{!v||v===o.current.element||(p(),o.current.element=v,o.current.scrollContainers=Zoe(v),_())};return B2e(g,!!e),U2e(d),it.useEffect(()=>{p(),_()},[e,g,d]),it.useEffect(()=>p,[]),[y,s,f]}function U2e(n){it.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function B2e(n,e){it.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function Zoe(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:r,overflowY:i}=window.getComputedStyle(n);return[t,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...Zoe(n.parentElement)]}const F2e=["x","y","top","bottom","left","right","width","height"],z2e=(n,e)=>F2e.every(t=>n[t]===e[t]);function j2e({ref:n,children:e,fallback:t,resize:r,style:i,gl:s,events:a=Koe,eventSource:o,eventPrefix:l,shadows:c,linear:u,flat:f,legacy:d,orthographic:g,frameloop:p,dpr:_,performance:y,raycaster:v,camera:x,scene:E,onPointerMissed:M,onCreated:O,...N}){it.useMemo(()=>nj(PMe),[]);const I=i2e(),[D,V]=L2e({scroll:!0,debounce:{scroll:50,resize:0},...r}),G=it.useRef(null),Q=it.useRef(null);it.useImperativeHandle(n,()=>G.current);const B=Qz(M),[$,U]=it.useState(!1),[J,W]=it.useState(!1);if($)throw $;if(J)throw J;const q=it.useRef(null);aO(()=>{const ae=G.current;if(V.width>0&&V.height>0&&ae){q.current||(q.current=M2e(ae));async function Z(){await q.current.configure({gl:s,scene:E,events:a,shadows:c,linear:u,flat:f,legacy:d,orthographic:g,frameloop:p,dpr:_,performance:y,raycaster:v,camera:x,size:V,onPointerMissed:(...K)=>B.current==null?void 0:B.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(o?n2e(o)?o.current:o:Q.current),l&&K.setEvents({compute:(ne,le)=>{const ce=ne[l+"X"],de=ne[l+"Y"];le.pointer.set(ce/le.size.width*2-1,-(de/le.size.height)*2+1),le.raycaster.setFromCamera(le.pointer,le.camera)}}),O?.(K)}}),q.current.render(we.jsx(I,{children:we.jsx(a2e,{set:W,children:we.jsx(it.Suspense,{fallback:we.jsx(s2e,{set:U}),children:e??null})})}))}Z()}}),it.useEffect(()=>{const ae=G.current;if(ae)return()=>Goe(ae)},[]);const Y=o?"none":"auto";return we.jsx("div",{ref:Q,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...i},...N,children:we.jsx("div",{ref:D,style:{width:"100%",height:"100%"},children:we.jsx("canvas",{ref:G,style:{display:"block"},children:t})})})}function H2e(n){return we.jsx(Ioe,{children:we.jsx(j2e,{...n})})}var xI={exports:{}},eY;function q2e(){if(eY)return xI.exports;eY=1;function n(e,t=100,r={}){if(typeof e!="function")throw new TypeError(`Expected the first parameter to be a function, got \`${typeof e}\`.`);if(t<0)throw new RangeError("`wait` must not be negative.");const{immediate:i}=typeof r=="boolean"?{immediate:r}:r;let s,a,o,l,c;function u(){const g=s,p=a;return s=void 0,a=void 0,c=e.apply(g,p),c}function f(){const g=Date.now()-l;g<t&&g>=0?o=setTimeout(f,t-g):(o=void 0,i||(c=u()))}const d=function(...g){if(s&&this!==s&&Object.getPrototypeOf(this)===Object.getPrototypeOf(s))throw new Error("Debounced method called with different contexts of the same prototype.");s=this,a=g,l=Date.now();const p=i&&!o;return o||(o=setTimeout(f,t)),p&&(c=u()),c};return Object.defineProperty(d,"isPending",{get(){return o!==void 0}}),d.clear=()=>{o&&(clearTimeout(o),o=void 0)},d.flush=()=>{o&&d.trigger()},d.trigger=()=>{c=u(),d.clear()},d}return xI.exports.debounce=n,xI.exports=n,xI.exports}var V2e=q2e();const G2e=Bh(V2e);var U6={exports:{}},UR={},B6={exports:{}},F6={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tY;function $2e(){return tY||(tY=1,(function(n){function e(W,q){var Y=W.length;W.push(q);e:for(;0<Y;){var ae=Y-1>>>1,Z=W[ae];if(0<i(Z,q))W[ae]=q,W[Y]=Z,Y=ae;else break e}}function t(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var q=W[0],Y=W.pop();if(Y!==q){W[0]=Y;e:for(var ae=0,Z=W.length,K=Z>>>1;ae<K;){var ne=2*(ae+1)-1,le=W[ne],ce=ne+1,de=W[ce];if(0>i(le,Y))ce<Z&&0>i(de,le)?(W[ae]=de,W[ce]=Y,ae=ce):(W[ae]=le,W[ne]=Y,ae=ne);else if(ce<Z&&0>i(de,Y))W[ae]=de,W[ce]=Y,ae=ce;else break e}}return q}function i(W,q){var Y=W.sortIndex-q.sortIndex;return Y!==0?Y:W.id-q.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,f=null,d=3,g=!1,p=!1,_=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function M(W){for(var q=t(c);q!==null;){if(q.callback===null)r(c);else if(q.startTime<=W)r(c),q.sortIndex=q.expirationTime,e(l,q);else break;q=t(c)}}function O(W){if(_=!1,M(W),!p)if(t(l)!==null)p=!0,N||(N=!0,B());else{var q=t(c);q!==null&&J(O,q.startTime-W)}}var N=!1,I=-1,D=5,V=-1;function G(){return y?!0:!(n.unstable_now()-V<D)}function Q(){if(y=!1,N){var W=n.unstable_now();V=W;var q=!0;try{e:{p=!1,_&&(_=!1,x(I),I=-1),g=!0;var Y=d;try{t:{for(M(W),f=t(l);f!==null&&!(f.expirationTime>W&&G());){var ae=f.callback;if(typeof ae=="function"){f.callback=null,d=f.priorityLevel;var Z=ae(f.expirationTime<=W);if(W=n.unstable_now(),typeof Z=="function"){f.callback=Z,M(W),q=!0;break t}f===t(l)&&r(l),M(W)}else r(l);f=t(l)}if(f!==null)q=!0;else{var K=t(c);K!==null&&J(O,K.startTime-W),q=!1}}break e}finally{f=null,d=Y,g=!1}q=void 0}}finally{q?B():N=!1}}}var B;if(typeof E=="function")B=function(){E(Q)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,U=$.port2;$.port1.onmessage=Q,B=function(){U.postMessage(null)}}else B=function(){v(Q,0)};function J(W,q){I=v(function(){W(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(W){W.callback=null},n.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},n.unstable_getCurrentPriorityLevel=function(){return d},n.unstable_next=function(W){switch(d){case 1:case 2:case 3:var q=3;break;default:q=d}var Y=d;d=q;try{return W()}finally{d=Y}},n.unstable_requestPaint=function(){y=!0},n.unstable_runWithPriority=function(W,q){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var Y=d;d=W;try{return q()}finally{d=Y}},n.unstable_scheduleCallback=function(W,q,Y){var ae=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ae+Y:ae):Y=ae,W){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,W={id:u++,callback:q,priorityLevel:W,startTime:Y,expirationTime:Z,sortIndex:-1},Y>ae?(W.sortIndex=Y,e(c,W),t(l)===null&&W===t(c)&&(_?(x(I),I=-1):_=!0,J(O,Y-ae))):(W.sortIndex=Z,e(l,W),p||g||(p=!0,N||(N=!0,B()))),W},n.unstable_shouldYield=G,n.unstable_wrapCallback=function(W){var q=d;return function(){var Y=d;d=q;try{return W.apply(this,arguments)}finally{d=Y}}}})(F6)),F6}var nY;function W2e(){return nY||(nY=1,B6.exports=$2e()),B6.exports}var z6={exports:{}},$d={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rY;function Y2e(){if(rY)return $d;rY=1;var n=Mw();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,c,u){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:f==null?null:""+f,children:l,containerInfo:c,implementation:u}}var a=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return $d.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,$d.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return s(l,c,null,u)},$d.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},$d.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},$d.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},$d.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin),d=typeof c.integrity=="string"?c.integrity:void 0,g=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:f,integrity:d,fetchPriority:g}):u==="script"&&r.d.X(l,{crossOrigin:f,integrity:d,fetchPriority:g,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},$d.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},$d.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,f=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:f,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},$d.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},$d.requestFormReset=function(l){r.d.r(l)},$d.unstable_batchedUpdates=function(l,c){return l(c)},$d.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},$d.useFormStatus=function(){return a.H.useHostTransitionStatus()},$d.version="19.1.1",$d}var iY;function X2e(){if(iY)return z6.exports;iY=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),z6.exports=Y2e(),z6.exports}var sY;function K2e(){if(sY)return UR;sY=1;var n=W2e(),e=Mw(),t=X2e();function r(m){var S="https://react.dev/errors/"+m;if(1<arguments.length){S+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)S+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+m+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function s(m){var S=m,A=m;if(m.alternate)for(;S.return;)S=S.return;else{m=S;do S=m,(S.flags&4098)!==0&&(A=S.return),m=S.return;while(m)}return S.tag===3?A:null}function a(m){if(m.tag===13){var S=m.memoizedState;if(S===null&&(m=m.alternate,m!==null&&(S=m.memoizedState)),S!==null)return S.dehydrated}return null}function o(m){if(s(m)!==m)throw Error(r(188))}function l(m){var S=m.alternate;if(!S){if(S=s(m),S===null)throw Error(r(188));return S!==m?null:m}for(var A=m,L=S;;){var ee=A.return;if(ee===null)break;var fe=ee.alternate;if(fe===null){if(L=ee.return,L!==null){A=L;continue}break}if(ee.child===fe.child){for(fe=ee.child;fe;){if(fe===A)return o(ee),m;if(fe===L)return o(ee),S;fe=fe.sibling}throw Error(r(188))}if(A.return!==L.return)A=ee,L=fe;else{for(var He=!1,Je=ee.child;Je;){if(Je===A){He=!0,A=ee,L=fe;break}if(Je===L){He=!0,L=ee,A=fe;break}Je=Je.sibling}if(!He){for(Je=fe.child;Je;){if(Je===A){He=!0,A=fe,L=ee;break}if(Je===L){He=!0,L=fe,A=ee;break}Je=Je.sibling}if(!He)throw Error(r(189))}}if(A.alternate!==L)throw Error(r(190))}if(A.tag!==3)throw Error(r(188));return A.stateNode.current===A?m:S}function c(m){var S=m.tag;if(S===5||S===26||S===27||S===6)return m;for(m=m.child;m!==null;){if(S=c(m),S!==null)return S;m=m.sibling}return null}var u=Object.assign,f=Symbol.for("react.element"),d=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),p=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),y=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),x=Symbol.for("react.consumer"),E=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),O=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),D=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),G=Symbol.for("react.memo_cache_sentinel"),Q=Symbol.iterator;function B(m){return m===null||typeof m!="object"?null:(m=Q&&m[Q]||m["@@iterator"],typeof m=="function"?m:null)}var $=Symbol.for("react.client.reference");function U(m){if(m==null)return null;if(typeof m=="function")return m.$$typeof===$?null:m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case p:return"Fragment";case y:return"Profiler";case _:return"StrictMode";case O:return"Suspense";case N:return"SuspenseList";case V:return"Activity"}if(typeof m=="object")switch(m.$$typeof){case g:return"Portal";case E:return(m.displayName||"Context")+".Provider";case x:return(m._context.displayName||"Context")+".Consumer";case M:var S=m.render;return m=m.displayName,m||(m=S.displayName||S.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case I:return S=m.displayName||null,S!==null?S:U(m.type)||"Memo";case D:S=m._payload,m=m._init;try{return U(m(S))}catch{}}return null}var J=Array.isArray,W=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},ae=[],Z=-1;function K(m){return{current:m}}function ne(m){0>Z||(m.current=ae[Z],ae[Z]=null,Z--)}function le(m,S){Z++,ae[Z]=m.current,m.current=S}var ce=K(null),de=K(null),Me=K(null),qe=K(null);function Pe(m,S){switch(le(Me,S),le(de,m),le(ce,null),S.nodeType){case 9:case 11:m=(m=S.documentElement)&&(m=m.namespaceURI)?TG(m):0;break;default:if(m=S.tagName,S=S.namespaceURI)S=TG(S),m=wG(S,m);else switch(m){case"svg":m=1;break;case"math":m=2;break;default:m=0}}ne(ce),le(ce,m)}function Ce(){ne(ce),ne(de),ne(Me)}function Xe(m){m.memoizedState!==null&&le(qe,m);var S=ce.current,A=wG(S,m.type);S!==A&&(le(de,m),le(ce,A))}function $e(m){de.current===m&&(ne(ce),ne(de)),qe.current===m&&(ne(qe),yR._currentValue=Y)}var at=Object.prototype.hasOwnProperty,pt=n.unstable_scheduleCallback,oe=n.unstable_cancelCallback,Ue=n.unstable_shouldYield,Ge=n.unstable_requestPaint,ze=n.unstable_now,Be=n.unstable_getCurrentPriorityLevel,me=n.unstable_ImmediatePriority,Se=n.unstable_UserBlockingPriority,Ie=n.unstable_NormalPriority,be=n.unstable_LowPriority,Ke=n.unstable_IdlePriority,ot=n.log,lt=n.unstable_setDisableYieldValue,ct=null,Vt=null;function kt(m){if(typeof ot=="function"&&lt(m),Vt&&typeof Vt.setStrictMode=="function")try{Vt.setStrictMode(ct,m)}catch{}}var Ut=Math.clz32?Math.clz32:se,je=Math.log,ge=Math.LN2;function se(m){return m>>>=0,m===0?32:31-(je(m)/ge|0)|0}var _e=256,Ne=4194304;function Le(m){var S=m&42;if(S!==0)return S;switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return m&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return m}}function ke(m,S,A){var L=m.pendingLanes;if(L===0)return 0;var ee=0,fe=m.suspendedLanes,He=m.pingedLanes;m=m.warmLanes;var Je=L&134217727;return Je!==0?(L=Je&~fe,L!==0?ee=Le(L):(He&=Je,He!==0?ee=Le(He):A||(A=Je&~m,A!==0&&(ee=Le(A))))):(Je=L&~fe,Je!==0?ee=Le(Je):He!==0?ee=Le(He):A||(A=L&~m,A!==0&&(ee=Le(A)))),ee===0?0:S!==0&&S!==ee&&(S&fe)===0&&(fe=ee&-ee,A=S&-S,fe>=A||fe===32&&(A&4194048)!==0)?S:ee}function Re(m,S){return(m.pendingLanes&~(m.suspendedLanes&~m.pingedLanes)&S)===0}function st(m,S){switch(m){case 1:case 2:case 4:case 8:case 64:return S+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ve(){var m=_e;return _e<<=1,(_e&4194048)===0&&(_e=256),m}function tt(){var m=Ne;return Ne<<=1,(Ne&62914560)===0&&(Ne=4194304),m}function Ze(m){for(var S=[],A=0;31>A;A++)S.push(m);return S}function nt(m,S){m.pendingLanes|=S,S!==268435456&&(m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0)}function vt(m,S,A,L,ee,fe){var He=m.pendingLanes;m.pendingLanes=A,m.suspendedLanes=0,m.pingedLanes=0,m.warmLanes=0,m.expiredLanes&=A,m.entangledLanes&=A,m.errorRecoveryDisabledLanes&=A,m.shellSuspendCounter=0;var Je=m.entanglements,St=m.expirationTimes,Jt=m.hiddenUpdates;for(A=He&~A;0<A;){var vn=31-Ut(A),xn=1<<vn;Je[vn]=0,St[vn]=-1;var rn=Jt[vn];if(rn!==null)for(Jt[vn]=null,vn=0;vn<rn.length;vn++){var on=rn[vn];on!==null&&(on.lane&=-536870913)}A&=~xn}L!==0&&Qe(m,L,0),fe!==0&&ee===0&&m.tag!==0&&(m.suspendedLanes|=fe&~(He&~S))}function Qe(m,S,A){m.pendingLanes|=S,m.suspendedLanes&=~S;var L=31-Ut(S);m.entangledLanes|=S,m.entanglements[L]=m.entanglements[L]|1073741824|A&4194090}function ht(m,S){var A=m.entangledLanes|=S;for(m=m.entanglements;A;){var L=31-Ut(A),ee=1<<L;ee&S|m[L]&S&&(m[L]|=S),A&=~ee}}function mt(m){switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=128;break;case 268435456:m=134217728;break;default:m=0}return m}function ft(m){return m&=-m,2<m?8<m?(m&134217727)!==0?32:268435456:8:2}function _t(){var m=q.p;return m!==0?m:(m=window.event,m===void 0?32:VG(m.type))}function gn(m,S){var A=q.p;try{return q.p=m,S()}finally{q.p=A}}var _n=Math.random().toString(36).slice(2),Bt="__reactFiber$"+_n,Yt="__reactProps$"+_n,Mt="__reactContainer$"+_n,fn="__reactEvents$"+_n,Bn="__reactListeners$"+_n,cn="__reactHandles$"+_n,In="__reactResources$"+_n,$n="__reactMarker$"+_n;function er(m){delete m[Bt],delete m[Yt],delete m[fn],delete m[Bn],delete m[cn]}function as(m){var S=m[Bt];if(S)return S;for(var A=m.parentNode;A;){if(S=A[Mt]||A[Bt]){if(A=S.alternate,S.child!==null||A!==null&&A.child!==null)for(m=MG(m);m!==null;){if(A=m[Bt])return A;m=MG(m)}return S}m=A,A=m.parentNode}return null}function di(m){if(m=m[Bt]||m[Mt]){var S=m.tag;if(S===5||S===6||S===13||S===26||S===27||S===3)return m}return null}function Oi(m){var S=m.tag;if(S===5||S===26||S===27||S===6)return m.stateNode;throw Error(r(33))}function Bs(m){var S=m[In];return S||(S=m[In]={hoistableStyles:new Map,hoistableScripts:new Map}),S}function pi(m){m[$n]=!0}var ws=new Set,na={};function os(m,S){We(m,S),We(m+"Capture",S)}function We(m,S){for(na[m]=S,m=0;m<S.length;m++)ws.add(S[m])}var At=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Wt={},Kt={};function Lt(m){return at.call(Kt,m)?!0:at.call(Wt,m)?!1:At.test(m)?Kt[m]=!0:(Wt[m]=!0,!1)}function yn(m,S,A){if(Lt(S))if(A===null)m.removeAttribute(S);else{switch(typeof A){case"undefined":case"function":case"symbol":m.removeAttribute(S);return;case"boolean":var L=S.toLowerCase().slice(0,5);if(L!=="data-"&&L!=="aria-"){m.removeAttribute(S);return}}m.setAttribute(S,""+A)}}function zn(m,S,A){if(A===null)m.removeAttribute(S);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(S);return}m.setAttribute(S,""+A)}}function En(m,S,A,L){if(L===null)m.removeAttribute(A);else{switch(typeof L){case"undefined":case"function":case"symbol":case"boolean":m.removeAttribute(A);return}m.setAttributeNS(S,A,""+L)}}var tr,Ir;function Er(m){if(tr===void 0)try{throw Error()}catch(A){var S=A.stack.trim().match(/\n( *(at )?)/);tr=S&&S[1]||"",Ir=-1<A.stack.indexOf(`
    at`)?" (<anonymous>)":-1<A.stack.indexOf("@")?"@unknown:0:0":""}return`
`+tr+m+Ir}var rr=!1;function Dr(m,S){if(!m||rr)return"";rr=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var L={DetermineComponentFrameRoot:function(){try{if(S){var xn=function(){throw Error()};if(Object.defineProperty(xn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xn,[])}catch(on){var rn=on}Reflect.construct(m,[],xn)}else{try{xn.call()}catch(on){rn=on}m.call(xn.prototype)}}else{try{throw Error()}catch(on){rn=on}(xn=m())&&typeof xn.catch=="function"&&xn.catch(function(){})}}catch(on){if(on&&rn&&typeof on.stack=="string")return[on.stack,rn.stack]}return[null,null]}};L.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var ee=Object.getOwnPropertyDescriptor(L.DetermineComponentFrameRoot,"name");ee&&ee.configurable&&Object.defineProperty(L.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var fe=L.DetermineComponentFrameRoot(),He=fe[0],Je=fe[1];if(He&&Je){var St=He.split(`
`),Jt=Je.split(`
`);for(ee=L=0;L<St.length&&!St[L].includes("DetermineComponentFrameRoot");)L++;for(;ee<Jt.length&&!Jt[ee].includes("DetermineComponentFrameRoot");)ee++;if(L===St.length||ee===Jt.length)for(L=St.length-1,ee=Jt.length-1;1<=L&&0<=ee&&St[L]!==Jt[ee];)ee--;for(;1<=L&&0<=ee;L--,ee--)if(St[L]!==Jt[ee]){if(L!==1||ee!==1)do if(L--,ee--,0>ee||St[L]!==Jt[ee]){var vn=`
`+St[L].replace(" at new "," at ");return m.displayName&&vn.includes("<anonymous>")&&(vn=vn.replace("<anonymous>",m.displayName)),vn}while(1<=L&&0<=ee);break}}}finally{rr=!1,Error.prepareStackTrace=A}return(A=m?m.displayName||m.name:"")?Er(A):""}function ri(m){switch(m.tag){case 26:case 27:case 5:return Er(m.type);case 16:return Er("Lazy");case 13:return Er("Suspense");case 19:return Er("SuspenseList");case 0:case 15:return Dr(m.type,!1);case 11:return Dr(m.type.render,!1);case 1:return Dr(m.type,!0);case 31:return Er("Activity");default:return""}}function ha(m){try{var S="";do S+=ri(m),m=m.return;while(m);return S}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}function Cr(m){switch(typeof m){case"bigint":case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function ii(m){var S=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(S==="checkbox"||S==="radio")}function Tr(m){var S=ii(m)?"checked":"value",A=Object.getOwnPropertyDescriptor(m.constructor.prototype,S),L=""+m[S];if(!m.hasOwnProperty(S)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var ee=A.get,fe=A.set;return Object.defineProperty(m,S,{configurable:!0,get:function(){return ee.call(this)},set:function(He){L=""+He,fe.call(this,He)}}),Object.defineProperty(m,S,{enumerable:A.enumerable}),{getValue:function(){return L},setValue:function(He){L=""+He},stopTracking:function(){m._valueTracker=null,delete m[S]}}}}function Pr(m){m._valueTracker||(m._valueTracker=Tr(m))}function Cn(m){if(!m)return!1;var S=m._valueTracker;if(!S)return!0;var A=S.getValue(),L="";return m&&(L=ii(m)?m.checked?"true":"false":m.value),m=L,m!==A?(S.setValue(m),!0):!1}function zr(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}var Do=/[\n"\\]/g;function ls(m){return m.replace(Do,function(S){return"\\"+S.charCodeAt(0).toString(16)+" "})}function Lo(m,S,A,L,ee,fe,He,Je){m.name="",He!=null&&typeof He!="function"&&typeof He!="symbol"&&typeof He!="boolean"?m.type=He:m.removeAttribute("type"),S!=null?He==="number"?(S===0&&m.value===""||m.value!=S)&&(m.value=""+Cr(S)):m.value!==""+Cr(S)&&(m.value=""+Cr(S)):He!=="submit"&&He!=="reset"||m.removeAttribute("value"),S!=null?Xn(m,He,Cr(S)):A!=null?Xn(m,He,Cr(A)):L!=null&&m.removeAttribute("value"),ee==null&&fe!=null&&(m.defaultChecked=!!fe),ee!=null&&(m.checked=ee&&typeof ee!="function"&&typeof ee!="symbol"),Je!=null&&typeof Je!="function"&&typeof Je!="symbol"&&typeof Je!="boolean"?m.name=""+Cr(Je):m.removeAttribute("name")}function cs(m,S,A,L,ee,fe,He,Je){if(fe!=null&&typeof fe!="function"&&typeof fe!="symbol"&&typeof fe!="boolean"&&(m.type=fe),S!=null||A!=null){if(!(fe!=="submit"&&fe!=="reset"||S!=null))return;A=A!=null?""+Cr(A):"",S=S!=null?""+Cr(S):A,Je||S===m.value||(m.value=S),m.defaultValue=S}L=L??ee,L=typeof L!="function"&&typeof L!="symbol"&&!!L,m.checked=Je?m.checked:!!L,m.defaultChecked=!!L,He!=null&&typeof He!="function"&&typeof He!="symbol"&&typeof He!="boolean"&&(m.name=He)}function Xn(m,S,A){S==="number"&&zr(m.ownerDocument)===m||m.defaultValue===""+A||(m.defaultValue=""+A)}function Jr(m,S,A,L){if(m=m.options,S){S={};for(var ee=0;ee<A.length;ee++)S["$"+A[ee]]=!0;for(A=0;A<m.length;A++)ee=S.hasOwnProperty("$"+m[A].value),m[A].selected!==ee&&(m[A].selected=ee),ee&&L&&(m[A].defaultSelected=!0)}else{for(A=""+Cr(A),S=null,ee=0;ee<m.length;ee++){if(m[ee].value===A){m[ee].selected=!0,L&&(m[ee].defaultSelected=!0);return}S!==null||m[ee].disabled||(S=m[ee])}S!==null&&(S.selected=!0)}}function ur(m,S,A){if(S!=null&&(S=""+Cr(S),S!==m.value&&(m.value=S),A==null)){m.defaultValue!==S&&(m.defaultValue=S);return}m.defaultValue=A!=null?""+Cr(A):""}function Fs(m,S,A,L){if(S==null){if(L!=null){if(A!=null)throw Error(r(92));if(J(L)){if(1<L.length)throw Error(r(93));L=L[0]}A=L}A==null&&(A=""),S=A}A=Cr(S),m.defaultValue=A,L=m.textContent,L===A&&L!==""&&L!==null&&(m.value=L)}function bo(m,S){if(S){var A=m.firstChild;if(A&&A===m.lastChild&&A.nodeType===3){A.nodeValue=S;return}}m.textContent=S}var da=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function pa(m,S,A){var L=S.indexOf("--")===0;A==null||typeof A=="boolean"||A===""?L?m.setProperty(S,""):S==="float"?m.cssFloat="":m[S]="":L?m.setProperty(S,A):typeof A!="number"||A===0||da.has(S)?S==="float"?m.cssFloat=A:m[S]=(""+A).trim():m[S]=A+"px"}function zh(m,S,A){if(S!=null&&typeof S!="object")throw Error(r(62));if(m=m.style,A!=null){for(var L in A)!A.hasOwnProperty(L)||S!=null&&S.hasOwnProperty(L)||(L.indexOf("--")===0?m.setProperty(L,""):L==="float"?m.cssFloat="":m[L]="");for(var ee in S)L=S[ee],S.hasOwnProperty(ee)&&A[ee]!==L&&pa(m,ee,L)}else for(var fe in S)S.hasOwnProperty(fe)&&pa(m,fe,S[fe])}function lp(m){if(m.indexOf("-")===-1)return!1;switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Wp=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function rh(m){return Yp.test(""+m)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":m}var Tl=null;function ac(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var Uo=null,rl=null;function Xp(m){var S=di(m);if(S&&(m=S.stateNode)){var A=m[Yt]||null;e:switch(m=S.stateNode,S.type){case"input":if(Lo(m,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name),S=A.name,A.type==="radio"&&S!=null){for(A=m;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll('input[name="'+ls(""+S)+'"][type="radio"]'),S=0;S<A.length;S++){var L=A[S];if(L!==m&&L.form===m.form){var ee=L[Yt]||null;if(!ee)throw Error(r(90));Lo(L,ee.value,ee.defaultValue,ee.defaultValue,ee.checked,ee.defaultChecked,ee.type,ee.name)}}for(S=0;S<A.length;S++)L=A[S],L.form===m.form&&Cn(L)}break e;case"textarea":ur(m,A.value,A.defaultValue);break e;case"select":S=A.value,S!=null&&Jr(m,!!A.multiple,S,!1)}}}var wc=!1;function Gc(m,S,A){if(wc)return m(S,A);wc=!0;try{var L=m(S);return L}finally{if(wc=!1,(Uo!==null||rl!==null)&&(ps(),Uo&&(S=Uo,m=rl,rl=Uo=null,Xp(S),m)))for(S=0;S<m.length;S++)Xp(m[S])}}function $u(m,S){var A=m.stateNode;if(A===null)return null;var L=A[Yt]||null;if(L===null)return null;A=L[S];e:switch(S){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(L=!L.disabled)||(m=m.type,L=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!L;break e;default:m=!1}if(m)return null;if(A&&typeof A!="function")throw Error(r(231,S,typeof A));return A}var Wi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yi=!1;if(Wi)try{var Rc={};Object.defineProperty(Rc,"passive",{get:function(){Yi=!0}}),window.addEventListener("test",Rc,Rc),window.removeEventListener("test",Rc,Rc)}catch{Yi=!1}var Ef=null,Zm=null,oc=null;function co(){if(oc)return oc;var m,S=Zm,A=S.length,L,ee="value"in Ef?Ef.value:Ef.textContent,fe=ee.length;for(m=0;m<A&&S[m]===ee[m];m++);var He=A-m;for(L=1;L<=He&&S[A-L]===ee[fe-L];L++);return oc=ee.slice(m,1<L?1-L:void 0)}function $c(m){var S=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&S===13&&(m=13)):m=S,m===10&&(m=13),32<=m||m===13?m:0}function Wc(){return!0}function ih(){return!1}function ma(m){function S(A,L,ee,fe,He){this._reactName=A,this._targetInst=ee,this.type=L,this.nativeEvent=fe,this.target=He,this.currentTarget=null;for(var Je in m)m.hasOwnProperty(Je)&&(A=m[Je],this[Je]=A?A(fe):fe[Je]);return this.isDefaultPrevented=(fe.defaultPrevented!=null?fe.defaultPrevented:fe.returnValue===!1)?Wc:ih,this.isPropagationStopped=ih,this}return u(S.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=Wc)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=Wc)},persist:function(){},isPersistent:Wc}),S}var xf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sh=ma(xf),ah=u({},xf,{view:0,detail:0}),Qm=ma(ah),Wu,Tf,oh,Bo=u({},ah,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:up,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==oh&&(oh&&m.type==="mousemove"?(Wu=m.screenX-oh.screenX,Tf=m.screenY-oh.screenY):Tf=Wu=0,oh=m),Wu)},movementY:function(m){return"movementY"in m?m.movementY:Tf}}),Vl=ma(Bo),Ad=u({},Bo,{dataTransfer:0}),Kp=ma(Ad),il=u({},ah,{relatedTarget:0}),Jm=ma(il),q_=u({},xf,{animationName:0,elapsedTime:0,pseudoElement:0}),V_=ma(q_),cp=u({},xf,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),jh=ma(cp),Hh=u({},xf,{data:0}),Yu=ma(Hh),Xu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ta(m){var S=this.nativeEvent;return S.getModifierState?S.getModifierState(m):(m=vs[m])?!!S[m]:!1}function up(){return Ta}var tg=u({},ah,{key:function(m){if(m.key){var S=Xu[m.key]||m.key;if(S!=="Unidentified")return S}return m.type==="keypress"?(m=$c(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?eg[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:up,charCode:function(m){return m.type==="keypress"?$c(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?$c(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),qh=ma(tg),rt=u({},Bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Tt=ma(rt),Rt=u({},ah,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:up}),tn=ma(Rt),wn=u({},xf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Zn=ma(wn),Ri=u({},Bo,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),sl=ma(Ri),_r=u({},xf,{newState:0,oldState:0}),So=ma(_r),wf=[9,13,27,32],ns=Wi&&"CompositionEvent"in window,Ac=null;Wi&&"documentMode"in document&&(Ac=document.documentMode);var lh=Wi&&"TextEvent"in window&&!Ac,sr=Wi&&(!ns||Ac&&8<Ac&&11>=Ac),Cc=" ",Oa=!1;function vr(m,S){switch(m){case"keyup":return wf.indexOf(S.keyCode)!==-1;case"keydown":return S.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vr(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var ch=!1;function Rf(m,S){switch(m){case"compositionend":return Vr(S);case"keypress":return S.which!==32?null:(Oa=!0,Cc);case"textInput":return m=S.data,m===Cc&&Oa?null:m;default:return null}}function X0(m,S){if(ch)return m==="compositionend"||!ns&&vr(m,S)?(m=co(),oc=Zm=Ef=null,ch=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(S.ctrlKey||S.altKey||S.metaKey)||S.ctrlKey&&S.altKey){if(S.char&&1<S.char.length)return S.char;if(S.which)return String.fromCharCode(S.which)}return null;case"compositionend":return sr&&S.locale!=="ko"?null:S.data;default:return null}}var Gl={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ng(m){var S=m&&m.nodeName&&m.nodeName.toLowerCase();return S==="input"?!!Gl[m.type]:S==="textarea"}function Eo(m,S,A,L){Uo?rl?rl.push(L):rl=[L]:Uo=L,S=m3(S,"onChange"),0<S.length&&(A=new sh("onChange","change",null,A,L),m.push({event:A,listeners:S}))}var Fo=null,Su=null;function Yg(m){yG(m,0)}function Eu(m){var S=Oi(m);if(Cn(S))return m}function uh(m,S){if(m==="change")return S}var Zp=!1;if(Wi){var fh;if(Wi){var Af="oninput"in document;if(!Af){var Yc=document.createElement("div");Yc.setAttribute("oninput","return;"),Af=typeof Yc.oninput=="function"}fh=Af}else fh=!1;Zp=fh&&(!document.documentMode||9<document.documentMode)}function Hi(){Fo&&(Fo.detachEvent("onpropertychange",xu),Su=Fo=null)}function xu(m){if(m.propertyName==="value"&&Eu(Su)){var S=[];Eo(S,Su,m,ac(m)),Gc(Yg,S)}}function G_(m,S,A){m==="focusin"?(Hi(),Fo=S,Su=A,Fo.attachEvent("onpropertychange",xu)):m==="focusout"&&Hi()}function $_(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return Eu(Su)}function rg(m,S){if(m==="click")return Eu(S)}function Mc(m,S){if(m==="input"||m==="change")return Eu(S)}function Cd(m,S){return m===S&&(m!==0||1/m===1/S)||m!==m&&S!==S}var uo=typeof Object.is=="function"?Object.is:Cd;function Cf(m,S){if(uo(m,S))return!0;if(typeof m!="object"||m===null||typeof S!="object"||S===null)return!1;var A=Object.keys(m),L=Object.keys(S);if(A.length!==L.length)return!1;for(L=0;L<A.length;L++){var ee=A[L];if(!at.call(S,ee)||!uo(m[ee],S[ee]))return!1}return!0}function $l(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function ig(m,S){var A=$l(m);m=0;for(var L;A;){if(A.nodeType===3){if(L=m+A.textContent.length,m<=S&&L>=S)return{node:A,offset:S-m};m=L}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=$l(A)}}function Xg(m,S){return m&&S?m===S?!0:m&&m.nodeType===3?!1:S&&S.nodeType===3?Xg(m,S.parentNode):"contains"in m?m.contains(S):m.compareDocumentPosition?!!(m.compareDocumentPosition(S)&16):!1:!1}function mi(m){m=m!=null&&m.ownerDocument!=null&&m.ownerDocument.defaultView!=null?m.ownerDocument.defaultView:window;for(var S=zr(m.document);S instanceof m.HTMLIFrameElement;){try{var A=typeof S.contentWindow.location.href=="string"}catch{A=!1}if(A)m=S.contentWindow;else break;S=zr(m.document)}return S}function Xi(m){var S=m&&m.nodeName&&m.nodeName.toLowerCase();return S&&(S==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||S==="textarea"||m.contentEditable==="true")}var sg=Wi&&"documentMode"in document&&11>=document.documentMode,hh=null,fp=null,Fn=null,zs=!1;function Mf(m,S,A){var L=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;zs||hh==null||hh!==zr(L)||(L=hh,"selectionStart"in L&&Xi(L)?L={start:L.selectionStart,end:L.selectionEnd}:(L=(L.ownerDocument&&L.ownerDocument.defaultView||window).getSelection(),L={anchorNode:L.anchorNode,anchorOffset:L.anchorOffset,focusNode:L.focusNode,focusOffset:L.focusOffset}),Fn&&Cf(Fn,L)||(Fn=L,L=m3(fp,"onSelect"),0<L.length&&(S=new sh("onSelect","select",null,S,A),m.push({event:S,listeners:L}),S.target=hh)))}function xo(m,S){var A={};return A[m.toLowerCase()]=S.toLowerCase(),A["Webkit"+m]="webkit"+S,A["Moz"+m]="moz"+S,A}var wl={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionrun:xo("Transition","TransitionRun"),transitionstart:xo("Transition","TransitionStart"),transitioncancel:xo("Transition","TransitionCancel"),transitionend:xo("Transition","TransitionEnd")},Ku={},kf={};Wi&&(kf=document.createElement("div").style,"AnimationEvent"in window||(delete wl.animationend.animation,delete wl.animationiteration.animation,delete wl.animationstart.animation),"TransitionEvent"in window||delete wl.transitionend.transition);function kc(m){if(Ku[m])return Ku[m];if(!wl[m])return m;var S=wl[m],A;for(A in S)if(S.hasOwnProperty(A)&&A in kf)return Ku[m]=S[A];return m}var Rs=kc("animationend"),Kg=kc("animationiteration"),Xs=kc("animationstart"),K0=kc("transitionrun"),Rl=kc("transitionstart"),hp=kc("transitioncancel"),zo=kc("transitionend"),lc=new Map,Br="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Br.push("scrollEnd");function ve(m,S){lc.set(m,S),os(S,[m])}var cc=new WeakMap;function Ja(m,S){if(typeof m=="object"&&m!==null){var A=cc.get(m);return A!==void 0?A:(S={value:m,source:S,stack:ha(S)},cc.set(m,S),S)}return{value:m,source:S,stack:ha(S)}}var Ai=[],On=0,fo=0;function ho(){for(var m=On,S=fo=On=0;S<m;){var A=Ai[S];Ai[S++]=null;var L=Ai[S];Ai[S++]=null;var ee=Ai[S];Ai[S++]=null;var fe=Ai[S];if(Ai[S++]=null,L!==null&&ee!==null){var He=L.pending;He===null?ee.next=ee:(ee.next=He.next,He.next=ee),L.pending=ee}fe!==0&&ag(A,ee,fe)}}function Ki(m,S,A,L){Ai[On++]=m,Ai[On++]=S,Ai[On++]=A,Ai[On++]=L,fo|=L,m.lanes|=L,m=m.alternate,m!==null&&(m.lanes|=L)}function hn(m,S,A,L){return Ki(m,S,A,L),Of(m)}function Ei(m,S){return Ki(m,null,null,S),Of(m)}function ag(m,S,A){m.lanes|=A;var L=m.alternate;L!==null&&(L.lanes|=A);for(var ee=!1,fe=m.return;fe!==null;)fe.childLanes|=A,L=fe.alternate,L!==null&&(L.childLanes|=A),fe.tag===22&&(m=fe.stateNode,m===null||m._visibility&1||(ee=!0)),m=fe,fe=fe.return;return m.tag===3?(fe=m.stateNode,ee&&S!==null&&(ee=31-Ut(A),m=fe.hiddenUpdates,L=m[ee],L===null?m[ee]=[S]:L.push(S),S.lane=A|536870912),fe):null}function Of(m){if(50<oi)throw oi=0,Bi=null,Error(r(185));for(var S=m.return;S!==null;)m=S,S=m.return;return m.tag===3?m.stateNode:null}var If={};function og(m,S,A,L){this.tag=m,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=S,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function To(m,S,A,L){return new og(m,S,A,L)}function Oc(m){return m=m.prototype,!(!m||!m.isReactComponent)}function ga(m,S){var A=m.alternate;return A===null?(A=To(m.tag,S,m.key,m.mode),A.elementType=m.elementType,A.type=m.type,A.stateNode=m.stateNode,A.alternate=m,m.alternate=A):(A.pendingProps=S,A.type=m.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=m.flags&65011712,A.childLanes=m.childLanes,A.lanes=m.lanes,A.child=m.child,A.memoizedProps=m.memoizedProps,A.memoizedState=m.memoizedState,A.updateQueue=m.updateQueue,S=m.dependencies,A.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext},A.sibling=m.sibling,A.index=m.index,A.ref=m.ref,A.refCleanup=m.refCleanup,A}function dp(m,S){m.flags&=65011714;var A=m.alternate;return A===null?(m.childLanes=0,m.lanes=S,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=A.childLanes,m.lanes=A.lanes,m.child=A.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=A.memoizedProps,m.memoizedState=A.memoizedState,m.updateQueue=A.updateQueue,m.type=A.type,S=A.dependencies,m.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext}),m}function wo(m,S,A,L,ee,fe){var He=0;if(L=m,typeof m=="function")Oc(m)&&(He=1);else if(typeof m=="string")He=X1e(m,A,ce.current)?26:m==="html"||m==="head"||m==="body"?27:5;else e:switch(m){case V:return m=To(31,A,S,ee),m.elementType=V,m.lanes=fe,m;case p:return Ia(A.children,ee,fe,S);case _:He=8,ee|=24;break;case y:return m=To(12,A,S,ee|2),m.elementType=y,m.lanes=fe,m;case O:return m=To(13,A,S,ee),m.elementType=O,m.lanes=fe,m;case N:return m=To(19,A,S,ee),m.elementType=N,m.lanes=fe,m;default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case v:case E:He=10;break e;case x:He=9;break e;case M:He=11;break e;case I:He=14;break e;case D:He=16,L=null;break e}He=29,A=Error(r(130,m===null?"null":typeof m,"")),L=null}return S=To(He,A,S,ee),S.elementType=m,S.type=L,S.lanes=fe,S}function Ia(m,S,A,L){return m=To(7,m,L,S),m.lanes=A,m}function dh(m,S,A){return m=To(6,m,null,S),m.lanes=A,m}function Al(m,S,A){return S=To(4,m.children!==null?m.children:[],m.key,S),S.lanes=A,S.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},S}var js=[],Cl=0,Vh=null,Ic=0,us=[],uc=0,Gh=null,Wl=1,Tu="";function si(m,S){js[Cl++]=Ic,js[Cl++]=Vh,Vh=m,Ic=S}function $h(m,S,A){us[uc++]=Wl,us[uc++]=Tu,us[uc++]=Gh,Gh=m;var L=Wl;m=Tu;var ee=32-Ut(L)-1;L&=~(1<<ee),A+=1;var fe=32-Ut(S)+ee;if(30<fe){var He=ee-ee%5;fe=(L&(1<<He)-1).toString(32),L>>=He,ee-=He,Wl=1<<32-Ut(S)+ee|A<<ee|L,Tu=fe+m}else Wl=1<<fe|A<<ee|L,Tu=m}function Qp(m){m.return!==null&&(si(m,1),$h(m,1,0))}function Ks(m){for(;m===Vh;)Vh=js[--Cl],js[Cl]=null,Ic=js[--Cl],js[Cl]=null;for(;m===Gh;)Gh=us[--uc],us[uc]=null,Tu=us[--uc],us[uc]=null,Wl=us[--uc],us[uc]=null}var Ro=null,As=null,ei=!1,Nc=null,gi=!1,Wh=Error(r(519));function Yh(m){var S=Error(r(418,""));throw Xc(Ja(S,m)),Wh}function W_(m){var S=m.stateNode,A=m.type,L=m.memoizedProps;switch(S[Bt]=m,S[Yt]=L,A){case"dialog":ea("cancel",S),ea("close",S);break;case"iframe":case"object":case"embed":ea("load",S);break;case"video":case"audio":for(A=0;A<dR.length;A++)ea(dR[A],S);break;case"source":ea("error",S);break;case"img":case"image":case"link":ea("error",S),ea("load",S);break;case"details":ea("toggle",S);break;case"input":ea("invalid",S),cs(S,L.value,L.defaultValue,L.checked,L.defaultChecked,L.type,L.name,!0),Pr(S);break;case"select":ea("invalid",S);break;case"textarea":ea("invalid",S),Fs(S,L.value,L.defaultValue,L.children),Pr(S)}A=L.children,typeof A!="string"&&typeof A!="number"&&typeof A!="bigint"||S.textContent===""+A||L.suppressHydrationWarning===!0||xG(S.textContent,A)?(L.popover!=null&&(ea("beforetoggle",S),ea("toggle",S)),L.onScroll!=null&&ea("scroll",S),L.onScrollEnd!=null&&ea("scrollend",S),L.onClick!=null&&(S.onclick=g3),S=!0):S=!1,S||Yh(m)}function Md(m){for(Ro=m.return;Ro;)switch(Ro.tag){case 5:case 13:gi=!1;return;case 27:case 3:gi=!0;return;default:Ro=Ro.return}}function al(m){if(m!==Ro)return!1;if(!ei)return Md(m),ei=!0,!1;var S=m.tag,A;if((A=S!==3&&S!==27)&&((A=S===5)&&(A=m.type,A=!(A!=="form"&&A!=="button")||y5(m.type,m.memoizedProps)),A=!A),A&&As&&Yh(m),Md(m),S===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,S=0;m;){if(m.nodeType===8)if(A=m.data,A==="/$"){if(S===0){As=i_(m.nextSibling);break e}S--}else A!=="$"&&A!=="$!"&&A!=="$?"||S++;m=m.nextSibling}As=null}}else S===27?(S=As,Ab(m.type)?(m=x5,x5=null,As=m):As=S):As=Ro?i_(m.stateNode.nextSibling):null;return!0}function Qn(){As=Ro=null,ei=!1}function Ii(){var m=Nc;return m!==null&&(Ft===null?Ft=m:Ft.push.apply(Ft,m),Nc=null),m}function Xc(m){Nc===null?Nc=[m]:Nc.push(m)}var po=K(null),Nf=null,Kc=null;function ph(m,S,A){le(po,S._currentValue),S._currentValue=A}function Zc(m){m._currentValue=po.current,ne(po)}function Jp(m,S,A){for(;m!==null;){var L=m.alternate;if((m.childLanes&S)!==S?(m.childLanes|=S,L!==null&&(L.childLanes|=S)):L!==null&&(L.childLanes&S)!==S&&(L.childLanes|=S),m===A)break;m=m.return}}function kd(m,S,A,L){var ee=m.child;for(ee!==null&&(ee.return=m);ee!==null;){var fe=ee.dependencies;if(fe!==null){var He=ee.child;fe=fe.firstContext;e:for(;fe!==null;){var Je=fe;fe=ee;for(var St=0;St<S.length;St++)if(Je.context===S[St]){fe.lanes|=A,Je=fe.alternate,Je!==null&&(Je.lanes|=A),Jp(fe.return,A,m),L||(He=null);break e}fe=Je.next}}else if(ee.tag===18){if(He=ee.return,He===null)throw Error(r(341));He.lanes|=A,fe=He.alternate,fe!==null&&(fe.lanes|=A),Jp(He,A,m),He=null}else He=ee.child;if(He!==null)He.return=ee;else for(He=ee;He!==null;){if(He===m){He=null;break}if(ee=He.sibling,ee!==null){ee.return=He.return,He=ee;break}He=He.return}ee=He}}function Ao(m,S,A,L){m=null;for(var ee=S,fe=!1;ee!==null;){if(!fe){if((ee.flags&524288)!==0)fe=!0;else if((ee.flags&262144)!==0)break}if(ee.tag===10){var He=ee.alternate;if(He===null)throw Error(r(387));if(He=He.memoizedProps,He!==null){var Je=ee.type;uo(ee.pendingProps.value,He.value)||(m!==null?m.push(Je):m=[Je])}}else if(ee===qe.current){if(He=ee.alternate,He===null)throw Error(r(387));He.memoizedState.memoizedState!==ee.memoizedState.memoizedState&&(m!==null?m.push(yR):m=[yR])}ee=ee.return}m!==null&&kd(S,m,A,L),S.flags|=262144}function Xh(m){for(m=m.firstContext;m!==null;){if(!uo(m.context._currentValue,m.memoizedValue))return!0;m=m.next}return!1}function Zu(m){Nf=m,Kc=null,m=m.dependencies,m!==null&&(m.firstContext=null)}function Na(m){return pp(Nf,m)}function Kh(m,S){return Nf===null&&Zu(m),pp(m,S)}function pp(m,S){var A=S._currentValue;if(S={context:S,memoizedValue:A,next:null},Kc===null){if(m===null)throw Error(r(308));Kc=S,m.dependencies={lanes:0,firstContext:S},m.flags|=524288}else Kc=Kc.next=S;return A}var Qu=typeof AbortController<"u"?AbortController:function(){var m=[],S=this.signal={aborted:!1,addEventListener:function(A,L){m.push(L)}};this.abort=function(){S.aborted=!0,m.forEach(function(A){return A()})}},mh=n.unstable_scheduleCallback,Lr=n.unstable_NormalPriority,yr={$$typeof:E,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ol(){return{controller:new Qu,data:new Map,refCount:0}}function Yl(m){m.refCount--,m.refCount===0&&mh(Lr,function(){m.controller.abort()})}var xi=null,mp=0,Fr=0,Ml=null;function Pa(m,S){if(xi===null){var A=xi=[];mp=0,Fr=u5(),Ml={status:"pending",value:void 0,then:function(L){A.push(L)}}}return mp++,S.then(Od,Od),S}function Od(){if(--mp===0&&xi!==null){Ml!==null&&(Ml.status="fulfilled");var m=xi;xi=null,Fr=0,Ml=null;for(var S=0;S<m.length;S++)(0,m[S])()}}function gp(m,S){var A=[],L={status:"pending",value:null,reason:null,then:function(ee){A.push(ee)}};return m.then(function(){L.status="fulfilled",L.value=S;for(var ee=0;ee<A.length;ee++)(0,A[ee])(S)},function(ee){for(L.status="rejected",L.reason=ee,ee=0;ee<A.length;ee++)(0,A[ee])(void 0)}),L}var ll=W.S;W.S=function(m,S){typeof S=="object"&&S!==null&&typeof S.then=="function"&&Pa(m,S),ll!==null&&ll(m,S)};var Xl=K(null);function ja(){var m=Xl.current;return m!==null?m:F.pooledCache}function ra(m,S){S===null?le(Xl,Xl.current):le(Xl,S.pool)}function Pc(){var m=ja();return m===null?null:{parent:yr._currentValue,pool:m}}var Id=Error(r(460)),wu=Error(r(474)),eo=Error(r(542)),Ju={then:function(){}};function Dc(m){return m=m.status,m==="fulfilled"||m==="rejected"}function ef(){}function Ru(m,S,A){switch(A=m[A],A===void 0?m.push(S):A!==S&&(S.then(ef,ef),S=A),S.status){case"fulfilled":return S.value;case"rejected":throw m=S.reason,nf(m),m;default:if(typeof S.status=="string")S.then(ef,ef);else{if(m=F,m!==null&&100<m.shellSuspendCounter)throw Error(r(482));m=S,m.status="pending",m.then(function(L){if(S.status==="pending"){var ee=S;ee.status="fulfilled",ee.value=L}},function(L){if(S.status==="pending"){var ee=S;ee.status="rejected",ee.reason=L}})}switch(S.status){case"fulfilled":return S.value;case"rejected":throw m=S.reason,nf(m),m}throw Co=S,Id}}var Co=null;function tf(){if(Co===null)throw Error(r(459));var m=Co;return Co=null,m}function nf(m){if(m===Id||m===eo)throw Error(r(483))}var Mo=!1;function em(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jr(m,S){m=m.updateQueue,S.updateQueue===m&&(S.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,callbacks:null})}function Au(m){return{lane:m,tag:0,payload:null,callback:null,next:null}}function Pf(m,S,A){var L=m.updateQueue;if(L===null)return null;if(L=L.shared,(k&2)!==0){var ee=L.pending;return ee===null?S.next=S:(S.next=ee.next,ee.next=S),L.pending=S,S=Of(m),ag(m,null,A),S}return Ki(m,L,S,A),Of(m)}function Zh(m,S,A){if(S=S.updateQueue,S!==null&&(S=S.shared,(A&4194048)!==0)){var L=S.lanes;L&=m.pendingLanes,A|=L,S.lanes=A,ht(m,A)}}function Qh(m,S){var A=m.updateQueue,L=m.alternate;if(L!==null&&(L=L.updateQueue,A===L)){var ee=null,fe=null;if(A=A.firstBaseUpdate,A!==null){do{var He={lane:A.lane,tag:A.tag,payload:A.payload,callback:null,next:null};fe===null?ee=fe=He:fe=fe.next=He,A=A.next}while(A!==null);fe===null?ee=fe=S:fe=fe.next=S}else ee=fe=S;A={baseState:L.baseState,firstBaseUpdate:ee,lastBaseUpdate:fe,shared:L.shared,callbacks:L.callbacks},m.updateQueue=A;return}m=A.lastBaseUpdate,m===null?A.firstBaseUpdate=S:m.next=S,A.lastBaseUpdate=S}var kl=!1;function Hs(){if(kl){var m=Ml;if(m!==null)throw m}}function Ol(m,S,A,L){kl=!1;var ee=m.updateQueue;Mo=!1;var fe=ee.firstBaseUpdate,He=ee.lastBaseUpdate,Je=ee.shared.pending;if(Je!==null){ee.shared.pending=null;var St=Je,Jt=St.next;St.next=null,He===null?fe=Jt:He.next=Jt,He=St;var vn=m.alternate;vn!==null&&(vn=vn.updateQueue,Je=vn.lastBaseUpdate,Je!==He&&(Je===null?vn.firstBaseUpdate=Jt:Je.next=Jt,vn.lastBaseUpdate=St))}if(fe!==null){var xn=ee.baseState;He=0,vn=Jt=St=null,Je=fe;do{var rn=Je.lane&-536870913,on=rn!==Je.lane;if(on?(pe&rn)===rn:(L&rn)===rn){rn!==0&&rn===Fr&&(kl=!0),vn!==null&&(vn=vn.next={lane:0,tag:Je.tag,payload:Je.payload,callback:null,next:null});e:{var Mi=m,fi=Je;rn=S;var Yo=A;switch(fi.tag){case 1:if(Mi=fi.payload,typeof Mi=="function"){xn=Mi.call(Yo,xn,rn);break e}xn=Mi;break e;case 3:Mi.flags=Mi.flags&-65537|128;case 0:if(Mi=fi.payload,rn=typeof Mi=="function"?Mi.call(Yo,xn,rn):Mi,rn==null)break e;xn=u({},xn,rn);break e;case 2:Mo=!0}}rn=Je.callback,rn!==null&&(m.flags|=64,on&&(m.flags|=8192),on=ee.callbacks,on===null?ee.callbacks=[rn]:on.push(rn))}else on={lane:rn,tag:Je.tag,payload:Je.payload,callback:Je.callback,next:null},vn===null?(Jt=vn=on,St=xn):vn=vn.next=on,He|=rn;if(Je=Je.next,Je===null){if(Je=ee.shared.pending,Je===null)break;on=Je,Je=on.next,on.next=null,ee.lastBaseUpdate=on,ee.shared.pending=null}}while(!0);vn===null&&(St=xn),ee.baseState=St,ee.firstBaseUpdate=Jt,ee.lastBaseUpdate=vn,fe===null&&(ee.shared.lanes=0),Pt|=He,m.lanes=He,m.memoizedState=xn}}function Qc(m,S){if(typeof m!="function")throw Error(r(191,m));m.call(S)}function Nd(m,S){var A=m.callbacks;if(A!==null)for(m.callbacks=null,m=0;m<A.length;m++)Qc(A[m],S)}var Pd=K(null),tm=K(0);function Jh(m,S){m=dt,le(tm,m),le(Pd,S),dt=m|S.baseLanes}function Cu(){le(tm,dt),le(Pd,Pd.current)}function cl(){dt=tm.current,ne(Pd),ne(tm)}var rf=0,Kr=null,fs=null,Ha=null,ed=!1,Mu=!1,ul=!1,to=0,fc=0,jo=null,Zg=0;function Da(){throw Error(r(321))}function Zs(m,S){if(S===null)return!1;for(var A=0;A<S.length&&A<m.length;A++)if(!uo(m[A],S[A]))return!1;return!0}function no(m,S,A,L,ee,fe){return rf=fe,Kr=S,S.memoizedState=null,S.updateQueue=null,S.lanes=0,W.H=m===null||m.memoizedState===null?bp:t_,ul=!1,fe=A(L,ee),ul=!1,Mu&&(fe=nd(S,A,L,ee)),td(m),fe}function td(m){W.H=sd;var S=fs!==null&&fs.next!==null;if(rf=0,Ha=fs=Kr=null,ed=!1,fc=0,jo=null,S)throw Error(r(300));m===null||Va||(m=m.dependencies,m!==null&&Xh(m)&&(Va=!0))}function nd(m,S,A,L){Kr=m;var ee=0;do{if(Mu&&(jo=null),fc=0,Mu=!1,25<=ee)throw Error(r(301));if(ee+=1,Ha=fs=null,m.updateQueue!=null){var fe=m.updateQueue;fe.lastEffect=null,fe.events=null,fe.stores=null,fe.memoCache!=null&&(fe.memoCache.index=0)}W.H=Z_,fe=S(A,L)}while(Mu);return fe}function _p(){var m=W.H,S=m.useState()[0];return S=typeof S.then=="function"?dr(S):S,m=m.useState()[0],(fs!==null?fs.memoizedState:null)!==m&&(Kr.flags|=1024),S}function fl(){var m=to!==0;return to=0,m}function Kl(m,S,A){S.updateQueue=m.updateQueue,S.flags&=-2053,m.lanes&=~A}function vp(m){if(ed){for(m=m.memoizedState;m!==null;){var S=m.queue;S!==null&&(S.pending=null),m=m.next}ed=!1}rf=0,Ha=fs=Kr=null,Mu=!1,fc=to=0,jo=null}function hl(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ha===null?Kr.memoizedState=Ha=m:Ha=Ha.next=m,Ha}function ia(){if(fs===null){var m=Kr.alternate;m=m!==null?m.memoizedState:null}else m=fs.next;var S=Ha===null?Kr.memoizedState:Ha.next;if(S!==null)Ha=S,fs=m;else{if(m===null)throw Kr.alternate===null?Error(r(467)):Error(r(310));fs=m,m={memoizedState:fs.memoizedState,baseState:fs.baseState,baseQueue:fs.baseQueue,queue:fs.queue,next:null},Ha===null?Kr.memoizedState=Ha=m:Ha=Ha.next=m}return Ha}function hc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function dr(m){var S=fc;return fc+=1,jo===null&&(jo=[]),m=Ru(jo,m,S),S=Kr,(Ha===null?S.memoizedState:Ha.next)===null&&(S=S.alternate,W.H=S===null||S.memoizedState===null?bp:t_),m}function br(m){if(m!==null&&typeof m=="object"){if(typeof m.then=="function")return dr(m);if(m.$$typeof===E)return Na(m)}throw Error(r(438,String(m)))}function rd(m){var S=null,A=Kr.updateQueue;if(A!==null&&(S=A.memoCache),S==null){var L=Kr.alternate;L!==null&&(L=L.updateQueue,L!==null&&(L=L.memoCache,L!=null&&(S={data:L.data.map(function(ee){return ee.slice()}),index:0})))}if(S==null&&(S={data:[],index:0}),A===null&&(A=hc(),Kr.updateQueue=A),A.memoCache=S,A=S.data[S.index],A===void 0)for(A=S.data[S.index]=Array(m),L=0;L<m;L++)A[L]=G;return S.index++,A}function mo(m,S){return typeof S=="function"?S(m):S}function Zl(m){var S=ia();return yp(S,fs,m)}function yp(m,S,A){var L=m.queue;if(L===null)throw Error(r(311));L.lastRenderedReducer=A;var ee=m.baseQueue,fe=L.pending;if(fe!==null){if(ee!==null){var He=ee.next;ee.next=fe.next,fe.next=He}S.baseQueue=ee=fe,L.pending=null}if(fe=m.baseState,ee===null)m.memoizedState=fe;else{S=ee.next;var Je=He=null,St=null,Jt=S,vn=!1;do{var xn=Jt.lane&-536870913;if(xn!==Jt.lane?(pe&xn)===xn:(rf&xn)===xn){var rn=Jt.revertLane;if(rn===0)St!==null&&(St=St.next={lane:0,revertLane:0,action:Jt.action,hasEagerState:Jt.hasEagerState,eagerState:Jt.eagerState,next:null}),xn===Fr&&(vn=!0);else if((rf&rn)===rn){Jt=Jt.next,rn===Fr&&(vn=!0);continue}else xn={lane:0,revertLane:Jt.revertLane,action:Jt.action,hasEagerState:Jt.hasEagerState,eagerState:Jt.eagerState,next:null},St===null?(Je=St=xn,He=fe):St=St.next=xn,Kr.lanes|=rn,Pt|=rn;xn=Jt.action,ul&&A(fe,xn),fe=Jt.hasEagerState?Jt.eagerState:A(fe,xn)}else rn={lane:xn,revertLane:Jt.revertLane,action:Jt.action,hasEagerState:Jt.hasEagerState,eagerState:Jt.eagerState,next:null},St===null?(Je=St=rn,He=fe):St=St.next=rn,Kr.lanes|=xn,Pt|=xn;Jt=Jt.next}while(Jt!==null&&Jt!==S);if(St===null?He=fe:St.next=Je,!uo(fe,m.memoizedState)&&(Va=!0,vn&&(A=Ml,A!==null)))throw A;m.memoizedState=fe,m.baseState=He,m.baseQueue=St,L.lastRenderedState=fe}return ee===null&&(L.lanes=0),[m.memoizedState,L.dispatch]}function Ho(m){var S=ia(),A=S.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=m;var L=A.dispatch,ee=A.pending,fe=S.memoizedState;if(ee!==null){A.pending=null;var He=ee=ee.next;do fe=m(fe,He.action),He=He.next;while(He!==ee);uo(fe,S.memoizedState)||(Va=!0),S.memoizedState=fe,S.baseQueue===null&&(S.baseState=fe),A.lastRenderedState=fe}return[fe,L]}function dl(m,S,A){var L=Kr,ee=ia(),fe=ei;if(fe){if(A===void 0)throw Error(r(407));A=A()}else A=S();var He=!uo((fs||ee).memoizedState,A);He&&(ee.memoizedState=A,Va=!0),ee=ee.queue;var Je=sf.bind(null,L,ee,m);if(Lc(2048,8,Je,[m]),ee.getSnapshot!==S||He||Ha!==null&&Ha.memoizedState.tag&1){if(L.flags|=2048,Df(9,Bd(),Qg.bind(null,L,ee,A,S),null),F===null)throw Error(r(349));fe||(rf&124)!==0||id(L,S,A)}return A}function id(m,S,A){m.flags|=16384,m={getSnapshot:S,value:A},S=Kr.updateQueue,S===null?(S=hc(),Kr.updateQueue=S,S.stores=[m]):(A=S.stores,A===null?S.stores=[m]:A.push(m))}function Qg(m,S,A,L){S.value=A,S.getSnapshot=L,La(S)&&qo(m)}function sf(m,S,A){return A(function(){La(S)&&qo(m)})}function La(m){var S=m.getSnapshot;m=m.value;try{var A=S();return!uo(m,A)}catch{return!0}}function qo(m){var S=Ei(m,2);S!==null&&li(S,m,2)}function Dd(m){var S=hl();if(typeof m=="function"){var A=m;if(m=A(),ul){kt(!0);try{A()}finally{kt(!1)}}}return S.memoizedState=S.baseState=m,S.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:m},S}function lg(m,S,A,L){return m.baseState=A,yp(m,fs,typeof L=="function"?L:mo)}function nm(m,S,A,L,ee){if(l0(m))throw Error(r(485));if(m=S.action,m!==null){var fe={payload:ee,action:m,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(He){fe.listeners.push(He)}};W.T!==null?A(!0):fe.isTransition=!1,L(fe),A=S.pending,A===null?(fe.next=S.pending=fe,qa(S,fe)):(fe.next=A.next,S.pending=A.next=fe)}}function qa(m,S){var A=S.action,L=S.payload,ee=m.state;if(S.isTransition){var fe=W.T,He={};W.T=He;try{var Je=A(ee,L),St=W.S;St!==null&&St(He,Je),rm(m,S,Je)}catch(Jt){im(m,S,Jt)}finally{W.T=fe}}else try{fe=A(ee,L),rm(m,S,fe)}catch(Jt){im(m,S,Jt)}}function rm(m,S,A){A!==null&&typeof A=="object"&&typeof A.then=="function"?A.then(function(L){Jg(m,S,L)},function(L){return im(m,S,L)}):Jg(m,S,A)}function Jg(m,S,A){S.status="fulfilled",S.value=A,sm(S),m.state=A,S=m.pending,S!==null&&(A=S.next,A===S?m.pending=null:(A=A.next,S.next=A,qa(m,A)))}function im(m,S,A){var L=m.pending;if(m.pending=null,L!==null){L=L.next;do S.status="rejected",S.reason=A,sm(S),S=S.next;while(S!==L)}m.action=null}function sm(m){m=m.listeners;for(var S=0;S<m.length;S++)(0,m[S])()}function Ld(m,S){return S}function Ud(m,S){if(ei){var A=F.formState;if(A!==null){e:{var L=Kr;if(ei){if(As){t:{for(var ee=As,fe=gi;ee.nodeType!==8;){if(!fe){ee=null;break t}if(ee=i_(ee.nextSibling),ee===null){ee=null;break t}}fe=ee.data,ee=fe==="F!"||fe==="F"?ee:null}if(ee){As=i_(ee.nextSibling),L=ee.data==="F!";break e}}Yh(L)}L=!1}L&&(S=A[0])}}return A=hl(),A.memoizedState=A.baseState=S,L={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ld,lastRenderedState:S},A.queue=L,A=X_.bind(null,Kr,L),L.dispatch=A,L=Dd(!1),fe=pg.bind(null,Kr,!1,L.queue),L=hl(),ee={state:S,dispatch:null,action:m,pending:null},L.queue=ee,A=nm.bind(null,Kr,ee,fe,A),ee.dispatch=A,L.memoizedState=m,[S,A,!1]}function ku(m){var S=ia();return cg(S,fs,m)}function cg(m,S,A){if(S=yp(m,S,Ld)[0],m=Zl(mo)[0],typeof S=="object"&&S!==null&&typeof S.then=="function")try{var L=dr(S)}catch(He){throw He===Id?eo:He}else L=S;S=ia();var ee=S.queue,fe=ee.dispatch;return A!==S.memoizedState&&(Kr.flags|=2048,Df(9,Bd(),Z0.bind(null,ee,A),null)),[L,fe,m]}function Z0(m,S){m.action=S}function am(m){var S=ia(),A=fs;if(A!==null)return cg(S,A,m);ia(),S=S.memoizedState,A=ia();var L=A.queue.dispatch;return A.memoizedState=m,[S,L,!1]}function Df(m,S,A,L){return m={tag:m,create:A,deps:L,inst:S,next:null},S=Kr.updateQueue,S===null&&(S=hc(),Kr.updateQueue=S),A=S.lastEffect,A===null?S.lastEffect=m.next=m:(L=A.next,A.next=m,m.next=L,S.lastEffect=m),m}function Bd(){return{destroy:void 0,resource:void 0}}function Ou(){return ia().memoizedState}function pl(m,S,A,L){var ee=hl();L=L===void 0?null:L,Kr.flags|=m,ee.memoizedState=Df(1|S,Bd(),A,L)}function Lc(m,S,A,L){var ee=ia();L=L===void 0?null:L;var fe=ee.memoizedState.inst;fs!==null&&L!==null&&Zs(L,fs.memoizedState.deps)?ee.memoizedState=Df(S,fe,A,L):(Kr.flags|=m,ee.memoizedState=Df(1|S,fe,A,L))}function om(m,S){pl(8390656,8,m,S)}function e0(m,S){Lc(2048,8,m,S)}function lm(m,S){return Lc(4,2,m,S)}function ug(m,S){return Lc(4,4,m,S)}function t0(m,S){if(typeof S=="function"){m=m();var A=S(m);return function(){typeof A=="function"?A():S(null)}}if(S!=null)return m=m(),S.current=m,function(){S.current=null}}function n0(m,S,A){A=A!=null?A.concat([m]):null,Lc(4,4,t0.bind(null,S,m),A)}function cm(){}function Q0(m,S){var A=ia();S=S===void 0?null:S;var L=A.memoizedState;return S!==null&&Zs(S,L[1])?L[0]:(A.memoizedState=[m,S],m)}function um(m,S){var A=ia();S=S===void 0?null:S;var L=A.memoizedState;if(S!==null&&Zs(S,L[1]))return L[0];if(L=m(),ul){kt(!0);try{m()}finally{kt(!1)}}return A.memoizedState=[L,S],L}function r0(m,S,A){return A===void 0||(rf&1073741824)!==0?m.memoizedState=S:(m.memoizedState=A,m=bs(),Kr.lanes|=m,Pt|=m,A)}function Iu(m,S,A,L){return uo(A,S)?A:Pd.current!==null?(m=r0(m,A,L),uo(m,S)||(Va=!0),m):(rf&42)===0?(Va=!0,m.memoizedState=A):(m=bs(),Kr.lanes|=m,Pt|=m,S)}function Ql(m,S,A,L,ee){var fe=q.p;q.p=fe!==0&&8>fe?fe:8;var He=W.T,Je={};W.T=Je,pg(m,!1,S,A);try{var St=ee(),Jt=W.S;if(Jt!==null&&Jt(Je,St),St!==null&&typeof St=="object"&&typeof St.then=="function"){var vn=gp(St,L);dg(m,S,vn,Wr(m))}else dg(m,S,L,Wr(m))}catch(xn){dg(m,S,{then:function(){},status:"rejected",reason:xn},Wr())}finally{q.p=fe,W.T=He}}function fg(){}function hg(m,S,A,L){if(m.tag!==5)throw Error(r(476));var ee=i0(m).queue;Ql(m,ee,S,Y,A===null?fg:function(){return s0(m),A(L)})}function i0(m){var S=m.memoizedState;if(S!==null)return S;S={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:Y},next:null};var A={};return S.next={memoizedState:A,baseState:A,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:mo,lastRenderedState:A},next:null},m.memoizedState=S,m=m.alternate,m!==null&&(m.memoizedState=S),S}function s0(m){var S=i0(m).next.queue;dg(m,S,{},Wr())}function J0(){return Na(yR)}function Y_(){return ia().memoizedState}function a0(){return ia().memoizedState}function o0(m){for(var S=m.return;S!==null;){switch(S.tag){case 24:case 3:var A=Wr();m=Au(A);var L=Pf(S,m,A);L!==null&&(li(L,S,A),Zh(L,S,A)),S={cache:ol()},m.payload=S;return}S=S.return}}function e_(m,S,A){var L=Wr();A={lane:L,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null},l0(m)?K_(S,A):(A=hn(m,S,A,L),A!==null&&(li(A,m,L),Jc(A,S,L)))}function X_(m,S,A){var L=Wr();dg(m,S,A,L)}function dg(m,S,A,L){var ee={lane:L,revertLane:0,action:A,hasEagerState:!1,eagerState:null,next:null};if(l0(m))K_(S,ee);else{var fe=m.alternate;if(m.lanes===0&&(fe===null||fe.lanes===0)&&(fe=S.lastRenderedReducer,fe!==null))try{var He=S.lastRenderedState,Je=fe(He,A);if(ee.hasEagerState=!0,ee.eagerState=Je,uo(Je,He))return Ki(m,S,ee,0),F===null&&ho(),!1}catch{}finally{}if(A=hn(m,S,ee,L),A!==null)return li(A,m,L),Jc(A,S,L),!0}return!1}function pg(m,S,A,L){if(L={lane:2,revertLane:u5(),action:L,hasEagerState:!1,eagerState:null,next:null},l0(m)){if(S)throw Error(r(479))}else S=hn(m,A,L,2),S!==null&&li(S,m,2)}function l0(m){var S=m.alternate;return m===Kr||S!==null&&S===Kr}function K_(m,S){Mu=ed=!0;var A=m.pending;A===null?S.next=S:(S.next=A.next,A.next=S),m.pending=S}function Jc(m,S,A){if((A&4194048)!==0){var L=S.lanes;L&=m.pendingLanes,A|=L,S.lanes=A,ht(m,A)}}var sd={readContext:Na,use:br,useCallback:Da,useContext:Da,useEffect:Da,useImperativeHandle:Da,useLayoutEffect:Da,useInsertionEffect:Da,useMemo:Da,useReducer:Da,useRef:Da,useState:Da,useDebugValue:Da,useDeferredValue:Da,useTransition:Da,useSyncExternalStore:Da,useId:Da,useHostTransitionStatus:Da,useFormState:Da,useActionState:Da,useOptimistic:Da,useMemoCache:Da,useCacheRefresh:Da},bp={readContext:Na,use:br,useCallback:function(m,S){return hl().memoizedState=[m,S===void 0?null:S],m},useContext:Na,useEffect:om,useImperativeHandle:function(m,S,A){A=A!=null?A.concat([m]):null,pl(4194308,4,t0.bind(null,S,m),A)},useLayoutEffect:function(m,S){return pl(4194308,4,m,S)},useInsertionEffect:function(m,S){pl(4,2,m,S)},useMemo:function(m,S){var A=hl();S=S===void 0?null:S;var L=m();if(ul){kt(!0);try{m()}finally{kt(!1)}}return A.memoizedState=[L,S],L},useReducer:function(m,S,A){var L=hl();if(A!==void 0){var ee=A(S);if(ul){kt(!0);try{A(S)}finally{kt(!1)}}}else ee=S;return L.memoizedState=L.baseState=ee,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:ee},L.queue=m,m=m.dispatch=e_.bind(null,Kr,m),[L.memoizedState,m]},useRef:function(m){var S=hl();return m={current:m},S.memoizedState=m},useState:function(m){m=Dd(m);var S=m.queue,A=X_.bind(null,Kr,S);return S.dispatch=A,[m.memoizedState,A]},useDebugValue:cm,useDeferredValue:function(m,S){var A=hl();return r0(A,m,S)},useTransition:function(){var m=Dd(!1);return m=Ql.bind(null,Kr,m.queue,!0,!1),hl().memoizedState=m,[!1,m]},useSyncExternalStore:function(m,S,A){var L=Kr,ee=hl();if(ei){if(A===void 0)throw Error(r(407));A=A()}else{if(A=S(),F===null)throw Error(r(349));(pe&124)!==0||id(L,S,A)}ee.memoizedState=A;var fe={value:A,getSnapshot:S};return ee.queue=fe,om(sf.bind(null,L,fe,m),[m]),L.flags|=2048,Df(9,Bd(),Qg.bind(null,L,fe,A,S),null),A},useId:function(){var m=hl(),S=F.identifierPrefix;if(ei){var A=Tu,L=Wl;A=(L&~(1<<32-Ut(L)-1)).toString(32)+A,S=""+S+"R"+A,A=to++,0<A&&(S+="H"+A.toString(32)),S+=""}else A=Zg++,S=""+S+"r"+A.toString(32)+"";return m.memoizedState=S},useHostTransitionStatus:J0,useFormState:Ud,useActionState:Ud,useOptimistic:function(m){var S=hl();S.memoizedState=S.baseState=m;var A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return S.queue=A,S=pg.bind(null,Kr,!0,A),A.dispatch=S,[m,S]},useMemoCache:rd,useCacheRefresh:function(){return hl().memoizedState=o0.bind(null,Kr)}},t_={readContext:Na,use:br,useCallback:Q0,useContext:Na,useEffect:e0,useImperativeHandle:n0,useInsertionEffect:lm,useLayoutEffect:ug,useMemo:um,useReducer:Zl,useRef:Ou,useState:function(){return Zl(mo)},useDebugValue:cm,useDeferredValue:function(m,S){var A=ia();return Iu(A,fs.memoizedState,m,S)},useTransition:function(){var m=Zl(mo)[0],S=ia().memoizedState;return[typeof m=="boolean"?m:dr(m),S]},useSyncExternalStore:dl,useId:Y_,useHostTransitionStatus:J0,useFormState:ku,useActionState:ku,useOptimistic:function(m,S){var A=ia();return lg(A,fs,m,S)},useMemoCache:rd,useCacheRefresh:a0},Z_={readContext:Na,use:br,useCallback:Q0,useContext:Na,useEffect:e0,useImperativeHandle:n0,useInsertionEffect:lm,useLayoutEffect:ug,useMemo:um,useReducer:Ho,useRef:Ou,useState:function(){return Ho(mo)},useDebugValue:cm,useDeferredValue:function(m,S){var A=ia();return fs===null?r0(A,m,S):Iu(A,fs.memoizedState,m,S)},useTransition:function(){var m=Ho(mo)[0],S=ia().memoizedState;return[typeof m=="boolean"?m:dr(m),S]},useSyncExternalStore:dl,useId:Y_,useHostTransitionStatus:J0,useFormState:am,useActionState:am,useOptimistic:function(m,S){var A=ia();return fs!==null?lg(A,fs,m,S):(A.baseState=m,[m,A.queue.dispatch])},useMemoCache:rd,useCacheRefresh:a0},Sp=null,fm=0;function Fd(m){var S=fm;return fm+=1,Sp===null&&(Sp=[]),Ru(Sp,m,S)}function gh(m,S){S=S.props.ref,m.ref=S!==void 0?S:null}function Jl(m,S){throw S.$$typeof===f?Error(r(525)):(m=Object.prototype.toString.call(S),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":m)))}function Nu(m){var S=m._init;return S(m._payload)}function Cs(m){function S(Ht,Nt){if(m){var Xt=Ht.deletions;Xt===null?(Ht.deletions=[Nt],Ht.flags|=16):Xt.push(Nt)}}function A(Ht,Nt){if(!m)return null;for(;Nt!==null;)S(Ht,Nt),Nt=Nt.sibling;return null}function L(Ht){for(var Nt=new Map;Ht!==null;)Ht.key!==null?Nt.set(Ht.key,Ht):Nt.set(Ht.index,Ht),Ht=Ht.sibling;return Nt}function ee(Ht,Nt){return Ht=ga(Ht,Nt),Ht.index=0,Ht.sibling=null,Ht}function fe(Ht,Nt,Xt){return Ht.index=Xt,m?(Xt=Ht.alternate,Xt!==null?(Xt=Xt.index,Xt<Nt?(Ht.flags|=67108866,Nt):Xt):(Ht.flags|=67108866,Nt)):(Ht.flags|=1048576,Nt)}function He(Ht){return m&&Ht.alternate===null&&(Ht.flags|=67108866),Ht}function Je(Ht,Nt,Xt,bn){return Nt===null||Nt.tag!==6?(Nt=dh(Xt,Ht.mode,bn),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt),Nt.return=Ht,Nt)}function St(Ht,Nt,Xt,bn){var kr=Xt.type;return kr===p?vn(Ht,Nt,Xt.props.children,bn,Xt.key):Nt!==null&&(Nt.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===D&&Nu(kr)===Nt.type)?(Nt=ee(Nt,Xt.props),gh(Nt,Xt),Nt.return=Ht,Nt):(Nt=wo(Xt.type,Xt.key,Xt.props,null,Ht.mode,bn),gh(Nt,Xt),Nt.return=Ht,Nt)}function Jt(Ht,Nt,Xt,bn){return Nt===null||Nt.tag!==4||Nt.stateNode.containerInfo!==Xt.containerInfo||Nt.stateNode.implementation!==Xt.implementation?(Nt=Al(Xt,Ht.mode,bn),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt.children||[]),Nt.return=Ht,Nt)}function vn(Ht,Nt,Xt,bn,kr){return Nt===null||Nt.tag!==7?(Nt=Ia(Xt,Ht.mode,bn,kr),Nt.return=Ht,Nt):(Nt=ee(Nt,Xt),Nt.return=Ht,Nt)}function xn(Ht,Nt,Xt){if(typeof Nt=="string"&&Nt!==""||typeof Nt=="number"||typeof Nt=="bigint")return Nt=dh(""+Nt,Ht.mode,Xt),Nt.return=Ht,Nt;if(typeof Nt=="object"&&Nt!==null){switch(Nt.$$typeof){case d:return Xt=wo(Nt.type,Nt.key,Nt.props,null,Ht.mode,Xt),gh(Xt,Nt),Xt.return=Ht,Xt;case g:return Nt=Al(Nt,Ht.mode,Xt),Nt.return=Ht,Nt;case D:var bn=Nt._init;return Nt=bn(Nt._payload),xn(Ht,Nt,Xt)}if(J(Nt)||B(Nt))return Nt=Ia(Nt,Ht.mode,Xt,null),Nt.return=Ht,Nt;if(typeof Nt.then=="function")return xn(Ht,Fd(Nt),Xt);if(Nt.$$typeof===E)return xn(Ht,Kh(Ht,Nt),Xt);Jl(Ht,Nt)}return null}function rn(Ht,Nt,Xt,bn){var kr=Nt!==null?Nt.key:null;if(typeof Xt=="string"&&Xt!==""||typeof Xt=="number"||typeof Xt=="bigint")return kr!==null?null:Je(Ht,Nt,""+Xt,bn);if(typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case d:return Xt.key===kr?St(Ht,Nt,Xt,bn):null;case g:return Xt.key===kr?Jt(Ht,Nt,Xt,bn):null;case D:return kr=Xt._init,Xt=kr(Xt._payload),rn(Ht,Nt,Xt,bn)}if(J(Xt)||B(Xt))return kr!==null?null:vn(Ht,Nt,Xt,bn,null);if(typeof Xt.then=="function")return rn(Ht,Nt,Fd(Xt),bn);if(Xt.$$typeof===E)return rn(Ht,Nt,Kh(Ht,Xt),bn);Jl(Ht,Xt)}return null}function on(Ht,Nt,Xt,bn,kr){if(typeof bn=="string"&&bn!==""||typeof bn=="number"||typeof bn=="bigint")return Ht=Ht.get(Xt)||null,Je(Nt,Ht,""+bn,kr);if(typeof bn=="object"&&bn!==null){switch(bn.$$typeof){case d:return Ht=Ht.get(bn.key===null?Xt:bn.key)||null,St(Nt,Ht,bn,kr);case g:return Ht=Ht.get(bn.key===null?Xt:bn.key)||null,Jt(Nt,Ht,bn,kr);case D:var $s=bn._init;return bn=$s(bn._payload),on(Ht,Nt,Xt,bn,kr)}if(J(bn)||B(bn))return Ht=Ht.get(Xt)||null,vn(Nt,Ht,bn,kr,null);if(typeof bn.then=="function")return on(Ht,Nt,Xt,Fd(bn),kr);if(bn.$$typeof===E)return on(Ht,Nt,Xt,Kh(Nt,bn),kr);Jl(Nt,bn)}return null}function Mi(Ht,Nt,Xt,bn){for(var kr=null,$s=null,Gr=Nt,vi=Nt=0,Eh=null;Gr!==null&&vi<Xt.length;vi++){Gr.index>vi?(Eh=Gr,Gr=null):Eh=Gr.sibling;var Ya=rn(Ht,Gr,Xt[vi],bn);if(Ya===null){Gr===null&&(Gr=Eh);break}m&&Gr&&Ya.alternate===null&&S(Ht,Gr),Nt=fe(Ya,Nt,vi),$s===null?kr=Ya:$s.sibling=Ya,$s=Ya,Gr=Eh}if(vi===Xt.length)return A(Ht,Gr),ei&&si(Ht,vi),kr;if(Gr===null){for(;vi<Xt.length;vi++)Gr=xn(Ht,Xt[vi],bn),Gr!==null&&(Nt=fe(Gr,Nt,vi),$s===null?kr=Gr:$s.sibling=Gr,$s=Gr);return ei&&si(Ht,vi),kr}for(Gr=L(Gr);vi<Xt.length;vi++)Eh=on(Gr,Ht,vi,Xt[vi],bn),Eh!==null&&(m&&Eh.alternate!==null&&Gr.delete(Eh.key===null?vi:Eh.key),Nt=fe(Eh,Nt,vi),$s===null?kr=Eh:$s.sibling=Eh,$s=Eh);return m&&Gr.forEach(function(Ib){return S(Ht,Ib)}),ei&&si(Ht,vi),kr}function fi(Ht,Nt,Xt,bn){if(Xt==null)throw Error(r(151));for(var kr=null,$s=null,Gr=Nt,vi=Nt=0,Eh=null,Ya=Xt.next();Gr!==null&&!Ya.done;vi++,Ya=Xt.next()){Gr.index>vi?(Eh=Gr,Gr=null):Eh=Gr.sibling;var Ib=rn(Ht,Gr,Ya.value,bn);if(Ib===null){Gr===null&&(Gr=Eh);break}m&&Gr&&Ib.alternate===null&&S(Ht,Gr),Nt=fe(Ib,Nt,vi),$s===null?kr=Ib:$s.sibling=Ib,$s=Ib,Gr=Eh}if(Ya.done)return A(Ht,Gr),ei&&si(Ht,vi),kr;if(Gr===null){for(;!Ya.done;vi++,Ya=Xt.next())Ya=xn(Ht,Ya.value,bn),Ya!==null&&(Nt=fe(Ya,Nt,vi),$s===null?kr=Ya:$s.sibling=Ya,$s=Ya);return ei&&si(Ht,vi),kr}for(Gr=L(Gr);!Ya.done;vi++,Ya=Xt.next())Ya=on(Gr,Ht,vi,Ya.value,bn),Ya!==null&&(m&&Ya.alternate!==null&&Gr.delete(Ya.key===null?vi:Ya.key),Nt=fe(Ya,Nt,vi),$s===null?kr=Ya:$s.sibling=Ya,$s=Ya);return m&&Gr.forEach(function(oSe){return S(Ht,oSe)}),ei&&si(Ht,vi),kr}function Yo(Ht,Nt,Xt,bn){if(typeof Xt=="object"&&Xt!==null&&Xt.type===p&&Xt.key===null&&(Xt=Xt.props.children),typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case d:e:{for(var kr=Xt.key;Nt!==null;){if(Nt.key===kr){if(kr=Xt.type,kr===p){if(Nt.tag===7){A(Ht,Nt.sibling),bn=ee(Nt,Xt.props.children),bn.return=Ht,Ht=bn;break e}}else if(Nt.elementType===kr||typeof kr=="object"&&kr!==null&&kr.$$typeof===D&&Nu(kr)===Nt.type){A(Ht,Nt.sibling),bn=ee(Nt,Xt.props),gh(bn,Xt),bn.return=Ht,Ht=bn;break e}A(Ht,Nt);break}else S(Ht,Nt);Nt=Nt.sibling}Xt.type===p?(bn=Ia(Xt.props.children,Ht.mode,bn,Xt.key),bn.return=Ht,Ht=bn):(bn=wo(Xt.type,Xt.key,Xt.props,null,Ht.mode,bn),gh(bn,Xt),bn.return=Ht,Ht=bn)}return He(Ht);case g:e:{for(kr=Xt.key;Nt!==null;){if(Nt.key===kr)if(Nt.tag===4&&Nt.stateNode.containerInfo===Xt.containerInfo&&Nt.stateNode.implementation===Xt.implementation){A(Ht,Nt.sibling),bn=ee(Nt,Xt.children||[]),bn.return=Ht,Ht=bn;break e}else{A(Ht,Nt);break}else S(Ht,Nt);Nt=Nt.sibling}bn=Al(Xt,Ht.mode,bn),bn.return=Ht,Ht=bn}return He(Ht);case D:return kr=Xt._init,Xt=kr(Xt._payload),Yo(Ht,Nt,Xt,bn)}if(J(Xt))return Mi(Ht,Nt,Xt,bn);if(B(Xt)){if(kr=B(Xt),typeof kr!="function")throw Error(r(150));return Xt=kr.call(Xt),fi(Ht,Nt,Xt,bn)}if(typeof Xt.then=="function")return Yo(Ht,Nt,Fd(Xt),bn);if(Xt.$$typeof===E)return Yo(Ht,Nt,Kh(Ht,Xt),bn);Jl(Ht,Xt)}return typeof Xt=="string"&&Xt!==""||typeof Xt=="number"||typeof Xt=="bigint"?(Xt=""+Xt,Nt!==null&&Nt.tag===6?(A(Ht,Nt.sibling),bn=ee(Nt,Xt),bn.return=Ht,Ht=bn):(A(Ht,Nt),bn=dh(Xt,Ht.mode,bn),bn.return=Ht,Ht=bn),He(Ht)):A(Ht,Nt)}return function(Ht,Nt,Xt,bn){try{fm=0;var kr=Yo(Ht,Nt,Xt,bn);return Sp=null,kr}catch(Gr){if(Gr===Id||Gr===eo)throw Gr;var $s=To(29,Gr,null,Ht.mode);return $s.lanes=bn,$s.return=Ht,$s}finally{}}}var _h=Cs(!0),n_=Cs(!1),qs=K(null),dc=null;function Lf(m){var S=m.alternate;le(go,go.current&1),le(qs,m),dc===null&&(S===null||Pd.current!==null||S.memoizedState!==null)&&(dc=m)}function mg(m){if(m.tag===22){if(le(go,go.current),le(qs,m),dc===null){var S=m.alternate;S!==null&&S.memoizedState!==null&&(dc=m)}}else Uf()}function Uf(){le(go,go.current),le(qs,qs.current)}function af(m){ne(qs),dc===m&&(dc=null),ne(go)}var go=K(0);function ad(m){for(var S=m;S!==null;){if(S.tag===13){var A=S.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||E5(A)))return S}else if(S.tag===19&&S.memoizedProps.revealOrder!==void 0){if((S.flags&128)!==0)return S}else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===m)break;for(;S.sibling===null;){if(S.return===null||S.return===m)return null;S=S.return}S.sibling.return=S.return,S=S.sibling}return null}function Bf(m,S,A,L){S=m.memoizedState,A=A(L,S),A=A==null?S:u({},S,A),m.memoizedState=A,m.lanes===0&&(m.updateQueue.baseState=A)}var ro={enqueueSetState:function(m,S,A){m=m._reactInternals;var L=Wr(),ee=Au(L);ee.payload=S,A!=null&&(ee.callback=A),S=Pf(m,ee,L),S!==null&&(li(S,m,L),Zh(S,m,L))},enqueueReplaceState:function(m,S,A){m=m._reactInternals;var L=Wr(),ee=Au(L);ee.tag=1,ee.payload=S,A!=null&&(ee.callback=A),S=Pf(m,ee,L),S!==null&&(li(S,m,L),Zh(S,m,L))},enqueueForceUpdate:function(m,S){m=m._reactInternals;var A=Wr(),L=Au(A);L.tag=2,S!=null&&(L.callback=S),S=Pf(m,L,A),S!==null&&(li(S,m,A),Zh(S,m,A))}};function Vo(m,S,A,L,ee,fe,He){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(L,fe,He):S.prototype&&S.prototype.isPureReactComponent?!Cf(A,L)||!Cf(ee,fe):!0}function gg(m,S,A,L){m=S.state,typeof S.componentWillReceiveProps=="function"&&S.componentWillReceiveProps(A,L),typeof S.UNSAFE_componentWillReceiveProps=="function"&&S.UNSAFE_componentWillReceiveProps(A,L),S.state!==m&&ro.enqueueReplaceState(S,S.state,null)}function eu(m,S){var A=S;if("ref"in S){A={};for(var L in S)L!=="ref"&&(A[L]=S[L])}if(m=m.defaultProps){A===S&&(A=u({},A));for(var ee in m)A[ee]===void 0&&(A[ee]=m[ee])}return A}var zd=typeof reportError=="function"?reportError:function(m){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var S=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof m=="object"&&m!==null&&typeof m.message=="string"?String(m.message):String(m),error:m});if(!window.dispatchEvent(S))return}else if(typeof xl=="object"&&typeof xl.emit=="function"){xl.emit("uncaughtException",m);return}console.error(m)};function ml(m){zd(m)}function sa(m){console.error(m)}function Q_(m){zd(m)}function Ff(m,S){try{var A=m.onUncaughtError;A(S.value,{componentStack:S.stack})}catch(L){setTimeout(function(){throw L})}}function Sr(m,S,A){try{var L=m.onCaughtError;L(A.value,{componentStack:A.stack,errorBoundary:S.tag===1?S.stateNode:null})}catch(ee){setTimeout(function(){throw ee})}}function wr(m,S,A){return A=Au(A),A.tag=3,A.payload={element:null},A.callback=function(){Ff(m,S)},A}function pc(m){return m=Au(m),m.tag=3,m}function Li(m,S,A,L){var ee=A.type.getDerivedStateFromError;if(typeof ee=="function"){var fe=L.value;m.payload=function(){return ee(fe)},m.callback=function(){Sr(S,A,L)}}var He=A.stateNode;He!==null&&typeof He.componentDidCatch=="function"&&(m.callback=function(){Sr(S,A,L),typeof ee!="function"&&(Rn===null?Rn=new Set([this]):Rn.add(this));var Je=L.stack;this.componentDidCatch(L.value,{componentStack:Je!==null?Je:""})})}function aa(m,S,A,L,ee){if(A.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){if(S=A.alternate,S!==null&&Ao(S,A,ee,!0),A=qs.current,A!==null){switch(A.tag){case 13:return dc===null?T():A.alternate===null&&Et===0&&(Et=3),A.flags&=-257,A.flags|=65536,A.lanes=ee,L===Ju?A.flags|=16384:(S=A.updateQueue,S===null?A.updateQueue=new Set([L]):S.add(L),nn(m,L,ee)),!1;case 22:return A.flags|=65536,L===Ju?A.flags|=16384:(S=A.updateQueue,S===null?(S={transitions:null,markerInstances:null,retryQueue:new Set([L])},A.updateQueue=S):(A=S.retryQueue,A===null?S.retryQueue=new Set([L]):A.add(L)),nn(m,L,ee)),!1}throw Error(r(435,A.tag))}return nn(m,L,ee),T(),!1}if(ei)return S=qs.current,S!==null?((S.flags&65536)===0&&(S.flags|=256),S.flags|=65536,S.lanes=ee,L!==Wh&&(m=Error(r(422),{cause:L}),Xc(Ja(m,A)))):(L!==Wh&&(S=Error(r(423),{cause:L}),Xc(Ja(S,A))),m=m.current.alternate,m.flags|=65536,ee&=-ee,m.lanes|=ee,L=Ja(L,A),ee=wr(m.stateNode,L,ee),Qh(m,ee),Et!==4&&(Et=2)),!1;var fe=Error(r(520),{cause:L});if(fe=Ja(fe,A),It===null?It=[fe]:It.push(fe),Et!==4&&(Et=2),S===null)return!0;L=Ja(L,A),A=S;do{switch(A.tag){case 3:return A.flags|=65536,m=ee&-ee,A.lanes|=m,m=wr(A.stateNode,L,m),Qh(A,m),!1;case 1:if(S=A.type,fe=A.stateNode,(A.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||fe!==null&&typeof fe.componentDidCatch=="function"&&(Rn===null||!Rn.has(fe))))return A.flags|=65536,ee&=-ee,A.lanes|=ee,ee=pc(ee),Li(ee,m,A,L),Qh(A,ee),!1}A=A.return}while(A!==null);return!1}var wa=Error(r(461)),Va=!1;function ys(m,S,A,L){S.child=m===null?n_(S,null,A,L):_h(S,m.child,A,L)}function Ga(m,S,A,L,ee){A=A.render;var fe=S.ref;if("ref"in L){var He={};for(var Je in L)Je!=="ref"&&(He[Je]=L[Je])}else He=L;return Zu(S),L=no(m,S,A,He,fe,ee),Je=fl(),m!==null&&!Va?(Kl(m,S,ee),$r(m,S,ee)):(ei&&Je&&Qp(S),S.flags|=1,ys(m,S,L,ee),S.child)}function Il(m,S,A,L,ee){if(m===null){var fe=A.type;return typeof fe=="function"&&!Oc(fe)&&fe.defaultProps===void 0&&A.compare===null?(S.tag=15,S.type=fe,oa(m,S,fe,L,ee)):(m=wo(A.type,null,L,S,S.mode,ee),m.ref=S.ref,m.return=S,S.child=m)}if(fe=m.child,!rs(m,ee)){var He=fe.memoizedProps;if(A=A.compare,A=A!==null?A:Cf,A(He,L)&&m.ref===S.ref)return $r(m,S,ee)}return S.flags|=1,m=ga(fe,L),m.ref=S.ref,m.return=S,S.child=m}function oa(m,S,A,L,ee){if(m!==null){var fe=m.memoizedProps;if(Cf(fe,L)&&m.ref===S.ref)if(Va=!1,S.pendingProps=L=fe,rs(m,ee))(m.flags&131072)!==0&&(Va=!0);else return S.lanes=m.lanes,$r(m,S,ee)}return tu(m,S,A,L,ee)}function Hr(m,S,A){var L=S.pendingProps,ee=L.children,fe=m!==null?m.memoizedState:null;if(L.mode==="hidden"){if((S.flags&128)!==0){if(L=fe!==null?fe.baseLanes|A:A,m!==null){for(ee=S.child=m.child,fe=0;ee!==null;)fe=fe|ee.lanes|ee.childLanes,ee=ee.sibling;S.childLanes=fe&~L}else S.childLanes=0,S.child=null;return hs(m,S,L,A)}if((A&536870912)!==0)S.memoizedState={baseLanes:0,cachePool:null},m!==null&&ra(S,fe!==null?fe.cachePool:null),fe!==null?Jh(S,fe):Cu(),mg(S);else return S.lanes=S.childLanes=536870912,hs(m,S,fe!==null?fe.baseLanes|A:A,A)}else fe!==null?(ra(S,fe.cachePool),Jh(S,fe),Uf(),S.memoizedState=null):(m!==null&&ra(S,null),Cu(),Uf());return ys(m,S,ee,A),S.child}function hs(m,S,A,L){var ee=ja();return ee=ee===null?null:{parent:yr._currentValue,pool:ee},S.memoizedState={baseLanes:A,cachePool:ee},m!==null&&ra(S,null),Cu(),mg(S),m!==null&&Ao(m,S,L,!0),null}function Ra(m,S){var A=S.ref;if(A===null)m!==null&&m.ref!==null&&(S.flags|=4194816);else{if(typeof A!="function"&&typeof A!="object")throw Error(r(284));(m===null||m.ref!==A)&&(S.flags|=4194816)}}function tu(m,S,A,L,ee){return Zu(S),A=no(m,S,A,L,void 0,ee),L=fl(),m!==null&&!Va?(Kl(m,S,ee),$r(m,S,ee)):(ei&&L&&Qp(S),S.flags|=1,ys(m,S,A,ee),S.child)}function qi(m,S,A,L,ee,fe){return Zu(S),S.updateQueue=null,A=nd(S,L,A,ee),td(m),L=fl(),m!==null&&!Va?(Kl(m,S,fe),$r(m,S,fe)):(ei&&L&&Qp(S),S.flags|=1,ys(m,S,A,fe),S.child)}function $a(m,S,A,L,ee){if(Zu(S),S.stateNode===null){var fe=If,He=A.contextType;typeof He=="object"&&He!==null&&(fe=Na(He)),fe=new A(L,fe),S.memoizedState=fe.state!==null&&fe.state!==void 0?fe.state:null,fe.updater=ro,S.stateNode=fe,fe._reactInternals=S,fe=S.stateNode,fe.props=L,fe.state=S.memoizedState,fe.refs={},em(S),He=A.contextType,fe.context=typeof He=="object"&&He!==null?Na(He):If,fe.state=S.memoizedState,He=A.getDerivedStateFromProps,typeof He=="function"&&(Bf(S,A,He,L),fe.state=S.memoizedState),typeof A.getDerivedStateFromProps=="function"||typeof fe.getSnapshotBeforeUpdate=="function"||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(He=fe.state,typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount(),He!==fe.state&&ro.enqueueReplaceState(fe,fe.state,null),Ol(S,L,fe,ee),Hs(),fe.state=S.memoizedState),typeof fe.componentDidMount=="function"&&(S.flags|=4194308),L=!0}else if(m===null){fe=S.stateNode;var Je=S.memoizedProps,St=eu(A,Je);fe.props=St;var Jt=fe.context,vn=A.contextType;He=If,typeof vn=="object"&&vn!==null&&(He=Na(vn));var xn=A.getDerivedStateFromProps;vn=typeof xn=="function"||typeof fe.getSnapshotBeforeUpdate=="function",Je=S.pendingProps!==Je,vn||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(Je||Jt!==He)&&gg(S,fe,L,He),Mo=!1;var rn=S.memoizedState;fe.state=rn,Ol(S,L,fe,ee),Hs(),Jt=S.memoizedState,Je||rn!==Jt||Mo?(typeof xn=="function"&&(Bf(S,A,xn,L),Jt=S.memoizedState),(St=Mo||Vo(S,A,St,L,rn,Jt,He))?(vn||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(S.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(S.flags|=4194308),S.memoizedProps=L,S.memoizedState=Jt),fe.props=L,fe.state=Jt,fe.context=He,L=St):(typeof fe.componentDidMount=="function"&&(S.flags|=4194308),L=!1)}else{fe=S.stateNode,jr(m,S),He=S.memoizedProps,vn=eu(A,He),fe.props=vn,xn=S.pendingProps,rn=fe.context,Jt=A.contextType,St=If,typeof Jt=="object"&&Jt!==null&&(St=Na(Jt)),Je=A.getDerivedStateFromProps,(Jt=typeof Je=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(He!==xn||rn!==St)&&gg(S,fe,L,St),Mo=!1,rn=S.memoizedState,fe.state=rn,Ol(S,L,fe,ee),Hs();var on=S.memoizedState;He!==xn||rn!==on||Mo||m!==null&&m.dependencies!==null&&Xh(m.dependencies)?(typeof Je=="function"&&(Bf(S,A,Je,L),on=S.memoizedState),(vn=Mo||Vo(S,A,vn,L,rn,on,St)||m!==null&&m.dependencies!==null&&Xh(m.dependencies))?(Jt||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(L,on,St),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(L,on,St)),typeof fe.componentDidUpdate=="function"&&(S.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(S.flags|=1024)):(typeof fe.componentDidUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=1024),S.memoizedProps=L,S.memoizedState=on),fe.props=L,fe.state=on,fe.context=St,L=vn):(typeof fe.componentDidUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||He===m.memoizedProps&&rn===m.memoizedState||(S.flags|=1024),L=!1)}return fe=L,Ra(m,S),L=(S.flags&128)!==0,fe||L?(fe=S.stateNode,A=L&&typeof A.getDerivedStateFromError!="function"?null:fe.render(),S.flags|=1,m!==null&&L?(S.child=_h(S,m.child,null,ee),S.child=_h(S,null,A,ee)):ys(m,S,A,ee),S.memoizedState=fe.state,m=S.child):m=$r(m,S,ee),m}function of(m,S,A,L){return Qn(),S.flags|=256,ys(m,S,A,L),S.child}var Vs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Ms(m){return{baseLanes:m,cachePool:Pc()}}function Ni(m,S,A){return m=m!==null?m.childLanes&~A:0,S&&(m|=Ot),m}function io(m,S,A){var L=S.pendingProps,ee=!1,fe=(S.flags&128)!==0,He;if((He=fe)||(He=m!==null&&m.memoizedState===null?!1:(go.current&2)!==0),He&&(ee=!0,S.flags&=-129),He=(S.flags&32)!==0,S.flags&=-33,m===null){if(ei){if(ee?Lf(S):Uf(),ei){var Je=As,St;if(St=Je){e:{for(St=Je,Je=gi;St.nodeType!==8;){if(!Je){Je=null;break e}if(St=i_(St.nextSibling),St===null){Je=null;break e}}Je=St}Je!==null?(S.memoizedState={dehydrated:Je,treeContext:Gh!==null?{id:Wl,overflow:Tu}:null,retryLane:536870912,hydrationErrors:null},St=To(18,null,null,0),St.stateNode=Je,St.return=S,S.child=St,Ro=S,As=null,St=!0):St=!1}St||Yh(S)}if(Je=S.memoizedState,Je!==null&&(Je=Je.dehydrated,Je!==null))return E5(Je)?S.lanes=32:S.lanes=536870912,null;af(S)}return Je=L.children,L=L.fallback,ee?(Uf(),ee=S.mode,Je=Nl({mode:"hidden",children:Je},ee),L=Ia(L,ee,A,null),Je.return=S,L.return=S,Je.sibling=L,S.child=Je,ee=S.child,ee.memoizedState=Ms(A),ee.childLanes=Ni(m,He,A),S.memoizedState=Vs,L):(Lf(S),mc(S,Je))}if(St=m.memoizedState,St!==null&&(Je=St.dehydrated,Je!==null)){if(fe)S.flags&256?(Lf(S),S.flags&=-257,S=mr(m,S,A)):S.memoizedState!==null?(Uf(),S.child=m.child,S.flags|=128,S=null):(Uf(),ee=L.fallback,Je=S.mode,L=Nl({mode:"visible",children:L.children},Je),ee=Ia(ee,Je,A,null),ee.flags|=2,L.return=S,ee.return=S,L.sibling=ee,S.child=L,_h(S,m.child,null,A),L=S.child,L.memoizedState=Ms(A),L.childLanes=Ni(m,He,A),S.memoizedState=Vs,S=ee);else if(Lf(S),E5(Je)){if(He=Je.nextSibling&&Je.nextSibling.dataset,He)var Jt=He.dgst;He=Jt,L=Error(r(419)),L.stack="",L.digest=He,Xc({value:L,source:null,stack:null}),S=mr(m,S,A)}else if(Va||Ao(m,S,A,!1),He=(A&m.childLanes)!==0,Va||He){if(He=F,He!==null&&(L=A&-A,L=(L&42)!==0?1:mt(L),L=(L&(He.suspendedLanes|A))!==0?0:L,L!==0&&L!==St.retryLane))throw St.retryLane=L,Ei(m,L),li(He,m,L),wa;Je.data==="$?"||T(),S=mr(m,S,A)}else Je.data==="$?"?(S.flags|=192,S.child=m.child,S=null):(m=St.treeContext,As=i_(Je.nextSibling),Ro=S,ei=!0,Nc=null,gi=!1,m!==null&&(us[uc++]=Wl,us[uc++]=Tu,us[uc++]=Gh,Wl=m.id,Tu=m.overflow,Gh=S),S=mc(S,L.children),S.flags|=4096);return S}return ee?(Uf(),ee=L.fallback,Je=S.mode,St=m.child,Jt=St.sibling,L=ga(St,{mode:"hidden",children:L.children}),L.subtreeFlags=St.subtreeFlags&65011712,Jt!==null?ee=ga(Jt,ee):(ee=Ia(ee,Je,A,null),ee.flags|=2),ee.return=S,L.return=S,L.sibling=ee,S.child=L,L=ee,ee=S.child,Je=m.child.memoizedState,Je===null?Je=Ms(A):(St=Je.cachePool,St!==null?(Jt=yr._currentValue,St=St.parent!==Jt?{parent:Jt,pool:Jt}:St):St=Pc(),Je={baseLanes:Je.baseLanes|A,cachePool:St}),ee.memoizedState=Je,ee.childLanes=Ni(m,He,A),S.memoizedState=Vs,L):(Lf(S),A=m.child,m=A.sibling,A=ga(A,{mode:"visible",children:L.children}),A.return=S,A.sibling=null,m!==null&&(He=S.deletions,He===null?(S.deletions=[m],S.flags|=16):He.push(m)),S.child=A,S.memoizedState=null,A)}function mc(m,S){return S=Nl({mode:"visible",children:S},m.mode),S.return=m,m.child=S}function Nl(m,S){return m=To(22,m,null,S),m.lanes=0,m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},m}function mr(m,S,A){return _h(S,m.child,null,A),m=mc(S,S.pendingProps.children),m.flags|=2,S.memoizedState=null,m}function fr(m,S,A){m.lanes|=S;var L=m.alternate;L!==null&&(L.lanes|=S),Jp(m.return,S,A)}function Wn(m,S,A,L,ee){var fe=m.memoizedState;fe===null?m.memoizedState={isBackwards:S,rendering:null,renderingStartTime:0,last:L,tail:A,tailMode:ee}:(fe.isBackwards=S,fe.rendering=null,fe.renderingStartTime=0,fe.last=L,fe.tail=A,fe.tailMode=ee)}function Wa(m,S,A){var L=S.pendingProps,ee=L.revealOrder,fe=L.tail;if(ys(m,S,L.children,A),L=go.current,(L&2)!==0)L=L&1|2,S.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=S.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&fr(m,A,S);else if(m.tag===19)fr(m,A,S);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===S)break e;for(;m.sibling===null;){if(m.return===null||m.return===S)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}L&=1}switch(le(go,L),ee){case"forwards":for(A=S.child,ee=null;A!==null;)m=A.alternate,m!==null&&ad(m)===null&&(ee=A),A=A.sibling;A=ee,A===null?(ee=S.child,S.child=null):(ee=A.sibling,A.sibling=null),Wn(S,!1,ee,A,fe);break;case"backwards":for(A=null,ee=S.child,S.child=null;ee!==null;){if(m=ee.alternate,m!==null&&ad(m)===null){S.child=ee;break}m=ee.sibling,ee.sibling=A,A=ee,ee=m}Wn(S,!0,A,null,fe);break;case"together":Wn(S,!1,null,null,void 0);break;default:S.memoizedState=null}return S.child}function $r(m,S,A){if(m!==null&&(S.dependencies=m.dependencies),Pt|=S.lanes,(A&S.childLanes)===0)if(m!==null){if(Ao(m,S,A,!1),(A&S.childLanes)===0)return null}else return null;if(m!==null&&S.child!==m.child)throw Error(r(153));if(S.child!==null){for(m=S.child,A=ga(m,m.pendingProps),S.child=A,A.return=S;m.sibling!==null;)m=m.sibling,A=A.sibling=ga(m,m.pendingProps),A.return=S;A.sibling=null}return S.child}function rs(m,S){return(m.lanes&S)!==0?!0:(m=m.dependencies,!!(m!==null&&Xh(m)))}function Pu(m,S,A){switch(S.tag){case 3:Pe(S,S.stateNode.containerInfo),ph(S,yr,m.memoizedState.cache),Qn();break;case 27:case 5:Xe(S);break;case 4:Pe(S,S.stateNode.containerInfo);break;case 10:ph(S,S.type,S.memoizedProps.value);break;case 13:var L=S.memoizedState;if(L!==null)return L.dehydrated!==null?(Lf(S),S.flags|=128,null):(A&S.child.childLanes)!==0?io(m,S,A):(Lf(S),m=$r(m,S,A),m!==null?m.sibling:null);Lf(S);break;case 19:var ee=(m.flags&128)!==0;if(L=(A&S.childLanes)!==0,L||(Ao(m,S,A,!1),L=(A&S.childLanes)!==0),ee){if(L)return Wa(m,S,A);S.flags|=128}if(ee=S.memoizedState,ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),le(go,go.current),L)break;return null;case 22:case 23:return S.lanes=0,Hr(m,S,A);case 24:ph(S,yr,m.memoizedState.cache)}return $r(m,S,A)}function nu(m,S,A){if(m!==null)if(m.memoizedProps!==S.pendingProps)Va=!0;else{if(!rs(m,A)&&(S.flags&128)===0)return Va=!1,Pu(m,S,A);Va=(m.flags&131072)!==0}else Va=!1,ei&&(S.flags&1048576)!==0&&$h(S,Ic,S.index);switch(S.lanes=0,S.tag){case 16:e:{m=S.pendingProps;var L=S.elementType,ee=L._init;if(L=ee(L._payload),S.type=L,typeof L=="function")Oc(L)?(m=eu(L,m),S.tag=1,S=$a(null,S,L,m,A)):(S.tag=0,S=tu(null,S,L,m,A));else{if(L!=null){if(ee=L.$$typeof,ee===M){S.tag=11,S=Ga(null,S,L,m,A);break e}else if(ee===I){S.tag=14,S=Il(null,S,L,m,A);break e}}throw S=U(L)||L,Error(r(306,S,""))}}return S;case 0:return tu(m,S,S.type,S.pendingProps,A);case 1:return L=S.type,ee=eu(L,S.pendingProps),$a(m,S,L,ee,A);case 3:e:{if(Pe(S,S.stateNode.containerInfo),m===null)throw Error(r(387));L=S.pendingProps;var fe=S.memoizedState;ee=fe.element,jr(m,S),Ol(S,L,null,A);var He=S.memoizedState;if(L=He.cache,ph(S,yr,L),L!==fe.cache&&kd(S,[yr],A,!0),Hs(),L=He.element,fe.isDehydrated)if(fe={element:L,isDehydrated:!1,cache:He.cache},S.updateQueue.baseState=fe,S.memoizedState=fe,S.flags&256){S=of(m,S,L,A);break e}else if(L!==ee){ee=Ja(Error(r(424)),S),Xc(ee),S=of(m,S,L,A);break e}else{switch(m=S.stateNode.containerInfo,m.nodeType){case 9:m=m.body;break;default:m=m.nodeName==="HTML"?m.ownerDocument.body:m}for(As=i_(m.firstChild),Ro=S,ei=!0,Nc=null,gi=!0,A=n_(S,null,L,A),S.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling}else{if(Qn(),L===ee){S=$r(m,S,A);break e}ys(m,S,L,A)}S=S.child}return S;case 26:return Ra(m,S),m===null?(A=NG(S.type,null,S.pendingProps,null))?S.memoizedState=A:ei||(A=S.type,m=S.pendingProps,L=_3(Me.current).createElement(A),L[Bt]=S,L[Yt]=m,md(L,A,m),pi(L),S.stateNode=L):S.memoizedState=NG(S.type,m.memoizedProps,S.pendingProps,m.memoizedState),null;case 27:return Xe(S),m===null&&ei&&(L=S.stateNode=kG(S.type,S.pendingProps,Me.current),Ro=S,gi=!0,ee=As,Ab(S.type)?(x5=ee,As=i_(L.firstChild)):As=ee),ys(m,S,S.pendingProps.children,A),Ra(m,S),m===null&&(S.flags|=4194304),S.child;case 5:return m===null&&ei&&((ee=L=As)&&(L=L1e(L,S.type,S.pendingProps,gi),L!==null?(S.stateNode=L,Ro=S,As=i_(L.firstChild),gi=!1,ee=!0):ee=!1),ee||Yh(S)),Xe(S),ee=S.type,fe=S.pendingProps,He=m!==null?m.memoizedProps:null,L=fe.children,y5(ee,fe)?L=null:He!==null&&y5(ee,He)&&(S.flags|=32),S.memoizedState!==null&&(ee=no(m,S,_p,null,null,A),yR._currentValue=ee),Ra(m,S),ys(m,S,L,A),S.child;case 6:return m===null&&ei&&((m=A=As)&&(A=U1e(A,S.pendingProps,gi),A!==null?(S.stateNode=A,Ro=S,As=null,m=!0):m=!1),m||Yh(S)),null;case 13:return io(m,S,A);case 4:return Pe(S,S.stateNode.containerInfo),L=S.pendingProps,m===null?S.child=_h(S,null,L,A):ys(m,S,L,A),S.child;case 11:return Ga(m,S,S.type,S.pendingProps,A);case 7:return ys(m,S,S.pendingProps,A),S.child;case 8:return ys(m,S,S.pendingProps.children,A),S.child;case 12:return ys(m,S,S.pendingProps.children,A),S.child;case 10:return L=S.pendingProps,ph(S,S.type,L.value),ys(m,S,L.children,A),S.child;case 9:return ee=S.type._context,L=S.pendingProps.children,Zu(S),ee=Na(ee),L=L(ee),S.flags|=1,ys(m,S,L,A),S.child;case 14:return Il(m,S,S.type,S.pendingProps,A);case 15:return oa(m,S,S.type,S.pendingProps,A);case 19:return Wa(m,S,A);case 31:return L=S.pendingProps,A=S.mode,L={mode:L.mode,children:L.children},m===null?(A=Nl(L,A),A.ref=S.ref,S.child=A,A.return=S,S=A):(A=ga(m.child,L),A.ref=S.ref,S.child=A,A.return=S,S=A),S;case 22:return Hr(m,S,A);case 24:return Zu(S),L=Na(yr),m===null?(ee=ja(),ee===null&&(ee=F,fe=ol(),ee.pooledCache=fe,fe.refCount++,fe!==null&&(ee.pooledCacheLanes|=A),ee=fe),S.memoizedState={parent:L,cache:ee},em(S),ph(S,yr,ee)):((m.lanes&A)!==0&&(jr(m,S),Ol(S,null,null,A),Hs()),ee=m.memoizedState,fe=S.memoizedState,ee.parent!==L?(ee={parent:L,cache:L},S.memoizedState=ee,S.lanes===0&&(S.memoizedState=S.updateQueue.baseState=ee),ph(S,yr,L)):(L=fe.cache,ph(S,yr,L),L!==ee.cache&&kd(S,[yr],A,!0))),ys(m,S,S.pendingProps.children,A),S.child;case 29:throw S.pendingProps}throw Error(r(156,S.tag))}function ko(m){m.flags|=4}function od(m,S){if(S.type!=="stylesheet"||(S.state.loading&4)!==0)m.flags&=-16777217;else if(m.flags|=16777216,!BG(S)){if(S=qs.current,S!==null&&((pe&4194048)===pe?dc!==null:(pe&62914560)!==pe&&(pe&536870912)===0||S!==dc))throw Co=Ju,wu;m.flags|=8192}}function ld(m,S){S!==null&&(m.flags|=4),m.flags&16384&&(S=m.tag!==22?tt():536870912,m.lanes|=S,wt|=S)}function Ep(m,S){if(!ei)switch(m.tailMode){case"hidden":S=m.tail;for(var A=null;S!==null;)S.alternate!==null&&(A=S),S=S.sibling;A===null?m.tail=null:A.sibling=null;break;case"collapsed":A=m.tail;for(var L=null;A!==null;)A.alternate!==null&&(L=A),A=A.sibling;L===null?S||m.tail===null?m.tail=null:m.tail.sibling=null:L.sibling=null}}function la(m){var S=m.alternate!==null&&m.alternate.child===m.child,A=0,L=0;if(S)for(var ee=m.child;ee!==null;)A|=ee.lanes|ee.childLanes,L|=ee.subtreeFlags&65011712,L|=ee.flags&65011712,ee.return=m,ee=ee.sibling;else for(ee=m.child;ee!==null;)A|=ee.lanes|ee.childLanes,L|=ee.subtreeFlags,L|=ee.flags,ee.return=m,ee=ee.sibling;return m.subtreeFlags|=L,m.childLanes=A,S}function xp(m,S,A){var L=S.pendingProps;switch(Ks(S),S.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return la(S),null;case 1:return la(S),null;case 3:return A=S.stateNode,L=null,m!==null&&(L=m.memoizedState.cache),S.memoizedState.cache!==L&&(S.flags|=2048),Zc(yr),Ce(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(m===null||m.child===null)&&(al(S)?ko(S):m===null||m.memoizedState.isDehydrated&&(S.flags&256)===0||(S.flags|=1024,Ii())),la(S),null;case 26:return A=S.memoizedState,m===null?(ko(S),A!==null?(la(S),od(S,A)):(la(S),S.flags&=-16777217)):A?A!==m.memoizedState?(ko(S),la(S),od(S,A)):(la(S),S.flags&=-16777217):(m.memoizedProps!==L&&ko(S),la(S),S.flags&=-16777217),null;case 27:$e(S),A=Me.current;var ee=S.type;if(m!==null&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(!L){if(S.stateNode===null)throw Error(r(166));return la(S),null}m=ce.current,al(S)?W_(S):(m=kG(ee,L,A),S.stateNode=m,ko(S))}return la(S),null;case 5:if($e(S),A=S.type,m!==null&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(!L){if(S.stateNode===null)throw Error(r(166));return la(S),null}if(m=ce.current,al(S))W_(S);else{switch(ee=_3(Me.current),m){case 1:m=ee.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:m=ee.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":m=ee.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":m=ee.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":m=ee.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild);break;case"select":m=typeof L.is=="string"?ee.createElement("select",{is:L.is}):ee.createElement("select"),L.multiple?m.multiple=!0:L.size&&(m.size=L.size);break;default:m=typeof L.is=="string"?ee.createElement(A,{is:L.is}):ee.createElement(A)}}m[Bt]=S,m[Yt]=L;e:for(ee=S.child;ee!==null;){if(ee.tag===5||ee.tag===6)m.appendChild(ee.stateNode);else if(ee.tag!==4&&ee.tag!==27&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===S)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===S)break e;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}S.stateNode=m;e:switch(md(m,A,L),A){case"button":case"input":case"select":case"textarea":m=!!L.autoFocus;break e;case"img":m=!0;break e;default:m=!1}m&&ko(S)}}return la(S),S.flags&=-16777217,null;case 6:if(m&&S.stateNode!=null)m.memoizedProps!==L&&ko(S);else{if(typeof L!="string"&&S.stateNode===null)throw Error(r(166));if(m=Me.current,al(S)){if(m=S.stateNode,A=S.memoizedProps,L=null,ee=Ro,ee!==null)switch(ee.tag){case 27:case 5:L=ee.memoizedProps}m[Bt]=S,m=!!(m.nodeValue===A||L!==null&&L.suppressHydrationWarning===!0||xG(m.nodeValue,A)),m||Yh(S)}else m=_3(m).createTextNode(L),m[Bt]=S,S.stateNode=m}return la(S),null;case 13:if(L=S.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(ee=al(S),L!==null&&L.dehydrated!==null){if(m===null){if(!ee)throw Error(r(318));if(ee=S.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(r(317));ee[Bt]=S}else Qn(),(S.flags&128)===0&&(S.memoizedState=null),S.flags|=4;la(S),ee=!1}else ee=Ii(),m!==null&&m.memoizedState!==null&&(m.memoizedState.hydrationErrors=ee),ee=!0;if(!ee)return S.flags&256?(af(S),S):(af(S),null)}if(af(S),(S.flags&128)!==0)return S.lanes=A,S;if(A=L!==null,m=m!==null&&m.memoizedState!==null,A){L=S.child,ee=null,L.alternate!==null&&L.alternate.memoizedState!==null&&L.alternate.memoizedState.cachePool!==null&&(ee=L.alternate.memoizedState.cachePool.pool);var fe=null;L.memoizedState!==null&&L.memoizedState.cachePool!==null&&(fe=L.memoizedState.cachePool.pool),fe!==ee&&(L.flags|=2048)}return A!==m&&A&&(S.child.flags|=8192),ld(S,S.updateQueue),la(S),null;case 4:return Ce(),m===null&&p5(S.stateNode.containerInfo),la(S),null;case 10:return Zc(S.type),la(S),null;case 19:if(ne(go),ee=S.memoizedState,ee===null)return la(S),null;if(L=(S.flags&128)!==0,fe=ee.rendering,fe===null)if(L)Ep(ee,!1);else{if(Et!==0||m!==null&&(m.flags&128)!==0)for(m=S.child;m!==null;){if(fe=ad(m),fe!==null){for(S.flags|=128,Ep(ee,!1),m=fe.updateQueue,S.updateQueue=m,ld(S,m),S.subtreeFlags=0,m=A,A=S.child;A!==null;)dp(A,m),A=A.sibling;return le(go,go.current&1|2),S.child}m=m.sibling}ee.tail!==null&&ze()>$t&&(S.flags|=128,L=!0,Ep(ee,!1),S.lanes=4194304)}else{if(!L)if(m=ad(fe),m!==null){if(S.flags|=128,L=!0,m=m.updateQueue,S.updateQueue=m,ld(S,m),Ep(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!fe.alternate&&!ei)return la(S),null}else 2*ze()-ee.renderingStartTime>$t&&A!==536870912&&(S.flags|=128,L=!0,Ep(ee,!1),S.lanes=4194304);ee.isBackwards?(fe.sibling=S.child,S.child=fe):(m=ee.last,m!==null?m.sibling=fe:S.child=fe,ee.last=fe)}return ee.tail!==null?(S=ee.tail,ee.rendering=S,ee.tail=S.sibling,ee.renderingStartTime=ze(),S.sibling=null,m=go.current,le(go,L?m&1|2:m&1),S):(la(S),null);case 22:case 23:return af(S),cl(),L=S.memoizedState!==null,m!==null?m.memoizedState!==null!==L&&(S.flags|=8192):L&&(S.flags|=8192),L?(A&536870912)!==0&&(S.flags&128)===0&&(la(S),S.subtreeFlags&6&&(S.flags|=8192)):la(S),A=S.updateQueue,A!==null&&ld(S,A.retryQueue),A=null,m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),L=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(L=S.memoizedState.cachePool.pool),L!==A&&(S.flags|=2048),m!==null&&ne(Xl),null;case 24:return A=null,m!==null&&(A=m.memoizedState.cache),S.memoizedState.cache!==A&&(S.flags|=2048),Zc(yr),la(S),null;case 25:return null;case 30:return null}throw Error(r(156,S.tag))}function gl(m,S){switch(Ks(S),S.tag){case 1:return m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 3:return Zc(yr),Ce(),m=S.flags,(m&65536)!==0&&(m&128)===0?(S.flags=m&-65537|128,S):null;case 26:case 27:case 5:return $e(S),null;case 13:if(af(S),m=S.memoizedState,m!==null&&m.dehydrated!==null){if(S.alternate===null)throw Error(r(340));Qn()}return m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 19:return ne(go),null;case 4:return Ce(),null;case 10:return Zc(S.type),null;case 22:case 23:return af(S),cl(),m!==null&&ne(Xl),m=S.flags,m&65536?(S.flags=m&-65537|128,S):null;case 24:return Zc(yr),null;case 25:return null;default:return null}}function _l(m,S){switch(Ks(S),S.tag){case 3:Zc(yr),Ce();break;case 26:case 27:case 5:$e(S);break;case 4:Ce();break;case 13:af(S);break;case 19:ne(go);break;case 10:Zc(S.type);break;case 22:case 23:af(S),cl(),m!==null&&ne(Xl);break;case 24:Zc(yr)}}function Uc(m,S){try{var A=S.updateQueue,L=A!==null?A.lastEffect:null;if(L!==null){var ee=L.next;A=ee;do{if((A.tag&m)===m){L=void 0;var fe=A.create,He=A.inst;L=fe(),He.destroy=L}A=A.next}while(A!==ee)}}catch(Je){Ct(S,S.return,Je)}}function Zi(m,S,A){try{var L=S.updateQueue,ee=L!==null?L.lastEffect:null;if(ee!==null){var fe=ee.next;L=fe;do{if((L.tag&m)===m){var He=L.inst,Je=He.destroy;if(Je!==void 0){He.destroy=void 0,ee=S;var St=A,Jt=Je;try{Jt()}catch(vn){Ct(ee,St,vn)}}}L=L.next}while(L!==fe)}}catch(vn){Ct(S,S.return,vn)}}function Zr(m){var S=m.updateQueue;if(S!==null){var A=m.stateNode;try{Nd(S,A)}catch(L){Ct(m,m.return,L)}}}function so(m,S,A){A.props=eu(m.type,m.memoizedProps),A.state=m.memoizedState;try{A.componentWillUnmount()}catch(L){Ct(m,S,L)}}function vh(m,S){try{var A=m.ref;if(A!==null){switch(m.tag){case 26:case 27:case 5:var L=m.stateNode;break;case 30:L=m.stateNode;break;default:L=m.stateNode}typeof A=="function"?m.refCleanup=A(L):A.current=L}}catch(ee){Ct(m,S,ee)}}function vl(m,S){var A=m.ref,L=m.refCleanup;if(A!==null)if(typeof L=="function")try{L()}catch(ee){Ct(m,S,ee)}finally{m.refCleanup=null,m=m.alternate,m!=null&&(m.refCleanup=null)}else if(typeof A=="function")try{A(null)}catch(ee){Ct(m,S,ee)}else A.current=null}function _a(m){var S=m.type,A=m.memoizedProps,L=m.stateNode;try{e:switch(S){case"button":case"input":case"select":case"textarea":A.autoFocus&&L.focus();break e;case"img":A.src?L.src=A.src:A.srcSet&&(L.srcset=A.srcSet)}}catch(ee){Ct(m,m.return,ee)}}function Go(m,S,A){try{var L=m.stateNode;O1e(L,m.type,A,S),L[Yt]=S}catch(ee){Ct(m,m.return,ee)}}function jd(m){return m.tag===5||m.tag===3||m.tag===26||m.tag===27&&Ab(m.type)||m.tag===4}function zf(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||jd(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.tag===27&&Ab(m.type)||m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function ru(m,S,A){var L=m.tag;if(L===5||L===6)m=m.stateNode,S?(A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A).insertBefore(m,S):(S=A.nodeType===9?A.body:A.nodeName==="HTML"?A.ownerDocument.body:A,S.appendChild(m),A=A._reactRootContainer,A!=null||S.onclick!==null||(S.onclick=g3));else if(L!==4&&(L===27&&Ab(m.type)&&(A=m.stateNode,S=null),m=m.child,m!==null))for(ru(m,S,A),m=m.sibling;m!==null;)ru(m,S,A),m=m.sibling}function iu(m,S,A){var L=m.tag;if(L===5||L===6)m=m.stateNode,S?A.insertBefore(m,S):A.appendChild(m);else if(L!==4&&(L===27&&Ab(m.type)&&(A=m.stateNode),m=m.child,m!==null))for(iu(m,S,A),m=m.sibling;m!==null;)iu(m,S,A),m=m.sibling}function yh(m){var S=m.stateNode,A=m.memoizedProps;try{for(var L=m.type,ee=S.attributes;ee.length;)S.removeAttributeNode(ee[0]);md(S,L,A),S[Bt]=m,S[Yt]=A}catch(fe){Ct(m,m.return,fe)}}var lf=!1,ca=!1,Hd=!1,su=typeof WeakSet=="function"?WeakSet:Set,Gs=null;function Oo(m,S){if(m=m.containerInfo,_5=x3,m=mi(m),Xi(m)){if("selectionStart"in m)var A={start:m.selectionStart,end:m.selectionEnd};else e:{A=(A=m.ownerDocument)&&A.defaultView||window;var L=A.getSelection&&A.getSelection();if(L&&L.rangeCount!==0){A=L.anchorNode;var ee=L.anchorOffset,fe=L.focusNode;L=L.focusOffset;try{A.nodeType,fe.nodeType}catch{A=null;break e}var He=0,Je=-1,St=-1,Jt=0,vn=0,xn=m,rn=null;t:for(;;){for(var on;xn!==A||ee!==0&&xn.nodeType!==3||(Je=He+ee),xn!==fe||L!==0&&xn.nodeType!==3||(St=He+L),xn.nodeType===3&&(He+=xn.nodeValue.length),(on=xn.firstChild)!==null;)rn=xn,xn=on;for(;;){if(xn===m)break t;if(rn===A&&++Jt===ee&&(Je=He),rn===fe&&++vn===L&&(St=He),(on=xn.nextSibling)!==null)break;xn=rn,rn=xn.parentNode}xn=on}A=Je===-1||St===-1?null:{start:Je,end:St}}else A=null}A=A||{start:0,end:0}}else A=null;for(v5={focusedElem:m,selectionRange:A},x3=!1,Gs=S;Gs!==null;)if(S=Gs,m=S.child,(S.subtreeFlags&1024)!==0&&m!==null)m.return=S,Gs=m;else for(;Gs!==null;){switch(S=Gs,fe=S.alternate,m=S.flags,S.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&fe!==null){m=void 0,A=S,ee=fe.memoizedProps,fe=fe.memoizedState,L=A.stateNode;try{var Mi=eu(A.type,ee,A.elementType===A.type);m=L.getSnapshotBeforeUpdate(Mi,fe),L.__reactInternalSnapshotBeforeUpdate=m}catch(fi){Ct(A,A.return,fi)}}break;case 3:if((m&1024)!==0){if(m=S.stateNode.containerInfo,A=m.nodeType,A===9)S5(m);else if(A===1)switch(m.nodeName){case"HEAD":case"HTML":case"BODY":S5(m);break;default:m.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(r(163))}if(m=S.sibling,m!==null){m.return=S.return,Gs=m;break}Gs=S.return}}function cd(m,S,A){var L=A.flags;switch(A.tag){case 0:case 11:case 15:ui(m,A),L&4&&Uc(5,A);break;case 1:if(ui(m,A),L&4)if(m=A.stateNode,S===null)try{m.componentDidMount()}catch(He){Ct(A,A.return,He)}else{var ee=eu(A.type,S.memoizedProps);S=S.memoizedState;try{m.componentDidUpdate(ee,S,m.__reactInternalSnapshotBeforeUpdate)}catch(He){Ct(A,A.return,He)}}L&64&&Zr(A),L&512&&vh(A,A.return);break;case 3:if(ui(m,A),L&64&&(m=A.updateQueue,m!==null)){if(S=null,A.child!==null)switch(A.child.tag){case 27:case 5:S=A.child.stateNode;break;case 1:S=A.child.stateNode}try{Nd(m,S)}catch(He){Ct(A,A.return,He)}}break;case 27:S===null&&L&4&&yh(A);case 26:case 5:ui(m,A),S===null&&L&4&&_a(A),L&512&&vh(A,A.return);break;case 12:ui(m,A);break;case 13:ui(m,A),L&4&&bh(m,A),L&64&&(m=A.memoizedState,m!==null&&(m=m.dehydrated,m!==null&&(A=ya.bind(null,A),B1e(m,A))));break;case 22:if(L=A.memoizedState!==null||lf,!L){S=S!==null&&S.memoizedState!==null||ca,ee=lf;var fe=ca;lf=L,(ca=S)&&!fe?Sh(m,A,(A.subtreeFlags&8772)!==0):ui(m,A),lf=ee,ca=fe}break;case 30:break;default:ui(m,A)}}function _i(m){var S=m.alternate;S!==null&&(m.alternate=null,_i(S)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(S=m.stateNode,S!==null&&er(S)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}var ar=null,Ui=!1;function $o(m,S,A){for(A=A.child;A!==null;)ud(m,S,A),A=A.sibling}function ud(m,S,A){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ct,A)}catch{}switch(A.tag){case 26:ca||vl(A,S),$o(m,S,A),A.memoizedState?A.memoizedState.count--:A.stateNode&&(A=A.stateNode,A.parentNode.removeChild(A));break;case 27:ca||vl(A,S);var L=ar,ee=Ui;Ab(A.type)&&(ar=A.stateNode,Ui=!1),$o(m,S,A),mR(A.stateNode),ar=L,Ui=ee;break;case 5:ca||vl(A,S);case 6:if(L=ar,ee=Ui,ar=null,$o(m,S,A),ar=L,Ui=ee,ar!==null)if(Ui)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(A.stateNode)}catch(fe){Ct(A,S,fe)}else try{ar.removeChild(A.stateNode)}catch(fe){Ct(A,S,fe)}break;case 18:ar!==null&&(Ui?(m=ar,CG(m.nodeType===9?m.body:m.nodeName==="HTML"?m.ownerDocument.body:m,A.stateNode),xR(m)):CG(ar,A.stateNode));break;case 4:L=ar,ee=Ui,ar=A.stateNode.containerInfo,Ui=!0,$o(m,S,A),ar=L,Ui=ee;break;case 0:case 11:case 14:case 15:ca||Zi(2,A,S),ca||Zi(4,A,S),$o(m,S,A);break;case 1:ca||(vl(A,S),L=A.stateNode,typeof L.componentWillUnmount=="function"&&so(A,S,L)),$o(m,S,A);break;case 21:$o(m,S,A);break;case 22:ca=(L=ca)||A.memoizedState!==null,$o(m,S,A),ca=L;break;default:$o(m,S,A)}}function bh(m,S){if(S.memoizedState===null&&(m=S.alternate,m!==null&&(m=m.memoizedState,m!==null&&(m=m.dehydrated,m!==null))))try{xR(m)}catch(A){Ct(S,S.return,A)}}function _g(m){switch(m.tag){case 13:case 19:var S=m.stateNode;return S===null&&(S=m.stateNode=new su),S;case 22:return m=m.stateNode,S=m._retryCache,S===null&&(S=m._retryCache=new su),S;default:throw Error(r(435,m.tag))}}function Io(m,S){var A=_g(m);S.forEach(function(L){var ee=Xr.bind(null,m,L);A.has(L)||(A.add(L),L.then(ee,ee))})}function ds(m,S){var A=S.deletions;if(A!==null)for(var L=0;L<A.length;L++){var ee=A[L],fe=m,He=S,Je=He;e:for(;Je!==null;){switch(Je.tag){case 27:if(Ab(Je.type)){ar=Je.stateNode,Ui=!1;break e}break;case 5:ar=Je.stateNode,Ui=!1;break e;case 3:case 4:ar=Je.stateNode.containerInfo,Ui=!0;break e}Je=Je.return}if(ar===null)throw Error(r(160));ud(fe,He,ee),ar=null,Ui=!1,fe=ee.alternate,fe!==null&&(fe.return=null),ee.return=null}if(S.subtreeFlags&13878)for(S=S.child;S!==null;)ec(S,m),S=S.sibling}var Qs=null;function ec(m,S){var A=m.alternate,L=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:ds(S,m),ks(m),L&4&&(Zi(3,m,m.return),Uc(3,m),Zi(5,m,m.return));break;case 1:ds(S,m),ks(m),L&512&&(ca||A===null||vl(A,A.return)),L&64&&lf&&(m=m.updateQueue,m!==null&&(L=m.callbacks,L!==null&&(A=m.shared.hiddenCallbacks,m.shared.hiddenCallbacks=A===null?L:A.concat(L))));break;case 26:var ee=Qs;if(ds(S,m),ks(m),L&512&&(ca||A===null||vl(A,A.return)),L&4){var fe=A!==null?A.memoizedState:null;if(L=m.memoizedState,A===null)if(L===null)if(m.stateNode===null){e:{L=m.type,A=m.memoizedProps,ee=ee.ownerDocument||ee;t:switch(L){case"title":fe=ee.getElementsByTagName("title")[0],(!fe||fe[$n]||fe[Bt]||fe.namespaceURI==="http://www.w3.org/2000/svg"||fe.hasAttribute("itemprop"))&&(fe=ee.createElement(L),ee.head.insertBefore(fe,ee.querySelector("head > title"))),md(fe,L,A),fe[Bt]=m,pi(fe),L=fe;break e;case"link":var He=LG("link","href",ee).get(L+(A.href||""));if(He){for(var Je=0;Je<He.length;Je++)if(fe=He[Je],fe.getAttribute("href")===(A.href==null||A.href===""?null:A.href)&&fe.getAttribute("rel")===(A.rel==null?null:A.rel)&&fe.getAttribute("title")===(A.title==null?null:A.title)&&fe.getAttribute("crossorigin")===(A.crossOrigin==null?null:A.crossOrigin)){He.splice(Je,1);break t}}fe=ee.createElement(L),md(fe,L,A),ee.head.appendChild(fe);break;case"meta":if(He=LG("meta","content",ee).get(L+(A.content||""))){for(Je=0;Je<He.length;Je++)if(fe=He[Je],fe.getAttribute("content")===(A.content==null?null:""+A.content)&&fe.getAttribute("name")===(A.name==null?null:A.name)&&fe.getAttribute("property")===(A.property==null?null:A.property)&&fe.getAttribute("http-equiv")===(A.httpEquiv==null?null:A.httpEquiv)&&fe.getAttribute("charset")===(A.charSet==null?null:A.charSet)){He.splice(Je,1);break t}}fe=ee.createElement(L),md(fe,L,A),ee.head.appendChild(fe);break;default:throw Error(r(468,L))}fe[Bt]=m,pi(fe),L=fe}m.stateNode=L}else UG(ee,m.type,m.stateNode);else m.stateNode=DG(ee,L,m.memoizedProps);else fe!==L?(fe===null?A.stateNode!==null&&(A=A.stateNode,A.parentNode.removeChild(A)):fe.count--,L===null?UG(ee,m.type,m.stateNode):DG(ee,L,m.memoizedProps)):L===null&&m.stateNode!==null&&Go(m,m.memoizedProps,A.memoizedProps)}break;case 27:ds(S,m),ks(m),L&512&&(ca||A===null||vl(A,A.return)),A!==null&&L&4&&Go(m,m.memoizedProps,A.memoizedProps);break;case 5:if(ds(S,m),ks(m),L&512&&(ca||A===null||vl(A,A.return)),m.flags&32){ee=m.stateNode;try{bo(ee,"")}catch(on){Ct(m,m.return,on)}}L&4&&m.stateNode!=null&&(ee=m.memoizedProps,Go(m,ee,A!==null?A.memoizedProps:ee)),L&1024&&(Hd=!0);break;case 6:if(ds(S,m),ks(m),L&4){if(m.stateNode===null)throw Error(r(162));L=m.memoizedProps,A=m.stateNode;try{A.nodeValue=L}catch(on){Ct(m,m.return,on)}}break;case 3:if(b3=null,ee=Qs,Qs=v3(S.containerInfo),ds(S,m),Qs=ee,ks(m),L&4&&A!==null&&A.memoizedState.isDehydrated)try{xR(S.containerInfo)}catch(on){Ct(m,m.return,on)}Hd&&(Hd=!1,cf(m));break;case 4:L=Qs,Qs=v3(m.stateNode.containerInfo),ds(S,m),ks(m),Qs=L;break;case 12:ds(S,m),ks(m);break;case 13:ds(S,m),ks(m),m.child.flags&8192&&m.memoizedState!==null!=(A!==null&&A.memoizedState!==null)&&(Gt=ze()),L&4&&(L=m.updateQueue,L!==null&&(m.updateQueue=null,Io(m,L)));break;case 22:ee=m.memoizedState!==null;var St=A!==null&&A.memoizedState!==null,Jt=lf,vn=ca;if(lf=Jt||ee,ca=vn||St,ds(S,m),ca=vn,lf=Jt,ks(m),L&8192)e:for(S=m.stateNode,S._visibility=ee?S._visibility&-2:S._visibility|1,ee&&(A===null||St||lf||ca||au(m)),A=null,S=m;;){if(S.tag===5||S.tag===26){if(A===null){St=A=S;try{if(fe=St.stateNode,ee)He=fe.style,typeof He.setProperty=="function"?He.setProperty("display","none","important"):He.display="none";else{Je=St.stateNode;var xn=St.memoizedProps.style,rn=xn!=null&&xn.hasOwnProperty("display")?xn.display:null;Je.style.display=rn==null||typeof rn=="boolean"?"":(""+rn).trim()}}catch(on){Ct(St,St.return,on)}}}else if(S.tag===6){if(A===null){St=S;try{St.stateNode.nodeValue=ee?"":St.memoizedProps}catch(on){Ct(St,St.return,on)}}}else if((S.tag!==22&&S.tag!==23||S.memoizedState===null||S===m)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===m)break e;for(;S.sibling===null;){if(S.return===null||S.return===m)break e;A===S&&(A=null),S=S.return}A===S&&(A=null),S.sibling.return=S.return,S=S.sibling}L&4&&(L=m.updateQueue,L!==null&&(A=L.retryQueue,A!==null&&(L.retryQueue=null,Io(m,A))));break;case 19:ds(S,m),ks(m),L&4&&(L=m.updateQueue,L!==null&&(m.updateQueue=null,Io(m,L)));break;case 30:break;case 21:break;default:ds(S,m),ks(m)}}function ks(m){var S=m.flags;if(S&2){try{for(var A,L=m.return;L!==null;){if(jd(L)){A=L;break}L=L.return}if(A==null)throw Error(r(160));switch(A.tag){case 27:var ee=A.stateNode,fe=zf(m);iu(m,fe,ee);break;case 5:var He=A.stateNode;A.flags&32&&(bo(He,""),A.flags&=-33);var Je=zf(m);iu(m,Je,He);break;case 3:case 4:var St=A.stateNode.containerInfo,Jt=zf(m);ru(m,Jt,St);break;default:throw Error(r(161))}}catch(vn){Ct(m,m.return,vn)}m.flags&=-3}S&4096&&(m.flags&=-4097)}function cf(m){if(m.subtreeFlags&1024)for(m=m.child;m!==null;){var S=m;cf(S),S.tag===5&&S.flags&1024&&S.stateNode.reset(),m=m.sibling}}function ui(m,S){if(S.subtreeFlags&8772)for(S=S.child;S!==null;)cd(m,S.alternate,S),S=S.sibling}function au(m){for(m=m.child;m!==null;){var S=m;switch(S.tag){case 0:case 11:case 14:case 15:Zi(4,S,S.return),au(S);break;case 1:vl(S,S.return);var A=S.stateNode;typeof A.componentWillUnmount=="function"&&so(S,S.return,A),au(S);break;case 27:mR(S.stateNode);case 26:case 5:vl(S,S.return),au(S);break;case 22:S.memoizedState===null&&au(S);break;case 30:au(S);break;default:au(S)}m=m.sibling}}function Sh(m,S,A){for(A=A&&(S.subtreeFlags&8772)!==0,S=S.child;S!==null;){var L=S.alternate,ee=m,fe=S,He=fe.flags;switch(fe.tag){case 0:case 11:case 15:Sh(ee,fe,A),Uc(4,fe);break;case 1:if(Sh(ee,fe,A),L=fe,ee=L.stateNode,typeof ee.componentDidMount=="function")try{ee.componentDidMount()}catch(Jt){Ct(L,L.return,Jt)}if(L=fe,ee=L.updateQueue,ee!==null){var Je=L.stateNode;try{var St=ee.shared.hiddenCallbacks;if(St!==null)for(ee.shared.hiddenCallbacks=null,ee=0;ee<St.length;ee++)Qc(St[ee],Je)}catch(Jt){Ct(L,L.return,Jt)}}A&&He&64&&Zr(fe),vh(fe,fe.return);break;case 27:yh(fe);case 26:case 5:Sh(ee,fe,A),A&&L===null&&He&4&&_a(fe),vh(fe,fe.return);break;case 12:Sh(ee,fe,A);break;case 13:Sh(ee,fe,A),A&&He&4&&bh(ee,fe);break;case 22:fe.memoizedState===null&&Sh(ee,fe,A),vh(fe,fe.return);break;case 30:break;default:Sh(ee,fe,A)}S=S.sibling}}function fd(m,S){var A=null;m!==null&&m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(A=m.memoizedState.cachePool.pool),m=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(m=S.memoizedState.cachePool.pool),m!==A&&(m!=null&&m.refCount++,A!=null&&Yl(A))}function hm(m,S){m=null,S.alternate!==null&&(m=S.alternate.memoizedState.cache),S=S.memoizedState.cache,S!==m&&(S.refCount++,m!=null&&Yl(m))}function va(m,S,A,L){if(S.subtreeFlags&10256)for(S=S.child;S!==null;)jf(m,S,A,L),S=S.sibling}function jf(m,S,A,L){var ee=S.flags;switch(S.tag){case 0:case 11:case 15:va(m,S,A,L),ee&2048&&Uc(9,S);break;case 1:va(m,S,A,L);break;case 3:va(m,S,A,L),ee&2048&&(m=null,S.alternate!==null&&(m=S.alternate.memoizedState.cache),S=S.memoizedState.cache,S!==m&&(S.refCount++,m!=null&&Yl(m)));break;case 12:if(ee&2048){va(m,S,A,L),m=S.stateNode;try{var fe=S.memoizedProps,He=fe.id,Je=fe.onPostCommit;typeof Je=="function"&&Je(He,S.alternate===null?"mount":"update",m.passiveEffectDuration,-0)}catch(St){Ct(S,S.return,St)}}else va(m,S,A,L);break;case 13:va(m,S,A,L);break;case 23:break;case 22:fe=S.stateNode,He=S.alternate,S.memoizedState!==null?fe._visibility&2?va(m,S,A,L):j(m,S):fe._visibility&2?va(m,S,A,L):(fe._visibility|=2,Du(m,S,A,L,(S.subtreeFlags&10256)!==0)),ee&2048&&fd(He,S);break;case 24:va(m,S,A,L),ee&2048&&hm(S.alternate,S);break;default:va(m,S,A,L)}}function Du(m,S,A,L,ee){for(ee=ee&&(S.subtreeFlags&10256)!==0,S=S.child;S!==null;){var fe=m,He=S,Je=A,St=L,Jt=He.flags;switch(He.tag){case 0:case 11:case 15:Du(fe,He,Je,St,ee),Uc(8,He);break;case 23:break;case 22:var vn=He.stateNode;He.memoizedState!==null?vn._visibility&2?Du(fe,He,Je,St,ee):j(fe,He):(vn._visibility|=2,Du(fe,He,Je,St,ee)),ee&&Jt&2048&&fd(He.alternate,He);break;case 24:Du(fe,He,Je,St,ee),ee&&Jt&2048&&hm(He.alternate,He);break;default:Du(fe,He,Je,St,ee)}S=S.sibling}}function j(m,S){if(S.subtreeFlags&10256)for(S=S.child;S!==null;){var A=m,L=S,ee=L.flags;switch(L.tag){case 22:j(A,L),ee&2048&&fd(L.alternate,L);break;case 24:j(A,L),ee&2048&&hm(L.alternate,L);break;default:j(A,L)}S=S.sibling}}var C=8192;function P(m){if(m.subtreeFlags&C)for(m=m.child;m!==null;)H(m),m=m.sibling}function H(m){switch(m.tag){case 26:P(m),m.flags&C&&m.memoizedState!==null&&Z1e(Qs,m.memoizedState,m.memoizedProps);break;case 5:P(m);break;case 3:case 4:var S=Qs;Qs=v3(m.stateNode.containerInfo),P(m),Qs=S;break;case 22:m.memoizedState===null&&(S=m.alternate,S!==null&&S.memoizedState!==null?(S=C,C=16777216,P(m),C=S):P(m));break;default:P(m)}}function X(m){var S=m.alternate;if(S!==null&&(m=S.child,m!==null)){S.child=null;do S=m.sibling,m.sibling=null,m=S;while(m!==null)}}function te(m){var S=m.deletions;if((m.flags&16)!==0){if(S!==null)for(var A=0;A<S.length;A++){var L=S[A];Gs=L,w(L,m)}X(m)}if(m.subtreeFlags&10256)for(m=m.child;m!==null;)ue(m),m=m.sibling}function ue(m){switch(m.tag){case 0:case 11:case 15:te(m),m.flags&2048&&Zi(9,m,m.return);break;case 3:te(m);break;case 12:te(m);break;case 22:var S=m.stateNode;m.memoizedState!==null&&S._visibility&2&&(m.return===null||m.return.tag!==13)?(S._visibility&=-3,Ee(m)):te(m);break;default:te(m)}}function Ee(m){var S=m.deletions;if((m.flags&16)!==0){if(S!==null)for(var A=0;A<S.length;A++){var L=S[A];Gs=L,w(L,m)}X(m)}for(m=m.child;m!==null;){switch(S=m,S.tag){case 0:case 11:case 15:Zi(8,S,S.return),Ee(S);break;case 22:A=S.stateNode,A._visibility&2&&(A._visibility&=-3,Ee(S));break;default:Ee(S)}m=m.sibling}}function w(m,S){for(;Gs!==null;){var A=Gs;switch(A.tag){case 0:case 11:case 15:Zi(8,A,S);break;case 23:case 22:if(A.memoizedState!==null&&A.memoizedState.cachePool!==null){var L=A.memoizedState.cachePool.pool;L!=null&&L.refCount++}break;case 24:Yl(A.memoizedState.cache)}if(L=A.child,L!==null)L.return=A,Gs=L;else e:for(A=m;Gs!==null;){L=Gs;var ee=L.sibling,fe=L.return;if(_i(L),L===A){Gs=null;break e}if(ee!==null){ee.return=fe,Gs=ee;break e}Gs=fe}}}var h={getCacheForType:function(m){var S=Na(yr),A=S.data.get(m);return A===void 0&&(A=m(),S.data.set(m,A)),A}},b=typeof WeakMap=="function"?WeakMap:Map,k=0,F=null,ie=null,pe=0,ye=0,Ae=null,De=!1,Fe=!1,Ye=!1,dt=0,Et=0,Pt=0,bt=0,gt=0,Ot=0,wt=0,It=null,Ft=null,Zt=!1,Gt=0,$t=1/0,dn=null,Rn=null,Nn=0,qn=null,Dn=null,gr=0,Ur=0,Ci=null,ai=null,oi=0,Bi=null;function Wr(){if((k&2)!==0&&pe!==0)return pe&-pe;if(W.T!==null){var m=Fr;return m!==0?m:u5()}return _t()}function bs(){Ot===0&&(Ot=(pe&536870912)===0||ei?Ve():536870912);var m=qs.current;return m!==null&&(m.flags|=32),Ot}function li(m,S,A){(m===F&&(ye===2||ye===9)||m.cancelPendingCommit!==null)&&(Pl(m,0),Is(m,pe,Ot,!1)),nt(m,A),((k&2)===0||m!==F)&&(m===F&&((k&2)===0&&(bt|=A),Et===4&&Is(m,pe,Ot,!1)),vg(m))}function Os(m,S,A){if((k&6)!==0)throw Error(r(327));var L=!A&&(S&124)===0&&(S&m.expiredLanes)===0||Re(m,S),ee=L?re(m,S):R(m,S,!0),fe=L;do{if(ee===0){Fe&&!L&&Is(m,S,0,!1);break}else{if(A=m.current.alternate,fe&&!Js(A)){ee=R(m,S,!1),fe=!1;continue}if(ee===2){if(fe=S,m.errorRecoveryDisabledLanes&fe)var He=0;else He=m.pendingLanes&-536870913,He=He!==0?He:He&536870912?536870912:0;if(He!==0){S=He;e:{var Je=m;ee=It;var St=Je.current.memoizedState.isDehydrated;if(St&&(Pl(Je,He).flags|=256),He=R(Je,He,!1),He!==2){if(Ye&&!St){Je.errorRecoveryDisabledLanes|=fe,bt|=fe,ee=4;break e}fe=Ft,Ft=ee,fe!==null&&(Ft===null?Ft=fe:Ft.push.apply(Ft,fe))}ee=He}if(fe=!1,ee!==2)continue}}if(ee===1){Pl(m,0),Is(m,S,0,!0);break}e:{switch(L=m,fe=ee,fe){case 0:case 1:throw Error(r(345));case 4:if((S&4194048)!==S)break;case 6:Is(L,S,Ot,!De);break e;case 2:Ft=null;break;case 3:case 5:break;default:throw Error(r(329))}if((S&62914560)===S&&(ee=Gt+300-ze(),10<ee)){if(Is(L,S,Ot,!De),ke(L,0,!0)!==0)break e;L.timeoutHandle=RG(Vi.bind(null,L,A,Ft,dn,Zt,S,Ot,bt,wt,De,fe,2,-0,0),ee);break e}Vi(L,A,Ft,dn,Zt,S,Ot,bt,wt,De,fe,0,-0,0)}}break}while(!0);vg(m)}function Vi(m,S,A,L,ee,fe,He,Je,St,Jt,vn,xn,rn,on){if(m.timeoutHandle=-1,xn=S.subtreeFlags,(xn&8192||(xn&16785408)===16785408)&&(vR={stylesheets:null,count:0,unsuspend:K1e},H(S),xn=Q1e(),xn!==null)){m.cancelPendingCommit=xn(Ln.bind(null,m,S,fe,A,L,ee,He,Je,St,vn,1,rn,on)),Is(m,fe,He,!Jt);return}Ln(m,S,fe,A,L,ee,He,Je,St)}function Js(m){for(var S=m;;){var A=S.tag;if((A===0||A===11||A===15)&&S.flags&16384&&(A=S.updateQueue,A!==null&&(A=A.stores,A!==null)))for(var L=0;L<A.length;L++){var ee=A[L],fe=ee.getSnapshot;ee=ee.value;try{if(!uo(fe(),ee))return!1}catch{return!1}}if(A=S.child,S.subtreeFlags&16384&&A!==null)A.return=S,S=A;else{if(S===m)break;for(;S.sibling===null;){if(S.return===null||S.return===m)return!0;S=S.return}S.sibling.return=S.return,S=S.sibling}}return!0}function Is(m,S,A,L){S&=~gt,S&=~bt,m.suspendedLanes|=S,m.pingedLanes&=~S,L&&(m.warmLanes|=S),L=m.expirationTimes;for(var ee=S;0<ee;){var fe=31-Ut(ee),He=1<<fe;L[fe]=-1,ee&=~He}A!==0&&Qe(m,A,S)}function ps(){return(k&6)===0?(nS(0),!1):!0}function _o(){if(ie!==null){if(ye===0)var m=ie.return;else m=ie,Kc=Nf=null,vp(m),Sp=null,fm=0,m=ie;for(;m!==null;)_l(m.alternate,m),m=m.return;ie=null}}function Pl(m,S){var A=m.timeoutHandle;A!==-1&&(m.timeoutHandle=-1,N1e(A)),A=m.cancelPendingCommit,A!==null&&(m.cancelPendingCommit=null,A()),_o(),F=m,ie=A=ga(m.current,null),pe=S,ye=0,Ae=null,De=!1,Fe=Re(m,S),Ye=!1,wt=Ot=gt=bt=Pt=Et=0,Ft=It=null,Zt=!1,(S&8)!==0&&(S|=S&32);var L=m.entangledLanes;if(L!==0)for(m=m.entanglements,L&=S;0<L;){var ee=31-Ut(L),fe=1<<ee;S|=m[ee],L&=~fe}return dt=S,ho(),A}function gc(m,S){Kr=null,W.H=sd,S===Id||S===eo?(S=tf(),ye=3):S===wu?(S=tf(),ye=4):ye=S===wa?8:S!==null&&typeof S=="object"&&typeof S.then=="function"?6:1,Ae=S,ie===null&&(Et=1,Ff(m,Ja(S,m.current)))}function ou(){var m=W.H;return W.H=sd,m===null?sd:m}function Lu(){var m=W.A;return W.A=h,m}function T(){Et=4,De||(pe&4194048)!==pe&&qs.current!==null||(Fe=!0),(Pt&134217727)===0&&(bt&134217727)===0||F===null||Is(F,pe,Ot,!1)}function R(m,S,A){var L=k;k|=2;var ee=ou(),fe=Lu();(F!==m||pe!==S)&&(dn=null,Pl(m,S)),S=!1;var He=Et;e:do try{if(ye!==0&&ie!==null){var Je=ie,St=Ae;switch(ye){case 8:_o(),He=6;break e;case 3:case 2:case 9:case 6:qs.current===null&&(S=!0);var Jt=ye;if(ye=0,Ae=null,yt(m,Je,St,Jt),A&&Fe){He=0;break e}break;default:Jt=ye,ye=0,Ae=null,yt(m,Je,St,Jt)}}z(),He=Et;break}catch(vn){gc(m,vn)}while(!0);return S&&m.shellSuspendCounter++,Kc=Nf=null,k=L,W.H=ee,W.A=fe,ie===null&&(F=null,pe=0,ho()),He}function z(){for(;ie!==null;)Te(ie)}function re(m,S){var A=k;k|=2;var L=ou(),ee=Lu();F!==m||pe!==S?(dn=null,$t=ze()+500,Pl(m,S)):Fe=Re(m,S);e:do try{if(ye!==0&&ie!==null){S=ie;var fe=Ae;t:switch(ye){case 1:ye=0,Ae=null,yt(m,S,fe,1);break;case 2:case 9:if(Dc(fe)){ye=0,Ae=null,et(S);break}S=function(){ye!==2&&ye!==9||F!==m||(ye=7),vg(m)},fe.then(S,S);break e;case 3:ye=7;break e;case 4:ye=5;break e;case 7:Dc(fe)?(ye=0,Ae=null,et(S)):(ye=0,Ae=null,yt(m,S,fe,7));break;case 5:var He=null;switch(ie.tag){case 26:He=ie.memoizedState;case 5:case 27:var Je=ie;if(!He||BG(He)){ye=0,Ae=null;var St=Je.sibling;if(St!==null)ie=St;else{var Jt=Je.return;Jt!==null?(ie=Jt,zt(Jt)):ie=null}break t}}ye=0,Ae=null,yt(m,S,fe,5);break;case 6:ye=0,Ae=null,yt(m,S,fe,6);break;case 8:_o(),Et=6;break e;default:throw Error(r(462))}}he();break}catch(vn){gc(m,vn)}while(!0);return Kc=Nf=null,W.H=L,W.A=ee,k=A,ie!==null?0:(F=null,pe=0,ho(),Et)}function he(){for(;ie!==null&&!Ue();)Te(ie)}function Te(m){var S=nu(m.alternate,m,dt);m.memoizedProps=m.pendingProps,S===null?zt(m):ie=S}function et(m){var S=m,A=S.alternate;switch(S.tag){case 15:case 0:S=qi(A,S,S.pendingProps,S.type,void 0,pe);break;case 11:S=qi(A,S,S.pendingProps,S.type.render,S.ref,pe);break;case 5:vp(S);default:_l(A,S),S=ie=dp(S,dt),S=nu(A,S,dt)}m.memoizedProps=m.pendingProps,S===null?zt(m):ie=S}function yt(m,S,A,L){Kc=Nf=null,vp(S),Sp=null,fm=0;var ee=S.return;try{if(aa(m,ee,S,A,pe)){Et=1,Ff(m,Ja(A,m.current)),ie=null;return}}catch(fe){if(ee!==null)throw ie=ee,fe;Et=1,Ff(m,Ja(A,m.current)),ie=null;return}S.flags&32768?(ei||L===1?m=!0:Fe||(pe&536870912)!==0?m=!1:(De=m=!0,(L===2||L===9||L===3||L===6)&&(L=qs.current,L!==null&&L.tag===13&&(L.flags|=16384))),mn(S,m)):zt(S)}function zt(m){var S=m;do{if((S.flags&32768)!==0){mn(S,De);return}m=S.return;var A=xp(S.alternate,S,dt);if(A!==null){ie=A;return}if(S=S.sibling,S!==null){ie=S;return}ie=S=m}while(S!==null);Et===0&&(Et=5)}function mn(m,S){do{var A=gl(m.alternate,m);if(A!==null){A.flags&=32767,ie=A;return}if(A=m.return,A!==null&&(A.flags|=32768,A.subtreeFlags=0,A.deletions=null),!S&&(m=m.sibling,m!==null)){ie=m;return}ie=m=A}while(m!==null);Et=6,ie=null}function Ln(m,S,A,L,ee,fe,He,Je,St){m.cancelPendingCommit=null;do hd();while(Nn!==0);if((k&6)!==0)throw Error(r(327));if(S!==null){if(S===m.current)throw Error(r(177));if(fe=S.lanes|S.childLanes,fe|=fo,vt(m,A,fe,He,Je,St),m===F&&(ie=F=null,pe=0),Dn=S,qn=m,gr=A,Ur=fe,Ci=ee,ai=L,(S.subtreeFlags&10256)!==0||(S.flags&10256)!==0?(m.callbackNode=null,m.callbackPriority=0,Ss(Ie,function(){return dd(),null})):(m.callbackNode=null,m.callbackPriority=0),L=(S.flags&13878)!==0,(S.subtreeFlags&13878)!==0||L){L=W.T,W.T=null,ee=q.p,q.p=2,He=k,k|=4;try{Oo(m,S,A)}finally{k=He,q.p=ee,W.T=L}}Nn=1,Jn(),nr(),Yr()}}function Jn(){if(Nn===1){Nn=0;var m=qn,S=Dn,A=(S.flags&13878)!==0;if((S.subtreeFlags&13878)!==0||A){A=W.T,W.T=null;var L=q.p;q.p=2;var ee=k;k|=4;try{ec(S,m);var fe=v5,He=mi(m.containerInfo),Je=fe.focusedElem,St=fe.selectionRange;if(He!==Je&&Je&&Je.ownerDocument&&Xg(Je.ownerDocument.documentElement,Je)){if(St!==null&&Xi(Je)){var Jt=St.start,vn=St.end;if(vn===void 0&&(vn=Jt),"selectionStart"in Je)Je.selectionStart=Jt,Je.selectionEnd=Math.min(vn,Je.value.length);else{var xn=Je.ownerDocument||document,rn=xn&&xn.defaultView||window;if(rn.getSelection){var on=rn.getSelection(),Mi=Je.textContent.length,fi=Math.min(St.start,Mi),Yo=St.end===void 0?fi:Math.min(St.end,Mi);!on.extend&&fi>Yo&&(He=Yo,Yo=fi,fi=He);var Ht=ig(Je,fi),Nt=ig(Je,Yo);if(Ht&&Nt&&(on.rangeCount!==1||on.anchorNode!==Ht.node||on.anchorOffset!==Ht.offset||on.focusNode!==Nt.node||on.focusOffset!==Nt.offset)){var Xt=xn.createRange();Xt.setStart(Ht.node,Ht.offset),on.removeAllRanges(),fi>Yo?(on.addRange(Xt),on.extend(Nt.node,Nt.offset)):(Xt.setEnd(Nt.node,Nt.offset),on.addRange(Xt))}}}}for(xn=[],on=Je;on=on.parentNode;)on.nodeType===1&&xn.push({element:on,left:on.scrollLeft,top:on.scrollTop});for(typeof Je.focus=="function"&&Je.focus(),Je=0;Je<xn.length;Je++){var bn=xn[Je];bn.element.scrollLeft=bn.left,bn.element.scrollTop=bn.top}}x3=!!_5,v5=_5=null}finally{k=ee,q.p=L,W.T=A}}m.current=S,Nn=2}}function nr(){if(Nn===2){Nn=0;var m=qn,S=Dn,A=(S.flags&8772)!==0;if((S.subtreeFlags&8772)!==0||A){A=W.T,W.T=null;var L=q.p;q.p=2;var ee=k;k|=4;try{cd(m,S.alternate,S)}finally{k=ee,q.p=L,W.T=A}}Nn=3}}function Yr(){if(Nn===4||Nn===3){Nn=0,Ge();var m=qn,S=Dn,A=gr,L=ai;(S.subtreeFlags&10256)!==0||(S.flags&10256)!==0?Nn=5:(Nn=0,Dn=qn=null,lu(m,m.pendingLanes));var ee=m.pendingLanes;if(ee===0&&(Rn=null),ft(A),S=S.stateNode,Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ct,S,void 0,(S.current.flags&128)===128)}catch{}if(L!==null){S=W.T,ee=q.p,q.p=2,W.T=null;try{for(var fe=m.onRecoverableError,He=0;He<L.length;He++){var Je=L[He];fe(Je.value,{componentStack:Je.stack})}}finally{W.T=S,q.p=ee}}(gr&3)!==0&&hd(),vg(m),ee=m.pendingLanes,(A&4194090)!==0&&(ee&42)!==0?m===Bi?oi++:(oi=0,Bi=m):oi=0,nS(0)}}function lu(m,S){(m.pooledCacheLanes&=S)===0&&(S=m.pooledCache,S!=null&&(m.pooledCache=null,Yl(S)))}function hd(m){return Jn(),nr(),Yr(),dd()}function dd(){if(Nn!==5)return!1;var m=qn,S=Ur;Ur=0;var A=ft(gr),L=W.T,ee=q.p;try{q.p=32>A?32:A,W.T=null,A=Ci,Ci=null;var fe=qn,He=gr;if(Nn=0,Dn=qn=null,gr=0,(k&6)!==0)throw Error(r(331));var Je=k;if(k|=4,ue(fe.current),jf(fe,fe.current,He,A),k=Je,nS(0,!1),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ct,fe)}catch{}return!0}finally{q.p=ee,W.T=L,lu(m,S)}}function Qt(m,S,A){S=Ja(A,S),S=wr(m.stateNode,S,2),m=Pf(m,S,2),m!==null&&(nt(m,2),vg(m))}function Ct(m,S,A){if(m.tag===3)Qt(m,m,A);else for(;S!==null;){if(S.tag===3){Qt(S,m,A);break}else if(S.tag===1){var L=S.stateNode;if(typeof S.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(Rn===null||!Rn.has(L))){m=Ja(A,m),A=pc(2),L=Pf(S,A,2),L!==null&&(Li(A,L,S,m),nt(L,2),vg(L));break}}S=S.return}}function nn(m,S,A){var L=m.pingCache;if(L===null){L=m.pingCache=new b;var ee=new Set;L.set(S,ee)}else ee=L.get(S),ee===void 0&&(ee=new Set,L.set(S,ee));ee.has(A)||(Ye=!0,ee.add(A),m=Un.bind(null,m,S,A),S.then(m,m))}function Un(m,S,A){var L=m.pingCache;L!==null&&L.delete(S),m.pingedLanes|=m.suspendedLanes&A,m.warmLanes&=~A,F===m&&(pe&A)===A&&(Et===4||Et===3&&(pe&62914560)===pe&&300>ze()-Gt?(k&2)===0&&Pl(m,0):gt|=A,wt===pe&&(wt=0)),vg(m)}function Mr(m,S){S===0&&(S=tt()),m=Ei(m,S),m!==null&&(nt(m,S),vg(m))}function ya(m){var S=m.memoizedState,A=0;S!==null&&(A=S.retryLane),Mr(m,A)}function Xr(m,S){var A=0;switch(m.tag){case 13:var L=m.stateNode,ee=m.memoizedState;ee!==null&&(A=ee.retryLane);break;case 19:L=m.stateNode;break;case 22:L=m.stateNode._retryCache;break;default:throw Error(r(314))}L!==null&&L.delete(S),Mr(m,A)}function Ss(m,S){return pt(m,S)}var Aa=null,Qi=null,pd=!1,r_=!1,fR=!1,J_=0;function vg(m){m!==Qi&&m.next===null&&(Qi===null?Aa=Qi=m:Qi=Qi.next=m),r_=!0,pd||(pd=!0,T1e())}function nS(m,S){if(!fR&&r_){fR=!0;do for(var A=!1,L=Aa;L!==null;){if(m!==0){var ee=L.pendingLanes;if(ee===0)var fe=0;else{var He=L.suspendedLanes,Je=L.pingedLanes;fe=(1<<31-Ut(42|m)+1)-1,fe&=ee&~(He&~Je),fe=fe&201326741?fe&201326741|1:fe?fe|2:0}fe!==0&&(A=!0,d3(L,fe))}else fe=pe,fe=ke(L,L===F?fe:0,L.cancelPendingCommit!==null||L.timeoutHandle!==-1),(fe&3)===0||Re(L,fe)||(A=!0,d3(L,fe));L=L.next}while(A);fR=!1}}function f3(){hR()}function hR(){r_=pd=!1;var m=0;J_!==0&&(I1e()&&(m=J_),J_=0);for(var S=ze(),A=null,L=Aa;L!==null;){var ee=L.next,fe=h3(L,S);fe===0?(L.next=null,A===null?Aa=ee:A.next=ee,ee===null&&(Qi=A)):(A=L,(m!==0||(fe&3)!==0)&&(r_=!0)),L=ee}nS(m)}function h3(m,S){for(var A=m.suspendedLanes,L=m.pingedLanes,ee=m.expirationTimes,fe=m.pendingLanes&-62914561;0<fe;){var He=31-Ut(fe),Je=1<<He,St=ee[He];St===-1?((Je&A)===0||(Je&L)!==0)&&(ee[He]=st(Je,S)):St<=S&&(m.expiredLanes|=Je),fe&=~Je}if(S=F,A=pe,A=ke(m,m===S?A:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),L=m.callbackNode,A===0||m===S&&(ye===2||ye===9)||m.cancelPendingCommit!==null)return L!==null&&L!==null&&oe(L),m.callbackNode=null,m.callbackPriority=0;if((A&3)===0||Re(m,A)){if(S=A&-A,S===m.callbackPriority)return S;switch(L!==null&&oe(L),ft(A)){case 2:case 8:A=Se;break;case 32:A=Ie;break;case 268435456:A=Ke;break;default:A=Ie}return L=ay.bind(null,m),A=pt(A,L),m.callbackPriority=S,m.callbackNode=A,S}return L!==null&&L!==null&&oe(L),m.callbackPriority=2,m.callbackNode=null,2}function ay(m,S){if(Nn!==0&&Nn!==5)return m.callbackNode=null,m.callbackPriority=0,null;var A=m.callbackNode;if(hd()&&m.callbackNode!==A)return null;var L=pe;return L=ke(m,m===F?L:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),L===0?null:(Os(m,L,S),h3(m,ze()),m.callbackNode!=null&&m.callbackNode===A?ay.bind(null,m):null)}function d3(m,S){if(hd())return null;Os(m,S,!0)}function T1e(){P1e(function(){(k&6)!==0?pt(me,f3):hR()})}function u5(){return J_===0&&(J_=Ve()),J_}function _G(m){return m==null||typeof m=="symbol"||typeof m=="boolean"?null:typeof m=="function"?m:rh(""+m)}function vG(m,S){var A=S.ownerDocument.createElement("input");return A.name=S.name,A.value=S.value,m.id&&A.setAttribute("form",m.id),S.parentNode.insertBefore(A,S),m=new FormData(m),A.parentNode.removeChild(A),m}function w1e(m,S,A,L,ee){if(S==="submit"&&A&&A.stateNode===ee){var fe=_G((ee[Yt]||null).action),He=L.submitter;He&&(S=(S=He[Yt]||null)?_G(S.formAction):He.getAttribute("formAction"),S!==null&&(fe=S,He=null));var Je=new sh("action","action",null,L,ee);m.push({event:Je,listeners:[{instance:null,listener:function(){if(L.defaultPrevented){if(J_!==0){var St=He?vG(ee,He):new FormData(ee);hg(A,{pending:!0,data:St,method:ee.method,action:fe},null,St)}}else typeof fe=="function"&&(Je.preventDefault(),St=He?vG(ee,He):new FormData(ee),hg(A,{pending:!0,data:St,method:ee.method,action:fe},fe,St))},currentTarget:ee}]})}}for(var f5=0;f5<Br.length;f5++){var h5=Br[f5],R1e=h5.toLowerCase(),A1e=h5[0].toUpperCase()+h5.slice(1);ve(R1e,"on"+A1e)}ve(Rs,"onAnimationEnd"),ve(Kg,"onAnimationIteration"),ve(Xs,"onAnimationStart"),ve("dblclick","onDoubleClick"),ve("focusin","onFocus"),ve("focusout","onBlur"),ve(K0,"onTransitionRun"),ve(Rl,"onTransitionStart"),ve(hp,"onTransitionCancel"),ve(zo,"onTransitionEnd"),We("onMouseEnter",["mouseout","mouseover"]),We("onMouseLeave",["mouseout","mouseover"]),We("onPointerEnter",["pointerout","pointerover"]),We("onPointerLeave",["pointerout","pointerover"]),os("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),os("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),os("onBeforeInput",["compositionend","keypress","textInput","paste"]),os("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),os("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),os("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dR="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),C1e=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dR));function yG(m,S){S=(S&4)!==0;for(var A=0;A<m.length;A++){var L=m[A],ee=L.event;L=L.listeners;e:{var fe=void 0;if(S)for(var He=L.length-1;0<=He;He--){var Je=L[He],St=Je.instance,Jt=Je.currentTarget;if(Je=Je.listener,St!==fe&&ee.isPropagationStopped())break e;fe=Je,ee.currentTarget=Jt;try{fe(ee)}catch(vn){zd(vn)}ee.currentTarget=null,fe=St}else for(He=0;He<L.length;He++){if(Je=L[He],St=Je.instance,Jt=Je.currentTarget,Je=Je.listener,St!==fe&&ee.isPropagationStopped())break e;fe=Je,ee.currentTarget=Jt;try{fe(ee)}catch(vn){zd(vn)}ee.currentTarget=null,fe=St}}}}function ea(m,S){var A=S[fn];A===void 0&&(A=S[fn]=new Set);var L=m+"__bubble";A.has(L)||(bG(S,m,2,!1),A.add(L))}function d5(m,S,A){var L=0;S&&(L|=4),bG(A,m,L,S)}var p3="_reactListening"+Math.random().toString(36).slice(2);function p5(m){if(!m[p3]){m[p3]=!0,ws.forEach(function(A){A!=="selectionchange"&&(C1e.has(A)||d5(A,!1,m),d5(A,!0,m))});var S=m.nodeType===9?m:m.ownerDocument;S===null||S[p3]||(S[p3]=!0,d5("selectionchange",!1,S))}}function bG(m,S,A,L){switch(VG(S)){case 2:var ee=tSe;break;case 8:ee=nSe;break;default:ee=C5}A=ee.bind(null,S,A,m),ee=void 0,!Yi||S!=="touchstart"&&S!=="touchmove"&&S!=="wheel"||(ee=!0),L?ee!==void 0?m.addEventListener(S,A,{capture:!0,passive:ee}):m.addEventListener(S,A,!0):ee!==void 0?m.addEventListener(S,A,{passive:ee}):m.addEventListener(S,A,!1)}function m5(m,S,A,L,ee){var fe=L;if((S&1)===0&&(S&2)===0&&L!==null)e:for(;;){if(L===null)return;var He=L.tag;if(He===3||He===4){var Je=L.stateNode.containerInfo;if(Je===ee)break;if(He===4)for(He=L.return;He!==null;){var St=He.tag;if((St===3||St===4)&&He.stateNode.containerInfo===ee)return;He=He.return}for(;Je!==null;){if(He=as(Je),He===null)return;if(St=He.tag,St===5||St===6||St===26||St===27){L=fe=He;continue e}Je=Je.parentNode}}L=L.return}Gc(function(){var Jt=fe,vn=ac(A),xn=[];e:{var rn=lc.get(m);if(rn!==void 0){var on=sh,Mi=m;switch(m){case"keypress":if($c(A)===0)break e;case"keydown":case"keyup":on=qh;break;case"focusin":Mi="focus",on=Jm;break;case"focusout":Mi="blur",on=Jm;break;case"beforeblur":case"afterblur":on=Jm;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":on=Vl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":on=Kp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":on=tn;break;case Rs:case Kg:case Xs:on=V_;break;case zo:on=Zn;break;case"scroll":case"scrollend":on=Qm;break;case"wheel":on=sl;break;case"copy":case"cut":case"paste":on=jh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":on=Tt;break;case"toggle":case"beforetoggle":on=So}var fi=(S&4)!==0,Yo=!fi&&(m==="scroll"||m==="scrollend"),Ht=fi?rn!==null?rn+"Capture":null:rn;fi=[];for(var Nt=Jt,Xt;Nt!==null;){var bn=Nt;if(Xt=bn.stateNode,bn=bn.tag,bn!==5&&bn!==26&&bn!==27||Xt===null||Ht===null||(bn=$u(Nt,Ht),bn!=null&&fi.push(pR(Nt,bn,Xt))),Yo)break;Nt=Nt.return}0<fi.length&&(rn=new on(rn,Mi,null,A,vn),xn.push({event:rn,listeners:fi}))}}if((S&7)===0){e:{if(rn=m==="mouseover"||m==="pointerover",on=m==="mouseout"||m==="pointerout",rn&&A!==Tl&&(Mi=A.relatedTarget||A.fromElement)&&(as(Mi)||Mi[Mt]))break e;if((on||rn)&&(rn=vn.window===vn?vn:(rn=vn.ownerDocument)?rn.defaultView||rn.parentWindow:window,on?(Mi=A.relatedTarget||A.toElement,on=Jt,Mi=Mi?as(Mi):null,Mi!==null&&(Yo=s(Mi),fi=Mi.tag,Mi!==Yo||fi!==5&&fi!==27&&fi!==6)&&(Mi=null)):(on=null,Mi=Jt),on!==Mi)){if(fi=Vl,bn="onMouseLeave",Ht="onMouseEnter",Nt="mouse",(m==="pointerout"||m==="pointerover")&&(fi=Tt,bn="onPointerLeave",Ht="onPointerEnter",Nt="pointer"),Yo=on==null?rn:Oi(on),Xt=Mi==null?rn:Oi(Mi),rn=new fi(bn,Nt+"leave",on,A,vn),rn.target=Yo,rn.relatedTarget=Xt,bn=null,as(vn)===Jt&&(fi=new fi(Ht,Nt+"enter",Mi,A,vn),fi.target=Xt,fi.relatedTarget=Yo,bn=fi),Yo=bn,on&&Mi)t:{for(fi=on,Ht=Mi,Nt=0,Xt=fi;Xt;Xt=gx(Xt))Nt++;for(Xt=0,bn=Ht;bn;bn=gx(bn))Xt++;for(;0<Nt-Xt;)fi=gx(fi),Nt--;for(;0<Xt-Nt;)Ht=gx(Ht),Xt--;for(;Nt--;){if(fi===Ht||Ht!==null&&fi===Ht.alternate)break t;fi=gx(fi),Ht=gx(Ht)}fi=null}else fi=null;on!==null&&SG(xn,rn,on,fi,!1),Mi!==null&&Yo!==null&&SG(xn,Yo,Mi,fi,!0)}}e:{if(rn=Jt?Oi(Jt):window,on=rn.nodeName&&rn.nodeName.toLowerCase(),on==="select"||on==="input"&&rn.type==="file")var kr=uh;else if(ng(rn))if(Zp)kr=Mc;else{kr=$_;var $s=G_}else on=rn.nodeName,!on||on.toLowerCase()!=="input"||rn.type!=="checkbox"&&rn.type!=="radio"?Jt&&lp(Jt.elementType)&&(kr=uh):kr=rg;if(kr&&(kr=kr(m,Jt))){Eo(xn,kr,A,vn);break e}$s&&$s(m,rn,Jt),m==="focusout"&&Jt&&rn.type==="number"&&Jt.memoizedProps.value!=null&&Xn(rn,"number",rn.value)}switch($s=Jt?Oi(Jt):window,m){case"focusin":(ng($s)||$s.contentEditable==="true")&&(hh=$s,fp=Jt,Fn=null);break;case"focusout":Fn=fp=hh=null;break;case"mousedown":zs=!0;break;case"contextmenu":case"mouseup":case"dragend":zs=!1,Mf(xn,A,vn);break;case"selectionchange":if(sg)break;case"keydown":case"keyup":Mf(xn,A,vn)}var Gr;if(ns)e:{switch(m){case"compositionstart":var vi="onCompositionStart";break e;case"compositionend":vi="onCompositionEnd";break e;case"compositionupdate":vi="onCompositionUpdate";break e}vi=void 0}else ch?vr(m,A)&&(vi="onCompositionEnd"):m==="keydown"&&A.keyCode===229&&(vi="onCompositionStart");vi&&(sr&&A.locale!=="ko"&&(ch||vi!=="onCompositionStart"?vi==="onCompositionEnd"&&ch&&(Gr=co()):(Ef=vn,Zm="value"in Ef?Ef.value:Ef.textContent,ch=!0)),$s=m3(Jt,vi),0<$s.length&&(vi=new Yu(vi,m,null,A,vn),xn.push({event:vi,listeners:$s}),Gr?vi.data=Gr:(Gr=Vr(A),Gr!==null&&(vi.data=Gr)))),(Gr=lh?Rf(m,A):X0(m,A))&&(vi=m3(Jt,"onBeforeInput"),0<vi.length&&($s=new Yu("onBeforeInput","beforeinput",null,A,vn),xn.push({event:$s,listeners:vi}),$s.data=Gr)),w1e(xn,m,Jt,A,vn)}yG(xn,S)})}function pR(m,S,A){return{instance:m,listener:S,currentTarget:A}}function m3(m,S){for(var A=S+"Capture",L=[];m!==null;){var ee=m,fe=ee.stateNode;if(ee=ee.tag,ee!==5&&ee!==26&&ee!==27||fe===null||(ee=$u(m,A),ee!=null&&L.unshift(pR(m,ee,fe)),ee=$u(m,S),ee!=null&&L.push(pR(m,ee,fe))),m.tag===3)return L;m=m.return}return[]}function gx(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5&&m.tag!==27);return m||null}function SG(m,S,A,L,ee){for(var fe=S._reactName,He=[];A!==null&&A!==L;){var Je=A,St=Je.alternate,Jt=Je.stateNode;if(Je=Je.tag,St!==null&&St===L)break;Je!==5&&Je!==26&&Je!==27||Jt===null||(St=Jt,ee?(Jt=$u(A,fe),Jt!=null&&He.unshift(pR(A,Jt,St))):ee||(Jt=$u(A,fe),Jt!=null&&He.push(pR(A,Jt,St)))),A=A.return}He.length!==0&&m.push({event:S,listeners:He})}var M1e=/\r\n?/g,k1e=/\u0000|\uFFFD/g;function EG(m){return(typeof m=="string"?m:""+m).replace(M1e,`
`).replace(k1e,"")}function xG(m,S){return S=EG(S),EG(m)===S}function g3(){}function Wo(m,S,A,L,ee,fe){switch(A){case"children":typeof L=="string"?S==="body"||S==="textarea"&&L===""||bo(m,L):(typeof L=="number"||typeof L=="bigint")&&S!=="body"&&bo(m,""+L);break;case"className":zn(m,"class",L);break;case"tabIndex":zn(m,"tabindex",L);break;case"dir":case"role":case"viewBox":case"width":case"height":zn(m,A,L);break;case"style":zh(m,L,fe);break;case"data":if(S!=="object"){zn(m,"data",L);break}case"src":case"href":if(L===""&&(S!=="a"||A!=="href")){m.removeAttribute(A);break}if(L==null||typeof L=="function"||typeof L=="symbol"||typeof L=="boolean"){m.removeAttribute(A);break}L=rh(""+L),m.setAttribute(A,L);break;case"action":case"formAction":if(typeof L=="function"){m.setAttribute(A,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof fe=="function"&&(A==="formAction"?(S!=="input"&&Wo(m,S,"name",ee.name,ee,null),Wo(m,S,"formEncType",ee.formEncType,ee,null),Wo(m,S,"formMethod",ee.formMethod,ee,null),Wo(m,S,"formTarget",ee.formTarget,ee,null)):(Wo(m,S,"encType",ee.encType,ee,null),Wo(m,S,"method",ee.method,ee,null),Wo(m,S,"target",ee.target,ee,null)));if(L==null||typeof L=="symbol"||typeof L=="boolean"){m.removeAttribute(A);break}L=rh(""+L),m.setAttribute(A,L);break;case"onClick":L!=null&&(m.onclick=g3);break;case"onScroll":L!=null&&ea("scroll",m);break;case"onScrollEnd":L!=null&&ea("scrollend",m);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(r(61));if(A=L.__html,A!=null){if(ee.children!=null)throw Error(r(60));m.innerHTML=A}}break;case"multiple":m.multiple=L&&typeof L!="function"&&typeof L!="symbol";break;case"muted":m.muted=L&&typeof L!="function"&&typeof L!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(L==null||typeof L=="function"||typeof L=="boolean"||typeof L=="symbol"){m.removeAttribute("xlink:href");break}A=rh(""+L),m.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",A);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":L!=null&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,""+L):m.removeAttribute(A);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":L&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,""):m.removeAttribute(A);break;case"capture":case"download":L===!0?m.setAttribute(A,""):L!==!1&&L!=null&&typeof L!="function"&&typeof L!="symbol"?m.setAttribute(A,L):m.removeAttribute(A);break;case"cols":case"rows":case"size":case"span":L!=null&&typeof L!="function"&&typeof L!="symbol"&&!isNaN(L)&&1<=L?m.setAttribute(A,L):m.removeAttribute(A);break;case"rowSpan":case"start":L==null||typeof L=="function"||typeof L=="symbol"||isNaN(L)?m.removeAttribute(A):m.setAttribute(A,L);break;case"popover":ea("beforetoggle",m),ea("toggle",m),yn(m,"popover",L);break;case"xlinkActuate":En(m,"http://www.w3.org/1999/xlink","xlink:actuate",L);break;case"xlinkArcrole":En(m,"http://www.w3.org/1999/xlink","xlink:arcrole",L);break;case"xlinkRole":En(m,"http://www.w3.org/1999/xlink","xlink:role",L);break;case"xlinkShow":En(m,"http://www.w3.org/1999/xlink","xlink:show",L);break;case"xlinkTitle":En(m,"http://www.w3.org/1999/xlink","xlink:title",L);break;case"xlinkType":En(m,"http://www.w3.org/1999/xlink","xlink:type",L);break;case"xmlBase":En(m,"http://www.w3.org/XML/1998/namespace","xml:base",L);break;case"xmlLang":En(m,"http://www.w3.org/XML/1998/namespace","xml:lang",L);break;case"xmlSpace":En(m,"http://www.w3.org/XML/1998/namespace","xml:space",L);break;case"is":yn(m,"is",L);break;case"innerText":case"textContent":break;default:(!(2<A.length)||A[0]!=="o"&&A[0]!=="O"||A[1]!=="n"&&A[1]!=="N")&&(A=Wp.get(A)||A,yn(m,A,L))}}function g5(m,S,A,L,ee,fe){switch(A){case"style":zh(m,L,fe);break;case"dangerouslySetInnerHTML":if(L!=null){if(typeof L!="object"||!("__html"in L))throw Error(r(61));if(A=L.__html,A!=null){if(ee.children!=null)throw Error(r(60));m.innerHTML=A}}break;case"children":typeof L=="string"?bo(m,L):(typeof L=="number"||typeof L=="bigint")&&bo(m,""+L);break;case"onScroll":L!=null&&ea("scroll",m);break;case"onScrollEnd":L!=null&&ea("scrollend",m);break;case"onClick":L!=null&&(m.onclick=g3);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!na.hasOwnProperty(A))e:{if(A[0]==="o"&&A[1]==="n"&&(ee=A.endsWith("Capture"),S=A.slice(2,ee?A.length-7:void 0),fe=m[Yt]||null,fe=fe!=null?fe[A]:null,typeof fe=="function"&&m.removeEventListener(S,fe,ee),typeof L=="function")){typeof fe!="function"&&fe!==null&&(A in m?m[A]=null:m.hasAttribute(A)&&m.removeAttribute(A)),m.addEventListener(S,L,ee);break e}A in m?m[A]=L:L===!0?m.setAttribute(A,""):yn(m,A,L)}}}function md(m,S,A){switch(S){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ea("error",m),ea("load",m);var L=!1,ee=!1,fe;for(fe in A)if(A.hasOwnProperty(fe)){var He=A[fe];if(He!=null)switch(fe){case"src":L=!0;break;case"srcSet":ee=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,S));default:Wo(m,S,fe,He,A,null)}}ee&&Wo(m,S,"srcSet",A.srcSet,A,null),L&&Wo(m,S,"src",A.src,A,null);return;case"input":ea("invalid",m);var Je=fe=He=ee=null,St=null,Jt=null;for(L in A)if(A.hasOwnProperty(L)){var vn=A[L];if(vn!=null)switch(L){case"name":ee=vn;break;case"type":He=vn;break;case"checked":St=vn;break;case"defaultChecked":Jt=vn;break;case"value":fe=vn;break;case"defaultValue":Je=vn;break;case"children":case"dangerouslySetInnerHTML":if(vn!=null)throw Error(r(137,S));break;default:Wo(m,S,L,vn,A,null)}}cs(m,fe,Je,St,Jt,He,ee,!1),Pr(m);return;case"select":ea("invalid",m),L=He=fe=null;for(ee in A)if(A.hasOwnProperty(ee)&&(Je=A[ee],Je!=null))switch(ee){case"value":fe=Je;break;case"defaultValue":He=Je;break;case"multiple":L=Je;default:Wo(m,S,ee,Je,A,null)}S=fe,A=He,m.multiple=!!L,S!=null?Jr(m,!!L,S,!1):A!=null&&Jr(m,!!L,A,!0);return;case"textarea":ea("invalid",m),fe=ee=L=null;for(He in A)if(A.hasOwnProperty(He)&&(Je=A[He],Je!=null))switch(He){case"value":L=Je;break;case"defaultValue":ee=Je;break;case"children":fe=Je;break;case"dangerouslySetInnerHTML":if(Je!=null)throw Error(r(91));break;default:Wo(m,S,He,Je,A,null)}Fs(m,L,ee,fe),Pr(m);return;case"option":for(St in A)if(A.hasOwnProperty(St)&&(L=A[St],L!=null))switch(St){case"selected":m.selected=L&&typeof L!="function"&&typeof L!="symbol";break;default:Wo(m,S,St,L,A,null)}return;case"dialog":ea("beforetoggle",m),ea("toggle",m),ea("cancel",m),ea("close",m);break;case"iframe":case"object":ea("load",m);break;case"video":case"audio":for(L=0;L<dR.length;L++)ea(dR[L],m);break;case"image":ea("error",m),ea("load",m);break;case"details":ea("toggle",m);break;case"embed":case"source":case"link":ea("error",m),ea("load",m);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Jt in A)if(A.hasOwnProperty(Jt)&&(L=A[Jt],L!=null))switch(Jt){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,S));default:Wo(m,S,Jt,L,A,null)}return;default:if(lp(S)){for(vn in A)A.hasOwnProperty(vn)&&(L=A[vn],L!==void 0&&g5(m,S,vn,L,A,void 0));return}}for(Je in A)A.hasOwnProperty(Je)&&(L=A[Je],L!=null&&Wo(m,S,Je,L,A,null))}function O1e(m,S,A,L){switch(S){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var ee=null,fe=null,He=null,Je=null,St=null,Jt=null,vn=null;for(on in A){var xn=A[on];if(A.hasOwnProperty(on)&&xn!=null)switch(on){case"checked":break;case"value":break;case"defaultValue":St=xn;default:L.hasOwnProperty(on)||Wo(m,S,on,null,L,xn)}}for(var rn in L){var on=L[rn];if(xn=A[rn],L.hasOwnProperty(rn)&&(on!=null||xn!=null))switch(rn){case"type":fe=on;break;case"name":ee=on;break;case"checked":Jt=on;break;case"defaultChecked":vn=on;break;case"value":He=on;break;case"defaultValue":Je=on;break;case"children":case"dangerouslySetInnerHTML":if(on!=null)throw Error(r(137,S));break;default:on!==xn&&Wo(m,S,rn,on,L,xn)}}Lo(m,He,Je,St,Jt,vn,fe,ee);return;case"select":on=He=Je=rn=null;for(fe in A)if(St=A[fe],A.hasOwnProperty(fe)&&St!=null)switch(fe){case"value":break;case"multiple":on=St;default:L.hasOwnProperty(fe)||Wo(m,S,fe,null,L,St)}for(ee in L)if(fe=L[ee],St=A[ee],L.hasOwnProperty(ee)&&(fe!=null||St!=null))switch(ee){case"value":rn=fe;break;case"defaultValue":Je=fe;break;case"multiple":He=fe;default:fe!==St&&Wo(m,S,ee,fe,L,St)}S=Je,A=He,L=on,rn!=null?Jr(m,!!A,rn,!1):!!L!=!!A&&(S!=null?Jr(m,!!A,S,!0):Jr(m,!!A,A?[]:"",!1));return;case"textarea":on=rn=null;for(Je in A)if(ee=A[Je],A.hasOwnProperty(Je)&&ee!=null&&!L.hasOwnProperty(Je))switch(Je){case"value":break;case"children":break;default:Wo(m,S,Je,null,L,ee)}for(He in L)if(ee=L[He],fe=A[He],L.hasOwnProperty(He)&&(ee!=null||fe!=null))switch(He){case"value":rn=ee;break;case"defaultValue":on=ee;break;case"children":break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(91));break;default:ee!==fe&&Wo(m,S,He,ee,L,fe)}ur(m,rn,on);return;case"option":for(var Mi in A)if(rn=A[Mi],A.hasOwnProperty(Mi)&&rn!=null&&!L.hasOwnProperty(Mi))switch(Mi){case"selected":m.selected=!1;break;default:Wo(m,S,Mi,null,L,rn)}for(St in L)if(rn=L[St],on=A[St],L.hasOwnProperty(St)&&rn!==on&&(rn!=null||on!=null))switch(St){case"selected":m.selected=rn&&typeof rn!="function"&&typeof rn!="symbol";break;default:Wo(m,S,St,rn,L,on)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var fi in A)rn=A[fi],A.hasOwnProperty(fi)&&rn!=null&&!L.hasOwnProperty(fi)&&Wo(m,S,fi,null,L,rn);for(Jt in L)if(rn=L[Jt],on=A[Jt],L.hasOwnProperty(Jt)&&rn!==on&&(rn!=null||on!=null))switch(Jt){case"children":case"dangerouslySetInnerHTML":if(rn!=null)throw Error(r(137,S));break;default:Wo(m,S,Jt,rn,L,on)}return;default:if(lp(S)){for(var Yo in A)rn=A[Yo],A.hasOwnProperty(Yo)&&rn!==void 0&&!L.hasOwnProperty(Yo)&&g5(m,S,Yo,void 0,L,rn);for(vn in L)rn=L[vn],on=A[vn],!L.hasOwnProperty(vn)||rn===on||rn===void 0&&on===void 0||g5(m,S,vn,rn,L,on);return}}for(var Ht in A)rn=A[Ht],A.hasOwnProperty(Ht)&&rn!=null&&!L.hasOwnProperty(Ht)&&Wo(m,S,Ht,null,L,rn);for(xn in L)rn=L[xn],on=A[xn],!L.hasOwnProperty(xn)||rn===on||rn==null&&on==null||Wo(m,S,xn,rn,L,on)}var _5=null,v5=null;function _3(m){return m.nodeType===9?m:m.ownerDocument}function TG(m){switch(m){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wG(m,S){if(m===0)switch(S){case"svg":return 1;case"math":return 2;default:return 0}return m===1&&S==="foreignObject"?0:m}function y5(m,S){return m==="textarea"||m==="noscript"||typeof S.children=="string"||typeof S.children=="number"||typeof S.children=="bigint"||typeof S.dangerouslySetInnerHTML=="object"&&S.dangerouslySetInnerHTML!==null&&S.dangerouslySetInnerHTML.__html!=null}var b5=null;function I1e(){var m=window.event;return m&&m.type==="popstate"?m===b5?!1:(b5=m,!0):(b5=null,!1)}var RG=typeof setTimeout=="function"?setTimeout:void 0,N1e=typeof clearTimeout=="function"?clearTimeout:void 0,AG=typeof Promise=="function"?Promise:void 0,P1e=typeof queueMicrotask=="function"?queueMicrotask:typeof AG<"u"?function(m){return AG.resolve(null).then(m).catch(D1e)}:RG;function D1e(m){setTimeout(function(){throw m})}function Ab(m){return m==="head"}function CG(m,S){var A=S,L=0,ee=0;do{var fe=A.nextSibling;if(m.removeChild(A),fe&&fe.nodeType===8)if(A=fe.data,A==="/$"){if(0<L&&8>L){A=L;var He=m.ownerDocument;if(A&1&&mR(He.documentElement),A&2&&mR(He.body),A&4)for(A=He.head,mR(A),He=A.firstChild;He;){var Je=He.nextSibling,St=He.nodeName;He[$n]||St==="SCRIPT"||St==="STYLE"||St==="LINK"&&He.rel.toLowerCase()==="stylesheet"||A.removeChild(He),He=Je}}if(ee===0){m.removeChild(fe),xR(S);return}ee--}else A==="$"||A==="$?"||A==="$!"?ee++:L=A.charCodeAt(0)-48;else L=0;A=fe}while(A);xR(S)}function S5(m){var S=m.firstChild;for(S&&S.nodeType===10&&(S=S.nextSibling);S;){var A=S;switch(S=S.nextSibling,A.nodeName){case"HTML":case"HEAD":case"BODY":S5(A),er(A);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(A.rel.toLowerCase()==="stylesheet")continue}m.removeChild(A)}}function L1e(m,S,A,L){for(;m.nodeType===1;){var ee=A;if(m.nodeName.toLowerCase()!==S.toLowerCase()){if(!L&&(m.nodeName!=="INPUT"||m.type!=="hidden"))break}else if(L){if(!m[$n])switch(S){case"meta":if(!m.hasAttribute("itemprop"))break;return m;case"link":if(fe=m.getAttribute("rel"),fe==="stylesheet"&&m.hasAttribute("data-precedence"))break;if(fe!==ee.rel||m.getAttribute("href")!==(ee.href==null||ee.href===""?null:ee.href)||m.getAttribute("crossorigin")!==(ee.crossOrigin==null?null:ee.crossOrigin)||m.getAttribute("title")!==(ee.title==null?null:ee.title))break;return m;case"style":if(m.hasAttribute("data-precedence"))break;return m;case"script":if(fe=m.getAttribute("src"),(fe!==(ee.src==null?null:ee.src)||m.getAttribute("type")!==(ee.type==null?null:ee.type)||m.getAttribute("crossorigin")!==(ee.crossOrigin==null?null:ee.crossOrigin))&&fe&&m.hasAttribute("async")&&!m.hasAttribute("itemprop"))break;return m;default:return m}}else if(S==="input"&&m.type==="hidden"){var fe=ee.name==null?null:""+ee.name;if(ee.type==="hidden"&&m.getAttribute("name")===fe)return m}else return m;if(m=i_(m.nextSibling),m===null)break}return null}function U1e(m,S,A){if(S==="")return null;for(;m.nodeType!==3;)if((m.nodeType!==1||m.nodeName!=="INPUT"||m.type!=="hidden")&&!A||(m=i_(m.nextSibling),m===null))return null;return m}function E5(m){return m.data==="$!"||m.data==="$?"&&m.ownerDocument.readyState==="complete"}function B1e(m,S){var A=m.ownerDocument;if(m.data!=="$?"||A.readyState==="complete")S();else{var L=function(){S(),A.removeEventListener("DOMContentLoaded",L)};A.addEventListener("DOMContentLoaded",L),m._reactRetry=L}}function i_(m){for(;m!=null;m=m.nextSibling){var S=m.nodeType;if(S===1||S===3)break;if(S===8){if(S=m.data,S==="$"||S==="$!"||S==="$?"||S==="F!"||S==="F")break;if(S==="/$")return null}}return m}var x5=null;function MG(m){m=m.previousSibling;for(var S=0;m;){if(m.nodeType===8){var A=m.data;if(A==="$"||A==="$!"||A==="$?"){if(S===0)return m;S--}else A==="/$"&&S++}m=m.previousSibling}return null}function kG(m,S,A){switch(S=_3(A),m){case"html":if(m=S.documentElement,!m)throw Error(r(452));return m;case"head":if(m=S.head,!m)throw Error(r(453));return m;case"body":if(m=S.body,!m)throw Error(r(454));return m;default:throw Error(r(451))}}function mR(m){for(var S=m.attributes;S.length;)m.removeAttributeNode(S[0]);er(m)}var c0=new Map,OG=new Set;function v3(m){return typeof m.getRootNode=="function"?m.getRootNode():m.nodeType===9?m:m.ownerDocument}var oy=q.d;q.d={f:F1e,r:z1e,D:j1e,C:H1e,L:q1e,m:V1e,X:$1e,S:G1e,M:W1e};function F1e(){var m=oy.f(),S=ps();return m||S}function z1e(m){var S=di(m);S!==null&&S.tag===5&&S.type==="form"?s0(S):oy.r(m)}var _x=typeof document>"u"?null:document;function IG(m,S,A){var L=_x;if(L&&typeof S=="string"&&S){var ee=ls(S);ee='link[rel="'+m+'"][href="'+ee+'"]',typeof A=="string"&&(ee+='[crossorigin="'+A+'"]'),OG.has(ee)||(OG.add(ee),m={rel:m,crossOrigin:A,href:S},L.querySelector(ee)===null&&(S=L.createElement("link"),md(S,"link",m),pi(S),L.head.appendChild(S)))}}function j1e(m){oy.D(m),IG("dns-prefetch",m,null)}function H1e(m,S){oy.C(m,S),IG("preconnect",m,S)}function q1e(m,S,A){oy.L(m,S,A);var L=_x;if(L&&m&&S){var ee='link[rel="preload"][as="'+ls(S)+'"]';S==="image"&&A&&A.imageSrcSet?(ee+='[imagesrcset="'+ls(A.imageSrcSet)+'"]',typeof A.imageSizes=="string"&&(ee+='[imagesizes="'+ls(A.imageSizes)+'"]')):ee+='[href="'+ls(m)+'"]';var fe=ee;switch(S){case"style":fe=vx(m);break;case"script":fe=yx(m)}c0.has(fe)||(m=u({rel:"preload",href:S==="image"&&A&&A.imageSrcSet?void 0:m,as:S},A),c0.set(fe,m),L.querySelector(ee)!==null||S==="style"&&L.querySelector(gR(fe))||S==="script"&&L.querySelector(_R(fe))||(S=L.createElement("link"),md(S,"link",m),pi(S),L.head.appendChild(S)))}}function V1e(m,S){oy.m(m,S);var A=_x;if(A&&m){var L=S&&typeof S.as=="string"?S.as:"script",ee='link[rel="modulepreload"][as="'+ls(L)+'"][href="'+ls(m)+'"]',fe=ee;switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":fe=yx(m)}if(!c0.has(fe)&&(m=u({rel:"modulepreload",href:m},S),c0.set(fe,m),A.querySelector(ee)===null)){switch(L){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(A.querySelector(_R(fe)))return}L=A.createElement("link"),md(L,"link",m),pi(L),A.head.appendChild(L)}}}function G1e(m,S,A){oy.S(m,S,A);var L=_x;if(L&&m){var ee=Bs(L).hoistableStyles,fe=vx(m);S=S||"default";var He=ee.get(fe);if(!He){var Je={loading:0,preload:null};if(He=L.querySelector(gR(fe)))Je.loading=5;else{m=u({rel:"stylesheet",href:m,"data-precedence":S},A),(A=c0.get(fe))&&T5(m,A);var St=He=L.createElement("link");pi(St),md(St,"link",m),St._p=new Promise(function(Jt,vn){St.onload=Jt,St.onerror=vn}),St.addEventListener("load",function(){Je.loading|=1}),St.addEventListener("error",function(){Je.loading|=2}),Je.loading|=4,y3(He,S,L)}He={type:"stylesheet",instance:He,count:1,state:Je},ee.set(fe,He)}}}function $1e(m,S){oy.X(m,S);var A=_x;if(A&&m){var L=Bs(A).hoistableScripts,ee=yx(m),fe=L.get(ee);fe||(fe=A.querySelector(_R(ee)),fe||(m=u({src:m,async:!0},S),(S=c0.get(ee))&&w5(m,S),fe=A.createElement("script"),pi(fe),md(fe,"link",m),A.head.appendChild(fe)),fe={type:"script",instance:fe,count:1,state:null},L.set(ee,fe))}}function W1e(m,S){oy.M(m,S);var A=_x;if(A&&m){var L=Bs(A).hoistableScripts,ee=yx(m),fe=L.get(ee);fe||(fe=A.querySelector(_R(ee)),fe||(m=u({src:m,async:!0,type:"module"},S),(S=c0.get(ee))&&w5(m,S),fe=A.createElement("script"),pi(fe),md(fe,"link",m),A.head.appendChild(fe)),fe={type:"script",instance:fe,count:1,state:null},L.set(ee,fe))}}function NG(m,S,A,L){var ee=(ee=Me.current)?v3(ee):null;if(!ee)throw Error(r(446));switch(m){case"meta":case"title":return null;case"style":return typeof A.precedence=="string"&&typeof A.href=="string"?(S=vx(A.href),A=Bs(ee).hoistableStyles,L=A.get(S),L||(L={type:"style",instance:null,count:0,state:null},A.set(S,L)),L):{type:"void",instance:null,count:0,state:null};case"link":if(A.rel==="stylesheet"&&typeof A.href=="string"&&typeof A.precedence=="string"){m=vx(A.href);var fe=Bs(ee).hoistableStyles,He=fe.get(m);if(He||(ee=ee.ownerDocument||ee,He={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},fe.set(m,He),(fe=ee.querySelector(gR(m)))&&!fe._p&&(He.instance=fe,He.state.loading=5),c0.has(m)||(A={rel:"preload",as:"style",href:A.href,crossOrigin:A.crossOrigin,integrity:A.integrity,media:A.media,hrefLang:A.hrefLang,referrerPolicy:A.referrerPolicy},c0.set(m,A),fe||Y1e(ee,m,A,He.state))),S&&L===null)throw Error(r(528,""));return He}if(S&&L!==null)throw Error(r(529,""));return null;case"script":return S=A.async,A=A.src,typeof A=="string"&&S&&typeof S!="function"&&typeof S!="symbol"?(S=yx(A),A=Bs(ee).hoistableScripts,L=A.get(S),L||(L={type:"script",instance:null,count:0,state:null},A.set(S,L)),L):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,m))}}function vx(m){return'href="'+ls(m)+'"'}function gR(m){return'link[rel="stylesheet"]['+m+"]"}function PG(m){return u({},m,{"data-precedence":m.precedence,precedence:null})}function Y1e(m,S,A,L){m.querySelector('link[rel="preload"][as="style"]['+S+"]")?L.loading=1:(S=m.createElement("link"),L.preload=S,S.addEventListener("load",function(){return L.loading|=1}),S.addEventListener("error",function(){return L.loading|=2}),md(S,"link",A),pi(S),m.head.appendChild(S))}function yx(m){return'[src="'+ls(m)+'"]'}function _R(m){return"script[async]"+m}function DG(m,S,A){if(S.count++,S.instance===null)switch(S.type){case"style":var L=m.querySelector('style[data-href~="'+ls(A.href)+'"]');if(L)return S.instance=L,pi(L),L;var ee=u({},A,{"data-href":A.href,"data-precedence":A.precedence,href:null,precedence:null});return L=(m.ownerDocument||m).createElement("style"),pi(L),md(L,"style",ee),y3(L,A.precedence,m),S.instance=L;case"stylesheet":ee=vx(A.href);var fe=m.querySelector(gR(ee));if(fe)return S.state.loading|=4,S.instance=fe,pi(fe),fe;L=PG(A),(ee=c0.get(ee))&&T5(L,ee),fe=(m.ownerDocument||m).createElement("link"),pi(fe);var He=fe;return He._p=new Promise(function(Je,St){He.onload=Je,He.onerror=St}),md(fe,"link",L),S.state.loading|=4,y3(fe,A.precedence,m),S.instance=fe;case"script":return fe=yx(A.src),(ee=m.querySelector(_R(fe)))?(S.instance=ee,pi(ee),ee):(L=A,(ee=c0.get(fe))&&(L=u({},A),w5(L,ee)),m=m.ownerDocument||m,ee=m.createElement("script"),pi(ee),md(ee,"link",L),m.head.appendChild(ee),S.instance=ee);case"void":return null;default:throw Error(r(443,S.type))}else S.type==="stylesheet"&&(S.state.loading&4)===0&&(L=S.instance,S.state.loading|=4,y3(L,A.precedence,m));return S.instance}function y3(m,S,A){for(var L=A.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),ee=L.length?L[L.length-1]:null,fe=ee,He=0;He<L.length;He++){var Je=L[He];if(Je.dataset.precedence===S)fe=Je;else if(fe!==ee)break}fe?fe.parentNode.insertBefore(m,fe.nextSibling):(S=A.nodeType===9?A.head:A,S.insertBefore(m,S.firstChild))}function T5(m,S){m.crossOrigin==null&&(m.crossOrigin=S.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=S.referrerPolicy),m.title==null&&(m.title=S.title)}function w5(m,S){m.crossOrigin==null&&(m.crossOrigin=S.crossOrigin),m.referrerPolicy==null&&(m.referrerPolicy=S.referrerPolicy),m.integrity==null&&(m.integrity=S.integrity)}var b3=null;function LG(m,S,A){if(b3===null){var L=new Map,ee=b3=new Map;ee.set(A,L)}else ee=b3,L=ee.get(A),L||(L=new Map,ee.set(A,L));if(L.has(m))return L;for(L.set(m,null),A=A.getElementsByTagName(m),ee=0;ee<A.length;ee++){var fe=A[ee];if(!(fe[$n]||fe[Bt]||m==="link"&&fe.getAttribute("rel")==="stylesheet")&&fe.namespaceURI!=="http://www.w3.org/2000/svg"){var He=fe.getAttribute(S)||"";He=m+He;var Je=L.get(He);Je?Je.push(fe):L.set(He,[fe])}}return L}function UG(m,S,A){m=m.ownerDocument||m,m.head.insertBefore(A,S==="title"?m.querySelector("head > title"):null)}function X1e(m,S,A){if(A===1||S.itemProp!=null)return!1;switch(m){case"meta":case"title":return!0;case"style":if(typeof S.precedence!="string"||typeof S.href!="string"||S.href==="")break;return!0;case"link":if(typeof S.rel!="string"||typeof S.href!="string"||S.href===""||S.onLoad||S.onError)break;switch(S.rel){case"stylesheet":return m=S.disabled,typeof S.precedence=="string"&&m==null;default:return!0}case"script":if(S.async&&typeof S.async!="function"&&typeof S.async!="symbol"&&!S.onLoad&&!S.onError&&S.src&&typeof S.src=="string")return!0}return!1}function BG(m){return!(m.type==="stylesheet"&&(m.state.loading&3)===0)}var vR=null;function K1e(){}function Z1e(m,S,A){if(vR===null)throw Error(r(475));var L=vR;if(S.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(S.state.loading&4)===0){if(S.instance===null){var ee=vx(A.href),fe=m.querySelector(gR(ee));if(fe){m=fe._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(L.count++,L=S3.bind(L),m.then(L,L)),S.state.loading|=4,S.instance=fe,pi(fe);return}fe=m.ownerDocument||m,A=PG(A),(ee=c0.get(ee))&&T5(A,ee),fe=fe.createElement("link"),pi(fe);var He=fe;He._p=new Promise(function(Je,St){He.onload=Je,He.onerror=St}),md(fe,"link",A),S.instance=fe}L.stylesheets===null&&(L.stylesheets=new Map),L.stylesheets.set(S,m),(m=S.state.preload)&&(S.state.loading&3)===0&&(L.count++,S=S3.bind(L),m.addEventListener("load",S),m.addEventListener("error",S))}}function Q1e(){if(vR===null)throw Error(r(475));var m=vR;return m.stylesheets&&m.count===0&&R5(m,m.stylesheets),0<m.count?function(S){var A=setTimeout(function(){if(m.stylesheets&&R5(m,m.stylesheets),m.unsuspend){var L=m.unsuspend;m.unsuspend=null,L()}},6e4);return m.unsuspend=S,function(){m.unsuspend=null,clearTimeout(A)}}:null}function S3(){if(this.count--,this.count===0){if(this.stylesheets)R5(this,this.stylesheets);else if(this.unsuspend){var m=this.unsuspend;this.unsuspend=null,m()}}}var E3=null;function R5(m,S){m.stylesheets=null,m.unsuspend!==null&&(m.count++,E3=new Map,S.forEach(J1e,m),E3=null,S3.call(m))}function J1e(m,S){if(!(S.state.loading&4)){var A=E3.get(m);if(A)var L=A.get(null);else{A=new Map,E3.set(m,A);for(var ee=m.querySelectorAll("link[data-precedence],style[data-precedence]"),fe=0;fe<ee.length;fe++){var He=ee[fe];(He.nodeName==="LINK"||He.getAttribute("media")!=="not all")&&(A.set(He.dataset.precedence,He),L=He)}L&&A.set(null,L)}ee=S.instance,He=ee.getAttribute("data-precedence"),fe=A.get(He)||L,fe===L&&A.set(null,ee),A.set(He,ee),this.count++,L=S3.bind(this),ee.addEventListener("load",L),ee.addEventListener("error",L),fe?fe.parentNode.insertBefore(ee,fe.nextSibling):(m=m.nodeType===9?m.head:m,m.insertBefore(ee,m.firstChild)),S.state.loading|=4}}var yR={$$typeof:E,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function eSe(m,S,A,L,ee,fe,He,Je){this.tag=1,this.containerInfo=m,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ze(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ze(0),this.hiddenUpdates=Ze(null),this.identifierPrefix=L,this.onUncaughtError=ee,this.onCaughtError=fe,this.onRecoverableError=He,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Je,this.incompleteTransitions=new Map}function FG(m,S,A,L,ee,fe,He,Je,St,Jt,vn,xn){return m=new eSe(m,S,A,He,Je,St,Jt,xn),S=1,fe===!0&&(S|=24),fe=To(3,null,null,S),m.current=fe,fe.stateNode=m,S=ol(),S.refCount++,m.pooledCache=S,S.refCount++,fe.memoizedState={element:L,isDehydrated:A,cache:S},em(fe),m}function zG(m){return m?(m=If,m):If}function jG(m,S,A,L,ee,fe){ee=zG(ee),L.context===null?L.context=ee:L.pendingContext=ee,L=Au(S),L.payload={element:A},fe=fe===void 0?null:fe,fe!==null&&(L.callback=fe),A=Pf(m,L,S),A!==null&&(li(A,m,S),Zh(A,m,S))}function HG(m,S){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var A=m.retryLane;m.retryLane=A!==0&&A<S?A:S}}function A5(m,S){HG(m,S),(m=m.alternate)&&HG(m,S)}function qG(m){if(m.tag===13){var S=Ei(m,67108864);S!==null&&li(S,m,67108864),A5(m,67108864)}}var x3=!0;function tSe(m,S,A,L){var ee=W.T;W.T=null;var fe=q.p;try{q.p=2,C5(m,S,A,L)}finally{q.p=fe,W.T=ee}}function nSe(m,S,A,L){var ee=W.T;W.T=null;var fe=q.p;try{q.p=8,C5(m,S,A,L)}finally{q.p=fe,W.T=ee}}function C5(m,S,A,L){if(x3){var ee=M5(L);if(ee===null)m5(m,S,L,T3,A),GG(m,L);else if(iSe(ee,m,S,A,L))L.stopPropagation();else if(GG(m,L),S&4&&-1<rSe.indexOf(m)){for(;ee!==null;){var fe=di(ee);if(fe!==null)switch(fe.tag){case 3:if(fe=fe.stateNode,fe.current.memoizedState.isDehydrated){var He=Le(fe.pendingLanes);if(He!==0){var Je=fe;for(Je.pendingLanes|=2,Je.entangledLanes|=2;He;){var St=1<<31-Ut(He);Je.entanglements[1]|=St,He&=~St}vg(fe),(k&6)===0&&($t=ze()+500,nS(0))}}break;case 13:Je=Ei(fe,2),Je!==null&&li(Je,fe,2),ps(),A5(fe,2)}if(fe=M5(L),fe===null&&m5(m,S,L,T3,A),fe===ee)break;ee=fe}ee!==null&&L.stopPropagation()}else m5(m,S,L,null,A)}}function M5(m){return m=ac(m),k5(m)}var T3=null;function k5(m){if(T3=null,m=as(m),m!==null){var S=s(m);if(S===null)m=null;else{var A=S.tag;if(A===13){if(m=a(S),m!==null)return m;m=null}else if(A===3){if(S.stateNode.current.memoizedState.isDehydrated)return S.tag===3?S.stateNode.containerInfo:null;m=null}else S!==m&&(m=null)}}return T3=m,null}function VG(m){switch(m){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Be()){case me:return 2;case Se:return 8;case Ie:case be:return 32;case Ke:return 268435456;default:return 32}default:return 32}}var O5=!1,Cb=null,Mb=null,kb=null,bR=new Map,SR=new Map,Ob=[],rSe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function GG(m,S){switch(m){case"focusin":case"focusout":Cb=null;break;case"dragenter":case"dragleave":Mb=null;break;case"mouseover":case"mouseout":kb=null;break;case"pointerover":case"pointerout":bR.delete(S.pointerId);break;case"gotpointercapture":case"lostpointercapture":SR.delete(S.pointerId)}}function ER(m,S,A,L,ee,fe){return m===null||m.nativeEvent!==fe?(m={blockedOn:S,domEventName:A,eventSystemFlags:L,nativeEvent:fe,targetContainers:[ee]},S!==null&&(S=di(S),S!==null&&qG(S)),m):(m.eventSystemFlags|=L,S=m.targetContainers,ee!==null&&S.indexOf(ee)===-1&&S.push(ee),m)}function iSe(m,S,A,L,ee){switch(S){case"focusin":return Cb=ER(Cb,m,S,A,L,ee),!0;case"dragenter":return Mb=ER(Mb,m,S,A,L,ee),!0;case"mouseover":return kb=ER(kb,m,S,A,L,ee),!0;case"pointerover":var fe=ee.pointerId;return bR.set(fe,ER(bR.get(fe)||null,m,S,A,L,ee)),!0;case"gotpointercapture":return fe=ee.pointerId,SR.set(fe,ER(SR.get(fe)||null,m,S,A,L,ee)),!0}return!1}function $G(m){var S=as(m.target);if(S!==null){var A=s(S);if(A!==null){if(S=A.tag,S===13){if(S=a(A),S!==null){m.blockedOn=S,gn(m.priority,function(){if(A.tag===13){var L=Wr();L=mt(L);var ee=Ei(A,L);ee!==null&&li(ee,A,L),A5(A,L)}});return}}else if(S===3&&A.stateNode.current.memoizedState.isDehydrated){m.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}m.blockedOn=null}function w3(m){if(m.blockedOn!==null)return!1;for(var S=m.targetContainers;0<S.length;){var A=M5(m.nativeEvent);if(A===null){A=m.nativeEvent;var L=new A.constructor(A.type,A);Tl=L,A.target.dispatchEvent(L),Tl=null}else return S=di(A),S!==null&&qG(S),m.blockedOn=A,!1;S.shift()}return!0}function WG(m,S,A){w3(m)&&A.delete(S)}function sSe(){O5=!1,Cb!==null&&w3(Cb)&&(Cb=null),Mb!==null&&w3(Mb)&&(Mb=null),kb!==null&&w3(kb)&&(kb=null),bR.forEach(WG),SR.forEach(WG)}function R3(m,S){m.blockedOn===S&&(m.blockedOn=null,O5||(O5=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,sSe)))}var A3=null;function YG(m){A3!==m&&(A3=m,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){A3===m&&(A3=null);for(var S=0;S<m.length;S+=3){var A=m[S],L=m[S+1],ee=m[S+2];if(typeof L!="function"){if(k5(L||A)===null)continue;break}var fe=di(A);fe!==null&&(m.splice(S,3),S-=3,hg(fe,{pending:!0,data:ee,method:A.method,action:L},L,ee))}}))}function xR(m){function S(St){return R3(St,m)}Cb!==null&&R3(Cb,m),Mb!==null&&R3(Mb,m),kb!==null&&R3(kb,m),bR.forEach(S),SR.forEach(S);for(var A=0;A<Ob.length;A++){var L=Ob[A];L.blockedOn===m&&(L.blockedOn=null)}for(;0<Ob.length&&(A=Ob[0],A.blockedOn===null);)$G(A),A.blockedOn===null&&Ob.shift();if(A=(m.ownerDocument||m).$$reactFormReplay,A!=null)for(L=0;L<A.length;L+=3){var ee=A[L],fe=A[L+1],He=ee[Yt]||null;if(typeof fe=="function")He||YG(A);else if(He){var Je=null;if(fe&&fe.hasAttribute("formAction")){if(ee=fe,He=fe[Yt]||null)Je=He.formAction;else if(k5(ee)!==null)continue}else Je=He.action;typeof Je=="function"?A[L+1]=Je:(A.splice(L,3),L-=3),YG(A)}}}function I5(m){this._internalRoot=m}C3.prototype.render=I5.prototype.render=function(m){var S=this._internalRoot;if(S===null)throw Error(r(409));var A=S.current,L=Wr();jG(A,L,m,S,null,null)},C3.prototype.unmount=I5.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var S=m.containerInfo;jG(m.current,2,null,m,null,null),ps(),S[Mt]=null}};function C3(m){this._internalRoot=m}C3.prototype.unstable_scheduleHydration=function(m){if(m){var S=_t();m={blockedOn:null,target:m,priority:S};for(var A=0;A<Ob.length&&S!==0&&S<Ob[A].priority;A++);Ob.splice(A,0,m),A===0&&$G(m)}};var XG=e.version;if(XG!=="19.1.1")throw Error(r(527,XG,"19.1.1"));q.findDOMNode=function(m){var S=m._reactInternals;if(S===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=l(S),m=m!==null?c(m):null,m=m===null?null:m.stateNode,m};var aSe={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:W,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var M3=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!M3.isDisabled&&M3.supportsFiber)try{ct=M3.inject(aSe),Vt=M3}catch{}}return UR.createRoot=function(m,S){if(!i(m))throw Error(r(299));var A=!1,L="",ee=ml,fe=sa,He=Q_,Je=null;return S!=null&&(S.unstable_strictMode===!0&&(A=!0),S.identifierPrefix!==void 0&&(L=S.identifierPrefix),S.onUncaughtError!==void 0&&(ee=S.onUncaughtError),S.onCaughtError!==void 0&&(fe=S.onCaughtError),S.onRecoverableError!==void 0&&(He=S.onRecoverableError),S.unstable_transitionCallbacks!==void 0&&(Je=S.unstable_transitionCallbacks)),S=FG(m,1,!1,null,null,A,L,ee,fe,He,Je,null),m[Mt]=S.current,p5(m),new I5(S)},UR.hydrateRoot=function(m,S,A){if(!i(m))throw Error(r(299));var L=!1,ee="",fe=ml,He=sa,Je=Q_,St=null,Jt=null;return A!=null&&(A.unstable_strictMode===!0&&(L=!0),A.identifierPrefix!==void 0&&(ee=A.identifierPrefix),A.onUncaughtError!==void 0&&(fe=A.onUncaughtError),A.onCaughtError!==void 0&&(He=A.onCaughtError),A.onRecoverableError!==void 0&&(Je=A.onRecoverableError),A.unstable_transitionCallbacks!==void 0&&(St=A.unstable_transitionCallbacks),A.formState!==void 0&&(Jt=A.formState)),S=FG(m,1,!0,S,A??null,L,ee,fe,He,Je,St,Jt),S.context=zG(null),A=S.current,L=Wr(),L=mt(L),ee=Au(L),ee.callback=null,Pf(A,ee,L),A=L,S.current.lanes=A,nt(S,A),vg(S),m[Mt]=S.current,p5(m),new C3(S)},UR.version="19.1.1",UR}var aY;function Z2e(){if(aY)return U6.exports;aY=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),U6.exports=K2e(),U6.exports}var Q2e=Z2e(),IN={exports:{}},J2e=IN.exports,oY;function eke(){return oY||(oY=1,(function(n,e){(function(t,r){n.exports=r()})(J2e,function(){return t.importState=function(i){var s=new t;return s.importState(i),s},t;function t(){return(function(i){var s=0,a=0,o=0,l=1;i.length==0&&(i=[+new Date]);var c=r();s=c(" "),a=c(" "),o=c(" ");for(var u=0;u<i.length;u++)s-=c(i[u]),s<0&&(s+=1),a-=c(i[u]),a<0&&(a+=1),o-=c(i[u]),o<0&&(o+=1);c=null;var f=function(){var d=2091639*s+l*23283064365386963e-26;return s=a,a=o,o=d-(l=d|0)};return f.next=f,f.uint32=function(){return f()*4294967296},f.fract53=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.version="Alea 0.9",f.args=i,f.exportState=function(){return[s,a,o,l]},f.importState=function(d){s=+d[0]||0,a=+d[1]||0,o=+d[2]||0,l=+d[3]||0},f})(Array.prototype.slice.call(arguments))}function r(){var i=4022871197,s=function(a){a=a.toString();for(var o=0;o<a.length;o++){i+=a.charCodeAt(o);var l=.02519603282416938*i;i=l>>>0,l-=i,l*=i,i=l>>>0,l-=i,i+=l*4294967296}return(i>>>0)*23283064365386963e-26};return s.version="Mash 0.9",s}})})(IN)),IN.exports}var tke=eke();const ij=Bh(tke);new an;new an;function Di(n,e,t){return Math.max(e,Math.min(t,n))}function nke(n,e){return Di(n-Math.floor(n/e)*e,0,e)}function rke(n,e){var t=nke(e-n,Math.PI*2);return t>Math.PI&&(t-=Math.PI*2),t}function ike(n){return n/180*Math.PI}function ske(n){return n*180/Math.PI}const ake=ij("089fad0j9awfem09wavefc09uwaef");function lY(n){return 2*Math.floor(n/2)}function Qoe(n,e){return Math.round(n/e)*e}function oke(){return ake()}function lke(n){return ij(n)()}function Mg(n,e){const t=Math.min(n,e),i=Math.max(n,e)-t+1;return t+Math.floor(oke()*i)}function Joe(n,e,t){const r=Math.min(e,t),s=Math.max(e,t)-r+1;return r+Math.floor(lke(n)*s)}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */var cke=(function(){var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},n(e,t)};return function(e,t){n(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}})(),uke=Object.prototype.hasOwnProperty;function l7(n,e){return uke.call(n,e)}function c7(n){if(Array.isArray(n)){for(var e=new Array(n.length),t=0;t<e.length;t++)e[t]=""+t;return e}if(Object.keys)return Object.keys(n);var r=[];for(var i in n)l7(n,i)&&r.push(i);return r}function km(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function u7(n){for(var e=0,t=n.length,r;e<t;){if(r=n.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function NS(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function ele(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function f7(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(var e=0,t=n.length;e<t;e++)if(f7(n[e]))return!0}else if(typeof n=="object"){for(var r=c7(n),i=r.length,s=0;s<i;s++)if(f7(n[r[s]]))return!0}}return!1}function cY(n,e){var t=[n];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&t.push(r+": "+i)}return t.join(`
`)}var tle=(function(n){cke(e,n);function e(t,r,i,s,a){var o=this.constructor,l=n.call(this,cY(t,{name:r,index:i,operation:s,tree:a}))||this;return l.name=r,l.index=i,l.operation=s,l.tree=a,Object.setPrototypeOf(l,o.prototype),l.message=cY(t,{name:r,index:i,operation:s,tree:a}),l}return e})(Error),du=tle,fke=km,mT={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var r=n[e];return delete n[e],{newDocument:t,removed:r}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:function(n,e,t){var r=pD(t,this.path);r&&(r=km(r));var i=sE(t,{op:"remove",path:this.from}).removed;return sE(t,{op:"add",path:this.path,value:i}),{newDocument:t,removed:r}},copy:function(n,e,t){var r=pD(t,this.from);return sE(t,{op:"add",path:this.path,value:km(r)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:X2(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}},hke={add:function(n,e,t){return u7(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var r=n.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:mT.move,copy:mT.copy,test:mT.test,_get:mT._get};function pD(n,e){if(e=="")return n;var t={op:"_get",path:e};return sE(n,t),t.value}function sE(n,e,t,r,i,s){if(t===void 0&&(t=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),t&&(typeof t=="function"?t(e,0,n,e.path):mD(e,0)),e.path===""){var a={newDocument:n};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=n,a;if(e.op==="move"||e.op==="copy")return a.newDocument=pD(n,e.from),e.op==="move"&&(a.removed=n),a;if(e.op==="test"){if(a.test=X2(n,e.value),a.test===!1)throw new du("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a.newDocument=n,a}else{if(e.op==="remove")return a.removed=n,a.newDocument=null,a;if(e.op==="_get")return e.value=n,a;if(t)throw new du("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,n);return a}}else{r||(n=km(n));var o=e.path||"",l=o.split("/"),c=n,u=1,f=l.length,d=void 0,g=void 0,p=void 0;for(typeof t=="function"?p=t:p=mD;;){if(g=l[u],g&&g.indexOf("~")!=-1&&(g=ele(g)),i&&(g=="__proto__"||g=="prototype"&&u>0&&l[u-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&d===void 0&&(c[g]===void 0?d=l.slice(0,u).join("/"):u==f-1&&(d=e.path),d!==void 0&&p(e,0,n,d)),u++,Array.isArray(c)){if(g==="-")g=c.length;else{if(t&&!u7(g))throw new du("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,n);u7(g)&&(g=~~g)}if(u>=f){if(t&&e.op==="add"&&g>c.length)throw new du("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,n);var a=hke[e.op].call(e,c,g,n);if(a.test===!1)throw new du("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a}}else if(u>=f){var a=mT[e.op].call(e,c,g,n);if(a.test===!1)throw new du("Test operation failed","TEST_OPERATION_FAILED",s,e,n);return a}if(c=c[g],t&&u<f&&(!c||typeof c!="object"))throw new du("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",s,e,n)}}}function A4(n,e,t,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),t&&!Array.isArray(e))throw new du("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(n=km(n));for(var s=new Array(e.length),a=0,o=e.length;a<o;a++)s[a]=sE(n,e[a],t,!0,i,a),n=s[a].newDocument;return s.newDocument=n,s}function dke(n,e,t){var r=sE(n,e);if(r.test===!1)throw new du("Test operation failed","TEST_OPERATION_FAILED",t,e,n);return r.newDocument}function mD(n,e,t,r){if(typeof n!="object"||n===null||Array.isArray(n))throw new du("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(mT[n.op]){if(typeof n.path!="string")throw new du("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new du('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new du("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new du("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&f7(n.value))throw new du("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var i=n.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new du("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==r)throw new du("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var a={op:"_get",path:n.from,value:void 0},o=nle([a],t);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new du("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new du("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function nle(n,e,t){try{if(!Array.isArray(n))throw new du("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)A4(km(e),km(n),t||!0);else{t=t||mD;for(var r=0;r<n.length;r++)t(n[r],r,e,void 0)}}catch(i){if(i instanceof du)return i;throw i}}function X2(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),r=Array.isArray(e),i,s,a;if(t&&r){if(s=n.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!X2(n[i],e[i]))return!1;return!0}if(t!=r)return!1;var o=Object.keys(n);if(s=o.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(o[i]))return!1;for(i=s;i--!==0;)if(a=o[i],!X2(n[a],e[a]))return!1;return!0}return n!==n&&e!==e}const pke=Object.freeze(Object.defineProperty({__proto__:null,JsonPatchError:du,_areEquals:X2,applyOperation:sE,applyPatch:A4,applyReducer:dke,deepClone:fke,getValueByPointer:pD,validate:nle,validator:mD},Symbol.toStringTag,{value:"Module"}));/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2021 Joachim Wester
 * MIT license
 */var sj=new WeakMap,mke=(function(){function n(e){this.observers=new Map,this.obj=e}return n})(),gke=(function(){function n(e,t){this.callback=e,this.observer=t}return n})();function _ke(n){return sj.get(n)}function vke(n,e){return n.observers.get(e)}function yke(n,e){n.observers.delete(e.callback)}function bke(n,e){e.unobserve()}function Ske(n,e){var t=[],r,i=_ke(n);if(!i)i=new mke(n),sj.set(n,i);else{var s=vke(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=km(n),e){r.callback=e,r.next=null;var a=function(){h7(r)},o=function(){clearTimeout(r.next),r.next=setTimeout(a)};typeof window<"u"&&(window.addEventListener("mouseup",o),window.addEventListener("keyup",o),window.addEventListener("mousedown",o),window.addEventListener("keydown",o),window.addEventListener("change",o))}return r.patches=t,r.object=n,r.unobserve=function(){h7(r),clearTimeout(r.next),yke(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",o),window.removeEventListener("keyup",o),window.removeEventListener("mousedown",o),window.removeEventListener("keydown",o),window.removeEventListener("change",o))},i.observers.set(e,new gke(e,r)),r}function h7(n,e){e===void 0&&(e=!1);var t=sj.get(n.object);aj(t.value,n.object,n.patches,"",e),n.patches.length&&A4(t.value,n.patches);var r=n.patches;return r.length>0&&(n.patches=[],n.callback&&n.callback(r)),r}function aj(n,e,t,r,i){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=c7(e),a=c7(n),o=!1,l=a.length-1;l>=0;l--){var c=a[l],u=n[c];if(l7(e,c)&&!(e[c]===void 0&&u!==void 0&&Array.isArray(e)===!1)){var f=e[c];typeof u=="object"&&u!=null&&typeof f=="object"&&f!=null&&Array.isArray(u)===Array.isArray(f)?aj(u,f,t,r+"/"+NS(c),i):u!==f&&(i&&t.push({op:"test",path:r+"/"+NS(c),value:km(u)}),t.push({op:"replace",path:r+"/"+NS(c),value:km(f)}))}else Array.isArray(n)===Array.isArray(e)?(i&&t.push({op:"test",path:r+"/"+NS(c),value:km(u)}),t.push({op:"remove",path:r+"/"+NS(c)}),o=!0):(i&&t.push({op:"test",path:r,value:n}),t.push({op:"replace",path:r,value:e}))}if(!(!o&&s.length==a.length))for(var l=0;l<s.length;l++){var c=s[l];!l7(n,c)&&e[c]!==void 0&&t.push({op:"add",path:r+"/"+NS(c),value:km(e[c])})}}}function Eke(n,e,t){t===void 0&&(t=!1);var r=[];return aj(n,e,r,"",t),r}const xke=Object.freeze(Object.defineProperty({__proto__:null,compare:Eke,generate:h7,observe:Ske,unobserve:bke},Symbol.toStringTag,{value:"Module"}));Object.assign({},pke,xke,{JsonPatchError:tle,deepClone:km,escapePathComponent:NS,unescapePathComponent:ele});var j6,uY;function Tke(){if(uY)return j6;uY=1;var n=typeof Element<"u",e=typeof Map=="function",t=typeof Set=="function",r=typeof ArrayBuffer=="function"&&!!ArrayBuffer.isView;function i(s,a){if(s===a)return!0;if(s&&a&&typeof s=="object"&&typeof a=="object"){if(s.constructor!==a.constructor)return!1;var o,l,c;if(Array.isArray(s)){if(o=s.length,o!=a.length)return!1;for(l=o;l--!==0;)if(!i(s[l],a[l]))return!1;return!0}var u;if(e&&s instanceof Map&&a instanceof Map){if(s.size!==a.size)return!1;for(u=s.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;for(u=s.entries();!(l=u.next()).done;)if(!i(l.value[1],a.get(l.value[0])))return!1;return!0}if(t&&s instanceof Set&&a instanceof Set){if(s.size!==a.size)return!1;for(u=s.entries();!(l=u.next()).done;)if(!a.has(l.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(s)&&ArrayBuffer.isView(a)){if(o=s.length,o!=a.length)return!1;for(l=o;l--!==0;)if(s[l]!==a[l])return!1;return!0}if(s.constructor===RegExp)return s.source===a.source&&s.flags===a.flags;if(s.valueOf!==Object.prototype.valueOf&&typeof s.valueOf=="function"&&typeof a.valueOf=="function")return s.valueOf()===a.valueOf();if(s.toString!==Object.prototype.toString&&typeof s.toString=="function"&&typeof a.toString=="function")return s.toString()===a.toString();if(c=Object.keys(s),o=c.length,o!==Object.keys(a).length)return!1;for(l=o;l--!==0;)if(!Object.prototype.hasOwnProperty.call(a,c[l]))return!1;if(n&&s instanceof Element)return!1;for(l=o;l--!==0;)if(!((c[l]==="_owner"||c[l]==="__v"||c[l]==="__o")&&s.$$typeof)&&!i(s[c[l]],a[c[l]]))return!1;return!0}return s!==s&&a!==a}return j6=function(a,o){try{return i(a,o)}catch(l){if((l.message||"").match(/stack|recursion/i))return console.warn("react-fast-compare cannot handle circular refs"),!1;throw l}},j6}var wke=Tke();const Jb=Bh(wke);function xe(n){return n!=null}const Rke=Object.fromEntries,sb=Object.keys;function Sl(n){return km(n)}function Ake(n){return typeof n=="boolean"}function Mn(n){return typeof n=="number"&&isNaN(n)===!1}function Vn(n){return typeof n=="string"}function bi(n){return Array.isArray(n)}function bm(n){return n}function Cke(n){return typeof n=="object"&&Vn(n.session)&&Vn(n.player)&&Vn(n.id)&&Vn(n.sender)&&Vn(n.target)}function Mke(n){n.emit("","session_reset")}function Si(n,e,t,...r){return n.emit(e,"error",[`$red${t}$blue>>`,...r]),!1}function kke(n,e,...t){return n.emit(e,"info",t),!0}function xs(n,e,...t){return n.emit(e,"log",t),!0}function Oke(n,e,...t){return n.emit(e,"chat",t),!0}function rle(n,e,t){n.emit(e,"toast",t)}function Ike(n,e,t){n.emit(e,"bridge:streamstart",t)}function Nke(n,e){n.emit(e,"bridge:streamstop",void 0)}function Pke(n,e,t){n.emit(e,"bridge:chatstart",t)}function Dke(n,e){n.emit(e,"bridge:chatstop")}function Lke(n,e,t,r,i,s,a){n.emit(e,"bridge:fetch",[t,r,i,s,a])}function Uke(n,e,t){n.emit(e,"bridge:join",t)}function Bke(n,e,t){n.emit(e,"bridge:start",t)}function Fke(n,e,t){n.emit(e,"bridge:tab",t)}function zke(n,e){n.emit(e,"bridge:tabopen")}function jke(n,e,t){n.emit(e,"bridge:showjoincode",t)}function Hke(n,e){n.emit(e,"gadgetserver:desync")}function qke(n,e){n.emit(e,"gadgetserver:clearscroll")}function fY(n,e,t,r){n.emit(e,"register:downloadjsonfile",[t,r])}function Vke(n,e){n.emit(e,"register:dev",void 0)}function Gke(n,e){n.emit(e,"register:share",void 0)}function $ke(n,e){n.emit(e,"register:nuke",void 0)}function Wke(n,e){n.emit(e,"register:enterar",void 0)}function Yke(n,e){n.emit(e,"synth:audioenabled",void 0)}function Xke(n,e,t,r){n.emit(e,"synth:tts",[t,r])}function Kke(n,e,t,r){n.emit(e,"synth:ttsqueue",[t,r])}function Zke(n,e,t,r){n.emit(e,"synth:play",[t,r])}function Qke(n,e,t,r,i){n.emit(e,"synth:bgplay",[t,r,i])}function Jke(n,e,t){n.emit(e,"synth:bpm",t)}function eOe(n,e,t){n.emit(e,"synth:playvolume",t)}function tOe(n,e,t){n.emit(e,"synth:bgplayvolume",t)}function nOe(n,e,t){n.emit(e,"synth:ttsvolume",t)}function H6(n,e,t,r,i){n.emit(e,"synth:voice",[t,r,i])}function ile(n,e,t,r,i,s){n.emit(e,"synth:voicefx",[t,r,i,s])}function rOe(n,e,t){n.emit(e,"synth:record",t)}function iOe(n,e){n.emit(e,"synth:flush")}function sOe(n,e){n.emit(e,"register:refresh")}function hY(n,e,t,r){n.emit(e,"register:config",[t,r])}function aOe(n,e){n.emit(e,"register:configshow")}function oOe(n,e){n.emit(e,"register:inspector")}function lOe(n,e){n.emit(e,"register:terminal:open")}function dY(n,e,t){n.emit(e,"register:terminal:quickopen",t)}function gD(n,e){n.emit(e,"register:terminal:close")}function sle(n,e,t){n.emit(e,"register:terminal:inclayout",t)}function oj(n,e){n.emit(e,"register:terminal:full")}function cOe(n,e,t,r,i,s){n.emit(e,"register:editor:open",[t,r,i,s])}function uOe(n,e){n.emit(e,"register:editor:close")}function fOe(n,e){n.emit(e,"vm:operator")}function hOe(n,e){n.emit(e,"vm:admin")}function dOe(n,e,t,r){n.emit(e,"vm:zztsearch",[t,r])}function pOe(n,e){n.emit(e,"vm:zztrandom")}function ale(n,e){n.emit(e,"vm:zsswords")}function mOe(n,e,t){n.emit(e,"vm:halt",t)}function gOe(n,e,t,r){n.emit(e,"vm:books",[t,r])}function _Oe(n,e){n.emit(e,"vm:search")}function vOe(n,e){n.emit(e,"vm:login")}function yOe(n,e){n.emit(e,"vm:local")}function ole(n,e){n.emit(e,"vm:logout")}function lle(n,e){n.emit(e,"vm:doot")}function pY(n,e,t,r,i){n.emit(e,"vm:touched",[t,r,i])}function cle(n,e,t,r){n.emit(e,"vm:input",[t,r])}function bOe(n,e,t){n.emit(e,"vm:copyjsonfile",t)}function SOe(n,e,t){n.emit(e,"vm:makeitscroll",t)}function EOe(n,e){n.emit(e,"vm:refscroll")}function xOe(n,e,t,r){n.emit(e,"vm:inspect",[t,r])}function ule(n,e){const[t,r]=e;return`${n}:${[t,r].filter(xe).join(":")}`}function TOe(n,e,t,r){n.emit(e,"vm:codewatch",[t,r])}function wOe(n,e,t,r){n.emit(e,"vm:coderelease",[t,r])}function wv(n,e,t){n.emit(e,"vm:cli",t)}function fle(n,e){n.emit(e,"vm:clirepeatlast")}function ROe(n,e){n.emit(e,"vm:restart")}function AOe(n,e,t){n.emit(e,"vm:synthsend",t)}function COe(n,e){n.emit(e,"vm:flush")}function MOe(n,e){n.emit(e,"vm:fork")}function kOe(n,e){n.emit(e,"vm:itchiopublish")}function OOe(n,e){return{filename:n,cursor:0,lines:e.split(`
`)}}function IOe(n,e){return{filename:n,json:e}}function NOe(n,e){return{filename:n,cursor:0,bytes:e,dataview:new DataView(e.buffer)}}function T_(n,e,t,r,i,s){let a;switch(r){case"file":a=s;break;case"text":a=OOe(i,s);break;case"json":a=IOe(i,s);break;case"binary":a=NOe(i,s);break}setTimeout(()=>{n.emit(e,"vm:loader",[t,r,i,a])},1)}var BR={},mY;function POe(){return mY||(mY=1,(function(n){var e=BR&&BR.__spreadArray||function(c,u,f){if(f||arguments.length===2)for(var d=0,g=u.length,p;d<g;d++)(p||!(d in u))&&(p||(p=Array.prototype.slice.call(u,0,d)),p[d]=u[d]);return c.concat(p||Array.prototype.slice.call(u))};Object.defineProperty(n,"__esModule",{value:!0}),n.minLength=n.maxLength=n.poolSize=n.humanId=n.adverbs=n.verbs=n.nouns=n.adjectives=void 0,n.adjectives=["afraid","all","angry","beige","big","better","bitter","blue","brave","breezy","bright","brown","bumpy","busy","calm","chatty","chilly","chubby","clean","clear","clever","cold","crazy","cruel","cuddly","curly","curvy","cute","common","cold","cool","cyan","dark","deep","dirty","dry","dull","eager","early","easy","eight","eighty","eleven","empty","every","evil","fair","famous","fast","fancy","few","fine","fifty","five","flat","fluffy","floppy","forty","four","free","fresh","fruity","full","funny","fuzzy","gentle","giant","gold","good","great","green","grumpy","happy","heavy","hip","honest","hot","huge","hungry","icy","itchy","khaki","kind","large","late","lazy","lemon","legal","light","little","long","loose","loud","lovely","lucky","major","many","mean","metal","mighty","modern","moody","nasty","neat","new","nice","nine","ninety","odd","old","olive","open","orange","pink","plain","plenty","polite","poor","pretty","proud","public","puny","petite","purple","quick","quiet","rare","real","ready","red","rich","ripe","rotten","rude","sad","salty","seven","shaggy","shaky","sharp","shiny","short","shy","silent","silly","silver","six","sixty","slick","slimy","slow","small","smart","smooth","social","soft","solid","some","sour","spicy","spotty","stale","strong","stupid","sweet","swift","tall","tame","tangy","tasty","ten","tender","thick","thin","thirty","three","tidy","tiny","tired","tough","tricky","true","twelve","twenty","two","upset","vast","violet","warm","weak","wet","whole","wicked","wide","wild","wise","witty","yellow","young","yummy"],n.nouns=["apes","animals","areas","bars","banks","baths","breads","bushes","cloths","clowns","clubs","hoops","loops","memes","papers","parks","paths","showers","sides","signs","sites","streets","teeth","tires","webs","actors","ads","adults","aliens","ants","apples","baboons","badgers","bags","bananas","bats","beans","bears","beds","beers","bees","berries","bikes","birds","boats","bobcats","books","bottles","boxes","brooms","buckets","bugs","buses","buttons","camels","cases","cameras","candies","candles","carpets","carrots","carrots","cars","cats","chairs","chefs","chicken","clocks","clouds","coats","cobras","coins","corners","colts","comics","cooks","cougars","regions","results","cows","crabs","crabs","crews","cups","cities","cycles","dancers","days","deer","dingos","dodos","dogs","dolls","donkeys","donuts","doodles","doors","dots","dragons","drinks","dryers","ducks","ducks","eagles","ears","eels","eggs","ends","mammals","emus","experts","eyes","facts","falcons","fans","feet","files","flies","flowers","forks","foxes","friends","frogs","games","garlics","geckos","geese","ghosts","ghosts","gifts","glasses","goats","grapes","groups","guests","hairs","hands","hats","heads","hornets","horses","hotels","hounds","houses","humans","icons","ideas","impalas","insects","islands","items","jars","jeans","jobs","jokes","keys","kids","kings","kiwis","knives","lamps","lands","laws","lemons","lies","lights","lines","lions","lizards","llamas","mails","mangos","maps","masks","meals","melons","mice","mirrors","moments","moles","monkeys","months","moons","moose","mugs","nails","needles","news","nights","numbers","olives","onions","oranges","otters","owls","pandas","pans","pants","papayas","parents","parts","parrots","paws","peaches","pears","peas","pens","pets","phones","pianos","pigs","pillows","places","planes","planets","plants","plums","poems","poets","points","pots","pugs","pumas","queens","rabbits","radios","rats","ravens","readers","rice","rings","rivers","rockets","rocks","rooms","roses","rules","schools","bats","seals","seas","sheep","shirts","shoes","shrimps","singers","sloths","snails","snakes","socks","spiders","spies","spoons","squids","stars","states","steaks","wings","suits","suns","swans","symbols","tables","taxes","taxis","teams","terms","things","ties","tigers","times","tips","toes","towns","tools","toys","trains","trams","trees","turkeys","turtles","vans","views","walls","walls","wasps","waves","ways","weeks","windows","wolves","women","wombats","words","worlds","worms","yaks","years","zebras","zoos"],n.verbs=["accept","act","add","admire","agree","allow","appear","argue","arrive","ask","attack","attend","bake","bathe","battle","beam","beg","begin","behave","bet","boil","bow","brake","brush","build","burn","buy","call","camp","care","carry","change","cheat","check","cheer","chew","clap","clean","cough","count","cover","crash","create","cross","cry","cut","dance","decide","deny","design","dig","divide","do","double","doubt","draw","dream","dress","drive","drop","drum","eat","end","enter","enjoy","exist","fail","fall","feel","fetch","film","find","fix","flash","float","flow","fly","fold","follow","fry","give","glow","go","grab","greet","grin","grow","guess","hammer","hang","happen","heal","hear","help","hide","hope","hug","hunt","invent","invite","itch","jam","jog","join","joke","judge","juggle","jump","kick","kiss","kneel","knock","know","laugh","lay","lead","learn","leave","lick","like","lie","listen","live","look","lose","love","make","march","marry","mate","matter","melt","mix","move","nail","notice","obey","occur","open","own","pay","peel","play","poke","post","press","prove","pull","pump","pick","punch","push","raise","read","refuse","relate","relax","remain","repair","repeat","reply","report","rescue","rest","retire","return","rhyme","ring","roll","rule","run","rush","say","scream","see","search","sell","send","serve","shake","share","shave","shine","show","shop","shout","sin","sink","sing","sip","sit","sleep","slide","smash","smell","smile","smoke","sneeze","sniff","sort","speak","spend","stand","start","stay","stick","stop","stare","study","strive","swim","switch","take","talk","tan","tap","taste","teach","tease","tell","thank","think","throw","tickle","tie","trade","train","travel","try","turn","type","unite","vanish","visit","wait","walk","warn","wash","watch","wave","wear","win","wink","wish","wonder","work","worry","write","yawn","yell"],n.adverbs=["bravely","brightly","busily","daily","freely","hungrily","joyously","knowlingly","lazily","oddly","mysteriously","noisily","politely","quickly","quietly","rapidly","safely","sleepily","slowly","truly","yearly"];function t(c){return c[Math.floor(Math.random()*c.length)]}function r(c){return c.reduce(function(u,f){return u.length>f.length?u:f})}function i(c){return c.reduce(function(u,f){return u.length<f.length?u:f})}function s(c){c===void 0&&(c={}),typeof c=="string"&&(c={separator:c}),typeof c=="boolean"&&(c={capitalize:c});var u=c.separator,f=u===void 0?"":u,d=c.capitalize,g=d===void 0?!0:d,p=c.adjectiveCount,_=p===void 0?1:p,y=c.addAdverb,v=y===void 0?!1:y,x=e(e(e([],e([],Array(_),!0).map(function(E){return t(n.adjectives)}),!0),[t(n.nouns),t(n.verbs)],!1),v?[t(n.adverbs)]:[],!0);return g&&(x=x.map(function(E){return E.charAt(0).toUpperCase()+E.substr(1)})),x.join(f)}n.humanId=s;function a(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,d=c.addAdverb,g=d===void 0?!1:d;return n.adjectives.length*f*n.nouns.length*n.verbs.length*(g?n.adverbs.length:1)}n.poolSize=a;function o(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,d=c.addAdverb,g=d===void 0?!1:d,p=c.separator,_=p===void 0?"":p;return r(n.adjectives).length*f+f*_.length+r(n.nouns).length+_.length+r(n.verbs).length+(g?r(n.adverbs).length+_.length:0)}n.maxLength=o;function l(c){c===void 0&&(c={});var u=c.adjectiveCount,f=u===void 0?1:u,d=c.addAdverb,g=d===void 0?!1:d,p=c.separator,_=p===void 0?"":p;return i(n.adjectives).length*f+f*_.length+i(n.nouns).length+_.length+i(n.verbs).length+(g?i(n.adverbs).length+_.length:0)}n.minLength=l,n.default=s})(BR)),BR}var DOe=POe();const lj=Bh(DOe);function C4(n){return new Promise((e,t)=>{n.oncomplete=n.onsuccess=()=>e(n.result),n.onabort=n.onerror=()=>t(n.error)})}function LOe(n,e){let t;const r=()=>{if(t)return t;const i=indexedDB.open(n);return i.onupgradeneeded=()=>i.result.createObjectStore(e),t=C4(i),t.then(s=>{s.onclose=()=>t=void 0},()=>{}),t};return(i,s)=>r().then(a=>s(a.transaction(e,i).objectStore(e)))}let q6;function cj(){return q6||(q6=LOe("keyval-store","keyval")),q6}function UOe(n,e=cj()){return e("readonly",t=>C4(t.get(n)))}function BOe(n,e=cj()){return e("readonly",t=>Promise.all(n.map(r=>C4(t.get(r)))))}function FOe(n,e,t=cj()){return t("readwrite",r=>new Promise((i,s)=>{r.get(n).onsuccess=function(){try{r.put(e(this.result),n),i(C4(r.transaction))}catch(a){s(a)}}}))}const V6=new Set,K2={emit(n,e,t,r,i){K2.invoke(e3e(n,e,t,r,i))},invoke(n){V6.forEach(e=>e.handle(n))},connect(n){V6.add(n)},disconnect(n){V6.delete(n)}},zOe="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let jOe=n=>crypto.getRandomValues(new Uint8Array(n)),HOe=(n,e,t)=>{let r=(2<<Math.log2(n.length-1))-1,i=-~(1.6*r*e/n.length);return(s=e)=>{let a="";for(;;){let o=t(i),l=i|0;for(;l--;)if(a+=n[o[l]&r]||"",a.length>=s)return a}}},hle=(n,e=21)=>HOe(n,e|0,jOe),qOe=(n=21)=>{let e="",t=crypto.getRandomValues(new Uint8Array(n|=0));for(;n--;)e+=zOe[t[n]&63];return e};var G6,gY;function dle(){return gY||(gY=1,G6="abcdefghijklmnopqrstuvwxyz"),G6}var $6,_Y;function ple(){return _Y||(_Y=1,$6="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),$6}var W6,vY;function mle(){return vY||(vY=1,W6="0123456789"),W6}var Y6,yY;function VOe(){return yY||(yY=1,Y6="346789ABCDEFGHJKLMNPQRTUVWXYabcdefghijkmnpqrtwxyz"),Y6}var X6,bY;function GOe(){return bY||(bY=1,X6="6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz"),X6}var K6,SY;function $Oe(){if(SY)return K6;SY=1;const n=mle(),e=dle(),t=ple();return K6=n+e+t,K6}var Z6,EY;function WOe(){return EY||(EY=1,Z6={lowercase:dle(),uppercase:ple(),numbers:mle(),nolookalikes:VOe(),nolookalikesSafe:GOe(),alphanumeric:$Oe()}),Z6}var d7=WOe();function vc(){return`sid_${qOe(12).replaceAll("-",".")}`}const YOe=hle(d7.numbers,4),XOe=hle(`${d7.numbers}${d7.lowercase}`,16);function KOe(){return`pid_${YOe()}_${XOe()}`}function x0(n){return n?.startsWith("pid_")??!1}function gle(){return lj({capitalize:!1,adjectiveCount:1})}function ZOe(){return lj({addAdverb:!1,capitalize:!1,adjectiveCount:0})}const QOe=20,xY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function JOe(n){const e=ij(n),t=[];for(let r=0;r<QOe;++r)t.push(xY[Math.floor(e()*xY.length)]);return t.join("")}var Sn=(n=>(n[n.BLACK=0]="BLACK",n[n.DKBLUE=1]="DKBLUE",n[n.DKGREEN=2]="DKGREEN",n[n.DKCYAN=3]="DKCYAN",n[n.DKRED=4]="DKRED",n[n.DKPURPLE=5]="DKPURPLE",n[n.DKYELLOW=6]="DKYELLOW",n[n.LTGRAY=7]="LTGRAY",n[n.DKGRAY=8]="DKGRAY",n[n.BLUE=9]="BLUE",n[n.GREEN=10]="GREEN",n[n.CYAN=11]="CYAN",n[n.RED=12]="RED",n[n.PURPLE=13]="PURPLE",n[n.YELLOW=14]="YELLOW",n[n.WHITE=15]="WHITE",n[n.ONBLACK=16]="ONBLACK",n[n.ONDKBLUE=17]="ONDKBLUE",n[n.ONDKGREEN=18]="ONDKGREEN",n[n.ONDKCYAN=19]="ONDKCYAN",n[n.ONDKRED=20]="ONDKRED",n[n.ONDKPURPLE=21]="ONDKPURPLE",n[n.ONDKYELLOW=22]="ONDKYELLOW",n[n.ONLTGRAY=23]="ONLTGRAY",n[n.ONDKGRAY=24]="ONDKGRAY",n[n.ONBLUE=25]="ONBLUE",n[n.ONGREEN=26]="ONGREEN",n[n.ONCYAN=27]="ONCYAN",n[n.ONRED=28]="ONRED",n[n.ONPURPLE=29]="ONPURPLE",n[n.ONYELLOW=30]="ONYELLOW",n[n.ONWHITE=31]="ONWHITE",n[n.ONCLEAR=32]="ONCLEAR",n[n.BLBLACK=33]="BLBLACK",n[n.BLDKBLUE=34]="BLDKBLUE",n[n.BLDKGREEN=35]="BLDKGREEN",n[n.BLDKCYAN=36]="BLDKCYAN",n[n.BLDKRED=37]="BLDKRED",n[n.BLDKPURPLE=38]="BLDKPURPLE",n[n.BLDKYELLOW=39]="BLDKYELLOW",n[n.BLLTGRAY=40]="BLLTGRAY",n[n.BLDKGRAY=41]="BLDKGRAY",n[n.BLBLUE=42]="BLBLUE",n[n.BLGREEN=43]="BLGREEN",n[n.BLCYAN=44]="BLCYAN",n[n.BLRED=45]="BLRED",n[n.BLPURPLE=46]="BLPURPLE",n[n.BLYELLOW=47]="BLYELLOW",n[n.BLWHITE=48]="BLWHITE",n))(Sn||{}),Rr=(n=>(n[n.ISWALK=0]="ISWALK",n[n.ISSOLID=1]="ISSOLID",n[n.ISSWIM=2]="ISSWIM",n[n.ISBULLET=3]="ISBULLET",n[n.ISGHOST=4]="ISGHOST",n))(Rr||{}),SE=(n=>(n[n.ISTERRAIN=0]="ISTERRAIN",n[n.ISOBJECT=1]="ISOBJECT",n))(SE||{}),Hn=(n=>(n[n.IDLE=0]="IDLE",n[n.NORTH=1]="NORTH",n[n.SOUTH=2]="SOUTH",n[n.WEST=3]="WEST",n[n.EAST=4]="EAST",n[n.BY=5]="BY",n[n.AT=6]="AT",n[n.FLOW=7]="FLOW",n[n.SEEK=8]="SEEK",n[n.RNDNS=9]="RNDNS",n[n.RNDNE=10]="RNDNE",n[n.RND=11]="RND",n[n.CW=12]="CW",n[n.CCW=13]="CCW",n[n.OPP=14]="OPP",n[n.RNDP=15]="RNDP",n[n.AWAY=16]="AWAY",n[n.TOWARD=17]="TOWARD",n[n.FIND=18]="FIND",n[n.FLEE=19]="FLEE",n[n.TO=20]="TO",n[n.MID=21]="MID",n[n.OVER=22]="OVER",n[n.UNDER=23]="UNDER",n[n.WITHIN=24]="WITHIN",n[n.AWAYBY=25]="AWAYBY",n))(Hn||{}),hr=(n=>(n[n.LOADER=0]="LOADER",n[n.BOARD=1]="BOARD",n[n.OBJECT=2]="OBJECT",n[n.TERRAIN=3]="TERRAIN",n[n.CHARSET=4]="CHARSET",n[n.PALETTE=5]="PALETTE",n[n.CONST=6]="CONST",n[n.RANGE=7]="RANGE",n[n.SELECT=8]="SELECT",n[n.NUMBER=9]="NUMBER",n[n.TEXT=10]="TEXT",n[n.HOTKEY=11]="HOTKEY",n[n.COPYIT=12]="COPYIT",n[n.OPENIT=13]="OPENIT",n[n.VIEWIT=14]="VIEWIT",n[n.ZSSEDIT=15]="ZSSEDIT",n[n.CHAREDIT=16]="CHAREDIT",n[n.COLOREDIT=17]="COLOREDIT",n))(hr||{});function qr(n){return Vn(n)?n.toLowerCase().trim():""}function e3e(n,e,t,r,i){return{session:n,player:e,id:vc(),sender:t,target:r,data:i}}function EE(n){const[e,...t]=n.split(":");return{target:e,path:t.join(":")}}function H1(n,e=[],t=bm,r=""){const i=vc(),s=qr(n),a=e.map(qr);let o=r;const l={id(){return i},name(){return n},session(c){return xe(c)?c.session===o?c.session:"":o},topics(){return e},emit(c,u,f){K2.emit(o,c,i,u,f)},reply(c,u,f){l.emit(c.player,`${c.sender}:${u}`,f)},replynext(c,u,f){setTimeout(()=>l.emit(c.player,`${c.sender}:${u}`,f),64)},handle(c){const{target:u,path:f}=EE(c.target),d=qr(u);!o&&d==="ready"&&(o=c.session),d==="session_reset"&&(o=""),a.findIndex(g=>g==="all"||g===d)!==-1&&t(c),(i===u||d==="all"||s===d)&&t({...c,target:f})}};return K2.connect(l),l}var NN={exports:{}},t3e=NN.exports,TY;function n3e(){return TY||(TY=1,(function(n,e){(function(t,r){r()})(t3e,function(){function t(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function r(c,u,f){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,f)},d.onerror=function(){console.error("could not download file")},d.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var a=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof C0=="object"&&C0.global===C0?C0:void 0,o=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=a.saveAs||(typeof window!="object"||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(c,u,f){var d=a.URL||a.webkitURL,g=document.createElement("a");u=u||c.name||"download",g.download=u,g.rel="noopener",typeof c=="string"?(g.href=c,g.origin===location.origin?s(g):i(g.href)?r(c,u,f):s(g,g.target="_blank")):(g.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(g.href)},4e4),setTimeout(function(){s(g)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,f){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(t(c,f),u);else if(i(c))r(c,u,f);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){s(d)})}}:function(c,u,f,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return r(c,u,f);var g=c.type==="application/octet-stream",p=/constructor/i.test(a.HTMLElement)||a.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||g&&p||o)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var E=y.result;E=_?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=E:location=E,d=null},y.readAsDataURL(c)}else{var v=a.URL||a.webkitURL,x=v.createObjectURL(c);d?d.location=x:location.href=x,d=null,setTimeout(function(){v.revokeObjectURL(x)},4e4)}});a.saveAs=l.saveAs=l,n.exports=l})})(NN)),NN.exports}var r3e=n3e(),_le={},M4={};M4.byteLength=a3e;M4.toByteArray=l3e;M4.fromByteArray=f3e;var yv=[],v0=[],i3e=typeof Uint8Array<"u"?Uint8Array:Array,Q6="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var jx=0,s3e=Q6.length;jx<s3e;++jx)yv[jx]=Q6[jx],v0[Q6.charCodeAt(jx)]=jx;v0[45]=62;v0[95]=63;function vle(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function a3e(n){var e=vle(n),t=e[0],r=e[1];return(t+r)*3/4-r}function o3e(n,e,t){return(e+t)*3/4-t}function l3e(n){var e,t=vle(n),r=t[0],i=t[1],s=new i3e(o3e(n,r,i)),a=0,o=i>0?r-4:r,l;for(l=0;l<o;l+=4)e=v0[n.charCodeAt(l)]<<18|v0[n.charCodeAt(l+1)]<<12|v0[n.charCodeAt(l+2)]<<6|v0[n.charCodeAt(l+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=e&255;return i===2&&(e=v0[n.charCodeAt(l)]<<2|v0[n.charCodeAt(l+1)]>>4,s[a++]=e&255),i===1&&(e=v0[n.charCodeAt(l)]<<10|v0[n.charCodeAt(l+1)]<<4|v0[n.charCodeAt(l+2)]>>2,s[a++]=e>>8&255,s[a++]=e&255),s}function c3e(n){return yv[n>>18&63]+yv[n>>12&63]+yv[n>>6&63]+yv[n&63]}function u3e(n,e,t){for(var r,i=[],s=e;s<t;s+=3)r=(n[s]<<16&16711680)+(n[s+1]<<8&65280)+(n[s+2]&255),i.push(c3e(r));return i.join("")}function f3e(n){for(var e,t=n.length,r=t%3,i=[],s=16383,a=0,o=t-r;a<o;a+=s)i.push(u3e(n,a,a+s>o?o:a+s));return r===1?(e=n[t-1],i.push(yv[e>>2]+yv[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],i.push(yv[e>>10]+yv[e>>4&63]+yv[e<<2&63]+"=")),i.join("")}var uj={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */uj.read=function(n,e,t,r,i){var s,a,o=i*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,f=t?i-1:0,d=t?-1:1,g=n[e+f];for(f+=d,s=g&(1<<-u)-1,g>>=-u,u+=o;u>0;s=s*256+n[e+f],f+=d,u-=8);for(a=s&(1<<-u)-1,s>>=-u,u+=r;u>0;a=a*256+n[e+f],f+=d,u-=8);if(s===0)s=1-c;else{if(s===l)return a?NaN:(g?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-c}return(g?-1:1)*a*Math.pow(2,s-r)};uj.write=function(n,e,t,r,i,s){var a,o,l,c=s*8-i-1,u=(1<<c)-1,f=u>>1,d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:s-1,p=r?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?e+=d/l:e+=d*Math.pow(2,1-f),e*l>=2&&(a++,l/=2),a+f>=u?(o=0,a=u):a+f>=1?(o=(e*l-1)*Math.pow(2,i),a=a+f):(o=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;n[t+g]=o&255,g+=p,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;n[t+g]=a&255,g+=p,a/=256,c-=8);n[t+g-p]|=_*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(n){const e=M4,t=uj,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;n.Buffer=u,n.SlowBuffer=O,n.INSPECT_MAX_BYTES=50;const i=2147483647;n.kMaxLength=i;const{Uint8Array:s,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const je=new s(1),ge={foo:function(){return 42}};return Object.setPrototypeOf(ge,s.prototype),Object.setPrototypeOf(je,ge),je.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(je){if(je>i)throw new RangeError('The value "'+je+'" is invalid for option "size"');const ge=new s(je);return Object.setPrototypeOf(ge,u.prototype),ge}function u(je,ge,se){if(typeof je=="number"){if(typeof ge=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(je)}return f(je,ge,se)}u.poolSize=8192;function f(je,ge,se){if(typeof je=="string")return _(je,ge);if(a.isView(je))return v(je);if(je==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je);if(lt(je,a)||je&&lt(je.buffer,a)||typeof o<"u"&&(lt(je,o)||je&&lt(je.buffer,o)))return x(je,ge,se);if(typeof je=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=je.valueOf&&je.valueOf();if(_e!=null&&_e!==je)return u.from(_e,ge,se);const Ne=E(je);if(Ne)return Ne;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof je[Symbol.toPrimitive]=="function")return u.from(je[Symbol.toPrimitive]("string"),ge,se);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof je)}u.from=function(je,ge,se){return f(je,ge,se)},Object.setPrototypeOf(u.prototype,s.prototype),Object.setPrototypeOf(u,s);function d(je){if(typeof je!="number")throw new TypeError('"size" argument must be of type number');if(je<0)throw new RangeError('The value "'+je+'" is invalid for option "size"')}function g(je,ge,se){return d(je),je<=0?c(je):ge!==void 0?typeof se=="string"?c(je).fill(ge,se):c(je).fill(ge):c(je)}u.alloc=function(je,ge,se){return g(je,ge,se)};function p(je){return d(je),c(je<0?0:M(je)|0)}u.allocUnsafe=function(je){return p(je)},u.allocUnsafeSlow=function(je){return p(je)};function _(je,ge){if((typeof ge!="string"||ge==="")&&(ge="utf8"),!u.isEncoding(ge))throw new TypeError("Unknown encoding: "+ge);const se=N(je,ge)|0;let _e=c(se);const Ne=_e.write(je,ge);return Ne!==se&&(_e=_e.slice(0,Ne)),_e}function y(je){const ge=je.length<0?0:M(je.length)|0,se=c(ge);for(let _e=0;_e<ge;_e+=1)se[_e]=je[_e]&255;return se}function v(je){if(lt(je,s)){const ge=new s(je);return x(ge.buffer,ge.byteOffset,ge.byteLength)}return y(je)}function x(je,ge,se){if(ge<0||je.byteLength<ge)throw new RangeError('"offset" is outside of buffer bounds');if(je.byteLength<ge+(se||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return ge===void 0&&se===void 0?_e=new s(je):se===void 0?_e=new s(je,ge):_e=new s(je,ge,se),Object.setPrototypeOf(_e,u.prototype),_e}function E(je){if(u.isBuffer(je)){const ge=M(je.length)|0,se=c(ge);return se.length===0||je.copy(se,0,0,ge),se}if(je.length!==void 0)return typeof je.length!="number"||ct(je.length)?c(0):y(je);if(je.type==="Buffer"&&Array.isArray(je.data))return y(je.data)}function M(je){if(je>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return je|0}function O(je){return+je!=je&&(je=0),u.alloc(+je)}u.isBuffer=function(ge){return ge!=null&&ge._isBuffer===!0&&ge!==u.prototype},u.compare=function(ge,se){if(lt(ge,s)&&(ge=u.from(ge,ge.offset,ge.byteLength)),lt(se,s)&&(se=u.from(se,se.offset,se.byteLength)),!u.isBuffer(ge)||!u.isBuffer(se))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ge===se)return 0;let _e=ge.length,Ne=se.length;for(let Le=0,ke=Math.min(_e,Ne);Le<ke;++Le)if(ge[Le]!==se[Le]){_e=ge[Le],Ne=se[Le];break}return _e<Ne?-1:Ne<_e?1:0},u.isEncoding=function(ge){switch(String(ge).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(ge,se){if(!Array.isArray(ge))throw new TypeError('"list" argument must be an Array of Buffers');if(ge.length===0)return u.alloc(0);let _e;if(se===void 0)for(se=0,_e=0;_e<ge.length;++_e)se+=ge[_e].length;const Ne=u.allocUnsafe(se);let Le=0;for(_e=0;_e<ge.length;++_e){let ke=ge[_e];if(lt(ke,s))Le+ke.length>Ne.length?(u.isBuffer(ke)||(ke=u.from(ke)),ke.copy(Ne,Le)):s.prototype.set.call(Ne,ke,Le);else if(u.isBuffer(ke))ke.copy(Ne,Le);else throw new TypeError('"list" argument must be an Array of Buffers');Le+=ke.length}return Ne};function N(je,ge){if(u.isBuffer(je))return je.length;if(a.isView(je)||lt(je,a))return je.byteLength;if(typeof je!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof je);const se=je.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&se===0)return 0;let Ne=!1;for(;;)switch(ge){case"ascii":case"latin1":case"binary":return se;case"utf8":case"utf-8":return Se(je).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return se*2;case"hex":return se>>>1;case"base64":return Ke(je).length;default:if(Ne)return _e?-1:Se(je).length;ge=(""+ge).toLowerCase(),Ne=!0}}u.byteLength=N;function I(je,ge,se){let _e=!1;if((ge===void 0||ge<0)&&(ge=0),ge>this.length||((se===void 0||se>this.length)&&(se=this.length),se<=0)||(se>>>=0,ge>>>=0,se<=ge))return"";for(je||(je="utf8");;)switch(je){case"hex":return ne(this,ge,se);case"utf8":case"utf-8":return q(this,ge,se);case"ascii":return Z(this,ge,se);case"latin1":case"binary":return K(this,ge,se);case"base64":return W(this,ge,se);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le(this,ge,se);default:if(_e)throw new TypeError("Unknown encoding: "+je);je=(je+"").toLowerCase(),_e=!0}}u.prototype._isBuffer=!0;function D(je,ge,se){const _e=je[ge];je[ge]=je[se],je[se]=_e}u.prototype.swap16=function(){const ge=this.length;if(ge%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let se=0;se<ge;se+=2)D(this,se,se+1);return this},u.prototype.swap32=function(){const ge=this.length;if(ge%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let se=0;se<ge;se+=4)D(this,se,se+3),D(this,se+1,se+2);return this},u.prototype.swap64=function(){const ge=this.length;if(ge%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let se=0;se<ge;se+=8)D(this,se,se+7),D(this,se+1,se+6),D(this,se+2,se+5),D(this,se+3,se+4);return this},u.prototype.toString=function(){const ge=this.length;return ge===0?"":arguments.length===0?q(this,0,ge):I.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(ge){if(!u.isBuffer(ge))throw new TypeError("Argument must be a Buffer");return this===ge?!0:u.compare(this,ge)===0},u.prototype.inspect=function(){let ge="";const se=n.INSPECT_MAX_BYTES;return ge=this.toString("hex",0,se).replace(/(.{2})/g,"$1 ").trim(),this.length>se&&(ge+=" ... "),"<Buffer "+ge+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(ge,se,_e,Ne,Le){if(lt(ge,s)&&(ge=u.from(ge,ge.offset,ge.byteLength)),!u.isBuffer(ge))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ge);if(se===void 0&&(se=0),_e===void 0&&(_e=ge?ge.length:0),Ne===void 0&&(Ne=0),Le===void 0&&(Le=this.length),se<0||_e>ge.length||Ne<0||Le>this.length)throw new RangeError("out of range index");if(Ne>=Le&&se>=_e)return 0;if(Ne>=Le)return-1;if(se>=_e)return 1;if(se>>>=0,_e>>>=0,Ne>>>=0,Le>>>=0,this===ge)return 0;let ke=Le-Ne,Re=_e-se;const st=Math.min(ke,Re),Ve=this.slice(Ne,Le),tt=ge.slice(se,_e);for(let Ze=0;Ze<st;++Ze)if(Ve[Ze]!==tt[Ze]){ke=Ve[Ze],Re=tt[Ze];break}return ke<Re?-1:Re<ke?1:0};function V(je,ge,se,_e,Ne){if(je.length===0)return-1;if(typeof se=="string"?(_e=se,se=0):se>2147483647?se=2147483647:se<-2147483648&&(se=-2147483648),se=+se,ct(se)&&(se=Ne?0:je.length-1),se<0&&(se=je.length+se),se>=je.length){if(Ne)return-1;se=je.length-1}else if(se<0)if(Ne)se=0;else return-1;if(typeof ge=="string"&&(ge=u.from(ge,_e)),u.isBuffer(ge))return ge.length===0?-1:G(je,ge,se,_e,Ne);if(typeof ge=="number")return ge=ge&255,typeof s.prototype.indexOf=="function"?Ne?s.prototype.indexOf.call(je,ge,se):s.prototype.lastIndexOf.call(je,ge,se):G(je,[ge],se,_e,Ne);throw new TypeError("val must be string, number or Buffer")}function G(je,ge,se,_e,Ne){let Le=1,ke=je.length,Re=ge.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(je.length<2||ge.length<2)return-1;Le=2,ke/=2,Re/=2,se/=2}function st(tt,Ze){return Le===1?tt[Ze]:tt.readUInt16BE(Ze*Le)}let Ve;if(Ne){let tt=-1;for(Ve=se;Ve<ke;Ve++)if(st(je,Ve)===st(ge,tt===-1?0:Ve-tt)){if(tt===-1&&(tt=Ve),Ve-tt+1===Re)return tt*Le}else tt!==-1&&(Ve-=Ve-tt),tt=-1}else for(se+Re>ke&&(se=ke-Re),Ve=se;Ve>=0;Ve--){let tt=!0;for(let Ze=0;Ze<Re;Ze++)if(st(je,Ve+Ze)!==st(ge,Ze)){tt=!1;break}if(tt)return Ve}return-1}u.prototype.includes=function(ge,se,_e){return this.indexOf(ge,se,_e)!==-1},u.prototype.indexOf=function(ge,se,_e){return V(this,ge,se,_e,!0)},u.prototype.lastIndexOf=function(ge,se,_e){return V(this,ge,se,_e,!1)};function Q(je,ge,se,_e){se=Number(se)||0;const Ne=je.length-se;_e?(_e=Number(_e),_e>Ne&&(_e=Ne)):_e=Ne;const Le=ge.length;_e>Le/2&&(_e=Le/2);let ke;for(ke=0;ke<_e;++ke){const Re=parseInt(ge.substr(ke*2,2),16);if(ct(Re))return ke;je[se+ke]=Re}return ke}function B(je,ge,se,_e){return ot(Se(ge,je.length-se),je,se,_e)}function $(je,ge,se,_e){return ot(Ie(ge),je,se,_e)}function U(je,ge,se,_e){return ot(Ke(ge),je,se,_e)}function J(je,ge,se,_e){return ot(be(ge,je.length-se),je,se,_e)}u.prototype.write=function(ge,se,_e,Ne){if(se===void 0)Ne="utf8",_e=this.length,se=0;else if(_e===void 0&&typeof se=="string")Ne=se,_e=this.length,se=0;else if(isFinite(se))se=se>>>0,isFinite(_e)?(_e=_e>>>0,Ne===void 0&&(Ne="utf8")):(Ne=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Le=this.length-se;if((_e===void 0||_e>Le)&&(_e=Le),ge.length>0&&(_e<0||se<0)||se>this.length)throw new RangeError("Attempt to write outside buffer bounds");Ne||(Ne="utf8");let ke=!1;for(;;)switch(Ne){case"hex":return Q(this,ge,se,_e);case"utf8":case"utf-8":return B(this,ge,se,_e);case"ascii":case"latin1":case"binary":return $(this,ge,se,_e);case"base64":return U(this,ge,se,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,ge,se,_e);default:if(ke)throw new TypeError("Unknown encoding: "+Ne);Ne=(""+Ne).toLowerCase(),ke=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(je,ge,se){return ge===0&&se===je.length?e.fromByteArray(je):e.fromByteArray(je.slice(ge,se))}function q(je,ge,se){se=Math.min(je.length,se);const _e=[];let Ne=ge;for(;Ne<se;){const Le=je[Ne];let ke=null,Re=Le>239?4:Le>223?3:Le>191?2:1;if(Ne+Re<=se){let st,Ve,tt,Ze;switch(Re){case 1:Le<128&&(ke=Le);break;case 2:st=je[Ne+1],(st&192)===128&&(Ze=(Le&31)<<6|st&63,Ze>127&&(ke=Ze));break;case 3:st=je[Ne+1],Ve=je[Ne+2],(st&192)===128&&(Ve&192)===128&&(Ze=(Le&15)<<12|(st&63)<<6|Ve&63,Ze>2047&&(Ze<55296||Ze>57343)&&(ke=Ze));break;case 4:st=je[Ne+1],Ve=je[Ne+2],tt=je[Ne+3],(st&192)===128&&(Ve&192)===128&&(tt&192)===128&&(Ze=(Le&15)<<18|(st&63)<<12|(Ve&63)<<6|tt&63,Ze>65535&&Ze<1114112&&(ke=Ze))}}ke===null?(ke=65533,Re=1):ke>65535&&(ke-=65536,_e.push(ke>>>10&1023|55296),ke=56320|ke&1023),_e.push(ke),Ne+=Re}return ae(_e)}const Y=4096;function ae(je){const ge=je.length;if(ge<=Y)return String.fromCharCode.apply(String,je);let se="",_e=0;for(;_e<ge;)se+=String.fromCharCode.apply(String,je.slice(_e,_e+=Y));return se}function Z(je,ge,se){let _e="";se=Math.min(je.length,se);for(let Ne=ge;Ne<se;++Ne)_e+=String.fromCharCode(je[Ne]&127);return _e}function K(je,ge,se){let _e="";se=Math.min(je.length,se);for(let Ne=ge;Ne<se;++Ne)_e+=String.fromCharCode(je[Ne]);return _e}function ne(je,ge,se){const _e=je.length;(!ge||ge<0)&&(ge=0),(!se||se<0||se>_e)&&(se=_e);let Ne="";for(let Le=ge;Le<se;++Le)Ne+=Vt[je[Le]];return Ne}function le(je,ge,se){const _e=je.slice(ge,se);let Ne="";for(let Le=0;Le<_e.length-1;Le+=2)Ne+=String.fromCharCode(_e[Le]+_e[Le+1]*256);return Ne}u.prototype.slice=function(ge,se){const _e=this.length;ge=~~ge,se=se===void 0?_e:~~se,ge<0?(ge+=_e,ge<0&&(ge=0)):ge>_e&&(ge=_e),se<0?(se+=_e,se<0&&(se=0)):se>_e&&(se=_e),se<ge&&(se=ge);const Ne=this.subarray(ge,se);return Object.setPrototypeOf(Ne,u.prototype),Ne};function ce(je,ge,se){if(je%1!==0||je<0)throw new RangeError("offset is not uint");if(je+ge>se)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ne=this[ge],Le=1,ke=0;for(;++ke<se&&(Le*=256);)Ne+=this[ge+ke]*Le;return Ne},u.prototype.readUintBE=u.prototype.readUIntBE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ne=this[ge+--se],Le=1;for(;se>0&&(Le*=256);)Ne+=this[ge+--se]*Le;return Ne},u.prototype.readUint8=u.prototype.readUInt8=function(ge,se){return ge=ge>>>0,se||ce(ge,1,this.length),this[ge]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(ge,se){return ge=ge>>>0,se||ce(ge,2,this.length),this[ge]|this[ge+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(ge,se){return ge=ge>>>0,se||ce(ge,2,this.length),this[ge]<<8|this[ge+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),(this[ge]|this[ge+1]<<8|this[ge+2]<<16)+this[ge+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]*16777216+(this[ge+1]<<16|this[ge+2]<<8|this[ge+3])},u.prototype.readBigUInt64LE=kt(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ne=se+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24,Le=this[++ge]+this[++ge]*2**8+this[++ge]*2**16+_e*2**24;return BigInt(Ne)+(BigInt(Le)<<BigInt(32))}),u.prototype.readBigUInt64BE=kt(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ne=se*2**24+this[++ge]*2**16+this[++ge]*2**8+this[++ge],Le=this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+_e;return(BigInt(Ne)<<BigInt(32))+BigInt(Le)}),u.prototype.readIntLE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ne=this[ge],Le=1,ke=0;for(;++ke<se&&(Le*=256);)Ne+=this[ge+ke]*Le;return Le*=128,Ne>=Le&&(Ne-=Math.pow(2,8*se)),Ne},u.prototype.readIntBE=function(ge,se,_e){ge=ge>>>0,se=se>>>0,_e||ce(ge,se,this.length);let Ne=se,Le=1,ke=this[ge+--Ne];for(;Ne>0&&(Le*=256);)ke+=this[ge+--Ne]*Le;return Le*=128,ke>=Le&&(ke-=Math.pow(2,8*se)),ke},u.prototype.readInt8=function(ge,se){return ge=ge>>>0,se||ce(ge,1,this.length),this[ge]&128?(255-this[ge]+1)*-1:this[ge]},u.prototype.readInt16LE=function(ge,se){ge=ge>>>0,se||ce(ge,2,this.length);const _e=this[ge]|this[ge+1]<<8;return _e&32768?_e|4294901760:_e},u.prototype.readInt16BE=function(ge,se){ge=ge>>>0,se||ce(ge,2,this.length);const _e=this[ge+1]|this[ge]<<8;return _e&32768?_e|4294901760:_e},u.prototype.readInt32LE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]|this[ge+1]<<8|this[ge+2]<<16|this[ge+3]<<24},u.prototype.readInt32BE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),this[ge]<<24|this[ge+1]<<16|this[ge+2]<<8|this[ge+3]},u.prototype.readBigInt64LE=kt(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ne=this[ge+4]+this[ge+5]*2**8+this[ge+6]*2**16+(_e<<24);return(BigInt(Ne)<<BigInt(32))+BigInt(se+this[++ge]*2**8+this[++ge]*2**16+this[++ge]*2**24)}),u.prototype.readBigInt64BE=kt(function(ge){ge=ge>>>0,Ge(ge,"offset");const se=this[ge],_e=this[ge+7];(se===void 0||_e===void 0)&&ze(ge,this.length-8);const Ne=(se<<24)+this[++ge]*2**16+this[++ge]*2**8+this[++ge];return(BigInt(Ne)<<BigInt(32))+BigInt(this[++ge]*2**24+this[++ge]*2**16+this[++ge]*2**8+_e)}),u.prototype.readFloatLE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),t.read(this,ge,!0,23,4)},u.prototype.readFloatBE=function(ge,se){return ge=ge>>>0,se||ce(ge,4,this.length),t.read(this,ge,!1,23,4)},u.prototype.readDoubleLE=function(ge,se){return ge=ge>>>0,se||ce(ge,8,this.length),t.read(this,ge,!0,52,8)},u.prototype.readDoubleBE=function(ge,se){return ge=ge>>>0,se||ce(ge,8,this.length),t.read(this,ge,!1,52,8)};function de(je,ge,se,_e,Ne,Le){if(!u.isBuffer(je))throw new TypeError('"buffer" argument must be a Buffer instance');if(ge>Ne||ge<Le)throw new RangeError('"value" argument is out of bounds');if(se+_e>je.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(ge,se,_e,Ne){if(ge=+ge,se=se>>>0,_e=_e>>>0,!Ne){const Re=Math.pow(2,8*_e)-1;de(this,ge,se,_e,Re,0)}let Le=1,ke=0;for(this[se]=ge&255;++ke<_e&&(Le*=256);)this[se+ke]=ge/Le&255;return se+_e},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(ge,se,_e,Ne){if(ge=+ge,se=se>>>0,_e=_e>>>0,!Ne){const Re=Math.pow(2,8*_e)-1;de(this,ge,se,_e,Re,0)}let Le=_e-1,ke=1;for(this[se+Le]=ge&255;--Le>=0&&(ke*=256);)this[se+Le]=ge/ke&255;return se+_e},u.prototype.writeUint8=u.prototype.writeUInt8=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,1,255,0),this[se]=ge&255,se+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,65535,0),this[se]=ge&255,this[se+1]=ge>>>8,se+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,65535,0),this[se]=ge>>>8,this[se+1]=ge&255,se+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,4294967295,0),this[se+3]=ge>>>24,this[se+2]=ge>>>16,this[se+1]=ge>>>8,this[se]=ge&255,se+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,4294967295,0),this[se]=ge>>>24,this[se+1]=ge>>>16,this[se+2]=ge>>>8,this[se+3]=ge&255,se+4};function Me(je,ge,se,_e,Ne){Ue(ge,_e,Ne,je,se,7);let Le=Number(ge&BigInt(4294967295));je[se++]=Le,Le=Le>>8,je[se++]=Le,Le=Le>>8,je[se++]=Le,Le=Le>>8,je[se++]=Le;let ke=Number(ge>>BigInt(32)&BigInt(4294967295));return je[se++]=ke,ke=ke>>8,je[se++]=ke,ke=ke>>8,je[se++]=ke,ke=ke>>8,je[se++]=ke,se}function qe(je,ge,se,_e,Ne){Ue(ge,_e,Ne,je,se,7);let Le=Number(ge&BigInt(4294967295));je[se+7]=Le,Le=Le>>8,je[se+6]=Le,Le=Le>>8,je[se+5]=Le,Le=Le>>8,je[se+4]=Le;let ke=Number(ge>>BigInt(32)&BigInt(4294967295));return je[se+3]=ke,ke=ke>>8,je[se+2]=ke,ke=ke>>8,je[se+1]=ke,ke=ke>>8,je[se]=ke,se+8}u.prototype.writeBigUInt64LE=kt(function(ge,se=0){return Me(this,ge,se,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=kt(function(ge,se=0){return qe(this,ge,se,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(ge,se,_e,Ne){if(ge=+ge,se=se>>>0,!Ne){const st=Math.pow(2,8*_e-1);de(this,ge,se,_e,st-1,-st)}let Le=0,ke=1,Re=0;for(this[se]=ge&255;++Le<_e&&(ke*=256);)ge<0&&Re===0&&this[se+Le-1]!==0&&(Re=1),this[se+Le]=(ge/ke>>0)-Re&255;return se+_e},u.prototype.writeIntBE=function(ge,se,_e,Ne){if(ge=+ge,se=se>>>0,!Ne){const st=Math.pow(2,8*_e-1);de(this,ge,se,_e,st-1,-st)}let Le=_e-1,ke=1,Re=0;for(this[se+Le]=ge&255;--Le>=0&&(ke*=256);)ge<0&&Re===0&&this[se+Le+1]!==0&&(Re=1),this[se+Le]=(ge/ke>>0)-Re&255;return se+_e},u.prototype.writeInt8=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,1,127,-128),ge<0&&(ge=255+ge+1),this[se]=ge&255,se+1},u.prototype.writeInt16LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,32767,-32768),this[se]=ge&255,this[se+1]=ge>>>8,se+2},u.prototype.writeInt16BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,2,32767,-32768),this[se]=ge>>>8,this[se+1]=ge&255,se+2},u.prototype.writeInt32LE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,2147483647,-2147483648),this[se]=ge&255,this[se+1]=ge>>>8,this[se+2]=ge>>>16,this[se+3]=ge>>>24,se+4},u.prototype.writeInt32BE=function(ge,se,_e){return ge=+ge,se=se>>>0,_e||de(this,ge,se,4,2147483647,-2147483648),ge<0&&(ge=4294967295+ge+1),this[se]=ge>>>24,this[se+1]=ge>>>16,this[se+2]=ge>>>8,this[se+3]=ge&255,se+4},u.prototype.writeBigInt64LE=kt(function(ge,se=0){return Me(this,ge,se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=kt(function(ge,se=0){return qe(this,ge,se,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pe(je,ge,se,_e,Ne,Le){if(se+_e>je.length)throw new RangeError("Index out of range");if(se<0)throw new RangeError("Index out of range")}function Ce(je,ge,se,_e,Ne){return ge=+ge,se=se>>>0,Ne||Pe(je,ge,se,4),t.write(je,ge,se,_e,23,4),se+4}u.prototype.writeFloatLE=function(ge,se,_e){return Ce(this,ge,se,!0,_e)},u.prototype.writeFloatBE=function(ge,se,_e){return Ce(this,ge,se,!1,_e)};function Xe(je,ge,se,_e,Ne){return ge=+ge,se=se>>>0,Ne||Pe(je,ge,se,8),t.write(je,ge,se,_e,52,8),se+8}u.prototype.writeDoubleLE=function(ge,se,_e){return Xe(this,ge,se,!0,_e)},u.prototype.writeDoubleBE=function(ge,se,_e){return Xe(this,ge,se,!1,_e)},u.prototype.copy=function(ge,se,_e,Ne){if(!u.isBuffer(ge))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!Ne&&Ne!==0&&(Ne=this.length),se>=ge.length&&(se=ge.length),se||(se=0),Ne>0&&Ne<_e&&(Ne=_e),Ne===_e||ge.length===0||this.length===0)return 0;if(se<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if(Ne<0)throw new RangeError("sourceEnd out of bounds");Ne>this.length&&(Ne=this.length),ge.length-se<Ne-_e&&(Ne=ge.length-se+_e);const Le=Ne-_e;return this===ge&&typeof s.prototype.copyWithin=="function"?this.copyWithin(se,_e,Ne):s.prototype.set.call(ge,this.subarray(_e,Ne),se),Le},u.prototype.fill=function(ge,se,_e,Ne){if(typeof ge=="string"){if(typeof se=="string"?(Ne=se,se=0,_e=this.length):typeof _e=="string"&&(Ne=_e,_e=this.length),Ne!==void 0&&typeof Ne!="string")throw new TypeError("encoding must be a string");if(typeof Ne=="string"&&!u.isEncoding(Ne))throw new TypeError("Unknown encoding: "+Ne);if(ge.length===1){const ke=ge.charCodeAt(0);(Ne==="utf8"&&ke<128||Ne==="latin1")&&(ge=ke)}}else typeof ge=="number"?ge=ge&255:typeof ge=="boolean"&&(ge=Number(ge));if(se<0||this.length<se||this.length<_e)throw new RangeError("Out of range index");if(_e<=se)return this;se=se>>>0,_e=_e===void 0?this.length:_e>>>0,ge||(ge=0);let Le;if(typeof ge=="number")for(Le=se;Le<_e;++Le)this[Le]=ge;else{const ke=u.isBuffer(ge)?ge:u.from(ge,Ne),Re=ke.length;if(Re===0)throw new TypeError('The value "'+ge+'" is invalid for argument "value"');for(Le=0;Le<_e-se;++Le)this[Le+se]=ke[Le%Re]}return this};const $e={};function at(je,ge,se){$e[je]=class extends se{constructor(){super(),Object.defineProperty(this,"message",{value:ge.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${je}]`,this.stack,delete this.name}get code(){return je}set code(Ne){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Ne,writable:!0})}toString(){return`${this.name} [${je}]: ${this.message}`}}}at("ERR_BUFFER_OUT_OF_BOUNDS",function(je){return je?`${je} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),at("ERR_INVALID_ARG_TYPE",function(je,ge){return`The "${je}" argument must be of type number. Received type ${typeof ge}`},TypeError),at("ERR_OUT_OF_RANGE",function(je,ge,se){let _e=`The value of "${je}" is out of range.`,Ne=se;return Number.isInteger(se)&&Math.abs(se)>2**32?Ne=pt(String(se)):typeof se=="bigint"&&(Ne=String(se),(se>BigInt(2)**BigInt(32)||se<-(BigInt(2)**BigInt(32)))&&(Ne=pt(Ne)),Ne+="n"),_e+=` It must be ${ge}. Received ${Ne}`,_e},RangeError);function pt(je){let ge="",se=je.length;const _e=je[0]==="-"?1:0;for(;se>=_e+4;se-=3)ge=`_${je.slice(se-3,se)}${ge}`;return`${je.slice(0,se)}${ge}`}function oe(je,ge,se){Ge(ge,"offset"),(je[ge]===void 0||je[ge+se]===void 0)&&ze(ge,je.length-(se+1))}function Ue(je,ge,se,_e,Ne,Le){if(je>se||je<ge){const ke=typeof ge=="bigint"?"n":"";let Re;throw ge===0||ge===BigInt(0)?Re=`>= 0${ke} and < 2${ke} ** ${(Le+1)*8}${ke}`:Re=`>= -(2${ke} ** ${(Le+1)*8-1}${ke}) and < 2 ** ${(Le+1)*8-1}${ke}`,new $e.ERR_OUT_OF_RANGE("value",Re,je)}oe(_e,Ne,Le)}function Ge(je,ge){if(typeof je!="number")throw new $e.ERR_INVALID_ARG_TYPE(ge,"number",je)}function ze(je,ge,se){throw Math.floor(je)!==je?(Ge(je,se),new $e.ERR_OUT_OF_RANGE("offset","an integer",je)):ge<0?new $e.ERR_BUFFER_OUT_OF_BOUNDS:new $e.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${ge}`,je)}const Be=/[^+/0-9A-Za-z-_]/g;function me(je){if(je=je.split("=")[0],je=je.trim().replace(Be,""),je.length<2)return"";for(;je.length%4!==0;)je=je+"=";return je}function Se(je,ge){ge=ge||1/0;let se;const _e=je.length;let Ne=null;const Le=[];for(let ke=0;ke<_e;++ke){if(se=je.charCodeAt(ke),se>55295&&se<57344){if(!Ne){if(se>56319){(ge-=3)>-1&&Le.push(239,191,189);continue}else if(ke+1===_e){(ge-=3)>-1&&Le.push(239,191,189);continue}Ne=se;continue}if(se<56320){(ge-=3)>-1&&Le.push(239,191,189),Ne=se;continue}se=(Ne-55296<<10|se-56320)+65536}else Ne&&(ge-=3)>-1&&Le.push(239,191,189);if(Ne=null,se<128){if((ge-=1)<0)break;Le.push(se)}else if(se<2048){if((ge-=2)<0)break;Le.push(se>>6|192,se&63|128)}else if(se<65536){if((ge-=3)<0)break;Le.push(se>>12|224,se>>6&63|128,se&63|128)}else if(se<1114112){if((ge-=4)<0)break;Le.push(se>>18|240,se>>12&63|128,se>>6&63|128,se&63|128)}else throw new Error("Invalid code point")}return Le}function Ie(je){const ge=[];for(let se=0;se<je.length;++se)ge.push(je.charCodeAt(se)&255);return ge}function be(je,ge){let se,_e,Ne;const Le=[];for(let ke=0;ke<je.length&&!((ge-=2)<0);++ke)se=je.charCodeAt(ke),_e=se>>8,Ne=se%256,Le.push(Ne),Le.push(_e);return Le}function Ke(je){return e.toByteArray(me(je))}function ot(je,ge,se,_e){let Ne;for(Ne=0;Ne<_e&&!(Ne+se>=ge.length||Ne>=je.length);++Ne)ge[Ne+se]=je[Ne];return Ne}function lt(je,ge){return je instanceof ge||je!=null&&je.constructor!=null&&je.constructor.name!=null&&je.constructor.name===ge.name}function ct(je){return je!==je}const Vt=(function(){const je="0123456789abcdef",ge=new Array(256);for(let se=0;se<16;++se){const _e=se*16;for(let Ne=0;Ne<16;++Ne)ge[_e+Ne]=je[se]+je[Ne]}return ge})();function kt(je){return typeof BigInt>"u"?Ut:je}function Ut(){throw new Error("BigInt not supported")}})(_le);const mf=_le.Buffer;function TI(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var J6={exports:{}},wY;function h3e(){return wY||(wY=1,(function(n,e){(function(t){n.exports=t()})(function(){return(function t(r,i,s){function a(c,u){if(!i[c]){if(!r[c]){var f=typeof TI=="function"&&TI;if(!u&&f)return f(c,!0);if(o)return o(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var g=i[c]={exports:{}};r[c][0].call(g.exports,function(p){var _=r[c][1][p];return a(_||p)},g,g.exports,t,r,i,s)}return i[c].exports}for(var o=typeof TI=="function"&&TI,l=0;l<s.length;l++)a(s[l]);return a})({1:[function(t,r,i){var s=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(l){for(var c,u,f,d,g,p,_,y=[],v=0,x=l.length,E=x,M=s.getTypeOf(l)!=="string";v<l.length;)E=x-v,f=M?(c=l[v++],u=v<x?l[v++]:0,v<x?l[v++]:0):(c=l.charCodeAt(v++),u=v<x?l.charCodeAt(v++):0,v<x?l.charCodeAt(v++):0),d=c>>2,g=(3&c)<<4|u>>4,p=1<E?(15&u)<<2|f>>6:64,_=2<E?63&f:64,y.push(o.charAt(d)+o.charAt(g)+o.charAt(p)+o.charAt(_));return y.join("")},i.decode=function(l){var c,u,f,d,g,p,_=0,y=0,v="data:";if(l.substr(0,v.length)===v)throw new Error("Invalid base64 input, it looks like a data url.");var x,E=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&E--,l.charAt(l.length-2)===o.charAt(64)&&E--,E%1!=0)throw new Error("Invalid base64 input, bad content length.");for(x=a.uint8array?new Uint8Array(0|E):new Array(0|E);_<l.length;)c=o.indexOf(l.charAt(_++))<<2|(d=o.indexOf(l.charAt(_++)))>>4,u=(15&d)<<4|(g=o.indexOf(l.charAt(_++)))>>2,f=(3&g)<<6|(p=o.indexOf(l.charAt(_++))),x[y++]=c,g!==64&&(x[y++]=u),p!==64&&(x[y++]=f);return x}},{"./support":30,"./utils":32}],2:[function(t,r,i){var s=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function c(u,f,d,g,p){this.compressedSize=u,this.uncompressedSize=f,this.crc32=d,this.compression=g,this.compressedContent=p}c.prototype={getContentWorker:function(){var u=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),f=this;return u.on("end",function(){if(this.streamInfo.data_length!==f.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,f,d){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(f.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",f)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,r,i){var s=t("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,r,i){var s=t("./utils"),a=(function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l})();r.exports=function(o,l){return o!==void 0&&o.length?s.getTypeOf(o)!=="string"?(function(c,u,f,d){var g=a,p=d+f;c^=-1;for(var _=d;_<p;_++)c=c>>>8^g[255&(c^u[_])];return-1^c})(0|l,o,o.length,0):(function(c,u,f,d){var g=a,p=d+f;c^=-1;for(var _=d;_<p;_++)c=c>>>8^g[255&(c^u.charCodeAt(_))];return-1^c})(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(t,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(t,r,i){var s=null;s=typeof Promise<"u"?Promise:t("lie"),r.exports={Promise:s}},{lie:37}],7:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=t("pako"),o=t("./utils"),l=t("./stream/GenericWorker"),c=s?"uint8array":"array";function u(f,d){l.call(this,"FlateWorker/"+f),this._pako=null,this._pakoAction=f,this._pakoOptions=d,this.meta={}}i.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(f){this.meta=f.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,f.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var f=this;this._pako.onData=function(d){f.push({data:d,meta:f.meta})}},i.compressWorker=function(f){return new u("Deflate",f)},i.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,r,i){function s(g,p){var _,y="";for(_=0;_<p;_++)y+=String.fromCharCode(255&g),g>>>=8;return y}function a(g,p,_,y,v,x){var E,M,O=g.file,N=g.compression,I=x!==c.utf8encode,D=o.transformTo("string",x(O.name)),V=o.transformTo("string",c.utf8encode(O.name)),G=O.comment,Q=o.transformTo("string",x(G)),B=o.transformTo("string",c.utf8encode(G)),$=V.length!==O.name.length,U=B.length!==G.length,J="",W="",q="",Y=O.dir,ae=O.date,Z={crc32:0,compressedSize:0,uncompressedSize:0};p&&!_||(Z.crc32=g.crc32,Z.compressedSize=g.compressedSize,Z.uncompressedSize=g.uncompressedSize);var K=0;p&&(K|=8),I||!$&&!U||(K|=2048);var ne=0,le=0;Y&&(ne|=16),v==="UNIX"?(le=798,ne|=(function(de,Me){var qe=de;return de||(qe=Me?16893:33204),(65535&qe)<<16})(O.unixPermissions,Y)):(le=20,ne|=(function(de){return 63&(de||0)})(O.dosPermissions)),E=ae.getUTCHours(),E<<=6,E|=ae.getUTCMinutes(),E<<=5,E|=ae.getUTCSeconds()/2,M=ae.getUTCFullYear()-1980,M<<=4,M|=ae.getUTCMonth()+1,M<<=5,M|=ae.getUTCDate(),$&&(W=s(1,1)+s(u(D),4)+V,J+="up"+s(W.length,2)+W),U&&(q=s(1,1)+s(u(Q),4)+B,J+="uc"+s(q.length,2)+q);var ce="";return ce+=`
\0`,ce+=s(K,2),ce+=N.magic,ce+=s(E,2),ce+=s(M,2),ce+=s(Z.crc32,4),ce+=s(Z.compressedSize,4),ce+=s(Z.uncompressedSize,4),ce+=s(D.length,2),ce+=s(J.length,2),{fileRecord:f.LOCAL_FILE_HEADER+ce+D+J,dirRecord:f.CENTRAL_FILE_HEADER+s(le,2)+ce+s(Q.length,2)+"\0\0\0\0"+s(ne,4)+s(y,4)+D+J+Q}}var o=t("../utils"),l=t("../stream/GenericWorker"),c=t("../utf8"),u=t("../crc32"),f=t("../signature");function d(g,p,_,y){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=p,this.zipPlatform=_,this.encodeFileName=y,this.streamFiles=g,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,l),d.prototype.push=function(g){var p=g.meta.percent||0,_=this.entriesCount,y=this._sources.length;this.accumulate?this.contentBuffer.push(g):(this.bytesWritten+=g.data.length,l.prototype.push.call(this,{data:g.data,meta:{currentFile:this.currentFile,percent:_?(p+100*(_-y-1))/_:100}}))},d.prototype.openedSource=function(g){this.currentSourceOffset=this.bytesWritten,this.currentFile=g.file.name;var p=this.streamFiles&&!g.file.dir;if(p){var _=a(g,p,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(g){this.accumulate=!1;var p=this.streamFiles&&!g.file.dir,_=a(g,p,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),p)this.push({data:(function(y){return f.DATA_DESCRIPTOR+s(y.crc32,4)+s(y.compressedSize,4)+s(y.uncompressedSize,4)})(g),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var g=this.bytesWritten,p=0;p<this.dirRecords.length;p++)this.push({data:this.dirRecords[p],meta:{percent:100}});var _=this.bytesWritten-g,y=(function(v,x,E,M,O){var N=o.transformTo("string",O(M));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(v,2)+s(v,2)+s(x,4)+s(E,4)+s(N.length,2)+N})(this.dirRecords.length,_,g,this.zipComment,this.encodeFileName);this.push({data:y,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(g){this._sources.push(g);var p=this;return g.on("data",function(_){p.processChunk(_)}),g.on("end",function(){p.closedSource(p.previous.streamInfo),p._sources.length?p.prepareNextSource():p.end()}),g.on("error",function(_){p.error(_)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(g){var p=this._sources;if(!l.prototype.error.call(this,g))return!1;for(var _=0;_<p.length;_++)try{p[_].error(g)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var g=this._sources,p=0;p<g.length;p++)g[p].lock()},r.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,r,i){var s=t("../compressions"),a=t("./ZipFileWorker");i.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),f=0;try{o.forEach(function(d,g){f++;var p=(function(x,E){var M=x||E,O=s[M];if(!O)throw new Error(M+" is not a valid compression method !");return O})(g.options.compression,l.compression),_=g.options.compressionOptions||l.compressionOptions||{},y=g.dir,v=g.date;g._compressWorker(p,_).withStreamInfo("file",{name:d,dir:y,date:v,comment:g.comment||"",unixPermissions:g.unixPermissions,dosPermissions:g.dosPermissions}).pipe(u)}),u.entriesCount=f}catch(d){u.error(d)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(s.prototype=t("./object")).loadAsync=t("./load"),s.support=t("./support"),s.defaults=t("./defaults"),s.version="3.10.1",s.loadAsync=function(a,o){return new s().loadAsync(a,o)},s.external=t("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,r,i){var s=t("./utils"),a=t("./external"),o=t("./utf8"),l=t("./zipEntries"),c=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function f(d){return new a.Promise(function(g,p){var _=d.decompressed.getContentWorker().pipe(new c);_.on("error",function(y){p(y)}).on("end",function(){_.streamInfo.crc32!==d.decompressed.crc32?p(new Error("Corrupted zip : CRC32 mismatch")):g()}).resume()})}r.exports=function(d,g){var p=this;return g=s.extend(g||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(d)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",d,!0,g.optimizedBinaryString,g.base64).then(function(_){var y=new l(g);return y.load(_),y}).then(function(_){var y=[a.Promise.resolve(_)],v=_.files;if(g.checkCRC32)for(var x=0;x<v.length;x++)y.push(f(v[x]));return a.Promise.all(y)}).then(function(_){for(var y=_.shift(),v=y.files,x=0;x<v.length;x++){var E=v[x],M=E.fileNameStr,O=s.resolve(E.fileNameStr);p.file(O,E.decompressed,{binary:!0,optimizedBinaryString:!0,date:E.date,dir:E.dir,comment:E.fileCommentStr.length?E.fileCommentStr:null,unixPermissions:E.unixPermissions,dosPermissions:E.dosPermissions,createFolders:g.createFolders}),E.dir||(p.file(O).unsafeOriginalName=M)}return y.zipComment.length&&(p.comment=y.zipComment),p})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,r,i){var s=t("../utils"),a=t("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}s.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,r,i){var s=t("readable-stream").Readable;function a(o,l,c){s.call(this,l),this._helper=o;var u=this;o.on("data",function(f,d){u.push(f)||u._helper.pause(),c&&c(d)}).on("error",function(f){u.emit("error",f)}).on("end",function(){u.push(null)})}t("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,r,i){r.exports={isNode:typeof mf<"u",newBufferFrom:function(s,a){if(mf.from&&mf.from!==Uint8Array.from)return mf.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new mf(s,a)},allocBuffer:function(s){if(mf.alloc)return mf.alloc(s);var a=new mf(s);return a.fill(0),a},isBuffer:function(s){return mf.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(t,r,i){function s(O,N,I){var D,V=o.getTypeOf(N),G=o.extend(I||{},u);G.date=G.date||new Date,G.compression!==null&&(G.compression=G.compression.toUpperCase()),typeof G.unixPermissions=="string"&&(G.unixPermissions=parseInt(G.unixPermissions,8)),G.unixPermissions&&16384&G.unixPermissions&&(G.dir=!0),G.dosPermissions&&16&G.dosPermissions&&(G.dir=!0),G.dir&&(O=v(O)),G.createFolders&&(D=y(O))&&x.call(this,D,!0);var Q=V==="string"&&G.binary===!1&&G.base64===!1;I&&I.binary!==void 0||(G.binary=!Q),(N instanceof f&&N.uncompressedSize===0||G.dir||!N||N.length===0)&&(G.base64=!1,G.binary=!0,N="",G.compression="STORE",V="string");var B=null;B=N instanceof f||N instanceof l?N:p.isNode&&p.isStream(N)?new _(O,N):o.prepareContent(O,N,G.binary,G.optimizedBinaryString,G.base64);var $=new d(O,B,G);this.files[O]=$}var a=t("./utf8"),o=t("./utils"),l=t("./stream/GenericWorker"),c=t("./stream/StreamHelper"),u=t("./defaults"),f=t("./compressedObject"),d=t("./zipObject"),g=t("./generate"),p=t("./nodejsUtils"),_=t("./nodejs/NodejsStreamInputAdapter"),y=function(O){O.slice(-1)==="/"&&(O=O.substring(0,O.length-1));var N=O.lastIndexOf("/");return 0<N?O.substring(0,N):""},v=function(O){return O.slice(-1)!=="/"&&(O+="/"),O},x=function(O,N){return N=N!==void 0?N:u.createFolders,O=v(O),this.files[O]||s.call(this,O,null,{dir:!0,createFolders:N}),this.files[O]};function E(O){return Object.prototype.toString.call(O)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(O){var N,I,D;for(N in this.files)D=this.files[N],(I=N.slice(this.root.length,N.length))&&N.slice(0,this.root.length)===this.root&&O(I,D)},filter:function(O){var N=[];return this.forEach(function(I,D){O(I,D)&&N.push(D)}),N},file:function(O,N,I){if(arguments.length!==1)return O=this.root+O,s.call(this,O,N,I),this;if(E(O)){var D=O;return this.filter(function(G,Q){return!Q.dir&&D.test(G)})}var V=this.files[this.root+O];return V&&!V.dir?V:null},folder:function(O){if(!O)return this;if(E(O))return this.filter(function(V,G){return G.dir&&O.test(V)});var N=this.root+O,I=x.call(this,N),D=this.clone();return D.root=I.name,D},remove:function(O){O=this.root+O;var N=this.files[O];if(N||(O.slice(-1)!=="/"&&(O+="/"),N=this.files[O]),N&&!N.dir)delete this.files[O];else for(var I=this.filter(function(V,G){return G.name.slice(0,O.length)===O}),D=0;D<I.length;D++)delete this.files[I[D].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(O){var N,I={};try{if((I=o.extend(O||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=I.type.toLowerCase(),I.compression=I.compression.toUpperCase(),I.type==="binarystring"&&(I.type="string"),!I.type)throw new Error("No output type specified.");o.checkSupport(I.type),I.platform!=="darwin"&&I.platform!=="freebsd"&&I.platform!=="linux"&&I.platform!=="sunos"||(I.platform="UNIX"),I.platform==="win32"&&(I.platform="DOS");var D=I.comment||this.comment||"";N=g.generateWorker(this,I,D)}catch(V){(N=new l("error")).error(V)}return new c(N,I.type||"string",I.mimeType)},generateAsync:function(O,N){return this.generateInternalStream(O).accumulate(N)},generateNodeStream:function(O,N){return(O=O||{}).type||(O.type="nodebuffer"),this.generateInternalStream(O).toNodejsStream(N)}};r.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,r,i){r.exports=t("stream")},{stream:void 0}],17:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===c&&this.data[d+2]===u&&this.data[d+3]===f)return d-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),f=o.charCodeAt(3),d=this.readData(4);return l===d[0]&&c===d[1]&&u===d[2]&&f===d[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,r,i){var s=t("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return s.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(t,r,i){var s=t("./Uint8ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,r,i){var s=t("./DataReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,r,i){var s=t("./ArrayReader");function a(o){s.call(this,o)}t("../utils").inherits(a,s),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,r,i){var s=t("../utils"),a=t("../support"),o=t("./ArrayReader"),l=t("./StringReader"),c=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");r.exports=function(f){var d=s.getTypeOf(f);return s.checkSupport(d),d!=="string"||a.uint8array?d==="nodebuffer"?new c(f):a.uint8array?new u(s.transformTo("uint8array",f)):new o(s.transformTo("array",f)):new l(f)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,r,i){var s=t("./GenericWorker"),a=t("../utils");function o(l){s.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,s),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,r,i){var s=t("./GenericWorker"),a=t("../crc32");function o(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,s),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}s.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,r,i){var s=t("../utils"),a=t("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=s.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}s.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,r,i){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=s},{}],29:[function(t,r,i){var s=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),l=t("../base64"),c=t("../support"),u=t("../external"),f=null;if(c.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(p,_){return new u.Promise(function(y,v){var x=[],E=p._internalType,M=p._outputType,O=p._mimeType;p.on("data",function(N,I){x.push(N),_&&_(I)}).on("error",function(N){x=[],v(N)}).on("end",function(){try{var N=(function(I,D,V){switch(I){case"blob":return s.newBlob(s.transformTo("arraybuffer",D),V);case"base64":return l.encode(D);default:return s.transformTo(I,D)}})(M,(function(I,D){var V,G=0,Q=null,B=0;for(V=0;V<D.length;V++)B+=D[V].length;switch(I){case"string":return D.join("");case"array":return Array.prototype.concat.apply([],D);case"uint8array":for(Q=new Uint8Array(B),V=0;V<D.length;V++)Q.set(D[V],G),G+=D[V].length;return Q;case"nodebuffer":return mf.concat(D);default:throw new Error("concat : unsupported type '"+I+"'")}})(E,x),O);y(N)}catch(I){v(I)}x=[]}).resume()})}function g(p,_,y){var v=_;switch(_){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string"}try{this._internalType=v,this._outputType=_,this._mimeType=y,s.checkSupport(v),this._worker=p.pipe(new a(v)),p.lock()}catch(x){this._worker=new o("error"),this._worker.error(x)}}g.prototype={accumulate:function(p){return d(this,p)},on:function(p,_){var y=this;return p==="data"?this._worker.on(p,function(v){_.call(y,v.data,v.meta)}):this._worker.on(p,function(){s.delay(_,arguments,y)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(p){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:this._outputType!=="nodebuffer"},p)}},r.exports=g},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof mf<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),i.blob=a.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!t("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(t,r,i){for(var s=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),l=t("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function f(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}i.utf8encode=function(g){return a.nodebuffer?o.newBufferFrom(g,"utf-8"):(function(p){var _,y,v,x,E,M=p.length,O=0;for(x=0;x<M;x++)(64512&(y=p.charCodeAt(x)))==55296&&x+1<M&&(64512&(v=p.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),x++),O+=y<128?1:y<2048?2:y<65536?3:4;for(_=a.uint8array?new Uint8Array(O):new Array(O),x=E=0;E<O;x++)(64512&(y=p.charCodeAt(x)))==55296&&x+1<M&&(64512&(v=p.charCodeAt(x+1)))==56320&&(y=65536+(y-55296<<10)+(v-56320),x++),y<128?_[E++]=y:(y<2048?_[E++]=192|y>>>6:(y<65536?_[E++]=224|y>>>12:(_[E++]=240|y>>>18,_[E++]=128|y>>>12&63),_[E++]=128|y>>>6&63),_[E++]=128|63&y);return _})(g)},i.utf8decode=function(g){return a.nodebuffer?s.transformTo("nodebuffer",g).toString("utf-8"):(function(p){var _,y,v,x,E=p.length,M=new Array(2*E);for(_=y=0;_<E;)if((v=p[_++])<128)M[y++]=v;else if(4<(x=c[v]))M[y++]=65533,_+=x-1;else{for(v&=x===2?31:x===3?15:7;1<x&&_<E;)v=v<<6|63&p[_++],x--;1<x?M[y++]=65533:v<65536?M[y++]=v:(v-=65536,M[y++]=55296|v>>10&1023,M[y++]=56320|1023&v)}return M.length!==y&&(M.subarray?M=M.subarray(0,y):M.length=y),s.applyFromCharCode(M)})(g=s.transformTo(a.uint8array?"uint8array":"array",g))},s.inherits(f,l),f.prototype.processChunk=function(g){var p=s.transformTo(a.uint8array?"uint8array":"array",g.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var _=p;(p=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),p.set(_,this.leftOver.length)}else p=this.leftOver.concat(p);this.leftOver=null}var y=(function(x,E){var M;for((E=E||x.length)>x.length&&(E=x.length),M=E-1;0<=M&&(192&x[M])==128;)M--;return M<0||M===0?E:M+c[x[M]]>E?M:E})(p),v=p;y!==p.length&&(a.uint8array?(v=p.subarray(0,y),this.leftOver=p.subarray(y,p.length)):(v=p.slice(0,y),this.leftOver=p.slice(y,p.length))),this.push({data:i.utf8decode(v),meta:g.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=f,s.inherits(d,l),d.prototype.processChunk=function(g){this.push({data:i.utf8encode(g.data),meta:g.meta})},i.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,r,i){var s=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),l=t("./external");function c(_){return _}function u(_,y){for(var v=0;v<_.length;++v)y[v]=255&_.charCodeAt(v);return y}t("setimmediate"),i.newBlob=function(_,y){i.checkSupport("blob");try{return new Blob([_],{type:y})}catch{try{var v=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return v.append(_),v.getBlob(y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(_,y,v){var x=[],E=0,M=_.length;if(M<=v)return String.fromCharCode.apply(null,_);for(;E<M;)y==="array"||y==="nodebuffer"?x.push(String.fromCharCode.apply(null,_.slice(E,Math.min(E+v,M)))):x.push(String.fromCharCode.apply(null,_.subarray(E,Math.min(E+v,M)))),E+=v;return x.join("")},stringifyByChar:function(_){for(var y="",v=0;v<_.length;v++)y+=String.fromCharCode(_[v]);return y},applyCanBeUsed:{uint8array:(function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}})()}};function d(_){var y=65536,v=i.getTypeOf(_),x=!0;if(v==="uint8array"?x=f.applyCanBeUsed.uint8array:v==="nodebuffer"&&(x=f.applyCanBeUsed.nodebuffer),x)for(;1<y;)try{return f.stringifyByChunk(_,v,y)}catch{y=Math.floor(y/2)}return f.stringifyByChar(_)}function g(_,y){for(var v=0;v<_.length;v++)y[v]=_[v];return y}i.applyFromCharCode=d;var p={};p.string={string:c,array:function(_){return u(_,new Array(_.length))},arraybuffer:function(_){return p.string.uint8array(_).buffer},uint8array:function(_){return u(_,new Uint8Array(_.length))},nodebuffer:function(_){return u(_,o.allocBuffer(_.length))}},p.array={string:d,array:c,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return o.newBufferFrom(_)}},p.arraybuffer={string:function(_){return d(new Uint8Array(_))},array:function(_){return g(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:c,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return o.newBufferFrom(new Uint8Array(_))}},p.uint8array={string:d,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:c,nodebuffer:function(_){return o.newBufferFrom(_)}},p.nodebuffer={string:d,array:function(_){return g(_,new Array(_.length))},arraybuffer:function(_){return p.nodebuffer.uint8array(_).buffer},uint8array:function(_){return g(_,new Uint8Array(_.length))},nodebuffer:c},i.transformTo=function(_,y){if(y=y||"",!_)return y;i.checkSupport(_);var v=i.getTypeOf(y);return p[v][_](y)},i.resolve=function(_){for(var y=_.split("/"),v=[],x=0;x<y.length;x++){var E=y[x];E==="."||E===""&&x!==0&&x!==y.length-1||(E===".."?v.pop():v.push(E))}return v.join("/")},i.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":s.nodebuffer&&o.isBuffer(_)?"nodebuffer":s.uint8array&&_ instanceof Uint8Array?"uint8array":s.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(_){if(!s[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(_){var y,v,x="";for(v=0;v<(_||"").length;v++)x+="\\x"+((y=_.charCodeAt(v))<16?"0":"")+y.toString(16).toUpperCase();return x},i.delay=function(_,y,v){setImmediate(function(){_.apply(v||null,y||[])})},i.inherits=function(_,y){function v(){}v.prototype=y.prototype,_.prototype=new v},i.extend=function(){var _,y,v={};for(_=0;_<arguments.length;_++)for(y in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],y)&&v[y]===void 0&&(v[y]=arguments[_][y]);return v},i.prepareContent=function(_,y,v,x,E){return l.Promise.resolve(y).then(function(M){return s.blob&&(M instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(M))!==-1)&&typeof FileReader<"u"?new l.Promise(function(O,N){var I=new FileReader;I.onload=function(D){O(D.target.result)},I.onerror=function(D){N(D.target.error)},I.readAsArrayBuffer(M)}):M}).then(function(M){var O=i.getTypeOf(M);return O?(O==="arraybuffer"?M=i.transformTo("uint8array",M):O==="string"&&(E?M=a.decode(M):v&&x!==!0&&(M=(function(N){return u(N,s.uint8array?new Uint8Array(N.length):new Array(N.length))})(M))),M):l.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),l=t("./zipEntry"),c=t("./support");function u(f){this.files=[],this.loadOptions=f}u.prototype={checkSignature:function(f){if(!this.reader.readAndCheckSignature(f)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(d)+", expected "+a.pretty(f)+")")}},isSignature:function(f,d){var g=this.reader.index;this.reader.setIndex(f);var p=this.reader.readString(4)===d;return this.reader.setIndex(g),p},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var f=this.reader.readData(this.zipCommentLength),d=c.uint8array?"uint8array":"array",g=a.transformTo(d,f);this.zipComment=this.loadOptions.decodeFileName(g)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var f,d,g,p=this.zip64EndOfCentralSize-44;0<p;)f=this.reader.readInt(2),d=this.reader.readInt(4),g=this.reader.readData(d),this.zip64ExtensibleData[f]={id:f,length:d,value:g}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var f,d;for(f=0;f<this.files.length;f++)d=this.files[f],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var f;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(f=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(f);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var f=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(f<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(f);var d=f;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(f=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(f),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var g=this.centralDirOffset+this.centralDirSize;this.zip64&&(g+=20,g+=12+this.zip64EndOfCentralSize);var p=d-g;if(0<p)this.isSignature(d,o.CENTRAL_FILE_HEADER)||(this.reader.zero=p);else if(p<0)throw new Error("Corrupted zip: missing "+Math.abs(p)+" bytes.")},prepareReader:function(f){this.reader=s(f)},load:function(f){this.prepareReader(f),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,r,i){var s=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),l=t("./crc32"),c=t("./utf8"),u=t("./compressions"),f=t("./support");function d(g,p){this.options=g,this.loadOptions=p}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(g){var p,_;if(g.skip(22),this.fileNameLength=g.readInt(2),_=g.readInt(2),this.fileName=g.readData(this.fileNameLength),g.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((p=(function(y){for(var v in u)if(Object.prototype.hasOwnProperty.call(u,v)&&u[v].magic===y)return u[v];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,p,g.readData(this.compressedSize))},readCentralPart:function(g){this.versionMadeBy=g.readInt(2),g.skip(2),this.bitFlag=g.readInt(2),this.compressionMethod=g.readString(2),this.date=g.readDate(),this.crc32=g.readInt(4),this.compressedSize=g.readInt(4),this.uncompressedSize=g.readInt(4);var p=g.readInt(2);if(this.extraFieldsLength=g.readInt(2),this.fileCommentLength=g.readInt(2),this.diskNumberStart=g.readInt(2),this.internalFileAttributes=g.readInt(2),this.externalFileAttributes=g.readInt(4),this.localHeaderOffset=g.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");g.skip(p),this.readExtraFields(g),this.parseZIP64ExtraField(g),this.fileComment=g.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var g=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),g==0&&(this.dosPermissions=63&this.externalFileAttributes),g==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var g=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=g.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=g.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=g.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=g.readInt(4))}},readExtraFields:function(g){var p,_,y,v=g.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});g.index+4<v;)p=g.readInt(2),_=g.readInt(2),y=g.readData(_),this.extraFields[p]={id:p,length:_,value:y};g.setIndex(v)},handleUTF8:function(){var g=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var p=this.findExtraFieldUnicodePath();if(p!==null)this.fileNameStr=p;else{var _=a.transformTo(g,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var y=this.findExtraFieldUnicodeComment();if(y!==null)this.fileCommentStr=y;else{var v=a.transformTo(g,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(v)}}},findExtraFieldUnicodePath:function(){var g=this.extraFields[28789];if(g){var p=s(g.value);return p.readInt(1)!==1||l(this.fileName)!==p.readInt(4)?null:c.utf8decode(p.readData(g.length-5))}return null},findExtraFieldUnicodeComment:function(){var g=this.extraFields[25461];if(g){var p=s(g.value);return p.readInt(1)!==1||l(this.fileComment)!==p.readInt(4)?null:c.utf8decode(p.readData(g.length-5))}return null}},r.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,r,i){function s(p,_,y){this.name=p,this.dir=y.dir,this.date=y.date,this.comment=y.comment,this.unixPermissions=y.unixPermissions,this.dosPermissions=y.dosPermissions,this._data=_,this._dataBinary=y.binary,this.options={compression:y.compression,compressionOptions:y.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),l=t("./utf8"),c=t("./compressedObject"),u=t("./stream/GenericWorker");s.prototype={internalStream:function(p){var _=null,y="string";try{if(!p)throw new Error("No output type specified.");var v=(y=p.toLowerCase())==="string"||y==="text";y!=="binarystring"&&y!=="text"||(y="string"),_=this._decompressWorker();var x=!this._dataBinary;x&&!v&&(_=_.pipe(new l.Utf8EncodeWorker)),!x&&v&&(_=_.pipe(new l.Utf8DecodeWorker))}catch(E){(_=new u("error")).error(E)}return new a(_,y,"")},async:function(p,_){return this.internalStream(p).accumulate(_)},nodeStream:function(p,_){return this.internalStream(p||"nodebuffer").toNodejsStream(_)},_compressWorker:function(p,_){if(this._data instanceof c&&this._data.compression.magic===p.magic)return this._data.getCompressedWorker();var y=this._decompressWorker();return this._dataBinary||(y=y.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(y,p,_)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},g=0;g<f.length;g++)s.prototype[f[g]]=d;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,r,i){(function(s){var a,o,l=s.MutationObserver||s.WebKitMutationObserver;if(l){var c=0,u=new l(p),f=s.document.createTextNode("");u.observe(f,{characterData:!0}),a=function(){f.data=c=++c%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var _=s.document.createElement("script");_.onreadystatechange=function(){p(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},s.document.documentElement.appendChild(_)}:function(){setTimeout(p,0)};else{var d=new s.MessageChannel;d.port1.onmessage=p,a=function(){d.port2.postMessage(0)}}var g=[];function p(){var _,y;o=!0;for(var v=g.length;v;){for(y=g,g=[],_=-1;++_<v;)y[_]();v=g.length}o=!1}r.exports=function(_){g.push(_)!==1||o||a()}}).call(this,typeof C0<"u"?C0:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(t,r,i){var s=t("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function f(v){if(typeof v!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,v!==a&&_(this,v)}function d(v,x,E){this.promise=v,typeof x=="function"&&(this.onFulfilled=x,this.callFulfilled=this.otherCallFulfilled),typeof E=="function"&&(this.onRejected=E,this.callRejected=this.otherCallRejected)}function g(v,x,E){s(function(){var M;try{M=x(E)}catch(O){return o.reject(v,O)}M===v?o.reject(v,new TypeError("Cannot resolve promise with itself")):o.resolve(v,M)})}function p(v){var x=v&&v.then;if(v&&(typeof v=="object"||typeof v=="function")&&typeof x=="function")return function(){x.apply(v,arguments)}}function _(v,x){var E=!1;function M(I){E||(E=!0,o.reject(v,I))}function O(I){E||(E=!0,o.resolve(v,I))}var N=y(function(){x(O,M)});N.status==="error"&&M(N.value)}function y(v,x){var E={};try{E.value=v(x),E.status="success"}catch(M){E.status="error",E.value=M}return E}(r.exports=f).prototype.finally=function(v){if(typeof v!="function")return this;var x=this.constructor;return this.then(function(E){return x.resolve(v()).then(function(){return E})},function(E){return x.resolve(v()).then(function(){throw E})})},f.prototype.catch=function(v){return this.then(null,v)},f.prototype.then=function(v,x){if(typeof v!="function"&&this.state===c||typeof x!="function"&&this.state===l)return this;var E=new this.constructor(a);return this.state!==u?g(E,this.state===c?v:x,this.outcome):this.queue.push(new d(E,v,x)),E},d.prototype.callFulfilled=function(v){o.resolve(this.promise,v)},d.prototype.otherCallFulfilled=function(v){g(this.promise,this.onFulfilled,v)},d.prototype.callRejected=function(v){o.reject(this.promise,v)},d.prototype.otherCallRejected=function(v){g(this.promise,this.onRejected,v)},o.resolve=function(v,x){var E=y(p,x);if(E.status==="error")return o.reject(v,E.value);var M=E.value;if(M)_(v,M);else{v.state=c,v.outcome=x;for(var O=-1,N=v.queue.length;++O<N;)v.queue[O].callFulfilled(x)}return v},o.reject=function(v,x){v.state=l,v.outcome=x;for(var E=-1,M=v.queue.length;++E<M;)v.queue[E].callRejected(x);return v},f.resolve=function(v){return v instanceof this?v:o.resolve(new this(a),v)},f.reject=function(v){var x=new this(a);return o.reject(x,v)},f.all=function(v){var x=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=v.length,M=!1;if(!E)return this.resolve([]);for(var O=new Array(E),N=0,I=-1,D=new this(a);++I<E;)V(v[I],I);return D;function V(G,Q){x.resolve(G).then(function(B){O[Q]=B,++N!==E||M||(M=!0,o.resolve(D,O))},function(B){M||(M=!0,o.reject(D,B))})}},f.race=function(v){var x=this;if(Object.prototype.toString.call(v)!=="[object Array]")return this.reject(new TypeError("must be an array"));var E=v.length,M=!1;if(!E)return this.resolve([]);for(var O=-1,N=new this(a);++O<E;)I=v[O],x.resolve(I).then(function(D){M||(M=!0,o.resolve(N,D))},function(D){M||(M=!0,o.reject(N,D))});var I;return N}},{immediate:36}],38:[function(t,r,i){var s={};(0,t("./lib/utils/common").assign)(s,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,r,i){var s=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/messages"),c=t("./zlib/zstream"),u=Object.prototype.toString,f=0,d=-1,g=0,p=8;function _(v){if(!(this instanceof _))return new _(v);this.options=a.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:g,to:""},v||{});var x=this.options;x.raw&&0<x.windowBits?x.windowBits=-x.windowBits:x.gzip&&0<x.windowBits&&x.windowBits<16&&(x.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var E=s.deflateInit2(this.strm,x.level,x.method,x.windowBits,x.memLevel,x.strategy);if(E!==f)throw new Error(l[E]);if(x.header&&s.deflateSetHeader(this.strm,x.header),x.dictionary){var M;if(M=typeof x.dictionary=="string"?o.string2buf(x.dictionary):u.call(x.dictionary)==="[object ArrayBuffer]"?new Uint8Array(x.dictionary):x.dictionary,(E=s.deflateSetDictionary(this.strm,M))!==f)throw new Error(l[E]);this._dict_set=!0}}function y(v,x){var E=new _(x);if(E.push(v,!0),E.err)throw E.msg||l[E.err];return E.result}_.prototype.push=function(v,x){var E,M,O=this.strm,N=this.options.chunkSize;if(this.ended)return!1;M=x===~~x?x:x===!0?4:0,typeof v=="string"?O.input=o.string2buf(v):u.call(v)==="[object ArrayBuffer]"?O.input=new Uint8Array(v):O.input=v,O.next_in=0,O.avail_in=O.input.length;do{if(O.avail_out===0&&(O.output=new a.Buf8(N),O.next_out=0,O.avail_out=N),(E=s.deflate(O,M))!==1&&E!==f)return this.onEnd(E),!(this.ended=!0);O.avail_out!==0&&(O.avail_in!==0||M!==4&&M!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(O.output,O.next_out))):this.onData(a.shrinkBuf(O.output,O.next_out)))}while((0<O.avail_in||O.avail_out===0)&&E!==1);return M===4?(E=s.deflateEnd(this.strm),this.onEnd(E),this.ended=!0,E===f):M!==2||(this.onEnd(f),!(O.avail_out=0))},_.prototype.onData=function(v){this.chunks.push(v)},_.prototype.onEnd=function(v){v===f&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Deflate=_,i.deflate=y,i.deflateRaw=function(v,x){return(x=x||{}).raw=!0,y(v,x)},i.gzip=function(v,x){return(x=x||{}).gzip=!0,y(v,x)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,r,i){var s=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),l=t("./zlib/constants"),c=t("./zlib/messages"),u=t("./zlib/zstream"),f=t("./zlib/gzheader"),d=Object.prototype.toString;function g(_){if(!(this instanceof g))return new g(_);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},_||{});var y=this.options;y.raw&&0<=y.windowBits&&y.windowBits<16&&(y.windowBits=-y.windowBits,y.windowBits===0&&(y.windowBits=-15)),!(0<=y.windowBits&&y.windowBits<16)||_&&_.windowBits||(y.windowBits+=32),15<y.windowBits&&y.windowBits<48&&(15&y.windowBits)==0&&(y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var v=s.inflateInit2(this.strm,y.windowBits);if(v!==l.Z_OK)throw new Error(c[v]);this.header=new f,s.inflateGetHeader(this.strm,this.header)}function p(_,y){var v=new g(y);if(v.push(_,!0),v.err)throw v.msg||c[v.err];return v.result}g.prototype.push=function(_,y){var v,x,E,M,O,N,I=this.strm,D=this.options.chunkSize,V=this.options.dictionary,G=!1;if(this.ended)return!1;x=y===~~y?y:y===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof _=="string"?I.input=o.binstring2buf(_):d.call(_)==="[object ArrayBuffer]"?I.input=new Uint8Array(_):I.input=_,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new a.Buf8(D),I.next_out=0,I.avail_out=D),(v=s.inflate(I,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&V&&(N=typeof V=="string"?o.string2buf(V):d.call(V)==="[object ArrayBuffer]"?new Uint8Array(V):V,v=s.inflateSetDictionary(this.strm,N)),v===l.Z_BUF_ERROR&&G===!0&&(v=l.Z_OK,G=!1),v!==l.Z_STREAM_END&&v!==l.Z_OK)return this.onEnd(v),!(this.ended=!0);I.next_out&&(I.avail_out!==0&&v!==l.Z_STREAM_END&&(I.avail_in!==0||x!==l.Z_FINISH&&x!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(E=o.utf8border(I.output,I.next_out),M=I.next_out-E,O=o.buf2string(I.output,E),I.next_out=M,I.avail_out=D-M,M&&a.arraySet(I.output,I.output,E,M,0),this.onData(O)):this.onData(a.shrinkBuf(I.output,I.next_out)))),I.avail_in===0&&I.avail_out===0&&(G=!0)}while((0<I.avail_in||I.avail_out===0)&&v!==l.Z_STREAM_END);return v===l.Z_STREAM_END&&(x=l.Z_FINISH),x===l.Z_FINISH?(v=s.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===l.Z_OK):x!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(I.avail_out=0))},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},i.Inflate=g,i.inflate=p,i.inflateRaw=function(_,y){return(y=y||{}).raw=!0,p(_,y)},i.ungzip=p},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var f in u)u.hasOwnProperty(f)&&(l[f]=u[f])}}return l},i.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,f,d){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+f),d);else for(var g=0;g<f;g++)l[d+g]=c[u+g]},flattenChunks:function(l){var c,u,f,d,g,p;for(c=f=0,u=l.length;c<u;c++)f+=l[c].length;for(p=new Uint8Array(f),c=d=0,u=l.length;c<u;c++)g=l[c],p.set(g,d),d+=g.length;return p}},o={arraySet:function(l,c,u,f,d){for(var g=0;g<f;g++)l[d+g]=c[u+g]},flattenChunks:function(l){return[].concat.apply([],l)}};i.setTyped=function(l){l?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,a)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,o))},i.setTyped(s)},{}],42:[function(t,r,i){var s=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new s.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(f,d){if(d<65537&&(f.subarray&&o||!f.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(f,d));for(var g="",p=0;p<d;p++)g+=String.fromCharCode(f[p]);return g}l[254]=l[254]=1,i.string2buf=function(f){var d,g,p,_,y,v=f.length,x=0;for(_=0;_<v;_++)(64512&(g=f.charCodeAt(_)))==55296&&_+1<v&&(64512&(p=f.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),_++),x+=g<128?1:g<2048?2:g<65536?3:4;for(d=new s.Buf8(x),_=y=0;y<x;_++)(64512&(g=f.charCodeAt(_)))==55296&&_+1<v&&(64512&(p=f.charCodeAt(_+1)))==56320&&(g=65536+(g-55296<<10)+(p-56320),_++),g<128?d[y++]=g:(g<2048?d[y++]=192|g>>>6:(g<65536?d[y++]=224|g>>>12:(d[y++]=240|g>>>18,d[y++]=128|g>>>12&63),d[y++]=128|g>>>6&63),d[y++]=128|63&g);return d},i.buf2binstring=function(f){return u(f,f.length)},i.binstring2buf=function(f){for(var d=new s.Buf8(f.length),g=0,p=d.length;g<p;g++)d[g]=f.charCodeAt(g);return d},i.buf2string=function(f,d){var g,p,_,y,v=d||f.length,x=new Array(2*v);for(g=p=0;g<v;)if((_=f[g++])<128)x[p++]=_;else if(4<(y=l[_]))x[p++]=65533,g+=y-1;else{for(_&=y===2?31:y===3?15:7;1<y&&g<v;)_=_<<6|63&f[g++],y--;1<y?x[p++]=65533:_<65536?x[p++]=_:(_-=65536,x[p++]=55296|_>>10&1023,x[p++]=56320|1023&_)}return u(x,p)},i.utf8border=function(f,d){var g;for((d=d||f.length)>f.length&&(d=f.length),g=d-1;0<=g&&(192&f[g])==128;)g--;return g<0||g===0?d:g+l[f[g]]>d?g:d}},{"./common":41}],43:[function(t,r,i){r.exports=function(s,a,o,l){for(var c=65535&s|0,u=s>>>16&65535|0,f=0;o!==0;){for(o-=f=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--f;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(t,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,r,i){var s=(function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o})();r.exports=function(a,o,l,c){var u=s,f=c+l;a^=-1;for(var d=c;d<f;d++)a=a>>>8^u[255&(a^o[d])];return-1^a}},{}],46:[function(t,r,i){var s,a=t("../utils/common"),o=t("./trees"),l=t("./adler32"),c=t("./crc32"),u=t("./messages"),f=0,d=4,g=0,p=-2,_=-1,y=4,v=2,x=8,E=9,M=286,O=30,N=19,I=2*M+1,D=15,V=3,G=258,Q=G+V+1,B=42,$=113,U=1,J=2,W=3,q=4;function Y(oe,Ue){return oe.msg=u[Ue],Ue}function ae(oe){return(oe<<1)-(4<oe?9:0)}function Z(oe){for(var Ue=oe.length;0<=--Ue;)oe[Ue]=0}function K(oe){var Ue=oe.state,Ge=Ue.pending;Ge>oe.avail_out&&(Ge=oe.avail_out),Ge!==0&&(a.arraySet(oe.output,Ue.pending_buf,Ue.pending_out,Ge,oe.next_out),oe.next_out+=Ge,Ue.pending_out+=Ge,oe.total_out+=Ge,oe.avail_out-=Ge,Ue.pending-=Ge,Ue.pending===0&&(Ue.pending_out=0))}function ne(oe,Ue){o._tr_flush_block(oe,0<=oe.block_start?oe.block_start:-1,oe.strstart-oe.block_start,Ue),oe.block_start=oe.strstart,K(oe.strm)}function le(oe,Ue){oe.pending_buf[oe.pending++]=Ue}function ce(oe,Ue){oe.pending_buf[oe.pending++]=Ue>>>8&255,oe.pending_buf[oe.pending++]=255&Ue}function de(oe,Ue){var Ge,ze,Be=oe.max_chain_length,me=oe.strstart,Se=oe.prev_length,Ie=oe.nice_match,be=oe.strstart>oe.w_size-Q?oe.strstart-(oe.w_size-Q):0,Ke=oe.window,ot=oe.w_mask,lt=oe.prev,ct=oe.strstart+G,Vt=Ke[me+Se-1],kt=Ke[me+Se];oe.prev_length>=oe.good_match&&(Be>>=2),Ie>oe.lookahead&&(Ie=oe.lookahead);do if(Ke[(Ge=Ue)+Se]===kt&&Ke[Ge+Se-1]===Vt&&Ke[Ge]===Ke[me]&&Ke[++Ge]===Ke[me+1]){me+=2,Ge++;do;while(Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&Ke[++me]===Ke[++Ge]&&me<ct);if(ze=G-(ct-me),me=ct-G,Se<ze){if(oe.match_start=Ue,Ie<=(Se=ze))break;Vt=Ke[me+Se-1],kt=Ke[me+Se]}}while((Ue=lt[Ue&ot])>be&&--Be!=0);return Se<=oe.lookahead?Se:oe.lookahead}function Me(oe){var Ue,Ge,ze,Be,me,Se,Ie,be,Ke,ot,lt=oe.w_size;do{if(Be=oe.window_size-oe.lookahead-oe.strstart,oe.strstart>=lt+(lt-Q)){for(a.arraySet(oe.window,oe.window,lt,lt,0),oe.match_start-=lt,oe.strstart-=lt,oe.block_start-=lt,Ue=Ge=oe.hash_size;ze=oe.head[--Ue],oe.head[Ue]=lt<=ze?ze-lt:0,--Ge;);for(Ue=Ge=lt;ze=oe.prev[--Ue],oe.prev[Ue]=lt<=ze?ze-lt:0,--Ge;);Be+=lt}if(oe.strm.avail_in===0)break;if(Se=oe.strm,Ie=oe.window,be=oe.strstart+oe.lookahead,Ke=Be,ot=void 0,ot=Se.avail_in,Ke<ot&&(ot=Ke),Ge=ot===0?0:(Se.avail_in-=ot,a.arraySet(Ie,Se.input,Se.next_in,ot,be),Se.state.wrap===1?Se.adler=l(Se.adler,Ie,ot,be):Se.state.wrap===2&&(Se.adler=c(Se.adler,Ie,ot,be)),Se.next_in+=ot,Se.total_in+=ot,ot),oe.lookahead+=Ge,oe.lookahead+oe.insert>=V)for(me=oe.strstart-oe.insert,oe.ins_h=oe.window[me],oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[me+1])&oe.hash_mask;oe.insert&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[me+V-1])&oe.hash_mask,oe.prev[me&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=me,me++,oe.insert--,!(oe.lookahead+oe.insert<V)););}while(oe.lookahead<Q&&oe.strm.avail_in!==0)}function qe(oe,Ue){for(var Ge,ze;;){if(oe.lookahead<Q){if(Me(oe),oe.lookahead<Q&&Ue===f)return U;if(oe.lookahead===0)break}if(Ge=0,oe.lookahead>=V&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),Ge!==0&&oe.strstart-Ge<=oe.w_size-Q&&(oe.match_length=de(oe,Ge)),oe.match_length>=V)if(ze=o._tr_tally(oe,oe.strstart-oe.match_start,oe.match_length-V),oe.lookahead-=oe.match_length,oe.match_length<=oe.max_lazy_match&&oe.lookahead>=V){for(oe.match_length--;oe.strstart++,oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart,--oe.match_length!=0;);oe.strstart++}else oe.strstart+=oe.match_length,oe.match_length=0,oe.ins_h=oe.window[oe.strstart],oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+1])&oe.hash_mask;else ze=o._tr_tally(oe,0,oe.window[oe.strstart]),oe.lookahead--,oe.strstart++;if(ze&&(ne(oe,!1),oe.strm.avail_out===0))return U}return oe.insert=oe.strstart<V-1?oe.strstart:V-1,Ue===d?(ne(oe,!0),oe.strm.avail_out===0?W:q):oe.last_lit&&(ne(oe,!1),oe.strm.avail_out===0)?U:J}function Pe(oe,Ue){for(var Ge,ze,Be;;){if(oe.lookahead<Q){if(Me(oe),oe.lookahead<Q&&Ue===f)return U;if(oe.lookahead===0)break}if(Ge=0,oe.lookahead>=V&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),oe.prev_length=oe.match_length,oe.prev_match=oe.match_start,oe.match_length=V-1,Ge!==0&&oe.prev_length<oe.max_lazy_match&&oe.strstart-Ge<=oe.w_size-Q&&(oe.match_length=de(oe,Ge),oe.match_length<=5&&(oe.strategy===1||oe.match_length===V&&4096<oe.strstart-oe.match_start)&&(oe.match_length=V-1)),oe.prev_length>=V&&oe.match_length<=oe.prev_length){for(Be=oe.strstart+oe.lookahead-V,ze=o._tr_tally(oe,oe.strstart-1-oe.prev_match,oe.prev_length-V),oe.lookahead-=oe.prev_length-1,oe.prev_length-=2;++oe.strstart<=Be&&(oe.ins_h=(oe.ins_h<<oe.hash_shift^oe.window[oe.strstart+V-1])&oe.hash_mask,Ge=oe.prev[oe.strstart&oe.w_mask]=oe.head[oe.ins_h],oe.head[oe.ins_h]=oe.strstart),--oe.prev_length!=0;);if(oe.match_available=0,oe.match_length=V-1,oe.strstart++,ze&&(ne(oe,!1),oe.strm.avail_out===0))return U}else if(oe.match_available){if((ze=o._tr_tally(oe,0,oe.window[oe.strstart-1]))&&ne(oe,!1),oe.strstart++,oe.lookahead--,oe.strm.avail_out===0)return U}else oe.match_available=1,oe.strstart++,oe.lookahead--}return oe.match_available&&(ze=o._tr_tally(oe,0,oe.window[oe.strstart-1]),oe.match_available=0),oe.insert=oe.strstart<V-1?oe.strstart:V-1,Ue===d?(ne(oe,!0),oe.strm.avail_out===0?W:q):oe.last_lit&&(ne(oe,!1),oe.strm.avail_out===0)?U:J}function Ce(oe,Ue,Ge,ze,Be){this.good_length=oe,this.max_lazy=Ue,this.nice_length=Ge,this.max_chain=ze,this.func=Be}function Xe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=x,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*I),this.dyn_dtree=new a.Buf16(2*(2*O+1)),this.bl_tree=new a.Buf16(2*(2*N+1)),Z(this.dyn_ltree),Z(this.dyn_dtree),Z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(D+1),this.heap=new a.Buf16(2*M+1),Z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*M+1),Z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function $e(oe){var Ue;return oe&&oe.state?(oe.total_in=oe.total_out=0,oe.data_type=v,(Ue=oe.state).pending=0,Ue.pending_out=0,Ue.wrap<0&&(Ue.wrap=-Ue.wrap),Ue.status=Ue.wrap?B:$,oe.adler=Ue.wrap===2?0:1,Ue.last_flush=f,o._tr_init(Ue),g):Y(oe,p)}function at(oe){var Ue=$e(oe);return Ue===g&&(function(Ge){Ge.window_size=2*Ge.w_size,Z(Ge.head),Ge.max_lazy_match=s[Ge.level].max_lazy,Ge.good_match=s[Ge.level].good_length,Ge.nice_match=s[Ge.level].nice_length,Ge.max_chain_length=s[Ge.level].max_chain,Ge.strstart=0,Ge.block_start=0,Ge.lookahead=0,Ge.insert=0,Ge.match_length=Ge.prev_length=V-1,Ge.match_available=0,Ge.ins_h=0})(oe.state),Ue}function pt(oe,Ue,Ge,ze,Be,me){if(!oe)return p;var Se=1;if(Ue===_&&(Ue=6),ze<0?(Se=0,ze=-ze):15<ze&&(Se=2,ze-=16),Be<1||E<Be||Ge!==x||ze<8||15<ze||Ue<0||9<Ue||me<0||y<me)return Y(oe,p);ze===8&&(ze=9);var Ie=new Xe;return(oe.state=Ie).strm=oe,Ie.wrap=Se,Ie.gzhead=null,Ie.w_bits=ze,Ie.w_size=1<<Ie.w_bits,Ie.w_mask=Ie.w_size-1,Ie.hash_bits=Be+7,Ie.hash_size=1<<Ie.hash_bits,Ie.hash_mask=Ie.hash_size-1,Ie.hash_shift=~~((Ie.hash_bits+V-1)/V),Ie.window=new a.Buf8(2*Ie.w_size),Ie.head=new a.Buf16(Ie.hash_size),Ie.prev=new a.Buf16(Ie.w_size),Ie.lit_bufsize=1<<Be+6,Ie.pending_buf_size=4*Ie.lit_bufsize,Ie.pending_buf=new a.Buf8(Ie.pending_buf_size),Ie.d_buf=1*Ie.lit_bufsize,Ie.l_buf=3*Ie.lit_bufsize,Ie.level=Ue,Ie.strategy=me,Ie.method=Ge,at(oe)}s=[new Ce(0,0,0,0,function(oe,Ue){var Ge=65535;for(Ge>oe.pending_buf_size-5&&(Ge=oe.pending_buf_size-5);;){if(oe.lookahead<=1){if(Me(oe),oe.lookahead===0&&Ue===f)return U;if(oe.lookahead===0)break}oe.strstart+=oe.lookahead,oe.lookahead=0;var ze=oe.block_start+Ge;if((oe.strstart===0||oe.strstart>=ze)&&(oe.lookahead=oe.strstart-ze,oe.strstart=ze,ne(oe,!1),oe.strm.avail_out===0)||oe.strstart-oe.block_start>=oe.w_size-Q&&(ne(oe,!1),oe.strm.avail_out===0))return U}return oe.insert=0,Ue===d?(ne(oe,!0),oe.strm.avail_out===0?W:q):(oe.strstart>oe.block_start&&(ne(oe,!1),oe.strm.avail_out),U)}),new Ce(4,4,8,4,qe),new Ce(4,5,16,8,qe),new Ce(4,6,32,32,qe),new Ce(4,4,16,16,Pe),new Ce(8,16,32,32,Pe),new Ce(8,16,128,128,Pe),new Ce(8,32,128,256,Pe),new Ce(32,128,258,1024,Pe),new Ce(32,258,258,4096,Pe)],i.deflateInit=function(oe,Ue){return pt(oe,Ue,x,15,8,0)},i.deflateInit2=pt,i.deflateReset=at,i.deflateResetKeep=$e,i.deflateSetHeader=function(oe,Ue){return oe&&oe.state?oe.state.wrap!==2?p:(oe.state.gzhead=Ue,g):p},i.deflate=function(oe,Ue){var Ge,ze,Be,me;if(!oe||!oe.state||5<Ue||Ue<0)return oe?Y(oe,p):p;if(ze=oe.state,!oe.output||!oe.input&&oe.avail_in!==0||ze.status===666&&Ue!==d)return Y(oe,oe.avail_out===0?-5:p);if(ze.strm=oe,Ge=ze.last_flush,ze.last_flush=Ue,ze.status===B)if(ze.wrap===2)oe.adler=0,le(ze,31),le(ze,139),le(ze,8),ze.gzhead?(le(ze,(ze.gzhead.text?1:0)+(ze.gzhead.hcrc?2:0)+(ze.gzhead.extra?4:0)+(ze.gzhead.name?8:0)+(ze.gzhead.comment?16:0)),le(ze,255&ze.gzhead.time),le(ze,ze.gzhead.time>>8&255),le(ze,ze.gzhead.time>>16&255),le(ze,ze.gzhead.time>>24&255),le(ze,ze.level===9?2:2<=ze.strategy||ze.level<2?4:0),le(ze,255&ze.gzhead.os),ze.gzhead.extra&&ze.gzhead.extra.length&&(le(ze,255&ze.gzhead.extra.length),le(ze,ze.gzhead.extra.length>>8&255)),ze.gzhead.hcrc&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending,0)),ze.gzindex=0,ze.status=69):(le(ze,0),le(ze,0),le(ze,0),le(ze,0),le(ze,0),le(ze,ze.level===9?2:2<=ze.strategy||ze.level<2?4:0),le(ze,3),ze.status=$);else{var Se=x+(ze.w_bits-8<<4)<<8;Se|=(2<=ze.strategy||ze.level<2?0:ze.level<6?1:ze.level===6?2:3)<<6,ze.strstart!==0&&(Se|=32),Se+=31-Se%31,ze.status=$,ce(ze,Se),ze.strstart!==0&&(ce(ze,oe.adler>>>16),ce(ze,65535&oe.adler)),oe.adler=1}if(ze.status===69)if(ze.gzhead.extra){for(Be=ze.pending;ze.gzindex<(65535&ze.gzhead.extra.length)&&(ze.pending!==ze.pending_buf_size||(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending!==ze.pending_buf_size));)le(ze,255&ze.gzhead.extra[ze.gzindex]),ze.gzindex++;ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),ze.gzindex===ze.gzhead.extra.length&&(ze.gzindex=0,ze.status=73)}else ze.status=73;if(ze.status===73)if(ze.gzhead.name){Be=ze.pending;do{if(ze.pending===ze.pending_buf_size&&(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending===ze.pending_buf_size)){me=1;break}me=ze.gzindex<ze.gzhead.name.length?255&ze.gzhead.name.charCodeAt(ze.gzindex++):0,le(ze,me)}while(me!==0);ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),me===0&&(ze.gzindex=0,ze.status=91)}else ze.status=91;if(ze.status===91)if(ze.gzhead.comment){Be=ze.pending;do{if(ze.pending===ze.pending_buf_size&&(ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),K(oe),Be=ze.pending,ze.pending===ze.pending_buf_size)){me=1;break}me=ze.gzindex<ze.gzhead.comment.length?255&ze.gzhead.comment.charCodeAt(ze.gzindex++):0,le(ze,me)}while(me!==0);ze.gzhead.hcrc&&ze.pending>Be&&(oe.adler=c(oe.adler,ze.pending_buf,ze.pending-Be,Be)),me===0&&(ze.status=103)}else ze.status=103;if(ze.status===103&&(ze.gzhead.hcrc?(ze.pending+2>ze.pending_buf_size&&K(oe),ze.pending+2<=ze.pending_buf_size&&(le(ze,255&oe.adler),le(ze,oe.adler>>8&255),oe.adler=0,ze.status=$)):ze.status=$),ze.pending!==0){if(K(oe),oe.avail_out===0)return ze.last_flush=-1,g}else if(oe.avail_in===0&&ae(Ue)<=ae(Ge)&&Ue!==d)return Y(oe,-5);if(ze.status===666&&oe.avail_in!==0)return Y(oe,-5);if(oe.avail_in!==0||ze.lookahead!==0||Ue!==f&&ze.status!==666){var Ie=ze.strategy===2?(function(be,Ke){for(var ot;;){if(be.lookahead===0&&(Me(be),be.lookahead===0)){if(Ke===f)return U;break}if(be.match_length=0,ot=o._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++,ot&&(ne(be,!1),be.strm.avail_out===0))return U}return be.insert=0,Ke===d?(ne(be,!0),be.strm.avail_out===0?W:q):be.last_lit&&(ne(be,!1),be.strm.avail_out===0)?U:J})(ze,Ue):ze.strategy===3?(function(be,Ke){for(var ot,lt,ct,Vt,kt=be.window;;){if(be.lookahead<=G){if(Me(be),be.lookahead<=G&&Ke===f)return U;if(be.lookahead===0)break}if(be.match_length=0,be.lookahead>=V&&0<be.strstart&&(lt=kt[ct=be.strstart-1])===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]){Vt=be.strstart+G;do;while(lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&lt===kt[++ct]&&ct<Vt);be.match_length=G-(Vt-ct),be.match_length>be.lookahead&&(be.match_length=be.lookahead)}if(be.match_length>=V?(ot=o._tr_tally(be,1,be.match_length-V),be.lookahead-=be.match_length,be.strstart+=be.match_length,be.match_length=0):(ot=o._tr_tally(be,0,be.window[be.strstart]),be.lookahead--,be.strstart++),ot&&(ne(be,!1),be.strm.avail_out===0))return U}return be.insert=0,Ke===d?(ne(be,!0),be.strm.avail_out===0?W:q):be.last_lit&&(ne(be,!1),be.strm.avail_out===0)?U:J})(ze,Ue):s[ze.level].func(ze,Ue);if(Ie!==W&&Ie!==q||(ze.status=666),Ie===U||Ie===W)return oe.avail_out===0&&(ze.last_flush=-1),g;if(Ie===J&&(Ue===1?o._tr_align(ze):Ue!==5&&(o._tr_stored_block(ze,0,0,!1),Ue===3&&(Z(ze.head),ze.lookahead===0&&(ze.strstart=0,ze.block_start=0,ze.insert=0))),K(oe),oe.avail_out===0))return ze.last_flush=-1,g}return Ue!==d?g:ze.wrap<=0?1:(ze.wrap===2?(le(ze,255&oe.adler),le(ze,oe.adler>>8&255),le(ze,oe.adler>>16&255),le(ze,oe.adler>>24&255),le(ze,255&oe.total_in),le(ze,oe.total_in>>8&255),le(ze,oe.total_in>>16&255),le(ze,oe.total_in>>24&255)):(ce(ze,oe.adler>>>16),ce(ze,65535&oe.adler)),K(oe),0<ze.wrap&&(ze.wrap=-ze.wrap),ze.pending!==0?g:1)},i.deflateEnd=function(oe){var Ue;return oe&&oe.state?(Ue=oe.state.status)!==B&&Ue!==69&&Ue!==73&&Ue!==91&&Ue!==103&&Ue!==$&&Ue!==666?Y(oe,p):(oe.state=null,Ue===$?Y(oe,-3):g):p},i.deflateSetDictionary=function(oe,Ue){var Ge,ze,Be,me,Se,Ie,be,Ke,ot=Ue.length;if(!oe||!oe.state||(me=(Ge=oe.state).wrap)===2||me===1&&Ge.status!==B||Ge.lookahead)return p;for(me===1&&(oe.adler=l(oe.adler,Ue,ot,0)),Ge.wrap=0,ot>=Ge.w_size&&(me===0&&(Z(Ge.head),Ge.strstart=0,Ge.block_start=0,Ge.insert=0),Ke=new a.Buf8(Ge.w_size),a.arraySet(Ke,Ue,ot-Ge.w_size,Ge.w_size,0),Ue=Ke,ot=Ge.w_size),Se=oe.avail_in,Ie=oe.next_in,be=oe.input,oe.avail_in=ot,oe.next_in=0,oe.input=Ue,Me(Ge);Ge.lookahead>=V;){for(ze=Ge.strstart,Be=Ge.lookahead-(V-1);Ge.ins_h=(Ge.ins_h<<Ge.hash_shift^Ge.window[ze+V-1])&Ge.hash_mask,Ge.prev[ze&Ge.w_mask]=Ge.head[Ge.ins_h],Ge.head[Ge.ins_h]=ze,ze++,--Be;);Ge.strstart=ze,Ge.lookahead=V-1,Me(Ge)}return Ge.strstart+=Ge.lookahead,Ge.block_start=Ge.strstart,Ge.insert=Ge.lookahead,Ge.lookahead=0,Ge.match_length=Ge.prev_length=V-1,Ge.match_available=0,oe.next_in=Ie,oe.input=be,oe.avail_in=Se,Ge.wrap=me,g},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,r,i){r.exports=function(s,a){var o,l,c,u,f,d,g,p,_,y,v,x,E,M,O,N,I,D,V,G,Q,B,$,U,J;o=s.state,l=s.next_in,U=s.input,c=l+(s.avail_in-5),u=s.next_out,J=s.output,f=u-(a-s.avail_out),d=u+(s.avail_out-257),g=o.dmax,p=o.wsize,_=o.whave,y=o.wnext,v=o.window,x=o.hold,E=o.bits,M=o.lencode,O=o.distcode,N=(1<<o.lenbits)-1,I=(1<<o.distbits)-1;e:do{E<15&&(x+=U[l++]<<E,E+=8,x+=U[l++]<<E,E+=8),D=M[x&N];t:for(;;){if(x>>>=V=D>>>24,E-=V,(V=D>>>16&255)===0)J[u++]=65535&D;else{if(!(16&V)){if((64&V)==0){D=M[(65535&D)+(x&(1<<V)-1)];continue t}if(32&V){o.mode=12;break e}s.msg="invalid literal/length code",o.mode=30;break e}G=65535&D,(V&=15)&&(E<V&&(x+=U[l++]<<E,E+=8),G+=x&(1<<V)-1,x>>>=V,E-=V),E<15&&(x+=U[l++]<<E,E+=8,x+=U[l++]<<E,E+=8),D=O[x&I];n:for(;;){if(x>>>=V=D>>>24,E-=V,!(16&(V=D>>>16&255))){if((64&V)==0){D=O[(65535&D)+(x&(1<<V)-1)];continue n}s.msg="invalid distance code",o.mode=30;break e}if(Q=65535&D,E<(V&=15)&&(x+=U[l++]<<E,(E+=8)<V&&(x+=U[l++]<<E,E+=8)),g<(Q+=x&(1<<V)-1)){s.msg="invalid distance too far back",o.mode=30;break e}if(x>>>=V,E-=V,(V=u-f)<Q){if(_<(V=Q-V)&&o.sane){s.msg="invalid distance too far back",o.mode=30;break e}if($=v,(B=0)===y){if(B+=p-V,V<G){for(G-=V;J[u++]=v[B++],--V;);B=u-Q,$=J}}else if(y<V){if(B+=p+y-V,(V-=y)<G){for(G-=V;J[u++]=v[B++],--V;);if(B=0,y<G){for(G-=V=y;J[u++]=v[B++],--V;);B=u-Q,$=J}}}else if(B+=y-V,V<G){for(G-=V;J[u++]=v[B++],--V;);B=u-Q,$=J}for(;2<G;)J[u++]=$[B++],J[u++]=$[B++],J[u++]=$[B++],G-=3;G&&(J[u++]=$[B++],1<G&&(J[u++]=$[B++]))}else{for(B=u-Q;J[u++]=J[B++],J[u++]=J[B++],J[u++]=J[B++],2<(G-=3););G&&(J[u++]=J[B++],1<G&&(J[u++]=J[B++]))}break}}break}}while(l<c&&u<d);l-=G=E>>3,x&=(1<<(E-=G<<3))-1,s.next_in=l,s.next_out=u,s.avail_in=l<c?c-l+5:5-(l-c),s.avail_out=u<d?d-u+257:257-(u-d),o.hold=x,o.bits=E}},{}],49:[function(t,r,i){var s=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),l=t("./inffast"),c=t("./inftrees"),u=1,f=2,d=0,g=-2,p=1,_=852,y=592;function v(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function x(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(B){var $;return B&&B.state?($=B.state,B.total_in=B.total_out=$.total=0,B.msg="",$.wrap&&(B.adler=1&$.wrap),$.mode=p,$.last=0,$.havedict=0,$.dmax=32768,$.head=null,$.hold=0,$.bits=0,$.lencode=$.lendyn=new s.Buf32(_),$.distcode=$.distdyn=new s.Buf32(y),$.sane=1,$.back=-1,d):g}function M(B){var $;return B&&B.state?(($=B.state).wsize=0,$.whave=0,$.wnext=0,E(B)):g}function O(B,$){var U,J;return B&&B.state?(J=B.state,$<0?(U=0,$=-$):(U=1+($>>4),$<48&&($&=15)),$&&($<8||15<$)?g:(J.window!==null&&J.wbits!==$&&(J.window=null),J.wrap=U,J.wbits=$,M(B))):g}function N(B,$){var U,J;return B?(J=new x,(B.state=J).window=null,(U=O(B,$))!==d&&(B.state=null),U):g}var I,D,V=!0;function G(B){if(V){var $;for(I=new s.Buf32(512),D=new s.Buf32(32),$=0;$<144;)B.lens[$++]=8;for(;$<256;)B.lens[$++]=9;for(;$<280;)B.lens[$++]=7;for(;$<288;)B.lens[$++]=8;for(c(u,B.lens,0,288,I,0,B.work,{bits:9}),$=0;$<32;)B.lens[$++]=5;c(f,B.lens,0,32,D,0,B.work,{bits:5}),V=!1}B.lencode=I,B.lenbits=9,B.distcode=D,B.distbits=5}function Q(B,$,U,J){var W,q=B.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new s.Buf8(q.wsize)),J>=q.wsize?(s.arraySet(q.window,$,U-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(J<(W=q.wsize-q.wnext)&&(W=J),s.arraySet(q.window,$,U-J,W,q.wnext),(J-=W)?(s.arraySet(q.window,$,U-J,J,0),q.wnext=J,q.whave=q.wsize):(q.wnext+=W,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=W))),0}i.inflateReset=M,i.inflateReset2=O,i.inflateResetKeep=E,i.inflateInit=function(B){return N(B,15)},i.inflateInit2=N,i.inflate=function(B,$){var U,J,W,q,Y,ae,Z,K,ne,le,ce,de,Me,qe,Pe,Ce,Xe,$e,at,pt,oe,Ue,Ge,ze,Be=0,me=new s.Buf8(4),Se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return g;(U=B.state).mode===12&&(U.mode=13),Y=B.next_out,W=B.output,Z=B.avail_out,q=B.next_in,J=B.input,ae=B.avail_in,K=U.hold,ne=U.bits,le=ae,ce=Z,Ue=d;e:for(;;)switch(U.mode){case p:if(U.wrap===0){U.mode=13;break}for(;ne<16;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(2&U.wrap&&K===35615){me[U.check=0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0),ne=K=0,U.mode=2;break}if(U.flags=0,U.head&&(U.head.done=!1),!(1&U.wrap)||(((255&K)<<8)+(K>>8))%31){B.msg="incorrect header check",U.mode=30;break}if((15&K)!=8){B.msg="unknown compression method",U.mode=30;break}if(ne-=4,oe=8+(15&(K>>>=4)),U.wbits===0)U.wbits=oe;else if(oe>U.wbits){B.msg="invalid window size",U.mode=30;break}U.dmax=1<<oe,B.adler=U.check=1,U.mode=512&K?10:12,ne=K=0;break;case 2:for(;ne<16;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(U.flags=K,(255&U.flags)!=8){B.msg="unknown compression method",U.mode=30;break}if(57344&U.flags){B.msg="unknown header flags set",U.mode=30;break}U.head&&(U.head.text=K>>8&1),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0,U.mode=3;case 3:for(;ne<32;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.head&&(U.head.time=K),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,me[2]=K>>>16&255,me[3]=K>>>24&255,U.check=o(U.check,me,4,0)),ne=K=0,U.mode=4;case 4:for(;ne<16;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.head&&(U.head.xflags=255&K,U.head.os=K>>8),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0,U.mode=5;case 5:if(1024&U.flags){for(;ne<16;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.length=K,U.head&&(U.head.extra_len=K),512&U.flags&&(me[0]=255&K,me[1]=K>>>8&255,U.check=o(U.check,me,2,0)),ne=K=0}else U.head&&(U.head.extra=null);U.mode=6;case 6:if(1024&U.flags&&(ae<(de=U.length)&&(de=ae),de&&(U.head&&(oe=U.head.extra_len-U.length,U.head.extra||(U.head.extra=new Array(U.head.extra_len)),s.arraySet(U.head.extra,J,q,de,oe)),512&U.flags&&(U.check=o(U.check,J,de,q)),ae-=de,q+=de,U.length-=de),U.length))break e;U.length=0,U.mode=7;case 7:if(2048&U.flags){if(ae===0)break e;for(de=0;oe=J[q+de++],U.head&&oe&&U.length<65536&&(U.head.name+=String.fromCharCode(oe)),oe&&de<ae;);if(512&U.flags&&(U.check=o(U.check,J,de,q)),ae-=de,q+=de,oe)break e}else U.head&&(U.head.name=null);U.length=0,U.mode=8;case 8:if(4096&U.flags){if(ae===0)break e;for(de=0;oe=J[q+de++],U.head&&oe&&U.length<65536&&(U.head.comment+=String.fromCharCode(oe)),oe&&de<ae;);if(512&U.flags&&(U.check=o(U.check,J,de,q)),ae-=de,q+=de,oe)break e}else U.head&&(U.head.comment=null);U.mode=9;case 9:if(512&U.flags){for(;ne<16;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(K!==(65535&U.check)){B.msg="header crc mismatch",U.mode=30;break}ne=K=0}U.head&&(U.head.hcrc=U.flags>>9&1,U.head.done=!0),B.adler=U.check=0,U.mode=12;break;case 10:for(;ne<32;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}B.adler=U.check=v(K),ne=K=0,U.mode=11;case 11:if(U.havedict===0)return B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,2;B.adler=U.check=1,U.mode=12;case 12:if($===5||$===6)break e;case 13:if(U.last){K>>>=7&ne,ne-=7&ne,U.mode=27;break}for(;ne<3;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}switch(U.last=1&K,ne-=1,3&(K>>>=1)){case 0:U.mode=14;break;case 1:if(G(U),U.mode=20,$!==6)break;K>>>=2,ne-=2;break e;case 2:U.mode=17;break;case 3:B.msg="invalid block type",U.mode=30}K>>>=2,ne-=2;break;case 14:for(K>>>=7&ne,ne-=7&ne;ne<32;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if((65535&K)!=(K>>>16^65535)){B.msg="invalid stored block lengths",U.mode=30;break}if(U.length=65535&K,ne=K=0,U.mode=15,$===6)break e;case 15:U.mode=16;case 16:if(de=U.length){if(ae<de&&(de=ae),Z<de&&(de=Z),de===0)break e;s.arraySet(W,J,q,de,Y),ae-=de,q+=de,Z-=de,Y+=de,U.length-=de;break}U.mode=12;break;case 17:for(;ne<14;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(U.nlen=257+(31&K),K>>>=5,ne-=5,U.ndist=1+(31&K),K>>>=5,ne-=5,U.ncode=4+(15&K),K>>>=4,ne-=4,286<U.nlen||30<U.ndist){B.msg="too many length or distance symbols",U.mode=30;break}U.have=0,U.mode=18;case 18:for(;U.have<U.ncode;){for(;ne<3;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.lens[Se[U.have++]]=7&K,K>>>=3,ne-=3}for(;U.have<19;)U.lens[Se[U.have++]]=0;if(U.lencode=U.lendyn,U.lenbits=7,Ge={bits:U.lenbits},Ue=c(0,U.lens,0,19,U.lencode,0,U.work,Ge),U.lenbits=Ge.bits,Ue){B.msg="invalid code lengths set",U.mode=30;break}U.have=0,U.mode=19;case 19:for(;U.have<U.nlen+U.ndist;){for(;Ce=(Be=U.lencode[K&(1<<U.lenbits)-1])>>>16&255,Xe=65535&Be,!((Pe=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(Xe<16)K>>>=Pe,ne-=Pe,U.lens[U.have++]=Xe;else{if(Xe===16){for(ze=Pe+2;ne<ze;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(K>>>=Pe,ne-=Pe,U.have===0){B.msg="invalid bit length repeat",U.mode=30;break}oe=U.lens[U.have-1],de=3+(3&K),K>>>=2,ne-=2}else if(Xe===17){for(ze=Pe+3;ne<ze;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}ne-=Pe,oe=0,de=3+(7&(K>>>=Pe)),K>>>=3,ne-=3}else{for(ze=Pe+7;ne<ze;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}ne-=Pe,oe=0,de=11+(127&(K>>>=Pe)),K>>>=7,ne-=7}if(U.have+de>U.nlen+U.ndist){B.msg="invalid bit length repeat",U.mode=30;break}for(;de--;)U.lens[U.have++]=oe}}if(U.mode===30)break;if(U.lens[256]===0){B.msg="invalid code -- missing end-of-block",U.mode=30;break}if(U.lenbits=9,Ge={bits:U.lenbits},Ue=c(u,U.lens,0,U.nlen,U.lencode,0,U.work,Ge),U.lenbits=Ge.bits,Ue){B.msg="invalid literal/lengths set",U.mode=30;break}if(U.distbits=6,U.distcode=U.distdyn,Ge={bits:U.distbits},Ue=c(f,U.lens,U.nlen,U.ndist,U.distcode,0,U.work,Ge),U.distbits=Ge.bits,Ue){B.msg="invalid distances set",U.mode=30;break}if(U.mode=20,$===6)break e;case 20:U.mode=21;case 21:if(6<=ae&&258<=Z){B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,l(B,ce),Y=B.next_out,W=B.output,Z=B.avail_out,q=B.next_in,J=B.input,ae=B.avail_in,K=U.hold,ne=U.bits,U.mode===12&&(U.back=-1);break}for(U.back=0;Ce=(Be=U.lencode[K&(1<<U.lenbits)-1])>>>16&255,Xe=65535&Be,!((Pe=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(Ce&&(240&Ce)==0){for($e=Pe,at=Ce,pt=Xe;Ce=(Be=U.lencode[pt+((K&(1<<$e+at)-1)>>$e)])>>>16&255,Xe=65535&Be,!($e+(Pe=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}K>>>=$e,ne-=$e,U.back+=$e}if(K>>>=Pe,ne-=Pe,U.back+=Pe,U.length=Xe,Ce===0){U.mode=26;break}if(32&Ce){U.back=-1,U.mode=12;break}if(64&Ce){B.msg="invalid literal/length code",U.mode=30;break}U.extra=15&Ce,U.mode=22;case 22:if(U.extra){for(ze=U.extra;ne<ze;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.length+=K&(1<<U.extra)-1,K>>>=U.extra,ne-=U.extra,U.back+=U.extra}U.was=U.length,U.mode=23;case 23:for(;Ce=(Be=U.distcode[K&(1<<U.distbits)-1])>>>16&255,Xe=65535&Be,!((Pe=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if((240&Ce)==0){for($e=Pe,at=Ce,pt=Xe;Ce=(Be=U.distcode[pt+((K&(1<<$e+at)-1)>>$e)])>>>16&255,Xe=65535&Be,!($e+(Pe=Be>>>24)<=ne);){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}K>>>=$e,ne-=$e,U.back+=$e}if(K>>>=Pe,ne-=Pe,U.back+=Pe,64&Ce){B.msg="invalid distance code",U.mode=30;break}U.offset=Xe,U.extra=15&Ce,U.mode=24;case 24:if(U.extra){for(ze=U.extra;ne<ze;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}U.offset+=K&(1<<U.extra)-1,K>>>=U.extra,ne-=U.extra,U.back+=U.extra}if(U.offset>U.dmax){B.msg="invalid distance too far back",U.mode=30;break}U.mode=25;case 25:if(Z===0)break e;if(de=ce-Z,U.offset>de){if((de=U.offset-de)>U.whave&&U.sane){B.msg="invalid distance too far back",U.mode=30;break}Me=de>U.wnext?(de-=U.wnext,U.wsize-de):U.wnext-de,de>U.length&&(de=U.length),qe=U.window}else qe=W,Me=Y-U.offset,de=U.length;for(Z<de&&(de=Z),Z-=de,U.length-=de;W[Y++]=qe[Me++],--de;);U.length===0&&(U.mode=21);break;case 26:if(Z===0)break e;W[Y++]=U.length,Z--,U.mode=21;break;case 27:if(U.wrap){for(;ne<32;){if(ae===0)break e;ae--,K|=J[q++]<<ne,ne+=8}if(ce-=Z,B.total_out+=ce,U.total+=ce,ce&&(B.adler=U.check=U.flags?o(U.check,W,ce,Y-ce):a(U.check,W,ce,Y-ce)),ce=Z,(U.flags?K:v(K))!==U.check){B.msg="incorrect data check",U.mode=30;break}ne=K=0}U.mode=28;case 28:if(U.wrap&&U.flags){for(;ne<32;){if(ae===0)break e;ae--,K+=J[q++]<<ne,ne+=8}if(K!==(4294967295&U.total)){B.msg="incorrect length check",U.mode=30;break}ne=K=0}U.mode=29;case 29:Ue=1;break e;case 30:Ue=-3;break e;case 31:return-4;case 32:default:return g}return B.next_out=Y,B.avail_out=Z,B.next_in=q,B.avail_in=ae,U.hold=K,U.bits=ne,(U.wsize||ce!==B.avail_out&&U.mode<30&&(U.mode<27||$!==4))&&Q(B,B.output,B.next_out,ce-B.avail_out)?(U.mode=31,-4):(le-=B.avail_in,ce-=B.avail_out,B.total_in+=le,B.total_out+=ce,U.total+=ce,U.wrap&&ce&&(B.adler=U.check=U.flags?o(U.check,W,ce,B.next_out-ce):a(U.check,W,ce,B.next_out-ce)),B.data_type=U.bits+(U.last?64:0)+(U.mode===12?128:0)+(U.mode===20||U.mode===15?256:0),(le==0&&ce===0||$===4)&&Ue===d&&(Ue=-5),Ue)},i.inflateEnd=function(B){if(!B||!B.state)return g;var $=B.state;return $.window&&($.window=null),B.state=null,d},i.inflateGetHeader=function(B,$){var U;return B&&B.state?(2&(U=B.state).wrap)==0?g:((U.head=$).done=!1,d):g},i.inflateSetDictionary=function(B,$){var U,J=$.length;return B&&B.state?(U=B.state).wrap!==0&&U.mode!==11?g:U.mode===11&&a(1,$,J,0)!==U.check?-3:Q(B,$,J,J)?(U.mode=31,-4):(U.havedict=1,d):g},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,r,i){var s=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,f,d,g,p,_,y,v){var x,E,M,O,N,I,D,V,G,Q=v.bits,B=0,$=0,U=0,J=0,W=0,q=0,Y=0,ae=0,Z=0,K=0,ne=null,le=0,ce=new s.Buf16(16),de=new s.Buf16(16),Me=null,qe=0;for(B=0;B<=15;B++)ce[B]=0;for($=0;$<g;$++)ce[f[d+$]]++;for(W=Q,J=15;1<=J&&ce[J]===0;J--);if(J<W&&(W=J),J===0)return p[_++]=20971520,p[_++]=20971520,v.bits=1,0;for(U=1;U<J&&ce[U]===0;U++);for(W<U&&(W=U),B=ae=1;B<=15;B++)if(ae<<=1,(ae-=ce[B])<0)return-1;if(0<ae&&(u===0||J!==1))return-1;for(de[1]=0,B=1;B<15;B++)de[B+1]=de[B]+ce[B];for($=0;$<g;$++)f[d+$]!==0&&(y[de[f[d+$]]++]=$);if(I=u===0?(ne=Me=y,19):u===1?(ne=a,le-=257,Me=o,qe-=257,256):(ne=l,Me=c,-1),B=U,N=_,Y=$=K=0,M=-1,O=(Z=1<<(q=W))-1,u===1&&852<Z||u===2&&592<Z)return 1;for(;;){for(D=B-Y,G=y[$]<I?(V=0,y[$]):y[$]>I?(V=Me[qe+y[$]],ne[le+y[$]]):(V=96,0),x=1<<B-Y,U=E=1<<q;p[N+(K>>Y)+(E-=x)]=D<<24|V<<16|G|0,E!==0;);for(x=1<<B-1;K&x;)x>>=1;if(x!==0?(K&=x-1,K+=x):K=0,$++,--ce[B]==0){if(B===J)break;B=f[d+y[$]]}if(W<B&&(K&O)!==M){for(Y===0&&(Y=W),N+=U,ae=1<<(q=B-Y);q+Y<J&&!((ae-=ce[q+Y])<=0);)q++,ae<<=1;if(Z+=1<<q,u===1&&852<Z||u===2&&592<Z)return 1;p[M=K&O]=W<<24|q<<16|N-_|0}}return K!==0&&(p[N+K]=B-Y<<24|64<<16|0),v.bits=W,0}},{"../utils/common":41}],51:[function(t,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,r,i){var s=t("../utils/common"),a=0,o=1;function l(Be){for(var me=Be.length;0<=--me;)Be[me]=0}var c=0,u=29,f=256,d=f+1+u,g=30,p=19,_=2*d+1,y=15,v=16,x=7,E=256,M=16,O=17,N=18,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],D=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],V=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=new Array(2*(d+2));l(Q);var B=new Array(2*g);l(B);var $=new Array(512);l($);var U=new Array(256);l(U);var J=new Array(u);l(J);var W,q,Y,ae=new Array(g);function Z(Be,me,Se,Ie,be){this.static_tree=Be,this.extra_bits=me,this.extra_base=Se,this.elems=Ie,this.max_length=be,this.has_stree=Be&&Be.length}function K(Be,me){this.dyn_tree=Be,this.max_code=0,this.stat_desc=me}function ne(Be){return Be<256?$[Be]:$[256+(Be>>>7)]}function le(Be,me){Be.pending_buf[Be.pending++]=255&me,Be.pending_buf[Be.pending++]=me>>>8&255}function ce(Be,me,Se){Be.bi_valid>v-Se?(Be.bi_buf|=me<<Be.bi_valid&65535,le(Be,Be.bi_buf),Be.bi_buf=me>>v-Be.bi_valid,Be.bi_valid+=Se-v):(Be.bi_buf|=me<<Be.bi_valid&65535,Be.bi_valid+=Se)}function de(Be,me,Se){ce(Be,Se[2*me],Se[2*me+1])}function Me(Be,me){for(var Se=0;Se|=1&Be,Be>>>=1,Se<<=1,0<--me;);return Se>>>1}function qe(Be,me,Se){var Ie,be,Ke=new Array(y+1),ot=0;for(Ie=1;Ie<=y;Ie++)Ke[Ie]=ot=ot+Se[Ie-1]<<1;for(be=0;be<=me;be++){var lt=Be[2*be+1];lt!==0&&(Be[2*be]=Me(Ke[lt]++,lt))}}function Pe(Be){var me;for(me=0;me<d;me++)Be.dyn_ltree[2*me]=0;for(me=0;me<g;me++)Be.dyn_dtree[2*me]=0;for(me=0;me<p;me++)Be.bl_tree[2*me]=0;Be.dyn_ltree[2*E]=1,Be.opt_len=Be.static_len=0,Be.last_lit=Be.matches=0}function Ce(Be){8<Be.bi_valid?le(Be,Be.bi_buf):0<Be.bi_valid&&(Be.pending_buf[Be.pending++]=Be.bi_buf),Be.bi_buf=0,Be.bi_valid=0}function Xe(Be,me,Se,Ie){var be=2*me,Ke=2*Se;return Be[be]<Be[Ke]||Be[be]===Be[Ke]&&Ie[me]<=Ie[Se]}function $e(Be,me,Se){for(var Ie=Be.heap[Se],be=Se<<1;be<=Be.heap_len&&(be<Be.heap_len&&Xe(me,Be.heap[be+1],Be.heap[be],Be.depth)&&be++,!Xe(me,Ie,Be.heap[be],Be.depth));)Be.heap[Se]=Be.heap[be],Se=be,be<<=1;Be.heap[Se]=Ie}function at(Be,me,Se){var Ie,be,Ke,ot,lt=0;if(Be.last_lit!==0)for(;Ie=Be.pending_buf[Be.d_buf+2*lt]<<8|Be.pending_buf[Be.d_buf+2*lt+1],be=Be.pending_buf[Be.l_buf+lt],lt++,Ie===0?de(Be,be,me):(de(Be,(Ke=U[be])+f+1,me),(ot=I[Ke])!==0&&ce(Be,be-=J[Ke],ot),de(Be,Ke=ne(--Ie),Se),(ot=D[Ke])!==0&&ce(Be,Ie-=ae[Ke],ot)),lt<Be.last_lit;);de(Be,E,me)}function pt(Be,me){var Se,Ie,be,Ke=me.dyn_tree,ot=me.stat_desc.static_tree,lt=me.stat_desc.has_stree,ct=me.stat_desc.elems,Vt=-1;for(Be.heap_len=0,Be.heap_max=_,Se=0;Se<ct;Se++)Ke[2*Se]!==0?(Be.heap[++Be.heap_len]=Vt=Se,Be.depth[Se]=0):Ke[2*Se+1]=0;for(;Be.heap_len<2;)Ke[2*(be=Be.heap[++Be.heap_len]=Vt<2?++Vt:0)]=1,Be.depth[be]=0,Be.opt_len--,lt&&(Be.static_len-=ot[2*be+1]);for(me.max_code=Vt,Se=Be.heap_len>>1;1<=Se;Se--)$e(Be,Ke,Se);for(be=ct;Se=Be.heap[1],Be.heap[1]=Be.heap[Be.heap_len--],$e(Be,Ke,1),Ie=Be.heap[1],Be.heap[--Be.heap_max]=Se,Be.heap[--Be.heap_max]=Ie,Ke[2*be]=Ke[2*Se]+Ke[2*Ie],Be.depth[be]=(Be.depth[Se]>=Be.depth[Ie]?Be.depth[Se]:Be.depth[Ie])+1,Ke[2*Se+1]=Ke[2*Ie+1]=be,Be.heap[1]=be++,$e(Be,Ke,1),2<=Be.heap_len;);Be.heap[--Be.heap_max]=Be.heap[1],(function(kt,Ut){var je,ge,se,_e,Ne,Le,ke=Ut.dyn_tree,Re=Ut.max_code,st=Ut.stat_desc.static_tree,Ve=Ut.stat_desc.has_stree,tt=Ut.stat_desc.extra_bits,Ze=Ut.stat_desc.extra_base,nt=Ut.stat_desc.max_length,vt=0;for(_e=0;_e<=y;_e++)kt.bl_count[_e]=0;for(ke[2*kt.heap[kt.heap_max]+1]=0,je=kt.heap_max+1;je<_;je++)nt<(_e=ke[2*ke[2*(ge=kt.heap[je])+1]+1]+1)&&(_e=nt,vt++),ke[2*ge+1]=_e,Re<ge||(kt.bl_count[_e]++,Ne=0,Ze<=ge&&(Ne=tt[ge-Ze]),Le=ke[2*ge],kt.opt_len+=Le*(_e+Ne),Ve&&(kt.static_len+=Le*(st[2*ge+1]+Ne)));if(vt!==0){do{for(_e=nt-1;kt.bl_count[_e]===0;)_e--;kt.bl_count[_e]--,kt.bl_count[_e+1]+=2,kt.bl_count[nt]--,vt-=2}while(0<vt);for(_e=nt;_e!==0;_e--)for(ge=kt.bl_count[_e];ge!==0;)Re<(se=kt.heap[--je])||(ke[2*se+1]!==_e&&(kt.opt_len+=(_e-ke[2*se+1])*ke[2*se],ke[2*se+1]=_e),ge--)}})(Be,me),qe(Ke,Vt,Be.bl_count)}function oe(Be,me,Se){var Ie,be,Ke=-1,ot=me[1],lt=0,ct=7,Vt=4;for(ot===0&&(ct=138,Vt=3),me[2*(Se+1)+1]=65535,Ie=0;Ie<=Se;Ie++)be=ot,ot=me[2*(Ie+1)+1],++lt<ct&&be===ot||(lt<Vt?Be.bl_tree[2*be]+=lt:be!==0?(be!==Ke&&Be.bl_tree[2*be]++,Be.bl_tree[2*M]++):lt<=10?Be.bl_tree[2*O]++:Be.bl_tree[2*N]++,Ke=be,Vt=(lt=0)===ot?(ct=138,3):be===ot?(ct=6,3):(ct=7,4))}function Ue(Be,me,Se){var Ie,be,Ke=-1,ot=me[1],lt=0,ct=7,Vt=4;for(ot===0&&(ct=138,Vt=3),Ie=0;Ie<=Se;Ie++)if(be=ot,ot=me[2*(Ie+1)+1],!(++lt<ct&&be===ot)){if(lt<Vt)for(;de(Be,be,Be.bl_tree),--lt!=0;);else be!==0?(be!==Ke&&(de(Be,be,Be.bl_tree),lt--),de(Be,M,Be.bl_tree),ce(Be,lt-3,2)):lt<=10?(de(Be,O,Be.bl_tree),ce(Be,lt-3,3)):(de(Be,N,Be.bl_tree),ce(Be,lt-11,7));Ke=be,Vt=(lt=0)===ot?(ct=138,3):be===ot?(ct=6,3):(ct=7,4)}}l(ae);var Ge=!1;function ze(Be,me,Se,Ie){ce(Be,(c<<1)+(Ie?1:0),3),(function(be,Ke,ot,lt){Ce(be),le(be,ot),le(be,~ot),s.arraySet(be.pending_buf,be.window,Ke,ot,be.pending),be.pending+=ot})(Be,me,Se)}i._tr_init=function(Be){Ge||((function(){var me,Se,Ie,be,Ke,ot=new Array(y+1);for(be=Ie=0;be<u-1;be++)for(J[be]=Ie,me=0;me<1<<I[be];me++)U[Ie++]=be;for(U[Ie-1]=be,be=Ke=0;be<16;be++)for(ae[be]=Ke,me=0;me<1<<D[be];me++)$[Ke++]=be;for(Ke>>=7;be<g;be++)for(ae[be]=Ke<<7,me=0;me<1<<D[be]-7;me++)$[256+Ke++]=be;for(Se=0;Se<=y;Se++)ot[Se]=0;for(me=0;me<=143;)Q[2*me+1]=8,me++,ot[8]++;for(;me<=255;)Q[2*me+1]=9,me++,ot[9]++;for(;me<=279;)Q[2*me+1]=7,me++,ot[7]++;for(;me<=287;)Q[2*me+1]=8,me++,ot[8]++;for(qe(Q,d+1,ot),me=0;me<g;me++)B[2*me+1]=5,B[2*me]=Me(me,5);W=new Z(Q,I,f+1,d,y),q=new Z(B,D,0,g,y),Y=new Z(new Array(0),V,0,p,x)})(),Ge=!0),Be.l_desc=new K(Be.dyn_ltree,W),Be.d_desc=new K(Be.dyn_dtree,q),Be.bl_desc=new K(Be.bl_tree,Y),Be.bi_buf=0,Be.bi_valid=0,Pe(Be)},i._tr_stored_block=ze,i._tr_flush_block=function(Be,me,Se,Ie){var be,Ke,ot=0;0<Be.level?(Be.strm.data_type===2&&(Be.strm.data_type=(function(lt){var ct,Vt=4093624447;for(ct=0;ct<=31;ct++,Vt>>>=1)if(1&Vt&&lt.dyn_ltree[2*ct]!==0)return a;if(lt.dyn_ltree[18]!==0||lt.dyn_ltree[20]!==0||lt.dyn_ltree[26]!==0)return o;for(ct=32;ct<f;ct++)if(lt.dyn_ltree[2*ct]!==0)return o;return a})(Be)),pt(Be,Be.l_desc),pt(Be,Be.d_desc),ot=(function(lt){var ct;for(oe(lt,lt.dyn_ltree,lt.l_desc.max_code),oe(lt,lt.dyn_dtree,lt.d_desc.max_code),pt(lt,lt.bl_desc),ct=p-1;3<=ct&&lt.bl_tree[2*G[ct]+1]===0;ct--);return lt.opt_len+=3*(ct+1)+5+5+4,ct})(Be),be=Be.opt_len+3+7>>>3,(Ke=Be.static_len+3+7>>>3)<=be&&(be=Ke)):be=Ke=Se+5,Se+4<=be&&me!==-1?ze(Be,me,Se,Ie):Be.strategy===4||Ke===be?(ce(Be,2+(Ie?1:0),3),at(Be,Q,B)):(ce(Be,4+(Ie?1:0),3),(function(lt,ct,Vt,kt){var Ut;for(ce(lt,ct-257,5),ce(lt,Vt-1,5),ce(lt,kt-4,4),Ut=0;Ut<kt;Ut++)ce(lt,lt.bl_tree[2*G[Ut]+1],3);Ue(lt,lt.dyn_ltree,ct-1),Ue(lt,lt.dyn_dtree,Vt-1)})(Be,Be.l_desc.max_code+1,Be.d_desc.max_code+1,ot+1),at(Be,Be.dyn_ltree,Be.dyn_dtree)),Pe(Be),Ie&&Ce(Be)},i._tr_tally=function(Be,me,Se){return Be.pending_buf[Be.d_buf+2*Be.last_lit]=me>>>8&255,Be.pending_buf[Be.d_buf+2*Be.last_lit+1]=255&me,Be.pending_buf[Be.l_buf+Be.last_lit]=255&Se,Be.last_lit++,me===0?Be.dyn_ltree[2*Se]++:(Be.matches++,me--,Be.dyn_ltree[2*(U[Se]+f+1)]++,Be.dyn_dtree[2*ne(me)]++),Be.last_lit===Be.lit_bufsize-1},i._tr_align=function(Be){ce(Be,2,3),de(Be,E,Q),(function(me){me.bi_valid===16?(le(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)})(Be)}},{"../utils/common":41}],53:[function(t,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,r,i){(function(s){(function(a,o){if(!a.setImmediate){var l,c,u,f,d=1,g={},p=!1,_=a.document,y=Object.getPrototypeOf&&Object.getPrototypeOf(a);y=y&&y.setTimeout?y:a,l={}.toString.call(a.process)==="[object process]"?function(M){xl.nextTick(function(){x(M)})}:(function(){if(a.postMessage&&!a.importScripts){var M=!0,O=a.onmessage;return a.onmessage=function(){M=!1},a.postMessage("","*"),a.onmessage=O,M}})()?(f="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",E,!1):a.attachEvent("onmessage",E),function(M){a.postMessage(f+M,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(M){x(M.data)},function(M){u.port2.postMessage(M)}):_&&"onreadystatechange"in _.createElement("script")?(c=_.documentElement,function(M){var O=_.createElement("script");O.onreadystatechange=function(){x(M),O.onreadystatechange=null,c.removeChild(O),O=null},c.appendChild(O)}):function(M){setTimeout(x,0,M)},y.setImmediate=function(M){typeof M!="function"&&(M=new Function(""+M));for(var O=new Array(arguments.length-1),N=0;N<O.length;N++)O[N]=arguments[N+1];var I={callback:M,args:O};return g[d]=I,l(d),d++},y.clearImmediate=v}function v(M){delete g[M]}function x(M){if(p)setTimeout(x,0,M);else{var O=g[M];if(O){p=!0;try{(function(N){var I=N.callback,D=N.args;switch(D.length){case 0:I();break;case 1:I(D[0]);break;case 2:I(D[0],D[1]);break;case 3:I(D[0],D[1],D[2]);break;default:I.apply(o,D)}})(O)}finally{v(M),p=!1}}}}function E(M){M.source===a&&typeof M.data=="string"&&M.data.indexOf(f)===0&&x(+M.data.slice(f.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof C0<"u"?C0:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(J6)),J6.exports}var d3e=h3e();const p3e=Bh(d3e);async function m3e(n,e){const t=new p3e;t.file("index.html",`<!doctype html>
      <html lang=en>
      <head>
      <meta charset=utf-8>
      <title>...adding bytes</title>
      </head>
      <body>
      <script>location = 'https://zed.cafe/#${e}';<\/script>
      </body>
    </html>`);const r=await t.generateAsync({type:"blob"});r3e.saveAs(r,`${n}.zip`)}function Ds(n,e,t){return n.namespaceURI&&n.namespaceURI!=="http://www.w3.org/1999/xhtml"||(e=Array.isArray(e)?e:[e],!e.includes(n.tagName.toLowerCase()))?!1:t?Object.entries(t).every(([r,i])=>n[r]===i):!0}function G0(n){var e;if(g3e(n)&&n.defaultView)return n.defaultView;if(!((e=n.ownerDocument)===null||e===void 0)&&e.defaultView)return n.ownerDocument.defaultView;throw new Error(`Could not determine window of node. Node was ${_3e(n)}`)}function g3e(n){return n.nodeType===9}function _3e(n){return typeof n=="function"?`function ${n.name}`:n===null?"null":String(n)}function yle(n,e){return new Promise((t,r)=>{const i=new e;i.onerror=r,i.onabort=r,i.onload=()=>{t(String(i.result))},i.readAsText(n)})}function fj(n,e){const t={...e,length:e.length,item:r=>t[r],[Symbol.iterator]:function*(){for(let i=0;i<t.length;i++)yield t[i]}};return t.constructor=n.FileList,n.FileList&&Object.setPrototypeOf(t,n.FileList.prototype),Object.freeze(t),t}function u1(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class ble{getAsFile(){return this.file}getAsString(e){typeof this.data=="string"&&e(this.data)}webkitGetAsEntry(){throw new Error("not implemented")}constructor(e,t){u1(this,"kind",void 0),u1(this,"type",void 0),u1(this,"file",null),u1(this,"data",void 0),typeof e=="string"?(this.kind="string",this.type=String(t),this.data=e):(this.kind="file",this.type=e.type,this.file=e)}}class v3e extends Array{add(...e){const t=new ble(e[0],e[1]);return this.push(t),t}clear(){this.splice(0,this.length)}remove(e){this.splice(e,1)}}function wI(n,e){const[t,r]=n.split("/"),i=!r||r==="*";return s=>e?s.type===(i?t:n):i?s.type.startsWith(`${t}/`):s.type===t}function y3e(n){return new class{getData(t){var r;const i=(r=this.items.find(wI(t,!0)))!==null&&r!==void 0?r:this.items.find(wI(t,!1));let s="";return i?.getAsString(a=>{s=a}),s}setData(t,r){const i=this.items.findIndex(wI(t,!0)),s=new ble(r,t);i>=0?this.items.splice(i,1,s):this.items.push(s)}clearData(t){if(t){const r=this.items.findIndex(wI(t,!0));r>=0&&this.items.remove(r)}else this.items.clear()}get types(){const t=[];return this.files.length&&t.push("Files"),this.items.forEach(r=>t.push(r.type)),Object.freeze(t),t}setDragImage(){}constructor(){u1(this,"dropEffect","none"),u1(this,"effectAllowed","uninitialized"),u1(this,"items",new v3e),u1(this,"files",fj(n,[]))}}}function hj(n,e=[]){const t=typeof n.DataTransfer>"u"?y3e(n):new n.DataTransfer;return Object.defineProperty(t,"files",{get:()=>fj(n,e)}),t}async function b3e(n,e){return e.kind==="file"?e.getAsFile():new n.Blob([await new Promise(t=>e.getAsString(t))],{type:e.type})}function Sle(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ele(n,...e){const t=Object.fromEntries(e.map(r=>[typeof r=="string"?"text/plain":r.type,Promise.resolve(r)]));return typeof n.ClipboardItem<"u"?new n.ClipboardItem(t):new class{get types(){return Array.from(Object.keys(this.data))}async getType(i){const s=await this.data[i];if(!s)throw new Error(`${i} is not one of the available MIME types on this item.`);return s instanceof n.Blob?s:new n.Blob([s],{type:i})}constructor(i){Sle(this,"data",void 0),this.data=i}}(t)}const YT=Symbol("Manage ClipboardSub");function RY(n,e){return Object.assign(new class extends n.EventTarget{async read(){return Array.from(this.items)}async readText(){let r="";for(const i of this.items){const s=i.types.includes("text/plain")?"text/plain":i.types.find(a=>a.startsWith("text/"));s&&(r+=await i.getType(s).then(a=>yle(a,n.FileReader)))}return r}async write(r){this.items=r}async writeText(r){this.items=[Ele(n,r)]}constructor(...r){super(...r),Sle(this,"items",[])}},{[YT]:e})}function dj(n){return!!n?.[YT]}function S3e(n){if(dj(n.navigator.clipboard))return n.navigator.clipboard[YT];const e=Object.getOwnPropertyDescriptor(n.navigator,"clipboard");let t;const r={resetClipboardStub:()=>{t=RY(n,r)},detachClipboardStub:()=>{e?Object.defineProperty(n.navigator,"clipboard",e):Object.defineProperty(n.navigator,"clipboard",{value:void 0,configurable:!0})}};return t=RY(n,r),Object.defineProperty(n.navigator,"clipboard",{get:()=>t,configurable:!0}),t[YT]}function E3e(n){dj(n.navigator.clipboard)&&n.navigator.clipboard[YT].resetClipboardStub()}function x3e(n){dj(n.navigator.clipboard)&&n.navigator.clipboard[YT].detachClipboardStub()}async function T3e(n){const e=n.defaultView,t=e?.navigator.clipboard,r=t&&await t.read();if(!r)throw new Error("The Clipboard API is unavailable.");const i=hj(e);for(const s of r)for(const a of s.types)i.setData(a,await s.getType(a).then(o=>yle(o,e.FileReader)));return i}async function xle(n,e){const t=G0(n),r=t.navigator.clipboard,i=[];for(let a=0;a<e.items.length;a++){const o=e.items[a],l=await b3e(t,o);i.push(Ele(t,l))}if(!(r&&await r.write(i).then(()=>!0,()=>!1)))throw new Error("The Clipboard API is unavailable.")}const _D=globalThis;typeof _D.afterEach=="function"&&_D.afterEach(()=>E3e(globalThis.window));typeof _D.afterAll=="function"&&_D.afterAll(()=>x3e(globalThis.window));const Tle=["input:not([type=hidden]):not([disabled])","button:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[contenteditable=""]','[contenteditable="true"]',"a[href]","[tabindex]:not([disabled])"].join(", ");function pj(n){return n.matches(Tle)}function w3e(n){return new n.constructor(n.type,n)}function ab(n){for(let t=n;t;t=t.parentElement)if(Ds(t,["button","input","select","textarea","optgroup","option"])){if(t.hasAttribute("disabled"))return!0}else if(Ds(t,"fieldset")){var e;if(t.hasAttribute("disabled")&&!(!((e=t.querySelector(":scope > legend"))===null||e===void 0)&&e.contains(n)))return!0}else if(t.tagName.includes("-")&&t.constructor.formAssociated&&t.hasAttribute("disabled"))return!0;return!1}function oO(n){const e=n.activeElement;return e?.shadowRoot?oO(e.shadowRoot):ab(e)?n.ownerDocument?n.ownerDocument.body:n.body:e}function eB(n){var e;return(e=oO(n))!==null&&e!==void 0?e:n.body}function R3e(n,e){let t=n;do{if(e(t))return t;t=t.parentElement}while(t&&t!==n.ownerDocument.body)}function xE(n){return n.hasAttribute("contenteditable")&&(n.getAttribute("contenteditable")=="true"||n.getAttribute("contenteditable")=="")}function Z2(n){const e=A3e(n);return e&&(e.closest('[contenteditable=""]')||e.closest('[contenteditable="true"]'))}function A3e(n){return n.nodeType===1?n:n.parentElement}var wle=(function(n){return n.button="button",n.color="color",n.file="file",n.image="image",n.reset="reset",n.submit="submit",n.checkbox="checkbox",n.radio="radio",n})(wle||{});function Rle(n){return Ds(n,"button")||Ds(n,"input")&&n.type in wle}function XT(n){return Cle(n)&&!n.readOnly||xE(n)}var Ale=(function(n){return n.text="text",n.date="date",n["datetime-local"]="datetime-local",n.email="email",n.month="month",n.number="number",n.password="password",n.search="search",n.tel="tel",n.time="time",n.url="url",n.week="week",n})(Ale||{});function Cle(n){return Ds(n,"textarea")||Ds(n,"input")&&n.type in Ale}function Yv(n){return Mle(n)&&Cle(n)}function C3e(n){return Mle(n)&&Rle(n)}function Mle(n){return n.nodeType===1}function M3e(n){const e=n.ownerDocument.getSelection();if(e?.focusNode&&Yv(n)){const r=Z2(e.focusNode);if(r){if(!e.isCollapsed){var t;const i=((t=r.firstChild)===null||t===void 0?void 0:t.nodeType)===3?r.firstChild:r;e.setBaseAndExtent(i,0,i,0)}}else e.setBaseAndExtent(n,0,n,0)}}var nv={},PN={exports:{}};PN.exports;var AY;function kle(){return AY||(AY=1,(function(n){const t=(s=0)=>a=>`\x1B[${38+s};5;${a}m`,r=(s=0)=>(a,o,l)=>`\x1B[${38+s};2;${a};${o};${l}m`;function i(){const s=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,l]of Object.entries(a)){for(const[c,u]of Object.entries(l))a[c]={open:`\x1B[${u[0]}m`,close:`\x1B[${u[1]}m`},l[c]=a[c],s.set(u[0],u[1]);Object.defineProperty(a,o,{value:l,enumerable:!1})}return Object.defineProperty(a,"codes",{value:s,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=t(),a.color.ansi16m=r(),a.bgColor.ansi256=t(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,l,c)=>o===l&&l===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(l/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const l=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!l)return[0,0,0];let{colorString:c}=l.groups;c.length===3&&(c=c.split("").map(f=>f+f).join(""));const u=Number.parseInt(c,16);return[u>>16&255,u>>8&255,u&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(n,"exports",{enumerable:!0,get:i})})(PN)),PN.exports}var gS={},CY;function k4(){if(CY)return gS;CY=1,Object.defineProperty(gS,"__esModule",{value:!0}),gS.printIteratorEntries=e,gS.printIteratorValues=t,gS.printListItems=r,gS.printObjectProperties=i;const n=(s,a)=>{const o=Object.keys(s).sort(a);return Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(s).forEach(l=>{Object.getOwnPropertyDescriptor(s,l).enumerable&&o.push(l)}),o};function e(s,a,o,l,c,u,f=": "){let d="",g=s.next();if(!g.done){d+=a.spacingOuter;const p=o+a.indent;for(;!g.done;){const _=u(g.value[0],a,p,l,c),y=u(g.value[1],a,p,l,c);d+=p+_+f+y,g=s.next(),g.done?a.min||(d+=","):d+=","+a.spacingInner}d+=a.spacingOuter+o}return d}function t(s,a,o,l,c,u){let f="",d=s.next();if(!d.done){f+=a.spacingOuter;const g=o+a.indent;for(;!d.done;)f+=g+u(d.value,a,g,l,c),d=s.next(),d.done?a.min||(f+=","):f+=","+a.spacingInner;f+=a.spacingOuter+o}return f}function r(s,a,o,l,c,u){let f="";if(s.length){f+=a.spacingOuter;const d=o+a.indent;for(let g=0;g<s.length;g++)f+=d,g in s&&(f+=u(s[g],a,d,l,c)),g<s.length-1?f+=","+a.spacingInner:a.min||(f+=",");f+=a.spacingOuter+o}return f}function i(s,a,o,l,c,u){let f="";const d=n(s,a.compareKeys);if(d.length){f+=a.spacingOuter;const g=o+a.indent;for(let p=0;p<d.length;p++){const _=d[p],y=u(_,a,g,l,c),v=u(s[_],a,g,l,c);f+=g+y+": "+v,p<d.length-1?f+=","+a.spacingInner:a.min||(f+=",")}f+=a.spacingOuter+o}return f}return gS}var my={},MY;function k3e(){if(MY)return my;MY=1,Object.defineProperty(my,"__esModule",{value:!0}),my.test=my.serialize=my.default=void 0;var n=k4(),e=(function(){return typeof globalThis<"u"?globalThis:typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()})(),t=e["jest-symbol-do-not-touch"]||e.Symbol;const r=typeof t=="function"&&t.for?t.for("jest.asymmetricMatcher"):1267621,i=" ",s=(c,u,f,d,g,p)=>{const _=c.toString();return _==="ArrayContaining"||_==="ArrayNotContaining"?++d>u.maxDepth?"["+_+"]":_+i+"["+(0,n.printListItems)(c.sample,u,f,d,g,p)+"]":_==="ObjectContaining"||_==="ObjectNotContaining"?++d>u.maxDepth?"["+_+"]":_+i+"{"+(0,n.printObjectProperties)(c.sample,u,f,d,g,p)+"}":_==="StringMatching"||_==="StringNotMatching"||_==="StringContaining"||_==="StringNotContaining"?_+i+p(c.sample,u,f,d,g):c.toAsymmetricMatcher()};my.serialize=s;const a=c=>c&&c.$$typeof===r;my.test=a;var l={serialize:s,test:a};return my.default=l,my}var gy={},tB,kY;function O3e(){return kY||(kY=1,tB=({onlyFirst:n=!1}={})=>{const e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,n?void 0:"g")}),tB}var OY;function I3e(){if(OY)return gy;OY=1,Object.defineProperty(gy,"__esModule",{value:!0}),gy.test=gy.serialize=gy.default=void 0;var n=t(O3e()),e=t(kle());function t(l){return l&&l.__esModule?l:{default:l}}const r=l=>l.replace((0,n.default)(),c=>{switch(c){case e.default.red.close:case e.default.green.close:case e.default.cyan.close:case e.default.gray.close:case e.default.white.close:case e.default.yellow.close:case e.default.bgRed.close:case e.default.bgGreen.close:case e.default.bgYellow.close:case e.default.inverse.close:case e.default.dim.close:case e.default.bold.close:case e.default.reset.open:case e.default.reset.close:return"</>";case e.default.red.open:return"<red>";case e.default.green.open:return"<green>";case e.default.cyan.open:return"<cyan>";case e.default.gray.open:return"<gray>";case e.default.white.open:return"<white>";case e.default.yellow.open:return"<yellow>";case e.default.bgRed.open:return"<bgRed>";case e.default.bgGreen.open:return"<bgGreen>";case e.default.bgYellow.open:return"<bgYellow>";case e.default.inverse.open:return"<inverse>";case e.default.dim.open:return"<dim>";case e.default.bold.open:return"<bold>";default:return""}}),i=l=>typeof l=="string"&&!!l.match((0,n.default)());gy.test=i;const s=(l,c,u,f,d,g)=>g(r(l),c,u,f,d);gy.serialize=s;var o={serialize:s,test:i};return gy.default=o,gy}var _y={},IY;function N3e(){if(IY)return _y;IY=1,Object.defineProperty(_y,"__esModule",{value:!0}),_y.test=_y.serialize=_y.default=void 0;var n=k4();const e=" ",t=["DOMStringMap","NamedNodeMap"],r=/^(HTML\w*Collection|NodeList)$/,i=u=>t.indexOf(u)!==-1||r.test(u),s=u=>u&&u.constructor&&!!u.constructor.name&&i(u.constructor.name);_y.test=s;const a=u=>u.constructor.name==="NamedNodeMap",o=(u,f,d,g,p,_)=>{const y=u.constructor.name;return++g>f.maxDepth?"["+y+"]":(f.min?"":y+e)+(t.indexOf(y)!==-1?"{"+(0,n.printObjectProperties)(a(u)?Array.from(u).reduce((v,x)=>(v[x.name]=x.value,v),{}):{...u},f,d,g,p,_)+"}":"["+(0,n.printListItems)(Array.from(u),f,d,g,p,_)+"]")};_y.serialize=o;var c={serialize:o,test:s};return _y.default=c,_y}var vy={},wp={},RI={},NY;function P3e(){if(NY)return RI;NY=1,Object.defineProperty(RI,"__esModule",{value:!0}),RI.default=n;function n(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;")}return RI}var PY;function mj(){if(PY)return wp;PY=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.printText=wp.printProps=wp.printElementAsLeaf=wp.printElement=wp.printComment=wp.printChildren=void 0;var n=e(P3e());function e(l){return l&&l.__esModule?l:{default:l}}const t=(l,c,u,f,d,g,p)=>{const _=f+u.indent,y=u.colors;return l.map(v=>{const x=c[v];let E=p(x,u,_,d,g);return typeof x!="string"&&(E.indexOf(`
`)!==-1&&(E=u.spacingOuter+_+E+u.spacingOuter+f),E="{"+E+"}"),u.spacingInner+f+y.prop.open+v+y.prop.close+"="+y.value.open+E+y.value.close}).join("")};wp.printProps=t;const r=(l,c,u,f,d,g)=>l.map(p=>c.spacingOuter+u+(typeof p=="string"?i(p,c):g(p,c,u,f,d))).join("");wp.printChildren=r;const i=(l,c)=>{const u=c.colors.content;return u.open+(0,n.default)(l)+u.close};wp.printText=i;const s=(l,c)=>{const u=c.colors.comment;return u.open+"<!--"+(0,n.default)(l)+"-->"+u.close};wp.printComment=s;const a=(l,c,u,f,d)=>{const g=f.colors.tag;return g.open+"<"+l+(c&&g.close+c+f.spacingOuter+d+g.open)+(u?">"+g.close+u+f.spacingOuter+d+g.open+"</"+l:(c&&!f.min?"":" ")+"/")+">"+g.close};wp.printElement=a;const o=(l,c)=>{const u=c.colors.tag;return u.open+"<"+l+u.close+" "+u.open+" />"+u.close};return wp.printElementAsLeaf=o,wp}var DY;function D3e(){if(DY)return vy;DY=1,Object.defineProperty(vy,"__esModule",{value:!0}),vy.test=vy.serialize=vy.default=void 0;var n=mj();const e=1,t=3,r=8,i=11,s=/^((HTML|SVG)\w*)?Element$/,a=_=>{try{return typeof _.hasAttribute=="function"&&_.hasAttribute("is")}catch{return!1}},o=_=>{const y=_.constructor.name,{nodeType:v,tagName:x}=_,E=typeof x=="string"&&x.includes("-")||a(_);return v===e&&(s.test(y)||E)||v===t&&y==="Text"||v===r&&y==="Comment"||v===i&&y==="DocumentFragment"},l=_=>{var y;return(_==null||(y=_.constructor)===null||y===void 0?void 0:y.name)&&o(_)};vy.test=l;function c(_){return _.nodeType===t}function u(_){return _.nodeType===r}function f(_){return _.nodeType===i}const d=(_,y,v,x,E,M)=>{if(c(_))return(0,n.printText)(_.data,y);if(u(_))return(0,n.printComment)(_.data,y);const O=f(_)?"DocumentFragment":_.tagName.toLowerCase();return++x>y.maxDepth?(0,n.printElementAsLeaf)(O,y):(0,n.printElement)(O,(0,n.printProps)(f(_)?[]:Array.from(_.attributes).map(N=>N.name).sort(),f(_)?{}:Array.from(_.attributes).reduce((N,I)=>(N[I.name]=I.value,N),{}),y,v+y.indent,x,E,M),(0,n.printChildren)(Array.prototype.slice.call(_.childNodes||_.children),y,v+y.indent,x,E,M),y,v)};vy.serialize=d;var p={serialize:d,test:l};return vy.default=p,vy}var yy={},LY;function L3e(){if(LY)return yy;LY=1,Object.defineProperty(yy,"__esModule",{value:!0}),yy.test=yy.serialize=yy.default=void 0;var n=k4();const e="@@__IMMUTABLE_ITERABLE__@@",t="@@__IMMUTABLE_LIST__@@",r="@@__IMMUTABLE_KEYED__@@",i="@@__IMMUTABLE_MAP__@@",s="@@__IMMUTABLE_ORDERED__@@",a="@@__IMMUTABLE_RECORD__@@",o="@@__IMMUTABLE_SEQ__@@",l="@@__IMMUTABLE_SET__@@",c="@@__IMMUTABLE_STACK__@@",u=I=>"Immutable."+I,f=I=>"["+I+"]",d=" ",g="",p=(I,D,V,G,Q,B,$)=>++G>D.maxDepth?f(u($)):u($)+d+"{"+(0,n.printIteratorEntries)(I.entries(),D,V,G,Q,B)+"}";function _(I){let D=0;return{next(){if(D<I._keys.length){const V=I._keys[D++];return{done:!1,value:[V,I.get(V)]}}return{done:!0,value:void 0}}}}const y=(I,D,V,G,Q,B)=>{const $=u(I._name||"Record");return++G>D.maxDepth?f($):$+d+"{"+(0,n.printIteratorEntries)(_(I),D,V,G,Q,B)+"}"},v=(I,D,V,G,Q,B)=>{const $=u("Seq");return++G>D.maxDepth?f($):I[r]?$+d+"{"+(I._iter||I._object?(0,n.printIteratorEntries)(I.entries(),D,V,G,Q,B):g)+"}":$+d+"["+(I._iter||I._array||I._collection||I._iterable?(0,n.printIteratorValues)(I.values(),D,V,G,Q,B):g)+"]"},x=(I,D,V,G,Q,B,$)=>++G>D.maxDepth?f(u($)):u($)+d+"["+(0,n.printIteratorValues)(I.values(),D,V,G,Q,B)+"]",E=(I,D,V,G,Q,B)=>I[i]?p(I,D,V,G,Q,B,I[s]?"OrderedMap":"Map"):I[t]?x(I,D,V,G,Q,B,"List"):I[l]?x(I,D,V,G,Q,B,I[s]?"OrderedSet":"Set"):I[c]?x(I,D,V,G,Q,B,"Stack"):I[o]?v(I,D,V,G,Q,B):y(I,D,V,G,Q,B);yy.serialize=E;const M=I=>I&&(I[e]===!0||I[a]===!0);yy.test=M;var N={serialize:E,test:M};return yy.default=N,yy}var by={},nB={exports:{}},Xo={};/** @license React v17.0.2
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UY;function U3e(){if(UY)return Xo;UY=1;var n=60103,e=60106,t=60107,r=60108,i=60114,s=60109,a=60110,o=60112,l=60113,c=60120,u=60115,f=60116,d=60121,g=60122,p=60117,_=60129,y=60131;if(typeof Symbol=="function"&&Symbol.for){var v=Symbol.for;n=v("react.element"),e=v("react.portal"),t=v("react.fragment"),r=v("react.strict_mode"),i=v("react.profiler"),s=v("react.provider"),a=v("react.context"),o=v("react.forward_ref"),l=v("react.suspense"),c=v("react.suspense_list"),u=v("react.memo"),f=v("react.lazy"),d=v("react.block"),g=v("react.server.block"),p=v("react.fundamental"),_=v("react.debug_trace_mode"),y=v("react.legacy_hidden")}function x($){if(typeof $=="object"&&$!==null){var U=$.$$typeof;switch(U){case n:switch($=$.type,$){case t:case i:case r:case l:case c:return $;default:switch($=$&&$.$$typeof,$){case a:case o:case f:case u:case s:return $;default:return U}}case e:return U}}}var E=s,M=n,O=o,N=t,I=f,D=u,V=e,G=i,Q=r,B=l;return Xo.ContextConsumer=a,Xo.ContextProvider=E,Xo.Element=M,Xo.ForwardRef=O,Xo.Fragment=N,Xo.Lazy=I,Xo.Memo=D,Xo.Portal=V,Xo.Profiler=G,Xo.StrictMode=Q,Xo.Suspense=B,Xo.isAsyncMode=function(){return!1},Xo.isConcurrentMode=function(){return!1},Xo.isContextConsumer=function($){return x($)===a},Xo.isContextProvider=function($){return x($)===s},Xo.isElement=function($){return typeof $=="object"&&$!==null&&$.$$typeof===n},Xo.isForwardRef=function($){return x($)===o},Xo.isFragment=function($){return x($)===t},Xo.isLazy=function($){return x($)===f},Xo.isMemo=function($){return x($)===u},Xo.isPortal=function($){return x($)===e},Xo.isProfiler=function($){return x($)===i},Xo.isStrictMode=function($){return x($)===r},Xo.isSuspense=function($){return x($)===l},Xo.isValidElementType=function($){return typeof $=="string"||typeof $=="function"||$===t||$===i||$===_||$===r||$===l||$===c||$===y||typeof $=="object"&&$!==null&&($.$$typeof===f||$.$$typeof===u||$.$$typeof===s||$.$$typeof===a||$.$$typeof===o||$.$$typeof===p||$.$$typeof===d||$[0]===g)},Xo.typeOf=x,Xo}var BY;function B3e(){return BY||(BY=1,nB.exports=U3e()),nB.exports}var FY;function F3e(){if(FY)return by;FY=1,Object.defineProperty(by,"__esModule",{value:!0}),by.test=by.serialize=by.default=void 0;var n=r(B3e()),e=mj();function t(f){if(typeof WeakMap!="function")return null;var d=new WeakMap,g=new WeakMap;return(t=function(p){return p?g:d})(f)}function r(f,d){if(f&&f.__esModule)return f;if(f===null||typeof f!="object"&&typeof f!="function")return{default:f};var g=t(d);if(g&&g.has(f))return g.get(f);var p={},_=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var y in f)if(y!=="default"&&Object.prototype.hasOwnProperty.call(f,y)){var v=_?Object.getOwnPropertyDescriptor(f,y):null;v&&(v.get||v.set)?Object.defineProperty(p,y,v):p[y]=f[y]}return p.default=f,g&&g.set(f,p),p}const i=(f,d=[])=>(Array.isArray(f)?f.forEach(g=>{i(g,d)}):f!=null&&f!==!1&&d.push(f),d),s=f=>{const d=f.type;if(typeof d=="string")return d;if(typeof d=="function")return d.displayName||d.name||"Unknown";if(n.isFragment(f))return"React.Fragment";if(n.isSuspense(f))return"React.Suspense";if(typeof d=="object"&&d!==null){if(n.isContextProvider(f))return"Context.Provider";if(n.isContextConsumer(f))return"Context.Consumer";if(n.isForwardRef(f)){if(d.displayName)return d.displayName;const g=d.render.displayName||d.render.name||"";return g!==""?"ForwardRef("+g+")":"ForwardRef"}if(n.isMemo(f)){const g=d.displayName||d.type.displayName||d.type.name||"";return g!==""?"Memo("+g+")":"Memo"}}return"UNDEFINED"},a=f=>{const{props:d}=f;return Object.keys(d).filter(g=>g!=="children"&&d[g]!==void 0).sort()},o=(f,d,g,p,_,y)=>++p>d.maxDepth?(0,e.printElementAsLeaf)(s(f),d):(0,e.printElement)(s(f),(0,e.printProps)(a(f),f.props,d,g+d.indent,p,_,y),(0,e.printChildren)(i(f.props.children),d,g+d.indent,p,_,y),d,g);by.serialize=o;const l=f=>f!=null&&n.isElement(f);by.test=l;var u={serialize:o,test:l};return by.default=u,by}var Sy={},zY;function z3e(){if(zY)return Sy;zY=1,Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.test=Sy.serialize=Sy.default=void 0;var n=mj(),e=(function(){return typeof globalThis<"u"?globalThis:typeof e<"u"?e:typeof self<"u"?self:typeof window<"u"?window:Function("return this")()})(),t=e["jest-symbol-do-not-touch"]||e.Symbol;const r=typeof t=="function"&&t.for?t.for("react.test.json"):245830487,i=c=>{const{props:u}=c;return u?Object.keys(u).filter(f=>u[f]!==void 0).sort():[]},s=(c,u,f,d,g,p)=>++d>u.maxDepth?(0,n.printElementAsLeaf)(c.type,u):(0,n.printElement)(c.type,c.props?(0,n.printProps)(i(c),c.props,u,f+u.indent,d,g,p):"",c.children?(0,n.printChildren)(c.children,u,f+u.indent,d,g,p):"",u,f);Sy.serialize=s;const a=c=>c&&c.$$typeof===r;Sy.test=a;var l={serialize:s,test:a};return Sy.default=l,Sy}var jY;function j3e(){if(jY)return nv;jY=1,Object.defineProperty(nv,"__esModule",{value:!0}),nv.default=nv.DEFAULT_OPTIONS=void 0,nv.format=Me,nv.plugins=void 0;var n=c(kle()),e=k4(),t=c(k3e()),r=c(I3e()),i=c(N3e()),s=c(D3e()),a=c(L3e()),o=c(F3e()),l=c(z3e());function c(Ce){return Ce&&Ce.__esModule?Ce:{default:Ce}}const u=Object.prototype.toString,f=Date.prototype.toISOString,d=Error.prototype.toString,g=RegExp.prototype.toString,p=Ce=>typeof Ce.constructor=="function"&&Ce.constructor.name||"Object",_=Ce=>typeof window<"u"&&Ce===window,y=/^Symbol\((.*)\)(.*)$/,v=/\n/gi;class x extends Error{constructor(Xe,$e){super(Xe),this.stack=$e,this.name=this.constructor.name}}function E(Ce){return Ce==="[object Array]"||Ce==="[object ArrayBuffer]"||Ce==="[object DataView]"||Ce==="[object Float32Array]"||Ce==="[object Float64Array]"||Ce==="[object Int8Array]"||Ce==="[object Int16Array]"||Ce==="[object Int32Array]"||Ce==="[object Uint8Array]"||Ce==="[object Uint8ClampedArray]"||Ce==="[object Uint16Array]"||Ce==="[object Uint32Array]"}function M(Ce){return Object.is(Ce,-0)?"-0":String(Ce)}function O(Ce){return`${Ce}n`}function N(Ce,Xe){return Xe?"[Function "+(Ce.name||"anonymous")+"]":"[Function]"}function I(Ce){return String(Ce).replace(y,"Symbol($1)")}function D(Ce){return"["+d.call(Ce)+"]"}function V(Ce,Xe,$e,at){if(Ce===!0||Ce===!1)return""+Ce;if(Ce===void 0)return"undefined";if(Ce===null)return"null";const pt=typeof Ce;if(pt==="number")return M(Ce);if(pt==="bigint")return O(Ce);if(pt==="string")return at?'"'+Ce.replace(/"|\\/g,"\\$&")+'"':'"'+Ce+'"';if(pt==="function")return N(Ce,Xe);if(pt==="symbol")return I(Ce);const oe=u.call(Ce);return oe==="[object WeakMap]"?"WeakMap {}":oe==="[object WeakSet]"?"WeakSet {}":oe==="[object Function]"||oe==="[object GeneratorFunction]"?N(Ce,Xe):oe==="[object Symbol]"?I(Ce):oe==="[object Date]"?isNaN(+Ce)?"Date { NaN }":f.call(Ce):oe==="[object Error]"?D(Ce):oe==="[object RegExp]"?$e?g.call(Ce).replace(/[\\^$*+?.()|[\]{}]/g,"\\$&"):g.call(Ce):Ce instanceof Error?D(Ce):null}function G(Ce,Xe,$e,at,pt,oe){if(pt.indexOf(Ce)!==-1)return"[Circular]";pt=pt.slice(),pt.push(Ce);const Ue=++at>Xe.maxDepth,Ge=Xe.min;if(Xe.callToJSON&&!Ue&&Ce.toJSON&&typeof Ce.toJSON=="function"&&!oe)return U(Ce.toJSON(),Xe,$e,at,pt,!0);const ze=u.call(Ce);return ze==="[object Arguments]"?Ue?"[Arguments]":(Ge?"":"Arguments ")+"["+(0,e.printListItems)(Ce,Xe,$e,at,pt,U)+"]":E(ze)?Ue?"["+Ce.constructor.name+"]":(Ge||!Xe.printBasicPrototype&&Ce.constructor.name==="Array"?"":Ce.constructor.name+" ")+"["+(0,e.printListItems)(Ce,Xe,$e,at,pt,U)+"]":ze==="[object Map]"?Ue?"[Map]":"Map {"+(0,e.printIteratorEntries)(Ce.entries(),Xe,$e,at,pt,U," => ")+"}":ze==="[object Set]"?Ue?"[Set]":"Set {"+(0,e.printIteratorValues)(Ce.values(),Xe,$e,at,pt,U)+"}":Ue||_(Ce)?"["+p(Ce)+"]":(Ge||!Xe.printBasicPrototype&&p(Ce)==="Object"?"":p(Ce)+" ")+"{"+(0,e.printObjectProperties)(Ce,Xe,$e,at,pt,U)+"}"}function Q(Ce){return Ce.serialize!=null}function B(Ce,Xe,$e,at,pt,oe){let Ue;try{Ue=Q(Ce)?Ce.serialize(Xe,$e,at,pt,oe,U):Ce.print(Xe,Ge=>U(Ge,$e,at,pt,oe),Ge=>{const ze=at+$e.indent;return ze+Ge.replace(v,`
`+ze)},{edgeSpacing:$e.spacingOuter,min:$e.min,spacing:$e.spacingInner},$e.colors)}catch(Ge){throw new x(Ge.message,Ge.stack)}if(typeof Ue!="string")throw new Error(`pretty-format: Plugin must return type "string" but instead returned "${typeof Ue}".`);return Ue}function $(Ce,Xe){for(let $e=0;$e<Ce.length;$e++)try{if(Ce[$e].test(Xe))return Ce[$e]}catch(at){throw new x(at.message,at.stack)}return null}function U(Ce,Xe,$e,at,pt,oe){const Ue=$(Xe.plugins,Ce);if(Ue!==null)return B(Ue,Ce,Xe,$e,at,pt);const Ge=V(Ce,Xe.printFunctionName,Xe.escapeRegex,Xe.escapeString);return Ge!==null?Ge:G(Ce,Xe,$e,at,pt,oe)}const J={comment:"gray",content:"reset",prop:"yellow",tag:"cyan",value:"green"},W=Object.keys(J),q={callToJSON:!0,compareKeys:void 0,escapeRegex:!1,escapeString:!0,highlight:!1,indent:2,maxDepth:1/0,min:!1,plugins:[],printBasicPrototype:!0,printFunctionName:!0,theme:J};nv.DEFAULT_OPTIONS=q;function Y(Ce){if(Object.keys(Ce).forEach(Xe=>{if(!q.hasOwnProperty(Xe))throw new Error(`pretty-format: Unknown option "${Xe}".`)}),Ce.min&&Ce.indent!==void 0&&Ce.indent!==0)throw new Error('pretty-format: Options "min" and "indent" cannot be used together.');if(Ce.theme!==void 0){if(Ce.theme===null)throw new Error('pretty-format: Option "theme" must not be null.');if(typeof Ce.theme!="object")throw new Error(`pretty-format: Option "theme" must be of type "object" but instead received "${typeof Ce.theme}".`)}}const ae=Ce=>W.reduce((Xe,$e)=>{const at=Ce.theme&&Ce.theme[$e]!==void 0?Ce.theme[$e]:J[$e],pt=at&&n.default[at];if(pt&&typeof pt.close=="string"&&typeof pt.open=="string")Xe[$e]=pt;else throw new Error(`pretty-format: Option "theme" has a key "${$e}" whose value "${at}" is undefined in ansi-styles.`);return Xe},Object.create(null)),Z=()=>W.reduce((Ce,Xe)=>(Ce[Xe]={close:"",open:""},Ce),Object.create(null)),K=Ce=>Ce&&Ce.printFunctionName!==void 0?Ce.printFunctionName:q.printFunctionName,ne=Ce=>Ce&&Ce.escapeRegex!==void 0?Ce.escapeRegex:q.escapeRegex,le=Ce=>Ce&&Ce.escapeString!==void 0?Ce.escapeString:q.escapeString,ce=Ce=>{var Xe;return{callToJSON:Ce&&Ce.callToJSON!==void 0?Ce.callToJSON:q.callToJSON,colors:Ce&&Ce.highlight?ae(Ce):Z(),compareKeys:Ce&&typeof Ce.compareKeys=="function"?Ce.compareKeys:q.compareKeys,escapeRegex:ne(Ce),escapeString:le(Ce),indent:Ce&&Ce.min?"":de(Ce&&Ce.indent!==void 0?Ce.indent:q.indent),maxDepth:Ce&&Ce.maxDepth!==void 0?Ce.maxDepth:q.maxDepth,min:Ce&&Ce.min!==void 0?Ce.min:q.min,plugins:Ce&&Ce.plugins!==void 0?Ce.plugins:q.plugins,printBasicPrototype:(Xe=Ce?.printBasicPrototype)!==null&&Xe!==void 0?Xe:!0,printFunctionName:K(Ce),spacingInner:Ce&&Ce.min?" ":`
`,spacingOuter:Ce&&Ce.min?"":`
`}};function de(Ce){return new Array(Ce+1).join(" ")}function Me(Ce,Xe){if(Xe&&(Y(Xe),Xe.plugins)){const at=$(Xe.plugins,Ce);if(at!==null)return B(at,Ce,ce(Xe),"",0,[])}const $e=V(Ce,K(Xe),ne(Xe),le(Xe));return $e!==null?$e:G(Ce,ce(Xe),"",0,[])}const qe={AsymmetricMatcher:t.default,ConvertAnsi:r.default,DOMCollection:i.default,DOMElement:s.default,Immutable:a.default,ReactElement:o.default,ReactTestComponent:l.default};nv.plugins=qe;var Pe=Me;return nv.default=Pe,nv}var Ole=j3e(),H3e=Object.prototype.toString;function q3e(n){return typeof n=="function"||H3e.call(n)==="[object Function]"}function V3e(n){var e=Number(n);return isNaN(e)?0:e===0||!isFinite(e)?e:(e>0?1:-1)*Math.floor(Math.abs(e))}var G3e=Math.pow(2,53)-1;function $3e(n){var e=V3e(n);return Math.min(Math.max(e,0),G3e)}function g_(n,e){var t=Array,r=Object(n);if(n==null)throw new TypeError("Array.from requires an array-like object - not null or undefined");for(var i=$3e(r.length),s=q3e(t)?Object(new t(i)):new Array(i),a=0,o;a<i;)o=r[a],s[a]=o,a+=1;return s.length=i,s}function Q2(n){"@babel/helpers - typeof";return Q2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q2(n)}function W3e(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function Y3e(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,Ile(r.key),r)}}function X3e(n,e,t){return e&&Y3e(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function K3e(n,e,t){return e=Ile(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ile(n){var e=Z3e(n,"string");return Q2(e)==="symbol"?e:String(e)}function Z3e(n,e){if(Q2(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(Q2(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var Q3e=(function(){function n(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];W3e(this,n),K3e(this,"items",void 0),this.items=e}return X3e(n,[{key:"add",value:function(t){return this.has(t)===!1&&this.items.push(t),this}},{key:"clear",value:function(){this.items=[]}},{key:"delete",value:function(t){var r=this.items.length;return this.items=this.items.filter(function(i){return i!==t}),r!==this.items.length}},{key:"forEach",value:function(t){var r=this;this.items.forEach(function(i){t(i,i,r)})}},{key:"has",value:function(t){return this.items.indexOf(t)!==-1}},{key:"size",get:function(){return this.items.length}}]),n})();const J3e=typeof Set>"u"?Set:Q3e;function rp(n){var e;return(e=n.localName)!==null&&e!==void 0?e:n.tagName.toLowerCase()}var eIe={article:"article",aside:"complementary",button:"button",datalist:"listbox",dd:"definition",details:"group",dialog:"dialog",dt:"term",fieldset:"group",figure:"figure",form:"form",footer:"contentinfo",h1:"heading",h2:"heading",h3:"heading",h4:"heading",h5:"heading",h6:"heading",header:"banner",hr:"separator",html:"document",legend:"legend",li:"listitem",math:"math",main:"main",menu:"list",nav:"navigation",ol:"list",optgroup:"group",option:"option",output:"status",progress:"progressbar",section:"region",summary:"button",table:"table",tbody:"rowgroup",textarea:"textbox",tfoot:"rowgroup",td:"cell",th:"columnheader",thead:"rowgroup",tr:"row",ul:"list"},tIe={caption:new Set(["aria-label","aria-labelledby"]),code:new Set(["aria-label","aria-labelledby"]),deletion:new Set(["aria-label","aria-labelledby"]),emphasis:new Set(["aria-label","aria-labelledby"]),generic:new Set(["aria-label","aria-labelledby","aria-roledescription"]),insertion:new Set(["aria-label","aria-labelledby"]),paragraph:new Set(["aria-label","aria-labelledby"]),presentation:new Set(["aria-label","aria-labelledby"]),strong:new Set(["aria-label","aria-labelledby"]),subscript:new Set(["aria-label","aria-labelledby"]),superscript:new Set(["aria-label","aria-labelledby"])};function nIe(n,e){return["aria-atomic","aria-busy","aria-controls","aria-current","aria-describedby","aria-details","aria-dropeffect","aria-flowto","aria-grabbed","aria-hidden","aria-keyshortcuts","aria-label","aria-labelledby","aria-live","aria-owns","aria-relevant","aria-roledescription"].some(function(t){var r;return n.hasAttribute(t)&&!((r=tIe[e])!==null&&r!==void 0&&r.has(t))})}function Nle(n,e){return nIe(n,e)}function rIe(n){var e=sIe(n);if(e===null||e==="presentation"){var t=iIe(n);if(e!=="presentation"||Nle(n,t||""))return t}return e}function iIe(n){var e=eIe[rp(n)];if(e!==void 0)return e;switch(rp(n)){case"a":case"area":case"link":if(n.hasAttribute("href"))return"link";break;case"img":return n.getAttribute("alt")===""&&!Nle(n,"img")?"presentation":"img";case"input":{var t=n,r=t.type;switch(r){case"button":case"image":case"reset":case"submit":return"button";case"checkbox":case"radio":return r;case"range":return"slider";case"email":case"tel":case"text":case"url":return n.hasAttribute("list")?"combobox":"textbox";case"search":return n.hasAttribute("list")?"combobox":"searchbox";case"number":return"spinbutton";default:return null}}case"select":return n.hasAttribute("multiple")||n.size>1?"listbox":"combobox"}return null}function sIe(n){var e=n.getAttribute("role");if(e!==null){var t=e.trim().split(" ")[0];if(t.length>0)return t}return null}function bc(n){return n!==null&&n.nodeType===n.ELEMENT_NODE}function Ple(n){return bc(n)&&rp(n)==="caption"}function DN(n){return bc(n)&&rp(n)==="input"}function aIe(n){return bc(n)&&rp(n)==="optgroup"}function oIe(n){return bc(n)&&rp(n)==="select"}function lIe(n){return bc(n)&&rp(n)==="table"}function cIe(n){return bc(n)&&rp(n)==="textarea"}function uIe(n){var e=n.ownerDocument===null?n:n.ownerDocument,t=e.defaultView;if(t===null)throw new TypeError("no window available");return t}function fIe(n){return bc(n)&&rp(n)==="fieldset"}function hIe(n){return bc(n)&&rp(n)==="legend"}function dIe(n){return bc(n)&&rp(n)==="slot"}function pIe(n){return bc(n)&&n.ownerSVGElement!==void 0}function mIe(n){return bc(n)&&rp(n)==="svg"}function gIe(n){return pIe(n)&&rp(n)==="title"}function vD(n,e){if(bc(n)&&n.hasAttribute(e)){var t=n.getAttribute(e).split(" "),r=n.getRootNode?n.getRootNode():n.ownerDocument;return t.map(function(i){return r.getElementById(i)}).filter(function(i){return i!==null})}return[]}function qy(n,e){return bc(n)?e.indexOf(rIe(n))!==-1:!1}function _Ie(n){return n.trim().replace(/\s\s+/g," ")}function vIe(n,e){if(!bc(n))return!1;if(n.hasAttribute("hidden")||n.getAttribute("aria-hidden")==="true")return!0;var t=e(n);return t.getPropertyValue("display")==="none"||t.getPropertyValue("visibility")==="hidden"}function yIe(n){return qy(n,["button","combobox","listbox","textbox"])||Dle(n,"range")}function Dle(n,e){if(!bc(n))return!1;switch(e){case"range":return qy(n,["meter","progressbar","scrollbar","slider","spinbutton"]);default:throw new TypeError("No knowledge about abstract role '".concat(e,"'. This is likely a bug :("))}}function HY(n,e){var t=g_(n.querySelectorAll(e));return vD(n,"aria-owns").forEach(function(r){t.push.apply(t,g_(r.querySelectorAll(e)))}),t}function bIe(n){return oIe(n)?n.selectedOptions||HY(n,"[selected]"):HY(n,'[aria-selected="true"]')}function SIe(n){return qy(n,["none","presentation"])}function EIe(n){return Ple(n)}function xIe(n){return qy(n,["button","cell","checkbox","columnheader","gridcell","heading","label","legend","link","menuitem","menuitemcheckbox","menuitemradio","option","radio","row","rowheader","switch","tab","tooltip","treeitem"])}function TIe(n){return!1}function wIe(n){return DN(n)||cIe(n)?n.value:n.textContent||""}function qY(n){var e=n.getPropertyValue("content");return/^["'].*["']$/.test(e)?e.slice(1,-1):""}function Lle(n){var e=rp(n);return e==="button"||e==="input"&&n.getAttribute("type")!=="hidden"||e==="meter"||e==="output"||e==="progress"||e==="select"||e==="textarea"}function Ule(n){if(Lle(n))return n;var e=null;return n.childNodes.forEach(function(t){if(e===null&&bc(t)){var r=Ule(t);r!==null&&(e=r)}}),e}function RIe(n){if(n.control!==void 0)return n.control;var e=n.getAttribute("for");return e!==null?n.ownerDocument.getElementById(e):Ule(n)}function AIe(n){var e=n.labels;if(e===null)return e;if(e!==void 0)return g_(e);if(!Lle(n))return null;var t=n.ownerDocument;return g_(t.querySelectorAll("label")).filter(function(r){return RIe(r)===n})}function CIe(n){var e=n.assignedNodes();return e.length===0?g_(n.childNodes):e}function Ble(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=new J3e,r=uIe(n),i=e.compute,s=i===void 0?"name":i,a=e.computedStyleSupportsPseudoElements,o=a===void 0?e.getComputedStyle!==void 0:a,l=e.getComputedStyle,c=l===void 0?r.getComputedStyle.bind(r):l,u=e.hidden,f=u===void 0?!1:u;function d(v,x){var E="";if(bc(v)&&o){var M=c(v,"::before"),O=qY(M);E="".concat(O," ").concat(E)}var N=dIe(v)?CIe(v):g_(v.childNodes).concat(vD(v,"aria-owns"));if(N.forEach(function(V){var G=y(V,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!1,recursion:!0}),Q=bc(V)?c(V).getPropertyValue("display"):"inline",B=Q!=="inline"?" ":"";E+="".concat(B).concat(G).concat(B)}),bc(v)&&o){var I=c(v,"::after"),D=qY(I);E="".concat(E," ").concat(D)}return E.trim()}function g(v,x){var E=v.getAttributeNode(x);return E!==null&&!t.has(E)&&E.value.trim()!==""?(t.add(E),E.value):null}function p(v){return bc(v)?g(v,"title"):null}function _(v){if(!bc(v))return null;if(fIe(v)){t.add(v);for(var x=g_(v.childNodes),E=0;E<x.length;E+=1){var M=x[E];if(hIe(M))return y(M,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(lIe(v)){t.add(v);for(var O=g_(v.childNodes),N=0;N<O.length;N+=1){var I=O[N];if(Ple(I))return y(I,{isEmbeddedInLabel:!1,isReferenced:!1,recursion:!1})}}else if(mIe(v)){t.add(v);for(var D=g_(v.childNodes),V=0;V<D.length;V+=1){var G=D[V];if(gIe(G))return G.textContent}return null}else if(rp(v)==="img"||rp(v)==="area"){var Q=g(v,"alt");if(Q!==null)return Q}else if(aIe(v)){var B=g(v,"label");if(B!==null)return B}if(DN(v)&&(v.type==="button"||v.type==="submit"||v.type==="reset")){var $=g(v,"value");if($!==null)return $;if(v.type==="submit")return"Submit";if(v.type==="reset")return"Reset"}var U=AIe(v);if(U!==null&&U.length!==0)return t.add(v),g_(U).map(function(Y){return y(Y,{isEmbeddedInLabel:!0,isReferenced:!1,recursion:!0})}).filter(function(Y){return Y.length>0}).join(" ");if(DN(v)&&v.type==="image"){var J=g(v,"alt");if(J!==null)return J;var W=g(v,"title");return W!==null?W:"Submit Query"}if(qy(v,["button"])){var q=d(v,{isEmbeddedInLabel:!1});if(q!=="")return q}return null}function y(v,x){if(t.has(v))return"";if(!f&&vIe(v,c)&&!x.isReferenced)return t.add(v),"";var E=bc(v)?v.getAttributeNode("aria-labelledby"):null,M=E!==null&&!t.has(E)?vD(v,"aria-labelledby"):[];if(s==="name"&&!x.isReferenced&&M.length>0)return t.add(E),M.map(function(Q){return y(Q,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!0,recursion:!1})}).join(" ");var O=x.recursion&&yIe(v)&&s==="name";if(!O){var N=(bc(v)&&v.getAttribute("aria-label")||"").trim();if(N!==""&&s==="name")return t.add(v),N;if(!SIe(v)){var I=_(v);if(I!==null)return t.add(v),I}}if(qy(v,["menu"]))return t.add(v),"";if(O||x.isEmbeddedInLabel||x.isReferenced){if(qy(v,["combobox","listbox"])){t.add(v);var D=bIe(v);return D.length===0?DN(v)?v.value:"":g_(D).map(function(Q){return y(Q,{isEmbeddedInLabel:x.isEmbeddedInLabel,isReferenced:!1,recursion:!0})}).join(" ")}if(Dle(v,"range"))return t.add(v),v.hasAttribute("aria-valuetext")?v.getAttribute("aria-valuetext"):v.hasAttribute("aria-valuenow")?v.getAttribute("aria-valuenow"):v.getAttribute("value")||"";if(qy(v,["textbox"]))return t.add(v),wIe(v)}if(xIe(v)||bc(v)&&x.isReferenced||EIe(v)||TIe()){var V=d(v,{isEmbeddedInLabel:x.isEmbeddedInLabel});if(V!=="")return t.add(v),V}if(v.nodeType===v.TEXT_NODE)return t.add(v),v.textContent||"";if(x.recursion)return t.add(v),d(v,{isEmbeddedInLabel:x.isEmbeddedInLabel});var G=p(v);return G!==null?(t.add(v),G):(t.add(v),"")}return _Ie(y(n,{isEmbeddedInLabel:!1,isReferenced:s==="description",recursion:!1}))}function J2(n){"@babel/helpers - typeof";return J2=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J2(n)}function VY(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function GY(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?VY(Object(t),!0).forEach(function(r){MIe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):VY(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function MIe(n,e,t){return e=kIe(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function kIe(n){var e=OIe(n,"string");return J2(e)==="symbol"?e:String(e)}function OIe(n,e){if(J2(n)!=="object"||n===null)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(J2(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function Fle(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=vD(n,"aria-describedby").map(function(i){return Ble(i,GY(GY({},e),{},{compute:"description"}))}).join(" ");if(t===""){var r=n.getAttribute("title");t=r===null?"":r}return t}function IIe(n){return qy(n,["caption","code","deletion","emphasis","generic","insertion","paragraph","presentation","strong","subscript","superscript"])}function gj(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return IIe(n)?"":Ble(n,e)}var Sg={},FR={},AI={},zR={},$Y;function NIe(){if($Y)return zR;$Y=1,Object.defineProperty(zR,"__esModule",{value:!0}),zR.default=void 0;function n(){var t=this,r=0,i={"@@iterator":function(){return i},next:function(){if(r<t.length){var a=t[r];return r=r+1,{done:!1,value:a}}else return{done:!0}}};return i}var e=n;return zR.default=e,zR}var WY;function lO(){if(WY)return AI;WY=1,Object.defineProperty(AI,"__esModule",{value:!0}),AI.default=r;var n=e(NIe());function e(i){return i&&i.__esModule?i:{default:i}}function t(i){"@babel/helpers - typeof";return t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},t(i)}function r(i,s){return typeof Symbol=="function"&&t(Symbol.iterator)==="symbol"&&Object.defineProperty(i,Symbol.iterator,{value:n.default.bind(s)}),i}return AI}var YY;function PIe(){if(YY)return FR;YY=1,Object.defineProperty(FR,"__esModule",{value:!0}),FR.default=void 0;var n=e(lO());function e(d){return d&&d.__esModule?d:{default:d}}function t(d,g){return s(d)||i(d,g)||o(d,g)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(d,g){var p=d==null?null:typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(p!=null){var _=[],y=!0,v=!1,x,E;try{for(p=p.call(d);!(y=(x=p.next()).done)&&(_.push(x.value),!(g&&_.length===g));y=!0);}catch(M){v=!0,E=M}finally{try{!y&&p.return!=null&&p.return()}finally{if(v)throw E}}return _}}function s(d){if(Array.isArray(d))return d}function a(d,g){var p=typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(!p){if(Array.isArray(d)||(p=o(d))||g){p&&(d=p);var _=0,y=function(){};return{s:y,n:function(){return _>=d.length?{done:!0}:{done:!1,value:d[_++]}},e:function(O){throw O},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,x=!1,E;return{s:function(){p=p.call(d)},n:function(){var O=p.next();return v=O.done,O},e:function(O){x=!0,E=O},f:function(){try{!v&&p.return!=null&&p.return()}finally{if(x)throw E}}}}function o(d,g){if(d){if(typeof d=="string")return l(d,g);var p=Object.prototype.toString.call(d).slice(8,-1);if(p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set")return Array.from(d);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return l(d,g)}}function l(d,g){(g==null||g>d.length)&&(g=d.length);for(var p=0,_=new Array(g);p<g;p++)_[p]=d[p];return _}var c=[["aria-activedescendant",{type:"id"}],["aria-atomic",{type:"boolean"}],["aria-autocomplete",{type:"token",values:["inline","list","both","none"]}],["aria-braillelabel",{type:"string"}],["aria-brailleroledescription",{type:"string"}],["aria-busy",{type:"boolean"}],["aria-checked",{type:"tristate"}],["aria-colcount",{type:"integer"}],["aria-colindex",{type:"integer"}],["aria-colspan",{type:"integer"}],["aria-controls",{type:"idlist"}],["aria-current",{type:"token",values:["page","step","location","date","time",!0,!1]}],["aria-describedby",{type:"idlist"}],["aria-description",{type:"string"}],["aria-details",{type:"id"}],["aria-disabled",{type:"boolean"}],["aria-dropeffect",{type:"tokenlist",values:["copy","execute","link","move","none","popup"]}],["aria-errormessage",{type:"id"}],["aria-expanded",{type:"boolean",allowundefined:!0}],["aria-flowto",{type:"idlist"}],["aria-grabbed",{type:"boolean",allowundefined:!0}],["aria-haspopup",{type:"token",values:[!1,!0,"menu","listbox","tree","grid","dialog"]}],["aria-hidden",{type:"boolean",allowundefined:!0}],["aria-invalid",{type:"token",values:["grammar",!1,"spelling",!0]}],["aria-keyshortcuts",{type:"string"}],["aria-label",{type:"string"}],["aria-labelledby",{type:"idlist"}],["aria-level",{type:"integer"}],["aria-live",{type:"token",values:["assertive","off","polite"]}],["aria-modal",{type:"boolean"}],["aria-multiline",{type:"boolean"}],["aria-multiselectable",{type:"boolean"}],["aria-orientation",{type:"token",values:["vertical","undefined","horizontal"]}],["aria-owns",{type:"idlist"}],["aria-placeholder",{type:"string"}],["aria-posinset",{type:"integer"}],["aria-pressed",{type:"tristate"}],["aria-readonly",{type:"boolean"}],["aria-relevant",{type:"tokenlist",values:["additions","all","removals","text"]}],["aria-required",{type:"boolean"}],["aria-roledescription",{type:"string"}],["aria-rowcount",{type:"integer"}],["aria-rowindex",{type:"integer"}],["aria-rowspan",{type:"integer"}],["aria-selected",{type:"boolean",allowundefined:!0}],["aria-setsize",{type:"integer"}],["aria-sort",{type:"token",values:["ascending","descending","none","other"]}],["aria-valuemax",{type:"number"}],["aria-valuemin",{type:"number"}],["aria-valuenow",{type:"number"}],["aria-valuetext",{type:"string"}]],u={entries:function(){return c},forEach:function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,_=a(c),y;try{for(_.s();!(y=_.n()).done;){var v=t(y.value,2),x=v[0],E=v[1];g.call(p,E,x,c)}}catch(M){_.e(M)}finally{_.f()}},get:function(g){var p=c.find(function(_){return _[0]===g});return p&&p[1]},has:function(g){return!!u.get(g)},keys:function(){return c.map(function(g){var p=t(g,1),_=p[0];return _})},values:function(){return c.map(function(g){var p=t(g,2),_=p[1];return _})}},f=(0,n.default)(u,u.entries());return FR.default=f,FR}var jR={},XY;function DIe(){if(XY)return jR;XY=1,Object.defineProperty(jR,"__esModule",{value:!0}),jR.default=void 0;var n=e(lO());function e(d){return d&&d.__esModule?d:{default:d}}function t(d,g){return s(d)||i(d,g)||o(d,g)||r()}function r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(d,g){var p=d==null?null:typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(p!=null){var _=[],y=!0,v=!1,x,E;try{for(p=p.call(d);!(y=(x=p.next()).done)&&(_.push(x.value),!(g&&_.length===g));y=!0);}catch(M){v=!0,E=M}finally{try{!y&&p.return!=null&&p.return()}finally{if(v)throw E}}return _}}function s(d){if(Array.isArray(d))return d}function a(d,g){var p=typeof Symbol<"u"&&d[Symbol.iterator]||d["@@iterator"];if(!p){if(Array.isArray(d)||(p=o(d))||g){p&&(d=p);var _=0,y=function(){};return{s:y,n:function(){return _>=d.length?{done:!0}:{done:!1,value:d[_++]}},e:function(O){throw O},f:y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var v=!0,x=!1,E;return{s:function(){p=p.call(d)},n:function(){var O=p.next();return v=O.done,O},e:function(O){x=!0,E=O},f:function(){try{!v&&p.return!=null&&p.return()}finally{if(x)throw E}}}}function o(d,g){if(d){if(typeof d=="string")return l(d,g);var p=Object.prototype.toString.call(d).slice(8,-1);if(p==="Object"&&d.constructor&&(p=d.constructor.name),p==="Map"||p==="Set")return Array.from(d);if(p==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(p))return l(d,g)}}function l(d,g){(g==null||g>d.length)&&(g=d.length);for(var p=0,_=new Array(g);p<g;p++)_[p]=d[p];return _}var c=[["a",{reserved:!1}],["abbr",{reserved:!1}],["acronym",{reserved:!1}],["address",{reserved:!1}],["applet",{reserved:!1}],["area",{reserved:!1}],["article",{reserved:!1}],["aside",{reserved:!1}],["audio",{reserved:!1}],["b",{reserved:!1}],["base",{reserved:!0}],["bdi",{reserved:!1}],["bdo",{reserved:!1}],["big",{reserved:!1}],["blink",{reserved:!1}],["blockquote",{reserved:!1}],["body",{reserved:!1}],["br",{reserved:!1}],["button",{reserved:!1}],["canvas",{reserved:!1}],["caption",{reserved:!1}],["center",{reserved:!1}],["cite",{reserved:!1}],["code",{reserved:!1}],["col",{reserved:!0}],["colgroup",{reserved:!0}],["content",{reserved:!1}],["data",{reserved:!1}],["datalist",{reserved:!1}],["dd",{reserved:!1}],["del",{reserved:!1}],["details",{reserved:!1}],["dfn",{reserved:!1}],["dialog",{reserved:!1}],["dir",{reserved:!1}],["div",{reserved:!1}],["dl",{reserved:!1}],["dt",{reserved:!1}],["em",{reserved:!1}],["embed",{reserved:!1}],["fieldset",{reserved:!1}],["figcaption",{reserved:!1}],["figure",{reserved:!1}],["font",{reserved:!1}],["footer",{reserved:!1}],["form",{reserved:!1}],["frame",{reserved:!1}],["frameset",{reserved:!1}],["h1",{reserved:!1}],["h2",{reserved:!1}],["h3",{reserved:!1}],["h4",{reserved:!1}],["h5",{reserved:!1}],["h6",{reserved:!1}],["head",{reserved:!0}],["header",{reserved:!1}],["hgroup",{reserved:!1}],["hr",{reserved:!1}],["html",{reserved:!0}],["i",{reserved:!1}],["iframe",{reserved:!1}],["img",{reserved:!1}],["input",{reserved:!1}],["ins",{reserved:!1}],["kbd",{reserved:!1}],["keygen",{reserved:!1}],["label",{reserved:!1}],["legend",{reserved:!1}],["li",{reserved:!1}],["link",{reserved:!0}],["main",{reserved:!1}],["map",{reserved:!1}],["mark",{reserved:!1}],["marquee",{reserved:!1}],["menu",{reserved:!1}],["menuitem",{reserved:!1}],["meta",{reserved:!0}],["meter",{reserved:!1}],["nav",{reserved:!1}],["noembed",{reserved:!0}],["noscript",{reserved:!0}],["object",{reserved:!1}],["ol",{reserved:!1}],["optgroup",{reserved:!1}],["option",{reserved:!1}],["output",{reserved:!1}],["p",{reserved:!1}],["param",{reserved:!0}],["picture",{reserved:!0}],["pre",{reserved:!1}],["progress",{reserved:!1}],["q",{reserved:!1}],["rp",{reserved:!1}],["rt",{reserved:!1}],["rtc",{reserved:!1}],["ruby",{reserved:!1}],["s",{reserved:!1}],["samp",{reserved:!1}],["script",{reserved:!0}],["section",{reserved:!1}],["select",{reserved:!1}],["small",{reserved:!1}],["source",{reserved:!0}],["spacer",{reserved:!1}],["span",{reserved:!1}],["strike",{reserved:!1}],["strong",{reserved:!1}],["style",{reserved:!0}],["sub",{reserved:!1}],["summary",{reserved:!1}],["sup",{reserved:!1}],["table",{reserved:!1}],["tbody",{reserved:!1}],["td",{reserved:!1}],["textarea",{reserved:!1}],["tfoot",{reserved:!1}],["th",{reserved:!1}],["thead",{reserved:!1}],["time",{reserved:!1}],["title",{reserved:!0}],["tr",{reserved:!1}],["track",{reserved:!0}],["tt",{reserved:!1}],["u",{reserved:!1}],["ul",{reserved:!1}],["var",{reserved:!1}],["video",{reserved:!1}],["wbr",{reserved:!1}],["xmp",{reserved:!1}]],u={entries:function(){return c},forEach:function(g){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,_=a(c),y;try{for(_.s();!(y=_.n()).done;){var v=t(y.value,2),x=v[0],E=v[1];g.call(p,E,x,c)}}catch(M){_.e(M)}finally{_.f()}},get:function(g){var p=c.find(function(_){return _[0]===g});return p&&p[1]},has:function(g){return!!u.get(g)},keys:function(){return c.map(function(g){var p=t(g,1),_=p[0];return _})},values:function(){return c.map(function(g){var p=t(g,2),_=p[1];return _})}},f=(0,n.default)(u,u.entries());return jR.default=f,jR}var HR={},qR={},VR={},KY;function LIe(){if(KY)return VR;KY=1,Object.defineProperty(VR,"__esModule",{value:!0}),VR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return VR.default=e,VR}var GR={},ZY;function UIe(){if(ZY)return GR;ZY=1,Object.defineProperty(GR,"__esModule",{value:!0}),GR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return GR.default=e,GR}var $R={},QY;function BIe(){if(QY)return $R;QY=1,Object.defineProperty($R,"__esModule",{value:!0}),$R.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null},relatedConcepts:[{concept:{name:"input"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget"]]},e=n;return $R.default=e,$R}var WR={},JY;function FIe(){if(JY)return WR;JY=1,Object.defineProperty(WR,"__esModule",{value:!0}),WR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return WR.default=e,WR}var YR={},eX;function zIe(){if(eX)return YR;eX=1,Object.defineProperty(YR,"__esModule",{value:!0}),YR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuemax":null,"aria-valuemin":null,"aria-valuenow":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return YR.default=e,YR}var XR={},tX;function jIe(){if(tX)return XR;tX=1,Object.defineProperty(XR,"__esModule",{value:!0}),XR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{"aria-atomic":null,"aria-busy":null,"aria-controls":null,"aria-current":null,"aria-describedby":null,"aria-details":null,"aria-dropeffect":null,"aria-flowto":null,"aria-grabbed":null,"aria-hidden":null,"aria-keyshortcuts":null,"aria-label":null,"aria-labelledby":null,"aria-live":null,"aria-owns":null,"aria-relevant":null,"aria-roledescription":null},relatedConcepts:[{concept:{name:"role"},module:"XHTML"},{concept:{name:"type"},module:"Dublin Core"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},e=n;return XR.default=e,XR}var KR={},nX;function HIe(){if(nX)return KR;nX=1,Object.defineProperty(KR,"__esModule",{value:!0}),KR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"frontmatter"},module:"DTB"},{concept:{name:"level"},module:"DTB"},{concept:{name:"level"},module:"SMIL"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return KR.default=e,KR}var ZR={},rX;function qIe(){if(rX)return ZR;rX=1,Object.defineProperty(ZR,"__esModule",{value:!0}),ZR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return ZR.default=e,ZR}var QR={},iX;function VIe(){if(iX)return QR;iX=1,Object.defineProperty(QR,"__esModule",{value:!0}),QR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","group"]]},e=n;return QR.default=e,QR}var JR={},sX;function GIe(){if(sX)return JR;sX=1,Object.defineProperty(JR,"__esModule",{value:!0}),JR.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return JR.default=e,JR}var eA={},aX;function $Ie(){if(aX)return eA;aX=1,Object.defineProperty(eA,"__esModule",{value:!0}),eA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return eA.default=e,eA}var tA={},oX;function WIe(){if(oX)return tA;oX=1,Object.defineProperty(tA,"__esModule",{value:!0}),tA.default=void 0;var n={abstract:!0,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-modal":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype"]]},e=n;return tA.default=e,tA}var lX;function YIe(){if(lX)return qR;lX=1,Object.defineProperty(qR,"__esModule",{value:!0}),qR.default=void 0;var n=d(LIe()),e=d(UIe()),t=d(BIe()),r=d(FIe()),i=d(zIe()),s=d(jIe()),a=d(HIe()),o=d(qIe()),l=d(VIe()),c=d(GIe()),u=d($Ie()),f=d(WIe());function d(_){return _&&_.__esModule?_:{default:_}}var g=[["command",n.default],["composite",e.default],["input",t.default],["landmark",r.default],["range",i.default],["roletype",s.default],["section",a.default],["sectionhead",o.default],["select",l.default],["structure",c.default],["widget",u.default],["window",f.default]],p=g;return qR.default=p,qR}var nA={},rA={},cX;function XIe(){if(cX)return rA;cX=1,Object.defineProperty(rA,"__esModule",{value:!0}),rA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"assertive"},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return rA.default=e,rA}var iA={},uX;function KIe(){if(uX)return iA;uX=1,Object.defineProperty(iA,"__esModule",{value:!0}),iA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"alert"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","alert"],["roletype","window","dialog"]]},e=n;return iA.default=e,iA}var sA={},fX;function ZIe(){if(fX)return sA;fX=1,Object.defineProperty(sA,"__esModule",{value:!0}),sA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return sA.default=e,sA}var aA={},hX;function QIe(){if(hX)return aA;hX=1,Object.defineProperty(aA,"__esModule",{value:!0}),aA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"article"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},e=n;return aA.default=e,aA}var oA={},dX;function JIe(){if(dX)return oA;dX=1,Object.defineProperty(oA,"__esModule",{value:!0}),oA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"header"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return oA.default=e,oA}var lA={},pX;function eNe(){if(pX)return lA;pX=1,Object.defineProperty(lA,"__esModule",{value:!0}),lA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"blockquote"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return lA.default=e,lA}var cA={},mX;function tNe(){if(mX)return cA;mX=1,Object.defineProperty(cA,"__esModule",{value:!0}),cA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-pressed":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"button"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"image"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"reset"}],name:"input"},module:"HTML"},{concept:{attributes:[{name:"type",value:"submit"}],name:"input"},module:"HTML"},{concept:{name:"button"},module:"HTML"},{concept:{name:"trigger"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return cA.default=e,cA}var uA={},gX;function nNe(){if(gX)return uA;gX=1,Object.defineProperty(uA,"__esModule",{value:!0}),uA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"caption"},module:"HTML"}],requireContextRole:["figure","grid","table"],requiredContextRole:["figure","grid","table"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return uA.default=e,uA}var fA={},_X;function rNe(){if(_X)return fA;_X=1,Object.defineProperty(fA,"__esModule",{value:!0}),fA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-colspan":null,"aria-rowindex":null,"aria-rowspan":null},relatedConcepts:[{concept:{constraints:["ancestor table element has table role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return fA.default=e,fA}var hA={},vX;function iNe(){if(vX)return hA;vX=1,Object.defineProperty(hA,"__esModule",{value:!0}),hA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"checkbox"}],name:"input"},module:"HTML"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},e=n;return hA.default=e,hA}var dA={},yX;function sNe(){if(yX)return dA;yX=1,Object.defineProperty(dA,"__esModule",{value:!0}),dA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"code"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return dA.default=e,dA}var pA={},bX;function aNe(){if(bX)return pA;bX=1,Object.defineProperty(pA,"__esModule",{value:!0}),pA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"col"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"colgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},e=n;return pA.default=e,pA}var mA={},SX;function oNe(){if(SX)return mA;SX=1,Object.defineProperty(mA,"__esModule",{value:!0}),mA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-expanded":"false","aria-haspopup":"listbox"},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"email"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"search"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"tel"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"text"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"list"},{name:"type",value:"url"}],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"multiple"},{constraints:["undefined"],name:"size"}],constraints:["the multiple attribute is not set and the size attribute does not have a value greater than 1"],name:"select"},module:"HTML"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-expanded":"false"},superClass:[["roletype","widget","input"]]},e=n;return mA.default=e,mA}var gA={},EX;function lNe(){if(EX)return gA;EX=1,Object.defineProperty(gA,"__esModule",{value:!0}),gA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-label"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],constraints:["scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"aside"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return gA.default=e,gA}var _A={},xX;function cNe(){if(xX)return _A;xX=1,Object.defineProperty(_A,"__esModule",{value:!0}),_A.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{constraints:["scoped to the body element"],name:"footer"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return _A.default=e,_A}var vA={},TX;function uNe(){if(TX)return vA;TX=1,Object.defineProperty(vA,"__esModule",{value:!0}),vA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dd"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return vA.default=e,vA}var yA={},wX;function fNe(){if(wX)return yA;wX=1,Object.defineProperty(yA,"__esModule",{value:!0}),yA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"del"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return yA.default=e,yA}var bA={},RX;function hNe(){if(RX)return bA;RX=1,Object.defineProperty(bA,"__esModule",{value:!0}),bA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dialog"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","window"]]},e=n;return bA.default=e,bA}var SA={},AX;function dNe(){if(AX)return SA;AX=1,Object.defineProperty(SA,"__esModule",{value:!0}),SA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{module:"DAISY Guide"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","list"]]},e=n;return SA.default=e,SA}var EA={},CX;function pNe(){if(CX)return EA;CX=1,Object.defineProperty(EA,"__esModule",{value:!0}),EA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"Device Independence Delivery Unit"}},{concept:{name:"html"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return EA.default=e,EA}var xA={},MX;function mNe(){if(MX)return xA;MX=1,Object.defineProperty(xA,"__esModule",{value:!0}),xA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"em"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return xA.default=e,xA}var TA={},kX;function gNe(){if(kX)return TA;kX=1,Object.defineProperty(TA,"__esModule",{value:!0}),TA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["article"]],requiredProps:{},superClass:[["roletype","structure","section","list"]]},e=n;return TA.default=e,TA}var wA={},OX;function _Ne(){if(OX)return wA;OX=1,Object.defineProperty(wA,"__esModule",{value:!0}),wA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"figure"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return wA.default=e,wA}var RA={},IX;function vNe(){if(IX)return RA;IX=1,Object.defineProperty(RA,"__esModule",{value:!0}),RA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"form"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"name"}],name:"form"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return RA.default=e,RA}var AA={},NX;function yNe(){if(NX)return AA;NX=1,Object.defineProperty(AA,"__esModule",{value:!0}),AA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"a"},module:"HTML"},{concept:{name:"area"},module:"HTML"},{concept:{name:"aside"},module:"HTML"},{concept:{name:"b"},module:"HTML"},{concept:{name:"bdo"},module:"HTML"},{concept:{name:"body"},module:"HTML"},{concept:{name:"data"},module:"HTML"},{concept:{name:"div"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"footer"},module:"HTML"},{concept:{constraints:["scoped to the main element","scoped to a sectioning content element","scoped to a sectioning root element other than body"],name:"header"},module:"HTML"},{concept:{name:"hgroup"},module:"HTML"},{concept:{name:"i"},module:"HTML"},{concept:{name:"pre"},module:"HTML"},{concept:{name:"q"},module:"HTML"},{concept:{name:"samp"},module:"HTML"},{concept:{name:"section"},module:"HTML"},{concept:{name:"small"},module:"HTML"},{concept:{name:"span"},module:"HTML"},{concept:{name:"u"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return AA.default=e,AA}var CA={},PX;function bNe(){if(PX)return CA;PX=1,Object.defineProperty(CA,"__esModule",{value:!0}),CA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-multiselectable":null,"aria-readonly":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","structure","section","table"]]},e=n;return CA.default=e,CA}var MA={},DX;function SNe(){if(DX)return MA;DX=1,Object.defineProperty(MA,"__esModule",{value:!0}),MA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-selected":null},relatedConcepts:[{concept:{constraints:["ancestor table element has grid role","ancestor table element has treegrid role"],name:"td"},module:"HTML"}],requireContextRole:["row"],requiredContextRole:["row"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","widget"]]},e=n;return MA.default=e,MA}var kA={},LX;function ENe(){if(LX)return kA;LX=1,Object.defineProperty(kA,"__esModule",{value:!0}),kA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-disabled":null},relatedConcepts:[{concept:{name:"details"},module:"HTML"},{concept:{name:"fieldset"},module:"HTML"},{concept:{name:"optgroup"},module:"HTML"},{concept:{name:"address"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return kA.default=e,kA}var OA={},UX;function xNe(){if(UX)return OA;UX=1,Object.defineProperty(OA,"__esModule",{value:!0}),OA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-level":"2"},relatedConcepts:[{concept:{name:"h1"},module:"HTML"},{concept:{name:"h2"},module:"HTML"},{concept:{name:"h3"},module:"HTML"},{concept:{name:"h4"},module:"HTML"},{concept:{name:"h5"},module:"HTML"},{concept:{name:"h6"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-level":"2"},superClass:[["roletype","structure","sectionhead"]]},e=n;return OA.default=e,OA}var IA={},BX;function TNe(){if(BX)return IA;BX=1,Object.defineProperty(IA,"__esModule",{value:!0}),IA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"alt"}],name:"img"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"alt"}],name:"img"},module:"HTML"},{concept:{name:"imggroup"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return IA.default=e,IA}var NA={},FX;function wNe(){if(FX)return NA;FX=1,Object.defineProperty(NA,"__esModule",{value:!0}),NA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"ins"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return NA.default=e,NA}var PA={},zX;function RNe(){if(zX)return PA;zX=1,Object.defineProperty(PA,"__esModule",{value:!0}),PA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"href"}],name:"a"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"href"}],name:"area"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return PA.default=e,PA}var DA={},jX;function ANe(){if(jX)return DA;jX=1,Object.defineProperty(DA,"__esModule",{value:!0}),DA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menu"},module:"HTML"},{concept:{name:"ol"},module:"HTML"},{concept:{name:"ul"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["listitem"]],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return DA.default=e,DA}var LA={},HX;function CNe(){if(HX)return LA;HX=1,Object.defineProperty(LA,"__esModule",{value:!0}),LA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-invalid":null,"aria-multiselectable":null,"aria-readonly":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[{concept:{attributes:[{constraints:[">1"],name:"size"}],constraints:["the size attribute value is greater than 1"],name:"select"},module:"HTML"},{concept:{attributes:[{name:"multiple"}],name:"select"},module:"HTML"},{concept:{name:"datalist"},module:"HTML"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["option","group"],["option"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return LA.default=e,LA}var UA={},qX;function MNe(){if(qX)return UA;qX=1,Object.defineProperty(UA,"__esModule",{value:!0}),UA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{constraints:["direct descendant of ol","direct descendant of ul","direct descendant of menu"],name:"li"},module:"HTML"},{concept:{name:"item"},module:"XForms"}],requireContextRole:["directory","list"],requiredContextRole:["directory","list"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return UA.default=e,UA}var BA={},VX;function kNe(){if(VX)return BA;VX=1,Object.defineProperty(BA,"__esModule",{value:!0}),BA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-live":"polite"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return BA.default=e,BA}var FA={},GX;function ONe(){if(GX)return FA;GX=1,Object.defineProperty(FA,"__esModule",{value:!0}),FA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"main"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return FA.default=e,FA}var zA={},$X;function INe(){if($X)return zA;$X=1,Object.defineProperty(zA,"__esModule",{value:!0}),zA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:[],props:{"aria-braillelabel":null,"aria-brailleroledescription":null,"aria-description":null},relatedConcepts:[{concept:{name:"mark"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return zA.default=e,zA}var jA={},WX;function NNe(){if(WX)return jA;WX=1,Object.defineProperty(jA,"__esModule",{value:!0}),jA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return jA.default=e,jA}var HA={},YX;function PNe(){if(YX)return HA;YX=1,Object.defineProperty(HA,"__esModule",{value:!0}),HA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"math"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return HA.default=e,HA}var qA={},XX;function DNe(){if(XX)return qA;XX=1,Object.defineProperty(qA,"__esModule",{value:!0}),qA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"vertical"},relatedConcepts:[{concept:{name:"MENU"},module:"JAPI"},{concept:{name:"list"},module:"ARIA"},{concept:{name:"select"},module:"XForms"},{concept:{name:"sidebar"},module:"DTB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return qA.default=e,qA}var VA={},KX;function LNe(){if(KX)return VA;KX=1,Object.defineProperty(VA,"__esModule",{value:!0}),VA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"toolbar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["menuitem","group"],["menuitemradio","group"],["menuitemcheckbox","group"],["menuitem"],["menuitemcheckbox"],["menuitemradio"]],requiredProps:{},superClass:[["roletype","widget","composite","select","menu"],["roletype","structure","section","group","select","menu"]]},e=n;return VA.default=e,VA}var GA={},ZX;function UNe(){if(ZX)return GA;ZX=1,Object.defineProperty(GA,"__esModule",{value:!0}),GA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"MENU_ITEM"},module:"JAPI"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command"]]},e=n;return GA.default=e,GA}var $A={},QX;function BNe(){if(QX)return $A;QX=1,Object.defineProperty($A,"__esModule",{value:!0}),$A.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"],["roletype","widget","command","menuitem"]]},e=n;return $A.default=e,$A}var WA={},JX;function FNe(){if(JX)return WA;JX=1,Object.defineProperty(WA,"__esModule",{value:!0}),WA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"menuitem"},module:"ARIA"}],requireContextRole:["group","menu","menubar"],requiredContextRole:["group","menu","menubar"],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox","menuitemcheckbox"],["roletype","widget","command","menuitem","menuitemcheckbox"],["roletype","widget","input","radio"]]},e=n;return WA.default=e,WA}var YA={},eK;function zNe(){if(eK)return YA;eK=1,Object.defineProperty(YA,"__esModule",{value:!0}),YA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null,"aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{name:"meter"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","structure","range"]]},e=n;return YA.default=e,YA}var XA={},tK;function jNe(){if(tK)return XA;tK=1,Object.defineProperty(XA,"__esModule",{value:!0}),XA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"nav"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return XA.default=e,XA}var KA={},nK;function HNe(){if(nK)return KA;nK=1,Object.defineProperty(KA,"__esModule",{value:!0}),KA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:[],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[]},e=n;return KA.default=e,KA}var ZA={},rK;function qNe(){if(rK)return ZA;rK=1,Object.defineProperty(ZA,"__esModule",{value:!0}),ZA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return ZA.default=e,ZA}var QA={},iK;function VNe(){if(iK)return QA;iK=1,Object.defineProperty(QA,"__esModule",{value:!0}),QA.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[{concept:{name:"item"},module:"XForms"},{concept:{name:"listitem"},module:"ARIA"},{concept:{name:"option"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-selected":"false"},superClass:[["roletype","widget","input"]]},e=n;return QA.default=e,QA}var JA={},sK;function GNe(){if(sK)return JA;sK=1,Object.defineProperty(JA,"__esModule",{value:!0}),JA.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"p"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return JA.default=e,JA}var eC={},aK;function $Ne(){if(aK)return eC;aK=1,Object.defineProperty(eC,"__esModule",{value:!0}),eC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{attributes:[{name:"alt",value:""}],name:"img"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return eC.default=e,eC}var tC={},oK;function WNe(){if(oK)return tC;oK=1,Object.defineProperty(tC,"__esModule",{value:!0}),tC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-valuetext":null},relatedConcepts:[{concept:{name:"progress"},module:"HTML"},{concept:{name:"status"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","range"],["roletype","widget"]]},e=n;return tC.default=e,tC}var nC={},lK;function YNe(){if(lK)return nC;lK=1,Object.defineProperty(nC,"__esModule",{value:!0}),nC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-checked":null,"aria-posinset":null,"aria-setsize":null},relatedConcepts:[{concept:{attributes:[{name:"type",value:"radio"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input"]]},e=n;return nC.default=e,nC}var rC={},cK;function XNe(){if(cK)return rC;cK=1,Object.defineProperty(rC,"__esModule",{value:!0}),rC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{name:"list"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["radio"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return rC.default=e,rC}var iC={},uK;function KNe(){if(uK)return iC;uK=1,Object.defineProperty(iC,"__esModule",{value:!0}),iC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["set"],name:"aria-label"}],name:"section"},module:"HTML"},{concept:{attributes:[{constraints:["set"],name:"aria-labelledby"}],name:"section"},module:"HTML"},{concept:{name:"Device Independence Glossart perceivable unit"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return iC.default=e,iC}var sC={},fK;function ZNe(){if(fK)return sC;fK=1,Object.defineProperty(sC,"__esModule",{value:!0}),sC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-colindex":null,"aria-expanded":null,"aria-level":null,"aria-posinset":null,"aria-rowindex":null,"aria-selected":null,"aria-setsize":null},relatedConcepts:[{concept:{name:"tr"},module:"HTML"}],requireContextRole:["grid","rowgroup","table","treegrid"],requiredContextRole:["grid","rowgroup","table","treegrid"],requiredOwnedElements:[["cell"],["columnheader"],["gridcell"],["rowheader"]],requiredProps:{},superClass:[["roletype","structure","section","group"],["roletype","widget"]]},e=n;return sC.default=e,sC}var aC={},hK;function QNe(){if(hK)return aC;hK=1,Object.defineProperty(aC,"__esModule",{value:!0}),aC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"tbody"},module:"HTML"},{concept:{name:"tfoot"},module:"HTML"},{concept:{name:"thead"},module:"HTML"}],requireContextRole:["grid","table","treegrid"],requiredContextRole:["grid","table","treegrid"],requiredOwnedElements:[["row"]],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return aC.default=e,aC}var oC={},dK;function JNe(){if(dK)return oC;dK=1,Object.defineProperty(oC,"__esModule",{value:!0}),oC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-sort":null},relatedConcepts:[{concept:{attributes:[{name:"scope",value:"row"}],name:"th"},module:"HTML"},{concept:{attributes:[{name:"scope",value:"rowgroup"}],name:"th"},module:"HTML"}],requireContextRole:["row","rowgroup"],requiredContextRole:["row","rowgroup"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","cell"],["roletype","structure","section","cell","gridcell"],["roletype","widget","gridcell"],["roletype","structure","sectionhead"]]},e=n;return oC.default=e,oC}var lC={},pK;function ePe(){if(pK)return lC;pK=1,Object.defineProperty(lC,"__esModule",{value:!0}),lC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-valuetext":null,"aria-orientation":"vertical","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-controls":null,"aria-valuenow":null},superClass:[["roletype","structure","range"],["roletype","widget"]]},e=n;return lC.default=e,lC}var cC={},mK;function tPe(){if(mK)return cC;mK=1,Object.defineProperty(cC,"__esModule",{value:!0}),cC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return cC.default=e,cC}var uC={},gK;function nPe(){if(gK)return uC;gK=1,Object.defineProperty(uC,"__esModule",{value:!0}),uC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"search"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input","textbox"]]},e=n;return uC.default=e,uC}var fC={},_K;function rPe(){if(_K)return fC;_K=1,Object.defineProperty(fC,"__esModule",{value:!0}),fC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0","aria-valuenow":null,"aria-valuetext":null},relatedConcepts:[{concept:{name:"hr"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure"]]},e=n;return fC.default=e,fC}var hC={},vK;function iPe(){if(vK)return hC;vK=1,Object.defineProperty(hC,"__esModule",{value:!0}),hC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-readonly":null,"aria-valuetext":null,"aria-orientation":"horizontal","aria-valuemax":"100","aria-valuemin":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"range"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-valuenow":null},superClass:[["roletype","widget","input"],["roletype","structure","range"]]},e=n;return hC.default=e,hC}var dC={},yK;function sPe(){if(yK)return dC;yK=1,Object.defineProperty(dC,"__esModule",{value:!0}),dC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-readonly":null,"aria-required":null,"aria-valuetext":null,"aria-valuenow":"0"},relatedConcepts:[{concept:{attributes:[{name:"type",value:"number"}],name:"input"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","composite"],["roletype","widget","input"],["roletype","structure","range"]]},e=n;return dC.default=e,dC}var pC={},bK;function aPe(){if(bK)return pC;bK=1,Object.defineProperty(pC,"__esModule",{value:!0}),pC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-atomic":"true","aria-live":"polite"},relatedConcepts:[{concept:{name:"output"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return pC.default=e,pC}var mC={},SK;function oPe(){if(SK)return mC;SK=1,Object.defineProperty(mC,"__esModule",{value:!0}),mC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"strong"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return mC.default=e,mC}var gC={},EK;function lPe(){if(EK)return gC;EK=1,Object.defineProperty(gC,"__esModule",{value:!0}),gC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sub"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return gC.default=e,gC}var _C={},xK;function cPe(){if(xK)return _C;xK=1,Object.defineProperty(_C,"__esModule",{value:!0}),_C.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["prohibited"],prohibitedProps:["aria-label","aria-labelledby"],props:{},relatedConcepts:[{concept:{name:"sup"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return _C.default=e,_C}var vC={},TK;function uPe(){if(TK)return vC;TK=1,Object.defineProperty(vC,"__esModule",{value:!0}),vC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"button"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{"aria-checked":null},superClass:[["roletype","widget","input","checkbox"]]},e=n;return vC.default=e,vC}var yC={},wK;function fPe(){if(wK)return yC;wK=1,Object.defineProperty(yC,"__esModule",{value:!0}),yC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!0,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-disabled":null,"aria-expanded":null,"aria-haspopup":null,"aria-posinset":null,"aria-setsize":null,"aria-selected":"false"},relatedConcepts:[],requireContextRole:["tablist"],requiredContextRole:["tablist"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"],["roletype","widget"]]},e=n;return yC.default=e,yC}var bC={},RK;function hPe(){if(RK)return bC;RK=1,Object.defineProperty(bC,"__esModule",{value:!0}),bC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-colcount":null,"aria-rowcount":null},relatedConcepts:[{concept:{name:"table"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return bC.default=e,bC}var SC={},AK;function dPe(){if(AK)return SC;AK=1,Object.defineProperty(SC,"__esModule",{value:!0}),SC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-level":null,"aria-multiselectable":null,"aria-orientation":"horizontal"},relatedConcepts:[{module:"DAISY",concept:{name:"guide"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["tab"]],requiredProps:{},superClass:[["roletype","widget","composite"]]},e=n;return SC.default=e,SC}var EC={},CK;function pPe(){if(CK)return EC;CK=1,Object.defineProperty(EC,"__esModule",{value:!0}),EC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return EC.default=e,EC}var xC={},MK;function mPe(){if(MK)return xC;MK=1,Object.defineProperty(xC,"__esModule",{value:!0}),xC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"dfn"},module:"HTML"},{concept:{name:"dt"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return xC.default=e,xC}var TC={},kK;function gPe(){if(kK)return TC;kK=1,Object.defineProperty(TC,"__esModule",{value:!0}),TC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-activedescendant":null,"aria-autocomplete":null,"aria-errormessage":null,"aria-haspopup":null,"aria-invalid":null,"aria-multiline":null,"aria-placeholder":null,"aria-readonly":null,"aria-required":null},relatedConcepts:[{concept:{attributes:[{constraints:["undefined"],name:"type"},{constraints:["undefined"],name:"list"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"email"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"tel"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"text"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{attributes:[{constraints:["undefined"],name:"list"},{name:"type",value:"url"}],constraints:["the list attribute is not set"],name:"input"},module:"HTML"},{concept:{name:"input"},module:"XForms"},{concept:{name:"textarea"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","input"]]},e=n;return TC.default=e,TC}var wC={},OK;function _Pe(){if(OK)return wC;OK=1,Object.defineProperty(wC,"__esModule",{value:!0}),wC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"time"},module:"HTML"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return wC.default=e,wC}var RC={},IK;function vPe(){if(IK)return RC;IK=1,Object.defineProperty(RC,"__esModule",{value:!0}),RC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","status"]]},e=n;return RC.default=e,RC}var AC={},NK;function yPe(){if(NK)return AC;NK=1,Object.defineProperty(AC,"__esModule",{value:!0}),AC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-orientation":"horizontal"},relatedConcepts:[{concept:{name:"menubar"},module:"ARIA"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},e=n;return AC.default=e,AC}var CC={},PK;function bPe(){if(PK)return CC;PK=1,Object.defineProperty(CC,"__esModule",{value:!0}),CC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return CC.default=e,CC}var MC={},DK;function SPe(){if(DK)return MC;DK=1,Object.defineProperty(MC,"__esModule",{value:!0}),MC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null,"aria-multiselectable":null,"aria-required":null,"aria-orientation":"vertical"},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["treeitem","group"],["treeitem"]],requiredProps:{},superClass:[["roletype","widget","composite","select"],["roletype","structure","section","group","select"]]},e=n;return MC.default=e,MC}var kC={},LK;function EPe(){if(LK)return kC;LK=1,Object.defineProperty(kC,"__esModule",{value:!0}),kC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["row"],["row","rowgroup"]],requiredProps:{},superClass:[["roletype","widget","composite","grid"],["roletype","structure","section","table","grid"],["roletype","widget","composite","select","tree"],["roletype","structure","section","group","select","tree"]]},e=n;return kC.default=e,kC}var OC={},UK;function xPe(){if(UK)return OC;UK=1,Object.defineProperty(OC,"__esModule",{value:!0}),OC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-expanded":null,"aria-haspopup":null},relatedConcepts:[],requireContextRole:["group","tree"],requiredContextRole:["group","tree"],requiredOwnedElements:[],requiredProps:{"aria-selected":null},superClass:[["roletype","structure","section","listitem"],["roletype","widget","input","option"]]},e=n;return OC.default=e,OC}var BK;function TPe(){if(BK)return nA;BK=1,Object.defineProperty(nA,"__esModule",{value:!0}),nA.default=void 0;var n=ft(XIe()),e=ft(KIe()),t=ft(ZIe()),r=ft(QIe()),i=ft(JIe()),s=ft(eNe()),a=ft(tNe()),o=ft(nNe()),l=ft(rNe()),c=ft(iNe()),u=ft(sNe()),f=ft(aNe()),d=ft(oNe()),g=ft(lNe()),p=ft(cNe()),_=ft(uNe()),y=ft(fNe()),v=ft(hNe()),x=ft(dNe()),E=ft(pNe()),M=ft(mNe()),O=ft(gNe()),N=ft(_Ne()),I=ft(vNe()),D=ft(yNe()),V=ft(bNe()),G=ft(SNe()),Q=ft(ENe()),B=ft(xNe()),$=ft(TNe()),U=ft(wNe()),J=ft(RNe()),W=ft(ANe()),q=ft(CNe()),Y=ft(MNe()),ae=ft(kNe()),Z=ft(ONe()),K=ft(INe()),ne=ft(NNe()),le=ft(PNe()),ce=ft(DNe()),de=ft(LNe()),Me=ft(UNe()),qe=ft(BNe()),Pe=ft(FNe()),Ce=ft(zNe()),Xe=ft(jNe()),$e=ft(HNe()),at=ft(qNe()),pt=ft(VNe()),oe=ft(GNe()),Ue=ft($Ne()),Ge=ft(WNe()),ze=ft(YNe()),Be=ft(XNe()),me=ft(KNe()),Se=ft(ZNe()),Ie=ft(QNe()),be=ft(JNe()),Ke=ft(ePe()),ot=ft(tPe()),lt=ft(nPe()),ct=ft(rPe()),Vt=ft(iPe()),kt=ft(sPe()),Ut=ft(aPe()),je=ft(oPe()),ge=ft(lPe()),se=ft(cPe()),_e=ft(uPe()),Ne=ft(fPe()),Le=ft(hPe()),ke=ft(dPe()),Re=ft(pPe()),st=ft(mPe()),Ve=ft(gPe()),tt=ft(_Pe()),Ze=ft(vPe()),nt=ft(yPe()),vt=ft(bPe()),Qe=ft(SPe()),ht=ft(EPe()),mt=ft(xPe());function ft(_n){return _n&&_n.__esModule?_n:{default:_n}}var _t=[["alert",n.default],["alertdialog",e.default],["application",t.default],["article",r.default],["banner",i.default],["blockquote",s.default],["button",a.default],["caption",o.default],["cell",l.default],["checkbox",c.default],["code",u.default],["columnheader",f.default],["combobox",d.default],["complementary",g.default],["contentinfo",p.default],["definition",_.default],["deletion",y.default],["dialog",v.default],["directory",x.default],["document",E.default],["emphasis",M.default],["feed",O.default],["figure",N.default],["form",I.default],["generic",D.default],["grid",V.default],["gridcell",G.default],["group",Q.default],["heading",B.default],["img",$.default],["insertion",U.default],["link",J.default],["list",W.default],["listbox",q.default],["listitem",Y.default],["log",ae.default],["main",Z.default],["mark",K.default],["marquee",ne.default],["math",le.default],["menu",ce.default],["menubar",de.default],["menuitem",Me.default],["menuitemcheckbox",qe.default],["menuitemradio",Pe.default],["meter",Ce.default],["navigation",Xe.default],["none",$e.default],["note",at.default],["option",pt.default],["paragraph",oe.default],["presentation",Ue.default],["progressbar",Ge.default],["radio",ze.default],["radiogroup",Be.default],["region",me.default],["row",Se.default],["rowgroup",Ie.default],["rowheader",be.default],["scrollbar",Ke.default],["search",ot.default],["searchbox",lt.default],["separator",ct.default],["slider",Vt.default],["spinbutton",kt.default],["status",Ut.default],["strong",je.default],["subscript",ge.default],["superscript",se.default],["switch",_e.default],["tab",Ne.default],["table",Le.default],["tablist",ke.default],["tabpanel",Re.default],["term",st.default],["textbox",Ve.default],["time",tt.default],["timer",Ze.default],["toolbar",nt.default],["tooltip",vt.default],["tree",Qe.default],["treegrid",ht.default],["treeitem",mt.default]],gn=_t;return nA.default=gn,nA}var IC={},NC={},FK;function wPe(){if(FK)return NC;FK=1,Object.defineProperty(NC,"__esModule",{value:!0}),NC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"abstract [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return NC.default=e,NC}var PC={},zK;function RPe(){if(zK)return PC;zK=1,Object.defineProperty(PC,"__esModule",{value:!0}),PC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"acknowledgments [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return PC.default=e,PC}var DC={},jK;function APe(){if(jK)return DC;jK=1,Object.defineProperty(DC,"__esModule",{value:!0}),DC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"afterword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return DC.default=e,DC}var LC={},HK;function CPe(){if(HK)return LC;HK=1,Object.defineProperty(LC,"__esModule",{value:!0}),LC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"appendix [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return LC.default=e,LC}var UC={},qK;function MPe(){if(qK)return UC;qK=1,Object.defineProperty(UC,"__esModule",{value:!0}),UC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"referrer [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return UC.default=e,UC}var BC={},VK;function kPe(){if(VK)return BC;VK=1,Object.defineProperty(BC,"__esModule",{value:!0}),BC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"EPUB biblioentry [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-bibliography"],requiredContextRole:["doc-bibliography"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},e=n;return BC.default=e,BC}var FC={},GK;function OPe(){if(GK)return FC;GK=1,Object.defineProperty(FC,"__esModule",{value:!0}),FC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"bibliography [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-biblioentry"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return FC.default=e,FC}var zC={},$K;function IPe(){if($K)return zC;$K=1,Object.defineProperty(zC,"__esModule",{value:!0}),zC.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"biblioref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return zC.default=e,zC}var jC={},WK;function NPe(){if(WK)return jC;WK=1,Object.defineProperty(jC,"__esModule",{value:!0}),jC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"chapter [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return jC.default=e,jC}var HC={},YK;function PPe(){if(YK)return HC;YK=1,Object.defineProperty(HC,"__esModule",{value:!0}),HC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"colophon [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return HC.default=e,HC}var qC={},XK;function DPe(){if(XK)return qC;XK=1,Object.defineProperty(qC,"__esModule",{value:!0}),qC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"conclusion [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return qC.default=e,qC}var VC={},KK;function LPe(){if(KK)return VC;KK=1,Object.defineProperty(VC,"__esModule",{value:!0}),VC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"cover [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},e=n;return VC.default=e,VC}var GC={},ZK;function UPe(){if(ZK)return GC;ZK=1,Object.defineProperty(GC,"__esModule",{value:!0}),GC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credit [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return GC.default=e,GC}var $C={},QK;function BPe(){if(QK)return $C;QK=1,Object.defineProperty($C,"__esModule",{value:!0}),$C.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"credits [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return $C.default=e,$C}var WC={},JK;function FPe(){if(JK)return WC;JK=1,Object.defineProperty(WC,"__esModule",{value:!0}),WC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"dedication [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return WC.default=e,WC}var YC={},eZ;function zPe(){if(eZ)return YC;eZ=1,Object.defineProperty(YC,"__esModule",{value:!0}),YC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:["doc-endnotes"],requiredContextRole:["doc-endnotes"],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","listitem"]]},e=n;return YC.default=e,YC}var XC={},tZ;function jPe(){if(tZ)return XC;tZ=1,Object.defineProperty(XC,"__esModule",{value:!0}),XC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"rearnotes [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["doc-endnote"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return XC.default=e,XC}var KC={},nZ;function HPe(){if(nZ)return KC;nZ=1,Object.defineProperty(KC,"__esModule",{value:!0}),KC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epigraph [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return KC.default=e,KC}var ZC={},rZ;function qPe(){if(rZ)return ZC;rZ=1,Object.defineProperty(ZC,"__esModule",{value:!0}),ZC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"epilogue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return ZC.default=e,ZC}var QC={},iZ;function VPe(){if(iZ)return QC;iZ=1,Object.defineProperty(QC,"__esModule",{value:!0}),QC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"errata [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return QC.default=e,QC}var JC={},sZ;function GPe(){if(sZ)return JC;sZ=1,Object.defineProperty(JC,"__esModule",{value:!0}),JC.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return JC.default=e,JC}var eM={},aZ;function $Pe(){if(aZ)return eM;aZ=1,Object.defineProperty(eM,"__esModule",{value:!0}),eM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"footnote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return eM.default=e,eM}var tM={},oZ;function WPe(){if(oZ)return tM;oZ=1,Object.defineProperty(tM,"__esModule",{value:!0}),tM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"foreword [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return tM.default=e,tM}var nM={},lZ;function YPe(){if(lZ)return nM;lZ=1,Object.defineProperty(nM,"__esModule",{value:!0}),nM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossary [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[["definition"],["term"]],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return nM.default=e,nM}var rM={},cZ;function XPe(){if(cZ)return rM;cZ=1,Object.defineProperty(rM,"__esModule",{value:!0}),rM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"glossref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return rM.default=e,rM}var iM={},uZ;function KPe(){if(uZ)return iM;uZ=1,Object.defineProperty(iM,"__esModule",{value:!0}),iM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"index [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return iM.default=e,iM}var sM={},fZ;function ZPe(){if(fZ)return sM;fZ=1,Object.defineProperty(sM,"__esModule",{value:!0}),sM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"introduction [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return sM.default=e,sM}var aM={},hZ;function QPe(){if(hZ)return aM;hZ=1,Object.defineProperty(aM,"__esModule",{value:!0}),aM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"noteref [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","widget","command","link"]]},e=n;return aM.default=e,aM}var oM={},dZ;function JPe(){if(dZ)return oM;dZ=1,Object.defineProperty(oM,"__esModule",{value:!0}),oM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"notice [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},e=n;return oM.default=e,oM}var lM={},pZ;function eDe(){if(pZ)return lM;pZ=1,Object.defineProperty(lM,"__esModule",{value:!0}),lM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"pagebreak [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","separator"]]},e=n;return lM.default=e,lM}var cM={},mZ;function tDe(){if(mZ)return cM;mZ=1,Object.defineProperty(cM,"__esModule",{value:!0}),cM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"page-list [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return cM.default=e,cM}var uM={},gZ;function nDe(){if(gZ)return uM;gZ=1,Object.defineProperty(uM,"__esModule",{value:!0}),uM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"part [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return uM.default=e,uM}var fM={},_Z;function rDe(){if(_Z)return fM;_Z=1,Object.defineProperty(fM,"__esModule",{value:!0}),fM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"preface [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return fM.default=e,fM}var hM={},vZ;function iDe(){if(vZ)return hM;vZ=1,Object.defineProperty(hM,"__esModule",{value:!0}),hM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"prologue [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark"]]},e=n;return hM.default=e,hM}var dM={},yZ;function sDe(){if(yZ)return dM;yZ=1,Object.defineProperty(dM,"__esModule",{value:!0}),dM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{},relatedConcepts:[{concept:{name:"pullquote [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["none"]]},e=n;return dM.default=e,dM}var pM={},bZ;function aDe(){if(bZ)return pM;bZ=1,Object.defineProperty(pM,"__esModule",{value:!0}),pM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"qna [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section"]]},e=n;return pM.default=e,pM}var mM={},SZ;function oDe(){if(SZ)return mM;SZ=1,Object.defineProperty(mM,"__esModule",{value:!0}),mM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"subtitle [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","sectionhead"]]},e=n;return mM.default=e,mM}var gM={},EZ;function lDe(){if(EZ)return gM;EZ=1,Object.defineProperty(gM,"__esModule",{value:!0}),gM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"help [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","note"]]},e=n;return gM.default=e,gM}var _M={},xZ;function cDe(){if(xZ)return _M;xZ=1,Object.defineProperty(_M,"__esModule",{value:!0}),_M.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{concept:{name:"toc [EPUB-SSV]"},module:"EPUB"}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","landmark","navigation"]]},e=n;return _M.default=e,_M}var TZ;function uDe(){if(TZ)return IC;TZ=1,Object.defineProperty(IC,"__esModule",{value:!0}),IC.default=void 0;var n=le(wPe()),e=le(RPe()),t=le(APe()),r=le(CPe()),i=le(MPe()),s=le(kPe()),a=le(OPe()),o=le(IPe()),l=le(NPe()),c=le(PPe()),u=le(DPe()),f=le(LPe()),d=le(UPe()),g=le(BPe()),p=le(FPe()),_=le(zPe()),y=le(jPe()),v=le(HPe()),x=le(qPe()),E=le(VPe()),M=le(GPe()),O=le($Pe()),N=le(WPe()),I=le(YPe()),D=le(XPe()),V=le(KPe()),G=le(ZPe()),Q=le(QPe()),B=le(JPe()),$=le(eDe()),U=le(tDe()),J=le(nDe()),W=le(rDe()),q=le(iDe()),Y=le(sDe()),ae=le(aDe()),Z=le(oDe()),K=le(lDe()),ne=le(cDe());function le(Me){return Me&&Me.__esModule?Me:{default:Me}}var ce=[["doc-abstract",n.default],["doc-acknowledgments",e.default],["doc-afterword",t.default],["doc-appendix",r.default],["doc-backlink",i.default],["doc-biblioentry",s.default],["doc-bibliography",a.default],["doc-biblioref",o.default],["doc-chapter",l.default],["doc-colophon",c.default],["doc-conclusion",u.default],["doc-cover",f.default],["doc-credit",d.default],["doc-credits",g.default],["doc-dedication",p.default],["doc-endnote",_.default],["doc-endnotes",y.default],["doc-epigraph",v.default],["doc-epilogue",x.default],["doc-errata",E.default],["doc-example",M.default],["doc-footnote",O.default],["doc-foreword",N.default],["doc-glossary",I.default],["doc-glossref",D.default],["doc-index",V.default],["doc-introduction",G.default],["doc-noteref",Q.default],["doc-notice",B.default],["doc-pagebreak",$.default],["doc-pagelist",U.default],["doc-part",J.default],["doc-preface",W.default],["doc-prologue",q.default],["doc-pullquote",Y.default],["doc-qna",ae.default],["doc-subtitle",Z.default],["doc-tip",K.default],["doc-toc",ne.default]],de=ce;return IC.default=de,IC}var vM={},yM={},wZ;function fDe(){if(wZ)return yM;wZ=1,Object.defineProperty(yM,"__esModule",{value:!0}),yM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!1,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-object"}},{module:"ARIA",concept:{name:"img"}},{module:"ARIA",concept:{name:"article"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","document"]]},e=n;return yM.default=e,yM}var bM={},RZ;function hDe(){if(RZ)return bM;RZ=1,Object.defineProperty(bM,"__esModule",{value:!0}),bM.default=void 0;var n={abstract:!1,accessibleNameRequired:!1,baseConcepts:[],childrenPresentational:!1,nameFrom:["author","contents"],prohibitedProps:[],props:{"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[{module:"GRAPHICS",concept:{name:"graphics-document"}},{module:"ARIA",concept:{name:"group"}},{module:"ARIA",concept:{name:"img"}},{module:"GRAPHICS",concept:{name:"graphics-symbol"}}],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","group"]]},e=n;return bM.default=e,bM}var SM={},AZ;function dDe(){if(AZ)return SM;AZ=1,Object.defineProperty(SM,"__esModule",{value:!0}),SM.default=void 0;var n={abstract:!1,accessibleNameRequired:!0,baseConcepts:[],childrenPresentational:!0,nameFrom:["author"],prohibitedProps:[],props:{"aria-disabled":null,"aria-errormessage":null,"aria-expanded":null,"aria-haspopup":null,"aria-invalid":null},relatedConcepts:[],requireContextRole:[],requiredContextRole:[],requiredOwnedElements:[],requiredProps:{},superClass:[["roletype","structure","section","img"]]},e=n;return SM.default=e,SM}var CZ;function pDe(){if(CZ)return vM;CZ=1,Object.defineProperty(vM,"__esModule",{value:!0}),vM.default=void 0;var n=r(fDe()),e=r(hDe()),t=r(dDe());function r(a){return a&&a.__esModule?a:{default:a}}var i=[["graphics-document",n.default],["graphics-object",e.default],["graphics-symbol",t.default]],s=i;return vM.default=s,vM}var MZ;function _j(){if(MZ)return HR;MZ=1,Object.defineProperty(HR,"__esModule",{value:!0}),HR.default=void 0;var n=s(YIe()),e=s(TPe()),t=s(uDe()),r=s(pDe()),i=s(lO());function s(v){return v&&v.__esModule?v:{default:v}}function a(v,x,E){return x in v?Object.defineProperty(v,x,{value:E,enumerable:!0,configurable:!0,writable:!0}):v[x]=E,v}function o(v,x){var E=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!E){if(Array.isArray(v)||(E=u(v))||x){E&&(v=E);var M=0,O=function(){};return{s:O,n:function(){return M>=v.length?{done:!0}:{done:!1,value:v[M++]}},e:function(G){throw G},f:O}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var N=!0,I=!1,D;return{s:function(){E=E.call(v)},n:function(){var G=E.next();return N=G.done,G},e:function(G){I=!0,D=G},f:function(){try{!N&&E.return!=null&&E.return()}finally{if(I)throw D}}}}function l(v,x){return g(v)||d(v,x)||u(v,x)||c()}function c(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function u(v,x){if(v){if(typeof v=="string")return f(v,x);var E=Object.prototype.toString.call(v).slice(8,-1);if(E==="Object"&&v.constructor&&(E=v.constructor.name),E==="Map"||E==="Set")return Array.from(v);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return f(v,x)}}function f(v,x){(x==null||x>v.length)&&(x=v.length);for(var E=0,M=new Array(x);E<x;E++)M[E]=v[E];return M}function d(v,x){var E=v==null?null:typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(E!=null){var M=[],O=!0,N=!1,I,D;try{for(E=E.call(v);!(O=(I=E.next()).done)&&(M.push(I.value),!(x&&M.length===x));O=!0);}catch(V){N=!0,D=V}finally{try{!O&&E.return!=null&&E.return()}finally{if(N)throw D}}return M}}function g(v){if(Array.isArray(v))return v}var p=[].concat(n.default,e.default,t.default,r.default);p.forEach(function(v){var x=l(v,2),E=x[1],M=o(E.superClass),O;try{for(M.s();!(O=M.n()).done;){var N=O.value,I=o(N),D;try{var V=function(){var Q=D.value,B=p.find(function(q){var Y=l(q,1),ae=Y[0];return ae===Q});if(B)for(var $=B[1],U=0,J=Object.keys($.props);U<J.length;U++){var W=J[U];Object.prototype.hasOwnProperty.call(E.props,W)||Object.assign(E.props,a({},W,$.props[W]))}};for(I.s();!(D=I.n()).done;)V()}catch(G){I.e(G)}finally{I.f()}}}catch(G){M.e(G)}finally{M.f()}});var _={entries:function(){return p},forEach:function(x){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,M=o(p),O;try{for(M.s();!(O=M.n()).done;){var N=l(O.value,2),I=N[0],D=N[1];x.call(E,D,I,p)}}catch(V){M.e(V)}finally{M.f()}},get:function(x){var E=p.find(function(M){return M[0]===x});return E&&E[1]},has:function(x){return!!_.get(x)},keys:function(){return p.map(function(x){var E=l(x,1),M=E[0];return M})},values:function(){return p.map(function(x){var E=l(x,2),M=E[1];return M})}},y=(0,i.default)(_,_.entries());return HR.default=y,HR}var EM={},rB={},kZ;function mDe(){if(kZ)return rB;kZ=1;var n=Object.prototype.hasOwnProperty;function e(t,r){var i,s;if(t===r)return!0;if(t&&r&&(i=t.constructor)===r.constructor){if(i===Date)return t.getTime()===r.getTime();if(i===RegExp)return t.toString()===r.toString();if(i===Array){if((s=t.length)===r.length)for(;s--&&e(t[s],r[s]););return s===-1}if(!i||typeof t=="object"){s=0;for(i in t)if(n.call(t,i)&&++s&&!n.call(r,i)||!(i in r)||!e(t[i],r[i]))return!1;return Object.keys(r).length===s}}return t!==t&&r!==r}return rB.dequal=e,rB}var OZ;function gDe(){if(OZ)return EM;OZ=1,Object.defineProperty(EM,"__esModule",{value:!0}),EM.default=void 0;var n=mDe(),e=r(lO()),t=r(_j());function r(O){return O&&O.__esModule?O:{default:O}}function i(O,N){return o(O)||a(O,N)||c(O,N)||s()}function s(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function a(O,N){var I=O==null?null:typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(I!=null){var D=[],V=!0,G=!1,Q,B;try{for(I=I.call(O);!(V=(Q=I.next()).done)&&(D.push(Q.value),!(N&&D.length===N));V=!0);}catch($){G=!0,B=$}finally{try{!V&&I.return!=null&&I.return()}finally{if(G)throw B}}return D}}function o(O){if(Array.isArray(O))return O}function l(O,N){var I=typeof Symbol<"u"&&O[Symbol.iterator]||O["@@iterator"];if(!I){if(Array.isArray(O)||(I=c(O))||N){I&&(O=I);var D=0,V=function(){};return{s:V,n:function(){return D>=O.length?{done:!0}:{done:!1,value:O[D++]}},e:function(U){throw U},f:V}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var G=!0,Q=!1,B;return{s:function(){I=I.call(O)},n:function(){var U=I.next();return G=U.done,U},e:function(U){Q=!0,B=U},f:function(){try{!G&&I.return!=null&&I.return()}finally{if(Q)throw B}}}}function c(O,N){if(O){if(typeof O=="string")return u(O,N);var I=Object.prototype.toString.call(O).slice(8,-1);if(I==="Object"&&O.constructor&&(I=O.constructor.name),I==="Map"||I==="Set")return Array.from(O);if(I==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(I))return u(O,N)}}function u(O,N){(N==null||N>O.length)&&(N=O.length);for(var I=0,D=new Array(N);I<N;I++)D[I]=O[I];return D}for(var f=[],d=t.default.keys(),g=0;g<d.length;g++){var p=d[g],_=t.default.get(p);if(_)for(var y=[].concat(_.baseConcepts,_.relatedConcepts),v=0;v<y.length;v++){var x=y[v];x.module==="HTML"&&(function(){var O=x.concept;if(O){var N=f.find(function(G){return(0,n.dequal)(G,O)}),I;N?I=N[1]:I=[];for(var D=!0,V=0;V<I.length;V++)if(I[V]===p){D=!1;break}D&&I.push(p),f.push([O,I])}})()}}var E={entries:function(){return f},forEach:function(N){var I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,D=l(f),V;try{for(D.s();!(V=D.n()).done;){var G=i(V.value,2),Q=G[0],B=G[1];N.call(I,B,Q,f)}}catch($){D.e($)}finally{D.f()}},get:function(N){var I=f.find(function(D){return N.name===D[0].name&&(0,n.dequal)(N.attributes,D[0].attributes)});return I&&I[1]},has:function(N){return!!E.get(N)},keys:function(){return f.map(function(N){var I=i(N,1),D=I[0];return D})},values:function(){return f.map(function(N){var I=i(N,2),D=I[1];return D})}},M=(0,e.default)(E,E.entries());return EM.default=M,EM}var xM={},IZ;function _De(){if(IZ)return xM;IZ=1,Object.defineProperty(xM,"__esModule",{value:!0}),xM.default=void 0;var n=t(lO()),e=t(_j());function t(N){return N&&N.__esModule?N:{default:N}}function r(N,I){return a(N)||s(N,I)||l(N,I)||i()}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function s(N,I){var D=N==null?null:typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(D!=null){var V=[],G=!0,Q=!1,B,$;try{for(D=D.call(N);!(G=(B=D.next()).done)&&(V.push(B.value),!(I&&V.length===I));G=!0);}catch(U){Q=!0,$=U}finally{try{!G&&D.return!=null&&D.return()}finally{if(Q)throw $}}return V}}function a(N){if(Array.isArray(N))return N}function o(N,I){var D=typeof Symbol<"u"&&N[Symbol.iterator]||N["@@iterator"];if(!D){if(Array.isArray(N)||(D=l(N))||I){D&&(N=D);var V=0,G=function(){};return{s:G,n:function(){return V>=N.length?{done:!0}:{done:!1,value:N[V++]}},e:function(J){throw J},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Q=!0,B=!1,$;return{s:function(){D=D.call(N)},n:function(){var J=D.next();return Q=J.done,J},e:function(J){B=!0,$=J},f:function(){try{!Q&&D.return!=null&&D.return()}finally{if(B)throw $}}}}function l(N,I){if(N){if(typeof N=="string")return c(N,I);var D=Object.prototype.toString.call(N).slice(8,-1);if(D==="Object"&&N.constructor&&(D=N.constructor.name),D==="Map"||D==="Set")return Array.from(N);if(D==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(D))return c(N,I)}}function c(N,I){(I==null||I>N.length)&&(I=N.length);for(var D=0,V=new Array(I);D<I;D++)V[D]=N[D];return V}for(var u=[],f=e.default.keys(),d=0;d<f.length;d++){var g=f[d],p=e.default.get(g),_=[];if(p){for(var y=[].concat(p.baseConcepts,p.relatedConcepts),v=0;v<y.length;v++){var x=y[v];if(x.module==="HTML"){var E=x.concept;E!=null&&_.push(E)}}_.length>0&&u.push([g,_])}}var M={entries:function(){return u},forEach:function(I){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,V=o(u),G;try{for(V.s();!(G=V.n()).done;){var Q=r(G.value,2),B=Q[0],$=Q[1];I.call(D,$,B,u)}}catch(U){V.e(U)}finally{V.f()}},get:function(I){var D=u.find(function(V){return V[0]===I});return D&&D[1]},has:function(I){return!!M.get(I)},keys:function(){return u.map(function(I){var D=r(I,1),V=D[0];return V})},values:function(){return u.map(function(I){var D=r(I,2),V=D[1];return V})}},O=(0,n.default)(M,M.entries());return xM.default=O,xM}var NZ;function vDe(){if(NZ)return Sg;NZ=1,Object.defineProperty(Sg,"__esModule",{value:!0}),Sg.roles=Sg.roleElements=Sg.elementRoles=Sg.dom=Sg.aria=void 0;var n=s(PIe()),e=s(DIe()),t=s(_j()),r=s(gDe()),i=s(_De());function s(f){return f&&f.__esModule?f:{default:f}}var a=n.default;Sg.aria=a;var o=e.default;Sg.dom=o;var l=t.default;Sg.roles=l;var c=r.default;Sg.elementRoles=c;var u=i.default;return Sg.roleElements=u,Sg}var _0=vDe(),iB={exports:{}},PZ;function yDe(){return PZ||(PZ=1,(function(n){var e=(function(){var t=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",s={};function a(l,c){if(!s[l]){s[l]={};for(var u=0;u<l.length;u++)s[l][l.charAt(u)]=u}return s[l][c]}var o={compressToBase64:function(l){if(l==null)return"";var c=o._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:o._decompress(l.length,32,function(c){return a(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":o._compress(l,15,function(c){return t(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:o._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=o.compress(l),u=new Uint8Array(c.length*2),f=0,d=c.length;f<d;f++){var g=c.charCodeAt(f);u[f*2]=g>>>8,u[f*2+1]=g%256}return u},decompressFromUint8Array:function(l){if(l==null)return o.decompress(l);for(var c=new Array(l.length/2),u=0,f=c.length;u<f;u++)c[u]=l[u*2]*256+l[u*2+1];var d=[];return c.forEach(function(g){d.push(t(g))}),o.decompress(d.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":o._compress(l,6,function(c){return i.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),o._decompress(l.length,32,function(c){return a(i,l.charAt(c))}))},compress:function(l){return o._compress(l,16,function(c){return t(c)})},_compress:function(l,c,u){if(l==null)return"";var f,d,g={},p={},_="",y="",v="",x=2,E=3,M=2,O=[],N=0,I=0,D;for(D=0;D<l.length;D+=1)if(_=l.charAt(D),Object.prototype.hasOwnProperty.call(g,_)||(g[_]=E++,p[_]=!0),y=v+_,Object.prototype.hasOwnProperty.call(g,y))v=y;else{if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(f=0;f<M;f++)N=N<<1,I==c-1?(I=0,O.push(u(N)),N=0):I++;for(d=v.charCodeAt(0),f=0;f<8;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1}else{for(d=1,f=0;f<M;f++)N=N<<1|d,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=0;for(d=v.charCodeAt(0),f=0;f<16;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1}x--,x==0&&(x=Math.pow(2,M),M++),delete p[v]}else for(d=g[v],f=0;f<M;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1;x--,x==0&&(x=Math.pow(2,M),M++),g[y]=E++,v=String(_)}if(v!==""){if(Object.prototype.hasOwnProperty.call(p,v)){if(v.charCodeAt(0)<256){for(f=0;f<M;f++)N=N<<1,I==c-1?(I=0,O.push(u(N)),N=0):I++;for(d=v.charCodeAt(0),f=0;f<8;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1}else{for(d=1,f=0;f<M;f++)N=N<<1|d,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=0;for(d=v.charCodeAt(0),f=0;f<16;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1}x--,x==0&&(x=Math.pow(2,M),M++),delete p[v]}else for(d=g[v],f=0;f<M;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1;x--,x==0&&(x=Math.pow(2,M),M++)}for(d=2,f=0;f<M;f++)N=N<<1|d&1,I==c-1?(I=0,O.push(u(N)),N=0):I++,d=d>>1;for(;;)if(N=N<<1,I==c-1){O.push(u(N));break}else I++;return O.join("")},decompress:function(l){return l==null?"":l==""?null:o._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var f=[],d=4,g=4,p=3,_="",y=[],v,x,E,M,O,N,I,D={val:u(0),position:c,index:1};for(v=0;v<3;v+=1)f[v]=v;for(E=0,O=Math.pow(2,2),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;switch(E){case 0:for(E=0,O=Math.pow(2,8),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;I=t(E);break;case 1:for(E=0,O=Math.pow(2,16),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;I=t(E);break;case 2:return""}for(f[3]=I,x=I,y.push(I);;){if(D.index>l)return"";for(E=0,O=Math.pow(2,p),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;switch(I=E){case 0:for(E=0,O=Math.pow(2,8),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;f[g++]=t(E),I=g-1,d--;break;case 1:for(E=0,O=Math.pow(2,16),N=1;N!=O;)M=D.val&D.position,D.position>>=1,D.position==0&&(D.position=c,D.val=u(D.index++)),E|=(M>0?1:0)*N,N<<=1;f[g++]=t(E),I=g-1,d--;break;case 2:return y.join("")}if(d==0&&(d=Math.pow(2,p),p++),f[I])_=f[I];else if(I===g)_=x+x.charAt(0);else return null;y.push(_),f[g++]=x+_.charAt(0),d--,x=_,d==0&&(d=Math.pow(2,p),p++)}}};return o})();n!=null?n.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(iB)),iB.exports}var bDe=yDe();const SDe=Bh(bDe);var p7={};function zle(n){return n.replace(/</g,"&lt;").replace(/>/g,"&gt;")}const EDe=(n,e,t,r,i,s,a)=>{const o=r+t.indent,l=t.colors;return n.map(c=>{const u=e[c];let f=a(u,t,o,i,s);return typeof u!="string"&&(f.indexOf(`
`)!==-1&&(f=t.spacingOuter+o+f+t.spacingOuter+r),f="{"+f+"}"),t.spacingInner+r+l.prop.open+c+l.prop.close+"="+l.value.open+f+l.value.close}).join("")},xDe=3,TDe=(n,e,t,r,i,s)=>n.map(a=>{const o=typeof a=="string"?jle(a,e):s(a,e,t,r,i);return o===""&&typeof a=="object"&&a!==null&&a.nodeType!==xDe?"":e.spacingOuter+t+o}).join(""),jle=(n,e)=>{const t=e.colors.content;return t.open+zle(n)+t.close},wDe=(n,e)=>{const t=e.colors.comment;return t.open+"<!--"+zle(n)+"-->"+t.close},RDe=(n,e,t,r,i)=>{const s=r.colors.tag;return s.open+"<"+n+(e&&s.close+e+r.spacingOuter+i+s.open)+(t?">"+s.close+t+r.spacingOuter+i+s.open+"</"+n:(e&&!r.min?"":" ")+"/")+">"+s.close},ADe=(n,e)=>{const t=e.colors.tag;return t.open+"<"+n+t.close+" "+t.open+" />"+t.close},CDe=1,Hle=3,qle=8,Vle=11,MDe=/^((HTML|SVG)\w*)?Element$/,Gle=n=>{const{tagName:e}=n;return!!(typeof e=="string"&&e.includes("-")||typeof n.hasAttribute=="function"&&n.hasAttribute("is"))},kDe=n=>{const e=n.constructor.name,{nodeType:t}=n;return t===CDe&&(MDe.test(e)||Gle(n))||t===Hle&&e==="Text"||t===qle&&e==="Comment"||t===Vle&&e==="DocumentFragment"};function ODe(n){return n.nodeType===Hle}function IDe(n){return n.nodeType===qle}function sB(n){return n.nodeType===Vle}function NDe(n){return{test:e=>{var t;return((e==null||(t=e.constructor)==null?void 0:t.name)||Gle(e))&&kDe(e)},serialize:(e,t,r,i,s,a)=>{if(ODe(e))return jle(e.data,t);if(IDe(e))return wDe(e.data,t);const o=sB(e)?"DocumentFragment":e.tagName.toLowerCase();return++i>t.maxDepth?ADe(o,t):RDe(o,EDe(sB(e)?[]:Array.from(e.attributes).map(l=>l.name).sort(),sB(e)?{}:Array.from(e.attributes).reduce((l,c)=>(l[c.name]=c.value,l),{}),t,r+t.indent,i,s,a),TDe(Array.prototype.slice.call(e.childNodes||e.children).filter(n),t,r+t.indent,i,s,a),t,r)}}}let $le=null,vj=null,yj=null;try{const n=Ih&&Ih.require;vj=n.call(Ih,"fs").readFileSync,yj=n.call(Ih,"@babel/code-frame").codeFrameColumns,$le=n.call(Ih,"picocolors")}catch{}function PDe(n){const e=n.indexOf("(")+1,t=n.indexOf(")"),r=n.slice(e,t),i=r.split(":"),[s,a,o]=[i[0],parseInt(i[1],10),parseInt(i[2],10)];let l="";try{l=vj(s,"utf-8")}catch{return""}const c=yj(l,{start:{line:a,column:o}},{highlightCode:!0,linesBelow:0});return $le.dim(r)+`
`+c+`
`}function DDe(){if(!vj||!yj)return"";const e=new Error().stack.split(`
`).slice(1).find(t=>!t.includes("node_modules/"));return PDe(e)}const Wle=3;function aB(){return typeof jest<"u"&&jest!==null?setTimeout._isMockFunction===!0||Object.prototype.hasOwnProperty.call(setTimeout,"clock"):!1}function bj(){if(typeof window>"u")throw new Error("Could not find default container");return window.document}function LDe(n){if(n.defaultView)return n.defaultView;if(n.ownerDocument&&n.ownerDocument.defaultView)return n.ownerDocument.defaultView;if(n.window)return n.window;throw n.ownerDocument&&n.ownerDocument.defaultView===null?new Error("It looks like the window object is not available for the provided node."):n.then instanceof Function?new Error("It looks like you passed a Promise object instead of a DOM node. Did you do something like `fireEvent.click(screen.findBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`, or await the findBy query `fireEvent.click(await screen.findBy...`?"):Array.isArray(n)?new Error("It looks like you passed an Array instead of a DOM node. Did you do something like `fireEvent.click(screen.getAllBy...` when you meant to use a `getBy` query `fireEvent.click(screen.getBy...`?"):typeof n.debug=="function"&&typeof n.logTestingPlaygroundURL=="function"?new Error("It looks like you passed a `screen` object. Did you do something like `fireEvent.click(screen, ...` when you meant to use a query, e.g. `fireEvent.click(screen.getBy..., `?"):new Error("The given node is not an Element, the node type is: "+typeof n+".")}function pb(n){if(!n||typeof n.querySelector!="function"||typeof n.querySelectorAll!="function")throw new TypeError("Expected container to be an Element, a Document or a DocumentFragment but got "+e(n)+".");function e(t){return typeof t=="object"?t===null?"null":t.constructor.name:typeof t}}const UDe=()=>{if(typeof xl>"u")return!1;let n;try{var e;const t=(e=p7)==null?void 0:e.COLORS;t&&(n=JSON.parse(t))}catch{}return typeof n=="boolean"?n:xl.versions!==void 0&&xl.versions.node!==void 0},{DOMCollection:BDe}=Ole.plugins,FDe=1,zDe=8;function jDe(n){return n.nodeType!==zDe&&(n.nodeType!==FDe||!n.matches(Za().defaultIgnore))}function yD(n,e,t){if(t===void 0&&(t={}),n||(n=bj().body),typeof e!="number"&&(e=typeof xl<"u"&&typeof p7<"u"&&p7.DEBUG_PRINT_LIMIT||7e3),e===0)return"";n.documentElement&&(n=n.documentElement);let r=typeof n;if(r==="object"?r=n.constructor.name:n={},!("outerHTML"in n))throw new TypeError("Expected an element or document but got "+r);const{filterNode:i=jDe,...s}=t,a=Ole.format(n,{plugins:[NDe(i),BDe],printFunctionName:!1,highlight:UDe(),...s});return e!==void 0&&n.outerHTML.length>e?a.slice(0,e)+"...":a}const DZ=function(){const n=DDe();console.log(n?yD(...arguments)+`

`+n:yD(...arguments))};let bD={testIdAttribute:"data-testid",asyncUtilTimeout:1e3,asyncWrapper:n=>n(),unstable_advanceTimersWrapper:n=>n(),eventWrapper:n=>n(),defaultHidden:!1,defaultIgnore:"script, style",showOriginalStackTrace:!1,throwSuggestions:!1,getElementError(n,e){const t=yD(e),r=new Error([n,"Ignored nodes: comments, "+bD.defaultIgnore+`
`+t].filter(Boolean).join(`

`));return r.name="TestingLibraryElementError",r},_disableExpensiveErrorDiagnostics:!1,computedStyleSupportsPseudoElements:!1};function HDe(n){try{return bD._disableExpensiveErrorDiagnostics=!0,n()}finally{bD._disableExpensiveErrorDiagnostics=!1}}function Za(){return bD}const qDe=["button","meter","output","progress","select","textarea","input"];function Yle(n){return qDe.includes(n.nodeName.toLowerCase())?"":n.nodeType===Wle?n.textContent:Array.from(n.childNodes).map(e=>Yle(e)).join("")}function m7(n){let e;return n.tagName.toLowerCase()==="label"?e=Yle(n):e=n.value||n.textContent,e}function Xle(n){if(n.labels!==void 0){var e;return(e=n.labels)!=null?e:[]}if(!VDe(n))return[];const t=n.ownerDocument.querySelectorAll("label");return Array.from(t).filter(r=>r.control===n)}function VDe(n){return/BUTTON|METER|OUTPUT|PROGRESS|SELECT|TEXTAREA/.test(n.tagName)||n.tagName==="INPUT"&&n.getAttribute("type")!=="hidden"}function Kle(n,e,t){let{selector:r="*"}=t===void 0?{}:t;const i=e.getAttribute("aria-labelledby"),s=i?i.split(" "):[];return s.length?s.map(a=>{const o=n.querySelector('[id="'+a+'"]');return o?{content:m7(o),formControl:null}:{content:"",formControl:null}}):Array.from(Xle(e)).map(a=>{const o=m7(a),c=Array.from(a.querySelectorAll("button, input, meter, output, progress, select, textarea")).filter(u=>u.matches(r))[0];return{content:o,formControl:c}})}function Zle(n){if(n==null)throw new Error("It looks like "+n+" was passed instead of a matcher. Did you do something like getByText("+n+")?")}function Fw(n,e,t,r){if(typeof n!="string")return!1;Zle(t);const i=r(n);return typeof t=="string"||typeof t=="number"?i.toLowerCase().includes(t.toString().toLowerCase()):typeof t=="function"?t(i,e):Jle(t,i)}function Xy(n,e,t,r){if(typeof n!="string")return!1;Zle(t);const i=r(n);return t instanceof Function?t(i,e):t instanceof RegExp?Jle(t,i):i===String(t)}function Qle(n){let{trim:e=!0,collapseWhitespace:t=!0}=n===void 0?{}:n;return r=>{let i=r;return i=e?i.trim():i,i=t?i.replace(/\s+/g," "):i,i}}function XE(n){let{trim:e,collapseWhitespace:t,normalizer:r}=n;if(!r)return Qle({trim:e,collapseWhitespace:t});if(typeof e<"u"||typeof t<"u")throw new Error('trim and collapseWhitespace are not supported with a normalizer. If you want to use the default trim and collapseWhitespace logic in your normalizer, use "getDefaultNormalizer({trim, collapseWhitespace})" and compose that into your normalizer');return r}function Jle(n,e){const t=n.test(e);return n.global&&n.lastIndex!==0&&(console.warn("To match all elements we had to reset the lastIndex of the RegExp because the global flag is enabled. We encourage to remove the global flag from the RegExp."),n.lastIndex=0),t}function O4(n){return n.matches("input[type=submit], input[type=button], input[type=reset]")?n.value:Array.from(n.childNodes).filter(e=>e.nodeType===Wle&&!!e.textContent).map(e=>e.textContent).join("")}const GDe=$De(_0.elementRoles);function ece(n){return n.hidden===!0||n.getAttribute("aria-hidden")==="true"||n.ownerDocument.defaultView.getComputedStyle(n).display==="none"}function Sj(n,e){e===void 0&&(e={});const{isSubtreeInaccessible:t=ece}=e;if(n.ownerDocument.defaultView.getComputedStyle(n).visibility==="hidden")return!0;let i=n;for(;i;){if(t(i))return!0;i=i.parentElement}return!1}function Ej(n){for(const{match:e,roles:t}of GDe)if(e(n))return[...t];return[]}function $De(n){function e(a){let{name:o,attributes:l}=a;return""+o+l.map(c=>{let{name:u,value:f,constraints:d=[]}=c;const g=d.indexOf("undefined")!==-1,p=d.indexOf("set")!==-1;return typeof f<"u"?"["+u+'="'+f+'"]':g?":not(["+u+"])":p?"["+u+"]:not(["+u+'=""])':"["+u+"]"}).join("")}function t(a){let{attributes:o=[]}=a;return o.length}function r(a,o){let{specificity:l}=a,{specificity:c}=o;return c-l}function i(a){let{attributes:o=[]}=a;const l=o.findIndex(u=>u.value&&u.name==="type"&&u.value==="text");l>=0&&(o=[...o.slice(0,l),...o.slice(l+1)]);const c=e({...a,attributes:o});return u=>l>=0&&u.type!=="text"?!1:u.matches(c)}let s=[];for(const[a,o]of n.entries())s=[...s,{match:i(a),roles:Array.from(o),specificity:t(a)}];return s.sort(r)}function WDe(n,e){let{hidden:t=!1}=e===void 0?{}:e;function r(i){return[i,...Array.from(i.children).reduce((s,a)=>[...s,...r(a)],[])]}return r(n).filter(i=>t===!1?Sj(i)===!1:!0).reduce((i,s)=>{let a=[];return s.hasAttribute("role")?a=s.getAttribute("role").split(" ").slice(0,1):a=Ej(s),a.reduce((o,l)=>Array.isArray(o[l])?{...o,[l]:[...o[l],s]}:{...o,[l]:[s]},i)},{})}function YDe(n,e){let{hidden:t,includeDescription:r}=e;const i=WDe(n,{hidden:t});return Object.entries(i).filter(s=>{let[a]=s;return a!=="generic"}).map(s=>{let[a,o]=s;const l="-".repeat(50),c=o.map(u=>{const f='Name "'+gj(u,{computedStyleSupportsPseudoElements:Za().computedStyleSupportsPseudoElements})+`":
`,d=yD(u.cloneNode(!1));if(r){const g='Description "'+Fle(u,{computedStyleSupportsPseudoElements:Za().computedStyleSupportsPseudoElements})+`":
`;return""+f+g+d}return""+f+d}).join(`

`);return a+`:

`+c+`

`+l}).join(`
`)}function XDe(n){return n.tagName==="OPTION"?n.selected:cO(n,"aria-selected")}function KDe(n){return n.getAttribute("aria-busy")==="true"}function ZDe(n){if(!("indeterminate"in n&&n.indeterminate))return"checked"in n?n.checked:cO(n,"aria-checked")}function QDe(n){return cO(n,"aria-pressed")}function JDe(n){var e,t;return(e=(t=cO(n,"aria-current"))!=null?t:n.getAttribute("aria-current"))!=null?e:!1}function eLe(n){return cO(n,"aria-expanded")}function cO(n,e){const t=n.getAttribute(e);if(t==="true")return!0;if(t==="false")return!1}function tLe(n){const e={H1:1,H2:2,H3:3,H4:4,H5:5,H6:6};return n.getAttribute("aria-level")&&Number(n.getAttribute("aria-level"))||e[n.tagName]}function nLe(n){const e=n.getAttribute("aria-valuenow");return e===null?void 0:+e}function rLe(n){const e=n.getAttribute("aria-valuemax");return e===null?void 0:+e}function iLe(n){const e=n.getAttribute("aria-valuemin");return e===null?void 0:+e}function sLe(n){const e=n.getAttribute("aria-valuetext");return e===null?void 0:e}const LZ=Qle();function aLe(n){return n.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function UZ(n){return new RegExp(aLe(n.toLowerCase()),"i")}function zb(n,e,t,r){let{variant:i,name:s}=r,a="";const o={},l=[["Role","TestId"].includes(n)?t:UZ(t)];s&&(o.name=UZ(s)),n==="Role"&&Sj(e)&&(o.hidden=!0,a=`Element is inaccessible. This means that the element and all its children are invisible to screen readers.
    If you are using the aria-hidden prop, make sure this is the right choice for your case.
    `),Object.keys(o).length>0&&l.push(o);const c=i+"By"+n;return{queryName:n,queryMethod:c,queryArgs:l,variant:i,warning:a,toString(){a&&console.warn(a);let[u,f]=l;return u=typeof u=="string"?"'"+u+"'":u,f=f?", { "+Object.entries(f).map(d=>{let[g,p]=d;return g+": "+p}).join(", ")+" }":"",c+"("+u+f+")"}}}function jb(n,e,t){return t&&!0}function g7(n,e,t){var r,i;if(e===void 0&&(e="get"),n.matches(Za().defaultIgnore))return;const s=(r=n.getAttribute("role"))!=null?r:(i=Ej(n))==null?void 0:i[0];if(s!=="generic"&&jb("Role",t,s))return zb("Role",n,s,{variant:e,name:gj(n,{computedStyleSupportsPseudoElements:Za().computedStyleSupportsPseudoElements})});const a=Kle(document,n).map(d=>d.content).join(" ");if(jb("LabelText",t,a))return zb("LabelText",n,a,{variant:e});const o=n.getAttribute("placeholder");if(jb("PlaceholderText",t,o))return zb("PlaceholderText",n,o,{variant:e});const l=LZ(O4(n));if(jb("Text",t,l))return zb("Text",n,l,{variant:e});if(jb("DisplayValue",t,n.value))return zb("DisplayValue",n,LZ(n.value),{variant:e});const c=n.getAttribute("alt");if(jb("AltText",t,c))return zb("AltText",n,c,{variant:e});const u=n.getAttribute("title");if(jb("Title",t,u))return zb("Title",n,u,{variant:e});const f=n.getAttribute(Za().testIdAttribute);if(jb("TestId",t,f))return zb("TestId",n,f,{variant:e})}function CI(n,e){n.stack=e.stack.replace(e.message,n.message)}function oLe(n,e){let{container:t=bj(),timeout:r=Za().asyncUtilTimeout,showOriginalStackTrace:i=Za().showOriginalStackTrace,stackTraceError:s,interval:a=50,onTimeout:o=c=>(Object.defineProperty(c,"message",{value:Za().getElementError(c.message,t).message}),c),mutationObserverOptions:l={subtree:!0,childList:!0,attributes:!0,characterData:!0}}=e;if(typeof n!="function")throw new TypeError("Received `callback` arg must be a function");return new Promise(async(c,u)=>{let f,d,g,p=!1,_="idle";const y=setTimeout(O,r),v=aB();if(v){const{unstable_advanceTimersWrapper:N}=Za();for(M();!p;){if(!aB()){const I=new Error("Changed from using fake timers to real timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to real timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");i||CI(I,s),u(I);return}if(await N(async()=>{jest.advanceTimersByTime(a)}),p)break;M()}}else{try{pb(t)}catch(I){u(I);return}d=setInterval(E,a);const{MutationObserver:N}=LDe(t);g=new N(E),g.observe(t,l),M()}function x(N,I){p=!0,clearTimeout(y),v||(clearInterval(d),g.disconnect()),N?u(N):c(I)}function E(){if(aB()){const N=new Error("Changed from using real timers to fake timers while using waitFor. This is not allowed and will result in very strange behavior. Please ensure you're awaiting all async things your test is doing before changing to fake timers. For more info, please go to https://github.com/testing-library/dom-testing-library/issues/830");return i||CI(N,s),u(N)}else return M()}function M(){if(_!=="pending")try{const N=HDe(n);typeof N?.then=="function"?(_="pending",N.then(I=>{_="resolved",x(null,I)},I=>{_="rejected",f=I})):x(null,N)}catch(N){f=N}}function O(){let N;f?(N=f,!i&&N.name==="TestingLibraryElementError"&&CI(N,s)):(N=new Error("Timed out in waitFor."),i||CI(N,s)),x(o(N),null)}})}function lLe(n,e){const t=new Error("STACK_TRACE_MESSAGE");return Za().asyncWrapper(()=>oLe(n,{stackTraceError:t,...e}))}function tce(n,e){return Za().getElementError(n,e)}function cLe(n,e){return tce(n+"\n\n(If this is intentional, then use the `*AllBy*` variant of the query (like `queryAllByText`, `getAllByText`, or `findAllByText`)).",e)}function I4(n,e,t,r){let{exact:i=!0,collapseWhitespace:s,trim:a,normalizer:o}=r===void 0?{}:r;const l=i?Xy:Fw,c=XE({collapseWhitespace:s,trim:a,normalizer:o});return Array.from(e.querySelectorAll("["+n+"]")).filter(u=>l(u.getAttribute(n),u,t,c))}function SD(n,e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const a=n(t,...i);if(a.length>1){const o=a.map(l=>tce(null,l).message).join(`

`);throw cLe(e(t,...i)+`

Here are the matching elements:

`+o,t)}return a[0]||null}}function nce(n,e){return Za().getElementError(`A better query is available, try this:
`+n.toString()+`
`,e)}function uLe(n,e){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];const a=n(t,...i);if(!a.length)throw Za().getElementError(e(t,...i),t);return a}}function ED(n){return(e,t,r,i)=>lLe(()=>n(e,t,r),{container:e,...i})}const wT=(n,e,t)=>function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];const o=n(r,...s),[{suggest:l=Za().throwSuggestions}={}]=s.slice(-1);if(o&&l){const c=g7(o,t);if(c&&!e.endsWith(c.queryName))throw nce(c.toString(),r)}return o},B0=(n,e,t)=>function(r){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];const o=n(r,...s),[{suggest:l=Za().throwSuggestions}={}]=s.slice(-1);if(o.length&&l){const c=[...new Set(o.map(u=>{var f;return(f=g7(u,t))==null?void 0:f.toString()}))];if(c.length===1&&!e.endsWith(g7(o[0],t).queryName))throw nce(c[0],r)}return o};function KE(n,e,t){const r=wT(SD(n,e),n.name,"query"),i=uLe(n,t),s=SD(i,e),a=wT(s,n.name,"get"),o=B0(i,n.name.replace("query","get"),"getAll"),l=ED(B0(i,n.name,"findAll")),c=ED(wT(s,n.name,"find"));return[r,o,a,l,c]}function fLe(n){return Array.from(n.querySelectorAll("label,input")).map(e=>({node:e,textToMatch:m7(e)})).filter(e=>{let{textToMatch:t}=e;return t!==null})}const hLe=function(n,e,t){let{exact:r=!0,trim:i,collapseWhitespace:s,normalizer:a}=t===void 0?{}:t;const o=r?Xy:Fw,l=XE({collapseWhitespace:s,trim:i,normalizer:a});return fLe(n).filter(u=>{let{node:f,textToMatch:d}=u;return o(d,f,e,l)}).map(u=>{let{node:f}=u;return f})},ek=function(n,e,t){let{selector:r="*",exact:i=!0,collapseWhitespace:s,trim:a,normalizer:o}=t===void 0?{}:t;pb(n);const l=i?Xy:Fw,c=XE({collapseWhitespace:s,trim:a,normalizer:o}),u=Array.from(n.querySelectorAll("*")).filter(f=>Xle(f).length||f.hasAttribute("aria-labelledby")).reduce((f,d)=>{const g=Kle(n,d,{selector:r});g.filter(_=>!!_.formControl).forEach(_=>{l(_.content,_.formControl,e,c)&&_.formControl&&f.push(_.formControl)});const p=g.filter(_=>!!_.content).map(_=>_.content);return l(p.join(" "),d,e,c)&&f.push(d),p.length>1&&p.forEach((_,y)=>{l(_,d,e,c)&&f.push(d);const v=[...p];v.splice(y,1),v.length>1&&l(v.join(" "),d,e,c)&&f.push(d)}),f},[]).concat(I4("aria-label",n,e,{exact:i,normalizer:c}));return Array.from(new Set(u)).filter(f=>f.matches(r))},TE=function(n,e){for(var t=arguments.length,r=new Array(t>2?t-2:0),i=2;i<t;i++)r[i-2]=arguments[i];const s=ek(n,e,...r);if(!s.length){const a=hLe(n,e,...r);if(a.length){const o=a.map(l=>dLe(n,l)).filter(l=>!!l);throw o.length?Za().getElementError(o.map(l=>"Found a label with the text of: "+e+", however the element associated with this label (<"+l+" />) is non-labellable [https://html.spec.whatwg.org/multipage/forms.html#category-label]. If you really need to label a <"+l+" />, you can use aria-label or aria-labelledby instead.").join(`

`),n):Za().getElementError("Found a label with the text of: "+e+`, however no form control was found associated to that label. Make sure you're using the "for" attribute or "aria-labelledby" attribute correctly.`,n)}else throw Za().getElementError("Unable to find a label with the text of: "+e,n)}return s};function dLe(n,e){const t=e.getAttribute("for");if(!t)return null;const r=n.querySelector('[id="'+t+'"]');return r?r.tagName.toLowerCase():null}const rce=(n,e)=>"Found multiple elements with the text of: "+e,pLe=wT(SD(ek,rce),ek.name,"query"),ice=SD(TE,rce),mLe=ED(B0(TE,TE.name,"findAll")),gLe=ED(wT(ice,TE.name,"find")),_Le=B0(TE,TE.name,"getAll"),vLe=wT(ice,TE.name,"get"),yLe=B0(ek,ek.name,"queryAll"),_7=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return pb(e[0]),I4("placeholder",...e)},bLe=(n,e)=>"Found multiple elements with the placeholder text of: "+e,SLe=(n,e)=>"Unable to find an element with the placeholder text of: "+e,ELe=B0(_7,_7.name,"queryAll"),[xLe,TLe,wLe,RLe,ALe]=KE(_7,bLe,SLe),v7=function(n,e,t){let{selector:r="*",exact:i=!0,collapseWhitespace:s,trim:a,ignore:o=Za().defaultIgnore,normalizer:l}=t===void 0?{}:t;pb(n);const c=i?Xy:Fw,u=XE({collapseWhitespace:s,trim:a,normalizer:l});let f=[];return typeof n.matches=="function"&&n.matches(r)&&(f=[n]),[...f,...Array.from(n.querySelectorAll(r))].filter(d=>!o||!d.matches(o)).filter(d=>c(O4(d),d,e,u))},CLe=(n,e)=>"Found multiple elements with the text: "+e,MLe=function(n,e,t){t===void 0&&(t={});const{collapseWhitespace:r,trim:i,normalizer:s,selector:a}=t,l=XE({collapseWhitespace:r,trim:i,normalizer:s})(e.toString()),c=l!==e.toString(),u=(a??"*")!=="*";return"Unable to find an element with the text: "+(c?l+" (normalized from '"+e+"')":e)+(u?", which matches selector '"+a+"'":"")+". This could be because the text is broken up by multiple elements. In this case, you can provide a function for your text matcher to make your matcher more flexible."},kLe=B0(v7,v7.name,"queryAll"),[OLe,ILe,NLe,PLe,DLe]=KE(v7,CLe,MLe),y7=function(n,e,t){let{exact:r=!0,collapseWhitespace:i,trim:s,normalizer:a}=t===void 0?{}:t;pb(n);const o=r?Xy:Fw,l=XE({collapseWhitespace:i,trim:s,normalizer:a});return Array.from(n.querySelectorAll("input,textarea,select")).filter(c=>c.tagName==="SELECT"?Array.from(c.options).filter(f=>f.selected).some(f=>o(O4(f),f,e,l)):o(c.value,c,e,l))},LLe=(n,e)=>"Found multiple elements with the display value: "+e+".",ULe=(n,e)=>"Unable to find an element with the display value: "+e+".",BLe=B0(y7,y7.name,"queryAll"),[FLe,zLe,jLe,HLe,qLe]=KE(y7,LLe,ULe),VLe=/^(img|input|area|.+-.+)$/i,b7=function(n,e,t){return t===void 0&&(t={}),pb(n),I4("alt",n,e,t).filter(r=>VLe.test(r.tagName))},GLe=(n,e)=>"Found multiple elements with the alt text: "+e,$Le=(n,e)=>"Unable to find an element with the alt text: "+e,WLe=B0(b7,b7.name,"queryAll"),[YLe,XLe,KLe,ZLe,QLe]=KE(b7,GLe,$Le),JLe=n=>{var e;return n.tagName.toLowerCase()==="title"&&((e=n.parentElement)==null?void 0:e.tagName.toLowerCase())==="svg"},S7=function(n,e,t){let{exact:r=!0,collapseWhitespace:i,trim:s,normalizer:a}=t===void 0?{}:t;pb(n);const o=r?Xy:Fw,l=XE({collapseWhitespace:i,trim:s,normalizer:a});return Array.from(n.querySelectorAll("[title], svg > title")).filter(c=>o(c.getAttribute("title"),c,e,l)||JLe(c)&&o(O4(c),c,e,l))},e4e=(n,e)=>"Found multiple elements with the title: "+e+".",t4e=(n,e)=>"Unable to find an element with the title: "+e+".",n4e=B0(S7,S7.name,"queryAll"),[r4e,i4e,s4e,a4e,o4e]=KE(S7,e4e,t4e),E7=function(n,e,t){let{hidden:r=Za().defaultHidden,name:i,description:s,queryFallbacks:a=!1,selected:o,busy:l,checked:c,pressed:u,current:f,level:d,expanded:g,value:{now:p,min:_,max:y,text:v}={}}=t===void 0?{}:t;if(pb(n),o!==void 0){var x;if(((x=_0.roles.get(e))==null?void 0:x.props["aria-selected"])===void 0)throw new Error('"aria-selected" is not supported on role "'+e+'".')}if(l!==void 0){var E;if(((E=_0.roles.get(e))==null?void 0:E.props["aria-busy"])===void 0)throw new Error('"aria-busy" is not supported on role "'+e+'".')}if(c!==void 0){var M;if(((M=_0.roles.get(e))==null?void 0:M.props["aria-checked"])===void 0)throw new Error('"aria-checked" is not supported on role "'+e+'".')}if(u!==void 0){var O;if(((O=_0.roles.get(e))==null?void 0:O.props["aria-pressed"])===void 0)throw new Error('"aria-pressed" is not supported on role "'+e+'".')}if(f!==void 0){var N;if(((N=_0.roles.get(e))==null?void 0:N.props["aria-current"])===void 0)throw new Error('"aria-current" is not supported on role "'+e+'".')}if(d!==void 0&&e!=="heading")throw new Error('Role "'+e+'" cannot have "level" property.');if(p!==void 0){var I;if(((I=_0.roles.get(e))==null?void 0:I.props["aria-valuenow"])===void 0)throw new Error('"aria-valuenow" is not supported on role "'+e+'".')}if(y!==void 0){var D;if(((D=_0.roles.get(e))==null?void 0:D.props["aria-valuemax"])===void 0)throw new Error('"aria-valuemax" is not supported on role "'+e+'".')}if(_!==void 0){var V;if(((V=_0.roles.get(e))==null?void 0:V.props["aria-valuemin"])===void 0)throw new Error('"aria-valuemin" is not supported on role "'+e+'".')}if(v!==void 0){var G;if(((G=_0.roles.get(e))==null?void 0:G.props["aria-valuetext"])===void 0)throw new Error('"aria-valuetext" is not supported on role "'+e+'".')}if(g!==void 0){var Q;if(((Q=_0.roles.get(e))==null?void 0:Q.props["aria-expanded"])===void 0)throw new Error('"aria-expanded" is not supported on role "'+e+'".')}const B=new WeakMap;function $(U){return B.has(U)||B.set(U,ece(U)),B.get(U)}return Array.from(n.querySelectorAll(l4e(e))).filter(U=>{if(U.hasAttribute("role")){const q=U.getAttribute("role");if(a)return q.split(" ").filter(Boolean).some(ae=>ae===e);const[Y]=q.split(" ");return Y===e}return Ej(U).some(q=>q===e)}).filter(U=>{if(o!==void 0)return o===XDe(U);if(l!==void 0)return l===KDe(U);if(c!==void 0)return c===ZDe(U);if(u!==void 0)return u===QDe(U);if(f!==void 0)return f===JDe(U);if(g!==void 0)return g===eLe(U);if(d!==void 0)return d===tLe(U);if(p!==void 0||y!==void 0||_!==void 0||v!==void 0){let W=!0;if(p!==void 0&&W&&(W=p===nLe(U)),y!==void 0&&W&&(W=y===rLe(U)),_!==void 0&&W&&(W=_===iLe(U)),v!==void 0){var J;W&&(W=Xy((J=sLe(U))!=null?J:null,U,v,q=>q))}return W}return!0}).filter(U=>i===void 0?!0:Xy(gj(U,{computedStyleSupportsPseudoElements:Za().computedStyleSupportsPseudoElements}),U,i,J=>J)).filter(U=>s===void 0?!0:Xy(Fle(U,{computedStyleSupportsPseudoElements:Za().computedStyleSupportsPseudoElements}),U,s,J=>J)).filter(U=>r===!1?Sj(U,{isSubtreeInaccessible:$})===!1:!0)};function l4e(n){var e;const t='*[role~="'+n+'"]',r=(e=_0.roleElements.get(n))!=null?e:new Set,i=new Set(Array.from(r).map(s=>{let{name:a}=s;return a}));return[t].concat(Array.from(i)).join(",")}const sce=n=>{let e="";return n===void 0?e="":typeof n=="string"?e=' and name "'+n+'"':e=" and name `"+n+"`",e},c4e=function(n,e,t){let{name:r}=t===void 0?{}:t;return'Found multiple elements with the role "'+e+'"'+sce(r)},u4e=function(n,e,t){let{hidden:r=Za().defaultHidden,name:i,description:s}=t===void 0?{}:t;if(Za()._disableExpensiveErrorDiagnostics)return'Unable to find role="'+e+'"'+sce(i);let a="";Array.from(n.children).forEach(u=>{a+=YDe(u,{hidden:r,includeDescription:s!==void 0})});let o;a.length===0?r===!1?o="There are no accessible roles. But there might be some inaccessible roles. If you wish to access them, then set the `hidden` option to `true`. Learn more about this here: https://testing-library.com/docs/dom-testing-library/api-queries#byrole":o="There are no available roles.":o=(`
Here are the `+(r===!1?"accessible":"available")+` roles:

  `+a.replace(/\n/g,`
  `).replace(/\n\s\s\n/g,`

`)+`
`).trim();let l="";i===void 0?l="":typeof i=="string"?l=' and name "'+i+'"':l=" and name `"+i+"`";let c="";return s===void 0?c="":typeof s=="string"?c=' and description "'+s+'"':c=" and description `"+s+"`",(`
Unable to find an `+(r===!1?"accessible ":"")+'element with the role "'+e+'"'+l+c+`

`+o).trim()},f4e=B0(E7,E7.name,"queryAll"),[h4e,d4e,p4e,m4e,g4e]=KE(E7,c4e,u4e),xj=()=>Za().testIdAttribute,x7=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return pb(e[0]),I4(xj(),...e)},_4e=(n,e)=>"Found multiple elements by: ["+xj()+'="'+e+'"]',v4e=(n,e)=>"Unable to find an element by: ["+xj()+'="'+e+'"]',y4e=B0(x7,x7.name,"queryAll"),[b4e,S4e,E4e,x4e,T4e]=KE(x7,_4e,v4e);var T7=Object.freeze({__proto__:null,queryAllByLabelText:yLe,queryByLabelText:pLe,getAllByLabelText:_Le,getByLabelText:vLe,findAllByLabelText:mLe,findByLabelText:gLe,queryByPlaceholderText:xLe,queryAllByPlaceholderText:ELe,getByPlaceholderText:wLe,getAllByPlaceholderText:TLe,findAllByPlaceholderText:RLe,findByPlaceholderText:ALe,queryByText:OLe,queryAllByText:kLe,getByText:NLe,getAllByText:ILe,findAllByText:PLe,findByText:DLe,queryByDisplayValue:FLe,queryAllByDisplayValue:BLe,getByDisplayValue:jLe,getAllByDisplayValue:zLe,findAllByDisplayValue:HLe,findByDisplayValue:qLe,queryByAltText:YLe,queryAllByAltText:WLe,getByAltText:KLe,getAllByAltText:XLe,findAllByAltText:ZLe,findByAltText:QLe,queryByTitle:r4e,queryAllByTitle:n4e,getByTitle:s4e,getAllByTitle:i4e,findAllByTitle:a4e,findByTitle:o4e,queryByRole:h4e,queryAllByRole:f4e,getAllByRole:d4e,getByRole:p4e,findAllByRole:m4e,findByRole:g4e,queryByTestId:b4e,queryAllByTestId:y4e,getByTestId:E4e,getAllByTestId:S4e,findAllByTestId:x4e,findByTestId:T4e});function w4e(n,e,t){return e===void 0&&(e=T7),t===void 0&&(t={}),Object.keys(e).reduce((r,i)=>{const s=e[i];return r[i]=s.bind(null,n),r},t)}const BZ={copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionEnd:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionStart:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},compositionUpdate:{EventType:"CompositionEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyDown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyPress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},keyUp:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,charCode:0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusIn:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusOut:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},invalid:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!0}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},reset:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}},click:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,button:0,composed:!0}},contextMenu:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblClick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drag:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragEnd:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragEnter:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragExit:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragLeave:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},dragOver:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dragStart:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},drop:{EventType:"DragEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseDown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseEnter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseLeave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseMove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOut:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseOver:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseUp:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},select:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},touchCancel:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},touchEnd:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchMove:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},touchStart:{EventType:"TouchEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},resize:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},scroll:{EventType:"UIEvent",defaultInit:{bubbles:!1,cancelable:!1}},wheel:{EventType:"WheelEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},abort:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlay:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},canPlayThrough:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},durationChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},emptied:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},encrypted:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},ended:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedData:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadedMetadata:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},loadStart:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},pause:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},play:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},playing:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},progress:{EventType:"ProgressEvent",defaultInit:{bubbles:!1,cancelable:!1}},rateChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeked:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},seeking:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},stalled:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},suspend:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},timeUpdate:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},volumeChange:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},waiting:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},load:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},error:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},animationStart:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationEnd:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},animationIteration:{EventType:"AnimationEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionCancel:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionEnd:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},transitionRun:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},transitionStart:{EventType:"TransitionEvent",defaultInit:{bubbles:!0,cancelable:!1}},pointerOver:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerEnter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerDown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerMove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerUp:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerCancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerOut:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerLeave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},gotPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},lostPointerCapture:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},popState:{EventType:"PopStateEvent",defaultInit:{bubbles:!0,cancelable:!1}},offline:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},online:{EventType:"Event",defaultInit:{bubbles:!1,cancelable:!1}},pageHide:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}},pageShow:{EventType:"PageTransitionEvent",defaultInit:{bubbles:!0,cancelable:!0}}},R4e={doubleClick:"dblClick"};Object.keys(BZ).forEach(n=>{const{EventType:e,defaultInit:t}=BZ[n];n.toLowerCase()});Object.keys(R4e).forEach(n=>{});function A4e(n){return n.replace(/[ \t]*[\n][ \t]*/g,`
`)}function C4e(n){return SDe.compressToEncodedURIComponent(A4e(n))}function M4e(n){return"https://testing-playground.com/#markup="+C4e(n)}const k4e=(n,e,t)=>Array.isArray(n)?n.forEach(r=>DZ(r,e,t)):DZ(n,e,t),O4e=function(n){if(n===void 0&&(n=bj().body),!n||!("innerHTML"in n)){console.log("The element you're providing isn't a valid DOM element.");return}if(!n.innerHTML){console.log("The provided element doesn't have any children.");return}const e=M4e(n.innerHTML);return console.log(`Open this URL in your browser

`+e),e},FZ={debug:k4e,logTestingPlaygroundURL:O4e};typeof document<"u"&&document.body?w4e(document.body,T7,FZ):Object.keys(T7).reduce((n,e)=>(n[e]=()=>{throw new TypeError("For queries bound to document.body a global document has to be available... Learn more: https://testing-library.com/s/screen-global-error")},n),FZ);function KT(n,e){return Za().eventWrapper(n)}function T1(n){const e=R3e(n,pj),t=oO(n.ownerDocument);(e??n.ownerDocument.body)!==t&&(KT(e?()=>e.focus():()=>t?.blur()),M3e(e??n.ownerDocument.body))}function I4e(n){!pj(n)||!(oO(n.ownerDocument)===n)||KT(()=>n.blur())}const w1={};w1.click=(n,e,t)=>{const r=e.closest("button,input,label,select,textarea"),i=r&&Ds(r,"label")&&r.control;if(i&&i!==e)return()=>{pj(i)&&(T1(i),t.dispatchEvent(i,w3e(n)))};if(Ds(e,"input",{type:"file"}))return()=>{I4e(e),e.dispatchEvent(new(G0(e)).Event("fileDialog")),T1(e)}};const ZT=Symbol("Displayed value in UI"),Vy=Symbol("Displayed selection in UI"),xD=Symbol("Initial value to compare on blur");function N4e(n){return typeof n=="object"&&ZT in n}function P4e(n){return!!n&&typeof n=="object"&&Vy in n}function D4e(n,e){n[xD]===void 0&&(n[xD]=n.value),n[ZT]=e,n.value=Object.assign(new String(e),{[ZT]:!0})}function Xv(n){return n[ZT]===void 0?n.value:String(n[ZT])}function Tj(n){n[ZT]=void 0}function ace(n){n[xD]=void 0}function L4e(n){return n[xD]}function U4e(n,e){n[Vy]=e}function zw(n,{focusOffset:e,anchorOffset:t=e},r="replace"){const i=Xv(n).length,s=f=>Math.max(0,Math.min(i,f)),a=r==="replace"||n[Vy]===void 0?s(t):n[Vy].anchorOffset,o=s(e),l=Math.min(a,o),c=Math.max(a,o);if(n[Vy]={anchorOffset:a,focusOffset:o},n.selectionStart===l&&n.selectionEnd===c)return;const u=Object.assign(new Number(l),{[Vy]:!0});try{n.setSelectionRange(u,c)}catch{}}function tk(n){var e,t,r;const i=(r=n[Vy])!==null&&r!==void 0?r:{anchorOffset:(e=n.selectionStart)!==null&&e!==void 0?e:0,focusOffset:(t=n.selectionEnd)!==null&&t!==void 0?t:0};return{...i,startOffset:Math.min(i.anchorOffset,i.focusOffset),endOffset:Math.max(i.anchorOffset,i.focusOffset)}}function B4e(n){return!!n[Vy]}function LN(n){n[Vy]=void 0}const TD=globalThis.parseInt;function F4e(n){const e=n.replace(/\D/g,"");if(e.length<2)return n;const t=TD(e[0],10),r=TD(e[1],10);if(t>=3||t===2&&r>=4){let i;return t>=3?i=1:i=2,zZ(e,i)}return n.length===2?n:zZ(e,2)}function zZ(n,e){const t=n.slice(0,e),r=Math.min(TD(t,10),23),i=n.slice(e),s=TD(i,10),a=Math.min(s,59);return`${r.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function oce(n,e){const t=n.cloneNode();return t.value=e,t.value===e}var lce=(function(n){return n.email="email",n.password="password",n.search="search",n.telephone="telephone",n.text="text",n.url="url",n})(lce||{});function z4e(n){var e;const t=(e=n.getAttribute("maxlength"))!==null&&e!==void 0?e:"";return/^\d+$/.test(t)&&Number(t)>=0?Number(t):void 0}function j4e(n){return Ds(n,"textarea")||Ds(n,"input")&&n.type in lce}function cce(n,e,t,r){if(UN(n)&&e+t>=0&&e+t<=n.nodeValue.length)return{node:n,offset:e+t};const i=jZ(n,e,t);if(i){if(UN(i))return{node:i,offset:t>0?Math.min(1,i.nodeValue.length):Math.max(i.nodeValue.length-1,0)};if(Ds(i,"br")){const s=jZ(i,void 0,t);return s?UN(s)?{node:s,offset:t>0?0:s.nodeValue.length}:t<0&&Ds(s,"br")?{node:i.parentNode,offset:MI(i)}:{node:s.parentNode,offset:MI(s)+(t>0?0:1)}:t<0&&r==="deleteContentBackward"?{node:i.parentNode,offset:MI(i)}:void 0}else return{node:i.parentNode,offset:MI(i)+(t>0?1:0)}}}function jZ(n,e,t){const r=Number(e)+(t<0?-1:0);return e!==void 0&&wj(n)&&r>=0&&r<n.children.length&&(n=n.children[r]),q4e(n,t===1?"next":"previous",H4e)}function H4e(n){if(UN(n))return!0;if(wj(n)){if(Ds(n,["input","textarea"]))return n.type!=="hidden";if(Ds(n,"br"))return!0}return!1}function MI(n){let e=0;for(;n.previousSibling;)e++,n=n.previousSibling;return e}function wj(n){return n.nodeType===1}function UN(n){return n.nodeType===3}function q4e(n,e,t){for(;;){var r;const i=n[`${e}Sibling`];if(i){if(n=V4e(i,e==="next"?"first":"last"),t(n))return n}else if(n.parentNode&&(!wj(n.parentNode)||!xE(n.parentNode)&&n.parentNode!==((r=n.ownerDocument)===null||r===void 0?void 0:r.body)))n=n.parentNode;else break}}function V4e(n,e){for(;n.hasChildNodes();)n=n[`${e}Child`];return n}const nk=Symbol("Track programmatic changes for React workaround");function G4e(n){return Object.getOwnPropertyNames(n).some(e=>e.startsWith("__react"))&&G0(n).REACT_VERSION===17}function $4e(n){G4e(n)&&(n[nk]={previousValue:String(n.value),tracked:[]})}function W4e(n,e){var t,r;(r=n[nk])===null||r===void 0||(t=r.tracked)===null||t===void 0||t.push(e),n[nk]||(Tj(n),zw(n,{focusOffset:e.length}))}function Y4e(n,e){var t;const r=n[nk];if(n[nk]=void 0,!(!(r==null||(t=r.tracked)===null||t===void 0)&&t.length))return;const i=r.tracked.length===2&&r.tracked[0]===r.previousValue&&r.tracked[1]===n.value;i||Tj(n),B4e(n)&&zw(n,{focusOffset:i?e:n.value.length})}function uce(n){const e=X4e(n);if(e&&Yv(e))return{type:"input",selection:tk(e)};const t=e?.ownerDocument.getSelection();return{type:Z2(n)&&t?.anchorNode&&Z2(t.anchorNode)?"contenteditable":"default",selection:t}}function X4e(n){return n.nodeType===1?n:n.parentElement}function K4e(n){const e=uce(n);if(e.type==="input")return e.selection;if(e.type==="contenteditable"){var t;return(t=e.selection)===null||t===void 0?void 0:t.getRangeAt(0)}}function wE({focusNode:n,focusOffset:e,anchorNode:t=n,anchorOffset:r=e}){var i,s;if(uce(n).type==="input")return zw(n,{anchorOffset:r,focusOffset:e});(s=t.ownerDocument)===null||s===void 0||(i=s.getSelection())===null||i===void 0||i.setBaseAndExtent(t,r,n,e)}function fce(n){return Ds(n,"input")&&["date","time"].includes(n.type)}function QT(n,e,t,r="insertText"){const i=K4e(e);i&&(!fce(e)&&!n.dispatchUIEvent(e,"beforeinput",{inputType:r,data:t})||("startContainer"in i?Z4e(n,e,i,t,r):Q4e(n,e,i,t,r)))}function Z4e(n,e,t,r,i){let s=!1;if(!t.collapsed)s=!0,t.deleteContents();else if(["deleteContentBackward","deleteContentForward"].includes(i)){const a=cce(t.startContainer,t.startOffset,i==="deleteContentBackward"?-1:1,i);if(a){s=!0;const o=t.cloneRange();o.comparePoint(a.node,a.offset)<0?o.setStart(a.node,a.offset):o.setEnd(a.node,a.offset),o.deleteContents()}}if(r)if(t.endContainer.nodeType===3){const a=t.endOffset;t.endContainer.insertData(a,r),t.setStart(t.endContainer,a+r.length),t.setEnd(t.endContainer,a+r.length)}else{const a=e.ownerDocument.createTextNode(r);t.insertNode(a),t.setStart(a,r.length),t.setEnd(a,r.length)}(s||r)&&n.dispatchUIEvent(e,"input",{inputType:i})}function Q4e(n,e,t,r,i){let s=r;if(j4e(e)){const c=z4e(e);if(c!==void 0&&r.length>0){const u=c-e.value.length;if(u>0)s=r.substring(0,u);else return}}const{newValue:a,newOffset:o,oldValue:l}=J4e(s,e,t,i);a===l&&o===t.startOffset&&o===t.endOffset||Ds(e,"input",{type:"number"})&&!eUe(a)||(D4e(e,a),wE({focusNode:e,anchorOffset:o,focusOffset:o}),fce(e)?oce(e,a)&&(HZ(n,e,o,{}),n.dispatchUIEvent(e,"change"),ace(e)):HZ(n,e,o,{data:r,inputType:i}))}function J4e(n,e,{startOffset:t,endOffset:r},i){const s=Xv(e),a=Math.max(0,t===r&&i==="deleteContentBackward"?t-1:t),o=s.substring(0,a),l=Math.min(s.length,t===r&&i==="deleteContentForward"?t+1:r),c=s.substring(l,s.length);let u=`${o}${n}${c}`,f=a+n.length;if(Ds(e,"input",{type:"time"})){const d=F4e(u);d!==""&&oce(e,d)&&(u=d,f=d.length)}return{oldValue:s,newValue:u,newOffset:f}}function HZ(n,e,t,r){n.dispatchUIEvent(e,"input",r),Y4e(e,t)}function eUe(n){var e,t;const r=n.split("e",2);return!(/[^\d.\-e]/.test(n)||Number((e=n.match(/-/g))===null||e===void 0?void 0:e.length)>2||Number((t=n.match(/\./g))===null||t===void 0?void 0:t.length)>1||r[1]&&!/^-?\d*$/.test(r[1]))}w1.cut=(n,e,t)=>()=>{XT(e)&&QT(t,e,"","deleteByCut")};function tUe(n){return n?xE(n)?n.textContent:Xv(n):null}function nUe(n){const e=G0(n);for(let t=n;t?.ownerDocument;t=t.parentElement){const{display:r,visibility:i}=e.getComputedStyle(t);if(r==="none"||i==="hidden")return!1}return!0}function rUe(n,e){const t=n.ownerDocument,r=t.querySelectorAll(Tle),i=Array.from(r).filter(l=>l===n||!(Number(l.getAttribute("tabindex"))<0||ab(l)));Number(n.getAttribute("tabindex"))>=0&&i.sort((l,c)=>{const u=Number(l.getAttribute("tabindex")),f=Number(c.getAttribute("tabindex"));return u===f?0:u===0?1:f===0?-1:u-f});const s={};let a=[t.body];const o=Ds(n,"input",{type:"radio"})?n.name:void 0;i.forEach(l=>{const c=l;if(Ds(c,"input",{type:"radio"})&&c.name){if(c===n){a.push(c);return}else if(c.name===o)return;if(c.checked){a=a.filter(u=>!Ds(u,"input",{type:"radio",name:c.name})),a.push(c),s[c.name]=c;return}if(typeof s[c.name]<"u")return}a.push(c)});for(let l=a.findIndex(c=>c===n);;)if(l+=e?-1:1,l===a.length?l=0:l===-1&&(l=a.length-1),a[l]===n||a[l]===t.body||nUe(a[l]))return a[l]}function qZ(n,e){if(Yv(n)){const t=tk(n);wE({focusNode:n,focusOffset:t.startOffset===t.endOffset?t.focusOffset+e:e<0?t.startOffset:t.endOffset})}else{const t=n.ownerDocument.getSelection();if(!t?.focusNode)return;if(t.isCollapsed){const r=cce(t.focusNode,t.focusOffset,e);r&&wE({focusNode:r.node,focusOffset:r.offset})}else t[e<0?"collapseToStart":"collapseToEnd"]()}}function hce(n){if(Yv(n))return wE({focusNode:n,anchorOffset:0,focusOffset:Xv(n).length});var e;const t=(e=Z2(n))!==null&&e!==void 0?e:n.ownerDocument.body;wE({focusNode:t,anchorOffset:0,focusOffset:t.childNodes.length})}function iUe(n){if(Yv(n))return tk(n).startOffset===0&&tk(n).endOffset===Xv(n).length;var e;const t=(e=Z2(n))!==null&&e!==void 0?e:n.ownerDocument.body,r=n.ownerDocument.getSelection();return r?.anchorNode===t&&r.focusNode===t&&r.anchorOffset===0&&r.focusOffset===t.childNodes.length}function XM(n,e,t){var r;if(Yv(n))return wE({focusNode:n,anchorOffset:e,focusOffset:t});if(xE(n)&&((r=n.firstChild)===null||r===void 0?void 0:r.nodeType)===3)return wE({focusNode:n.firstChild,anchorOffset:e,focusOffset:t});throw new Error("Not implemented. The result of this interaction is unreliable.")}function kI(n,e,t){const r=G0(e),i=Array.from(e.ownerDocument.querySelectorAll(e.name?`input[type="radio"][name="${r.CSS.escape(e.name)}"]`:'input[type="radio"][name=""], input[type="radio"]:not([name])'));for(let s=i.findIndex(a=>a===e)+t;;s+=t){if(i[s]||(s=t>0?0:i.length-1),i[s]===e)return;if(!ab(i[s])){T1(i[s]),n.dispatchUIEvent(i[s],"click");return}}}w1.keydown=(n,e,t)=>{var r,i;return(i=(r=VZ[n.key])===null||r===void 0?void 0:r.call(VZ,n,e,t))!==null&&i!==void 0?i:sUe(n,e,t)};const VZ={ArrowDown:(n,e,t)=>{if(Ds(e,"input",{type:"radio"}))return()=>kI(t,e,1)},ArrowLeft:(n,e,t)=>Ds(e,"input",{type:"radio"})?()=>kI(t,e,-1):()=>qZ(e,-1),ArrowRight:(n,e,t)=>Ds(e,"input",{type:"radio"})?()=>kI(t,e,1):()=>qZ(e,1),ArrowUp:(n,e,t)=>{if(Ds(e,"input",{type:"radio"}))return()=>kI(t,e,-1)},Backspace:(n,e,t)=>{if(XT(e))return()=>{QT(t,e,"","deleteContentBackward")}},Delete:(n,e,t)=>{if(XT(e))return()=>{QT(t,e,"","deleteContentForward")}},End:(n,e)=>{if(Ds(e,["input","textarea"])||xE(e))return()=>{var t,r;const i=(r=(t=tUe(e))===null||t===void 0?void 0:t.length)!==null&&r!==void 0?r:0;XM(e,i,i)}},Home:(n,e)=>{if(Ds(e,["input","textarea"])||xE(e))return()=>{XM(e,0,0)}},PageDown:(n,e)=>{if(Ds(e,["input"]))return()=>{const t=Xv(e).length;XM(e,t,t)}},PageUp:(n,e)=>{if(Ds(e,["input"]))return()=>{XM(e,0,0)}},Tab:(n,e,t)=>()=>{const r=rUe(e,t.system.keyboard.modifiers.Shift);T1(r),Yv(r)&&zw(r,{anchorOffset:0,focusOffset:r.value.length})}},sUe=(n,e,t)=>{if(n.code==="KeyA"&&t.system.keyboard.modifiers.Control)return()=>hce(e)};w1.keypress=(n,e,t)=>{if(n.key==="Enter"){if(Ds(e,"button")||Ds(e,"input")&&aUe.includes(e.type)||Ds(e,"a")&&e.href)return()=>{t.dispatchUIEvent(e,"click")};if(Ds(e,"input")){const r=e.form,i=r?.querySelector('input[type="submit"], button:not([type]), button[type="submit"]');return i?()=>t.dispatchUIEvent(i,"click"):r&&oUe.includes(e.type)&&r.querySelectorAll("input").length===1?()=>t.dispatchUIEvent(r,"submit"):void 0}}if(XT(e)){const r=n.key==="Enter"?xE(e)&&!t.system.keyboard.modifiers.Shift?"insertParagraph":"insertLineBreak":"insertText",i=n.key==="Enter"?`
`:n.key;return()=>QT(t,e,i,r)}};const aUe=["button","color","file","image","reset","submit"],oUe=["email","month","password","search","tel","text","url","week"];w1.keyup=(n,e,t)=>{var r;return(r=GZ[n.key])===null||r===void 0?void 0:r.call(GZ,n,e,t)};const GZ={" ":(n,e,t)=>{if(Rle(e))return()=>t.dispatchUIEvent(e,"click")}};w1.paste=(n,e,t)=>{if(XT(e))return()=>{var r;const i=(r=n.clipboardData)===null||r===void 0?void 0:r.getData("text");i&&QT(t,e,i,"insertFromPaste")}};const dce={auxclick:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},beforeinput:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},blur:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},click:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},contextmenu:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},copy:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},change:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!1}},cut:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},dblclick:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},focus:{EventType:"FocusEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},focusin:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},focusout:{EventType:"FocusEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},keydown:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keypress:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},keyup:{EventType:"KeyboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},paste:{EventType:"ClipboardEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},input:{EventType:"InputEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},mousedown:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseenter:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mouseleave:{EventType:"MouseEvent",defaultInit:{bubbles:!1,cancelable:!1,composed:!0}},mousemove:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseout:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseover:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},mouseup:{EventType:"MouseEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerover:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerenter:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},pointerdown:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointermove:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerup:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointercancel:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!1,composed:!0}},pointerout:{EventType:"PointerEvent",defaultInit:{bubbles:!0,cancelable:!0,composed:!0}},pointerleave:{EventType:"PointerEvent",defaultInit:{bubbles:!1,cancelable:!1}},submit:{EventType:"Event",defaultInit:{bubbles:!0,cancelable:!0}}};function pce(n){return dce[n].EventType}const lUe=["MouseEvent","PointerEvent"];function cUe(n){return lUe.includes(pce(n))}function uUe(n){return pce(n)==="KeyboardEvent"}const fUe={ClipboardEvent:[dUe],Event:[],FocusEvent:[TM,pUe],InputEvent:[TM,mUe],MouseEvent:[TM,oB,$Z],PointerEvent:[TM,oB,$Z,_Ue],KeyboardEvent:[TM,oB,gUe]};function mce(n,e,t){const r=G0(e),{EventType:i,defaultInit:s}=dce[n],a=new(hUe(r))[i](n,s);return fUe[i].forEach(o=>o(a,t??{})),a}function hUe(n){var e;const t=(e=n.Event)!==null&&e!==void 0?e:class{};var r;const i=(r=n.AnimationEvent)!==null&&r!==void 0?r:class extends t{};var s;const a=(s=n.ClipboardEvent)!==null&&s!==void 0?s:class extends t{};var o;const l=(o=n.PopStateEvent)!==null&&o!==void 0?o:class extends t{};var c;const u=(c=n.ProgressEvent)!==null&&c!==void 0?c:class extends t{};var f;const d=(f=n.TransitionEvent)!==null&&f!==void 0?f:class extends t{};var g;const p=(g=n.UIEvent)!==null&&g!==void 0?g:class extends t{};var _;const y=(_=n.CompositionEvent)!==null&&_!==void 0?_:class extends p{};var v;const x=(v=n.FocusEvent)!==null&&v!==void 0?v:class extends p{};var E;const M=(E=n.InputEvent)!==null&&E!==void 0?E:class extends p{};var O;const N=(O=n.KeyboardEvent)!==null&&O!==void 0?O:class extends p{};var I;const D=(I=n.MouseEvent)!==null&&I!==void 0?I:class extends p{};var V;const G=(V=n.DragEvent)!==null&&V!==void 0?V:class extends D{};var Q;const B=(Q=n.PointerEvent)!==null&&Q!==void 0?Q:class extends D{};var $;const U=($=n.TouchEvent)!==null&&$!==void 0?$:class extends p{};return{Event:t,AnimationEvent:i,ClipboardEvent:a,PopStateEvent:l,ProgressEvent:u,TransitionEvent:d,UIEvent:p,CompositionEvent:y,FocusEvent:x,InputEvent:M,KeyboardEvent:N,MouseEvent:D,DragEvent:G,PointerEvent:B,TouchEvent:U}}function q1(n,e){for(const[t,r]of Object.entries(e))Object.defineProperty(n,t,{get:()=>r??null})}function hu(n){return Number(n??0)}function dUe(n,{clipboardData:e}){q1(n,{clipboardData:e})}function pUe(n,{relatedTarget:e}){q1(n,{relatedTarget:e})}function mUe(n,{data:e,inputType:t,isComposing:r}){q1(n,{data:e,isComposing:!!r,inputType:String(t)})}function TM(n,{view:e,detail:t}){q1(n,{view:e,detail:hu(t??0)})}function oB(n,{altKey:e,ctrlKey:t,metaKey:r,shiftKey:i,modifierAltGraph:s,modifierCapsLock:a,modifierFn:o,modifierFnLock:l,modifierNumLock:c,modifierScrollLock:u,modifierSymbol:f,modifierSymbolLock:d}){q1(n,{altKey:!!e,ctrlKey:!!t,metaKey:!!r,shiftKey:!!i,getModifierState(g){return!!{Alt:e,AltGraph:s,CapsLock:a,Control:t,Fn:o,FnLock:l,Meta:r,NumLock:c,ScrollLock:u,Shift:i,Symbol:f,SymbolLock:d}[g]}})}function gUe(n,{key:e,code:t,location:r,repeat:i,isComposing:s,charCode:a}){q1(n,{key:String(e),code:String(t),location:hu(r),repeat:!!i,isComposing:!!s,charCode:a})}function $Z(n,{x:e,y:t,screenX:r,screenY:i,clientX:s=e,clientY:a=t,button:o,buttons:l,relatedTarget:c,offsetX:u,offsetY:f,pageX:d,pageY:g}){q1(n,{screenX:hu(r),screenY:hu(i),clientX:hu(s),x:hu(s),clientY:hu(a),y:hu(a),button:hu(o),buttons:hu(l),relatedTarget:c,offsetX:hu(u),offsetY:hu(f),pageX:hu(d),pageY:hu(g)})}function _Ue(n,{pointerId:e,width:t,height:r,pressure:i,tangentialPressure:s,tiltX:a,tiltY:o,twist:l,pointerType:c,isPrimary:u}){q1(n,{pointerId:hu(e),width:hu(t??1),height:hu(r??1),pressure:hu(i),tangentialPressure:hu(s),tiltX:hu(a),tiltY:hu(o),twist:hu(l),pointerType:String(c),isPrimary:!!u})}function vUe(n,e,t,r=!1){(cUe(e)||uUe(e))&&(t={...t,...this.system.getUIEventModifiers()});const i=mce(e,n,t);return gce.call(this,n,i,r)}function gce(n,e,t=!1){var r;const i=e.type,s=t?()=>{}:(r=w1[i])===null||r===void 0?void 0:r.call(w1,e,n,this);if(s){e.preventDefault();let a=!1;return Object.defineProperty(e,"defaultPrevented",{get:()=>a}),Object.defineProperty(e,"preventDefault",{value:()=>{a=e.cancelable}}),KT(()=>n.dispatchEvent(e)),a||s(),!a}return KT(()=>n.dispatchEvent(e))}function PS(n,e,t){const r=mce(e,n,t);KT(()=>n.dispatchEvent(r))}const WZ=Symbol("patched focus/blur methods");function _ce(n){if(n.prototype[WZ])return;const{focus:e,blur:t}=n.prototype;Object.defineProperties(n.prototype,{focus:{configurable:!0,get:()=>i},blur:{configurable:!0,get:()=>s},[WZ]:{configurable:!0,get:()=>({focus:e,blur:t})}});let r;function i(a){if(this.ownerDocument.visibilityState!=="hidden")return e.call(this,a);const o=YZ(this.ownerDocument);if(o===this)return;const l=Symbol("focus call");r=l,o&&(t.call(o),PS(o,"blur",{relatedTarget:this}),PS(o,"focusout",{relatedTarget:r===l?this:null})),r===l&&(e.call(this,a),PS(this,"focus",{relatedTarget:o})),r===l&&PS(this,"focusin",{relatedTarget:o})}function s(){if(this.ownerDocument.visibilityState!=="hidden")return t.call(this);const a=YZ(this.ownerDocument);if(a!==this)return;r=Symbol("blur call"),t.call(this),PS(a,"blur",{relatedTarget:null}),PS(a,"focusout",{relatedTarget:null})}}function YZ(n){const e=oO(n);return e?.tagName==="BODY"?null:e}const lB=Symbol("Interceptor for programmatical calls");function gT(n,e,t){const r=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=Object.getOwnPropertyDescriptor(n,e),s=r?.set?"set":"value";if(typeof r?.[s]!="function"||r[s][lB])throw new Error(`Element ${n.tagName} does not implement "${String(e)}".`);function a(...o){const{applyNative:l=!1,realArgs:c,then:u}=t.call(this,...o),f=(!l&&i||r)[s];s==="set"?f.call(this,c):f.call(this,...c),u?.()}a[lB]=lB,Object.defineProperty(n,e,{...i??r,[s]:a})}function yUe(n){gT(n,"value",function(t){const r=N4e(t);return r&&$4e(this),{applyNative:!!r,realArgs:bUe(this,t),then:r?void 0:()=>W4e(this,String(t))}})}function bUe(n,e){return Ds(n,"input",{type:"number"})&&String(e)!==""&&!Number.isNaN(Number(e))?String(Number(e)):String(e)}function SUe(n){gT(n,"setSelectionRange",function(t,...r){const i=P4e(t);return{applyNative:!!i,realArgs:[Number(t),...r],then:()=>i?void 0:LN(n)}}),gT(n,"selectionStart",function(t){return{realArgs:t,then:()=>LN(n)}}),gT(n,"selectionEnd",function(t){return{realArgs:t,then:()=>LN(n)}}),gT(n,"select",function(){return{realArgs:[],then:()=>U4e(n,{anchorOffset:0,focusOffset:Xv(n).length})}})}function EUe(n){gT(n,"setRangeText",function(...t){return{realArgs:t,then:()=>{Tj(n),LN(n)}}})}const RT=Symbol("Node prepared with document state workarounds");function vce(n){n[RT]||(n.addEventListener("focus",e=>{const t=e.target;XZ(t)},{capture:!0,passive:!0}),n.activeElement&&XZ(n.activeElement),n.addEventListener("blur",e=>{const t=e.target,r=L4e(t);r!==void 0&&(t.value!==r&&PS(t,"change"),ace(t))},{capture:!0,passive:!0}),n[RT]=RT)}function XZ(n){n[RT]||(Ds(n,["input","textarea"])&&(yUe(n),SUe(n),EUe(n)),n[RT]=RT)}function xUe(n){return TUe(n)?n:n.ownerDocument}function TUe(n){return n.nodeType===9}var Tg=(function(n){return n[n.Trigger=2]="Trigger",n[n.Call=1]="Call",n})({});function KM(n,e){n.levelRefs[e]={}}function OI(n,e){return n.levelRefs[e]}function JT(n){const e=n.delay;if(typeof e=="number")return Promise.all([new Promise(t=>globalThis.setTimeout(()=>t(),e)),n.advanceTimers(e)])}var BN=(function(n){return n[n.EachTrigger=4]="EachTrigger",n[n.EachApiCall=2]="EachApiCall",n[n.EachTarget=1]="EachTarget",n[n.Never=0]="Never",n})({});function _S(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}var rv=(function(n){return n[n.STANDARD=0]="STANDARD",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n[n.NUMPAD=3]="NUMPAD",n})({});const wUe=["Alt","AltGraph","Control","Fn","Meta","Shift","Symbol"];function KZ(n){return wUe.includes(n)}const RUe=["CapsLock","FnLock","NumLock","ScrollLock","SymbolLock"];function ZZ(n){return RUe.includes(n)}class AUe{isKeyPressed(e){return this.pressed.has(String(e.code))}getPressedKeys(){return this.pressed.values().map(e=>e.keyDef)}async keydown(e,t){const r=String(t.key),i=String(t.code),s=eB(e.config.document);this.setKeydownTarget(s),this.pressed.add(i,t),KZ(r)&&(this.modifiers[r]=!0);const a=e.dispatchUIEvent(s,"keydown",{key:r,code:i});ZZ(r)&&!this.modifiers[r]&&(this.modifiers[r]=!0,this.modifierLockStart[r]=!0),a&&this.pressed.setUnprevented(i),a&&this.hasKeyPress(r)&&e.dispatchUIEvent(eB(e.config.document),"keypress",{key:r,code:i,charCode:t.key==="Enter"?13:String(t.key).charCodeAt(0)})}async keyup(e,t){const r=String(t.key),i=String(t.code),s=this.pressed.isUnprevented(i);this.pressed.delete(i),KZ(r)&&!this.pressed.values().find(a=>a.keyDef.key===r)&&(this.modifiers[r]=!1),e.dispatchUIEvent(eB(e.config.document),"keyup",{key:r,code:i},!s),ZZ(r)&&this.modifiers[r]&&(this.modifierLockStart[r]?this.modifierLockStart[r]=!1:this.modifiers[r]=!1)}setKeydownTarget(e){e!==this.lastKeydownTarget&&(this.carryChar=""),this.lastKeydownTarget=e}hasKeyPress(e){return(e.length===1||e==="Enter")&&!this.modifiers.Control&&!this.modifiers.Alt}constructor(e){_S(this,"system",void 0),_S(this,"modifiers",{Alt:!1,AltGraph:!1,CapsLock:!1,Control:!1,Fn:!1,FnLock:!1,Meta:!1,NumLock:!1,ScrollLock:!1,Shift:!1,Symbol:!1,SymbolLock:!1}),_S(this,"pressed",new class{add(t,r){var i,s,a;(a=(i=this.registry)[s=t])!==null&&a!==void 0||(i[s]={keyDef:r,unpreventedDefault:!1})}has(t){return!!this.registry[t]}setUnprevented(t){const r=this.registry[t];r&&(r.unpreventedDefault=!0)}isUnprevented(t){var r;return!!(!((r=this.registry[t])===null||r===void 0)&&r.unpreventedDefault)}delete(t){delete this.registry[t]}values(){return Object.values(this.registry)}constructor(){_S(this,"registry",{})}}),_S(this,"carryChar",""),_S(this,"lastKeydownTarget",void 0),_S(this,"modifierLockStart",{}),this.system=e}}const CUe=[..."0123456789".split("").map(n=>({code:`Digit${n}`,key:n})),...")!@#$%^&*(".split("").map((n,e)=>({code:`Digit${e}`,key:n,shiftKey:!0})),..."abcdefghijklmnopqrstuvwxyz".split("").map(n=>({code:`Key${n.toUpperCase()}`,key:n})),..."ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(n=>({code:`Key${n}`,key:n,shiftKey:!0})),{code:"BracketLeft",key:"["},{code:"BracketLeft",key:"{",shiftKey:!0},{code:"BracketRight",key:"]"},{code:"BracketRight",key:"}",shiftKey:!0},{code:"Space",key:" "},{code:"AltLeft",key:"Alt",location:rv.LEFT},{code:"AltRight",key:"Alt",location:rv.RIGHT},{code:"ShiftLeft",key:"Shift",location:rv.LEFT},{code:"ShiftRight",key:"Shift",location:rv.RIGHT},{code:"ControlLeft",key:"Control",location:rv.LEFT},{code:"ControlRight",key:"Control",location:rv.RIGHT},{code:"MetaLeft",key:"Meta",location:rv.LEFT},{code:"MetaRight",key:"Meta",location:rv.RIGHT},{code:"OSLeft",key:"OS",location:rv.LEFT},{code:"OSRight",key:"OS",location:rv.RIGHT},{code:"ContextMenu",key:"ContextMenu"},{code:"Tab",key:"Tab"},{code:"CapsLock",key:"CapsLock"},{code:"Backspace",key:"Backspace"},{code:"Enter",key:"Enter"},{code:"Escape",key:"Escape"},{code:"ArrowUp",key:"ArrowUp"},{code:"ArrowDown",key:"ArrowDown"},{code:"ArrowLeft",key:"ArrowLeft"},{code:"ArrowRight",key:"ArrowRight"},{code:"Home",key:"Home"},{code:"End",key:"End"},{code:"Delete",key:"Delete"},{code:"PageUp",key:"PageUp"},{code:"PageDown",key:"PageDown"},{code:"Fn",key:"Fn"},{code:"Symbol",key:"Symbol"},{code:"AltRight",key:"AltGraph"}],MUe=[{name:"MouseLeft",pointerType:"mouse",button:"primary"},{name:"MouseRight",pointerType:"mouse",button:"secondary"},{name:"MouseMiddle",pointerType:"mouse",button:"auxiliary"},{name:"TouchA",pointerType:"touch"},{name:"TouchB",pointerType:"touch"},{name:"TouchC",pointerType:"touch"}];function kUe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class yce{getButtons(){let e=0;for(const t of Object.keys(this.pressed))e|=2**Number(t);return e}down(e){const t=w7(e.button);if(t in this.pressed){this.pressed[t].push(e);return}return this.pressed[t]=[e],t}up(e){const t=w7(e.button);if(t in this.pressed&&(this.pressed[t]=this.pressed[t].filter(r=>r.name!==e.name),this.pressed[t].length===0))return delete this.pressed[t],t}constructor(){kUe(this,"pressed",{})}}const QZ={primary:0,secondary:1,auxiliary:2,back:3,X1:3,forward:4,X2:4};function w7(n=0){return n in QZ?QZ[n]:Number(n)}const JZ={1:2,2:1};function R7(n){return n=w7(n),n in JZ?JZ[n]:n}function OUe(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class IUe{get countPressed(){return this.pressedKeys.size}isPressed(e){return this.pressedKeys.has(e.name)}addPressed(e){return this.pressedKeys.add(e.name)}removePressed(e){return this.pressedKeys.delete(e.name)}constructor(){OUe(this,"pressedKeys",new Set)}}function y2(n,e){const t=[];for(let s=n;s;s=s.parentElement)t.push(s);const r=[];for(let s=e;s;s=s.parentElement)r.push(s);let i=0;for(;!(i>=t.length||i>=r.length||t[t.length-1-i]!==r[r.length-1-i]);i++);return[t.slice(0,t.length-i),r.slice(0,r.length-i),r.slice(r.length-i)]}function A7({target:n,node:e,offset:t}){return Yv(n)?{node:n,offset:t??Xv(n).length}:e?{node:e,offset:t??(e.nodeType===3?e.nodeValue.length:e.childNodes.length)}:bce(n,t)}function bce(n,e,t=!0){let r=e===void 0?n.childNodes.length-1:0;const i=e===void 0?-1:1;for(;e===void 0?r>=(t?Math.max(n.childNodes.length-1,0):0):r<=n.childNodes.length;){if(e&&r===n.childNodes.length)throw new Error("The given offset is out of bounds.");const s=n.childNodes.item(r),a=String(s.textContent);if(a.length)if(e!==void 0&&a.length<e)e-=a.length;else{if(s.nodeType===1)return bce(s,e,!1);if(s.nodeType===3)return{node:s,offset:e??s.nodeValue.length}}r+=i}return{node:n,offset:n.childNodes.length}}function NUe({document:n,target:e,clickCount:t,node:r,offset:i}){if(C3e(e))return;const s=Yv(e),a=String(s?Xv(e):e.textContent),[o,l]=r?[i,i]:PUe(a,i,t);if(s)return zw(e,{anchorOffset:o??a.length,focusOffset:l??a.length}),{node:e,start:o??0,end:l??a.length};{const{node:c,offset:u}=A7({target:e,node:r,offset:o}),{node:f,offset:d}=A7({target:e,node:r,offset:l}),g=e.ownerDocument.createRange();try{g.setStart(c,u),g.setEnd(f,d)}catch{throw new Error("The given offset is out of bounds.")}const p=n.getSelection();return p?.removeAllRanges(),p?.addRange(g.cloneRange()),g}}function PUe(n,e,t){if(t%3===1||n.length===0)return[e,e];const r=e??n.length;return t%3===2?[r-n.substr(0,e).match(/(\w+|\s+|\W)?$/)[0].length,e===void 0?e:e+n.substr(e).match(/^(\w+|\s+|\W)?/)[0].length]:[r-n.substr(0,e).match(/[^\r\n]*$/)[0].length,e===void 0?e:e+n.substr(e).match(/^[^\r\n]*/)[0].length]}function DUe(n,{document:e,target:t,node:r,offset:i}){const s=A7({target:t,node:r,offset:i});if("node"in n){if(s.node===n.node){const a=s.offset<n.start?n.end:n.start,o=s.offset>n.end||s.offset<n.start?s.offset:n.end;zw(n.node,{anchorOffset:a,focusOffset:o})}}else{const a=n.cloneRange(),o=a.comparePoint(s.node,s.offset);o<0?a.setStart(s.node,s.offset):o>0&&a.setEnd(s.node,s.offset);const l=e.getSelection();l?.removeAllRanges(),l?.addRange(a.cloneRange())}}function Sce(n,e){var t,r,i,s,a,o,l,c,u,f,d,g,p,_,y,v,x,E,M,O,N,I,D,V;return n.target!==e.target||((t=n.coords)===null||t===void 0?void 0:t.x)!==((r=e.coords)===null||r===void 0?void 0:r.x)||((i=n.coords)===null||i===void 0?void 0:i.y)!==((s=e.coords)===null||s===void 0?void 0:s.y)||((a=n.coords)===null||a===void 0?void 0:a.clientX)!==((o=e.coords)===null||o===void 0?void 0:o.clientX)||((l=n.coords)===null||l===void 0?void 0:l.clientY)!==((c=e.coords)===null||c===void 0?void 0:c.clientY)||((u=n.coords)===null||u===void 0?void 0:u.offsetX)!==((f=e.coords)===null||f===void 0?void 0:f.offsetX)||((d=n.coords)===null||d===void 0?void 0:d.offsetY)!==((g=e.coords)===null||g===void 0?void 0:g.offsetY)||((p=n.coords)===null||p===void 0?void 0:p.pageX)!==((_=e.coords)===null||_===void 0?void 0:_.pageX)||((y=n.coords)===null||y===void 0?void 0:y.pageY)!==((v=e.coords)===null||v===void 0?void 0:v.pageY)||((x=n.coords)===null||x===void 0?void 0:x.screenX)!==((E=e.coords)===null||E===void 0?void 0:E.screenX)||((M=n.coords)===null||M===void 0?void 0:M.screenY)!==((O=e.coords)===null||O===void 0?void 0:O.screenY)||((N=n.caret)===null||N===void 0?void 0:N.node)!==((I=e.caret)===null||I===void 0?void 0:I.node)||((D=n.caret)===null||D===void 0?void 0:D.offset)!==((V=e.caret)===null||V===void 0?void 0:V.offset)}function vS(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class LUe{move(e,t,r){const i=this.position,s=this.getTarget(e);if(this.position=t,!Sce(i,t))return;const a=this.getTarget(e),o=this.getEventInit("mousemove"),[l,c]=y2(s,a);return{leave:()=>{s!==a&&(e.dispatchUIEvent(s,"mouseout",o),l.forEach(u=>e.dispatchUIEvent(u,"mouseleave",o)))},enter:()=>{s!==a&&(e.dispatchUIEvent(a,"mouseover",o),c.forEach(u=>e.dispatchUIEvent(u,"mouseenter",o)))},move:()=>{r||(e.dispatchUIEvent(a,"mousemove",o),this.modifySelecting(e))}}}down(e,t,r){const i=this.buttons.down(t);if(i===void 0)return;const s=this.getTarget(e);this.buttonDownTarget[i]=s;const a=this.getEventInit("mousedown",t.button),o=ab(s);!r&&(o||e.dispatchUIEvent(s,"mousedown",a))&&(this.startSelecting(e,a.detail),T1(s)),!o&&R7(t.button)===2&&e.dispatchUIEvent(s,"contextmenu",this.getEventInit("contextmenu",t.button))}up(e,t,r){const i=this.buttons.up(t);if(i===void 0)return;const s=this.getTarget(e);if(!ab(s)){if(!r){const o=this.getEventInit("mouseup",t.button);e.dispatchUIEvent(s,"mouseup",o),this.endSelecting()}const a=y2(this.buttonDownTarget[i],s)[2][0];if(a){const o=this.getEventInit("click",t.button);o.detail&&(e.dispatchUIEvent(a,o.button===0?"click":"auxclick",o),o.button===0&&o.detail===2&&e.dispatchUIEvent(a,"dblclick",{...this.getEventInit("dblclick",t.button),detail:o.detail}))}}}resetClickCount(){this.clickCount.reset()}getEventInit(e,t){const r={...this.position.coords};return r.button=R7(t),r.buttons=this.buttons.getButtons(),e==="mousedown"?r.detail=this.clickCount.getOnDown(r.button):e==="mouseup"?r.detail=this.clickCount.getOnUp(r.button):(e==="click"||e==="auxclick")&&(r.detail=this.clickCount.incOnClick(r.button)),r}getTarget(e){var t;return(t=this.position.target)!==null&&t!==void 0?t:e.config.document.body}startSelecting(e,t){var r,i;this.selecting=NUe({document:e.config.document,target:this.getTarget(e),node:(r=this.position.caret)===null||r===void 0?void 0:r.node,offset:(i=this.position.caret)===null||i===void 0?void 0:i.offset,clickCount:t})}modifySelecting(e){var t,r;this.selecting&&DUe(this.selecting,{document:e.config.document,target:this.getTarget(e),node:(t=this.position.caret)===null||t===void 0?void 0:t.node,offset:(r=this.position.caret)===null||r===void 0?void 0:r.offset})}endSelecting(){this.selecting=void 0}constructor(){vS(this,"position",{}),vS(this,"buttons",new yce),vS(this,"selecting",void 0),vS(this,"buttonDownTarget",{}),vS(this,"clickCount",new class{incOnClick(e){const t=this.down[e]===void 0?void 0:Number(this.down[e])+1;return this.count=this.count[e]===void 0?{}:{[e]:Number(this.count[e])+1},t}getOnDown(e){var t;this.down={[e]:(t=this.count[e])!==null&&t!==void 0?t:0};var r;return this.count={[e]:(r=this.count[e])!==null&&r!==void 0?r:0},Number(this.count[e])+1}getOnUp(e){return this.down[e]===void 0?void 0:Number(this.down[e])+1}reset(){this.count={}}constructor(){vS(this,"down",{}),vS(this,"count",{})}})}}function wD(n,e){var t;return((t=Ece(n,e))===null||t===void 0?void 0:t.pointerEvents)!=="none"}function UUe(n){const e=G0(n);for(let t=n,r=[];t?.ownerDocument;t=t.parentElement){r.push(t);const i=e.getComputedStyle(t).pointerEvents;if(i&&!["inherit","unset"].includes(i))return{pointerEvents:i,tree:r}}}const eQ=Symbol("Last check for pointer-events");function Ece(n,e){const t=e[eQ];if(!(n.config.pointerEventsCheck!==BN.Never&&(!t||tQ(n.config.pointerEventsCheck,BN.EachApiCall)&&t[Tg.Call]!==OI(n,Tg.Call)||tQ(n.config.pointerEventsCheck,BN.EachTrigger)&&t[Tg.Trigger]!==OI(n,Tg.Trigger))))return t?.result;const i=UUe(e);return e[eQ]={[Tg.Call]:OI(n,Tg.Call),[Tg.Trigger]:OI(n,Tg.Trigger),result:i},i}function ZM(n,e){const t=Ece(n,e);if(t?.pointerEvents==="none")throw new Error([`Unable to perform pointer interaction as the element ${t.tree.length>1?"inherits":"has"} \`pointer-events: none\`:`,"",BUe(t.tree)].join(`
`))}function BUe(n){return n.reverse().map((e,t)=>["".padEnd(t),e.tagName,e.id&&`#${e.id}`,e.hasAttribute("data-testid")&&`(testId=${e.getAttribute("data-testid")})`,FUe(e),n.length>1&&t===0&&"  <-- This element declared `pointer-events: none`",n.length>1&&t===n.length-1&&"  <-- Asserted pointer events here"].filter(Boolean).join("")).join(`
`)}function FUe(n){var e;let t;if(n.hasAttribute("aria-label"))t=n.getAttribute("aria-label");else if(n.hasAttribute("aria-labelledby")){var r,i;t=(i=n.ownerDocument.getElementById(n.getAttribute("aria-labelledby")))===null||i===void 0||(r=i.textContent)===null||r===void 0?void 0:r.trim()}else if(Ds(n,["button","input","meter","output","progress","select","textarea"])&&(!((e=n.labels)===null||e===void 0)&&e.length))t=Array.from(n.labels).map(a=>{var o;return(o=a.textContent)===null||o===void 0?void 0:o.trim()}).join("|");else if(Ds(n,"button")){var s;t=(s=n.textContent)===null||s===void 0?void 0:s.trim()}return t=t?.replace(/\n/g,"  "),Number(t?.length)>30&&(t=`${t?.substring(0,29)}`),t?`(label=${t})`:""}function tQ(n,e){return(n&e)>0}function Ey(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class zUe{init(e){const t=this.getTarget(e),[,r]=y2(null,t),i=this.getEventInit();return ZM(e,t),e.dispatchUIEvent(t,"pointerover",i),r.forEach(s=>e.dispatchUIEvent(s,"pointerenter",i)),this}move(e,t){const r=this.position,i=this.getTarget(e);if(this.position=t,!Sce(r,t))return;const s=this.getTarget(e),a=this.getEventInit(-1),[o,l]=y2(i,s);return{leave:()=>{wD(e,i)&&i!==s&&(e.dispatchUIEvent(i,"pointerout",a),o.forEach(c=>e.dispatchUIEvent(c,"pointerleave",a)))},enter:()=>{ZM(e,s),i!==s&&(e.dispatchUIEvent(s,"pointerover",a),l.forEach(c=>e.dispatchUIEvent(c,"pointerenter",a)))},move:()=>{e.dispatchUIEvent(s,"pointermove",a)}}}down(e,t=0){if(this.isDown)return;const r=this.getTarget(e);ZM(e,r),this.isDown=!0,this.isPrevented=!e.dispatchUIEvent(r,"pointerdown",this.getEventInit(t))}up(e,t=0){if(!this.isDown)return;const r=this.getTarget(e);ZM(e,r),this.isPrevented=!1,this.isDown=!1,e.dispatchUIEvent(r,"pointerup",this.getEventInit(t))}release(e){const t=this.getTarget(e),[r]=y2(t,null),i=this.getEventInit();wD(e,t)&&(e.dispatchUIEvent(t,"pointerout",i),r.forEach(s=>e.dispatchUIEvent(s,"pointerleave",i))),this.isCancelled=!0}getTarget(e){var t;return(t=this.position.target)!==null&&t!==void 0?t:e.config.document.body}getEventInit(e){return{...this.position.coords,pointerId:this.pointerId,pointerType:this.pointerType,isPrimary:this.isPrimary,button:R7(e),buttons:this.buttons.getButtons()}}constructor({pointerId:e,pointerType:t,isPrimary:r},i){Ey(this,"pointerId",void 0),Ey(this,"pointerType",void 0),Ey(this,"isPrimary",void 0),Ey(this,"buttons",void 0),Ey(this,"isMultitouch",!1),Ey(this,"isCancelled",!1),Ey(this,"isDown",!1),Ey(this,"isPrevented",!1),Ey(this,"position",{}),this.pointerId=e,this.pointerType=t,this.isPrimary=r,this.isMultitouch=!r,this.buttons=i}}function Hb(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class jUe{isKeyPressed(e){return this.devices.get(e.pointerType).isPressed(e)}async press(e,t,r){this.devices.get(t.pointerType).addPressed(t),this.buttons.down(t);const i=this.getPointerName(t),s=t.pointerType==="touch"?this.pointers.new(i,t.pointerType,this.buttons):this.pointers.get(i);s.position=r,s.pointerType!=="touch"&&(this.mouse.position=r),s.pointerType==="touch"&&s.init(e),s.down(e,t.button),s.pointerType!=="touch"&&this.mouse.down(e,t,s.isPrevented)}async move(e,t,r){const i=this.pointers.get(t),s=i.move(e,r),a=i.pointerType==="touch"?void 0:this.mouse.move(e,r,i.isPrevented);s?.leave(),a?.leave(),s?.enter(),a?.enter(),s?.move(),a?.move()}async release(e,t,r){const i=this.devices.get(t.pointerType);i.removePressed(t),this.buttons.up(t);const s=this.pointers.get(this.getPointerName(t)),a=s.isPrevented;if(s.position=r,s.pointerType!=="touch"&&(this.mouse.position=r),i.countPressed===0&&s.up(e,t.button),s.pointerType==="touch"&&s.release(e),s.pointerType==="touch"&&!s.isMultitouch){const o=this.mouse.move(e,r,a);o?.leave(),o?.enter(),o?.move(),this.mouse.down(e,t,a)}if(!s.isMultitouch){const o=this.mouse.move(e,r,a);o?.leave(),o?.enter(),o?.move(),this.mouse.up(e,t,a)}}getPointerName(e){return e.pointerType==="touch"?e.name:e.pointerType}getPreviousPosition(e){return this.pointers.has(e)?this.pointers.get(e).position:void 0}resetClickCount(){this.mouse.resetClickCount()}getMouseTarget(e){var t;return(t=this.mouse.position.target)!==null&&t!==void 0?t:e.config.document.body}setMousePosition(e){this.mouse.position=e,this.pointers.get("mouse").position=e}constructor(e){Hb(this,"system",void 0),Hb(this,"mouse",void 0),Hb(this,"buttons",void 0),Hb(this,"devices",new class{get(t){var r,i,s;return(s=(r=this.registry)[i=t])!==null&&s!==void 0?s:r[i]=new IUe}constructor(){Hb(this,"registry",{})}}),Hb(this,"pointers",new class{new(t,r,i){const s=r!=="touch"||!Object.values(this.registry).some(a=>a.pointerType==="touch"&&!a.isCancelled);return s||Object.values(this.registry).forEach(a=>{a.pointerType===r&&!a.isCancelled&&(a.isMultitouch=!0)}),this.registry[t]=new zUe({pointerId:this.nextId++,pointerType:r,isPrimary:s},i),this.registry[t]}get(t){if(!this.has(t))throw new Error(`Trying to access pointer "${t}" which does not exist.`);return this.registry[t]}has(t){return t in this.registry}constructor(){Hb(this,"registry",{}),Hb(this,"nextId",1)}}),this.system=e,this.buttons=new yce,this.mouse=new LUe,this.pointers.new("mouse","mouse",this.buttons)}}function nQ(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}class xce{getUIEventModifiers(){return{altKey:this.keyboard.modifiers.Alt,ctrlKey:this.keyboard.modifiers.Control,metaKey:this.keyboard.modifiers.Meta,shiftKey:this.keyboard.modifiers.Shift,modifierAltGraph:this.keyboard.modifiers.AltGraph,modifierCapsLock:this.keyboard.modifiers.CapsLock,modifierFn:this.keyboard.modifiers.Fn,modifierFnLock:this.keyboard.modifiers.FnLock,modifierNumLock:this.keyboard.modifiers.NumLock,modifierScrollLock:this.keyboard.modifiers.ScrollLock,modifierSymbol:this.keyboard.modifiers.Symbol,modifierSymbolLock:this.keyboard.modifiers.SymbolLock}}constructor(){nQ(this,"keyboard",new AUe(this)),nQ(this,"pointer",new jUe(this))}}async function HUe(n){const e=[];return this.config.skipHover||e.push({target:n}),e.push({keys:"[MouseLeft]",target:n}),this.pointer(e)}async function qUe(n){return this.pointer([{target:n},"[MouseLeft][MouseLeft]"])}async function VUe(n){return this.pointer([{target:n},"[MouseLeft][MouseLeft][MouseLeft]"])}async function GUe(n){return this.pointer({target:n})}async function $Ue(n){return ZM(this,this.system.pointer.getMouseTarget(this)),this.pointer({target:n.ownerDocument.body})}async function WUe({shift:n}={}){return this.keyboard(n===!0?"{Shift>}{Tab}{/Shift}":n===!1?"[/ShiftLeft][/ShiftRight]{Tab}":"{Tab}")}var Rj=(function(n){return n["{"]="}",n["["]="]",n})(Rj||{});function Tce(n,e){let t=0;const r=n[t]in Rj?n[t]:"";t+=r.length;const s=new RegExp(`^\\${r}{2}`).test(n)?"":r;return{type:s,...s===""?YUe(n,t,e):XUe(n,t,s,e)}}function YUe(n,e,t){const r=n[e];return wce(r,n,e,t),e+=r.length,{consumedLength:e,descriptor:r,releasePrevious:!1,releaseSelf:!0,repeat:1}}function XUe(n,e,t,r){var i,s;const a=n[e]==="/"?"/":"";e+=a.length;const o=t==="{"&&n[e]==="\\";e+=Number(o);const l=o?n[e]:(i=n.slice(e).match(t==="{"?/^\w+|^[^}>/]/:/^\w+/))===null||i===void 0?void 0:i[0];wce(l,n,e,r),e+=l.length;var c;const u=(c=(s=n.slice(e).match(/^>\d+/))===null||s===void 0?void 0:s[0])!==null&&c!==void 0?c:"";e+=u.length;const f=n[e]==="/"||!u&&n[e]===">"?n[e]:"";e+=f.length;const d=Rj[t],g=n[e]===d?d:"";if(!g)throw new Error(Rce([!u&&"repeat modifier",!f&&"release modifier",`"${d}"`].filter(Boolean).join(" or "),n[e],n,r));return e+=g.length,{consumedLength:e,descriptor:l,releasePrevious:!!a,repeat:u?Math.max(Number(u.substr(1)),1):1,releaseSelf:KUe(f,u)}}function wce(n,e,t,r){if(!n)throw new Error(Rce("key descriptor",e[t],e,r))}function KUe(n,e){if(n)return n==="/";if(e)return!1}function Rce(n,e,t,r){return`Expected ${n} but found "${e??""}" in "${t}"
    See ${r==="pointer"?"https://testing-library.com/docs/user-event/pointer#pressing-a-button-or-touching-the-screen":"https://testing-library.com/docs/user-event/keyboard"}
    for more information about how userEvent parses your input.`}function ZUe(n,e){const t=[];do{const{type:i,descriptor:s,consumedLength:a,releasePrevious:o,releaseSelf:l=!0,repeat:c}=Tce(e,"keyboard");var r;const u=(r=n.find(f=>{if(i==="["){var d;return((d=f.code)===null||d===void 0?void 0:d.toLowerCase())===s.toLowerCase()}else if(i==="{"){var g;return((g=f.key)===null||g===void 0?void 0:g.toLowerCase())===s.toLowerCase()}return f.key===s}))!==null&&r!==void 0?r:{key:"Unknown",code:"Unknown",[i==="["?"code":"key"]:s};t.push({keyDef:u,releasePrevious:o,releaseSelf:l,repeat:c}),e=e.slice(a)}while(e);return t}async function QUe(n){const e=ZUe(this.config.keyboardMap,n);for(let t=0;t<e.length;t++)await JT(this.config),await JUe(this,e[t])}async function JUe(n,{keyDef:e,releasePrevious:t,releaseSelf:r,repeat:i}){const{system:s}=n;if(s.keyboard.isKeyPressed(e)&&await s.keyboard.keyup(n,e),!t){for(let a=1;a<=i;a++)await s.keyboard.keydown(n,e),a<i&&await JT(n.config);r&&await s.keyboard.keyup(n,e)}}async function e5e(n){for(const e of n.system.keyboard.getPressedKeys())await n.system.keyboard.keyup(n,e)}function Ace(n){const e=Yv(n)?{"text/plain":t5e(n)}:{"text/plain":String(n.ownerDocument.getSelection())},t=hj(G0(n));for(const r in e)e[r]&&t.setData(r,e[r]);return t}function t5e(n){const e=tk(n);return Xv(n).substring(e.startOffset,e.endOffset)}async function n5e(){const n=this.config.document;var e;const t=(e=n.activeElement)!==null&&e!==void 0?e:n.body,r=Ace(t);if(r.items.length!==0)return this.dispatchUIEvent(t,"copy",{clipboardData:r})&&this.config.writeToClipboard&&await xle(n,r),r}async function r5e(){const n=this.config.document;var e;const t=(e=n.activeElement)!==null&&e!==void 0?e:n.body,r=Ace(t);if(r.items.length!==0)return this.dispatchUIEvent(t,"cut",{clipboardData:r})&&this.config.writeToClipboard&&await xle(t.ownerDocument,r),r}async function i5e(n){const e=this.config.document;var t;const r=(t=e.activeElement)!==null&&t!==void 0?t:e.body;var i;const s=(i=typeof n=="string"?s5e(e,n):n)!==null&&i!==void 0?i:await T3e(e).catch(()=>{throw new Error("`userEvent.paste()` without `clipboardData` requires the `ClipboardAPI` to be available.")});this.dispatchUIEvent(r,"paste",{clipboardData:s})}function s5e(n,e){const t=hj(G0(n));return t.setData("text",e),t}function rQ(n,e){const t=[];do{const{descriptor:r,consumedLength:i,releasePrevious:s,releaseSelf:a=!0}=Tce(e,"pointer"),o=n.find(l=>l.name===r);o&&t.push({keyDef:o,releasePrevious:s,releaseSelf:a}),e=e.slice(i)}while(e);return t}async function a5e(n){const{pointerMap:e}=this.config,t=[];(Array.isArray(n)?n:[n]).forEach(r=>{typeof r=="string"?t.push(...rQ(e,r)):"keys"in r?t.push(...rQ(e,r.keys).map(i=>({...r,...i}))):t.push(r)});for(let r=0;r<t.length;r++)await JT(this.config),await o5e(this,t[r]);this.system.pointer.resetClickCount()}async function o5e(n,e){var t,r;const i="pointerName"in e&&e.pointerName?e.pointerName:"keyDef"in e?n.system.pointer.getPointerName(e.keyDef):"mouse",s=n.system.pointer.getPreviousPosition(i);var a,o,l,c;const u={target:(a=e.target)!==null&&a!==void 0?a:l5e(n,s),coords:(o=e.coords)!==null&&o!==void 0?o:s?.coords,caret:{node:(l=e.node)!==null&&l!==void 0?l:iQ(e)||s==null||(t=s.caret)===null||t===void 0?void 0:t.node,offset:(c=e.offset)!==null&&c!==void 0?c:iQ(e)||s==null||(r=s.caret)===null||r===void 0?void 0:r.offset}};"keyDef"in e?(n.system.pointer.isKeyPressed(e.keyDef)&&(KM(n,Tg.Trigger),await n.system.pointer.release(n,e.keyDef,u)),e.releasePrevious||(KM(n,Tg.Trigger),await n.system.pointer.press(n,e.keyDef,u),e.releaseSelf&&(KM(n,Tg.Trigger),await n.system.pointer.release(n,e.keyDef,u)))):(KM(n,Tg.Trigger),await n.system.pointer.move(n,i,u))}function iQ(n){var e,t;return!!((t=(e=n.target)!==null&&e!==void 0?e:n.node)!==null&&t!==void 0?t:n.offset!==void 0)}function l5e(n,e){if(!e)throw new Error("This pointer has no previous position. Provide a target property!");var t;return(t=e.target)!==null&&t!==void 0?t:n.config.document.body}async function c5e(n){if(!XT(n)||ab(n))throw new Error("clear()` is only supported on editable elements.");if(T1(n),n.ownerDocument.activeElement!==n)throw new Error("The element to be cleared could not be focused.");if(hce(n),!iUe(n))throw new Error("The element content to be cleared could not be selected.");QT(this,n,"","deleteContentBackward")}async function u5e(n,e){return Cce.call(this,!0,n,e)}async function f5e(n,e){return Cce.call(this,!1,n,e)}async function Cce(n,e,t){if(!n&&!e.multiple)throw Za().getElementError("Unable to deselect an option in a non-multiple select. Use selectOptions to change the selection instead.",e);const r=Array.isArray(t)?t:[t],i=Array.from(e.querySelectorAll('option, [role="option"]')),s=r.map(o=>{if(typeof o!="string"&&i.includes(o))return o;{const l=i.find(c=>c.value===o||c.innerHTML===o);if(l)return l;throw Za().getElementError(`Value "${String(o)}" not found in options`,e)}}).filter(o=>!ab(o));if(ab(e)||!s.length)return;const a=o=>{o.selected=n,this.dispatchUIEvent(e,"input",{bubbles:!0,cancelable:!1,composed:!0}),this.dispatchUIEvent(e,"change")};if(Ds(e,"select"))if(e.multiple)for(const o of s){const l=this.config.pointerEventsCheck===0?!0:wD(this,o);l&&(this.dispatchUIEvent(o,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(o,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(o,"pointermove"),this.dispatchUIEvent(o,"mousemove"),this.dispatchUIEvent(o,"pointerdown"),this.dispatchUIEvent(o,"mousedown")),T1(e),l&&(this.dispatchUIEvent(o,"pointerup"),this.dispatchUIEvent(o,"mouseup")),a(o),l&&this.dispatchUIEvent(o,"click"),await JT(this.config)}else if(s.length===1){const o=this.config.pointerEventsCheck===0?!0:wD(this,e);o?await this.click(e):T1(e),a(s[0]),o&&(this.dispatchUIEvent(e,"pointerover"),this.dispatchUIEvent(e,"pointerenter"),this.dispatchUIEvent(e,"mouseover"),this.dispatchUIEvent(e,"mouseenter"),this.dispatchUIEvent(e,"pointerup"),this.dispatchUIEvent(e,"mouseup"),this.dispatchUIEvent(e,"click")),await JT(this.config)}else throw Za().getElementError("Cannot select multiple options on a non-multiple select",e);else if(e.getAttribute("role")==="listbox")for(const o of s)await this.click(o),await this.unhover(o);else throw Za().getElementError("Cannot select options on elements that are neither select nor listbox elements",e)}async function h5e(n,e,{skipClick:t=this.config.skipClick,skipAutoClose:r=this.config.skipAutoClose,initialSelectionStart:i,initialSelectionEnd:s}={}){n.disabled||(t||await this.click(n),i!==void 0&&XM(n,i,s??i),await this.keyboard(e),r||await e5e(this))}const sQ=Symbol("files and value properties are mocked");function cB(n,e,t){t?Object.defineProperty(n,e,t):delete n[e]}function d5e(n,e){var t;(t=n[sQ])===null||t===void 0||t.restore();const r=Object.getOwnPropertyDescriptor(n,"type"),i=Object.getOwnPropertyDescriptor(n,"value"),s=Object.getOwnPropertyDescriptor(n,"files");function a(){cB(n,"type",r),cB(n,"value",i),cB(n,"files",s)}n[sQ]={restore:a},Object.defineProperties(n,{files:{configurable:!0,get:()=>e},value:{configurable:!0,get:()=>e.length?`C:\\fakepath\\${e[0].name}`:"",set(o){if(o==="")a();else{var l;i==null||(l=i.set)===null||l===void 0||l.call(n,o)}}},type:{configurable:!0,get:()=>"file",set(o){o!=="file"&&(a(),n.type=o)}}})}async function p5e(n,e){const t=Ds(n,"label")?n.control:n;if(!t||!Ds(t,"input",{type:"file"}))throw new TypeError(`The ${t===n?"given":"associated"} ${t?.tagName} element does not accept file uploads`);if(ab(n))return;const r=(Array.isArray(e)?e:[e]).filter(s=>!this.config.applyAccept||m5e(s,t.accept)).slice(0,t.multiple?void 0:1),i=()=>{var s;r.length===((s=t.files)===null||s===void 0?void 0:s.length)&&r.every((a,o)=>{var l;return a===((l=t.files)===null||l===void 0?void 0:l.item(o))})||(d5e(t,fj(G0(n),r)),this.dispatchUIEvent(t,"input"),this.dispatchUIEvent(t,"change"))};t.addEventListener("fileDialog",i),await this.click(n),t.removeEventListener("fileDialog",i)}function II(n){return n.toLowerCase().replace(/(\.|\/)jpg\b/g,"$1jpeg")}function m5e(n,e){if(!e)return!0;const t=["audio/*","image/*","video/*"];return II(e).trim().split(/\s*,\s*/).some(r=>r.startsWith(".")?II(n.name).endsWith(r):t.includes(r)?II(n.type).startsWith(r.replace("*","")):II(n.type)===r)}const aQ={click:HUe,dblClick:qUe,tripleClick:VUe,hover:GUe,unhover:$Ue,tab:WUe,keyboard:QUe,copy:n5e,cut:r5e,paste:i5e,pointer:a5e,clear:c5e,deselectOptions:f5e,selectOptions:u5e,type:h5e,upload:p5e};function g5e(n){return Za().asyncWrapper(n)}const Mce={applyAccept:!0,autoModify:!0,delay:0,document:globalThis.document,keyboardMap:CUe,pointerMap:MUe,pointerEventsCheck:BN.EachApiCall,skipAutoClose:!1,skipClick:!1,skipHover:!1,writeToClipboard:!1,advanceTimers:()=>Promise.resolve()},_5e={...Mce,writeToClipboard:!0};function kce(n={},e=_5e,t){const r=S5e(n,t,e);return{...e,...n,document:r}}function v5e(n={}){const e=kce(n);vce(e.document),_ce(G0(e.document).HTMLElement);var t;const r=(t=e.document.defaultView)!==null&&t!==void 0?t:globalThis.window;return S3e(r),Aj(e).api}function sp({keyboardState:n,pointerState:e,...t}={},r){const i=kce(t,Mce,r);vce(i.document),_ce(G0(i.document).HTMLElement);var s;const a=(s=e??n)!==null&&s!==void 0?s:new xce;return{api:Aj(i,a).api,system:a}}function y5e(n){return Aj({...this.config,...n},this.system).api}function b5e(n,e){function t(...r){return KM(n,Tg.Call),g5e(()=>e.apply(n,r).then(async i=>(await JT(n.config),i)))}return Object.defineProperty(t,"name",{get:()=>e.name}),t}function Aj(n,e=new xce){const t={};return Object.assign(t,{config:n,dispatchEvent:gce.bind(t),dispatchUIEvent:vUe.bind(t),system:e,levelRefs:{},...aQ}),{instance:t,api:{...Object.fromEntries(Object.entries(aQ).map(([r,i])=>[r,b5e(t,i)])),setup:y5e.bind(t)}}}function S5e(n,e,t){var r,i;return(i=(r=n.document)!==null&&r!==void 0?r:e&&xUe(e))!==null&&i!==void 0?i:t.document}function E5e(n){return sp().api.clear(n)}function x5e(n,e={}){return sp(e,n).api.click(n)}function T5e(n={}){return sp(n).api.copy()}function w5e(n={}){return sp(n).api.cut()}function R5e(n,e={}){return sp(e).api.dblClick(n)}function A5e(n,e,t={}){return sp(t).api.deselectOptions(n,e)}function C5e(n,e={}){return sp(e).api.hover(n)}async function M5e(n,e={}){const{api:t,system:r}=sp(e);return t.keyboard(n).then(()=>r)}async function k5e(n,e={}){const{api:t,system:r}=sp(e);return t.pointer(n).then(()=>r)}function O5e(n,e){return sp(e).api.paste(n)}function I5e(n,e,t={}){return sp(t).api.selectOptions(n,e)}function N5e(n,e={}){return sp(e).api.tripleClick(n)}function P5e(n,e,t={}){return sp(t,n).api.type(n,e,t)}function D5e(n,e={}){const{api:t,system:r}=sp(e);return r.pointer.setMousePosition({target:n}),t.unhover(n)}function L5e(n,e,t={}){return sp(t).api.upload(n,e)}function U5e(n={}){return sp().api.tab(n)}const B5e=Object.freeze(Object.defineProperty({__proto__:null,clear:E5e,click:x5e,copy:T5e,cut:w5e,dblClick:R5e,deselectOptions:A5e,hover:C5e,keyboard:M5e,paste:O5e,pointer:k5e,selectOptions:I5e,tab:U5e,tripleClick:N5e,type:P5e,unhover:D5e,upload:L5e},Symbol.toStringTag,{value:"Module"})),F5e={...B5e,setup:v5e},z5e=32,p_=F5e.setup({delay:z5e});function Qo(){return window.sysclipboard}async function Cj(n){const e=Mg(1111111,9999999),t=qr(n.replace(/[^a-zA-Z/]/g,""));return await(await fetch(`https://raw.githubusercontent.com/wiki/goldbuick/zed-software-system/${t}.md?q=${e}`)).text()}function Mj(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var ZE=Mj();function Oce(n){ZE=n}var b2={exec:()=>null};function yo(n,e=""){let t=typeof n=="string"?n:n.source,r={replace:(i,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(Lp.caret,"$1"),t=t.replace(i,a),r},getRegex:()=>new RegExp(t,e)};return r}var Lp={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:n=>new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}#`),htmlBeginRegex:n=>new RegExp(`^ {0,${Math.min(3,n-1)}}<(?:[a-z].*>|!--)`,"i")},j5e=/^(?:[ \t]*(?:\n|$))+/,H5e=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,q5e=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,uO=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,V5e=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,kj=/(?:[*+-]|\d{1,9}[.)])/,Ice=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,Nce=yo(Ice).replace(/bull/g,kj).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),G5e=yo(Ice).replace(/bull/g,kj).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),Oj=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,$5e=/^[^\n]+/,Ij=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,W5e=yo(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",Ij).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Y5e=yo(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,kj).getRegex(),N4="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",Nj=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,X5e=yo("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",Nj).replace("tag",N4).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),Pce=yo(Oj).replace("hr",uO).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N4).getRegex(),K5e=yo(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",Pce).getRegex(),Pj={blockquote:K5e,code:H5e,def:W5e,fences:q5e,heading:V5e,hr:uO,html:X5e,lheading:Nce,list:Y5e,newline:j5e,paragraph:Pce,table:b2,text:$5e},oQ=yo("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",uO).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N4).getRegex(),Z5e={...Pj,lheading:G5e,table:oQ,paragraph:yo(Oj).replace("hr",uO).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",oQ).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",N4).getRegex()},Q5e={...Pj,html:yo(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",Nj).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:b2,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:yo(Oj).replace("hr",uO).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Nce).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},J5e=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,e6e=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,Dce=/^( {2,}|\\)\n(?!\s*$)/,t6e=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,P4=/[\p{P}\p{S}]/u,Dj=/[\s\p{P}\p{S}]/u,Lce=/[^\s\p{P}\p{S}]/u,n6e=yo(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,Dj).getRegex(),Uce=/(?!~)[\p{P}\p{S}]/u,r6e=/(?!~)[\s\p{P}\p{S}]/u,i6e=/(?:[^\s\p{P}\p{S}]|~)/u,s6e=/\[[^\[\]]*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)|`[^`]*?`|<(?! )[^<>]*?>/g,Bce=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,a6e=yo(Bce,"u").replace(/punct/g,P4).getRegex(),o6e=yo(Bce,"u").replace(/punct/g,Uce).getRegex(),Fce="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",l6e=yo(Fce,"gu").replace(/notPunctSpace/g,Lce).replace(/punctSpace/g,Dj).replace(/punct/g,P4).getRegex(),c6e=yo(Fce,"gu").replace(/notPunctSpace/g,i6e).replace(/punctSpace/g,r6e).replace(/punct/g,Uce).getRegex(),u6e=yo("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,Lce).replace(/punctSpace/g,Dj).replace(/punct/g,P4).getRegex(),f6e=yo(/\\(punct)/,"gu").replace(/punct/g,P4).getRegex(),h6e=yo(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),d6e=yo(Nj).replace("(?:-->|$)","-->").getRegex(),p6e=yo("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",d6e).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),RD=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`[^`]*`|[^\[\]\\`])*?/,m6e=yo(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",RD).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),zce=yo(/^!?\[(label)\]\[(ref)\]/).replace("label",RD).replace("ref",Ij).getRegex(),jce=yo(/^!?\[(ref)\](?:\[\])?/).replace("ref",Ij).getRegex(),g6e=yo("reflink|nolink(?!\\()","g").replace("reflink",zce).replace("nolink",jce).getRegex(),Lj={_backpedal:b2,anyPunctuation:f6e,autolink:h6e,blockSkip:s6e,br:Dce,code:e6e,del:b2,emStrongLDelim:a6e,emStrongRDelimAst:l6e,emStrongRDelimUnd:u6e,escape:J5e,link:m6e,nolink:jce,punctuation:n6e,reflink:zce,reflinkSearch:g6e,tag:p6e,text:t6e,url:b2},_6e={...Lj,link:yo(/^!?\[(label)\]\((.*?)\)/).replace("label",RD).getRegex(),reflink:yo(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",RD).getRegex()},C7={...Lj,emStrongRDelimAst:c6e,emStrongLDelim:o6e,url:yo(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},v6e={...C7,br:yo(Dce).replace("{2,}","*").getRegex(),text:yo(C7.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},NI={normal:Pj,gfm:Z5e,pedantic:Q5e},wM={normal:Lj,gfm:C7,breaks:v6e,pedantic:_6e},y6e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},lQ=n=>y6e[n];function ov(n,e){if(e){if(Lp.escapeTest.test(n))return n.replace(Lp.escapeReplace,lQ)}else if(Lp.escapeTestNoEncode.test(n))return n.replace(Lp.escapeReplaceNoEncode,lQ);return n}function cQ(n){try{n=encodeURI(n).replace(Lp.percentDecode,"%")}catch{return null}return n}function uQ(n,e){let t=n.replace(Lp.findPipe,(s,a,o)=>{let l=!1,c=a;for(;--c>=0&&o[c]==="\\";)l=!l;return l?"|":" |"}),r=t.split(Lp.splitPipe),i=0;if(r[0].trim()||r.shift(),r.length>0&&!r.at(-1)?.trim()&&r.pop(),e)if(r.length>e)r.splice(e);else for(;r.length<e;)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(Lp.slashPipe,"|");return r}function RM(n,e,t){let r=n.length;if(r===0)return"";let i=0;for(;i<r&&n.charAt(r-i-1)===e;)i++;return n.slice(0,r-i)}function b6e(n,e){if(n.indexOf(e[1])===-1)return-1;let t=0;for(let r=0;r<n.length;r++)if(n[r]==="\\")r++;else if(n[r]===e[0])t++;else if(n[r]===e[1]&&(t--,t<0))return r;return t>0?-2:-1}function fQ(n,e,t,r,i){let s=e.href,a=e.title||null,o=n[1].replace(i.other.outputLinkReplace,"$1");r.state.inLink=!0;let l={type:n[0].charAt(0)==="!"?"image":"link",raw:t,href:s,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function S6e(n,e,t){let r=n.match(t.other.indentCodeCompensation);if(r===null)return e;let i=r[1];return e.split(`
`).map(s=>{let a=s.match(t.other.beginningSpace);if(a===null)return s;let[o]=a;return o.length>=i.length?s.slice(i.length):s}).join(`
`)}var AD=class{options;rules;lexer;constructor(n){this.options=n||ZE}space(n){let e=this.rules.block.newline.exec(n);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(n){let e=this.rules.block.code.exec(n);if(e){let t=e[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?t:RM(t,`
`)}}}fences(n){let e=this.rules.block.fences.exec(n);if(e){let t=e[0],r=S6e(t,e[3]||"",this.rules);return{type:"code",raw:t,lang:e[2]?e[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):e[2],text:r}}}heading(n){let e=this.rules.block.heading.exec(n);if(e){let t=e[2].trim();if(this.rules.other.endingHash.test(t)){let r=RM(t,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(t=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:t,tokens:this.lexer.inline(t)}}}hr(n){let e=this.rules.block.hr.exec(n);if(e)return{type:"hr",raw:RM(e[0],`
`)}}blockquote(n){let e=this.rules.block.blockquote.exec(n);if(e){let t=RM(e[0],`
`).split(`
`),r="",i="",s=[];for(;t.length>0;){let a=!1,o=[],l;for(l=0;l<t.length;l++)if(this.rules.other.blockquoteStart.test(t[l]))o.push(t[l]),a=!0;else if(!a)o.push(t[l]);else break;t=t.slice(l);let c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,i=i?`${i}
${u}`:u;let f=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,s,!0),this.lexer.state.top=f,t.length===0)break;let d=s.at(-1);if(d?.type==="code")break;if(d?.type==="blockquote"){let g=d,p=g.raw+`
`+t.join(`
`),_=this.blockquote(p);s[s.length-1]=_,r=r.substring(0,r.length-g.raw.length)+_.raw,i=i.substring(0,i.length-g.text.length)+_.text;break}else if(d?.type==="list"){let g=d,p=g.raw+`
`+t.join(`
`),_=this.list(p);s[s.length-1]=_,r=r.substring(0,r.length-d.raw.length)+_.raw,i=i.substring(0,i.length-g.raw.length)+_.raw,t=p.substring(s.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:s,text:i}}}list(n){let e=this.rules.block.list.exec(n);if(e){let t=e[1].trim(),r=t.length>1,i={type:"list",raw:"",ordered:r,start:r?+t.slice(0,-1):"",loose:!1,items:[]};t=r?`\\d{1,9}\\${t.slice(-1)}`:`\\${t}`,this.options.pedantic&&(t=r?t:"[*+-]");let s=this.rules.other.listItemRegex(t),a=!1;for(;n;){let l=!1,c="",u="";if(!(e=s.exec(n))||this.rules.block.hr.test(n))break;c=e[0],n=n.substring(c.length);let f=e[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,v=>" ".repeat(3*v.length)),d=n.split(`
`,1)[0],g=!f.trim(),p=0;if(this.options.pedantic?(p=2,u=f.trimStart()):g?p=e[1].length+1:(p=e[2].search(this.rules.other.nonSpaceChar),p=p>4?1:p,u=f.slice(p),p+=e[1].length),g&&this.rules.other.blankLine.test(d)&&(c+=d+`
`,n=n.substring(d.length+1),l=!0),!l){let v=this.rules.other.nextBulletRegex(p),x=this.rules.other.hrRegex(p),E=this.rules.other.fencesBeginRegex(p),M=this.rules.other.headingBeginRegex(p),O=this.rules.other.htmlBeginRegex(p);for(;n;){let N=n.split(`
`,1)[0],I;if(d=N,this.options.pedantic?(d=d.replace(this.rules.other.listReplaceNesting,"  "),I=d):I=d.replace(this.rules.other.tabCharGlobal,"    "),E.test(d)||M.test(d)||O.test(d)||v.test(d)||x.test(d))break;if(I.search(this.rules.other.nonSpaceChar)>=p||!d.trim())u+=`
`+I.slice(p);else{if(g||f.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||E.test(f)||M.test(f)||x.test(f))break;u+=`
`+d}!g&&!d.trim()&&(g=!0),c+=N+`
`,n=n.substring(N.length+1),f=I.slice(p)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let _=null,y;this.options.gfm&&(_=this.rules.other.listIsTask.exec(u),_&&(y=_[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),i.items.push({type:"list_item",raw:c,task:!!_,checked:y,loose:!1,text:u,tokens:[]}),i.raw+=c}let o=i.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l=0;l<i.items.length;l++)if(this.lexer.state.top=!1,i.items[l].tokens=this.lexer.blockTokens(i.items[l].text,[]),!i.loose){let c=i.items[l].tokens.filter(f=>f.type==="space"),u=c.length>0&&c.some(f=>this.rules.other.anyLine.test(f.raw));i.loose=u}if(i.loose)for(let l=0;l<i.items.length;l++)i.items[l].loose=!0;return i}}html(n){let e=this.rules.block.html.exec(n);if(e)return{type:"html",block:!0,raw:e[0],pre:e[1]==="pre"||e[1]==="script"||e[1]==="style",text:e[0]}}def(n){let e=this.rules.block.def.exec(n);if(e){let t=e[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=e[2]?e[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):e[3];return{type:"def",tag:t,raw:e[0],href:r,title:i}}}table(n){let e=this.rules.block.table.exec(n);if(!e||!this.rules.other.tableDelimiter.test(e[2]))return;let t=uQ(e[1]),r=e[2].replace(this.rules.other.tableAlignChars,"").split("|"),i=e[3]?.trim()?e[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],s={type:"table",raw:e[0],header:[],align:[],rows:[]};if(t.length===r.length){for(let a of r)this.rules.other.tableAlignRight.test(a)?s.align.push("right"):this.rules.other.tableAlignCenter.test(a)?s.align.push("center"):this.rules.other.tableAlignLeft.test(a)?s.align.push("left"):s.align.push(null);for(let a=0;a<t.length;a++)s.header.push({text:t[a],tokens:this.lexer.inline(t[a]),header:!0,align:s.align[a]});for(let a of i)s.rows.push(uQ(a,s.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[l]})));return s}}lheading(n){let e=this.rules.block.lheading.exec(n);if(e)return{type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:this.lexer.inline(e[1])}}paragraph(n){let e=this.rules.block.paragraph.exec(n);if(e){let t=e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:t,tokens:this.lexer.inline(t)}}}text(n){let e=this.rules.block.text.exec(n);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}}escape(n){let e=this.rules.inline.escape.exec(n);if(e)return{type:"escape",raw:e[0],text:e[1]}}tag(n){let e=this.rules.inline.tag.exec(n);if(e)return!this.lexer.state.inLink&&this.rules.other.startATag.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:e[0]}}link(n){let e=this.rules.inline.link.exec(n);if(e){let t=e[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(t)){if(!this.rules.other.endAngleBracket.test(t))return;let s=RM(t.slice(0,-1),"\\");if((t.length-s.length)%2===0)return}else{let s=b6e(e[2],"()");if(s===-2)return;if(s>-1){let a=(e[0].indexOf("!")===0?5:4)+e[1].length+s;e[2]=e[2].substring(0,s),e[0]=e[0].substring(0,a).trim(),e[3]=""}}let r=e[2],i="";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=e[3]?e[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(t)?r=r.slice(1):r=r.slice(1,-1)),fQ(e,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:i&&i.replace(this.rules.inline.anyPunctuation,"$1")},e[0],this.lexer,this.rules)}}reflink(n,e){let t;if((t=this.rules.inline.reflink.exec(n))||(t=this.rules.inline.nolink.exec(n))){let r=(t[2]||t[1]).replace(this.rules.other.multipleSpaceGlobal," "),i=e[r.toLowerCase()];if(!i){let s=t[0].charAt(0);return{type:"text",raw:s,text:s}}return fQ(t,i,t[0],this.lexer,this.rules)}}emStrong(n,e,t=""){let r=this.rules.inline.emStrongLDelim.exec(n);if(!(!r||r[3]&&t.match(this.rules.other.unicodeAlphaNumeric))&&(!(r[1]||r[2])||!t||this.rules.inline.punctuation.exec(t))){let i=[...r[0]].length-1,s,a,o=i,l=0,c=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,e=e.slice(-1*n.length+i);(r=c.exec(e))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(a=[...s].length,r[3]||r[4]){o+=a;continue}else if((r[5]||r[6])&&i%3&&!((i+a)%3)){l+=a;continue}if(o-=a,o>0)continue;a=Math.min(a,a+o+l);let u=[...r[0]][0].length,f=n.slice(0,i+r.index+u+a);if(Math.min(i,a)%2){let g=f.slice(1,-1);return{type:"em",raw:f,text:g,tokens:this.lexer.inlineTokens(g)}}let d=f.slice(2,-2);return{type:"strong",raw:f,text:d,tokens:this.lexer.inlineTokens(d)}}}}codespan(n){let e=this.rules.inline.code.exec(n);if(e){let t=e[2].replace(this.rules.other.newLineCharGlobal," "),r=this.rules.other.nonSpaceChar.test(t),i=this.rules.other.startingSpaceChar.test(t)&&this.rules.other.endingSpaceChar.test(t);return r&&i&&(t=t.substring(1,t.length-1)),{type:"codespan",raw:e[0],text:t}}}br(n){let e=this.rules.inline.br.exec(n);if(e)return{type:"br",raw:e[0]}}del(n){let e=this.rules.inline.del.exec(n);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}}autolink(n){let e=this.rules.inline.autolink.exec(n);if(e){let t,r;return e[2]==="@"?(t=e[1],r="mailto:"+t):(t=e[1],r=t),{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}url(n){let e;if(e=this.rules.inline.url.exec(n)){let t,r;if(e[2]==="@")t=e[0],r="mailto:"+t;else{let i;do i=e[0],e[0]=this.rules.inline._backpedal.exec(e[0])?.[0]??"";while(i!==e[0]);t=e[0],e[1]==="www."?r="http://"+e[0]:r=e[0]}return{type:"link",raw:e[0],text:t,href:r,tokens:[{type:"text",raw:t,text:t}]}}}inlineText(n){let e=this.rules.inline.text.exec(n);if(e){let t=this.lexer.state.inRawBlock;return{type:"text",raw:e[0],text:e[0],escaped:t}}}},Gy=class M7{tokens;options;state;tokenizer;inlineQueue;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ZE,this.options.tokenizer=this.options.tokenizer||new AD,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:Lp,block:NI.normal,inline:wM.normal};this.options.pedantic?(t.block=NI.pedantic,t.inline=wM.pedantic):this.options.gfm&&(t.block=NI.gfm,this.options.breaks?t.inline=wM.breaks:t.inline=wM.gfm),this.tokenizer.rules=t}static get rules(){return{block:NI,inline:wM}}static lex(e,t){return new M7(t).lex(e)}static lexInline(e,t){return new M7(t).inlineTokens(e)}lex(e){e=e.replace(Lp.carriageReturn,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let r=this.inlineQueue[t];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],r=!1){for(this.options.pedantic&&(e=e.replace(Lp.tabCharGlobal,"    ").replace(Lp.spaceLine,""));e;){let i;if(this.options.extensions?.block?.some(a=>(i=a.call({lexer:this},e,t))?(e=e.substring(i.raw.length),t.push(i),!0):!1))continue;if(i=this.tokenizer.space(e)){e=e.substring(i.raw.length);let a=t.at(-1);i.raw.length===1&&a!==void 0?a.raw+=`
`:t.push(i);continue}if(i=this.tokenizer.code(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.at(-1).src=a.text):t.push(i);continue}if(i=this.tokenizer.fences(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.heading(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.hr(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.blockquote(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.list(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.html(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.def(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="paragraph"||a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.raw,this.inlineQueue.at(-1).src=a.text):this.tokens.links[i.tag]||(this.tokens.links[i.tag]={href:i.href,title:i.title},t.push(i));continue}if(i=this.tokenizer.table(e)){e=e.substring(i.raw.length),t.push(i);continue}if(i=this.tokenizer.lheading(e)){e=e.substring(i.raw.length),t.push(i);continue}let s=e;if(this.options.extensions?.startBlock){let a=1/0,o=e.slice(1),l;this.options.extensions.startBlock.forEach(c=>{l=c.call({lexer:this},o),typeof l=="number"&&l>=0&&(a=Math.min(a,l))}),a<1/0&&a>=0&&(s=e.substring(0,a+1))}if(this.state.top&&(i=this.tokenizer.paragraph(s))){let a=t.at(-1);r&&a?.type==="paragraph"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(i),r=s.length!==e.length,e=e.substring(i.raw.length);continue}if(i=this.tokenizer.text(e)){e=e.substring(i.raw.length);let a=t.at(-1);a?.type==="text"?(a.raw+=(a.raw.endsWith(`
`)?"":`
`)+i.raw,a.text+=`
`+i.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=a.text):t.push(i);continue}if(e){let a="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let r=e,i=null;if(this.tokens.links){let o=Object.keys(this.tokens.links);if(o.length>0)for(;(i=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)o.includes(i[0].slice(i[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(i=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,i.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(i=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,i.index)+"["+"a".repeat(i[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let s=!1,a="";for(;e;){s||(a=""),s=!1;let o;if(this.options.extensions?.inline?.some(c=>(o=c.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.escape(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.tag(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.link(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(o.raw.length);let c=t.at(-1);o.type==="text"&&c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):t.push(o);continue}if(o=this.tokenizer.emStrong(e,r,a)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.codespan(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.br(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.del(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.autolink(e)){e=e.substring(o.raw.length),t.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(e))){e=e.substring(o.raw.length),t.push(o);continue}let l=e;if(this.options.extensions?.startInline){let c=1/0,u=e.slice(1),f;this.options.extensions.startInline.forEach(d=>{f=d.call({lexer:this},u),typeof f=="number"&&f>=0&&(c=Math.min(c,f))}),c<1/0&&c>=0&&(l=e.substring(0,c+1))}if(o=this.tokenizer.inlineText(l)){e=e.substring(o.raw.length),o.raw.slice(-1)!=="_"&&(a=o.raw.slice(-1)),s=!0;let c=t.at(-1);c?.type==="text"?(c.raw+=o.raw,c.text+=o.text):t.push(o);continue}if(e){let c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}},CD=class{options;parser;constructor(e){this.options=e||ZE}space(e){return""}code({text:e,lang:t,escaped:r}){let i=(t||"").match(Lp.notSpaceStart)?.[0],s=e.replace(Lp.endingNewline,"")+`
`;return i?'<pre><code class="language-'+ov(i)+'">'+(r?s:ov(s,!0))+`</code></pre>
`:"<pre><code>"+(r?s:ov(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){let t=e.ordered,r=e.start,i="";for(let o=0;o<e.items.length;o++){let l=e.items[o];i+=this.listitem(l)}let s=t?"ol":"ul",a=t&&r!==1?' start="'+r+'"':"";return"<"+s+a+`>
`+i+"</"+s+`>
`}listitem(e){let t="";if(e.task){let r=this.checkbox({checked:!!e.checked});e.loose?e.tokens[0]?.type==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+ov(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",r="";for(let s=0;s<e.header.length;s++)r+=this.tablecell(e.header[s]);t+=this.tablerow({text:r});let i="";for(let s=0;s<e.rows.length;s++){let a=e.rows[s];r="";for(let o=0;o<a.length;o++)r+=this.tablecell(a[o]);i+=this.tablerow({text:r})}return i&&(i=`<tbody>${i}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+i+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){let t=this.parser.parseInline(e.tokens),r=e.header?"th":"td";return(e.align?`<${r} align="${e.align}">`:`<${r}>`)+t+`</${r}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${ov(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:r}){let i=this.parser.parseInline(r),s=cQ(e);if(s===null)return i;e=s;let a='<a href="'+e+'"';return t&&(a+=' title="'+ov(t)+'"'),a+=">"+i+"</a>",a}image({href:e,title:t,text:r,tokens:i}){i&&(r=this.parser.parseInline(i,this.parser.textRenderer));let s=cQ(e);if(s===null)return ov(r);e=s;let a=`<img src="${e}" alt="${r}"`;return t&&(a+=` title="${ov(t)}"`),a+=">",a}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:ov(e.text)}},Uj=class{strong({text:n}){return n}em({text:n}){return n}codespan({text:n}){return n}del({text:n}){return n}html({text:n}){return n}text({text:n}){return n}link({text:n}){return""+n}image({text:n}){return""+n}br(){return""}},$y=class k7{options;renderer;textRenderer;constructor(e){this.options=e||ZE,this.options.renderer=this.options.renderer||new CD,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new Uj}static parse(e,t){return new k7(t).parse(e)}static parseInline(e,t){return new k7(t).parseInline(e)}parse(e,t=!0){let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let o=s,l=this.options.extensions.renderers[o.type].call({parser:this},o);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(o.type)){r+=l||"";continue}}let a=s;switch(a.type){case"space":{r+=this.renderer.space(a);continue}case"hr":{r+=this.renderer.hr(a);continue}case"heading":{r+=this.renderer.heading(a);continue}case"code":{r+=this.renderer.code(a);continue}case"table":{r+=this.renderer.table(a);continue}case"blockquote":{r+=this.renderer.blockquote(a);continue}case"list":{r+=this.renderer.list(a);continue}case"html":{r+=this.renderer.html(a);continue}case"def":{r+=this.renderer.def(a);continue}case"paragraph":{r+=this.renderer.paragraph(a);continue}case"text":{let o=a,l=this.renderer.text(o);for(;i+1<e.length&&e[i+1].type==="text";)o=e[++i],l+=`
`+this.renderer.text(o);t?r+=this.renderer.paragraph({type:"paragraph",raw:l,text:l,tokens:[{type:"text",raw:l,text:l,escaped:!0}]}):r+=l;continue}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}parseInline(e,t=this.renderer){let r="";for(let i=0;i<e.length;i++){let s=e[i];if(this.options.extensions?.renderers?.[s.type]){let o=this.options.extensions.renderers[s.type].call({parser:this},s);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){r+=o||"";continue}}let a=s;switch(a.type){case"escape":{r+=t.text(a);break}case"html":{r+=t.html(a);break}case"link":{r+=t.link(a);break}case"image":{r+=t.image(a);break}case"strong":{r+=t.strong(a);break}case"em":{r+=t.em(a);break}case"codespan":{r+=t.codespan(a);break}case"br":{r+=t.br(a);break}case"del":{r+=t.del(a);break}case"text":{r+=t.text(a);break}default:{let o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return r}},FN=class{options;block;constructor(n){this.options=n||ZE}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(n){return n}postprocess(n){return n}processAllTokens(n){return n}provideLexer(){return this.block?Gy.lex:Gy.lexInline}provideParser(){return this.block?$y.parse:$y.parseInline}},E6e=class{defaults=Mj();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=$y;Renderer=CD;TextRenderer=Uj;Lexer=Gy;Tokenizer=AD;Hooks=FN;constructor(...n){this.use(...n)}walkTokens(n,e){let t=[];for(let r of n)switch(t=t.concat(e.call(this,r)),r.type){case"table":{let i=r;for(let s of i.header)t=t.concat(this.walkTokens(s.tokens,e));for(let s of i.rows)for(let a of s)t=t.concat(this.walkTokens(a.tokens,e));break}case"list":{let i=r;t=t.concat(this.walkTokens(i.items,e));break}default:{let i=r;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let a=i[s].flat(1/0);t=t.concat(this.walkTokens(a,e))}):i.tokens&&(t=t.concat(this.walkTokens(i.tokens,e)))}}return t}use(...n){let e=this.defaults.extensions||{renderers:{},childTokens:{}};return n.forEach(t=>{let r={...t};if(r.async=this.defaults.async||r.async||!1,t.extensions&&(t.extensions.forEach(i=>{if(!i.name)throw new Error("extension name required");if("renderer"in i){let s=e.renderers[i.name];s?e.renderers[i.name]=function(...a){let o=i.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:e.renderers[i.name]=i.renderer}if("tokenizer"in i){if(!i.level||i.level!=="block"&&i.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");let s=e[i.level];s?s.unshift(i.tokenizer):e[i.level]=[i.tokenizer],i.start&&(i.level==="block"?e.startBlock?e.startBlock.push(i.start):e.startBlock=[i.start]:i.level==="inline"&&(e.startInline?e.startInline.push(i.start):e.startInline=[i.start]))}"childTokens"in i&&i.childTokens&&(e.childTokens[i.name]=i.childTokens)}),r.extensions=e),t.renderer){let i=this.defaults.renderer||new CD(this.defaults);for(let s in t.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if(["options","parser"].includes(s))continue;let a=s,o=t.renderer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u||""}}r.renderer=i}if(t.tokenizer){let i=this.defaults.tokenizer||new AD(this.defaults);for(let s in t.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if(["options","rules","lexer"].includes(s))continue;let a=s,o=t.tokenizer[a],l=i[a];i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.tokenizer=i}if(t.hooks){let i=this.defaults.hooks||new FN;for(let s in t.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if(["options","block"].includes(s))continue;let a=s,o=t.hooks[a],l=i[a];FN.passThroughHooks.has(s)?i[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(i,c)).then(f=>l.call(i,f));let u=o.call(i,c);return l.call(i,u)}:i[a]=(...c)=>{let u=o.apply(i,c);return u===!1&&(u=l.apply(i,c)),u}}r.hooks=i}if(t.walkTokens){let i=this.defaults.walkTokens,s=t.walkTokens;r.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),i&&(o=o.concat(i.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(n){return this.defaults={...this.defaults,...n},this}lexer(n,e){return Gy.lex(n,e??this.defaults)}parser(n,e){return $y.parse(n,e??this.defaults)}parseMarkdown(n){return(e,t)=>{let r={...t},i={...this.defaults,...r},s=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&r.async===!1)return s(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof e>"u"||e===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof e!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=n);let a=i.hooks?i.hooks.provideLexer():n?Gy.lex:Gy.lexInline,o=i.hooks?i.hooks.provideParser():n?$y.parse:$y.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(e):e).then(l=>a(l,i)).then(l=>i.hooks?i.hooks.processAllTokens(l):l).then(l=>i.walkTokens?Promise.all(this.walkTokens(l,i.walkTokens)).then(()=>l):l).then(l=>o(l,i)).then(l=>i.hooks?i.hooks.postprocess(l):l).catch(s);try{i.hooks&&(e=i.hooks.preprocess(e));let l=a(e,i);i.hooks&&(l=i.hooks.processAllTokens(l)),i.walkTokens&&this.walkTokens(l,i.walkTokens);let c=o(l,i);return i.hooks&&(c=i.hooks.postprocess(c)),c}catch(l){return s(l)}}}onError(n,e){return t=>{if(t.message+=`
Please report this to https://github.com/markedjs/marked.`,n){let r="<p>An error occurred:</p><pre>"+ov(t.message+"",!0)+"</pre>";return e?Promise.resolve(r):r}if(e)return Promise.reject(t);throw t}}},RE=new E6e;function vo(n,e){return RE.parse(n,e)}vo.options=vo.setOptions=function(n){return RE.setOptions(n),vo.defaults=RE.defaults,Oce(vo.defaults),vo};vo.getDefaults=Mj;vo.defaults=ZE;vo.use=function(...n){return RE.use(...n),vo.defaults=RE.defaults,Oce(vo.defaults),vo};vo.walkTokens=function(n,e){return RE.walkTokens(n,e)};vo.parseInline=RE.parseInline;vo.Parser=$y;vo.parser=$y.parse;vo.Renderer=CD;vo.TextRenderer=Uj;vo.Lexer=Gy;vo.lexer=Gy.lex;vo.Tokenizer=AD;vo.Hooks=FN;vo.parse=vo;vo.options;vo.setOptions;vo.use;vo.walkTokens;vo.parseInline;$y.parse;Gy.lex;const xt=H1("SOFTWARE");var HS=(n=>(n[n.Border=-1]="Border",n[n.Data=0]="Data",n[n.Function=1]="Function",n[n.Position=2]="Position",n[n.Timing=3]="Timing",n[n.Alignment=4]="Alignment",n))(HS||{}),x6e=Object.defineProperty,T6e=(n,e,t)=>e in n?x6e(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,PI=(n,e,t)=>(T6e(n,typeof e!="symbol"?e+"":e,t),t);const w6e=[0,1],Hce=[1,0],qce=[2,3],Vce=[3,2],R6e={L:w6e,M:Hce,Q:qce,H:Vce},A6e=/^[0-9]*$/,C6e=/^[A-Z0-9 $%*+.\/:-]*$/,uB="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Bj=1,Fj=40,hQ=3,M6e=3,DI=40,k6e=10,Gce=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],$ce=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];class O6e{constructor(e,t,r,i){if(this.version=e,this.ecc=t,PI(this,"size"),PI(this,"mask"),PI(this,"modules",[]),PI(this,"types",[]),e<Bj||e>Fj)throw new RangeError("Version value out of range");if(i<-1||i>7)throw new RangeError("Mask value out of range");this.size=e*4+17;const s=Array.from({length:this.size},()=>!1);for(let o=0;o<this.size;o++)this.modules.push(s.slice()),this.types.push(s.map(()=>0));this.drawFunctionPatterns();const a=this.addEccAndInterleave(r);if(this.drawCodewords(a),i===-1){let o=1e9;for(let l=0;l<8;l++){this.applyMask(l),this.drawFormatBits(l);const c=this.getPenaltyScore();c<o&&(i=l,o=c),this.applyMask(l)}}this.mask=i,this.applyMask(i),this.drawFormatBits(i)}getModule(e,t){return e>=0&&e<this.size&&t>=0&&t<this.size&&this.modules[t][e]}drawFunctionPatterns(){for(let r=0;r<this.size;r++)this.setFunctionModule(6,r,r%2===0,HS.Timing),this.setFunctionModule(r,6,r%2===0,HS.Timing);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const e=this.getAlignmentPatternPositions(),t=e.length;for(let r=0;r<t;r++)for(let i=0;i<t;i++)r===0&&i===0||r===0&&i===t-1||r===t-1&&i===0||this.drawAlignmentPattern(e[r],e[i]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(e){const t=this.ecc[1]<<3|e;let r=t;for(let s=0;s<10;s++)r=r<<1^(r>>>9)*1335;const i=(t<<10|r)^21522;for(let s=0;s<=5;s++)this.setFunctionModule(8,s,xy(i,s));this.setFunctionModule(8,7,xy(i,6)),this.setFunctionModule(8,8,xy(i,7)),this.setFunctionModule(7,8,xy(i,8));for(let s=9;s<15;s++)this.setFunctionModule(14-s,8,xy(i,s));for(let s=0;s<8;s++)this.setFunctionModule(this.size-1-s,8,xy(i,s));for(let s=8;s<15;s++)this.setFunctionModule(8,this.size-15+s,xy(i,s));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let e=this.version;for(let r=0;r<12;r++)e=e<<1^(e>>>11)*7973;const t=this.version<<12|e;for(let r=0;r<18;r++){const i=xy(t,r),s=this.size-11+r%3,a=Math.floor(r/3);this.setFunctionModule(s,a,i),this.setFunctionModule(a,s,i)}}drawFinderPattern(e,t){for(let r=-4;r<=4;r++)for(let i=-4;i<=4;i++){const s=Math.max(Math.abs(i),Math.abs(r)),a=e+i,o=t+r;a>=0&&a<this.size&&o>=0&&o<this.size&&this.setFunctionModule(a,o,s!==2&&s!==4,HS.Position)}}drawAlignmentPattern(e,t){for(let r=-2;r<=2;r++)for(let i=-2;i<=2;i++)this.setFunctionModule(e+i,t+r,Math.max(Math.abs(i),Math.abs(r))!==1,HS.Alignment)}setFunctionModule(e,t,r,i=HS.Function){this.modules[t][e]=r,this.types[t][e]=i}addEccAndInterleave(e){const t=this.version,r=this.ecc;if(e.length!==zN(t,r))throw new RangeError("Invalid argument");const i=$ce[r[0]][t],s=Gce[r[0]][t],a=Math.floor(O7(t)/8),o=i-a%i,l=Math.floor(a/i),c=[],u=z6e(s);for(let d=0,g=0;d<i;d++){const p=e.slice(g,g+l-s+(d<o?0:1));g+=p.length;const _=j6e(p,u);d<o&&p.push(0),c.push(p.concat(_))}const f=[];for(let d=0;d<c[0].length;d++)c.forEach((g,p)=>{(d!==l-s||p>=o)&&f.push(g[d])});return f}drawCodewords(e){if(e.length!==Math.floor(O7(this.version)/8))throw new RangeError("Invalid argument");let t=0;for(let r=this.size-1;r>=1;r-=2){r===6&&(r=5);for(let i=0;i<this.size;i++)for(let s=0;s<2;s++){const a=r-s,l=(r+1&2)===0?this.size-1-i:i;!this.types[l][a]&&t<e.length*8&&(this.modules[l][a]=xy(e[t>>>3],7-(t&7)),t++)}}}applyMask(e){if(e<0||e>7)throw new RangeError("Mask value out of range");for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++){let i;switch(e){case 0:i=(r+t)%2===0;break;case 1:i=t%2===0;break;case 2:i=r%3===0;break;case 3:i=(r+t)%3===0;break;case 4:i=(Math.floor(r/3)+Math.floor(t/2))%2===0;break;case 5:i=r*t%2+r*t%3===0;break;case 6:i=(r*t%2+r*t%3)%2===0;break;case 7:i=((r+t)%2+r*t%3)%2===0;break;default:throw new Error("Unreachable")}!this.types[t][r]&&i&&(this.modules[t][r]=!this.modules[t][r])}}getPenaltyScore(){let e=0;for(let s=0;s<this.size;s++){let a=!1,o=0;const l=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[s][c]===a?(o++,o===5?e+=hQ:o>5&&e++):(this.finderPenaltyAddHistory(o,l),a||(e+=this.finderPenaltyCountPatterns(l)*DI),a=this.modules[s][c],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,l)*DI}for(let s=0;s<this.size;s++){let a=!1,o=0;const l=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[c][s]===a?(o++,o===5?e+=hQ:o>5&&e++):(this.finderPenaltyAddHistory(o,l),a||(e+=this.finderPenaltyCountPatterns(l)*DI),a=this.modules[c][s],o=1);e+=this.finderPenaltyTerminateAndCount(a,o,l)*DI}for(let s=0;s<this.size-1;s++)for(let a=0;a<this.size-1;a++){const o=this.modules[s][a];o===this.modules[s][a+1]&&o===this.modules[s+1][a]&&o===this.modules[s+1][a+1]&&(e+=M6e)}let t=0;for(const s of this.modules)t=s.reduce((a,o)=>a+(o?1:0),t);const r=this.size*this.size,i=Math.ceil(Math.abs(t*20-r*10)/r)-1;return e+=i*k6e,e}getAlignmentPatternPositions(){if(this.version===1)return[];{const e=Math.floor(this.version/7)+2,t=this.version===32?26:Math.ceil((this.version*4+4)/(e*2-2))*2,r=[6];for(let i=this.size-7;r.length<e;i-=t)r.splice(1,0,i);return r}}finderPenaltyCountPatterns(e){const t=e[1],r=t>0&&e[2]===t&&e[3]===t*3&&e[4]===t&&e[5]===t;return(r&&e[0]>=t*4&&e[6]>=t?1:0)+(r&&e[6]>=t*4&&e[0]>=t?1:0)}finderPenaltyTerminateAndCount(e,t,r){return e&&(this.finderPenaltyAddHistory(t,r),t=0),t+=this.size,this.finderPenaltyAddHistory(t,r),this.finderPenaltyCountPatterns(r)}finderPenaltyAddHistory(e,t){t[0]===0&&(e+=this.size),t.pop(),t.unshift(e)}}function Uy(n,e,t){if(e<0||e>31||n>>>e)throw new RangeError("Value out of range");for(let r=e-1;r>=0;r--)t.push(n>>>r&1)}function xy(n,e){return(n>>>e&1)!==0}class zj{constructor(e,t,r){if(this.mode=e,this.numChars=t,this.bitData=r,t<0)throw new RangeError("Invalid argument");this.bitData=r.slice()}getData(){return this.bitData.slice()}}const I6e=[1,10,12,14],N6e=[2,9,11,13],P6e=[4,8,16,16];function Wce(n,e){return n[Math.floor((e+7)/17)+1]}function Yce(n){const e=[];for(const t of n)Uy(t,8,e);return new zj(P6e,n.length,e)}function D6e(n){if(!Xce(n))throw new RangeError("String contains non-numeric characters");const e=[];for(let t=0;t<n.length;){const r=Math.min(n.length-t,3);Uy(Number.parseInt(n.substring(t,t+r),10),r*3+1,e),t+=r}return new zj(I6e,n.length,e)}function L6e(n){if(!Kce(n))throw new RangeError("String contains unencodable characters in alphanumeric mode");const e=[];let t;for(t=0;t+2<=n.length;t+=2){let r=uB.indexOf(n.charAt(t))*45;r+=uB.indexOf(n.charAt(t+1)),Uy(r,11,e)}return t<n.length&&Uy(uB.indexOf(n.charAt(t)),6,e),new zj(N6e,n.length,e)}function U6e(n){return n===""?[]:Xce(n)?[D6e(n)]:Kce(n)?[L6e(n)]:[Yce(F6e(n))]}function Xce(n){return A6e.test(n)}function Kce(n){return C6e.test(n)}function B6e(n,e){let t=0;for(const r of n){const i=Wce(r.mode,e);if(r.numChars>=1<<i)return Number.POSITIVE_INFINITY;t+=4+i+r.bitData.length}return t}function F6e(n){n=encodeURI(n);const e=[];for(let t=0;t<n.length;t++)n.charAt(t)!=="%"?e.push(n.charCodeAt(t)):(e.push(Number.parseInt(n.substring(t+1,t+3),16)),t+=2);return e}function O7(n){if(n<Bj||n>Fj)throw new RangeError("Version number out of range");let e=(16*n+128)*n+64;if(n>=2){const t=Math.floor(n/7)+2;e-=(25*t-10)*t-55,n>=7&&(e-=36)}return e}function zN(n,e){return Math.floor(O7(n)/8)-Gce[e[0]][n]*$ce[e[0]][n]}function z6e(n){if(n<1||n>255)throw new RangeError("Degree out of range");const e=[];for(let r=0;r<n-1;r++)e.push(0);e.push(1);let t=1;for(let r=0;r<n;r++){for(let i=0;i<e.length;i++)e[i]=I7(e[i],t),i+1<e.length&&(e[i]^=e[i+1]);t=I7(t,2)}return e}function j6e(n,e){const t=e.map(r=>0);for(const r of n){const i=r^t.shift();t.push(0),e.forEach((s,a)=>t[a]^=I7(s,i))}return t}function I7(n,e){if(n>>>8||e>>>8)throw new RangeError("Byte out of range");let t=0;for(let r=7;r>=0;r--)t=t<<1^(t>>>7)*285,t^=(e>>>r&1)*n;return t}function H6e(n,e,t=1,r=40,i=-1,s=!0){if(!(Bj<=t&&t<=r&&r<=Fj)||i<-1||i>7)throw new RangeError("Invalid value");let a,o;for(a=t;;a++){const f=zN(a,e)*8,d=B6e(n,a);if(d<=f){o=d;break}if(a>=r)throw new RangeError("Data too long")}for(const f of[Hce,qce,Vce])s&&o<=zN(a,f)*8&&(e=f);const l=[];for(const f of n){Uy(f.mode[0],4,l),Uy(f.numChars,Wce(f.mode,a),l);for(const d of f.getData())l.push(d)}const c=zN(a,e)*8;Uy(0,Math.min(4,c-l.length),l),Uy(0,(8-l.length%8)%8,l);for(let f=236;l.length<c;f^=253)Uy(f,8,l);const u=Array.from({length:Math.ceil(l.length/8)},()=>0);return l.forEach((f,d)=>u[d>>>3]|=f<<7-(d&7)),new O6e(a,e,u,i)}function q6e(n,e){const{ecc:t="L",boostEcc:r=!1,minVersion:i=1,maxVersion:s=40,maskPattern:a=-1,border:o=1}=e||{},l=typeof n=="string"?U6e(n):Array.isArray(n)?[Yce(n)]:void 0;if(!l)throw new Error(`uqr only supports encoding string and binary data, but got: ${typeof n}`);const c=H6e(l,R6e[t],i,s,a,r),u=V6e({version:c.version,maskPattern:c.mask,size:c.size,data:c.modules,types:c.types},o);return e?.invert&&(u.data=u.data.map(f=>f.map(d=>!d))),e?.onEncoded?.(u),u}function V6e(n,e=1){if(!e)return n;const{size:t}=n,r=t+e*2;n.size=r,n.data.forEach(s=>{for(let a=0;a<e;a++)s.unshift(!1),s.push(!1)});for(let s=0;s<e;s++)n.data.unshift(Array.from({length:r},a=>!1)),n.data.push(Array.from({length:r},a=>!1));const i=HS.Border;n.types.forEach(s=>{for(let a=0;a<e;a++)s.unshift(i),s.push(i)});for(let s=0;s<e;s++)n.types.unshift(Array.from({length:r},a=>i)),n.types.push(Array.from({length:r},a=>i));return n}function G6e(n,e,t,r=!1){return e<0||t<0||e>=n.length||t>=n.length?r:n[t][e]}function $6e(n,e={}){const t={WHITE_ALL:"",WHITE_BLACK:"",BLACK_WHITE:"",BLACK_ALL:" "},r=q6e(n,e),i=!1,s=!0,a=(c,u)=>G6e(r.data,c,u,!0),o=[];let l="";for(let c=0;c<r.size;c+=2){for(let u=0;u<r.size;u++)a(u,c)===i&&a(u,c+1)===i?l+=t.WHITE_ALL:a(u,c)===i&&a(u,c+1)===s?l+=t.WHITE_BLACK:a(u,c)===s&&a(u,c+1)===i?l+=t.BLACK_WHITE:l+=t.BLACK_ALL;o.push(l),l=""}return o.join(`
`)}const AE="$dkpurple",W6e="$196",Y6e="$205";function es(n,e,t){kke(n,e,t)}function Zce(n,e,t){const r=W6e.repeat(t);es(n,e,`${AE}${r}`)}function jj(n,e,t){const r=Y6e.repeat(t);es(n,e,`${AE}${r}`)}function y_(n,e,t){Zce(n,e,t.length+2),es(n,e,`${AE} $white${t} `),jj(n,e,t.length+2)}function DS(n,e,t){es(n,e,`${AE} ${" ".repeat(t.length)} `),es(n,e,`${AE} $gray${t} `),jj(n,e,t.length+2)}function Tm(n,e,t,r){es(n,e,`${AE} $white${t} $blue${r}`)}function Ny(n,e,t){es(n,e,`${AE}$blue${t}`)}function N7(n,e,t,r){es(n,e,`!${t};${r}`)}function P7(n,e,t,r,i=!0){if(i){const s=$6e(t).split(`
`),a={32:32,9600:223,9604:220,9608:219};for(let o=0;o<s.length;o++){const l=[...s[o]].map(c=>`$${a[c.charCodeAt(0)]}`).join("");es(n,e,l)}}es(n,e,`!copyit ${t};${r}`),oj(n,e)}function Oy(n,e){switch(e.type){default:console.info("unknown",e);break;case"heading":y_(xt,n,e.text),es(xt,n," ");break;case"hr":es(xt,n," "),Zce(xt,n,10),es(xt,n," ");break;case"paragraph":for(let t=0;t<(e.tokens?.length??0);++t)xe(e.tokens?.[t])&&Oy(n,e.tokens[t]);break;case"code":e.text.split(`
`).forEach(t=>es(xt,n,t.replace(/\s+/g," ").trim()));break;case"text":es(xt,n,e.text);break;case"link":{const[t,...r]=e.text.split("|").map(s=>s.trim()),i=[...r,e.href??""];N7(xt,n,i.join(" "),t);break}case"image":N7(xt,n,`openit ${e.href}`,`show ${e.title??e.href}`);break;case"blockquote":e.text.split(`
`).forEach(t=>{es(xt,n,`$dkpurple$221$white  ${t}`)}),es(xt,n," ");break;case"list":for(let t=0;t<(e.items?.length??0);++t)xe(e.items?.[t])&&Oy(n,e.items[t]);es(xt,n," ");break;case"list_item":es(xt,n,` $grey$7 ${e.text}`);break}}function Hj(n,e){vo.use({pedantic:!1,gfm:!0,breaks:!1,renderer:{heading(t){return Oy(n,t),""},code(t){return Oy(n,t),""},blockquote(t){return Oy(n,t),""},hr(t){return Oy(n,t),""},list(t){return Oy(n,t),""},listitem(t){return Oy(n,t),""},paragraph(t){return Oy(n,t),""}}}),vo.parse(e)}const Qce={"application/andrew-inset":["ez"],"application/appinstaller":["appinstaller"],"application/applixware":["aw"],"application/appx":["appx"],"application/appxbundle":["appxbundle"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/automationml-aml+xml":["aml"],"application/automationml-amlx+zip":["amlx"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cpl+xml":["cpl"],"application/cu-seeme":["cu"],"application/cwl":["cwl"],"application/dash+xml":["mpd"],"application/dash-patch+xml":["mpp"],"application/davmount+xml":["davmount"],"application/dicom":["dcm"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdf":["fdf"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["*js"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/media-policy-dataset+xml":["mpf"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["*mp4","*mpg4","mp4s","m4p"],"application/msix":["msix"],"application/msixbundle":["msixbundle"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg","one","onea"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-keys":["asc"],"application/pgp-signature":["sig","*asc"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/sql":["sql"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/watcherinfo+xml":["wif"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xfdf":["xfdf"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"application/zip+dotlottie":["lottie"],"audio/3gpp":["*3gpp"],"audio/aac":["adts","aac"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a","m4b"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avci":["avci"],"image/avcs":["avcs"],"image/avif":["avif"],"image/bmp":["bmp","dib"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/dpx":["dpx"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/ief":["ief"],"image/jaii":["jaii"],"image/jais":["jais"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpg","jpeg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm","jpgm"],"image/jpx":["jpx","jpf"],"image/jxl":["jxl"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/pjpeg":["jfif"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime","mht","mhtml"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/jt":["jt"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/prc":["prc"],"model/step":["step","stp","stpnc","p21","210"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/u3d":["u3d"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/javascript":["js","mjs"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["md","markdown"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/wgsl":["wgsl"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","*jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts","m2t","m2ts","mts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};Object.freeze(Qce);var f0=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},tT,QM,LS;class X6e{constructor(...e){tT.set(this,new Map),QM.set(this,new Map),LS.set(this,new Map);for(const t of e)this.define(t)}define(e,t=!1){for(let[r,i]of Object.entries(e)){r=r.toLowerCase(),i=i.map(o=>o.toLowerCase()),f0(this,LS,"f").has(r)||f0(this,LS,"f").set(r,new Set);const s=f0(this,LS,"f").get(r);let a=!0;for(let o of i){const l=o.startsWith("*");if(o=l?o.slice(1):o,s?.add(o),a&&f0(this,QM,"f").set(r,o),a=!1,l)continue;const c=f0(this,tT,"f").get(o);if(c&&c!=r&&!t)throw new Error(`"${r} -> ${o}" conflicts with "${c} -> ${o}". Pass \`force=true\` to override this definition.`);f0(this,tT,"f").set(o,r)}}return this}getType(e){if(typeof e!="string")return null;const t=e.replace(/^.*[/\\]/s,"").toLowerCase(),r=t.replace(/^.*\./s,"").toLowerCase(),i=t.length<e.length;return!(r.length<t.length-1)&&i?null:f0(this,tT,"f").get(r)??null}getExtension(e){return typeof e!="string"?null:(e=e?.split?.(";")[0],(e&&f0(this,QM,"f").get(e.trim().toLowerCase()))??null)}getAllExtensions(e){return typeof e!="string"?null:f0(this,LS,"f").get(e.toLowerCase())??null}_freeze(){this.define=()=>{throw new Error("define() not allowed for built-in Mime objects. See https://github.com/broofa/mime/blob/main/README.md#custom-mime-instances")},Object.freeze(this);for(const e of f0(this,LS,"f").values())Object.freeze(e);return this}_getTestState(){return{types:f0(this,tT,"f"),extensions:f0(this,QM,"f")}}}tT=new WeakMap,QM=new WeakMap,LS=new WeakMap;new X6e(Qce)._freeze();const K6e=80,D4=Math.floor(1e3/K6e),Z6e=3;function Ch(n){return new Promise(e=>setTimeout(e,n))}var LI={},dQ;function Q6e(){if(dQ)return LI;dQ=1,Object.defineProperty(LI,"__esModule",{value:!0});function n(o){return typeof o=="string"?o.startsWith("#")?"hex":null:"r"in o&&"g"in o&&"b"in o?"rgb":"h"in o&&"s"in o&&"l"in o?"hsl":"h"in o&&"s"in o&&"v"in o?"hsv":null}function e(o){const l=o.replace("#",""),c=parseInt(l.substring(0,2),16),u=parseInt(l.substring(2,4),16),f=parseInt(l.substring(4,6),16);return{r:c,g:u,b:f}}function t(o){const{r:l,g:c,b:u}=o;return`#${(l<<16|c<<8|u).toString(16).padStart(6,"0")}`}function r(o,l,c){l/=100,c/=100;const u=g=>(g+o/30)%12,f=l*Math.min(c,1-c),d=g=>c-f*Math.max(-1,Math.min(u(g)-3,Math.min(9-u(g),1)));return{r:Math.round(d(0)*255),g:Math.round(d(8)*255),b:Math.round(d(4)*255)}}function i(o,l,c){l/=100,c/=100;const u=d=>(d+o/60)%6,f=d=>c-c*l*Math.max(0,Math.min(u(d),4-u(d),1));return{r:Math.round(f(5)*255),g:Math.round(f(3)*255),b:Math.round(f(1)*255)}}function s(o,l){const c=Math.abs(o.r-l.r),u=Math.abs(o.g-l.g),f=Math.abs(o.b-l.b),d=1-c/255,g=1-u/255,p=1-f/255;return(d+g+p)/3}function a(o){let l=Math.min(Math.max(o.similarityThreshold||.8,.01),1);const{targetColor:c,colorArray:u}=o,f=n(c);if(f===null)return null;let d;if(f==="hex")d=e(c);else if(f==="rgb")d=c;else if(f==="hsl"){const{h:_,s:y,l:v}=c;d=r(_,y,v)}else if(f==="hsv"){const{h:_,s:y,v}=c;d=i(_,y,v)}else return null;let g=null,p=0;for(const _ of u){n(_.hex?_.hex:_.rgb),_.hex?_.rgb||(_.rgb=e(_.hex)):_.hex=t(_.rgb);const y=Math.round(s(d,_.rgb)*100)/100;y>=l&&y>p&&(p=y,g={name:_.name,hex:_.hex,rgb:_.rgb,similarity:y})}return g}return LI.default=a,LI}Q6e();function ew(n,e,t){typeof n!="number"&&(n=0,e=0,t=1),typeof e!="number"&&(e=n,n=0,t=1),typeof t!="number"&&(t=1);const r=[],i=Math.min(n,e),s=Math.max(n,e);for(let a=i;a<=s;a+=t)r.push(a);return r}function J6e(n){return n[Mg(0,n.length-1)]}function eBe(n,e){return e[Joe(n,0,e.length-1)]}function T0(...n){return J6e(n.flat())}function tBe(n,...e){return eBe(n,e.flat())}function nBe(n){return[...new Set(n)].filter(xe)}const Yn=60,Ti=25,b_=Yn*Ti;var ni=(n=>(n[n.ERROR=0]="ERROR",n[n.LOADER=1]="LOADER",n[n.BOARD=2]="BOARD",n[n.OBJECT=3]="OBJECT",n[n.TERRAIN=4]="TERRAIN",n[n.CHARSET=5]="CHARSET",n[n.PALETTE=6]="PALETTE",n))(ni||{});const D7=14,tw=3,Jd=8,ep=14,O0=16,L7=16,Jce=16;var oo=(n=>(n[n.BLANK=0]="BLANK",n[n.TILES=1]="TILES",n[n.SPRITES=2]="SPRITES",n[n.DITHER=3]="DITHER",n[n.MEDIA=4]="MEDIA",n[n.CONTROL=5]="CONTROL",n))(oo||{}),tl=(n=>(n[n.FAR=1]="FAR",n[n.MID=1.5]="MID",n[n.NEAR=3]="NEAR",n))(tl||{});function jw(n){let e=0,t=0,r=Yn*.5,i=Ti*.5,s=1.5,a="flat",o=0;return n.forEach(l=>{switch(l.type){case 1:e=Math.max(e,l.width),t=Math.max(t,l.height);break;case 3:e=Math.max(e,l.width),t=Math.max(t,l.height);break;case 5:r=l.focusx,i=l.focusy,s=l.viewscale,a=l.graphics,o=l.facing;break}}),{width:e,height:t,focusx:r,focusy:i,viewscale:s,graphics:a,facing:o}}function V1(n,e){return`${n}:${e}`}const qj=1,Vj=16,Gj=256;var Tn=(n=>(n[n.NONE=0]="NONE",n[n.ALT=1]="ALT",n[n.CTRL=2]="CTRL",n[n.SHIFT=3]="SHIFT",n[n.MOVE_UP=4]="MOVE_UP",n[n.MOVE_DOWN=5]="MOVE_DOWN",n[n.MOVE_LEFT=6]="MOVE_LEFT",n[n.MOVE_RIGHT=7]="MOVE_RIGHT",n[n.OK_BUTTON=8]="OK_BUTTON",n[n.CANCEL_BUTTON=9]="CANCEL_BUTTON",n[n.MENU_BUTTON=10]="MENU_BUTTON",n))(Tn||{});function nw(n,e=16){return n?ew(e-1).map(t=>{const r=t*tw;return new cr(n.bits[r]/63,n.bits[r+1]/63,n.bits[r+2]/63)}):[]}var jN={exports:{}},HN={exports:{}},rBe=HN.exports,pQ;function iBe(){return pQ||(pQ=1,(function(n,e){(function(t,r){n.exports=r()})(rBe,function(){function t(_){return!isNaN(parseFloat(_))&&isFinite(_)}function r(_){return _.charAt(0).toUpperCase()+_.substring(1)}function i(_){return function(){return this[_]}}var s=["isConstructor","isEval","isNative","isToplevel"],a=["columnNumber","lineNumber"],o=["fileName","functionName","source"],l=["args"],c=["evalOrigin"],u=s.concat(a,o,l,c);function f(_){if(_)for(var y=0;y<u.length;y++)_[u[y]]!==void 0&&this["set"+r(u[y])](_[u[y]])}f.prototype={getArgs:function(){return this.args},setArgs:function(_){if(Object.prototype.toString.call(_)!=="[object Array]")throw new TypeError("Args must be an Array");this.args=_},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(_){if(_ instanceof f)this.evalOrigin=_;else if(_ instanceof Object)this.evalOrigin=new f(_);else throw new TypeError("Eval Origin must be an Object or StackFrame")},toString:function(){var _=this.getFileName()||"",y=this.getLineNumber()||"",v=this.getColumnNumber()||"",x=this.getFunctionName()||"";return this.getIsEval()?_?"[eval] ("+_+":"+y+":"+v+")":"[eval]:"+y+":"+v:x?x+" ("+_+":"+y+":"+v+")":_+":"+y+":"+v}},f.fromString=function(y){var v=y.indexOf("("),x=y.lastIndexOf(")"),E=y.substring(0,v),M=y.substring(v+1,x).split(","),O=y.substring(x+1);if(O.indexOf("@")===0)var N=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(O,""),I=N[1],D=N[2],V=N[3];return new f({functionName:E,args:M||void 0,fileName:I,lineNumber:D||void 0,columnNumber:V||void 0})};for(var d=0;d<s.length;d++)f.prototype["get"+r(s[d])]=i(s[d]),f.prototype["set"+r(s[d])]=(function(_){return function(y){this[_]=!!y}})(s[d]);for(var g=0;g<a.length;g++)f.prototype["get"+r(a[g])]=i(a[g]),f.prototype["set"+r(a[g])]=(function(_){return function(y){if(!t(y))throw new TypeError(_+" must be a Number");this[_]=Number(y)}})(a[g]);for(var p=0;p<o.length;p++)f.prototype["get"+r(o[p])]=i(o[p]),f.prototype["set"+r(o[p])]=(function(_){return function(y){this[_]=String(y)}})(o[p]);return f})})(HN)),HN.exports}var sBe=jN.exports,mQ;function aBe(){return mQ||(mQ=1,(function(n,e){(function(t,r){n.exports=r(iBe())})(sBe,function(r){var i=/(^|@)\S+:\d+/,s=/^\s*at .*(\S+:\d+|\(native\))/m,a=/^(eval@)?(\[native code])?$/;return{parse:function(l){if(typeof l.stacktrace<"u"||typeof l["opera#sourceloc"]<"u")return this.parseOpera(l);if(l.stack&&l.stack.match(s))return this.parseV8OrIE(l);if(l.stack)return this.parseFFOrSafari(l);throw new Error("Cannot parse given Error object")},extractLocation:function(l){if(l.indexOf(":")===-1)return[l];var c=/(.+?)(?::(\d+))?(?::(\d+))?$/,u=c.exec(l.replace(/[()]/g,""));return[u[1],u[2]||void 0,u[3]||void 0]},parseV8OrIE:function(l){var c=l.stack.split(`
`).filter(function(u){return!!u.match(s)},this);return c.map(function(u){u.indexOf("(eval ")>-1&&(u=u.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(,.*$)/g,""));var f=u.replace(/^\s+/,"").replace(/\(eval code/g,"(").replace(/^.*?\s+/,""),d=f.match(/ (\(.+\)$)/);f=d?f.replace(d[0],""):f;var g=this.extractLocation(d?d[1]:f),p=d&&f||void 0,_=["eval","<anonymous>"].indexOf(g[0])>-1?void 0:g[0];return new r({functionName:p,fileName:_,lineNumber:g[1],columnNumber:g[2],source:u})},this)},parseFFOrSafari:function(l){var c=l.stack.split(`
`).filter(function(u){return!u.match(a)},this);return c.map(function(u){if(u.indexOf(" > eval")>-1&&(u=u.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1")),u.indexOf("@")===-1&&u.indexOf(":")===-1)return new r({functionName:u});var f=/((.*".+"[^@]*)?[^@]*)(?:@)/,d=u.match(f),g=d&&d[1]?d[1]:void 0,p=this.extractLocation(u.replace(f,""));return new r({functionName:g,fileName:p[0],lineNumber:p[1],columnNumber:p[2],source:u})},this)},parseOpera:function(l){return!l.stacktrace||l.message.indexOf(`
`)>-1&&l.message.split(`
`).length>l.stacktrace.split(`
`).length?this.parseOpera9(l):l.stack?this.parseOpera11(l):this.parseOpera10(l)},parseOpera9:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)/i,u=l.message.split(`
`),f=[],d=2,g=u.length;d<g;d+=2){var p=c.exec(u[d]);p&&f.push(new r({fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera10:function(l){for(var c=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,u=l.stacktrace.split(`
`),f=[],d=0,g=u.length;d<g;d+=2){var p=c.exec(u[d]);p&&f.push(new r({functionName:p[3]||void 0,fileName:p[2],lineNumber:p[1],source:u[d]}))}return f},parseOpera11:function(l){var c=l.stack.split(`
`).filter(function(u){return!!u.match(i)&&!u.match(/^Error created at/)},this);return c.map(function(u){var f=u.split("@"),d=this.extractLocation(f.pop()),g=f.shift()||"",p=g.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,_;g.match(/\(([^)]*)\)/)&&(_=g.replace(/^[^(]+\(([^)]*)\)$/,"$1"));var y=_===void 0||_==="[arguments not available]"?void 0:_.split(",");return new r({functionName:p,args:y,fileName:d[0],lineNumber:d[1],columnNumber:d[2],source:u})},this)}}})})(jN)),jN.exports}var oBe=aBe();const lBe=Bh(oBe),Fv=!!JSON.parse("false"),cBe=!!JSON.parse("false"),uBe=!!JSON.parse("false"),gQ=!!JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");JSON.parse("false");const Gn={HALT_AT_COUNT:256,DRAW_CHAR_SCALE:2,DRAW_CHAR_WIDTH(){return Jd*Gn.DRAW_CHAR_SCALE},DRAW_CHAR_HEIGHT(){return ep*Gn.DRAW_CHAR_SCALE}};function mb(n){const e={},t={everytick(){},aftertick(){},listcommands(){return sb(e)},...n,getcommand(r){return e[r]},command(r,i){return e[r]=i,t}};return t}var U7;try{U7=new TextDecoder}catch{}var lr,Ov,jt=0,Ul={},Ea,f1,y0=0,bv=0,Oh,Ky,Bm=[],ua,_Q={useRecords:!1,mapsAsObjects:!0};class eue{}const tue=new eue;tue.name="MessagePack 0xC1";var p1=!1,nue=2,fBe;try{new Function("")}catch{nue=1/0}class rk{constructor(e){e&&(e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.sequential&&e.trusted!==!1&&(e.trusted=!0,!e.structures&&e.useRecords!=!1&&(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(lr)return lue(()=>(F7(),this?this.unpack(e,t):rk.prototype.unpack.call(_Q,e,t)));!e.buffer&&e.constructor===ArrayBuffer&&(e=typeof mf<"u"?mf.from(e):new Uint8Array(e)),typeof t=="object"?(Ov=t.end||e.length,jt=t.start||0):(jt=0,Ov=t>-1?t:e.length),bv=0,f1=null,Oh=null,lr=e;try{ua=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw lr=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof rk){if(Ul=this,this.structures)return Ea=this.structures,UI(t);(!Ea||Ea.length>0)&&(Ea=[])}else Ul=_Q,(!Ea||Ea.length>0)&&(Ea=[]);return UI(t)}unpackMultiple(e,t){let r,i=0;try{p1=!0;let s=e.length,a=this?this.unpack(e,s):L4.unpack(e,s);if(t){if(t(a,i,jt)===!1)return;for(;jt<s;)if(i=jt,t(UI(),i,jt)===!1)return}else{for(r=[a];jt<s;)i=jt,r.push(UI());return r}}catch(s){throw s.lastPosition=i,s.values=r,s}finally{p1=!1,F7()}}_mergeStructures(e,t){e=e||[],Object.isFrozen(e)&&(e=e.map(r=>r.slice(0)));for(let r=0,i=e.length;r<i;r++){let s=e[r];s&&(s.isShared=!0,r>=32&&(s.highByte=r-32>>5))}e.sharedLength=e.length;for(let r in t||[])if(r>=0){let i=e[r],s=t[r];s&&(i&&((e.restoreStructures||(e.restoreStructures=[]))[r]=i),e[r]=s)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function UI(n){try{if(!Ul.trusted&&!p1){let t=Ea.sharedLength||0;t<Ea.length&&(Ea.length=t)}let e;if(Ul.randomAccessStructure&&lr[jt]<64&&lr[jt]>=32&&fBe||(e=qu()),Oh&&(jt=Oh.postBundlePosition,Oh=null),p1&&(Ea.restoreStructures=null),jt==Ov)Ea&&Ea.restoreStructures&&vQ(),Ea=null,lr=null,Ky&&(Ky=null);else{if(jt>Ov)throw new Error("Unexpected end of MessagePack data");if(!p1){let t;try{t=JSON.stringify(e,(r,i)=>typeof i=="bigint"?`${i}n`:i).slice(0,100)}catch(r){t="(JSON view not available "+r+")"}throw new Error("Data read, but end of buffer not reached "+t)}}return e}catch(e){throw Ea&&Ea.restoreStructures&&vQ(),F7(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||jt>Ov)&&(e.incomplete=!0),e}}function vQ(){for(let n in Ea.restoreStructures)Ea[n]=Ea.restoreStructures[n];Ea.restoreStructures=null}function qu(){let n=lr[jt++];if(n<160)if(n<128){if(n<64)return n;{let e=Ea[n&63]||Ul.getStructures&&rue()[n&63];return e?(e.read||(e.read=$j(e,n&63)),e.read()):n}}else if(n<144)if(n-=128,Ul.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=sue();r==="__proto__"&&(r="__proto_"),e[r]=qu()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(qu(),qu());return e}else{n-=144;let e=new Array(n);for(let t=0;t<n;t++)e[t]=qu();return Ul.freezeData?Object.freeze(e):e}else if(n<192){let e=n-160;if(bv>=jt)return f1.slice(jt-y0,(jt+=e)-y0);if(bv==0&&Ov<140){let t=e<16?Wj(e):iue(e);if(t!=null)return t}return B7(e)}else{let e;switch(n){case 192:return null;case 193:return Oh?(e=qu(),e>0?Oh[1].slice(Oh.position1,Oh.position1+=e):Oh[0].slice(Oh.position0,Oh.position0-=e)):tue;case 194:return!1;case 195:return!0;case 196:if(e=lr[jt++],e===void 0)throw new Error("Unexpected end of buffer");return fB(e);case 197:return e=ua.getUint16(jt),jt+=2,fB(e);case 198:return e=ua.getUint32(jt),jt+=4,fB(e);case 199:return yS(lr[jt++]);case 200:return e=ua.getUint16(jt),jt+=2,yS(e);case 201:return e=ua.getUint32(jt),jt+=4,yS(e);case 202:if(e=ua.getFloat32(jt),Ul.useFloat32>2){let t=Yj[(lr[jt]&127)<<1|lr[jt+1]>>7];return jt+=4,(t*e+(e>0?.5:-.5)>>0)/t}return jt+=4,e;case 203:return e=ua.getFloat64(jt),jt+=8,e;case 204:return lr[jt++];case 205:return e=ua.getUint16(jt),jt+=2,e;case 206:return e=ua.getUint32(jt),jt+=4,e;case 207:return Ul.int64AsType==="number"?(e=ua.getUint32(jt)*4294967296,e+=ua.getUint32(jt+4)):Ul.int64AsType==="string"?e=ua.getBigUint64(jt).toString():Ul.int64AsType==="auto"?(e=ua.getBigUint64(jt),e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=ua.getBigUint64(jt),jt+=8,e;case 208:return ua.getInt8(jt++);case 209:return e=ua.getInt16(jt),jt+=2,e;case 210:return e=ua.getInt32(jt),jt+=4,e;case 211:return Ul.int64AsType==="number"?(e=ua.getInt32(jt)*4294967296,e+=ua.getUint32(jt+4)):Ul.int64AsType==="string"?e=ua.getBigInt64(jt).toString():Ul.int64AsType==="auto"?(e=ua.getBigInt64(jt),e>=BigInt(-2)<<BigInt(52)&&e<=BigInt(2)<<BigInt(52)&&(e=Number(e))):e=ua.getBigInt64(jt),jt+=8,e;case 212:if(e=lr[jt++],e==114)return wQ(lr[jt++]&63);{let t=Bm[e];if(t)return t.read?(jt++,t.read(qu())):t.noBuffer?(jt++,t()):t(lr.subarray(jt,++jt));throw new Error("Unknown extension "+e)}case 213:return e=lr[jt],e==114?(jt++,wQ(lr[jt++]&63,lr[jt++])):yS(2);case 214:return yS(4);case 215:return yS(8);case 216:return yS(16);case 217:return e=lr[jt++],bv>=jt?f1.slice(jt-y0,(jt+=e)-y0):dBe(e);case 218:return e=ua.getUint16(jt),jt+=2,bv>=jt?f1.slice(jt-y0,(jt+=e)-y0):pBe(e);case 219:return e=ua.getUint32(jt),jt+=4,bv>=jt?f1.slice(jt-y0,(jt+=e)-y0):mBe(e);case 220:return e=ua.getUint16(jt),jt+=2,bQ(e);case 221:return e=ua.getUint32(jt),jt+=4,bQ(e);case 222:return e=ua.getUint16(jt),jt+=2,SQ(e);case 223:return e=ua.getUint32(jt),jt+=4,SQ(e);default:if(n>=224)return n-256;if(n===void 0){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+n)}}}const hBe=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function $j(n,e){function t(){if(t.count++>nue){let i=n.read=new Function("r","return function(){return "+(Ul.freezeData?"Object.freeze":"")+"({"+n.map(s=>s==="__proto__"?"__proto_:r()":hBe.test(s)?s+":r()":"["+JSON.stringify(s)+"]:r()").join(",")+"})}")(qu);return n.highByte===0&&(n.read=yQ(e,n.read)),i()}let r={};for(let i=0,s=n.length;i<s;i++){let a=n[i];a==="__proto__"&&(a="__proto_"),r[a]=qu()}return Ul.freezeData?Object.freeze(r):r}return t.count=0,n.highByte===0?yQ(e,t):t}const yQ=(n,e)=>function(){let t=lr[jt++];if(t===0)return e();let r=n<32?-(n+(t<<5)):n+(t<<5),i=Ea[r]||rue()[r];if(!i)throw new Error("Record id is not defined for "+r);return i.read||(i.read=$j(i,n)),i.read()};function rue(){let n=lue(()=>(lr=null,Ul.getStructures()));return Ea=Ul._mergeStructures(n,Ea)}var B7=fO,dBe=fO,pBe=fO,mBe=fO;function fO(n){let e;if(n<16&&(e=Wj(n)))return e;if(n>64&&U7)return U7.decode(lr.subarray(jt,jt+=n));const t=jt+n,r=[];for(e="";jt<t;){const i=lr[jt++];if((i&128)===0)r.push(i);else if((i&224)===192){const s=lr[jt++]&63;r.push((i&31)<<6|s)}else if((i&240)===224){const s=lr[jt++]&63,a=lr[jt++]&63;r.push((i&31)<<12|s<<6|a)}else if((i&248)===240){const s=lr[jt++]&63,a=lr[jt++]&63,o=lr[jt++]&63;let l=(i&7)<<18|s<<12|a<<6|o;l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|l&1023),r.push(l)}else r.push(i);r.length>=4096&&(e+=wh.apply(String,r),r.length=0)}return r.length>0&&(e+=wh.apply(String,r)),e}function bQ(n){let e=new Array(n);for(let t=0;t<n;t++)e[t]=qu();return Ul.freezeData?Object.freeze(e):e}function SQ(n){if(Ul.mapsAsObjects){let e={};for(let t=0;t<n;t++){let r=sue();r==="__proto__"&&(r="__proto_"),e[r]=qu()}return e}else{let e=new Map;for(let t=0;t<n;t++)e.set(qu(),qu());return e}}var wh=String.fromCharCode;function iue(n){let e=jt,t=new Array(n);for(let r=0;r<n;r++){const i=lr[jt++];if((i&128)>0){jt=e;return}t[r]=i}return wh.apply(String,t)}function Wj(n){if(n<4)if(n<2){if(n===0)return"";{let e=lr[jt++];if((e&128)>1){jt-=1;return}return wh(e)}}else{let e=lr[jt++],t=lr[jt++];if((e&128)>0||(t&128)>0){jt-=2;return}if(n<3)return wh(e,t);let r=lr[jt++];if((r&128)>0){jt-=3;return}return wh(e,t,r)}else{let e=lr[jt++],t=lr[jt++],r=lr[jt++],i=lr[jt++];if((e&128)>0||(t&128)>0||(r&128)>0||(i&128)>0){jt-=4;return}if(n<6){if(n===4)return wh(e,t,r,i);{let s=lr[jt++];if((s&128)>0){jt-=5;return}return wh(e,t,r,i,s)}}else if(n<8){let s=lr[jt++],a=lr[jt++];if((s&128)>0||(a&128)>0){jt-=6;return}if(n<7)return wh(e,t,r,i,s,a);let o=lr[jt++];if((o&128)>0){jt-=7;return}return wh(e,t,r,i,s,a,o)}else{let s=lr[jt++],a=lr[jt++],o=lr[jt++],l=lr[jt++];if((s&128)>0||(a&128)>0||(o&128)>0||(l&128)>0){jt-=8;return}if(n<10){if(n===8)return wh(e,t,r,i,s,a,o,l);{let c=lr[jt++];if((c&128)>0){jt-=9;return}return wh(e,t,r,i,s,a,o,l,c)}}else if(n<12){let c=lr[jt++],u=lr[jt++];if((c&128)>0||(u&128)>0){jt-=10;return}if(n<11)return wh(e,t,r,i,s,a,o,l,c,u);let f=lr[jt++];if((f&128)>0){jt-=11;return}return wh(e,t,r,i,s,a,o,l,c,u,f)}else{let c=lr[jt++],u=lr[jt++],f=lr[jt++],d=lr[jt++];if((c&128)>0||(u&128)>0||(f&128)>0||(d&128)>0){jt-=12;return}if(n<14){if(n===12)return wh(e,t,r,i,s,a,o,l,c,u,f,d);{let g=lr[jt++];if((g&128)>0){jt-=13;return}return wh(e,t,r,i,s,a,o,l,c,u,f,d,g)}}else{let g=lr[jt++],p=lr[jt++];if((g&128)>0||(p&128)>0){jt-=14;return}if(n<15)return wh(e,t,r,i,s,a,o,l,c,u,f,d,g,p);let _=lr[jt++];if((_&128)>0){jt-=15;return}return wh(e,t,r,i,s,a,o,l,c,u,f,d,g,p,_)}}}}}function xQ(){let n=lr[jt++],e;if(n<192)e=n-160;else switch(n){case 217:e=lr[jt++];break;case 218:e=ua.getUint16(jt),jt+=2;break;case 219:e=ua.getUint32(jt),jt+=4;break;default:throw new Error("Expected string")}return fO(e)}function fB(n){return Ul.copyBuffers?Uint8Array.prototype.slice.call(lr,jt,jt+=n):lr.subarray(jt,jt+=n)}function yS(n){let e=lr[jt++];if(Bm[e]){let t;return Bm[e](lr.subarray(jt,t=jt+=n),r=>{jt=r;try{return qu()}finally{jt=t}})}else throw new Error("Unknown extension type "+e)}var TQ=new Array(4096);function sue(){let n=lr[jt++];if(n>=160&&n<192){if(n=n-160,bv>=jt)return f1.slice(jt-y0,(jt+=n)-y0);if(!(bv==0&&Ov<180))return B7(n)}else return jt--,aue(qu());let e=(n<<5^(n>1?ua.getUint16(jt):n>0?lr[jt]:0))&4095,t=TQ[e],r=jt,i=jt+n-3,s,a=0;if(t&&t.bytes==n){for(;r<i;){if(s=ua.getUint32(r),s!=t[a++]){r=1879048192;break}r+=4}for(i+=3;r<i;)if(s=lr[r++],s!=t[a++]){r=1879048192;break}if(r===i)return jt=r,t.string;i-=3,r=jt}for(t=[],TQ[e]=t,t.bytes=n;r<i;)s=ua.getUint32(r),t.push(s),r+=4;for(i+=3;r<i;)s=lr[r++],t.push(s);let o=n<16?Wj(n):iue(n);return o!=null?t.string=o:t.string=B7(n)}function aue(n){if(typeof n=="string")return n;if(typeof n=="number"||typeof n=="boolean"||typeof n=="bigint")return n.toString();if(n==null)return n+"";if(Ul.allowArraysInMapKeys&&Array.isArray(n)&&n.flat().every(e=>["string","number","boolean","bigint"].includes(typeof e)))return n.flat().toString();throw new Error(`Invalid property type for record: ${typeof n}`)}const wQ=(n,e)=>{let t=qu().map(aue),r=n;e!==void 0&&(n=n<32?-((e<<5)+n):(e<<5)+n,t.highByte=e);let i=Ea[n];return i&&(i.isShared||p1)&&((Ea.restoreStructures||(Ea.restoreStructures=[]))[n]=i),Ea[n]=t,t.read=$j(t,r),t.read()};Bm[0]=()=>{};Bm[0].noBuffer=!0;Bm[66]=n=>{let e=n.byteLength%8||8,t=BigInt(n[0]&128?n[0]-256:n[0]);for(let r=1;r<e;r++)t<<=BigInt(8),t+=BigInt(n[r]);if(n.byteLength!==e){let r=new DataView(n.buffer,n.byteOffset,n.byteLength),i=(s,a)=>{let o=a-s;if(o<=40){let f=r.getBigUint64(s);for(let d=s+8;d<a;d+=8)f<<=64n,f|=r.getBigUint64(d);return f}let l=s+(o>>4<<3),c=i(s,l),u=i(l,a);return c<<BigInt((a-l)*8)|u};t=t<<BigInt((r.byteLength-e)*8)|i(e,r.byteLength)}return t};let RQ={Error,EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,AggregateError:typeof AggregateError=="function"?AggregateError:null};Bm[101]=()=>{let n=qu();if(!RQ[n[0]]){let e=Error(n[1],{cause:n[2]});return e.name=n[0],e}return RQ[n[0]](n[1],{cause:n[2]})};Bm[105]=n=>{if(Ul.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=ua.getUint32(jt-4);Ky||(Ky=new Map);let t=lr[jt],r;t>=144&&t<160||t==220||t==221?r=[]:t>=128&&t<144||t==222||t==223?r=new Map:(t>=199&&t<=201||t>=212&&t<=216)&&lr[jt+1]===115?r=new Set:r={};let i={target:r};Ky.set(e,i);let s=qu();if(i.used)Object.assign(r,s);else return i.target=s;if(r instanceof Map)for(let[a,o]of s.entries())r.set(a,o);if(r instanceof Set)for(let a of Array.from(s))r.add(a);return r};Bm[112]=n=>{if(Ul.structuredClone===!1)throw new Error("Structured clone extension is disabled");let e=ua.getUint32(jt-4),t=Ky.get(e);return t.used=!0,t.target};Bm[115]=()=>new Set(qu());const oue=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(n=>n+"Array");let gBe=typeof globalThis=="object"?globalThis:window;Bm[116]=n=>{let e=n[0],t=Uint8Array.prototype.slice.call(n,1).buffer,r=oue[e];if(!r){if(e===16)return t;if(e===17)return new DataView(t);throw new Error("Could not find typed array for code "+e)}return new gBe[r](t)};Bm[120]=()=>{let n=qu();return new RegExp(n[0],n[1])};const _Be=[];Bm[98]=n=>{let e=(n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3],t=jt;return jt+=e-n.length,Oh=_Be,Oh=[xQ(),xQ()],Oh.position0=0,Oh.position1=0,Oh.postBundlePosition=jt,jt=t,qu()};Bm[255]=n=>n.length==4?new Date((n[0]*16777216+(n[1]<<16)+(n[2]<<8)+n[3])*1e3):n.length==8?new Date(((n[0]<<22)+(n[1]<<14)+(n[2]<<6)+(n[3]>>2))/1e6+((n[3]&3)*4294967296+n[4]*16777216+(n[5]<<16)+(n[6]<<8)+n[7])*1e3):n.length==12?new Date(((n[0]<<24)+(n[1]<<16)+(n[2]<<8)+n[3])/1e6+((n[4]&128?-281474976710656:0)+n[6]*1099511627776+n[7]*4294967296+n[8]*16777216+(n[9]<<16)+(n[10]<<8)+n[11])*1e3):new Date("invalid");function lue(n){let e=Ov,t=jt,r=y0,i=bv,s=f1,a=Ky,o=Oh,l=new Uint8Array(lr.slice(0,Ov)),c=Ea,u=Ea.slice(0,Ea.length),f=Ul,d=p1,g=n();return Ov=e,jt=t,y0=r,bv=i,f1=s,Ky=a,Oh=o,lr=l,p1=d,Ea=c,Ea.splice(0,Ea.length,...u),Ul=f,ua=new DataView(lr.buffer,lr.byteOffset,lr.byteLength),g}function F7(){lr=null,Ky=null,Ea=null}const Yj=new Array(147);for(let n=0;n<256;n++)Yj[n]=+("1e"+Math.floor(45.15-n*.30103));var L4=new rk({useRecords:!1});L4.unpack;L4.unpackMultiple;L4.unpack;let vBe=new Float32Array(1);new Uint8Array(vBe.buffer,0,4);let qN;try{qN=new TextEncoder}catch{}let z7,cue;const rw=typeof mf<"u",BI=rw?function(n){return mf.allocUnsafeSlow(n)}:Uint8Array,uue=rw?mf:Uint8Array,AQ=rw?4294967296:2144337920;let sn,AM,bl,qt=0,Wd,Bc=null,yBe;const bBe=21760,SBe=/[\u0080-\uFFFF]/,Hx=Symbol("record-id");class EBe extends rk{constructor(e){super(e),this.offset=0;let t,r,i,s,a=uue.prototype.utf8Write?function($,U){return sn.utf8Write($,U,sn.byteLength-U)}:qN&&qN.encodeInto?function($,U){return qN.encodeInto($,sn.subarray(U)).written}:!1,o=this;e||(e={});let l=e&&e.sequential,c=e.structures||e.saveStructures,u=e.maxSharedStructures;if(u==null&&(u=c?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");e.structuredClone&&e.moreTypes==null&&(this.moreTypes=!0);let f=e.maxOwnStructures;f==null&&(f=c?32:64),!this.structures&&e.useRecords!=!1&&(this.structures=[]);let d=u>32||f+u>64,g=u+64,p=u+f+64;if(p>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let _=[],y=0,v=0;this.pack=this.encode=function($,U){if(sn||(sn=new BI(8192),bl=sn.dataView||(sn.dataView=new DataView(sn.buffer,0,8192)),qt=0),Wd=sn.length-10,Wd-qt<2048?(sn=new BI(sn.length),bl=sn.dataView||(sn.dataView=new DataView(sn.buffer,0,sn.length)),Wd=sn.length-10,qt=0):qt=qt+7&2147483640,t=qt,U&ABe&&(qt+=U&255),s=o.structuredClone?new Map:null,o.bundleStrings&&typeof $!="string"?(Bc=[],Bc.size=1/0):Bc=null,i=o.structures,i){i.uninitialized&&(i=o._mergeStructures(o.getStructures()));let W=i.sharedLength||0;if(W>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+i.sharedLength);if(!i.transitions){i.transitions=Object.create(null);for(let q=0;q<W;q++){let Y=i[q];if(!Y)continue;let ae,Z=i.transitions;for(let K=0,ne=Y.length;K<ne;K++){let le=Y[K];ae=Z[le],ae||(ae=Z[le]=Object.create(null)),Z=ae}Z[Hx]=q+64}this.lastNamedStructuresLength=W}l||(i.nextId=W+64)}r&&(r=!1);let J;try{o.randomAccessStructure&&$&&$.constructor&&$.constructor===Object?B($):M($);let W=Bc;if(Bc&&MQ(t,M,0),s&&s.idsToInsert){let q=s.idsToInsert.sort((K,ne)=>K.offset>ne.offset?1:-1),Y=q.length,ae=-1;for(;W&&Y>0;){let K=q[--Y].offset+t;K<W.stringsPosition+t&&ae===-1&&(ae=0),K>W.position+t?ae>=0&&(ae+=6):(ae>=0&&(bl.setUint32(W.position+t,bl.getUint32(W.position+t)+ae),ae=-1),W=W.previous,Y++)}ae>=0&&W&&bl.setUint32(W.position+t,bl.getUint32(W.position+t)+ae),qt+=q.length*6,qt>Wd&&V(qt),o.offset=qt;let Z=xBe(sn.subarray(t,qt),q);return s=null,Z}return o.offset=qt,U&wBe?(sn.start=t,sn.end=qt,sn):sn.subarray(t,qt)}catch(W){throw J=W,W}finally{if(i&&(x(),r&&o.saveStructures)){let W=i.sharedLength||0,q=sn.subarray(t,qt),Y=TBe(i,o);if(!J)return o.saveStructures(Y,Y.isCompatible)===!1?o.pack($,U):(o.lastNamedStructuresLength=W,sn.length>1073741824&&(sn=null),q)}sn.length>1073741824&&(sn=null),U&RBe&&(qt=t)}};const x=()=>{v<10&&v++;let $=i.sharedLength||0;if(i.length>$&&!l&&(i.length=$),y>1e4)i.transitions=null,v=0,y=0,_.length>0&&(_=[]);else if(_.length>0&&!l){for(let U=0,J=_.length;U<J;U++)_[U][Hx]=0;_=[]}},E=$=>{var U=$.length;U<16?sn[qt++]=144|U:U<65536?(sn[qt++]=220,sn[qt++]=U>>8,sn[qt++]=U&255):(sn[qt++]=221,bl.setUint32(qt,U),qt+=4);for(let J=0;J<U;J++)M($[J])},M=$=>{qt>Wd&&(sn=V(qt));var U=typeof $,J;if(U==="string"){let W=$.length;if(Bc&&W>=4&&W<4096){if((Bc.size+=W)>bBe){let Z,K=(Bc[0]?Bc[0].length*3+Bc[1].length:0)+10;qt+K>Wd&&(sn=V(qt+K));let ne;Bc.position?(ne=Bc,sn[qt]=200,qt+=3,sn[qt++]=98,Z=qt-t,qt+=4,MQ(t,M,0),bl.setUint16(Z+t-3,qt-t-Z)):(sn[qt++]=214,sn[qt++]=98,Z=qt-t,qt+=4),Bc=["",""],Bc.previous=ne,Bc.size=0,Bc.position=Z}let ae=SBe.test($);Bc[ae?0:1]+=$,sn[qt++]=193,M(ae?-W:W);return}let q;W<32?q=1:W<256?q=2:W<65536?q=3:q=5;let Y=W*3;if(qt+Y>Wd&&(sn=V(qt+Y)),W<64||!a){let ae,Z,K,ne=qt+q;for(ae=0;ae<W;ae++)Z=$.charCodeAt(ae),Z<128?sn[ne++]=Z:Z<2048?(sn[ne++]=Z>>6|192,sn[ne++]=Z&63|128):(Z&64512)===55296&&((K=$.charCodeAt(ae+1))&64512)===56320?(Z=65536+((Z&1023)<<10)+(K&1023),ae++,sn[ne++]=Z>>18|240,sn[ne++]=Z>>12&63|128,sn[ne++]=Z>>6&63|128,sn[ne++]=Z&63|128):(sn[ne++]=Z>>12|224,sn[ne++]=Z>>6&63|128,sn[ne++]=Z&63|128);J=ne-qt-q}else J=a($,qt+q);J<32?sn[qt++]=160|J:J<256?(q<2&&sn.copyWithin(qt+2,qt+1,qt+1+J),sn[qt++]=217,sn[qt++]=J):J<65536?(q<3&&sn.copyWithin(qt+3,qt+2,qt+2+J),sn[qt++]=218,sn[qt++]=J>>8,sn[qt++]=J&255):(q<5&&sn.copyWithin(qt+5,qt+3,qt+3+J),sn[qt++]=219,bl.setUint32(qt,J),qt+=4),qt+=J}else if(U==="number")if($>>>0===$)$<32||$<128&&this.useRecords===!1||$<64&&!this.randomAccessStructure?sn[qt++]=$:$<256?(sn[qt++]=204,sn[qt++]=$):$<65536?(sn[qt++]=205,sn[qt++]=$>>8,sn[qt++]=$&255):(sn[qt++]=206,bl.setUint32(qt,$),qt+=4);else if($>>0===$)$>=-32?sn[qt++]=256+$:$>=-128?(sn[qt++]=208,sn[qt++]=$+256):$>=-32768?(sn[qt++]=209,bl.setInt16(qt,$),qt+=2):(sn[qt++]=210,bl.setInt32(qt,$),qt+=4);else{let W;if((W=this.useFloat32)>0&&$<4294967296&&$>=-2147483648){sn[qt++]=202,bl.setFloat32(qt,$);let q;if(W<4||(q=$*Yj[(sn[qt]&127)<<1|sn[qt+1]>>7])>>0===q){qt+=4;return}else qt--}sn[qt++]=203,bl.setFloat64(qt,$),qt+=8}else if(U==="object"||U==="function")if(!$)sn[qt++]=192;else{if(s){let q=s.get($);if(q){if(!q.id){let Y=s.idsToInsert||(s.idsToInsert=[]);q.id=Y.push(q)}sn[qt++]=214,sn[qt++]=112,bl.setUint32(qt,q.id),qt+=4;return}else s.set($,{offset:qt-t})}let W=$.constructor;if(W===Object)D($);else if(W===Array)E($);else if(W===Map)if(this.mapAsEmptyObject)sn[qt++]=128;else{J=$.size,J<16?sn[qt++]=128|J:J<65536?(sn[qt++]=222,sn[qt++]=J>>8,sn[qt++]=J&255):(sn[qt++]=223,bl.setUint32(qt,J),qt+=4);for(let[q,Y]of $)M(q),M(Y)}else{for(let q=0,Y=z7.length;q<Y;q++){let ae=cue[q];if($ instanceof ae){let Z=z7[q];if(Z.write){Z.type&&(sn[qt++]=212,sn[qt++]=Z.type,sn[qt++]=0);let de=Z.write.call(this,$);de===$?Array.isArray($)?E($):D($):M(de);return}let K=sn,ne=bl,le=qt;sn=null;let ce;try{ce=Z.pack.call(this,$,de=>(sn=K,K=null,qt+=de,qt>Wd&&V(qt),{target:sn,targetView:bl,position:qt-de}),M)}finally{K&&(sn=K,bl=ne,qt=le,Wd=sn.length-10)}ce&&(ce.length+qt>Wd&&V(ce.length+qt),qt=CQ(ce,sn,qt,Z.type));return}}if(Array.isArray($))E($);else{if($.toJSON){const q=$.toJSON();if(q!==$)return M(q)}if(U==="function")return M(this.writeFunction&&this.writeFunction($));D($)}}}else if(U==="boolean")sn[qt++]=$?195:194;else if(U==="bigint"){if($<9223372036854776e3&&$>=-9223372036854776e3)sn[qt++]=211,bl.setBigInt64(qt,$);else if($<18446744073709552e3&&$>0)sn[qt++]=207,bl.setBigUint64(qt,$);else if(this.largeBigIntToFloat)sn[qt++]=203,bl.setFloat64(qt,Number($));else{if(this.largeBigIntToString)return M($.toString());if(this.useBigIntExtension||this.moreTypes){let W=$<0?BigInt(-1):BigInt(0),q;if($>>BigInt(65536)===W){let Y=BigInt(18446744073709552e3)-BigInt(1),ae=[];for(;ae.push($&Y),$>>BigInt(63)!==W;)$>>=BigInt(64);q=new Uint8Array(new BigUint64Array(ae).buffer),q.reverse()}else{let Y=$<0,ae=(Y?~$:$).toString(16);if(ae.length%2?ae="0"+ae:parseInt(ae.charAt(0),16)>=8&&(ae="00"+ae),rw)q=mf.from(ae,"hex");else{q=new Uint8Array(ae.length/2);for(let Z=0;Z<q.length;Z++)q[Z]=parseInt(ae.slice(Z*2,Z*2+2),16)}if(Y)for(let Z=0;Z<q.length;Z++)q[Z]=~q[Z]}q.length+qt>Wd&&V(q.length+qt),qt=CQ(q,sn,qt,66);return}else throw new RangeError($+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string")}qt+=8}else if(U==="undefined")this.encodeUndefinedAsNil?sn[qt++]=192:(sn[qt++]=212,sn[qt++]=0,sn[qt++]=0);else throw new Error("Unknown type: "+U)},O=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?$=>{let U;if(this.skipValues){U=[];for(let q in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(q))&&!this.skipValues.includes($[q])&&U.push(q)}else U=Object.keys($);let J=U.length;J<16?sn[qt++]=128|J:J<65536?(sn[qt++]=222,sn[qt++]=J>>8,sn[qt++]=J&255):(sn[qt++]=223,bl.setUint32(qt,J),qt+=4);let W;if(this.coercibleKeyAsNumber)for(let q=0;q<J;q++){W=U[q];let Y=Number(W);M(isNaN(Y)?W:Y),M($[W])}else for(let q=0;q<J;q++)M(W=U[q]),M($[W])}:$=>{sn[qt++]=222;let U=qt-t;qt+=2;let J=0;for(let W in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(W))&&(M(W),M($[W]),J++);if(J>65535)throw new Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');sn[U+++t]=J>>8,sn[U+t]=J&255},N=this.useRecords===!1?O:e.progressiveRecords&&!d?$=>{let U,J=i.transitions||(i.transitions=Object.create(null)),W=qt++-t,q;for(let Y in $)if(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y)){if(U=J[Y],U)J=U;else{let ae=Object.keys($),Z=J;J=i.transitions;let K=0;for(let ne=0,le=ae.length;ne<le;ne++){let ce=ae[ne];U=J[ce],U||(U=J[ce]=Object.create(null),K++),J=U}W+t+1==qt?(qt--,G(J,ae,K)):Q(J,ae,W,K),q=!0,J=Z[Y]}M($[Y])}if(!q){let Y=J[Hx];Y?sn[W+t]=Y:Q(J,Object.keys($),W,0)}}:$=>{let U,J=i.transitions||(i.transitions=Object.create(null)),W=0;for(let Y in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y))&&(U=J[Y],U||(U=J[Y]=Object.create(null),W++),J=U);let q=J[Hx];q?q>=96&&d?(sn[qt++]=((q-=96)&31)+96,sn[qt++]=q>>5):sn[qt++]=q:G(J,J.__keys__||Object.keys($),W);for(let Y in $)(typeof $.hasOwnProperty!="function"||$.hasOwnProperty(Y))&&M($[Y])},I=typeof this.useRecords=="function"&&this.useRecords,D=I?$=>{I($)?N($):O($)}:N,V=$=>{let U;if($>16777216){if($-t>AQ)throw new Error("Packed buffer would be larger than maximum buffer size");U=Math.min(AQ,Math.round(Math.max(($-t)*($>67108864?1.25:2),4194304)/4096)*4096)}else U=(Math.max($-t<<2,sn.length-1)>>12)+1<<12;let J=new BI(U);return bl=J.dataView||(J.dataView=new DataView(J.buffer,0,U)),$=Math.min($,sn.length),sn.copy?sn.copy(J,0,t,$):J.set(sn.slice(t,$)),qt-=t,t=0,Wd=J.length-10,sn=J},G=($,U,J)=>{let W=i.nextId;W||(W=64),W<g&&this.shouldShareStructure&&!this.shouldShareStructure(U)?(W=i.nextOwnId,W<p||(W=g),i.nextOwnId=W+1):(W>=p&&(W=g),i.nextId=W+1);let q=U.highByte=W>=96&&d?W-96>>5:-1;$[Hx]=W,$.__keys__=U,i[W-64]=U,W<g?(U.isShared=!0,i.sharedLength=W-63,r=!0,q>=0?(sn[qt++]=(W&31)+96,sn[qt++]=q):sn[qt++]=W):(q>=0?(sn[qt++]=213,sn[qt++]=114,sn[qt++]=(W&31)+96,sn[qt++]=q):(sn[qt++]=212,sn[qt++]=114,sn[qt++]=W),J&&(y+=v*J),_.length>=f&&(_.shift()[Hx]=0),_.push($),M(U))},Q=($,U,J,W)=>{let q=sn,Y=qt,ae=Wd,Z=t;sn=AM,qt=0,t=0,sn||(AM=sn=new BI(8192)),Wd=sn.length-10,G($,U,W),AM=sn;let K=qt;if(sn=q,qt=Y,Wd=ae,t=Z,K>1){let ne=qt+K-1;ne>Wd&&V(ne);let le=J+t;sn.copyWithin(le+K,le+1,qt),sn.set(AM.slice(0,K),le),qt=ne}else sn[J+t]=AM[0]},B=$=>{let U=yBe($,sn,t,qt,i,V,(J,W,q)=>{if(q)return r=!0;qt=W;let Y=sn;return M(J),x(),Y!==sn?{position:qt,targetView:bl,target:sn}:qt},this);if(U===0)return D($);qt=U}}useBuffer(e){sn=e,sn.dataView||(sn.dataView=new DataView(sn.buffer,sn.byteOffset,sn.byteLength)),bl=sn.dataView,qt=0}set position(e){qt=e}get position(){return qt}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}cue=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,DataView,eue];z7=[{pack(n,e,t){let r=n.getTime()/1e3;if((this.useTimestamp32||n.getMilliseconds()===0)&&r>=0&&r<4294967296){let{target:i,targetView:s,position:a}=e(6);i[a++]=214,i[a++]=255,s.setUint32(a,r)}else if(r>0&&r<4294967296){let{target:i,targetView:s,position:a}=e(10);i[a++]=215,i[a++]=255,s.setUint32(a,n.getMilliseconds()*4e6+(r/1e3/4294967296>>0)),s.setUint32(a+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),t(this.onInvalidDate());let{target:i,targetView:s,position:a}=e(3);i[a++]=212,i[a++]=255,i[a++]=255}else{let{target:i,targetView:s,position:a}=e(15);i[a++]=199,i[a++]=12,i[a++]=255,s.setUint32(a,n.getMilliseconds()*1e6),s.setBigInt64(a+4,BigInt(Math.floor(r)))}}},{pack(n,e,t){if(this.setAsEmptyObject)return e(0),t({});let r=Array.from(n),{target:i,position:s}=e(this.moreTypes?3:0);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),t(r)}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=101,r[i++]=0),t([n.name,n.message,n.cause])}},{pack(n,e,t){let{target:r,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(r[i++]=212,r[i++]=120,r[i++]=0),t([n.source,n.flags])}},{pack(n,e){this.moreTypes?hB(n,16,e):dB(rw?mf.from(n):new Uint8Array(n),e)}},{pack(n,e){let t=n.constructor;t!==uue&&this.moreTypes?hB(n,oue.indexOf(t.name),e):dB(n,e)}},{pack(n,e){this.moreTypes?hB(n,17,e):dB(rw?mf.from(n):new Uint8Array(n),e)}},{pack(n,e){let{target:t,position:r}=e(1);t[r]=193}}];function hB(n,e,t,r){let i=n.byteLength;if(i+1<256){var{target:s,position:a}=t(4+i);s[a++]=199,s[a++]=i+1}else if(i+1<65536){var{target:s,position:a}=t(5+i);s[a++]=200,s[a++]=i+1>>8,s[a++]=i+1&255}else{var{target:s,position:a,targetView:o}=t(7+i);s[a++]=201,o.setUint32(a,i+1),a+=4}s[a++]=116,s[a++]=e,n.buffer||(n=new Uint8Array(n)),s.set(new Uint8Array(n.buffer,n.byteOffset,n.byteLength),a)}function dB(n,e){let t=n.byteLength;var r,i;if(t<256){var{target:r,position:i}=e(t+2);r[i++]=196,r[i++]=t}else if(t<65536){var{target:r,position:i}=e(t+3);r[i++]=197,r[i++]=t>>8,r[i++]=t&255}else{var{target:r,position:i,targetView:s}=e(t+5);r[i++]=198,s.setUint32(i,t),i+=4}r.set(n,i)}function CQ(n,e,t,r){let i=n.length;switch(i){case 1:e[t++]=212;break;case 2:e[t++]=213;break;case 4:e[t++]=214;break;case 8:e[t++]=215;break;case 16:e[t++]=216;break;default:i<256?(e[t++]=199,e[t++]=i):i<65536?(e[t++]=200,e[t++]=i>>8,e[t++]=i&255):(e[t++]=201,e[t++]=i>>24,e[t++]=i>>16&255,e[t++]=i>>8&255,e[t++]=i&255)}return e[t++]=r,e.set(n,t),t+=i,t}function xBe(n,e){let t,r=e.length*6,i=n.length-r;for(;t=e.pop();){let s=t.offset,a=t.id;n.copyWithin(s+r,s,i),r-=6;let o=s+r;n[o++]=214,n[o++]=105,n[o++]=a>>24,n[o++]=a>>16&255,n[o++]=a>>8&255,n[o++]=a&255,i=s}return n}function MQ(n,e,t){if(Bc.length>0){bl.setUint32(Bc.position+n,qt+t-Bc.position-n),Bc.stringsPosition=qt-n;let r=Bc;Bc=null,e(r[0]),e(r[1])}}function TBe(n,e){return n.isCompatible=t=>{let r=!t||(e.lastNamedStructuresLength||0)===t.length;return r||e._mergeStructures(t),r},n}let fue=new EBe({useRecords:!1});fue.pack;fue.pack;const wBe=512,RBe=1024,ABe=2048;function Xj(n,e,t={}){if(xe(n))try{const r={};for(let i=0;i<n.length;i+=2){let s=n[i],a=n[i+1];const o=e[s];xe(o)&&(s=o);const l=t[s];xe(l)&&(a=l(a)),r[s]=a}return r}catch(r){Si(xt,"","format",r.message)}}function CBe(n,e){return n%e}function MBe(n,e){return Math.floor(n/e)}function iw(n,e){return{x:CBe(n,e),y:MBe(n,e)}}function kQ(n,e){const t=n.x-e.x,r=n.y-e.y;return Math.sqrt(t*t+r*r)}function gf(n,e){return n.x+n.y*e}function kBe(n,e,t,r,i,s){return n>=s&&n<=r&&e>=t&&e<=i}function OQ(n,e,t,r){const i=[],s=Math.abs(t-n),a=Math.abs(r-e),o=n<t?1:-1,l=e<r?1:-1;let c=s-a;for(i.push({x:n,y:e});n!==t||e!==r;){const u=2*c;u>-a&&(c-=a,n+=o),u<s&&(c+=s,e+=l),i.push({x:n,y:e})}return i}function aE(n){return xe(n)&&xe(n.x)&&xe(n.y)}function uu(n,e){switch(e){case Hn.NORTH:--n.y;break;case Hn.SOUTH:++n.y;break;case Hn.WEST:--n.x;break;case Hn.EAST:++n.x;break}return n}function ZS(n,e){return n<0?Hn.WEST:n>0?Hn.EAST:e<0?Hn.NORTH:e>0?Hn.SOUTH:Hn.IDLE}function dv(n,e){return ZS(e.x-n.x,e.y-n.y)}const hue={idle:"IDLE",up:"NORTH",down:"SOUTH",left:"WEST",right:"EAST",by:"BY",at:"AT",flow:"FLOW",seek:"SEEK",rndns:"RNDNS",rndne:"RNDNE",rnd:"RND",cw:"CW",ccw:"CCW",opp:"OPP",rndp:"RNDP",away:"AWAY",toward:"TOWARD",find:"FIND",flee:"FLEE",to:"TO",i:"IDLE",u:"NORTH",north:"NORTH",n:"NORTH",d:"SOUTH",south:"SOUTH",s:"SOUTH",l:"WEST",west:"WEST",w:"WEST",r:"EAST",east:"EAST",e:"EAST",over:"OVER",under:"UNDER",within:"WITHIN",awayby:"AWAYBY"};function F0(n){return bi(n)&&due(n[0])}function due(n){return xe(Hn[n])&&Vn(n)}function pue(n){const e=Hn[n];return xe(e)?e:Hn.IDLE}function U4(n){if(Vn(n))return hue[qr(n)]}function OBe(n){if(F0(n))return n;if(due(n))return[n];const e=U4(n);if(xe(e))return[e]}function IQ(n){const e=Oe.words[n],t=OBe(e);return F0(t)?[t,n+1]:[void 0,n]}function mue(n){const e=[];let[t,r]=IQ(n);for(;F0(t);){switch(e.push(...t),t[0]){case"AT":case"BY":case"AWAY":case"TOWARD":{const[o,l,c]=ln(Oe.words,r,[Dt.NUMBER,Dt.NUMBER]);e.push(o,l),r=c;break}case"FLEE":case"FIND":{const[o,l]=ln(Oe.words,r,[Dt.KIND]);console.info("kind",o),r=l;break}case"TO":{const[o,l,c]=ln(Oe.words,r,[Dt.DIR,Dt.DIR]),u=Oe.element?.x??0,f=Oe.element?.y??0;o.destpt.x-=u,o.destpt.y-=f,l.destpt.x-=u,l.destpt.y-=f,e.push(u+o.destpt.x+l.destpt.x,f+o.destpt.y+l.destpt.y),r=c;break}case"WITHIN":case"AWAYBY":{const[o,l]=ln(Oe.words,r,[Dt.NUMBER]);e.push(o),r=l;break}}const i=r;switch(t[0]){case"CW":case"CCW":case"OPP":case"RNDP":case"OVER":case"UNDER":case"WITHIN":case"AWAYBY":break;default:return[e,r]}const[s,a]=IQ(i);t=s,r=a}return e.length?[e,r]:[void 0,n]}function IBe(n){if(xe(n)&&(n<Sn.ONBLACK||n>Sn.ONCLEAR))return n}function Kj(n){return xe(n)&&n>Sn.WHITE&&n<Sn.ONCLEAR?n-Sn.ONBLACK:void 0}const B4={black:"BLACK",dkblue:"DKBLUE",dkgreen:"DKGREEN",dkcyan:"DKCYAN",dkred:"DKRED",dkpurple:"DKPURPLE",dkyellow:"DKYELLOW",ltgray:"LTGRAY",dkgray:"DKGRAY",blue:"BLUE",green:"GREEN",cyan:"CYAN",red:"RED",purple:"PURPLE",yellow:"YELLOW",white:"WHITE",brown:"DKYELLOW",dkwhite:"LTGRAY",ltgrey:"LTGRAY",gray:"LTGRAY",grey:"LTGRAY",dkgrey:"DKGRAY",ltblack:"DKGRAY",onblack:"ONBLACK",ondkblue:"ONDKBLUE",ondkgreen:"ONDKGREEN",ondkcyan:"ONDKCYAN",ondkred:"ONDKRED",ondkpurple:"ONDKPURPLE",ondkyellow:"ONDKYELLOW",onltgray:"ONLTGRAY",ondkgray:"ONDKGRAY",onblue:"ONBLUE",ongreen:"ONGREEN",oncyan:"ONCYAN",onred:"ONRED",onpurple:"ONPURPLE",onyellow:"ONYELLOW",onwhite:"ONWHITE",onbrown:"ONDKYELLOW",ondkwhite:"ONLTGRAY",onltgrey:"ONLTGRAY",ongray:"ONLTGRAY",ongrey:"ONLTGRAY",ondkgrey:"ONDKGRAY",onltblack:"ONDKGRAY",onclear:"ONCLEAR",blblack:"BLBLACK",bldkblue:"BLDKBLUE",bldkgreen:"BLDKGREEN",bldkcyan:"BLDKCYAN",bldkred:"BLDKRED",bldkpurple:"BLDKPURPLE",bldkyellow:"BLDKYELLOW",blltgray:"BLLTGRAY",bldkgray:"BLDKGRAY",blblue:"BLBLUE",blgreen:"BLGREEN",blcyan:"BLCYAN",blred:"BLRED",blpurple:"BLPURPLE",blyellow:"BLYELLOW",blwhite:"BLWHITE",blbrown:"BLDKYELLOW",bldkwhite:"BLLTGRAY",blltgrey:"BLLTGRAY",blgray:"BLLTGRAY",blgrey:"BLLTGRAY",bldkgrey:"BLDKGRAY",blltblack:"BLDKGRAY"};function Up(n){return bi(n)&&gue(n[0])}function NBe(n){return Up(n)&&n[0].startsWith("ON")}function gue(n){return xe(Sn[n])&&Vn(n)}function ik(n){if(Vn(n))return B4[qr(n)]}function F4(n,e){return[xe(n)?`${Sn[n]}`:void 0,xe(e)?`ON${Sn[e]}`:void 0].filter(xe)}function MD(n){return n.map(e=>Sn[e]).find(e=>xe(e)&&e<Sn.ONBLACK)}function kD(n){return n.map(e=>Sn[e]).find(e=>xe(e)&&e>=Sn.ONBLACK)}function PBe(n){if(Up(n))return n;if(gue(n))return[n];const e=ik(n);if(xe(e))return[e]}function NQ(n){const e=Oe.words[n],t=PBe(e);return Up(t)?[t,n+1]:[void 0,n]}function OD(n){const e=[];let t=n;const r=parseFloat(Oe.words[n]);if(Mn(r))return[F4(r,void 0),n+1];const[i,s]=NQ(n);Up(i)&&(e.push(...i),t=s);const[a,o]=NQ(s);return NBe(a)&&(e.push(...a),t=o),e.length?[e,t]:[void 0,n]}function _ue(n){const e={};for(let t=0;t<n.length;++t){const r=n[t],i=Sn[r];xe(i)&&(i<Sn.ONBLACK?e.color=i:e.bg=Kj(i))}return e}function oE(n){return bi(n)&&typeof n[0]=="string"}function DBe(n){const e=Oe.words[n];return Vn(e)?[e,n+1]:[void 0,n]}function pB(n){const e=Oe.words[n];if(oE(e))return[e,n+1];const[t,r]=OD(n),[i,s]=DBe(r);return Vn(i)&&(i==="empty"||O1({kind:i}))?[[i,t],s]:[void 0,n]}function sk(n){if(!oE(n))return;const[e]=n;return e}function ID(n){if(!oE(n))return;const[,e]=n,t=xe(e)?MD(e):void 0;return xe(t)?t:void 0}function vue(n){if(!oE(n))return;const[,e]=n,t=xe(e)?kD(e):void 0;return xe(t)?Kj(t):void 0}function LBe(n){const e=document.createElement("canvas");if(e.width=n?.width||1,e.height=n?.height||1,n){const t=e.getContext("2d"),r=t?.getImageData(0,0,n.width,n.height);if(r&&t){let i=0;const{data:s}=r;for(let a=0;a<s.length;a+=4){const o=n.bits[i];s[a]=o,s[a+1]=o,s[a+2]=o,s[a+3]=255,i+=1}t.putImageData(r,0,0)}}return e}function Zj(n,e){return{width:n,height:e,size:n*e,bits:new Uint8Array(n*e).fill(0)}}function mB(n,e,t){return{width:n,height:e,size:n*e,bits:new Uint8Array(t)}}function gB(n,e,t){if(!xe(n))return;const r=Math.round(n.height/t),i=Math.round(n.width/e),s=e+2,a=t+2,o=i*e,l=i*s,c=r*a,u=Zj(l,c);for(let f=0;f<r;++f)for(let d=0;d<i;++d)for(let g=0;g<t;++g)for(let p=0;p<e;++p){const _=d*e+p,y=f*t+g,v=n.bits[_+y*o],x=d*s+p+1,E=f*a+g+1,M=x+E*l;u.bits[M]=v,p===0&&(u.bits[M-1]=v),p===Jd-1&&(u.bits[M+1]=v),g===0&&(u.bits[M-l]=v),g===ep-1&&(u.bits[M+l]=v)}return u}function QE(n){const e=Math.floor(n.length/tw);if(e*tw!==n.length)return;const t=Zj(3,e);for(let r=0;r<t.bits.length;++r)t.bits[r]=n[r];return t}function UBe(n,e){return n&1<<e?255:0}function JE(n){const e=Math.floor(n.length/D7);if(e*D7!==n.length)return;const t=Math.ceil(e/O0),r=Jd*O0,i=Zj(r,ep*t);let s=0,a=0,o=0;for(let l=0;l<n.length;++l){const c=a*ep+o,u=n[l];for(let f=0;f<Jd;++f){const d=s*Jd+f;i.bits[d+c*r]=UBe(u,7-f)}++o,o===ep&&(o=0,++s,s===O0&&(s=0,++a))}return i}/* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
*
* @author   Jimmy Wrting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
* @license  MIT
*/const PQ="0123456789abcdef",yue=[],ND=[];for(let n=0;n<256;n++)yue[n]=PQ[n>>4&15]+PQ[n&15],n<16&&(n<10?ND[48+n]=n:ND[87+n]=n);const bue=n=>{const e=n.length;let t="",r=0;for(;r<e;)t+=yue[n[r++]];return t},Ig=n=>{const e=n.length>>1,t=e<<1,r=new Uint8Array(e);let i=0,s=0;for(;s<t;)r[i++]=ND[n.charCodeAt(s++)]<<4|ND[n.charCodeAt(s++)];return r};var DQ="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BBe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var FI=0;FI<DQ.length;FI++)BBe[DQ.charCodeAt(FI)]=FI;new TextDecoder;new TextEncoder;const LQ=typeof window<"u"?window:self,UQ=LQ.crypto||LQ.msCrypto||{};UQ.subtle||UQ.webkitSubtle;const Hw=Ig("000000000000000000000000000000007e81a58181bd99817e00000000007effdbffffc3e7ff7e0000000000006cfefefefe7c381000000000000010387cfe7c3810000000000000183c3ce7e7e718183c0000000000183c7effff7e18183c0000000000000000183c3c180000000000ffffffffffe7c3c3e7ffffffffff000000003c664242663c00000000ffffffffc399bdbd99c3ffffffff00001e0e1a3278cccccc7800000000003c6666663c187e181800000000003f333f30303070f0e000000000007f637f63636367e7e6c0000000001818db3ce73cdb1818000000000080c0e0f8fef8e0c080000000000002060e3efe3e0e06020000000000183c7e1818187e3c18000000000066666666666600666600000000007fdbdbdb7b1b1b1b1b000000007cc660386cc6c66c380cc67c000000000000000000fefefe0000000000183c7e1818187e3c187e00000000183c7e18181818181800000000001818181818187e3c1800000000000000180cfe0c180000000000000000003060fe603000000000000000000000c0c0c0fe000000000000000000286cfe6c2800000000000000001038387c7cfefe00000000000000fefe7c7c3838100000000000000000000000000000000000000000183c3c3c1818001818000000006666662400000000000000000000006c6cfe6c6c6cfe6c6c00000018187cc6c2c07c0686c67c18180000000000c2c60c183066c60000000000386c6c3876dccccc76000000003030306000000000000000000000000c183030303030180c000000000030180c0c0c0c0c183000000000000000663cff3c6600000000000000000018187e181800000000000000000000000000181818300000000000000000fe000000000000000000000000000000001818000000000002060c183060c0800000000000007cc6cedef6e6c6c67c000000000018387818181818187e00000000007cc6060c183060c6fe00000000007cc606063c0606c67c00000000000c1c3c6cccfe0c0c1e0000000000fec0c0c0fc0606c67c00000000003860c0c0fcc6c6c67c0000000000fec6060c183030303000000000007cc6c6c67cc6c6c67c00000000007cc6c6c67e06060c78000000000000181800000018180000000000000018180000001818300000000000060c18306030180c0600000000000000007e00007e000000000000006030180c060c18306000000000007cc6c60c181800181800000000007cc6c6dedededcc07c000000000010386cc6c6fec6c6c60000000000fc6666667c666666fc00000000003c66c2c0c0c0c2663c0000000000f86c66666666666cf80000000000fe66626878686266fe0000000000fe66626878686060f000000000003c66c2c0c0dec6663a0000000000c6c6c6c6fec6c6c6c600000000003c181818181818183c00000000001e0c0c0c0c0ccccc780000000000e6666c6c786c6c66e60000000000f060606060606266fe0000000000c6eefefed6c6c6c6c60000000000c6e6f6fedecec6c6c60000000000386cc6c6c6c6c66c380000000000fc6666667c606060f000000000007cc6c6c6c6d6de7c0c0e00000000fc6666667c6c6666e600000000007cc6c660380cc6c67c00000000007e7e5a18181818183c0000000000c6c6c6c6c6c6c6c67c0000000000c6c6c6c6c6c66c38100000000000c6c6c6c6d6d6fe7c6c0000000000c6c66c3838386cc6c60000000000666666663c1818183c0000000000fec68c183060c2c6fe00000000003c303030303030303c000000000080c0e070381c0e060200000000003c0c0c0c0c0c0c0c3c00000010386cc600000000000000000000000000000000000000000000ff0030301800000000000000000000000000000000780c7ccccc760000000000e06060786c6666667c00000000000000007cc6c0c0c67c00000000001c0c0c3c6ccccccc7600000000000000007cc6fec0c67c0000000000386c6460f0606060f0000000000000000076cccccc7c0ccc78000000e060606c76666666e6000000000018180038181818183c00000000000606000e0606060666663c000000e06060666c786c66e6000000000038181818181818183c0000000000000000ecfed6d6d6c60000000000000000dc666666666600000000000000007cc6c6c6c67c0000000000000000dc6666667c6060f000000000000076cccccc7c0c0c1e000000000000dc76666060f000000000000000007cc6701cc67c0000000000103030fc303030361c0000000000000000cccccccccc760000000000000000666666663c180000000000000000c6c6d6d6fe6c0000000000000000c66c38386cc60000000000000000c6c6c6c67e060cf8000000000000fecc183066fe00000000000e181818701818180e00000000001818181800181818180000000000701818180e18181870000000000076dc000000000000000000000000000010386cc6c6fe0000000000003c66c2c0c0c2663c0c067c000000cccc00cccccccccc76000000000c1830007cc6fec0c67c0000000010386c00780c7ccccc760000000000cccc00780c7ccccc760000000060301800780c7ccccc7600000000386c3800780c7ccccc76000000000000003c6660663c0c063c00000010386c007cc6fec0c67c0000000000cccc007cc6fec0c67c00000000603018007cc6fec0c67c000000000066660038181818183c00000000183c660038181818183c000000006030180038181818183c00000000c6c610386cc6c6fec6c6000000386c3800386cc6c6fec6c600000018306000fe66607c6066fe00000000000000cc76367ed8d86e00000000003e6cccccfeccccccce0000000010386c007cc6c6c6c67c0000000000c6c6007cc6c6c6c67c00000000603018007cc6c6c6c67c000000003078cc00cccccccccc760000000060301800cccccccccc760000000000c6c600c6c6c6c67e060c780000c6c6386cc6c6c6c66c3800000000c6c600c6c6c6c6c6c67c0000000018183c666060663c181800000000386c6460f0606060e6fc000000000066663c187e187e181800000000f8ccccf8c4ccdeccccc6000000000e1b1818187e18181818d870000018306000780c7ccccc76000000000c18300038181818183c00000000183060007cc6c6c6c67c0000000018306000cccccccccc76000000000076dc00dc666666666600000076dc00c6e6f6fedecec6c6000000003c6c6c3e007e0000000000000000386c6c38007c000000000000000000303000303060c6c67c000000000000000000fec0c0c000000000000000000000fe0606060000000000c0c0c6ccd83060dc860c183e0000c0c0c6ccd83066ce9e3e060600000018180018183c3c3c1800000000000000366cd86c36000000000000000000d86c366cd80000000000114411441144114411441144114455aa55aa55aa55aa55aa55aa55aadd77dd77dd77dd77dd77dd77dd77181818181818181818181818181818181818181818f81818181818181818181818f818f818181818181836363636363636f636363636363600000000000000fe3636363636360000000000f818f81818181818183636363636f606f636363636363636363636363636363636363636360000000000fe06f63636363636363636363636f606fe00000000000036363636363636fe0000000000001818181818f818f800000000000000000000000000f8181818181818181818181818181f00000000000018181818181818ff00000000000000000000000000ff181818181818181818181818181f18181818181800000000000000ff00000000000018181818181818ff18181818181818181818181f181f1818181818183636363636363637363636363636363636363637303f00000000000000000000003f30373636363636363636363636f700ff0000000000000000000000ff00f736363636363636363636363730373636363636360000000000ff00ff0000000000003636363636f700f73636363636361818181818ff00ff00000000000036363636363636ff0000000000000000000000ff00ff18181818181800000000000000ff363636363636363636363636363f00000000000018181818181f181f00000000000000000000001f181f181818181818000000000000003f36363636363636363636363636ff3636363636361818181818ff18ff18181818181818181818181818f8000000000000000000000000001f181818181818ffffffffffffffffffffffffffff00000000000000fffffffffffffff0f0f0f0f0f0f0f0f0f0f0f0f0f00f0f0f0f0f0f0f0f0f0f0f0f0f0fffffffffffffff00000000000000000000000076dcd8d8dc76000000000000007cc6fcc6c6fcc0c040000000fec6c6c0c0c0c0c0c000000000000000fe6c6c6c6c6c6c0000000000fec66030183060c6fe00000000000000007ed8d8d8d87000000000000000666666667c6060c000000000000076dc181818181800000000007e183c6666663c187e0000000000386cc6c6fec6c66c380000000000386cc6c6c66c6c6cee00000000001e30180c3e6666663c00000000000000007edbdb7e0000000000000003067edbdbf37e60c000000000001c3060607c6060301c0000000000007cc6c6c6c6c6c6c6000000000000fe0000fe0000fe0000000000000018187e18180000ff000000000030180c060c1830007e00000000000c18306030180c007e00000000000e1b1b1818181818181818181818181818181818d8d8700000000000001818007e001818000000000000000076dc0076dc000000000000386c6c3800000000000000000000000000000018180000000000000000000000000018000000000000000f0c0c0c0c0cec6c3c1c00000000d86c6c6c6c6c000000000000000070d83060c8f800000000000000000000007c7c7c7c7c7c000000000000000000000000000000000000"),qw=Ig("00000000002a002a00002a2a2a00002a002a2a15002a2a2a15151515153f153f15153f3f3f15153f153f3f3f153f3f3f"),Wy=globalThis||void 0||self;var Sue=typeof Wy=="object"&&Wy&&Wy.Object===Object&&Wy,FBe=typeof self=="object"&&self&&self.Object===Object&&self,Kv=Sue||FBe||Function("return this")(),z0=Kv.Symbol,Eue=Object.prototype,zBe=Eue.hasOwnProperty,jBe=Eue.toString,CM=z0?z0.toStringTag:void 0;function HBe(n){var e=zBe.call(n,CM),t=n[CM];try{n[CM]=void 0;var r=!0}catch{}var i=jBe.call(n);return r&&(e?n[CM]=t:delete n[CM]),i}var qBe=Object.prototype,VBe=qBe.toString;function GBe(n){return VBe.call(n)}var $Be="[object Null]",WBe="[object Undefined]",BQ=z0?z0.toStringTag:void 0;function G1(n){return n==null?n===void 0?WBe:$Be:BQ&&BQ in Object(n)?HBe(n):GBe(n)}function A_(n){return n!=null&&typeof n=="object"}var YBe="[object Symbol]";function z4(n){return typeof n=="symbol"||A_(n)&&G1(n)==YBe}function j4(n,e){for(var t=-1,r=n==null?0:n.length,i=Array(r);++t<r;)i[t]=e(n[t],t,n);return i}var ka=Array.isArray,FQ=z0?z0.prototype:void 0,zQ=FQ?FQ.toString:void 0;function xue(n){if(typeof n=="string")return n;if(ka(n))return j4(n,xue)+"";if(z4(n))return zQ?zQ.call(n):"";var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}var XBe=/\s/;function KBe(n){for(var e=n.length;e--&&XBe.test(n.charAt(e)););return e}var ZBe=/^\s+/;function QBe(n){return n&&n.slice(0,KBe(n)+1).replace(ZBe,"")}function j0(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var jQ=NaN,JBe=/^[-+]0x[0-9a-f]+$/i,e8e=/^0b[01]+$/i,t8e=/^0o[0-7]+$/i,n8e=parseInt;function r8e(n){if(typeof n=="number")return n;if(z4(n))return jQ;if(j0(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=j0(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=QBe(n);var t=e8e.test(n);return t||t8e.test(n)?n8e(n.slice(2),t?2:8):JBe.test(n)?jQ:+n}var HQ=1/0,i8e=17976931348623157e292;function s8e(n){if(!n)return n===0?n:0;if(n=r8e(n),n===HQ||n===-HQ){var e=n<0?-1:1;return e*i8e}return n===n?n:0}function H4(n){var e=s8e(n),t=e%1;return e===e?t?e-t:e:0}function sw(n){return n}var a8e="[object AsyncFunction]",o8e="[object Function]",l8e="[object GeneratorFunction]",c8e="[object Proxy]";function gb(n){if(!j0(n))return!1;var e=G1(n);return e==o8e||e==l8e||e==a8e||e==c8e}var _B=Kv["__core-js_shared__"],qQ=(function(){var n=/[^.]+$/.exec(_B&&_B.keys&&_B.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function u8e(n){return!!qQ&&qQ in n}var f8e=Function.prototype,h8e=f8e.toString;function ex(n){if(n!=null){try{return h8e.call(n)}catch{}try{return n+""}catch{}}return""}var d8e=/[\\^$.*+?()[\]{}|]/g,p8e=/^\[object .+?Constructor\]$/,m8e=Function.prototype,g8e=Object.prototype,_8e=m8e.toString,v8e=g8e.hasOwnProperty,y8e=RegExp("^"+_8e.call(v8e).replace(d8e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function b8e(n){if(!j0(n)||u8e(n))return!1;var e=gb(n)?y8e:p8e;return e.test(ex(n))}function S8e(n,e){return n?.[e]}function tx(n,e){var t=S8e(n,e);return b8e(t)?t:void 0}var j7=tx(Kv,"WeakMap"),VQ=Object.create,E8e=(function(){function n(){}return function(e){if(!j0(e))return{};if(VQ)return VQ(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}})();function x8e(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}function qf(){}function T8e(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var w8e=800,R8e=16,A8e=Date.now;function C8e(n){var e=0,t=0;return function(){var r=A8e(),i=R8e-(r-t);if(t=r,i>0){if(++e>=w8e)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function M8e(n){return function(){return n}}var PD=(function(){try{var n=tx(Object,"defineProperty");return n({},"",{}),n}catch{}})(),k8e=PD?function(n,e){return PD(n,"toString",{configurable:!0,enumerable:!1,value:M8e(e),writable:!0})}:sw,O8e=C8e(k8e);function Tue(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}function wue(n,e,t,r){for(var i=n.length,s=t+-1;++s<i;)if(e(n[s],s,n))return s;return-1}function I8e(n){return n!==n}function N8e(n,e,t){for(var r=t-1,i=n.length;++r<i;)if(n[r]===e)return r;return-1}function Qj(n,e,t){return e===e?N8e(n,e,t):wue(n,I8e,t)}function Rue(n,e){var t=n==null?0:n.length;return!!t&&Qj(n,e,0)>-1}var P8e=9007199254740991,D8e=/^(?:0|[1-9]\d*)$/;function q4(n,e){var t=typeof n;return e=e??P8e,!!e&&(t=="number"||t!="symbol"&&D8e.test(n))&&n>-1&&n%1==0&&n<e}function Jj(n,e,t){e=="__proto__"&&PD?PD(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}function hO(n,e){return n===e||n!==n&&e!==e}var L8e=Object.prototype,U8e=L8e.hasOwnProperty;function V4(n,e,t){var r=n[e];(!(U8e.call(n,e)&&hO(r,t))||t===void 0&&!(e in n))&&Jj(n,e,t)}function eH(n,e,t,r){var i=!t;t||(t={});for(var s=-1,a=e.length;++s<a;){var o=e[s],l=void 0;l===void 0&&(l=n[o]),i?Jj(t,o,l):V4(t,o,l)}return t}var GQ=Math.max;function B8e(n,e,t){return e=GQ(e===void 0?n.length-1:e,0),function(){for(var r=arguments,i=-1,s=GQ(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=t(a),x8e(n,this,o)}}function tH(n,e){return O8e(B8e(n,e,sw),n+"")}var F8e=9007199254740991;function nH(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=F8e}function Zv(n){return n!=null&&nH(n.length)&&!gb(n)}function Aue(n,e,t){if(!j0(t))return!1;var r=typeof e;return(r=="number"?Zv(t)&&q4(e,t.length):r=="string"&&e in t)?hO(t[e],n):!1}function z8e(n){return tH(function(e,t){var r=-1,i=t.length,s=i>1?t[i-1]:void 0,a=i>2?t[2]:void 0;for(s=n.length>3&&typeof s=="function"?(i--,s):void 0,a&&Aue(t[0],t[1],a)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=t[r];o&&n(e,o,r,s)}return e})}var j8e=Object.prototype;function dO(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||j8e;return n===t}function H8e(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var q8e="[object Arguments]";function $Q(n){return A_(n)&&G1(n)==q8e}var Cue=Object.prototype,V8e=Cue.hasOwnProperty,G8e=Cue.propertyIsEnumerable,G4=$Q((function(){return arguments})())?$Q:function(n){return A_(n)&&V8e.call(n,"callee")&&!G8e.call(n,"callee")};function $8e(){return!1}var Mue=typeof Pg=="object"&&Pg&&!Pg.nodeType&&Pg,WQ=Mue&&typeof Ih=="object"&&Ih&&!Ih.nodeType&&Ih,W8e=WQ&&WQ.exports===Mue,YQ=W8e?Kv.Buffer:void 0,Y8e=YQ?YQ.isBuffer:void 0,ak=Y8e||$8e,X8e="[object Arguments]",K8e="[object Array]",Z8e="[object Boolean]",Q8e="[object Date]",J8e="[object Error]",eFe="[object Function]",tFe="[object Map]",nFe="[object Number]",rFe="[object Object]",iFe="[object RegExp]",sFe="[object Set]",aFe="[object String]",oFe="[object WeakMap]",lFe="[object ArrayBuffer]",cFe="[object DataView]",uFe="[object Float32Array]",fFe="[object Float64Array]",hFe="[object Int8Array]",dFe="[object Int16Array]",pFe="[object Int32Array]",mFe="[object Uint8Array]",gFe="[object Uint8ClampedArray]",_Fe="[object Uint16Array]",vFe="[object Uint32Array]",tc={};tc[uFe]=tc[fFe]=tc[hFe]=tc[dFe]=tc[pFe]=tc[mFe]=tc[gFe]=tc[_Fe]=tc[vFe]=!0;tc[X8e]=tc[K8e]=tc[lFe]=tc[Z8e]=tc[cFe]=tc[Q8e]=tc[J8e]=tc[eFe]=tc[tFe]=tc[nFe]=tc[rFe]=tc[iFe]=tc[sFe]=tc[aFe]=tc[oFe]=!1;function yFe(n){return A_(n)&&nH(n.length)&&!!tc[G1(n)]}function $4(n){return function(e){return n(e)}}var kue=typeof Pg=="object"&&Pg&&!Pg.nodeType&&Pg,S2=kue&&typeof Ih=="object"&&Ih&&!Ih.nodeType&&Ih,bFe=S2&&S2.exports===kue,vB=bFe&&Sue.process,R1=(function(){try{var n=S2&&S2.require&&S2.require("util").types;return n||vB&&vB.binding&&vB.binding("util")}catch{}})(),XQ=R1&&R1.isTypedArray,rH=XQ?$4(XQ):yFe,SFe=Object.prototype,EFe=SFe.hasOwnProperty;function Oue(n,e){var t=ka(n),r=!t&&G4(n),i=!t&&!r&&ak(n),s=!t&&!r&&!i&&rH(n),a=t||r||i||s,o=a?H8e(n.length,String):[],l=o.length;for(var c in n)(e||EFe.call(n,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||q4(c,l)))&&o.push(c);return o}function Iue(n,e){return function(t){return n(e(t))}}var xFe=Iue(Object.keys,Object),TFe=Object.prototype,wFe=TFe.hasOwnProperty;function Nue(n){if(!dO(n))return xFe(n);var e=[];for(var t in Object(n))wFe.call(n,t)&&t!="constructor"&&e.push(t);return e}function H0(n){return Zv(n)?Oue(n):Nue(n)}var RFe=Object.prototype,AFe=RFe.hasOwnProperty,Fm=z8e(function(n,e){if(dO(e)||Zv(e)){eH(e,H0(e),n);return}for(var t in e)AFe.call(e,t)&&V4(n,t,e[t])});function CFe(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var MFe=Object.prototype,kFe=MFe.hasOwnProperty;function OFe(n){if(!j0(n))return CFe(n);var e=dO(n),t=[];for(var r in n)r=="constructor"&&(e||!kFe.call(n,r))||t.push(r);return t}function Pue(n){return Zv(n)?Oue(n,!0):OFe(n)}var IFe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,NFe=/^\w*$/;function iH(n,e){if(ka(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||z4(n)?!0:NFe.test(n)||!IFe.test(n)||e!=null&&n in Object(e)}var ok=tx(Object,"create");function PFe(){this.__data__=ok?ok(null):{},this.size=0}function DFe(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var LFe="__lodash_hash_undefined__",UFe=Object.prototype,BFe=UFe.hasOwnProperty;function FFe(n){var e=this.__data__;if(ok){var t=e[n];return t===LFe?void 0:t}return BFe.call(e,n)?e[n]:void 0}var zFe=Object.prototype,jFe=zFe.hasOwnProperty;function HFe(n){var e=this.__data__;return ok?e[n]!==void 0:jFe.call(e,n)}var qFe="__lodash_hash_undefined__";function VFe(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=ok&&e===void 0?qFe:e,this}function CE(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}CE.prototype.clear=PFe;CE.prototype.delete=DFe;CE.prototype.get=FFe;CE.prototype.has=HFe;CE.prototype.set=VFe;function GFe(){this.__data__=[],this.size=0}function W4(n,e){for(var t=n.length;t--;)if(hO(n[t][0],e))return t;return-1}var $Fe=Array.prototype,WFe=$Fe.splice;function YFe(n){var e=this.__data__,t=W4(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():WFe.call(e,t,1),--this.size,!0}function XFe(n){var e=this.__data__,t=W4(e,n);return t<0?void 0:e[t][1]}function KFe(n){return W4(this.__data__,n)>-1}function ZFe(n,e){var t=this.__data__,r=W4(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function _b(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}_b.prototype.clear=GFe;_b.prototype.delete=YFe;_b.prototype.get=XFe;_b.prototype.has=KFe;_b.prototype.set=ZFe;var lk=tx(Kv,"Map");function QFe(){this.size=0,this.__data__={hash:new CE,map:new(lk||_b),string:new CE}}function JFe(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function Y4(n,e){var t=n.__data__;return JFe(e)?t[typeof e=="string"?"string":"hash"]:t.map}function e7e(n){var e=Y4(this,n).delete(n);return this.size-=e?1:0,e}function t7e(n){return Y4(this,n).get(n)}function n7e(n){return Y4(this,n).has(n)}function r7e(n,e){var t=Y4(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function vb(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}vb.prototype.clear=QFe;vb.prototype.delete=e7e;vb.prototype.get=t7e;vb.prototype.has=n7e;vb.prototype.set=r7e;var i7e="Expected a function";function sH(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(i7e);var t=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=t.cache;if(s.has(i))return s.get(i);var a=n.apply(this,r);return t.cache=s.set(i,a)||s,a};return t.cache=new(sH.Cache||vb),t}sH.Cache=vb;var s7e=500;function a7e(n){var e=sH(n,function(r){return t.size===s7e&&t.clear(),r}),t=e.cache;return e}var o7e=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l7e=/\\(\\)?/g,c7e=a7e(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(o7e,function(t,r,i,s){e.push(i?s.replace(l7e,"$1"):r||t)}),e});function Due(n){return n==null?"":xue(n)}function X4(n,e){return ka(n)?n:iH(n,e)?[n]:c7e(Due(n))}function pO(n){if(typeof n=="string"||z4(n))return n;var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}function aH(n,e){e=X4(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[pO(e[t++])];return t&&t==r?n:void 0}function u7e(n,e,t){var r=n==null?void 0:aH(n,e);return r===void 0?t:r}function oH(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}var KQ=z0?z0.isConcatSpreadable:void 0;function f7e(n){return ka(n)||G4(n)||!!(KQ&&n&&n[KQ])}function lH(n,e,t,r,i){var s=-1,a=n.length;for(t||(t=f7e),i||(i=[]);++s<a;){var o=n[s];t(o)?oH(i,o):r||(i[i.length]=o)}return i}function Nm(n){var e=n==null?0:n.length;return e?lH(n):[]}var Lue=Iue(Object.getPrototypeOf,Object);function cH(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function h7e(n,e,t){var r=n.length;return t=t===void 0?r:t,!e&&t>=r?n:cH(n,e,t)}var d7e="\\ud800-\\udfff",p7e="\\u0300-\\u036f",m7e="\\ufe20-\\ufe2f",g7e="\\u20d0-\\u20ff",_7e=p7e+m7e+g7e,v7e="\\ufe0e\\ufe0f",y7e="\\u200d",b7e=RegExp("["+y7e+d7e+_7e+v7e+"]");function Uue(n){return b7e.test(n)}function S7e(n){return n.split("")}var Bue="\\ud800-\\udfff",E7e="\\u0300-\\u036f",x7e="\\ufe20-\\ufe2f",T7e="\\u20d0-\\u20ff",w7e=E7e+x7e+T7e,R7e="\\ufe0e\\ufe0f",A7e="["+Bue+"]",H7="["+w7e+"]",q7="\\ud83c[\\udffb-\\udfff]",C7e="(?:"+H7+"|"+q7+")",Fue="[^"+Bue+"]",zue="(?:\\ud83c[\\udde6-\\uddff]){2}",jue="[\\ud800-\\udbff][\\udc00-\\udfff]",M7e="\\u200d",Hue=C7e+"?",que="["+R7e+"]?",k7e="(?:"+M7e+"(?:"+[Fue,zue,jue].join("|")+")"+que+Hue+")*",O7e=que+Hue+k7e,I7e="(?:"+[Fue+H7+"?",H7,zue,jue,A7e].join("|")+")",N7e=RegExp(q7+"(?="+q7+")|"+I7e+O7e,"g");function P7e(n){return n.match(N7e)||[]}function D7e(n){return Uue(n)?P7e(n):S7e(n)}function L7e(n){return function(e){e=Due(e);var t=Uue(e)?D7e(e):void 0,r=t?t[0]:e.charAt(0),i=t?h7e(t,1).join(""):e.slice(1);return r[n]()+i}}var Vue=L7e("toUpperCase");function U7e(n,e,t,r){var i=-1,s=n==null?0:n.length;for(r&&s&&(t=n[++i]);++i<s;)t=e(t,n[i],i,n);return t}function B7e(){this.__data__=new _b,this.size=0}function F7e(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function z7e(n){return this.__data__.get(n)}function j7e(n){return this.__data__.has(n)}var H7e=200;function q7e(n,e){var t=this.__data__;if(t instanceof _b){var r=t.__data__;if(!lk||r.length<H7e-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new vb(r)}return t.set(n,e),this.size=t.size,this}function Iv(n){var e=this.__data__=new _b(n);this.size=e.size}Iv.prototype.clear=B7e;Iv.prototype.delete=F7e;Iv.prototype.get=z7e;Iv.prototype.has=j7e;Iv.prototype.set=q7e;function V7e(n,e){return n&&eH(e,H0(e),n)}var Gue=typeof Pg=="object"&&Pg&&!Pg.nodeType&&Pg,ZQ=Gue&&typeof Ih=="object"&&Ih&&!Ih.nodeType&&Ih,G7e=ZQ&&ZQ.exports===Gue,QQ=G7e?Kv.Buffer:void 0,JQ=QQ?QQ.allocUnsafe:void 0;function $7e(n,e){var t=n.length,r=JQ?JQ(t):new n.constructor(t);return n.copy(r),r}function uH(n,e){for(var t=-1,r=n==null?0:n.length,i=0,s=[];++t<r;){var a=n[t];e(a,t,n)&&(s[i++]=a)}return s}function $ue(){return[]}var W7e=Object.prototype,Y7e=W7e.propertyIsEnumerable,eJ=Object.getOwnPropertySymbols,fH=eJ?function(n){return n==null?[]:(n=Object(n),uH(eJ(n),function(e){return Y7e.call(n,e)}))}:$ue;function X7e(n,e){return eH(n,fH(n),e)}var K7e=Object.getOwnPropertySymbols,Z7e=K7e?function(n){for(var e=[];n;)oH(e,fH(n)),n=Lue(n);return e}:$ue;function Wue(n,e,t){var r=e(n);return ka(n)?r:oH(r,t(n))}function V7(n){return Wue(n,H0,fH)}function Q7e(n){return Wue(n,Pue,Z7e)}var G7=tx(Kv,"DataView"),$7=tx(Kv,"Promise"),AT=tx(Kv,"Set"),tJ="[object Map]",J7e="[object Object]",nJ="[object Promise]",rJ="[object Set]",iJ="[object WeakMap]",sJ="[object DataView]",e9e=ex(G7),t9e=ex(lk),n9e=ex($7),r9e=ex(AT),i9e=ex(j7),S0=G1;(G7&&S0(new G7(new ArrayBuffer(1)))!=sJ||lk&&S0(new lk)!=tJ||$7&&S0($7.resolve())!=nJ||AT&&S0(new AT)!=rJ||j7&&S0(new j7)!=iJ)&&(S0=function(n){var e=G1(n),t=e==J7e?n.constructor:void 0,r=t?ex(t):"";if(r)switch(r){case e9e:return sJ;case t9e:return tJ;case n9e:return nJ;case r9e:return rJ;case i9e:return iJ}return e});var s9e=Object.prototype,a9e=s9e.hasOwnProperty;function o9e(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&a9e.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var DD=Kv.Uint8Array;function l9e(n){var e=new n.constructor(n.byteLength);return new DD(e).set(new DD(n)),e}function c9e(n,e){var t=n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var u9e=/\w*$/;function f9e(n){var e=new n.constructor(n.source,u9e.exec(n));return e.lastIndex=n.lastIndex,e}var aJ=z0?z0.prototype:void 0,oJ=aJ?aJ.valueOf:void 0;function h9e(n){return oJ?Object(oJ.call(n)):{}}function d9e(n,e){var t=n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var p9e="[object Boolean]",m9e="[object Date]",g9e="[object Map]",_9e="[object Number]",v9e="[object RegExp]",y9e="[object Set]",b9e="[object String]",S9e="[object Symbol]",E9e="[object ArrayBuffer]",x9e="[object DataView]",T9e="[object Float32Array]",w9e="[object Float64Array]",R9e="[object Int8Array]",A9e="[object Int16Array]",C9e="[object Int32Array]",M9e="[object Uint8Array]",k9e="[object Uint8ClampedArray]",O9e="[object Uint16Array]",I9e="[object Uint32Array]";function N9e(n,e,t){var r=n.constructor;switch(e){case E9e:return l9e(n);case p9e:case m9e:return new r(+n);case x9e:return c9e(n);case T9e:case w9e:case R9e:case A9e:case C9e:case M9e:case k9e:case O9e:case I9e:return d9e(n);case g9e:return new r;case _9e:case b9e:return new r(n);case v9e:return f9e(n);case y9e:return new r;case S9e:return h9e(n)}}function P9e(n){return typeof n.constructor=="function"&&!dO(n)?E8e(Lue(n)):{}}var D9e="[object Map]";function L9e(n){return A_(n)&&S0(n)==D9e}var lJ=R1&&R1.isMap,U9e=lJ?$4(lJ):L9e,B9e="[object Set]";function F9e(n){return A_(n)&&S0(n)==B9e}var cJ=R1&&R1.isSet,z9e=cJ?$4(cJ):F9e,Yue="[object Arguments]",j9e="[object Array]",H9e="[object Boolean]",q9e="[object Date]",V9e="[object Error]",Xue="[object Function]",G9e="[object GeneratorFunction]",$9e="[object Map]",W9e="[object Number]",Kue="[object Object]",Y9e="[object RegExp]",X9e="[object Set]",K9e="[object String]",Z9e="[object Symbol]",Q9e="[object WeakMap]",J9e="[object ArrayBuffer]",eze="[object DataView]",tze="[object Float32Array]",nze="[object Float64Array]",rze="[object Int8Array]",ize="[object Int16Array]",sze="[object Int32Array]",aze="[object Uint8Array]",oze="[object Uint8ClampedArray]",lze="[object Uint16Array]",cze="[object Uint32Array]",Dl={};Dl[Yue]=Dl[j9e]=Dl[J9e]=Dl[eze]=Dl[H9e]=Dl[q9e]=Dl[tze]=Dl[nze]=Dl[rze]=Dl[ize]=Dl[sze]=Dl[$9e]=Dl[W9e]=Dl[Kue]=Dl[Y9e]=Dl[X9e]=Dl[K9e]=Dl[Z9e]=Dl[aze]=Dl[oze]=Dl[lze]=Dl[cze]=!0;Dl[V9e]=Dl[Xue]=Dl[Q9e]=!1;function VN(n,e,t,r,i,s){var a;if(a!==void 0)return a;if(!j0(n))return n;var o=ka(n);if(o)return a=o9e(n),T8e(n,a);var l=S0(n),c=l==Xue||l==G9e;if(ak(n))return $7e(n);if(l==Kue||l==Yue||c&&!i)return a=c?{}:P9e(n),X7e(n,V7e(a,n));if(!Dl[l])return i?n:{};a=N9e(n,l),s||(s=new Iv);var u=s.get(n);if(u)return u;s.set(n,a),z9e(n)?n.forEach(function(g){a.add(VN(g,e,t,g,n,s))}):U9e(n)&&n.forEach(function(g,p){a.set(p,VN(g,e,t,p,n,s))});var f=V7,d=o?void 0:f(n);return Tue(d||n,function(g,p){d&&(p=g,g=n[p]),V4(a,p,VN(g,e,t,p,n,s))}),a}var uze=4;function Td(n){return VN(n,uze)}function mO(n){for(var e=-1,t=n==null?0:n.length,r=0,i=[];++e<t;){var s=n[e];s&&(i[r++]=s)}return i}var fze="__lodash_hash_undefined__";function hze(n){return this.__data__.set(n,fze),this}function dze(n){return this.__data__.has(n)}function aw(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new vb;++e<t;)this.add(n[e])}aw.prototype.add=aw.prototype.push=hze;aw.prototype.has=dze;function Zue(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function hH(n,e){return n.has(e)}var pze=1,mze=2;function Que(n,e,t,r,i,s){var a=t&pze,o=n.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(n),u=s.get(e);if(c&&u)return c==e&&u==n;var f=-1,d=!0,g=t&mze?new aw:void 0;for(s.set(n,e),s.set(e,n);++f<o;){var p=n[f],_=e[f];if(r)var y=a?r(_,p,f,e,n,s):r(p,_,f,n,e,s);if(y!==void 0){if(y)continue;d=!1;break}if(g){if(!Zue(e,function(v,x){if(!hH(g,x)&&(p===v||i(p,v,t,r,s)))return g.push(x)})){d=!1;break}}else if(!(p===_||i(p,_,t,r,s))){d=!1;break}}return s.delete(n),s.delete(e),d}function gze(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}function dH(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var _ze=1,vze=2,yze="[object Boolean]",bze="[object Date]",Sze="[object Error]",Eze="[object Map]",xze="[object Number]",Tze="[object RegExp]",wze="[object Set]",Rze="[object String]",Aze="[object Symbol]",Cze="[object ArrayBuffer]",Mze="[object DataView]",uJ=z0?z0.prototype:void 0,yB=uJ?uJ.valueOf:void 0;function kze(n,e,t,r,i,s,a){switch(t){case Mze:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case Cze:return!(n.byteLength!=e.byteLength||!s(new DD(n),new DD(e)));case yze:case bze:case xze:return hO(+n,+e);case Sze:return n.name==e.name&&n.message==e.message;case Tze:case Rze:return n==e+"";case Eze:var o=gze;case wze:var l=r&_ze;if(o||(o=dH),n.size!=e.size&&!l)return!1;var c=a.get(n);if(c)return c==e;r|=vze,a.set(n,e);var u=Que(o(n),o(e),r,i,s,a);return a.delete(n),u;case Aze:if(yB)return yB.call(n)==yB.call(e)}return!1}var Oze=1,Ize=Object.prototype,Nze=Ize.hasOwnProperty;function Pze(n,e,t,r,i,s){var a=t&Oze,o=V7(n),l=o.length,c=V7(e),u=c.length;if(l!=u&&!a)return!1;for(var f=l;f--;){var d=o[f];if(!(a?d in e:Nze.call(e,d)))return!1}var g=s.get(n),p=s.get(e);if(g&&p)return g==e&&p==n;var _=!0;s.set(n,e),s.set(e,n);for(var y=a;++f<l;){d=o[f];var v=n[d],x=e[d];if(r)var E=a?r(x,v,d,e,n,s):r(v,x,d,n,e,s);if(!(E===void 0?v===x||i(v,x,t,r,s):E)){_=!1;break}y||(y=d=="constructor")}if(_&&!y){var M=n.constructor,O=e.constructor;M!=O&&"constructor"in n&&"constructor"in e&&!(typeof M=="function"&&M instanceof M&&typeof O=="function"&&O instanceof O)&&(_=!1)}return s.delete(n),s.delete(e),_}var Dze=1,fJ="[object Arguments]",hJ="[object Array]",zI="[object Object]",Lze=Object.prototype,dJ=Lze.hasOwnProperty;function Uze(n,e,t,r,i,s){var a=ka(n),o=ka(e),l=a?hJ:S0(n),c=o?hJ:S0(e);l=l==fJ?zI:l,c=c==fJ?zI:c;var u=l==zI,f=c==zI,d=l==c;if(d&&ak(n)){if(!ak(e))return!1;a=!0,u=!1}if(d&&!u)return s||(s=new Iv),a||rH(n)?Que(n,e,t,r,i,s):kze(n,e,l,t,r,i,s);if(!(t&Dze)){var g=u&&dJ.call(n,"__wrapped__"),p=f&&dJ.call(e,"__wrapped__");if(g||p){var _=g?n.value():n,y=p?e.value():e;return s||(s=new Iv),i(_,y,t,r,s)}}return d?(s||(s=new Iv),Pze(n,e,t,r,i,s)):!1}function pH(n,e,t,r,i){return n===e?!0:n==null||e==null||!A_(n)&&!A_(e)?n!==n&&e!==e:Uze(n,e,t,r,pH,i)}var Bze=1,Fze=2;function zze(n,e,t,r){var i=t.length,s=i;if(n==null)return!s;for(n=Object(n);i--;){var a=t[i];if(a[2]?a[1]!==n[a[0]]:!(a[0]in n))return!1}for(;++i<s;){a=t[i];var o=a[0],l=n[o],c=a[1];if(a[2]){if(l===void 0&&!(o in n))return!1}else{var u=new Iv,f;if(!(f===void 0?pH(c,l,Bze|Fze,r,u):f))return!1}}return!0}function Jue(n){return n===n&&!j0(n)}function jze(n){for(var e=H0(n),t=e.length;t--;){var r=e[t],i=n[r];e[t]=[r,i,Jue(i)]}return e}function efe(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}function Hze(n){var e=jze(n);return e.length==1&&e[0][2]?efe(e[0][0],e[0][1]):function(t){return t===n||zze(t,n,e)}}function qze(n,e){return n!=null&&e in Object(n)}function tfe(n,e,t){e=X4(e,n);for(var r=-1,i=e.length,s=!1;++r<i;){var a=pO(e[r]);if(!(s=n!=null&&t(n,a)))break;n=n[a]}return s||++r!=i?s:(i=n==null?0:n.length,!!i&&nH(i)&&q4(a,i)&&(ka(n)||G4(n)))}function Vze(n,e){return n!=null&&tfe(n,e,qze)}var Gze=1,$ze=2;function Wze(n,e){return iH(n)&&Jue(e)?efe(pO(n),e):function(t){var r=u7e(t,n);return r===void 0&&r===e?Vze(t,n):pH(e,r,Gze|$ze)}}function Yze(n){return function(e){return e?.[n]}}function Xze(n){return function(e){return aH(e,n)}}function Kze(n){return iH(n)?Yze(pO(n)):Xze(n)}function Qv(n){return typeof n=="function"?n:n==null?sw:typeof n=="object"?ka(n)?Wze(n[0],n[1]):Hze(n):Kze(n)}function Zze(n,e,t,r){for(var i=-1,s=n==null?0:n.length;++i<s;){var a=n[i];e(r,a,t(a),n)}return r}function Qze(n){return function(e,t,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var l=a[++i];if(t(s[l],l,s)===!1)break}return e}}var Jze=Qze();function eje(n,e){return n&&Jze(n,e,H0)}function tje(n,e){return function(t,r){if(t==null)return t;if(!Zv(t))return n(t,r);for(var i=t.length,s=-1,a=Object(t);++s<i&&r(a[s],s,a)!==!1;);return t}}var nx=tje(eje);function nje(n,e,t,r){return nx(n,function(i,s,a){e(r,i,t(i),a)}),r}function rje(n,e){return function(t,r){var i=ka(t)?Zze:nje,s=e?e():{};return i(t,n,Qv(r),s)}}var nfe=Object.prototype,ije=nfe.hasOwnProperty,mH=tH(function(n,e){n=Object(n);var t=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&Aue(e[0],e[1],i)&&(r=1);++t<r;)for(var s=e[t],a=Pue(s),o=-1,l=a.length;++o<l;){var c=a[o],u=n[c];(u===void 0||hO(u,nfe[c])&&!ije.call(n,c))&&(n[c]=s[c])}return n});function pJ(n){return A_(n)&&Zv(n)}var sje=200;function aje(n,e,t,r){var i=-1,s=Rue,a=!0,o=n.length,l=[],c=e.length;if(!o)return l;e.length>=sje&&(s=hH,a=!1,e=new aw(e));e:for(;++i<o;){var u=n[i],f=u;if(u=u!==0?u:0,a&&f===f){for(var d=c;d--;)if(e[d]===f)continue e;l.push(u)}else s(e,f,r)||l.push(u)}return l}var K4=tH(function(n,e){return pJ(n)?aje(n,lH(e,1,pJ,!0)):[]});function ow(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}function yd(n,e,t){var r=n==null?0:n.length;return r?(e=e===void 0?1:H4(e),cH(n,e<0?0:e,r)):[]}function ck(n,e,t){var r=n==null?0:n.length;return r?(e=e===void 0?1:H4(e),e=r-e,cH(n,0,e<0?0:e)):[]}function oje(n){return typeof n=="function"?n:sw}function wi(n,e){var t=ka(n)?Tue:nx;return t(n,oje(e))}function lje(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(!e(n[t],t,n))return!1;return!0}function cje(n,e){var t=!0;return nx(n,function(r,i,s){return t=!!e(r,i,s),t}),t}function w_(n,e,t){var r=ka(n)?lje:cje;return r(n,Qv(e))}function rfe(n,e){var t=[];return nx(n,function(r,i,s){e(r,i,s)&&t.push(r)}),t}function $0(n,e){var t=ka(n)?uH:rfe;return t(n,Qv(e))}function uje(n){return function(e,t,r){var i=Object(e);if(!Zv(e)){var s=Qv(t);e=H0(e),t=function(o){return s(i[o],o,i)}}var a=n(e,t,r);return a>-1?i[s?e[a]:a]:void 0}}var fje=Math.max;function hje(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var i=t==null?0:H4(t);return i<0&&(i=fje(r+i,0)),wue(n,Qv(e),i)}var lw=uje(hje);function C_(n){return n&&n.length?n[0]:void 0}function dje(n,e){var t=-1,r=Zv(n)?Array(n.length):[];return nx(n,function(i,s,a){r[++t]=e(i,s,a)}),r}function Ar(n,e){var t=ka(n)?j4:dje;return t(n,Qv(e))}function P0(n,e){return lH(Ar(n,e))}var pje=Object.prototype,mje=pje.hasOwnProperty,ife=rje(function(n,e,t){mje.call(n,t)?n[t].push(e):Jj(n,t,[e])}),gje=Object.prototype,_je=gje.hasOwnProperty;function vje(n,e){return n!=null&&_je.call(n,e)}function hi(n,e){return n!=null&&tfe(n,e,vje)}var yje="[object String]";function zm(n){return typeof n=="string"||!ka(n)&&A_(n)&&G1(n)==yje}function bje(n,e){return j4(e,function(t){return n[t]})}function _f(n){return n==null?[]:bje(n,H0(n))}var Sje=Math.max;function Gp(n,e,t,r){n=Zv(n)?n:_f(n),t=t?H4(t):0;var i=n.length;return t<0&&(t=Sje(i+t,0)),zm(n)?t<=i&&n.indexOf(e,t)>-1:!!i&&Qj(n,e,t)>-1}function mJ(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var i=0;return Qj(n,e,i)}var Eje="[object Map]",xje="[object Set]",Tje=Object.prototype,wje=Tje.hasOwnProperty;function Fl(n){if(n==null)return!0;if(Zv(n)&&(ka(n)||typeof n=="string"||typeof n.splice=="function"||ak(n)||rH(n)||G4(n)))return!n.length;var e=S0(n);if(e==Eje||e==xje)return!n.size;if(dO(n))return!Nue(n).length;for(var t in n)if(wje.call(n,t))return!1;return!0}var Rje="[object RegExp]";function Aje(n){return A_(n)&&G1(n)==Rje}var gJ=R1&&R1.isRegExp,ob=gJ?$4(gJ):Aje;function lb(n){return n===void 0}var Cje="Expected a function";function Mje(n){if(typeof n!="function")throw new TypeError(Cje);return function(){var e=arguments;switch(e.length){case 0:return!n.call(this);case 1:return!n.call(this,e[0]);case 2:return!n.call(this,e[0],e[1]);case 3:return!n.call(this,e[0],e[1],e[2])}return!n.apply(this,e)}}function kje(n,e,t,r){if(!j0(n))return n;e=X4(e,n);for(var i=-1,s=e.length,a=s-1,o=n;o!=null&&++i<s;){var l=pO(e[i]),c=t;if(l==="__proto__"||l==="constructor"||l==="prototype")return n;if(i!=a){var u=o[l];c=void 0,c===void 0&&(c=j0(u)?u:q4(e[i+1])?[]:{})}V4(o,l,c),o=o[l]}return n}function Oje(n,e,t){for(var r=-1,i=e.length,s={};++r<i;){var a=e[r],o=aH(n,a);t(o,a)&&kje(s,X4(a,n),o)}return s}function B_(n,e){if(n==null)return{};var t=j4(Q7e(n),function(r){return[r]});return e=Qv(e),Oje(n,t,function(r,i){return e(r,i[0])})}function Ije(n,e,t,r,i){return i(n,function(s,a,o){t=r?(r=!1,s):e(t,s,a,o)}),t}function jm(n,e,t){var r=ka(n)?U7e:Ije,i=arguments.length<3;return r(n,Qv(e),t,i,nx)}function Z4(n,e){var t=ka(n)?uH:rfe;return t(n,Mje(Qv(e)))}function Nje(n,e){var t;return nx(n,function(r,i,s){return t=e(r,i,s),!t}),!!t}function gH(n,e,t){var r=ka(n)?Zue:Nje;return r(n,Qv(e))}var Pje=1/0,Dje=AT&&1/dH(new AT([,-0]))[1]==Pje?function(n){return new AT(n)}:qf,Lje=200;function Uje(n,e,t){var r=-1,i=Rue,s=n.length,a=!0,o=[],l=o;if(s>=Lje){var c=Dje(n);if(c)return dH(c);a=!1,i=hH,l=new aw}else l=o;e:for(;++r<s;){var u=n[r],f=u;if(u=u!==0?u:0,a&&f===f){for(var d=l.length;d--;)if(l[d]===f)continue e;o.push(u)}else i(l,f,t)||(l!==o&&l.push(f),o.push(u))}return o}function Q4(n){return n&&n.length?Uje(n):[]}function W7(n){console&&console.error&&console.error(`Error: ${n}`)}function sfe(n){console&&console.warn&&console.warn(`Warning: ${n}`)}function afe(n){const e=new Date().getTime(),t=n();return{time:new Date().getTime()-e,value:t}}function ofe(n){function e(){}e.prototype=n;const t=new e;function r(){return typeof t.bar}return r(),r(),n}function Bje(n){return Fje(n)?n.LABEL:n.name}function Fje(n){return zm(n.LABEL)&&n.LABEL!==""}class Jv{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this),wi(this.definition,t=>{t.accept(e)})}}class Hm extends Jv{constructor(e){super([]),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}set definition(e){}get definition(){return this.referencedRule!==void 0?this.referencedRule.definition:[]}accept(e){e.visit(this)}}class Vw extends Jv{constructor(e){super(e.definition),this.orgText="",Fm(this,B_(e,t=>t!==void 0))}}class qm extends Jv{constructor(e){super(e.definition),this.ignoreAmbiguities=!1,Fm(this,B_(e,t=>t!==void 0))}}class Pm extends Jv{constructor(e){super(e.definition),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}}class ey extends Jv{constructor(e){super(e.definition),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}}class ty extends Jv{constructor(e){super(e.definition),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}}class Wf extends Jv{constructor(e){super(e.definition),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}}class F_ extends Jv{constructor(e){super(e.definition),this.idx=1,Fm(this,B_(e,t=>t!==void 0))}}class z_ extends Jv{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition),this.idx=1,this.ignoreAmbiguities=!1,this.hasPredicates=!1,Fm(this,B_(e,t=>t!==void 0))}}class Hc{constructor(e){this.idx=1,Fm(this,B_(e,t=>t!==void 0))}accept(e){e.visit(this)}}function zje(n){return Ar(n,GN)}function GN(n){function e(t){return Ar(t,GN)}if(n instanceof Hm){const t={type:"NonTerminal",name:n.nonTerminalName,idx:n.idx};return zm(n.label)&&(t.label=n.label),t}else{if(n instanceof qm)return{type:"Alternative",definition:e(n.definition)};if(n instanceof Pm)return{type:"Option",idx:n.idx,definition:e(n.definition)};if(n instanceof ey)return{type:"RepetitionMandatory",idx:n.idx,definition:e(n.definition)};if(n instanceof ty)return{type:"RepetitionMandatoryWithSeparator",idx:n.idx,separator:GN(new Hc({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof F_)return{type:"RepetitionWithSeparator",idx:n.idx,separator:GN(new Hc({terminalType:n.separator})),definition:e(n.definition)};if(n instanceof Wf)return{type:"Repetition",idx:n.idx,definition:e(n.definition)};if(n instanceof z_)return{type:"Alternation",idx:n.idx,definition:e(n.definition)};if(n instanceof Hc){const t={type:"Terminal",name:n.terminalType.name,label:Bje(n.terminalType),idx:n.idx};zm(n.label)&&(t.terminalLabel=n.label);const r=n.terminalType.PATTERN;return n.terminalType.PATTERN&&(t.pattern=ob(r)?r.source:r),t}else{if(n instanceof Vw)return{type:"Rule",name:n.name,orgText:n.orgText,definition:e(n.definition)};throw Error("non exhaustive match")}}}class rx{visit(e){const t=e;switch(t.constructor){case Hm:return this.visitNonTerminal(t);case qm:return this.visitAlternative(t);case Pm:return this.visitOption(t);case ey:return this.visitRepetitionMandatory(t);case ty:return this.visitRepetitionMandatoryWithSeparator(t);case F_:return this.visitRepetitionWithSeparator(t);case Wf:return this.visitRepetition(t);case z_:return this.visitAlternation(t);case Hc:return this.visitTerminal(t);case Vw:return this.visitRule(t);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function jje(n){return n instanceof qm||n instanceof Pm||n instanceof Wf||n instanceof ey||n instanceof ty||n instanceof F_||n instanceof Hc||n instanceof Vw}function LD(n,e=[]){return n instanceof Pm||n instanceof Wf||n instanceof F_?!0:n instanceof z_?gH(n.definition,r=>LD(r,e)):n instanceof Hm&&Gp(e,n)?!1:n instanceof Jv?(n instanceof Hm&&e.push(n),w_(n.definition,r=>LD(r,e))):!1}function Hje(n){return n instanceof z_}function pv(n){if(n instanceof Hm)return"SUBRULE";if(n instanceof Pm)return"OPTION";if(n instanceof z_)return"OR";if(n instanceof ey)return"AT_LEAST_ONE";if(n instanceof ty)return"AT_LEAST_ONE_SEP";if(n instanceof F_)return"MANY_SEP";if(n instanceof Wf)return"MANY";if(n instanceof Hc)return"CONSUME";throw Error("non exhaustive match")}class J4{walk(e,t=[]){wi(e.definition,(r,i)=>{const s=yd(e.definition,i+1);if(r instanceof Hm)this.walkProdRef(r,s,t);else if(r instanceof Hc)this.walkTerminal(r,s,t);else if(r instanceof qm)this.walkFlat(r,s,t);else if(r instanceof Pm)this.walkOption(r,s,t);else if(r instanceof ey)this.walkAtLeastOne(r,s,t);else if(r instanceof ty)this.walkAtLeastOneSep(r,s,t);else if(r instanceof F_)this.walkManySep(r,s,t);else if(r instanceof Wf)this.walkMany(r,s,t);else if(r instanceof z_)this.walkOr(r,s,t);else throw Error("non exhaustive match")})}walkTerminal(e,t,r){}walkProdRef(e,t,r){}walkFlat(e,t,r){const i=t.concat(r);this.walk(e,i)}walkOption(e,t,r){const i=t.concat(r);this.walk(e,i)}walkAtLeastOne(e,t,r){const i=[new Pm({definition:e.definition})].concat(t,r);this.walk(e,i)}walkAtLeastOneSep(e,t,r){const i=_J(e,t,r);this.walk(e,i)}walkMany(e,t,r){const i=[new Pm({definition:e.definition})].concat(t,r);this.walk(e,i)}walkManySep(e,t,r){const i=_J(e,t,r);this.walk(e,i)}walkOr(e,t,r){const i=t.concat(r);wi(e.definition,s=>{const a=new qm({definition:[s]});this.walk(a,i)})}}function _J(n,e,t){return[new Pm({definition:[new Hc({terminalType:n.separator})].concat(n.definition)})].concat(e,t)}function gO(n){if(n instanceof Hm)return gO(n.referencedRule);if(n instanceof Hc)return Gje(n);if(jje(n))return qje(n);if(Hje(n))return Vje(n);throw Error("non exhaustive match")}function qje(n){let e=[];const t=n.definition;let r=0,i=t.length>r,s,a=!0;for(;i&&a;)s=t[r],a=LD(s),e=e.concat(gO(s)),r=r+1,i=t.length>r;return Q4(e)}function Vje(n){const e=Ar(n.definition,t=>gO(t));return Q4(Nm(e))}function Gje(n){return[n.terminalType]}const lfe="_~IN~_";class $je extends J4{constructor(e){super(),this.topProd=e,this.follows={}}startWalking(){return this.walk(this.topProd),this.follows}walkTerminal(e,t,r){}walkProdRef(e,t,r){const i=Yje(e.referencedRule,e.idx)+this.topProd.name,s=t.concat(r),a=new qm({definition:s}),o=gO(a);this.follows[i]=o}}function Wje(n){const e={};return wi(n,t=>{const r=new $je(t).startWalking();Fm(e,r)}),e}function Yje(n,e){return n.name+e+lfe}function ki(n){return n.charCodeAt(0)}function bB(n,e){Array.isArray(n)?n.forEach(function(t){e.push(t)}):e.push(n)}function MM(n,e){if(n[e]===!0)throw"duplicate flag "+e;n[e],n[e]=!0}function qx(n){if(n===void 0)throw Error("Internal Error - Should never get here!");return!0}function Xje(){throw Error("Internal Error - Should never get here!")}function vJ(n){return n.type==="Character"}const UD=[];for(let n=ki("0");n<=ki("9");n++)UD.push(n);const BD=[ki("_")].concat(UD);for(let n=ki("a");n<=ki("z");n++)BD.push(n);for(let n=ki("A");n<=ki("Z");n++)BD.push(n);const yJ=[ki(" "),ki("\f"),ki(`
`),ki("\r"),ki("	"),ki("\v"),ki("	"),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki(""),ki("\u2028"),ki("\u2029"),ki(""),ki(""),ki(""),ki("\uFEFF")],Kje=/[0-9a-fA-F]/,jI=/[0-9]/,Zje=/[1-9]/;class Qje{constructor(){this.idx=0,this.input="",this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx}pattern(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");const t=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};for(;this.isRegExpFlag();)switch(this.popChar()){case"g":MM(r,"global");break;case"i":MM(r,"ignoreCase");break;case"m":MM(r,"multiLine");break;case"u":MM(r,"unicode");break;case"y":MM(r,"sticky");break}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t,loc:this.loc(0)}}disjunction(){const e=[],t=this.idx;for(e.push(this.alternative());this.peekChar()==="|";)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){const e=[],t=this.idx;for(;this.isTerm();)e.push(this.term());return{type:"Alternative",value:e,loc:this.loc(t)}}term(){return this.isAssertion()?this.assertion():this.atom()}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let t;switch(this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead";break}qx(t);const r=this.disjunction();return this.consumeChar(")"),{type:t,value:r,loc:this.loc(e)}}return Xje()}quantifier(e=!1){let t;const r=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":const i=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:i,atMost:i};break;case",":let s;this.isDigit()?(s=this.integerIncludingZero(),t={atLeast:i,atMost:s}):t={atLeast:i,atMost:1/0},this.consumeChar("}");break}if(e===!0&&t===void 0)return;qx(t);break}if(!(e===!0&&t===void 0)&&qx(t))return this.peekChar(0)==="?"?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t.loc=this.loc(r),t}atom(){let e;const t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===void 0&&this.isPatternCharacter()&&(e=this.patternCharacter()),qx(e))return e.loc=this.loc(t),this.isQuantifier()&&(e.quantifier=this.quantifier()),e}dotAll(){return this.consumeChar("."),{type:"Set",complement:!0,value:[ki(`
`),ki("\r"),ki("\u2028"),ki("\u2029")]}}atomEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){return{type:"GroupBackReference",value:this.positiveInteger()}}characterClassEscape(){let e,t=!1;switch(this.popChar()){case"d":e=UD;break;case"D":e=UD,t=!0;break;case"s":e=yJ;break;case"S":e=yJ,t=!0;break;case"w":e=BD;break;case"W":e=BD,t=!0;break}if(qx(e))return{type:"Set",value:e,complement:t}}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=ki("\f");break;case"n":e=ki(`
`);break;case"r":e=ki("\r");break;case"t":e=ki("	");break;case"v":e=ki("\v");break}if(qx(e))return{type:"Character",value:e}}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===!1)throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}}nulCharacterAtom(){return this.consumeChar("0"),{type:"Character",value:ki("\0")}}hexEscapeSequenceAtom(){return this.consumeChar("x"),this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){return this.consumeChar("u"),this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:ki(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case`
`:case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:ki(e)}}}characterClass(){const e=[];let t=!1;for(this.consumeChar("["),this.peekChar(0)==="^"&&(this.consumeChar("^"),t=!0);this.isClassAtom();){const r=this.classAtom();if(r.type,vJ(r)&&this.isRangeDash()){this.consumeChar("-");const i=this.classAtom();if(i.type,vJ(i)){if(i.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:i.value})}else bB(r.value,e),e.push(ki("-")),bB(i.value,e)}else bB(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case`
`:case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:ki("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++;break}const t=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r}positiveInteger(){let e=this.popChar();if(Zje.test(e)===!1)throw Error("Expecting a positive integer");for(;jI.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(jI.test(e)===!1)throw Error("Expecting an integer");for(;jI.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case`
`:case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:ki(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return jI.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!");default:return!1}}isQuantifier(){const e=this.saveState();try{return this.quantifier(!0)!==void 0}catch{return!1}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case`
`:case"\r":case"\u2028":case"\u2029":return!1;default:return!0}}parseHexDigits(e){let t="";for(let i=0;i<e;i++){const s=this.popChar();if(Kje.test(s)===!1)throw Error("Expecting a HexDecimal digits");t+=s}return{type:"Character",value:parseInt(t,16)}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);return this.consumeChar(void 0),e}consumeChar(e){if(e!==void 0&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++}loc(e){return{begin:e,end:this.idx}}}class _H{visitChildren(e){for(const t in e){const r=e[t];e.hasOwnProperty(t)&&(r.type!==void 0?this.visit(r):Array.isArray(r)&&r.forEach(i=>{this.visit(i)},this))}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}let $N={};const Jje=new Qje;function eU(n){const e=n.toString();if($N.hasOwnProperty(e))return $N[e];{const t=Jje.pattern(e);return $N[e]=t,t}}function eHe(){$N={}}const cfe="Complement Sets are not supported for first char optimization",FD=`Unable to use "first char" lexer optimizations:
`;function tHe(n,e=!1){try{const t=eU(n);return Y7(t.value,{},t.flags.ignoreCase)}catch(t){if(t.message===cfe)e&&sfe(`${FD}	Unable to optimize: < ${n.toString()} >
	Complement Sets cannot be automatically optimized.
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.`);else{let r="";e&&(r=`
	This will disable the lexer's first char optimizations.
	See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details.`),W7(`${FD}
	Failed parsing: < ${n.toString()} >
	Using the @chevrotain/regexp-to-ast library
	Please open an issue at: https://github.com/chevrotain/chevrotain/issues`+r)}}return[]}function Y7(n,e,t){switch(n.type){case"Disjunction":for(let i=0;i<n.value.length;i++)Y7(n.value[i],e,t);break;case"Alternative":const r=n.value;for(let i=0;i<r.length;i++){const s=r[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const a=s;switch(a.type){case"Character":HI(a.value,e,t);break;case"Set":if(a.complement===!0)throw Error(cfe);wi(a.value,l=>{if(typeof l=="number")HI(l,e,t);else{const c=l;if(t===!0)for(let u=c.from;u<=c.to;u++)HI(u,e,t);else{for(let u=c.from;u<=c.to&&u<e2;u++)HI(u,e,t);if(c.to>=e2){const u=c.from>=e2?c.from:e2,f=c.to,d=A1(u),g=A1(f);for(let p=d;p<=g;p++)e[p]=p}}}});break;case"Group":Y7(a.value,e,t);break;default:throw Error("Non Exhaustive Match")}const o=a.quantifier!==void 0&&a.quantifier.atLeast===0;if(a.type==="Group"&&X7(a)===!1||a.type!=="Group"&&o===!1)break}break;default:throw Error("non exhaustive match!")}return _f(e)}function HI(n,e,t){const r=A1(n);e[r]=r,t===!0&&nHe(n,e)}function nHe(n,e){const t=String.fromCharCode(n),r=t.toUpperCase();if(r!==t){const i=A1(r.charCodeAt(0));e[i]=i}else{const i=t.toLowerCase();if(i!==t){const s=A1(i.charCodeAt(0));e[s]=s}}}function bJ(n,e){return lw(n.value,t=>{if(typeof t=="number")return Gp(e,t);{const r=t;return lw(e,i=>r.from<=i&&i<=r.to)!==void 0}})}function X7(n){const e=n.quantifier;return e&&e.atLeast===0?!0:n.value?ka(n.value)?w_(n.value,X7):X7(n.value):!1}class rHe extends _H{constructor(e){super(),this.targetCharCodes=e,this.found=!1}visitChildren(e){if(this.found!==!0){switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return}super.visitChildren(e)}}visitCharacter(e){Gp(this.targetCharCodes,e.value)&&(this.found=!0)}visitSet(e){e.complement?bJ(e,this.targetCharCodes)===void 0&&(this.found=!0):bJ(e,this.targetCharCodes)!==void 0&&(this.found=!0)}}function vH(n,e){if(e instanceof RegExp){const t=eU(e),r=new rHe(n);return r.visit(t),r.found}else return lw(e,t=>Gp(n,t.charCodeAt(0)))!==void 0}const ME="PATTERN",JM="defaultMode",qI="modes";let ufe=typeof new RegExp("(?:)").sticky=="boolean";function iHe(n,e){e=mH(e,{useSticky:ufe,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r",`
`],tracer:(x,E)=>E()});const t=e.tracer;t("initCharCodeToOptimizedIndexMap",()=>{AHe()});let r;t("Reject Lexer.NA",()=>{r=Z4(n,x=>x[ME]===Ph.NA)});let i=!1,s;t("Transform Patterns",()=>{i=!1,s=Ar(r,x=>{const E=x[ME];if(ob(E)){const M=E.source;return M.length===1&&M!=="^"&&M!=="$"&&M!=="."&&!E.ignoreCase?M:M.length===2&&M[0]==="\\"&&!Gp(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],M[1])?M[1]:e.useSticky?EJ(E):SJ(E)}else{if(gb(E))return i=!0,{exec:E};if(typeof E=="object")return i=!0,E;if(typeof E=="string"){if(E.length===1)return E;{const M=E.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),O=new RegExp(M);return e.useSticky?EJ(O):SJ(O)}}else throw Error("non exhaustive match")}})});let a,o,l,c,u;t("misc mapping",()=>{a=Ar(r,x=>x.tokenTypeIdx),o=Ar(r,x=>{const E=x.GROUP;if(E!==Ph.SKIPPED){if(zm(E))return E;if(lb(E))return!1;throw Error("non exhaustive match")}}),l=Ar(r,x=>{const E=x.LONGER_ALT;if(E)return ka(E)?Ar(E,O=>mJ(r,O)):[mJ(r,E)]}),c=Ar(r,x=>x.PUSH_MODE),u=Ar(r,x=>hi(x,"POP_MODE"))});let f;t("Line Terminator Handling",()=>{const x=dfe(e.lineTerminatorCharacters);f=Ar(r,E=>!1),e.positionTracking!=="onlyOffset"&&(f=Ar(r,E=>hi(E,"LINE_BREAKS")?!!E.LINE_BREAKS:hfe(E,x)===!1&&vH(x,E.PATTERN)))});let d,g,p,_;t("Misc Mapping #2",()=>{d=Ar(r,ffe),g=Ar(s,THe),p=jm(r,(x,E)=>{const M=E.GROUP;return zm(M)&&M!==Ph.SKIPPED&&(x[M]=[]),x},{}),_=Ar(s,(x,E)=>({pattern:s[E],longerAlt:l[E],canLineTerminator:f[E],isCustom:d[E],short:g[E],group:o[E],push:c[E],pop:u[E],tokenTypeIdx:a[E],tokenType:r[E]}))});let y=!0,v=[];return e.safeMode||t("First Char Optimization",()=>{v=jm(r,(x,E,M)=>{if(typeof E.PATTERN=="string"){const O=E.PATTERN.charCodeAt(0),N=A1(O);SB(x,N,_[M])}else if(ka(E.START_CHARS_HINT)){let O;wi(E.START_CHARS_HINT,N=>{const I=typeof N=="string"?N.charCodeAt(0):N,D=A1(I);O!==D&&(O=D,SB(x,D,_[M]))})}else if(ob(E.PATTERN))if(E.PATTERN.unicode)y=!1,e.ensureOptimizations&&W7(`${FD}	Unable to analyze < ${E.PATTERN.toString()} > pattern.
	The regexp unicode flag is not currently supported by the regexp-to-ast library.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE`);else{const O=tHe(E.PATTERN,e.ensureOptimizations);Fl(O)&&(y=!1),wi(O,N=>{SB(x,N,_[M])})}else e.ensureOptimizations&&W7(`${FD}	TokenType: <${E.name}> is using a custom token pattern without providing <start_chars_hint> parameter.
	This will disable the lexer's first char optimizations.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE`),y=!1;return x},[])}),{emptyGroups:p,patternIdxToConfig:_,charCodeToPatternIdxToConfig:v,hasCustom:i,canBeOptimized:y}}function sHe(n,e){let t=[];const r=oHe(n);t=t.concat(r.errors);const i=lHe(r.valid),s=i.valid;return t=t.concat(i.errors),t=t.concat(aHe(s)),t=t.concat(gHe(s)),t=t.concat(_He(s,e)),t=t.concat(vHe(s)),t}function aHe(n){let e=[];const t=$0(n,r=>ob(r[ME]));return e=e.concat(uHe(t)),e=e.concat(dHe(t)),e=e.concat(pHe(t)),e=e.concat(mHe(t)),e=e.concat(fHe(t)),e}function oHe(n){const e=$0(n,i=>!hi(i,ME)),t=Ar(e,i=>({message:"Token Type: ->"+i.name+"<- missing static 'PATTERN' property",type:_u.MISSING_PATTERN,tokenTypes:[i]})),r=K4(n,e);return{errors:t,valid:r}}function lHe(n){const e=$0(n,i=>{const s=i[ME];return!ob(s)&&!gb(s)&&!hi(s,"exec")&&!zm(s)}),t=Ar(e,i=>({message:"Token Type: ->"+i.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:_u.INVALID_PATTERN,tokenTypes:[i]})),r=K4(n,e);return{errors:t,valid:r}}const cHe=/[^\\][$]/;function uHe(n){class e extends _H{constructor(){super(...arguments),this.found=!1}visitEndAnchor(s){this.found=!0}}const t=$0(n,i=>{const s=i.PATTERN;try{const a=eU(s),o=new e;return o.visit(a),o.found}catch{return cHe.test(s.source)}});return Ar(t,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain end of input anchor '$'
	See chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:_u.EOI_ANCHOR_FOUND,tokenTypes:[i]}))}function fHe(n){const e=$0(n,r=>r.PATTERN.test(""));return Ar(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' must not match an empty string",type:_u.EMPTY_MATCH_PATTERN,tokenTypes:[r]}))}const hHe=/[^\\[][\^]|^\^/;function dHe(n){class e extends _H{constructor(){super(...arguments),this.found=!1}visitStartAnchor(s){this.found=!0}}const t=$0(n,i=>{const s=i.PATTERN;try{const a=eU(s),o=new e;return o.visit(a),o.found}catch{return hHe.test(s.source)}});return Ar(t,i=>({message:`Unexpected RegExp Anchor Error:
	Token Type: ->`+i.name+`<- static 'PATTERN' cannot contain start of input anchor '^'
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.`,type:_u.SOI_ANCHOR_FOUND,tokenTypes:[i]}))}function pHe(n){const e=$0(n,r=>{const i=r[ME];return i instanceof RegExp&&(i.multiline||i.global)});return Ar(e,r=>({message:"Token Type: ->"+r.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:_u.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[r]}))}function mHe(n){const e=[];let t=Ar(n,s=>jm(n,(a,o)=>(s.PATTERN.source===o.PATTERN.source&&!Gp(e,o)&&o.PATTERN!==Ph.NA&&(e.push(o),a.push(o)),a),[]));t=mO(t);const r=$0(t,s=>s.length>1);return Ar(r,s=>{const a=Ar(s,l=>l.name);return{message:`The same RegExp pattern ->${C_(s).PATTERN}<-has been used in all of the following Token Types: ${a.join(", ")} <-`,type:_u.DUPLICATE_PATTERNS_FOUND,tokenTypes:s}})}function gHe(n){const e=$0(n,r=>{if(!hi(r,"GROUP"))return!1;const i=r.GROUP;return i!==Ph.SKIPPED&&i!==Ph.NA&&!zm(i)});return Ar(e,r=>({message:"Token Type: ->"+r.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:_u.INVALID_GROUP_TYPE_FOUND,tokenTypes:[r]}))}function _He(n,e){const t=$0(n,i=>i.PUSH_MODE!==void 0&&!Gp(e,i.PUSH_MODE));return Ar(t,i=>({message:`Token Type: ->${i.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${i.PUSH_MODE}<-which does not exist`,type:_u.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[i]}))}function vHe(n){const e=[],t=jm(n,(r,i,s)=>{const a=i.PATTERN;return a===Ph.NA||(zm(a)?r.push({str:a,idx:s,tokenType:i}):ob(a)&&bHe(a)&&r.push({str:a.source,idx:s,tokenType:i})),r},[]);return wi(n,(r,i)=>{wi(t,({str:s,idx:a,tokenType:o})=>{if(i<a&&yHe(s,r.PATTERN)){const l=`Token: ->${o.name}<- can never be matched.
Because it appears AFTER the Token Type ->${r.name}<-in the lexer's definition.
See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;e.push({message:l,type:_u.UNREACHABLE_PATTERN,tokenTypes:[r,o]})}})}),e}function yHe(n,e){if(ob(e)){const t=e.exec(n);return t!==null&&t.index===0}else{if(gb(e))return e(n,0,[],{});if(hi(e,"exec"))return e.exec(n,0,[],{});if(typeof e=="string")return e===n;throw Error("non exhaustive match")}}function bHe(n){return lw([".","\\","[","]","|","^","$","(",")","?","*","+","{"],t=>n.source.indexOf(t)!==-1)===void 0}function SJ(n){const e=n.ignoreCase?"i":"";return new RegExp(`^(?:${n.source})`,e)}function EJ(n){const e=n.ignoreCase?"iy":"y";return new RegExp(`${n.source}`,e)}function SHe(n,e,t){const r=[];return hi(n,JM)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+JM+`> property in its definition
`,type:_u.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),hi(n,qI)||r.push({message:"A MultiMode Lexer cannot be initialized without a <"+qI+`> property in its definition
`,type:_u.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),hi(n,qI)&&hi(n,JM)&&!hi(n.modes,n.defaultMode)&&r.push({message:`A MultiMode Lexer cannot be initialized with a ${JM}: <${n.defaultMode}>which does not exist
`,type:_u.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),hi(n,qI)&&wi(n.modes,(i,s)=>{wi(i,(a,o)=>{if(lb(a))r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:<${s}> at index: <${o}>
`,type:_u.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED});else if(hi(a,"LONGER_ALT")){const l=ka(a.LONGER_ALT)?a.LONGER_ALT:[a.LONGER_ALT];wi(l,c=>{!lb(c)&&!Gp(i,c)&&r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${c.name}> on token <${a.name}> outside of mode <${s}>
`,type:_u.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})})}})}),r}function EHe(n,e,t){const r=[];let i=!1;const s=mO(Nm(_f(n.modes))),a=Z4(s,l=>l[ME]===Ph.NA),o=dfe(t);return e&&wi(a,l=>{const c=hfe(l,o);if(c!==!1){const f={message:RHe(l,c),type:c.issue,tokenType:l};r.push(f)}else hi(l,"LINE_BREAKS")?l.LINE_BREAKS===!0&&(i=!0):vH(o,l.PATTERN)&&(i=!0)}),e&&!i&&r.push({message:`Warning: No LINE_BREAKS Found.
	This Lexer has been defined to track line and column information,
	But none of the Token Types can be identified as matching a line terminator.
	See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS 
	for details.`,type:_u.NO_LINE_BREAKS_FLAGS}),r}function xHe(n){const e={},t=H0(n);return wi(t,r=>{const i=n[r];if(ka(i))e[r]=[];else throw Error("non exhaustive match")}),e}function ffe(n){const e=n.PATTERN;if(ob(e))return!1;if(gb(e))return!0;if(hi(e,"exec"))return!0;if(zm(e))return!1;throw Error("non exhaustive match")}function THe(n){return zm(n)&&n.length===1?n.charCodeAt(0):!1}const wHe={test:function(n){const e=n.length;for(let t=this.lastIndex;t<e;t++){const r=n.charCodeAt(t);if(r===10)return this.lastIndex=t+1,!0;if(r===13)return n.charCodeAt(t+1)===10?this.lastIndex=t+2:this.lastIndex=t+1,!0}return!1},lastIndex:0};function hfe(n,e){if(hi(n,"LINE_BREAKS"))return!1;if(ob(n.PATTERN)){try{vH(e,n.PATTERN)}catch(t){return{issue:_u.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}else{if(zm(n.PATTERN))return!1;if(ffe(n))return{issue:_u.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}}function RHe(n,e){if(e.issue===_u.IDENTIFY_TERMINATOR)return`Warning: unable to identify line terminator usage in pattern.
	The problem is in the <${n.name}> Token Type
	 Root cause: ${e.errMsg}.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR`;if(e.issue===_u.CUSTOM_LINE_BREAK)return`Warning: A Custom Token Pattern should specify the <line_breaks> option.
	The problem is in the <${n.name}> Token Type
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK`;throw Error("non exhaustive match")}function dfe(n){return Ar(n,t=>zm(t)?t.charCodeAt(0):t)}function SB(n,e,t){n[e]===void 0?n[e]=[t]:n[e].push(t)}const e2=256;let WN=[];function A1(n){return n<e2?n:WN[n]}function AHe(){if(Fl(WN)){WN=new Array(65536);for(let n=0;n<65536;n++)WN[n]=n>255?255+~~(n/255):n}}function _O(n,e){const t=n.tokenTypeIdx;return t===e.tokenTypeIdx?!0:e.isParent===!0&&e.categoryMatchesMap[t]===!0}function zD(n,e){return n.tokenTypeIdx===e.tokenTypeIdx}let xJ=1;const pfe={};function vO(n){const e=CHe(n);MHe(e),OHe(e),kHe(e),wi(e,t=>{t.isParent=t.categoryMatches.length>0})}function CHe(n){let e=Td(n),t=n,r=!0;for(;r;){t=mO(Nm(Ar(t,s=>s.CATEGORIES)));const i=K4(t,e);e=e.concat(i),Fl(i)?r=!1:t=i}return e}function MHe(n){wi(n,e=>{gfe(e)||(pfe[xJ]=e,e.tokenTypeIdx=xJ++),TJ(e)&&!ka(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),TJ(e)||(e.CATEGORIES=[]),IHe(e)||(e.categoryMatches=[]),NHe(e)||(e.categoryMatchesMap={})})}function kHe(n){wi(n,e=>{e.categoryMatches=[],wi(e.categoryMatchesMap,(t,r)=>{e.categoryMatches.push(pfe[r].tokenTypeIdx)})})}function OHe(n){wi(n,e=>{mfe([],e)})}function mfe(n,e){wi(n,t=>{e.categoryMatchesMap[t.tokenTypeIdx]=!0}),wi(e.CATEGORIES,t=>{const r=n.concat(e);Gp(r,t)||mfe(r,t)})}function gfe(n){return hi(n,"tokenTypeIdx")}function TJ(n){return hi(n,"CATEGORIES")}function IHe(n){return hi(n,"categoryMatches")}function NHe(n){return hi(n,"categoryMatchesMap")}function PHe(n){return hi(n,"tokenTypeIdx")}const DHe={buildUnableToPopLexerModeMessage(n){return`Unable to pop Lexer Mode after encountering Token ->${n.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(n,e,t,r,i){return`unexpected character: ->${n.charAt(e)}<- at offset: ${e}, skipped ${t} characters.`}};var _u;(function(n){n[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK",n[n.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(_u||(_u={}));const t2={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:[`
`,"\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:DHe,traceInitPerf:!1,skipValidations:!1,recoveryEnabled:!0};Object.freeze(t2);let Ph=class{constructor(e,t=t2){if(this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},this.TRACE_INIT=(i,s)=>{if(this.traceInitPerf===!0){this.traceInitIndent++;const a=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${a}--> <${i}>`);const{time:o,value:l}=afe(s),c=o>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(`${a}<-- <${i}> time: ${o}ms`),this.traceInitIndent--,l}else return s()},typeof t=="boolean")throw Error(`The second argument to the Lexer constructor is now an ILexerConfig Object.
a boolean 2nd argument is no longer supported`);this.config=Fm({},t2,t);const r=this.config.traceInitPerf;r===!0?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):typeof r=="number"&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",()=>{let i,s=!0;this.TRACE_INIT("Lexer Config handling",()=>{if(this.config.lineTerminatorsPattern===t2.lineTerminatorsPattern)this.config.lineTerminatorsPattern=wHe;else if(this.config.lineTerminatorCharacters===t2.lineTerminatorCharacters)throw Error(`Error: Missing <lineTerminatorCharacters> property on the Lexer config.
	For details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS`);if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking),this.trackEndLines=/full/i.test(this.config.positionTracking),ka(e)?i={modes:{defaultMode:Td(e)},defaultMode:JM}:(s=!1,i=Td(e))}),this.config.skipValidations===!1&&(this.TRACE_INIT("performRuntimeChecks",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(SHe(i,this.trackStartLines,this.config.lineTerminatorCharacters))}),this.TRACE_INIT("performWarningRuntimeChecks",()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(EHe(i,this.trackStartLines,this.config.lineTerminatorCharacters))})),i.modes=i.modes?i.modes:{},wi(i.modes,(o,l)=>{i.modes[l]=Z4(o,c=>lb(c))});const a=H0(i.modes);if(wi(i.modes,(o,l)=>{this.TRACE_INIT(`Mode: <${l}> processing`,()=>{if(this.modes.push(l),this.config.skipValidations===!1&&this.TRACE_INIT("validatePatterns",()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(sHe(o,a))}),Fl(this.lexerDefinitionErrors)){vO(o);let c;this.TRACE_INIT("analyzeTokenTypes",()=>{c=iHe(o,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})}),this.patternIdxToConfig[l]=c.patternIdxToConfig,this.charCodeToPatternIdxToConfig[l]=c.charCodeToPatternIdxToConfig,this.emptyGroups=Fm({},this.emptyGroups,c.emptyGroups),this.hasCustom=c.hasCustom||this.hasCustom,this.canModeBeOptimized[l]=c.canBeOptimized}})}),this.defaultMode=i.defaultMode,!Fl(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const l=Ar(this.lexerDefinitionErrors,c=>c.message).join(`-----------------------
`);throw new Error(`Errors detected in definition of Lexer:
`+l)}wi(this.lexerDefinitionWarning,o=>{sfe(o.message)}),this.TRACE_INIT("Choosing sub-methods implementations",()=>{if(ufe?(this.chopInput=sw,this.match=this.matchWithTest):(this.updateLastIndex=qf,this.match=this.matchWithExec),s&&(this.handleModes=qf),this.trackStartLines===!1&&(this.computeNewColumn=sw),this.trackEndLines===!1&&(this.updateTokenEndLineColumnLocation=qf),/full/i.test(this.config.positionTracking))this.createTokenInstance=this.createFullToken;else if(/onlyStart/i.test(this.config.positionTracking))this.createTokenInstance=this.createStartOnlyToken;else if(/onlyOffset/i.test(this.config.positionTracking))this.createTokenInstance=this.createOffsetOnlyToken;else throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`);this.hasCustom?(this.addToken=this.addTokenUsingPush,this.handlePayload=this.handlePayloadWithCustom):(this.addToken=this.addTokenUsingMemberAccess,this.handlePayload=this.handlePayloadNoCustom)}),this.TRACE_INIT("Failed Optimization Warnings",()=>{const o=jm(this.canModeBeOptimized,(l,c,u)=>(c===!1&&l.push(u),l),[]);if(t.ensureOptimizations&&!Fl(o))throw Error(`Lexer Modes: < ${o.join(", ")} > cannot be optimized.
	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.
	 Or inspect the console log for details on how to resolve these issues.`)}),this.TRACE_INIT("clearRegExpParserCache",()=>{eHe()}),this.TRACE_INIT("toFastProperties",()=>{ofe(this)})})}tokenize(e,t=this.defaultMode){if(!Fl(this.lexerDefinitionErrors)){const i=Ar(this.lexerDefinitionErrors,s=>s.message).join(`-----------------------
`);throw new Error(`Unable to Tokenize because Errors detected in definition of Lexer:
`+i)}return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let r,i,s,a,o,l,c,u,f,d,g,p,_,y,v;const x=e,E=x.length;let M=0,O=0;const N=this.hasCustom?0:Math.floor(e.length/10),I=new Array(N),D=[];let V=this.trackStartLines?1:void 0,G=this.trackStartLines?1:void 0;const Q=xHe(this.emptyGroups),B=this.trackStartLines,$=this.config.lineTerminatorsPattern;let U=0,J=[],W=[];const q=[],Y=[];Object.freeze(Y);let ae;function Z(){return J}function K(Me){const qe=A1(Me),Pe=W[qe];return Pe===void 0?Y:Pe}const ne=Me=>{if(q.length===1&&Me.tokenType.PUSH_MODE===void 0){const qe=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(Me);D.push({offset:Me.startOffset,line:Me.startLine,column:Me.startColumn,length:Me.image.length,message:qe})}else{q.pop();const qe=ow(q);J=this.patternIdxToConfig[qe],W=this.charCodeToPatternIdxToConfig[qe],U=J.length;const Pe=this.canModeBeOptimized[qe]&&this.config.safeMode===!1;W&&Pe?ae=K:ae=Z}};function le(Me){q.push(Me),W=this.charCodeToPatternIdxToConfig[Me],J=this.patternIdxToConfig[Me],U=J.length,U=J.length;const qe=this.canModeBeOptimized[Me]&&this.config.safeMode===!1;W&&qe?ae=K:ae=Z}le.call(this,t);let ce;const de=this.config.recoveryEnabled;for(;M<E;){l=null;const Me=x.charCodeAt(M),qe=ae(Me),Pe=qe.length;for(r=0;r<Pe;r++){ce=qe[r];const Ce=ce.pattern;c=null;const Xe=ce.short;if(Xe!==!1?Me===Xe&&(l=Ce):ce.isCustom===!0?(v=Ce.exec(x,M,I,Q),v!==null?(l=v[0],v.payload!==void 0&&(c=v.payload)):l=null):(this.updateLastIndex(Ce,M),l=this.match(Ce,e,M)),l!==null){if(o=ce.longerAlt,o!==void 0){const $e=o.length;for(s=0;s<$e;s++){const at=J[o[s]],pt=at.pattern;if(u=null,at.isCustom===!0?(v=pt.exec(x,M,I,Q),v!==null?(a=v[0],v.payload!==void 0&&(u=v.payload)):a=null):(this.updateLastIndex(pt,M),a=this.match(pt,e,M)),a&&a.length>l.length){l=a,c=u,ce=at;break}}}break}}if(l!==null){if(f=l.length,d=ce.group,d!==void 0&&(g=ce.tokenTypeIdx,p=this.createTokenInstance(l,M,g,ce.tokenType,V,G,f),this.handlePayload(p,c),d===!1?O=this.addToken(I,O,p):Q[d].push(p)),e=this.chopInput(e,f),M=M+f,G=this.computeNewColumn(G,f),B===!0&&ce.canLineTerminator===!0){let Ce=0,Xe,$e;$.lastIndex=0;do Xe=$.test(l),Xe===!0&&($e=$.lastIndex-1,Ce++);while(Xe===!0);Ce!==0&&(V=V+Ce,G=f-$e,this.updateTokenEndLineColumnLocation(p,d,$e,Ce,V,G,f))}this.handleModes(ce,ne,le,p)}else{const Ce=M,Xe=V,$e=G;let at=de===!1;for(;at===!1&&M<E;)for(e=this.chopInput(e,1),M++,i=0;i<U;i++){const pt=J[i],oe=pt.pattern,Ue=pt.short;if(Ue!==!1?x.charCodeAt(M)===Ue&&(at=!0):pt.isCustom===!0?at=oe.exec(x,M,I,Q)!==null:(this.updateLastIndex(oe,M),at=oe.exec(e)!==null),at===!0)break}if(_=M-Ce,G=this.computeNewColumn(G,_),y=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(x,Ce,_,Xe,$e),D.push({offset:Ce,line:Xe,column:$e,length:_,message:y}),de===!1)break}}return this.hasCustom||(I.length=O),{tokens:I,groups:Q,errors:D}}handleModes(e,t,r,i){if(e.pop===!0){const s=e.push;t(i),s!==void 0&&r.call(this,s)}else e.push!==void 0&&r.call(this,e.push)}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,r,i,s,a,o){let l,c;t!==void 0&&(l=r===o-1,c=l?-1:0,i===1&&l===!0||(e.endLine=s+c,e.endColumn=a-1+-c))}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,r,i){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:i}}createStartOnlyToken(e,t,r,i,s,a){return{image:e,startOffset:t,startLine:s,startColumn:a,tokenTypeIdx:r,tokenType:i}}createFullToken(e,t,r,i,s,a,o){return{image:e,startOffset:t,endOffset:t+o-1,startLine:s,endLine:s,startColumn:a,endColumn:a+o-1,tokenTypeIdx:r,tokenType:i}}addTokenUsingPush(e,t,r){return e.push(r),t}addTokenUsingMemberAccess(e,t,r){return e[t]=r,t++,t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){t!==null&&(e.payload=t)}matchWithTest(e,t,r){return e.test(t)===!0?t.substring(r,e.lastIndex):null}matchWithExec(e,t){const r=e.exec(t);return r!==null?r[0]:null}};Ph.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Ph.NA=/NOT_APPLICABLE/;function E2(n){return _fe(n)?n.LABEL:n.name}function _fe(n){return zm(n.LABEL)&&n.LABEL!==""}const LHe="parent",wJ="categories",RJ="label",AJ="group",CJ="push_mode",MJ="pop_mode",kJ="longer_alt",OJ="line_breaks",IJ="start_chars_hint";function $g(n){return UHe(n)}function UHe(n){const e=n.pattern,t={};if(t.name=n.name,lb(e)||(t.PATTERN=e),hi(n,LHe))throw`The parent property is no longer supported.
See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details.`;return hi(n,wJ)&&(t.CATEGORIES=n[wJ]),vO([t]),hi(n,RJ)&&(t.LABEL=n[RJ]),hi(n,AJ)&&(t.GROUP=n[AJ]),hi(n,MJ)&&(t.POP_MODE=n[MJ]),hi(n,CJ)&&(t.PUSH_MODE=n[CJ]),hi(n,kJ)&&(t.LONGER_ALT=n[kJ]),hi(n,OJ)&&(t.LINE_BREAKS=n[OJ]),hi(n,IJ)&&(t.START_CHARS_HINT=n[IJ]),t}const kE=$g({name:"EOF",pattern:Ph.NA});vO([kE]);function yO(n,e,t,r,i,s,a,o){return{image:e,startOffset:t,endOffset:r,startLine:i,endLine:s,startColumn:a,endColumn:o,tokenTypeIdx:n.tokenTypeIdx,tokenType:n}}function BHe(n,e){return _O(n,e)}const vfe={buildMismatchTokenMessage({expected:n,actual:e,previous:t,ruleName:r}){return`Expecting ${_fe(n)?`--> ${E2(n)} <--`:`token of type --> ${n.name} <--`} but found --> '${e.image}' <--`},buildNotAllInputParsedMessage({firstRedundant:n,ruleName:e}){return"Redundant input, expecting EOF but found: "+n.image},buildNoViableAltMessage({expectedPathsPerAlt:n,actual:e,previous:t,customUserDescription:r,ruleName:i}){const s="Expecting: ",o=`
but found: '`+C_(e).image+"'";if(r)return s+r+o;{const l=jm(n,(d,g)=>d.concat(g),[]),c=Ar(l,d=>`[${Ar(d,g=>E2(g)).join(", ")}]`),f=`one of these possible Token sequences:
${Ar(c,(d,g)=>`  ${g+1}. ${d}`).join(`
`)}`;return s+f+o}},buildEarlyExitMessage({expectedIterationPaths:n,actual:e,customUserDescription:t,ruleName:r}){const i="Expecting: ",a=`
but found: '`+C_(e).image+"'";if(t)return i+t+a;{const l=`expecting at least one iteration which starts with one of these possible Token sequences::
  <${Ar(n,c=>`[${Ar(c,u=>E2(u)).join(",")}]`).join(" ,")}>`;return i+l+a}}};Object.freeze(vfe);const FHe={buildRuleNotFoundError(n,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+`<-
inside top level rule: ->`+n.name+"<-"}},QS={buildDuplicateFoundError(n,e){function t(u){return u instanceof Hc?u.terminalType.name:u instanceof Hm?u.nonTerminalName:""}const r=n.name,i=C_(e),s=i.idx,a=pv(i),o=t(i),l=s>0;let c=`->${a}${l?s:""}<- ${o?`with argument: ->${o}<-`:""}
                  appears more than once (${e.length} times) in the top level rule: ->${r}<-.                  
                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES 
                  `;return c=c.replace(/[ \t]+/g," "),c=c.replace(/\s\s+/g,`
`),c},buildNamespaceConflictError(n){return`Namespace conflict found in grammar.
The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${n.name}>.
To resolve this make sure each Terminal and Non-Terminal names are unique
This is easy to accomplish by using the convention that Terminal names start with an uppercase letter
and Non-Terminal names start with a lower case letter.`},buildAlternationPrefixAmbiguityError(n){const e=Ar(n.prefixPath,i=>E2(i)).join(", "),t=n.alternation.idx===0?"":n.alternation.idx;return`Ambiguous alternatives: <${n.ambiguityIndices.join(" ,")}> due to common lookahead prefix
in <OR${t}> inside <${n.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX
For Further details.`},buildAlternationAmbiguityError(n){const e=Ar(n.prefixPath,i=>E2(i)).join(", "),t=n.alternation.idx===0?"":n.alternation.idx;let r=`Ambiguous Alternatives Detected: <${n.ambiguityIndices.join(" ,")}> in <OR${t}> inside <${n.topLevelRule.name}> Rule,
<${e}> may appears as a prefix path in all these alternatives.
`;return r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES
For Further details.`,r},buildEmptyRepetitionError(n){let e=pv(n.repetition);return n.repetition.idx!==0&&(e+=n.repetition.idx),`The repetition <${e}> within Rule <${n.topLevelRule.name}> can never consume any tokens.
This could lead to an infinite loop.`},buildTokenNameError(n){return"deprecated"},buildEmptyAlternationError(n){return`Ambiguous empty alternative: <${n.emptyChoiceIdx+1}> in <OR${n.alternation.idx}> inside <${n.topLevelRule.name}> Rule.
Only the last alternative may be an empty alternative.`},buildTooManyAlternativesError(n){return`An Alternation cannot have more than 256 alternatives:
<OR${n.alternation.idx}> inside <${n.topLevelRule.name}> Rule.
 has ${n.alternation.definition.length+1} alternatives.`},buildLeftRecursionError(n){const e=n.topLevelRule.name,t=Ar(n.leftRecursionPath,s=>s.name),r=`${e} --> ${t.concat([e]).join(" --> ")}`;return`Left Recursion found in grammar.
rule: <${e}> can be invoked from itself (directly or indirectly)
without consuming any Tokens. The grammar path that causes this is: 
 ${r}
 To fix this refactor your grammar to remove the left recursion.
see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`},buildInvalidRuleNameError(n){return"deprecated"},buildDuplicateRuleNameError(n){let e;return n.topLevelRule instanceof Vw?e=n.topLevelRule.name:e=n.topLevelRule,`Duplicate definition, rule: ->${e}<- is already defined in the grammar: ->${n.grammarName}<-`}};function zHe(n,e){const t=new jHe(n,e);return t.resolveRefs(),t.errors}class jHe extends rx{constructor(e,t){super(),this.nameToTopRule=e,this.errMsgProvider=t,this.errors=[]}resolveRefs(){wi(_f(this.nameToTopRule),e=>{this.currTopLevel=e,e.accept(this)})}visitNonTerminal(e){const t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{const r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:Hp.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}}}class HHe extends J4{constructor(e,t){super(),this.topProd=e,this.path=t,this.possibleTokTypes=[],this.nextProductionName="",this.nextProductionOccurrence=0,this.found=!1,this.isAtEndOfPath=!1}startWalking(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Td(this.path.ruleStack).reverse(),this.occurrenceStack=Td(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes}walk(e,t=[]){this.found||super.walk(e,t)}walkProdRef(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const i=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,i)}}updateExpectedNext(){Fl(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())}}class qHe extends HHe{constructor(e,t){super(e,t),this.path=t,this.nextTerminalName="",this.nextTerminalOccurrence=0,this.nextTerminalName=this.path.lastTok.name,this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const i=t.concat(r),s=new qm({definition:i});this.possibleTokTypes=gO(s),this.found=!0}}}class tU extends J4{constructor(e,t){super(),this.topRule=e,this.occurrence=t,this.result={token:void 0,occurrence:void 0,isEndOfRule:void 0}}startWalking(){return this.walk(this.topRule),this.result}}class VHe extends tU{walkMany(e,t,r){if(e.idx===this.occurrence){const i=C_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Hc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkMany(e,t,r)}}class NJ extends tU{walkManySep(e,t,r){if(e.idx===this.occurrence){const i=C_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Hc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkManySep(e,t,r)}}class GHe extends tU{walkAtLeastOne(e,t,r){if(e.idx===this.occurrence){const i=C_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Hc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOne(e,t,r)}}class PJ extends tU{walkAtLeastOneSep(e,t,r){if(e.idx===this.occurrence){const i=C_(t.concat(r));this.result.isEndOfRule=i===void 0,i instanceof Hc&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else super.walkAtLeastOneSep(e,t,r)}}function K7(n,e,t=[]){t=Td(t);let r=[],i=0;function s(o){return o.concat(yd(n,i+1))}function a(o){const l=K7(s(o),e,t);return r.concat(l)}for(;t.length<e&&i<n.length;){const o=n[i];if(o instanceof qm)return a(o.definition);if(o instanceof Hm)return a(o.definition);if(o instanceof Pm)r=a(o.definition);else if(o instanceof ey){const l=o.definition.concat([new Wf({definition:o.definition})]);return a(l)}else if(o instanceof ty){const l=[new qm({definition:o.definition}),new Wf({definition:[new Hc({terminalType:o.separator})].concat(o.definition)})];return a(l)}else if(o instanceof F_){const l=o.definition.concat([new Wf({definition:[new Hc({terminalType:o.separator})].concat(o.definition)})]);r=a(l)}else if(o instanceof Wf){const l=o.definition.concat([new Wf({definition:o.definition})]);r=a(l)}else{if(o instanceof z_)return wi(o.definition,l=>{Fl(l.definition)===!1&&(r=a(l.definition))}),r;if(o instanceof Hc)t.push(o.terminalType);else throw Error("non exhaustive match")}i++}return r.push({partialPath:t,suffixDef:yd(n,i)}),r}function yfe(n,e,t,r){const i="EXIT_NONE_TERMINAL",s=[i],a="EXIT_ALTERNATIVE";let o=!1;const l=e.length,c=l-r-1,u=[],f=[];for(f.push({idx:-1,def:n,ruleStack:[],occurrenceStack:[]});!Fl(f);){const d=f.pop();if(d===a){o&&ow(f).idx<=c&&f.pop();continue}const g=d.def,p=d.idx,_=d.ruleStack,y=d.occurrenceStack;if(Fl(g))continue;const v=g[0];if(v===i){const x={idx:p,def:yd(g),ruleStack:ck(_),occurrenceStack:ck(y)};f.push(x)}else if(v instanceof Hc)if(p<l-1){const x=p+1,E=e[x];if(t(E,v.terminalType)){const M={idx:x,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(M)}}else if(p===l-1)u.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:_,occurrenceStack:y}),o=!0;else throw Error("non exhaustive match");else if(v instanceof Hm){const x=Td(_);x.push(v.nonTerminalName);const E=Td(y);E.push(v.idx);const M={idx:p,def:v.definition.concat(s,yd(g)),ruleStack:x,occurrenceStack:E};f.push(M)}else if(v instanceof Pm){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E={idx:p,def:v.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y};f.push(E)}else if(v instanceof ey){const x=new Wf({definition:v.definition,idx:v.idx}),E=v.definition.concat([x],yd(g)),M={idx:p,def:E,ruleStack:_,occurrenceStack:y};f.push(M)}else if(v instanceof ty){const x=new Hc({terminalType:v.separator}),E=new Wf({definition:[x].concat(v.definition),idx:v.idx}),M=v.definition.concat([E],yd(g)),O={idx:p,def:M,ruleStack:_,occurrenceStack:y};f.push(O)}else if(v instanceof F_){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E=new Hc({terminalType:v.separator}),M=new Wf({definition:[E].concat(v.definition),idx:v.idx}),O=v.definition.concat([M],yd(g)),N={idx:p,def:O,ruleStack:_,occurrenceStack:y};f.push(N)}else if(v instanceof Wf){const x={idx:p,def:yd(g),ruleStack:_,occurrenceStack:y};f.push(x),f.push(a);const E=new Wf({definition:v.definition,idx:v.idx}),M=v.definition.concat([E],yd(g)),O={idx:p,def:M,ruleStack:_,occurrenceStack:y};f.push(O)}else if(v instanceof z_)for(let x=v.definition.length-1;x>=0;x--){const E=v.definition[x],M={idx:p,def:E.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y};f.push(M),f.push(a)}else if(v instanceof qm)f.push({idx:p,def:v.definition.concat(yd(g)),ruleStack:_,occurrenceStack:y});else if(v instanceof Vw)f.push($He(v,p,_,y));else throw Error("non exhaustive match")}return u}function $He(n,e,t,r){const i=Td(t);i.push(n.name);const s=Td(r);return s.push(1),{idx:e,def:n.definition,ruleStack:i,occurrenceStack:s}}var mu;(function(n){n[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION"})(mu||(mu={}));function bfe(n){if(n instanceof Pm||n==="Option")return mu.OPTION;if(n instanceof Wf||n==="Repetition")return mu.REPETITION;if(n instanceof ey||n==="RepetitionMandatory")return mu.REPETITION_MANDATORY;if(n instanceof ty||n==="RepetitionMandatoryWithSeparator")return mu.REPETITION_MANDATORY_WITH_SEPARATOR;if(n instanceof F_||n==="RepetitionWithSeparator")return mu.REPETITION_WITH_SEPARATOR;if(n instanceof z_||n==="Alternation")return mu.ALTERNATION;throw Error("non exhaustive match")}function WHe(n,e,t,r,i,s){const a=yH(n,e,t),o=xfe(a)?zD:_O;return s(a,r,o,i)}function YHe(n,e,t,r,i,s){const a=bH(n,e,i,t),o=xfe(a)?zD:_O;return s(a[0],o,r)}function XHe(n,e,t,r){const i=n.length,s=w_(n,a=>w_(a,o=>o.length===1));if(e)return function(a){const o=Ar(a,l=>l.GATE);for(let l=0;l<i;l++){const c=n[l],u=c.length,f=o[l];if(!(f!==void 0&&f.call(this)===!1))e:for(let d=0;d<u;d++){const g=c[d],p=g.length;for(let _=0;_<p;_++){const y=this.LA(_+1);if(t(y,g[_])===!1)continue e}return l}}};if(s&&!r){const a=Ar(n,l=>Nm(l)),o=jm(a,(l,c,u)=>(wi(c,f=>{hi(l,f.tokenTypeIdx)||(l[f.tokenTypeIdx]=u),wi(f.categoryMatches,d=>{hi(l,d)||(l[d]=u)})}),l),{});return function(){const l=this.LA(1);return o[l.tokenTypeIdx]}}else return function(){for(let a=0;a<i;a++){const o=n[a],l=o.length;e:for(let c=0;c<l;c++){const u=o[c],f=u.length;for(let d=0;d<f;d++){const g=this.LA(d+1);if(t(g,u[d])===!1)continue e}return a}}}}function KHe(n,e,t){const r=w_(n,s=>s.length===1),i=n.length;if(r&&!t){const s=Nm(n);if(s.length===1&&Fl(s[0].categoryMatches)){const o=s[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}else{const a=jm(s,(o,l,c)=>(o[l.tokenTypeIdx]=!0,wi(l.categoryMatches,u=>{o[u]=!0}),o),[]);return function(){const o=this.LA(1);return a[o.tokenTypeIdx]===!0}}}else return function(){e:for(let s=0;s<i;s++){const a=n[s],o=a.length;for(let l=0;l<o;l++){const c=this.LA(l+1);if(e(c,a[l])===!1)continue e}return!0}return!1}}class ZHe extends J4{constructor(e,t,r){super(),this.topProd=e,this.targetOccurrence=t,this.targetProdType=r}startWalking(){return this.walk(this.topProd),this.restDef}checkIsTarget(e,t,r,i){return e.idx===this.targetOccurrence&&this.targetProdType===t?(this.restDef=r.concat(i),!0):!1}walkOption(e,t,r){this.checkIsTarget(e,mu.OPTION,t,r)||super.walkOption(e,t,r)}walkAtLeastOne(e,t,r){this.checkIsTarget(e,mu.REPETITION_MANDATORY,t,r)||super.walkOption(e,t,r)}walkAtLeastOneSep(e,t,r){this.checkIsTarget(e,mu.REPETITION_MANDATORY_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}walkMany(e,t,r){this.checkIsTarget(e,mu.REPETITION,t,r)||super.walkOption(e,t,r)}walkManySep(e,t,r){this.checkIsTarget(e,mu.REPETITION_WITH_SEPARATOR,t,r)||super.walkOption(e,t,r)}}class Sfe extends rx{constructor(e,t,r){super(),this.targetOccurrence=e,this.targetProdType=t,this.targetRef=r,this.result=[]}checkIsTarget(e,t){e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.targetRef===void 0||e===this.targetRef)&&(this.result=e.definition)}visitOption(e){this.checkIsTarget(e,mu.OPTION)}visitRepetition(e){this.checkIsTarget(e,mu.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,mu.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,mu.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,mu.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,mu.ALTERNATION)}}function DJ(n){const e=new Array(n);for(let t=0;t<n;t++)e[t]=[];return e}function EB(n){let e=[""];for(let t=0;t<n.length;t++){const r=n[t],i=[];for(let s=0;s<e.length;s++){const a=e[s];i.push(a+"_"+r.tokenTypeIdx);for(let o=0;o<r.categoryMatches.length;o++){const l="_"+r.categoryMatches[o];i.push(a+l)}}e=i}return e}function QHe(n,e,t){for(let r=0;r<n.length;r++){if(r===t)continue;const i=n[r];for(let s=0;s<e.length;s++){const a=e[s];if(i[a]===!0)return!1}}return!0}function Efe(n,e){const t=Ar(n,a=>K7([a],1)),r=DJ(t.length),i=Ar(t,a=>{const o={};return wi(a,l=>{const c=EB(l.partialPath);wi(c,u=>{o[u]=!0})}),o});let s=t;for(let a=1;a<=e;a++){const o=s;s=DJ(o.length);for(let l=0;l<o.length;l++){const c=o[l];for(let u=0;u<c.length;u++){const f=c[u].partialPath,d=c[u].suffixDef,g=EB(f);if(QHe(i,g,l)||Fl(d)||f.length===e){const _=r[l];if(Z7(_,f)===!1){_.push(f);for(let y=0;y<g.length;y++){const v=g[y];i[l][v]=!0}}}else{const _=K7(d,a+1,f);s[l]=s[l].concat(_),wi(_,y=>{const v=EB(y.partialPath);wi(v,x=>{i[l][x]=!0})})}}}}return r}function yH(n,e,t,r){const i=new Sfe(n,mu.ALTERNATION,r);return e.accept(i),Efe(i.result,t)}function bH(n,e,t,r){const i=new Sfe(n,t);e.accept(i);const s=i.result,o=new ZHe(e,n,t).startWalking(),l=new qm({definition:s}),c=new qm({definition:o});return Efe([l,c],r)}function Z7(n,e){e:for(let t=0;t<n.length;t++){const r=n[t];if(r.length===e.length){for(let i=0;i<r.length;i++){const s=e[i],a=r[i];if((s===a||a.categoryMatchesMap[s.tokenTypeIdx]!==void 0)===!1)continue e}return!0}}return!1}function JHe(n,e){return n.length<e.length&&w_(n,(t,r)=>{const i=e[r];return t===i||i.categoryMatchesMap[t.tokenTypeIdx]})}function xfe(n){return w_(n,e=>w_(e,t=>w_(t,r=>Fl(r.categoryMatches))))}function eqe(n){const e=n.lookaheadStrategy.validate({rules:n.rules,tokenTypes:n.tokenTypes,grammarName:n.grammarName});return Ar(e,t=>Object.assign({type:Hp.CUSTOM_LOOKAHEAD_VALIDATION},t))}function tqe(n,e,t,r){const i=P0(n,l=>nqe(l,t)),s=pqe(n,e,t),a=P0(n,l=>uqe(l,t)),o=P0(n,l=>sqe(l,n,r,t));return i.concat(s,a,o)}function nqe(n,e){const t=new iqe;n.accept(t);const r=t.allProductions,i=ife(r,rqe),s=B_(i,o=>o.length>1);return Ar(_f(s),o=>{const l=C_(o),c=e.buildDuplicateFoundError(n,o),u=pv(l),f={message:c,type:Hp.DUPLICATE_PRODUCTIONS,ruleName:n.name,dslName:u,occurrence:l.idx},d=Tfe(l);return d&&(f.parameter=d),f})}function rqe(n){return`${pv(n)}_#_${n.idx}_#_${Tfe(n)}`}function Tfe(n){return n instanceof Hc?n.terminalType.name:n instanceof Hm?n.nonTerminalName:""}class iqe extends rx{constructor(){super(...arguments),this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function sqe(n,e,t,r){const i=[];if(jm(e,(a,o)=>o.name===n.name?a+1:a,0)>1){const a=r.buildDuplicateRuleNameError({topLevelRule:n,grammarName:t});i.push({message:a,type:Hp.DUPLICATE_RULE_NAME,ruleName:n.name})}return i}function aqe(n,e,t){const r=[];let i;return Gp(e,n)||(i=`Invalid rule override, rule: ->${n}<- cannot be overridden in the grammar: ->${t}<-as it is not defined in any of the super grammars `,r.push({message:i,type:Hp.INVALID_RULE_OVERRIDE,ruleName:n})),r}function wfe(n,e,t,r=[]){const i=[],s=YN(e.definition);if(Fl(s))return[];{const a=n.name;Gp(s,n)&&i.push({message:t.buildLeftRecursionError({topLevelRule:n,leftRecursionPath:r}),type:Hp.LEFT_RECURSION,ruleName:a});const l=K4(s,r.concat([n])),c=P0(l,u=>{const f=Td(r);return f.push(u),wfe(n,u,t,f)});return i.concat(c)}}function YN(n){let e=[];if(Fl(n))return e;const t=C_(n);if(t instanceof Hm)e.push(t.referencedRule);else if(t instanceof qm||t instanceof Pm||t instanceof ey||t instanceof ty||t instanceof F_||t instanceof Wf)e=e.concat(YN(t.definition));else if(t instanceof z_)e=Nm(Ar(t.definition,s=>YN(s.definition)));else if(!(t instanceof Hc))throw Error("non exhaustive match");const r=LD(t),i=n.length>1;if(r&&i){const s=yd(n);return e.concat(YN(s))}else return e}class SH extends rx{constructor(){super(...arguments),this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function oqe(n,e){const t=new SH;n.accept(t);const r=t.alternations;return P0(r,s=>{const a=ck(s.definition);return P0(a,(o,l)=>{const c=yfe([o],[],_O,1);return Fl(c)?[{message:e.buildEmptyAlternationError({topLevelRule:n,alternation:s,emptyChoiceIdx:l}),type:Hp.NONE_LAST_EMPTY_ALT,ruleName:n.name,occurrence:s.idx,alternative:l+1}]:[]})})}function lqe(n,e,t){const r=new SH;n.accept(r);let i=r.alternations;return i=Z4(i,a=>a.ignoreAmbiguities===!0),P0(i,a=>{const o=a.idx,l=a.maxLookahead||e,c=yH(o,n,l,a),u=hqe(c,a,n,t),f=dqe(c,a,n,t);return u.concat(f)})}class cqe extends rx{constructor(){super(...arguments),this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function uqe(n,e){const t=new SH;n.accept(t);const r=t.alternations;return P0(r,s=>s.definition.length>255?[{message:e.buildTooManyAlternativesError({topLevelRule:n,alternation:s}),type:Hp.TOO_MANY_ALTS,ruleName:n.name,occurrence:s.idx}]:[])}function fqe(n,e,t){const r=[];return wi(n,i=>{const s=new cqe;i.accept(s);const a=s.allProductions;wi(a,o=>{const l=bfe(o),c=o.maxLookahead||e,u=o.idx,d=bH(u,i,l,c)[0];if(Fl(Nm(d))){const g=t.buildEmptyRepetitionError({topLevelRule:i,repetition:o});r.push({message:g,type:Hp.NO_NON_EMPTY_LOOKAHEAD,ruleName:i.name})}})}),r}function hqe(n,e,t,r){const i=[],s=jm(n,(o,l,c)=>(e.definition[c].ignoreAmbiguities===!0||wi(l,u=>{const f=[c];wi(n,(d,g)=>{c!==g&&Z7(d,u)&&e.definition[g].ignoreAmbiguities!==!0&&f.push(g)}),f.length>1&&!Z7(i,u)&&(i.push(u),o.push({alts:f,path:u}))}),o),[]);return Ar(s,o=>{const l=Ar(o.alts,u=>u+1);return{message:r.buildAlternationAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:l,prefixPath:o.path}),type:Hp.AMBIGUOUS_ALTS,ruleName:t.name,occurrence:e.idx,alternatives:o.alts}})}function dqe(n,e,t,r){const i=jm(n,(a,o,l)=>{const c=Ar(o,u=>({idx:l,path:u}));return a.concat(c)},[]);return mO(P0(i,a=>{if(e.definition[a.idx].ignoreAmbiguities===!0)return[];const l=a.idx,c=a.path,u=$0(i,d=>e.definition[d.idx].ignoreAmbiguities!==!0&&d.idx<l&&JHe(d.path,c));return Ar(u,d=>{const g=[d.idx+1,l+1],p=e.idx===0?"":e.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:t,alternation:e,ambiguityIndices:g,prefixPath:d.path}),type:Hp.AMBIGUOUS_PREFIX_ALTS,ruleName:t.name,occurrence:p,alternatives:g}})}))}function pqe(n,e,t){const r=[],i=Ar(e,s=>s.name);return wi(n,s=>{const a=s.name;if(Gp(i,a)){const o=t.buildNamespaceConflictError(s);r.push({message:o,type:Hp.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:a})}}),r}function mqe(n){const e=mH(n,{errMsgProvider:FHe}),t={};return wi(n.rules,r=>{t[r.name]=r}),zHe(t,e.errMsgProvider)}function gqe(n){return n=mH(n,{errMsgProvider:QS}),tqe(n.rules,n.tokenTypes,n.errMsgProvider,n.grammarName)}const Rfe="MismatchedTokenException",Afe="NoViableAltException",Cfe="EarlyExitException",Mfe="NotAllInputParsedException",kfe=[Rfe,Afe,Cfe,Mfe];Object.freeze(kfe);function jD(n){return Gp(kfe,n.name)}class nU extends Error{constructor(e,t){super(e),this.token=t,this.resyncedTokens=[],Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}class Ofe extends nU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=Rfe}}class _qe extends nU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=Afe}}class vqe extends nU{constructor(e,t){super(e,t),this.name=Mfe}}class yqe extends nU{constructor(e,t,r){super(e,t),this.previousToken=r,this.name=Cfe}}const xB={},Ife="InRuleRecoveryException";class bqe extends Error{constructor(e){super(e),this.name=Ife}}class Sqe{initRecoverable(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=hi(e,"recoveryEnabled")?e.recoveryEnabled:cb.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Eqe)}getTokenToInsert(e){const t=yO(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t}canTokenTypeBeInsertedInRecovery(e){return!0}canTokenTypeBeDeletedInRecovery(e){return!0}tryInRepetitionRecovery(e,t,r,i){const s=this.findReSyncTokenType(),a=this.exportLexerState(),o=[];let l=!1;const c=this.LA(1);let u=this.LA(1);const f=()=>{const d=this.LA(0),g=this.errorMessageProvider.buildMismatchTokenMessage({expected:i,actual:c,previous:d,ruleName:this.getCurrRuleFullName()}),p=new Ofe(g,c,this.LA(0));p.resyncedTokens=ck(o),this.SAVE_ERROR(p)};for(;!l;)if(this.tokenMatcher(u,i)){f();return}else if(r.call(this)){f(),e.apply(this,t);return}else this.tokenMatcher(u,s)?l=!0:(u=this.SKIP_TOKEN(),this.addToResyncTokens(u,o));this.importLexerState(a)}shouldInRepetitionRecoveryBeTried(e,t,r){return!(r===!1||this.tokenMatcher(this.LA(1),e)||this.isBackTracking()||this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))}getFollowsForInRuleRecovery(e,t){const r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){const r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new bqe("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e)||Fl(t))return!1;const r=this.LA(1);return lw(t,s=>this.tokenMatcher(r,s))!==void 0}canRecoverWithSingleTokenDeletion(e){return this.canTokenTypeBeDeletedInRecovery(e)?this.tokenMatcher(this.LA(2),e):!1}isInCurrentRuleReSyncSet(e){const t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Gp(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let t=this.LA(1),r=2;for(;;){const i=lw(e,s=>BHe(t,s));if(i!==void 0)return i;t=this.LA(r),r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1)return xB;const e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK,t=this.RULE_OCCURRENCE_STACK;return Ar(e,(r,i)=>i===0?xB:{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:t[i],inRule:this.shortRuleNameToFullName(e[i-1])})}flattenFollowSet(){const e=Ar(this.buildFullFollowKeyStack(),t=>this.getFollowSetFromFollowKey(t));return Nm(e)}getFollowSetFromFollowKey(e){if(e===xB)return[kE];const t=e.ruleName+e.idxInCallingRule+lfe+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){return this.tokenMatcher(e,kE)||t.push(e),t}reSyncTo(e){const t=[];let r=this.LA(1);for(;this.tokenMatcher(r,e)===!1;)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return ck(t)}attemptInRepetitionRecovery(e,t,r,i,s,a,o){}getCurrentGrammarPath(e,t){const r=this.getHumanReadableRuleStack(),i=Td(this.RULE_OCCURRENCE_STACK);return{ruleStack:r,occurrenceStack:i,lastTok:e,lastTokOccurrence:t}}getHumanReadableRuleStack(){return Ar(this.RULE_STACK,e=>this.shortRuleNameToFullName(e))}}function Eqe(n,e,t,r,i,s,a){const o=this.getKeyForAutomaticLookahead(r,i);let l=this.firstAfterRepMap[o];if(l===void 0){const d=this.getCurrRuleFullName(),g=this.getGAstProductions()[d];l=new s(g,i).startWalking(),this.firstAfterRepMap[o]=l}let c=l.token,u=l.occurrence;const f=l.isEndOfRule;this.RULE_STACK.length===1&&f&&c===void 0&&(c=kE,u=1),!(c===void 0||u===void 0)&&this.shouldInRepetitionRecoveryBeTried(c,u,a)&&this.tryInRepetitionRecovery(n,e,t,c)}const xqe=4,$1=8,Nfe=1<<$1,Pfe=2<<$1,Q7=3<<$1,J7=4<<$1,e9=5<<$1,XN=6<<$1;function TB(n,e,t){return t|e|n}class Tqe{constructor(e){var t;this.maxLookahead=(t=e?.maxLookahead)!==null&&t!==void 0?t:cb.maxLookahead}validate(e){const t=this.validateNoLeftRecursion(e.rules);if(Fl(t)){const r=this.validateEmptyOrAlternatives(e.rules),i=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead),s=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);return[...t,...r,...i,...s]}return t}validateNoLeftRecursion(e){return P0(e,t=>wfe(t,t,QS))}validateEmptyOrAlternatives(e){return P0(e,t=>oqe(t,QS))}validateAmbiguousAlternationAlternatives(e,t){return P0(e,r=>lqe(r,t,QS))}validateSomeNonEmptyLookaheadPath(e,t){return fqe(e,t,QS)}buildLookaheadForAlternation(e){return WHe(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,XHe)}buildLookaheadForOptional(e){return YHe(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,bfe(e.prodType),KHe)}}class wqe{initLooksAhead(e){this.dynamicTokensEnabled=hi(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:cb.dynamicTokensEnabled,this.maxLookahead=hi(e,"maxLookahead")?e.maxLookahead:cb.maxLookahead,this.lookaheadStrategy=hi(e,"lookaheadStrategy")?e.lookaheadStrategy:new Tqe({maxLookahead:this.maxLookahead}),this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){wi(e,t=>{this.TRACE_INIT(`${t.name} Rule Lookahead`,()=>{const{alternation:r,repetition:i,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:o,repetitionWithSeparator:l}=Aqe(t);wi(r,c=>{const u=c.idx===0?"":c.idx;this.TRACE_INIT(`${pv(c)}${u}`,()=>{const f=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:c.idx,rule:t,maxLookahead:c.maxLookahead||this.maxLookahead,hasPredicates:c.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled}),d=TB(this.fullRuleNameToShort[t.name],Nfe,c.idx);this.setLaFuncCache(d,f)})}),wi(i,c=>{this.computeLookaheadFunc(t,c.idx,Q7,"Repetition",c.maxLookahead,pv(c))}),wi(s,c=>{this.computeLookaheadFunc(t,c.idx,Pfe,"Option",c.maxLookahead,pv(c))}),wi(a,c=>{this.computeLookaheadFunc(t,c.idx,J7,"RepetitionMandatory",c.maxLookahead,pv(c))}),wi(o,c=>{this.computeLookaheadFunc(t,c.idx,XN,"RepetitionMandatoryWithSeparator",c.maxLookahead,pv(c))}),wi(l,c=>{this.computeLookaheadFunc(t,c.idx,e9,"RepetitionWithSeparator",c.maxLookahead,pv(c))})})})}computeLookaheadFunc(e,t,r,i,s,a){this.TRACE_INIT(`${a}${t===0?"":t}`,()=>{const o=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:s||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:i}),l=TB(this.fullRuleNameToShort[e.name],r,t);this.setLaFuncCache(l,o)})}getKeyForAutomaticLookahead(e,t){const r=this.getLastExplicitRuleShortName();return TB(r,e,t)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}}class Rqe extends rx{constructor(){super(...arguments),this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const VI=new Rqe;function Aqe(n){VI.reset(),n.accept(VI);const e=VI.dslMethods;return VI.reset(),e}function LJ(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.endOffset=e.endOffset):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset)}function UJ(n,e){isNaN(n.startOffset)===!0?(n.startOffset=e.startOffset,n.startColumn=e.startColumn,n.startLine=e.startLine,n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine):n.endOffset<e.endOffset&&(n.endOffset=e.endOffset,n.endColumn=e.endColumn,n.endLine=e.endLine)}function Cqe(n,e,t){n.children[t]===void 0?n.children[t]=[e]:n.children[t].push(e)}function Mqe(n,e,t){n.children[e]===void 0?n.children[e]=[t]:n.children[e].push(t)}const kqe="name";function Dfe(n,e){Object.defineProperty(n,kqe,{enumerable:!1,configurable:!0,writable:!1,value:e})}function Oqe(n,e){const t=H0(n),r=t.length;for(let i=0;i<r;i++){const s=t[i],a=n[s],o=a.length;for(let l=0;l<o;l++){const c=a[l];c.tokenTypeIdx===void 0&&this[c.name](c.children,e)}}}function Iqe(n,e){const t=function(){};Dfe(t,n+"BaseSemantics");const r={visit:function(i,s){if(ka(i)&&(i=i[0]),!lb(i))return this[i.name](i.children,s)},validateVisitor:function(){const i=Pqe(this,e);if(!Fl(i)){const s=Ar(i,a=>a.msg);throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:
	${s.join(`

`).replace(/\n/g,`
	`)}`)}}};return t.prototype=r,t.prototype.constructor=t,t._RULE_NAMES=e,t}function Nqe(n,e,t){const r=function(){};Dfe(r,n+"BaseSemanticsWithDefaults");const i=Object.create(t.prototype);return wi(e,s=>{i[s]=Oqe}),r.prototype=i,r.prototype.constructor=r,r}var t9;(function(n){n[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD"})(t9||(t9={}));function Pqe(n,e){return Dqe(n,e)}function Dqe(n,e){const t=$0(e,i=>gb(n[i])===!1),r=Ar(t,i=>({msg:`Missing visitor method: <${i}> on ${n.constructor.name} CST Visitor.`,type:t9.MISSING_METHOD,methodName:i}));return mO(r)}class Lqe{initTreeBuilder(e){if(this.CST_STACK=[],this.outputCst=e.outputCst,this.nodeLocationTracking=hi(e,"nodeLocationTracking")?e.nodeLocationTracking:cb.nodeLocationTracking,!this.outputCst)this.cstInvocationStateUpdate=qf,this.cstFinallyStateUpdate=qf,this.cstPostTerminal=qf,this.cstPostNonTerminal=qf,this.cstPostRule=qf;else if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=UJ,this.setNodeLocationFromNode=UJ,this.cstPostRule=qf,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=LJ,this.setNodeLocationFromNode=LJ,this.cstPostRule=qf,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else if(/none/i.test(this.nodeLocationTracking))this.setNodeLocationFromToken=qf,this.setNodeLocationFromNode=qf,this.cstPostRule=qf,this.setInitialNodeLocation=qf;else throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t),this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)}cstPostRuleOnlyOffset(e){const t=this.LA(0),r=e.location;r.startOffset<=t.startOffset?r.endOffset=t.endOffset:r.startOffset=NaN}cstPostTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];Cqe(r,t,e),this.setNodeLocationFromToken(r.location,t)}cstPostNonTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];Mqe(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(lb(this.baseCstVisitorConstructor)){const e=Iqe(this.className,H0(this.gastProductionsCache));return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(lb(this.baseCstVisitorWithDefaultsConstructor)){const e=Nqe(this.className,H0(this.gastProductionsCache),this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class Uqe{initLexerAdapter(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==!0)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):qD}LA(e){const t=this.currIdx+e;return t<0||this.tokVectorLength<=t?qD:this.tokVector[t]}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class Bqe{ACTION(e){return e.call(this)}consume(e,t,r){return this.consumeInternal(t,e,r)}subrule(e,t,r){return this.subruleInternal(t,e,r)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,r=VD){if(Gp(this.definedRulesNames,e)){const a={message:QS.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:Hp.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(a)}this.definedRulesNames.push(e);const i=this.defineRule(e,t,r);return this[e]=i,i}OVERRIDE_RULE(e,t,r=VD){const i=aqe(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(i);const s=this.defineRule(e,t,r);return this[e]=s,s}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{return e.apply(this,t),!0}catch(i){if(jD(i))return!1;throw i}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return zje(_f(this.gastProductionsCache))}}class Fqe{initRecognizerEngine(e,t){if(this.className=this.constructor.name,this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=zD,this.subruleIdx=0,this.definedRulesNames=[],this.tokensMap={},this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},hi(t,"serializedGrammar"))throw Error(`The Parser's configuration can no longer contain a <serializedGrammar> property.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0
	For Further details.`);if(ka(e)){if(Fl(e))throw Error(`A Token Vocabulary cannot be empty.
	Note that the first argument for the parser constructor
	is no longer a Token vector (since v4.0).`);if(typeof e[0].startOffset=="number")throw Error(`The Parser constructor no longer accepts a token vector as the first argument.
	See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0
	For Further details.`)}if(ka(e))this.tokensMap=jm(e,(s,a)=>(s[a.name]=a,s),{});else if(hi(e,"modes")&&w_(Nm(_f(e.modes)),PHe)){const s=Nm(_f(e.modes)),a=Q4(s);this.tokensMap=jm(a,(o,l)=>(o[l.name]=l,o),{})}else if(j0(e))this.tokensMap=Td(e);else throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap.EOF=kE;const r=hi(e,"modes")?Nm(_f(e.modes)):_f(e),i=w_(r,s=>Fl(s.categoryMatches));this.tokenMatcher=i?zD:_O,vO(_f(this.tokensMap))}defineRule(e,t,r){if(this.selfAnalysisDone)throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'
Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`);const i=hi(r,"resyncEnabled")?r.resyncEnabled:VD.resyncEnabled,s=hi(r,"recoveryValueFunc")?r.recoveryValueFunc:VD.recoveryValueFunc,a=this.ruleShortNameIdx<<xqe+$1;this.ruleShortNameIdx++,this.shortRuleNameToFull[a]=e,this.fullRuleNameToShort[e]=a;let o;return this.outputCst===!0?o=function(...u){try{this.ruleInvocationStateUpdate(a,e,this.subruleIdx),t.apply(this,u);const f=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(f),f}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}}:o=function(...u){try{return this.ruleInvocationStateUpdate(a,e,this.subruleIdx),t.apply(this,u)}catch(f){return this.invokeRuleCatch(f,i,s)}finally{this.ruleFinallyStateUpdate()}},Object.assign(o,{ruleName:e,originalGrammarAction:t})}invokeRuleCatch(e,t,r){const i=this.RULE_STACK.length===1,s=t&&!this.isBackTracking()&&this.recoveryEnabled;if(jD(e)){const a=e;if(s){const o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))if(a.resyncedTokens=this.reSyncTo(o),this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];return l.recoveredNode=!0,l}else return r(e);else{if(this.outputCst){const l=this.CST_STACK[this.CST_STACK.length-1];l.recoveredNode=!0,a.partialCstResult=l}throw a}}else{if(i)return this.moveToTerminatedState(),r(e);throw a}}else throw e}optionInternal(e,t){const r=this.getKeyForAutomaticLookahead(Pfe,t);return this.optionInternalLogic(e,t,r)}optionInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof e!="function"){s=e.DEF;const a=e.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=e;if(i.call(this)===!0)return s.call(this)}atLeastOneInternal(e,t){const r=this.getKeyForAutomaticLookahead(J7,e);return this.atLeastOneInternalLogic(e,t,r)}atLeastOneInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const a=t.GATE;if(a!==void 0){const o=i;i=()=>a.call(this)&&o.call(this)}}else s=t;if(i.call(this)===!0){let a=this.doSingleRepetition(s);for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s)}else throw this.raiseEarlyExitException(e,mu.REPETITION_MANDATORY,t.ERR_MSG);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],i,J7,e,GHe)}atLeastOneSepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead(XN,e);this.atLeastOneSepFirstInternalLogic(e,t,r)}atLeastOneSepFirstInternalLogic(e,t,r){const i=t.DEF,s=t.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,PJ],o,XN,e,PJ)}else throw this.raiseEarlyExitException(e,mu.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)}manyInternal(e,t){const r=this.getKeyForAutomaticLookahead(Q7,e);return this.manyInternalLogic(e,t,r)}manyInternalLogic(e,t,r){let i=this.getLaFuncFromCache(r),s;if(typeof t!="function"){s=t.DEF;const o=t.GATE;if(o!==void 0){const l=i;i=()=>o.call(this)&&l.call(this)}}else s=t;let a=!0;for(;i.call(this)===!0&&a===!0;)a=this.doSingleRepetition(s);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],i,Q7,e,VHe,a)}manySepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead(e9,e);this.manySepFirstInternalLogic(e,t,r)}manySepFirstInternalLogic(e,t,r){const i=t.DEF,s=t.SEP;if(this.getLaFuncFromCache(r).call(this)===!0){i.call(this);const o=()=>this.tokenMatcher(this.LA(1),s);for(;this.tokenMatcher(this.LA(1),s)===!0;)this.CONSUME(s),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,o,i,NJ],o,e9,e,NJ)}}repetitionSepSecondInternal(e,t,r,i,s){for(;r();)this.CONSUME(t),i.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,i,s],r,XN,e,s)}doSingleRepetition(e){const t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t}orInternal(e,t){const r=this.getKeyForAutomaticLookahead(Nfe,t),i=ka(e)?e:e.DEF,a=this.getLaFuncFromCache(r).call(this,i);if(a!==void 0)return i[a].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),this.RULE_STACK.length===0&&this.isAtEndOfInput()===!1){const e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new vqe(t,e))}}subruleInternal(e,t,r){let i;try{const s=r!==void 0?r.ARGS:void 0;return this.subruleIdx=t,i=e.apply(this,s),this.cstPostNonTerminal(i,r!==void 0&&r.LABEL!==void 0?r.LABEL:e.ruleName),i}catch(s){throw this.subruleInternalError(s,r,e.ruleName)}}subruleInternalError(e,t,r){throw jD(e)&&e.partialCstResult!==void 0&&(this.cstPostNonTerminal(e.partialCstResult,t!==void 0&&t.LABEL!==void 0?t.LABEL:r),delete e.partialCstResult),e}consumeInternal(e,t,r){let i;try{const s=this.LA(1);this.tokenMatcher(s,e)===!0?(this.consumeToken(),i=s):this.consumeInternalError(e,s,r)}catch(s){i=this.consumeInternalRecovery(e,t,s)}return this.cstPostTerminal(r!==void 0&&r.LABEL!==void 0?r.LABEL:e.name,i),i}consumeInternalError(e,t,r){let i;const s=this.LA(0);throw r!==void 0&&r.ERR_MSG?i=r.ERR_MSG:i=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:s,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Ofe(i,t,s))}consumeInternalRecovery(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const i=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,i)}catch(s){throw s.name===Ife?r:s}}else throw r}saveRecogState(){const e=this.errors,t=Td(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),kE)}reset(){this.resetLexerState(),this.subruleIdx=0,this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]}}class zqe{initErrorHandler(e){this._errors=[],this.errorMessageProvider=hi(e,"errorMessageProvider")?e.errorMessageProvider:cb.errorMessageProvider}SAVE_ERROR(e){if(jD(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Td(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")}get errors(){return Td(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,r){const i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=bH(e,s,t,this.maxLookahead)[0],l=[];for(let u=1;u<=this.maxLookahead;u++)l.push(this.LA(u));const c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:l,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new yqe(c,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){const r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=yH(e,i,this.maxLookahead),a=[];for(let c=1;c<=this.maxLookahead;c++)a.push(this.LA(c));const o=this.LA(0),l=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:a,previous:o,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new _qe(l,this.LA(1),o))}}class jqe{initContentAssist(){}computeContentAssist(e,t){const r=this.gastProductionsCache[e];if(lb(r))throw Error(`Rule ->${e}<- does not exist in this grammar.`);return yfe([r],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const t=C_(e.ruleStack),i=this.getGAstProductions()[t];return new qHe(i,e).startWalking()}}const rU={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(rU);const BJ=!0,FJ=Math.pow(2,$1)-1,Lfe=$g({name:"RECORDING_PHASE_TOKEN",pattern:Ph.NA});vO([Lfe]);const Ufe=yO(Lfe,`This IToken indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,-1,-1,-1,-1,-1,-1);Object.freeze(Ufe);const Hqe={name:`This CSTNode indicates the Parser is in Recording Phase
	See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details`,children:{}};class qqe{initGastRecorder(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1}enableRecording(){this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",()=>{for(let e=0;e<10;e++){const t=e>0?e:"";this[`CONSUME${t}`]=function(r,i){return this.consumeInternalRecord(r,e,i)},this[`SUBRULE${t}`]=function(r,i){return this.subruleInternalRecord(r,e,i)},this[`OPTION${t}`]=function(r){return this.optionInternalRecord(r,e)},this[`OR${t}`]=function(r){return this.orInternalRecord(r,e)},this[`MANY${t}`]=function(r){this.manyInternalRecord(e,r)},this[`MANY_SEP${t}`]=function(r){this.manySepFirstInternalRecord(e,r)},this[`AT_LEAST_ONE${t}`]=function(r){this.atLeastOneInternalRecord(e,r)},this[`AT_LEAST_ONE_SEP${t}`]=function(r){this.atLeastOneSepFirstInternalRecord(e,r)}}this.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},this.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},this.option=function(e,t){return this.optionInternalRecord(t,e)},this.or=function(e,t){return this.orInternalRecord(t,e)},this.many=function(e,t){this.manyInternalRecord(e,t)},this.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},this.ACTION=this.ACTION_RECORD,this.BACKTRACK=this.BACKTRACK_RECORD,this.LA=this.LA_RECORD})}disableRecording(){this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",()=>{const e=this;for(let t=0;t<10;t++){const r=t>0?t:"";delete e[`CONSUME${r}`],delete e[`SUBRULE${r}`],delete e[`OPTION${r}`],delete e[`OR${r}`],delete e[`MANY${r}`],delete e[`MANY_SEP${r}`],delete e[`AT_LEAST_ONE${r}`],delete e[`AT_LEAST_ONE_SEP${r}`]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>!0}LA_RECORD(e){return qD}topLevelRuleRecord(e,t){try{const r=new Vw({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(r){if(r.KNOWN_RECORDER_ERROR!==!0)try{r.message=r.message+`
	 This error was thrown during the "grammar recording phase" For more info see:
	https://chevrotain.io/docs/guide/internals.html#grammar-recording`}catch{throw r}throw r}}optionInternalRecord(e,t){return kM.call(this,Pm,e,t)}atLeastOneInternalRecord(e,t){kM.call(this,ey,t,e)}atLeastOneSepFirstInternalRecord(e,t){kM.call(this,ty,t,e,BJ)}manyInternalRecord(e,t){kM.call(this,Wf,t,e)}manySepFirstInternalRecord(e,t){kM.call(this,F_,t,e,BJ)}orInternalRecord(e,t){return Vqe.call(this,e,t)}subruleInternalRecord(e,t,r){if(HD(t),!e||hi(e,"ruleName")===!1){const o=new Error(`<SUBRULE${zJ(t)}> argument is invalid expecting a Parser method reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw o.KNOWN_RECORDER_ERROR=!0,o}const i=ow(this.recordingProdStack),s=e.ruleName,a=new Hm({idx:t,nonTerminalName:s,label:r?.LABEL,referencedRule:void 0});return i.definition.push(a),this.outputCst?Hqe:rU}consumeInternalRecord(e,t,r){if(HD(t),!gfe(e)){const a=new Error(`<CONSUME${zJ(t)}> argument is invalid expecting a TokenType reference but got: <${JSON.stringify(e)}>
 inside top level rule: <${this.recordingProdStack[0].name}>`);throw a.KNOWN_RECORDER_ERROR=!0,a}const i=ow(this.recordingProdStack),s=new Hc({idx:t,terminalType:e,label:r?.LABEL});return i.definition.push(s),Ufe}}function kM(n,e,t,r=!1){HD(t);const i=ow(this.recordingProdStack),s=gb(e)?e:e.DEF,a=new n({definition:[],idx:t});return r&&(a.separator=e.SEP),hi(e,"MAX_LOOKAHEAD")&&(a.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(a),s.call(this),i.definition.push(a),this.recordingProdStack.pop(),rU}function Vqe(n,e){HD(e);const t=ow(this.recordingProdStack),r=ka(n)===!1,i=r===!1?n:n.DEF,s=new z_({definition:[],idx:e,ignoreAmbiguities:r&&n.IGNORE_AMBIGUITIES===!0});hi(n,"MAX_LOOKAHEAD")&&(s.maxLookahead=n.MAX_LOOKAHEAD);const a=gH(i,o=>gb(o.GATE));return s.hasPredicates=a,t.definition.push(s),wi(i,o=>{const l=new qm({definition:[]});s.definition.push(l),hi(o,"IGNORE_AMBIGUITIES")?l.ignoreAmbiguities=o.IGNORE_AMBIGUITIES:hi(o,"GATE")&&(l.ignoreAmbiguities=!0),this.recordingProdStack.push(l),o.ALT.call(this),this.recordingProdStack.pop()}),rU}function zJ(n){return n===0?"":`${n}`}function HD(n){if(n<0||n>FJ){const e=new Error(`Invalid DSL Method idx value: <${n}>
	Idx value must be a none negative value smaller than ${FJ+1}`);throw e.KNOWN_RECORDER_ERROR=!0,e}}class Gqe{initPerformanceTracer(e){if(hi(e,"traceInitPerf")){const t=e.traceInitPerf,r=typeof t=="number";this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=cb.traceInitPerf;this.traceInitIndent=-1}TRACE_INIT(e,t){if(this.traceInitPerf===!0){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(`${r}--> <${e}>`);const{time:i,value:s}=afe(t),a=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&a(`${r}<-- <${e}> time: ${i}ms`),this.traceInitIndent--,s}else return t()}}function $qe(n,e){e.forEach(t=>{const r=t.prototype;Object.getOwnPropertyNames(r).forEach(i=>{if(i==="constructor")return;const s=Object.getOwnPropertyDescriptor(r,i);s&&(s.get||s.set)?Object.defineProperty(n.prototype,i,s):n.prototype[i]=t.prototype[i]})})}const qD=yO(kE,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(qD);const cb=Object.freeze({recoveryEnabled:!1,maxLookahead:3,dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:vfe,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),VD=Object.freeze({recoveryValueFunc:()=>{},resyncEnabled:!0});var Hp;(function(n){n[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=10]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=11]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=12]="TOO_MANY_ALTS",n[n.CUSTOM_LOOKAHEAD_VALIDATION=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Hp||(Hp={}));let EH=class Bfe{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated.	\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",()=>{let e;this.selfAnalysisDone=!0;const t=this.className;this.TRACE_INIT("toFastProps",()=>{ofe(this)}),this.TRACE_INIT("Grammar Recording",()=>{try{this.enableRecording(),wi(this.definedRulesNames,i=>{const a=this[i].originalGrammarAction;let o;this.TRACE_INIT(`${i} Rule`,()=>{o=this.topLevelRuleRecord(i,a)}),this.gastProductionsCache[i]=o})}finally{this.disableRecording()}});let r=[];if(this.TRACE_INIT("Grammar Resolving",()=>{r=mqe({rules:_f(this.gastProductionsCache)}),this.definitionErrors=this.definitionErrors.concat(r)}),this.TRACE_INIT("Grammar Validations",()=>{if(Fl(r)&&this.skipValidations===!1){const i=gqe({rules:_f(this.gastProductionsCache),tokenTypes:_f(this.tokensMap),errMsgProvider:QS,grammarName:t}),s=eqe({lookaheadStrategy:this.lookaheadStrategy,rules:_f(this.gastProductionsCache),tokenTypes:_f(this.tokensMap),grammarName:t});this.definitionErrors=this.definitionErrors.concat(i,s)}}),Fl(this.definitionErrors)&&(this.recoveryEnabled&&this.TRACE_INIT("computeAllProdsFollows",()=>{const i=Wje(_f(this.gastProductionsCache));this.resyncFollows=i}),this.TRACE_INIT("ComputeLookaheadFunctions",()=>{var i,s;(s=(i=this.lookaheadStrategy).initialize)===null||s===void 0||s.call(i,{rules:_f(this.gastProductionsCache)}),this.preComputeLookaheadFunctions(_f(this.gastProductionsCache))})),!Bfe.DEFER_DEFINITION_ERRORS_HANDLING&&!Fl(this.definitionErrors))throw e=Ar(this.definitionErrors,i=>i.message),new Error(`Parser Definition Errors detected:
 ${e.join(`
-------------------------------
`)}`)})}constructor(e,t){this.definitionErrors=[],this.selfAnalysisDone=!1;const r=this;if(r.initErrorHandler(t),r.initLexerAdapter(),r.initLooksAhead(t),r.initRecognizerEngine(e,t),r.initRecoverable(t),r.initTreeBuilder(t),r.initContentAssist(),r.initGastRecorder(t),r.initPerformanceTracer(t),hi(t,"ignoredIssues"))throw new Error(`The <ignoredIssues> IParserConfig property has been deprecated.
	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.
	See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES
	For further details.`);this.skipValidations=hi(t,"skipValidations")?t.skipValidations:cb.skipValidations}};EH.DEFER_DEFINITION_ERRORS_HANDLING=!1;$qe(EH,[Sqe,wqe,Lqe,Uqe,Fqe,Bqe,zqe,jqe,qqe,Gqe]);class Wqe extends EH{constructor(e,t=cb){const r=Td(t);r.outputCst=!0,super(e,r)}}function Yqe(n){const e=new Xqe,t=_f(n);return Ar(t,r=>e.visitRule(r))}class Xqe extends rx{visitRule(e){const t=this.visitEach(e.definition),r=ife(t,s=>s.propertyName),i=Ar(r,(s,a)=>{const o=!gH(s,c=>!c.canBeNull);let l=s[0].type;return s.length>1&&(l=Ar(s,c=>c.type)),{name:a,type:l,optional:o}});return{name:e.name,properties:i}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:!0,type:GI(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0}).concat({propertyName:e.separator.name,canBeNull:!0,type:GI(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:!0})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:!1,type:GI(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:!1,type:GI(e)}]}visitEachAndOverrideWith(e,t){return Ar(this.visitEach(e),r=>Fm({},r,t))}visitEach(e){return Nm(Ar(e,t=>this.visit(t)))}}function GI(n){return n instanceof Hm?{kind:"rule",name:n.referencedRule.name}:{kind:"token"}}function Kqe(n,e){let t=[];return t=t.concat('import type { CstNode, ICstVisitor, IToken } from "chevrotain";'),t=t.concat(Nm(Ar(n,r=>Zqe(r)))),e.includeVisitorInterface&&(t=t.concat(tVe(e.visitorInterfaceName,n))),t.join(`

`)+`
`}function Zqe(n){const e=Qqe(n),t=Jqe(n);return[e,t]}function Qqe(n){const e=Ffe(n.name),t=xH(n.name);return`export interface ${e} extends CstNode {
  name: "${n.name}";
  children: ${t};
}`}function Jqe(n){return`export type ${xH(n.name)} = {
  ${Ar(n.properties,t=>eVe(t)).join(`
  `)}
};`}function eVe(n){const e=rVe(n.type);return`${n.name}${n.optional?"?":""}: ${e}[];`}function tVe(n,e){return`export interface ${n}<IN, OUT> extends ICstVisitor<IN, OUT> {
  ${Ar(e,t=>nVe(t)).join(`
  `)}
}`}function nVe(n){const e=xH(n.name);return`${n.name}(children: ${e}, param?: IN): OUT;`}function rVe(n){if(ka(n)){const e=Q4(Ar(n,r=>jJ(r)));return"("+jm(e,(r,i)=>r+" | "+i)+")"}else return jJ(n)}function jJ(n){return n.kind==="token"?"IToken":Ffe(n.name)}function Ffe(n){return Vue(n)+"CstNode"}function xH(n){return Vue(n)+"CstChildren"}const iVe={includeVisitorInterface:!0,visitorInterfaceName:"ICstNodeVisitor"};function sVe(n,e){const t=Object.assign(Object.assign({},iVe),e),r=Yqe(n);return Kqe(r,t)}const bO=ew(32,126).map(n=>String.fromCharCode(n));function _s(n){return $g({...n,name:`token_${n.name}`})}function un(n){return _s({name:n,pattern:new RegExp(n.toLowerCase(),"i"),longer_alt:bu})}const uk=_s({name:"newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),zfe=_s({name:"whitespace",pattern:/ +/,group:Ph.SKIPPED}),jfe=_s({name:"whitespace",pattern:/\s+/,line_breaks:!0,group:Ph.SKIPPED}),OE=_s({name:"stat",pattern:/@.*/,start_chars_hint:["@"]}),By=_s({name:"command",pattern:/#/,start_chars_hint:["#"]});let Hfe=!1;const aVe="@#/?':!",oVe=/^(by|at|away|toward|find|flee|to|cw|ccw|opp|rndp)/i;function lVe(n,e){if(!Hfe)return null;let t=e;const r=n[t-1]??"";if(t>0&&r!==" "&&r!==`
`)return null;if(n[t]===" "){for(;n[t]===" ";)t++;if(aVe.includes(n[t]))return null}for(;t>0&&`$"@#':!/?
`.includes(n[t])===!1;)t--;switch(n[t]){case"?":case"/":{const a=n.substring(t+1,e+1).toLowerCase();if(a.indexOf(" ")<1||oVe.test(a))return null;break}case"#":return null;case'"':{for(t--;t>0&&n[t]===" ";)t--;if(!(t<1||n[t]===`
`))return null;break}case"@":case"'":case":":case"!":return null}let i=e;for(n[i]==='"'&&++i;i<n.length&&n[i]!==`
`;)i++;const s=n.substring(e,i);return s.trim().length===0||s.toLowerCase()==="do"?null:[s]}const fk=_s({name:"text",pattern:lVe,line_breaks:!1,start_chars_hint:bO}),hk=_s({name:"comment",pattern:/'.*/,start_chars_hint:["'"]}),cw=_s({name:"label",pattern:/:[^;:\n]*/,start_chars_hint:[":"]}),dk=_s({name:"hyperlink",pattern:/![^;\n]*/,start_chars_hint:["!"]}),TH=_s({name:"hyperlinktext",pattern:/;[^;\n]*/,start_chars_hint:[";"]}),bu=_s({name:"stringliteral",pattern:/[^-0-9"!:;@#/?()\s]+[^-"!:;@#/?()\s]*/,start_chars_hint:bO}),x2=_s({name:"stringliteraldouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),GD=_s({name:"numberliteral",pattern:/-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?/}),qfe=un("isterrain"),Vfe=un("isobject"),Gfe=un("issolid"),$fe=un("iswalk"),Wfe=un("isswim"),Yfe=un("isbullet"),Xfe=un("isghost"),Kfe=un("iswalking"),Zfe=un("iswalkable"),Qfe=un("isswimming"),Jfe=un("isswimmable"),ehe=un("black"),the=un("dkblue"),nhe=un("dkgreen"),rhe=un("dkcyan"),ihe=un("dkred"),she=un("dkpurple"),ahe=un("dkyellow"),ohe=un("ltgray"),lhe=un("dkgray"),che=un("blue"),uhe=un("green"),fhe=un("cyan"),hhe=un("red"),dhe=un("purple"),phe=un("yellow"),mhe=un("white"),ghe=un("brown"),_he=un("dkwhite"),vhe=un("ltgrey"),yhe=un("gray"),bhe=un("grey"),She=un("dkgrey"),Ehe=un("ltblack"),xhe=un("onblack"),The=un("ondkblue"),whe=un("ondkgreen"),Rhe=un("ondkcyan"),Ahe=un("ondkred"),Che=un("ondkpurple"),Mhe=un("ondkyellow"),khe=un("onltgray"),Ohe=un("ondkgray"),Ihe=un("onblue"),Nhe=un("ongreen"),Phe=un("oncyan"),Dhe=un("onred"),Lhe=un("onpurple"),Uhe=un("onyellow"),Bhe=un("onwhite"),Fhe=un("onbrown"),zhe=un("ondkwhite"),jhe=un("onltgrey"),Hhe=un("ongray"),qhe=un("ongrey"),Vhe=un("ondkgrey"),Ghe=un("onltblack"),$he=un("onclear"),Whe=un("blblack"),Yhe=un("bldkblue"),Xhe=un("bldkgreen"),Khe=un("bldkcyan"),Zhe=un("bldkred"),Qhe=un("bldkpurple"),Jhe=un("bldkyellow"),ede=un("blltgray"),tde=un("bldkgray"),nde=un("blblue"),rde=un("blgreen"),ide=un("blcyan"),sde=un("blred"),ade=un("blpurple"),ode=un("blyellow"),lde=un("blwhite"),cde=un("blbrown"),ude=un("bldkwhite"),fde=un("blltgrey"),hde=un("blgray"),dde=un("blgrey"),pde=un("bldkgrey"),mde=un("blltblack"),gde=un("idle"),_de=un("up"),vde=un("down"),yde=un("left"),bde=un("right"),Sde=un("by"),Ede=un("at"),xde=un("flow"),Tde=un("seek"),wde=un("rndns"),Rde=un("rndne"),Ade=un("rnd"),Cde=un("cw"),Mde=un("ccw"),kde=un("opp"),Ode=un("rndp"),Ide=un("away"),Nde=un("toward"),Pde=un("find"),Dde=un("flee"),Lde=un("to"),Ude=un("i"),Bde=un("u"),Fde=un("north"),zde=un("n"),jde=un("d"),Hde=un("south"),qde=un("s"),Vde=un("l"),Gde=un("west"),$de=un("w"),Wde=un("r"),Yde=un("east"),Xde=un("e"),Kde=un("over"),Zde=un("under"),Qde=un("within"),Jde=un("awayby"),epe=_s({name:"expr_aligned",pattern:/aligned|alligned/i,longer_alt:bu}),tpe=un("contact"),npe=un("blocked"),rpe=un("any"),ipe=un("countof"),spe=un("abs"),ape=un("intceil"),ope=un("intfloor"),lpe=un("intround"),cpe=un("clamp"),upe=un("min"),fpe=un("max"),hpe=un("pick"),dpe=un("pickwith"),ppe=un("random"),mpe=un("randomwith"),gpe=un("run"),_pe=un("runwith"),vpe=_s({name:"stop",pattern:/\|/,start_chars_hint:["|"]}),wH=_s({name:"iseq",pattern:/=|is|eq|equal/i,longer_alt:bu}),RH=_s({name:"isnoteq",pattern:/!=|not ?eq|not ?equal/i,longer_alt:bu}),AH=_s({name:"islessthan",pattern:/<|below/i,longer_alt:bu}),CH=_s({name:"isgreaterthan",pattern:/>|above/i,longer_alt:bu}),MH=_s({name:"islessthanorequal",pattern:/<=|below ?or ?eq|below ?or ?equal/i,longer_alt:bu}),kH=_s({name:"isgreaterthanorequal",pattern:/>=|above ?or ?eq|above ?or ?equal/i,longer_alt:bu}),$D=_s({name:"or",pattern:/or/i,longer_alt:bu}),WD=_s({name:"not",pattern:/not/i,longer_alt:bu}),YD=_s({name:"and",pattern:/and/i,longer_alt:bu}),XD=_s({name:"plus",pattern:/\+/}),KD=_s({name:"minus",pattern:/-/}),OH=_s({name:"power",pattern:/\*\*/}),IH=_s({name:"multiply",pattern:/\*/}),lE=_s({name:"divide",pattern:/\//}),NH=_s({name:"moddivide",pattern:/%/}),PH=_s({name:"floordivide",pattern:/%%/}),pk=_s({name:"query",pattern:/\?/}),DH=_s({name:"lparen",pattern:/\(/,push_mode:"ignore_newlines"}),LH=_s({name:"rparen",pattern:/\)/,pop_mode:!0}),UH=_s({name:"command_play",pattern:/(play|bgplay|bgplayon64n|bgplayon32n|bgplayon16n|bgplayon8n|bgplayon4n|bgplayon2n|bgplayon1n) .*/i,start_chars_hint:bO,longer_alt:bu}),ype=_s({name:"command_toast",pattern:/toast .*/i,start_chars_hint:bO,longer_alt:bu}),bpe=_s({name:"command_ticker",pattern:/ticker .*/i,start_chars_hint:bO,longer_alt:bu}),cE=_s({name:"if",pattern:/if|try|take|give|duplicate/i,longer_alt:bu}),uE=_s({name:"do",pattern:new RegExp("(?<!(zap |send |restore ))(?<=\\s)do","i"),start_chars_hint:["d"],longer_alt:bu}),ZD=un("done"),fE=un("else"),BH=un("while"),FH=un("repeat"),zH=un("waitfor"),jH=_s({name:"foreach",pattern:/foreach|for/i,longer_alt:bu}),HH=un("break"),qH=un("continue");function Spe(n,e){return[...n,vde,...e,GD,qfe,Vfe,Gfe,Zfe,Kfe,$fe,Jfe,Qfe,Wfe,Yfe,Xfe,ehe,the,nhe,rhe,ihe,she,ahe,ohe,lhe,che,uhe,fhe,hhe,dhe,phe,mhe,ghe,_he,vhe,yhe,bhe,She,Ehe,xhe,The,whe,Rhe,Ahe,Che,Mhe,khe,Ohe,Ihe,Nhe,Phe,Dhe,Lhe,Uhe,Bhe,Fhe,zhe,jhe,Hhe,qhe,Vhe,Ghe,$he,Whe,Yhe,Xhe,Khe,Zhe,Qhe,Jhe,ede,tde,nde,rde,ide,sde,ade,ode,lde,cde,ude,fde,hde,dde,pde,mde,gde,_de,yde,bde,Sde,Ede,xde,Tde,Ode,wde,Rde,Ade,Cde,Mde,kde,Qde,Jde,Ide,Nde,Pde,Dde,Lde,Fde,Hde,Gde,Yde,Kde,Zde,epe,tpe,npe,rpe,ipe,spe,ape,ope,lpe,cpe,upe,fpe,dpe,hpe,mpe,ppe,_pe,gpe,vpe,wH,RH,MH,AH,kH,CH,$D,WD,YD,XD,KD,OH,IH,lE,PH,NH,pk,DH,LH,Ude,Bde,zde,jde,qde,Vde,$de,Wde,Xde,x2,bu]}const Epe=Spe([fk,OE,UH,ype,bpe,By,hk,cw,dk,TH,uk,zfe],[HH,qH,ZD,uE,fE,jH,cE,FH,zH,BH]),cVe=new Ph({defaultMode:"use_newlines",modes:{use_newlines:Epe,ignore_newlines:Spe([jfe],[])}},{skipValidations:!Fv,ensureOptimizations:Fv,positionTracking:"full"});function xpe(n){Hfe=!0;const e=cVe.tokenize(n||` 
`),[t]=(bi(e.tokens)?e.tokens:[]).slice(-1);return t&&t.tokenType.name!=="Newline"&&e.tokens.push(yO(uk,`
`,t.startOffset,t.endOffset??NaN,t.startLine??NaN,t.endLine??NaN,t.startColumn??NaN,t.endColumn??NaN)),e}function n9(n,e,t=!0){if(t){const[r,...i]=e;switch(qr(r??"")){default:return{type:hr.OBJECT,values:e};case"loader":return{type:hr.LOADER,values:i};case"board":return{type:hr.BOARD,values:i};case"object":return{type:hr.OBJECT,values:i};case"terrain":return{type:hr.TERRAIN,values:i};case"charset":return{type:hr.CHARSET,values:i};case"palette":return{type:hr.PALETTE,values:i}}}else{const[r,i,...s]=e,a=qr(i??""),o=[r,n,...s];switch(a){default:return{type:hr.CONST,values:e};case"rn":case"range":return{type:hr.RANGE,values:o};case"sl":case"select":return{type:hr.SELECT,values:o};case"nm":case"number":return{type:hr.NUMBER,values:o};case"tx":case"text":return{type:hr.TEXT,values:o};case"hk":case"hotkey":return{type:hr.HOTKEY,values:o};case"copyit":return{type:hr.COPYIT,values:o};case"openit":return{type:hr.OPENIT,values:o};case"zssedit":return{type:hr.ZSSEDIT,values:o};case"charedit":return{type:hr.CHAREDIT,values:o};case"coloredit":return{type:hr.COLOREDIT,values:o}}}}function e1(n){switch(n){case hr.LOADER:return"loader";case hr.BOARD:return"board";case hr.OBJECT:return"object";case hr.TERRAIN:return"terrain";case hr.CHARSET:return"charset";case hr.PALETTE:return"palette";case hr.CONST:return"const";case hr.RANGE:return"range";case hr.SELECT:return"select";case hr.NUMBER:return"number";case hr.TEXT:return"text";case hr.HOTKEY:return"hotkey";case hr.COPYIT:return"copyit";case hr.OPENIT:return"openit";case hr.VIEWIT:return"viewit";case hr.ZSSEDIT:return"zssedit";case hr.CHAREDIT:return"charedit";case hr.COLOREDIT:return"coloredit"}}function HJ(){return{id:vc()}}function yf(n){return n?.category===SE.ISOBJECT}function mk(n,e){if(!xe(n)||!Up(e))return;const{color:t,bg:r}=_ue(e);xe(t)&&(n.color=t),xe(r)&&(n.bg=r)}function uVe(n,e){return{id:vc(),code:n,...e}}function $I(n){const e={...SO(n)};return Object.keys(e).forEach(t=>{switch(t){case"type":case"name":delete e[t];break}}),e}function Tpe(n){const e=xpe(n),t={};let r=!0;for(let i=0;i<e.tokens.length;++i){const s=e.tokens[i];if(s.tokenType===OE){const a=s.image.slice(1),[o,l]=a.split(";").map(d=>d.trim()),c=o.split(" "),u=n9(Vn(l)?l:"",c,r),f=u.values.join(" ");switch(r=!1,u.type){case hr.LOADER:t.type=ni.LOADER,t.name=f;break;case hr.BOARD:t.type=ni.BOARD,t.name=f;break;case hr.OBJECT:t.type=ni.OBJECT,t.name=f||"object";break;case hr.TERRAIN:t.type=ni.TERRAIN,t.name=f;break;case hr.CHARSET:t.type=ni.CHARSET,t.name=f;break;case hr.PALETTE:t.type=ni.PALETTE,t.name=f;break;case hr.CONST:{const[d,...g]=u.values;if(Vn(d)){const p=qr(d),_=g.join(" ");if(Vn(_)){const y=parseFloat(_);t[p]=Mn(y)?y:_}else t[p]=1}break}case hr.RANGE:case hr.SELECT:case hr.NUMBER:case hr.TEXT:case hr.HOTKEY:case hr.ZSSEDIT:case hr.CHAREDIT:case hr.COLOREDIT:{const[d,...g]=u.values;if(Vn(d)){const p=qr(d);t[p]=[e1(u.type),...g]}break}}}}return t}function SO(n){return xe(n)?(xe(n.stats?.type)||(n.stats=Tpe(n.code),xe(n.stats.type)||(n.stats.type=ni.OBJECT)),n.stats):{}}function wpe(n){switch(n){default:case ni.ERROR:return"error";case ni.LOADER:return e1(hr.LOADER);case ni.BOARD:return e1(hr.BOARD);case ni.OBJECT:return e1(hr.OBJECT);case ni.TERRAIN:return e1(hr.TERRAIN);case ni.CHARSET:return e1(hr.CHARSET);case ni.PALETTE:return e1(hr.PALETTE)}}function C1(n){return SO(n).type??ni.ERROR}function Vx(n){return wpe(C1(n))}function Mh(n){return SO(n).name??""}function fVe(n,e){return SO(n)[e]}const WI=new cr;function hVe(n){if(!Vn(n))return;const e=ik(n);if(xe(e)&&xe(Sn[e]))return Sn[e];const t=qr(n),r=Hn[t];if(xe(r))return r}function r9(n,e){const t=Object.keys(n);for(let r=0;r<t.length;++r){const i=t[r],s=n[i];if(bi(s)){const[a,...o]=s;switch(a){case"text":xe(e[i])||(e[i]="");break;case"range":xe(e[i])||(e[i]=4);break;case"number":xe(e[i])||(e[i]=0);break;case"select":if(!xe(e[i])){const[,l]=o;e[i]=l}break}continue}switch(i){case"name":case"char":case"light":case"group":case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"cycle":case"stepx":case"stepy":case"shootx":case"shooty":case"displaychar":e[i]=s;break;case"color":case"bg":case"lightdir":case"displaycolor":case"displaybg":e[i]=hVe(s)??s;break;case"isitem":e.item=1;break;case"notitem":e.item=0;break;case"ispushable":e.pushable=s===""?1:s;break;case"notpushable":e.pushable=0;break;case"iswalk":case"iswalking":case"iswalkable":e.collision=Rr.ISWALK;break;case"isswim":case"isswimming":case"isswimable":e.collision=Rr.ISSWIM;break;case"issolid":e.collision=Rr.ISSOLID;break;case"isbullet":e.collision=Rr.ISBULLET;break;case"isghost":e.collision=Rr.ISGHOST;break;case"isbreakable":e.breakable=1;break;case"notbreakable":e.breakable=0;break}}}function Jf(n){if(xe(n))switch(C1(n)){default:return;case ni.ERROR:return n.code??"";case ni.LOADER:return n.code??"";case ni.BOARD:{xe(n.board)||(n.board=aU()),n.board.id=n.id,n.board.name=Mh(n);const e=$I(n);return xe(e.isdark)&&(n.board.isdark=1),xe(e.notdark)&&(n.board.isdark=0),Mn(e.startx)&&(n.board.startx=e.startx),Mn(e.starty)&&(n.board.starty=e.starty),Vn(e.over)&&(qr(e.over)==="empty"?n.board.over=void 0:n.board.over=e.over),Vn(e.under)&&(qr(e.under)==="empty"?n.board.under=void 0:n.board.under=e.under),Vn(e.camera)&&(qr(e.camera)==="empty"?n.board.camera=void 0:n.board.camera=e.camera),Vn(e.graphics)&&(qr(e.graphics)==="empty"?n.board.graphics=void 0:n.board.graphics=e.graphics),Mn(e.facing)&&(n.board.facing=e.facing),Vn(e.facing)&&qr(e.facing)==="empty"&&(n.board.facing=void 0),Vn(e.exitnorth)&&(n.board.exitnorth=e.exitnorth),Vn(e.exitsouth)&&(n.board.exitsouth=e.exitsouth),Vn(e.exitwest)&&(n.board.exitwest=e.exitwest),Vn(e.exiteast)&&(n.board.exiteast=e.exiteast),Mn(e.timelimit)&&(n.board.timelimit=e.timelimit),xe(e.restartonzap)&&(n.board.restartonzap=1),xe(e.norestartonzap)&&(n.board.restartonzap=0),Mn(e.maxplayershots)&&(n.board.maxplayershots=e.maxplayershots),n.board}case ni.OBJECT:return xe(n.object)||(n.object=HJ()),n.object.id=n.id,n.object.code=n.code,n.object.name=Mh(n),n.object.category=SE.ISOBJECT,r9($I(n),n.object),n.object;case ni.TERRAIN:return xe(n.terrain)||(n.terrain=HJ()),n.terrain.id=n.id,n.terrain.name=Mh(n),n.terrain.category=SE.ISTERRAIN,r9($I(n),n.terrain),n.terrain;case ni.PALETTE:{if(xe(n.palette)||(n.palette=QE(qw)),xe(n.palette?.bits)){const e=$I(n),t=sb(e);for(let r=0;r<t.length;++r){const i=t[r].toLowerCase(),s=e[i];if(i.startsWith("color")&&Vn(s)){const a=parseFloat(i.replace("color",""));if(a>=0&&a<=15){WI.set(s);const o=a*tw,l=WI.r*63,c=WI.g*63,u=WI.b*63;n.palette.bits[o+0]=Di(l,0,63),n.palette.bits[o+1]=Di(c,0,63),n.palette.bits[o+2]=Di(u,0,63)}}}}return n.palette}case ni.CHARSET:return xe(n.charset)||(n.charset=JE(Hw)),n.charset}}function Rpe(n){return{id:vc(),name:gle(),timestamp:0,activelist:[],pages:n,flags:{}}}function Ape(n){xe(n)&&(n.token=`${ZOe()}${Mg(1111,9999)}`)}function gk(n,e){if(!xe(n))return;const t=qr(e);return n.pages.find(i=>i.id===e||t===Mh(i))}function jg(n,e,t){if(!xe(n))return;const r=qr(t);return n.pages.find(s=>C1(s)===e&&(s.id===t||r===Mh(s)))}function i9(n,e,t){let r=jg(n,e,t);if(!xe(r)){const i=wpe(e);return r=uVe(i==="object"?`@${t||"object"}
`:`@${i} ${t}
`,{}),dVe(n,r),[r,!0]}return[r,!1]}function s9(n,e,t){if(!xe(n))return[];const r=qr(t);return n.pages.filter(s=>C1(s)===e).filter(s=>{const a=SO(s),o=qr(Mh(s));return s.id===t||r===o||xe(a[t])})}function OM(n){return xe(n)?Sl(n.pages).sort((t,r)=>{const i=C1(t),s=C1(r);return i===s?Mh(t).localeCompare(Mh(r)):s-i}):[]}function dVe(n,e){if(!xe(n)||!xe(e))return!1;const t=gk(n,e.id);return xe(t)?!1:(n.pages.push(e),Ape(n),!0)}function Cpe(n,e){const t=gk(n,e);if(xe(n)&&xe(t)){const r=qr(e);return n.pages=n.pages.filter(i=>i.id!==e&&r!==Mh(i)),Ape(n),t}}function Vm(n,e=1,t=Sn.WHITE,r=Sn.BLACK){const i=n?.kinddata;return{name:qr(n?.name??i?.name),char:n?.displaychar??i?.displaychar??n?.char??i?.char??e,color:n?.displaycolor??i?.displaycolor??n?.color??i?.color??t,bg:n?.displaybg??i?.displaybg??n?.bg??i?.bg??r,light:n?.light??i?.light??0}}function iU(n,e){return n?(n.flags[e]=n.flags[e]??{},n.flags[e]):{}}function pVe(n,e){n&&delete n.flags[e]}function QD(n,e,t){return iU(n,e)?.[t]}function a9(n,e,t,r){const i=iU(n,e);return i&&(i[t]=r),r}function sU(n,e){const t=n??Rr.ISWALK,r=e??Rr.ISWALK;if(t===Rr.ISGHOST||r===Rr.ISGHOST)return!1;switch(t){case Rr.ISWALK:return r!==Rr.ISWALK;case Rr.ISSWIM:return r!==Rr.ISSWIM;case Rr.ISSOLID:return!0;case Rr.ISBULLET:return r!==Rr.ISWALK&&r!==Rr.ISSWIM}}function _k(n,e,t){const r=n?.objects[t];if(xe(r))return r;const i=Gw(n,"player");return xe(e)?(e.x<0&&(e.x=Mg(0,Yn-1)),e.y<0&&(e.y=Mg(0,Ti-1)),kpe(e,i)):T0(...i)}function Gw(n,e){const t=n?.named?.[e];return xe(t)?[...t.values()].map(i=>typeof i=="string"?n?.objects[i]:n?.terrain[i]).filter(xe):[]}function mVe(n){const e=[];for(let t=0;t<Ti;++t)for(let r=0;r<Yn;++r){const i={x:r,y:t},s=Jo(n,i);!s?.name&&!s?.kind&&e.push(i)}return e}function o9(n,e,t,r){if(!xe(n))return!1;const i=Vm(n);return!(xe(e)&&e!==i.name||xe(t)&&t!==i.color||xe(r)&&r!==i.bg)}function JD(n,e){const t=sk(e),r=ID(e),i=vue(e);return Gw(n,t??"").filter(s=>o9(s,t,r,i))}function qJ(n,e){const t=xe(e)?MD(e):void 0,r=xe(e)?kD(e):void 0,i=[];if(xe(n)){for(let a=0;a<n.terrain.length;++a){const o=n.terrain[a];xe(o)&&o9(o,void 0,t,r)&&i.push(o)}const s=Object.values(n.objects);for(let a=0;a<s.length;++a){const o=s[a];o9(o,void 0,t,r)&&i.push(o)}}return i}function Mpe(n,e){return xe(n)?e.map(t=>{if(typeof t=="string"){const r=n.objects[t];if(xe(r))return r;const i=Gw(n,qr(t));if(i.length)return i}else if(aE(t)&&t.x>=0&&t.x<Yn&&t.y>=0&&t.y<Ti){const r=t.x+t.y*Yn,i=n.lookup?.[r];return xe(i)?n.objects[i]:n.terrain[r]}}).flat().filter(xe):[]}function kpe(n,e){let t=0,r;for(let i=0;i<e.length;++i){const s=e[i];if(s){const a=n.x-(s.x??0),o=n.y-(s.y??0),l=Math.sqrt(a*a+o*o);(r===void 0||l<t)&&(t=l,r=s)}}return r}function Bp(n){if(!xe(n)||xe(n.lookup)&&xe(n.named))return;const e=new Array(Yn*Ti).fill(void 0),t={},r=Object.values(n.objects);for(let a=0;a<r.length;++a){const o=r[a];if(xe(o.x)&&xe(o.y)&&xe(o.id)&&!xe(o.removed)&&$i(o,"collision")!==Rr.ISGHOST){o.category=SE.ISOBJECT,e[o.x+o.y*Yn]=o.id,Vn(o.code)&&!xe(o.name)&&r9(Tpe(o.code),o);const l=Vm(o);t[l.name]||(t[l.name]=new Set),t[l.name].add(o.id)}}let i=0,s=0;for(let a=0;a<n.terrain.length;++a){const o=n.terrain[a];if(xe(o)){o.x=i,o.y=s,o.category=SE.ISTERRAIN;const l=Vm(O1(o));t[l.name]||(t[l.name]=new Set),t[l.name].add(a)}++i,i>=Yn&&(i=0,++s)}n.lookup=e,n.named=t}function vk(n){xe(n)&&(delete n.named,delete n.lookup,Bp(n))}function l9(n,e,t){if(!xe(n)||!xe(n.named)||!xe(e))return;const r=qr(e.name??e.kinddata?.name??"");n.named[r]||(n.named[r]=new Set),n.named[r].add(e?.id??t??"")}function Ope(n,e){if(!(!xe(n)||!xe(n.lookup)||!xe(e?.id))&&!xe(e.removed)&&$i(e,"collision")!==Rr.ISGHOST){const t=e.x??0,r=e.y??0;n.lookup[t+r*Yn]=e.id}}function gVe(n,e){if(xe(n)&&xe(e?.x)&&xe(e.y)){const t=Vm(e),r=yk(n,e);xe(n.named?.[t.name])&&n.named[t.name].delete(r)}}function VH(n,e){if(xe(n)&&xe(e?.id)){if(xe(n.lookup)&&xe(e.x)&&xe(e.y)){const r=e.x+e.y*Yn;n.lookup[r]===e.id&&(n.lookup[r]=void 0)}const t=Vm(e);xe(n.named?.[t.name])&&xe(e.id)&&n.named[t.name].delete(e.id)}}function _Ve(n,e,t,r){if(!xe(n))return;xe(n.distmaps)||(n.distmaps={});const i=`${e}.${t.x}.${t.y}.${r.x}.${r.y}`;let s=n.distmaps[i];if(!xe(s)){s=new Array(b_).fill(-2);const a=[{...r}];let o=0;for(;a.length;){const l=a.shift();if(xe(l)&&uw(l)){const c=gf(l,Yn);if(s[c]===-2){const u=IE(n,l.x,l.y);sU(e,$i(u,"collision"))||(s[c]=o,a.push({x:l.x,y:l.y-1},{x:l.x,y:l.y+1},{x:l.x-1,y:l.y},{x:l.x+1,y:l.y})),++o}}}n.distmaps[i]=s}return s}function VJ(n,e){return uw(n)?e[gf(n,Yn)]:-1}function GJ(n,e,t,r,i){if(!xe(n))return;const s=_Ve(n,e,t,r);if(!xe(s))return;const a=[{x:t.x,y:t.y-1},{x:t.x,y:t.y+1},{x:t.x-1,y:t.y},{x:t.x+1,y:t.y}];let o;if(i){let l=i?0:1e4;for(let c=0;c<a.length;++c){const u=VJ(a[c],s);u>=0&&u>l&&(l=u,o=a[c])}}else{let l=1e5;for(let c=0;c<a.length;++c){const u=VJ(a[c],s);u>=0&&u<l&&(l=u,o=a[c])}}return o}function vVe(){return new Array(Yn*Ti).map(()=>{})}function aU(n=bm){const e={terrain:vVe(),objects:{},id:"",name:""};return n(e)}function uw(n){return kBe(n.x,n.y,0,Yn-1,Ti-1,0)}function yk(n,e){return!xe(n)||!xe(e?.x)||!xe(e?.y)||e.x<0||e.x>=Yn||e.y<0||e.y>=Ti?-1:e.x+e.y*Yn}function Jo(n,e){const t=yk(n,e);if(t<0||!xe(n?.lookup))return;const r=Ug(n,n.lookup[t]??"");return xe(r)?r:n.terrain[t]}function yVe(n,e){const t=Ug(n,e);if(xe(t))return t;const r=parseFloat(e),i=iw(isNaN(r)?-1:r,Yn);return IE(n,i.x,i.y)}function IE(n,e,t){return(e>=0&&e<Yn)??(t>=0&&t<Ti)?n?.terrain[e+t*Yn]:void 0}function Ed(n,e){if(!xe(n)||!xe(e)||!xe(e.x)||!xe(e.y)||e.x<0||e.x>=Yn||e.y<0||e.y>=Ti)return;const t=Sl(e),r=e.x+e.y*Yn;return n.terrain[r]=t,delete n.distmaps,n.terrain[r]}function bVe(n,e){if(!xe(n)||!xe(e))return;const t=Sl(e);return t.id=t.id??vc(),n.objects[t.id]=t,n.objects[t.id]}function SVe(n,e,t){return Ed(n,{...e,kind:t})}function Ipe(n,e,t,r){return bVe(n,{...e,kind:t,id:r})}function Ug(n,e){if(n)return n.objects[e]}function EVe(n){return xe(n)?[...Object.values(n.objects)]:[]}function $J(n,e){const t=yk(n,e);if(t<0||!xe(n?.lookup))return;const r=Ug(n,n.lookup[t]??"");if(xe(r))return r}function Bg(n,e,t){return!xe(e)||Vm(e).name==="player"?!1:(e.id?(e.removed=t,VH(n,e)):(Ed(n,{x:e?.x??0,y:e?.y??0}),gVe(n,e)),!0)}function xVe(n,e,t){if(!xe(n)||!xe(e))return;const r=n.objects[t];if(xe(r))return r;if(aE(e))return kpe(e,Gw(n,"player"))}function n2(n,e,t,r,i){const s=Hn.MID;if(!xe(n)||!xe(e))return{dir:r,startpt:i,destpt:i,layer:s,targets:[]};const a={x:e.x??0,y:e.y??0},o={x:a.x+(e.stepx??0),y:a.y+(e.stepy??0)},l=dv(a,o),c=Yn-1,u=Ti-1;for(let f=0;f<r.length;++f){const d=pue(r[f]);switch(d){case Hn.IDLE:break;case Hn.NORTH:case Hn.SOUTH:case Hn.WEST:case Hn.EAST:uu(a,d);break;case Hn.BY:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Di(a.x+g,0,c),a.y=Di(a.y+p,0,u)),f+=2;break}case Hn.TO:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Di(g,0,c),a.y=Di(p,0,u)),f+=2;break}case Hn.AT:{const[g,p]=r.slice(f+1);Mn(g)&&Mn(p)&&(a.x=Di(g,0,c),a.y=Di(p,0,u)),f+=2;break}case Hn.FLOW:uu(a,l);break;case Hn.SEEK:{const g=xVe(n,e,t);aE(g)&&uu(a,dv(i,g));break}case Hn.RNDNS:uu(a,T0(Hn.NORTH,Hn.SOUTH));break;case Hn.RNDNE:uu(a,T0(Hn.NORTH,Hn.EAST));break;case Hn.RND:uu(a,T0(Hn.NORTH,Hn.SOUTH,Hn.WEST,Hn.EAST));break;case Hn.CW:case Hn.CCW:case Hn.OPP:case Hn.RNDP:{const g=n2(n,e,t,r.slice(f+1),i);switch(a.x=i.x,a.y=i.y,d){case Hn.CW:switch(dv(i,g.destpt)){case Hn.NORTH:uu(a,Hn.EAST);break;case Hn.SOUTH:uu(a,Hn.WEST);break;case Hn.EAST:uu(a,Hn.SOUTH);break;case Hn.WEST:uu(a,Hn.NORTH);break}break;case Hn.CCW:switch(dv(i,g.destpt)){case Hn.NORTH:uu(a,Hn.WEST);break;case Hn.SOUTH:uu(a,Hn.EAST);break;case Hn.EAST:uu(a,Hn.NORTH);break;case Hn.WEST:uu(a,Hn.SOUTH);break}break;case Hn.OPP:switch(dv(i,g.destpt)){case Hn.NORTH:uu(a,Hn.SOUTH);break;case Hn.SOUTH:uu(a,Hn.NORTH);break;case Hn.EAST:uu(a,Hn.WEST);break;case Hn.WEST:uu(a,Hn.EAST);break}break;case Hn.RNDP:switch(dv(i,g.destpt)){case Hn.NORTH:case Hn.SOUTH:a.x+=T0(-1,1);break;case Hn.WEST:case Hn.EAST:a.y+=T0(-1,1);break}break}return{dir:r,startpt:i,destpt:a,layer:s,targets:[]}}case Hn.FLEE:break;case Hn.AWAY:{const[g,p]=r.slice(f+1);if(Mn(g)&&Mn(p)){const _={x:Di(g,0,c),y:Di(p,0,u)},y=_.x-a.x,v=_.y-a.y;if(Math.abs(y)>1||Math.abs(v)>1){const x=$i(e,"collision"),E=GJ(n,x,a,_,!0);xe(E)&&E.x!==g&&E.y!==p&&!$J(n,E)&&(a.x=E.x,a.y=E.y)}else{const x=ZS(-y,-v);uu(a,x)}}f+=2;break}case Hn.FIND:break;case Hn.TOWARD:{const[g,p]=r.slice(f+1);if(Mn(g)&&Mn(p)){const _={x:Di(g,0,c),y:Di(p,0,u)},y=_.x-a.x,v=_.y-a.y;if(Math.abs(y)>1||Math.abs(v)>1){const x=$i(e,"collision"),E=GJ(n,x,a,_,!1);xe(E)&&E.x!==g&&E.y!==p&&!$J(n,E)&&(a.x=E.x,a.y=E.y)}else{const x=ZS(y,v);uu(a,x)}}f+=2;break}case Hn.OVER:case Hn.UNDER:{const g=n2(n,e,t,r.slice(f+1),i);return g.layer=d,g}case Hn.WITHIN:{const[g]=r.slice(f+1),p=n2(n,e,t,r.slice(f+2),i);if(p.targets.length===0&&Mn(g)&&g>0)for(let _=-g;_<=g;++_)for(let y=-g;y<=g;++y){const v={x:p.destpt.x+y,y:p.destpt.y+_};uw(v)&&p.targets.push(v)}return Mn(g)&&g>0?{...p,targets:p.targets.filter(_=>aE(_)?kQ(_,p.destpt)<=g:!1)}:p}case Hn.AWAYBY:{const[g]=r.slice(f+1),p=n2(n,e,t,r.slice(f+2),i);if(p.targets.length===0)for(let _=-Yn;_<=Yn;++_)for(let y=-Yn;y<=Yn;++y){const v={x:p.destpt.x+y,y:p.destpt.y+_};uw(v)&&p.targets.push(v)}return Mn(g)&&g>0?{...p,targets:p.targets.filter(_=>aE(_)?kQ(_,p.destpt)>=g:!1)}:p}}}return{dir:r,startpt:i,destpt:a,layer:s,targets:[]}}function oU(n,e,t,r=!1){if(!xe(n)||!xe(n.lookup)||t.x<0||t.x>=Yn||t.y<0||t.y>=Ti)return;const i=t.x+t.y*Yn,s=Ug(n,n.lookup[i]??"404");if(xe(s))return r&&x0(s.id)?void 0:s;const a=n.terrain[i];if(xe(a)&&sU(e,$i(a,"collision")))return a}function TVe(n,e,t){const r=Ug(n,e?.id??""),i=r?.x??-1,s=r?.y??-1;if(i-t.x===0&&s-t.y===0)return!0;const a=$i(r,"collision");return xe(oU(n,a,t))}function c9(n,e,t){const r=Ug(n,e?.id??"");if(!xe(n)||!xe(r)||!xe(r.x)||!xe(r.y)||!xe(n.lookup)||t.x<0||t.x>=Yn||t.y<0||t.y>=Ti)return{name:"edge",kind:"edge",collision:Rr.ISSOLID,x:t.x,y:t.y};if(r.x-t.x===0&&r.y-t.y===0)return;const i=yk(n,r),s=yk(n,t),a=$i(r,"collision");if(a===Rr.ISGHOST){r.x=t.x,r.y=t.y;return}const o=x0(r?.id),l=Ug(n,n.lookup[s]??"");if($i(l,"collision")===Rr.ISGHOST)return;const c=x0(l?.id??"");if(xe(l)&&(!o||!c))return{...l};const u=n.terrain[s],f=u?.collision??u?.kinddata?.collision??Rr.ISWALK;if(sU(a,f))return{...u,x:t.x,y:t.y};r.x=t.x,r.y=t.y,xe(r.removed)||(n.lookup[i]=void 0,n.lookup[s]=r.id??"")}function Npe(n,e,t){const r=[],i=[];if(!xe(n))return{objectelements:r,terrainelements:i};function s(o,l){switch(t){case"all":return!0;case"self":return o?.id===e;case"others":return o?.id!==e;case"terrain":return l===!0;case"object":return l===!1}const c=$i(o,t);return xe(c)||Vm(o).name===t||$i(o,"group")===t}const a=Object.values(n.objects);for(let o=0;o<a.length;++o){const l=a[o];s(l,!1)&&r.push(l)}for(let o=0;o<b_;++o){const l=n.terrain[o];xe(l)&&s(l,!0)&&i.push(l)}return{objectelements:r,terrainelements:i}}const Ppe={isterrain:"ISTERRAIN",isobject:"ISOBJECT"};function bk(n){return bi(n)&&Dpe(n[0])}function Dpe(n){return xe(SE[n])&&Vn(n)}function Lpe(n){if(Vn(n))return Ppe[qr(n)]}function WJ(n){if(bk(n))return n;if(Dpe(n))return[n];const e=Lpe(n);if(xe(e))return[e]}function wVe(n){const e=Oe.words[n],t=WJ(e);if(bk(t))return[t,n+1];const[r,i]=Ap(n),s=WJ(r);return bk(s)?[s,i]:[void 0,n]}const Upe={issolid:"ISSOLID",iswalk:"ISWALK",isswim:"ISSWIM",isbullet:"ISBULLET",isghost:"ISGHOST",iswalking:"ISWALK",iswalkable:"ISWALK",isswimming:"ISSWIM",isswimmable:"ISSWIM"};Rr.ISSOLID,Rr.ISWALK,Rr.ISSWIM,Rr.ISBULLET,Rr.ISGHOST,Rr.ISWALK,Rr.ISSWIM;function eL(n){return bi(n)&&u9(n[0])}function u9(n){return xe(Rr[n])&&Vn(n)}function RVe(n){if(Vn(n))return Upe[qr(n)]}function AVe(n){const e=Oe.words[n];if(eL(e))return[e,n+1];if(u9(e))return[[e],n+1];const[t,r]=Ap(n);return eL(t)?[t,r]:u9(t)?[[t],r]:[void 0,n]}function Gx(n,e=0){const t=[];let r=n;for(;r<Oe.words.length;){const[i,s]=Ap(r);if(bi(i)&&!F0(i)&&!bk(i)&&!eL(i)&&!Up(i)&&t.push(...i),i==="|")return[t,s];if(r=s,t.push(i),e>0&&t.length>=e)return[t,r]}return[t,r]}function Ap(n){const e=Oe.words[n],t=n+1;if(Lpe(e)){const[r,i]=wVe(n);if(xe(r))return[r,i]}if(RVe(e)){const[r,i]=AVe(n);if(xe(r))return[r,i]}if(ik(e)){const[r,i]=OD(n);if(xe(r))return[r,i]}if(Vn(e)&&qr(e)==="rnd"){const[r,i]=Ap(t),[s,a]=Ap(i);return Mn(r)&&Mn(s)?[Mg(r,s),a]:Mn(r)?[Mg(0,r),i]:[Mg(0,1),t]}if(U4(e)){const[r,i]=mue(n);if(xe(r))return[r,i]}if(!xe(e))return[void 0,n];if(Mn(e)||bi(e))return[e,t];if(Vn(e)){const r=qr(e),i=Oe.get?.(e);if(xe(i))return[i,t];switch(r){case"aligned":case"alligned":{const s=_k(Oe.board,{x:Oe.element?.x??-1,y:Oe.element?.y??-1},Oe.elementfocus);return!xe(Oe.element)||!xe(s)?[0,t]:[Oe.element.x===s.x||Oe.element.y===s.y?1:0,t]}case"contact":{const s=_k(Oe.board,{x:Oe.element?.x??-1,y:Oe.element?.y??-1},Oe.elementfocus);if(!xe(Oe.element)||!xe(s))return[0,t];const a=(s.x??0)-(Oe.element?.x??0),o=(s.y??0)-(Oe.element?.y??0);return[a===0&&Math.abs(o)<2||o===0&&Math.abs(a)<2?1:0,t]}case"blocked":{const[s,a]=ln(Oe.words,t,[Dt.DIR]);return[TVe(Oe.board,Oe.element,s.destpt)?1:0,a]}case"any":{const[s]=ln(Oe.words,t,[Dt.ANY]);if(F0(s)){const[c,u,f]=ln(Oe.words,t,[Dt.DIR,Dt.COLOR_OR_KIND]);if(c.targets.length){const[g,p]=u,_=[];for(let y=0;y<c.targets.length;++y){const v=c.targets[y],x=["any","at",v.x,v.y,p,g].filter(M=>M!==void 0),[E]=ln(x,0,[Dt.ANY]);bi(E)&&E.length&&_.push(...E)}return[_,f]}const d=c.layer===Hn.MID?Jo(Oe.board,c.destpt):IE(Oe.board,c.destpt.x,c.destpt.y);if(xe(d)){const g=Vm(d);if(Up(u))return[MD(u)===g.color||kD(u)===g.bg?[d]:[],f];const p=qr(sk(u)),_=ID(u);if((p.length&&p!==g.name||xe(_)&&_!==g.color)===!1)return[[d],f]}return[[],f]}const[a,o]=ln(Oe.words,t,[Dt.COLOR_OR_KIND]);return Up(a)?[qJ(Oe.board,a),o]:[JD(Oe.board,a),o]}case"countof":{const[s]=ln(Oe.words,t,[Dt.ANY]);if(F0(s)){const[c,u,f]=ln(Oe.words,t,[Dt.DIR,Dt.COLOR_OR_KIND]);if(c.targets.length){let g=0;const[p,_]=u;for(let y=0;y<c.targets.length;++y){const v=c.targets[y],x=["countof","at",v.x,v.y,_,p].filter(M=>M!==void 0),[E]=ln(x,0,[Dt.ANY]);Mn(E)&&(g+=E)}return[g,f]}const d=c.layer===Hn.MID?Jo(Oe.board,c.destpt):IE(Oe.board,c.destpt.x,c.destpt.y);if(xe(d)){const g=Vm(d);if(Up(u))return[MD(u)===g.color||kD(u)===g.bg?1:0,f];const p=qr(sk(u)),_=ID(u),y=p.length?p===g.name:!0,v=xe(_)?_===g.color:!0;if(y&&v)return[1,f]}return[0,f]}const[a,o]=ln(Oe.words,t,[Dt.COLOR_OR_KIND]);return Up(a)?[qJ(Oe.board,a).length,o]:[JD(Oe.board,a).length,o]}case"rnd":return[Mg(0,1),t];case"abs":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER]);return[Math.abs(s),a]}case"intceil":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER]);return[Math.ceil(s),a]}case"intfloor":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER]);return[Math.floor(s),a]}case"intround":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER]);return[Math.round(s),a]}case"clamp":{const[s,a,o,l]=ln(Oe.words,t,[Dt.NUMBER,Dt.NUMBER,Dt.NUMBER]);return[Di(s,a,o),l]}case"min":{const[s,a]=Gx(t);return[Math.min(...s),a]}case"max":{const[s,a]=Gx(t);return[Math.max(...s),a]}case"pick":{const[s,a]=Gx(t);return[T0(s),a]}case"pickwith":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER_OR_STRING]),[o,l]=Gx(a);return[tBe(`${s}`,o),l]}case"random":{const[s,a]=Gx(t,2),[o,l]=s;return[Mg(o,l??0),a]}case"randomwith":{const[s,a]=ln(Oe.words,t,[Dt.NUMBER_OR_STRING]),[o,l]=Gx(a,2),[c,u]=o;return[Joe(`${s}`,c,u??0),l]}case"run":{const[s,a]=ln(Oe.words,t,[Dt.NAME]);return hL(s),[Oe.get?.("arg"),a]}case"runwith":{const[s,a,o]=ln(Oe.words,t,[Dt.ANY,Dt.NAME]);return xe(Oe.element)&&(Oe.element.arg=s),hL(a),[Oe.get?.("arg"),o]}}}return[e,t]}const Oe={timestamp:0,book:void 0,board:void 0,element:void 0,elementid:"",elementisplayer:!1,elementfocus:"",words:[],get:void 0};var Dt=(n=>(n[n.COLOR=0]="COLOR",n[n.KIND=1]="KIND",n[n.DIR=2]="DIR",n[n.NAME=3]="NAME",n[n.NUMBER=4]="NUMBER",n[n.STRING=5]="STRING",n[n.NUMBER_OR_STRING=6]="NUMBER_OR_STRING",n[n.COLOR_OR_KIND=7]="COLOR_OR_KIND",n[n.MAYBE_KIND=8]="MAYBE_KIND",n[n.MAYBE_NAME=9]="MAYBE_NAME",n[n.MAYBE_NUMBER=10]="MAYBE_NUMBER",n[n.MAYBE_STRING=11]="MAYBE_STRING",n[n.MAYBE_NUMBER_OR_STRING=12]="MAYBE_NUMBER_OR_STRING",n[n.ANY=13]="ANY",n))(Dt||{});function Th(n,e,t){throw console.info(t,Oe.element,Oe.elementid,Oe.elementfocus),new Error(`Invalid arg, expected: ${n} but got ${JSON.stringify(e)}`)}function YJ(n){const e={x:Oe.element?.x??0,y:Oe.element?.y??0};return n2(Oe.board,Oe.element,Oe.elementfocus,n,e)}function ln(n,e,t){const r=Oe.words;Oe.words=n;const i=[];let s=e;for(let a=0;a<t.length;++a)switch(t[a]){case 1:{const[o,l]=pB(s);oE(o)?(s=l,i.push(o)):Th("kind",o,n);break}case 0:{if(ik(n[s])===void 0){const[o,l]=Ap(s);Up(o)?(s=l,i.push(o)):Mn(o)?(s=l,i.push(F4(o,void 0))):Th("color",o,n)}else{const[o,l]=OD(s);Up(o)?(s=l,i.push(o)):Th("color",o,n)}break}case 2:{if(U4(n[s])===void 0){const[o,l]=Ap(s);F0(o)?(s=l,i.push(YJ(o))):Th("direction",o,n)}else{const[o,l]=mue(s);F0(o)?(s=l,i.push(YJ(o))):Th("direction",o,n)}break}case 3:{const o=Oe.words[s];Vn(o)||Th("string",o,n),++s,i.push(o);break}case 4:{const[o,l]=Ap(s);if(Vn(o)){const c=parseFloat(o);Mn(c)?i.push(c):Th("number",o,n)}else Mn(o)?i.push(o):Th("number",o,n);s=l;break}case 5:{const[o,l]=Ap(s);Vn(o)||Th("string",o,n),s=l,i.push(o);break}case 6:{const[o,l]=Ap(s);let c=o;if(Vn(c)){const u=parseFloat(c);Mn(u)&&(c=u)}else Mn(c)||Th("number or string",c,n);s=l,i.push(c);break}case 7:{const[o,l]=pB(s);if(oE(o))s=l,i.push(o);else if(ik(n[s])===void 0){const[c,u]=Ap(s);Up(c)?(s=u,i.push(c)):Th("color",c,n)}else{const[c,u]=OD(s);Up(c)?(s=u,i.push(c)):Th("color or kind",c,n)}break}case 8:{const[o,l]=pB(s);o!==void 0&&!oE(o)&&Th("optional kind",o,n),s=l,i.push(o);break}case 9:{const o=Oe.words[s];o!==void 0&&!Vn(o)&&Th("optional string",o,n),++s,i.push(o);break}case 10:{const[o,l]=Ap(s);if(Vn(o)){const c=parseFloat(o);Mn(c)?i.push(c):Th("optional number",o,n)}else Mn(o)||o===void 0?i.push(o):Th("optional number",o,n);s=l;break}case 11:{const[o,l]=Ap(s);o!==void 0&&!Vn(o)&&Th("optional string",o,n),s=l,i.push(o);break}case 12:{const[o,l]=Ap(s);let c=o;if(Vn(c)){const u=parseFloat(c);Mn(u)&&(c=u)}else c!==void 0&&!Mn(c)&&Th("number or string",c,n);s=l,i.push(c);break}case 13:{const[o,l]=Ap(s);s=l,i.push(o);break}}return Oe.words=r,[...i,s]}function xm(n,e,t,r){const[i,s]=ln(r,0,[Dt.NUMBER_OR_STRING,Dt.MAYBE_NUMBER_OR_STRING]);ile(xt,n,e,t,i,s)}const CVe=["echo","reverb","phaser","distortion","vibrato","fc","fcrush","autowah"];function GH(n,e,t){const[r,i]=ln(t,0,[Dt.NUMBER_OR_STRING]);if(Mn(r))H6(xt,n,e,"volume",r);else if(CVe.includes(qr(r))){const[s,a]=ln(t,i,[Dt.NUMBER_OR_STRING,Dt.MAYBE_NUMBER_OR_STRING]);ile(xt,n,e,r,s,a)}else{const[s]=ln(t,i,[Dt.MAYBE_NUMBER_OR_STRING]);if(Mn(s)){const a=t.length-i,o=new Array(a).fill(Dt.NUMBER),l=ln(t,i,o).slice(0,a),c=l.length===1?l[0]:l;H6(xt,n,e,r,c)}else{const[a]=ln(t,i,[Dt.MAYBE_NUMBER_OR_STRING]);H6(xt,n,e,r,a)}}}function qb(n,e){const[t]=ln(n,0,[Dt.MAYBE_NAME]);Qke(xt,Oe.elementfocus,Oe.board?.id??"",t??"",e)}const lU=mb().command("tts",(n,e)=>{const[t,r]=ln(e,0,[Dt.STRING,Dt.STRING]);return Xke(xt,Oe.elementfocus,t,r),0}).command("ttsqueue",(n,e)=>{const[t,r]=ln(e,0,[Dt.STRING,Dt.STRING]);return Kke(xt,Oe.elementfocus,t,r),0}).command("bpm",(n,e)=>{const[t]=ln(e,0,[Dt.NUMBER]);return Jke(xt,Oe.elementfocus,t),0}).command("vol",(n,e)=>{const[t]=ln(e,0,[Dt.NUMBER]);return eOe(xt,Oe.elementfocus,t),0}).command("bgvol",(n,e)=>{const[t]=ln(e,0,[Dt.NUMBER]);return tOe(xt,Oe.elementfocus,t),0}).command("ttsvol",(n,e)=>{const[t]=ln(e,0,[Dt.NUMBER]);return nOe(xt,Oe.elementfocus,t),0}).command("play",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]);return Zke(xt,Oe.elementfocus,Oe.board?.id??"",t??""),0}).command("bgplay",(n,e)=>(qb(e,""),0)).command("bgplayon64n",(n,e)=>(qb(e,"@64n"),0)).command("bgplayon32n",(n,e)=>(qb(e,"@32n"),0)).command("bgplayon16n",(n,e)=>(qb(e,"@16n"),0)).command("bgplayon8n",(n,e)=>(qb(e,"@8n"),0)).command("bgplayon4n",(n,e)=>(qb(e,"@4n"),0)).command("bgplayon2n",(n,e)=>(qb(e,"@2n"),0)).command("bgplayon1n",(n,e)=>(qb(e,"@1m"),0)).command("synth",(n,e)=>{for(let t=0;t<4;++t)GH(Oe.elementfocus,t,e);return 0}).command("synthrecord",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_STRING]);return rOe(xt,Oe.elementfocus,t??""),0}).command("synthflush",()=>(iOe(xt,Oe.elementfocus),0)).command("echo",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"echo",e);return 0}).command("fcrush",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"fc",e);return 0}).command("phaser",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"phaser",e);return 0}).command("reverb",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"reverb",e);return 0}).command("distort",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"distort",e);return 0}).command("vibrato",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"vibrato",e);return 0}).command("autowah",(n,e)=>{for(let t=0;t<2;++t)xm(Oe.elementfocus,t,"autowah",e);return 0});for(let n=0;n<4;++n)lU.command(`synth${n+1}`,(e,t)=>(GH(Oe.elementfocus,n,t),0));lU.command("synth5",(n,e)=>{for(let t=4;t<8;++t)GH(Oe.elementfocus,t,e);return 0});for(let n=0;n<3;++n){const e=n+1;lU.command(`echo${e}`,(t,r)=>(xm(Oe.elementfocus,n,"echo",r),0)).command(`fcrush${e}`,(t,r)=>(xm(Oe.elementfocus,n,"fcrush",r),0)).command(`phaser${e}`,(t,r)=>(xm(Oe.elementfocus,n,"phaser",r),0)).command(`reverb${e}`,(t,r)=>(xm(Oe.elementfocus,n,"reverb",r),0)).command(`distort${e}`,(t,r)=>(xm(Oe.elementfocus,n,"distort",r),0)).command(`vibrato${e}`,(t,r)=>(xm(Oe.elementfocus,n,"vibrato",r),0)).command(`autowah${e}`,(t,r)=>(xm(Oe.elementfocus,n,"autowah",r),0))}function XJ(n,e,t,r){for(let i=t.y;i<=r.y;++i)for(let s=t.x;s<=r.x;++s){const a=Jo(e,{x:s,y:i});yf(a)&&Bg(e,a,n.timestamp),Ed(e,{x:s,y:i})}}function MVe(n,e,t){for(let r=e.y;r<=t.y;++r)for(let i=e.x;i<=t.x;++i)Ed(n,{x:i,y:r})}function KJ(n,e,t,r){for(let i=t.y;i<=r.y;++i)for(let s=t.x;s<=r.x;++s){const a=Jo(e,{x:s,y:i});yf(a)&&Bg(e,a,n.timestamp),Ed(e,{x:s,y:i})}}function NE(n,e){xe(n)&&(n.name=e.name,n.char=e.char,n.color=e.color,n.bg=e.bg,n.displaychar=e.displaychar,n.displaycolor=e.displaycolor,n.displaybg=e.displaybg,n.p1=e.p1,n.p2=e.p2,n.p3=e.p3,n.p4=e.p4,n.p5=e.p5,n.p6=e.p6,n.code=e.code,n.item=e.item,n.group=e.group,n.party=e.party,n.cycle=e.cycle,n.light=e.light,n.lightdir=e.lightdir,n.stepx=e.stepx,n.stepy=e.stepy,n.shootx=e.shootx,n.shooty=e.shooty,n.pushable=e.pushable,n.collision=e.collision,n.breakable=e.breakable,n.tickertext=e.tickertext,n.tickertime=e.tickertime)}function cU(n,e,t,r,i){switch(i){case"all":case"object":case"terrain":break;default:return kVe(n,e,t,"",i)}if(!xe(Oe.book))return;const s=Oe.book,a=jg(s,ni.BOARD,n),o=Jf(a);if(!xe(o))return;const l=jg(s,ni.BOARD,e),c=Jf(l);if(!xe(c))return;Bp(o),Bp(c);let u=!1;if(xe(o)&&xe(c)){switch(i){case"all":XJ(s,c,t,r);break;case"object":KJ(s,c,t,r);break;case"terrain":MVe(c,t,r);break;default:u=!0;break}for(let f=t.y;f<=r.y;++f)for(let d=t.x;d<=r.x;++d){let g=!1,p=!1;switch(i){case"all":g=!0,p=!0;break;case"object":g=!0;break;case"terrain":p=!0;break}const _={x:d,y:f};let y,v=Jo(o,_);if(yf(v)?(y=IE(o,d,f),x0(v?.id)&&(v=void 0)):(y=v,v=void 0),xe(y)&&(p||u&&$i(y,"group")===i)){u&&XJ(s,c,_,_);const x=D0(c,[y.kind??""],_);NE(x,y)}if(xe(v)&&(g||u&&$i(v,"group")===i)){u&&KJ(s,c,_,_);const x=D0(c,[v.kind??""],_);NE(x,v)}}vk(c)}}function kVe(n,e,t,r,i){if(!xe(Oe.book))return;const s=Oe.book,a=jg(s,ni.BOARD,n),o=Jf(a);if(!xe(o))return;const l=jg(s,ni.BOARD,e),c=Jf(l);if(xe(c)&&(Bp(o),Bp(c),xe(o)&&xe(c))){const{terrainelements:u,objectelements:f}=Npe(o,r,i);if(u.length===0&&f.length===0)return;const d={x:Yn,y:Ti};for(let g=0;g<u.length;++g){const p=u[g];Mn(p.x)&&(d.x=Math.min(d.x,p.x)),Mn(p.y)&&(d.y=Math.min(d.y,p.y))}for(let g=0;g<f.length;++g){const p=f[g];Mn(p.x)&&(d.x=Math.min(d.x,p.x)),Mn(p.y)&&(d.y=Math.min(d.y,p.y))}for(let g=0;g<u.length;++g){const p=u[g],_={x:t.x+(p.x??0)-d.x,y:t.y+(p.y??0)-d.y},y=Jo(c,_);xe(y)&&(yf(y)&&Bg(c,y,s.timestamp),Ed(c,_));const v=D0(c,[p.kind??""],_);NE(v,p)}for(let g=0;g<f.length;++g){const p=f[g],_={x:t.x+(p.x??0)-d.x,y:t.y+(p.y??0)-d.y},y=D0(c,[p.kind??""],_);NE(y,p)}vk(c)}}function pu(n){return`${n??""}`}function vd(n,e){const t=parseFloat(pu(n));return isNaN(t)?e:t}function Fp(n,e){return typeof n==typeof e?n:e}function OVe(n,e,t){if(!xe(n))return;a9(n,e,"board",t);const r=Pp(t);xe(r)?n.activelist.includes(e)||n.activelist.push(e):n.activelist=n.activelist.filter(i=>i!==e)}function _T(n,e,t,r,i=!1){const s=pet(e);if(!xe(n)||!xe(s))return;const a=Ug(s,e);if(!yf(a)||!a?.id)return;const o=Pp(t);if(!xe(o))return;Bp(o);const l=oU(o,Rr.ISWALK,r,!0);if(i===!1&&xe(l))if($i(l,"item"))zu(e,a,l,"touch");else return;VH(s,a),delete s.objects[a.id],a.x=r.x,a.y=r.y,o.objects[a.id]=a,l9(o,a),Ope(o,a),a9(n,e,"enterx",r.x),a9(n,e,"entery",r.y),OVe(n,e,o.id)}function IVe(n){const t=(n?.activelist??[]).map(r=>{const i=QD(n,r,"board");return Vn(i)?i:""});return nBe(t)}function Bpe(n){const e=IVe(n),t=new Set,r=[];for(let i=0;i<e.length;++i){const s=Pp(e[i]);if(xe(s)&&!t.has(s.id)){if(Vn(s.over))if(Vn(s.overboard)){const a=Pp(s.overboard);xe(a)?t.has(a.id)||r.push(a):delete s.overboard}else{const a=Pp(s.over);xe(a)&&(s.overboard=a.id)}else Vn(s.overboard)&&delete s.overboard;if(r.push(s),Vn(s.under))if(Vn(s.underboard)){const a=Pp(s.underboard);xe(a)||delete s.underboard}else{const a=Pp(s.under);xe(a)&&(s.underboard=a.id)}else Vn(s.underboard)&&delete s.underboard}}return r}const NVe=ew(32,126).map(n=>String.fromCharCode(n)),Fpe=$g({name:"Whitespace",pattern:/ +/}),PVe=$g({name:"WhitespaceSkipped",pattern:/ +/,group:Ph.SKIPPED}),uU=$g({name:"Newline",line_breaks:!0,start_chars_hint:[`
`,"\r"],pattern:/\n|\r\n?/}),fU=$g({name:"StringLiteral",pattern:/[^ $;\r\n]+/,start_chars_hint:NVe}),hU=$g({name:"StringLiteralDouble",pattern:/"(?:[^\\"]|\\(?:[^\n\r]|u[0-9a-fA-F]{4}))*"/}),dU=$g({name:"EscapedDollar",pattern:"$$"}),pU=$g({name:"MaybeFlag",pattern:/\$[^-0-9"!;@#/?\s]+[^-"!;@#/?\s]*/}),mU=$g({name:"NumberLiteral",pattern:/\$-?(\d*\.)?\d+([eE][+-]?\d+)?[jJ]?[lL]?\+?/}),gU=$g({name:"HyperLinkText",pattern:/;[^;\r\n]*/,start_chars_hint:[";"]});function DVe(n,e=""){return $g({name:e||n,pattern:new RegExp(n.toLowerCase(),"i")})}const LVe=Object.keys(B4),zpe=LVe.map(n=>DVe(`\\$(${n})`,n)),UVe=[Fpe,uU,...zpe,hU,fU,mU,dU,gU,pU],BVe=new Ph(UVe,{skipValidations:!Fv,ensureOptimizations:Fv}),FVe=new Ph([PVe,uU,...zpe,hU,fU,mU,dU,gU,pU],{skipValidations:!Fv,ensureOptimizations:Fv}),ZJ=/\$CENTER/i;function $H(n){if(ZJ.test(n))return n.replace(ZJ,"")}function EO(n,e=!1){return e?FVe.tokenize(n):BVe.tokenize(n)}function yb(n,e,t,r,i,s,a,o){return{disablewrap:!1,measureonly:!1,measuredwidth:0,writefullwidth:void 0,x:0,y:0,iseven:!0,active:{color:t,bg:r,topedge:i,leftedge:s,rightedge:a,bottomedge:o},reset:{color:t,bg:r,topedge:i,leftedge:s,rightedge:a,bottomedge:o},width:n,height:e,char:[],color:[],bg:[],changed(){}}}function WH(n){n.active={...n.reset}}function YH(n,e){const t=e.y;function r(){++e.x;const o=e.active.rightedge??e.width-1;!e.disablewrap&&e.x>o&&(e.x=e.active.leftedge??0,++e.y),e.x>e.measuredwidth&&(e.measuredwidth=e.x)}function i(){return e.x>=(e.active.leftedge??0)&&e.x<=(e.active.rightedge??e.width-1)&&e.y>=(e.active.topedge??0)&&e.y<=(e.active.bottomedge??e.height-1)}function s(o){for(let l=0;l<o.length;++l){if(e.measureonly!==!0&&i()){const c=e.x+e.y*e.width;e.char[c]=o.charCodeAt(l),e.active.color!==void 0&&(e.color[c]=e.active.color),e.active.bg!==void 0&&(e.bg[c]=e.active.bg)}r()}}for(let o=0;o<n.length;++o){const l=n[o];switch(l.tokenType){case dU:s("$");break;case mU:if(e.measureonly!==!0&&i()){const c=e.x+e.y*e.width;e.char[c]=parseFloat(l.image.replace("$","")),e.active.color!==void 0&&(e.color[c]=e.active.color),e.active.bg!==void 0&&(e.bg[c]=e.active.bg)}r();break;case hU:s(l.image.substring(1,l.image.length-1).replaceAll('\\"','"'));break;case uU:{e.x=e.active.leftedge??0,++e.y;break}default:{const c=l.tokenType.name,u=B4[c],f=IBe(Sn[u]),d=Kj(Sn[u]);u==="ONCLEAR"?(e.active.color=e.reset.color,e.active.bg=e.reset.bg):xe(f)?e.active.color=f:xe(d)?e.active.bg=d:s(l.image);break}}}e.x>e.measuredwidth&&(e.measuredwidth=e.x+1);const a=e.active.leftedge??0;if(xe(e.writefullwidth)&&(e.x>a||e.y===t)){const l=(e.active.rightedge??e.width-1)-e.x;if(l>0){WH(e);const c=String.fromCharCode(e.writefullwidth).repeat(l),u=e.x+e.y*e.width;fw(u,u+c.length,e.active.color,e.active.bg,e),_U(u,c,e)}}}function ci(n,e,t){const r=EO(n);r.tokens&&(YH(r.tokens,e),t&&WH(e),e.changed())}function QJ(n){const e=EO(n);if(!e.tokens)return"";const t=e.tokens.filter(r=>{switch(r.tokenType){case Fpe:case uU:case hU:case fU:case mU:case dU:case gU:case pU:return!0;default:return!1}}).map(r=>r.image).join("");return t.trim().length===0?"":t}function W1(n,e,t){const r=EO(n);if(!r.tokens)return;const i=yb(e,t,Sn.WHITE,Sn.BLACK);return i.measureonly=!0,YH(r.tokens,i),i.x>0&&++i.y,i}function _U(n,e,t){let r=0;const i=n+e.length;for(let s=n;s<i;++s)t.char[s]=e.charCodeAt(r++);t.changed()}function fw(n,e,t,r,i){const s=Math.min(n,e),a=Math.max(n,e);for(let o=s;o<=a;++o)i.color[o]=t,i.bg[o]=r;i.changed()}function zVe(n,e,t,r){const i=Math.min(n,e),s=Math.max(n,e);for(let a=i;a<=s;++a)r.bg[a]=t;r.changed()}function h0(n,e,t,r,i,s,a){const o=Math.min(t,r),l=Math.max(t,r);if(o>e||l<0)return;const c=Math.max(0,o),u=Math.min(e,l);fw(n+c,n+u,i,s,a)}function JJ(n,e,t,r,i,s){const a=Math.min(t,r),o=Math.max(t,r);if(a>e||o<0)return;const l=Math.max(0,a),c=Math.min(e,o);zVe(n+l,n+c,i,s)}function f9(n,e,t){const r=yO(fU,n,0,0,0,0,0,0);YH([r],e),t&&WH(e),e.changed()}function W0(n){const e=n.reset.leftedge??0,t=n.reset.rightedge??n.width-1,r=n.reset.topedge??0,i=n.reset.bottomedge??n.height-1,s=t-e+1,a=i-r+1;return{left:e,right:t,top:r,bottom:i,width:s,height:a}}function YI(n,e,t){if(!xe(Oe.element?.x)||!xe(Oe.element.y))return 0;if(Oe.elementisplayer){const o=Oe.board?.maxplayershots??0;if(o>0&&EVe(Oe.board).filter(c=>!c.removed&&x0(c.party)&&$i(c,"collision")===Rr.ISBULLET).length>=o)return n.set("didshoot",0),n.yield(),0}const[r,i]=ln(e,0,[Dt.DIR,Dt.MAYBE_KIND]);Oe.element.shootx=Di(r.destpt.x-r.startpt.x,-1,1),Oe.element.shooty=Di(r.destpt.y-r.startpt.y,-1,1);const s=i??["bullet"],a=fet(Oe.board,s,{x:Oe.element.x,y:Oe.element.y});if(xe(a)){xe(t)&&(a.arg=t),a.cycle=1,a.party=Oe.elementid,a.collision=Rr.ISBULLET,a.breakable=1,a.stepx=r.destpt.x-Oe.element.x,a.stepy=r.destpt.y-Oe.element.y,a.bg=Sn.ONCLEAR;const o=O1(a),l=a.code??o?.code??"";get(Oe.book,Oe.board,a,l)}return Oe.elementisplayer&&n.set("didshoot",xe(a)?1:0),n.yield(),0}function r2(n,e,t){if(!aE(Oe.element)||!xe(Oe.book)||!xe(Oe.board)||!xe(Oe.element))return 0;const[r,i]=ln(n,0,[Dt.DIR,Dt.KIND]);if(r.targets.length){for(let d=0;d<r.targets.length;++d){const g=r.targets[d];r2(["at",g.x,g.y,...i],e,t)}return 0}const{destpt:s}=r;if(s.x<0||s.x>=Yn||s.y<0||s.y>=Ti)return 0;const[a]=i,o={x:Oe.element?.x??0,y:Oe.element?.y??0},l=O1({kind:a}),c=$i(l,"collision");if(c===Rr.ISGHOST)return D0(Oe.board,i,r.destpt,e),0;let u=Jo(Oe.board,r.destpt);if($i(u,"pushable")){const d=Sl(r.destpt),g=uu(d,dv(o,d));S_(Oe.book,Oe.board,u,g),u=Jo(Oe.board,r.destpt)}if(a==="empty")return Bg(Oe.board,u,Oe.timestamp),0;if(yf(u)&&Bg(Oe.board,u,Oe.timestamp),yf(l)||D0(Oe.board,i,r.destpt,e),yf(l)){const d=oU(Oe.board,c,r.destpt);if(!xe(d)){const g=D0(Oe.board,i,r.destpt,e);xe(g)&&xe(t)&&(g.arg=t)}}return 0}function XI(n,e,t){if(!xe(Oe.book)||!xe(Oe.board))return 1;const[r,i]=ln(e,0,[Dt.DIR,Dt.DIR]),s=Jo(Oe.board,r.destpt);if(xe(s)&&xe(s.kind)){const a=$i(s,"collision"),o=oU(Oe.board,a,i.destpt);if(xe(o))return 1;const l=D0(Oe.board,[s.kind],i.destpt);if(!xe(l))return 1;NE(l,s),xe(t)&&(l.arg=t)}else return 1;return 0}const jVe={x:0,y:0},HVe={x:Yn-1,y:Ti-1},qVe="all",VVe=mb().command("build",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board)||!xe(Oe.element))return 0;const[t,r]=ln(e,0,[Dt.NAME,Dt.MAYBE_STRING]),i=aU();if(xe(i)){if(Vn(r)){const s=Pp(r);xe(s)&&cU(s.id,i.id,jVe,HVe,qVe)}n.set(t,i.id)}return 0}).command("goto",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.STRING]),[i,s]=ln(e,r,[Dt.MAYBE_NUMBER,Dt.MAYBE_NUMBER]),a=Pp(t);if(!xe(a))return 0;const o={x:i??a.startx??Math.round(Yn*.5),y:s??a.starty??Math.round(Ti*.5)},l=Vm(Oe.element);if(l.name!=="player"){const c=$i(Oe.element,"color"),u=$i(Oe.element,"bg"),f=F4(c,u),d=JD(a,[l.name,f]),[g]=d.sort((p,_)=>{const y=p.y??1e4,v=_.y??1e4,x=y-v;if(x!==0)return x;const E=p.x??1e4,M=_.x??1e4;return E-M});xe(g)&&Mn(g.x)&&Mn(g.y)&&(o.x=g.x,o.y=g.y)}return _T(Oe.book,Oe.elementfocus,a.id,o,!0),0}).command("transport",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board)||!xe(Oe.element))return 0;const[t]=ln(e,0,[Dt.STRING]),r=Ug(Oe.board,t);if(xe(Oe.element?.x)&&xe(Oe.element.y)&&xe(r?.x)&&xe(r.y)){let i=!0;const s={x:Oe.element.x,y:Oe.element.y},a=s.x-r.x,o=s.y-r.y;if($i(Oe.element,"shootx")!==a||$i(Oe.element,"shooty")!==o)return 0;for(;i&&(s.x+=a,s.y+=o,!(s.x<0&&s.x>=Yn&&s.y<0&&s.y>=Ti));){const l=Jo(Oe.board,s);l?.kind===Oe.element.kind&&$i(l,"shootx")===-a&&$i(l,"shooty")===-o&&S_(Oe.book,Oe.board,r,{x:s.x+a,y:s.y+o})&&(i=!1)}}return 0}).command("shove",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.DIR,Dt.DIR]),i=Jo(Oe.board,t.destpt);if(yf(i)){const s=t.destpt.x+(r.destpt.x-r.startpt.x),a=t.destpt.y+(r.destpt.y-r.startpt.y);S_(Oe.book,Oe.board,i,{x:s,y:a})}return 0}).command("duplicate",XI).command("duplicatewith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return XI(e.slice(r),t)}).command("dupe",XI).command("dupewith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return XI(e.slice(r),t)}).command("write",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r,i]=ln(e,0,[Dt.DIR,Dt.COLOR]),s=e.slice(i).map(pu).join(" "),{color:a,bg:o}=_ue(r),l=W1(s,256,1)?.measuredwidth??1,c=yb(256,1,a??Sn.WHITE,o??Sn.BLACK);ci(s,c,!1);const u=l-1;switch(dv(t.startpt,t.destpt)){case Hn.EAST:for(let d=0;d<l;++d)Ed(Oe.board,{x:t.destpt.x+d,y:t.destpt.y,name:"text",char:c.char[d],color:c.color[d],bg:c.bg[d]});break;case Hn.WEST:for(let d=0;d<l;++d)Ed(Oe.board,{x:t.destpt.x+d-u,y:t.destpt.y,name:"text",char:c.char[d],color:c.color[d],bg:c.bg[d]});break;case Hn.NORTH:for(let d=0;d<l;++d)Ed(Oe.board,{x:t.destpt.x,y:t.destpt.y+d-u,name:"text",char:c.char[d],color:c.color[d],bg:c.bg[d]});break;case Hn.SOUTH:for(let d=0;d<l;++d)Ed(Oe.board,{x:t.destpt.x,y:t.destpt.y+d,name:"text",char:c.char[d],color:c.color[d],bg:c.bg[d]});break}return 0}).command("change",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.KIND,Dt.KIND]);(sk(t)??"")==="empty"&&mVe(Oe.board).forEach(l=>{D0(Oe.board,r,l)});const s=sk(r),a=ID(r),o=vue(r);return JD(Oe.board,t).forEach(l=>{if(xe(a)&&(l.color=a),xe(o)&&(l.bg=o),Vm(l).name!==s){const u=$i(l,"color"),f=$i(l,"bg");if(Bg(Oe.board,l,Oe.timestamp),s!=="empty"){const d={x:l.x??0,y:l.y??0},g=D0(Oe.board,r,d);xe(g)&&(g.color=u,g.bg=f)}}}),0}).command("put",(n,e)=>r2(e)).command("putwith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return r2(e.slice(r),void 0,t)}).command("oneof",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return xe(Oe.board)&&Ug(Oe.board,t)?0:r2(e.slice(r),t)}).command("oneofwith",(n,e)=>{const[t,r,i]=ln(e,0,[Dt.ANY,Dt.ANY]);return xe(Oe.board)&&Ug(Oe.board,r)?0:r2(e.slice(i),r,t)}).command("shoot",YI).command("shootwith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return YI(n,e.slice(r),t)}).command("throwstar",(n,e)=>YI(n,[...e,"star"])).command("throwstarwith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY]);return YI(n,[...e.slice(r),"star"],t)}),R_=()=>new Map,h9=n=>{const e=R_();return n.forEach((t,r)=>{e.set(r,t)}),e},Y1=(n,e,t)=>{let r=n.get(e);return r===void 0&&n.set(e,r=t()),r},GVe=(n,e)=>{const t=[];for(const[r,i]of n)t.push(e(i,r));return t},$Ve=(n,e)=>{for(const[t,r]of n)if(e(r,t))return!0;return!1},hw=()=>new Set,wB=n=>n[n.length-1],WVe=(n,e)=>{for(let t=0;t<e.length;t++)n.push(e[t])},PE=Array.from,YVe=(n,e)=>{for(let t=0;t<n.length;t++)if(e(n[t],t,n))return!0;return!1},d9=Array.isArray;class jpe{constructor(){this._observers=R_()}on(e,t){return Y1(this._observers,e,hw).add(t),t}once(e,t){const r=(...i)=>{this.off(e,r),t(...i)};this.on(e,r)}off(e,t){const r=this._observers.get(e);r!==void 0&&(r.delete(t),r.size===0&&this._observers.delete(e))}emit(e,t){return PE((this._observers.get(e)||R_()).values()).forEach(r=>r(...t))}destroy(){this._observers=R_()}}const M1=Math.floor,KN=Math.abs,Hpe=(n,e)=>n<e?n:e,ix=(n,e)=>n>e?n:e,qpe=n=>n!==0?n<0:1/n<0,eee=1,tee=2,RB=4,AB=8,Sk=32,Zy=64,Fg=128,vU=31,p9=63,hE=127,XVe=2147483647,Vpe=Number.MAX_SAFE_INTEGER,KVe=Number.isInteger||(n=>typeof n=="number"&&isFinite(n)&&M1(n)===n),ZVe=n=>n.toLowerCase(),QVe=/^\s*/g,JVe=n=>n.replace(QVe,""),eGe=/([A-Z])/g,nee=(n,e)=>JVe(n.replace(eGe,t=>`${e}${ZVe(t)}`)),tGe=n=>{const e=unescape(encodeURIComponent(n)),t=e.length,r=new Uint8Array(t);for(let i=0;i<t;i++)r[i]=e.codePointAt(i);return r},Ek=typeof TextEncoder<"u"?new TextEncoder:null,nGe=n=>Ek.encode(n),rGe=Ek?nGe:tGe;let T2=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});T2&&T2.decode(new Uint8Array).length===1&&(T2=null);class xO{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const yU=()=>new xO,iGe=n=>{let e=n.cpos;for(let t=0;t<n.bufs.length;t++)e+=n.bufs[t].length;return e},Rv=n=>{const e=new Uint8Array(iGe(n));let t=0;for(let r=0;r<n.bufs.length;r++){const i=n.bufs[r];e.set(i,t),t+=i.length}return e.set(new Uint8Array(n.cbuf.buffer,0,n.cpos),t),e},sGe=(n,e)=>{const t=n.cbuf.length;t-n.cpos<e&&(n.bufs.push(new Uint8Array(n.cbuf.buffer,0,n.cpos)),n.cbuf=new Uint8Array(ix(t,e)*2),n.cpos=0)},Ah=(n,e)=>{const t=n.cbuf.length;n.cpos===t&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(t*2),n.cpos=0),n.cbuf[n.cpos++]=e},m9=Ah,Fa=(n,e)=>{for(;e>hE;)Ah(n,Fg|hE&e),e=M1(e/128);Ah(n,hE&e)},XH=(n,e)=>{const t=qpe(e);for(t&&(e=-e),Ah(n,(e>p9?Fg:0)|(t?Zy:0)|p9&e),e=M1(e/64);e>0;)Ah(n,(e>hE?Fg:0)|hE&e),e=M1(e/128)},g9=new Uint8Array(3e4),aGe=g9.length/3,oGe=(n,e)=>{if(e.length<aGe){const t=Ek.encodeInto(e,g9).written||0;Fa(n,t);for(let r=0;r<t;r++)Ah(n,g9[r])}else Eg(n,rGe(e))},lGe=(n,e)=>{const t=unescape(encodeURIComponent(e)),r=t.length;Fa(n,r);for(let i=0;i<r;i++)Ah(n,t.codePointAt(i))},CT=Ek&&Ek.encodeInto?oGe:lGe,bU=(n,e)=>{const t=n.cbuf.length,r=n.cpos,i=Hpe(t-r,e.length),s=e.length-i;n.cbuf.set(e.subarray(0,i),r),n.cpos+=i,s>0&&(n.bufs.push(n.cbuf),n.cbuf=new Uint8Array(ix(t*2,s)),n.cbuf.set(e.subarray(i)),n.cpos=s)},Eg=(n,e)=>{Fa(n,e.byteLength),bU(n,e)},KH=(n,e)=>{sGe(n,e);const t=new DataView(n.cbuf.buffer,n.cpos,e);return n.cpos+=e,t},cGe=(n,e)=>KH(n,4).setFloat32(0,e,!1),uGe=(n,e)=>KH(n,8).setFloat64(0,e,!1),fGe=(n,e)=>KH(n,8).setBigInt64(0,e,!1),ree=new DataView(new ArrayBuffer(4)),hGe=n=>(ree.setFloat32(0,n),ree.getFloat32(0)===n),xk=(n,e)=>{switch(typeof e){case"string":Ah(n,119),CT(n,e);break;case"number":KVe(e)&&KN(e)<=XVe?(Ah(n,125),XH(n,e)):hGe(e)?(Ah(n,124),cGe(n,e)):(Ah(n,123),uGe(n,e));break;case"bigint":Ah(n,122),fGe(n,e);break;case"object":if(e===null)Ah(n,126);else if(d9(e)){Ah(n,117),Fa(n,e.length);for(let t=0;t<e.length;t++)xk(n,e[t])}else if(e instanceof Uint8Array)Ah(n,116),Eg(n,e);else{Ah(n,118);const t=Object.keys(e);Fa(n,t.length);for(let r=0;r<t.length;r++){const i=t[r];CT(n,i),xk(n,e[i])}}break;case"boolean":Ah(n,e?120:121);break;default:Ah(n,127)}};class iee extends xO{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&Fa(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}const see=n=>{n.count>0&&(XH(n.encoder,n.count===1?n.s:-n.s),n.count>1&&Fa(n.encoder,n.count-2))};class ZN{constructor(){this.encoder=new xO,this.s=0,this.count=0}write(e){this.s===e?this.count++:(see(this),this.count=1,this.s=e)}toUint8Array(){return see(this),Rv(this.encoder)}}const aee=n=>{if(n.count>0){const e=n.diff*2+(n.count===1?0:1);XH(n.encoder,e),n.count>1&&Fa(n.encoder,n.count-2)}};class CB{constructor(){this.encoder=new xO,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(aee(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return aee(this),Rv(this.encoder)}}class dGe{constructor(){this.sarr=[],this.s="",this.lensE=new ZN}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){const e=new xO;return this.sarr.push(this.s),this.s="",CT(e,this.sarr.join("")),bU(e,this.lensE.toUint8Array()),Rv(e)}}const k1=n=>new Error(n),Nv=()=>{throw k1("Method unimplemented")},zv=()=>{throw k1("Unexpected case")},Gpe=k1("Unexpected end of array"),$pe=k1("Integer out of Range");class SU{constructor(e){this.arr=e,this.pos=0}}const $w=n=>new SU(n),pGe=n=>n.pos!==n.arr.length,mGe=(n,e)=>{const t=new Uint8Array(n.arr.buffer,n.pos+n.arr.byteOffset,e);return n.pos+=e,t},xg=n=>mGe(n,Ws(n)),dw=n=>n.arr[n.pos++],Ws=n=>{let e=0,t=1;const r=n.arr.length;for(;n.pos<r;){const i=n.arr[n.pos++];if(e=e+(i&hE)*t,t*=128,i<Fg)return e;if(e>Vpe)throw $pe}throw Gpe},ZH=n=>{let e=n.arr[n.pos++],t=e&p9,r=64;const i=(e&Zy)>0?-1:1;if((e&Fg)===0)return i*t;const s=n.arr.length;for(;n.pos<s;){if(e=n.arr[n.pos++],t=t+(e&hE)*r,r*=128,e<Fg)return i*t;if(t>Vpe)throw $pe}throw Gpe},gGe=n=>{let e=Ws(n);if(e===0)return"";{let t=String.fromCodePoint(dw(n));if(--e<100)for(;e--;)t+=String.fromCodePoint(dw(n));else for(;e>0;){const r=e<1e4?e:1e4,i=n.arr.subarray(n.pos,n.pos+r);n.pos+=r,t+=String.fromCodePoint.apply(null,i),e-=r}return decodeURIComponent(escape(t))}},_Ge=n=>T2.decode(xg(n)),MT=T2?_Ge:gGe,QH=(n,e)=>{const t=new DataView(n.arr.buffer,n.arr.byteOffset+n.pos,e);return n.pos+=e,t},vGe=n=>QH(n,4).getFloat32(0,!1),yGe=n=>QH(n,8).getFloat64(0,!1),bGe=n=>QH(n,8).getBigInt64(0,!1),SGe=[n=>{},n=>null,ZH,vGe,yGe,bGe,n=>!1,n=>!0,MT,n=>{const e=Ws(n),t={};for(let r=0;r<e;r++){const i=MT(n);t[i]=Tk(n)}return t},n=>{const e=Ws(n),t=[];for(let r=0;r<e;r++)t.push(Tk(n));return t},xg],Tk=n=>SGe[127-dw(n)](n);class oee extends SU{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),pGe(this)?this.count=Ws(this)+1:this.count=-1),this.count--,this.s}}class QN extends SU{constructor(e){super(e),this.s=0,this.count=0}read(){if(this.count===0){this.s=ZH(this);const e=qpe(this.s);this.count=1,e&&(this.s=-this.s,this.count=Ws(this)+2)}return this.count--,this.s}}class MB extends SU{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const e=ZH(this),t=e&1;this.diff=M1(e/2),this.count=1,t&&(this.count=Ws(this)+2)}return this.s+=this.diff,this.count--,this.s}}class EGe{constructor(e){this.decoder=new QN(e),this.str=MT(this.decoder),this.spos=0}read(){const e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}const xGe=crypto.getRandomValues.bind(crypto),Wpe=()=>xGe(new Uint32Array(1))[0],TGe="10000000-1000-4000-8000"+-1e11,wGe=()=>TGe.replace(/[018]/g,n=>(n^Wpe()&15>>n/4).toString(16)),RGe=Date.now,lee=n=>new Promise(n);Promise.all.bind(Promise);const cee=n=>n===void 0?null:n;class AGe{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}}let Ype=new AGe,CGe=!0;try{typeof localStorage<"u"&&localStorage&&(Ype=localStorage,CGe=!1)}catch{}const MGe=Ype,kGe=Object.assign,OGe=Object.keys,IGe=(n,e)=>{for(const t in n)e(n[t],t)},uee=n=>OGe(n).length,NGe=n=>{for(const e in n)return!1;return!0},PGe=(n,e)=>{for(const t in n)if(!e(n[t],t))return!1;return!0},DGe=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),LGe=(n,e)=>n===e||uee(n)===uee(e)&&PGe(n,(t,r)=>(t!==void 0||DGe(e,r))&&e[r]===t),UGe=Object.freeze,Xpe=n=>{for(const e in n){const t=n[e];(typeof t=="object"||typeof t=="function")&&Xpe(n[e])}return UGe(n)},JH=(n,e,t=0)=>{try{for(;t<n.length;t++)n[t](...e)}finally{t<n.length&&JH(n,e,t+1)}},BGe=n=>n,FGe=(n,e)=>e.includes(n);var Kpe={};const wk=typeof xl<"u"&&xl.release&&/node|io\.js/.test(xl.release.name)&&Object.prototype.toString.call(typeof xl<"u"?xl:0)==="[object process]";let iv;const zGe=()=>{if(iv===void 0)if(wk){iv=R_();const n=xl.argv;let e=null;for(let t=0;t<n.length;t++){const r=n[t];r[0]==="-"?(e!==null&&iv.set(e,""),e=r):e!==null&&(iv.set(e,r),e=null)}e!==null&&iv.set(e,"")}else typeof location=="object"?(iv=R_(),(location.search||"?").slice(1).split("&").forEach(n=>{if(n.length!==0){const[e,t]=n.split("=");iv.set(`--${nee(e,"-")}`,t),iv.set(`-${nee(e,"-")}`,t)}})):iv=R_();return iv},_9=n=>zGe().has(n),tL=n=>cee(wk?Kpe[n.toUpperCase().replaceAll("-","_")]:MGe.getItem(n)),Zpe=n=>_9("--"+n)||tL(n)!==null;Zpe("production");const jGe=wk&&FGe(Kpe.FORCE_COLOR,["true","1","2"]),HGe=jGe||!_9("--no-colors")&&!Zpe("no-color")&&(!wk||xl.stdout.isTTY)&&(!wk||_9("--color")||tL("COLORTERM")!==null||(tL("TERM")||"").includes("color")),qGe=n=>new Uint8Array(n),VGe=n=>{const e=qGe(n.byteLength);return e.set(n),e};class GGe{constructor(e,t){this.left=e,this.right=t}}const Ty=(n,e)=>new GGe(n,e);typeof DOMParser<"u"&&new DOMParser;const $Ge=n=>GVe(n,(e,t)=>`${t}:${e};`).join(""),bb=Symbol,Qpe=bb(),Jpe=bb(),WGe=bb(),YGe=bb(),XGe=bb(),eme=bb(),KGe=bb(),eq=bb(),ZGe=bb(),QGe=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[];let r=0;for(;r<n.length;r++){const i=n[r];if(i===void 0)break;if(i.constructor===String||i.constructor===Number)e.push(i);else if(i.constructor===Object)break}for(r>0&&t.push(e.join(""));r<n.length;r++){const i=n[r];i instanceof Symbol||t.push(i)}return t},JGe={[Qpe]:Ty("font-weight","bold"),[Jpe]:Ty("font-weight","normal"),[WGe]:Ty("color","blue"),[XGe]:Ty("color","green"),[YGe]:Ty("color","grey"),[eme]:Ty("color","red"),[KGe]:Ty("color","purple"),[eq]:Ty("color","orange"),[ZGe]:Ty("color","black")},e$e=n=>{n.length===1&&n[0]?.constructor===Function&&(n=n[0]());const e=[],t=[],r=R_();let i=[],s=0;for(;s<n.length;s++){const a=n[s],o=JGe[a];if(o!==void 0)r.set(o.left,o.right);else{if(a===void 0)break;if(a.constructor===String||a.constructor===Number){const l=$Ge(r);s>0||l.length>0?(e.push("%c"+a),t.push(l)):e.push(a)}else break}}for(s>0&&(i=t,i.unshift(e.join("")));s<n.length;s++){const a=n[s];a instanceof Symbol||i.push(a)}return i},tme=HGe?e$e:QGe,t$e=(...n)=>{console.log(...tme(n)),rme.forEach(e=>e.print(n))},nme=(...n)=>{console.warn(...tme(n)),n.unshift(eq),rme.forEach(e=>e.print(n))},rme=hw(),ime=n=>({[Symbol.iterator](){return this},next:n}),n$e=(n,e)=>ime(()=>{let t;do t=n.next();while(!t.done&&!e(t.value));return t}),kB=(n,e)=>ime(()=>{const{done:t,value:r}=n.next();return{done:t,value:t?void 0:e(r)}});class tq{constructor(e,t){this.clock=e,this.len=t}}class Ww{constructor(){this.clients=new Map}}const pw=(n,e,t)=>e.clients.forEach((r,i)=>{const s=n.doc.store.clients.get(i);if(s!=null){const a=s[s.length-1],o=a.id.clock+a.length;for(let l=0,c=r[l];l<r.length&&c.clock<o;c=r[++l])dme(n,s,c.clock,c.len,t)}}),r$e=(n,e)=>{let t=0,r=n.length-1;for(;t<=r;){const i=M1((t+r)/2),s=n[i],a=s.clock;if(a<=e){if(e<a+s.len)return i;t=i+1}else r=i-1}return null},TO=(n,e)=>{const t=n.clients.get(e.client);return t!==void 0&&r$e(t,e.clock)!==null},nq=n=>{n.clients.forEach(e=>{e.sort((i,s)=>i.clock-s.clock);let t,r;for(t=1,r=1;t<e.length;t++){const i=e[r-1],s=e[t];i.clock+i.len>=s.clock?i.len=ix(i.len,s.clock+s.len-i.clock):(r<t&&(e[r]=s),r++)}e.length=r})},v9=n=>{const e=new Ww;for(let t=0;t<n.length;t++)n[t].clients.forEach((r,i)=>{if(!e.clients.has(i)){const s=r.slice();for(let a=t+1;a<n.length;a++)WVe(s,n[a].clients.get(i)||[]);e.clients.set(i,s)}});return nq(e),e},Rk=(n,e,t,r)=>{Y1(n.clients,e,()=>[]).push(new tq(t,r))},i$e=()=>new Ww,s$e=n=>{const e=i$e();return n.clients.forEach((t,r)=>{const i=[];for(let s=0;s<t.length;s++){const a=t[s];if(a.deleted){const o=a.id.clock;let l=a.length;if(s+1<t.length)for(let c=t[s+1];s+1<t.length&&c.deleted;c=t[++s+1])l+=c.length;i.push(new tq(o,l))}}i.length>0&&e.clients.set(r,i)}),e},Yw=(n,e)=>{Fa(n.restEncoder,e.clients.size),PE(e.clients.entries()).sort((t,r)=>r[0]-t[0]).forEach(([t,r])=>{n.resetDsCurVal(),Fa(n.restEncoder,t);const i=r.length;Fa(n.restEncoder,i);for(let s=0;s<i;s++){const a=r[s];n.writeDsClock(a.clock),n.writeDsLen(a.len)}})},rq=n=>{const e=new Ww,t=Ws(n.restDecoder);for(let r=0;r<t;r++){n.resetDsCurVal();const i=Ws(n.restDecoder),s=Ws(n.restDecoder);if(s>0){const a=Y1(e.clients,i,()=>[]);for(let o=0;o<s;o++)a.push(new tq(n.readDsClock(),n.readDsLen()))}}return e},fee=(n,e,t)=>{const r=new Ww,i=Ws(n.restDecoder);for(let s=0;s<i;s++){n.resetDsCurVal();const a=Ws(n.restDecoder),o=Ws(n.restDecoder),l=t.clients.get(a)||[],c=Kf(t,a);for(let u=0;u<o;u++){const f=n.readDsClock(),d=f+n.readDsLen();if(f<c){c<d&&Rk(r,a,c,d-c);let g=jv(l,f),p=l[g];for(!p.deleted&&p.id.clock<f&&(l.splice(g+1,0,cL(e,p,f-p.id.clock)),g++);g<l.length&&(p=l[g++],p.id.clock<d);)p.deleted||(d<p.id.clock+p.length&&l.splice(g,0,cL(e,p,d-p.id.clock)),p.delete(e))}else Rk(r,a,f,d-f)}}if(r.clients.size>0){const s=new DE;return Fa(s.restEncoder,0),Yw(s,r),s.toUint8Array()}return null},sme=Wpe;class sx extends jpe{constructor({guid:e=wGe(),collectionid:t=null,gc:r=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=r,this.gcFilter=i,this.clientID=sme(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new fme,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=lee(c=>{this.on("load",()=>{this.isLoaded=!0,c(this)})});const l=()=>lee(c=>{const u=f=>{(f===void 0||f===!0)&&(this.off("sync",u),c())};this.on("sync",u)});this.on("sync",c=>{c===!1&&this.isSynced&&(this.whenSynced=l()),this.isSynced=c===void 0||c===!0,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=l()}load(){const e=this._item;e!==null&&!this.shouldLoad&&El(e.parent.doc,t=>{t.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(PE(this.subdocs).map(e=>e.guid))}transact(e,t=null){return El(this,e,t)}get(e,t=Dh){const r=Y1(this.share,e,()=>{const s=new t;return s._integrate(this,null),s}),i=r.constructor;if(t!==Dh&&i!==t)if(i===Dh){const s=new t;s._map=r._map,r._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=r._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=r._length,this.share.set(e,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${e} has already been defined with a different constructor`);return r}getArray(e=""){return this.get(e,OT)}getText(e=""){return this.get(e,Hv)}getMap(e=""){return this.get(e,gw)}getXmlElement(e=""){return this.get(e,_w)}getXmlFragment(e=""){return this.get(e,LE)}toJSON(){const e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,PE(this.subdocs).forEach(t=>t.destroy());const e=this._item;if(e!==null){this._item=null;const t=e.content;t.doc=new sx({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,El(e.parent.doc,r=>{const i=t.doc;e.deleted||r.subdocsAdded.add(i),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class ame{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return Ws(this.restDecoder)}readDsLen(){return Ws(this.restDecoder)}}class ome extends ame{readLeftID(){return Ys(Ws(this.restDecoder),Ws(this.restDecoder))}readRightID(){return Ys(Ws(this.restDecoder),Ws(this.restDecoder))}readClient(){return Ws(this.restDecoder)}readInfo(){return dw(this.restDecoder)}readString(){return MT(this.restDecoder)}readParentInfo(){return Ws(this.restDecoder)===1}readTypeRef(){return Ws(this.restDecoder)}readLen(){return Ws(this.restDecoder)}readAny(){return Tk(this.restDecoder)}readBuf(){return VGe(xg(this.restDecoder))}readJSON(){return JSON.parse(MT(this.restDecoder))}readKey(){return MT(this.restDecoder)}}class a$e{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=Ws(this.restDecoder),this.dsCurrVal}readDsLen(){const e=Ws(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class mw extends a$e{constructor(e){super(e),this.keys=[],Ws(e),this.keyClockDecoder=new MB(xg(e)),this.clientDecoder=new QN(xg(e)),this.leftClockDecoder=new MB(xg(e)),this.rightClockDecoder=new MB(xg(e)),this.infoDecoder=new oee(xg(e),dw),this.stringDecoder=new EGe(xg(e)),this.parentInfoDecoder=new oee(xg(e),dw),this.typeRefDecoder=new QN(xg(e)),this.lenDecoder=new QN(xg(e))}readLeftID(){return new kT(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new kT(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Tk(this.restDecoder)}readBuf(){return xg(this.restDecoder)}readJSON(){return Tk(this.restDecoder)}readKey(){const e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{const t=this.stringDecoder.read();return this.keys.push(t),t}}}class o$e{constructor(){this.restEncoder=yU()}toUint8Array(){return Rv(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){Fa(this.restEncoder,e)}writeDsLen(e){Fa(this.restEncoder,e)}}class wO extends o$e{writeLeftID(e){Fa(this.restEncoder,e.client),Fa(this.restEncoder,e.clock)}writeRightID(e){Fa(this.restEncoder,e.client),Fa(this.restEncoder,e.clock)}writeClient(e){Fa(this.restEncoder,e)}writeInfo(e){m9(this.restEncoder,e)}writeString(e){CT(this.restEncoder,e)}writeParentInfo(e){Fa(this.restEncoder,e?1:0)}writeTypeRef(e){Fa(this.restEncoder,e)}writeLen(e){Fa(this.restEncoder,e)}writeAny(e){xk(this.restEncoder,e)}writeBuf(e){Eg(this.restEncoder,e)}writeJSON(e){CT(this.restEncoder,JSON.stringify(e))}writeKey(e){CT(this.restEncoder,e)}}class l$e{constructor(){this.restEncoder=yU(),this.dsCurrVal=0}toUint8Array(){return Rv(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){const t=e-this.dsCurrVal;this.dsCurrVal=e,Fa(this.restEncoder,t)}writeDsLen(e){e===0&&zv(),Fa(this.restEncoder,e-1),this.dsCurrVal+=e}}class DE extends l$e{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new CB,this.clientEncoder=new ZN,this.leftClockEncoder=new CB,this.rightClockEncoder=new CB,this.infoEncoder=new iee(m9),this.stringEncoder=new dGe,this.parentInfoEncoder=new iee(m9),this.typeRefEncoder=new ZN,this.lenEncoder=new ZN}toUint8Array(){const e=yU();return Fa(e,0),Eg(e,this.keyClockEncoder.toUint8Array()),Eg(e,this.clientEncoder.toUint8Array()),Eg(e,this.leftClockEncoder.toUint8Array()),Eg(e,this.rightClockEncoder.toUint8Array()),Eg(e,Rv(this.infoEncoder)),Eg(e,this.stringEncoder.toUint8Array()),Eg(e,Rv(this.parentInfoEncoder)),Eg(e,this.typeRefEncoder.toUint8Array()),Eg(e,this.lenEncoder.toUint8Array()),bU(e,Rv(this.restEncoder)),Rv(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(e?1:0)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){xk(this.restEncoder,e)}writeBuf(e){Eg(this.restEncoder,e)}writeJSON(e){xk(this.restEncoder,e)}writeKey(e){const t=this.keyMap.get(e);t===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}const c$e=(n,e,t,r)=>{r=ix(r,e[0].id.clock);const i=jv(e,r);Fa(n.restEncoder,e.length-i),n.writeClient(t),Fa(n.restEncoder,r);const s=e[i];s.write(n,r-s.id.clock);for(let a=i+1;a<e.length;a++)e[a].write(n,0)},iq=(n,e,t)=>{const r=new Map;t.forEach((i,s)=>{Kf(e,s)>i&&r.set(s,i)}),sq(e).forEach((i,s)=>{t.has(s)||r.set(s,0)}),Fa(n.restEncoder,r.size),PE(r.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{c$e(n,e.clients.get(i),i,s)})},u$e=(n,e)=>{const t=R_(),r=Ws(n.restDecoder);for(let i=0;i<r;i++){const s=Ws(n.restDecoder),a=new Array(s),o=n.readClient();let l=Ws(n.restDecoder);t.set(o,{i:0,refs:a});for(let c=0;c<s;c++){const u=n.readInfo();switch(vU&u){case 0:{const f=n.readLen();a[c]=new w0(Ys(o,l),f),l+=f;break}case 10:{const f=Ws(n.restDecoder);a[c]=new R0(Ys(o,l),f),l+=f;break}default:{const f=(u&(Zy|Fg))===0,d=new rc(Ys(o,l),null,(u&Fg)===Fg?n.readLeftID():null,null,(u&Zy)===Zy?n.readRightID():null,f?n.readParentInfo()?e.get(n.readString()):n.readLeftID():null,f&&(u&Sk)===Sk?n.readString():null,Nme(n,u));a[c]=d,l+=d.length}}}}return t},f$e=(n,e,t)=>{const r=[];let i=PE(t.keys()).sort((g,p)=>g-p);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let g=t.get(i[i.length-1]);for(;g.refs.length===g.i;)if(i.pop(),i.length>0)g=t.get(i[i.length-1]);else return null;return g};let a=s();if(a===null)return null;const o=new fme,l=new Map,c=(g,p)=>{const _=l.get(g);(_==null||_>p)&&l.set(g,p)};let u=a.refs[a.i++];const f=new Map,d=()=>{for(const g of r){const p=g.id.client,_=t.get(p);_?(_.i--,o.clients.set(p,_.refs.slice(_.i)),t.delete(p),_.i=0,_.refs=[]):o.clients.set(p,[g]),i=i.filter(y=>y!==p)}r.length=0};for(;;){if(u.constructor!==R0){const p=Y1(f,u.id.client,()=>Kf(e,u.id.client))-u.id.clock;if(p<0)r.push(u),c(u.id.client,u.id.clock-1),d();else{const _=u.getMissing(n,e);if(_!==null){r.push(u);const y=t.get(_)||{refs:[],i:0};if(y.refs.length===y.i)c(_,Kf(e,_)),d();else{u=y.refs[y.i++];continue}}else(p===0||p<u.length)&&(u.integrate(n,p),f.set(u.id.client,u.id.clock+u.length))}}if(r.length>0)u=r.pop();else if(a!==null&&a.i<a.refs.length)u=a.refs[a.i++];else{if(a=s(),a===null)break;u=a.refs[a.i++]}}if(o.clients.size>0){const g=new DE;return iq(g,o,new Map),Fa(g.restEncoder,0),{missing:l,update:g.toUint8Array()}}return null},h$e=(n,e)=>iq(n,e.doc.store,e.beforeState),d$e=(n,e,t,r=new mw(n))=>El(e,i=>{i.local=!1;let s=!1;const a=i.doc,o=a.store,l=u$e(r,a),c=f$e(i,o,l),u=o.pendingStructs;if(u){for(const[d,g]of u.missing)if(g<Kf(o,d)){s=!0;break}if(c){for(const[d,g]of c.missing){const p=u.missing.get(d);(p==null||p>g)&&u.missing.set(d,g)}u.update=rL([u.update,c.update])}}else o.pendingStructs=c;const f=fee(r,i,o);if(o.pendingDs){const d=new mw($w(o.pendingDs));Ws(d.restDecoder);const g=fee(d,i,o);f&&g?o.pendingDs=rL([f,g]):o.pendingDs=f||g}else o.pendingDs=f;if(s){const d=o.pendingStructs.update;o.pendingStructs=null,lme(i.doc,d)}},t,!1),lme=(n,e,t,r=mw)=>{const i=$w(e);d$e(i,n,t,new r(i))},hee=(n,e,t)=>lme(n,e,t,ome),p$e=(n,e,t=new Map)=>{iq(n,e.store,t),Yw(n,s$e(e.store))},m$e=(n,e=new Uint8Array([0]),t=new DE)=>{const r=cme(e);p$e(t,n,r);const i=[t.toUint8Array()];if(n.store.pendingDs&&i.push(n.store.pendingDs),n.store.pendingStructs&&i.push(k$e(n.store.pendingStructs.update,e)),i.length>1){if(t.constructor===wO)return C$e(i.map((s,a)=>a===0?s:I$e(s)));if(t.constructor===DE)return rL(i)}return i[0]},g$e=(n,e)=>m$e(n,e,new wO),_$e=n=>{const e=new Map,t=Ws(n.restDecoder);for(let r=0;r<t;r++){const i=Ws(n.restDecoder),s=Ws(n.restDecoder);e.set(i,s)}return e},cme=n=>_$e(new ame($w(n)));class v$e{constructor(){this.l=[]}}const dee=()=>new v$e,pee=(n,e)=>n.l.push(e),mee=(n,e)=>{const t=n.l,r=t.length;n.l=t.filter(i=>e!==i),r===n.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ume=(n,e,t)=>JH(n.l,[e,t]);class kT{constructor(e,t){this.client=e,this.clock=t}}const KI=(n,e)=>n===e||n!==null&&e!==null&&n.client===e.client&&n.clock===e.clock,Ys=(n,e)=>new kT(n,e),y$e=n=>{for(const[e,t]of n.doc.share.entries())if(t===n)return e;throw zv()},nL=(n,e)=>{for(;e!==null;){if(e.parent===n)return!0;e=e.parent._item}return!1},nT=(n,e)=>e===void 0?!n.deleted:e.sv.has(n.id.client)&&(e.sv.get(n.id.client)||0)>n.id.clock&&!TO(e.ds,n.id),y9=(n,e)=>{const t=Y1(n.meta,y9,hw),r=n.doc.store;t.has(e)||(e.sv.forEach((i,s)=>{i<Kf(r,s)&&Am(n,Ys(s,i))}),pw(n,e.ds,i=>{}),t.add(e))};class fme{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const sq=n=>{const e=new Map;return n.clients.forEach((t,r)=>{const i=t[t.length-1];e.set(r,i.id.clock+i.length)}),e},Kf=(n,e)=>{const t=n.clients.get(e);if(t===void 0)return 0;const r=t[t.length-1];return r.id.clock+r.length},hme=(n,e)=>{let t=n.clients.get(e.id.client);if(t===void 0)t=[],n.clients.set(e.id.client,t);else{const r=t[t.length-1];if(r.id.clock+r.length!==e.id.clock)throw zv()}t.push(e)},jv=(n,e)=>{let t=0,r=n.length-1,i=n[r],s=i.id.clock;if(s===e)return r;let a=M1(e/(s+i.length-1)*r);for(;t<=r;){if(i=n[a],s=i.id.clock,s<=e){if(e<s+i.length)return a;t=a+1}else r=a-1;a=M1((t+r)/2)}throw zv()},b$e=(n,e)=>{const t=n.clients.get(e.client);return t[jv(t,e.clock)]},JN=b$e,b9=(n,e,t)=>{const r=jv(e,t),i=e[r];return i.id.clock<t&&i instanceof rc?(e.splice(r+1,0,cL(n,i,t-i.id.clock)),r+1):r},Am=(n,e)=>{const t=n.doc.store.clients.get(e.client);return t[b9(n,t,e.clock)]},gee=(n,e,t)=>{const r=e.clients.get(t.client),i=jv(r,t.clock),s=r[i];return t.clock!==s.id.clock+s.length-1&&s.constructor!==w0&&r.splice(i+1,0,cL(n,s,t.clock-s.id.clock+1)),s},S$e=(n,e,t)=>{const r=n.clients.get(e.id.client);r[jv(r,e.id.clock)]=t},dme=(n,e,t,r,i)=>{if(r===0)return;const s=t+r;let a=b9(n,e,t),o;do o=e[a++],s<o.id.clock+o.length&&b9(n,e,s),i(o);while(a<e.length&&e[a].id.clock<s)};class E$e{constructor(e,t,r){this.doc=e,this.deleteSet=new Ww,this.beforeState=sq(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}const _ee=(n,e)=>e.deleteSet.clients.size===0&&!$Ve(e.afterState,(t,r)=>e.beforeState.get(r)!==t)?!1:(nq(e.deleteSet),h$e(n,e),Yw(n,e.deleteSet),!0),vee=(n,e,t)=>{const r=e._item;(r===null||r.id.clock<(n.beforeState.get(r.id.client)||0)&&!r.deleted)&&Y1(n.changed,e,hw).add(t)},eP=(n,e)=>{let t=n[e],r=n[e-1],i=e;for(;i>0;t=r,r=n[--i-1]){if(r.deleted===t.deleted&&r.constructor===t.constructor&&r.mergeWith(t)){t instanceof rc&&t.parentSub!==null&&t.parent._map.get(t.parentSub)===t&&t.parent._map.set(t.parentSub,r);continue}break}const s=e-i;return s&&n.splice(e+1-s,s),s},x$e=(n,e,t)=>{for(const[r,i]of n.clients.entries()){const s=e.clients.get(r);for(let a=i.length-1;a>=0;a--){const o=i[a],l=o.clock+o.len;for(let c=jv(s,o.clock),u=s[c];c<s.length&&u.id.clock<l;u=s[++c]){const f=s[c];if(o.clock+o.len<=f.id.clock)break;f instanceof rc&&f.deleted&&!f.keep&&t(f)&&f.gc(e,!1)}}}},T$e=(n,e)=>{n.clients.forEach((t,r)=>{const i=e.clients.get(r);for(let s=t.length-1;s>=0;s--){const a=t[s],o=Hpe(i.length-1,1+jv(i,a.clock+a.len-1));for(let l=o,c=i[l];l>0&&c.id.clock>=a.clock;c=i[l])l-=1+eP(i,l)}})},pme=(n,e)=>{if(e<n.length){const t=n[e],r=t.doc,i=r.store,s=t.deleteSet,a=t._mergeStructs;try{nq(s),t.afterState=sq(t.doc.store),r.emit("beforeObserverCalls",[t,r]);const o=[];t.changed.forEach((l,c)=>o.push(()=>{(c._item===null||!c._item.deleted)&&c._callObserver(t,l)})),o.push(()=>{t.changedParentTypes.forEach((l,c)=>{c._dEH.l.length>0&&(c._item===null||!c._item.deleted)&&(l=l.filter(u=>u.target._item===null||!u.target._item.deleted),l.forEach(u=>{u.currentTarget=c,u._path=null}),l.sort((u,f)=>u.path.length-f.path.length),ume(c._dEH,l,t))})}),o.push(()=>r.emit("afterTransaction",[t,r])),JH(o,[]),t._needFormattingCleanup&&$$e(t)}finally{r.gc&&x$e(s,i,r.gcFilter),T$e(s,i),t.afterState.forEach((u,f)=>{const d=t.beforeState.get(f)||0;if(d!==u){const g=i.clients.get(f),p=ix(jv(g,d),1);for(let _=g.length-1;_>=p;)_-=1+eP(g,_)}});for(let u=a.length-1;u>=0;u--){const{client:f,clock:d}=a[u].id,g=i.clients.get(f),p=jv(g,d);p+1<g.length&&eP(g,p+1)>1||p>0&&eP(g,p)}if(!t.local&&t.afterState.get(r.clientID)!==t.beforeState.get(r.clientID)&&(t$e(eq,Qpe,"[yjs] ",Jpe,eme,"Changed the client-id because another client seems to be using it."),r.clientID=sme()),r.emit("afterTransactionCleanup",[t,r]),r._observers.has("update")){const u=new wO;_ee(u,t)&&r.emit("update",[u.toUint8Array(),t.origin,r,t])}if(r._observers.has("updateV2")){const u=new DE;_ee(u,t)&&r.emit("updateV2",[u.toUint8Array(),t.origin,r,t])}const{subdocsAdded:o,subdocsLoaded:l,subdocsRemoved:c}=t;(o.size>0||c.size>0||l.size>0)&&(o.forEach(u=>{u.clientID=r.clientID,u.collectionid==null&&(u.collectionid=r.collectionid),r.subdocs.add(u)}),c.forEach(u=>r.subdocs.delete(u)),r.emit("subdocs",[{loaded:l,added:o,removed:c},r,t]),c.forEach(u=>u.destroy())),n.length<=e+1?(r._transactionCleanups=[],r.emit("afterAllTransactions",[r,n])):pme(n,e+1)}}},El=(n,e,t=null,r=!0)=>{const i=n._transactionCleanups;let s=!1,a=null;n._transaction===null&&(s=!0,n._transaction=new E$e(n,t,r),i.push(n._transaction),i.length===1&&n.emit("beforeAllTransactions",[n]),n.emit("beforeTransaction",[n._transaction,n]));try{a=e(n._transaction)}finally{if(s){const o=n._transaction===i[0];n._transaction=null,o&&pme(i,0)}}return a};class w$e{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}const yee=(n,e,t)=>{pw(n,t.deletions,r=>{r instanceof rc&&e.scope.some(i=>i===n.doc||nL(i,r))&&dq(r,!1)})},bee=(n,e,t)=>{let r=null;const i=n.doc,s=n.scope;El(i,o=>{for(;e.length>0&&n.currStackItem===null;){const l=i.store,c=e.pop(),u=new Set,f=[];let d=!1;pw(o,c.insertions,g=>{if(g instanceof rc){if(g.redone!==null){let{item:p,diff:_}=yWe(l,g.id);_>0&&(p=Am(o,Ys(p.id.client,p.id.clock+_))),g=p}!g.deleted&&s.some(p=>p===o.doc||nL(p,g))&&f.push(g)}}),pw(o,c.deletions,g=>{g instanceof rc&&s.some(p=>p===o.doc||nL(p,g))&&!TO(c.insertions,g.id)&&u.add(g)}),u.forEach(g=>{d=Ime(o,g,u,c.insertions,n.ignoreRemoteMapChanges,n)!==null||d});for(let g=f.length-1;g>=0;g--){const p=f[g];n.deleteFilter(p)&&(p.delete(o),d=!0)}n.currStackItem=d?c:null}o.changed.forEach((l,c)=>{l.has(null)&&c._searchMarker&&(c._searchMarker.length=0)}),r=o},n);const a=n.currStackItem;if(a!=null){const o=r.changedParentTypes;n.emit("stack-item-popped",[{stackItem:a,type:t,changedParentTypes:o,origin:n},n]),n.currStackItem=null}return a};class R$e extends jpe{constructor(e,{captureTimeout:t=500,captureTransaction:r=l=>!0,deleteFilter:i=()=>!0,trackedOrigins:s=new Set([null]),ignoreRemoteMapChanges:a=!1,doc:o=d9(e)?e[0].doc:e instanceof sx?e:e.doc}={}){super(),this.scope=[],this.doc=o,this.addToScope(e),this.deleteFilter=i,s.add(this),this.trackedOrigins=s,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=a,this.captureTimeout=t,this.afterTransactionHandler=l=>{if(!this.captureTransaction(l)||!this.scope.some(y=>l.changedParentTypes.has(y)||y===this.doc)||!this.trackedOrigins.has(l.origin)&&(!l.origin||!this.trackedOrigins.has(l.origin.constructor)))return;const c=this.undoing,u=this.redoing,f=c?this.redoStack:this.undoStack;c?this.stopCapturing():u||this.clear(!1,!0);const d=new Ww;l.afterState.forEach((y,v)=>{const x=l.beforeState.get(v)||0,E=y-x;E>0&&Rk(d,v,x,E)});const g=RGe();let p=!1;if(this.lastChange>0&&g-this.lastChange<this.captureTimeout&&f.length>0&&!c&&!u){const y=f[f.length-1];y.deletions=v9([y.deletions,l.deleteSet]),y.insertions=v9([y.insertions,d])}else f.push(new w$e(l.deleteSet,d)),p=!0;!c&&!u&&(this.lastChange=g),pw(l,l.deleteSet,y=>{y instanceof rc&&this.scope.some(v=>v===l.doc||nL(v,y))&&dq(y,!0)});const _=[{stackItem:f[f.length-1],origin:l.origin,type:c?"redo":"undo",changedParentTypes:l.changedParentTypes},this];p?this.emit("stack-item-added",_):this.emit("stack-item-updated",_)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){const t=new Set(this.scope);e=d9(e)?e:[e],e.forEach(r=>{t.has(r)||(t.add(r),(r instanceof Dh?r.doc!==this.doc:r!==this.doc)&&nme("[yjs#509] Not same Y.Doc"),this.scope.push(r))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(i=>yee(r,this,i)),this.undoStack=[]),t&&(this.redoStack.forEach(i=>yee(r,this,i)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){this.undoing=!0;let e;try{e=bee(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){this.redoing=!0;let e;try{e=bee(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}function*A$e(n){const e=Ws(n.restDecoder);for(let t=0;t<e;t++){const r=Ws(n.restDecoder),i=n.readClient();let s=Ws(n.restDecoder);for(let a=0;a<r;a++){const o=n.readInfo();if(o===10){const l=Ws(n.restDecoder);yield new R0(Ys(i,s),l),s+=l}else if((vU&o)!==0){const l=(o&(Zy|Fg))===0,c=new rc(Ys(i,s),null,(o&Fg)===Fg?n.readLeftID():null,null,(o&Zy)===Zy?n.readRightID():null,l?n.readParentInfo()?n.readString():n.readLeftID():null,l&&(o&Sk)===Sk?n.readString():null,Nme(n,o));yield c,s+=c.length}else{const l=n.readLen();yield new w0(Ys(i,s),l),s+=l}}}}class aq{constructor(e,t){this.gen=A$e(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===R0);return this.curr}}class oq{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}const C$e=n=>rL(n,ome,wO),M$e=(n,e)=>{if(n.constructor===w0){const{client:t,clock:r}=n.id;return new w0(Ys(t,r+e),n.length-e)}else if(n.constructor===R0){const{client:t,clock:r}=n.id;return new R0(Ys(t,r+e),n.length-e)}else{const t=n,{client:r,clock:i}=t.id;return new rc(Ys(r,i+e),null,Ys(r,i+e-1),null,t.rightOrigin,t.parent,t.parentSub,t.content.splice(e))}},rL=(n,e=mw,t=DE)=>{if(n.length===1)return n[0];const r=n.map(u=>new e($w(u)));let i=r.map(u=>new aq(u,!0)),s=null;const a=new t,o=new oq(a);for(;i=i.filter(d=>d.curr!==null),i.sort((d,g)=>{if(d.curr.id.client===g.curr.id.client){const p=d.curr.id.clock-g.curr.id.clock;return p===0?d.curr.constructor===g.curr.constructor?0:d.curr.constructor===R0?1:-1:p}else return g.curr.id.client-d.curr.id.client}),i.length!==0;){const u=i[0],f=u.curr.id.client;if(s!==null){let d=u.curr,g=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=u.next(),g=!0;if(d===null||d.id.client!==f||g&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)a1(o,s.struct,s.offset),s={struct:d,offset:0},u.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===R0)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{a1(o,s.struct,s.offset);const p=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new R0(Ys(f,s.struct.id.clock+s.struct.length),p),offset:0}}else{const p=s.struct.id.clock+s.struct.length-d.id.clock;p>0&&(s.struct.constructor===R0?s.struct.length-=p:d=M$e(d,p)),s.struct.mergeWith(d)||(a1(o,s.struct,s.offset),s={struct:d,offset:0},u.next())}}else s={struct:u.curr,offset:0},u.next();for(let d=u.curr;d!==null&&d.id.client===f&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==R0;d=u.next())a1(o,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(a1(o,s.struct,s.offset),s=null),lq(o);const l=r.map(u=>rq(u)),c=v9(l);return Yw(a,c),a.toUint8Array()},k$e=(n,e,t=mw,r=DE)=>{const i=cme(e),s=new r,a=new oq(s),o=new t($w(n)),l=new aq(o,!1);for(;l.curr;){const u=l.curr,f=u.id.client,d=i.get(f)||0;if(l.curr.constructor===R0){l.next();continue}if(u.id.clock+u.length>d)for(a1(a,u,ix(d-u.id.clock,0)),l.next();l.curr&&l.curr.id.client===f;)a1(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===f&&l.curr.id.clock+l.curr.length<=d;)l.next()}lq(a);const c=rq(o);return Yw(s,c),s.toUint8Array()},mme=n=>{n.written>0&&(n.clientStructs.push({written:n.written,restEncoder:Rv(n.encoder.restEncoder)}),n.encoder.restEncoder=yU(),n.written=0)},a1=(n,e,t)=>{n.written>0&&n.currClient!==e.id.client&&mme(n),n.written===0&&(n.currClient=e.id.client,n.encoder.writeClient(e.id.client),Fa(n.encoder.restEncoder,e.id.clock+t)),e.write(n.encoder,t),n.written++},lq=n=>{mme(n);const e=n.encoder.restEncoder;Fa(e,n.clientStructs.length);for(let t=0;t<n.clientStructs.length;t++){const r=n.clientStructs[t];Fa(e,r.written),bU(e,r.restEncoder)}},O$e=(n,e,t,r)=>{const i=new t($w(n)),s=new aq(i,!1),a=new r,o=new oq(a);for(let c=s.curr;c!==null;c=s.next())a1(o,e(c),0);lq(o);const l=rq(i);return Yw(a,l),a.toUint8Array()},I$e=n=>O$e(n,BGe,mw,wO),See="You must not compute changes after the event-handler fired.";class EU{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=N$e(this.currentTarget,this.target))}deletes(e){return TO(this.transaction.deleteSet,e.id)}get keys(){if(this._keys===null){if(this.transaction.doc._transactionCleanups.length===0)throw k1(See);const e=new Map,t=this.target;this.transaction.changed.get(t).forEach(i=>{if(i!==null){const s=t._map.get(i);let a,o;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))a="delete",o=wB(l.content.getContent());else return;else l!==null&&this.deletes(l)?(a="update",o=wB(l.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=wB(s.content.getContent());else return;e.set(i,{action:a,oldValue:o})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(e===null){if(this.transaction.doc._transactionCleanups.length===0)throw k1(See);const t=this.target,r=hw(),i=hw(),s=[];if(e={added:r,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(t).has(null)){let o=null;const l=()=>{o&&s.push(o)};for(let c=t._start;c!==null;c=c.right)c.deleted?this.deletes(c)&&!this.adds(c)&&((o===null||o.delete===void 0)&&(l(),o={delete:0}),o.delete+=c.length,i.add(c)):this.adds(c)?((o===null||o.insert===void 0)&&(l(),o={insert:[]}),o.insert=o.insert.concat(c.content.getContent()),r.add(c)):((o===null||o.retain===void 0)&&(l(),o={retain:0}),o.retain+=c.length);o!==null&&o.retain===void 0&&l()}this._changes=e}return e}}const N$e=(n,e)=>{const t=[];for(;e._item!==null&&e!==n;){if(e._item.parentSub!==null)t.unshift(e._item.parentSub);else{let r=0,i=e._item.parent._start;for(;i!==e._item&&i!==null;)!i.deleted&&i.countable&&(r+=i.length),i=i.right;t.unshift(r)}e=e._item.parent}return t},tp=()=>{nme("Invalid access: Add Yjs type to a document before reading data.")},gme=80;let cq=0;class P$e{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=cq++}}const D$e=n=>{n.timestamp=cq++},_me=(n,e,t)=>{n.p.marker=!1,n.p=e,e.marker=!0,n.index=t,n.timestamp=cq++},L$e=(n,e,t)=>{if(n.length>=gme){const r=n.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return _me(r,e,t),r}else{const r=new P$e(e,t);return n.push(r),r}},xU=(n,e)=>{if(n._start===null||e===0||n._searchMarker===null)return null;const t=n._searchMarker.length===0?null:n._searchMarker.reduce((s,a)=>KN(e-s.index)<KN(e-a.index)?s:a);let r=n._start,i=0;for(t!==null&&(r=t.p,i=t.index,D$e(t));r.right!==null&&i<e;){if(!r.deleted&&r.countable){if(e<i+r.length)break;i+=r.length}r=r.right}for(;r.left!==null&&i>e;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);for(;r.left!==null&&r.left.id.client===r.id.client&&r.left.id.clock+r.left.length===r.id.clock;)r=r.left,!r.deleted&&r.countable&&(i-=r.length);return t!==null&&KN(t.index-i)<r.parent.length/gme?(_me(t,r,i),t):L$e(n._searchMarker,r,i)},Ak=(n,e,t)=>{for(let r=n.length-1;r>=0;r--){const i=n[r];if(t>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){n.splice(r,1);continue}i.p=s,s.marker=!0}(e<i.index||t>0&&e===i.index)&&(i.index=ix(e,i.index+t))}},TU=(n,e,t)=>{const r=n,i=e.changedParentTypes;for(;Y1(i,n,()=>[]).push(t),n._item!==null;)n=n._item.parent;ume(r._eH,t,e)};class Dh{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=dee(),this._dEH=dee(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw Nv()}clone(){throw Nv()}_write(e){}get _first(){let e=this._start;for(;e!==null&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){pee(this._eH,e)}observeDeep(e){pee(this._dEH,e)}unobserve(e){mee(this._eH,e)}unobserveDeep(e){mee(this._dEH,e)}toJSON(){}}const vme=(n,e,t)=>{n.doc??tp(),e<0&&(e=n._length+e),t<0&&(t=n._length+t);let r=t-e;const i=[];let s=n._start;for(;s!==null&&r>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=e)e-=a.length;else{for(let o=e;o<a.length&&r>0;o++)i.push(a[o]),r--;e=0}}s=s.right}return i},yme=n=>{n.doc??tp();const e=[];let t=n._start;for(;t!==null;){if(t.countable&&!t.deleted){const r=t.content.getContent();for(let i=0;i<r.length;i++)e.push(r[i])}t=t.right}return e},Ck=(n,e)=>{let t=0,r=n._start;for(n.doc??tp();r!==null;){if(r.countable&&!r.deleted){const i=r.content.getContent();for(let s=0;s<i.length;s++)e(i[s],t++,n)}r=r.right}},bme=(n,e)=>{const t=[];return Ck(n,(r,i)=>{t.push(e(r,i,n))}),t},U$e=n=>{let e=n._start,t=null,r=0;return{[Symbol.iterator](){return this},next:()=>{if(t===null){for(;e!==null&&e.deleted;)e=e.right;if(e===null)return{done:!0,value:void 0};t=e.content.getContent(),r=0,e=e.right}const i=t[r++];return t.length<=r&&(t=null),{done:!1,value:i}}}},Sme=(n,e)=>{n.doc??tp();const t=xU(n,e);let r=n._start;for(t!==null&&(r=t.p,e-=t.index);r!==null;r=r.right)if(!r.deleted&&r.countable){if(e<r.length)return r.content.getContent()[e];e-=r.length}},iL=(n,e,t,r)=>{let i=t;const s=n.doc,a=s.clientID,o=s.store,l=t===null?e._start:t.right;let c=[];const u=()=>{c.length>0&&(i=new rc(Ys(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new UE(c)),i.integrate(n,0),c=[])};r.forEach(f=>{if(f===null)c.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(f);break;default:switch(u(),f.constructor){case Uint8Array:case ArrayBuffer:i=new rc(Ys(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new RO(new Uint8Array(f))),i.integrate(n,0);break;case sx:i=new rc(Ys(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new AO(f)),i.integrate(n,0);break;default:if(f instanceof Dh)i=new rc(Ys(a,Kf(o,a)),i,i&&i.lastId,l,l&&l.id,e,null,new Sb(f)),i.integrate(n,0);else throw new Error("Unexpected content type in insert operation")}}}),u()},Eme=()=>k1("Length exceeded!"),xme=(n,e,t,r)=>{if(t>e._length)throw Eme();if(t===0)return e._searchMarker&&Ak(e._searchMarker,t,r.length),iL(n,e,null,r);const i=t,s=xU(e,t);let a=e._start;for(s!==null&&(a=s.p,t-=s.index,t===0&&(a=a.prev,t+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(t<=a.length){t<a.length&&Am(n,Ys(a.id.client,a.id.clock+t));break}t-=a.length}return e._searchMarker&&Ak(e._searchMarker,i,r.length),iL(n,e,a,r)},B$e=(n,e,t)=>{let i=(e._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:e._start}).p;if(i)for(;i.right;)i=i.right;return iL(n,e,i,t)},Tme=(n,e,t,r)=>{if(r===0)return;const i=t,s=r,a=xU(e,t);let o=e._start;for(a!==null&&(o=a.p,t-=a.index);o!==null&&t>0;o=o.right)!o.deleted&&o.countable&&(t<o.length&&Am(n,Ys(o.id.client,o.id.clock+t)),t-=o.length);for(;r>0&&o!==null;)o.deleted||(r<o.length&&Am(n,Ys(o.id.client,o.id.clock+r)),o.delete(n),r-=o.length),o=o.right;if(r>0)throw Eme();e._searchMarker&&Ak(e._searchMarker,i,-s+r)},sL=(n,e,t)=>{const r=e._map.get(t);r!==void 0&&r.delete(n)},uq=(n,e,t,r)=>{const i=e._map.get(t)||null,s=n.doc,a=s.clientID;let o;if(r==null)o=new UE([r]);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:case Date:case BigInt:o=new UE([r]);break;case Uint8Array:o=new RO(r);break;case sx:o=new AO(r);break;default:if(r instanceof Dh)o=new Sb(r);else throw new Error("Unexpected content type")}new rc(Ys(a,Kf(s.store,a)),i,i&&i.lastId,null,null,e,t,o).integrate(n,0)},fq=(n,e)=>{n.doc??tp();const t=n._map.get(e);return t!==void 0&&!t.deleted?t.content.getContent()[t.length-1]:void 0},wme=n=>{const e={};return n.doc??tp(),n._map.forEach((t,r)=>{t.deleted||(e[r]=t.content.getContent()[t.length-1])}),e},Rme=(n,e)=>{n.doc??tp();const t=n._map.get(e);return t!==void 0&&!t.deleted},F$e=(n,e)=>{const t={};return n._map.forEach((r,i)=>{let s=r;for(;s!==null&&(!e.sv.has(s.id.client)||s.id.clock>=(e.sv.get(s.id.client)||0));)s=s.left;s!==null&&nT(s,e)&&(t[i]=s.content.getContent()[s.length-1])}),t},ZI=n=>(n.doc??tp(),n$e(n._map.entries(),e=>!e[1].deleted));class z$e extends EU{}class OT extends Dh{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){const t=new OT;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new OT}clone(){const e=new OT;return e.insert(0,this.toArray().map(t=>t instanceof Dh?t.clone():t)),e}get length(){return this.doc??tp(),this._length}_callObserver(e,t){super._callObserver(e,t),TU(this,e,new z$e(this,e))}insert(e,t){this.doc!==null?El(this.doc,r=>{xme(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){this.doc!==null?El(this.doc,t=>{B$e(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){this.doc!==null?El(this.doc,r=>{Tme(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return Sme(this,e)}toArray(){return yme(this)}slice(e=0,t=this.length){return vme(this,e,t)}toJSON(){return this.map(e=>e instanceof Dh?e.toJSON():e)}map(e){return bme(this,e)}forEach(e){Ck(this,e)}[Symbol.iterator](){return U$e(this)}_write(e){e.writeTypeRef(fWe)}}const j$e=n=>new OT;class H$e extends EU{constructor(e,t,r){super(e,t),this.keysChanged=r}}class gw extends Dh{constructor(e){super(),this._prelimContent=null,e===void 0?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((r,i)=>{this.set(i,r)}),this._prelimContent=null}_copy(){return new gw}clone(){const e=new gw;return this.forEach((t,r)=>{e.set(r,t instanceof Dh?t.clone():t)}),e}_callObserver(e,t){TU(this,e,new H$e(this,e,t))}toJSON(){this.doc??tp();const e={};return this._map.forEach((t,r)=>{if(!t.deleted){const i=t.content.getContent()[t.length-1];e[r]=i instanceof Dh?i.toJSON():i}}),e}get size(){return[...ZI(this)].length}keys(){return kB(ZI(this),e=>e[0])}values(){return kB(ZI(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return kB(ZI(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??tp(),this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){this.doc!==null?El(this.doc,t=>{sL(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return this.doc!==null?El(this.doc,r=>{uq(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return fq(this,e)}has(e){return Rme(this,e)}clear(){this.doc!==null?El(this.doc,e=>{this.forEach(function(t,r,i){sL(e,i,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(hWe)}}const q$e=n=>new gw,h1=(n,e)=>n===e||typeof n=="object"&&typeof e=="object"&&n&&e&&LGe(n,e);class S9{constructor(e,t,r,i){this.left=e,this.right=t,this.index=r,this.currentAttributes=i}forward(){switch(this.right===null&&zv(),this.right.content.constructor){case eh:this.right.deleted||Xw(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Eee=(n,e,t)=>{for(;e.right!==null&&t>0;){switch(e.right.content.constructor){case eh:e.right.deleted||Xw(e.currentAttributes,e.right.content);break;default:e.right.deleted||(t<e.right.length&&Am(n,Ys(e.right.id.client,e.right.id.clock+t)),e.index+=e.right.length,t-=e.right.length);break}e.left=e.right,e.right=e.right.right}return e},QI=(n,e,t,r)=>{const i=new Map,s=r?xU(e,t):null;if(s){const a=new S9(s.p.left,s.p,s.index,i);return Eee(n,a,t-s.index)}else{const a=new S9(null,e._start,0,i);return Eee(n,a,t)}},Ame=(n,e,t,r)=>{for(;t.right!==null&&(t.right.deleted===!0||t.right.content.constructor===eh&&h1(r.get(t.right.content.key),t.right.content.value));)t.right.deleted||r.delete(t.right.content.key),t.forward();const i=n.doc,s=i.clientID;r.forEach((a,o)=>{const l=t.left,c=t.right,u=new rc(Ys(s,Kf(i.store,s)),l,l&&l.lastId,c,c&&c.id,e,null,new eh(o,a));u.integrate(n,0),t.right=u,t.forward()})},Xw=(n,e)=>{const{key:t,value:r}=e;r===null?n.delete(t):n.set(t,r)},Cme=(n,e)=>{for(;n.right!==null;){if(!(n.right.deleted||n.right.content.constructor===eh&&h1(e[n.right.content.key]??null,n.right.content.value)))break;n.forward()}},Mme=(n,e,t,r)=>{const i=n.doc,s=i.clientID,a=new Map;for(const o in r){const l=r[o],c=t.currentAttributes.get(o)??null;if(!h1(c,l)){a.set(o,c);const{left:u,right:f}=t;t.right=new rc(Ys(s,Kf(i.store,s)),u,u&&u.lastId,f,f&&f.id,e,null,new eh(o,l)),t.right.integrate(n,0),t.forward()}}return a},OB=(n,e,t,r,i)=>{t.currentAttributes.forEach((d,g)=>{i[g]===void 0&&(i[g]=null)});const s=n.doc,a=s.clientID;Cme(t,i);const o=Mme(n,e,t,i),l=r.constructor===String?new qv(r):r instanceof Dh?new Sb(r):new ax(r);let{left:c,right:u,index:f}=t;e._searchMarker&&Ak(e._searchMarker,t.index,l.getLength()),u=new rc(Ys(a,Kf(s.store,a)),c,c&&c.lastId,u,u&&u.id,e,null,l),u.integrate(n,0),t.right=u,t.index=f,t.forward(),Ame(n,e,t,o)},xee=(n,e,t,r,i)=>{const s=n.doc,a=s.clientID;Cme(t,i);const o=Mme(n,e,t,i);e:for(;t.right!==null&&(r>0||o.size>0&&(t.right.deleted||t.right.content.constructor===eh));){if(!t.right.deleted)switch(t.right.content.constructor){case eh:{const{key:l,value:c}=t.right.content,u=i[l];if(u!==void 0){if(h1(u,c))o.delete(l);else{if(r===0)break e;o.set(l,c)}t.right.delete(n)}else t.currentAttributes.set(l,c);break}default:r<t.right.length&&Am(n,Ys(t.right.id.client,t.right.id.clock+r)),r-=t.right.length;break}t.forward()}if(r>0){let l="";for(;r>0;r--)l+=`
`;t.right=new rc(Ys(a,Kf(s.store,a)),t.left,t.left&&t.left.lastId,t.right,t.right&&t.right.id,e,null,new qv(l)),t.right.integrate(n,0),t.forward()}Ame(n,e,t,o)},kme=(n,e,t,r,i)=>{let s=e;const a=R_();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===eh){const c=s.content;a.set(c.key,c)}s=s.right}let o=0,l=!1;for(;e!==s;){if(t===e&&(l=!0),!e.deleted){const c=e.content;switch(c.constructor){case eh:{const{key:u,value:f}=c,d=r.get(u)??null;(a.get(u)!==c||d===f)&&(e.delete(n),o++,!l&&(i.get(u)??null)===f&&d!==f&&(d===null?i.delete(u):i.set(u,d))),!l&&!e.deleted&&Xw(i,c);break}}}e=e.right}return o},V$e=(n,e)=>{for(;e&&e.right&&(e.right.deleted||!e.right.countable);)e=e.right;const t=new Set;for(;e&&(e.deleted||!e.countable);){if(!e.deleted&&e.content.constructor===eh){const r=e.content.key;t.has(r)?e.delete(n):t.add(r)}e=e.left}},G$e=n=>{let e=0;return El(n.doc,t=>{let r=n._start,i=n._start,s=R_();const a=h9(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case eh:Xw(a,i.content);break;default:e+=kme(t,r,i,s,a),s=h9(a),r=i;break}i=i.right}}),e},$$e=n=>{const e=new Set,t=n.doc;for(const[r,i]of n.afterState.entries()){const s=n.beforeState.get(r)||0;i!==s&&dme(n,t.store.clients.get(r),s,i,a=>{!a.deleted&&a.content.constructor===eh&&a.constructor!==w0&&e.add(a.parent)})}El(t,r=>{pw(n,n.deleteSet,i=>{if(i instanceof w0||!i.parent._hasFormatting||e.has(i.parent))return;const s=i.parent;i.content.constructor===eh?e.add(s):V$e(r,i)});for(const i of e)G$e(i)})},Tee=(n,e,t)=>{const r=t,i=h9(e.currentAttributes),s=e.right;for(;t>0&&e.right!==null;){if(e.right.deleted===!1)switch(e.right.content.constructor){case Sb:case ax:case qv:t<e.right.length&&Am(n,Ys(e.right.id.client,e.right.id.clock+t)),t-=e.right.length,e.right.delete(n);break}e.forward()}s&&kme(n,s,e.right,i,e.currentAttributes);const a=(e.left||e.right).parent;return a._searchMarker&&Ak(a._searchMarker,e.index,-r+t),e};class W$e extends EU{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(this._delta===null){const e=this.target.doc,t=[];El(e,r=>{const i=new Map,s=new Map;let a=this.target._start,o=null;const l={};let c="",u=0,f=0;const d=()=>{if(o!==null){let g=null;switch(o){case"delete":f>0&&(g={delete:f}),f=0;break;case"insert":(typeof c=="object"||c.length>0)&&(g={insert:c},i.size>0&&(g.attributes={},i.forEach((p,_)=>{p!==null&&(g.attributes[_]=p)}))),c="";break;case"retain":u>0&&(g={retain:u},NGe(l)||(g.attributes=kGe({},l))),u=0;break}g&&t.push(g),o=null}};for(;a!==null;){switch(a.content.constructor){case Sb:case ax:this.adds(a)?this.deletes(a)||(d(),o="insert",c=a.content.getContent()[0],d()):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),f+=1):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=1);break;case qv:this.adds(a)?this.deletes(a)||(o!=="insert"&&(d(),o="insert"),c+=a.content.str):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),f+=a.length):a.deleted||(o!=="retain"&&(d(),o="retain"),u+=a.length);break;case eh:{const{key:g,value:p}=a.content;if(this.adds(a)){if(!this.deletes(a)){const _=i.get(g)??null;h1(_,p)?p!==null&&a.delete(r):(o==="retain"&&d(),h1(p,s.get(g)??null)?delete l[g]:l[g]=p)}}else if(this.deletes(a)){s.set(g,p);const _=i.get(g)??null;h1(_,p)||(o==="retain"&&d(),l[g]=_)}else if(!a.deleted){s.set(g,p);const _=l[g];_!==void 0&&(h1(_,p)?_!==null&&a.delete(r):(o==="retain"&&d(),p===null?delete l[g]:l[g]=p))}a.deleted||(o==="insert"&&d(),Xw(i,a.content));break}}a=a.right}for(d();t.length>0;){const g=t[t.length-1];if(g.retain!==void 0&&g.attributes===void 0)t.pop();else break}}),this._delta=t}return this._delta}}class Hv extends Dh{constructor(e){super(),this._pending=e!==void 0?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??tp(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(r=>r())}catch(r){console.error(r)}this._pending=null}_copy(){return new Hv}clone(){const e=new Hv;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);const r=new W$e(this,e,t);TU(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??tp();let e="",t=this._start;for(;t!==null;)!t.deleted&&t.countable&&t.content.constructor===qv&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){this.doc!==null?El(this.doc,r=>{const i=new S9(null,this._start,0,new Map);for(let s=0;s<e.length;s++){const a=e[s];if(a.insert!==void 0){const o=!t&&typeof a.insert=="string"&&s===e.length-1&&i.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&OB(r,this,i,o,a.attributes||{})}else a.retain!==void 0?xee(r,this,i,a.retain,a.attributes||{}):a.delete!==void 0&&Tee(r,i,a.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){this.doc??tp();const i=[],s=new Map,a=this.doc;let o="",l=this._start;function c(){if(o.length>0){const f={};let d=!1;s.forEach((p,_)=>{d=!0,f[_]=p});const g={insert:o};d&&(g.attributes=f),i.push(g),o=""}}const u=()=>{for(;l!==null;){if(nT(l,e)||t!==void 0&&nT(l,t))switch(l.content.constructor){case qv:{const f=s.get("ychange");e!==void 0&&!nT(l,e)?(f===void 0||f.user!==l.id.client||f.type!=="removed")&&(c(),s.set("ychange",r?r("removed",l.id):{type:"removed"})):t!==void 0&&!nT(l,t)?(f===void 0||f.user!==l.id.client||f.type!=="added")&&(c(),s.set("ychange",r?r("added",l.id):{type:"added"})):f!==void 0&&(c(),s.delete("ychange")),o+=l.content.str;break}case Sb:case ax:{c();const f={insert:l.content.getContent()[0]};if(s.size>0){const d={};f.attributes=d,s.forEach((g,p)=>{d[p]=g})}i.push(f);break}case eh:nT(l,e)&&(c(),Xw(s,l.content));break}l=l.right}c()};return e||t?El(a,f=>{e&&y9(f,e),t&&y9(f,t),u()},"cleanup"):u(),i}insert(e,t,r){if(t.length<=0)return;const i=this.doc;i!==null?El(i,s=>{const a=QI(s,this,e,!r);r||(r={},a.currentAttributes.forEach((o,l)=>{r[l]=o})),OB(s,this,a,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){const i=this.doc;i!==null?El(i,s=>{const a=QI(s,this,e,!r);OB(s,this,a,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(t===0)return;const r=this.doc;r!==null?El(r,i=>{Tee(i,QI(i,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(t===0)return;const i=this.doc;i!==null?El(i,s=>{const a=QI(s,this,e,!1);a.right!==null&&xee(s,this,a,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){this.doc!==null?El(this.doc,t=>{sL(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){this.doc!==null?El(this.doc,r=>{uq(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return fq(this,e)}getAttributes(){return wme(this)}_write(e){e.writeTypeRef(dWe)}}const Y$e=n=>new Hv;class IB{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??tp()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(e!==null&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,!e.deleted&&(t.constructor===_w||t.constructor===LE)&&t._start!==null)e=t._start;else for(;e!==null;){const r=e.next;if(r!==null){e=r;break}else e.parent===this._root?e=null:e=e.parent._item}while(e!==null&&(e.deleted||!this._filter(e.content.type)));return this._firstCall=!1,e===null?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class LE extends Dh{constructor(){super(),this._prelimContent=[]}get firstChild(){const e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new LE}clone(){const e=new LE;return e.insert(0,this.toArray().map(t=>t instanceof Dh?t.clone():t)),e}get length(){return this.doc??tp(),this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(e){return new IB(this,e)}querySelector(e){e=e.toUpperCase();const r=new IB(this,i=>i.nodeName&&i.nodeName.toUpperCase()===e).next();return r.done?null:r.value}querySelectorAll(e){return e=e.toUpperCase(),PE(new IB(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){TU(this,e,new Z$e(this,t,e))}toString(){return bme(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){const i=e.createDocumentFragment();return r!==void 0&&r._createAssociation(i,this),Ck(this,s=>{i.insertBefore(s.toDOM(e,t,r),null)}),i}insert(e,t){this.doc!==null?El(this.doc,r=>{xme(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(this.doc!==null)El(this.doc,r=>{const i=e&&e instanceof Dh?e._item:e;iL(r,this,i,t)});else{const r=this._prelimContent,i=e===null?0:r.findIndex(s=>s===e)+1;if(i===0&&e!==null)throw k1("Reference item not found");r.splice(i,0,...t)}}delete(e,t=1){this.doc!==null?El(this.doc,r=>{Tme(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return yme(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return Sme(this,e)}slice(e=0,t=this.length){return vme(this,e,t)}forEach(e){Ck(this,e)}_write(e){e.writeTypeRef(mWe)}}const X$e=n=>new LE;class _w extends LE{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((r,i)=>{this.setAttribute(i,r)}),this._prelimAttrs=null}_copy(){return new _w(this.nodeName)}clone(){const e=new _w(this.nodeName),t=this.getAttributes();return IGe(t,(r,i)=>{typeof r=="string"&&e.setAttribute(i,r)}),e.insert(0,this.toArray().map(r=>r instanceof Dh?r.clone():r)),e}toString(){const e=this.getAttributes(),t=[],r=[];for(const o in e)r.push(o);r.sort();const i=r.length;for(let o=0;o<i;o++){const l=r[o];t.push(l+'="'+e[l]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=t.length>0?" "+t.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(e){this.doc!==null?El(this.doc,t=>{sL(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){this.doc!==null?El(this.doc,r=>{uq(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return fq(this,e)}hasAttribute(e){return Rme(this,e)}getAttributes(e){return e?F$e(this,e):wme(this)}toDOM(e=document,t={},r){const i=e.createElement(this.nodeName),s=this.getAttributes();for(const a in s){const o=s[a];typeof o=="string"&&i.setAttribute(a,o)}return Ck(this,a=>{i.appendChild(a.toDOM(e,t,r))}),r!==void 0&&r._createAssociation(i,this),i}_write(e){e.writeTypeRef(pWe),e.writeKey(this.nodeName)}}const K$e=n=>new _w(n.readKey());class Z$e extends EU{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class aL extends gw{constructor(e){super(),this.hookName=e}_copy(){return new aL(this.hookName)}clone(){const e=new aL(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){const i=t[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),r!==void 0&&r._createAssociation(s,this),s}_write(e){e.writeTypeRef(gWe),e.writeKey(this.hookName)}}const Q$e=n=>new aL(n.readKey());class oL extends Hv{get nextSibling(){const e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){const e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new oL}clone(){const e=new oL;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){const i=e.createTextNode(this.toString());return r!==void 0&&r._createAssociation(i,this),i}toString(){return this.toDelta().map(e=>{const t=[];for(const i in e.attributes){const s=[];for(const a in e.attributes[i])s.push({key:a,value:e.attributes[i][a]});s.sort((a,o)=>a.key<o.key?-1:1),t.push({nodeName:i,attrs:s})}t.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let r="";for(let i=0;i<t.length;i++){const s=t[i];r+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];r+=` ${o.key}="${o.value}"`}r+=">"}r+=e.insert;for(let i=t.length-1;i>=0;i--)r+=`</${t[i].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(_We)}}const J$e=n=>new oL;class hq{constructor(e,t){this.id=e,this.length=t}get deleted(){throw Nv()}mergeWith(e){return!1}write(e,t,r){throw Nv()}integrate(e,t){throw Nv()}}const eWe=0;class w0 extends hq{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),hme(e.doc.store,this)}write(e,t){e.writeInfo(eWe),e.writeLen(this.length-t)}getMissing(e,t){return null}}class RO{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new RO(this.content)}splice(e){throw Nv()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}const tWe=n=>new RO(n.readBuf());class Mk{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Mk(this.len)}splice(e){const t=new Mk(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){Rk(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}const nWe=n=>new Mk(n.readLen()),Ome=(n,e)=>new sx({guid:n,...e,shouldLoad:e.shouldLoad||e.autoLoad||!1});class AO{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;const t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),e.meta!==null&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new AO(Ome(this.doc.guid,this.opts))}splice(e){throw Nv()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}const rWe=n=>new AO(Ome(n.readString(),n.readAny()));class ax{constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new ax(this.embed)}splice(e){throw Nv()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}const iWe=n=>new ax(n.readJSON());class eh{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new eh(this.key,this.value)}splice(e){throw Nv()}mergeWith(e){return!1}integrate(e,t){const r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}const sWe=n=>new eh(n.readKey(),n.readJSON());class lL{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new lL(this.arr)}splice(e){const t=new lL(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const s=this.arr[i];e.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const aWe=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++){const i=n.readString();i==="undefined"?t.push(void 0):t.push(JSON.parse(i))}return new lL(t)},oWe=tL("node_env")==="development";class UE{constructor(e){this.arr=e,oWe&&Xpe(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new UE(this.arr)}splice(e){const t=new UE(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){const r=this.arr.length;e.writeLen(r-t);for(let i=t;i<r;i++){const s=this.arr[i];e.writeAny(s)}}getRef(){return 8}}const lWe=n=>{const e=n.readLen(),t=[];for(let r=0;r<e;r++)t.push(n.readAny());return new UE(t)};class qv{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new qv(this.str)}splice(e){const t=new qv(this.str.slice(e));this.str=this.str.slice(0,e);const r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(t===0?this.str:this.str.slice(t))}getRef(){return 4}}const cWe=n=>new qv(n.readString()),uWe=[j$e,q$e,Y$e,K$e,X$e,Q$e,J$e],fWe=0,hWe=1,dWe=2,pWe=3,mWe=4,gWe=5,_We=6;class Sb{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Sb(this.type._copy())}splice(e){throw Nv()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;t!==null;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(r=>{r.deleted?r.id.clock<(e.beforeState.get(r.id.client)||0)&&e._mergeStructs.push(r):r.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;t!==null;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(r=>{for(;r!==null;)r.gc(e,!0),r=r.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}const vWe=n=>new Sb(uWe[n.readTypeRef()](n)),yWe=(n,e)=>{let t=e,r=0,i;do r>0&&(t=Ys(t.client,t.clock+r)),i=JN(n,t),r=t.clock-i.id.clock,t=i.redone;while(t!==null&&i instanceof rc);return{item:i,diff:r}},dq=(n,e)=>{for(;n!==null&&n.keep!==e;)n.keep=e,n=n.parent._item},cL=(n,e,t)=>{const{client:r,clock:i}=e.id,s=new rc(Ys(r,i+t),e,Ys(r,i+t-1),e.right,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t));return e.deleted&&s.markDeleted(),e.keep&&(s.keep=!0),e.redone!==null&&(s.redone=Ys(e.redone.client,e.redone.clock+t)),e.right=s,s.right!==null&&(s.right.left=s),n._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),e.length=t,s},wee=(n,e)=>YVe(n,t=>TO(t.deletions,e)),Ime=(n,e,t,r,i,s)=>{const a=n.doc,o=a.store,l=a.clientID,c=e.redone;if(c!==null)return Am(n,c);let u=e.parent._item,f=null,d;if(u!==null&&u.deleted===!0){if(u.redone===null&&(!t.has(u)||Ime(n,u,t,r,i,s)===null))return null;for(;u.redone!==null;)u=Am(n,u.redone)}const g=u===null?e.parent:u.content.type;if(e.parentSub===null){for(f=e.left,d=e;f!==null;){let v=f;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Am(n,v.redone);if(v!==null&&v.parent._item===u){f=v;break}f=f.left}for(;d!==null;){let v=d;for(;v!==null&&v.parent._item!==u;)v=v.redone===null?null:Am(n,v.redone);if(v!==null&&v.parent._item===u){d=v;break}d=d.right}}else if(d=null,e.right&&!i){for(f=e;f!==null&&f.right!==null&&(f.right.redone||TO(r,f.right.id)||wee(s.undoStack,f.right.id)||wee(s.redoStack,f.right.id));)for(f=f.right;f.redone;)f=Am(n,f.redone);if(f&&f.right!==null)return null}else f=g._map.get(e.parentSub)||null;const p=Kf(o,l),_=Ys(l,p),y=new rc(_,f,f&&f.lastId,d,d&&d.id,g,e.parentSub,e.content.copy());return e.redone=_,dq(y,!0),y.integrate(n,0),y};class rc extends hq{constructor(e,t,r,i,s,a,o,l){super(e,l.getLength()),this.origin=r,this.left=t,this.right=i,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=l,this.info=this.content.isCountable()?tee:0}set marker(e){(this.info&AB)>0!==e&&(this.info^=AB)}get marker(){return(this.info&AB)>0}get keep(){return(this.info&eee)>0}set keep(e){this.keep!==e&&(this.info^=eee)}get countable(){return(this.info&tee)>0}get deleted(){return(this.info&RB)>0}set deleted(e){this.deleted!==e&&(this.info^=RB)}markDeleted(){this.info|=RB}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=Kf(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=Kf(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===kT&&this.id.client!==this.parent.client&&this.parent.clock>=Kf(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=gee(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Am(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===w0||this.right&&this.right.constructor===w0)this.parent=null;else if(!this.parent)this.left&&this.left.constructor===rc?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===rc&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===kT){const r=JN(t,this.parent);r.constructor===w0?this.parent=null:this.parent=r.content.type}return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=gee(e,e.doc.store,Ys(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let r=this.left,i;if(r!==null)i=r.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,a=new Set;for(;i!==null&&i!==this.right;){if(a.add(i),s.add(i),KI(this.origin,i.origin)){if(i.id.client<this.id.client)r=i,s.clear();else if(KI(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&a.has(JN(e.doc.store,i.origin)))s.has(JN(e.doc.store,i.origin))||(r=i,s.clear());else break;i=i.right}this.left=r}if(this.left!==null){const r=this.left.right;this.right=r,this.left.right=this}else{let r;if(this.parentSub!==null)for(r=this.parent._map.get(this.parentSub)||null;r!==null&&r.left!==null;)r=r.left;else r=this.parent._start,this.parent._start=this;this.right=r}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(e)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),hme(e.doc.store,this),this.content.integrate(e,this),vee(e,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(e)}else new w0(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;e!==null&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;e!==null&&e.deleted;)e=e.left;return e}get lastId(){return this.length===1?this.id:Ys(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&KI(e.origin,this.lastId)&&this.right===e&&KI(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&this.redone===null&&e.redone===null&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){const t=this.parent._searchMarker;return t&&t.forEach(r=>{r.p===e&&(r.p=this,!this.deleted&&this.countable&&(r.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,this.right!==null&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){const t=this.parent;this.countable&&this.parentSub===null&&(t._length-=this.length),this.markDeleted(),Rk(e.deleteSet,this.id.client,this.id.clock,this.length),vee(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw zv();this.content.gc(e),t?S$e(e,this,new w0(this.id,this.length)):this.content=new Mk(this.length)}write(e,t){const r=t>0?Ys(this.id.client,this.id.clock+t-1):this.origin,i=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&vU|(r===null?0:Fg)|(i===null?0:Zy)|(s===null?0:Sk);if(e.writeInfo(a),r!==null&&e.writeLeftID(r),i!==null&&e.writeRightID(i),r===null&&i===null){const o=this.parent;if(o._item!==void 0){const l=o._item;if(l===null){const c=y$e(o);e.writeParentInfo(!0),e.writeString(c)}else e.writeParentInfo(!1),e.writeLeftID(l.id)}else o.constructor===String?(e.writeParentInfo(!0),e.writeString(o)):o.constructor===kT?(e.writeParentInfo(!1),e.writeLeftID(o)):zv();s!==null&&e.writeString(s)}this.content.write(e,t)}}const Nme=(n,e)=>bWe[e&vU](n),bWe=[()=>{zv()},nWe,aWe,tWe,cWe,iWe,sWe,vWe,lWe,rWe,()=>{zv()}],SWe=10;class R0 extends hq{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor!==e.constructor?!1:(this.length+=e.length,!0)}integrate(e,t){zv()}write(e,t){e.writeInfo(SWe),Fa(e.restEncoder,this.length-t)}getMissing(e,t){return null}}const Pme=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof Wy<"u"?Wy:{},Dme="__ $YJS$ __";Pme[Dme]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Pme[Dme]=!0;let Ree=!1;const Cm=new sx;function Lme(n){const e=Cm.getMap(),[,t]=it.useState(0);if(it.useEffect(()=>{function r(){t(i=>1-i)}return e.observe(r),()=>{e.unobserve(r)}},[e,t]),e.has(n))return e.get(n)}function CO(n){const e=Lme(n);if(Mn(e))return e}function Ume(n){const e=Lme(n);if(!(!xe(e)||!(e instanceof Hv)))return e}function Bme(n,e,t){const r=Cm.getMap();if(!r.has(n))switch(e){case 0:case 1:r.set(n,t);break}}function EWe(n,e){Bme(n,0,e)}function Fme(n,e){const t=new Hv(e);Bme(n,1,t)}function Np(n,e){Cm.getMap().set(n,e)}function xWe(n,e){const t=Cm.getMap(),r=new Hv(e);t.set(n,r)}function zme(n,e){const t=Cm.getMap();function r(i){const s=t.get(n);for(let a=0;a<i.length;++a)(i[a].target===t||i[a].target===s)&&e(s)}return t.has(n)&&e(t.get(n)),t.observeDeep(r),()=>{t.observeDeep(r)}}function TWe(n,e){return zme(n,t=>{Mn(t)&&e(t)})}function wWe(n,e){return zme(n,t=>{t instanceof Hv&&e(t.toJSON())})}const US=H1("modem",["second"],n=>{if(US.session(n))switch(n.target){case"second":!Ree&&n.data%2===0&&US.emit(n.player,"modem:join");break;case"join":n.sender!==US.id()&&US.reply(n,"joinack",bue(g$e(Cm)));break;case"joinack":n.sender!==US.id()&&(Ree=!0,hee(Cm,Ig(n.data),Cm));break;case"sync":{n.sender!==US.id()&&xe(n.data)&&hee(Cm,Ig(n.data),Cm);break}}});function jme(n,e){e!==Cm&&US.emit("","modem:sync",bue(n))}Cm.on("update",jme);Cm.on("destroy",()=>{Cm.off("update",jme)});const RWe=`desc;$DKGRAYname and type of codepage
`,AWe=Object.freeze(Object.defineProperty({__proto__:null,default:RWe},Symbol.toStringTag,{value:"Module"})),CWe="desc;changes object into specified element",MWe=Object.freeze(Object.defineProperty({__proto__:null,default:CWe},Symbol.toStringTag,{value:"Module"})),kWe="desc;like #play but for sound effects",OWe=Object.freeze(Object.defineProperty({__proto__:null,default:kWe},Symbol.toStringTag,{value:"Module"})),IWe="",NWe=Object.freeze(Object.defineProperty({__proto__:null,default:IWe},Symbol.toStringTag,{value:"Module"})),PWe="",DWe=Object.freeze(Object.defineProperty({__proto__:null,default:PWe},Symbol.toStringTag,{value:"Module"})),LWe="",UWe=Object.freeze(Object.defineProperty({__proto__:null,default:LWe},Symbol.toStringTag,{value:"Module"})),BWe="",FWe=Object.freeze(Object.defineProperty({__proto__:null,default:BWe},Symbol.toStringTag,{value:"Module"})),zWe="",jWe=Object.freeze(Object.defineProperty({__proto__:null,default:zWe},Symbol.toStringTag,{value:"Module"})),HWe="",qWe=Object.freeze(Object.defineProperty({__proto__:null,default:HWe},Symbol.toStringTag,{value:"Module"})),VWe="",GWe=Object.freeze(Object.defineProperty({__proto__:null,default:VWe},Symbol.toStringTag,{value:"Module"})),$We="",WWe=Object.freeze(Object.defineProperty({__proto__:null,default:$We},Symbol.toStringTag,{value:"Module"})),YWe="",XWe=Object.freeze(Object.defineProperty({__proto__:null,default:YWe},Symbol.toStringTag,{value:"Module"})),KWe="",ZWe=Object.freeze(Object.defineProperty({__proto__:null,default:KWe},Symbol.toStringTag,{value:"Module"})),QWe="",JWe=Object.freeze(Object.defineProperty({__proto__:null,default:QWe},Symbol.toStringTag,{value:"Module"})),eYe="",tYe=Object.freeze(Object.defineProperty({__proto__:null,default:eYe},Symbol.toStringTag,{value:"Module"})),nYe="",rYe=Object.freeze(Object.defineProperty({__proto__:null,default:nYe},Symbol.toStringTag,{value:"Module"})),iYe="",sYe=Object.freeze(Object.defineProperty({__proto__:null,default:iYe},Symbol.toStringTag,{value:"Module"})),aYe="",oYe=Object.freeze(Object.defineProperty({__proto__:null,default:aYe},Symbol.toStringTag,{value:"Module"})),lYe=`desc;$DKGRAYstarts a section of an if-do-done block
`,cYe=Object.freeze(Object.defineProperty({__proto__:null,default:lYe},Symbol.toStringTag,{value:"Module"})),uYe=`desc;$DKGRAYcompletes an if-do-done block
`,fYe=Object.freeze(Object.defineProperty({__proto__:null,default:uYe},Symbol.toStringTag,{value:"Module"})),hYe="",dYe=Object.freeze(Object.defineProperty({__proto__:null,default:hYe},Symbol.toStringTag,{value:"Module"})),pYe="",mYe=Object.freeze(Object.defineProperty({__proto__:null,default:pYe},Symbol.toStringTag,{value:"Module"})),gYe="",_Ye=Object.freeze(Object.defineProperty({__proto__:null,default:gYe},Symbol.toStringTag,{value:"Module"})),vYe=`desc;$DKGRAYelse logic in an if-do-done block
`,yYe=Object.freeze(Object.defineProperty({__proto__:null,default:vYe},Symbol.toStringTag,{value:"Module"})),bYe=`desc;$DKGRAYconditional else logic in an if-do-done block
`,SYe=Object.freeze(Object.defineProperty({__proto__:null,default:bYe},Symbol.toStringTag,{value:"Module"})),EYe="",xYe=Object.freeze(Object.defineProperty({__proto__:null,default:EYe},Symbol.toStringTag,{value:"Module"})),TYe="",wYe=Object.freeze(Object.defineProperty({__proto__:null,default:TYe},Symbol.toStringTag,{value:"Module"})),RYe="",AYe=Object.freeze(Object.defineProperty({__proto__:null,default:RYe},Symbol.toStringTag,{value:"Module"})),CYe="",MYe=Object.freeze(Object.defineProperty({__proto__:null,default:CYe},Symbol.toStringTag,{value:"Module"})),kYe="",OYe=Object.freeze(Object.defineProperty({__proto__:null,default:kYe},Symbol.toStringTag,{value:"Module"})),IYe="",NYe=Object.freeze(Object.defineProperty({__proto__:null,default:IYe},Symbol.toStringTag,{value:"Module"})),PYe="",DYe=Object.freeze(Object.defineProperty({__proto__:null,default:PYe},Symbol.toStringTag,{value:"Module"})),LYe="",UYe=Object.freeze(Object.defineProperty({__proto__:null,default:LYe},Symbol.toStringTag,{value:"Module"})),BYe=`desc;$DKGRAYhalt until the next cycle
`,FYe=Object.freeze(Object.defineProperty({__proto__:null,default:BYe},Symbol.toStringTag,{value:"Module"})),zYe=`desc;$DKGRAYevals condition for true or false
`,jYe=Object.freeze(Object.defineProperty({__proto__:null,default:zYe},Symbol.toStringTag,{value:"Module"})),HYe="",qYe=Object.freeze(Object.defineProperty({__proto__:null,default:HYe},Symbol.toStringTag,{value:"Module"})),VYe="",GYe=Object.freeze(Object.defineProperty({__proto__:null,default:VYe},Symbol.toStringTag,{value:"Module"})),$Ye="",WYe=Object.freeze(Object.defineProperty({__proto__:null,default:$Ye},Symbol.toStringTag,{value:"Module"})),YYe="",XYe=Object.freeze(Object.defineProperty({__proto__:null,default:YYe},Symbol.toStringTag,{value:"Module"})),KYe="",ZYe=Object.freeze(Object.defineProperty({__proto__:null,default:KYe},Symbol.toStringTag,{value:"Module"})),QYe="",JYe=Object.freeze(Object.defineProperty({__proto__:null,default:QYe},Symbol.toStringTag,{value:"Module"})),eXe="",tXe=Object.freeze(Object.defineProperty({__proto__:null,default:eXe},Symbol.toStringTag,{value:"Module"})),nXe="",rXe=Object.freeze(Object.defineProperty({__proto__:null,default:nXe},Symbol.toStringTag,{value:"Module"})),iXe="",sXe=Object.freeze(Object.defineProperty({__proto__:null,default:iXe},Symbol.toStringTag,{value:"Module"})),aXe="",oXe=Object.freeze(Object.defineProperty({__proto__:null,default:aXe},Symbol.toStringTag,{value:"Module"})),lXe="",cXe=Object.freeze(Object.defineProperty({__proto__:null,default:lXe},Symbol.toStringTag,{value:"Module"})),uXe="",fXe=Object.freeze(Object.defineProperty({__proto__:null,default:uXe},Symbol.toStringTag,{value:"Module"})),hXe="",dXe=Object.freeze(Object.defineProperty({__proto__:null,default:hXe},Symbol.toStringTag,{value:"Module"})),pXe="",mXe=Object.freeze(Object.defineProperty({__proto__:null,default:pXe},Symbol.toStringTag,{value:"Module"})),gXe="",_Xe=Object.freeze(Object.defineProperty({__proto__:null,default:gXe},Symbol.toStringTag,{value:"Module"})),vXe="",yXe=Object.freeze(Object.defineProperty({__proto__:null,default:vXe},Symbol.toStringTag,{value:"Module"})),bXe="",SXe=Object.freeze(Object.defineProperty({__proto__:null,default:bXe},Symbol.toStringTag,{value:"Module"})),EXe="",xXe=Object.freeze(Object.defineProperty({__proto__:null,default:EXe},Symbol.toStringTag,{value:"Module"})),TXe="",wXe=Object.freeze(Object.defineProperty({__proto__:null,default:TXe},Symbol.toStringTag,{value:"Module"})),RXe="",AXe=Object.freeze(Object.defineProperty({__proto__:null,default:RXe},Symbol.toStringTag,{value:"Module"})),CXe="",MXe=Object.freeze(Object.defineProperty({__proto__:null,default:CXe},Symbol.toStringTag,{value:"Module"})),kXe=`desc;$DKGRAYlaunches a bullet
words;dir
words2;dir,kind
`,OXe=Object.freeze(Object.defineProperty({__proto__:null,default:kXe},Symbol.toStringTag,{value:"Module"})),IXe="",NXe=Object.freeze(Object.defineProperty({__proto__:null,default:IXe},Symbol.toStringTag,{value:"Module"})),PXe="",DXe=Object.freeze(Object.defineProperty({__proto__:null,default:PXe},Symbol.toStringTag,{value:"Module"})),LXe="",UXe=Object.freeze(Object.defineProperty({__proto__:null,default:LXe},Symbol.toStringTag,{value:"Module"})),BXe="",FXe=Object.freeze(Object.defineProperty({__proto__:null,default:BXe},Symbol.toStringTag,{value:"Module"})),zXe="",jXe=Object.freeze(Object.defineProperty({__proto__:null,default:zXe},Symbol.toStringTag,{value:"Module"})),HXe="",qXe=Object.freeze(Object.defineProperty({__proto__:null,default:HXe},Symbol.toStringTag,{value:"Module"})),VXe="",GXe=Object.freeze(Object.defineProperty({__proto__:null,default:VXe},Symbol.toStringTag,{value:"Module"})),$Xe="",WXe=Object.freeze(Object.defineProperty({__proto__:null,default:$Xe},Symbol.toStringTag,{value:"Module"})),YXe="",XXe=Object.freeze(Object.defineProperty({__proto__:null,default:YXe},Symbol.toStringTag,{value:"Module"})),KXe="",ZXe=Object.freeze(Object.defineProperty({__proto__:null,default:KXe},Symbol.toStringTag,{value:"Module"})),QXe="",JXe=Object.freeze(Object.defineProperty({__proto__:null,default:QXe},Symbol.toStringTag,{value:"Module"})),eKe="",tKe=Object.freeze(Object.defineProperty({__proto__:null,default:eKe},Symbol.toStringTag,{value:"Module"})),nKe="",rKe=Object.freeze(Object.defineProperty({__proto__:null,default:nKe},Symbol.toStringTag,{value:"Module"})),iKe="",sKe=Object.freeze(Object.defineProperty({__proto__:null,default:iKe},Symbol.toStringTag,{value:"Module"})),aKe="",oKe=Object.freeze(Object.defineProperty({__proto__:null,default:aKe},Symbol.toStringTag,{value:"Module"})),lKe="",cKe=Object.freeze(Object.defineProperty({__proto__:null,default:lKe},Symbol.toStringTag,{value:"Module"})),uKe="",fKe=Object.freeze(Object.defineProperty({__proto__:null,default:uKe},Symbol.toStringTag,{value:"Module"})),hKe="",dKe=Object.freeze(Object.defineProperty({__proto__:null,default:hKe},Symbol.toStringTag,{value:"Module"})),pKe="",mKe=Object.freeze(Object.defineProperty({__proto__:null,default:pKe},Symbol.toStringTag,{value:"Module"})),gKe=`desc;$DKGRAYdesignates an inactive label or comment
`,_Ke=Object.freeze(Object.defineProperty({__proto__:null,default:gKe},Symbol.toStringTag,{value:"Module"})),vKe=`desc;$DKGRAYadds hyperlink text

`,yKe=Object.freeze(Object.defineProperty({__proto__:null,default:vKe},Symbol.toStringTag,{value:"Module"})),bKe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,SKe=Object.freeze(Object.defineProperty({__proto__:null,default:bKe},Symbol.toStringTag,{value:"Module"})),EKe=`desc;$DKGRAYread number input into given stat/flag
`,xKe=Object.freeze(Object.defineProperty({__proto__:null,default:EKe},Symbol.toStringTag,{value:"Module"})),TKe=`desc;$DKGRAYa slider input from 1 to 9 

`,wKe=Object.freeze(Object.defineProperty({__proto__:null,default:TKe},Symbol.toStringTag,{value:"Module"})),RKe=`desc;$DKGRAYlist with label value pairs to pick from
`,AKe=Object.freeze(Object.defineProperty({__proto__:null,default:RKe},Symbol.toStringTag,{value:"Module"})),CKe=`desc;$DKGRAYread text input into given stat/flag
`,MKe=Object.freeze(Object.defineProperty({__proto__:null,default:CKe},Symbol.toStringTag,{value:"Module"})),kKe=`desc;$DKGRAYdesignates a starting point for running code
`,OKe=Object.freeze(Object.defineProperty({__proto__:null,default:kKe},Symbol.toStringTag,{value:"Module"})),IKe=`desc;$DKGRAYwaits until the object can move in the given direction and moves
`,NKe=Object.freeze(Object.defineProperty({__proto__:null,default:IKe},Symbol.toStringTag,{value:"Module"})),PKe=`desc;$DKGRAYwill move the object in the given direction
`,DKe=Object.freeze(Object.defineProperty({__proto__:null,default:PKe},Symbol.toStringTag,{value:"Module"})),LKe=`desc;$DKGRAYcreates a 60x25 space for terrain and object elements
`,UKe=Object.freeze(Object.defineProperty({__proto__:null,default:LKe},Symbol.toStringTag,{value:"Module"})),BKe=`desc;$DKGRAYcustom 8x14 charset
`,FKe=Object.freeze(Object.defineProperty({__proto__:null,default:BKe},Symbol.toStringTag,{value:"Module"})),zKe=`desc;$DKGRAYsets stat to given value

`,jKe=Object.freeze(Object.defineProperty({__proto__:null,default:zKe},Symbol.toStringTag,{value:"Module"})),HKe=`desc;$DKGRAYsends the given message when hotkey is pressed

`,qKe=Object.freeze(Object.defineProperty({__proto__:null,default:HKe},Symbol.toStringTag,{value:"Module"})),VKe=`desc;$DKGRAYread external content and/or handle events
`,GKe=Object.freeze(Object.defineProperty({__proto__:null,default:VKe},Symbol.toStringTag,{value:"Module"})),$Ke=`desc;$DKGRAYread number input into given stat/flag
`,WKe=Object.freeze(Object.defineProperty({__proto__:null,default:$Ke},Symbol.toStringTag,{value:"Module"})),YKe=`desc;$DKGRAYelements that can walk, swim, or be used with #shoot

`,XKe=Object.freeze(Object.defineProperty({__proto__:null,default:YKe},Symbol.toStringTag,{value:"Module"})),KKe=`desc;$DKGRAYcustom palette colors
`,ZKe=Object.freeze(Object.defineProperty({__proto__:null,default:KKe},Symbol.toStringTag,{value:"Module"})),QKe=`desc;$DKGRAYa slider input from 1 to 9 

`,JKe=Object.freeze(Object.defineProperty({__proto__:null,default:QKe},Symbol.toStringTag,{value:"Module"})),eZe=`desc;$DKGRAYlist with label value pairs to pick from
`,tZe=Object.freeze(Object.defineProperty({__proto__:null,default:eZe},Symbol.toStringTag,{value:"Module"})),nZe=`desc;$DKGRAYterrain for solid, walkable, swimable board elements
`,rZe=Object.freeze(Object.defineProperty({__proto__:null,default:nZe},Symbol.toStringTag,{value:"Module"})),iZe=`desc;$DKGRAYread text input into given stat/flag
`,sZe=Object.freeze(Object.defineProperty({__proto__:null,default:iZe},Symbol.toStringTag,{value:"Module"})),aZe=`desc;$DKGRAYadds text
`,oZe=Object.freeze(Object.defineProperty({__proto__:null,default:aZe},Symbol.toStringTag,{value:"Module"})),lZe=`header;zss controls and inputs
section;keyboard input
option;arrow keys;move
option;shift + arrow keys;shoot
option;enter;ok / accept
option;escape;cancel / close
option;tab;menu / action
section;controller input
option;left stick;move
option;right stick;aim
option;a;ok / accept
option;b;cancel / close
option;y;menu / action
option;x;shoot
option;triggers;shoot
`,cZe=Object.freeze(Object.defineProperty({__proto__:null,default:lZe},Symbol.toStringTag,{value:"Module"})),uZe=`header;developer commands
option;#books;list books in memory
option;#pages;list pages in opened book
option;@[pagetype:]page name;create & edit a new codepage in the currently opened book
option;#trash;list books and pages from open book you can delete
option;#save;flush state to register
option;#share;creates a click to copy share url and QR code
`,fZe=Object.freeze(Object.defineProperty({__proto__:null,default:uZe},Symbol.toStringTag,{value:"Module"})),hZe=`header;H E L P
keyboard input
option;? or /;open terminal
option;esc;close terminal, scroll, or editor
option;tab;change layout
option;up or down arrow keys;navigate terminal items
option;left or right arrow keys;change terminal items
option;enter;activate terminal items
option;alt + arrow keys;skip words and terminal lines
option;ctrl + up / down arrow keys;input history
$32
option;controls;zss controls and inputs
!helpcontrols;read help controls
$32
option;text;zss text and inputs
!helptext;read help text
$32
option;developer;developer commands
!helpdeveloper;read help developer
$32
option;player;player settings & hotkeys
!helpplayer;read help player
`,dZe=Object.freeze(Object.defineProperty({__proto__:null,default:hZe},Symbol.toStringTag,{value:"Module"})),pZe=`$white no pages found
$white use @ to create a page
$white @board name of board
$white @object name of object
$white @terrain name of terrain
$white You can omit the type and it will default to object
$white @object name of object
$white @name of object`,mZe=Object.freeze(Object.defineProperty({__proto__:null,default:pZe},Symbol.toStringTag,{value:"Module"})),gZe=`header;player settings
#set user "name goes here"
`,_Ze=Object.freeze(Object.defineProperty({__proto__:null,default:gZe},Symbol.toStringTag,{value:"Module"})),vZe=`header;text formatting
section;typography
plain text
use"@quoted strings for special chars"
$$0-255 for ascii chars $159$176$240
use color names like $RED$$red$BLUE to change foreground color
use color names like $ONGREEN$$ongreen$ONCLEAR to change background color
use onclear $WHITE$$onclear$BLUE to change background to transparent
section;hyperlinks
option;!hotkey label <shortcut> [shortcutword];
send the given #label when the <shortcut> is pressed
!openit https://github.com/ianstormtaylor/is-hotkey;$BLUEuses is-hotkey
option;!range flag [minword] [maxword];
uses the standard 1 to 9 values input range
option;!select flag ...list of <word> <value> pairs;
gives a user a way to cycle through preset values
option;!text flag;
write user text input into a flag
`,yZe=Object.freeze(Object.defineProperty({__proto__:null,default:vZe},Symbol.toStringTag,{value:"Module"})),bZe=`section;#autowah on
#autowah <number>
$white 0-100, 0 is off, 100 is full volume
#autowah basefrequency <frequency>
$white The frequency the filter is set to at the
$white low point of the wah.
#autowah octaves <number>
$white The number of octaves above the baseFrequency 
$white the filter will sweep to when fully open.
#autowah sensitivity <number>
$white The decibel threshold sensitivity for 
$white the incoming signal.
$white Normal range of -40 to 0.
#autowah gain <number>
$white Controls the loudness of the effect.
#autowah follower <seconds>
$white Sets the smoothing time for the effect.`,SZe=Object.freeze(Object.defineProperty({__proto__:null,default:bZe},Symbol.toStringTag,{value:"Module"})),EZe=`section;#distort on
#distort <number>
$white 0-100, 0 is off, 100 is full volume
#distort distortion <number>
$white 0 or higher, controls strength of effect.
#distort oversample <2x|4x|none>
$white oversample improves quality.`,xZe=Object.freeze(Object.defineProperty({__proto__:null,default:EZe},Symbol.toStringTag,{value:"Module"})),TZe=`section;#echo on
#echo <number>
$white 0-100, 0 is off, 100 is full volume
#echo delaytime <seconds>
$white duration between echos.
#echo feedback <number>
$white A number that is between [0, 1]
$white 1 is forever feedback and 0 is none.`,wZe=Object.freeze(Object.defineProperty({__proto__:null,default:TZe},Symbol.toStringTag,{value:"Module"})),RZe=`!fcrushscroll hk f F next;#fcrush on
!echoscroll hk e E next;#echo on
!reverbscroll hk r R next;#reverb on
!phaserscroll hk p P next;#phaser on
!distortscroll hk d D next;#distort on
!vibratoscroll hk v V next;#vibrato on
!autowahscroll hk a A next;#autowah on`,AZe=Object.freeze(Object.defineProperty({__proto__:null,default:RZe},Symbol.toStringTag,{value:"Module"})),CZe=`section;#fcrush on
#fcrush <number>
$white 0-100, 0 is off, 100 is full volume
#fcrush rate <number>
$white 1 or higher, more rate, more crush`,MZe=Object.freeze(Object.defineProperty({__proto__:null,default:CZe},Symbol.toStringTag,{value:"Module"})),kZe=`section;helper scrolls
!termscroll hk t T next;terminal commands
!dictionary hk d D next;dictionary of commands
!charscroll hk a A next;char
!colorscroll hk c C next;color
!bgscroll hk b B next;bg
!notesscroll hk n N next;notes
!synthscroll hk s S next;synth
!effectsscroll hk e E next;effects
!voicescroll hk v V next;tts voices
`,OZe=Object.freeze(Object.defineProperty({__proto__:null,default:kZe},Symbol.toStringTag,{value:"Module"})),IZe=`"duration             cdefgab = notes 
"y = 64th note        x = rest
"t = 32nd note        
"s = 16th note        drums
"i = eight note       0 = hihat
"q = quarter note     1 = open hihat
"h = half note        2 = cowbell
"w = whole note       p = clap
"mods                 4 = high snare
"3 = triplet          5 = high woodblock
". = time and a half  6 = low snare
"# = sharp            7 = low tom
"! = flat             8 = low woodblock
"+ = increase octave  9 = bass drum
"- = decrease octave`,NZe=Object.freeze(Object.defineProperty({__proto__:null,default:IZe},Symbol.toStringTag,{value:"Module"})),PZe=`section;sine, square, triangle, sawtooth
#synth phase <degrees>
$white The phase is the starting position within 
$white the oscillator's cycle. For example a phase 
$white of 180 would start halfway through the
$white oscillator's cycle.
section;amsine, amsquare, amtriangle, amsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
section;fmsine, fmsquare, fmtriangle, fmsawtooth
#synth harmonicity <number>
$white Harmonicity is the frequency ratio between 
$white the carrier and the modulator oscillators.
$white A harmonicity of 1 gives both oscillators 
$white the same frequency. Harmonicity = 2 
$white means a change of an octave.
#synth modtype <sine, square, triangle, sawtooth>
#synth modenv <a> <d> <s> <r> - in seconds
#synth modindex <degrees>
$white The modulation index which is in essence
$white the depth or amount of the modulation.
$white In other terms it is the ratio of the 
$white frequency of the modulating signal (mf) 
$white to the amplitude of the modulating signal 
$white (ma) -- as in ma/mf
section;fatsine, fatsquare, fattriangle, fatsawtooth
#synth phase <degrees>
#synth count <number>
$white This sets the number of oscillators to 
$white spread along the given range.
#synth spread <cents>
$white This signals the number of cents between
$white oscillators.`,DZe=Object.freeze(Object.defineProperty({__proto__:null,default:PZe},Symbol.toStringTag,{value:"Module"})),LZe=`section;#phaser on
#phaser <number>
$white 0-100, 0 is off, 100 is full volume
#phaser frequency <frequency>
$white The rate of oscilation of the effect.
#phaser octaves <number>
$white Controls the range of the effect.
#phaser basefrequency <frequency>
$white The base frequency of the filters.
`,UZe=Object.freeze(Object.defineProperty({__proto__:null,default:LZe},Symbol.toStringTag,{value:"Module"})),BZe=`section;pulse
#synth width <range>
$white A number that is between [-1, 1] altering
$white this value changes the shape of the square
$white wave`,FZe=Object.freeze(Object.defineProperty({__proto__:null,default:BZe},Symbol.toStringTag,{value:"Module"})),zZe=`section;pwm
#synth modfreq <frequency>
$white This sets the frequency of change for the 
$white pulse width of this oscillator.`,jZe=Object.freeze(Object.defineProperty({__proto__:null,default:zZe},Symbol.toStringTag,{value:"Module"})),HZe=`section;#reverb on
#reverb <number>
$white 0-100, 0 is off, 100 is full volume
#reverb predelay <seconds>
$white The amount of time before the reverb
$white is fully ramped in.
#reverb decay <seconds>
$white The duration of the reverb.
`,qZe=Object.freeze(Object.defineProperty({__proto__:null,default:HZe},Symbol.toStringTag,{value:"Module"})),VZe=`switching voices
#synth <sine, square, triangle, sawtooth> 
#synth <pwm, pulse, bells, doot>
#synth <retro, buzz, clang, metallic>

voice settings
#synth restart - resets voice to default
#synth vol <db> - control volume
#synth port <seconds>
#synth env <attack> <delay> <sustain> <release>

voice specific 
!oscscroll hk o O next;sine, square, triangle, sawtooth
!pwmscroll hk m M next;pwm
!pulsescroll hk p P next;pulse`,GZe=Object.freeze(Object.defineProperty({__proto__:null,default:VZe},Symbol.toStringTag,{value:"Module"})),$Ze=`press$white C$yellow to chat
press$white #$yellow to run a quick command
section;dev-tools
#gadget
$white toggles inspector tool on/off
#zztrandom
$white downloads random from the museumofzzt api
#zztsearch <field> <value>
$white searches the museumofzzt api for zzt games
section;multi-player
#set user <name>
$white sets your display name when talking to others
#joincode OR ctrl+O 
$white starts a multi-player session showing a
$white QR code. It also provides are sharable link
$white you can give to other to join the game.`,WZe=Object.freeze(Object.defineProperty({__proto__:null,default:$Ze},Symbol.toStringTag,{value:"Module"})),YZe=`section;#vibrato on
#vibrato <number>
$white 0-100, 0 is off, 100 is full volume
#vibrato maxdelay <seconds>
$white longer delay increases the vibrato`,XZe=Object.freeze(Object.defineProperty({__proto__:null,default:YZe},Symbol.toStringTag,{value:"Module"})),KZe=`!copyit "ar-SA-HamedNeural";ar-SA-HamedNeural
!copyit "ar-SA-ZariyahNeural";ar-SA-ZariyahNeural
!copyit "de-DE-AmalaNeural";de-DE-AmalaNeural
!copyit "de-DE-ConradNeural";de-DE-ConradNeural
!copyit "de-DE-KatjaNeural";de-DE-KatjaNeural
!copyit "de-DE-KillianNeural";de-DE-KillianNeural
!copyit "en-US-AnaNeural";en-US-AnaNeural
!copyit "en-US-AndrewNeural";en-US-AndrewNeural
!copyit "en-US-AriaNeural";en-US-AriaNeural
!copyit "en-US-ChristopherNeural";en-US-ChristopherNeural
!copyit "en-US-EricNeural";en-US-EricNeural
!copyit "en-US-GuyNeural";en-US-GuyNeural
!copyit "en-US-JennyNeural";en-US-JennyNeural
!copyit "en-US-MichelleNeural";en-US-MichelleNeural
!copyit "en-US-RogerNeural";en-US-RogerNeural
!copyit "en-US-SteffanNeural";en-US-SteffanNeural
!copyit "es-ES-AlvaroNeural";es-ES-AlvaroNeural
!copyit "es-ES-ElviraNeural";es-ES-ElviraNeural
!copyit "fr-FR-DeniseNeural";fr-FR-DeniseNeural
!copyit "fr-FR-EloiseNeural";fr-FR-EloiseNeural
!copyit "fr-FR-HenriNeural";fr-FR-HenriNeural`,ZZe=Object.freeze(Object.defineProperty({__proto__:null,default:KZe},Symbol.toStringTag,{value:"Module"})),tP={},rT={};function QZe(){return{id:vc(),board:"",layers:[],scroll:[],sidebar:[]}}const JZe=new Set(["rn","range","sl","select","nm","number","tx","text","zssedit","charedit","coloredit","bgedit"]),eQe=new Set(["tx","text"]),tQe={rn:1,range:1,sl:0,select:0,nm:0,number:0,tx:"",text:"",zssedit:"",charedit:"",coloredit:""},Aee={};let nQe=n=>{let e=Aee[n];return xe(e)||(Aee[n]=e=QZe()),e};function NB(n){return nQe(n)}function pq(n){return xe(tP[n])||(tP[n]=[]),tP[n]}function rQe(n,e,t){Object.values(rT).forEach(r=>{if(r[e]!==void 0){const i=V1(n.id(),e);Mn(t)&&Np(i,t),Vn(t)&&xWe(i,t)}})}function iQe(n){const e=pq(n);return tP[n]=[],e}function Cee(n){const e=[];let t;for(let r=0;r<n.length;++r){const i=n[r],s=Vn(i)&&xe($H(i));xe(t)&&t!==s&&e.push(" "),e.push(i),t=s}return e}function sQe(n,e){pq(n).push(e)}function aQe(n,e,t,r,i=()=>0,s=bm){const a=[e,t,...r],o=qr(`${a[3]}`),l={...Oe};function c(u,f){xe(f)&&f!==i(u)&&(Oe.board=l.board,Oe.element=l.element,Oe.elementfocus=l.elementfocus,s(u,f))}if(JZe.has(o)){const u=`${a[2]}`;rT[e]=rT[e]??{};const f=i(u)??tQe[o];if(rT[e][u]===void 0){const d=V1(e,u);Mn(f)&&EWe(d,f),Vn(f)&&Fme(d,f),eQe.has(o)?rT[e][u]=wWe(d,g=>{c(u,g)}):rT[e][u]=TWe(d,g=>{c(u,g)})}}pq(n).push(a)}const Mee=Object.assign({"./editor/codepagename.txt":AWe,"./editor/command/become.txt":MWe,"./editor/command/bgplay.txt":OWe,"./editor/command/bgvol.txt":NWe,"./editor/command/bind.txt":DWe,"./editor/command/board.txt":UWe,"./editor/command/bpm.txt":FWe,"./editor/command/break.txt":jWe,"./editor/command/change.txt":qWe,"./editor/command/char.txt":GWe,"./editor/command/charset.txt":WWe,"./editor/command/clear.txt":XWe,"./editor/command/color.txt":ZWe,"./editor/command/continue.txt":JWe,"./editor/command/copy.txt":tYe,"./editor/command/cycle.txt":rYe,"./editor/command/die.txt":sYe,"./editor/command/distort.txt":oYe,"./editor/command/do.txt":cYe,"./editor/command/done.txt":fYe,"./editor/command/duplicate.txt":dYe,"./editor/command/echo.txt":mYe,"./editor/command/edge.txt":_Ye,"./editor/command/else.txt":yYe,"./editor/command/elseif.txt":SYe,"./editor/command/end.txt":xYe,"./editor/command/endgame.txt":wYe,"./editor/command/endwith.txt":AYe,"./editor/command/fcrush.txt":MYe,"./editor/command/fetch.txt":OYe,"./editor/command/fetchwith.txt":NYe,"./editor/command/foreach.txt":DYe,"./editor/command/go.txt":UYe,"./editor/command/idle.txt":FYe,"./editor/command/if.txt":jYe,"./editor/command/lock.txt":qYe,"./editor/command/oneof.txt":GYe,"./editor/command/oneofwith.txt":WYe,"./editor/command/palette.txt":XYe,"./editor/command/phaser.txt":ZYe,"./editor/command/pivot.txt":JYe,"./editor/command/play.txt":tXe,"./editor/command/put.txt":rXe,"./editor/command/putwith.txt":sXe,"./editor/command/readbin.txt":oXe,"./editor/command/readjson.txt":cXe,"./editor/command/readline.txt":fXe,"./editor/command/readrexpaint.txt":dXe,"./editor/command/remix.txt":mXe,"./editor/command/repeat.txt":_Xe,"./editor/command/restore.txt":yXe,"./editor/command/reverb.txt":SXe,"./editor/command/revert.txt":xXe,"./editor/command/run.txt":wXe,"./editor/command/runwith.txt":AXe,"./editor/command/set.txt":MXe,"./editor/command/shoot.txt":OXe,"./editor/command/shootwith.txt":NXe,"./editor/command/shove.txt":DXe,"./editor/command/snapshot.txt":UXe,"./editor/command/synth.txt":FXe,"./editor/command/toast.txt":jXe,"./editor/command/tts.txt":qXe,"./editor/command/ttsvol.txt":GXe,"./editor/command/twitchbroadcast.txt":WXe,"./editor/command/twitchchat.txt":XXe,"./editor/command/unlock.txt":ZXe,"./editor/command/vibrato.txt":JXe,"./editor/command/vol.txt":tKe,"./editor/command/waitfor.txt":rKe,"./editor/command/walk.txt":sKe,"./editor/command/weave.txt":oKe,"./editor/command/while.txt":cKe,"./editor/command/with.txt":fKe,"./editor/command/write.txt":dKe,"./editor/command/zap.txt":mKe,"./editor/comment.txt":_Ke,"./editor/hyperlink.txt":yKe,"./editor/hyperlink/hotkey.txt":SKe,"./editor/hyperlink/number.txt":xKe,"./editor/hyperlink/range.txt":wKe,"./editor/hyperlink/select.txt":AKe,"./editor/hyperlink/text.txt":MKe,"./editor/label.txt":OKe,"./editor/shortgo.txt":NKe,"./editor/shorttry.txt":DKe,"./editor/stat/board.txt":UKe,"./editor/stat/charset.txt":FKe,"./editor/stat/const.txt":jKe,"./editor/stat/hotkey.txt":qKe,"./editor/stat/loader.txt":GKe,"./editor/stat/number.txt":WKe,"./editor/stat/object.txt":XKe,"./editor/stat/palette.txt":ZKe,"./editor/stat/range.txt":JKe,"./editor/stat/select.txt":tZe,"./editor/stat/terrain.txt":rZe,"./editor/stat/text.txt":sZe,"./editor/text.txt":oZe,"./help/controls.txt":cZe,"./help/developer.txt":fZe,"./help/menu.txt":dZe,"./help/nopages.txt":mZe,"./help/player.txt":_Ze,"./help/text.txt":yZe,"./refscroll/autowahscroll.txt":SZe,"./refscroll/distortscroll.txt":xZe,"./refscroll/echoscroll.txt":wZe,"./refscroll/effectsscroll.txt":AZe,"./refscroll/fcrushscroll.txt":MZe,"./refscroll/menu.txt":OZe,"./refscroll/notesscroll.txt":NZe,"./refscroll/oscscroll.txt":DZe,"./refscroll/phaserscroll.txt":UZe,"./refscroll/pulsescroll.txt":FZe,"./refscroll/pwmscroll.txt":jZe,"./refscroll/reverbscroll.txt":qZe,"./refscroll/synthscroll.txt":GZe,"./refscroll/termscroll.txt":WZe,"./refscroll/vibratoscroll.txt":XZe,"./refscroll/voicescroll.txt":ZZe}),Hme={};sb(Mee).forEach(n=>{const e=n.replace(".txt","").replace("./","").replaceAll("/",":");Hme[e]=Mee[n].default});function qme(n){const e=qr(n.trim().replaceAll(`
`,"").replace(/:+$/,"")),t=Hme[e];if(xe(t))return t;const{target:r,path:i}=EE(e);switch(r){case"editor":{const s=EE(i);switch(s.target){case"command":if(s.path.length)return`desc;$DKGRAYsends the message ${s.path}`}break}}}function Vme(n,e){const t=(n??"").split(`
`);for(let r=0;r<t.length;++r)e(t[r].split(";"))}function oQe(n,e){const[t,...r]=e,i=r[0]??"",s=r[1]??"";switch(qr(t.trim())){case"header":y_(xt,n,i);break;case"section":DS(xt,n,i);break;case"option":Tm(xt,n,i,s);break;default:t.trimStart().startsWith("!")?N7(xt,n,t.trimStart().slice(1),i):es(xt,n,t);break}}function lQe(n){const e={};return Vme(n,t=>{const[r,...i]=t,s=i[0]??"";e[r]=s}),e}function Qy(n,e=!1){const[t]=ln(n,0,[Dt.ANY]);if(e&&F0(t)){const[r,i,s]=ln(n,0,[Dt.DIR,Dt.MAYBE_NAME]);return Vn(i)&&i.startsWith(":")?{targetdir:r,label:[i.substring(1).trim(),...n.slice(s)].join(" ")}:{targetdir:r,label:n.slice(s-1).join(" ")}}else if(Vn(t)){const[r,i,s]=ln(n,0,[Dt.NAME,Dt.MAYBE_NAME]);if(Vn(i)&&i.startsWith(":")){const o=[i.substring(1).trim(),...n.slice(s)];return{targetname:r,label:o.join(" ")}}return{targetname:"self",label:[r,...n.slice(s-1)].join(" ")}}return{targetname:"",label:""}}function bS(){COe(xt,yT())}function iT(n){Vme(qme(`help:${n}`),e=>oQe(Oe.elementfocus,e))}function kee(n){switch(n.label){case"helpmenu":iT("menu");break;case"helpcontrols":iT("controls");break;case"helptext":iT("text");break;case"helpdeveloper":iT("developer");break;case"helpplayer":iT("player");break;default:{const e=Av(b0.MAIN),t=Bpe(e);xe(n.targetname)?fL(n.targetname,n.label,void 0,t):xe(n.targetdir)&&fL(n.targetdir.destpt,n.label,void 0,t);break}}}const cQe=mb().command("endgame",()=>(ole(xt,Oe.elementfocus),0)).command("shortsend",(n,e)=>{const t=Qy(e);return kee(t),0}).command("send",(n,e)=>{const t=Qy(e,!0);return kee(t),0}).command("stat",(n,e)=>(SOe(xt,Oe.elementfocus,e.map(pu).join(" ")),0)).command("text",(n,e)=>{const t=e.map(pu).join(" ");if(xe(Oe.element)&&Oe.elementisplayer){const{user:r}=g1(Oe.elementid),i=Vn(r)?r:"player";Oe.element.tickertext=`${i}:$WHITE ${t}`,Oe.element.tickertime=Oe.timestamp;const s=Vm(Oe.element);Oke(xt,Oe.elementid,`$${Sn[s.color]}$ON${Sn[s.bg]}$${s.char}$ONCLEAR$CYAN ${i}:$WHITE ${t}`),T_(xt,Oe.elementid,void 0,"text","chat:message:game",`${i}:${t}`)}return 0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=pu(t),s=Qy(r);if(xe(s.targetname)){const{user:a}=g1(Oe.elementid),o=Vn(a)?a:"player",l=Vm(Oe.element),c=`$${Sn[l.color]}$ON${Sn[l.bg]}$${l.char}$ONCLEAR $WHITE${o}$BLUE ${i}`;xs(xt,Oe.elementid,`!${s.targetname}:${s.label};${c}`)}return 0}).command("config",(n,e)=>{const[t,r]=ln(e,0,[Dt.MAYBE_NAME,Dt.MAYBE_STRING]);return Vn(t)&&Vn(r)?hY(xt,Oe.elementfocus,t,r):aOe(xt,Oe.elementfocus),0}).command("bookcreate",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]),r=mge(t);return xe(r)&&n.command("bookopen",r.id),0}).command("bookopen",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Fy(t);return xe(r)?(hY(xt,Oe.elementfocus,"selected",r.id),bS()):Si(xt,Oe.elementfocus,"bookopen",`book ${t} not found`),0}).command("booktrash",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Av(b0.MAIN),i=Fy(t);return xe(i)&&(r===i&&pge(b0.MAIN,""),det(t),xs(xt,Oe.elementfocus,`trashed [book] ${i.name}`),bS(),n.command("pages")),0}).command("boardopen",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Pp(t);return xe(r)&&_T(Oe.book,Oe.elementfocus,r.id,{x:Mg(0,Yn-1),y:Mg(0,Ti-1)},!0),0}).command("pageopen",(n,e)=>{const[t,r]=ln(e,0,[Dt.NAME,Dt.MAYBE_NAME]);let i,s;const a=Py();for(let o=0;o<a.length&&(s=a[o],i=gk(s,t),!xe(i));++o);if(xe(i)&&xe(s)){const o=Mh(i),l=[i.id,r];Fme(ule(s.id,l),i.code);const c=Vx(i);cOe(xt,Oe.elementfocus,s.id,l,c,`${o} - ${s.name}`)}else Si(xt,"pageopen",`page ${t} not found`,Oe.elementfocus);return 0}).command("pagetrash",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=m1(b0.MAIN),i=Cpe(r,t);if(xe(t)){const s=Mh(i),a=Vx(i);xs(xt,Oe.elementfocus,`trashed [${a}] ${s}`),bS(),n.command("pages")}return 0}).command("help",(n,e)=>{const t=e.map(pu).join(" ")||"menu";return n.command(`help${t}`),0}).command("books",()=>{DS(xt,Oe.elementfocus,"books");const n=Av(b0.MAIN);Tm(xt,Oe.elementfocus,"main",`${n?.name??"empty"} $GREEN${n?.id??""}`);const e=Av(b0.MAIN);Tm(xt,Oe.elementfocus,"content",`${e?.name??"empty"} ${e?.id??""}`),jj(xt,Oe.elementfocus,7);const t=Py();return t.length?t.forEach(r=>{es(xt,Oe.elementfocus,`!bookopen ${r.id};${r.name}`)}):Ny(xt,Oe.elementfocus,"no books found"),es(xt,Oe.elementfocus,"!bookcreate;create a new book"),0}).command("pages",()=>{const n=m1(b0.MAIN);if(!xe(n))return 0;DS(xt,Oe.elementfocus,"pages"),Tm(xt,Oe.elementfocus,"main",`${n.name} $GREEN${n.id}`),n.pages.length?OM(n).forEach(r=>{const i=Mh(r),s=Vx(r);es(xt,Oe.elementfocus,`!pageopen ${r.id};$blue[${s}]$white ${i}`)}):(es(xt,Oe.elementfocus,""),iT("nopages"));const e=Py();for(let t=0;t<e.length;++t){const r=e[t];r.id!==n.id&&(Tm(xt,Oe.elementfocus,"content",`${r.name} $GREEN${r.id}`),OM(r).forEach(s=>{const a=Mh(s),o=Vx(s);es(xt,Oe.elementfocus,`!pageopen ${s.id};$blue[${o}]$white ${a}`)}))}return 0}).command("boards",()=>{DS(xt,Oe.elementfocus,"boards");const n=m1(b0.MAIN);if(xe(n)){Tm(xt,Oe.elementfocus,"main",`${n.name} $GREEN${n.id}`);const t=OM(n);t.filter(r=>C1(r)===ni.BOARD).forEach(r=>{const i=Mh(r);es(xt,Oe.elementfocus,`!boardopen ${r.id};$blue[#goto]$white ${i}`)}),t.length===0&&(es(xt,Oe.elementfocus,""),Ny(xt,Oe.elementfocus,"$white no boards found"),Ny(xt,Oe.elementfocus,"$white use @ to create a board"),Ny(xt,Oe.elementfocus,"$white @board name of board"))}const e=Py();for(let t=0;t<e.length;++t){const r=e[t];r.id!==n.id&&(Tm(xt,Oe.elementfocus,"content",`${r.name} $GREEN${r.id}`),OM(r).filter(s=>C1(s)===ni.BOARD).forEach(s=>{const a=Mh(s);es(xt,Oe.elementfocus,`!boardopen ${s.id};$blue[#goto]$white ${a}`)}))}return 0}).command("trash",()=>{DS(xt,Oe.elementfocus,"$REDTRASH"),Ny(xt,Oe.elementfocus,"books");const n=Py();n.length&&(n.forEach(t=>{es(xt,Oe.elementfocus,`!booktrash ${t.id};$REDTRASH ${t.name}`)}),es(xt,Oe.elementfocus,""));const e=Av(b0.MAIN);return xe(e)&&(Ny(xt,Oe.elementfocus,`pages in open ${e.name} book`),e.pages.forEach(t=>{const r=Mh(t);es(xt,Oe.elementfocus,`!pagetrash ${t.id};$REDTRASH ${r}`)}),es(xt,Oe.elementfocus,"")),0}).command("dev",()=>(bS(),Vke(xt,Oe.elementfocus),0)).command("share",()=>(bS(),Gke(xt,Oe.elementfocus),0)).command("save",()=>(bS(),0)).command("fork",()=>(MOe(xt,Oe.elementfocus),0)).command("itchiopublish",()=>(kOe(xt,Oe.elementfocus),0)).command("nuke",()=>($ke(xt,Oe.elementfocus),0)).command("restart",()=>(ROe(xt,Oe.elementfocus),bS(),0)).command("export",()=>{y_(xt,Oe.elementfocus,"E X P O R T"),DS(xt,Oe.elementfocus,"books");const n=Py();return n.length&&n.forEach(e=>es(xt,Oe.elementfocus,`!bookexport ${e.id};${e.name}`)),0}).command("bookexport",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Fy(t);return xe(r)&&(y_(xt,Oe.elementfocus,"E X P O R T"),DS(xt,Oe.elementfocus,"pages"),setTimeout(()=>{if(r.pages.length){const i=OM(r);es(xt,Oe.elementfocus,`!bookallexport ${t};$blue[all]$white export book`),i.forEach(s=>{const a=Mh(s),o=Vx(s);es(xt,Oe.elementfocus,`!pageexport ${t}:${s.id};$blue[${o}]$white ${a}`)})}},1e3)),0}).command("bookallexport",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Fy(t);return xe(r)&&fY(xt,Oe.elementfocus,Sl(r),`${r.name}.book.json`),0}).command("pageexport",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),{target:r,path:i}=EE(t),s=Fy(r),a=gk(s,i);return xe(a)&&fY(xt,Oe.elementfocus,Sl(a),`${Mh(a)}.${Vx(a)}.json`),0}).command("gadget",()=>(oOe(xt,Oe.elementfocus),0)).command("zztsearch",(n,e)=>{const[t,r]=ln(e,0,[Dt.NAME,Dt.MAYBE_NAME]),i=xe(r)?t:"title",s=xe(r)?r:t;return dOe(xt,Oe.elementfocus,i,s),0}).command("zztrandom",()=>(pOe(xt,Oe.elementfocus),0)).command("admin",()=>(hOe(xt,Oe.elementfocus),0)).command("joincode",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]);return Bke(xt,Oe.elementfocus,!!t),0}).command("jointab",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]);return Fke(xt,Oe.elementfocus,!!t),0}).command("broadcast",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]);return t?Ike(xt,Oe.elementfocus,t):Nke(xt,Oe.elementfocus),0}).command("startlookingglass",()=>(Wke(xt,Oe.elementfocus),0)),uQe=mb().command("toast",(n,e)=>{const t=e.map(pu).join("");return rle(xt,Oe.elementfocus,t),0}).command("ticker",(n,e)=>{const t=e.map(pu).join("");return xe(Oe.element)&&(Oe.element.tickertext=t,Oe.element.tickertime=Oe.timestamp),0}).command("palette",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=rne(),i=M_(ni.PALETTE,t);return xe(i)?(r.palette=i.id,xs(xt,Oe.elementfocus,`loaded palette ${t}`)):Si(xt,Oe.elementfocus,"not-found",`unabled to find palette ${t}`),0}).command("charset",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=rne(),i=M_(ni.CHARSET,t);return xe(i)?(r.charset=i.id,xs(xt,Oe.elementfocus,`loaded charset ${t}`)):Si(xt,Oe.elementfocus,"not-found",`unabled to find charset ${t}`),0}),fQe=new Set(["inputmove","inputalt","inputctrl","inputshift","inputok","inputcancel","inputmenu"]),Oee=new Set(["char","color","bg","displaychar","displaycolor","displaybg","item","group","party","player","pushable","collision","breakable","p1","p2","p3","p4","p5","p6","p7","p8","p9","p10","cycle","stepx","stepy","shootx","shooty","light","lightdir","arg"]),hQe=["NORTH","SOUTH","WEST","EAST"];function dQe(n,e,t){const r=g1(n);if(Mn(r.inputcurrent)||(r.inputcurrent=0),bi(r.inputqueue)||(r.inputqueue=[]),r.inputcurrent>0)return r;const[i]=r.inputqueue,[s=Tn.NONE,a=0]=i??[Tn.NONE,0];switch(r.inputmove=[],r.inputok=0,r.inputcancel=0,r.inputmenu=0,r.inputalt=a&qj?1:0,r.inputctrl=a&Vj?1:0,r.inputshift=a&Gj?1:0,s){case Tn.MOVE_UP:case Tn.MOVE_DOWN:case Tn.MOVE_LEFT:case Tn.MOVE_RIGHT:{const o=hQe[s-Tn.MOVE_UP];if(Vn(e)&&e==="fpv"&&Mn(t))switch(Math.round(t/90)){default:case 0:r.inputmove=[o];break;case 1:switch(o){default:case"NORTH":r.inputmove=["EAST"];break;case"EAST":r.inputmove=["SOUTH"];break;case"SOUTH":r.inputmove=["WEST"];break;case"WEST":r.inputmove=["NORTH"];break}break;case 2:switch(o){default:case"NORTH":r.inputmove=["SOUTH"];break;case"EAST":r.inputmove=["WEST"];break;case"SOUTH":r.inputmove=["NORTH"];break;case"WEST":r.inputmove=["EAST"];break}break;case 3:switch(o){default:case"NORTH":r.inputmove=["WEST"];break;case"EAST":r.inputmove=["NORTH"];break;case"SOUTH":r.inputmove=["EAST"];break;case"WEST":r.inputmove=["SOUTH"];break}break}else r.inputmove=[o];break}case Tn.OK_BUTTON:r.inputok=1;break;case Tn.CANCEL_BUTTON:r.inputcancel=1;break;case Tn.MENU_BUTTON:r.inputmenu=1;break}return r.inputcurrent=s,r.inputqueue=r.inputqueue.filter(o=>{const[l]=o;return l!==Tn.NONE&&l!==s}),r}function pQe(n){const e=Ppe[n];if(xe(e))return e;const t=Upe[n];if(xe(t))return t;const r=B4[n];if(xe(r))return r;const i=hue[n];if(xe(i))return i}function Iee(){if(Bg(Oe.board,Oe.element,Oe.timestamp),!!$i(Oe.element,"item")){const e={x:Oe.element?.x??-1,y:Oe.element?.y??-1},t=_k(Oe.board,e,Oe.elementfocus);xe(t)&&(t.x=e.x,t.y=e.y)}}const mQe=mb({get(n,e){const t=pQe(e);if(xe(t))return[!0,t];if(Oe.elementisplayer&&fQe.has(e)){const c=n.get("graphics"),u=n.get("facing"),f=dQe(Oe.elementid,c,u)[e];return[xe(f),f]}const r=_k(Oe.board,{x:Oe.element?.x??-1,y:Oe.element?.y??-1},Oe.elementfocus),i=r?.id??Oe.elementfocus??yT(),s=Oe.element?.sender,a=yVe(Oe.board,Vn(s)?s:""),o=a?.id??"";switch(e){case"camera":case"graphics":case"facing":{const c=g1(i)[e];return[!0,xe(c)?c:Oe.board?.[e]??0]}case"isdark":return[!0,Oe.board?.isdark?1:0];case"startx":return[!0,Oe.board?.startx??0];case"starty":return[!0,Oe.board?.starty??0];case"over":return[!0,Oe.board?.over??""];case"under":return[!0,Oe.board?.under??""];case"exitnorth":return[!0,Oe.board?.exitnorth??""];case"exitsouth":return[!0,Oe.board?.exitsouth??""];case"exitwest":return[!0,Oe.board?.exitwest??""];case"exiteast":return[!0,Oe.board?.exiteast??""];case"timelimit":return[!0,Oe.board?.timelimit??0];case"restartonzap":return[!0,Oe.board?.restartonzap??0];case"maxplayershots":return[!0,Oe.board?.maxplayershots??0];case"b1":return[!0,Oe.board?.b1??0];case"b2":return[!0,Oe.board?.b1??0];case"b3":return[!0,Oe.board?.b1??0];case"b4":return[!0,Oe.board?.b1??0];case"b5":return[!0,Oe.board?.b1??0];case"b6":return[!0,Oe.board?.b1??0];case"b7":return[!0,Oe.board?.b1??0];case"b8":return[!0,Oe.board?.b1??0];case"b9":return[!0,Oe.board?.b1??0];case"b10":return[!0,Oe.board?.b1??0];case"currenttick":return[!0,Oe.timestamp];case"boardid":return[!0,Oe.board?.id??""];case"playerid":return[!0,i];case"playerx":return[!0,r?.x??-1];case"playery":return[!0,r?.y??-1];case"thisid":return[!0,Oe.element?.id??""];case"thisx":return[!0,Oe.element?.x??-1];case"thisy":return[!0,Oe.element?.y??-1];case"sender":case"senderid":return[!0,o];case"senderx":return[!0,a?.x??-1];case"sendery":return[!0,a?.y??-1];default:{if(Oee.has(e))return[!0,$i(Oe.element,e)??0];break}}const l=g1(i)[e];return[xe(l),l]},set(n,e,t){const r={x:Oe.element?.x??-1,y:Oe.element?.y??-1},s=_k(Oe.board,r,Oe.elementfocus)?.id??Oe.elementfocus;switch(e){case"camera":case"graphics":break;case"facing":t=(t%360+360)%360;break;case"isdark":if(xe(Oe.board))return Oe.board.isdark=t?1:0,[!0,Oe.board.isdark];break;case"startx":if(xe(Oe.board))return Oe.board.startx=vd(t,0),[!0,Oe.board.startx];break;case"starty":if(xe(Oe.board))return Oe.board.starty=vd(t,0),[!0,Oe.board.starty];break;case"over":if(xe(Oe.board))return Oe.board.over=pu(t),[!0,Oe.board.over];break;case"under":if(xe(Oe.board))return[!0,Oe.board.under=pu(t)];break;case"exitnorth":if(xe(Oe.board))return[!0,Oe.board.exitnorth=pu(t)];break;case"exitsouth":if(xe(Oe.board))return[!0,Oe.board.exitsouth=pu(t)];break;case"exitwest":if(xe(Oe.board))return[!0,Oe.board.exitwest=pu(t)];break;case"exiteast":if(xe(Oe.board))return[!0,Oe.board.exiteast=pu(t)];break;case"timelimit":if(xe(Oe.board))return[!0,Oe.board.timelimit=vd(t,0)];break;case"restartonzap":if(xe(Oe.board))return[!0,Oe.board.restartonzap=t?1:0];break;case"maxplayershots":if(xe(Oe.board))return[!0,Oe.board.maxplayershots=vd(t,0)];break;case"b1":if(xe(Oe.board))return[!0,Oe.board.b1=vd(t,0)];break;case"b2":if(xe(Oe.board))return[!0,Oe.board.b2=vd(t,0)];break;case"b3":if(xe(Oe.board))return[!0,Oe.board.b3=vd(t,0)];break;case"b4":if(xe(Oe.board))return[!0,Oe.board.b4=vd(t,0)];break;case"b5":if(xe(Oe.board))return[!0,Oe.board.b5=vd(t,0)];break;case"b6":if(xe(Oe.board))return[!0,Oe.board.b6=vd(t,0)];break;case"b7":if(xe(Oe.board))return[!0,Oe.board.b7=vd(t,0)];break;case"b8":if(xe(Oe.board))return[!0,Oe.board.b8=vd(t,0)];break;case"b9":if(xe(Oe.board))return[!0,Oe.board.b9=vd(t,0)];break;case"b10":if(xe(Oe.board))return[!0,Oe.board.b10=vd(t,0)];break;case"currenttick":case"boardid":return[!0,t];case"playerid":case"playerx":case"playery":return[!0,t];case"thisid":case"thisx":case"thisy":return[!0,t];case"senderid":case"senderx":case"sendery":return[!0,t];default:{if(Oee.has(e))return xe(Oe.element)&&(Oe.element[e]=t),[!0,t];break}}const a=g1(s);return xe(a)?(a[e]=t,[!0,t]):[!1,t]},everytick(n){if(Oe.elementisplayer){const e=n.get("health");Mn(e)&&e<=0&&(n.endofprogram(),ole(xt,Oe.elementid))}!Oe.element?.removed&&xe(Oe.element?.x)&&xe(Oe.element.y)&&xe(Oe.element.stepx)&&xe(Oe.element.stepy)&&(Oe.element.stepx||Oe.element.stepy)&&S_(Oe.book,Oe.board,Oe.element,{x:Oe.element.x+Oe.element.stepx,y:Oe.element.y+Oe.element.stepy})}}).command("clear",(n,e)=>{for(let t=0;t<e.length;++t)n.set(pu(e[t]),0);return 0}).command("set",(n,e)=>{const[t,r]=ln(e,0,[Dt.NAME,Dt.ANY]);return n.set(t,r??1),0}).command("become",(n,e)=>{const[t]=ln(e,0,[Dt.KIND]);Bp(Oe.board);const r=Vm(Oe.element),[i,s]=t,a=[...F4(r.color,r.bg),...s??[]],o=[i,a];if(VH(Oe.board,Oe.element),Bg(Oe.board,Oe.element,Oe.timestamp)){const l={x:Oe.element?.x??0,y:Oe.element?.y??0};D0(Oe.board,o,l)}return n.endofprogram(),0}).command("bind",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]),r=Gw(Oe.board,t);return xe(Oe.element)&&r.length>0&&(Oe.element.code=T0(...r).code??"",_et(Oe.elementid)),0}).command("char",(n,e)=>{const[t]=ln(e,0,[Dt.ANY]);if(F0(t)){const[r,i]=ln(e,0,[Dt.DIR,Dt.NUMBER]),s=Jo(Oe.board,r.destpt);xe(s)&&(s.char=i)}else xe(Oe.element)&&Mn(t)&&(Oe.element.char=t);return 0}).command("color",(n,e)=>{const[t]=ln(e,0,[Dt.ANY]);if(F0(t)){const[r,i]=ln(e,0,[Dt.DIR,Dt.COLOR]),s=Jo(Oe.board,r.destpt);xe(s)&&mk(Oe.element,i)}else{const[r]=ln(e,0,[Dt.COLOR]);xe(Oe.element)&&xe(r)&&mk(Oe.element,r)}return 0}).command("go",(n,e)=>{if(xe(Oe.element)){const[t]=ln(e,0,[Dt.DIR]);if(S_(Oe.book,Oe.board,Oe.element,t.destpt),n.yield(),Oe.element.x===t.destpt.x&&Oe.element.y===t.destpt.y)return 0}return 1}).command("walk",(n,e)=>{if(!xe(Oe.element))return 0;const[t]=ln(e,0,[Dt.DIR]),r=Oe.element.x??0,i=Oe.element.y??0;return Oe.element.stepx=t.destpt.x-r,Oe.element.stepy=t.destpt.y-i,0}).command("idle",n=>(n.yield(),0)).command("end",n=>(n.endofprogram(),0)).command("endwith",(n,e)=>{const[t]=ln(e,0,[Dt.ANY]);return n.set("arg",t),n.command("end")}).command("lock",n=>(n.lock(n.id()),0)).command("restore",(n,e)=>(n.restore(pu(e[0])),0)).command("unlock",n=>(n.unlock(),0)).command("zap",(n,e)=>(n.zap(pu(e[0])),0)).command("cycle",(n,e)=>{if(xe(Oe.element)){const[t]=ln(e,0,[Dt.NUMBER]);Oe.element.cycle=Di(Math.round(t),1,255)}return 0}).command("die",n=>(Iee(),n.endofprogram(),0)).command("dieonend",()=>(Iee(),0)).command("run",(n,e)=>{const[t]=ln(e,0,[Dt.NAME]);return hL(t),0}).command("runwith",(n,e)=>{const[t,r]=ln(e,0,[Dt.ANY,Dt.NAME]);return n.set("arg",t),hL(r),0}),Gme={};function gQe(n){return Gme[n]?.format}function IT(n){return Gme[n]?.content}function Nee(n,e){if(!xe(n))return;const t=qr(e),r=t.endsWith("le");switch(t){case"float32":case"float32le":{const i=n.dataview.getFloat32(n.cursor,r);return n.cursor+=4,i}case"float64":case"float64le":{const i=n.dataview.getFloat64(n.cursor,r);return n.cursor+=8,i}case"int8":case"int8le":{const i=n.dataview.getInt8(n.cursor);return n.cursor+=1,i}case"int16":case"int16le":{const i=n.dataview.getInt16(n.cursor,r);return n.cursor+=2,i}case"int32":case"int32le":{const i=n.dataview.getInt32(n.cursor,r);return n.cursor+=4,i}case"int64":case"int64le":{const i=n.dataview.getBigInt64(n.cursor,r);return n.cursor+=8,i}case"uint8":case"uint8le":{const i=n.dataview.getUint8(n.cursor);return n.cursor+=1,i}case"uint16":case"uint16le":{const i=n.dataview.getUint16(n.cursor,r);return n.cursor+=2,i}case"uint32":case"uint32le":{const i=n.dataview.getUint32(n.cursor,r);return n.cursor+=4,i}case"uint64":case"uint64le":{const i=n.dataview.getBigUint64(n.cursor,r);return n.cursor+=8,i}}}const _Qe=(n,e)=>{const t=IT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Dt.NAME]),s=qr(r);switch(s){case"seek":{const[a]=ln(e,i,[Dt.NUMBER]);t.cursor=a;break}case"float32":case"float32le":case"float64":case"float64le":case"int8":case"int8le":case"int16":case"int16le":case"int32":case"int32le":case"int64":case"int64le":case"uint8":case"uint8le":case"uint16":case"uint16le":case"uint32":case"uint32le":case"uint64":case"uint64le":{const[a]=ln(e,i,[Dt.NAME]);n.set(a,Nee(t,s));break}case"text":{const[a,o]=ln(e,i,[Dt.NAME,Dt.NAME]),l=Nee(t,a);if(Mn(l)&&Vn(o)){const c=new Uint8Array(t.bytes.buffer,t.cursor,l),f=new TextDecoder("utf-8").decode(c);n.set(o,f),t.cursor+=l}break}case"palette":{const[a]=ln(e,i,[Dt.NAME]),[o]=i9(Oe.book,ni.PALETTE,a),l=Jf(o);if(xe(l)){const c=Jce*tw,u=QE(new Uint8Array(t.bytes.buffer,t.cursor,c));xe(u)&&(l.bits=u.bits),t.cursor+=c}break}case"charset":{const[a]=ln(e,i,[Dt.NAME]),[o]=i9(Oe.book,ni.CHARSET,a),l=Jf(o);if(xe(l)){const c=O0*L7*D7,u=JE(new Uint8Array(t.bytes.buffer,t.cursor,c));xe(u)&&(l.bits=u.bits),t.cursor+=c}break}}return 0},vw=n=>n!==null&&Object.prototype.toString.call(n)==="[object Object]",uL=(n,e)=>{if(n===e)return!0;if(typeof n!=typeof e)return!1;if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t+=1)if(!uL(n[t],e[t]))return!1;return!0}if(vw(n)&&vw(e)){const t=Object.entries(n),r=new Set(Object.keys(e));if(t.length!==r.size)return!1;for(const[i,s]of t){if(!uL(s,e[i]))return!1;r.delete(i)}return r.size===0}return!1},JI=n=>{if(n===""||n===!1||n===null||n===void 0||Array.isArray(n)&&n.length===0)return!0;if(vw(n)){for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}return!1},vQe=n=>n>="a"&&n<="z"||n>="A"&&n<="Z"||n==="_",Pee=n=>n>="0"&&n<="9"||n==="-",yQe=n=>n>="a"&&n<="z"||n>="A"&&n<="Z"||n>="0"&&n<="9"||n==="_";var en;(function(n){n.TOK_EOF="EOF",n.TOK_UNQUOTEDIDENTIFIER="UnquotedIdentifier",n.TOK_QUOTEDIDENTIFIER="QuotedIdentifier",n.TOK_RBRACKET="Rbracket",n.TOK_RPAREN="Rparen",n.TOK_COMMA="Comma",n.TOK_COLON="Colon",n.TOK_RBRACE="Rbrace",n.TOK_NUMBER="Number",n.TOK_CURRENT="Current",n.TOK_ROOT="Root",n.TOK_EXPREF="Expref",n.TOK_PIPE="Pipe",n.TOK_OR="Or",n.TOK_AND="And",n.TOK_EQ="EQ",n.TOK_GT="GT",n.TOK_LT="LT",n.TOK_GTE="GTE",n.TOK_LTE="LTE",n.TOK_NE="NE",n.TOK_FLATTEN="Flatten",n.TOK_STAR="Star",n.TOK_FILTER="Filter",n.TOK_DOT="Dot",n.TOK_NOT="Not",n.TOK_LBRACE="Lbrace",n.TOK_LBRACKET="Lbracket",n.TOK_LPAREN="Lparen",n.TOK_LITERAL="Literal"})(en||(en={}));const Dee={"(":en.TOK_LPAREN,")":en.TOK_RPAREN,"*":en.TOK_STAR,",":en.TOK_COMMA,".":en.TOK_DOT,":":en.TOK_COLON,"@":en.TOK_CURRENT,$:en.TOK_ROOT,"]":en.TOK_RBRACKET,"{":en.TOK_LBRACE,"}":en.TOK_RBRACE},bQe={"!":!0,"<":!0,"=":!0,">":!0},SQe={"	":!0,"\n":!0,"\r":!0," ":!0};class EQe{constructor(){this._current=0}tokenize(e){const t=[];this._current=0;let r,i,s;for(;this._current<e.length;)if(vQe(e[this._current]))r=this._current,i=this.consumeUnquotedIdentifier(e),t.push({start:r,type:en.TOK_UNQUOTEDIDENTIFIER,value:i});else if(Dee[e[this._current]]!==void 0)t.push({start:this._current,type:Dee[e[this._current]],value:e[this._current]}),this._current+=1;else if(Pee(e[this._current]))s=this.consumeNumber(e),t.push(s);else if(e[this._current]==="[")s=this.consumeLBracket(e),t.push(s);else if(e[this._current]==='"')r=this._current,i=this.consumeQuotedIdentifier(e),t.push({start:r,type:en.TOK_QUOTEDIDENTIFIER,value:i});else if(e[this._current]==="'")r=this._current,i=this.consumeRawStringLiteral(e),t.push({start:r,type:en.TOK_LITERAL,value:i});else if(e[this._current]==="`"){r=this._current;const a=this.consumeLiteral(e);t.push({start:r,type:en.TOK_LITERAL,value:a})}else if(bQe[e[this._current]]!==void 0)s=this.consumeOperator(e),s&&t.push(s);else if(SQe[e[this._current]]!==void 0)this._current+=1;else if(e[this._current]==="&")r=this._current,this._current+=1,e[this._current]==="&"?(this._current+=1,t.push({start:r,type:en.TOK_AND,value:"&&"})):t.push({start:r,type:en.TOK_EXPREF,value:"&"});else if(e[this._current]==="|")r=this._current,this._current+=1,e[this._current]==="|"?(this._current+=1,t.push({start:r,type:en.TOK_OR,value:"||"})):t.push({start:r,type:en.TOK_PIPE,value:"|"});else{const a=new Error(`Unknown character: ${e[this._current]}`);throw a.name="LexerError",a}return t}consumeUnquotedIdentifier(e){const t=this._current;for(this._current+=1;this._current<e.length&&yQe(e[this._current]);)this._current+=1;return e.slice(t,this._current)}consumeQuotedIdentifier(e){const t=this._current;this._current+=1;const r=e.length;for(;e[this._current]!=='"'&&this._current<r;){let i=this._current;e[i]==="\\"&&(e[i+1]==="\\"||e[i+1]==='"')?i+=2:i+=1,this._current=i}return this._current+=1,JSON.parse(e.slice(t,this._current))}consumeRawStringLiteral(e){const t=this._current;this._current+=1;const r=e.length;for(;e[this._current]!=="'"&&this._current<r;){let s=this._current;e[s]==="\\"&&(e[s+1]==="\\"||e[s+1]==="'")?s+=2:s+=1,this._current=s}return this._current+=1,e.slice(t+1,this._current-1).replace("\\'","'")}consumeNumber(e){const t=this._current;this._current+=1;const r=e.length;for(;Pee(e[this._current])&&this._current<r;)this._current+=1;const i=parseInt(e.slice(t,this._current),10);return{start:t,value:i,type:en.TOK_NUMBER}}consumeLBracket(e){const t=this._current;return this._current+=1,e[this._current]==="?"?(this._current+=1,{start:t,type:en.TOK_FILTER,value:"[?"}):e[this._current]==="]"?(this._current+=1,{start:t,type:en.TOK_FLATTEN,value:"[]"}):{start:t,type:en.TOK_LBRACKET,value:"["}}consumeOperator(e){const t=this._current,r=e[t];if(this._current+=1,r==="!")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_NE,value:"!="}):{start:t,type:en.TOK_NOT,value:"!"};if(r==="<")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_LTE,value:"<="}):{start:t,type:en.TOK_LT,value:"<"};if(r===">")return e[this._current]==="="?(this._current+=1,{start:t,type:en.TOK_GTE,value:">="}):{start:t,type:en.TOK_GT,value:">"};if(r==="="&&e[this._current]==="=")return this._current+=1,{start:t,type:en.TOK_EQ,value:"=="}}consumeLiteral(e){this._current+=1;const t=this._current,r=e.length;for(;e[this._current]!=="`"&&this._current<r;){let a=this._current;e[a]==="\\"&&(e[a+1]==="\\"||e[a+1]==="`")?a+=2:a+=1,this._current=a}let i=e.slice(t,this._current).trimLeft();i=i.replace("\\`","`");const s=this.looksLikeJSON(i)?JSON.parse(i):JSON.parse(`"${i}"`);return this._current+=1,s}looksLikeJSON(e){const r=["true","false","null"],i="-0123456789";if(e==="")return!1;if('[{"'.includes(e[0])||r.includes(e))return!0;if(i.includes(e[0]))try{return JSON.parse(e),!0}catch{return!1}return!1}}const xQe=new EQe,Yd={[en.TOK_EOF]:0,[en.TOK_UNQUOTEDIDENTIFIER]:0,[en.TOK_QUOTEDIDENTIFIER]:0,[en.TOK_RBRACKET]:0,[en.TOK_RPAREN]:0,[en.TOK_COMMA]:0,[en.TOK_RBRACE]:0,[en.TOK_NUMBER]:0,[en.TOK_CURRENT]:0,[en.TOK_EXPREF]:0,[en.TOK_ROOT]:0,[en.TOK_PIPE]:1,[en.TOK_OR]:2,[en.TOK_AND]:3,[en.TOK_EQ]:5,[en.TOK_GT]:5,[en.TOK_LT]:5,[en.TOK_GTE]:5,[en.TOK_LTE]:5,[en.TOK_NE]:5,[en.TOK_FLATTEN]:9,[en.TOK_STAR]:20,[en.TOK_FILTER]:21,[en.TOK_DOT]:40,[en.TOK_NOT]:45,[en.TOK_LBRACE]:50,[en.TOK_LBRACKET]:55,[en.TOK_LPAREN]:60};class TQe{constructor(){this.index=0,this.tokens=[]}parse(e){this.loadTokens(e),this.index=0;const t=this.expression(0);if(this.lookahead(0)!==en.TOK_EOF){const r=this.lookaheadToken(0);this.errorToken(r,`Unexpected token type: ${r.type}, value: ${r.value}`)}return t}loadTokens(e){this.tokens=[...xQe.tokenize(e),{type:en.TOK_EOF,value:"",start:e.length}]}expression(e){const t=this.lookaheadToken(0);this.advance();let r=this.nud(t),i=this.lookahead(0);for(;e<Yd[i];)this.advance(),r=this.led(i,r),i=this.lookahead(0);return r}lookahead(e){return this.tokens[this.index+e].type}lookaheadToken(e){return this.tokens[this.index+e]}advance(){this.index+=1}nud(e){let t,r,i;switch(e.type){case en.TOK_LITERAL:return{type:"Literal",value:e.value};case en.TOK_UNQUOTEDIDENTIFIER:return{type:"Field",name:e.value};case en.TOK_QUOTEDIDENTIFIER:const s={type:"Field",name:e.value};if(this.lookahead(0)===en.TOK_LPAREN)throw new Error("Quoted identifier not allowed for function names.");return s;case en.TOK_NOT:return r=this.expression(Yd.Not),{type:"NotExpression",children:[r]};case en.TOK_STAR:return t={type:"Identity"},r=this.lookahead(0)===en.TOK_RBRACKET&&{type:"Identity"}||this.parseProjectionRHS(Yd.Star),{type:"ValueProjection",children:[t,r]};case en.TOK_FILTER:return this.led(e.type,{type:"Identity"});case en.TOK_LBRACE:return this.parseMultiselectHash();case en.TOK_FLATTEN:return t={type:en.TOK_FLATTEN,children:[{type:"Identity"}]},r=this.parseProjectionRHS(Yd.Flatten),{type:"Projection",children:[t,r]};case en.TOK_LBRACKET:return this.lookahead(0)===en.TOK_NUMBER||this.lookahead(0)===en.TOK_COLON?(r=this.parseIndexExpression(),this.projectIfSlice({type:"Identity"},r)):this.lookahead(0)===en.TOK_STAR&&this.lookahead(1)===en.TOK_RBRACKET?(this.advance(),this.advance(),r=this.parseProjectionRHS(Yd.Star),{children:[{type:"Identity"},r],type:"Projection"}):this.parseMultiselectList();case en.TOK_CURRENT:return{type:en.TOK_CURRENT};case en.TOK_ROOT:return{type:en.TOK_ROOT};case en.TOK_EXPREF:return i=this.expression(Yd.Expref),{type:"ExpressionReference",children:[i]};case en.TOK_LPAREN:const a=[];for(;this.lookahead(0)!==en.TOK_RPAREN;)this.lookahead(0)===en.TOK_CURRENT?(i={type:en.TOK_CURRENT},this.advance()):i=this.expression(0),a.push(i);return this.match(en.TOK_RPAREN),a[0];default:this.errorToken(e)}}led(e,t){let r;switch(e){case en.TOK_DOT:const i=Yd.Dot;return this.lookahead(0)!==en.TOK_STAR?(r=this.parseDotRHS(i),{type:"Subexpression",children:[t,r]}):(this.advance(),r=this.parseProjectionRHS(i),{type:"ValueProjection",children:[t,r]});case en.TOK_PIPE:return r=this.expression(Yd.Pipe),{type:en.TOK_PIPE,children:[t,r]};case en.TOK_OR:return r=this.expression(Yd.Or),{type:"OrExpression",children:[t,r]};case en.TOK_AND:return r=this.expression(Yd.And),{type:"AndExpression",children:[t,r]};case en.TOK_LPAREN:const s=t.name,a=[];let o;for(;this.lookahead(0)!==en.TOK_RPAREN;)this.lookahead(0)===en.TOK_CURRENT?(o={type:en.TOK_CURRENT},this.advance()):o=this.expression(0),this.lookahead(0)===en.TOK_COMMA&&this.match(en.TOK_COMMA),a.push(o);return this.match(en.TOK_RPAREN),{name:s,type:"Function",children:a};case en.TOK_FILTER:const c=this.expression(0);return this.match(en.TOK_RBRACKET),r=this.lookahead(0)===en.TOK_FLATTEN&&{type:"Identity"}||this.parseProjectionRHS(Yd.Filter),{type:"FilterProjection",children:[t,r,c]};case en.TOK_FLATTEN:const u={type:en.TOK_FLATTEN,children:[t]},f=this.parseProjectionRHS(Yd.Flatten);return{type:"Projection",children:[u,f]};case en.TOK_EQ:case en.TOK_NE:case en.TOK_GT:case en.TOK_GTE:case en.TOK_LT:case en.TOK_LTE:return this.parseComparator(t,e);case en.TOK_LBRACKET:const d=this.lookaheadToken(0);return d.type===en.TOK_NUMBER||d.type===en.TOK_COLON?(r=this.parseIndexExpression(),this.projectIfSlice(t,r)):(this.match(en.TOK_STAR),this.match(en.TOK_RBRACKET),r=this.parseProjectionRHS(Yd.Star),{type:"Projection",children:[t,r]});default:return this.errorToken(this.lookaheadToken(0))}}match(e){if(this.lookahead(0)===e){this.advance();return}else{const t=this.lookaheadToken(0);this.errorToken(t,`Expected ${e}, got: ${t.type}`)}}errorToken(e,t=""){const r=new Error(t||`Invalid token (${e.type}): "${e.value}"`);throw r.name="ParserError",r}parseIndexExpression(){if(this.lookahead(0)===en.TOK_COLON||this.lookahead(1)===en.TOK_COLON)return this.parseSliceExpression();const e={type:"Index",value:this.lookaheadToken(0).value};return this.advance(),this.match(en.TOK_RBRACKET),e}projectIfSlice(e,t){const r={type:"IndexExpression",children:[e,t]};return t.type==="Slice"?{children:[r,this.parseProjectionRHS(Yd.Star)],type:"Projection"}:r}parseSliceExpression(){const e=[null,null,null];let t=0,r=this.lookahead(0);for(;r!==en.TOK_RBRACKET&&t<3;){if(r===en.TOK_COLON)t+=1,this.advance();else if(r===en.TOK_NUMBER)e[t]=this.lookaheadToken(0).value,this.advance();else{const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}r=this.lookahead(0)}return this.match(en.TOK_RBRACKET),{children:e,type:"Slice"}}parseComparator(e,t){const r=this.expression(Yd[t]);return{type:"Comparator",name:t,children:[e,r]}}parseDotRHS(e){const t=this.lookahead(0);if([en.TOK_UNQUOTEDIDENTIFIER,en.TOK_QUOTEDIDENTIFIER,en.TOK_STAR].includes(t))return this.expression(e);if(t===en.TOK_LBRACKET)return this.match(en.TOK_LBRACKET),this.parseMultiselectList();if(t===en.TOK_LBRACE)return this.match(en.TOK_LBRACE),this.parseMultiselectHash();const i=this.lookaheadToken(0);this.errorToken(i,`Syntax error, unexpected token: ${i.value}(${i.type})`)}parseProjectionRHS(e){if(Yd[this.lookahead(0)]<10)return{type:"Identity"};if(this.lookahead(0)===en.TOK_LBRACKET)return this.expression(e);if(this.lookahead(0)===en.TOK_FILTER)return this.expression(e);if(this.lookahead(0)===en.TOK_DOT)return this.match(en.TOK_DOT),this.parseDotRHS(e);const t=this.lookaheadToken(0);this.errorToken(t,`Syntax error, unexpected token: ${t.value}(${t.type})`)}parseMultiselectList(){const e=[];for(;this.lookahead(0)!==en.TOK_RBRACKET;){const t=this.expression(0);if(e.push(t),this.lookahead(0)===en.TOK_COMMA&&(this.match(en.TOK_COMMA),this.lookahead(0)===en.TOK_RBRACKET))throw new Error("Unexpected token Rbracket")}return this.match(en.TOK_RBRACKET),{type:"MultiSelectList",children:e}}parseMultiselectHash(){const e=[],t=[en.TOK_UNQUOTEDIDENTIFIER,en.TOK_QUOTEDIDENTIFIER];let r,i,s;for(;;){if(r=this.lookaheadToken(0),!t.includes(r.type))throw new Error(`Expecting an identifier token, got: ${r.type}`);if(i=r.value,this.advance(),this.match(en.TOK_COLON),s=this.expression(0),e.push({value:s,type:"KeyValuePair",name:i}),this.lookahead(0)===en.TOK_COMMA)this.match(en.TOK_COMMA);else if(this.lookahead(0)===en.TOK_RBRACE){this.match(en.TOK_RBRACE);break}}return{type:"MultiSelectHash",children:e}}}const wQe=new TQe;var Pn;(function(n){n[n.TYPE_NUMBER=0]="TYPE_NUMBER",n[n.TYPE_ANY=1]="TYPE_ANY",n[n.TYPE_STRING=2]="TYPE_STRING",n[n.TYPE_ARRAY=3]="TYPE_ARRAY",n[n.TYPE_OBJECT=4]="TYPE_OBJECT",n[n.TYPE_BOOLEAN=5]="TYPE_BOOLEAN",n[n.TYPE_EXPREF=6]="TYPE_EXPREF",n[n.TYPE_NULL=7]="TYPE_NULL",n[n.TYPE_ARRAY_NUMBER=8]="TYPE_ARRAY_NUMBER",n[n.TYPE_ARRAY_STRING=9]="TYPE_ARRAY_STRING"})(Pn||(Pn={}));class RQe{constructor(e){this.TYPE_NAME_TABLE={[Pn.TYPE_NUMBER]:"number",[Pn.TYPE_ANY]:"any",[Pn.TYPE_STRING]:"string",[Pn.TYPE_ARRAY]:"array",[Pn.TYPE_OBJECT]:"object",[Pn.TYPE_BOOLEAN]:"boolean",[Pn.TYPE_EXPREF]:"expression",[Pn.TYPE_NULL]:"null",[Pn.TYPE_ARRAY_NUMBER]:"Array<number>",[Pn.TYPE_ARRAY_STRING]:"Array<string>"},this.functionAbs=([t])=>Math.abs(t),this.functionAvg=([t])=>{let r=0;for(let i=0;i<t.length;i+=1)r+=t[i];return r/t.length},this.functionCeil=([t])=>Math.ceil(t),this.functionContains=t=>{const[r,i]=t;return r.includes(i)},this.functionEndsWith=t=>{const[r,i]=t;return r.includes(i,r.length-i.length)},this.functionFloor=([t])=>Math.floor(t),this.functionJoin=t=>{const[r,i]=t;return i.join(r)},this.functionKeys=([t])=>Object.keys(t),this.functionLength=([t])=>vw(t)?Object.keys(t).length:t.length,this.functionMap=t=>{if(!this._interpreter)return[];const r=[],i=this._interpreter,s=t[0],a=t[1];for(let o=0;o<a.length;o+=1)r.push(i.visit(s,a[o]));return r},this.functionMax=([t])=>{if(!t.length)return null;if(this.getTypeName(t[0])===Pn.TYPE_NUMBER)return Math.max(...t);const i=t;let s=i[0];for(let a=1;a<i.length;a+=1)s.localeCompare(i[a])<0&&(s=i[a]);return s},this.functionMaxBy=t=>{const r=t[1],i=t[0],s=this.createKeyFunction(r,[Pn.TYPE_NUMBER,Pn.TYPE_STRING]);let a=-1/0,o,l;for(let c=0;c<i.length;c+=1)l=s&&s(i[c]),l!==void 0&&l>a&&(a=l,o=i[c]);return o},this.functionMerge=t=>{let r={};for(let i=0;i<t.length;i+=1){const s=t[i];r=Object.assign(r,s)}return r},this.functionMin=([t])=>{if(!t.length)return null;if(this.getTypeName(t[0])===Pn.TYPE_NUMBER)return Math.min(...t);const i=t;let s=i[0];for(let a=1;a<i.length;a+=1)i[a].localeCompare(s)<0&&(s=i[a]);return s},this.functionMinBy=t=>{const r=t[1],i=t[0],s=this.createKeyFunction(r,[Pn.TYPE_NUMBER,Pn.TYPE_STRING]);let a=1/0,o,l;for(let c=0;c<i.length;c+=1)l=s&&s(i[c]),l!==void 0&&l<a&&(a=l,o=i[c]);return o},this.functionNotNull=t=>{for(let r=0;r<t.length;r+=1)if(this.getTypeName(t[r])!==Pn.TYPE_NULL)return t[r];return null},this.functionReverse=([t])=>{if(this.getTypeName(t)===Pn.TYPE_STRING){const s=t;let a="";for(let o=s.length-1;o>=0;o-=1)a+=s[o];return a}const i=t.slice(0);return i.reverse(),i},this.functionSort=([t])=>[...t].sort(),this.functionSortBy=t=>{if(!this._interpreter)return[];const r=t[0].slice(0);if(r.length===0)return r;const i=this._interpreter,s=t[1],a=this.getTypeName(i.visit(s,r[0]));if(a!==void 0&&![Pn.TYPE_NUMBER,Pn.TYPE_STRING].includes(a))throw new Error(`TypeError: unexpected type (${this.TYPE_NAME_TABLE[a]})`);const o=[];for(let l=0;l<r.length;l+=1)o.push([l,r[l]]);o.sort((l,c)=>{const u=i.visit(s,l[1]),f=i.visit(s,c[1]);if(this.getTypeName(u)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(u)]}`);if(this.getTypeName(f)!==a)throw new Error(`TypeError: expected (${this.TYPE_NAME_TABLE[a]}), received ${this.TYPE_NAME_TABLE[this.getTypeName(f)]}`);return u>f?1:u<f?-1:l[0]-c[0]});for(let l=0;l<o.length;l+=1)r[l]=o[l][1];return r},this.functionStartsWith=([t,r])=>t.startsWith(r),this.functionSum=([t])=>t.reduce((r,i)=>r+i,0),this.functionToArray=([t])=>this.getTypeName(t)===Pn.TYPE_ARRAY?t:[t],this.functionToNumber=([t])=>{const r=this.getTypeName(t);let i;return r===Pn.TYPE_NUMBER?t:r===Pn.TYPE_STRING&&(i=+t,!isNaN(i))?i:null},this.functionToString=([t])=>this.getTypeName(t)===Pn.TYPE_STRING?t:JSON.stringify(t),this.functionType=([t])=>{switch(this.getTypeName(t)){case Pn.TYPE_NUMBER:return"number";case Pn.TYPE_STRING:return"string";case Pn.TYPE_ARRAY:return"array";case Pn.TYPE_OBJECT:return"object";case Pn.TYPE_BOOLEAN:return"boolean";case Pn.TYPE_EXPREF:return"expref";case Pn.TYPE_NULL:return"null";default:return}},this.functionValues=([t])=>Object.values(t),this.functionTable={abs:{_func:this.functionAbs,_signature:[{types:[Pn.TYPE_NUMBER]}]},avg:{_func:this.functionAvg,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER]}]},ceil:{_func:this.functionCeil,_signature:[{types:[Pn.TYPE_NUMBER]}]},contains:{_func:this.functionContains,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY]},{types:[Pn.TYPE_ANY]}]},ends_with:{_func:this.functionEndsWith,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_STRING]}]},floor:{_func:this.functionFloor,_signature:[{types:[Pn.TYPE_NUMBER]}]},join:{_func:this.functionJoin,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_ARRAY_STRING]}]},keys:{_func:this.functionKeys,_signature:[{types:[Pn.TYPE_OBJECT]}]},length:{_func:this.functionLength,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY,Pn.TYPE_OBJECT]}]},map:{_func:this.functionMap,_signature:[{types:[Pn.TYPE_EXPREF]},{types:[Pn.TYPE_ARRAY]}]},max:{_func:this.functionMax,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER,Pn.TYPE_ARRAY_STRING]}]},max_by:{_func:this.functionMaxBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},merge:{_func:this.functionMerge,_signature:[{types:[Pn.TYPE_OBJECT],variadic:!0}]},min:{_func:this.functionMin,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER,Pn.TYPE_ARRAY_STRING]}]},min_by:{_func:this.functionMinBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},not_null:{_func:this.functionNotNull,_signature:[{types:[Pn.TYPE_ANY],variadic:!0}]},reverse:{_func:this.functionReverse,_signature:[{types:[Pn.TYPE_STRING,Pn.TYPE_ARRAY]}]},sort:{_func:this.functionSort,_signature:[{types:[Pn.TYPE_ARRAY_STRING,Pn.TYPE_ARRAY_NUMBER]}]},sort_by:{_func:this.functionSortBy,_signature:[{types:[Pn.TYPE_ARRAY]},{types:[Pn.TYPE_EXPREF]}]},starts_with:{_func:this.functionStartsWith,_signature:[{types:[Pn.TYPE_STRING]},{types:[Pn.TYPE_STRING]}]},sum:{_func:this.functionSum,_signature:[{types:[Pn.TYPE_ARRAY_NUMBER]}]},to_array:{_func:this.functionToArray,_signature:[{types:[Pn.TYPE_ANY]}]},to_number:{_func:this.functionToNumber,_signature:[{types:[Pn.TYPE_ANY]}]},to_string:{_func:this.functionToString,_signature:[{types:[Pn.TYPE_ANY]}]},type:{_func:this.functionType,_signature:[{types:[Pn.TYPE_ANY]}]},values:{_func:this.functionValues,_signature:[{types:[Pn.TYPE_OBJECT]}]}},this._interpreter=e}registerFunction(e,t,r){if(e in this.functionTable)throw new Error(`Function already defined: ${e}()`);this.functionTable[e]={_func:t.bind(this),_signature:r}}callFunction(e,t){const r=this.functionTable[e];if(r===void 0)throw new Error(`Unknown function: ${e}()`);return this.validateArgs(e,t,r._signature),r._func.call(this,t)}validateInputSignatures(e,t){for(let r=0;r<t.length;r+=1)if("variadic"in t[r]&&r!==t.length-1)throw new Error(`ArgumentError: ${e}() 'variadic' argument ${r+1} must occur last`)}validateArgs(e,t,r){var i,s;let a;this.validateInputSignatures(e,r);const o=r.filter(_=>{var y;return(y=!_.optional)!==null&&y!==void 0?y:!1}).length,l=(s=(i=r[r.length-1])===null||i===void 0?void 0:i.variadic)!==null&&s!==void 0?s:!1,c=t.length<o,u=t.length>r.length,f=c&&(!l&&o>1||l)?"at least ":"";if(l&&c||!l&&(c||u))throw a=r.length>1,new Error(`ArgumentError: ${e}() takes ${f}${o} argument${a&&"s"||""} but received ${t.length}`);let d,g,p;for(let _=0;_<r.length;_+=1){p=!1,d=r[_].types,g=this.getTypeName(t[_]);let y;for(y=0;y<d.length;y+=1)if(g!==void 0&&this.typeMatches(g,d[y],t[_])){p=!0;break}if(!p&&g!==void 0){const v=d.map(x=>this.TYPE_NAME_TABLE[x]).join(" | ");throw new Error(`TypeError: ${e}() expected argument ${_+1} to be type (${v}) but received type ${this.TYPE_NAME_TABLE[g]} instead.`)}}}typeMatches(e,t,r){if(t===Pn.TYPE_ANY)return!0;if(t===Pn.TYPE_ARRAY_STRING||t===Pn.TYPE_ARRAY_NUMBER||t===Pn.TYPE_ARRAY){if(t===Pn.TYPE_ARRAY)return e===Pn.TYPE_ARRAY;if(e===Pn.TYPE_ARRAY){let i;t===Pn.TYPE_ARRAY_NUMBER?i=Pn.TYPE_NUMBER:t===Pn.TYPE_ARRAY_STRING&&(i=Pn.TYPE_STRING);for(let s=0;s<r.length;s+=1){const a=this.getTypeName(r[s]);if(a!==void 0&&i!==void 0&&!this.typeMatches(a,i,r[s]))return!1}return!0}}else return e===t;return!1}getTypeName(e){switch(Object.prototype.toString.call(e)){case"[object String]":return Pn.TYPE_STRING;case"[object Number]":return Pn.TYPE_NUMBER;case"[object Array]":return Pn.TYPE_ARRAY;case"[object Boolean]":return Pn.TYPE_BOOLEAN;case"[object Null]":return Pn.TYPE_NULL;case"[object Object]":return e.jmespathType===en.TOK_EXPREF?Pn.TYPE_EXPREF:Pn.TYPE_OBJECT;default:return}}createKeyFunction(e,t){if(!this._interpreter)return;const r=this._interpreter;return s=>{const a=r.visit(e,s);if(!t.includes(this.getTypeName(a))){const o=`TypeError: expected one of (${t.map(l=>this.TYPE_NAME_TABLE[l]).join(" | ")}), received ${this.TYPE_NAME_TABLE[this.getTypeName(a)]}`;throw new Error(o)}return a}}}class AQe{constructor(){this._rootValue=null,this.runtime=new RQe(this)}search(e,t){return this._rootValue=t,this.visit(e,t)}visit(e,t){let r,i,s,a,o,l,c,u,f,d,g;switch(e.type){case"Field":return t===null?null:vw(t)?(l=t[e.name],l===void 0?null:l):null;case"Subexpression":for(s=this.visit(e.children[0],t),d=1;d<e.children.length;d+=1)if(s=this.visit(e.children[1],s),s===null)return null;return s;case"IndexExpression":return c=this.visit(e.children[0],t),u=this.visit(e.children[1],c),u;case"Index":if(!Array.isArray(t))return null;let p=e.value;return p<0&&(p=t.length+p),s=t[p],s===void 0&&(s=null),s;case"Slice":if(!Array.isArray(t))return null;const _=[...e.children],y=this.computeSliceParams(t.length,_),[v,x,E]=y;if(s=[],E>0)for(d=v;d<x;d+=E)s.push(t[d]);else for(d=v;d>x;d+=E)s.push(t[d]);return s;case"Projection":if(g=this.visit(e.children[0],t),!Array.isArray(g))return null;for(f=[],d=0;d<g.length;d+=1)i=this.visit(e.children[1],g[d]),i!==null&&f.push(i);return f;case"ValueProjection":if(g=this.visit(e.children[0],t),!vw(g))return null;f=[];const M=Object.values(g);for(d=0;d<M.length;d+=1)i=this.visit(e.children[1],M[d]),i!==null&&f.push(i);return f;case"FilterProjection":if(g=this.visit(e.children[0],t),!Array.isArray(g))return null;const O=[],N=[];for(d=0;d<g.length;d+=1)r=this.visit(e.children[2],g[d]),JI(r)||O.push(g[d]);for(let B=0;B<O.length;B+=1)i=this.visit(e.children[1],O[B]),i!==null&&N.push(i);return N;case"Comparator":switch(a=this.visit(e.children[0],t),o=this.visit(e.children[1],t),e.name){case en.TOK_EQ:s=uL(a,o);break;case en.TOK_NE:s=!uL(a,o);break;case en.TOK_GT:s=a>o;break;case en.TOK_GTE:s=a>=o;break;case en.TOK_LT:s=a<o;break;case en.TOK_LTE:s=a<=o;break;default:throw new Error(`Unknown comparator: ${e.name}`)}return s;case en.TOK_FLATTEN:const I=this.visit(e.children[0],t);if(!Array.isArray(I))return null;let D=[];for(d=0;d<I.length;d+=1)i=I[d],Array.isArray(i)?D=[...D,...i]:D.push(i);return D;case"Identity":return t;case"MultiSelectList":if(t===null)return null;for(f=[],d=0;d<e.children.length;d+=1)f.push(this.visit(e.children[d],t));return f;case"MultiSelectHash":if(t===null)return null;f={};let V;for(d=0;d<e.children.length;d+=1)V=e.children[d],f[V.name]=this.visit(V.value,t);return f;case"OrExpression":return r=this.visit(e.children[0],t),JI(r)&&(r=this.visit(e.children[1],t)),r;case"AndExpression":return a=this.visit(e.children[0],t),JI(a)?a:this.visit(e.children[1],t);case"NotExpression":return a=this.visit(e.children[0],t),JI(a);case"Literal":return e.value;case en.TOK_PIPE:return c=this.visit(e.children[0],t),this.visit(e.children[1],c);case en.TOK_CURRENT:return t;case en.TOK_ROOT:return this._rootValue;case"Function":const G=[];for(let B=0;B<e.children.length;B+=1)G.push(this.visit(e.children[B],t));return this.runtime.callFunction(e.name,G);case"ExpressionReference":const Q=e.children[0];return Q.jmespathType=en.TOK_EXPREF,Q;default:throw new Error(`Unknown node type: ${e.type}`)}}computeSliceParams(e,t){let[r,i,s]=t;if(s===null)s=1;else if(s===0){const o=new Error("Invalid slice, step cannot be 0");throw o.name="RuntimeError",o}const a=s<0;return r=r===null?a?e-1:0:this.capSliceRange(e,r,s),i=i===null?a?-1:e:this.capSliceRange(e,i,s),[r,i,s]}capSliceRange(e,t,r){let i=t;return i<0?(i+=e,i<0&&(i=r<0?-1:0)):i>=e&&(i=r<0?e-1:e),i}}const CQe=new AQe;Pn.TYPE_ANY;Pn.TYPE_ARRAY;Pn.TYPE_ARRAY_NUMBER;Pn.TYPE_ARRAY_STRING;Pn.TYPE_BOOLEAN;Pn.TYPE_EXPREF;Pn.TYPE_NULL;Pn.TYPE_NUMBER;Pn.TYPE_OBJECT;Pn.TYPE_STRING;function MQe(n,e){const t=wQe.parse(e);return CQe.search(t,n)}const kQe=(n,e)=>{const t=IT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Dt.NAME,Dt.NAME]),s=MQe(t.json,r);return n.set(i,s),0},OQe=(n,e)=>{const t=IT(n.id());if(!xe(t))return 0;const[r,i]=ln(e,0,[Dt.NAME]);switch(qr(r)){case"seek":{const[a]=ln(e,i,[Dt.NUMBER]);t.cursor=Di(a,0,t.lines.length-1);break}case"line":t.cursor=Di(t.cursor+1,0,t.lines.length-1);break;default:{const a=t.lines[t.cursor]??"",l=new RegExp(r,"i").exec(a)??[];let c=1;for(let u=i;u<e.length;){const[f,d]=ln(e,u,[Dt.NAME]);n.set(f,l[c]??0),++c,u=d}break}}return 0};function Lee(n){const e=Av(b0.MAIN),t=Bpe(e);xe(n.targetdir)?fL(n.targetdir.destpt,n.label,void 0,t):xe(n.targetname)&&fL(n.targetname,n.label,void 0,t)}const IQe=mb({get(n,e){const t=gQe(n.id());if(e==="format")return[!0,t];switch(t){case"text":{const r=IT(n.id());switch(e){case"filename":return[!0,r.filename];case"cursor":return[!0,r.cursor];case"lines":return[!0,r.lines.length]}break}case"json":{const r=IT(n.id());switch(e){case"filename":return[!0,r.filename]}break}case"binary":{const r=IT(n.id());switch(e){case"filename":return[!0,r.filename];case"cursor":return[!0,r.cursor];case"bytes":return[!0,r.bytes.length]}break}}return[!1,void 0]}}).command("endgame",()=>0).command("shortsend",(n,e)=>{const t=Qy(e);return Lee(t),0}).command("send",(n,e)=>{const t=Qy(e,!0);return Lee(t),0}).command("stat",()=>0).command("text",(n,e)=>{const t=e.map(pu).join(" ");return xs(xt,Oe.elementfocus,"$175",t),0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=pu(t),s=Qy(r);return xe(s.targetname)&&xs(xt,Oe.elementfocus,"$175",`!${s.targetname}${s.label};${i}`),0}).command("readline",OQe).command("readjson",kQe).command("readbin",_Qe).command("withboard",(n,e)=>{const[t]=ln(e,0,[Dt.STRING]),r=Pp(t);return xe(r)&&(Oe.board=r,Oe.element={x:-1,y:-1}),0});function Uee(n,e,t,r,i,s){const a=[];for(let o=s;o<i.length;){const[l,c]=ln(i,o,[Dt.ANY]);bi(l)&&!F0(l)&&!bk(l)&&!eL(l)&&!Up(l)?a.push(...l):a.push(l),o=c}switch(qr(r)){case"get":case"post:json":Lke(xt,Oe.elementfocus,n,e,t,r,a);break}return 0}const NQe=mb().command("fetch",(n,e)=>{const[t,r,i="get",s]=ln(e,0,[Dt.NAME,Dt.NAME,Dt.MAYBE_STRING]);return Uee(void 0,t,r,i,e,s),0}).command("fetchwith",(n,e)=>{const[t,r,i,s="get",a]=ln(e,0,[Dt.ANY,Dt.NAME,Dt.NAME,Dt.MAYBE_STRING]);return Uee(t,r,i,s,e,a),0}).command("chat",(n,e)=>{const[t]=ln(e,0,[Dt.MAYBE_NAME]);return t?Pke(xt,Oe.elementfocus,t):Dke(xt,Oe.elementfocus),0});function IM(n,e,t){if(xe(Oe.board)){switch(t){case"shot":case"bombed":$i(e,"breakable")&&Bg(Oe.board,e,Oe.timestamp);break}xe(e?.id)&&n.send(Oe.elementfocus,e.id,t)}}function Bee(n,e){if(xe(e.targetname)){const t=Object.keys(Oe.board?.objects??{});switch(e.targetname){case"all":for(let r=0;r<t.length;++r){const i=t[r],s=Ug(Oe.board,i);xe(s)&&IM(n,s,e.label)}break;case"others":for(let r=0;r<t.length;++r){const i=t[r],s=Ug(Oe.board,i);i!==n.id()&&xe(s)&&IM(n,s,e.label)}break;case"self":Oe.elementid!==n.id()?n.send(Oe.elementfocus,Oe.elementid,e.label):n.message({session:xt.session(),player:Oe.elementfocus,id:vc(),sender:Oe.elementid,target:e.label});break;default:{const r=Mpe(Oe.board,[e.targetname]);for(let i=0;i<r.length;++i){const s=r[i];xe(s)&&IM(n,s,e.label)}break}}}else if(xe(e.targetdir))if(e.targetdir.targets.length)for(let t=0;t<e.targetdir.targets.length;++t){const r=Jo(Oe.board,e.targetdir.targets[t]);xe(r)&&IM(n,r,e.label)}else{const t=Jo(Oe.board,e.targetdir.destpt);xe(t)&&IM(n,t,e.label)}}const PQe=mb({set(n,e,t){return rQe(n,e,t),[!1,void 0]},aftertick(){const n=iQe(Oe.elementid),[e]=n;if(n.length===1&&Vn(e)){if(xe(Oe.element))if(e.trim().length===0){const t=NB(Oe.elementid);t.sidebar=[]}else Oe.element.tickertext=e,Oe.element.tickertime=Oe.timestamp}else if(n.length>1)if(Oe.elementisplayer){const t=NB(Oe.elementid);t.sidebar=Cee(n)}else{const t=NB(Oe.elementfocus);t.scrollname=Oe.element?.name??Oe.element?.kinddata?.name??"",t.scroll=Cee(n)}}}).command("endgame",n=>(n.set("health",0),0)).command("shortsend",(n,e)=>{const t=Qy(e);return Bee(n,t),0}).command("send",(n,e)=>{const t=Qy(e,!0);return Bee(n,t),0}).command("stat",()=>0).command("text",(n,e)=>{const t=e.map(pu).join("");return sQe(Oe.elementid,t),0}).command("hyperlink",(n,e)=>{const[t,...r]=e,i=pu(t),s=Qy(r);return xe(s.targetname)&&aQe(Oe.elementid,n.id(),i,`${s.targetname}:${s.label}`.split(" "),n.get,n.set),0});function DQe(n,e,t,r,i){if(!xe(Oe.book))return;const s=Oe.book,a=jg(s,ni.BOARD,n),o=Jf(a);if(!xe(o))return;const l=aU(),c=i==="all"||i==="object",u=i==="all"||i==="terrain";Bp(o),Bp(l);const f=-Math.tan(e*.5),d=Math.sin(e),g=Math.round(12.5*f),p=Math.round(12.5*d),_=new Array(Ti).fill(0);OQ(g,0,-g,Ti-1).forEach(M=>{M.x<0?_[M.y]=Math.min(_[M.y],M.x):_[M.y]=Math.max(_[M.y],M.x)});const v=new Array(Yn).fill(0);OQ(0,p,Yn-1,-p).forEach(M=>{M.y<0?v[M.x]=Math.min(v[M.x],M.y):v[M.x]=Math.max(v[M.x],M.y)});const E=[_,v,_];for(let M=0;M<E.length;++M){const O=E[M];if(M!==1){for(let N=0;N<Ti;++N){const I=O[N],D=N*Yn;for(let V=0;V<Yn;V++){const G=(V+I+Yn)%Yn;u&&(l.terrain[G+D]=o.terrain[V+D])}}if(c){const N=Object.keys(o.objects);for(let I=0;I<N.length;++I){const D=N[I],{x:V,y:G}=o.objects[D];if(xe(V)&&xe(G)){const Q=O[G];o.objects[D].x=(V+Q+Yn)%Yn,o.objects[D].lx=o.objects[D].x}}}}if(M===1){for(let N=0;N<Yn;++N){const I=O[N];for(let D=0;D<Ti;++D){const V=(D+I+Ti)%Ti;u&&(l.terrain[N+V*Yn]=o.terrain[N+D*Yn])}}if(c){const N=Object.keys(o.objects);for(let I=0;I<N.length;++I){const D=N[I],{x:V,y:G}=o.objects[D];if(xe(V)&&xe(G)){const Q=O[V];o.objects[D].y=(G+Q+Ti)%Ti,o.objects[D].ly=o.objects[D].y}}}}u&&(o.terrain=[...l.terrain]),delete l.named,delete l.lookup,delete o.named,delete o.lookup,Bp(l),Bp(o)}}var PB,Fee;function LQe(){if(Fee)return PB;Fee=1;function n(e,t){let r=0,i=0,s=0;for(;s<e.length;s++)r+=e[s];for(s=0,t*=r;t&&s<e.length;){if(i+=e[s],t<=i)return s;s++}return 0}return PB=n,PB}var DB,zee;function $me(){if(zee)return DB;zee=1;const n=LQe(),e=function(){};return e.prototype.FMX=0,e.prototype.FMY=0,e.prototype.FMXxFMY=0,e.prototype.T=0,e.prototype.N=0,e.prototype.initiliazedField=!1,e.prototype.generationComplete=!1,e.prototype.wave=null,e.prototype.compatible=null,e.prototype.weightLogWeights=null,e.prototype.sumOfWeights=0,e.prototype.sumOfWeightLogWeights=0,e.prototype.startingEntropy=0,e.prototype.sumsOfOnes=null,e.prototype.sumsOfWeights=null,e.prototype.sumsOfWeightLogWeights=null,e.prototype.entropies=null,e.prototype.propagator=null,e.prototype.observed=null,e.prototype.distribution=null,e.prototype.stack=null,e.prototype.stackSize=0,e.prototype.DX=[-1,0,1,0],e.prototype.DY=[0,1,0,-1],e.prototype.opposite=[2,3,0,1],e.prototype.initialize=function(){this.distribution=new Array(this.T),this.wave=new Array(this.FMXxFMY),this.compatible=new Array(this.FMXxFMY);for(let t=0;t<this.FMXxFMY;t++){this.wave[t]=new Array(this.T),this.compatible[t]=new Array(this.T);for(let r=0;r<this.T;r++)this.compatible[t][r]=[0,0,0,0]}this.weightLogWeights=new Array(this.T),this.sumOfWeights=0,this.sumOfWeightLogWeights=0;for(let t=0;t<this.T;t++)this.weightLogWeights[t]=this.weights[t]*Math.log(this.weights[t]),this.sumOfWeights+=this.weights[t],this.sumOfWeightLogWeights+=this.weightLogWeights[t];this.startingEntropy=Math.log(this.sumOfWeights)-this.sumOfWeightLogWeights/this.sumOfWeights,this.sumsOfOnes=new Array(this.FMXxFMY),this.sumsOfWeights=new Array(this.FMXxFMY),this.sumsOfWeightLogWeights=new Array(this.FMXxFMY),this.entropies=new Array(this.FMXxFMY),this.stack=new Array(this.FMXxFMY*this.T),this.stackSize=0},e.prototype.observe=function(t){let r=1e3,i=-1;for(let o=0;o<this.FMXxFMY;o++){if(this.onBoundary(o%this.FMX,o/this.FMX|0))continue;const l=this.sumsOfOnes[o];if(l===0)return!1;const c=this.entropies[o];if(l>1&&c<=r){const u=1e-6*t();c+u<r&&(r=c+u,i=o)}}if(i===-1){this.observed=new Array(this.FMXxFMY);for(let o=0;o<this.FMXxFMY;o++)for(let l=0;l<this.T;l++)if(this.wave[o][l]){this.observed[o]=l;break}return!0}for(let o=0;o<this.T;o++)this.distribution[o]=this.wave[i][o]?this.weights[o]:0;const s=n(this.distribution,t()),a=this.wave[i];for(let o=0;o<this.T;o++)a[o]!==(o===s)&&this.ban(i,o);return null},e.prototype.propagate=function(){for(;this.stackSize>0;){const t=this.stack[this.stackSize-1];this.stackSize--;const r=t[0],i=r%this.FMX,s=r/this.FMX|0;for(let a=0;a<4;a++){const o=this.DX[a],l=this.DY[a];let c=i+o,u=s+l;if(this.onBoundary(c,u))continue;c<0?c+=this.FMX:c>=this.FMX&&(c-=this.FMX),u<0?u+=this.FMY:u>=this.FMY&&(u-=this.FMY);const f=c+u*this.FMX,d=this.propagator[a][t[1]],g=this.compatible[f];for(let p=0;p<d.length;p++){const _=d[p],y=g[_];y[a]--,y[a]==0&&this.ban(f,_)}}}},e.prototype.singleIteration=function(t){const r=this.observe(t);return r!==null?(this.generationComplete=r,!!r):(this.propagate(),null)},e.prototype.iterate=function(t,r){this.wave||this.initialize(),this.initiliazedField||this.clear(),t=t||0,r=r||Math.random;for(let i=0;i<t||t===0;i++){const s=this.singleIteration(r);if(s!==null)return!!s}return!0},e.prototype.generate=function(t){for(t=t||Math.random,this.wave||this.initialize(),this.clear();;){const r=this.singleIteration(t);if(r!==null)return!!r}},e.prototype.isGenerationComplete=function(){return this.generationComplete},e.prototype.ban=function(t,r){const i=this.compatible[t][r];for(let a=0;a<4;a++)i[a]=0;this.wave[t][r]=!1,this.stack[this.stackSize]=[t,r],this.stackSize++,this.sumsOfOnes[t]-=1,this.sumsOfWeights[t]-=this.weights[r],this.sumsOfWeightLogWeights[t]-=this.weightLogWeights[r];const s=this.sumsOfWeights[t];this.entropies[t]=Math.log(s)-this.sumsOfWeightLogWeights[t]/s},e.prototype.clear=function(){for(let t=0;t<this.FMXxFMY;t++){for(let r=0;r<this.T;r++){this.wave[t][r]=!0;for(let i=0;i<4;i++)this.compatible[t][r][i]=this.propagator[this.opposite[i]][r].length}this.sumsOfOnes[t]=this.weights.length,this.sumsOfWeights[t]=this.sumOfWeights,this.sumsOfWeightLogWeights[t]=this.sumOfWeightLogWeights,this.entropies[t]=this.startingEntropy}this.initiliazedField=!0,this.generationComplete=!1},DB=e,DB}var LB,jee;function UQe(){if(jee)return LB;jee=1;const n=$me(),e=function(r,i,s,a,o,l,c,u,f,d){d=d||0,this.N=a,this.FMX=o,this.FMY=l,this.FMXxFMY=o*l,this.periodic=u;const g=i,p=new Array(g);for(let Q=0;Q<g;Q++)p[Q]=new Array(s);this.colors=[];const _={};for(let Q=0;Q<s;Q++)for(let B=0;B<i;B++){const $=(Q*i+B)*4,U=[r[$],r[$+1],r[$+2],r[$+3]],J=U.join("-");_.hasOwnProperty(J)||(_[J]=this.colors.length,this.colors.push(U)),p[B][Q]=_[J]}const y=this.colors.length,v=Math.pow(y,a*a),x=function(B){let $=new Array(a*a);for(let U=0;U<a;U++)for(let J=0;J<a;J++)$[J+U*a]=B(J,U);return $},E=function(B,$){return x(function(U,J){return p[(B+U)%i][($+J)%s]})},M=function(B){return x(function($,U){return B[a-1-U+$*a]})},O=function(B){return x(function($,U){return B[a-1-$+U*a]})},N=function(B){let $=0,U=1;for(let J=0;J<B.length;J++)$+=B[B.length-1-J]*U,U*=y;return $},I=function(B){let $=B,U=v;const J=new Array(a*a);for(let W=0;W<J.length;W++){U/=y;let q=0;for(;$>=U;)$-=U,q++;J[W]=q}return J},D={},V=[];for(let Q=0;Q<(c?s:s-a+1);Q++)for(let B=0;B<(c?i:i-a+1);B++){const $=new Array(8);$[0]=E(B,Q),$[1]=O($[0]),$[2]=M($[0]),$[3]=O($[2]),$[4]=M($[2]),$[5]=O($[4]),$[6]=M($[4]),$[7]=O($[6]);for(let U=0;U<f;U++){const J=N($[U]);D[J]?D[J]++:(V.push(J),D[J]=1)}}this.T=V.length,this.ground=(d+this.T)%this.T,this.patterns=new Array(this.T),this.weights=new Array(this.T);for(let Q=0;Q<this.T;Q++){const B=parseInt(V[Q],10);this.patterns[Q]=I(B),this.weights[Q]=D[B]}const G=function(B,$,U,J){const W=U<0?0:U,q=U<0?U+a:a,Y=J<0?0:J,ae=J<0?J+a:a;for(let Z=Y;Z<ae;Z++)for(let K=W;K<q;K++)if(B[K+a*Z]!=$[K-U+a*(Z-J)])return!1;return!0};this.propagator=new Array(4);for(let Q=0;Q<4;Q++){this.propagator[Q]=new Array(this.T);for(let B=0;B<this.T;B++){const $=[];for(let U=0;U<this.T;U++)G(this.patterns[B],this.patterns[U],this.DX[Q],this.DY[Q])&&$.push(U);this.propagator[Q][B]=$}}};return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(t,r){return!this.periodic&&(t+this.N>this.FMX||r+this.N>this.FMY||t<0||r<0)},e.prototype.clear=function(){if(n.prototype.clear.call(this),this.ground!==0){for(let t=0;t<this.FMX;t++){for(let r=0;r<this.T;r++)r!==this.ground&&this.ban(t+(this.FMY-1)*this.FMX,r);for(let r=0;r<this.FMY-1;r++)this.ban(t+r*this.FMX,this.ground)}this.propagate()}},e.prototype.graphics=function(t){return t=t||new Uint8Array(this.FMXxFMY*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t),t},e.prototype.graphicsComplete=function(t){for(let r=0;r<this.FMY;r++){const i=r<this.FMY-this.N+1?0:this.N-1;for(let s=0;s<this.FMX;s++){const a=s<this.FMX-this.N+1?0:this.N-1,o=(r*this.FMX+s)*4,l=this.colors[this.patterns[this.observed[s-a+(r-i)*this.FMX]][a+i*this.N]];t[o]=l[0],t[o+1]=l[1],t[o+2]=l[2],t[o+3]=l[3]}}},e.prototype.graphicsIncomplete=function(t){for(let r=0;r<this.FMXxFMY;r++){const i=r%this.FMX,s=r/this.FMX|0;let a=0,o=0,l=0,c=0,u=0;for(let d=0;d<this.N;d++)for(let g=0;g<this.N;g++){let p=i-g;p<0&&(p+=this.FMX);let _=s-d;if(_<0&&(_+=this.FMY),this.onBoundary(p,_))continue;const y=p+_*this.FMX;for(let v=0;v<this.T;v++)if(this.wave[y][v]){a++;const x=this.colors[this.patterns[v][g+d*this.N]];o+=x[0],l+=x[1],c+=x[2],u+=x[3]}}const f=r*4;t[f]=o/a,t[f+1]=l/a,t[f+2]=c/a,t[f+3]=u/a}},LB=e,LB}var UB,Hee;function BQe(){if(Hee)return UB;Hee=1;const n=$me(),e=function(r,i,s,a,o){const l=r.tilesize||16;this.FMX=s,this.FMY=a,this.FMXxFMY=s*a,this.periodic=o,this.tilesize=l;const c=!!r.unique;let u=null;i&&r.subsets&&r.subsets[i]&&(u=r.subsets[i]);const f=function(N){const I=new Array(l*l);for(let D=0;D<l;D++)for(let V=0;V<l;V++)I[V+D*l]=N(V,D);return I},d=function(N){return f(function(I,D){return N[l-1-D+I*l]})},g=function(N){return f(function(I,D){return N[l-1-I+D*l]})};this.tiles=[];const p=[],_=[],y={};let v,x,E;for(let O=0;O<r.tiles.length;O++){const N=r.tiles[O];if(u!==null&&u.indexOf(N.name)===-1)continue;switch(N.symmetry){case"L":E=4,v=function(D){return(D+1)%4},x=function(D){return D%2===0?D+1:D-1};break;case"T":E=4,v=function(D){return(D+1)%4},x=function(D){return D%2===0?D:4-D};break;case"I":E=2,v=function(D){return 1-D},x=function(D){return D};break;case"\\":E=2,v=function(D){return 1-D},x=function(D){return 1-D};break;case"F":E=8,v=function(D){return D<4?(D+1)%4:4+(D-1)%4},x=function(D){return D<4?D+4:D-4};break;default:E=1,v=function(D){return D},x=function(D){return D};break}this.T=_.length,y[N.name]=this.T;for(let D=0;D<E;D++)_.push([this.T+D,this.T+v(D),this.T+v(v(D)),this.T+v(v(v(D))),this.T+x(D),this.T+x(v(D)),this.T+x(v(v(D))),this.T+x(v(v(v(D))))]);let I;if(c)for(let D=0;D<E;D++)I=N.bitmap[D],this.tiles.push(f(function(V,G){return[I[(l*G+V)*4],I[(l*G+V)*4+1],I[(l*G+V)*4+2],I[(l*G+V)*4+3]]}));else{I=N.bitmap,this.tiles.push(f(function(D,V){return[I[(l*V+D)*4],I[(l*V+D)*4+1],I[(l*V+D)*4+2],I[(l*V+D)*4+3]]}));for(let D=1;D<E;D++)this.tiles.push(D<4?d(this.tiles[this.T+D-1]):g(this.tiles[this.T+D-4]))}for(let D=0;D<E;D++)p.push(N.weight||1)}this.T=_.length,this.weights=p,this.propagator=new Array(4);const M=new Array(4);for(let O=0;O<4;O++){this.propagator[O]=new Array(this.T),M[O]=new Array(this.T);for(let N=0;N<this.T;N++){M[O][N]=new Array(this.T);for(let I=0;I<this.T;I++)M[O][N][I]=!1}}for(let O=0;O<r.neighbors.length;O++){const N=r.neighbors[O],I=N.left.split(" ").filter(function($){return $.length}),D=N.right.split(" ").filter(function($){return $.length});if(u!==null&&(u.indexOf(I[0])===-1||u.indexOf(D[0])===-1))continue;const V=_[y[I[0]]][I.length==1?0:parseInt(I[1],10)],G=_[V][1],Q=_[y[D[0]]][D.length==1?0:parseInt(D[1],10)],B=_[Q][1];M[0][Q][V]=!0,M[0][_[Q][6]][_[V][6]]=!0,M[0][_[V][4]][_[Q][4]]=!0,M[0][_[V][2]][_[Q][2]]=!0,M[1][B][G]=!0,M[1][_[G][6]][_[B][6]]=!0,M[1][_[B][4]][_[G][4]]=!0,M[1][_[G][2]][_[B][2]]=!0}for(let O=0;O<this.T;O++)for(let N=0;N<this.T;N++)M[2][O][N]=M[0][N][O],M[3][O][N]=M[1][N][O];for(let O=0;O<4;O++)for(let N=0;N<this.T;N++){const I=[],D=M[O][N];for(let V=0;V<this.T;V++)D[V]&&I.push(V);this.propagator[O][N]=I}};return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.onBoundary=function(t,r){return!this.periodic&&(t<0||r<0||t>=this.FMX||r>=this.FMY)},e.prototype.graphics=function(t,r){return t=t||new Uint8Array(this.FMXxFMY*this.tilesize*this.tilesize*4),this.isGenerationComplete()?this.graphicsComplete(t):this.graphicsIncomplete(t,r),t},e.prototype.graphicsComplete=function(t){for(let r=0;r<this.FMX;r++)for(let i=0;i<this.FMY;i++){const s=this.tiles[this.observed[r+i*this.FMX]];for(let a=0;a<this.tilesize;a++)for(let o=0;o<this.tilesize;o++){const l=(r*this.tilesize+o+(i*this.tilesize+a)*this.FMX*this.tilesize)*4,c=s[o+a*this.tilesize];t[l]=c[0],t[l+1]=c[1],t[l+2]=c[2],t[l+3]=c[3]}}},e.prototype.graphicsIncomplete=function(t,r){(!r||r.length!==4)&&(r=!1);for(let i=0;i<this.FMX;i++)for(let s=0;s<this.FMY;s++){const a=this.wave[i+s*this.FMX];let o=0,l=0;for(let u=0;u<this.T;u++)a[u]&&(o++,l+=this.weights[u]);const c=1/l;for(let u=0;u<this.tilesize;u++)for(let f=0;f<this.tilesize;f++){const d=(i*this.tilesize+f+(s*this.tilesize+u)*this.FMX*this.tilesize)*4;if(r&&o===this.T)t[d]=r[0],t[d+1]=r[1],t[d+2]=r[2],t[d+3]=r[3];else{let g=0,p=0,_=0,y=0;for(let v=0;v<this.T;v++)if(a[v]){const x=this.tiles[v][f+u*this.tilesize],E=this.weights[v]*c;g+=x[0]*E,p+=x[1]*E,_+=x[2]*E,y+=x[3]*E}t[d]=g,t[d+1]=p,t[d+2]=_,t[d+3]=y}}}},UB=e,UB}var BB,qee;function FQe(){return qee||(qee=1,BB={OverlappingModel:UQe(),SimpleTiledModel:BQe()}),BB}var zQe=FQe();const jQe=Bh(zQe),Vee=5;function HQe(n,e,t,r,i,s,a){if(!xe(Oe.book))return!1;const o=Oe.book,l=jg(o,ni.BOARD,n),c=jg(o,ni.BOARD,e),u=Jf(l),f=Jf(c);if(!xe(u)||!xe(f))return!1;Bp(u),Bp(f);let d=0;const g=new Map,p=new Map;let _=0;const y=32,v=new Uint8Array(b_*4);for(let I=0;I<Ti;++I)for(let D=0;D<Yn;++D){const V=Jo(f,{x:D,y:I}),G=V?.char??0,Q=V?.color??y,B=V?.bg??y;v[_++]=G,v[_++]=Q,v[_++]=B;const $=O1(V),U=qr($?.name??"empty"),J=g.get(U);Mn(J)?v[_++]=J:(g.set(U,d),p.set(d,U),v[_++]=d++)}const x=s.x-i.x+1,E=s.y-i.y+1,M=new jQe.OverlappingModel(v,Yn,Ti,t,x,E,!1,!1,r,0);let O=0;for(;O<Vee&&!M.generate();++O);if(O===Vee)return!1;_=0;const N=M.graphics();for(let I=i.y;I<=s.y;++I)for(let D=i.x;D<=s.x;++D){const V={x:D,y:I},G=N[_++],Q=N[_++],B=N[_++];switch(d=N[_++],a){case"all":{const W=Jo(u,{x:D,y:I});yf(W)&&Bg(u,W,o.timestamp),Ed(u,{x:D,y:I});break}case"object":{const W=Jo(u,{x:D,y:I});yf(W)&&Bg(u,W,o.timestamp);break}case"terrain":Ed(u,{x:D,y:I});break}let $=p.get(d)??"";const U=O1({kind:$});switch(a){case"all":break;case"object":yf(U)||($="");break;case"terrain":yf(U)&&($="");break;default:if($i(U,"group")!==a&&($=""),$){const W=Jo(u,{x:D,y:I});yf(W)&&Bg(u,W,o.timestamp),Ed(u,{x:D,y:I})}break}const J=$?D0(u,[$],V):void 0;if(!(!xe(J)||!xe(U))&&(NE(J,U),G>0&&(J.char=G),Q<y&&(J.color=Q),B<y&&(J.bg=B),yf(J))){const W=T0(Gw(f,$));xe(W)&&(Ed(u,{...IE(f,W.x??0,W.y??0),x:D,y:I}),NE(J,W))}}return!0}function Wme(n){return`zss_snapshot_${n}`}const Yme={x:0,y:0},Xme={x:Yn-1,y:Ti-1},Kme="all";function qQe(n){const e=jg(Oe.book,ni.BOARD,n),t=Jf(e);if(!xe(t))return;const r=Wme(t.id);Cpe(Oe.book,r);const[i]=uet(b0.MAIN,r,ni.BOARD),s=Jf(i);if(xe(s))return cU(n,s.id,Yme,Xme,Kme),s}function VQe(n){const e=jg(Oe.book,ni.BOARD,n),t=Jf(e);if(!xe(t))return;const r=Wme(t.id),i=jg(Oe.book,ni.BOARD,r),s=Jf(i);if(xe(s))return cU(s.id,n,Yme,Xme,Kme),s}function GQe(n,e,t,r,i,s){switch(s){case"all":case"object":case"terrain":break;default:return $Qe(n,e,i,s)}if(!xe(Oe.book))return;const a=Oe.book,o=jg(a,ni.BOARD,n),l=Jf(o);if(!xe(l))return;const c=aU();Bp(l);for(let u=t.y;u<=r.y;++u)for(let f=t.x;f<=r.x;++f){let d=!1,g=!1;switch(s){case"all":d=!0,g=!0;break;case"object":d=!0;break;case"terrain":g=!0;break}const p=(f+e.x+Yn)%Yn,_=(u+e.y+Ti)%Ti;if(d){const y=Jo(l,{x:f,y:u});yf(y)&&xe(y?.x)&&xe(y?.y)&&(y.x=p,y.lx=p,y.y=_,y.ly=_)}g&&(c.terrain[p+_*Yn]=l.terrain[f+u*Yn])}(s==="all"||s==="terrain")&&(l.terrain=[...c.terrain]),vk(l)}function $Qe(n,e,t,r){if(!xe(Oe.book))return;const i=Oe.book,s=jg(i,ni.BOARD,n),a=Jf(s);if(!xe(a))return;Bp(a);const{terrainelements:o,objectelements:l}=Npe(a,t,r);if(o.length===0&&l.length===0)return;e.x<0&&(o.sort((p,_)=>{const y=p.x??0,v=_.x??0;return y-v}),l.sort((p,_)=>{const y=p.x??0,v=_.x??0;return y-v})),e.x>0&&(o.sort((p,_)=>{const y=p.x??0;return(_.x??0)-y}),l.sort((p,_)=>{const y=p.x??0;return(_.x??0)-y})),e.y<0&&(o.sort((p,_)=>{const y=p.y??0,v=_.y??0;return y-v}),l.sort((p,_)=>{const y=p.y??0,v=_.y??0;return y-v})),e.y>0&&(o.sort((p,_)=>{const y=p.y??0;return(_.y??0)-y}),l.sort((p,_)=>{const y=p.y??0;return(_.y??0)-y}));const c=l.map(p=>p.id??""),u=o.map(p=>gf({x:p.x??0,y:p.y??0},Yn)),f=[],d=[];for(let p=0;p<o.length;++p){const _=o[p],y={x:_.x??-1,y:_.y??-1},v=Jo(a,y);xe(v)&&yf(v)&&(f.push(v.id??""),f.push(v.id??""),d.push(gf({x:v.x??0,y:v.y??0},Yn)))}let g=!1;for(let p=0;p<o.length;++p){const _=o[p],y=$i(_,"collision"),v={x:_.x??-1,y:_.y??-1},x=gf(v,Yn),E={x:v.x+e.x,y:v.y+e.y};if(uw(E)){const M=Jo(a,E),O=M?.id??"",N=gf({x:M?.x??0,y:M?.y??0},Yn),I=$i(M,"collision");if(xe(M)&&yf(M)&&f.includes(O)!==!0&&c.includes(O)!==!0){let D=!1;const V=d.includes(x),G=V?Jo(a,v):void 0,Q=V?$i(G,"pushable"):!1,B=V&&Q;if(w9(_,M)&&(y!==Rr.ISWALK||V)){let $=V;xe(G)&&Q&&(g=S_(i,a,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0,g||($=!1)),($||y!==Rr.ISWALK)&&(g=S_(i,a,M,{x:(M.x??0)+e.x,y:(M.y??0)+e.y})!==!0,g&&(D=B))}else(y!==Rr.ISWALK||B)&&(g=!0,D=B);D&&xe(G)&&(g=S_(i,a,G,{x:(G.x??0)-e.x,y:(G.y??0)-e.y})!==!0)}else I===Rr.ISSOLID&&u.includes(N)===!1&&(g=!0)}else g=!0}if(!g){for(let p=0;p<l.length;++p){const _=l[p],y=$i(_,"collision"),v={x:_.x??0,y:_.y??0},x={x:v.x+e.x,y:v.y+e.y};if(uw(x)){const E=Jo(a,x),M=E?.id??"",O=$i(E,"collision"),N=$i(E,"group");xe(E)&&yf(E)&&f.includes(M)&&c.includes(M)!==!0?w9(_,E)?g=S_(i,a,E,x)!==!0:g=!0:sU(y,O)&&r!==N&&(g=!0)}else g=!0}if(!g){for(let p=0;p<o.length;++p){const _=o[p],y={x:_.x??-1,y:_.y??-1},v={x:y.x+e.x,y:y.y+e.y},x=IE(a,v.x,v.y);if(xe(_)&&xe(x)){Ed(a,{..._,x:v.x,y:v.y}),Ed(a,{...x,x:y.x,y:y.y});const E=Jo(a,y);yf(E)&&xe(E)&&(E.x=(E.x??0)+e.x,E.y=(E.y??0)+e.y,E.lx=(E.lx??0)+e.x,E.ly=(E.ly??0)+e.y)}}vk(a);for(let p=0;p<l.length;++p){const _=l[p],y={x:_.x??-1,y:_.y??-1},v={x:y.x+e.x,y:y.y+e.y};if(!S_(i,a,_,v))break}vk(a)}}}function eN(n,e){let t="all";const r={x:0,y:0},i={x:Yn-1,y:Ti-1};for(let s=e;s<n.length;){const[a,o]=ln(n,s,[Dt.MAYBE_NUMBER_OR_STRING]);if(Vn(a))t=qr(a),s=o;else if(Mn(a)){const[l,c,u,f]=ln(n,o,[Dt.NUMBER,Dt.MAYBE_NUMBER,Dt.MAYBE_NUMBER]);r.x=Math.min(a,c??a),r.y=Math.min(l,u??l),i.x=Math.max(a,c??a),i.y=Math.max(l,u??l),s=f}else break}return{targetset:t,pt1:r,pt2:i}}function Gee(n,e){const t=Py();for(let r=0;r<t.length;++r){const i=t[r],s=T0(s9(i,n,e));if(xe(s))return s}}const WQe=mb().command("snapshot",()=>(!xe(Oe.book)||!xe(Oe.board)||qQe(Oe.board.id),0)).command("revert",()=>(!xe(Oe.book)||!xe(Oe.board)||VQe(Oe.board.id),0)).command("copy",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.STRING]),i=Gee(ni.BOARD,t);if(xe(i)){const s=eN(e,r);cU(i.id,Oe.board.id,s.pt1,s.pt2,s.targetset)}return 0}).command("remix",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r,i,s]=ln(e,0,[Dt.STRING,Dt.NUMBER,Dt.NUMBER]),a=Gee(ni.BOARD,t);if(xe(a)){const o=eN(e,s);HQe(Oe.board.id,a.id,r,i,o.pt1,o.pt2,o.targetset)}return 0}).command("weave",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.DIR]),i={x:t.destpt.x-(Oe.element?.x??0),y:t.destpt.y-(Oe.element?.y??0)},s=eN(e,r);return GQe(Oe.board.id,i,s.pt1,s.pt2,Oe.elementid,s.targetset),0}).command("pivot",(n,e)=>{if(!xe(Oe.book)||!xe(Oe.board))return 0;const[t,r]=ln(e,0,[Dt.NUMBER]),i=eN(e,r);return DQe(Oe.board.id,ike(t),i.pt1,i.pt2,i.targetset),0});var mq=(n=>(n[n.ERROR=0]="ERROR",n[n.CLI=1]="CLI",n[n.LOADER=2]="LOADER",n[n.RUNTIME=3]="RUNTIME",n))(mq||{});const YQe={audio:lU,board:VVe,cli:cQe,display:uQe,element:mQe,runtime:PQe,loader:IQe,network:NQe,transform:WQe},FB=["audio","board","display","network","transform","element"],XQe={0:[],1:["cli",...FB],2:["loader",...FB],3:["runtime",...FB]},KQe={0:new Map,1:new Map,2:new Map,3:new Map};function MO(n){return(XQe[n]??[]).map(t=>YQe[t]).filter(xe)}function ZQe(n,e){const t=KQe[n];if(!t.has(e)){let r;const i=MO(n);for(let s=0;s<i.length&&(r=i[s].getcommand(e),!xe(r));++s);t.set(e,r)}return t.get(e)}function QQe(n,e,t){const r=MO(n);for(let i=0;i<r.length;++i){const s=r[i];if(s.get!==void 0){const[a,o]=s.get(e,t);if(a)return[a,o]}}return[!1,void 0]}function JQe(n,e,t,r){const i=MO(n);for(let s=0;s<i.length;++s){const a=i[s];if(a.set!==void 0){const[o]=a.set(e,t,r);if(o)return[o,r]}}return[!1,void 0]}function eJe(n,e){const t=MO(n);for(let r=0;r<t.length;++r)t[r].everytick(e)}function tJe(n,e){const t=MO(n);for(let r=0;r<t.length;++r)t[r].aftertick(e)}var NM={},zB={},jB={},HB={},$ee;function nJe(){if($ee)return HB;$ee=1;const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return HB.encode=function(e){if(0<=e&&e<n.length)return n[e];throw new TypeError("Must be between 0 and 63: "+e)},HB}var Wee;function Zme(){if(Wee)return jB;Wee=1;const n=nJe(),e=5,t=1<<e,r=t-1,i=t;function s(a){return a<0?(-a<<1)+1:(a<<1)+0}return jB.encode=function(o){let l="",c,u=s(o);do c=u&r,u>>>=e,u>0&&(c|=i),l+=n.encode(c);while(u>0);return l},jB}var l_={},SS={},i2={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */var rJe=i2.exports,Yee;function iJe(){return Yee||(Yee=1,(function(n,e){(function(t){var r=e&&!e.nodeType&&e,i=n&&!n.nodeType&&n,s=typeof C0=="object"&&C0;(s.global===s||s.window===s||s.self===s)&&(t=s);var a,o=2147483647,l=36,c=1,u=26,f=38,d=700,g=72,p=128,_="-",y=/^xn--/,v=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,E={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},M=l-c,O=Math.floor,N=String.fromCharCode,I;function D(Z){throw new RangeError(E[Z])}function V(Z,K){for(var ne=Z.length,le=[];ne--;)le[ne]=K(Z[ne]);return le}function G(Z,K){var ne=Z.split("@"),le="";ne.length>1&&(le=ne[0]+"@",Z=ne[1]),Z=Z.replace(x,".");var ce=Z.split("."),de=V(ce,K).join(".");return le+de}function Q(Z){for(var K=[],ne=0,le=Z.length,ce,de;ne<le;)ce=Z.charCodeAt(ne++),ce>=55296&&ce<=56319&&ne<le?(de=Z.charCodeAt(ne++),(de&64512)==56320?K.push(((ce&1023)<<10)+(de&1023)+65536):(K.push(ce),ne--)):K.push(ce);return K}function B(Z){return V(Z,function(K){var ne="";return K>65535&&(K-=65536,ne+=N(K>>>10&1023|55296),K=56320|K&1023),ne+=N(K),ne}).join("")}function $(Z){return Z-48<10?Z-22:Z-65<26?Z-65:Z-97<26?Z-97:l}function U(Z,K){return Z+22+75*(Z<26)-((K!=0)<<5)}function J(Z,K,ne){var le=0;for(Z=ne?O(Z/d):Z>>1,Z+=O(Z/K);Z>M*u>>1;le+=l)Z=O(Z/M);return O(le+(M+1)*Z/(Z+f))}function W(Z){var K=[],ne=Z.length,le,ce=0,de=p,Me=g,qe,Pe,Ce,Xe,$e,at,pt,oe,Ue;for(qe=Z.lastIndexOf(_),qe<0&&(qe=0),Pe=0;Pe<qe;++Pe)Z.charCodeAt(Pe)>=128&&D("not-basic"),K.push(Z.charCodeAt(Pe));for(Ce=qe>0?qe+1:0;Ce<ne;){for(Xe=ce,$e=1,at=l;Ce>=ne&&D("invalid-input"),pt=$(Z.charCodeAt(Ce++)),(pt>=l||pt>O((o-ce)/$e))&&D("overflow"),ce+=pt*$e,oe=at<=Me?c:at>=Me+u?u:at-Me,!(pt<oe);at+=l)Ue=l-oe,$e>O(o/Ue)&&D("overflow"),$e*=Ue;le=K.length+1,Me=J(ce-Xe,le,Xe==0),O(ce/le)>o-de&&D("overflow"),de+=O(ce/le),ce%=le,K.splice(ce++,0,de)}return B(K)}function q(Z){var K,ne,le,ce,de,Me,qe,Pe,Ce,Xe,$e,at=[],pt,oe,Ue,Ge;for(Z=Q(Z),pt=Z.length,K=p,ne=0,de=g,Me=0;Me<pt;++Me)$e=Z[Me],$e<128&&at.push(N($e));for(le=ce=at.length,ce&&at.push(_);le<pt;){for(qe=o,Me=0;Me<pt;++Me)$e=Z[Me],$e>=K&&$e<qe&&(qe=$e);for(oe=le+1,qe-K>O((o-ne)/oe)&&D("overflow"),ne+=(qe-K)*oe,K=qe,Me=0;Me<pt;++Me)if($e=Z[Me],$e<K&&++ne>o&&D("overflow"),$e==K){for(Pe=ne,Ce=l;Xe=Ce<=de?c:Ce>=de+u?u:Ce-de,!(Pe<Xe);Ce+=l)Ge=Pe-Xe,Ue=l-Xe,at.push(N(U(Xe+Ge%Ue,0))),Pe=O(Ge/Ue);at.push(N(U(Pe,0))),de=J(ne,oe,le==ce),ne=0,++le}++ne,++K}return at.join("")}function Y(Z){return G(Z,function(K){return y.test(K)?W(K.slice(4).toLowerCase()):K})}function ae(Z){return G(Z,function(K){return v.test(K)?"xn--"+q(K):K})}if(a={version:"1.4.1",ucs2:{decode:Q,encode:B},decode:W,encode:q,toASCII:ae,toUnicode:Y},r&&i)if(n.exports==r)i.exports=a;else for(I in a)a.hasOwnProperty(I)&&(r[I]=a[I]);else t.punycode=a})(rJe)})(i2,i2.exports)),i2.exports}var qB,Xee;function Kw(){return Xee||(Xee=1,qB=TypeError),qB}const sJe={},aJe=Object.freeze(Object.defineProperty({__proto__:null,default:sJe},Symbol.toStringTag,{value:"Module"})),oJe=uSe(aJe);var VB,Kee;function wU(){if(Kee)return VB;Kee=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=n&&e&&typeof e.get=="function"?e.get:null,r=n&&Map.prototype.forEach,i=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&i?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=i&&s&&typeof s.get=="function"?s.get:null,o=i&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,c=l?WeakMap.prototype.has:null,u=typeof WeakSet=="function"&&WeakSet.prototype,f=u?WeakSet.prototype.has:null,d=typeof WeakRef=="function"&&WeakRef.prototype,g=d?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,_=Object.prototype.toString,y=Function.prototype.toString,v=String.prototype.match,x=String.prototype.slice,E=String.prototype.replace,M=String.prototype.toUpperCase,O=String.prototype.toLowerCase,N=RegExp.prototype.test,I=Array.prototype.concat,D=Array.prototype.join,V=Array.prototype.slice,G=Math.floor,Q=typeof BigInt=="function"?BigInt.prototype.valueOf:null,B=Object.getOwnPropertySymbols,$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,U=typeof Symbol=="function"&&typeof Symbol.iterator=="object",J=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===U||!0)?Symbol.toStringTag:null,W=Object.prototype.propertyIsEnumerable,q=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ke){return ke.__proto__}:null);function Y(ke,Re){if(ke===1/0||ke===-1/0||ke!==ke||ke&&ke>-1e3&&ke<1e3||N.call(/e/,Re))return Re;var st=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ke=="number"){var Ve=ke<0?-G(-ke):G(ke);if(Ve!==ke){var tt=String(Ve),Ze=x.call(Re,tt.length+1);return E.call(tt,st,"$&_")+"."+E.call(E.call(Ze,/([0-9]{3})/g,"$&_"),/_$/,"")}}return E.call(Re,st,"$&_")}var ae=oJe,Z=ae.custom,K=oe(Z)?Z:null,ne={__proto__:null,double:'"',single:"'"},le={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};VB=function ke(Re,st,Ve,tt){var Ze=st||{};if(ze(Ze,"quoteStyle")&&!ze(ne,Ze.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ze(Ze,"maxStringLength")&&(typeof Ze.maxStringLength=="number"?Ze.maxStringLength<0&&Ze.maxStringLength!==1/0:Ze.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var nt=ze(Ze,"customInspect")?Ze.customInspect:!0;if(typeof nt!="boolean"&&nt!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ze(Ze,"indent")&&Ze.indent!==null&&Ze.indent!=="	"&&!(parseInt(Ze.indent,10)===Ze.indent&&Ze.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ze(Ze,"numericSeparator")&&typeof Ze.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var vt=Ze.numericSeparator;if(typeof Re>"u")return"undefined";if(Re===null)return"null";if(typeof Re=="boolean")return Re?"true":"false";if(typeof Re=="string")return Vt(Re,Ze);if(typeof Re=="number"){if(Re===0)return 1/0/Re>0?"0":"-0";var Qe=String(Re);return vt?Y(Re,Qe):Qe}if(typeof Re=="bigint"){var ht=String(Re)+"n";return vt?Y(Re,ht):ht}var mt=typeof Ze.depth>"u"?5:Ze.depth;if(typeof Ve>"u"&&(Ve=0),Ve>=mt&&mt>0&&typeof Re=="object")return qe(Re)?"[Array]":"[Object]";var ft=_e(Ze,Ve);if(typeof tt>"u")tt=[];else if(Se(tt,Re)>=0)return"[Circular]";function _t(ws,na,os){if(na&&(tt=V.call(tt),tt.push(na)),os){var We={depth:Ze.depth};return ze(Ze,"quoteStyle")&&(We.quoteStyle=Ze.quoteStyle),ke(ws,We,Ve+1,tt)}return ke(ws,Ze,Ve+1,tt)}if(typeof Re=="function"&&!Ce(Re)){var gn=me(Re),_n=Le(Re,_t);return"[Function"+(gn?": "+gn:" (anonymous)")+"]"+(_n.length>0?" { "+D.call(_n,", ")+" }":"")}if(oe(Re)){var Bt=U?E.call(String(Re),/^(Symbol\(.*\))_[^)]*$/,"$1"):$.call(Re);return typeof Re=="object"&&!U?Ut(Bt):Bt}if(ct(Re)){for(var Yt="<"+O.call(String(Re.nodeName)),Mt=Re.attributes||[],fn=0;fn<Mt.length;fn++)Yt+=" "+Mt[fn].name+"="+ce(de(Mt[fn].value),"double",Ze);return Yt+=">",Re.childNodes&&Re.childNodes.length&&(Yt+="..."),Yt+="</"+O.call(String(Re.nodeName))+">",Yt}if(qe(Re)){if(Re.length===0)return"[]";var Bn=Le(Re,_t);return ft&&!se(Bn)?"["+Ne(Bn,ft)+"]":"[ "+D.call(Bn,", ")+" ]"}if(Xe(Re)){var cn=Le(Re,_t);return!("cause"in Error.prototype)&&"cause"in Re&&!W.call(Re,"cause")?"{ ["+String(Re)+"] "+D.call(I.call("[cause]: "+_t(Re.cause),cn),", ")+" }":cn.length===0?"["+String(Re)+"]":"{ ["+String(Re)+"] "+D.call(cn,", ")+" }"}if(typeof Re=="object"&&nt){if(K&&typeof Re[K]=="function"&&ae)return ae(Re,{depth:mt-Ve});if(nt!=="symbol"&&typeof Re.inspect=="function")return Re.inspect()}if(Ie(Re)){var In=[];return r&&r.call(Re,function(ws,na){In.push(_t(na,Re,!0)+" => "+_t(ws,Re))}),ge("Map",t.call(Re),In,ft)}if(ot(Re)){var $n=[];return o&&o.call(Re,function(ws){$n.push(_t(ws,Re))}),ge("Set",a.call(Re),$n,ft)}if(be(Re))return je("WeakMap");if(lt(Re))return je("WeakSet");if(Ke(Re))return je("WeakRef");if(at(Re))return Ut(_t(Number(Re)));if(Ue(Re))return Ut(_t(Q.call(Re)));if(pt(Re))return Ut(p.call(Re));if($e(Re))return Ut(_t(String(Re)));if(typeof window<"u"&&Re===window)return"{ [object Window] }";if(typeof globalThis<"u"&&Re===globalThis||typeof C0<"u"&&Re===C0)return"{ [object globalThis] }";if(!Pe(Re)&&!Ce(Re)){var er=Le(Re,_t),as=q?q(Re)===Object.prototype:Re instanceof Object||Re.constructor===Object,di=Re instanceof Object?"":"null prototype",Oi=!as&&J&&Object(Re)===Re&&J in Re?x.call(Be(Re),8,-1):di?"Object":"",Bs=as||typeof Re.constructor!="function"?"":Re.constructor.name?Re.constructor.name+" ":"",pi=Bs+(Oi||di?"["+D.call(I.call([],Oi||[],di||[]),": ")+"] ":"");return er.length===0?pi+"{}":ft?pi+"{"+Ne(er,ft)+"}":pi+"{ "+D.call(er,", ")+" }"}return String(Re)};function ce(ke,Re,st){var Ve=st.quoteStyle||Re,tt=ne[Ve];return tt+ke+tt}function de(ke){return E.call(String(ke),/"/g,"&quot;")}function Me(ke){return!J||!(typeof ke=="object"&&(J in ke||typeof ke[J]<"u"))}function qe(ke){return Be(ke)==="[object Array]"&&Me(ke)}function Pe(ke){return Be(ke)==="[object Date]"&&Me(ke)}function Ce(ke){return Be(ke)==="[object RegExp]"&&Me(ke)}function Xe(ke){return Be(ke)==="[object Error]"&&Me(ke)}function $e(ke){return Be(ke)==="[object String]"&&Me(ke)}function at(ke){return Be(ke)==="[object Number]"&&Me(ke)}function pt(ke){return Be(ke)==="[object Boolean]"&&Me(ke)}function oe(ke){if(U)return ke&&typeof ke=="object"&&ke instanceof Symbol;if(typeof ke=="symbol")return!0;if(!ke||typeof ke!="object"||!$)return!1;try{return $.call(ke),!0}catch{}return!1}function Ue(ke){if(!ke||typeof ke!="object"||!Q)return!1;try{return Q.call(ke),!0}catch{}return!1}var Ge=Object.prototype.hasOwnProperty||function(ke){return ke in this};function ze(ke,Re){return Ge.call(ke,Re)}function Be(ke){return _.call(ke)}function me(ke){if(ke.name)return ke.name;var Re=v.call(y.call(ke),/^function\s*([\w$]+)/);return Re?Re[1]:null}function Se(ke,Re){if(ke.indexOf)return ke.indexOf(Re);for(var st=0,Ve=ke.length;st<Ve;st++)if(ke[st]===Re)return st;return-1}function Ie(ke){if(!t||!ke||typeof ke!="object")return!1;try{t.call(ke);try{a.call(ke)}catch{return!0}return ke instanceof Map}catch{}return!1}function be(ke){if(!c||!ke||typeof ke!="object")return!1;try{c.call(ke,c);try{f.call(ke,f)}catch{return!0}return ke instanceof WeakMap}catch{}return!1}function Ke(ke){if(!g||!ke||typeof ke!="object")return!1;try{return g.call(ke),!0}catch{}return!1}function ot(ke){if(!a||!ke||typeof ke!="object")return!1;try{a.call(ke);try{t.call(ke)}catch{return!0}return ke instanceof Set}catch{}return!1}function lt(ke){if(!f||!ke||typeof ke!="object")return!1;try{f.call(ke,f);try{c.call(ke,c)}catch{return!0}return ke instanceof WeakSet}catch{}return!1}function ct(ke){return!ke||typeof ke!="object"?!1:typeof HTMLElement<"u"&&ke instanceof HTMLElement?!0:typeof ke.nodeName=="string"&&typeof ke.getAttribute=="function"}function Vt(ke,Re){if(ke.length>Re.maxStringLength){var st=ke.length-Re.maxStringLength,Ve="... "+st+" more character"+(st>1?"s":"");return Vt(x.call(ke,0,Re.maxStringLength),Re)+Ve}var tt=le[Re.quoteStyle||"single"];tt.lastIndex=0;var Ze=E.call(E.call(ke,tt,"\\$1"),/[\x00-\x1f]/g,kt);return ce(Ze,"single",Re)}function kt(ke){var Re=ke.charCodeAt(0),st={8:"b",9:"t",10:"n",12:"f",13:"r"}[Re];return st?"\\"+st:"\\x"+(Re<16?"0":"")+M.call(Re.toString(16))}function Ut(ke){return"Object("+ke+")"}function je(ke){return ke+" { ? }"}function ge(ke,Re,st,Ve){var tt=Ve?Ne(st,Ve):D.call(st,", ");return ke+" ("+Re+") {"+tt+"}"}function se(ke){for(var Re=0;Re<ke.length;Re++)if(Se(ke[Re],`
`)>=0)return!1;return!0}function _e(ke,Re){var st;if(ke.indent==="	")st="	";else if(typeof ke.indent=="number"&&ke.indent>0)st=D.call(Array(ke.indent+1)," ");else return null;return{base:st,prev:D.call(Array(Re+1),st)}}function Ne(ke,Re){if(ke.length===0)return"";var st=`
`+Re.prev+Re.base;return st+D.call(ke,","+st)+`
`+Re.prev}function Le(ke,Re){var st=qe(ke),Ve=[];if(st){Ve.length=ke.length;for(var tt=0;tt<ke.length;tt++)Ve[tt]=ze(ke,tt)?Re(ke[tt],ke):""}var Ze=typeof B=="function"?B(ke):[],nt;if(U){nt={};for(var vt=0;vt<Ze.length;vt++)nt["$"+Ze[vt]]=Ze[vt]}for(var Qe in ke)ze(ke,Qe)&&(st&&String(Number(Qe))===Qe&&Qe<ke.length||U&&nt["$"+Qe]instanceof Symbol||(N.call(/[^\w$]/,Qe)?Ve.push(Re(Qe,ke)+": "+Re(ke[Qe],ke)):Ve.push(Qe+": "+Re(ke[Qe],ke))));if(typeof B=="function")for(var ht=0;ht<Ze.length;ht++)W.call(ke,Ze[ht])&&Ve.push("["+Re(Ze[ht])+"]: "+Re(ke[Ze[ht]],ke));return Ve}return VB}var GB,Zee;function lJe(){if(Zee)return GB;Zee=1;var n=wU(),e=Kw(),t=function(o,l,c){for(var u=o,f;(f=u.next)!=null;u=f)if(f.key===l)return u.next=f.next,c||(f.next=o.next,o.next=f),f},r=function(o,l){if(o){var c=t(o,l);return c&&c.value}},i=function(o,l,c){var u=t(o,l);u?u.value=c:o.next={key:l,next:o.next,value:c}},s=function(o,l){return o?!!t(o,l):!1},a=function(o,l){if(o)return t(o,l,!0)};return GB=function(){var l,c={assert:function(u){if(!c.has(u))throw new e("Side channel does not contain "+n(u))},delete:function(u){var f=l&&l.next,d=a(l,u);return d&&f&&f===d&&(l=void 0),!!d},get:function(u){return r(l,u)},has:function(u){return s(l,u)},set:function(u,f){l||(l={next:void 0}),i(l,u,f)}};return c},GB}var $B,Qee;function Qme(){return Qee||(Qee=1,$B=Object),$B}var WB,Jee;function cJe(){return Jee||(Jee=1,WB=Error),WB}var YB,ete;function uJe(){return ete||(ete=1,YB=EvalError),YB}var XB,tte;function fJe(){return tte||(tte=1,XB=RangeError),XB}var KB,nte;function hJe(){return nte||(nte=1,KB=ReferenceError),KB}var ZB,rte;function dJe(){return rte||(rte=1,ZB=SyntaxError),ZB}var QB,ite;function pJe(){return ite||(ite=1,QB=URIError),QB}var JB,ste;function mJe(){return ste||(ste=1,JB=Math.abs),JB}var e8,ate;function gJe(){return ate||(ate=1,e8=Math.floor),e8}var t8,ote;function _Je(){return ote||(ote=1,t8=Math.max),t8}var n8,lte;function vJe(){return lte||(lte=1,n8=Math.min),n8}var r8,cte;function yJe(){return cte||(cte=1,r8=Math.pow),r8}var i8,ute;function bJe(){return ute||(ute=1,i8=Math.round),i8}var s8,fte;function SJe(){return fte||(fte=1,s8=Number.isNaN||function(e){return e!==e}),s8}var a8,hte;function EJe(){if(hte)return a8;hte=1;var n=SJe();return a8=function(t){return n(t)||t===0?t:t<0?-1:1},a8}var o8,dte;function xJe(){return dte||(dte=1,o8=Object.getOwnPropertyDescriptor),o8}var l8,pte;function Jme(){if(pte)return l8;pte=1;var n=xJe();if(n)try{n([],"length")}catch{n=null}return l8=n,l8}var c8,mte;function TJe(){if(mte)return c8;mte=1;var n=Object.defineProperty||!1;if(n)try{n({},"a",{value:1})}catch{n=!1}return c8=n,c8}var u8,gte;function wJe(){return gte||(gte=1,u8=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[t]=i;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==i||o.enumerable!==!0)return!1}return!0}),u8}var f8,_te;function RJe(){if(_te)return f8;_te=1;var n=typeof Symbol<"u"&&Symbol,e=wJe();return f8=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},f8}var h8,vte;function ege(){return vte||(vte=1,h8=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),h8}var d8,yte;function tge(){if(yte)return d8;yte=1;var n=Qme();return d8=n.getPrototypeOf||null,d8}var p8,bte;function AJe(){if(bte)return p8;bte=1;var n="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,r="[object Function]",i=function(l,c){for(var u=[],f=0;f<l.length;f+=1)u[f]=l[f];for(var d=0;d<c.length;d+=1)u[d+l.length]=c[d];return u},s=function(l,c){for(var u=[],f=c,d=0;f<l.length;f+=1,d+=1)u[d]=l[f];return u},a=function(o,l){for(var c="",u=0;u<o.length;u+=1)c+=o[u],u+1<o.length&&(c+=l);return c};return p8=function(l){var c=this;if(typeof c!="function"||e.apply(c)!==r)throw new TypeError(n+c);for(var u=s(arguments,1),f,d=function(){if(this instanceof f){var v=c.apply(this,i(u,arguments));return Object(v)===v?v:this}return c.apply(l,i(u,arguments))},g=t(0,c.length-u.length),p=[],_=0;_<g;_++)p[_]="$"+_;if(f=Function("binder","return function ("+a(p,",")+"){ return binder.apply(this,arguments); }")(d),c.prototype){var y=function(){};y.prototype=c.prototype,f.prototype=new y,y.prototype=null}return f},p8}var m8,Ste;function RU(){if(Ste)return m8;Ste=1;var n=AJe();return m8=Function.prototype.bind||n,m8}var g8,Ete;function gq(){return Ete||(Ete=1,g8=Function.prototype.call),g8}var _8,xte;function nge(){return xte||(xte=1,_8=Function.prototype.apply),_8}var v8,Tte;function CJe(){return Tte||(Tte=1,v8=typeof Reflect<"u"&&Reflect&&Reflect.apply),v8}var y8,wte;function MJe(){if(wte)return y8;wte=1;var n=RU(),e=nge(),t=gq(),r=CJe();return y8=r||n.call(t,e),y8}var b8,Rte;function rge(){if(Rte)return b8;Rte=1;var n=RU(),e=Kw(),t=gq(),r=MJe();return b8=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return r(n,t,s)},b8}var S8,Ate;function kJe(){if(Ate)return S8;Ate=1;var n=rge(),e=Jme(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var r=!!t&&e&&e(Object.prototype,"__proto__"),i=Object,s=i.getPrototypeOf;return S8=r&&typeof r.get=="function"?n([r.get]):typeof s=="function"?function(o){return s(o==null?o:i(o))}:!1,S8}var E8,Cte;function OJe(){if(Cte)return E8;Cte=1;var n=ege(),e=tge(),t=kJe();return E8=n?function(i){return n(i)}:e?function(i){if(!i||typeof i!="object"&&typeof i!="function")throw new TypeError("getProto: not an object");return e(i)}:t?function(i){return t(i)}:null,E8}var x8,Mte;function IJe(){if(Mte)return x8;Mte=1;var n=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=RU();return x8=t.call(n,e),x8}var T8,kte;function _q(){if(kte)return T8;kte=1;var n,e=Qme(),t=cJe(),r=uJe(),i=fJe(),s=hJe(),a=dJe(),o=Kw(),l=pJe(),c=mJe(),u=gJe(),f=_Je(),d=vJe(),g=yJe(),p=bJe(),_=EJe(),y=Function,v=function(Ce){try{return y('"use strict"; return ('+Ce+").constructor;")()}catch{}},x=Jme(),E=TJe(),M=function(){throw new o},O=x?(function(){try{return arguments.callee,M}catch{try{return x(arguments,"callee").get}catch{return M}}})():M,N=RJe()(),I=OJe(),D=tge(),V=ege(),G=nge(),Q=gq(),B={},$=typeof Uint8Array>"u"||!I?n:I(Uint8Array),U={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?n:ArrayBuffer,"%ArrayIteratorPrototype%":N&&I?I([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":B,"%AsyncGenerator%":B,"%AsyncGeneratorFunction%":B,"%AsyncIteratorPrototype%":B,"%Atomics%":typeof Atomics>"u"?n:Atomics,"%BigInt%":typeof BigInt>"u"?n:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?n:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":r,"%Float16Array%":typeof Float16Array>"u"?n:Float16Array,"%Float32Array%":typeof Float32Array>"u"?n:Float32Array,"%Float64Array%":typeof Float64Array>"u"?n:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?n:FinalizationRegistry,"%Function%":y,"%GeneratorFunction%":B,"%Int8Array%":typeof Int8Array>"u"?n:Int8Array,"%Int16Array%":typeof Int16Array>"u"?n:Int16Array,"%Int32Array%":typeof Int32Array>"u"?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":N&&I?I(I([][Symbol.iterator]())):n,"%JSON%":typeof JSON=="object"?JSON:n,"%Map%":typeof Map>"u"?n:Map,"%MapIteratorPrototype%":typeof Map>"u"||!N||!I?n:I(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":x,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?n:Promise,"%Proxy%":typeof Proxy>"u"?n:Proxy,"%RangeError%":i,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?n:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?n:Set,"%SetIteratorPrototype%":typeof Set>"u"||!N||!I?n:I(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":N&&I?I(""[Symbol.iterator]()):n,"%Symbol%":N?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":O,"%TypedArray%":$,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?n:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?n:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?n:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?n:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?n:WeakMap,"%WeakRef%":typeof WeakRef>"u"?n:WeakRef,"%WeakSet%":typeof WeakSet>"u"?n:WeakSet,"%Function.prototype.call%":Q,"%Function.prototype.apply%":G,"%Object.defineProperty%":E,"%Object.getPrototypeOf%":D,"%Math.abs%":c,"%Math.floor%":u,"%Math.max%":f,"%Math.min%":d,"%Math.pow%":g,"%Math.round%":p,"%Math.sign%":_,"%Reflect.getPrototypeOf%":V};if(I)try{null.error}catch(Ce){var J=I(I(Ce));U["%Error.prototype%"]=J}var W=function Ce(Xe){var $e;if(Xe==="%AsyncFunction%")$e=v("async function () {}");else if(Xe==="%GeneratorFunction%")$e=v("function* () {}");else if(Xe==="%AsyncGeneratorFunction%")$e=v("async function* () {}");else if(Xe==="%AsyncGenerator%"){var at=Ce("%AsyncGeneratorFunction%");at&&($e=at.prototype)}else if(Xe==="%AsyncIteratorPrototype%"){var pt=Ce("%AsyncGenerator%");pt&&I&&($e=I(pt.prototype))}return U[Xe]=$e,$e},q={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Y=RU(),ae=IJe(),Z=Y.call(Q,Array.prototype.concat),K=Y.call(G,Array.prototype.splice),ne=Y.call(Q,String.prototype.replace),le=Y.call(Q,String.prototype.slice),ce=Y.call(Q,RegExp.prototype.exec),de=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Me=/\\(\\)?/g,qe=function(Xe){var $e=le(Xe,0,1),at=le(Xe,-1);if($e==="%"&&at!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(at==="%"&&$e!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var pt=[];return ne(Xe,de,function(oe,Ue,Ge,ze){pt[pt.length]=Ge?ne(ze,Me,"$1"):Ue||oe}),pt},Pe=function(Xe,$e){var at=Xe,pt;if(ae(q,at)&&(pt=q[at],at="%"+pt[0]+"%"),ae(U,at)){var oe=U[at];if(oe===B&&(oe=W(at)),typeof oe>"u"&&!$e)throw new o("intrinsic "+Xe+" exists, but is not available. Please file an issue!");return{alias:pt,name:at,value:oe}}throw new a("intrinsic "+Xe+" does not exist!")};return T8=function(Xe,$e){if(typeof Xe!="string"||Xe.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof $e!="boolean")throw new o('"allowMissing" argument must be a boolean');if(ce(/^%?[^%]*%?$/,Xe)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var at=qe(Xe),pt=at.length>0?at[0]:"",oe=Pe("%"+pt+"%",$e),Ue=oe.name,Ge=oe.value,ze=!1,Be=oe.alias;Be&&(pt=Be[0],K(at,Z([0,1],Be)));for(var me=1,Se=!0;me<at.length;me+=1){var Ie=at[me],be=le(Ie,0,1),Ke=le(Ie,-1);if((be==='"'||be==="'"||be==="`"||Ke==='"'||Ke==="'"||Ke==="`")&&be!==Ke)throw new a("property names with quotes must have matching quotes");if((Ie==="constructor"||!Se)&&(ze=!0),pt+="."+Ie,Ue="%"+pt+"%",ae(U,Ue))Ge=U[Ue];else if(Ge!=null){if(!(Ie in Ge)){if(!$e)throw new o("base intrinsic for "+Xe+" exists, but the property is not available.");return}if(x&&me+1>=at.length){var ot=x(Ge,Ie);Se=!!ot,Se&&"get"in ot&&!("originalValue"in ot.get)?Ge=ot.get:Ge=Ge[Ie]}else Se=ae(Ge,Ie),Ge=Ge[Ie];Se&&!ze&&(U[Ue]=Ge)}}return Ge},T8}var w8,Ote;function ige(){if(Ote)return w8;Ote=1;var n=_q(),e=rge(),t=e([n("%String.prototype.indexOf%")]);return w8=function(i,s){var a=n(i,!!s);return typeof a=="function"&&t(i,".prototype.")>-1?e([a]):a},w8}var R8,Ite;function sge(){if(Ite)return R8;Ite=1;var n=_q(),e=ige(),t=wU(),r=Kw(),i=n("%Map%",!0),s=e("Map.prototype.get",!0),a=e("Map.prototype.set",!0),o=e("Map.prototype.has",!0),l=e("Map.prototype.delete",!0),c=e("Map.prototype.size",!0);return R8=!!i&&function(){var f,d={assert:function(g){if(!d.has(g))throw new r("Side channel does not contain "+t(g))},delete:function(g){if(f){var p=l(f,g);return c(f)===0&&(f=void 0),p}return!1},get:function(g){if(f)return s(f,g)},has:function(g){return f?o(f,g):!1},set:function(g,p){f||(f=new i),a(f,g,p)}};return d},R8}var A8,Nte;function NJe(){if(Nte)return A8;Nte=1;var n=_q(),e=ige(),t=wU(),r=sge(),i=Kw(),s=n("%WeakMap%",!0),a=e("WeakMap.prototype.get",!0),o=e("WeakMap.prototype.set",!0),l=e("WeakMap.prototype.has",!0),c=e("WeakMap.prototype.delete",!0);return A8=s?function(){var f,d,g={assert:function(p){if(!g.has(p))throw new i("Side channel does not contain "+t(p))},delete:function(p){if(s&&p&&(typeof p=="object"||typeof p=="function")){if(f)return c(f,p)}else if(r&&d)return d.delete(p);return!1},get:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?a(f,p):d&&d.get(p)},has:function(p){return s&&p&&(typeof p=="object"||typeof p=="function")&&f?l(f,p):!!d&&d.has(p)},set:function(p,_){s&&p&&(typeof p=="object"||typeof p=="function")?(f||(f=new s),o(f,p,_)):r&&(d||(d=r()),d.set(p,_))}};return g}:r,A8}var C8,Pte;function PJe(){if(Pte)return C8;Pte=1;var n=Kw(),e=wU(),t=lJe(),r=sge(),i=NJe(),s=i||r||t;return C8=function(){var o,l={assert:function(c){if(!l.has(c))throw new n("Side channel does not contain "+e(c))},delete:function(c){return!!o&&o.delete(c)},get:function(c){return o&&o.get(c)},has:function(c){return!!o&&o.has(c)},set:function(c,u){o||(o=s()),o.set(c,u)}};return l},C8}var M8,Dte;function vq(){if(Dte)return M8;Dte=1;var n=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return M8={default:t.RFC3986,formatters:{RFC1738:function(r){return n.call(r,e,"+")},RFC3986:function(r){return String(r)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},M8}var k8,Lte;function age(){if(Lte)return k8;Lte=1;var n=vq(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r=(function(){for(var y=[],v=0;v<256;++v)y.push("%"+((v<16?"0":"")+v.toString(16)).toUpperCase());return y})(),i=function(v){for(;v.length>1;){var x=v.pop(),E=x.obj[x.prop];if(t(E)){for(var M=[],O=0;O<E.length;++O)typeof E[O]<"u"&&M.push(E[O]);x.obj[x.prop]=M}}},s=function(v,x){for(var E=x&&x.plainObjects?{__proto__:null}:{},M=0;M<v.length;++M)typeof v[M]<"u"&&(E[M]=v[M]);return E},a=function y(v,x,E){if(!x)return v;if(typeof x!="object"&&typeof x!="function"){if(t(v))v.push(x);else if(v&&typeof v=="object")(E&&(E.plainObjects||E.allowPrototypes)||!e.call(Object.prototype,x))&&(v[x]=!0);else return[v,x];return v}if(!v||typeof v!="object")return[v].concat(x);var M=v;return t(v)&&!t(x)&&(M=s(v,E)),t(v)&&t(x)?(x.forEach(function(O,N){if(e.call(v,N)){var I=v[N];I&&typeof I=="object"&&O&&typeof O=="object"?v[N]=y(I,O,E):v.push(O)}else v[N]=O}),v):Object.keys(x).reduce(function(O,N){var I=x[N];return e.call(O,N)?O[N]=y(O[N],I,E):O[N]=I,O},M)},o=function(v,x){return Object.keys(x).reduce(function(E,M){return E[M]=x[M],E},v)},l=function(y,v,x){var E=y.replace(/\+/g," ");if(x==="iso-8859-1")return E.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(E)}catch{return E}},c=1024,u=function(v,x,E,M,O){if(v.length===0)return v;var N=v;if(typeof v=="symbol"?N=Symbol.prototype.toString.call(v):typeof v!="string"&&(N=String(v)),E==="iso-8859-1")return escape(N).replace(/%u[0-9a-f]{4}/gi,function($){return"%26%23"+parseInt($.slice(2),16)+"%3B"});for(var I="",D=0;D<N.length;D+=c){for(var V=N.length>=c?N.slice(D,D+c):N,G=[],Q=0;Q<V.length;++Q){var B=V.charCodeAt(Q);if(B===45||B===46||B===95||B===126||B>=48&&B<=57||B>=65&&B<=90||B>=97&&B<=122||O===n.RFC1738&&(B===40||B===41)){G[G.length]=V.charAt(Q);continue}if(B<128){G[G.length]=r[B];continue}if(B<2048){G[G.length]=r[192|B>>6]+r[128|B&63];continue}if(B<55296||B>=57344){G[G.length]=r[224|B>>12]+r[128|B>>6&63]+r[128|B&63];continue}Q+=1,B=65536+((B&1023)<<10|V.charCodeAt(Q)&1023),G[G.length]=r[240|B>>18]+r[128|B>>12&63]+r[128|B>>6&63]+r[128|B&63]}I+=G.join("")}return I},f=function(v){for(var x=[{obj:{o:v},prop:"o"}],E=[],M=0;M<x.length;++M)for(var O=x[M],N=O.obj[O.prop],I=Object.keys(N),D=0;D<I.length;++D){var V=I[D],G=N[V];typeof G=="object"&&G!==null&&E.indexOf(G)===-1&&(x.push({obj:N,prop:V}),E.push(G))}return i(x),v},d=function(v){return Object.prototype.toString.call(v)==="[object RegExp]"},g=function(v){return!v||typeof v!="object"?!1:!!(v.constructor&&v.constructor.isBuffer&&v.constructor.isBuffer(v))},p=function(v,x){return[].concat(v,x)},_=function(v,x){if(t(v)){for(var E=[],M=0;M<v.length;M+=1)E.push(x(v[M]));return E}return x(v)};return k8={arrayToObject:s,assign:o,combine:p,compact:f,decode:l,encode:u,isBuffer:g,isRegExp:d,maybeMap:_,merge:a},k8}var O8,Ute;function DJe(){if(Ute)return O8;Ute=1;var n=PJe(),e=age(),t=vq(),r=Object.prototype.hasOwnProperty,i={brackets:function(y){return y+"[]"},comma:"comma",indices:function(y,v){return y+"["+v+"]"},repeat:function(y){return y}},s=Array.isArray,a=Array.prototype.push,o=function(_,y){a.apply(_,s(y)?y:[y])},l=Date.prototype.toISOString,c=t.default,u={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:c,formatter:t.formatters[c],indices:!1,serializeDate:function(y){return l.call(y)},skipNulls:!1,strictNullHandling:!1},f=function(y){return typeof y=="string"||typeof y=="number"||typeof y=="boolean"||typeof y=="symbol"||typeof y=="bigint"},d={},g=function _(y,v,x,E,M,O,N,I,D,V,G,Q,B,$,U,J,W,q){for(var Y=y,ae=q,Z=0,K=!1;(ae=ae.get(d))!==void 0&&!K;){var ne=ae.get(y);if(Z+=1,typeof ne<"u"){if(ne===Z)throw new RangeError("Cyclic object value");K=!0}typeof ae.get(d)>"u"&&(Z=0)}if(typeof V=="function"?Y=V(v,Y):Y instanceof Date?Y=B(Y):x==="comma"&&s(Y)&&(Y=e.maybeMap(Y,function(Ue){return Ue instanceof Date?B(Ue):Ue})),Y===null){if(O)return D&&!J?D(v,u.encoder,W,"key",$):v;Y=""}if(f(Y)||e.isBuffer(Y)){if(D){var le=J?v:D(v,u.encoder,W,"key",$);return[U(le)+"="+U(D(Y,u.encoder,W,"value",$))]}return[U(v)+"="+U(String(Y))]}var ce=[];if(typeof Y>"u")return ce;var de;if(x==="comma"&&s(Y))J&&D&&(Y=e.maybeMap(Y,D)),de=[{value:Y.length>0?Y.join(",")||null:void 0}];else if(s(V))de=V;else{var Me=Object.keys(Y);de=G?Me.sort(G):Me}var qe=I?String(v).replace(/\./g,"%2E"):String(v),Pe=E&&s(Y)&&Y.length===1?qe+"[]":qe;if(M&&s(Y)&&Y.length===0)return Pe+"[]";for(var Ce=0;Ce<de.length;++Ce){var Xe=de[Ce],$e=typeof Xe=="object"&&Xe&&typeof Xe.value<"u"?Xe.value:Y[Xe];if(!(N&&$e===null)){var at=Q&&I?String(Xe).replace(/\./g,"%2E"):String(Xe),pt=s(Y)?typeof x=="function"?x(Pe,at):Pe:Pe+(Q?"."+at:"["+at+"]");q.set(y,Z);var oe=n();oe.set(d,q),o(ce,_($e,pt,x,E,M,O,N,I,x==="comma"&&J&&s(Y)?null:D,V,G,Q,B,$,U,J,W,oe))}}return ce},p=function(y){if(!y)return u;if(typeof y.allowEmptyArrays<"u"&&typeof y.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof y.encodeDotInKeys<"u"&&typeof y.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(y.encoder!==null&&typeof y.encoder<"u"&&typeof y.encoder!="function")throw new TypeError("Encoder has to be a function.");var v=y.charset||u.charset;if(typeof y.charset<"u"&&y.charset!=="utf-8"&&y.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var x=t.default;if(typeof y.format<"u"){if(!r.call(t.formatters,y.format))throw new TypeError("Unknown format option provided.");x=y.format}var E=t.formatters[x],M=u.filter;(typeof y.filter=="function"||s(y.filter))&&(M=y.filter);var O;if(y.arrayFormat in i?O=y.arrayFormat:"indices"in y?O=y.indices?"indices":"repeat":O=u.arrayFormat,"commaRoundTrip"in y&&typeof y.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var N=typeof y.allowDots>"u"?y.encodeDotInKeys===!0?!0:u.allowDots:!!y.allowDots;return{addQueryPrefix:typeof y.addQueryPrefix=="boolean"?y.addQueryPrefix:u.addQueryPrefix,allowDots:N,allowEmptyArrays:typeof y.allowEmptyArrays=="boolean"?!!y.allowEmptyArrays:u.allowEmptyArrays,arrayFormat:O,charset:v,charsetSentinel:typeof y.charsetSentinel=="boolean"?y.charsetSentinel:u.charsetSentinel,commaRoundTrip:!!y.commaRoundTrip,delimiter:typeof y.delimiter>"u"?u.delimiter:y.delimiter,encode:typeof y.encode=="boolean"?y.encode:u.encode,encodeDotInKeys:typeof y.encodeDotInKeys=="boolean"?y.encodeDotInKeys:u.encodeDotInKeys,encoder:typeof y.encoder=="function"?y.encoder:u.encoder,encodeValuesOnly:typeof y.encodeValuesOnly=="boolean"?y.encodeValuesOnly:u.encodeValuesOnly,filter:M,format:x,formatter:E,serializeDate:typeof y.serializeDate=="function"?y.serializeDate:u.serializeDate,skipNulls:typeof y.skipNulls=="boolean"?y.skipNulls:u.skipNulls,sort:typeof y.sort=="function"?y.sort:null,strictNullHandling:typeof y.strictNullHandling=="boolean"?y.strictNullHandling:u.strictNullHandling}};return O8=function(_,y){var v=_,x=p(y),E,M;typeof x.filter=="function"?(M=x.filter,v=M("",v)):s(x.filter)&&(M=x.filter,E=M);var O=[];if(typeof v!="object"||v===null)return"";var N=i[x.arrayFormat],I=N==="comma"&&x.commaRoundTrip;E||(E=Object.keys(v)),x.sort&&E.sort(x.sort);for(var D=n(),V=0;V<E.length;++V){var G=E[V],Q=v[G];x.skipNulls&&Q===null||o(O,g(Q,G,N,I,x.allowEmptyArrays,x.strictNullHandling,x.skipNulls,x.encodeDotInKeys,x.encode?x.encoder:null,x.filter,x.sort,x.allowDots,x.serializeDate,x.format,x.formatter,x.encodeValuesOnly,x.charset,D))}var B=O.join(x.delimiter),$=x.addQueryPrefix===!0?"?":"";return x.charsetSentinel&&(x.charset==="iso-8859-1"?$+="utf8=%26%2310003%3B&":$+="utf8=%E2%9C%93&"),B.length>0?$+B:""},O8}var I8,Bte;function LJe(){if(Bte)return I8;Bte=1;var n=age(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},i=function(d){return d.replace(/&#(\d+);/g,function(g,p){return String.fromCharCode(parseInt(p,10))})},s=function(d,g,p){if(d&&typeof d=="string"&&g.comma&&d.indexOf(",")>-1)return d.split(",");if(g.throwOnLimitExceeded&&p>=g.arrayLimit)throw new RangeError("Array limit exceeded. Only "+g.arrayLimit+" element"+(g.arrayLimit===1?"":"s")+" allowed in an array.");return d},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",l=function(g,p){var _={__proto__:null},y=p.ignoreQueryPrefix?g.replace(/^\?/,""):g;y=y.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var v=p.parameterLimit===1/0?void 0:p.parameterLimit,x=y.split(p.delimiter,p.throwOnLimitExceeded?v+1:v);if(p.throwOnLimitExceeded&&x.length>v)throw new RangeError("Parameter limit exceeded. Only "+v+" parameter"+(v===1?"":"s")+" allowed.");var E=-1,M,O=p.charset;if(p.charsetSentinel)for(M=0;M<x.length;++M)x[M].indexOf("utf8=")===0&&(x[M]===o?O="utf-8":x[M]===a&&(O="iso-8859-1"),E=M,M=x.length);for(M=0;M<x.length;++M)if(M!==E){var N=x[M],I=N.indexOf("]="),D=I===-1?N.indexOf("="):I+1,V,G;D===-1?(V=p.decoder(N,r.decoder,O,"key"),G=p.strictNullHandling?null:""):(V=p.decoder(N.slice(0,D),r.decoder,O,"key"),G=n.maybeMap(s(N.slice(D+1),p,t(_[V])?_[V].length:0),function(B){return p.decoder(B,r.decoder,O,"value")})),G&&p.interpretNumericEntities&&O==="iso-8859-1"&&(G=i(String(G))),N.indexOf("[]=")>-1&&(G=t(G)?[G]:G);var Q=e.call(_,V);Q&&p.duplicates==="combine"?_[V]=n.combine(_[V],G):(!Q||p.duplicates==="last")&&(_[V]=G)}return _},c=function(d,g,p,_){var y=0;if(d.length>0&&d[d.length-1]==="[]"){var v=d.slice(0,-1).join("");y=Array.isArray(g)&&g[v]?g[v].length:0}for(var x=_?g:s(g,p,y),E=d.length-1;E>=0;--E){var M,O=d[E];if(O==="[]"&&p.parseArrays)M=p.allowEmptyArrays&&(x===""||p.strictNullHandling&&x===null)?[]:n.combine([],x);else{M=p.plainObjects?{__proto__:null}:{};var N=O.charAt(0)==="["&&O.charAt(O.length-1)==="]"?O.slice(1,-1):O,I=p.decodeDotInKeys?N.replace(/%2E/g,"."):N,D=parseInt(I,10);!p.parseArrays&&I===""?M={0:x}:!isNaN(D)&&O!==I&&String(D)===I&&D>=0&&p.parseArrays&&D<=p.arrayLimit?(M=[],M[D]=x):I!=="__proto__"&&(M[I]=x)}x=M}return x},u=function(g,p,_,y){if(g){var v=_.allowDots?g.replace(/\.([^.[]+)/g,"[$1]"):g,x=/(\[[^[\]]*])/,E=/(\[[^[\]]*])/g,M=_.depth>0&&x.exec(v),O=M?v.slice(0,M.index):v,N=[];if(O){if(!_.plainObjects&&e.call(Object.prototype,O)&&!_.allowPrototypes)return;N.push(O)}for(var I=0;_.depth>0&&(M=E.exec(v))!==null&&I<_.depth;){if(I+=1,!_.plainObjects&&e.call(Object.prototype,M[1].slice(1,-1))&&!_.allowPrototypes)return;N.push(M[1])}if(M){if(_.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+_.depth+" and strictDepth is true");N.push("["+v.slice(M.index)+"]")}return c(N,p,_,y)}},f=function(g){if(!g)return r;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.decodeDotInKeys<"u"&&typeof g.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(g.decoder!==null&&typeof g.decoder<"u"&&typeof g.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof g.throwOnLimitExceeded<"u"&&typeof g.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var p=typeof g.charset>"u"?r.charset:g.charset,_=typeof g.duplicates>"u"?r.duplicates:g.duplicates;if(_!=="combine"&&_!=="first"&&_!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var y=typeof g.allowDots>"u"?g.decodeDotInKeys===!0?!0:r.allowDots:!!g.allowDots;return{allowDots:y,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:r.allowEmptyArrays,allowPrototypes:typeof g.allowPrototypes=="boolean"?g.allowPrototypes:r.allowPrototypes,allowSparse:typeof g.allowSparse=="boolean"?g.allowSparse:r.allowSparse,arrayLimit:typeof g.arrayLimit=="number"?g.arrayLimit:r.arrayLimit,charset:p,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:r.charsetSentinel,comma:typeof g.comma=="boolean"?g.comma:r.comma,decodeDotInKeys:typeof g.decodeDotInKeys=="boolean"?g.decodeDotInKeys:r.decodeDotInKeys,decoder:typeof g.decoder=="function"?g.decoder:r.decoder,delimiter:typeof g.delimiter=="string"||n.isRegExp(g.delimiter)?g.delimiter:r.delimiter,depth:typeof g.depth=="number"||g.depth===!1?+g.depth:r.depth,duplicates:_,ignoreQueryPrefix:g.ignoreQueryPrefix===!0,interpretNumericEntities:typeof g.interpretNumericEntities=="boolean"?g.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof g.parameterLimit=="number"?g.parameterLimit:r.parameterLimit,parseArrays:g.parseArrays!==!1,plainObjects:typeof g.plainObjects=="boolean"?g.plainObjects:r.plainObjects,strictDepth:typeof g.strictDepth=="boolean"?!!g.strictDepth:r.strictDepth,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:r.strictNullHandling,throwOnLimitExceeded:typeof g.throwOnLimitExceeded=="boolean"?g.throwOnLimitExceeded:!1}};return I8=function(d,g){var p=f(g);if(d===""||d===null||typeof d>"u")return p.plainObjects?{__proto__:null}:{};for(var _=typeof d=="string"?l(d,p):d,y=p.plainObjects?{__proto__:null}:{},v=Object.keys(_),x=0;x<v.length;++x){var E=v[x],M=u(E,_[E],p,typeof d=="string");y=n.merge(y,M,p)}return p.allowSparse===!0?y:n.compact(y)},I8}var N8,Fte;function UJe(){if(Fte)return N8;Fte=1;var n=DJe(),e=LJe(),t=vq();return N8={formats:t,parse:e,stringify:n},N8}var zte;function BJe(){if(zte)return SS;zte=1;var n=iJe();function e(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var t=/^([a-z0-9.+-]+:)/i,r=/:[0-9]*$/,i=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,s=["<",">",'"',"`"," ","\r",`
`,"	"],a=["{","}","|","\\","^","`"].concat(s),o=["'"].concat(a),l=["%","/","?",";","#"].concat(o),c=["/","?","#"],u=255,f=/^[+a-z0-9A-Z_-]{0,63}$/,d=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=UJe();function v(O,N,I){if(O&&typeof O=="object"&&O instanceof e)return O;var D=new e;return D.parse(O,N,I),D}e.prototype.parse=function(O,N,I){if(typeof O!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof O);var D=O.indexOf("?"),V=D!==-1&&D<O.indexOf("#")?"?":"#",G=O.split(V),Q=/\\/g;G[0]=G[0].replace(Q,"/"),O=G.join(V);var B=O;if(B=B.trim(),!I&&O.split("#").length===1){var $=i.exec(B);if($)return this.path=B,this.href=B,this.pathname=$[1],$[2]?(this.search=$[2],N?this.query=y.parse(this.search.substr(1)):this.query=this.search.substr(1)):N&&(this.search="",this.query={}),this}var U=t.exec(B);if(U){U=U[0];var J=U.toLowerCase();this.protocol=J,B=B.substr(U.length)}if(I||U||B.match(/^\/\/[^@/]+@[^@/]+/)){var W=B.substr(0,2)==="//";W&&!(U&&p[U])&&(B=B.substr(2),this.slashes=!0)}if(!p[U]&&(W||U&&!_[U])){for(var q=-1,Y=0;Y<c.length;Y++){var ae=B.indexOf(c[Y]);ae!==-1&&(q===-1||ae<q)&&(q=ae)}var Z,K;q===-1?K=B.lastIndexOf("@"):K=B.lastIndexOf("@",q),K!==-1&&(Z=B.slice(0,K),B=B.slice(K+1),this.auth=decodeURIComponent(Z)),q=-1;for(var Y=0;Y<l.length;Y++){var ae=B.indexOf(l[Y]);ae!==-1&&(q===-1||ae<q)&&(q=ae)}q===-1&&(q=B.length),this.host=B.slice(0,q),B=B.slice(q),this.parseHost(),this.hostname=this.hostname||"";var ne=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!ne)for(var le=this.hostname.split(/\./),Y=0,ce=le.length;Y<ce;Y++){var de=le[Y];if(de&&!de.match(f)){for(var Me="",qe=0,Pe=de.length;qe<Pe;qe++)de.charCodeAt(qe)>127?Me+="x":Me+=de[qe];if(!Me.match(f)){var Ce=le.slice(0,Y),Xe=le.slice(Y+1),$e=de.match(d);$e&&(Ce.push($e[1]),Xe.unshift($e[2])),Xe.length&&(B="/"+Xe.join(".")+B),this.hostname=Ce.join(".");break}}}this.hostname.length>u?this.hostname="":this.hostname=this.hostname.toLowerCase(),ne||(this.hostname=n.toASCII(this.hostname));var at=this.port?":"+this.port:"",pt=this.hostname||"";this.host=pt+at,this.href+=this.host,ne&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),B[0]!=="/"&&(B="/"+B))}if(!g[J])for(var Y=0,ce=o.length;Y<ce;Y++){var oe=o[Y];if(B.indexOf(oe)!==-1){var Ue=encodeURIComponent(oe);Ue===oe&&(Ue=escape(oe)),B=B.split(oe).join(Ue)}}var Ge=B.indexOf("#");Ge!==-1&&(this.hash=B.substr(Ge),B=B.slice(0,Ge));var ze=B.indexOf("?");if(ze!==-1?(this.search=B.substr(ze),this.query=B.substr(ze+1),N&&(this.query=y.parse(this.query)),B=B.slice(0,ze)):N&&(this.search="",this.query={}),B&&(this.pathname=B),_[J]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var at=this.pathname||"",Be=this.search||"";this.path=at+Be}return this.href=this.format(),this};function x(O){return typeof O=="string"&&(O=v(O)),O instanceof e?O.format():e.prototype.format.call(O)}e.prototype.format=function(){var O=this.auth||"";O&&(O=encodeURIComponent(O),O=O.replace(/%3A/i,":"),O+="@");var N=this.protocol||"",I=this.pathname||"",D=this.hash||"",V=!1,G="";this.host?V=O+this.host:this.hostname&&(V=O+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(V+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(G=y.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var Q=this.search||G&&"?"+G||"";return N&&N.substr(-1)!==":"&&(N+=":"),this.slashes||(!N||_[N])&&V!==!1?(V="//"+(V||""),I&&I.charAt(0)!=="/"&&(I="/"+I)):V||(V=""),D&&D.charAt(0)!=="#"&&(D="#"+D),Q&&Q.charAt(0)!=="?"&&(Q="?"+Q),I=I.replace(/[?#]/g,function(B){return encodeURIComponent(B)}),Q=Q.replace("#","%23"),N+V+I+Q+D};function E(O,N){return v(O,!1,!0).resolve(N)}e.prototype.resolve=function(O){return this.resolveObject(v(O,!1,!0)).format()};function M(O,N){return O?v(O,!1,!0).resolveObject(N):N}return e.prototype.resolveObject=function(O){if(typeof O=="string"){var N=new e;N.parse(O,!1,!0),O=N}for(var I=new e,D=Object.keys(this),V=0;V<D.length;V++){var G=D[V];I[G]=this[G]}if(I.hash=O.hash,O.href==="")return I.href=I.format(),I;if(O.slashes&&!O.protocol){for(var Q=Object.keys(O),B=0;B<Q.length;B++){var $=Q[B];$!=="protocol"&&(I[$]=O[$])}return _[I.protocol]&&I.hostname&&!I.pathname&&(I.pathname="/",I.path=I.pathname),I.href=I.format(),I}if(O.protocol&&O.protocol!==I.protocol){if(!_[O.protocol]){for(var U=Object.keys(O),J=0;J<U.length;J++){var W=U[J];I[W]=O[W]}return I.href=I.format(),I}if(I.protocol=O.protocol,!O.host&&!p[O.protocol]){for(var ce=(O.pathname||"").split("/");ce.length&&!(O.host=ce.shift()););O.host||(O.host=""),O.hostname||(O.hostname=""),ce[0]!==""&&ce.unshift(""),ce.length<2&&ce.unshift(""),I.pathname=ce.join("/")}else I.pathname=O.pathname;if(I.search=O.search,I.query=O.query,I.host=O.host||"",I.auth=O.auth,I.hostname=O.hostname||O.host,I.port=O.port,I.pathname||I.search){var q=I.pathname||"",Y=I.search||"";I.path=q+Y}return I.slashes=I.slashes||O.slashes,I.href=I.format(),I}var ae=I.pathname&&I.pathname.charAt(0)==="/",Z=O.host||O.pathname&&O.pathname.charAt(0)==="/",K=Z||ae||I.host&&O.pathname,ne=K,le=I.pathname&&I.pathname.split("/")||[],ce=O.pathname&&O.pathname.split("/")||[],de=I.protocol&&!_[I.protocol];if(de&&(I.hostname="",I.port=null,I.host&&(le[0]===""?le[0]=I.host:le.unshift(I.host)),I.host="",O.protocol&&(O.hostname=null,O.port=null,O.host&&(ce[0]===""?ce[0]=O.host:ce.unshift(O.host)),O.host=null),K=K&&(ce[0]===""||le[0]==="")),Z)I.host=O.host||O.host===""?O.host:I.host,I.hostname=O.hostname||O.hostname===""?O.hostname:I.hostname,I.search=O.search,I.query=O.query,le=ce;else if(ce.length)le||(le=[]),le.pop(),le=le.concat(ce),I.search=O.search,I.query=O.query;else if(O.search!=null){if(de){I.host=le.shift(),I.hostname=I.host;var Me=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Me&&(I.auth=Me.shift(),I.hostname=Me.shift(),I.host=I.hostname)}return I.search=O.search,I.query=O.query,(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.href=I.format(),I}if(!le.length)return I.pathname=null,I.search?I.path="/"+I.search:I.path=null,I.href=I.format(),I;for(var qe=le.slice(-1)[0],Pe=(I.host||O.host||le.length>1)&&(qe==="."||qe==="..")||qe==="",Ce=0,Xe=le.length;Xe>=0;Xe--)qe=le[Xe],qe==="."?le.splice(Xe,1):qe===".."?(le.splice(Xe,1),Ce++):Ce&&(le.splice(Xe,1),Ce--);if(!K&&!ne)for(;Ce--;Ce)le.unshift("..");K&&le[0]!==""&&(!le[0]||le[0].charAt(0)!=="/")&&le.unshift(""),Pe&&le.join("/").substr(-1)!=="/"&&le.push("");var $e=le[0]===""||le[0]&&le[0].charAt(0)==="/";if(de){I.hostname=$e?"":le.length?le.shift():"",I.host=I.hostname;var Me=I.host&&I.host.indexOf("@")>0?I.host.split("@"):!1;Me&&(I.auth=Me.shift(),I.hostname=Me.shift(),I.host=I.hostname)}return K=K||I.host&&le.length,K&&!$e&&le.unshift(""),le.length>0?I.pathname=le.join("/"):(I.pathname=null,I.path=null),(I.pathname!==null||I.search!==null)&&(I.path=(I.pathname?I.pathname:"")+(I.search?I.search:"")),I.auth=O.auth||I.auth,I.slashes=I.slashes||O.slashes,I.href=I.format(),I},e.prototype.parseHost=function(){var O=this.host,N=r.exec(O);N&&(N=N[0],N!==":"&&(this.port=N.substr(1)),O=O.substr(0,O.length-N.length)),O&&(this.hostname=O)},SS.parse=v,SS.resolve=E,SS.resolveObject=M,SS.format=x,SS.Url=e,SS}var P8,jte;function FJe(){return jte||(jte=1,P8=typeof URL=="function"?URL:BJe().URL),P8}var Hte;function AU(){if(Hte)return l_;Hte=1;const n=FJe();function e(G,Q,B){if(Q in G)return G[Q];if(arguments.length===3)return B;throw new Error('"'+Q+'" is a required argument.')}l_.getArg=e;const t=(function(){return!("__proto__"in Object.create(null))})();function r(G){return G}function i(G){return a(G)?"$"+G:G}l_.toSetString=t?r:i;function s(G){return a(G)?G.slice(1):G}l_.fromSetString=t?r:s;function a(G){if(!G)return!1;const Q=G.length;if(Q<9||G.charCodeAt(Q-1)!==95||G.charCodeAt(Q-2)!==95||G.charCodeAt(Q-3)!==111||G.charCodeAt(Q-4)!==116||G.charCodeAt(Q-5)!==111||G.charCodeAt(Q-6)!==114||G.charCodeAt(Q-7)!==112||G.charCodeAt(Q-8)!==95||G.charCodeAt(Q-9)!==95)return!1;for(let B=Q-10;B>=0;B--)if(G.charCodeAt(B)!==36)return!1;return!0}function o(G,Q){return G===Q?0:G===null?1:Q===null?-1:G>Q?1:-1}function l(G,Q){let B=G.generatedLine-Q.generatedLine;return B!==0||(B=G.generatedColumn-Q.generatedColumn,B!==0)||(B=o(G.source,Q.source),B!==0)||(B=G.originalLine-Q.originalLine,B!==0)||(B=G.originalColumn-Q.originalColumn,B!==0)?B:o(G.name,Q.name)}l_.compareByGeneratedPositionsInflated=l;function c(G){return JSON.parse(G.replace(/^\)]}'[^\n]*\n/,""))}l_.parseSourceMapInput=c;const u="http:",f=`${u}//host`;function d(G){return Q=>{const B=v(Q),$=_(Q),U=new n(Q,$);G(U);const J=U.toString();return B==="absolute"?J:B==="scheme-relative"?J.slice(u.length):B==="path-absolute"?J.slice(f.length):x($,J)}}function g(G,Q){return new n(G,Q).toString()}function p(G,Q){let B=0;do{const $=G+B++;if(Q.indexOf($)===-1)return $}while(!0)}function _(G){const Q=G.split("..").length-1,B=p("p",G);let $=`${f}/`;for(let U=0;U<Q;U++)$+=`${B}/`;return $}const y=/^[A-Za-z0-9\+\-\.]+:/;function v(G){return G[0]==="/"?G[1]==="/"?"scheme-relative":"path-absolute":y.test(G)?"absolute":"path-relative"}function x(G,Q){typeof G=="string"&&(G=new n(G)),typeof Q=="string"&&(Q=new n(Q));const B=Q.pathname.split("/"),$=G.pathname.split("/");for($.length>0&&!$[$.length-1]&&$.pop();B.length>0&&$.length>0&&B[0]===$[0];)B.shift(),$.shift();return $.map(()=>"..").concat(B).join("/")+Q.search+Q.hash}const E=d(G=>{G.pathname=G.pathname.replace(/\/?$/,"/")}),M=d(G=>{G.href=new n(".",G.toString()).toString()}),O=d(G=>{});l_.normalize=O;function N(G,Q){const B=v(Q),$=v(G);if(G=E(G),B==="absolute")return g(Q,void 0);if($==="absolute")return g(Q,G);if(B==="scheme-relative")return O(Q);if($==="scheme-relative")return g(Q,g(G,f)).slice(u.length);if(B==="path-absolute")return O(Q);if($==="path-absolute")return g(Q,g(G,f)).slice(f.length);const U=_(Q+G),J=g(Q,g(G,U));return x(U,J)}l_.join=N;function I(G,Q){const B=D(G,Q);return typeof B=="string"?B:O(Q)}l_.relative=I;function D(G,Q){if(v(G)!==v(Q))return null;const $=_(G+Q),U=new n(G,$),J=new n(Q,$);try{new n("",J.toString())}catch{return null}return J.protocol!==U.protocol||J.user!==U.user||J.password!==U.password||J.hostname!==U.hostname||J.port!==U.port?null:x(U,J)}function V(G,Q,B){G&&v(Q)==="path-absolute"&&(Q=Q.replace(/^\//,""));let $=O(Q||"");return G&&($=N(G,$)),B&&($=N(M(B),$)),$}return l_.computeSourceURL=V,l_}var D8={},qte;function oge(){if(qte)return D8;qte=1;class n{constructor(){this._array=[],this._set=new Map}static fromArray(t,r){const i=new n;for(let s=0,a=t.length;s<a;s++)i.add(t[s],r);return i}size(){return this._set.size}add(t,r){const i=this.has(t),s=this._array.length;(!i||r)&&this._array.push(t),i||this._set.set(t,s)}has(t){return this._set.has(t)}indexOf(t){const r=this._set.get(t);if(r>=0)return r;throw new Error('"'+t+'" is not in the set.')}at(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)}toArray(){return this._array.slice()}}return D8.ArraySet=n,D8}var L8={},Vte;function zJe(){if(Vte)return L8;Vte=1;const n=AU();function e(r,i){const s=r.generatedLine,a=i.generatedLine,o=r.generatedColumn,l=i.generatedColumn;return a>s||a==s&&l>=o||n.compareByGeneratedPositionsInflated(r,i)<=0}class t{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(i,s){this._array.forEach(i,s)}add(i){e(this._last,i)?(this._last=i,this._array.push(i)):(this._sorted=!1,this._array.push(i))}toArray(){return this._sorted||(this._array.sort(n.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}}return L8.MappingList=t,L8}var Gte;function lge(){if(Gte)return zB;Gte=1;const n=Zme(),e=AU(),t=oge().ArraySet,r=zJe().MappingList;class i{constructor(a){a||(a={}),this._file=e.getArg(a,"file",null),this._sourceRoot=e.getArg(a,"sourceRoot",null),this._skipValidation=e.getArg(a,"skipValidation",!1),this._sources=new t,this._names=new t,this._mappings=new r,this._sourcesContents=null}static fromSourceMap(a){const o=a.sourceRoot,l=new i({file:a.file,sourceRoot:o});return a.eachMapping(function(c){const u={generated:{line:c.generatedLine,column:c.generatedColumn}};c.source!=null&&(u.source=c.source,o!=null&&(u.source=e.relative(o,u.source)),u.original={line:c.originalLine,column:c.originalColumn},c.name!=null&&(u.name=c.name)),l.addMapping(u)}),a.sources.forEach(function(c){let u=c;o!=null&&(u=e.relative(o,c)),l._sources.has(u)||l._sources.add(u);const f=a.sourceContentFor(c);f!=null&&l.setSourceContent(c,f)}),l}addMapping(a){const o=e.getArg(a,"generated"),l=e.getArg(a,"original",null);let c=e.getArg(a,"source",null),u=e.getArg(a,"name",null);this._skipValidation||this._validateMapping(o,l,c,u),c!=null&&(c=String(c),this._sources.has(c)||this._sources.add(c)),u!=null&&(u=String(u),this._names.has(u)||this._names.add(u)),this._mappings.add({generatedLine:o.line,generatedColumn:o.column,originalLine:l&&l.line,originalColumn:l&&l.column,source:c,name:u})}setSourceContent(a,o){let l=a;this._sourceRoot!=null&&(l=e.relative(this._sourceRoot,l)),o!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[e.toSetString(l)]=o):this._sourcesContents&&(delete this._sourcesContents[e.toSetString(l)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))}applySourceMap(a,o,l){let c=o;if(o==null){if(a.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);c=a.file}const u=this._sourceRoot;u!=null&&(c=e.relative(u,c));const f=this._mappings.toArray().length>0?new t:this._sources,d=new t;this._mappings.unsortedForEach(function(g){if(g.source===c&&g.originalLine!=null){const y=a.originalPositionFor({line:g.originalLine,column:g.originalColumn});y.source!=null&&(g.source=y.source,l!=null&&(g.source=e.join(l,g.source)),u!=null&&(g.source=e.relative(u,g.source)),g.originalLine=y.line,g.originalColumn=y.column,y.name!=null&&(g.name=y.name))}const p=g.source;p!=null&&!f.has(p)&&f.add(p);const _=g.name;_!=null&&!d.has(_)&&d.add(_)},this),this._sources=f,this._names=d,a.sources.forEach(function(g){const p=a.sourceContentFor(g);p!=null&&(l!=null&&(g=e.join(l,g)),u!=null&&(g=e.relative(u,g)),this.setSourceContent(g,p))},this)}_validateMapping(a,o,l,c){if(o&&typeof o.line!="number"&&typeof o.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(a&&"line"in a&&"column"in a&&a.line>0&&a.column>=0&&!o&&!l&&!c)){if(!(a&&"line"in a&&"column"in a&&o&&"line"in o&&"column"in o&&a.line>0&&a.column>=0&&o.line>0&&o.column>=0&&l))throw new Error("Invalid mapping: "+JSON.stringify({generated:a,source:l,original:o,name:c}))}}_serializeMappings(){let a=0,o=1,l=0,c=0,u=0,f=0,d="",g,p,_,y;const v=this._mappings.toArray();for(let x=0,E=v.length;x<E;x++){if(p=v[x],g="",p.generatedLine!==o)for(a=0;p.generatedLine!==o;)g+=";",o++;else if(x>0){if(!e.compareByGeneratedPositionsInflated(p,v[x-1]))continue;g+=","}g+=n.encode(p.generatedColumn-a),a=p.generatedColumn,p.source!=null&&(y=this._sources.indexOf(p.source),g+=n.encode(y-f),f=y,g+=n.encode(p.originalLine-1-c),c=p.originalLine-1,g+=n.encode(p.originalColumn-l),l=p.originalColumn,p.name!=null&&(_=this._names.indexOf(p.name),g+=n.encode(_-u),u=_)),d+=g}return d}_generateSourcesContent(a,o){return a.map(function(l){if(!this._sourcesContents)return null;o!=null&&(l=e.relative(o,l));const c=e.toSetString(l);return Object.prototype.hasOwnProperty.call(this._sourcesContents,c)?this._sourcesContents[c]:null},this)}toJSON(){const a={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(a.file=this._file),this._sourceRoot!=null&&(a.sourceRoot=this._sourceRoot),this._sourcesContents&&(a.sourcesContent=this._generateSourcesContent(a.sources,a.sourceRoot)),a}toString(){return JSON.stringify(this.toJSON())}}return i.prototype._version=3,zB.SourceMapGenerator=i,zB}var PM={},U8={},$te;function jJe(){return $te||($te=1,(function(n){n.GREATEST_LOWER_BOUND=1,n.LEAST_UPPER_BOUND=2;function e(t,r,i,s,a,o){const l=Math.floor((r-t)/2)+t,c=a(i,s[l],!0);return c===0?l:c>0?r-l>1?e(l,r,i,s,a,o):o===n.LEAST_UPPER_BOUND?r<s.length?r:-1:l:l-t>1?e(t,l,i,s,a,o):o==n.LEAST_UPPER_BOUND?l:t<0?-1:t}n.search=function(r,i,s,a){if(i.length===0)return-1;let o=e(-1,i.length,r,i,s,a||n.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&s(i[o],i[o-1],!0)===0;)--o;return o}})(U8)),U8}var tN={exports:{}},Wte;function cge(){if(Wte)return tN.exports;Wte=1;let n=null;return tN.exports=function(){if(typeof n=="string")return fetch(n).then(t=>t.arrayBuffer());if(n instanceof ArrayBuffer)return Promise.resolve(n);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},tN.exports.initialize=e=>{n=e},tN.exports}var B8,Yte;function HJe(){if(Yte)return B8;Yte=1;const n=cge();function e(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let t=null;return B8=function(){if(t)return t;const i=[];return t=n().then(s=>WebAssembly.instantiate(s,{env:{mapping_callback(a,o,l,c,u,f,d,g,p,_){const y=new e;y.generatedLine=a+1,y.generatedColumn=o,l&&(y.lastGeneratedColumn=c-1),u&&(y.source=f,y.originalLine=d+1,y.originalColumn=g,p&&(y.name=_)),i[i.length-1](y)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}})).then(s=>({exports:s.instance.exports,withMappingCallback:(a,o)=>{i.push(a);try{o()}finally{i.pop()}}})).then(null,s=>{throw t=null,s}),t},B8}var Xte;function qJe(){if(Xte)return PM;Xte=1;const n=AU(),e=jJe(),t=oge().ArraySet;Zme();const r=cge(),i=HJe(),s=Symbol("smcInternal");class a{constructor(d,g){return d==s?Promise.resolve(this):c(d,g)}static initialize(d){r.initialize(d["lib/mappings.wasm"])}static fromSourceMap(d,g){return u(d,g)}static async with(d,g,p){const _=await new a(d,g);try{return await p(_)}finally{_.destroy()}}eachMapping(d,g,p){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(d){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}a.prototype._version=3,a.GENERATED_ORDER=1,a.ORIGINAL_ORDER=2,a.GREATEST_LOWER_BOUND=1,a.LEAST_UPPER_BOUND=2,PM.SourceMapConsumer=a;class o extends a{constructor(d,g){return super(s).then(p=>{let _=d;typeof d=="string"&&(_=n.parseSourceMapInput(d));const y=n.getArg(_,"version"),v=n.getArg(_,"sources").map(String),x=n.getArg(_,"names",[]),E=n.getArg(_,"sourceRoot",null),M=n.getArg(_,"sourcesContent",null),O=n.getArg(_,"mappings"),N=n.getArg(_,"file",null),I=n.getArg(_,"x_google_ignoreList",null);if(y!=p._version)throw new Error("Unsupported version: "+y);return p._sourceLookupCache=new Map,p._names=t.fromArray(x.map(String),!0),p._sources=t.fromArray(v,!0),p._absoluteSources=t.fromArray(p._sources.toArray().map(function(D){return n.computeSourceURL(E,D,g)}),!0),p.sourceRoot=E,p.sourcesContent=M,p._mappings=O,p._sourceMapURL=g,p.file=N,p.x_google_ignoreList=I,p._computedColumnSpans=!1,p._mappingsPtr=0,p._wasm=null,i().then(D=>(p._wasm=D,p))})}_findSourceIndex(d){const g=this._sourceLookupCache.get(d);if(typeof g=="number")return g;const p=n.computeSourceURL(null,d,this._sourceMapURL);if(this._absoluteSources.has(p)){const y=this._absoluteSources.indexOf(p);return this._sourceLookupCache.set(d,y),y}const _=n.computeSourceURL(this.sourceRoot,d,this._sourceMapURL);if(this._absoluteSources.has(_)){const y=this._absoluteSources.indexOf(_);return this._sourceLookupCache.set(d,y),y}return-1}static fromSourceMap(d,g){return new o(d.toString())}get sources(){return this._absoluteSources.toArray()}_getMappingsPtr(){return this._mappingsPtr===0&&this._parseMappings(),this._mappingsPtr}_parseMappings(){const d=this._mappings,g=d.length,p=this._wasm.exports.allocate_mappings(g)>>>0,_=new Uint8Array(this._wasm.exports.memory.buffer,p,g);for(let v=0;v<g;v++)_[v]=d.charCodeAt(v);const y=this._wasm.exports.parse_mappings(p);if(!y){const v=this._wasm.exports.get_last_error();let x=`Error parsing mappings (code ${v}): `;switch(v){case 1:x+="the mappings contained a negative line, column, source index, or name index";break;case 2:x+="the mappings contained a number larger than 2**32";break;case 3:x+="reached EOF while in the middle of parsing a VLQ";break;case 4:x+="invalid base 64 character while parsing a VLQ";break;default:x+="unknown error code";break}throw new Error(x)}this._mappingsPtr=y}eachMapping(d,g,p){const _=g||null,y=p||a.GENERATED_ORDER;this._wasm.withMappingCallback(v=>{v.source!==null&&(v.source=this._absoluteSources.at(v.source),v.name!==null&&(v.name=this._names.at(v.name))),this._computedColumnSpans&&v.lastGeneratedColumn===null&&(v.lastGeneratedColumn=1/0),d.call(_,v)},()=>{switch(y){case a.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case a.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}})}allGeneratedPositionsFor(d){let g=n.getArg(d,"source");const p=n.getArg(d,"line"),_=d.column||0;if(g=this._findSourceIndex(g),g<0)return[];if(p<1)throw new Error("Line numbers must be >= 1");if(_<0)throw new Error("Column numbers must be >= 0");const y=[];return this._wasm.withMappingCallback(v=>{let x=v.lastGeneratedColumn;this._computedColumnSpans&&x===null&&(x=1/0),y.push({line:v.generatedLine,column:v.generatedColumn,lastColumn:x})},()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),g,p-1,"column"in d,_)}),y}destroy(){this._mappingsPtr!==0&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(d){const g={generatedLine:n.getArg(d,"line"),generatedColumn:n.getArg(d,"column")};if(g.generatedLine<1)throw new Error("Line numbers must be >= 1");if(g.generatedColumn<0)throw new Error("Column numbers must be >= 0");let p=n.getArg(d,"bias",a.GREATEST_LOWER_BOUND);p==null&&(p=a.GREATEST_LOWER_BOUND);let _;if(this._wasm.withMappingCallback(y=>_=y,()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),g.generatedLine-1,g.generatedColumn,p)}),_&&_.generatedLine===g.generatedLine){let y=n.getArg(_,"source",null);y!==null&&(y=this._absoluteSources.at(y));let v=n.getArg(_,"name",null);return v!==null&&(v=this._names.at(v)),{source:y,line:n.getArg(_,"originalLine",null),column:n.getArg(_,"originalColumn",null),name:v}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(d){return d==null}):!1}sourceContentFor(d,g){if(!this.sourcesContent)return null;const p=this._findSourceIndex(d);if(p>=0)return this.sourcesContent[p];if(g)return null;throw new Error('"'+d+'" is not in the SourceMap.')}generatedPositionFor(d){let g=n.getArg(d,"source");if(g=this._findSourceIndex(g),g<0)return{line:null,column:null,lastColumn:null};const p={source:g,originalLine:n.getArg(d,"line"),originalColumn:n.getArg(d,"column")};if(p.originalLine<1)throw new Error("Line numbers must be >= 1");if(p.originalColumn<0)throw new Error("Column numbers must be >= 0");let _=n.getArg(d,"bias",a.GREATEST_LOWER_BOUND);_==null&&(_=a.GREATEST_LOWER_BOUND);let y;if(this._wasm.withMappingCallback(v=>y=v,()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),p.source,p.originalLine-1,p.originalColumn,_)}),y&&y.source===p.source){let v=y.lastGeneratedColumn;return this._computedColumnSpans&&v===null&&(v=1/0),{line:n.getArg(y,"generatedLine",null),column:n.getArg(y,"generatedColumn",null),lastColumn:v}}return{line:null,column:null,lastColumn:null}}}o.prototype.consumer=a,PM.BasicSourceMapConsumer=o;class l extends a{constructor(d,g){return super(s).then(p=>{let _=d;typeof d=="string"&&(_=n.parseSourceMapInput(d));const y=n.getArg(_,"version"),v=n.getArg(_,"sections");if(y!=p._version)throw new Error("Unsupported version: "+y);let x={line:-1,column:0};return Promise.all(v.map(E=>{if(E.url)throw new Error("Support for url field in sections not implemented.");const M=n.getArg(E,"offset"),O=n.getArg(M,"line"),N=n.getArg(M,"column");if(O<x.line||O===x.line&&N<x.column)throw new Error("Section offsets must be ordered and non-overlapping.");return x=M,new a(n.getArg(E,"map"),g).then(D=>({generatedOffset:{generatedLine:O+1,generatedColumn:N+1},consumer:D}))})).then(E=>(p._sections=E,p))})}get sources(){const d=[];for(let g=0;g<this._sections.length;g++)for(let p=0;p<this._sections[g].consumer.sources.length;p++)d.push(this._sections[g].consumer.sources[p]);return d}originalPositionFor(d){const g={generatedLine:n.getArg(d,"line"),generatedColumn:n.getArg(d,"column")},p=e.search(g,this._sections,function(y,v){const x=y.generatedLine-v.generatedOffset.generatedLine;return x||y.generatedColumn-(v.generatedOffset.generatedColumn-1)}),_=this._sections[p];return _?_.consumer.originalPositionFor({line:g.generatedLine-(_.generatedOffset.generatedLine-1),column:g.generatedColumn-(_.generatedOffset.generatedLine===g.generatedLine?_.generatedOffset.generatedColumn-1:0),bias:d.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every(function(d){return d.consumer.hasContentsOfAllSources()})}sourceContentFor(d,g){for(let p=0;p<this._sections.length;p++){const y=this._sections[p].consumer.sourceContentFor(d,!0);if(y)return y}if(g)return null;throw new Error('"'+d+'" is not in the SourceMap.')}_findSectionIndex(d){for(let g=0;g<this._sections.length;g++){const{consumer:p}=this._sections[g];if(p._findSourceIndex(d)!==-1)return g}return-1}generatedPositionFor(d){const g=this._findSectionIndex(n.getArg(d,"source")),p=g>=0?this._sections[g]:null,_=g>=0&&g+1<this._sections.length?this._sections[g+1]:null,y=p&&p.consumer.generatedPositionFor(d);if(y&&y.line!==null){const v=p.generatedOffset.generatedLine-1,x=p.generatedOffset.generatedColumn-1;return y.line===1&&(y.column+=x,typeof y.lastColumn=="number"&&(y.lastColumn+=x)),y.lastColumn===1/0&&_&&y.line===_.generatedOffset.generatedLine&&(y.lastColumn=_.generatedOffset.generatedColumn-2),y.line+=v,y}return{line:null,column:null,lastColumn:null}}allGeneratedPositionsFor(d){const g=this._findSectionIndex(n.getArg(d,"source")),p=g>=0?this._sections[g]:null,_=g>=0&&g+1<this._sections.length?this._sections[g+1]:null;return p?p.consumer.allGeneratedPositionsFor(d).map(y=>{const v=p.generatedOffset.generatedLine-1,x=p.generatedOffset.generatedColumn-1;return y.line===1&&(y.column+=x,typeof y.lastColumn=="number"&&(y.lastColumn+=x)),y.lastColumn===1/0&&_&&y.line===_.generatedOffset.generatedLine&&(y.lastColumn=_.generatedOffset.generatedColumn-2),y.line+=v,y}):[]}eachMapping(d,g,p){this._sections.forEach((_,y)=>{const v=y+1<this._sections.length?this._sections[y+1]:null,{generatedOffset:x}=_,E=x.generatedLine-1,M=x.generatedColumn-1;_.consumer.eachMapping(function(O){O.generatedLine===1&&(O.generatedColumn+=M,typeof O.lastGeneratedColumn=="number"&&(O.lastGeneratedColumn+=M)),O.lastGeneratedColumn===1/0&&v&&O.generatedLine===v.generatedOffset.generatedLine&&(O.lastGeneratedColumn=v.generatedOffset.generatedColumn-2),O.generatedLine+=E,d.call(this,O)},g,p)})}computeColumnSpans(){for(let d=0;d<this._sections.length;d++)this._sections[d].consumer.computeColumnSpans()}destroy(){for(let d=0;d<this._sections.length;d++)this._sections[d].consumer.destroy()}}PM.IndexedSourceMapConsumer=l;function c(f,d){let g=f;typeof f=="string"&&(g=n.parseSourceMapInput(f));const p=g.sections!=null?new l(g,d):new o(g,d);return Promise.resolve(p)}function u(f,d){return o.fromSourceMap(f,d)}return PM}var F8={},Kte;function VJe(){if(Kte)return F8;Kte=1;const n=lge().SourceMapGenerator,e=AU(),t=/(\r?\n)/,r=10,i="$$$isSourceNode$$$";class s{constructor(o,l,c,u,f){this.children=[],this.sourceContents={},this.line=o??null,this.column=l??null,this.source=c??null,this.name=f??null,this[i]=!0,u!=null&&this.add(u)}static fromStringWithSourceMap(o,l,c){const u=new s,f=o.split(t);let d=0;const g=function(){const E=O(),M=O()||"";return E+M;function O(){return d<f.length?f[d++]:void 0}};let p=1,_=0,y=null,v;return l.eachMapping(function(E){if(y!==null)if(p<E.generatedLine)x(y,g()),p++,_=0;else{v=f[d]||"";const M=v.substr(0,E.generatedColumn-_);f[d]=v.substr(E.generatedColumn-_),_=E.generatedColumn,x(y,M),y=E;return}for(;p<E.generatedLine;)u.add(g()),p++;_<E.generatedColumn&&(v=f[d]||"",u.add(v.substr(0,E.generatedColumn)),f[d]=v.substr(E.generatedColumn),_=E.generatedColumn),y=E},this),d<f.length&&(y&&x(y,g()),u.add(f.splice(d).join(""))),l.sources.forEach(function(E){const M=l.sourceContentFor(E);M!=null&&(c!=null&&(E=e.join(c,E)),u.setSourceContent(E,M))}),u;function x(E,M){if(E===null||E.source===void 0)u.add(M);else{const O=c?e.join(c,E.source):E.source;u.add(new s(E.originalLine,E.originalColumn,O,M,E.name))}}}add(o){if(Array.isArray(o))o.forEach(function(l){this.add(l)},this);else if(o[i]||typeof o=="string")o&&this.children.push(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this}prepend(o){if(Array.isArray(o))for(let l=o.length-1;l>=0;l--)this.prepend(o[l]);else if(o[i]||typeof o=="string")this.children.unshift(o);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+o);return this}walk(o){let l;for(let c=0,u=this.children.length;c<u;c++)l=this.children[c],l[i]?l.walk(o):l!==""&&o(l,{source:this.source,line:this.line,column:this.column,name:this.name})}join(o){let l,c;const u=this.children.length;if(u>0){for(l=[],c=0;c<u-1;c++)l.push(this.children[c]),l.push(o);l.push(this.children[c]),this.children=l}return this}replaceRight(o,l){const c=this.children[this.children.length-1];return c[i]?c.replaceRight(o,l):typeof c=="string"?this.children[this.children.length-1]=c.replace(o,l):this.children.push("".replace(o,l)),this}setSourceContent(o,l){this.sourceContents[e.toSetString(o)]=l}walkSourceContents(o){for(let c=0,u=this.children.length;c<u;c++)this.children[c][i]&&this.children[c].walkSourceContents(o);const l=Object.keys(this.sourceContents);for(let c=0,u=l.length;c<u;c++)o(e.fromSetString(l[c]),this.sourceContents[l[c]])}toString(){let o="";return this.walk(function(l){o+=l}),o}toStringWithSourceMap(o){const l={code:"",line:1,column:0},c=new n(o);let u=!1,f=null,d=null,g=null,p=null;return this.walk(function(_,y){l.code+=_,y.source!==null&&y.line!==null&&y.column!==null?((f!==y.source||d!==y.line||g!==y.column||p!==y.name)&&c.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:l.line,column:l.column},name:y.name}),f=y.source,d=y.line,g=y.column,p=y.name,u=!0):u&&(c.addMapping({generated:{line:l.line,column:l.column}}),f=null,u=!1);for(let v=0,x=_.length;v<x;v++)_.charCodeAt(v)===r?(l.line++,l.column=0,v+1===x?(f=null,u=!1):u&&c.addMapping({source:y.source,original:{line:y.line,column:y.column},generated:{line:l.line,column:l.column},name:y.name})):l.column++}),this.walkSourceContents(function(_,y){c.setSourceContent(_,y)}),{code:l.code,map:c}}}return F8.SourceNode=s,F8}var Zte;function GJe(){return Zte||(Zte=1,NM.SourceMapGenerator=lge().SourceMapGenerator,NM.SourceMapConsumer=qJe().SourceMapConsumer,NM.SourceNode=VJe().SourceNode),NM}var $Je=GJe();let Qte=0;const Jte=Fv,WJe=["Command","lines"];class YJe extends Wqe{constructor(){super(Epe,{traceInitPerf:Fv,skipValidations:!Fv,maxLookahead:2,recoveryEnabled:!0,nodeLocationTracking:"full"}),this.performSelfAnalysis()}PEEK(e,t,...r){console.info(e,r.map(i=>[i.image,i.tokenType]),t)}RULED(e,t,r){const i=WJe.some(s=>e.includes(s));return this.RULE(e,()=>{const a=(Qte++).toString().padStart(3),o=i?"font-weight: bold;":"";if(Jte&&!this.RECORDING_PHASE){const l=[this.LA(1),this.LA(2),this.LA(3)].map(c=>`[${c.tokenType.name} ${c.image.replaceAll(`
`,"\\n")}]`);console.info(`${a}%c> ${e} ${l.join(" ")}`,o)}t(),Jte&&!this.RECORDING_PHASE&&console.info(`${a}%c< ${e} `,o),Qte--},r)}program=this.RULED("program",()=>{this.MANY(()=>this.SUBRULE(this.line))});line=this.RULED("line",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt)},{ALT:()=>this.CONSUME(uk)}])});stmt=this.RULED("stmt",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_label)},{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.stmt_command)},{ALT:()=>this.SUBRULE(this.short_go)},{ALT:()=>this.SUBRULE(this.short_try)}])});inline_go=this.RULED("inline_go",()=>{this.SUBRULE(this.short_go),this.OPTION(()=>this.SUBRULE(this.inline))});inline_try=this.RULED("inline_try",()=>{this.SUBRULE(this.short_try),this.OPTION(()=>this.SUBRULE(this.inline))});inline_command=this.RULED("inline_command",()=>{this.SUBRULE(this.stmt_command),this.OPTION(()=>this.SUBRULE(this.inline))});inline=this.RULED("inline",()=>{this.OR([{ALT:()=>this.SUBRULE(this.stmt_stat)},{ALT:()=>this.SUBRULE(this.stmt_text)},{ALT:()=>this.SUBRULE(this.stmt_comment)},{ALT:()=>this.SUBRULE(this.stmt_hyperlink)},{ALT:()=>this.SUBRULE(this.structured_cmd)},{ALT:()=>this.SUBRULE(this.inline_go)},{ALT:()=>this.SUBRULE(this.inline_try)},{ALT:()=>this.SUBRULE(this.inline_command)}])});stmt_label=this.RULED("stmt_label",()=>{this.CONSUME(cw)});stmt_stat=this.RULED("stmt_stat",()=>{this.CONSUME(OE)});stmt_text=this.RULED("stmt_text",()=>{this.OR([{ALT:()=>this.CONSUME(fk)}])});stmt_comment=this.RULED("stmt_comment",()=>{this.CONSUME(hk)});stmt_hyperlink=this.RULED("stmt_hyperlink",()=>{this.CONSUME(dk),this.CONSUME(TH)});stmt_command=this.RULED("stmt_command",()=>{this.CONSUME(By),this.OR([{ALT:()=>this.SUBRULE(this.words)},{ALT:()=>this.SUBRULE(this.structured_cmd)}])});structured_cmd=this.RULED("structured_cmd",()=>{this.OR([{ALT:()=>this.SUBRULE(this.command_if)},{ALT:()=>this.SUBRULE(this.command_while)},{ALT:()=>this.SUBRULE(this.command_repeat)},{ALT:()=>this.SUBRULE(this.command_waitfor)},{ALT:()=>this.SUBRULE(this.command_foreach)},{ALT:()=>this.SUBRULE(this.command_break)},{ALT:()=>this.SUBRULE(this.command_continue)}])});short_go=this.RULED("short_go",()=>{this.CONSUME(lE),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});short_try=this.RULED("short_try",()=>{this.CONSUME(pk),this.OR([{ALT:()=>this.SUBRULE(this.string_token)},{ALT:()=>this.SUBRULE(this.dir)}])});command_if=this.RULED("command_if",()=>{this.CONSUME(cE),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_if_block))});command_if_block=this.RULED("command_if_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(uE),this.MANY(()=>this.SUBRULE(this.line)),this.MANY2({GATE:this.BACKTRACK(this.command_else_if),DEF:()=>this.SUBRULE(this.command_else_if)}),this.OPTION(()=>this.SUBRULE(this.command_else)),this.MANY3(()=>this.CONSUME3(uk)),this.CONSUME4(By),this.CONSUME4(ZD)}}])});command_block=this.RULED("command_block",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(uE),this.MANY(()=>this.SUBRULE(this.line)),this.CONSUME(By),this.CONSUME(ZD)}}])});command_fork=this.RULED("command_fork",()=>{this.OR([{ALT:()=>this.SUBRULE(this.inline)},{ALT:()=>{this.CONSUME(uE),this.MANY({GATE:this.BACKTRACK(this.line),DEF:()=>this.SUBRULE(this.line)})}}])});command_else_if=this.RULED("command_else_if",()=>{this.CONSUME(By),this.CONSUME(fE),this.CONSUME(cE),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_fork))});command_else=this.RULED("command_else",()=>{this.CONSUME(By),this.CONSUME(fE),this.OPTION1(()=>this.SUBRULE(this.words)),this.OPTION2(()=>this.SUBRULE(this.command_fork))});command_while=this.RULED("command_while",()=>{this.CONSUME(BH),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_repeat=this.RULED("command_repeat",()=>{this.CONSUME(FH),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_waitfor=this.RULED("command_waitfor",()=>{this.CONSUME(zH),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_foreach=this.RULED("command_foreach",()=>{this.CONSUME(jH),this.SUBRULE(this.words),this.OPTION(()=>this.SUBRULE(this.command_block))});command_break=this.RULED("command_break",()=>{this.CONSUME(HH)});command_continue=this.RULED("command_continue",()=>{this.CONSUME(qH)});command_play=this.RULED("command_play",()=>{this.CONSUME(UH)});command_toast=this.RULED("command_toast",()=>{this.CONSUME(ype)});command_ticker=this.RULED("command_ticker",()=>{this.CONSUME(bpe)});expr=this.RULED("expr",()=>{this.SUBRULE1(this.and_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME($D),this.SUBRULE2(this.and_test,{LABEL:"RHS"})})});and_test=this.RULED("and_test",()=>{this.SUBRULE1(this.not_test,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(YD),this.SUBRULE2(this.not_test,{LABEL:"RHS"})})});not_test=this.RULED("not_test",()=>{this.OR([{ALT:()=>{this.CONSUME(WD),this.SUBRULE1(this.not_test,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.comparison)}])});comparison=this.RULED("comparison",()=>{this.SUBRULE1(this.arith_expr,{LABEL:"LHS"}),this.MANY(()=>{this.SUBRULE(this.comp_op),this.SUBRULE2(this.arith_expr,{LABEL:"RHS"})})});comp_op=this.RULED("comp_op",()=>{this.OR([{ALT:()=>this.CONSUME(wH)},{ALT:()=>this.CONSUME(RH)},{ALT:()=>this.CONSUME(AH)},{ALT:()=>this.CONSUME(CH)},{ALT:()=>this.CONSUME(MH)},{ALT:()=>this.CONSUME(kH)}])});expr_value=this.RULED("expr_value",()=>{this.SUBRULE1(this.and_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME($D),this.SUBRULE2(this.and_test_value,{LABEL:"RHS"})})});and_test_value=this.RULED("and_test_value",()=>{this.SUBRULE1(this.not_test_value,{LABEL:"LHS"}),this.MANY(()=>{this.CONSUME(YD),this.SUBRULE2(this.not_test_value,{LABEL:"RHS"})})});not_test_value=this.RULED("not_test_value",()=>{this.OR([{ALT:()=>{this.CONSUME(WD),this.SUBRULE1(this.not_test_value,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE2(this.arith_expr)}])});arith_expr=this.RULED("arith_expr",()=>{this.OR([{ALT:()=>this.SUBRULE(this.token_expr,{LABEL:"LHS"})},{ALT:()=>{this.SUBRULE1(this.term),this.MANY(()=>this.SUBRULE2(this.arith_expr_item,{LABEL:"RHS"}))}}])});arith_expr_item=this.RULED("arith_expr_item",()=>{this.OR([{ALT:()=>this.CONSUME(XD)},{ALT:()=>this.CONSUME(KD)}]),this.SUBRULE(this.term)});term=this.RULED("term",()=>{this.SUBRULE1(this.factor),this.MANY(()=>this.SUBRULE2(this.term_item))});term_item=this.RULED("term_item",()=>{this.OR([{ALT:()=>this.CONSUME(IH)},{ALT:()=>this.CONSUME(lE)},{ALT:()=>this.CONSUME(NH)},{ALT:()=>this.CONSUME(PH)}]),this.SUBRULE(this.factor)});factor=this.RULED("factor",()=>{this.OR1([{ALT:()=>{this.OR2([{ALT:()=>this.CONSUME(XD)},{ALT:()=>this.CONSUME(KD)}]),this.SUBRULE(this.factor,{LABEL:"LHS"})}},{ALT:()=>this.SUBRULE(this.power)}])});power=this.RULED("power",()=>{this.SUBRULE(this.token),this.OPTION(()=>{this.CONSUME(OH),this.SUBRULE(this.factor)})});words=this.RULED("words",()=>{this.AT_LEAST_ONE(()=>this.SUBRULE(this.expr))});kind=this.RULED("kind",()=>{this.OPTION(()=>this.SUBRULE(this.color)),this.SUBRULE(this.string_token)});category=this.RULED("category",()=>{this.OR([{ALT:()=>this.CONSUME(qfe)},{ALT:()=>this.CONSUME(Vfe)}])});collision=this.RULED("collision",()=>{this.OR([{ALT:()=>this.CONSUME(Gfe)},{ALT:()=>this.CONSUME($fe)},{ALT:()=>this.CONSUME(Wfe)},{ALT:()=>this.CONSUME(Yfe)},{ALT:()=>this.CONSUME(Xfe)},{ALT:()=>this.CONSUME(Kfe)},{ALT:()=>this.CONSUME(Zfe)},{ALT:()=>this.CONSUME(Qfe)},{ALT:()=>this.CONSUME(Jfe)}])});color=this.RULED("color",()=>{this.OR([{ALT:()=>this.CONSUME(ehe)},{ALT:()=>this.CONSUME(the)},{ALT:()=>this.CONSUME(nhe)},{ALT:()=>this.CONSUME(rhe)},{ALT:()=>this.CONSUME(ihe)},{ALT:()=>this.CONSUME(she)},{ALT:()=>this.CONSUME(ahe)},{ALT:()=>this.CONSUME(ohe)},{ALT:()=>this.CONSUME(lhe)},{ALT:()=>this.CONSUME(che)},{ALT:()=>this.CONSUME(uhe)},{ALT:()=>this.CONSUME(fhe)},{ALT:()=>this.CONSUME(hhe)},{ALT:()=>this.CONSUME(dhe)},{ALT:()=>this.CONSUME(phe)},{ALT:()=>this.CONSUME(mhe)},{ALT:()=>this.CONSUME(ghe)},{ALT:()=>this.CONSUME(_he)},{ALT:()=>this.CONSUME(vhe)},{ALT:()=>this.CONSUME(yhe)},{ALT:()=>this.CONSUME(bhe)},{ALT:()=>this.CONSUME(She)},{ALT:()=>this.CONSUME(Ehe)},{ALT:()=>this.CONSUME(xhe)},{ALT:()=>this.CONSUME(The)},{ALT:()=>this.CONSUME(whe)},{ALT:()=>this.CONSUME(Rhe)},{ALT:()=>this.CONSUME(Ahe)},{ALT:()=>this.CONSUME(Che)},{ALT:()=>this.CONSUME(Mhe)},{ALT:()=>this.CONSUME(khe)},{ALT:()=>this.CONSUME(Ohe)},{ALT:()=>this.CONSUME(Ihe)},{ALT:()=>this.CONSUME(Nhe)},{ALT:()=>this.CONSUME(Phe)},{ALT:()=>this.CONSUME(Dhe)},{ALT:()=>this.CONSUME(Lhe)},{ALT:()=>this.CONSUME(Uhe)},{ALT:()=>this.CONSUME(Bhe)},{ALT:()=>this.CONSUME(Fhe)},{ALT:()=>this.CONSUME(zhe)},{ALT:()=>this.CONSUME(jhe)},{ALT:()=>this.CONSUME(Hhe)},{ALT:()=>this.CONSUME(qhe)},{ALT:()=>this.CONSUME(Vhe)},{ALT:()=>this.CONSUME(Ghe)},{ALT:()=>this.CONSUME($he)},{ALT:()=>this.CONSUME(Whe)},{ALT:()=>this.CONSUME(Yhe)},{ALT:()=>this.CONSUME(Xhe)},{ALT:()=>this.CONSUME(Khe)},{ALT:()=>this.CONSUME(Zhe)},{ALT:()=>this.CONSUME(Qhe)},{ALT:()=>this.CONSUME(Jhe)},{ALT:()=>this.CONSUME(ede)},{ALT:()=>this.CONSUME(tde)},{ALT:()=>this.CONSUME(nde)},{ALT:()=>this.CONSUME(rde)},{ALT:()=>this.CONSUME(ide)},{ALT:()=>this.CONSUME(sde)},{ALT:()=>this.CONSUME(ade)},{ALT:()=>this.CONSUME(ode)},{ALT:()=>this.CONSUME(lde)},{ALT:()=>this.CONSUME(cde)},{ALT:()=>this.CONSUME(ude)},{ALT:()=>this.CONSUME(fde)},{ALT:()=>this.CONSUME(hde)},{ALT:()=>this.CONSUME(dde)},{ALT:()=>this.CONSUME(pde)},{ALT:()=>this.CONSUME(mde)}])});dir_mod=this.RULED("dir_mod",()=>{this.OR([{ALT:()=>this.CONSUME(Cde)},{ALT:()=>this.CONSUME(Mde)},{ALT:()=>this.CONSUME(kde)},{ALT:()=>this.CONSUME(Ode)},{ALT:()=>this.CONSUME(Kde)},{ALT:()=>this.CONSUME(Zde)},{ALT:()=>this.SUBRULE(this.dir_within)},{ALT:()=>this.SUBRULE(this.dir_awayby)}])});dir_by=this.RULED("dir_by",()=>{this.CONSUME(Sde),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_at=this.RULED("dir_at",()=>{this.CONSUME(Ede),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_away=this.RULED("dir_away",()=>{this.CONSUME(Ide),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_toward=this.RULED("dir_toward",()=>{this.CONSUME(Nde),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token)});dir_find=this.RULED("dir_find",()=>{this.CONSUME(Pde),this.SUBRULE1(this.kind)});dir_flee=this.RULED("dir_flee",()=>{this.CONSUME(Dde),this.SUBRULE1(this.kind)});dir_to=this.RULED("dir_to",()=>{this.CONSUME(Lde),this.SUBRULE1(this.dir),this.SUBRULE2(this.dir)});dir_within=this.RULED("dir_within",()=>{this.CONSUME(Qde),this.SUBRULE1(this.simple_token)});dir_awayby=this.RULED("dir_awayby",()=>{this.CONSUME(Jde),this.SUBRULE1(this.simple_token)});dir=this.RULED("dir",()=>{this.MANY(()=>this.SUBRULE(this.dir_mod)),this.OR([{ALT:()=>this.CONSUME(gde)},{ALT:()=>this.CONSUME(_de)},{ALT:()=>this.CONSUME(vde)},{ALT:()=>this.CONSUME(yde)},{ALT:()=>this.CONSUME(bde)},{ALT:()=>this.SUBRULE(this.dir_by)},{ALT:()=>this.SUBRULE(this.dir_at)},{ALT:()=>this.SUBRULE(this.dir_away)},{ALT:()=>this.SUBRULE(this.dir_toward)},{ALT:()=>this.CONSUME(xde)},{ALT:()=>this.CONSUME(Tde)},{ALT:()=>this.CONSUME(wde)},{ALT:()=>this.CONSUME(Rde)},{ALT:()=>this.CONSUME(Ade)},{ALT:()=>this.SUBRULE(this.dir_find)},{ALT:()=>this.SUBRULE(this.dir_flee)},{ALT:()=>this.SUBRULE(this.dir_to)},{ALT:()=>this.CONSUME(Ude)},{ALT:()=>this.CONSUME(Bde)},{ALT:()=>this.CONSUME(Fde)},{ALT:()=>this.CONSUME(zde)},{ALT:()=>this.CONSUME(jde)},{ALT:()=>this.CONSUME(Hde)},{ALT:()=>this.CONSUME(qde)},{ALT:()=>this.CONSUME(Vde)},{ALT:()=>this.CONSUME(Gde)},{ALT:()=>this.CONSUME($de)},{ALT:()=>this.CONSUME(Wde)},{ALT:()=>this.CONSUME(Yde)},{ALT:()=>this.CONSUME(Xde)}])});expr_any=this.RULED("expr_any",()=>{this.OR1([{ALT:()=>this.SUBRULE1(this.kind)},{ALT:()=>this.SUBRULE1(this.color)},{ALT:()=>{this.SUBRULE(this.dir),this.OR2([{ALT:()=>this.SUBRULE2(this.kind)},{ALT:()=>this.SUBRULE2(this.color)}])}}])});token_expr_any=this.RULED("token_expr_any",()=>{this.CONSUME(rpe),this.SUBRULE(this.expr_any)});token_expr_count=this.RULED("token_expr_count",()=>{this.CONSUME(ipe),this.SUBRULE(this.expr_any)});token_expr_blocked=this.RULED("token_expr_blocked",()=>{this.CONSUME(npe),this.SUBRULE(this.dir)});token_expr_abs=this.RULED("token_expr_abs",()=>{this.CONSUME(spe),this.SUBRULE(this.simple_token)});token_expr_intceil=this.RULED("token_expr_intceil",()=>{this.CONSUME(ape),this.SUBRULE(this.simple_token)});token_expr_intfloor=this.RULED("token_expr_intfloor",()=>{this.CONSUME(ope),this.SUBRULE(this.simple_token)});token_expr_intround=this.RULED("token_expr_intround",()=>{this.CONSUME(lpe),this.SUBRULE(this.simple_token)});token_expr_clamp=this.RULED("token_expr_clamp",()=>{this.CONSUME(cpe),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.SUBRULE3(this.simple_token)});token_expr_min=this.RULED("token_expr_min",()=>{this.CONSUME(upe),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_max=this.RULED("token_expr_max",()=>{this.CONSUME(fpe),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pick=this.RULED("token_expr_pick",()=>{this.CONSUME(hpe),this.AT_LEAST_ONE(()=>this.SUBRULE1(this.simple_token))});token_expr_pickwith=this.RULED("token_expr_pickwith",()=>{this.CONSUME(dpe),this.SUBRULE1(this.simple_token),this.AT_LEAST_ONE(()=>this.SUBRULE2(this.simple_token))});token_expr_random=this.RULED("token_expr_random",()=>{this.CONSUME(ppe),this.SUBRULE1(this.simple_token),this.OPTION(()=>this.SUBRULE2(this.simple_token))});token_expr_randomwith=this.RULED("token_expr_randomwith",()=>{this.CONSUME(mpe),this.SUBRULE1(this.simple_token),this.SUBRULE2(this.simple_token),this.OPTION(()=>this.SUBRULE3(this.simple_token))});token_expr_run=this.RULED("token_expr_run",()=>{this.CONSUME(gpe),this.SUBRULE(this.string_token)});token_expr_runwith=this.RULED("token_expr_runwith",()=>{this.CONSUME(_pe),this.SUBRULE(this.simple_token),this.SUBRULE(this.string_token)});token_expr=this.RULED("token_expr",()=>{this.OR([{ALT:()=>this.CONSUME(epe)},{ALT:()=>this.CONSUME(tpe)},{ALT:()=>this.SUBRULE(this.token_expr_any)},{ALT:()=>this.SUBRULE(this.token_expr_count)},{ALT:()=>this.SUBRULE(this.token_expr_blocked)},{ALT:()=>this.SUBRULE(this.token_expr_abs)},{ALT:()=>this.SUBRULE(this.token_expr_intceil)},{ALT:()=>this.SUBRULE(this.token_expr_intfloor)},{ALT:()=>this.SUBRULE(this.token_expr_intround)},{ALT:()=>this.SUBRULE(this.token_expr_clamp)},{ALT:()=>this.SUBRULE(this.token_expr_min)},{ALT:()=>this.SUBRULE(this.token_expr_max)},{ALT:()=>this.SUBRULE(this.token_expr_pick)},{ALT:()=>this.SUBRULE(this.token_expr_pickwith)},{ALT:()=>this.SUBRULE(this.token_expr_random)},{ALT:()=>this.SUBRULE(this.token_expr_randomwith)},{ALT:()=>this.SUBRULE(this.token_expr_run)},{ALT:()=>this.SUBRULE(this.token_expr_runwith)}])});string_token=this.RULED("string_token",()=>{this.OR([{ALT:()=>this.CONSUME(bu)},{ALT:()=>this.CONSUME(x2)}])});simple_token=this.RULED("simple_token",()=>{this.OR([{ALT:()=>this.CONSUME(GD)},{ALT:()=>this.CONSUME(bu)},{ALT:()=>this.CONSUME(x2)},{ALT:()=>this.SUBRULE(this.color)}])});token=this.RULED("token",()=>{this.OR([{ALT:()=>this.SUBRULE(this.category)},{ALT:()=>this.SUBRULE(this.collision)},{ALT:()=>this.SUBRULE(this.color)},{ALT:()=>this.SUBRULE(this.dir)},{ALT:()=>this.SUBRULE(this.command_play)},{ALT:()=>this.SUBRULE(this.command_toast)},{ALT:()=>this.SUBRULE(this.command_ticker)},{ALT:()=>this.CONSUME(cw)},{ALT:()=>this.CONSUME(x2)},{ALT:()=>this.CONSUME(bu)},{ALT:()=>this.CONSUME(GD)},{ALT:()=>this.CONSUME(vpe)},{ALT:()=>{this.CONSUME(DH),this.SUBRULE(this.expr),this.CONSUME(LH)}}])})}const vT=new YJe;if(cBe){const n=vT.getGAstProductions(),e=sVe(n);console.info(e)}const XJe=vT.getBaseCstVisitorConstructor();var ir=(n=>(n[n.PROGRAM=0]="PROGRAM",n[n.API=1]="API",n[n.LINE=2]="LINE",n[n.MARK=3]="MARK",n[n.GOTO=4]="GOTO",n[n.COUNT=5]="COUNT",n[n.TEXT=6]="TEXT",n[n.LABEL=7]="LABEL",n[n.HYPERLINK=8]="HYPERLINK",n[n.STAT=9]="STAT",n[n.MOVE=10]="MOVE",n[n.COMMAND=11]="COMMAND",n[n.LITERAL=12]="LITERAL",n[n.IF=13]="IF",n[n.IF_CHECK=14]="IF_CHECK",n[n.IF_BLOCK=15]="IF_BLOCK",n[n.ELSE_IF=16]="ELSE_IF",n[n.ELSE=17]="ELSE",n[n.WHILE=18]="WHILE",n[n.BREAK=19]="BREAK",n[n.CONTINUE=20]="CONTINUE",n[n.REPEAT=21]="REPEAT",n[n.WAITFOR=22]="WAITFOR",n[n.FOREACH=23]="FOREACH",n[n.OR=24]="OR",n[n.AND=25]="AND",n[n.NOT=26]="NOT",n[n.COMPARE=27]="COMPARE",n[n.COMPARE_ITEM=28]="COMPARE_ITEM",n[n.OPERATOR=29]="OPERATOR",n[n.OPERATOR_ITEM=30]="OPERATOR_ITEM",n[n.EXPR=31]="EXPR",n))(ir||{}),BS=(n=>(n[n.IS_EQ=0]="IS_EQ",n[n.IS_NOT_EQ=1]="IS_NOT_EQ",n[n.IS_LESS_THAN=2]="IS_LESS_THAN",n[n.IS_GREATER_THAN=3]="IS_GREATER_THAN",n[n.IS_LESS_THAN_OR_EQ=4]="IS_LESS_THAN_OR_EQ",n[n.IS_GREATER_THAN_OR_EQ=5]="IS_GREATER_THAN_OR_EQ",n))(BS||{}),lv=(n=>(n[n.EMPTY=0]="EMPTY",n[n.PLUS=1]="PLUS",n[n.MINUS=2]="MINUS",n[n.POWER=3]="POWER",n[n.MULTIPLY=4]="MULTIPLY",n[n.DIVIDE=5]="DIVIDE",n[n.MOD_DIVIDE=6]="MOD_DIVIDE",n[n.FLOOR_DIVIDE=7]="FLOOR_DIVIDE",n[n.UNI_PLUS=8]="UNI_PLUS",n[n.UNI_MINUS=9]="UNI_MINUS",n))(lv||{}),nP=(n=>(n[n.NUMBER=0]="NUMBER",n[n.STRING=1]="STRING",n[n.TEMPLATE=2]="TEMPLATE",n))(nP||{});function Bu(n,e){const[t]=n??[];return(t?.image??e).trimStart().replaceAll(/^"|"$/g,"")}class KJe extends XJe{unique=0;constructor(){super(),Fv&&this.validateVisitor()}visit(e){if(bi(e)&&(e=e[0]),!!xe(e))return this[e.name](e.children,e.location)}createcodenode(e,t){return[{...t,...e,lineindex:0}]}createstringnode(e,t){return this.createcodenode(e,{type:12,literal:1,value:t})}createtemplatenode(e,t){return this.createcodenode(e,{type:12,literal:2,value:t})}createmarknode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:3,id:t,comment:r}))}creategotonode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:4,id:t,comment:r}))}createlinenode(e,t){return this.createcodenode(e,{type:2,stmts:t})}createapinode(e,t,r){return this.createlinenode(e,this.createcodenode(e,{type:1,words:r,method:t}))}createlogicnode(e,t,r,i){return this.createlinenode(e,this.createcodenode(e,{type:14,skip:r,words:i,method:t}))}createcountnode(e){return this.createcodenode(e,{type:5,index:this.unique++})}createexprnodeondemand(e,t){return e.length===1?e[0]:this.createcodenode(t,{type:31,words:e})[0]}go(e){return Array.isArray(e)?e.map(t=>this.visit(t)).flat():xe(e)?[this.visit(e)].flat():[]}program(e,t){return this.unique=0,this.createcodenode(t,{type:0,lines:[this.createlinenode(t,this.createcodenode(t,{type:7,active:!0,name:"restart"})),this.go(e.line)].flat()})}line(e){return e.stmt?this.go(e.stmt):[]}stmt(e){return e.stmt_label?this.go(e.stmt_label):e.stmt_stat?this.go(e.stmt_stat):e.stmt_text?this.go(e.stmt_text):e.stmt_comment?this.go(e.stmt_comment):e.stmt_hyperlink?this.go(e.stmt_hyperlink):e.stmt_command?this.go(e.stmt_command):e.short_go?this.go(e.short_go):e.short_try?this.go(e.short_try):[]}inline_go(e){const t=[];return e.short_go&&t.push(...this.go(e.short_go)),e.inline&&t.push(...this.go(e.inline)),t}inline_try(e){const t=[];return e.short_try&&t.push(...this.go(e.short_try)),e.inline&&t.push(...this.go(e.inline)),t}inline_command(e){const t=[];return e.stmt_command&&t.push(...this.go(e.stmt_command)),e.inline&&t.push(...this.go(e.inline)),t}inline(e){const t=[];return e.stmt_stat&&t.push(...this.go(e.stmt_stat)),e.stmt_text&&t.push(...this.go(e.stmt_text)),e.stmt_comment&&t.push(...this.go(e.stmt_comment)),e.stmt_hyperlink&&t.push(...this.go(e.stmt_hyperlink)),e.inline_go&&t.push(...this.go(e.inline_go)),e.inline_try&&t.push(...this.go(e.inline_try)),e.inline_command&&t.push(...this.go(e.inline_command)),e.structured_cmd&&t.push(...this.go(e.structured_cmd)),t}stmt_label(e,t){return this.createlinenode(t,this.createcodenode(t,{type:7,active:!0,name:Bu(e.token_label,":").slice(1).trim()}))}stmt_stat(e,t){return this.createlinenode(t,this.createcodenode(t,{type:9,value:Bu(e.token_stat,"@").slice(1)}))}stmt_text(e,t){const r=Bu(e.token_text,"");return this.createlinenode(t,this.createcodenode(t,{type:6,value:r}))}stmt_comment(e,t){return this.createlinenode(t,this.createcodenode(t,{type:7,active:!1,name:Bu(e.token_comment,"'").slice(1).trim()}))}stmt_hyperlink(e,t){return this.createlinenode(t,this.createcodenode(t,{type:8,link:Bu(e.token_hyperlink,"!").slice(1),text:Bu(e.token_hyperlinktext,";").slice(1)}))}stmt_command(e,t){return e.structured_cmd?this.go(e.structured_cmd):this.createlinenode(t,this.createcodenode(t,{type:11,words:this.go(e.words)}))}structured_cmd(e){return e.command_if?this.go(e.command_if):e.command_while?this.go(e.command_while):e.command_repeat?this.go(e.command_repeat):e.command_waitfor?this.go(e.command_waitfor):e.command_foreach?this.go(e.command_foreach):e.command_break?this.go(e.command_break):e.command_continue?this.go(e.command_continue):[]}short_go(e,t){return e.token_divide?this.createlinenode(t,this.createcodenode(t,{type:10,wait:!0,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}short_try(e,t){return e.token_query?this.createlinenode(t,this.createcodenode(t,{type:10,wait:!1,words:[this.go(e.string_token),this.go(e.dir)].flat()})):[]}command_if(e,t){const[r]=this.createlogicnode(t,Bu(e.token_if,"if").toLowerCase(),"",this.go(e.words)),[i]=this.go(e.command_if_block)??[];return this.createcodenode(t,{type:13,check:r,block:i})}command_if_block(e,t){const r=vc(),i=vc();return this.createcodenode(t,{type:15,skip:r,done:i,lines:[this.go(e.inline),this.go(e.line),this.creategotonode(t,i,"end of if"),this.createmarknode(t,r,"alt logic")].flat(),altlines:[this.go(e.command_else_if),this.go(e.command_else),this.createmarknode(t,i,"end of if")].flat()})}command_block(e){return[this.go(e.inline),this.go(e.line)].flat()}command_fork(e){return[this.go(e.inline),this.go(e.line)].flat()}command_else_if(e,t){const r=vc(),i=vc();return this.createcodenode(t,{type:16,done:i,lines:[this.createlogicnode(t,Bu(e.token_if,"if"),r,this.go(e.words)),this.go(e.command_fork),this.creategotonode(t,i,"end of if"),this.createmarknode(t,r,"skip")].flat()})}command_else(e,t){const r=[];return e.words&&r.push(...this.createlinenode(t,this.createcodenode(t,{type:11,words:this.go(e.words)}))),e.command_fork&&r.push(...this.go(e.command_fork)),this.createcodenode(t,{type:17,lines:r})}command_while(e,t){const r=vc(),i=vc();return this.createcodenode(t,{type:18,loop:r,done:i,lines:[this.createmarknode(t,r,"start of while"),this.createlogicnode(t,"if",i,this.go(e.words)),this.go(e.command_block),this.creategotonode(t,r,"loop of while"),this.createmarknode(t,i,"end of while")].flat()})}command_repeat(e,t){const r=vc(),i=vc(),a=[this.createcountnode(t),this.go(e.words)].flat();return this.createcodenode(t,{type:21,loop:r,done:i,lines:[this.createapinode(t,"repeatstart",a),this.createmarknode(t,r,"start of repeat"),this.createlogicnode(t,"repeat",i,a),this.go(e.command_block),this.creategotonode(t,r,"loop of repeat"),this.createmarknode(t,i,"end of repeat")].flat()})}command_foreach(e,t){const r=vc(),i=vc(),a=[this.createcountnode(t),this.go(e.words)].flat();return this.createcodenode(t,{type:23,loop:r,done:i,lines:[this.createapinode(t,"foreachstart",a),this.createmarknode(t,r,"start of foreach"),this.createlogicnode(t,"foreach",i,a),this.go(e.command_block),this.creategotonode(t,r,"loop of foreach"),this.createmarknode(t,i,"end of foreach")].flat()})}command_waitfor(e,t){const r=vc();return this.createcodenode(t,{type:22,loop:r,lines:[this.createmarknode(t,r,"start of waitfor"),this.createlogicnode(t,"waitfor",r,this.go(e.words))].flat()})}command_break(e,t){return this.createcodenode(t,{type:19,goto:0})}command_continue(e,t){return this.createcodenode(t,{type:20,goto:0})}command_play(e,t){const r=Bu(e.token_command_play,"").trim(),[i,...s]=r.split(" ");return[this.createstringnode(t,i),this.createstringnode(t,s.join(" "))].flat()}command_toast(e,t){const i=Bu(e.token_command_toast,"").replace("toast","").trim();return[this.createstringnode(t,"toast"),this.createtemplatenode(t,i)].flat()}command_ticker(e,t){const i=Bu(e.token_command_ticker,"").replace("ticker","").trim();return[this.createstringnode(t,"ticker"),this.createtemplatenode(t,i)].flat()}expr(e,t){return e.RHS?this.createcodenode(t,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}and_test(e,t){return e.RHS?this.createcodenode(t,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}not_test(e,t){return e.comparison?this.go(e.comparison):e.LHS?this.createcodenode(t,{type:26,items:this.go(e.LHS)}):[]}comparison(e,t){if(e.RHS){const[r]=this.go(e.comp_op);return this.createcodenode(t,{type:27,compare:r,lhs:this.createexprnodeondemand(this.go(e.LHS),t),rhs:this.createexprnodeondemand(this.go(e.RHS),t)})}return this.go(e.LHS)}comp_op(e,t){return e.token_iseq?this.createcodenode(t,{type:28,method:0}):e.token_isnoteq?this.createcodenode(t,{type:28,method:1}):e.token_islessthan?this.createcodenode(t,{type:28,method:2}):e.token_isgreaterthan?this.createcodenode(t,{type:28,method:3}):e.token_islessthanorequal?this.createcodenode(t,{type:28,method:4}):e.token_isgreaterthanorequal?this.createcodenode(t,{type:28,method:5}):[]}expr_value(e,t){return e.RHS?this.createcodenode(t,{type:24,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}and_test_value(e,t){return e.RHS?this.createcodenode(t,{type:25,items:[this.createexprnodeondemand(this.go(e.LHS),t),this.createexprnodeondemand(this.go(e.RHS),t)]}):this.go(e.LHS)}not_test_value(e,t){return e.arith_expr?this.go(e.arith_expr):e.LHS?this.createcodenode(t,{type:26,items:this.go(e.LHS)}):[]}arith_expr(e,t){if(e.LHS)return this.go(e.LHS);const r=this.go(e.term);return e.RHS?this.createcodenode(t,{type:29,lhs:r[0],items:this.go(e.RHS)}):r}arith_expr_item(e,t){return this.createcodenode(t,{type:30,operator:e.token_plus?1:2,rhs:this.go(e.term)[0]})}term(e,t){return e.term_item?this.createcodenode(t,{type:29,lhs:this.go(e.factor)[0],items:this.go(e.term_item)}):this.go(e.factor)}term_item(e,t){let r=0;return e.token_multiply&&(r=4),e.token_divide&&(r=5),e.token_moddivide&&(r=6),e.token_floordivide&&(r=7),this.createcodenode(t,{type:30,operator:r,rhs:this.go(e.factor)[0]})}factor(e,t){if(e.power)return this.go(e.power);let r=0;return e.token_plus&&(r=8),e.token_minus&&(r=9),this.createcodenode(t,{type:29,lhs:void 0,items:this.createcodenode(t,{type:30,operator:r,rhs:this.go(e.LHS)[0]})})}power(e,t){const r=this.go(e.token);return e.factor?this.createcodenode(t,{type:29,lhs:r[0],items:this.createcodenode(t,{type:30,operator:3,rhs:this.go(e.factor)[0]})}):r}words(e){return this.go(e.expr)}kind(e){return[this.go(e.color),this.go(e.string_token)].flat()}category(e,t){return e.token_isterrain?this.createcodenode(t,{type:12,literal:1,value:"isterrain"}):e.token_isobject?this.createcodenode(t,{type:12,literal:1,value:"isobject"}):[]}collision(e,t){return e.token_iswalkable?this.createcodenode(t,{type:12,literal:1,value:"iswalkable"}):e.token_iswalking?this.createcodenode(t,{type:12,literal:1,value:"iswalking"}):e.token_iswalk?this.createcodenode(t,{type:12,literal:1,value:"iswalk"}):e.token_isswimmable?this.createcodenode(t,{type:12,literal:1,value:"isswimmable"}):e.token_isswimming?this.createcodenode(t,{type:12,literal:1,value:"isswimming"}):e.token_isswim?this.createcodenode(t,{type:12,literal:1,value:"isswim"}):e.token_issolid?this.createcodenode(t,{type:12,literal:1,value:"issolid"}):e.token_isbullet?this.createcodenode(t,{type:12,literal:1,value:"isbullet"}):e.token_isghost?this.createcodenode(t,{type:12,literal:1,value:"isghost"}):[]}color(e,t){let r="ERROR";return e.token_black&&(r="black"),e.token_dkblue&&(r="dkblue"),e.token_dkgreen&&(r="dkgreen"),e.token_dkcyan&&(r="dkcyan"),e.token_dkred&&(r="dkred"),e.token_dkpurple&&(r="dkpurple"),e.token_dkyellow&&(r="dkyellow"),e.token_ltgray&&(r="ltgray"),e.token_dkgray&&(r="dkgray"),e.token_blue&&(r="blue"),e.token_green&&(r="green"),e.token_cyan&&(r="cyan"),e.token_red&&(r="red"),e.token_purple&&(r="purple"),e.token_yellow&&(r="yellow"),e.token_white&&(r="white"),e.token_brown&&(r="brown"),e.token_dkwhite&&(r="dkwhite"),e.token_ltgrey&&(r="ltgrey"),e.token_gray&&(r="gray"),e.token_grey&&(r="grey"),e.token_dkgrey&&(r="dkgrey"),e.token_ltblack&&(r="ltblack"),e.token_onblack&&(r="onblack"),e.token_ondkblue&&(r="ondkblue"),e.token_ondkgreen&&(r="ondkgreen"),e.token_ondkcyan&&(r="ondkcyan"),e.token_ondkred&&(r="ondkred"),e.token_ondkpurple&&(r="ondkpurple"),e.token_ondkyellow&&(r="ondkyellow"),e.token_onltgray&&(r="onltgray"),e.token_ondkgray&&(r="ondkgray"),e.token_onblue&&(r="onblue"),e.token_ongreen&&(r="ongreen"),e.token_oncyan&&(r="oncyan"),e.token_onred&&(r="onred"),e.token_onpurple&&(r="onpurple"),e.token_onyellow&&(r="onyellow"),e.token_onwhite&&(r="onwhite"),e.token_onbrown&&(r="onbrown"),e.token_ondkwhite&&(r="ondkwhite"),e.token_onltgrey&&(r="onltgrey"),e.token_ongray&&(r="ongray"),e.token_ongrey&&(r="ongrey"),e.token_ondkgrey&&(r="ondkgrey"),e.token_onltblack&&(r="onltblack"),e.token_onclear&&(r="onclear"),this.createcodenode(t,{type:12,literal:1,value:r})}dir_mod(e,t){if(e.dir_within)return this.go(e.dir_within);if(e.dir_awayby)return this.go(e.dir_awayby);let r="ERROR";return e.token_cw&&(r="cw"),e.token_ccw&&(r="ccw"),e.token_opp&&(r="opp"),e.token_rndp&&(r="rndp"),e.token_over&&(r="over"),e.token_under&&(r="under"),this.createcodenode(t,{type:12,literal:1,value:r})}dir_by(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"by"}),...this.go(e.simple_token)]}dir_at(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"at"}),...this.go(e.simple_token)]}dir_away(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"away"}),...this.go(e.simple_token)]}dir_toward(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"toward"}),...this.go(e.simple_token)]}dir_find(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"find"}),...this.go(e.kind)]}dir_flee(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"flee"}),...this.go(e.kind)]}dir_to(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"to"}),...this.go(e.dir)]}dir_within(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"within"}),...this.go(e.simple_token)]}dir_awayby(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"awayby"}),...this.go(e.simple_token)]}dir(e,t){const r=this.go(e.dir_mod)??[];return e.token_i&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"i"})),e.token_idle&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"idle"})),e.token_n&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"n"})),e.token_u&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"u"})),e.token_north&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"north"})),e.token_up&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"up"})),e.token_s&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"s"})),e.token_d&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"d"})),e.token_south&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"south"})),e.token_down&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"down"})),e.token_w&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"w"})),e.token_l&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"l"})),e.token_west&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"west"})),e.token_left&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"left"})),e.token_e&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"e"})),e.token_r&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"r"})),e.token_east&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"east"})),e.token_right&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"right"})),e.token_rnd&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rnd"})),e.token_rndne&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rndne"})),e.token_rndns&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"rndns"})),e.token_flow&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"flow"})),e.token_seek&&r.push(...this.createcodenode(t,{type:12,literal:1,value:"seek"})),e.dir_by&&r.push(...this.go(e.dir_by)),e.dir_at&&r.push(...this.go(e.dir_at)),e.dir_away&&r.push(...this.go(e.dir_away)),e.dir_toward&&r.push(...this.go(e.dir_toward)),e.dir_find&&r.push(...this.go(e.dir_find)),e.dir_flee&&r.push(...this.go(e.dir_flee)),e.dir_to&&r.push(...this.go(e.dir_to)),r.flat()}expr_any(e){return[this.go(e.dir),this.go(e.kind),this.go(e.color)].flat()}token_expr_any(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"any"}),this.go(e.expr_any)].flat()}token_expr_count(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"countof"}),this.go(e.expr_any)].flat()}token_expr_blocked(e,t){return[this.createcodenode(t,{type:12,literal:1,value:"blocked"}),this.go(e.dir)].flat()}token_expr_abs(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"abs"}),...this.go(e.simple_token)]}token_expr_intceil(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intceil"}),...this.go(e.simple_token)]}token_expr_intfloor(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intfloor"}),...this.go(e.simple_token)]}token_expr_intround(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"intround"}),...this.go(e.simple_token)]}token_expr_clamp(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"clamp"}),...this.go(e.simple_token)]}token_expr_min(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"min"}),...this.go(e.simple_token)]}token_expr_max(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"max"}),...this.go(e.simple_token)]}token_expr_pick(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"pick"}),...this.go(e.simple_token)]}token_expr_pickwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"pickwith"}),...this.go(e.simple_token)]}token_expr_random(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"random"}),...this.go(e.simple_token)]}token_expr_randomwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"randomwith"}),...this.go(e.simple_token)]}token_expr_run(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"run"}),...this.go(e.string_token)]}token_expr_runwith(e,t){return[...this.createcodenode(t,{type:12,literal:1,value:"runwith"}),...this.go(e.simple_token),...this.go(e.string_token)]}token_expr(e,t){return e.token_expr_aligned?this.createcodenode(t,{type:12,literal:1,value:"aligned"}):e.token_contact?this.createcodenode(t,{type:12,literal:1,value:"contact"}):e.token_expr_any?this.go(e.token_expr_any):e.token_expr_count?this.go(e.token_expr_count):e.token_expr_blocked?this.go(e.token_expr_blocked):e.token_expr_abs?this.go(e.token_expr_abs):e.token_expr_intceil?this.go(e.token_expr_intceil):e.token_expr_intfloor?this.go(e.token_expr_intfloor):e.token_expr_intround?this.go(e.token_expr_intround):e.token_expr_clamp?this.go(e.token_expr_clamp):e.token_expr_min?this.go(e.token_expr_min):e.token_expr_max?this.go(e.token_expr_max):e.token_expr_pick?this.go(e.token_expr_pick):e.token_expr_pickwith?this.go(e.token_expr_pickwith):e.token_expr_random?this.go(e.token_expr_random):e.token_expr_randomwith?this.go(e.token_expr_randomwith):e.token_expr_run?this.go(e.token_expr_run):e.token_expr_runwith?this.go(e.token_expr_runwith):[]}string_token(e,t){if(e.token_stringliteraldouble){const r=Bu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=Bu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}return[]}simple_token(e,t){if(e.token_stringliteraldouble){const r=Bu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=Bu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_numberliteral){const r=parseFloat(Bu(e.token_numberliteral,"0"));return this.createcodenode(t,{type:12,literal:0,value:r})}return e.color?this.go(e.color):[]}token(e,t){if(e.category)return this.go(e.category);if(e.collision)return this.go(e.collision);if(e.color)return this.go(e.color);if(e.dir)return this.go(e.dir);if(e.command_play)return this.go(e.command_play);if(e.command_toast)return this.go(e.command_toast);if(e.command_ticker)return this.go(e.command_ticker);if(e.token_label){const r=Bu(e.token_label,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_stringliteraldouble){const r=Bu(e.token_stringliteraldouble,"");return this.createcodenode(t,{type:12,literal:2,value:r})}if(e.token_stringliteral){const r=Bu(e.token_stringliteral,"");return this.createcodenode(t,{type:12,literal:1,value:r})}if(e.token_numberliteral){const r=parseFloat(Bu(e.token_numberliteral,"0"));return this.createcodenode(t,{type:12,literal:0,value:r})}if(e.token_lparen)return[this.createexprnodeondemand(this.go(e.expr),t)];if(e.token_stop){const r=Bu(e.token_stop,"");return this.createcodenode(t,{type:12,literal:1,value:r})}return[]}}const ZJe=new KJe,Mm={labels:{},internal:0,lineindex:0,linelookup:{},isfirststat:!1},CU="zss.js";function ba(n,e){return new $Je.SourceNode(n.startLine??1,n.startColumn??1,CU,e)}function E9(n){return n.replace(/\\/g,"\\\\").replace(/'/g,"\\'")}function nN(n){return`'${E9(n)}'`}function z8(n){const e=EO(n);return e.errors.length?n:`['${e.tokens.map(r=>{if(r.tokenType===pU){const i=E9(r.image.substring(1));return qr(i)==="center"?"$CENTER":`', api.get('${i}'), '`}return E9(r.image)}).join("")}'].join('')`}function DM(n){return n.filter(e=>e!==void 0).map(Xa)}function ene(n){return ba(n,"")}function QJe(n,e){const t=[];return n.forEach(r=>{t.push(r,e)}),t.pop(),t}function Vf(n,e,t){return ba(n,[`api.${e}(`,...QJe(t,", "),")"])}function JJe(n){if(n.type===ir.COMPARE&&n.compare.type===ir.COMPARE_ITEM)switch(n.compare.method){case BS.IS_EQ:return Vf(n,"isEq",[Xa(n.lhs),Xa(n.rhs)]);case BS.IS_NOT_EQ:return Vf(n,"isNotEq",[Xa(n.lhs),Xa(n.rhs)]);case BS.IS_LESS_THAN:return Vf(n,"isLessThan",[Xa(n.lhs),Xa(n.rhs)]);case BS.IS_GREATER_THAN:return Vf(n,"isGreaterThan",[Xa(n.lhs),Xa(n.rhs)]);case BS.IS_LESS_THAN_OR_EQ:return Vf(n,"isLessThanOrEq",[Xa(n.lhs),Xa(n.rhs)]);case BS.IS_GREATER_THAN_OR_EQ:return Vf(n,"isGreaterThanOrEq",[Xa(n.lhs),Xa(n.rhs)])}return ba(n,"")}function ES(n,e,t){return n.prepend(`api.${e}(`),n.add([", ",Xa(t),")"])}function tne(n,e,t){return n.prepend(`api.${e}(`),n.add([Xa(t),")"])}function eet(n,e){if(n.type===ir.OPERATOR_ITEM)switch(n.operator){case lv.PLUS:return ES(e,"opPlus",n.rhs);case lv.MINUS:return ES(e,"opMinus",n.rhs);case lv.POWER:return ES(e,"opPower",n.rhs);case lv.MULTIPLY:return ES(e,"opMultiply",n.rhs);case lv.DIVIDE:return ES(e,"opDivide",n.rhs);case lv.MOD_DIVIDE:return ES(e,"opModDivide",n.rhs);case lv.FLOOR_DIVIDE:return ES(e,"opFloorDivide",n.rhs);case lv.UNI_PLUS:return tne(e,"opUniPlus",n.rhs);case lv.UNI_MINUS:return tne(e,"opUniMinus",n.rhs)}return ba(n,"")}function tet(n){if(n.type===ir.OPERATOR){const e=n.lhs?Xa(n.lhs):ba(n,"");return n.items.forEach(t=>eet(t,e)),e}return ba(n,"")}function rN(n,e){return ba(n,[Vf(n,"jump",[`${e}`]),"; continue;"])}function wy(n){return Mm.linelookup[n??""]??-1}function x9(n,e){Mm.linelookup[n]=e}function sT(n,e,t){for(let r=0;r<n.length;++r){const i=n[r];switch(i.type){case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.ELSE_IF:i.type===e&&(i.done=t);break;case ir.IF_BLOCK:case ir.IF_CHECK:i.type===e&&(i.skip=t);break;case ir.LINE:sT(i.stmts,e,t);break}}}function uge(n,e,t){for(let r=0;r<n.length;++r){const i=n[r];switch(i.type){case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.ELSE_IF:i.type===e&&x9(i.done,t);break;case ir.IF_BLOCK:case ir.IF_CHECK:i.type===e&&x9(i.skip,t);break;case ir.LINE:uge(i.stmts,e,t);break}}}function Xa(n){switch(n.type){case ir.PROGRAM:return ba(n,[`try { // first-line
`,`while (true) {
`,`if (api.sy()) { return 1; }
`,`switch (api.getcase()) {
`,...n.lines.map(Xa).flat(),`default:
`,`  return 0;
`,`}
`,`api.nextcase();
`,`} // end of logic
`,`} catch (e) {
`,`console.error(e);
`,`const source = api.stacktrace(e);
`,`const err = new Error(e.message);
`,`err.name = 'GameError';
`,`err.meta = { line: source.line, column: source.column };
`,`throw err;
`,`}
`,`//# sourceURL=${CU}`]);case ir.API:return ba(n,["  ",Vf(n,n.method,DM(n.words)),`;
`]);case ir.LINE:return ba(n,[`case ${n.lineindex}:
`,...n.stmts.map(Xa).flat(),`  break;
`]);case ir.MARK:return ba(n,`  // ${n.comment}
`);case ir.GOTO:{const e=wy(n.id);return ba(n,["  ",rN(n,e),`
`])}case ir.COUNT:return ba(n,`${n.index}`);case ir.LITERAL:switch(n.literal){case nP.NUMBER:return ba(n,`${n.value}`);case nP.STRING:return ba(n,nN(n.value));case nP.TEMPLATE:return ba(n,z8(n.value))}return ene(n);case ir.TEXT:return ba(n,["  ",Vf(n,"text",[z8(n.value)]),`;
`]);case ir.STAT:if(Mm.isfirststat){Mm.isfirststat=!1;const e=n.value.trim().split(" ").map(nN);return ba(n,["  ",Vf(n,"stat",e),`;
`])}return ba(n,`  // skipped ${n.value}
`);case ir.LABEL:{const e=qr(n.name),t=n.active?"label":"comment";Mm.labels[e]||(Mm.labels[e]=[]);const r=(n.active?1:-1)*n.lineindex;return Mm.labels[e].push(r),ba(n,`  // ${r} '${e}' ${t}
`)}case ir.HYPERLINK:return ba(n,["  ",Vf(n,"hyperlink",[z8(n.text),...n.link.split(" ").filter(e=>e.length>0).map(nN)]),`;
`]);case ir.MOVE:{const e=Vf(n,"command",[nN("go"),DM(n.words)].flat());return n.wait?ba(n,["  if (",e,`) { continue; };
`]):ba(n,["  ",e,`;
`])}case ir.COMMAND:return ba(n,["  if (",Vf(n,"command",DM(n.words)),`) { continue; };
`]);case ir.IF:{const e=n.block?.type===ir.IF_BLOCK?n.block:void 0;if(xe(e)){sT([n.check],ir.IF_CHECK,e.skip);const t=ba(n,Xa(n.check));return e.lines.forEach(r=>t.add(Xa(r))),uge(e.altlines,ir.ELSE_IF,wy(e.done)),e.altlines.forEach(r=>t.add(Xa(r))),t}return ba(n,Xa(n.check))}case ir.IF_CHECK:{const e=wy(n.skip);return e===-1?ba(n,["  ",Vf(n,n.method,DM(n.words)),`;
`]):ba(n,["  if (!",Vf(n,n.method,DM(n.words)),") { ",rN(n,e),` }
`])}case ir.ELSE_IF:case ir.ELSE:{const e=ba(n,"");return n.lines.forEach(t=>e.add(Xa(t))),e}case ir.WHILE:{const e=wy(n.loop),t=wy(n.done),r=ba(n,"");return sT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Xa(i))}),r}case ir.REPEAT:{const e=wy(n.loop),t=wy(n.done),r=ba(n,"");return sT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Xa(i))}),r}case ir.WAITFOR:{const e=ba(n,"");return sT(n.lines,ir.IF_CHECK,n.loop),n.lines.forEach(t=>{e.add(Xa(t))}),e}case ir.FOREACH:{const e=wy(n.loop),t=wy(n.done),r=ba(n,"");return sT(n.lines,ir.IF_CHECK,n.done),n.lines.forEach(i=>{switch(i.type){case ir.BREAK:i.goto=t;break;case ir.CONTINUE:i.goto=e;break}r.add(Xa(i))}),r}case ir.BREAK:return ba(n,["  ",rN(n,n.goto),`
`]);case ir.CONTINUE:return ba(n,["  ",rN(n,n.goto),`
`]);case ir.OR:return Vf(n,"or",n.items.map(Xa));case ir.AND:return Vf(n,"and",n.items.map(Xa));case ir.NOT:return Vf(n,"not",n.items.map(Xa));case ir.COMPARE:return JJe(n);case ir.OPERATOR:return tet(n);case ir.EXPR:return Vf(n,"expr",n.words.map(Xa));default:return console.error("<unsupported node>",n.type,n),ene(n)}}function cv(n){if(xe(n))switch(n.type===ir.LINE&&++Mm.lineindex,n.lineindex=Mm.lineindex,n.type){case ir.PROGRAM:n.lines.forEach(cv);break;case ir.LINE:n.stmts.forEach(cv);break;case ir.MARK:x9(n.id,n.lineindex);break;case ir.IF:cv(n.check),cv(n.block);break;case ir.IF_BLOCK:n.lines.forEach(cv),n.altlines.forEach(cv);break;case ir.ELSE_IF:n.lines.forEach(cv);break;case ir.ELSE:case ir.WHILE:case ir.REPEAT:case ir.FOREACH:case ir.WAITFOR:n.lines.forEach(cv);break;case ir.MOVE:case ir.COMMAND:case ir.IF_CHECK:n.words.forEach(cv);break}}function fge(n){Mm.labels={},Mm.internal=1,Mm.lineindex=0,Mm.isfirststat=!0,cv(n)}function net(n){return fge(n),{...Xa(n).toStringWithSourceMap({file:`${CU}.map`}),...Mm}}function nne(n){return bi(n)?n.length>0?1:0:n??0}function ret(n){return`${n}_chip`}function hge(n=""){return`vm:${n??""}`}function iet(n,e,t){const r=ret(n),i=g1(r);let s;const a=Sl(Object.entries(t.labels??{}));(!bi(i.lb)||i.lb.length!==a.length)&&(i.lb=a,i.lk="",i.mg=void 0,i.ec=1,i.lc=0,i.ys=0,i.ps=0,i.es=(t.errors?.length??0)!==0?1:0);function o(c,u){Oe.words=u;const f=ZQe(e,c);return xe(f)?f(l,u):c!=="send"?o("shortsend",[c,...u]):0}const l={halt(){het(r)},id(){return n},set(c,u){const[f,d]=JQe(e,l,c,u);if(f)return d},get(c){const[u,f]=QQe(e,l,c);if(u)return f},tick(c){const u=Mn(i.ps)?i.ps:0,f=u%c===0;if(i.ps=u+1,f===!1)return!1;eJe(e,l);const d=l.shouldtick();if(d){i.lc=0,i.ys=0,Oe.get=l.get;try{s?.(l)||(i.es=1)}catch(g){Si(xt,Oe.elementfocus,"crash",g.message),i.es=1}}return tJe(e,l),d},isended(){return i.es===1},isfirstpulse(){return i.ps===1},shouldtick(){return i.es===0||l.hm()!==0},shouldhalt(){return Mn(i.lc)?++i.lc>Gn.HALT_AT_COUNT:!0},haslabel(c){if(bi(i.lb))for(let u=0;u<i.lb.length;++u){const[f,d]=i.lb[u];if(f===c)return(d.find(p=>Mn(p)&&p>0)??0)>0}return!1},hm(){if(bi(i.mg)&&bi(i.lb)){const[c]=i.mg;if(xe(c))for(let u=0;u<i.lb.length;++u){const[f,d]=i.lb[u];if(f===c)return d.find(g=>Mn(g)&&g>0)??0}}return 0},yield(){i.ys=1},jump(c){i.ec=c},sy(){return!!i.ys||l.shouldhalt()},send(c,u,f,d){xt.emit(c,`${hge(u)}:${f}`,d)},lock(c){i.lk=c},unlock(){i.lk=""},message(c){i.lk&&c.sender!==i.lk||l.haslabel(c.target)&&(i.mg=[c.target,c.data,c.sender,c.player])},zap(c){if(bi(i.lb))for(let u=0;u<i.lb.length;++u){const f=i.lb[u];if(f[0]===c){const d=f[1].findIndex(g=>g>0);if(d>=0&&xe(f[1])){f[1][d]*=-1;break}}}},restore(c){if(bi(i.lb))for(let u=0;u<i.lb.length;++u){const f=i.lb[u];if(f[0]===c)for(let d=0;d<f[1].length;d++)f[1][d]=Math.abs(f[1][d])}},getcase(){i.ec=Mn(i.ec)?i.ec:1;const c=l.hm();if(c&&bi(i.mg)){const[,u,f,d]=i.mg;l.set("sender",f),xe(u)&&l.set("arg",u),d&&(l.set("player",d),Oe.elementfocus=d),i.mg=void 0,i.ys=0,i.es=0,i.ec=c}return i.ec},nextcase(){const c=Mn(i.ec)?i.ec:1;return i.ec=c+1,i.ec},endofprogram(){l.yield(),i.es=1},stacktrace(c){const u=lBe.parse(c),[f]=u.filter(d=>d.fileName===CU);return{line:f?.lineNumber??0,column:f?.columnNumber??0}},text(c){return o("text",[c])},stat(...c){return o("stat",c)},hyperlink(...c){return o("hyperlink",c)},command(...c){if(c.length===0)return 0;const[u,...f]=c;return o(qr(pu(u)),f)},if(...c){const[u,f]=ln(c,0,[Dt.ANY]),d=nne(u);return d&&f<c.length&&l.command(...c.slice(f)),d?1:0},try(...c){const[,u]=ln(c,0,[Dt.DIR]),f=l.command("go",...c);return f&&u<c.length&&l.command(...c.slice(u)),f?1:0},take(...c){const[u,f,d]=ln(c,0,[Dt.NAME,Dt.ANY]),g=Mn(f),p=g?d:1,_=l.get(u),y=g?f:1;if(!Mn(_))return p<c.length&&l.command(...c.slice(p)),1;const v=_-y;return v<0?(p<c.length&&l.command(...c.slice(p)),1):(l.set(u,v),0)},give(...c){const[u,f,d]=ln(c,0,[Dt.NAME,Dt.ANY]),g=Mn(f),p=g?d:1,_=l.get(u),y=g?f:1,v=_===void 0?1:0;return v&&p<c.length&&l.command(...c.slice(p)),l.set(u,vd(_,0)+y),v},duplicate(...c){return l.command("duplicate",...c)},repeatstart(c,...u){const[f,d]=ln(u,0,[Dt.NUMBER]),g=`repeatcount${c}`,p=`repeatwords${c}`;i[g]=f,i[p]=d<u.length?u.slice(d):void 0},repeat(c){const u=`repeatcount${c}`,f=`repeatwords${c}`;if(!Mn(i[u]))return 0;const d=i[u];i[u]=d-1;const g=d>0,p=i[f];return g&&bi(p)&&l.command(...p),g?1:0},foreachstart(c,...u){const[f,d,g,p]=ln(u,0,[Dt.NAME,Dt.NUMBER,Dt.NUMBER,Dt.MAYBE_NUMBER]);let _=Math.min(d,g),y=Math.max(d,g);const v=(p??0)||1;if(v<0){const x=_;_=y,y=x}return l.set(f,_-v),0},foreach(c,...u){const[f,d,g,p,_]=ln(u,0,[Dt.NAME,Dt.NUMBER,Dt.NUMBER,Dt.MAYBE_NUMBER]);let y=Math.min(d,g),v=Math.max(d,g);const x=(p??0)||1;if(x<0){const O=y;y=v,v=O}let E=l.get(f);!Mn(E)||E<y||E>v?E=y:E+=x;const M=E<=v?1:0;return M&&(l.set(f,E),_<u.length&&l.command(...u.slice(_))),M},waitfor(...c){const[u]=ln(c,0,[Dt.ANY]),f=nne(u);return f||l.yield(),f?1:0},or(...c){let u=0;for(let f=0;f<c.length;){const[d,g]=ln(c,f,[Dt.ANY]);if(u=d,u)break;f=g}return u},and(...c){let u=0;for(let f=0;f<c.length;){const[d,g]=ln(c,f,[Dt.ANY]);if(u=d,!u)break;f=g}return u},not(...c){const[u]=ln(c,0,[Dt.ANY]);return u?0:1},expr(...c){const[u]=ln(c,0,[Dt.ANY]);return u},isEq(c,u){const[f]=ln([c],0,[Dt.ANY]),[d]=ln([u],0,[Dt.ANY]);return typeof f=="object"||typeof d=="object"?Jb(f,d)?1:0:f===d?1:0},isNotEq(c,u){return this.isEq(c,u)?0:1},isLessThan(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f<d?1:0},isGreaterThan(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f>d?1:0},isLessThanOrEq(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f<=d?1:0},isGreaterThanOrEq(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f>=d?1:0},opPlus(c,u){const[f]=ln([c],0,[Dt.ANY]),[d]=ln([u],0,[Dt.ANY]);return f+d},opMinus(c,u){const[f]=ln([c],0,[Dt.ANY]),[d]=ln([u],0,[Dt.ANY]);return f-d},opPower(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return Math.pow(f,d)},opMultiply(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f*d},opDivide(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f/d},opModDivide(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return f%d},opFloorDivide(c,u){const[f]=ln([c],0,[Dt.NUMBER]),[d]=ln([u],0,[Dt.NUMBER]);return Math.floor(f/d)},opUniPlus(c){const[u]=ln([c],0,[Dt.NUMBER]);return+u},opUniMinus(c){const[u]=ln([c],0,[Dt.NUMBER]);return-u}};return s=t.code,l}function T9(n){if(!n||n.type===void 0)return;const e=[{start:n.startOffset,end:n.endOffset??0}];return Object.keys(n).forEach(t=>{if(t!=="parent"){const r=n[t];bi(r)?r.forEach(i=>{e.push(T9(i))}):e.push(T9(r))}}),n.range={start:Math.min(...e.filter(t=>t).map(t=>t?.start??0)),end:Math.max(...e.filter(t=>t).map(t=>t?.end??0))},n.range}function dge(n){const e=xpe(`${n}
`);if(e.errors.length>0)return e;vT.input=e.tokens;const t=vT.program();if(vT.errors.length>0)return{tokens:e.tokens,errors:vT.errors.map(i=>({offset:i.token.startOffset,line:i.token.startLine,column:i.token.startColumn,length:i.token.image.length,message:i.message}))};const[r]=ZJe.go(t);return r?(T9(r),{tokens:e.tokens,cst:t,ast:r}):{tokens:e.tokens,cst:t,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]}}function set(n,e){const t=`compile-${n}`;console.time(t);const r=dge(e);if(console.timeEnd(t),gQ&&console.info(e,r.errors),r.errors&&r.errors.length>0)return console.info(e,r.tokens,r.errors),r;if(!r.ast)return{...r,errors:[{message:"no ast output",offset:0,line:0,column:0,length:0}]};const i=net(r.ast);if(i.code){gQ&&console.info(i.code);try{return{...r,...i,source:i.code,code:new Function("api",i.code)}}catch(s){return{errors:[{message:`unexpected error ${s.message}`,offset:0,line:0,column:0,length:0}],source:"",code:new Function("api"," ")}}}return{...r,...i,source:"",code:new Function("api"," ")}}function aet(){const n={},e={};function t(i,s){const a=n[s];if(a)return a;const o=set(i,s);return n[s]=o,o}const r={ids(){return Object.keys(e)},isended(i){const s=e[i];return xe(s)?s.isended():!0},halt(i){const s=e[i];return xe(s)&&(s.halt(),delete e[i]),!!s},gc(){const i=r.ids();for(let s=0;s<i.length;++s)r.isended(i[s])&&r.halt(i[s])},arg(i,s){const a=e[i];xe(a)&&a.set("arg",s)},tick(i,s,a,o,l){let c=e[i];if(!xe(e[i])){const u=t(o,l);if(c=e[i]=iet(i,s,u),u.errors?.length){const[f]=u.errors,d=(f?.line??2)-1,g=l.replaceAll(`\r
`,"").split(`
`).map((E,M)=>[E,M]),p=g.slice(d-2,d);for(let E=0;E<p.length;++E){const[M,O]=p[E];Si(xt,yT(),"build",`$grey${O+1} $grey${M}`)}const[_,y]=g[d]??[];if(Vn(_)&&xe(y)){const E=(f.column??1)-1,M=E+f.length,O=E<_.length?_:`${_}*`,N=O.substring(0,E),I=O.substring(E,M),D=O.substring(M);Si(xt,yT(),"build",`$red${y+1} $grey${N}$red${I}$grey${D}`)}const v=g.slice(d+1,d+3);for(let E=0;E<v.length;++E){const[M,O]=v[E];Si(xt,yT(),"build",`$grey${O+1} $grey${M}`)}const x=f.message.split(`
`).slice(0,4).join(" ");return Si(xt,yT(),"build",x),!1}}return!!c?.tick(a)},once(i,s,a,o){const l=r.tick(i,s,1,a,o);return r.halt(i)&&l},message(i){const{target:s,path:a}=EE(i.target),o=e[s];if(xe(o)){const l={...i,target:a};o.message(l)}}};return r}new an;const yq=aet();var b0=(n=>(n.MAIN="main",n.TITLE="title",n.PLAYER="player",n.GADGETSTORE="gadgetstore",n))(b0||{});const Y0={session:vc(),operator:"",software:{main:"",content:""},books:new Map};function yT(){return Y0.operator}function Py(){return[...Y0.books.values()]}function oet(){const[n]=Y0.books.values();return n}function Fy(n){const e=qr(n);return Y0.books.get(n)??Py().find(t=>t.name===e)}function pge(n,e){xe(Fy(e))&&(Y0.software[n]=e)}function Av(n){return Fy(Y0.software[n])}function mge(n){const e=Rpe([]);return Vn(n)&&(e.name=n),gge(e),xs(xt,Y0.operator,`created [book] ${e.name}`),e}function cet(n){let e=Fy(n);return xe(e)||(e=Rpe([]),e.name=n),gge(e),xs(xt,Y0.operator,`created [book] ${e.name}`),e}function m1(n,e){let t=xe(e)?cet(e):Av(n);return xe(t)||(xe(t)||(t=oet()),xe(t)||(t=mge(e)),xe(t)&&xs(xt,Y0.operator,`opened [book] ${t.name} for ${n}`)),pge(n,t.id),t}function uet(n,e,t){return i9(m1(n),t,e)}function M_(n,e){const t=Av("main"),r=T0(s9(t,n,e));if(xe(r))return r;const i=Py();for(let s=0;s<i.length;++s){const a=i[s];if(a.id!==t?.id){const o=T0(s9(a,n,e));if(xe(o))return o}}}function O1(n){if(xe(n?.kinddata))return n.kinddata;if(!Vn(n?.kind)||!n.kind)return;const e=M_(ni.OBJECT,n.kind);if(xe(e))return n.kinddata=Jf(e),n.kinddata;const t=M_(ni.TERRAIN,n.kind);if(xe(t))return n.kinddata=Jf(t),n.kinddata}function $i(n,e){const t=n?.kinddata,r=t?.id??"",i=n?.[e];if(xe(i))return i;const s=t?.[e];if(xe(s))return s;const a=M_(ni.OBJECT,r)??M_(ni.TERRAIN,r),o=fVe(a,e);if(xe(o))return o;switch(e){case"group":return"";case"cycle":return Z6e;case"p1":case"p2":case"p3":case"p4":case"p5":case"p6":case"p7":case"p8":case"p9":case"p10":case"item":case"pushable":case"breakable":return 0;case"collision":return Rr.ISWALK;default:return}}function w9(n,e){const t={x:n?.x??-1,y:n?.y??-1},r={x:e?.x??-1,y:e?.y??-1},i=dv(t,r),s=$i(e,"pushable");return Mn(s)?s!==0:Vn(s)?s.trim().split(" ").map(a=>pue(U4(a))).some(a=>a===i):!1}function D0(n,e,t,r){if(!xe(n)||!xe(e))return;const[i,s]=e,a=M_(ni.OBJECT,i);if(xe(a)){const l=Ipe(n,t,i,r);if(xe(l))return mk(l,s),O1(l),$i(l,"collision")!==Rr.ISGHOST&&(Ope(n,l),l9(n,l)),l}const o=M_(ni.TERRAIN,i);if(xe(o)){const l=SVe(n,t,i);if(xe(l)){mk(l,s),O1(l);const c=gf(t,Yn);return l9(n,l,c),l}}}function fet(n,e,t){if(!xe(n)||!xe(e))return;const[r,i]=e,s=M_(ni.OBJECT,r);if(xe(s)){const a=Ipe(n,t,r);return mk(a,i),a}}function Pp(n){const e=M_(ni.BOARD,n);return Jf(e)}function g1(n){const e=m1("main");return iU(e,n)}function rne(){const n=m1("main");return iU(n,"main")}function het(n){const e=m1("main");return pVe(e,n)}function gge(n){return Y0.books.set(n.id,n),n.id}function det(n){const e=Fy(n);e&&Y0.books.delete(e.id)}function pet(n){const e=Av("main"),t=QD(e,n,"board"),r=M_(ni.BOARD,t);return Jf(r)}function zu(n,e,t,r){if(Vn(t.id))if(Vn(e.id))pY(xt,n,e.id,t.id,r);else{const i=`${gf({x:e.x??0,y:e.y??0},Yn)}`;pY(xt,n,i,t.id,r)}}function met(n,e,t,r){const i=t.id??"";if(r.x<0){const s=Pp(e?.exitwest??"");xe(s)&&_T(n,i,s.id,{x:Yn-1,y:r.y})}else if(r.x>=Yn){const s=Pp(e?.exiteast??"");xe(s)&&_T(n,i,s.id,{x:0,y:r.y})}else if(r.y<0){const s=Pp(e?.exitnorth??"");xe(s)&&_T(n,i,s.id,{x:r.x,y:Ti-1})}else if(r.y>=Ti){const s=Pp(e?.exitsouth??"");xe(s)&&_T(n,i,s.id,{x:r.x,y:0})}}function ine(n,e,t,r){const i=QD(n,r,"enterx"),s=QD(n,r,"entery");Mn(i)&&Mn(s)&&xe(t)&&c9(e,t,{x:i,y:s})}function S_(n,e,t,r,i={}){if(!xe(t?.id))return!1;let s=c9(e,t,r);const a=$i(t,"collision");if(xe(s)&&a!==Rr.ISBULLET){const o=x0(t?.id),l=!!$i(s,"item"),c=w9(t,s),u=s.id??"";if(c&&(!o||!l)&&!i[u]){i[u]=!0;const f=dv({x:t.x??0,y:t.y??0},r),d=uu({x:s.x??0,y:s.y??0},f);S_(n,e,s,d)}s=c9(e,t,r)}if(xe(s)){const o=x0(t.id),l=x0(t.party??t.id),c=$i(t,"collision")===Rr.ISBULLET,u=t.kind??"";let f="";t.party&&l&&(f=t.party),o&&(f=t.id);const d=x0(s.id),g=x0(s.party??s.id),p=$i(s,"collision")===Rr.ISBULLET,_=s.kind??"",y=l===g;let v="";if(s.party&&g&&(v=s.party),d&&(v=s.id??""),o&&_==="edge")met(n,e,t,r);else if(o)d?(zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,"bump")):p?(e?.restartonzap&&ine(n,e,t,f),zu(y?"":v,s,t,y?"partyshot":"shot"),zu(f,t,s,"thud")):(zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,"touch"));else if(c)if(d)e?.restartonzap&&ine(n,e,s,v),zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,y?"partyshot":"shot");else if(p)zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,"thud");else switch(zu(y?"":v,s,t,"thud"),_){case"object":case"scroll":zu(y?"":f,t,s,"shot");break;default:zu(y?"":f,t,s,y?"partyshot":"shot");break}else if(d)zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,"bump");else if(p){switch(u){case"object":case"scroll":zu(y?"":f,t,s,"shot");break;default:zu(y?"":f,t,s,y?"partyshot":"shot");break}zu(y?"":f,t,s,"thud")}else zu(y?"":v,s,t,"thud"),zu(y?"":f,t,s,"bump");if(c&&$i(s,"breakable"))if(xe(s?.id)){const x=Jo(e,{x:s.x??-1,y:s.y??-1});xe(x)&&Bg(Oe.board,x,Oe.timestamp)}else Ed(e,{x:r.x,y:r.y});return!1}return!0}function get(n,e,t,r){if(!xe(n)||!xe(e)||!xe(t))return;const i={...Oe};Oe.book=n,Oe.board=e,Oe.element=t,Oe.elementid=t.id??"",Oe.elementisplayer=x0(Oe.elementid);const s=Oe.element.player??Y0.operator;Oe.elementfocus=Oe.elementisplayer?Oe.elementid:s;const a=$i(t,"cycle"),o=t.id??"",l=qr(t.name??t.kinddata?.name??"");if(yq.tick(o,mq.RUNTIME,a,l,r),Mn(t?.tickertime)&&Oe.timestamp-t.tickertime>D4*5&&(t.tickertime=0,t.tickertext=""),Oe.elementisplayer){const c=g1(Oe.elementid);Mn(c.inputcurrent)&&(c.inputcurrent=0)}sb(i).forEach(c=>{Oe[c]=i[c]})}function _et(n){yq.halt(n)}function fL(n,e,t,r){const i=Av("main");if(!xe(i))return;function s(a){for(let o=0;o<a.length;++o){const l=a[o];if(xe(l.id)){const c=`${hge(l.id)}:${e}`;xt.emit("",c,t)}}}if(aE(n)){for(let a=0;a<r.length;++a){const o=r[a],l=Jo(o,n);xe(l)&&s([l])}return}for(let a=0;a<r.length;++a){const o=r[a];switch(qr(n)){case"all":case"self":case"others":{s(Object.values(o.objects));break}default:{s(Mpe(o,[n]));break}}}}function hL(n){const e=m1("main"),t=gk(e,n);if(!xe(e)||!xe(t)||!xe(Oe.element))return;const r={...Oe},i=`${n}_run`,s=qr(Oe.element.name??Oe.element.kinddata?.name??""),a=t?.code??"";yq.once(i,mq.RUNTIME,s,a),sb(r).forEach(o=>{Oe[o]=r[o]})}async function _ge(n){const e=new FormData;e.append("url",n);const t=new Request("https://bytes.zed.cafe",{method:"POST",body:e});return await(await fetch(t)).text()}function vge(){return window.location.href.includes("/join/")}function dL(){return window.location.href.includes("/locked/")}const vet=n=>n;function bq(n,e=vet){const t=Og.useSyncExternalStore(n.subscribe,Og.useCallback(()=>e(n.getState()),[n,e]),Og.useCallback(()=>e(n.getInitialState()),[n,e]));return Og.useDebugValue(t),t}const sne=n=>{const e=w4(n),t=r=>bq(e,r);return Object.assign(t,e),t},X1=n=>n?sne(n):sne;function ane(n){const e=it.useRef(null);return t=>{const r=n(t);return(e.current===void 0||r===void 0?e.current===r:Jb(e.current,r))?e.current:e.current=r}}const Ts=X1(()=>({desync:!1,zsswords:{cli:[],loader:[],runtime:[],flags:[],stats:[],kinds:[],altkinds:[],colors:[],dirs:[],dirmods:[],exprs:[]},gadget:{id:"",board:"",layers:[],tickers:[],scrollname:"",scroll:[],sidebar:[]},slim:[]}));var A0=(n=>(n[n.TOP=0]="TOP",n[n.FULL=1]="FULL",n[n.BOTTOM=2]="BOTTOM",n[n.SPLIT_X=3]="SPLIT_X",n[n.MAX=4]="MAX",n))(A0||{});const ao=X1(n=>({layout:0,inspector:dL(),quickterminal:!1,toast:"",terminal:{open:!0,info:[],logs:[]},editor:{open:!1,book:"",path:[],type:"",title:""},reset(){n({layout:0,inspector:dL(),quickterminal:!1,toast:"",terminal:{open:!0,info:[],logs:[]},editor:{open:!1,book:"",path:[],type:"",title:""}})}})),Ko=X1(n=>({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""],reset(){n({scroll:0,xcursor:0,ycursor:0,xselect:void 0,yselect:void 0,bufferindex:0,buffer:[""]})}})),_c=X1(n=>({xscroll:0,yscroll:0,cursor:0,select:void 0,reset(){n({xscroll:0,yscroll:0,cursor:0,select:void 0})}})),FS=X1(n=>({cursor:void 0,select:void 0,reset(){n({cursor:void 0,select:void 0})}}));function yge(n){return n.generateMipmaps=!1,n.minFilter=bf,n.magFilter=bf,n.needsUpdate=!0,n}function mv(n){if(xe(n))return yge(new Mae(LBe(n)))}const kO=it.createContext(yb(1,1,15,1));function Fh(){return it.useContext(kO)}const bge=X1(()=>({blink:!1}));setInterval(()=>{bge.setState(n=>({blink:!n.blink}))},333);function Wg(){return bge(n=>n.blink)}function Sge(){return w4(n=>{function e(){n(t=>({render:t.render+1}))}return{dither:[],render:0,changed(){queueMicrotask(e)}}})}function yet(n){n.fill(0)}function j8(n,e,t,r,i,s){if(r<0||r>=e||i<0||i>=t)return-1;n[r+i*e]=s}const Ege=it.createContext(Sge());function bet(n,e,t){const[r]=it.useState(()=>Sge()),i=n*e,s=r.getState();return s.dither.length!==i&&(s.dither=new Array(i).fill(t),s.render=0),r}function xge(){return w4(n=>{function e(){n(t=>({render:t.render+1}))}return{width:0,height:0,char:[],color:[],bg:[],render:0,changed(){queueMicrotask(e)}}})}function MU(n,e,t,r){n.char.fill(e),n.color.fill(t),n.bg.fill(r)}function Hu(n,e,t,r,i,s){if(r<0||r>=e||i<0||i>=t)return;const a=r+i*e;sb(s).forEach(o=>{const l=s[o];xe(l)&&(n[o][a]=l)})}const Sq=it.createContext(xge());function Zw(n,e,t,r,i){const[s]=it.useState(()=>xge()),a=n*e,o=s.getState();return o.char.length!==a&&(o.width=n,o.height=e,o.char=new Array(a).fill(t),o.color=new Array(a).fill(r),o.bg=new Array(a).fill(i),o.render=0),s}function Tge(){return it.useContext(Sq).getState()}const H8=QE(qw),LM=JE(Hw),qc=X1(n=>({palette:H8,charset:LM,mood:"",viewimage:"",screen:{},reset(){const e=xe(LM)?gB(LM,Jd,ep):void 0;n({palette:H8,mood:"",viewimage:"",screen:{},palettedata:nw(H8),charset:LM,charsetdata:mv(LM),spritecharset:e,spritecharsetdata:mv(e)})},setmood(e){n(t=>Jb(t.mood,e)?t:{...t,mood:e})},setviewimage(e){n(t=>Jb(t.viewimage,e)?t:{...t,viewimage:e})},setpalette(e){n(t=>Jb(t.palette,e)?t:{...t,palette:e,palettedata:nw(e)})},setcharset(e){n(t=>{if(Jb(t.charset,e))return t;const r=xe(e)?gB(e,Jd,ep):void 0;return{...t,charset:e,charsetdata:mv(e),spritecharset:r,spritecharsetdata:mv(r)}})},setaltcharset(e){n(t=>{if(Jb(t.altcharset,e))return t;const r=xe(e)?gB(e,Jd,ep):void 0;return{...t,altcharset:e,altcharsetdata:mv(e),spritealtcharset:r,spritealtcharsetdata:mv(r)}})},setscreen(e,t){n(r=>Jb(r.screen,t)?r:{...r,screen:{...r.screen,[e]:t}})}}));qc.getState().reset();const el=X1(()=>({active:!0,refresh:0,insetcols:20,insetrows:20,islowrez:!1,islandscape:!0,sidebaropen:!0,keyboardalt:!1,keyboardctrl:!1,keyboardshift:!1,showtouchcontrols:!1,checknumbers:"",wordlist:[],wordlistflag:""}));function Fc(n,e,t){t().catch(r=>{console.error(r),Si(n,e,"crash",r?.message)})}async function kk(n){return UOe(n)}async function pL(n,e){return FOe(n,e)}function Eet(n){try{return sessionStorage.getItem(n)??void 0}catch(e){Si(Pi,Ll,`readsession ${n}`,e.message)}}function xet(n,e){try{xe(e)?sessionStorage.setItem(n,e):sessionStorage.removeItem(n)}catch(t){Si(Pi,Ll,`writesession ${n} <- ${e}`,t.message)}}function wge(){try{const n=location.hash.slice(1);if(n.length)return n}catch(n){Si(Pi,Ll,"crash",n.message)}return""}async function R9(){const n=wge();if(n.length){const e=await Iet(n);return xe(e)&&e.length>n.length?e:n}return""}async function Rge(){const n=await Cj("cli");Hj(Ll,n)}function Tet(){wv(Pi,Ll,"#pages")}function wet(n,e){const t=n==="error"?"$red":"$blue",r=e.map(s=>`${s}`).join(" ");return r.startsWith("!")?`!${r}`:`$onclear${t}${r}`}const one=/\((\d+)\)/;function iN(n){const{terminal:e}=ao.getState(),t=wet(n.target,n.data),[r=""]=e.logs,i=[...e.logs],s=QJ(r).replace(one,""),a=QJ(t),o=s.indexOf(a);if(a.length&&s.length&&o===0){const l=one.exec(r);if(xe(l)){const c=parseFloat(l[1])+1;i.shift(),i.unshift(`(${c})${t}`)}else i.shift(),i.unshift(`(2)${t}`)}else i.unshift(t);ao.setState(l=>({terminal:{...l.terminal,logs:i}}))}function Ret(n){const{layout:e,editor:t}=ao.getState();let i=e+(n?1:-1);if(i<0&&(i+=A0.MAX),i>=A0.MAX&&(i-=A0.MAX),!t.open)switch(i){case A0.SPLIT_X:i=A0.TOP;break}ao.setState({layout:i})}async function Age(n){if(n.length===0){Si(Pi,Ll,"content","no content found"),await Rge(),ale(Pi,Ll),oj(Pi,Ll);return}const e=await w2("selected")??"";gOe(Pi,Ll,n,e)}let Ok="";window.addEventListener("hashchange",()=>{Fc(Pi,Ll,async()=>{const n=wge();if(Ok!==n){Ok=n;const e=await R9();await Age(e)}})});async function Cge(n,e,t){if(n.length>2048){const i=await Oet(n);return Cge(i,e,t)}const r=`#${n}`;if(location.hash!==r){Ok=n,location.hash=r;const i=`wrote ${t.length} chars [${t.slice(0,8)}...${t.slice(-8)}]`;e.includes("autosave")||xs(Pi,Ll,i),document.title=e}}function Mge(n){switch(n){case"crt":return"on";default:return"off"}}async function w2(n){const e=await kk(`config_${n}`);return e?e&&e!=="off"?"on":"off":Mge(n)}async function Aet(n,e){return xs(Pi,Ll,`writing config ${n}`),pL(`config_${n}`,()=>e)}async function Cet(){const n=["config_crt","config_lowrez","config_selected","config_scanlines","config_voice2text"];return(await BOe(n)).map((t,r)=>{const s=n[r].replace("config_","");return t?[s,t&&t!=="off"?"on":"off"]:[s,Mge(s)]})}async function Met(){return kk("HISTORYBUFFER")}async function ket(n){return pL("HISTORYBUFFER",()=>n)}async function Oet(n){let e=await kk(n);if(e===void 0){for(;e===void 0;){const t=lj({addAdverb:!0,capitalize:!1,adjectiveCount:2});await kk(t)===void 0&&(e=t)}await pL(n,()=>e),await pL(e,()=>n)}return e}async function Iet(n){return await kk(n)}let q8=0;const lne=10,Ll=Eet("PLAYER")??KOe();xet("PLAYER",Ll);let cne;function ss(){return Ll}const Pi=H1("register",["ready","second","info","error","log","chat","toast"],function(n){if(Pi.session(n)){switch(n.target){case"ready":case"chat":case"toast":case"second":break;default:if(n.player!==Ll)return;break}switch(n.target){case"ready":{Fc(Pi,n.player,async()=>{const e=await Met();xe(e)&&Ko.setState({buffer:e.filter(t=>t.includes("#broadcast")===!1)}),await Ch(256),xs(Pi,Ll,`myplayerid ${Ll}`),fOe(Pi,Ll)});break}case"refresh":Fc(Pi,n.player,async()=>{el.setState({active:!1}),await Ch(512),ao.getState().reset(),qc.getState().reset(),_c.getState().reset(),Ko.getState().reset(),FS.getState().reset(),Ts.setState({gadget:{id:"",board:"",layers:[],tickers:[],scrollname:"",scroll:[],sidebar:[]}}),await Ch(512),el.setState(e=>({active:!0,refresh:e.refresh+1}))});break;case"ackoperator":Fc(Pi,n.player,async()=>{const e=await R9();vge()?Uke(Pi,Ll,e):(mOe(Pi,Ll,dL()),await Age(e))});break;case"loginready":vOe(Pi,Ll),ale(Pi,Ll);break;case"loginfail":Fc(Pi,n.player,async()=>{await Rge(),Tet(),oj(Pi,Ll)});break;case"acklogin":Hke(Pi,Ll),gD(Pi,Ll);break;case"ackzsswords":{Ts.setState({zsswords:n.data});const e=[],t=Object.values(n.data);for(let r=0;r<t.length;++r)e.push(...t[r]);break}case"copy":Vn(n.data)&&xe(Qo())&&Qo().writeText(n.data).then(()=>Ny(Pi,n.player,"copied!")).catch(e=>console.error(e));break;case"copyjsonfile":if(bi(n.data)&&xe(Qo())){const[e,t]=n.data,r=new Blob([JSON.stringify({exported:t,data:e},null,2)],{type:"text/plain"});Qo().write([new ClipboardItem({[r.type]:r})]).then(()=>Ny(Pi,n.player,"copied!")).catch(i=>console.error(i))}break;case"downloadjsonfile":if(bi(n.data)){const[e,t]=n.data;try{const r=new Blob([JSON.stringify({exported:t,data:e},null,2)],{type:"application/json;charset=utf-8"}),i=URL.createObjectURL(r),s=document.createElement("a");s.href=i,s.download=t,s.click(),URL.revokeObjectURL(i)}catch(r){console.error(r)}}break;case"dev":Fc(Pi,n.player,async function(){dL()?(y_(Pi,n.player,"unlocking terminal"),await Ch(100),location.href=location.href.replace("/locked/#","/#")):(y_(Pi,n.player,"creating locked terminal"),await Ch(100),location.href=location.href.replace("/#","/locked/#"))});break;case"share":Fc(Pi,n.player,async function(){const e=await R9(),t=`#${e}`;Ok=e,location.hash=t;const r=await _ge(location.href);P7(Pi,n.player,r,r)});break;case"nuke":Fc(Pi,n.player,async function(){y_(Pi,n.player,"nuke in"),Tm(Pi,n.player,"3","..."),await Ch(1e3),Tm(Pi,n.player,"2","..."),await Ch(1e3),Tm(Pi,n.player,"1","..."),await Ch(1e3),y_(Pi,n.player,"BYE"),await Ch(100),location.hash="",Ok=location.hash,location.reload()});break;case"savemem":Fc(Pi,n.player,async function(){if(bi(n.data)){const[e,t]=n.data;Vn(e)&&Vn(t)&&await Cge(t,e,t)}});break;case"forkmem":if(bi(n.data)){const[e]=n.data;Vn(e)&&window.open(location.href.replace("/locked/#","/#").replace(/#.*/,`#${e}`),"_blank")}break;case"itchiopublishmem":Fc(Pi,n.player,async()=>{if(bi(n.data)){const[e,t]=n.data;Vn(e)&&Vn(t)&&await m3e(e,t)}});break;case"config":Fc(Pi,n.player,async()=>{if(bi(n.data)){const[e,t]=n.data;await Aet(e,t)}});break;case"configshow":Fc(Pi,n.player,async()=>{const e=await Cet();y_(Pi,n.player,"config");for(let t=0;t<e.length;++t)Tm(Pi,n.player,e[t][0],e[t][1])});break;case"second":++q8,q8>=lne&&(q8-=lne,lle(Pi,Ll));break;case"inspector":ao.setState(e=>{const t=xe(n.data)?!!n.data:!e.inspector;return xs(Pi,n.player,`gadget inspector ${t?"$greenon":"$redoff"}`),t&&xs(Pi,n.player,"mouse click or tap elements to inspect"),{inspector:t}});break;case"log":iN(n);break;case"chat":iN(n);break;case"info":iN(n);break;case"error":iN(n);break;case"toast":if(xe(n.data)){clearTimeout(cne),ao.setState({toast:n.data});const e=Math.max(n.data.length*150,3e3),t=Math.min(e,14e3);cne=setTimeout(()=>ao.setState({toast:""}),t)}break;case"terminal:full":ao.setState(e=>({layout:A0.FULL,terminal:{...e.terminal,open:!0}}));break;case"terminal:open":ao.setState(e=>({terminal:{...e.terminal,open:!0}}));break;case"terminal:quickopen":if(n.data&&Vn(n.data)){const e=Ko.getState().buffer;e[0]=n.data,Ko.setState({buffer:e,bufferindex:0,xcursor:n.data.length,ycursor:0,xselect:void 0,yselect:void 0})}ao.setState({quickterminal:!0,layout:A0.TOP});break;case"terminal:close":ao.setState(e=>({quickterminal:!1,terminal:{...e.terminal,open:!1}}));break;case"terminal:toggle":ao.setState(e=>({terminal:{...e.terminal,open:!e.terminal.open}}));break;case"terminal:inclayout":Ake(n.data)&&Ret(n.data);break;case"editor:open":if(bi(n.data)){const[e,t,r,i]=n.data;ao.setState(()=>({editor:{open:!0,player:n.player,book:e,path:t,type:r,title:i}}))}break;case"editor:close":ao.setState(e=>({editor:{...e.editor,open:!1}}));break}}}),kge="15.1.22",une=(n,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:n}),fne=(n,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:n}),A9=(n,e)=>({startTime:e,type:"setValue",value:n}),Oge=(n,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:n}),Ige=(n,e,{startTime:t,target:r,timeConstant:i})=>r+(e-r)*Math.exp((t-n)/i),bT=n=>n.type==="exponentialRampToValue",mL=n=>n.type==="linearRampToValue",t1=n=>bT(n)||mL(n),Eq=n=>n.type==="setValue",Iy=n=>n.type==="setValueCurve",gL=(n,e,t,r)=>{const i=n[e];return i===void 0?r:t1(i)||Eq(i)?i.value:Iy(i)?i.values[i.values.length-1]:Ige(t,gL(n,e-1,i.startTime,r),i)},hne=(n,e,t,r,i)=>t===void 0?[r.insertTime,i]:t1(t)?[t.endTime,t.value]:Eq(t)?[t.startTime,t.value]:Iy(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,gL(n,e-1,t.startTime,i)],C9=n=>n.type==="cancelAndHold",M9=n=>n.type==="cancelScheduledValues",Vb=n=>C9(n)||M9(n)?n.cancelTime:bT(n)||mL(n)?n.endTime:n.startTime,dne=(n,e,t,{endTime:r,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((n-e)/(r-e)):0,pne=(n,e,t,{endTime:r,value:i})=>t+(n-e)/(r-e)*(i-t),Net=(n,e)=>{const t=Math.floor(e),r=Math.ceil(e);return t===r?n[t]:(1-(e-t))*n[t]+(1-(r-e))*n[r]},Pet=(n,{duration:e,startTime:t,values:r})=>{const i=(n-t)/e*(r.length-1);return Net(r,i)},sN=n=>n.type==="setTarget";class Det{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=Vb(e);if(C9(e)||M9(e)){const r=this._automationEvents.findIndex(s=>M9(e)&&Iy(s)?s.startTime+s.duration>=t:Vb(s)>=t),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),C9(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&t1(i)){if(s!==void 0&&sN(s))throw new Error("The internal list is malformed.");const a=s===void 0?i.insertTime:Iy(s)?s.startTime+s.duration:Vb(s),o=s===void 0?this._defaultValue:Iy(s)?s.values[s.values.length-1]:s.value,l=bT(i)?dne(t,a,o,i):pne(t,a,o,i),c=bT(i)?une(l,t,this._currenTime):fne(l,t,this._currenTime);this._automationEvents.push(c)}if(s!==void 0&&sN(s)&&this._automationEvents.push(A9(this.getValue(t),t)),s!==void 0&&Iy(s)&&s.startTime+s.duration>t){const a=t-s.startTime,o=(s.values.length-1)/s.duration,l=Math.max(2,1+Math.ceil(a*o)),c=a/(l-1)*o,u=s.values.slice(0,l);if(c<1)for(let f=1;f<l;f+=1){const d=c*f%1;u[f]=s.values[f-1]*(1-d)+s.values[f]*d}this._automationEvents[this._automationEvents.length-1]=Oge(u,s.startTime,a)}}}else{const r=this._automationEvents.findIndex(a=>Vb(a)>t),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Iy(i)&&Vb(i)+i.duration>t)return!1;const s=bT(e)?une(e.value,e.endTime,this._currenTime):mL(e)?fne(e.value,t,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(Iy(e)&&t+e.duration>Vb(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const t=this._automationEvents.findIndex(r=>Vb(r)>e);if(t>1){const r=this._automationEvents.slice(t-1),i=r[0];sN(i)&&r.unshift(A9(gL(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(a=>Vb(a)>e),r=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,s=this._automationEvents[i];if(s!==void 0&&sN(s)&&(r===void 0||!t1(r)||r.insertTime>e))return Ige(e,gL(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&Eq(s)&&(r===void 0||!t1(r)))return s.value;if(s!==void 0&&Iy(s)&&(r===void 0||!t1(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?Pet(e,s):s.values[s.values.length-1];if(s!==void 0&&t1(s)&&(r===void 0||!t1(r)))return s.value;if(r!==void 0&&bT(r)){const[a,o]=hne(this._automationEvents,i,s,r,this._defaultValue);return dne(e,a,o,r)}if(r!==void 0&&mL(r)){const[a,o]=hne(this._automationEvents,i,s,r,this._defaultValue);return pne(e,a,o,r)}return this._defaultValue}}const Let=n=>({cancelTime:n,type:"cancelAndHold"}),Uet=n=>({cancelTime:n,type:"cancelScheduledValues"}),Bet=(n,e)=>({endTime:e,type:"exponentialRampToValue",value:n}),Fet=(n,e)=>({endTime:e,type:"linearRampToValue",value:n}),zet=(n,e,t)=>({startTime:e,target:n,timeConstant:t,type:"setTarget"}),jet=()=>new DOMException("","AbortError"),Het=n=>(e,t,[r,i,s],a)=>{n(e[i],[t,r,s],o=>o[0]===t&&o[1]===r,a)},qet=n=>(e,t,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);n.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},Vet=n=>(e,t)=>{n.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},yw=new WeakSet,Nge=new WeakMap,xq=new WeakMap,Pge=new WeakMap,Tq=new WeakMap,kU=new WeakMap,Dge=new WeakMap,k9=new WeakMap,O9=new WeakMap,I9=new WeakMap,Lge={construct(){return Lge}},Get=n=>{try{const e=new Proxy(n,Lge);new e}catch{return!1}return!0},mne=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,gne=(n,e)=>{const t=[];let r=n.replace(/^[\s]+/,""),i=r.match(mne);for(;i!==null;){const s=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());t.push(a),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(mne)}return[t.join(";"),r]},_ne=n=>{if(n!==void 0&&!Array.isArray(n))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},vne=n=>{if(!Get(n))throw new TypeError("The given value for processorCtor should be a constructor.");if(n.prototype===null||typeof n.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},$et=(n,e,t,r,i,s,a,o,l,c,u,f,d)=>{let g=0;return(p,_,y={credentials:"omit"})=>{const v=u.get(p);if(v!==void 0&&v.has(_))return Promise.resolve();const x=c.get(p);if(x!==void 0){const O=x.get(_);if(O!==void 0)return O}const E=s(p),M=E.audioWorklet===void 0?i(_).then(([O,N])=>{const[I,D]=gne(O,N),V=`${I};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${D}
})})(window,'_AWGS')`;return t(V)}).then(()=>{const O=d._AWGS.pop();if(O===void 0)throw new SyntaxError;r(E.currentTime,E.sampleRate,()=>O(class{},void 0,(N,I)=>{if(N.trim()==="")throw e();const D=O9.get(E);if(D!==void 0){if(D.has(N))throw e();vne(I),_ne(I.parameterDescriptors),D.set(N,I)}else vne(I),_ne(I.parameterDescriptors),O9.set(E,new Map([[N,I]]))},E.sampleRate,void 0,void 0))}):Promise.all([i(_),Promise.resolve(n(f,f))]).then(([[O,N],I])=>{const D=g+1;g=D;const[V,G]=gne(O,N),U=`${V};((AudioWorkletProcessor,registerProcessor)=>{${G}
})(${I?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${I?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${I?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${D}',class extends AudioWorkletProcessor{process(){return !1}})`,J=new Blob([U],{type:"application/javascript; charset=utf-8"}),W=URL.createObjectURL(J);return E.audioWorklet.addModule(W,y).then(()=>{if(o(E))return E;const q=a(E);return q.audioWorklet.addModule(W,y).then(()=>q)}).then(q=>{if(l===null)throw new SyntaxError;try{new l(q,`__sac${D}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(W))});return x===void 0?c.set(p,new Map([[_,M]])):x.set(_,M),M.then(()=>{const O=u.get(p);O===void 0?u.set(p,new Set([_])):O.add(_)}).finally(()=>{const O=c.get(p);O!==void 0&&O.delete(_)}),M}},k_=(n,e)=>{const t=n.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},OU=(n,e)=>{const t=Array.from(n).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[r]=t;return n.delete(r),r},Uge=(n,e,t,r)=>{const i=k_(n,e),s=OU(i,a=>a[0]===t&&a[1]===r);return i.size===0&&n.delete(e),s},OO=n=>k_(Dge,n),bw=n=>{if(yw.has(n))throw new Error("The AudioNode is already stored.");yw.add(n),OO(n).forEach(e=>e(!0))},Bge=n=>"port"in n,IO=n=>{if(!yw.has(n))throw new Error("The AudioNode is not stored.");yw.delete(n),OO(n).forEach(e=>e(!1))},N9=(n,e)=>{!Bge(n)&&e.every(t=>t.size===0)&&IO(n)},Wet=(n,e,t,r,i,s,a,o,l,c,u,f,d)=>{const g=new WeakMap;return(p,_,y,v,x)=>{const{activeInputs:E,passiveInputs:M}=s(_),{outputs:O}=s(p),N=o(p),I=D=>{const V=l(_),G=l(p);if(D){const Q=Uge(M,p,y,v);n(E,p,Q,!1),!x&&!f(p)&&t(G,V,y,v),d(_)&&bw(_)}else{const Q=r(E,p,y,v);e(M,v,Q,!1),!x&&!f(p)&&i(G,V,y,v);const B=a(_);if(B===0)u(_)&&N9(_,E);else{const $=g.get(_);$!==void 0&&clearTimeout($),g.set(_,setTimeout(()=>{u(_)&&N9(_,E)},B*1e3))}}};return c(O,[_,y,v],D=>D[0]===_&&D[1]===y&&D[2]===v,!0)?(N.add(I),u(p)?n(E,p,[y,v,I],!0):e(M,v,[p,y,I],!0),!0):!1}},Yet=n=>(e,t,[r,i,s],a)=>{const o=e.get(r);o===void 0?e.set(r,new Set([[i,t,s]])):n(o,[i,t,s],l=>l[0]===i&&l[1]===t,a)},Xet=n=>(e,t)=>{const r=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},Ket=n=>(e,t)=>{n(e).add(t)},Zet={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},Qet=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...Zet,...l},f=r(c,u),d=s(c)?e():null;super(o,!1,f,d),this._nativeAnalyserNode=f}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(o){this._nativeAnalyserNode.fftSize=o}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(o){const l=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=o,!(o>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=l,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(o){const l=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=o,!(this._nativeAnalyserNode.maxDecibels>o))throw this._nativeAnalyserNode.minDecibels=l,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(o){this._nativeAnalyserNode.smoothingTimeConstant=o}getByteFrequencyData(o){this._nativeAnalyserNode.getByteFrequencyData(o)}getByteTimeDomainData(o){this._nativeAnalyserNode.getByteTimeDomainData(o)}getFloatFrequencyData(o){this._nativeAnalyserNode.getFloatFrequencyData(o)}getFloatTimeDomainData(o){this._nativeAnalyserNode.getFloatTimeDomainData(o)}},ap=(n,e)=>n.context===e,Jet=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!ap(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},_L=n=>{try{n.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},ny=()=>new DOMException("","IndexSizeError"),wq=n=>{n.getChannelData=(e=>t=>{try{return e.call(n,t)}catch(r){throw r.code===12?ny():r}})(n.getChannelData)},ett={numberOfChannels:1},ttt=(n,e,t,r,i,s,a,o)=>{let l=null;return class Fge{constructor(u){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:f,numberOfChannels:d,sampleRate:g}={...ett,...u};l===null&&(l=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:f,numberOfChannels:d,sampleRate:g}):l.createBuffer(d,f,g);if(p.numberOfChannels===0)throw t();return typeof p.copyFromChannel!="function"?(a(p),wq(p)):e(_L,()=>_L(p))||o(p),n.add(p),p}static[Symbol.hasInstance](u){return u!==null&&typeof u=="object"&&Object.getPrototypeOf(u)===Fge.prototype||n.has(u)}}},wm=-34028234663852886e22,Op=-wm,Jy=n=>yw.has(n),ntt={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},rtt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),d={...ntt,...u},g=i(f,d),p=a(f),_=p?e():null;super(c,!1,g,_),this._audioBufferSourceNodeRenderer=_,this._isBufferNullified=!1,this._isBufferSet=d.buffer!==null,this._nativeAudioBufferSourceNode=g,this._onended=null,this._playbackRate=t(this,p,g.playbackRate,Op,wm)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(c){if(this._nativeAudioBufferSourceNode.buffer=c,c!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(c){this._nativeAudioBufferSourceNode.loop=c}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(c){this._nativeAudioBufferSourceNode.loopEnd=c}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(c){this._nativeAudioBufferSourceNode.loopStart=c}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?o(this,c):null;this._nativeAudioBufferSourceNode.onended=u;const f=this._nativeAudioBufferSourceNode.onended;this._onended=f!==null&&f===u?c:f}get playbackRate(){return this._playbackRate}start(c=0,u=0,f){if(this._nativeAudioBufferSourceNode.start(c,u,f),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=f===void 0?[c,u]:[c,u,f]),this.context.state!=="closed"){bw(this);const d=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",d),Jy(this)&&IO(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",d)}}stop(c=0){this._nativeAudioBufferSourceNode.stop(c),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=c)}},itt=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null;const l=async(c,u)=>{let f=t(c);const d=ap(f,u);if(!d){const g={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value};f=e(u,g),a!==null&&f.start(...a),o!==null&&f.stop(o)}return s.set(u,f),d?await n(u,c.playbackRate,f.playbackRate):await r(u,c.playbackRate,f.playbackRate),await i(c,u,f),f};return{set start(c){a=c},set stop(c){o=c},render(c,u){const f=s.get(u);return f!==void 0?Promise.resolve(f):l(c,u)}}},stt=n=>"playbackRate"in n,att=n=>"frequency"in n&&"gain"in n,ott=n=>"offset"in n,ltt=n=>!("frequency"in n)&&"gain"in n,ctt=n=>"detune"in n&&"frequency"in n&&!("gain"in n),utt=n=>"pan"in n,zp=n=>k_(Nge,n),NO=n=>k_(Pge,n),P9=(n,e)=>{const{activeInputs:t}=zp(n);t.forEach(i=>i.forEach(([s])=>{e.includes(n)||P9(s,[...e,n])}));const r=stt(n)?[n.playbackRate]:Bge(n)?Array.from(n.parameters.values()):att(n)?[n.Q,n.detune,n.frequency,n.gain]:ott(n)?[n.offset]:ltt(n)?[n.gain]:ctt(n)?[n.detune,n.frequency]:utt(n)?[n.pan]:[];for(const i of r){const s=NO(i);s!==void 0&&s.activeInputs.forEach(([a])=>P9(a,e))}Jy(n)&&IO(n)},zge=n=>{P9(n.destination,[])},ftt=n=>n===void 0||typeof n=="number"||typeof n=="string"&&(n==="balanced"||n==="interactive"||n==="playback"),htt=(n,e,t,r,i,s,a,o,l)=>class extends n{constructor(u={}){if(l===null)throw new Error("Missing the native AudioContext constructor.");let f;try{f=new l(u)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?t():p}if(f===null)throw r();if(!ftt(u.latencyHint))throw new TypeError(`The provided value '${u.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(u.sampleRate!==void 0&&f.sampleRate!==u.sampleRate)throw t();super(f,2);const{latencyHint:d}=u,{sampleRate:g}=f;if(this._baseLatency=typeof f.baseLatency=="number"?f.baseLatency:d==="balanced"?512/g:d==="interactive"||d===void 0?256/g:d==="playback"?1024/g:Math.max(2,Math.min(128,Math.round(d*g/128)))*128/g,this._nativeAudioContext=f,l.name==="webkitAudioContext"?(this._nativeGainNode=f.createGain(),this._nativeOscillatorNode=f.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(f.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,f.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),f.removeEventListener("statechange",p)};f.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),zge(this)}))}createMediaElementSource(u){return new i(this,{mediaElement:u})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(u){return new a(this,{mediaStream:u})}createMediaStreamTrackSource(u){return new o(this,{mediaStreamTrack:u})}resume(){return this._state==="suspended"?new Promise((u,f)=>{const d=()=>{this._nativeAudioContext.removeEventListener("statechange",d),this._nativeAudioContext.state==="running"?u():this.resume().then(u,f)};this._nativeAudioContext.addEventListener("statechange",d)}):this._nativeAudioContext.resume().catch(u=>{throw u===void 0||u.code===15?e():u})}suspend(){return this._nativeAudioContext.suspend().catch(u=>{throw u===void 0?e():u})}},dtt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),d=a(f),g=i(f,u,d),p=d?e(o):null;super(c,!1,g,p),this._isNodeOfNativeOfflineAudioContext=d,this._nativeAudioDestinationNode=g}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(c>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=c}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(c){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=c}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},ptt=n=>{const e=new WeakMap,t=async(r,i)=>{const s=i.destination;return e.set(i,s),await n(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):t(r,i)}}},mtt=(n,e,t,r,i,s,a,o)=>(l,c)=>{const u=c.listener,f=()=>{const O=new Float32Array(1),N=e(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),I=a(c);let D=!1,V=[0,0,-1,0,1,0],G=[0,0,0];const Q=()=>{if(D)return;D=!0;const J=r(c,256,9,0);J.onaudioprocess=({inputBuffer:W})=>{const q=[s(W,O,0),s(W,O,1),s(W,O,2),s(W,O,3),s(W,O,4),s(W,O,5)];q.some((ae,Z)=>ae!==V[Z])&&(u.setOrientation(...q),V=q);const Y=[s(W,O,6),s(W,O,7),s(W,O,8)];Y.some((ae,Z)=>ae!==G[Z])&&(u.setPosition(...Y),G=Y)},N.connect(J)},B=J=>W=>{W!==V[J]&&(V[J]=W,u.setOrientation(...V))},$=J=>W=>{W!==G[J]&&(G[J]=W,u.setPosition(...G))},U=(J,W,q)=>{const Y=t(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:W});Y.connect(N,0,J),Y.start(),Object.defineProperty(Y.offset,"defaultValue",{get(){return W}});const ae=n({context:l},I,Y.offset,Op,wm);return o(ae,"value",Z=>()=>Z.call(ae),Z=>K=>{try{Z.call(ae,K)}catch(ne){if(ne.code!==9)throw ne}Q(),I&&q(K)}),ae.cancelAndHoldAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.cancelAndHoldAtTime),ae.cancelScheduledValues=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.cancelScheduledValues),ae.exponentialRampToValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.exponentialRampToValueAtTime),ae.linearRampToValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.linearRampToValueAtTime),ae.setTargetAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.setTargetAtTime),ae.setValueAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.setValueAtTime),ae.setValueCurveAtTime=(Z=>I?()=>{throw i()}:(...K)=>{const ne=Z.apply(ae,K);return Q(),ne})(ae.setValueCurveAtTime),ae};return{forwardX:U(0,0,B(0)),forwardY:U(1,0,B(1)),forwardZ:U(2,-1,B(2)),positionX:U(6,0,$(0)),positionY:U(7,0,$(1)),positionZ:U(8,0,$(2)),upX:U(3,0,B(3)),upY:U(4,1,B(4)),upZ:U(5,0,B(5))}},{forwardX:d,forwardY:g,forwardZ:p,positionX:_,positionY:y,positionZ:v,upX:x,upY:E,upZ:M}=u.forwardX===void 0?f():u;return{get forwardX(){return d},get forwardY(){return g},get forwardZ(){return p},get positionX(){return _},get positionY(){return y},get positionZ(){return v},get upX(){return x},get upY(){return E},get upZ(){return M}}},vL=n=>"context"in n,PO=n=>vL(n[0]),ox=(n,e,t,r)=>{for(const i of n)if(t(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return n.add(e),!0},yne=(n,e,[t,r],i)=>{ox(n,[e,t,r],s=>s[0]===e&&s[1]===t,i)},bne=(n,[e,t,r],i)=>{const s=n.get(e);s===void 0?n.set(e,new Set([[t,r]])):ox(s,[t,r],a=>a[0]===t,i)},Qw=n=>"inputs"in n,yL=(n,e,t,r)=>{if(Qw(e)){const i=e.inputs[r];return n.connect(i,t,0),[i,t,0]}return n.connect(e,t,r),[e,t,r]},jge=(n,e,t)=>{for(const r of n)if(r[0]===e&&r[1]===t)return n.delete(r),r;return null},gtt=(n,e,t)=>OU(n,r=>r[0]===e&&r[1]===t),Hge=(n,e)=>{if(!OO(n).delete(e))throw new Error("Missing the expected event listener.")},qge=(n,e,t)=>{const r=k_(n,e),i=OU(r,s=>s[0]===t);return r.size===0&&n.delete(e),i},bL=(n,e,t,r)=>{Qw(e)?n.disconnect(e.inputs[r],t,0):n.disconnect(e,t,r)},sc=n=>k_(xq,n),Ik=n=>k_(Tq,n),BE=n=>k9.has(n),rP=n=>!yw.has(n),Sne=(n,e)=>new Promise(t=>{if(e!==null)t(!0);else{const r=n.createScriptProcessor(256,1,1),i=n.createGain(),s=n.createBuffer(1,2,44100),a=s.getChannelData(0);a[0]=1,a[1]=1;const o=n.createBufferSource();o.buffer=s,o.loop=!0,o.connect(r).connect(n.destination),o.connect(i),o.disconnect(i),r.onaudioprocess=l=>{const c=l.inputBuffer.getChannelData(0);Array.prototype.some.call(c,u=>u===1)?t(!0):t(!1),o.stop(),r.onaudioprocess=null,o.disconnect(r),r.disconnect(n.destination)},o.start()}}),V8=(n,e)=>{const t=new Map;for(const r of n)for(const i of r){const s=t.get(i);t.set(i,s===void 0?1:s+1)}t.forEach((r,i)=>e(i,r))},SL=n=>"context"in n,_tt=n=>{const e=new Map;n.connect=(t=>(r,i=0,s=0)=>{const a=SL(r)?t(r,i,s):t(r,i),o=e.get(r);return o===void 0?e.set(r,[{input:s,output:i}]):o.every(l=>l.input!==s||l.output!==i)&&o.push({input:s,output:i}),a})(n.connect.bind(n)),n.disconnect=(t=>(r,i,s)=>{if(t.apply(n),r===void 0)e.clear();else if(typeof r=="number")for(const[a,o]of e){const l=o.filter(c=>c.output!==r);l.length===0?e.delete(a):e.set(a,l)}else if(e.has(r))if(i===void 0)e.delete(r);else{const a=e.get(r);if(a!==void 0){const o=a.filter(l=>l.output!==i&&(l.input!==s||s===void 0));o.length===0?e.delete(r):e.set(r,o)}}for(const[a,o]of e)o.forEach(l=>{SL(a)?n.connect(a,l.output,l.input):n.connect(a,l.output)})})(n.disconnect)},vtt=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=NO(e),{outputs:a}=zp(n),o=OO(n),l=c=>{const u=sc(n),f=Ik(e);if(c){const d=qge(s,n,t);yne(i,n,d,!1),!r&&!BE(n)&&u.connect(f,t)}else{const d=gtt(i,n,t);bne(s,d,!1),!r&&!BE(n)&&u.disconnect(f,t)}};return ox(a,[e,t],c=>c[0]===e&&c[1]===t,!0)?(o.add(l),Jy(n)?yne(i,n,[t,l],!0):bne(s,[n,t,l],!0),!0):!1},ytt=(n,e,t,r)=>{const{activeInputs:i,passiveInputs:s}=zp(e),a=jge(i[r],n,t);return a===null?[Uge(s,n,t,r)[2],!1]:[a[2],!0]},btt=(n,e,t)=>{const{activeInputs:r,passiveInputs:i}=NO(e),s=jge(r,n,t);return s===null?[qge(i,n,t)[1],!1]:[s[2],!0]},Rq=(n,e,t,r,i)=>{const[s,a]=ytt(n,t,r,i);if(s!==null&&(Hge(n,s),a&&!e&&!BE(n)&&bL(sc(n),sc(t),r,i)),Jy(t)){const{activeInputs:o}=zp(t);N9(t,o)}},Aq=(n,e,t,r)=>{const[i,s]=btt(n,t,r);i!==null&&(Hge(n,i),s&&!e&&!BE(n)&&sc(n).disconnect(Ik(t),r))},Stt=(n,e)=>{const t=zp(n),r=[];for(const i of t.outputs)PO(i)?Rq(n,e,...i):Aq(n,e,...i),r.push(i[0]);return t.outputs.clear(),r},Ett=(n,e,t)=>{const r=zp(n),i=[];for(const s of r.outputs)s[1]===t&&(PO(s)?Rq(n,e,...s):Aq(n,e,...s),i.push(s[0]),r.outputs.delete(s));return i},xtt=(n,e,t,r,i)=>{const s=zp(n);return Array.from(s.outputs).filter(a=>a[0]===t&&(r===void 0||a[1]===r)&&(i===void 0||a[2]===i)).map(a=>(PO(a)?Rq(n,e,...a):Aq(n,e,...a),s.outputs.delete(a),a[0]))},Ttt=(n,e,t,r,i,s,a,o,l,c,u,f,d,g,p,_)=>class extends c{constructor(v,x,E,M){super(E),this._context=v,this._nativeAudioNode=E;const O=u(v);f(O)&&t(Sne,()=>Sne(O,_))!==!0&&_tt(E),xq.set(this,E),Dge.set(this,new Set),v.state!=="closed"&&x&&bw(this),n(this,M,E)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(v){this._nativeAudioNode.channelCount=v}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(v){this._nativeAudioNode.channelCountMode=v}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(v){this._nativeAudioNode.channelInterpretation=v}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(v,x=0,E=0){if(x<0||x>=this._nativeAudioNode.numberOfOutputs)throw i();const M=u(this._context),O=p(M);if(d(v)||g(v))throw s();if(vL(v)){const D=sc(v);try{const G=yL(this._nativeAudioNode,D,x,E),Q=rP(this);(O||Q)&&this._nativeAudioNode.disconnect(...G),this.context.state!=="closed"&&!Q&&rP(v)&&bw(v)}catch(G){throw G.code===12?s():G}if(e(this,v,x,E,O)){const G=l([this],v);V8(G,r(O))}return v}const N=Ik(v);if(N.name==="playbackRate"&&N.maxValue===1024)throw a();try{this._nativeAudioNode.connect(N,x),(O||rP(this))&&this._nativeAudioNode.disconnect(N,x)}catch(D){throw D.code===12?s():D}if(vtt(this,v,x,O)){const D=l([this],v);V8(D,r(O))}}disconnect(v,x,E){let M;const O=u(this._context),N=p(O);if(v===void 0)M=Stt(this,N);else if(typeof v=="number"){if(v<0||v>=this.numberOfOutputs)throw i();M=Ett(this,N,v)}else{if(x!==void 0&&(x<0||x>=this.numberOfOutputs)||vL(v)&&E!==void 0&&(E<0||E>=v.numberOfInputs))throw i();if(M=xtt(this,N,v,x,E),M.length===0)throw s()}for(const I of M){const D=l([this],I);V8(D,o)}}},wtt=(n,e,t,r,i,s,a,o,l,c,u,f,d)=>(g,p,_,y=null,v=null)=>{const x=_.value,E=new Det(x),M=p?r(E):null,O={get defaultValue(){return x},get maxValue(){return y===null?_.maxValue:y},get minValue(){return v===null?_.minValue:v},get value(){return _.value},set value(N){_.value=N,O.setValueAtTime(N,g.context.currentTime)},cancelAndHoldAtTime(N){if(typeof _.cancelAndHoldAtTime=="function")M===null&&E.flush(g.context.currentTime),E.add(i(N)),_.cancelAndHoldAtTime(N);else{const I=Array.from(E).pop();M===null&&E.flush(g.context.currentTime),E.add(i(N));const D=Array.from(E).pop();_.cancelScheduledValues(N),I!==D&&D!==void 0&&(D.type==="exponentialRampToValue"?_.exponentialRampToValueAtTime(D.value,D.endTime):D.type==="linearRampToValue"?_.linearRampToValueAtTime(D.value,D.endTime):D.type==="setValue"?_.setValueAtTime(D.value,D.startTime):D.type==="setValueCurve"&&_.setValueCurveAtTime(D.values,D.startTime,D.duration))}return O},cancelScheduledValues(N){return M===null&&E.flush(g.context.currentTime),E.add(s(N)),_.cancelScheduledValues(N),O},exponentialRampToValueAtTime(N,I){if(N===0)throw new RangeError;if(!Number.isFinite(I)||I<0)throw new RangeError;const D=g.context.currentTime;return M===null&&E.flush(D),Array.from(E).length===0&&(E.add(c(x,D)),_.setValueAtTime(x,D)),E.add(a(N,I)),_.exponentialRampToValueAtTime(N,I),O},linearRampToValueAtTime(N,I){const D=g.context.currentTime;return M===null&&E.flush(D),Array.from(E).length===0&&(E.add(c(x,D)),_.setValueAtTime(x,D)),E.add(o(N,I)),_.linearRampToValueAtTime(N,I),O},setTargetAtTime(N,I,D){return M===null&&E.flush(g.context.currentTime),E.add(l(N,I,D)),_.setTargetAtTime(N,I,D),O},setValueAtTime(N,I){return M===null&&E.flush(g.context.currentTime),E.add(c(N,I)),_.setValueAtTime(N,I),O},setValueCurveAtTime(N,I,D){const V=N instanceof Float32Array?N:new Float32Array(N);if(f!==null&&f.name==="webkitAudioContext"){const G=I+D,Q=g.context.sampleRate,B=Math.ceil(I*Q),$=Math.floor(G*Q),U=$-B,J=new Float32Array(U);for(let q=0;q<U;q+=1){const Y=(V.length-1)/D*((B+q)/Q-I),ae=Math.floor(Y),Z=Math.ceil(Y);J[q]=ae===Z?V[ae]:(1-(Y-ae))*V[ae]+(1-(Z-Y))*V[Z]}M===null&&E.flush(g.context.currentTime),E.add(u(J,I,D)),_.setValueCurveAtTime(J,I,D);const W=$/Q;W<G&&d(O,J[J.length-1],W),d(O,V[V.length-1],G)}else M===null&&E.flush(g.context.currentTime),E.add(u(V,I,D)),_.setValueCurveAtTime(V,I,D);return O}};return t.set(O,_),e.set(O,g),n(O,M),O},Rtt=n=>({replay(e){for(const t of n)if(t.type==="exponentialRampToValue"){const{endTime:r,value:i}=t;e.exponentialRampToValueAtTime(i,r)}else if(t.type==="linearRampToValue"){const{endTime:r,value:i}=t;e.linearRampToValueAtTime(i,r)}else if(t.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=t;e.setTargetAtTime(i,r,s)}else if(t.type==="setValue"){const{startTime:r,value:i}=t;e.setValueAtTime(i,r)}else if(t.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=t;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class Vge{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const Att={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},Ctt=(n,e,t,r,i,s,a,o,l,c,u,f,d,g)=>class extends e{constructor(_,y,v){var x;const E=o(_),M=l(E),O=u({...Att,...v});d(O);const N=O9.get(E),I=N?.get(y),D=M||E.state!=="closed"?E:(x=a(E))!==null&&x!==void 0?x:E,V=i(D,M?null:_.baseLatency,c,y,I,O),G=M?r(y,O,I):null;super(_,!0,V,G);const Q=[];V.parameters.forEach(($,U)=>{const J=t(this,M,$);Q.push([U,J])}),this._nativeAudioWorkletNode=V,this._onprocessorerror=null,this._parameters=new Vge(Q),M&&n(E,this);const{activeInputs:B}=s(this);f(V,B)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(_){const y=typeof _=="function"?g(this,_):null;this._nativeAudioWorkletNode.onprocessorerror=y;const v=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=v!==null&&v===y?_:v}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function EL(n,e,t,r,i){if(typeof n.copyFromChannel=="function")e[t].byteLength===0&&(e[t]=new Float32Array(128)),n.copyFromChannel(e[t],r,i);else{const s=n.getChannelData(r);if(e[t].byteLength===0)e[t]=s.slice(i,i+128);else{const a=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[t].set(a)}}}const Gge=(n,e,t,r,i)=>{typeof n.copyToChannel=="function"?e[t].byteLength!==0&&n.copyToChannel(e[t],r,i):e[t].byteLength!==0&&n.getChannelData(r).set(e[t],i)},xL=(n,e)=>{const t=[];for(let r=0;r<n;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let a=0;a<s;a+=1)i.push(new Float32Array(128));t.push(i)}return t},Mtt=(n,e)=>{const t=k_(I9,n),r=sc(e);return k_(t,r)},ktt=async(n,e,t,r,i,s,a)=>{const o=e===null?Math.ceil(n.context.length/128)*128:e.length,l=r.channelCount*r.numberOfInputs,c=i.reduce((y,v)=>y+v,0),u=c===0?null:t.createBuffer(c,o,t.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const f=zp(n),d=await Mtt(t,n),g=xL(r.numberOfInputs,r.channelCount),p=xL(r.numberOfOutputs,i),_=Array.from(n.parameters.keys()).reduce((y,v)=>({...y,[v]:new Float32Array(128)}),{});for(let y=0;y<o;y+=128){if(r.numberOfInputs>0&&e!==null)for(let v=0;v<r.numberOfInputs;v+=1)for(let x=0;x<r.channelCount;x+=1)EL(e,g[v],x,x,y);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:v},x)=>{EL(e,_,v,l+x,y)});for(let v=0;v<r.numberOfInputs;v+=1)for(let x=0;x<i[v];x+=1)p[v][x].byteLength===0&&(p[v][x]=new Float32Array(128));try{const v=g.map((E,M)=>f.activeInputs[M].size===0?[]:E),x=a(y/t.sampleRate,t.sampleRate,()=>d.process(v,p,_));if(u!==null)for(let E=0,M=0;E<r.numberOfOutputs;E+=1){for(let O=0;O<i[E];O+=1)Gge(u,p[E],O,M+O,y);M+=i[E]}if(!x)break}catch(v){n.dispatchEvent(new ErrorEvent("processorerror",{colno:v.colno,filename:v.filename,lineno:v.lineno,message:v.message}));break}}return u},Ott=(n,e,t,r,i,s,a,o,l,c,u,f,d,g,p,_)=>(y,v,x)=>{const E=new WeakMap;let M=null;const O=async(N,I)=>{let D=u(N),V=null;const G=ap(D,I),Q=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(f===null){const B=Q.reduce((W,q)=>W+q,0),$=i(I,{channelCount:Math.max(1,B),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,B)}),U=[];for(let W=0;W<N.numberOfOutputs;W+=1)U.push(r(I,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Q[W]}));const J=a(I,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1});J.connect=e.bind(null,U),J.disconnect=l.bind(null,U),V=[$,U,J]}else G||(D=new f(I,y));if(E.set(I,V===null?D:V[2]),V!==null){if(M===null){if(x===void 0)throw new Error("Missing the processor constructor.");if(d===null)throw new Error("Missing the native OfflineAudioContext constructor.");const q=N.channelCount*N.numberOfInputs,Y=x.parameterDescriptors===void 0?0:x.parameterDescriptors.length,ae=q+Y;M=ktt(N,ae===0?null:await(async()=>{const K=new d(ae,Math.ceil(N.context.length/128)*128,I.sampleRate),ne=[],le=[];for(let Me=0;Me<v.numberOfInputs;Me+=1)ne.push(a(K,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),le.push(i(K,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));const ce=await Promise.all(Array.from(N.parameters.values()).map(async Me=>{const qe=s(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:Me.value});return await g(K,Me,qe.offset),qe})),de=r(K,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,q+Y)});for(let Me=0;Me<v.numberOfInputs;Me+=1){ne[Me].connect(le[Me]);for(let qe=0;qe<v.channelCount;qe+=1)le[Me].connect(de,qe,Me*v.channelCount+qe)}for(const[Me,qe]of ce.entries())qe.connect(de,0,q+Me),qe.start(0);return de.connect(K.destination),await Promise.all(ne.map(Me=>p(N,K,Me))),_(K)})(),I,v,Q,x,c)}const B=await M,$=t(I,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[U,J,W]=V;B!==null&&($.buffer=B,$.start(0)),$.connect(U);for(let q=0,Y=0;q<N.numberOfOutputs;q+=1){const ae=J[q];for(let Z=0;Z<Q[q];Z+=1)U.connect(ae,Y+Z,Z);Y+=Q[q]}return W}if(G)for(const[B,$]of N.parameters.entries())await n(I,$,D.parameters.get(B));else for(const[B,$]of N.parameters.entries())await g(I,$,D.parameters.get(B));return await p(N,I,D),D};return{render(N,I){o(I,N);const D=E.get(I);return D!==void 0?Promise.resolve(D):O(N,I)}}},Itt=(n,e,t,r,i,s,a,o,l,c,u,f,d,g,p,_,y,v,x,E)=>class extends p{constructor(O,N){super(O,N),this._nativeContext=O,this._audioWorklet=n===void 0?void 0:{addModule:(I,D)=>n(this,I,D)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(O,N,I){return new t({length:N,numberOfChannels:O,sampleRate:I})}createBufferSource(){return new r(this)}createChannelMerger(O=6){return new s(this,{numberOfInputs:O})}createChannelSplitter(O=6){return new a(this,{numberOfOutputs:O})}createConstantSource(){return new o(this)}createConvolver(){return new l(this)}createDelay(O=1){return new u(this,{maxDelayTime:O})}createDynamicsCompressor(){return new f(this)}createGain(){return new d(this)}createIIRFilter(O,N){return new g(this,{feedback:N,feedforward:O})}createOscillator(){return new _(this)}createPanner(){return new y(this)}createPeriodicWave(O,N,I={disableNormalization:!1}){return new v(this,{...I,imag:N,real:O})}createStereoPanner(){return new x(this)}createWaveShaper(){return new E(this)}decodeAudioData(O,N,I){return c(this._nativeContext,O).then(D=>(typeof N=="function"&&N(D),D),D=>{throw typeof I=="function"&&I(D),D})}},Ntt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Ptt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),d={...Ntt,...u},g=i(f,d),p=a(f),_=p?t():null;super(c,!1,g,_),this._Q=e(this,p,g.Q,Op,wm),this._detune=e(this,p,g.detune,1200*Math.log2(Op),-1200*Math.log2(Op)),this._frequency=e(this,p,g.frequency,c.sampleRate/2,0),this._gain=e(this,p,g.gain,40*Math.log10(Op),wm),this._nativeBiquadFilterNode=g,o(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(c){this._nativeBiquadFilterNode.type=c}getFrequencyResponse(c,u,f){try{this._nativeBiquadFilterNode.getFrequencyResponse(c,u,f)}catch(d){throw d.code===11?r():d}if(c.length!==u.length||u.length!==f.length)throw r()}},Dtt=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=ap(c,l);if(!u){const f={Q:c.Q.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,detune:c.detune.value,frequency:c.frequency.value,gain:c.gain.value,type:c.type};c=e(l,f)}return s.set(l,c),u?(await n(l,o.Q,c.Q),await n(l,o.detune,c.detune),await n(l,o.frequency,c.frequency),await n(l,o.gain,c.gain)):(await r(l,o.Q,c.Q),await r(l,o.detune,c.detune),await r(l,o.frequency,c.frequency),await r(l,o.gain,c.gain)),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},Ltt=(n,e)=>(t,r)=>{const i=e.get(t);if(i!==void 0)return i;const s=n.get(t);if(s!==void 0)return s;try{const a=r();return a instanceof Promise?(n.set(t,a),a.catch(()=>!1).then(o=>(n.delete(t),e.set(t,o),o))):(e.set(t,a),a)}catch{return e.set(t,!1),!1}},Utt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Btt=(n,e,t,r,i)=>class extends n{constructor(a,o){const l=r(a),c={...Utt,...o},u=t(l,c),f=i(l)?e():null;super(a,!1,u,f)}},Ftt=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!ap(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfInputs:o.numberOfInputs};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},ztt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},jtt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u=s({...ztt,...l}),f=t(c,u),d=i(c)?e():null;super(o,!1,f,d)}},Htt=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!ap(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,numberOfOutputs:o.numberOfOutputs};o=n(a,c)}return r.set(a,o),await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},qtt=n=>(e,t,r)=>n(t,e,r),Vtt=n=>(e,t,r=0,i=0)=>{const s=e[r];if(s===void 0)throw n();return SL(t)?s.connect(t,0,i):s.connect(t,0)},Gtt=n=>(e,t)=>{const r=n(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},$tt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Wtt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...$tt,...c},d=r(u,f),g=s(u),p=g?t():null;super(l,!1,d,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=d,this._offset=e(this,g,d.offset,Op,wm),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeConstantSourceNode.onended=c;const u=this._nativeConstantSourceNode.onended;this._onended=u!==null&&u===c?l:u}start(l=0){if(this._nativeConstantSourceNode.start(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=l),this.context.state!=="closed"){bw(this);const c=()=>{this._nativeConstantSourceNode.removeEventListener("ended",c),Jy(this)&&IO(this)};this._nativeConstantSourceNode.addEventListener("ended",c)}}stop(l=0){this._nativeConstantSourceNode.stop(l),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=l)}},Ytt=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null;const l=async(c,u)=>{let f=t(c);const d=ap(f,u);if(!d){const g={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value};f=e(u,g),a!==null&&f.start(a),o!==null&&f.stop(o)}return s.set(u,f),d?await n(u,c.offset,f.offset):await r(u,c.offset,f.offset),await i(c,u,f),f};return{set start(c){a=c},set stop(c){o=c},render(c,u){const f=s.get(u);return f!==void 0?Promise.resolve(f):l(c,u)}}},Xtt=n=>e=>(n[0]=e,n[0]),Ktt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Ztt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u={...Ktt,...l},f=t(c,u),g=i(c)?e():null;super(o,!1,f,g),this._isBufferNullified=!1,this._nativeConvolverNode=f,u.buffer!==null&&s(this,u.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(o){if(this._nativeConvolverNode.buffer=o,o===null&&this._nativeConvolverNode.buffer!==null){const l=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=l.createBuffer(1,1,l.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(o){this._nativeConvolverNode.normalize=o}},Qtt=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!ap(o,a)){const c={buffer:o.buffer,channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,disableNormalization:!o.normalize};o=n(a,c)}return r.set(a,o),Qw(o)?await t(s,a,o.inputs[0]):await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},Jtt=(n,e)=>(t,r,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,r,i)}catch(s){throw s.name==="SyntaxError"?n():s}},ent=()=>new DOMException("","DataCloneError"),Ene=n=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(r=>{const i=()=>{t.onmessage=null,e.close(),t.close(),r()};t.onmessage=()=>i();try{e.postMessage(n,[n])}catch{}finally{i()}})},tnt=(n,e,t,r,i,s,a,o,l,c,u)=>(f,d)=>{const g=a(f)?f:s(f);if(i.has(d)){const p=t();return Promise.reject(p)}try{i.add(d)}catch{}return e(l,()=>l(g))?g.decodeAudioData(d).then(p=>(Ene(d).catch(()=>{}),e(o,()=>o(p))||u(p),n.add(p),p)):new Promise((p,_)=>{const y=async()=>{try{await Ene(d)}catch{}},v=x=>{_(x),y()};try{g.decodeAudioData(d,x=>{typeof x.copyFromChannel!="function"&&(c(x),wq(x)),n.add(x),y().then(()=>p(x))},x=>{v(x===null?r():x)})}catch(x){v(x)}})},nnt=(n,e,t,r,i,s,a,o)=>(l,c)=>{const u=e.get(l);if(u===void 0)throw new Error("Missing the expected cycle count.");const f=s(l.context),d=o(f);if(u===c){if(e.delete(l),!d&&a(l)){const g=r(l),{outputs:p}=t(l);for(const _ of p)if(PO(_)){const y=r(_[0]);n(g,y,_[1],_[2])}else{const y=i(_[0]);g.connect(y,_[1])}}}else e.set(l,u-c)},rnt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},snt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...rnt,...c},d=r(u,f),g=s(u),p=g?t(f.maxDelayTime):null;super(l,!1,d,p),this._delayTime=e(this,g,d.delayTime),a(this,f.maxDelayTime)}get delayTime(){return this._delayTime}},ant=(n,e,t,r,i)=>s=>{const a=new WeakMap,o=async(l,c)=>{let u=t(l);const f=ap(u,c);if(!f){const d={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,delayTime:u.delayTime.value,maxDelayTime:s};u=e(c,d)}return a.set(c,u),f?await n(c,l.delayTime,u.delayTime):await r(c,l.delayTime,u.delayTime),await i(l,c,u),u};return{render(l,c){const u=a.get(c);return u!==void 0?Promise.resolve(u):o(l,c)}}},ont=n=>(e,t,r,i)=>n(e[i],s=>s[0]===t&&s[1]===r),lnt=n=>(e,t)=>{n(e).delete(t)},cnt=n=>"delayTime"in n,unt=(n,e,t)=>function r(i,s){const a=vL(s)?s:t(n,s);if(cnt(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];const{outputs:o}=e(a);return Array.from(o).map(l=>r([...i,a],l[0])).reduce((l,c)=>l.concat(c),[])},aN=(n,e,t)=>{const r=e[t];if(r===void 0)throw n();return r},fnt=n=>(e,t=void 0,r=void 0,i=0)=>t===void 0?e.forEach(s=>s.disconnect()):typeof t=="number"?aN(n,e,t).disconnect():SL(t)?r===void 0?e.forEach(s=>s.disconnect(t)):i===void 0?aN(n,e,r).disconnect(t,0):aN(n,e,r).disconnect(t,0,i):r===void 0?e.forEach(s=>s.disconnect(t)):aN(n,e,r).disconnect(t,0),hnt={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},dnt=(n,e,t,r,i,s,a,o)=>class extends n{constructor(c,u){const f=s(c),d={...hnt,...u},g=r(f,d),p=a(f),_=p?t():null;super(c,!1,g,_),this._attack=e(this,p,g.attack),this._knee=e(this,p,g.knee),this._nativeDynamicsCompressorNode=g,this._ratio=e(this,p,g.ratio),this._release=e(this,p,g.release),this._threshold=e(this,p,g.threshold),o(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(c){const u=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=c,c>2)throw this._nativeDynamicsCompressorNode.channelCount=u,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(c){const u=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=c,c==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=u,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},pnt=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=ap(c,l);if(!u){const f={attack:c.attack.value,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,knee:c.knee.value,ratio:c.ratio.value,release:c.release.value,threshold:c.threshold.value};c=e(l,f)}return s.set(l,c),u?(await n(l,o.attack,c.attack),await n(l,o.knee,c.knee),await n(l,o.ratio,c.ratio),await n(l,o.release,c.release),await n(l,o.threshold,c.threshold)):(await r(l,o.attack,c.attack),await r(l,o.knee,c.knee),await r(l,o.ratio,c.ratio),await r(l,o.release,c.release),await r(l,o.threshold,c.threshold)),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},mnt=()=>new DOMException("","EncodingError"),gnt=n=>e=>new Promise((t,r)=>{if(n===null){r(new SyntaxError);return}const i=n.document.head;if(i===null)r(new SyntaxError);else{const s=n.document.createElement("script"),a=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(a),l=n.onerror,c=()=>{n.onerror=l,URL.revokeObjectURL(o)};n.onerror=(u,f,d,g,p)=>{if(f===o||f===n.location.href&&d===1&&g===1)return c(),r(p),!1;if(l!==null)return l(u,f,d,g,p)},s.onerror=()=>{c(),r(new SyntaxError)},s.onload=()=>{c(),t()},s.src=o,s.type="module",i.appendChild(s)}}),_nt=n=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=n(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(t,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(t,s===void 0?null:s,i)}},vnt=n=>(e,t,r)=>{Object.defineProperties(n,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{n!==null&&(delete n.currentFrame,delete n.currentTime)}},ynt=n=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw n()},bnt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Snt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...bnt,...l},f=r(c,u),d=s(c),g=d?t():null;super(o,!1,f,g),this._gain=e(this,d,f.gain,Op,wm)}get gain(){return this._gain}},Ent=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=ap(c,l);if(!u){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,gain:c.gain.value};c=e(l,f)}return s.set(l,c),u?await n(l,o.gain,c.gain):await r(l,o.gain,c.gain),await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},xnt=(n,e)=>t=>e(n,t),Tnt=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},wnt=n=>e=>{var t;return(t=n.get(e))!==null&&t!==void 0?t:0},Rnt=n=>e=>{const t=n(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},Ant=n=>e=>n.get(e),Lh=()=>new DOMException("","InvalidStateError"),Cnt=n=>e=>{const t=n.get(e);if(t===void 0)throw Lh();return t},Mnt=(n,e)=>t=>{let r=n.get(t);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),n.set(t,r),r},knt=n=>e=>{const t=n.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},IU=()=>new DOMException("","InvalidAccessError"),Ont=n=>{n.getFrequencyResponse=(e=>(t,r,i)=>{if(t.length!==r.length||r.length!==i.length)throw IU();return e.call(n,t,r,i)})(n.getFrequencyResponse)},Int={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Nnt=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=r(o),u=i(c),f={...Int,...l},d=e(c,u?null:o.baseLatency,f),g=u?t(f.feedback,f.feedforward):null;super(o,!1,d,g),Ont(d),this._nativeIIRFilterNode=d,s(this,1)}getFrequencyResponse(o,l,c){return this._nativeIIRFilterNode.getFrequencyResponse(o,l,c)}},$ge=(n,e,t,r,i,s,a,o,l,c,u)=>{const f=c.length;let d=o;for(let g=0;g<f;g+=1){let p=t[0]*c[g];for(let _=1;_<i;_+=1){const y=d-_&l-1;p+=t[_]*s[y],p-=n[_]*a[y]}for(let _=i;_<r;_+=1)p+=t[_]*s[d-_&l-1];for(let _=i;_<e;_+=1)p-=n[_]*a[d-_&l-1];s[d]=c[g],a[d]=p,d=d+1&l-1,u[g]=p}return d},Pnt=(n,e,t,r)=>{const i=t instanceof Float64Array?t:new Float64Array(t),s=r instanceof Float64Array?r:new Float64Array(r),a=i.length,o=s.length,l=Math.min(a,o);if(i[0]!==1){for(let p=0;p<a;p+=1)s[p]/=i[0];for(let p=1;p<o;p+=1)i[p]/=i[0]}const c=32,u=new Float32Array(c),f=new Float32Array(c),d=e.createBuffer(n.numberOfChannels,n.length,n.sampleRate),g=n.numberOfChannels;for(let p=0;p<g;p+=1){const _=n.getChannelData(p),y=d.getChannelData(p);u.fill(0),f.fill(0),$ge(i,a,s,o,l,u,f,0,c,_,y)}return d},Dnt=(n,e,t,r,i)=>(s,a)=>{const o=new WeakMap;let l=null;const c=async(u,f)=>{let d=null,g=e(u);const p=ap(g,f);if(f.createIIRFilter===void 0?d=n(f,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(g=f.createIIRFilter(a,s)),o.set(f,d===null?g:d),d!==null){if(l===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const y=new t(u.context.destination.channelCount,u.context.length,f.sampleRate);l=(async()=>{await r(u,y,y.destination);const v=await i(y);return Pnt(v,f,s,a)})()}const _=await l;return d.buffer=_,d.start(0),d}return await r(u,f,g),g};return{render(u,f){const d=o.get(f);return d!==void 0?Promise.resolve(d):c(u,f)}}},Lnt=(n,e,t,r,i,s)=>a=>(o,l)=>{const c=n.get(o);if(c===void 0){if(!a&&s(o)){const u=r(o),{outputs:f}=t(o);for(const d of f)if(PO(d)){const g=r(d[0]);e(u,g,d[1],d[2])}else{const g=i(d[0]);u.disconnect(g,d[1])}}n.set(o,l)}else n.set(o,c+l)},Unt=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},Bnt=(n,e)=>t=>n.has(t)||e(t),Fnt=(n,e)=>t=>n.has(t)||e(t),znt=(n,e)=>t=>{const r=n.get(t);return e(r)||e(t)},jnt=n=>e=>n!==null&&e instanceof n,Hnt=n=>e=>n!==null&&typeof n.AudioNode=="function"&&e instanceof n.AudioNode,qnt=n=>e=>n!==null&&typeof n.AudioParam=="function"&&e instanceof n.AudioParam,Vnt=(n,e)=>t=>n(t)||e(t),Gnt=n=>e=>n!==null&&e instanceof n,$nt=n=>n!==null&&n.isSecureContext,Wnt=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s),l=e(o,a);if(r(o))throw TypeError();super(s,!0,l,null),this._nativeMediaElementAudioSourceNode=l}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},Ynt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Xnt=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s);if(r(o))throw new TypeError;const l={...Ynt,...a},c=e(o,l);super(s,!1,c,null),this._nativeMediaStreamAudioDestinationNode=c}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},Knt=(n,e,t,r)=>class extends n{constructor(s,a){const o=t(s),l=e(o,a);if(r(o))throw new TypeError;super(s,!0,l,null),this._nativeMediaStreamAudioSourceNode=l}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},Znt=(n,e,t)=>class extends n{constructor(i,s){const a=t(i),o=e(a,s);super(i,!0,o,null)}},Qnt=(n,e,t,r,i,s)=>class extends t{constructor(o,l){super(o),this._nativeContext=o,kU.set(this,o),r(o)&&i.set(o,new Set),this._destination=new n(this,l),this._listener=e(this,o),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(o){const l=typeof o=="function"?s(this,o):null;this._nativeContext.onstatechange=l;const c=this._nativeContext.onstatechange;this._onstatechange=c!==null&&c===l?o:c}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},Nk=n=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=n.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},Jnt=(n,e)=>(t,r,i)=>{const s=new Set;return t.connect=(a=>(o,l=0,c=0)=>{const u=s.size===0;if(e(o))return a.call(t,o,l,c),n(s,[o,l,c],f=>f[0]===o&&f[1]===l&&f[2]===c,!0),u&&r(),o;a.call(t,o,l),n(s,[o,l],f=>f[0]===o&&f[1]===l,!0),u&&r()})(t.connect),t.disconnect=(a=>(o,l,c)=>{const u=s.size>0;if(o===void 0)a.apply(t),s.clear();else if(typeof o=="number"){a.call(t,o);for(const d of s)d[1]===o&&s.delete(d)}else{e(o)?a.call(t,o,l,c):a.call(t,o,l);for(const d of s)d[0]===o&&(l===void 0||d[1]===l)&&(c===void 0||d[2]===c)&&s.delete(d)}const f=s.size===0;u&&f&&i()})(t.disconnect),t},Sc=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t]&&(n[t]=r)},th=(n,e)=>{Sc(n,e,"channelCount"),Sc(n,e,"channelCountMode"),Sc(n,e,"channelInterpretation")},xne=n=>typeof n.getFloatTimeDomainData=="function",ert=n=>{n.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);n.getByteTimeDomainData(t);const r=Math.max(t.length,n.fftSize);for(let i=0;i<r;i+=1)e[i]=(t[i]-128)*.0078125;return e}},trt=(n,e)=>(t,r)=>{const i=t.createAnalyser();if(th(i,r),!(r.maxDecibels>r.minDecibels))throw e();return Sc(i,r,"fftSize"),Sc(i,r,"maxDecibels"),Sc(i,r,"minDecibels"),Sc(i,r,"smoothingTimeConstant"),n(xne,()=>xne(i))||ert(i),i},nrt=n=>n===null?null:n.hasOwnProperty("AudioBuffer")?n.AudioBuffer:null,gu=(n,e,t)=>{const r=e[t];r!==void 0&&r!==n[t].value&&(n[t].value=r)},rrt=n=>{n.start=(e=>{let t=!1;return(r=0,i=0,s)=>{if(t)throw Lh();e.call(n,r,i,s),t=!0}})(n.start)},Cq=n=>{n.start=(e=>(t=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(n,t,r,i)})(n.start)},Mq=n=>{n.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(n,t)})(n.stop)},irt=(n,e,t,r,i,s,a,o,l,c,u)=>(f,d)=>{const g=f.createBufferSource();return th(g,d),gu(g,d,"playbackRate"),Sc(g,d,"buffer"),Sc(g,d,"loop"),Sc(g,d,"loopEnd"),Sc(g,d,"loopStart"),e(t,()=>t(f))||rrt(g),e(r,()=>r(f))||l(g),e(i,()=>i(f))||c(g,f),e(s,()=>s(f))||Cq(g),e(a,()=>a(f))||u(g,f),e(o,()=>o(f))||Mq(g),n(f,g),g},srt=n=>n===null?null:n.hasOwnProperty("AudioContext")?n.AudioContext:n.hasOwnProperty("webkitAudioContext")?n.webkitAudioContext:null,art=(n,e)=>(t,r,i)=>{const s=t.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const a=n(t,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(a,"channelCount",o=>()=>o.call(a),o=>l=>{o.call(a,l);try{s.channelCount=l}catch(c){if(l>s.maxChannelCount)throw c}}),e(a,"channelCountMode",o=>()=>o.call(a),o=>l=>{o.call(a,l),s.channelCountMode=l}),e(a,"channelInterpretation",o=>()=>o.call(a),o=>l=>{o.call(a,l),s.channelInterpretation=l}),Object.defineProperty(a,"maxChannelCount",{get:()=>s.maxChannelCount}),a.connect(s),a},ort=n=>n===null?null:n.hasOwnProperty("AudioWorkletNode")?n.AudioWorkletNode:null,lrt=n=>{const{port1:e}=new MessageChannel;try{e.postMessage(n)}finally{e.close()}},crt=(n,e,t,r,i)=>(s,a,o,l,c,u)=>{if(o!==null)try{const f=new o(s,l,u),d=new Map;let g=null;if(Object.defineProperties(f,{channelCount:{get:()=>u.channelCount,set:()=>{throw n()}},channelCountMode:{get:()=>"explicit",set:()=>{throw n()}},onprocessorerror:{get:()=>g,set:p=>{typeof g=="function"&&f.removeEventListener("processorerror",g),g=typeof p=="function"?p:null,typeof g=="function"&&f.addEventListener("processorerror",g)}}}),f.addEventListener=(p=>(..._)=>{if(_[0]==="processorerror"){const y=typeof _[1]=="function"?_[1]:typeof _[1]=="object"&&_[1]!==null&&typeof _[1].handleEvent=="function"?_[1].handleEvent:null;if(y!==null){const v=d.get(_[1]);v!==void 0?_[1]=v:(_[1]=x=>{x.type==="error"?(Object.defineProperties(x,{type:{value:"processorerror"}}),y(x)):y(new ErrorEvent(_[0],{...x}))},d.set(y,_[1]))}}return p.call(f,"error",_[1],_[2]),p.call(f,..._)})(f.addEventListener),f.removeEventListener=(p=>(..._)=>{if(_[0]==="processorerror"){const y=d.get(_[1]);y!==void 0&&(d.delete(_[1]),_[1]=y)}return p.call(f,"error",_[1],_[2]),p.call(f,_[0],_[1],_[2])})(f.removeEventListener),u.numberOfOutputs!==0){const p=t(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return f.connect(p).connect(s.destination),i(f,()=>p.disconnect(),()=>p.connect(s.destination))}return f}catch(f){throw f.code===11?r():f}if(c===void 0)throw r();return lrt(u),e(s,a,c,u)},Wge=(n,e)=>n===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(n*e))))),urt=n=>new Promise((e,t)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),t(s)},i.postMessage(n)}),frt=async(n,e)=>{const t=await urt(e);return new n(t)},hrt=(n,e,t,r)=>{let i=I9.get(n);i===void 0&&(i=new WeakMap,I9.set(n,i));const s=frt(t,r);return i.set(e,s),s},drt=(n,e,t,r,i,s,a,o,l,c,u,f,d)=>(g,p,_,y)=>{if(y.numberOfInputs===0&&y.numberOfOutputs===0)throw l();const v=Array.isArray(y.outputChannelCount)?y.outputChannelCount:Array.from(y.outputChannelCount);if(v.some(Ue=>Ue<1))throw l();if(v.length!==y.numberOfOutputs)throw e();if(y.channelCountMode!=="explicit")throw l();const x=y.channelCount*y.numberOfInputs,E=v.reduce((Ue,Ge)=>Ue+Ge,0),M=_.parameterDescriptors===void 0?0:_.parameterDescriptors.length;if(x+M>6||E>6)throw l();const O=new MessageChannel,N=[],I=[];for(let Ue=0;Ue<y.numberOfInputs;Ue+=1)N.push(a(g,{channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation,gain:1})),I.push(i(g,{channelCount:y.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:y.channelCount}));const D=[];if(_.parameterDescriptors!==void 0)for(const{defaultValue:Ue,maxValue:Ge,minValue:ze,name:Be}of _.parameterDescriptors){const me=s(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:y.parameterData[Be]!==void 0?y.parameterData[Be]:Ue===void 0?0:Ue});Object.defineProperties(me.offset,{defaultValue:{get:()=>Ue===void 0?0:Ue},maxValue:{get:()=>Ge===void 0?Op:Ge},minValue:{get:()=>ze===void 0?wm:ze}}),D.push(me)}const V=r(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,x+M)}),G=Wge(p,g.sampleRate),Q=o(g,G,x+M,Math.max(1,E)),B=i(g,{channelCount:Math.max(1,E),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,E)}),$=[];for(let Ue=0;Ue<y.numberOfOutputs;Ue+=1)$.push(r(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:v[Ue]}));for(let Ue=0;Ue<y.numberOfInputs;Ue+=1){N[Ue].connect(I[Ue]);for(let Ge=0;Ge<y.channelCount;Ge+=1)I[Ue].connect(V,Ge,Ue*y.channelCount+Ge)}const U=new Vge(_.parameterDescriptors===void 0?[]:_.parameterDescriptors.map(({name:Ue},Ge)=>{const ze=D[Ge];return ze.connect(V,0,x+Ge),ze.start(0),[Ue,ze.offset]}));V.connect(Q);let J=y.channelInterpretation,W=null;const q=y.numberOfOutputs===0?[Q]:$,Y={get bufferSize(){return G},get channelCount(){return y.channelCount},set channelCount(Ue){throw t()},get channelCountMode(){return y.channelCountMode},set channelCountMode(Ue){throw t()},get channelInterpretation(){return J},set channelInterpretation(Ue){for(const Ge of N)Ge.channelInterpretation=Ue;J=Ue},get context(){return Q.context},get inputs(){return N},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get onprocessorerror(){return W},set onprocessorerror(Ue){typeof W=="function"&&Y.removeEventListener("processorerror",W),W=typeof Ue=="function"?Ue:null,typeof W=="function"&&Y.addEventListener("processorerror",W)},get parameters(){return U},get port(){return O.port2},addEventListener(...Ue){return Q.addEventListener(Ue[0],Ue[1],Ue[2])},connect:n.bind(null,q),disconnect:c.bind(null,q),dispatchEvent(...Ue){return Q.dispatchEvent(Ue[0])},removeEventListener(...Ue){return Q.removeEventListener(Ue[0],Ue[1],Ue[2])}},ae=new Map;O.port1.addEventListener=(Ue=>(...Ge)=>{if(Ge[0]==="message"){const ze=typeof Ge[1]=="function"?Ge[1]:typeof Ge[1]=="object"&&Ge[1]!==null&&typeof Ge[1].handleEvent=="function"?Ge[1].handleEvent:null;if(ze!==null){const Be=ae.get(Ge[1]);Be!==void 0?Ge[1]=Be:(Ge[1]=me=>{u(g.currentTime,g.sampleRate,()=>ze(me))},ae.set(ze,Ge[1]))}}return Ue.call(O.port1,Ge[0],Ge[1],Ge[2])})(O.port1.addEventListener),O.port1.removeEventListener=(Ue=>(...Ge)=>{if(Ge[0]==="message"){const ze=ae.get(Ge[1]);ze!==void 0&&(ae.delete(Ge[1]),Ge[1]=ze)}return Ue.call(O.port1,Ge[0],Ge[1],Ge[2])})(O.port1.removeEventListener);let Z=null;Object.defineProperty(O.port1,"onmessage",{get:()=>Z,set:Ue=>{typeof Z=="function"&&O.port1.removeEventListener("message",Z),Z=typeof Ue=="function"?Ue:null,typeof Z=="function"&&(O.port1.addEventListener("message",Z),O.port1.start())}}),_.prototype.port=O.port1;let K=null;hrt(g,Y,_,y).then(Ue=>K=Ue);const le=xL(y.numberOfInputs,y.channelCount),ce=xL(y.numberOfOutputs,v),de=_.parameterDescriptors===void 0?[]:_.parameterDescriptors.reduce((Ue,{name:Ge})=>({...Ue,[Ge]:new Float32Array(128)}),{});let Me=!0;const qe=()=>{y.numberOfOutputs>0&&Q.disconnect(B);for(let Ue=0,Ge=0;Ue<y.numberOfOutputs;Ue+=1){const ze=$[Ue];for(let Be=0;Be<v[Ue];Be+=1)B.disconnect(ze,Ge+Be,Be);Ge+=v[Ue]}},Pe=new Map;Q.onaudioprocess=({inputBuffer:Ue,outputBuffer:Ge})=>{if(K!==null){const ze=f(Y);for(let Be=0;Be<G;Be+=128){for(let me=0;me<y.numberOfInputs;me+=1)for(let Se=0;Se<y.channelCount;Se+=1)EL(Ue,le[me],Se,Se,Be);_.parameterDescriptors!==void 0&&_.parameterDescriptors.forEach(({name:me},Se)=>{EL(Ue,de,me,x+Se,Be)});for(let me=0;me<y.numberOfInputs;me+=1)for(let Se=0;Se<v[me];Se+=1)ce[me][Se].byteLength===0&&(ce[me][Se]=new Float32Array(128));try{const me=le.map((Ie,be)=>{if(ze[be].size>0)return Pe.set(be,G/128),Ie;const ot=Pe.get(be);return ot===void 0?[]:(Ie.every(lt=>lt.every(ct=>ct===0))&&(ot===1?Pe.delete(be):Pe.set(be,ot-1)),Ie)});Me=u(g.currentTime+Be/g.sampleRate,g.sampleRate,()=>K.process(me,ce,de));for(let Ie=0,be=0;Ie<y.numberOfOutputs;Ie+=1){for(let Ke=0;Ke<v[Ie];Ke+=1)Gge(Ge,ce[Ie],Ke,be+Ke,Be);be+=v[Ie]}}catch(me){Me=!1,Y.dispatchEvent(new ErrorEvent("processorerror",{colno:me.colno,filename:me.filename,lineno:me.lineno,message:me.message}))}if(!Me){for(let me=0;me<y.numberOfInputs;me+=1){N[me].disconnect(I[me]);for(let Se=0;Se<y.channelCount;Se+=1)I[Be].disconnect(V,Se,me*y.channelCount+Se)}if(_.parameterDescriptors!==void 0){const me=_.parameterDescriptors.length;for(let Se=0;Se<me;Se+=1){const Ie=D[Se];Ie.disconnect(V,0,x+Se),Ie.stop()}}V.disconnect(Q),Q.onaudioprocess=null,Ce?qe():at();break}}}};let Ce=!1;const Xe=a(g,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$e=()=>Q.connect(Xe).connect(g.destination),at=()=>{Q.disconnect(Xe),Xe.disconnect()},pt=()=>{if(Me){at(),y.numberOfOutputs>0&&Q.connect(B);for(let Ue=0,Ge=0;Ue<y.numberOfOutputs;Ue+=1){const ze=$[Ue];for(let Be=0;Be<v[Ue];Be+=1)B.connect(ze,Ge+Be,Be);Ge+=v[Ue]}}Ce=!0},oe=()=>{Me&&($e(),qe()),Ce=!1};return $e(),d(Y,pt,oe)},Yge=(n,e)=>{const t=n.createBiquadFilter();return th(t,e),gu(t,e,"Q"),gu(t,e,"detune"),gu(t,e,"frequency"),gu(t,e,"gain"),Sc(t,e,"type"),t},prt=(n,e)=>(t,r)=>{const i=t.createChannelMerger(r.numberOfInputs);return n!==null&&n.name==="webkitAudioContext"&&e(t,i),th(i,r),i},mrt=n=>{const e=n.numberOfOutputs;Object.defineProperty(n,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Lh()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Lh()}}),Object.defineProperty(n,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Lh()}})},DO=(n,e)=>{const t=n.createChannelSplitter(e.numberOfOutputs);return th(t,e),mrt(t),t},grt=(n,e,t,r,i)=>(s,a)=>{if(s.createConstantSource===void 0)return t(s,a);const o=s.createConstantSource();return th(o,a),gu(o,a,"offset"),e(r,()=>r(s))||Cq(o),e(i,()=>i(s))||Mq(o),n(s,o),o},Jw=(n,e)=>(n.connect=e.connect.bind(e),n.disconnect=e.disconnect.bind(e),n),_rt=(n,e,t,r)=>(i,{offset:s,...a})=>{const o=i.createBuffer(1,2,44100),l=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),c=t(i,{...a,gain:s}),u=o.getChannelData(0);u[0]=1,u[1]=1,l.buffer=o,l.loop=!0;const f={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(p){c.channelCount=p},get channelCountMode(){return c.channelCountMode},set channelCountMode(p){c.channelCountMode=p},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(p){c.channelInterpretation=p},get context(){return c.context},get inputs(){return[]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get offset(){return c.gain},get onended(){return l.onended},set onended(p){l.onended=p},addEventListener(...p){return l.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return l.dispatchEvent(p[0])},removeEventListener(...p){return l.removeEventListener(p[0],p[1],p[2])},start(p=0){l.start.call(l,p)},stop(p=0){l.stop.call(l,p)}},d=()=>l.connect(c),g=()=>l.disconnect(c);return n(i,l),r(Jw(f,c),d,g)},vrt=(n,e)=>(t,r)=>{const i=t.createConvolver();if(th(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Sc(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>a=>{if(a>2)throw n();return s.call(i,a)}),r.channelCountMode==="max"))throw n();return e(i,"channelCountMode",s=>()=>s.call(i),s=>a=>{if(a==="max")throw n();return s.call(i,a)}),i},Xge=(n,e)=>{const t=n.createDelay(e.maxDelayTime);return th(t,e),gu(t,e,"delayTime"),t},yrt=n=>(e,t)=>{const r=e.createDynamicsCompressor();if(th(r,t),t.channelCount>2||t.channelCountMode==="max")throw n();return gu(r,t,"attack"),gu(r,t,"knee"),gu(r,t,"ratio"),gu(r,t,"release"),gu(r,t,"threshold"),r},Gm=(n,e)=>{const t=n.createGain();return th(t,e),gu(t,e,"gain"),t},brt=n=>(e,t,r)=>{if(e.createIIRFilter===void 0)return n(e,t,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return th(i,r),i};function Srt(n,e){const t=e[0]*e[0]+e[1]*e[1];return[(n[0]*e[0]+n[1]*e[1])/t,(n[1]*e[0]-n[0]*e[1])/t]}function Ert(n,e){return[n[0]*e[0]-n[1]*e[1],n[0]*e[1]+n[1]*e[0]]}function Tne(n,e){let t=[0,0];for(let r=n.length-1;r>=0;r-=1)t=Ert(t,e),t[0]+=n[r];return t}const xrt=(n,e,t,r)=>(i,s,{channelCount:a,channelCountMode:o,channelInterpretation:l,feedback:c,feedforward:u})=>{const f=Wge(s,i.sampleRate),d=c instanceof Float64Array?c:new Float64Array(c),g=u instanceof Float64Array?u:new Float64Array(u),p=d.length,_=g.length,y=Math.min(p,_);if(p===0||p>20)throw r();if(d[0]===0)throw e();if(_===0||_>20)throw r();if(g[0]===0)throw e();if(d[0]!==1){for(let D=0;D<_;D+=1)g[D]/=d[0];for(let D=1;D<p;D+=1)d[D]/=d[0]}const v=t(i,f,a,a);v.channelCount=a,v.channelCountMode=o,v.channelInterpretation=l;const x=32,E=[],M=[],O=[];for(let D=0;D<a;D+=1){E.push(0);const V=new Float32Array(x),G=new Float32Array(x);V.fill(0),G.fill(0),M.push(V),O.push(G)}v.onaudioprocess=D=>{const V=D.inputBuffer,G=D.outputBuffer,Q=V.numberOfChannels;for(let B=0;B<Q;B+=1){const $=V.getChannelData(B),U=G.getChannelData(B);E[B]=$ge(d,p,g,_,y,M[B],O[B],E[B],x,$,U)}};const N=i.sampleRate/2;return Jw({get bufferSize(){return f},get channelCount(){return v.channelCount},set channelCount(D){v.channelCount=D},get channelCountMode(){return v.channelCountMode},set channelCountMode(D){v.channelCountMode=D},get channelInterpretation(){return v.channelInterpretation},set channelInterpretation(D){v.channelInterpretation=D},get context(){return v.context},get inputs(){return[v]},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},addEventListener(...D){return v.addEventListener(D[0],D[1],D[2])},dispatchEvent(...D){return v.dispatchEvent(D[0])},getFrequencyResponse(D,V,G){if(D.length!==V.length||V.length!==G.length)throw n();const Q=D.length;for(let B=0;B<Q;B+=1){const $=-Math.PI*(D[B]/N),U=[Math.cos($),Math.sin($)],J=Tne(g,U),W=Tne(d,U),q=Srt(J,W);V[B]=Math.sqrt(q[0]*q[0]+q[1]*q[1]),G[B]=Math.atan2(q[1],q[0])}},removeEventListener(...D){return v.removeEventListener(D[0],D[1],D[2])}},v)},Trt=(n,e)=>n.createMediaElementSource(e.mediaElement),wrt=(n,e)=>{const t=n.createMediaStreamDestination();return th(t,e),t.numberOfOutputs===1&&Object.defineProperty(t,"numberOfOutputs",{get:()=>0}),t},Rrt=(n,{mediaStream:e})=>{const t=e.getAudioTracks();t.sort((s,a)=>s.id<a.id?-1:s.id>a.id?1:0);const r=t.slice(0,1),i=n.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},Art=(n,e)=>(t,{mediaStreamTrack:r})=>{if(typeof t.createMediaStreamTrackSource=="function")return t.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=t.createMediaStreamSource(i);if(r.kind!=="audio")throw n();if(e(t))throw new TypeError;return s},Crt=n=>n===null?null:n.hasOwnProperty("OfflineAudioContext")?n.OfflineAudioContext:n.hasOwnProperty("webkitOfflineAudioContext")?n.webkitOfflineAudioContext:null,Mrt=(n,e,t,r,i,s)=>(a,o)=>{const l=a.createOscillator();return th(l,o),gu(l,o,"detune"),gu(l,o,"frequency"),o.periodicWave!==void 0?l.setPeriodicWave(o.periodicWave):Sc(l,o,"type"),e(t,()=>t(a))||Cq(l),e(r,()=>r(a))||s(l,a),e(i,()=>i(a))||Mq(l),n(a,l),l},krt=n=>(e,t)=>{const r=e.createPanner();return r.orientationX===void 0?n(e,t):(th(r,t),gu(r,t,"orientationX"),gu(r,t,"orientationY"),gu(r,t,"orientationZ"),gu(r,t,"positionX"),gu(r,t,"positionY"),gu(r,t,"positionZ"),Sc(r,t,"coneInnerAngle"),Sc(r,t,"coneOuterAngle"),Sc(r,t,"coneOuterGain"),Sc(r,t,"distanceModel"),Sc(r,t,"maxDistance"),Sc(r,t,"panningModel"),Sc(r,t,"refDistance"),Sc(r,t,"rolloffFactor"),r)},Ort=(n,e,t,r,i,s,a,o,l,c)=>(u,{coneInnerAngle:f,coneOuterAngle:d,coneOuterGain:g,distanceModel:p,maxDistance:_,orientationX:y,orientationY:v,orientationZ:x,panningModel:E,positionX:M,positionY:O,positionZ:N,refDistance:I,rolloffFactor:D,...V})=>{const G=u.createPanner();if(V.channelCount>2||V.channelCountMode==="max")throw a();th(G,V);const Q={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},B=t(u,{...Q,channelInterpretation:"speakers",numberOfInputs:6}),$=r(u,{...V,gain:1}),U=r(u,{...Q,gain:1}),J=r(u,{...Q,gain:0}),W=r(u,{...Q,gain:0}),q=r(u,{...Q,gain:0}),Y=r(u,{...Q,gain:0}),ae=r(u,{...Q,gain:0}),Z=i(u,256,6,1),K=s(u,{...Q,curve:new Float32Array([1,1]),oversample:"none"});let ne=[y,v,x],le=[M,O,N];const ce=new Float32Array(1);Z.onaudioprocess=({inputBuffer:Pe})=>{const Ce=[l(Pe,ce,0),l(Pe,ce,1),l(Pe,ce,2)];Ce.some(($e,at)=>$e!==ne[at])&&(G.setOrientation(...Ce),ne=Ce);const Xe=[l(Pe,ce,3),l(Pe,ce,4),l(Pe,ce,5)];Xe.some(($e,at)=>$e!==le[at])&&(G.setPosition(...Xe),le=Xe)},Object.defineProperty(J.gain,"defaultValue",{get:()=>0}),Object.defineProperty(W.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(Y.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ae.gain,"defaultValue",{get:()=>0});const de={get bufferSize(){},get channelCount(){return G.channelCount},set channelCount(Pe){if(Pe>2)throw a();$.channelCount=Pe,G.channelCount=Pe},get channelCountMode(){return G.channelCountMode},set channelCountMode(Pe){if(Pe==="max")throw a();$.channelCountMode=Pe,G.channelCountMode=Pe},get channelInterpretation(){return G.channelInterpretation},set channelInterpretation(Pe){$.channelInterpretation=Pe,G.channelInterpretation=Pe},get coneInnerAngle(){return G.coneInnerAngle},set coneInnerAngle(Pe){G.coneInnerAngle=Pe},get coneOuterAngle(){return G.coneOuterAngle},set coneOuterAngle(Pe){G.coneOuterAngle=Pe},get coneOuterGain(){return G.coneOuterGain},set coneOuterGain(Pe){if(Pe<0||Pe>1)throw e();G.coneOuterGain=Pe},get context(){return G.context},get distanceModel(){return G.distanceModel},set distanceModel(Pe){G.distanceModel=Pe},get inputs(){return[$]},get maxDistance(){return G.maxDistance},set maxDistance(Pe){if(Pe<0)throw new RangeError;G.maxDistance=Pe},get numberOfInputs(){return G.numberOfInputs},get numberOfOutputs(){return G.numberOfOutputs},get orientationX(){return U.gain},get orientationY(){return J.gain},get orientationZ(){return W.gain},get panningModel(){return G.panningModel},set panningModel(Pe){G.panningModel=Pe},get positionX(){return q.gain},get positionY(){return Y.gain},get positionZ(){return ae.gain},get refDistance(){return G.refDistance},set refDistance(Pe){if(Pe<0)throw new RangeError;G.refDistance=Pe},get rolloffFactor(){return G.rolloffFactor},set rolloffFactor(Pe){if(Pe<0)throw new RangeError;G.rolloffFactor=Pe},addEventListener(...Pe){return $.addEventListener(Pe[0],Pe[1],Pe[2])},dispatchEvent(...Pe){return $.dispatchEvent(Pe[0])},removeEventListener(...Pe){return $.removeEventListener(Pe[0],Pe[1],Pe[2])}};f!==de.coneInnerAngle&&(de.coneInnerAngle=f),d!==de.coneOuterAngle&&(de.coneOuterAngle=d),g!==de.coneOuterGain&&(de.coneOuterGain=g),p!==de.distanceModel&&(de.distanceModel=p),_!==de.maxDistance&&(de.maxDistance=_),y!==de.orientationX.value&&(de.orientationX.value=y),v!==de.orientationY.value&&(de.orientationY.value=v),x!==de.orientationZ.value&&(de.orientationZ.value=x),E!==de.panningModel&&(de.panningModel=E),M!==de.positionX.value&&(de.positionX.value=M),O!==de.positionY.value&&(de.positionY.value=O),N!==de.positionZ.value&&(de.positionZ.value=N),I!==de.refDistance&&(de.refDistance=I),D!==de.rolloffFactor&&(de.rolloffFactor=D),(ne[0]!==1||ne[1]!==0||ne[2]!==0)&&G.setOrientation(...ne),(le[0]!==0||le[1]!==0||le[2]!==0)&&G.setPosition(...le);const Me=()=>{$.connect(G),n($,K,0,0),K.connect(U).connect(B,0,0),K.connect(J).connect(B,0,1),K.connect(W).connect(B,0,2),K.connect(q).connect(B,0,3),K.connect(Y).connect(B,0,4),K.connect(ae).connect(B,0,5),B.connect(Z).connect(u.destination)},qe=()=>{$.disconnect(G),o($,K,0,0),K.disconnect(U),U.disconnect(B),K.disconnect(J),J.disconnect(B),K.disconnect(W),W.disconnect(B),K.disconnect(q),q.disconnect(B),K.disconnect(Y),Y.disconnect(B),K.disconnect(ae),ae.disconnect(B),B.disconnect(Z),Z.disconnect(u.destination)};return c(Jw(de,G),Me,qe)},Irt=n=>(e,{disableNormalization:t,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),a=i instanceof Float32Array?i:new Float32Array(i),o=e.createPeriodicWave(a,s,{disableNormalization:t});if(Array.from(r).length<2)throw n();return o},LO=(n,e,t,r)=>n.createScriptProcessor(e,t,r),Nrt=(n,e)=>(t,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return n(t,r);const s=t.createStereoPanner();return th(s,r),gu(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:a=>{if(a!==i)throw e()}}),s},Prt=(n,e,t,r,i,s)=>{const o=new Float32Array([1,1]),l=Math.PI/2,c={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},u={...c,oversample:"none"},f=(p,_,y,v)=>{const x=new Float32Array(16385),E=new Float32Array(16385);for(let V=0;V<16385;V+=1){const G=V/16384*l;x[V]=Math.cos(G),E[V]=Math.sin(G)}const M=t(p,{...c,gain:0}),O=r(p,{...u,curve:x}),N=r(p,{...u,curve:o}),I=t(p,{...c,gain:0}),D=r(p,{...u,curve:E});return{connectGraph(){_.connect(M),_.connect(N.inputs===void 0?N:N.inputs[0]),_.connect(I),N.connect(y),y.connect(O.inputs===void 0?O:O.inputs[0]),y.connect(D.inputs===void 0?D:D.inputs[0]),O.connect(M.gain),D.connect(I.gain),M.connect(v,0,0),I.connect(v,0,1)},disconnectGraph(){_.disconnect(M),_.disconnect(N.inputs===void 0?N:N.inputs[0]),_.disconnect(I),N.disconnect(y),y.disconnect(O.inputs===void 0?O:O.inputs[0]),y.disconnect(D.inputs===void 0?D:D.inputs[0]),O.disconnect(M.gain),D.disconnect(I.gain),M.disconnect(v,0,0),I.disconnect(v,0,1)}}},d=(p,_,y,v)=>{const x=new Float32Array(16385),E=new Float32Array(16385),M=new Float32Array(16385),O=new Float32Array(16385),N=Math.floor(16385/2);for(let q=0;q<16385;q+=1)if(q>N){const Y=(q-N)/(16384-N)*l;x[q]=Math.cos(Y),E[q]=Math.sin(Y),M[q]=0,O[q]=1}else{const Y=q/(16384-N)*l;x[q]=1,E[q]=0,M[q]=Math.cos(Y),O[q]=Math.sin(Y)}const I=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),D=t(p,{...c,gain:0}),V=r(p,{...u,curve:x}),G=t(p,{...c,gain:0}),Q=r(p,{...u,curve:E}),B=r(p,{...u,curve:o}),$=t(p,{...c,gain:0}),U=r(p,{...u,curve:M}),J=t(p,{...c,gain:0}),W=r(p,{...u,curve:O});return{connectGraph(){_.connect(I),_.connect(B.inputs===void 0?B:B.inputs[0]),I.connect(D,0),I.connect(G,0),I.connect($,1),I.connect(J,1),B.connect(y),y.connect(V.inputs===void 0?V:V.inputs[0]),y.connect(Q.inputs===void 0?Q:Q.inputs[0]),y.connect(U.inputs===void 0?U:U.inputs[0]),y.connect(W.inputs===void 0?W:W.inputs[0]),V.connect(D.gain),Q.connect(G.gain),U.connect($.gain),W.connect(J.gain),D.connect(v,0,0),$.connect(v,0,0),G.connect(v,0,1),J.connect(v,0,1)},disconnectGraph(){_.disconnect(I),_.disconnect(B.inputs===void 0?B:B.inputs[0]),I.disconnect(D,0),I.disconnect(G,0),I.disconnect($,1),I.disconnect(J,1),B.disconnect(y),y.disconnect(V.inputs===void 0?V:V.inputs[0]),y.disconnect(Q.inputs===void 0?Q:Q.inputs[0]),y.disconnect(U.inputs===void 0?U:U.inputs[0]),y.disconnect(W.inputs===void 0?W:W.inputs[0]),V.disconnect(D.gain),Q.disconnect(G.gain),U.disconnect($.gain),W.disconnect(J.gain),D.disconnect(v,0,0),$.disconnect(v,0,0),G.disconnect(v,0,1),J.disconnect(v,0,1)}}},g=(p,_,y,v,x)=>{if(_===1)return f(p,y,v,x);if(_===2)return d(p,y,v,x);throw i()};return(p,{channelCount:_,channelCountMode:y,pan:v,...x})=>{if(y==="max")throw i();const E=n(p,{...x,channelCount:1,channelCountMode:y,numberOfInputs:2}),M=t(p,{...x,channelCount:_,channelCountMode:y,gain:1}),O=t(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:v});let{connectGraph:N,disconnectGraph:I}=g(p,_,M,O,E);Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"maxValue",{get:()=>1}),Object.defineProperty(O.gain,"minValue",{get:()=>-1});const D={get bufferSize(){},get channelCount(){return M.channelCount},set channelCount(B){M.channelCount!==B&&(V&&I(),{connectGraph:N,disconnectGraph:I}=g(p,B,M,O,E),V&&N()),M.channelCount=B},get channelCountMode(){return M.channelCountMode},set channelCountMode(B){if(B==="clamped-max"||B==="max")throw i();M.channelCountMode=B},get channelInterpretation(){return M.channelInterpretation},set channelInterpretation(B){M.channelInterpretation=B},get context(){return M.context},get inputs(){return[M]},get numberOfInputs(){return M.numberOfInputs},get numberOfOutputs(){return M.numberOfOutputs},get pan(){return O.gain},addEventListener(...B){return M.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return M.dispatchEvent(B[0])},removeEventListener(...B){return M.removeEventListener(B[0],B[1],B[2])}};let V=!1;const G=()=>{N(),V=!0},Q=()=>{I(),V=!1};return s(Jw(D,E),G,Q)}},Drt=(n,e,t,r,i,s,a)=>(o,l)=>{const c=o.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&o.createGain().gain.automationRate===void 0)return t(o,l);th(c,l);const u=l.curve===null||l.curve instanceof Float32Array?l.curve:new Float32Array(l.curve);if(u!==null&&u.length<2)throw e();Sc(c,{curve:u},"curve"),Sc(c,l,"oversample");let f=null,d=!1;return a(c,"curve",_=>()=>_.call(c),_=>y=>(_.call(c,y),d&&(r(y)&&f===null?f=n(o,c):!r(y)&&f!==null&&(f(),f=null)),y)),i(c,()=>{d=!0,r(c.curve)&&(f=n(o,c))},()=>{d=!1,f!==null&&(f(),f=null)})},Lrt=(n,e,t,r,i)=>(s,{curve:a,oversample:o,...l})=>{const c=s.createWaveShaper(),u=s.createWaveShaper();th(c,l),th(u,l);const f=t(s,{...l,gain:1}),d=t(s,{...l,gain:-1}),g=t(s,{...l,gain:1}),p=t(s,{...l,gain:-1});let _=null,y=!1,v=null;const x={get bufferSize(){},get channelCount(){return c.channelCount},set channelCount(O){f.channelCount=O,d.channelCount=O,c.channelCount=O,g.channelCount=O,u.channelCount=O,p.channelCount=O},get channelCountMode(){return c.channelCountMode},set channelCountMode(O){f.channelCountMode=O,d.channelCountMode=O,c.channelCountMode=O,g.channelCountMode=O,u.channelCountMode=O,p.channelCountMode=O},get channelInterpretation(){return c.channelInterpretation},set channelInterpretation(O){f.channelInterpretation=O,d.channelInterpretation=O,c.channelInterpretation=O,g.channelInterpretation=O,u.channelInterpretation=O,p.channelInterpretation=O},get context(){return c.context},get curve(){return v},set curve(O){if(O!==null&&O.length<2)throw e();if(O===null)c.curve=O,u.curve=O;else{const N=O.length,I=new Float32Array(N+2-N%2),D=new Float32Array(N+2-N%2);I[0]=O[0],D[0]=-O[N-1];const V=Math.ceil((N+1)/2),G=(N+1)/2-1;for(let Q=1;Q<V;Q+=1){const B=Q/V*G,$=Math.floor(B),U=Math.ceil(B);I[Q]=$===U?O[$]:(1-(B-$))*O[$]+(1-(U-B))*O[U],D[Q]=$===U?-O[N-1-$]:-((1-(B-$))*O[N-1-$])-(1-(U-B))*O[N-1-U]}I[V]=N%2===1?O[V-1]:(O[V-2]+O[V-1])/2,c.curve=I,u.curve=D}v=O,y&&(r(v)&&_===null?_=n(s,f):_!==null&&(_(),_=null))},get inputs(){return[f]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return c.numberOfOutputs},get oversample(){return c.oversample},set oversample(O){c.oversample=O,u.oversample=O},addEventListener(...O){return f.addEventListener(O[0],O[1],O[2])},dispatchEvent(...O){return f.dispatchEvent(O[0])},removeEventListener(...O){return f.removeEventListener(O[0],O[1],O[2])}};a!==null&&(x.curve=a instanceof Float32Array?a:new Float32Array(a)),o!==x.oversample&&(x.oversample=o);const E=()=>{f.connect(c).connect(g),f.connect(d).connect(u).connect(p).connect(g),y=!0,r(v)&&(_=n(s,f))},M=()=>{f.disconnect(c),c.disconnect(g),f.disconnect(d),d.disconnect(u),u.disconnect(p),p.disconnect(g),y=!1,_!==null&&(_(),_=null)};return i(Jw(x,g),E,M)},$p=()=>new DOMException("","NotSupportedError"),Urt={numberOfChannels:1},Brt=(n,e,t,r,i)=>class extends n{constructor(a,o,l){let c;if(typeof a=="number"&&o!==void 0&&l!==void 0)c={length:o,numberOfChannels:a,sampleRate:l};else if(typeof a=="object")c=a;else throw new Error("The given parameters are not valid.");const{length:u,numberOfChannels:f,sampleRate:d}={...Urt,...c},g=r(f,u,d);e(Nk,()=>Nk(g))||g.addEventListener("statechange",(()=>{let p=0;const _=y=>{this._state==="running"&&(p>0?(g.removeEventListener("statechange",_),y.stopImmediatePropagation(),this._waitForThePromiseToSettle(y)):p+=1)};return _})()),super(g,f),this._length=u,this._nativeOfflineAudioContext=g,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,zge(this)}))}_waitForThePromiseToSettle(a){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(a):setTimeout(()=>this._waitForThePromiseToSettle(a))}},Frt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},zrt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Frt,...c},d=t(u,f),g=s(u),p=g?r():null,_=l.sampleRate/2;super(l,!1,d,p),this._detune=e(this,g,d.detune,153600,-153600),this._frequency=e(this,g,d.frequency,_,-_),this._nativeOscillatorNode=d,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&f.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=f.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(l){const c=typeof l=="function"?a(this,l):null;this._nativeOscillatorNode.onended=c;const u=this._nativeOscillatorNode.onended;this._onended=u!==null&&u===c?l:u}get type(){return this._nativeOscillatorNode.type}set type(l){this._nativeOscillatorNode.type=l,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(l){this._nativeOscillatorNode.setPeriodicWave(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=l)}start(l=0){if(this._nativeOscillatorNode.start(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=l),this.context.state!=="closed"){bw(this);const c=()=>{this._nativeOscillatorNode.removeEventListener("ended",c),Jy(this)&&IO(this)};this._nativeOscillatorNode.addEventListener("ended",c)}}stop(l=0){this._nativeOscillatorNode.stop(l),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=l)}},jrt=(n,e,t,r,i)=>()=>{const s=new WeakMap;let a=null,o=null,l=null;const c=async(u,f)=>{let d=t(u);const g=ap(d,f);if(!g){const p={channelCount:d.channelCount,channelCountMode:d.channelCountMode,channelInterpretation:d.channelInterpretation,detune:d.detune.value,frequency:d.frequency.value,periodicWave:a===null?void 0:a,type:d.type};d=e(f,p),o!==null&&d.start(o),l!==null&&d.stop(l)}return s.set(f,d),g?(await n(f,u.detune,d.detune),await n(f,u.frequency,d.frequency)):(await r(f,u.detune,d.detune),await r(f,u.frequency,d.frequency)),await i(u,f,d),d};return{set periodicWave(u){a=u},set start(u){o=u},set stop(u){l=u},render(u,f){const d=s.get(f);return d!==void 0?Promise.resolve(d):c(u,f)}}},Hrt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},qrt=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...Hrt,...c},d=t(u,f),g=s(u),p=g?r():null;super(l,!1,d,p),this._nativePannerNode=d,this._orientationX=e(this,g,d.orientationX,Op,wm),this._orientationY=e(this,g,d.orientationY,Op,wm),this._orientationZ=e(this,g,d.orientationZ,Op,wm),this._positionX=e(this,g,d.positionX,Op,wm),this._positionY=e(this,g,d.positionY,Op,wm),this._positionZ=e(this,g,d.positionZ,Op,wm),a(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(l){this._nativePannerNode.coneInnerAngle=l}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(l){this._nativePannerNode.coneOuterAngle=l}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(l){this._nativePannerNode.coneOuterGain=l}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(l){this._nativePannerNode.distanceModel=l}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(l){this._nativePannerNode.maxDistance=l}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(l){this._nativePannerNode.panningModel=l}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(l){this._nativePannerNode.refDistance=l}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(l){this._nativePannerNode.rolloffFactor=l}},Vrt=(n,e,t,r,i,s,a,o,l,c)=>()=>{const u=new WeakMap;let f=null;const d=async(g,p)=>{let _=null,y=s(g);const v={channelCount:y.channelCount,channelCountMode:y.channelCountMode,channelInterpretation:y.channelInterpretation},x={...v,coneInnerAngle:y.coneInnerAngle,coneOuterAngle:y.coneOuterAngle,coneOuterGain:y.coneOuterGain,distanceModel:y.distanceModel,maxDistance:y.maxDistance,panningModel:y.panningModel,refDistance:y.refDistance,rolloffFactor:y.rolloffFactor},E=ap(y,p);if("bufferSize"in y)_=r(p,{...v,gain:1});else if(!E){const M={...x,orientationX:y.orientationX.value,orientationY:y.orientationY.value,orientationZ:y.orientationZ.value,positionX:y.positionX.value,positionY:y.positionY.value,positionZ:y.positionZ.value};y=i(p,M)}if(u.set(p,_===null?y:_),_!==null){if(f===null){if(a===null)throw new Error("Missing the native OfflineAudioContext constructor.");const Q=new a(6,g.context.length,p.sampleRate),B=e(Q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});B.connect(Q.destination),f=(async()=>{const $=await Promise.all([g.orientationX,g.orientationY,g.orientationZ,g.positionX,g.positionY,g.positionZ].map(async(U,J)=>{const W=t(Q,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:J===0?1:0});return await o(Q,U,W.offset),W}));for(let U=0;U<6;U+=1)$[U].connect(B,0,U),$[U].start(0);return c(Q)})()}const M=await f,O=r(p,{...v,gain:1});await l(g,p,O);const N=[];for(let Q=0;Q<M.numberOfChannels;Q+=1)N.push(M.getChannelData(Q));let I=[N[0][0],N[1][0],N[2][0]],D=[N[3][0],N[4][0],N[5][0]],V=r(p,{...v,gain:1}),G=i(p,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:D[0],positionY:D[1],positionZ:D[2]});O.connect(V).connect(G.inputs[0]),G.connect(_);for(let Q=128;Q<M.length;Q+=128){const B=[N[0][Q],N[1][Q],N[2][Q]],$=[N[3][Q],N[4][Q],N[5][Q]];if(B.some((U,J)=>U!==I[J])||$.some((U,J)=>U!==D[J])){I=B,D=$;const U=Q/p.sampleRate;V.gain.setValueAtTime(0,U),V=r(p,{...v,gain:0}),G=i(p,{...x,orientationX:I[0],orientationY:I[1],orientationZ:I[2],positionX:D[0],positionY:D[1],positionZ:D[2]}),V.gain.setValueAtTime(1,U),O.connect(V).connect(G.inputs[0]),G.connect(_)}}return _}return E?(await n(p,g.orientationX,y.orientationX),await n(p,g.orientationY,y.orientationY),await n(p,g.orientationZ,y.orientationZ),await n(p,g.positionX,y.positionX),await n(p,g.positionY,y.positionY),await n(p,g.positionZ,y.positionZ)):(await o(p,g.orientationX,y.orientationX),await o(p,g.orientationY,y.orientationY),await o(p,g.orientationZ,y.orientationZ),await o(p,g.positionX,y.positionX),await o(p,g.positionY,y.positionY),await o(p,g.positionZ,y.positionZ)),Qw(y)?await l(g,p,y.inputs[0]):await l(g,p,y),y};return{render(g,p){const _=u.get(p);return _!==void 0?Promise.resolve(_):d(g,p)}}},Grt={disableNormalization:!1},$rt=(n,e,t,r)=>class Kge{constructor(s,a){const o=e(s),l=r({...Grt,...a}),c=n(o,l);return t.add(c),c}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===Kge.prototype||t.has(s)}},Wrt=(n,e)=>(t,r,i)=>(n(r).replay(i),e(r,t,i)),Yrt=(n,e,t)=>async(r,i,s)=>{const a=n(r);await Promise.all(a.activeInputs.map((o,l)=>Array.from(o).map(async([c,u])=>{const d=await e(c).render(c,i),g=r.context.destination;!t(c)&&(r!==g||!t(r))&&d.connect(s,u,l)})).reduce((o,l)=>[...o,...l],[]))},Xrt=(n,e,t)=>async(r,i,s)=>{const a=e(r);await Promise.all(Array.from(a.activeInputs).map(async([o,l])=>{const u=await n(o).render(o,i);t(o)||u.connect(s,l)}))},Krt=(n,e,t,r)=>i=>n(Nk,()=>Nk(i))?Promise.resolve(n(r,r)).then(s=>{if(!s){const a=t(i,512,0,1);i.oncomplete=()=>{a.onaudioprocess=null,a.disconnect()},a.onaudioprocess=()=>i.currentTime,a.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const a=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=o=>{a.disconnect(),s(o.renderedBuffer)},a.connect(i.destination),i.startRendering()}),Zrt=n=>(e,t)=>{n.set(e,t)},Qrt=n=>(e,t)=>n.set(e,t),Jrt=(n,e,t,r,i,s,a,o)=>(l,c)=>t(l).render(l,c).then(()=>Promise.all(Array.from(r(c)).map(u=>t(u).render(u,c)))).then(()=>i(c)).then(u=>(typeof u.copyFromChannel!="function"?(a(u),wq(u)):e(s,()=>s(u))||o(u),n.add(u),u)),eit={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},tit=(n,e,t,r,i,s)=>class extends n{constructor(o,l){const c=i(o),u={...eit,...l},f=t(c,u),d=s(c),g=d?r():null;super(o,!1,f,g),this._pan=e(this,d,f.pan)}get pan(){return this._pan}},nit=(n,e,t,r,i)=>()=>{const s=new WeakMap,a=async(o,l)=>{let c=t(o);const u=ap(c,l);if(!u){const f={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,pan:c.pan.value};c=e(l,f)}return s.set(l,c),u?await n(l,o.pan,c.pan):await r(l,o.pan,c.pan),Qw(c)?await i(o,l,c.inputs[0]):await i(o,l,c),c};return{render(o,l){const c=s.get(l);return c!==void 0?Promise.resolve(c):a(o,l)}}},rit=n=>()=>{if(n===null)return!1;try{new n({length:1,sampleRate:44100})}catch{return!1}return!0},iit=(n,e)=>async()=>{if(n===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(t);let s=!1,a=!1;try{await r.audioWorklet.addModule(i);const o=new n(r,"a",{numberOfOutputs:0}),l=r.createOscillator();o.port.onmessage=()=>s=!0,o.onprocessorerror=()=>a=!0,l.connect(o),l.start(0),await r.startRendering(),await new Promise(c=>setTimeout(c))}catch{}finally{URL.revokeObjectURL(i)}return s&&!a},sit=(n,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),r=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{r.disconnect(),i(t.currentTime!==0)},t.startRendering()})},ait=()=>new DOMException("","UnknownError"),oit={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},lit=(n,e,t,r,i,s,a)=>class extends n{constructor(l,c){const u=i(l),f={...oit,...c},d=t(u,f),p=s(u)?r():null;super(l,!0,d,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=d,a(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(l){if(l===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(l.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=l}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(l){this._nativeWaveShaperNode.oversample=l}},cit=(n,e,t)=>()=>{const r=new WeakMap,i=async(s,a)=>{let o=e(s);if(!ap(o,a)){const c={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,curve:o.curve,oversample:o.oversample};o=n(a,c)}return r.set(a,o),Qw(o)?await t(s,a,o.inputs[0]):await t(s,a,o),o};return{render(s,a){const o=r.get(a);return o!==void 0?Promise.resolve(o):i(s,a)}}},uit=()=>typeof window>"u"?null:window,fit=(n,e)=>t=>{t.copyFromChannel=(r,i,s=0)=>{const a=n(s),o=n(i);if(o>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(o),u=r.length;for(let f=a<0?-a:0;f+a<l&&f<u;f+=1)r[f]=c[f+a]},t.copyToChannel=(r,i,s=0)=>{const a=n(s),o=n(i);if(o>=t.numberOfChannels)throw e();const l=t.length,c=t.getChannelData(o),u=r.length;for(let f=a<0?-a:0;f+a<l&&f<u;f+=1)c[f+a]=r[f]}},hit=n=>e=>{e.copyFromChannel=(t=>(r,i,s=0)=>{const a=n(s),o=n(i);if(a<e.length)return t.call(e,r,o,a)})(e.copyFromChannel),e.copyToChannel=(t=>(r,i,s=0)=>{const a=n(s),o=n(i);if(a<e.length)return t.call(e,r,o,a)})(e.copyToChannel)},dit=n=>(e,t)=>{const r=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),n(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},pit=(n,e)=>(t,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw n()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw n()}});const i=t.createBufferSource();e(r,()=>{const o=r.numberOfInputs;for(let l=0;l<o;l+=1)i.connect(r,0,l)},()=>i.disconnect(r))},Zge=(n,e,t)=>n.copyFromChannel===void 0?n.getChannelData(t)[0]:(n.copyFromChannel(e,t),e[0]),Qge=n=>{if(n===null)return!1;const e=n.length;return e%2!==0?n[Math.floor(e/2)]!==0:n[e/2-1]+n[e/2]!==0},UO=(n,e,t,r)=>{let i=n;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:a}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(n,e,{get:t(s),set:r(a)})},mit=n=>({...n,outputChannelCount:n.outputChannelCount!==void 0?n.outputChannelCount:n.numberOfInputs===1&&n.numberOfOutputs===1?[n.channelCount]:Array.from({length:n.numberOfOutputs},()=>1)}),git=n=>({...n,channelCount:n.numberOfOutputs}),_it=n=>{const{imag:e,real:t}=n;return e===void 0?t===void 0?{...n,imag:[0,0],real:[0,0]}:{...n,imag:Array.from(t,()=>0),real:t}:t===void 0?{...n,imag:e,real:Array.from(e,()=>0)}:{...n,imag:e,real:t}},Jge=(n,e,t)=>{try{n.setValueAtTime(e,t)}catch(r){if(r.code!==9)throw r;Jge(n,e,t+1e-7)}},vit=n=>{const e=n.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},yit=n=>{const e=n.createBufferSource(),t=n.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},bit=n=>{const e=n.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},kq=n=>{const e=n.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},e0e=n=>{const e=n.createBuffer(1,1,44100),t=n.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Oq=n=>{const e=n.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},Sit=n=>{const{port1:e,port2:t}=new MessageChannel;try{e.postMessage(n)}finally{e.close(),t.close()}},Eit=n=>{n.start=(e=>(t=0,r=0,i)=>{const s=n.buffer,a=s===null?r:Math.min(s.duration,r);s!==null&&a>s.duration-.5/n.context.sampleRate?e.call(n,t,0,0):e.call(n,t,a,i)})(n.start)},t0e=(n,e)=>{const t=e.createGain();n.connect(t);const r=(i=>()=>{i.call(n,t),n.removeEventListener("ended",r)})(n.disconnect);n.addEventListener("ended",r),Jw(n,t),n.stop=(i=>{let s=!1;return(a=0)=>{if(s)try{i.call(n,a)}catch{t.gain.setValueAtTime(0,a)}else i.call(n,a),s=!0}})(n.stop)},eR=(n,e)=>t=>{const r={value:n};return Object.defineProperties(t,{currentTarget:r,target:r}),typeof e=="function"?e.call(n,t):e.handleEvent.call(n,t)},xit=Het(ox),Tit=Yet(ox),wit=ont(OU),n0e=new WeakMap,Rit=wnt(n0e),j_=Ltt(new Map,new WeakMap),Vv=uit(),r0e=trt(j_,ny),Iq=Tnt(zp),Rd=Yrt(zp,Iq,BE),Ait=Jet(r0e,sc,Rd),Hl=Cnt(kU),Eb=Crt(Vv),nl=Gnt(Eb),i0e=new WeakMap,s0e=_nt(eR),BO=srt(Vv),Nq=jnt(BO),Pq=Hnt(Vv),a0e=qnt(Vv),Pk=ort(Vv),Gu=Ttt(qet(Nge),Wet(xit,Tit,yL,wit,bL,zp,Rit,OO,sc,ox,Jy,BE,rP),j_,Lnt(k9,bL,zp,sc,Ik,Jy),ny,IU,$p,nnt(yL,k9,zp,sc,Ik,Hl,Jy,nl),unt(i0e,zp,k_),s0e,Hl,Nq,Pq,a0e,nl,Pk),Cit=Qet(Gu,Ait,ny,r0e,Hl,nl),Dq=new WeakSet,wne=nrt(Vv),o0e=Xtt(new Uint32Array(1)),Lq=fit(o0e,ny),Uq=hit(o0e),l0e=ttt(Dq,j_,$p,wne,Eb,rit(wne),Lq,Uq),NU=Xet(Gm),c0e=Xrt(Iq,NO,BE),ry=qtt(c0e),tR=irt(NU,j_,vit,yit,bit,kq,e0e,Oq,Eit,dit(UO),t0e),iy=Wrt(Rnt(NO),c0e),Mit=itt(ry,tR,sc,iy,Rd),H_=wtt(Vet(Pge),i0e,Tq,Rtt,Let,Uet,Bet,Fet,zet,A9,Oge,BO,Jge),kit=rtt(Gu,Mit,H_,Lh,tR,Hl,nl,eR),Oit=dtt(Gu,ptt,ny,Lh,art(Gm,UO),Hl,nl,Rd),Iit=Dtt(ry,Yge,sc,iy,Rd),lx=Qrt(n0e),Nit=Ptt(Gu,H_,Iit,IU,Yge,Hl,nl,lx),K1=Jnt(ox,Pq),Pit=pit(Lh,K1),Z1=prt(BO,Pit),Dit=Ftt(Z1,sc,Rd),Lit=Btt(Gu,Dit,Z1,Hl,nl),Uit=Htt(DO,sc,Rd),Bit=jtt(Gu,Uit,DO,Hl,nl,git),Fit=_rt(NU,tR,Gm,K1),nR=grt(NU,j_,Fit,kq,Oq),zit=Ytt(ry,nR,sc,iy,Rd),jit=Wtt(Gu,H_,zit,nR,Hl,nl,eR),u0e=vrt($p,UO),Hit=Qtt(u0e,sc,Rd),qit=Ztt(Gu,Hit,u0e,Hl,nl,lx),Vit=ant(ry,Xge,sc,iy,Rd),Git=snt(Gu,H_,Vit,Xge,Hl,nl,lx),f0e=yrt($p),$it=pnt(ry,f0e,sc,iy,Rd),Wit=dnt(Gu,H_,$it,f0e,$p,Hl,nl,lx),Yit=Ent(ry,Gm,sc,iy,Rd),Xit=Snt(Gu,H_,Yit,Gm,Hl,nl),Kit=xrt(IU,Lh,LO,$p),PU=Krt(j_,Gm,LO,sit(Gm,Eb)),Zit=Dnt(tR,sc,Eb,Rd,PU),Qit=brt(Kit),Jit=Nnt(Gu,Qit,Zit,Hl,nl,lx),est=mtt(H_,Z1,nR,LO,$p,Zge,nl,UO),h0e=new WeakMap,tst=Qnt(Oit,est,s0e,nl,h0e,eR),d0e=Mrt(NU,j_,kq,e0e,Oq,t0e),nst=jrt(ry,d0e,sc,iy,Rd),rst=zrt(Gu,H_,d0e,nst,Hl,nl,eR),p0e=Gtt(tR),ist=Lrt(p0e,Lh,Gm,Qge,K1),DU=Drt(p0e,Lh,ist,Qge,K1,BO,UO),sst=Ort(yL,Lh,Z1,Gm,LO,DU,$p,bL,Zge,K1),m0e=krt(sst),ast=Vrt(ry,Z1,nR,Gm,m0e,sc,Eb,iy,Rd,PU),ost=qrt(Gu,H_,m0e,ast,Hl,nl,lx),lst=Irt(ny),cst=$rt(lst,Hl,new WeakSet,_it),ust=Prt(Z1,DO,Gm,DU,$p,K1),g0e=Nrt(ust,$p),fst=nit(ry,g0e,sc,iy,Rd),hst=tit(Gu,H_,g0e,fst,Hl,nl),dst=cit(DU,sc,Rd),pst=lit(Gu,Lh,DU,dst,Hl,nl,lx),_0e=$nt(Vv),Bq=vnt(Vv),v0e=new WeakMap,mst=Mnt(v0e,Eb),gst=_0e?$et(j_,$p,gnt(Vv),Bq,ynt(jet),Hl,mst,nl,Pk,new WeakMap,new WeakMap,iit(Pk,Eb),Vv):void 0,_st=Vnt(Nq,nl),vst=tnt(Dq,j_,ent,mnt,new WeakSet,Hl,_st,_L,Nk,Lq,Uq),y0e=Itt(gst,Cit,l0e,kit,Nit,Lit,Bit,jit,qit,vst,Git,Wit,Xit,Jit,tst,rst,ost,cst,hst,pst),yst=Wnt(Gu,Trt,Hl,nl),bst=Xnt(Gu,wrt,Hl,nl),Sst=Knt(Gu,Rrt,Hl,nl),Est=Art(Lh,nl),xst=Znt(Gu,Est,Hl),Tst=htt(y0e,Lh,$p,ait,yst,bst,Sst,xst,BO),Fq=knt(h0e),wst=Ket(Fq),b0e=Vtt(ny),Rst=lnt(Fq),S0e=fnt(ny),E0e=new WeakMap,Ast=xnt(E0e,k_),Cst=drt(b0e,ny,Lh,Z1,DO,nR,Gm,LO,$p,S0e,Bq,Ast,K1),Mst=crt(Lh,Cst,Gm,$p,K1),kst=Ott(ry,b0e,tR,Z1,DO,nR,Gm,Rst,S0e,Bq,sc,Pk,Eb,iy,Rd,PU),Ost=Ant(v0e),Ist=Zrt(E0e),Rne=_0e?Ctt(wst,Gu,H_,kst,Mst,zp,Ost,Hl,nl,Pk,mit,Ist,Sit,eR):void 0,Nst=Jtt($p,Eb),Pst=Jrt(Dq,j_,Iq,Fq,PU,_L,Lq,Uq),Dst=Brt(y0e,j_,Lh,Nst,Pst),Lst=Unt(kU,Nq),Ust=Bnt(xq,Pq),Bst=Fnt(Tq,a0e),Fst=znt(kU,nl);function zg(n){return n===void 0}function Ls(n){return n!==void 0}function zst(n){return typeof n=="function"}function O_(n){return typeof n=="number"}function _1(n){return Object.prototype.toString.call(n)==="[object Object]"&&n.constructor===Object}function x0e(n){return typeof n=="boolean"}function Dm(n){return Array.isArray(n)}function ub(n){return typeof n=="string"}function oN(n){return ub(n)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(n)}function yi(n,e){if(!n)throw new Error(e)}function I0(n,e,t=1/0){if(!(e<=n&&n<=t))throw new RangeError(`Value must be within [${e}, ${t}], got: ${n}`)}function T0e(n){!n.isOffline&&n.state!=="running"&&LU('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let w0e=!1,Ane=!1;function Cne(n){w0e=n}function jst(n){zg(n)&&w0e&&!Ane&&(Ane=!0,LU("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let R0e=console;function Hst(...n){R0e.log(...n)}function LU(...n){R0e.warn(...n)}function qst(n){return new Tst(n)}function Vst(n,e,t){return new Dst(n,e,t)}const Cg=typeof self=="object"?self:null,Gst=Cg&&(Cg.hasOwnProperty("AudioContext")||Cg.hasOwnProperty("webkitAudioContext"));function $st(n,e,t){return yi(Ls(Rne),"AudioWorkletNode only works in a secure context (https or localhost)"),new(n instanceof Cg?.BaseAudioContext?Cg?.AudioWorkletNode:Rne)(n,e,t)}var D9=function(n,e){return D9=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])},D9(n,e)};function A0e(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");D9(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function ql(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var o=n.length-1;o>=0;o--)(a=n[o])&&(s=(i<3?a(s):i>3?a(e,t,s):a(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s}function Ec(n,e,t,r){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(u){try{c(r.next(u))}catch(f){a(f)}}function l(u){try{c(r.throw(u))}catch(f){a(f)}}function c(u){u.done?s(u.value):i(u.value).then(o,l)}c((r=r.apply(n,e||[])).next())})}function zq(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(u){return l([c,u])}}function l(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(r=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(n,t)}catch(u){c=[6,u],i=0}finally{r=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function UU(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=r.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(a)throw a.error}}return s}function L9(n,e,t){if(t||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||Array.prototype.slice.call(e))}class Wst{constructor(e,t,r,i){this._callback=e,this._type=t,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=r,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),t=URL.createObjectURL(e),r=new Worker(t);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var t;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((t=this._worker)===null||t===void 0||t.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function FE(n){return Bst(n)}function v1(n){return Ust(n)}function iP(n){return Fst(n)}function aT(n){return Lst(n)}function Yst(n){return n instanceof l0e}function Xst(n,e){return n==="value"||FE(e)||v1(e)||Yst(e)}function y1(n,...e){if(!e.length)return n;const t=e.shift();if(_1(n)&&_1(t))for(const r in t)Xst(r,t[r])?n[r]=t[r]:_1(t[r])?(n[r]||Object.assign(n,{[r]:{}}),y1(n[r],t[r])):Object.assign(n,{[r]:t[r]});return y1(n,...e)}function Kst(n,e){return n.length===e.length&&n.every((t,r)=>e[r]===t)}function pr(n,e,t=[],r){const i={},s=Array.from(e);if(_1(s[0])&&r&&!Reflect.has(s[0],r)&&(Object.keys(s[0]).some(o=>Reflect.has(n,o))||(y1(i,{[r]:s[0]}),t.splice(t.indexOf(r),1),s.shift())),s.length===1&&_1(s[0]))y1(i,s[0]);else for(let a=0;a<t.length;a++)Ls(s[a])&&(i[t[a]]=s[a]);return y1(n,i)}function Zst(n){return n.constructor.getDefaults()}function Pv(n,e){return zg(n)?e:n}function Cv(n,e){return e.forEach(t=>{Reflect.has(n,t)&&delete n[t]}),n}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class xb{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Cg&&this.toString()===Cg.TONE_DEBUG_CLASS)&&Hst(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}xb.version=kge;const jq=1e-6;function Sw(n,e){return n>e+jq}function U9(n,e){return Sw(n,e)||__(n,e)}function TL(n,e){return n+jq<e}function __(n,e){return Math.abs(n-e)<jq}function Qst(n,e,t){return Math.max(Math.min(n,t),e)}class L0 extends xb{constructor(){super(),this.name="Timeline",this._timeline=[];const e=pr(L0.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(yi(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const t=this._timeline[this.length-1];yi(U9(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const t=this._search(e.time);this._timeline.splice(t+1,0,e)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(e){const t=this._timeline.indexOf(e);return t!==-1&&this._timeline.splice(t,1),this}get(e,t="time"){const r=this._search(e,t);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,t="time"){const r=this._search(e,t);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){const t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];const r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let t=this._search(e);if(t>=0)if(__(this._timeline[t].time,e)){for(let r=t;r>=0&&__(this._timeline[r].time,e);r--)t=r;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else this._timeline.length===1&&U9(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}previousEvent(e){const t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}_search(e,t="time"){if(this._timeline.length===0)return-1;let r=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][t]<=e)return i-1;for(;r<s;){let a=Math.floor(r+(s-r)/2);const o=this._timeline[a],l=this._timeline[a+1];if(__(o[t],e)){for(let c=a;c<this._timeline.length;c++){const u=this._timeline[c];if(__(u[t],e))a=c;else break}return a}else{if(TL(o[t],e)&&Sw(l[t],e))return a;Sw(o[t],e)?s=a:r=a+1}}return-1}_iterate(e,t=0,r=this._timeline.length-1){this._timeline.slice(t,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,t){const r=this._search(e);return r!==-1&&this._iterate(t,0,r),this}forEachAfter(e,t){const r=this._search(e);return this._iterate(t,r+1),this}forEachBetween(e,t,r){let i=this._search(e),s=this._search(t);return i!==-1&&s!==-1?(this._timeline[i].time!==e&&(i+=1),this._timeline[s].time===t&&(s-=1),this._iterate(r,i,s)):i===-1&&this._iterate(r,0,s),this}forEachFrom(e,t){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(t,r+1),this}forEachAtTime(e,t){const r=this._search(e);if(r!==-1&&__(this._timeline[r].time,e)){let i=r;for(let s=r;s>=0&&__(this._timeline[s].time,e);s--)i=s;this._iterate(s=>{t(s)},i,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const C0e=[];function BU(n){C0e.push(n)}function Jst(n){C0e.forEach(e=>e(n))}const M0e=[];function FU(n){M0e.push(n)}function eat(n){M0e.forEach(e=>e(n))}class FO extends xb{constructor(){super(...arguments),this.name="Emitter"}on(e,t){return e.split(/\W+/).forEach(i=>{zg(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(t)}),this}once(e,t){const r=(...i)=>{t(...i),this.off(e,r)};return this.on(e,r),this}off(e,t){return e.split(/\W+/).forEach(i=>{if(zg(this._events)&&(this._events={}),this._events.hasOwnProperty(i))if(zg(t))this._events[i]=[];else{const s=this._events[i];for(let a=s.length-1;a>=0;a--)s[a]===t&&s.splice(a,1)}}),this}emit(e,...t){if(this._events&&this._events.hasOwnProperty(e)){const r=this._events[e].slice(0);for(let i=0,s=r.length;i<s;i++)r[i].apply(this,t)}return this}static mixin(e){["on","once","off","emit"].forEach(t=>{const r=Object.getOwnPropertyDescriptor(FO.prototype,t);Object.defineProperty(e.prototype,t,r)})}dispose(){return super.dispose(),this._events=void 0,this}}class k0e extends FO{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class rR extends k0e{constructor(){var e,t;super(),this.name="Context",this._constants=new Map,this._timeouts=new L0,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const r=pr(rR.getDefaults(),arguments,["context"]);r.context?(this._context=r.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=qst({latencyHint:r.latencyHint}),this._latencyHint=r.latencyHint),this._ticker=new Wst(this.emit.bind(this,"tick"),r.clockSource,r.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((t=arguments[0])===null||t===void 0)&&t.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=r.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(Jst(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,t,r){return this._context.createBuffer(e,t,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,t){return this._context.createIIRFilter(e,t)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,t,r){return this._context.createPeriodicWave(e,t,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return yi(aT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return yi(aT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return yi(aT(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){yi(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){yi(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){yi(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){yi(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,t){return $st(this.rawContext,e,t)}addAudioWorkletModule(e){return Ec(this,void 0,void 0,function*(){yi(Ls(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return Ec(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return aT(this._context)?this._context.resume():Promise.resolve()}close(){return Ec(this,void 0,void 0,function*(){aT(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&eat(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const t=this._context.createBuffer(1,128,this._context.sampleRate),r=t.getChannelData(0);for(let s=0;s<r.length;s++)r[s]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,t=>{t.callback(),this._timeouts.remove(t)})}setTimeout(e,t){this._timeoutIds++;const r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+t}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(t=>{t.id===e&&this._timeouts.remove(t)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,t){const r=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),i()},id:r,time:s+t})};return i(),r}}class tat extends k0e{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,t,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,t){return{}}createPanner(){return{}}createPeriodicWave(e,t,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,t){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return Ec(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,t){return 0}clearTimeout(e){return this}setInterval(e,t){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Us(n,e){Dm(e)?e.forEach(t=>Us(n,t)):Object.defineProperty(n,e,{enumerable:!0,writable:!1})}function zO(n,e){Dm(e)?e.forEach(t=>zO(n,t)):Object.defineProperty(n,e,{writable:!0})}const lo=()=>{};class Zo extends xb{constructor(){super(),this.name="ToneAudioBuffer",this.onload=lo;const e=pr(Zo.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,ub(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:lo,onload:lo,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:ic().sampleRate}set(e){return e instanceof Zo?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return Ec(this,void 0,void 0,function*(){const t=Zo.load(e).then(r=>{this.set(r),this.onload(this)});Zo.downloads.push(t);try{yield t}finally{const r=Zo.downloads.indexOf(t);Zo.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const t=Dm(e)&&e[0].length>0,r=t?e.length:1,i=t?e[0].length:e.length,s=ic(),a=s.createBuffer(r,i,s.sampleRate),o=!t&&r===1?[e]:e;for(let l=0;l<r;l++)a.copyToChannel(o[l],l);return this._buffer=a,this}toMono(e){if(O_(e))this.fromArray(this.toArray(e));else{let t=new Float32Array(this.length);const r=this.numberOfChannels;for(let i=0;i<r;i++){const s=this.toArray(i);for(let a=0;a<s.length;a++)t[a]+=s[a]}t=t.map(i=>i/r),this.fromArray(t)}return this}toArray(e){if(O_(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const t=[];for(let r=0;r<this.numberOfChannels;r++)t[r]=this.getChannelData(r);return t}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,t=this.duration){yi(this.loaded,"Buffer is not loaded");const r=Math.floor(e*this.sampleRate),i=Math.floor(t*this.sampleRate);yi(r<i,"The start time must be less than the end time");const s=i-r,a=ic().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let o=0;o<this.numberOfChannels;o++)a.copyToChannel(this.getChannelData(o).subarray(r,i),o);return new Zo(a)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Zo().fromArray(e)}static fromUrl(e){return Ec(this,void 0,void 0,function*(){return yield new Zo().load(e)})}static load(e){return Ec(this,void 0,void 0,function*(){const t=Zo.baseUrl===""||Zo.baseUrl.endsWith("/")?Zo.baseUrl:Zo.baseUrl+"/",r=yield fetch(t+e);if(!r.ok)throw new Error(`could not load url: ${e}`);const i=yield r.arrayBuffer();return yield ic().decodeAudioData(i)})}static supportsType(e){const t=e.split("."),r=t[t.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return Ec(this,void 0,void 0,function*(){for(yield Promise.resolve();Zo.downloads.length;)yield Zo.downloads[0]})}}Zo.baseUrl="";Zo.downloads=[];class jO extends rR{constructor(){super({clockSource:"offline",context:iP(arguments[0])?arguments[0]:Vst(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:iP(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=iP(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return Ec(this,void 0,void 0,function*(){let t=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,t++;const r=Math.floor(this.sampleRate/128);e&&t%r===0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(){return Ec(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const t=yield this._context.startRendering();return new Zo(t)})}close(){return Promise.resolve()}}const O0e=new tat;let JS=O0e;function ic(){return JS===O0e&&Gst&&wL(new rR),JS}function wL(n,e=!1){e&&JS.dispose(),aT(n)?JS=new rR(n):iP(n)?JS=new jO(n):JS=n}function nat(){return JS.resume()}if(Cg&&!Cg.TONE_SILENCE_LOGGING){const e=` * Tone.js v${kge} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function I0e(n){return Math.pow(10,n/20)}function N0e(n){return 20*(Math.log(n)/Math.LN10)}function P0e(n){return Math.pow(2,n/12)}let zU=440;function rat(){return zU}function iat(n){zU=n}function eE(n){return Math.round(D0e(n))}function D0e(n){return 69+12*Math.log2(n/zU)}function L0e(n){return zU*Math.pow(2,(n-69)/12)}class Hq extends xb{constructor(e,t,r){super(),this.defaultUnits="s",this._val=t,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,t)=>{const r=parseInt(e,10),i=t==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/r)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const t=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(t)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,t,r)=>{let i=0;return e&&e!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i+=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(i+=this._beatsToUnits(parseFloat(r)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Hq&&this.fromType(this._val),zg(this._val))return this._noArg();if(ub(this._val)&&zg(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(_1(this._val)){let e=0;for(const t in this._val)if(Ls(this._val[t])){const r=this._val[t],i=new this.constructor(this.context,t).valueOf()*r;e+=i}return e}if(Ls(this._units)){const e=this._expressions[this._units],t=this._val.toString().trim().match(e.regexp);return t?e.method.apply(this,t.slice(1)):e.method.call(this,this._val)}else return ub(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class N0 extends Hq{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const t=new N0(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(t))},regexp:/^@(.+)/}})}quantize(e,t=1){const r=new this.constructor(this.context,e).valueOf(),i=this.valueOf(),o=Math.round(i/r)*r-i;return i+o*t}toNotation(){const e=this.toSeconds(),t=["1m"];for(let s=1;s<9;s++){const a=Math.pow(2,s);t.push(a+"n."),t.push(a+"n"),t.push(a+"t")}t.push("0");let r=t[0],i=new N0(this.context,t[0]).toSeconds();return t.forEach(s=>{const a=new N0(this.context,s).toSeconds();Math.abs(a-e)<Math.abs(i-e)&&(r=s,i=a)}),r}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let t=this.valueOf()/e;t=parseFloat(t.toFixed(4));const r=Math.floor(t/this._getTimeSignature());let i=t%1*4;t=Math.floor(t)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[r,t,i].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return eE(this.toFrequency())}_now(){return this.context.now()}}function Rh(n,e){return new N0(ic(),n,e)}class Om extends N0{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return rat()}static set A4(e){iat(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:Om.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,t){const i=sat[e.toLowerCase()]+(parseInt(t,10)+1)*12;return this.defaultUnits==="midi"?i:Om.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,t,r){let i=1;return e&&e!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&t!=="0"&&(i*=this._beatsToUnits(parseFloat(t))),r&&r!=="0"&&(i*=this._beatsToUnits(parseFloat(r)/4)),i}}})}transpose(e){return new Om(this.context,this.valueOf()*P0e(e))}harmonize(e){return e.map(t=>this.transpose(t))}toMidi(){return eE(this.valueOf())}toNote(){const e=this.toFrequency(),t=Math.log2(e/Om.A4);let r=Math.round(12*t)+57;const i=Math.floor(r/12);return i<0&&(r+=-12*i),aat[r%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return L0e(e)}static ftom(e){return eE(e)}}const sat={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},aat=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function Mne(n,e){return new Om(ic(),n,e)}class NT extends N0{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class np extends xb{constructor(){super();const e=pr(np.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:ic()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return jst(e),new N0(this.context,e).toSeconds()}toFrequency(e){return new Om(this.context,e).toFrequency()}toTicks(e){return new NT(this.context,e).toTicks()}_getPartialProperties(e){const t=this.get();return Object.keys(t).forEach(r=>{zg(e[r])&&delete t[r]}),t}get(){const e=Zst(this);return Object.keys(e).forEach(t=>{if(Reflect.has(this,t)){const r=this[t];Ls(r)&&Ls(r.value)&&Ls(r.setValueAtTime)?e[t]=r.value:r instanceof np?e[t]=r._getPartialProperties(e[t]):Dm(r)||O_(r)||ub(r)||x0e(r)?e[t]=r:delete e[t]}}),e}set(e){return Object.keys(e).forEach(t=>{Reflect.has(this,t)&&Ls(this[t])&&(this[t]&&Ls(this[t].value)&&Ls(this[t].setValueAtTime)?this[t].value!==e[t]&&(this[t].value=e[t]):this[t]instanceof np?this[t].set(e[t]):this[t]=e[t])}),this}}class HO extends L0{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const t=this.get(e);return t!==null?t.state:this._initial}setStateAtTime(e,t,r){return I0(t,0),this.add(Object.assign({},r,{state:e,time:t})),this}getLastState(e,t){const r=this._search(t);for(let i=r;i>=0;i--){const s=this._timeline[i];if(s.state===e)return s}}getNextState(e,t){const r=this._search(t);if(r!==-1)for(let i=r;i<this._timeline.length;i++){const s=this._timeline[i];if(s.state===e)return s}}}class zi extends np{constructor(){const e=pr(zi.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,yi(Ls(e.param)&&(FE(e.param)||e.param instanceof zi),"param must be an AudioParam");!FE(e.param);)e.param=e.param._param;this._swappable=Ls(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new L0(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,Ls(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(np.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return Ls(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return Ls(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,t){return this.units===t}_assertRange(e){return Ls(this.maxValue)&&Ls(this.minValue)&&I0(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?I0e(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?N0e(e):e}setValueAtTime(e,t){const r=this.toSeconds(t),i=this._fromType(e);return yi(isFinite(i)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,r),this}getValueAtTime(e){const t=Math.max(this.toSeconds(e),0),r=this._events.getAfter(t),i=this._events.get(t);let s=this._initialValue;if(i===null)s=this._initialValue;else if(i.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){const a=this._events.getBefore(i.time);let o;a===null?o=this._initialValue:o=a.value,i.type==="setTargetAtTime"&&(s=this._exponentialApproach(i.time,o,i.value,i.constant,t))}else if(r===null)s=i.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let a=i.value;if(i.type==="setTargetAtTime"){const o=this._events.getBefore(i.time);o===null?a=this._initialValue:a=o.value}r.type==="linearRampToValueAtTime"?s=this._linearInterpolate(i.time,a,r.time,r.value,t):s=this._exponentialInterpolate(i.time,a,r.time,r.value,t)}else s=i.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(t)===0&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}linearRampToValueAtTime(e,t){const r=this._fromType(e),i=this.toSeconds(t);return yi(isFinite(r)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._assertRange(r),this._events.add({time:i,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(r,i),this}exponentialRampToValueAtTime(e,t){let r=this._fromType(e);r=__(r,0)?this._minOutput:r,this._assertRange(r);const i=this.toSeconds(t);return yi(isFinite(r)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(r,i),this}exponentialRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(t)),this}linearRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(t)),this}targetRampTo(e,t,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,t),this}exponentialApproachValueAtTime(e,t,r){t=this.toSeconds(t),r=this.toSeconds(r);const i=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,t,i),this.cancelAndHoldAtTime(t+r*.9),this.linearRampToValueAtTime(e,t+r),this}setTargetAtTime(e,t,r){const i=this._fromType(e);yi(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(t);return this._assertRange(i),yi(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(t)}`),this._events.add({constant:r,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,s,r),this._param.setTargetAtTime(i,s,r),this}setValueCurveAtTime(e,t,r,i=1){r=this.toSeconds(r),t=this.toSeconds(t);const s=this._fromType(e[0])*i;this.setValueAtTime(this._toType(s),t);const a=r/(e.length-1);for(let o=1;o<e.length;o++){const l=this._fromType(e[o])*i;this.linearRampToValueAtTime(this._toType(l),t+o*a)}return this}cancelScheduledValues(e){const t=this.toSeconds(e);return yi(isFinite(t),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}cancelAndHoldAtTime(e){const t=this.toSeconds(e),r=this._fromType(this.getValueAtTime(t));yi(isFinite(t),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",t,"value="+r);const i=this._events.get(t),s=this._events.getAfter(t);return i&&__(i.time,t)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),t):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),t)),this._events.add({time:t,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,t),this}rampTo(e,t=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,t,r):this.linearRampTo(e,t,r),this}apply(e){const t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);const r=this._events.get(t);if(r&&r.type==="setTargetAtTime"){const i=this._events.getAfter(r.time),s=i?i.time:t+2,a=(s-t)/10;for(let o=t;o<s;o+=a)e.linearRampToValueAtTime(this.getValueAtTime(o),o)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?e.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){yi(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,t,r,i,s){return r+(t-r)*Math.exp(-(s-e)/i)}_linearInterpolate(e,t,r,i,s){return t+(i-t)*((s-e)/(r-e))}_exponentialInterpolate(e,t,r,i,s){return t*Math.pow(i/t,(s-e)/(r-e))}}class xr extends np{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return Ls(this.input)?FE(this.input)||this.input instanceof zi?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ls(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return Ls(e)&&(e instanceof xr||v1(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();yi(e.length>0,"ToneAudioNode does not have any internal nodes");const t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}connect(e,t=0,r=0){return I_(this,e,t,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return LU("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,t=0,r=0){return U0e(this,e,t,r),this}chain(...e){return zE(this,...e),this}fan(...e){return e.forEach(t=>this.connect(t)),this}dispose(){return super.dispose(),Ls(this.input)&&(this.input instanceof xr?this.input.dispose():v1(this.input)&&this.input.disconnect()),Ls(this.output)&&(this.output instanceof xr?this.output.dispose():v1(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function zE(...n){const e=n.shift();n.reduce((t,r)=>(t instanceof xr?t.connect(r):v1(t)&&I_(t,r),r),e)}function I_(n,e,t=0,r=0){for(yi(Ls(n),"Cannot connect from undefined node"),yi(Ls(e),"Cannot connect to undefined node"),(e instanceof xr||v1(e))&&yi(e.numberOfInputs>0,"Cannot connect to node with no inputs"),yi(n.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof xr||e instanceof zi;)Ls(e.input)&&(e=e.input);for(;n instanceof xr;)Ls(n.output)&&(n=n.output);FE(e)?n.connect(e,t):n.connect(e,t,r)}function U0e(n,e,t=0,r=0){if(Ls(e))for(;e instanceof xr;)e=e.input;for(;!v1(n);)Ls(n.output)&&(n=n.output);FE(e)?n.disconnect(e,t):v1(e)?n.disconnect(e,t,r):n.disconnect()}class ji extends xr{constructor(){const e=pr(ji.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new zi({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Us(this,"gain")}static getDefaults(){return Object.assign(xr.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Ew extends xr{constructor(e){super(e),this.onended=lo,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new ji({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const r=this.toSeconds(t);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(xr.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:lo})}_startGain(e,t=1){yi(this._startTime===-1,"Source cannot be started more than once");const r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(t,e+r):this._gainNode.gain.exponentialApproachValueAtTime(t,e,r)):this._gainNode.gain.setValueAtTime(t,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){yi(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const t=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+t,this._stopTime=Math.max(this._stopTime,this.now()),t>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,t,e):this._gainNode.gain.targetRampTo(0,t,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const r=this._curve==="exponential"?t*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==lo&&(this.onended(this),this.onended=lo,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),yi(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=lo,this}}class qq extends Ew{constructor(){const e=pr(qq.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),I_(this._source,this._gainNode),this.offset=new zi({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Ew.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class fa extends xr{constructor(){const e=pr(fa.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new qq({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(xr.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,t=0,r=0){return jU(this,e,t,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,t){return this._param.setValueAtTime(e,t),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,t){return this._param.linearRampToValueAtTime(e,t),this}exponentialRampToValueAtTime(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}exponentialRampTo(e,t,r){return this._param.exponentialRampTo(e,t,r),this}linearRampTo(e,t,r){return this._param.linearRampTo(e,t,r),this}targetRampTo(e,t,r){return this._param.targetRampTo(e,t,r),this}exponentialApproachValueAtTime(e,t,r){return this._param.exponentialApproachValueAtTime(e,t,r),this}setTargetAtTime(e,t,r){return this._param.setTargetAtTime(e,t,r),this}setValueCurveAtTime(e,t,r,i){return this._param.setValueCurveAtTime(e,t,r,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,t,r){return this._param.rampTo(e,t,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function jU(n,e,t,r){(e instanceof zi||FE(e)||e instanceof fa&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof fa&&(e.overridden=!0)),I_(n,e,t,r)}class Vq extends zi{constructor(){const e=pr(Vq.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new L0(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(zi.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,t,r){t=this.toSeconds(t),this.setRampPoint(t);const i=this._fromType(e),s=this._events.get(t),a=Math.round(Math.max(1/r,1));for(let o=0;o<=a;o++){const l=r*o+t,c=this._exponentialApproach(s.time,s.value,i,r,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}setValueAtTime(e,t){const r=this.toSeconds(t);super.setValueAtTime(e,t);const i=this._events.get(r),s=this._events.previousEvent(i),a=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(a,0),this}linearRampToValueAtTime(e,t){const r=this.toSeconds(t);super.linearRampToValueAtTime(e,t);const i=this._events.get(r),s=this._events.previousEvent(i),a=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(a,0),this}exponentialRampToValueAtTime(e,t){t=this.toSeconds(t);const r=this._fromType(e),i=this._events.get(t),s=Math.round(Math.max((t-i.time)*10,1)),a=(t-i.time)/s;for(let o=0;o<=s;o++){const l=a*o+i.time,c=this._exponentialInterpolate(i.time,i.value,t,r,l);this.linearRampToValueAtTime(this._toType(c),l)}return this}_getTicksUntilEvent(e,t){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(zg(e.ticks)){const a=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(a,e.time)}const r=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(t));const s=this._events.get(t);return s&&s.time===t&&s.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+i)+e.ticks}getTicksAtTime(e){const t=this.toSeconds(e),r=this._events.get(t);return Math.max(this._getTicksUntilEvent(r,t),0)}getDurationOfTicks(e,t){const r=this.toSeconds(t),i=this.getTicksAtTime(t);return this.getTimeOfTick(i+e)-r}getTimeOfTick(e){const t=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&r&&r.type==="linearRampToValueAtTime"&&t.value!==r.value){const i=this._fromType(this.getValueAtTime(t.time)),a=(this._fromType(this.getValueAtTime(r.time))-i)/(r.time-t.time),o=Math.sqrt(Math.pow(i,2)-2*a*(t.ticks-e)),l=(-i+o)/a,c=(-i-o)/a;return(l>0?l:c)+t.time}else return t?t.value===0?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}ticksToTime(e,t){return this.getDurationOfTicks(e,t)}timeToTicks(e,t){const r=this.toSeconds(t),i=this.toSeconds(e),s=this.getTicksAtTime(r);return this.getTicksAtTime(r+i)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}class Gq extends fa{constructor(){const e=pr(Gq.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new Vq({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(fa.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,t){return this._param.ticksToTime(e,t)}timeToTicks(e,t){return this._param.timeToTicks(e,t)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,t){return this._param.getDurationOfTicks(e,t)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class $q extends np{constructor(){const e=pr($q.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new HO,this._tickOffset=new L0,this._ticksAtTime=new L0,this._secondsAtTime=new L0,this.frequency=new Gq({context:this.context,units:e.units,value:e.frequency}),Us(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},np.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,t){const r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),Ls(t)&&this.setTicksAtTime(t,r),this._ticksAtTime.cancel(r),this._secondsAtTime.cancel(r)),this}stop(e){const t=this.toSeconds(e);if(this._state.getValueAtTime(t)==="stopped"){const r=this._state.get(t);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const t=this.toSeconds(e),r=this._state.getLastState("stopped",t),i=this._ticksAtTime.get(t),s={state:"paused",time:t};this._state.add(s);let a=i||r,o=i?i.ticks:0,l=null;return this._state.forEachBetween(a.time,t+this.sampleTime,c=>{let u=a.time;const f=this._tickOffset.get(c.time);f&&f.time>=a.time&&(o=f.ticks,u=f.time),a.state==="started"&&c.state!=="started"&&(o+=this.frequency.getTicksAtTime(c.time)-this.frequency.getTicksAtTime(u),c.time!==s.time&&(l={state:c.state,time:c.time,ticks:o})),a=c}),this._state.remove(s),l&&this._ticksAtTime.add(l),o}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const t=this.now(),r=this.frequency.timeToTicks(e,t);this.setTicksAtTime(r,t)}getSecondsAtTime(e){e=this.toSeconds(e);const t=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);const i=this._secondsAtTime.get(e);let s=i||t,a=i?i.seconds:0,o=null;return this._state.forEachBetween(s.time,e+this.sampleTime,l=>{let c=s.time;const u=this._tickOffset.get(l.time);u&&u.time>=s.time&&(a=u.seconds,c=u.time),s.state==="started"&&l.state!=="started"&&(a+=l.time-c,l.time!==r.time&&(o={state:l.state,time:l.time,seconds:a})),s=l}),this._state.remove(r),o&&this._secondsAtTime.add(o),a}setTicksAtTime(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this._ticksAtTime.cancel(t),this._secondsAtTime.cancel(t),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,t=this.now()){const r=this._tickOffset.get(t),i=this._state.get(t),s=Math.max(r.time,i.time),a=this.frequency.getTicksAtTime(s)+e-r.ticks;return this.frequency.getTimeOfTick(a)}forEachTickBetween(e,t,r){let i=this._state.get(e);this._state.forEachBetween(e,t,a=>{i&&i.state==="started"&&a.state!=="started"&&this.forEachTickBetween(Math.max(i.time,e),a.time-this.sampleTime,r),i=a});let s=null;if(i&&i.state==="started"){const a=Math.max(i.time,e),o=this.frequency.getTicksAtTime(a),l=this.frequency.getTicksAtTime(i.time),c=o-l;let u=Math.ceil(c)-c;u=__(u,1)?0:u;let f=this.frequency.getTimeOfTick(o+u);for(;f<t;){try{r(f,Math.round(this.getTicksAtTime(f)))}catch(d){s=d;break}f+=this.frequency.getDurationOfTicks(1,f)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class HU extends np{constructor(){const e=pr(HU.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=lo,this._lastUpdate=0,this._state=new HO("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new $q({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Us(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(np.getDefaults(),{callback:lo,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,t){T0e(this.context);const r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,t),r<this._lastUpdate&&this.emit("start",r,t)),this}stop(e){const t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}pause(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)==="started"&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,t){return this._tickSource.setTicksAtTime(e,t),this}getTimeOfTick(e,t=this.now()){return this._tickSource.getTimeOfTick(e,t)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,t){const r=this.toSeconds(t),i=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(i+e,r)}_loop(){const e=this._lastUpdate,t=this.now();this._lastUpdate=t,this.log("loop",e,t),e!==t&&(this._state.forEachBetween(e,t,r=>{switch(r.state){case"started":const i=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,i);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,t,(r,i)=>{this.callback(r,i)}))}getStateAtTime(e){const t=this.toSeconds(e);return this._state.getValueAtTime(t)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}FO.mixin(HU);class xw extends xr{constructor(){const e=pr(xw.getDefaults(),arguments,["delayTime","maxDelay"]);super(e),this.name="Delay";const t=this.toSeconds(e.maxDelay);this._maxDelay=Math.max(t,this.toSeconds(e.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(t),this.delayTime=new zi({context:this.context,param:this._delayNode.delayTime,units:"time",value:e.delayTime,minValue:0,maxValue:this.maxDelay}),Us(this,"delayTime")}static getDefaults(){return Object.assign(xr.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}class Sm extends xr{constructor(){const e=pr(Sm.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new ji({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Us(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Wq extends xr{constructor(){const e=pr(Wq.getDefaults(),arguments);super(e),this.name="Destination",this.input=new Sm({context:this.context}),this.output=new ji({context:this.context}),this.volume=this.input.volume,zE(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),zE(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}BU(n=>{n.destination=new Wq({context:n})});FU(n=>{n.destination.dispose()});class oat extends xr{constructor(){super(...arguments),this.name="Listener",this.positionX=new zi({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new zi({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new zi({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new zi({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new zi({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new zi({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new zi({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new zi({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new zi({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(xr.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}BU(n=>{n.listener=new oat({context:n})});FU(n=>{n.listener.dispose()});function lat(n,e){return Ec(this,arguments,void 0,function*(t,r,i=2,s=ic().sampleRate){const a=ic(),o=new jO(i,r,s);wL(o),yield t(o);const l=o.render();wL(a);const c=yield l;return new Zo(c)})}class Yq extends xb{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=pr(Yq.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(t=>{this._loadingCount++;const r=e.urls[t];this.add(t,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:lo,onload:lo,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return yi(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,t])=>t.loaded)}add(e,t,r=lo,i=lo){return ub(t)?(this.baseUrl&&t.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Zo(this.baseUrl+t,r,i))):this._buffers.set(e.toString(),new Zo(t,r,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class RL extends Om{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return eE(super._frequencyToUnits(e))}_ticksToUnits(e){return eE(super._ticksToUnits(e))}_beatsToUnits(e){return eE(super._beatsToUnits(e))}_secondsToUnits(e){return eE(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return L0e(this.toMidi())}transpose(e){return new RL(this.context,this.toMidi()+e)}}class Gf extends NT{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class cat extends np{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new L0,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,t=>{e-t.time<=this.expiration&&t.callback(),this._events.remove(t)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}BU(n=>{n.draw=new cat({context:n})});FU(n=>{n.draw.dispose()});class uat extends xb{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){yi(Ls(e.time),"Events must have a time property"),yi(Ls(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let t=new fat(e.time,e.time+e.duration,e);for(this._root===null?this._root=t:this._root.insert(t),this._length++;t!==null;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}remove(e){if(this._root!==null){const t=[];this._root.search(e.time,t);for(const r of t)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,t=>this.remove(t)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,t){e.parent!==null?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const t=e.getBalance();let r,i=null;if(t>0)if(e.left.right===null)r=e.left,r.right=e.right,i=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,i=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,i=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,i=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const t=e.parent,r=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),t!==null?r?t.left=i:t.right=i:this._setRoot(i)}_rotateRight(e){const t=e.parent,r=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),t!==null?r?t.left=i:t.right=i:this._setRoot(i)}_rebalance(e){const t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const t=[];if(this._root.search(e,t),t.length>0){let r=t[0];for(let i=1;i<t.length;i++)t[i].low>r.low&&(r=t[i]);return r.event}}return null}forEach(e){if(this._root!==null){const t=[];this._root.traverse(r=>t.push(r)),t.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,t){if(this._root!==null){const r=[];this._root.search(e,r),r.forEach(i=>{i.event&&t(i.event)})}return this}forEachFrom(e,t){if(this._root!==null){const r=[];this._root.searchAfter(e,r),r.forEach(i=>{i.event&&t(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class fat{constructor(e,t,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=t,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,t){e>this.max||(this.left!==null&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,t))}searchAfter(e,t){this.low>=e&&(t.push(this),this.left!==null&&this.left.searchAfter(e,t)),this.right!==null&&this.right.searchAfter(e,t)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class hat extends xb{constructor(e){super(),this.name="TimelineValue",this._timeline=new L0({memory:10}),this._initialValue=e}set(e,t){return this._timeline.add({value:e,time:t}),this}get(e){const t=this._timeline.get(e);return t?t.value:this._initialValue}}class N_ extends xr{constructor(){super(pr(N_.getDefaults(),arguments,["context"]))}connect(e,t=0,r=0){return jU(this,e,t,r),this}}class Q1 extends N_{constructor(){const e=pr(Q1.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,Dm(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):zst(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(fa.getDefaults(),{length:1024})}setMap(e,t=1024){const r=new Float32Array(t);for(let i=0,s=t;i<s;i++){const a=i/(s-1)*2-1;r[i]=e(a,i)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const t=["none","2x","4x"].some(r=>r.includes(e));yi(t,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class qU extends N_{constructor(){const e=pr(qU.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new Q1({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(N_.getDefaults(),{value:1})}_expFunc(e){return t=>Math.pow(Math.abs(t),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class I1{constructor(e,t){this.id=I1._eventId++,this._remainderTime=0;const r=Object.assign(I1.getDefaults(),t);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=Math.floor(r.time),this._remainderTime=r.time-this.time}static getDefaults(){return{callback:lo,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const t=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*t),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}I1._eventId=0;class Xq extends I1{constructor(e,t){super(e,t),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const r=Object.assign(Xq.getDefaults(),t);this.duration=r.duration,this._interval=r.interval,this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},I1.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return TL(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new Gf(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){TL(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Gf(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const t=this.transport.getTicksAtTime(e);Sw(t,this.time)&&(this._nextTick=this.floatTime+Math.ceil((t-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class VU extends np{constructor(){const e=pr(VU.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new hat(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new L0,this._repeatedEvents=new uat,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new HU({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Us(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(np.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,t){if(this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&t%this._ppq!==0&&t%(this._swingTicks*2)!==0){const r=t%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(r*Math.PI)*this._swingAmount;e+=new Gf(this.context,this._swingTicks*2/3).toSeconds()*i}Cne(!0),this._timeline.forEachAtTime(t,r=>r.invoke(e)),Cne(!1)}schedule(e,t){const r=new I1(this,{callback:e,time:new NT(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,t,r,i=1/0){const s=new Xq(this,{callback:e,duration:new N0(this.context,i).toTicks(),interval:new N0(this.context,t).toTicks(),time:new NT(this.context,r).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,t){const r=new I1(this,{callback:e,once:!0,time:new NT(this.context,t).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}cancel(e=0){const t=this.toTicks(e);return this._timeline.forEachFrom(t,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(t,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,t)=>{t=new Gf(this.context,t).toSeconds(),this.emit("start",e,t)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,t){this.context.resume();let r;return Ls(t)&&(r=this.toTicks(t)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){Dm(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new N0(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new N0(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new Gf(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),t=this._clock.getTicksAtTime(e);return new Gf(this.context,t).toBarsBeatsSixteenths()}set position(e){const t=this.toTicks(e);this.ticks=t}get seconds(){return this._clock.seconds}set seconds(e){const t=this.now(),r=this._clock.frequency.timeToTicks(e,t);this.ticks=r}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const t=this.now();if(this.state==="started"){const r=this._clock.getTicksAtTime(t),i=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,t),s=t+i;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",t),this._clock.setTicksAtTime(e,t)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const t=this.now(),r=this.getTicksAtTime(t),i=e-r%e;return this._clock.nextTickTime(i,t)}}syncSignal(e,t){const r=this.now();let i=this.bpm,s=1/(60/i.getValueAtTime(r)/this.PPQ),a=[];if(e.units==="time"){const l=.015625/s,c=new ji(l),u=new qU(-1),f=new ji(l);i.chain(c,u,f),i=f,s=1/s,a=[c,u,f]}t||(e.getValueAtTime(r)!==0?t=e.getValueAtTime(r)/s:t=0);const o=new ji(t);return i.connect(o),o.connect(e._param),a.push(o),this._syncedSignals.push({initial:e.value,nodes:a,signal:e}),e.value=0,this}unsyncSignal(e){for(let t=this._syncedSignals.length-1;t>=0;t--){const r=this._syncedSignals[t];r.signal===e&&(r.nodes.forEach(i=>i.dispose()),r.signal.value=r.initial,this._syncedSignals.splice(t,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),zO(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}FO.mixin(VU);BU(n=>{n.transport=new VU({context:n})});FU(n=>{n.transport.dispose()});class Uh extends xr{constructor(e){super(e),this.input=void 0,this._state=new HO("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=lo,this._syncedStop=lo,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new Sm({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Us(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,onstop:lo,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,t,r){let i=zg(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")yi(Sw(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,r);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const s=this._state.get(i);s&&(s.offset=this.toSeconds(Pv(t,0)),s.duration=r?this.toSeconds(r):void 0);const a=this.context.transport.schedule(o=>{this._start(o,t,r)},i);this._scheduled.push(a),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else T0e(this.context),this._start(i,t,r);return this}stop(e){let t=zg(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),this._state.getValueAtTime(t)==="started"||Ls(this._state.getNextState("started",t))){if(this.log("stop",t),!this._synced)this._stop(t);else{const r=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(r)}this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}restart(e,t,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,t,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,t)=>{if(Sw(t,0)){const r=this._state.get(t);if(r&&r.state==="started"&&r.time!==t){const i=t-this.toSeconds(r.time);let s;r.duration&&(s=this.toSeconds(r.duration)-i),this._start(e,this.toSeconds(r.offset)+i,s)}}},this._syncedStop=e=>{const t=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(t)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=lo,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class qO extends Ew{constructor(){const e=pr(qO.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,I_(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new zi({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Zo(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Ew.getDefaults(),{url:new Zo,loop:!1,loopEnd:0,loopStart:0,onload:lo,onerror:lo,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,t,r,i=1){yi(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,i),this.loop?t=Pv(t,this.loopStart):t=Pv(t,0);let a=Math.max(this.toSeconds(t),0);if(this.loop){const o=this.toSeconds(this.loopEnd)||this.buffer.duration,l=this.toSeconds(this.loopStart),c=o-l;U9(a,o)&&(a=(a-l)%c+l),__(a,this.buffer.duration)&&(a=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,TL(a,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,a)),Ls(r)){let o=this.toSeconds(r);o=Math.max(o,0),this.stop(s+o)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class jE extends Uh{constructor(){const e=pr(jE.getDefaults(),arguments,["type"]);super(e),this.name="Noise",this._source=null,this._playbackRate=e.playbackRate,this.type=e.type,this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Uh.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(e){if(yi(e in kne,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,this.state==="started")){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}_start(e){const t=kne[this._type];this._source=new qO({url:t,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(t.duration-.001))}_stop(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(e){this._stop(e),this._start(e)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const $x=44100*5,G8=2,Ry={brown:null,pink:null,white:null},kne={get brown(){if(!Ry.brown){const n=[];for(let e=0;e<G8;e++){const t=new Float32Array($x);n[e]=t;let r=0;for(let i=0;i<$x;i++){const s=Math.random()*2-1;t[i]=(r+.02*s)/1.02,r=t[i],t[i]*=3.5}}Ry.brown=new Zo().fromArray(n)}return Ry.brown},get pink(){if(!Ry.pink){const n=[];for(let e=0;e<G8;e++){const t=new Float32Array($x);n[e]=t;let r,i,s,a,o,l,c;r=i=s=a=o=l=c=0;for(let u=0;u<$x;u++){const f=Math.random()*2-1;r=.99886*r+f*.0555179,i=.99332*i+f*.0750759,s=.969*s+f*.153852,a=.8665*a+f*.3104856,o=.55*o+f*.5329522,l=-.7616*l-f*.016898,t[u]=r+i+s+a+o+l+c+f*.5362,t[u]*=.11,c=f*.115926}}Ry.pink=new Zo().fromArray(n)}return Ry.pink},get white(){if(!Ry.white){const n=[];for(let e=0;e<G8;e++){const t=new Float32Array($x);n[e]=t;for(let r=0;r<$x;r++)t[r]=Math.random()*2-1}Ry.white=new Zo().fromArray(n)}return Ry.white}};function cx(n,e){return Ec(this,void 0,void 0,function*(){const t=e/n.context.sampleRate,r=new jO(1,t,n.context.sampleRate);return new n.constructor(Object.assign(n.get(),{frequency:2/t,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}class Kq extends Ew{constructor(){const e=pr(Kq.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],I_(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new zi({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new zi({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Us(this,["frequency","detune"])}static getDefaults(){return Object.assign(Ew.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class zc extends Uh{constructor(){const e=pr(zc.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new fa({context:this.context,units:"frequency",value:e.frequency}),Us(this,"frequency"),this.detune=new fa({context:this.context,units:"cents",value:e.detune}),Us(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Uh.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const t=this.toSeconds(e),r=new Kq({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(t)}_stop(e){const t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}_restart(e){const t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return zc._periodicWaveCache.find(t=>t.phase===this._phase&&Kst(t.partials,this._partials));{const e=zc._periodicWaveCache.find(t=>t.type===this._type&&t.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const t=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&t)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const r=this._getCachedPeriodicWave();if(Ls(r)){const{partials:i,wave:s}=r;this._wave=s,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,s]=this._getRealImaginary(e,this._phase),a=this.context.createPeriodicWave(i,s);this._wave=a,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),zc._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),zc._periodicWaveCache.length>100&&zc._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){I0(e,0);let t=this._type;const r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(t=r[1]),this._type!=="custom")e===0?this.type=t:this.type=t+e.toString();else{const i=new Float32Array(e);this._partials.forEach((s,a)=>i[a]=s),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,t){let i=2048;const s=new Float32Array(i),a=new Float32Array(i);let o=1;if(e==="custom"){if(o=this._partials.length+1,this._partialCount=this._partials.length,i=o,this._partials.length===0)return[s,a]}else{const l=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);l?(o=parseInt(l[2],10)+1,this._partialCount=parseInt(l[2],10),e=l[1],o=Math.max(o,2),i=o):this._partialCount=0,this._partials=[]}for(let l=1;l<i;++l){const c=2/(l*Math.PI);let u;switch(e){case"sine":u=l<=o?1:0,this._partials[l-1]=u;break;case"square":u=l&1?2*c:0,this._partials[l-1]=u;break;case"sawtooth":u=c*(l&1?1:-1),this._partials[l-1]=u;break;case"triangle":l&1?u=2*(c*c)*(l-1>>1&1?-1:1):u=0,this._partials[l-1]=u;break;case"custom":u=this._partials[l-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}u!==0?(s[l]=-u*Math.sin(t*l),a[l]=u*Math.cos(t*l)):(s[l]=0,a[l]=0)}return[s,a]}_inverseFFT(e,t,r){let i=0;const s=e.length;for(let a=0;a<s;a++)i+=e[a]*Math.cos(a*r)+t[a]*Math.sin(a*r);return i}getInitialValue(){const[e,t]=this._getRealImaginary(this._type,0);let r=0;const i=Math.PI*2,s=32;for(let a=0;a<s;a++)r=Math.max(this._inverseFFT(e,t,a/s*i),r);return Qst(-this._inverseFFT(e,t,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}zc._periodicWaveCache=[];class Zq extends N_{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Q1({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Gv extends fa{constructor(){const e=pr(Gv.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new ji({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(fa.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class GU extends Uh{constructor(){const e=pr(GU.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new Zq({context:this.context}),this._modulationNode=new ji({context:this.context}),this._carrier=new zc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new zc({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Gv({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Us(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(zc.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class VO extends Uh{constructor(){const e=pr(VO.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new ji({context:this.context,gain:0}),this._carrier=new zc({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new fa({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new zc({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Gv({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Gv({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Us(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(zc.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class GO extends Uh{constructor(){const e=pr(GO.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new ji({context:this.context,gain:0}),this._thresh=new Q1({context:this.context,mapping:t=>t<=0?-1:1}),this.width=new fa({context:this.context,units:"audioRange",value:e.width}),this._triangle=new zc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Us(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Uh.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class $U extends Uh{constructor(){const e=pr($U.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new fa({context:this.context,units:"frequency",value:e.frequency}),this.detune=new fa({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Us(this,["frequency","detune"])}static getDefaults(){return Object.assign(zc.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(t=>t.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(t=>t.stop(e))}_restart(e){this._forEach(t=>t.restart(e))}_forEach(e){for(let t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}get type(){return this._type}set type(e){this._type=e,this._forEach(t=>t.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const t=-e/2,r=e/(this._oscillators.length-1);this._forEach((i,s)=>i.detune.value=t+r*s)}}get count(){return this._oscillators.length}set count(e){if(I0(e,1),this._oscillators.length!==e){this._forEach(t=>t.dispose()),this._oscillators=[];for(let t=0;t<e;t++){const r=new zc({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+t/e*360,partialCount:this._partialCount,onstop:t===0?()=>this.onstop(this):lo});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[t]=r}this.spread=this._spread,this.state==="started"&&this._forEach(t=>t.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((t,r)=>t.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(t=>t.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(t=>t.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(t=>t.partialCount=e),this._type=this._oscillators[0].type}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class WU extends Uh{constructor(){const e=pr(WU.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Gv({context:this.context,value:2}),this._pulse=new GO({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new zc({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Us(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Uh.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const One={am:GU,fat:$U,fm:VO,oscillator:zc,pulse:GO,pwm:WU};class Tw extends Uh{constructor(){const e=pr(Tw.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new fa({context:this.context,units:"frequency",value:e.frequency}),this.detune=new fa({context:this.context,units:"cents",value:e.detune}),Us(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(zc.getDefaults(),VO.getDefaults(),GU.getDefaults(),$U.getDefaults(),GO.getDefaults(),WU.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(t=>this._sourceType===t)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const t=One[e],r=this.now();if(this._oscillator){const i=this._oscillator;i.stop(r),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new t({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let t="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(t=this._oscillator.type),e==="fm"?this.type="fm"+t:e==="am"?this.type="am"+t:e==="fat"?this.type="fat"+t:e==="oscillator"?this.type=t:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,t){return e instanceof One[t]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&O_(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&O_(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ub(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return Ec(this,arguments,void 0,function*(e=1024){return cx(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Qq extends fa{constructor(){super(pr(Qq.getDefaults(),arguments,["value"])),this.override=!1,this.name="Add",this._sum=new ji({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,zE(this._constantSource,this._sum)}static getDefaults(){return Object.assign(fa.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class ww extends N_{constructor(){const e=pr(ww.getDefaults(),arguments,["min","max"]);super(e),this.name="Scale",this._mult=this.input=new Gv({context:this.context,value:e.max-e.min}),this._add=this.output=new Qq({context:this.context,value:e.min}),this._min=e.min,this._max=e.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(N_.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(e){this._min=e,this._setRange()}get max(){return this._max}set max(e){this._max=e,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Jq extends N_{constructor(){super(pr(Jq.getDefaults(),arguments)),this.name="Zero",this._gain=new ji({context:this.context}),this.output=this._gain,this.input=void 0,I_(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),U0e(this.context.getConstant(0),this._gain),this}}class HE extends xr{constructor(){const e=pr(HE.getDefaults(),arguments,["frequency","min","max"]);super(e),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=zi.prototype._fromType,this._toType=zi.prototype._toType,this._is=zi.prototype._is,this._clampValue=zi.prototype._clampValue,this._oscillator=new zc(e),this.frequency=this._oscillator.frequency,this._amplitudeGain=new ji({context:this.context,gain:e.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new fa({context:this.context,units:"audioRange",value:0}),this._zeros=new Jq({context:this.context}),this._a2g=new Zq({context:this.context}),this._scaler=this.output=new ww({context:this.context,max:e.max,min:e.min}),this.units=e.units,this.min=e.min,this.max=e.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),Us(this,["amplitude","frequency"]),this.phase=e.phase}static getDefaults(){return Object.assign(zc.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}stop(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(e){e=this._fromType(e),this._scaler.min=e}get max(){return this._toType(this._scaler.max)}set max(e){e=this._fromType(e),this._scaler.max=e}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(e){this._oscillator.partials=e,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e,this._setStoppedValue()}get units(){return this._units}set units(e){const t=this.min,r=this.max;this._units=e,this.min=t,this.max=r}get state(){return this._oscillator.state}connect(e,t,r){return(e instanceof zi||e instanceof fa)&&(this.convert=e.convert,this.units=e.units),jU(this,e,t,r),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function B0e(n,e=1/0){const t=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(s){I0(s,n,e),t.set(this,s)}})}}function Tb(n,e=1/0){const t=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return t.get(this)},set:function(s){I0(this.toSeconds(s),n,e),t.set(this,s)}})}}class $O extends Uh{constructor(){const e=pr($O.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Zo({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Uh.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:lo,onerror:lo,playbackRate:1,reverse:!1})}load(e){return Ec(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=lo){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,t,r){return super.start(e,t,r),this}_start(e,t,r){this._loop?t=Pv(t,this._loopStart):t=Pv(t,0);const i=this.toSeconds(t),s=r;r=Pv(r,Math.max(this._buffer.duration-i,0));let a=this.toSeconds(r);a=a/this._playbackRate,e=this.toSeconds(e);const o=new qO({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+a),this._state.setStateAtTime("stopped",e+a,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&zg(s)?o.start(e,i):o.start(e,i,a-this.toSeconds(this.fadeOut))}_stop(e){const t=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(t))}restart(e,t,r){return super.restart(e,t,r),this}_restart(e,t,r){var i;(i=[...this._activeSources].pop())===null||i===void 0||i.stop(e),this._start(e,t,r)}seek(e,t){const r=this.toSeconds(t);if(this._state.getValueAtTime(r)==="started"){const i=this.toSeconds(e);this._stop(r),this._start(r,i)}return this}setLoopPoints(e,t){return this.loopStart=e,this.loopEnd=t,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&I0(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&I0(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(t=>{t.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(t=>{t.loop=e}),e)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const t=this.now(),r=this._state.getNextState("stopped",t);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,t)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}ql([Tb(0)],$O.prototype,"fadeIn",void 0);ql([Tb(0)],$O.prototype,"fadeOut",void 0);class dat extends N_{constructor(){super(...arguments),this.name="Abs",this._abs=new Q1({context:this.context,mapping:e=>Math.abs(e)<.001?0:Math.abs(e)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class pat extends N_{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Q1({context:this.context,mapping:e=>Math.abs(e)*2-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class eV extends ww{constructor(){const e=pr(eV.getDefaults(),arguments,["min","max","exponent"]);super(e),this.name="ScaleExp",this.input=this._exp=new qU({context:this.context,value:e.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(ww.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(e){this._exp.value=e}dispose(){return super.dispose(),this._exp.dispose(),this}}class Hg extends xr{constructor(){const e=pr(Hg.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new fa({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(xr.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,t){if(ub(e))return e;{let r;for(r in lN)if(lN[r][t]===e)return r;return e}}_setCurve(e,t,r){if(ub(r)&&Reflect.has(lN,r)){const i=lN[r];_1(i)?e!=="_decayCurve"&&(this[e]=i[t]):this[e]=i}else if(Dm(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,t=1){this.log("triggerAttack",e,t),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),a=this.getValueAtTime(e);if(a>0){const o=1/i;i=(1-a)/o}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(t,i,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(t,i,e);else{this._sig.cancelAndHoldAtTime(e);let o=this._attackCurve;for(let l=1;l<o.length;l++)if(o[l-1]<=a&&a<=o[l]){o=this._attackCurve.slice(l),o[0]=a;break}this._sig.setValueCurveAtTime(o,e,i,t)}if(s&&this.sustain<1){const o=t*this.sustain,l=e+i;this.log("decay",l),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(o,s+l):this._sig.exponentialApproachValueAtTime(o,l,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const t=this.getValueAtTime(e);if(t>0){const r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(yi(Dm(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,t))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),this.triggerAttack(t,r),this.triggerRelease(t+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,t=0,r=0){return jU(this,e,t,r),this}asArray(){return Ec(this,arguments,void 0,function*(e=1024){const t=e/this.context.sampleRate,r=new jO(1,t,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),a=s*.1,o=s+a,l=new this.constructor(Object.assign(this.get(),{attack:t*this.toSeconds(this.attack)/o,decay:t*this.toSeconds(this.decay)/o,release:t*this.toSeconds(this.release)/o,context:r}));return l._sig.toDestination(),l.triggerAttackRelease(t*(i+a)/o,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}ql([Tb(0)],Hg.prototype,"attack",void 0);ql([Tb(0)],Hg.prototype,"decay",void 0);ql([B0e(0,1)],Hg.prototype,"sustain",void 0);ql([Tb(0)],Hg.prototype,"release",void 0);const lN=(()=>{let e,t;const r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/127*(Math.PI/2));const i=[],s=6.4;for(e=0;e<127;e++){t=e/127;const d=Math.sin(t*(Math.PI*2)*s-Math.PI/2)+1;i[e]=d/10+t*.83}i[127]=1;const a=[],o=5;for(e=0;e<128;e++)a[e]=Math.ceil(e/127*o)/o;const l=[];for(e=0;e<128;e++)t=e/127,l[e]=.5*(1-Math.cos(Math.PI*t));const c=[];for(e=0;e<128;e++){t=e/127;const d=Math.pow(t,3)*4+.2,g=Math.cos(d*Math.PI*2*t);c[e]=Math.abs(g*(1-t))}function u(d){const g=new Array(d.length);for(let p=0;p<d.length;p++)g[p]=1-d[p];return g}function f(d){return d.slice(0).reverse()}return{bounce:{In:u(c),Out:c},cosine:{In:r,Out:f(r)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:u(i)},sine:{In:l,Out:u(l)},step:{In:a,Out:u(a)}}})();class $v extends xr{constructor(){const e=pr($v.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=t=>this._original_triggerRelease(t),this._volume=this.output=new Sm({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Us(this,"volume")}static getDefaults(){return Object.assign(xr.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,t){const r=this["_original_"+e]=this[e];this[e]=(...i)=>{const s=i[t],a=this.context.transport.schedule(o=>{i[t]=o,r.apply(this,i)},s);this._scheduledEvents.push(a)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,t,r,i){const s=this.toSeconds(r),a=this.toSeconds(t);return this.triggerAttack(e,s,i),this.triggerRelease(s+a),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class P_ extends $v{constructor(){const e=pr(P_.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign($v.getDefaults(),{detune:0,onsilence:lo,portamento:0})}triggerAttack(e,t,r=1){this.log("triggerAttack",e,t,r);const i=this.toSeconds(t);return this._triggerEnvelopeAttack(i,r),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}setNote(e,t){const r=this.toSeconds(t),i=e instanceof Om?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,s,r)}else this.frequency.setValueAtTime(i,r);return this}}ql([Tb(0)],P_.prototype,"portamento",void 0);class YU extends Hg{constructor(){super(pr(YU.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new ji({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Kd extends P_{constructor(){const e=pr(Kd.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new Tw(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new YU(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Us(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(P_.getDefaults(),{envelope:Object.assign(Cv(Hg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Cv(Tw.getDefaults(),[...Object.keys(Uh.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),this.envelope.sustain===0){const r=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class AL extends P_{constructor(){const e=pr(AL.getDefaults(),arguments);super(e),this.name="ModulationSynth",this._carrier=new Kd({context:this.context,oscillator:e.oscillator,envelope:e.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new Kd({context:this.context,oscillator:e.modulation,envelope:e.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new fa({context:this.context,units:"frequency"}),this.detune=new fa({context:this.context,value:e.detune,units:"cents"}),this.harmonicity=new Gv({context:this.context,value:e.harmonicity,minValue:0}),this._modulationNode=new ji({context:this.context,gain:0}),Us(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(P_.getDefaults(),{harmonicity:3,oscillator:Object.assign(Cv(Tw.getDefaults(),[...Object.keys(Uh.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign(Cv(Hg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Cv(Tw.getDefaults(),[...Object.keys(Uh.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign(Cv(Hg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}_triggerEnvelopeRelease(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class Rw extends xr{constructor(){const e=pr(Rw.getDefaults(),arguments,["frequency","type"]);super(e),this.name="BiquadFilter",this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new zi({context:this.context,units:"number",value:e.Q,param:this._filter.Q}),this.frequency=new zi({context:this.context,units:"frequency",value:e.frequency,param:this._filter.frequency}),this.detune=new zi({context:this.context,units:"cents",value:e.detune,param:this._filter.detune}),this.gain=new zi({context:this.context,units:"decibels",convert:!1,value:e.gain,param:this._filter.gain}),this.type=e.type}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(e){yi(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._filter.type=e}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let a=0;a<e;a++){const l=Math.pow(a/e,2)*19980+20;t[a]=l}const r=new Float32Array(e),i=new Float32Array(e),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(t,r,i),r}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class bd extends xr{constructor(){const e=pr(bd.getDefaults(),arguments,["frequency","type","rolloff"]);super(e),this.name="Filter",this.input=new ji({context:this.context}),this.output=new ji({context:this.context}),this._filters=[],this._filters=[],this.Q=new fa({context:this.context,units:"positive",value:e.Q}),this.frequency=new fa({context:this.context,units:"frequency",value:e.frequency}),this.detune=new fa({context:this.context,units:"cents",value:e.detune}),this.gain=new fa({context:this.context,units:"decibels",convert:!1,value:e.gain}),this._type=e.type,this.rolloff=e.rolloff,Us(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(e){yi(["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e)!==-1,`Invalid filter type: ${e}`),this._type=e,this._filters.forEach(r=>r.type=e)}get rolloff(){return this._rolloff}set rolloff(e){const t=O_(e)?e:parseInt(e,10),r=[-12,-24,-48,-96];let i=r.indexOf(t);yi(i!==-1,`rolloff can only be ${r.join(", ")}`),i+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach(s=>s.disconnect()),this._filters=new Array(i);for(let s=0;s<i;s++){const a=new Rw({context:this.context});a.type=this._type,this.frequency.connect(a.frequency),this.detune.connect(a.detune),this.Q.connect(a.Q),this.gain.connect(a.gain),this._filters[s]=a}this._internalChannels=this._filters,zE(this.input,...this._internalChannels,this.output)}getFrequencyResponse(e=128){const t=new Rw({context:this.context,frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),r=new Float32Array(e).map(()=>1);return this._filters.forEach(()=>{t.getFrequencyResponse(e).forEach((s,a)=>r[a]*=s)}),t.dispose(),r}dispose(){return super.dispose(),this._filters.forEach(e=>{e.dispose()}),zO(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class tV extends AL{constructor(){const e=pr(tV.getDefaults(),arguments);super(e),this.name="FMSynth",this.modulationIndex=new Gv({context:this.context,value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(AL.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const Ine=[1,1.483,1.932,2.546,2.63,3.897];class nV extends P_{constructor(){const e=pr(nV.getDefaults(),arguments);super(e),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[],this.detune=new fa({context:this.context,units:"cents",value:e.detune}),this.frequency=new fa({context:this.context,units:"frequency"}),this._amplitude=new ji({context:this.context,gain:0}).connect(this.output),this._highpass=new bd({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let t=0;t<Ine.length;t++){const r=new VO({context:this.context,harmonicity:e.harmonicity,modulationIndex:e.modulationIndex,modulationType:"square",onstop:t===0?()=>this.onsilence(this):lo,type:"square"});r.connect(this._highpass),this._oscillators[t]=r;const i=new Gv({context:this.context,value:Ine[t]});this._freqMultipliers[t]=i,this.frequency.chain(i,r.frequency),this.detune.connect(r.detune)}this._filterFreqScaler=new ww({context:this.context,max:7e3,min:this.toFrequency(e.resonance)}),this.envelope=new Hg({attack:e.envelope.attack,attackCurve:"linear",context:this.context,decay:e.envelope.decay,release:e.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=e.octaves,this.octaves=e.octaves}static getDefaults(){return y1(P_.getDefaults(),{envelope:Object.assign(Cv(Hg.getDefaults(),Object.keys(xr.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(e,t=1){return this.envelope.triggerAttack(e,t),this._oscillators.forEach(r=>r.start(e)),this.envelope.sustain===0&&this._oscillators.forEach(r=>{r.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))}),this}_triggerEnvelopeRelease(e){return this.envelope.triggerRelease(e),this._oscillators.forEach(t=>t.stop(e+this.toSeconds(this.envelope.release))),this}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(e){this._oscillators.forEach(t=>t.modulationIndex.value=e)}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(e){this._oscillators.forEach(t=>t.harmonicity.value=e)}get resonance(){return this._filterFreqScaler.min}set resonance(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}dispose(){return super.dispose(),this._oscillators.forEach(e=>e.dispose()),this._freqMultipliers.forEach(e=>e.dispose()),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class iR extends Kd{constructor(){const e=pr(iR.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Us(this,["oscillator","envelope"])}static getDefaults(){return y1(P_.getDefaults(),Kd.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,t){const r=this.toSeconds(t),i=this.toFrequency(e instanceof Om?e.toFrequency():e),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,r),this.oscillator.frequency.exponentialRampToValueAtTime(i,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}ql([B0e(0)],iR.prototype,"octaves",void 0);ql([Tb(0)],iR.prototype,"pitchDecay",void 0);class n1 extends $v{constructor(){const e=pr(n1.getDefaults(),arguments);super(e),this.name="NoiseSynth",this.noise=new jE(Object.assign({context:this.context},e.noise)),this.envelope=new YU(Object.assign({context:this.context},e.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign($v.getDefaults(),{envelope:Object.assign(Cv(Hg.getDefaults(),Object.keys(xr.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Cv(jE.getDefaults(),Object.keys(Uh.getDefaults())),{type:"white"})})}triggerAttack(e,t=1){return e=this.toSeconds(e),this.envelope.triggerAttack(e,t),this.noise.start(e),this.envelope.sustain===0&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(e,t,r=1){return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,r),this.triggerRelease(t+e),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const F0e=new Set;function rV(n){F0e.add(n)}function z0e(n,e){const t=`registerProcessor("${n}", ${e})`;F0e.add(t)}const mat=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;rV(mat);const gat=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;rV(gat);const _at=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;rV(_at);const vat="feedback-comb-filter",yat=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;z0e(vat,yat);class iV extends xr{constructor(){const e=pr(iV.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OnePoleFilter",this._frequency=e.frequency,this._type=e.type,this.input=new ji({context:this.context}),this.output=new ji({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(xr.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const e=this._filter,t=this.toFrequency(this._frequency),r=1/(2*Math.PI*t);if(this._type==="lowpass"){const i=1/(r*this.context.sampleRate),s=i-1;this._filter=this.context.createIIRFilter([i,0],[1,s])}else{const i=1/(r*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,i])}this.input.chain(this._filter,this.output),e&&this.context.setTimeout(()=>{this.disposed||(this.input.disconnect(e),e.disconnect())},this.blockTime)}get frequency(){return this._frequency}set frequency(e){this._frequency=e,this._createFilter()}get type(){return this._type}set type(e){this._type=e,this._createFilter()}getFrequencyResponse(e=128){const t=new Float32Array(e);for(let s=0;s<e;s++){const o=Math.pow(s/e,2)*19980+20;t[s]=o}const r=new Float32Array(e),i=new Float32Array(e);return this._filter.getFrequencyResponse(t,r,i),r}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class sV extends $v{constructor(){const e=pr(sV.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=i=>this.releaseAll(i),yi(!O_(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const t=e.voice.getDefaults();this.options=Object.assign(t,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const r=this._voices.indexOf(this._dummyVoice);this._voices.splice(r,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign($v.getDefaults(),{maxPolyphony:32,options:{},voice:Kd})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const t=this._activeVoices.findIndex(r=>r.voice===e);this._activeVoices.splice(t,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return yi(e instanceof P_,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else LU("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,t,r){e.forEach(i=>{const s=new RL(this.context,i).toMidi(),a=this._getNextAvailableVoice();a&&(a.triggerAttack(i,t,r),this._activeVoices.push({midi:s,voice:a,released:!1}),this.log("triggerAttack",i,t))})}_triggerRelease(e,t){e.forEach(r=>{const i=new RL(this.context,r).toMidi(),s=this._activeVoices.find(({midi:a,released:o})=>a===i&&!o);s&&(s.voice.triggerRelease(t),s.released=!0,this.log("triggerRelease",r,t))})}_scheduleEvent(e,t,r,i){yi(!this.disposed,"Synth was already disposed"),r<=this.now()?e==="attack"?this._triggerAttack(t,r,i):this._triggerRelease(t,r):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,t,r,i)},r-this.now())}triggerAttack(e,t,r){Array.isArray(e)||(e=[e]);const i=this.toSeconds(t);return this._scheduleEvent("attack",e,i,r),this}triggerRelease(e,t){Array.isArray(e)||(e=[e]);const r=this.toSeconds(t);return this._scheduleEvent("release",e,r),this}triggerAttackRelease(e,t,r,i){const s=this.toSeconds(r);if(this.triggerAttack(e,s,i),Dm(t)){yi(Dm(e),"If the duration is an array, the notes must also be an array"),e=e;for(let a=0;a<e.length;a++){const o=t[Math.min(a,t.length-1)],l=this.toSeconds(o);yi(l>0,"The duration must be greater than 0"),this.triggerRelease(e[a],s+l)}}else{const a=this.toSeconds(t);yi(a>0,"The duration must be greater than 0"),this.triggerRelease(e,s+a)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const t=Cv(e,["onsilence","context"]);return this.options=y1(this.options,t),this._voices.forEach(r=>r.set(t)),this._dummyVoice.set(t),this}get(){return this._dummyVoice.get()}releaseAll(e){const t=this.toSeconds(e);return this._activeVoices.forEach(({voice:r})=>{r.triggerRelease(t)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class WO extends $v{constructor(){const e=pr(WO.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const t={};Object.keys(e.urls).forEach(r=>{const i=parseInt(r,10);if(yi(oN(r)||O_(i)&&isFinite(i),`url key is neither a note or midi pitch: ${r}`),oN(r)){const s=new Om(this.context,r).toMidi();t[s]=e.urls[r]}else O_(i)&&isFinite(i)&&(t[i]=e.urls[i])}),this._buffers=new Yq({urls:t,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign($v.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:lo,onerror:lo,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,t,r=1){return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach(i=>{const s=D0e(new Om(this.context,i).toFrequency()),a=Math.round(s),o=s-a,l=this._findClosest(a),c=a-l,u=this._buffers.get(c),f=P0e(l+o),d=new qO({url:u,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:f}).connect(this.output);d.start(t,0,u.duration/f,r),Dm(this._activeSources.get(a))||this._activeSources.set(a,[]),this._activeSources.get(a).push(d),d.onended=()=>{if(this._activeSources&&this._activeSources.has(a)){const g=this._activeSources.get(a),p=g.indexOf(d);p!==-1&&g.splice(p,1)}}}),this}triggerRelease(e,t){return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=new Om(this.context,r).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const s=this._activeSources.get(i);t=this.toSeconds(t),s.forEach(a=>{a.stop(t)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const t=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(t)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,t,r,i=1){const s=this.toSeconds(r);return this.triggerAttack(e,s,i),Dm(t)?(yi(Dm(e),"notes must be an array when duration is array"),e.forEach((a,o)=>{const l=t[Math.min(o,t.length-1)];this.triggerRelease(a,s+this.toSeconds(l))})):this.triggerRelease(e,s+this.toSeconds(t)),this}add(e,t,r){if(yi(oN(e)||isFinite(e),`note must be a pitch or midi: ${e}`),oN(e)){const i=new Om(this.context,e).toMidi();this._buffers.add(i,t,r)}else this._buffers.add(e,t,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(t=>t.dispose())}),this._activeSources.clear(),this}}ql([Tb(0)],WO.prototype,"attack",void 0);ql([Tb(0)],WO.prototype,"release",void 0);class ST extends np{constructor(){const e=pr(ST.getDefaults(),arguments,["callback","value"]);super(e),this.name="ToneEvent",this._state=new HO("stopped"),this._startOffset=0,this._loop=e.loop,this.callback=e.callback,this.value=e.value,this._loopStart=this.toTicks(e.loopStart),this._loopEnd=this.toTicks(e.loopEnd),this._playbackRate=e.playbackRate,this._probability=e.probability,this._humanize=e.humanize,this.mute=e.mute,this._playbackRate=e.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(np.getDefaults(),{callback:lo,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(e=-1){this._state.forEachFrom(e,t=>{let r;if(t.state==="started"){t.id!==-1&&this.context.transport.clear(t.id);const i=t.time+Math.round(this.startOffset/this._playbackRate);if(this._loop===!0||O_(this._loop)&&this._loop>1){r=1/0,O_(this._loop)&&(r=this._loop*this._getLoopDuration());const s=this._state.getAfter(i);s!==null&&(r=Math.min(r,s.time-i)),r!==1/0&&(r=new Gf(this.context,r));const a=new Gf(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),a,new Gf(this.context,i),r)}else t.id=this.context.transport.schedule(this._tick.bind(this),new Gf(this.context,i))}})}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e}get probability(){return this._probability}set probability(e){this._probability=e}get humanize(){return this._humanize}set humanize(e){this._humanize=e}start(e){const t=this.toTicks(e);return this._state.getValueAtTime(t)==="stopped"&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}stop(e){this.cancel(e);const t=this.toTicks(e);if(this._state.getValueAtTime(t)==="started"){this._state.setStateAtTime("stopped",t,{id:-1});const r=this._state.getBefore(t);let i=t;r!==null&&(i=r.time),this._rescheduleEvents(i)}return this}cancel(e){e=Pv(e,-1/0);const t=this.toTicks(e);return this._state.forEachFrom(t,r=>{this.context.transport.clear(r.id)}),this._state.cancel(t),this}_tick(e){const t=this.context.transport.getTicksAtTime(e);if(!this.mute&&this._state.getValueAtTime(t)==="started"){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let r=.02;x0e(this.humanize)||(r=this.toSeconds(this.humanize)),e+=(Math.random()*2-1)*r}this.callback(e,this.value)}}_getLoopDuration(){return(this._loopEnd-this._loopStart)/this._playbackRate}get loop(){return this._loop}set loop(e){this._loop=e,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._rescheduleEvents()}get loopEnd(){return new Gf(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}get loopStart(){return new Gf(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const e=this.context.transport.ticks,t=this._state.get(e);if(t!==null&&t.state==="started"){const r=this._getLoopDuration();return(e-t.time)%r/r}else return 0}else return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Dk extends ST{constructor(){const e=pr(Dk.getDefaults(),arguments,["callback","events"]);super(e),this.name="Part",this._state=new HO("stopped"),this._events=new Set,this._state.increasing=!0,e.events.forEach(t=>{Dm(t)?this.add(t[0],t[1]):this.add(t)})}static getDefaults(){return Object.assign(ST.getDefaults(),{events:[]})}start(e,t){const r=this.toTicks(e);if(this._state.getValueAtTime(r)!=="started"){t=Pv(t,this._loop?this._loopStart:0),this._loop?t=Pv(t,this._loopStart):t=Pv(t,0);const i=this.toTicks(t);this._state.add({id:-1,offset:i,state:"started",time:r}),this._forEach(s=>{this._startNote(s,r,i)})}return this}_startNote(e,t,r){t-=r,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<r&&(t+=this._getLoopDuration()),e.start(new Gf(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=r&&(e.loop=!1,e.start(new Gf(this.context,t))):e.startOffset>=r&&e.start(new Gf(this.context,t))}get startOffset(){return this._startOffset}set startOffset(e){this._startOffset=e,this._forEach(t=>{t.startOffset+=this._startOffset})}stop(e){const t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach(r=>{r.stop(e)}),this}at(e,t){const r=new NT(this.context,e).toTicks(),i=new Gf(this.context,1).toSeconds(),s=this._events.values();let a=s.next();for(;!a.done;){const o=a.value;if(Math.abs(r-o.startOffset)<i)return Ls(t)&&(o.value=t),o;a=s.next()}return Ls(t)?(this.add(e,t),this.at(e)):null}add(e,t){e instanceof Object&&Reflect.has(e,"time")&&(t=e,e=t.time);const r=this.toTicks(e);let i;return t instanceof ST?(i=t,i.callback=this._tick.bind(this)):i=new ST({callback:this._tick.bind(this),context:this.context,value:t}),i.startOffset=r,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(e){this._state.forEach(t=>{t.state==="started"?this._startNote(e,t.time,t.offset):e.stop(new Gf(this.context,t.time))})}remove(e,t){return _1(e)&&e.hasOwnProperty("time")&&(t=e,e=t.time),e=this.toTicks(e),this._events.forEach(r=>{r.startOffset===e&&(zg(t)||Ls(t)&&r.value===t)&&(this._events.delete(r),r.dispose())}),this}clear(){return this._forEach(e=>e.dispose()),this._events.clear(),this}cancel(e){return this._forEach(t=>t.cancel(e)),this._state.cancel(this.toTicks(e)),this}_forEach(e){return this._events&&this._events.forEach(t=>{t instanceof Dk?t._forEach(e):e(t)}),this}_setAll(e,t){this._forEach(r=>{r[e]=t})}_tick(e,t){this.mute||this.callback(e,t)}_testLoopBoundries(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):e.state==="stopped"&&this._restartEvent(e)}get probability(){return this._probability}set probability(e){this._probability=e,this._setAll("probability",e)}get humanize(){return this._humanize}set humanize(e){this._humanize=e,this._setAll("humanize",e)}get loop(){return this._loop}set loop(e){this._loop=e,this._forEach(t=>{t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.loop=e,this._testLoopBoundries(t)})}get loopEnd(){return new Gf(this.context,this._loopEnd).toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopEnd=e,this._testLoopBoundries(t)})}get loopStart(){return new Gf(this.context,this._loopStart).toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e),this._loop&&this._forEach(t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this._setAll("playbackRate",e)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}class XU extends xr{constructor(){const e=pr(XU.getDefaults(),arguments,["fade"]);super(e),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new pat({context:this.context}),this.a=new ji({context:this.context,gain:0}),this.b=new ji({context:this.context,gain:0}),this.output=new ji({context:this.context}),this._internalChannels=[this.a,this.b],this.fade=new fa({context:this.context,units:"normalRange",value:e.fade}),Us(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",I_(this._split,this.a.gain,0),I_(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(xr.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}let $m=class extends xr{constructor(e){super(e),this.name="Effect",this._dryWet=new XU({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new ji({context:this.context}),this.effectReturn=new ji({context:this.context}),this.input=new ji({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(e.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],Us(this,"wet")}static getDefaults(){return Object.assign(xr.getDefaults(),{wet:1})}connectEffect(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}};class aV extends xr{constructor(){const e=pr(aV.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new zi({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Us(this,"pan")}static getDefaults(){return Object.assign(xr.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class oV extends xr{constructor(){const e=pr(oV.getDefaults(),arguments,["smoothing"]);super(e),this.name="Follower",this._abs=this.input=new dat({context:this.context}),this._lowpass=this.output=new iV({context:this.context,frequency:1/this.toSeconds(e.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=e.smoothing}static getDefaults(){return Object.assign(xr.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class lV extends $m{constructor(){const e=pr(lV.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);super(e),this.name="AutoWah",this._follower=new oV({context:this.context,smoothing:e.follower}),this._sweepRange=new eV({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this._inputBoost=new ji({context:this.context}),this._bandpass=new bd({context:this.context,rolloff:-48,frequency:0,Q:e.Q}),this._peaking=new bd({context:this.context,type:"peaking"}),this._peaking.gain.value=e.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=e.sensitivity,Us(this,["gain","Q"])}static getDefaults(){return Object.assign($m.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(e){this._octaves=e,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(e){this._follower.smoothing=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}get sensitivity(){return N0e(1/this._inputBoost.gain.value)}set sensitivity(e){this._inputBoost.gain.value=1/I0e(e)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const bat="bit-crusher",Sat=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;z0e(bat,Sat);class KU extends xr{constructor(){const e=pr(KU.getDefaults(),arguments,["channels"]);super(e),this.name="Split",this._splitter=this.input=this.output=this.context.createChannelSplitter(e.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(xr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class YO extends xr{constructor(){const e=pr(YO.getDefaults(),arguments,["channels"]);super(e),this.name="Merge",this._merger=this.output=this.input=this.context.createChannelMerger(e.channels)}static getDefaults(){return Object.assign(xr.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class CL extends xr{constructor(e){super(e),this.name="StereoEffect",this.input=new ji({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new XU({context:this.context,fade:e.wet}),this.wet=this._dryWet.fade,this._split=new KU({context:this.context,channels:2}),this._merge=new YO({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),Us(this,["wet"])}connectEffectLeft(...e){this._split.connect(e[0],0,0),zE(...e),I_(e[e.length-1],this._merge,0,0)}connectEffectRight(...e){this._split.connect(e[0],1,0),zE(...e),I_(e[e.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(xr.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class Nne extends CL{constructor(e){super(e),this.feedback=new fa({context:this.context,value:e.feedback,units:"normalRange"}),this._feedbackL=new ji({context:this.context}),this._feedbackR=new ji({context:this.context}),this._feedbackSplit=new KU({context:this.context,channels:2}),this._feedbackMerge=new YO({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),Us(this,["feedback"])}static getDefaults(){return Object.assign(CL.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class cV extends Nne{constructor(){const e=pr(cV.getDefaults(),arguments,["frequency","delayTime","depth"]);super(e),this.name="Chorus",this._depth=e.depth,this._delayTime=e.delayTime/1e3,this._lfoL=new HE({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new HE({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._delayNodeL=new xw({context:this.context}),this._delayNodeR=new xw({context:this.context}),this.frequency=this._lfoL.frequency,Us(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=e.type,this.spread=e.spread}static getDefaults(){return Object.assign(Nne.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(e){this._depth=e;const t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}get delayTime(){return this._delayTime*1e3}set delayTime(e){this._delayTime=e/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(e){this._lfoL.type=e,this._lfoR.type=e}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}start(e){return this._lfoL.start(e),this._lfoR.start(e),this}stop(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class Lk extends $m{constructor(){const e=pr(Lk.getDefaults(),arguments,["distortion"]);super(e),this.name="Distortion",this._shaper=new Q1({context:this.context,length:4096}),this._distortion=e.distortion,this.connectEffect(this._shaper),this.distortion=e.distortion,this.oversample=e.oversample}static getDefaults(){return Object.assign($m.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(e){this._distortion=e;const t=e*100,r=Math.PI/180;this._shaper.setMap(i=>Math.abs(i)<.001?0:(3+t)*i*20*r/(Math.PI+t*Math.abs(i)))}get oversample(){return this._shaper.oversample}set oversample(e){this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.dispose(),this}}class Pne extends $m{constructor(e){super(e),this.name="FeedbackEffect",this._feedbackGain=new ji({context:this.context,gain:e.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,Us(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign($m.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class uV extends Pne{constructor(){const e=pr(uV.getDefaults(),arguments,["delayTime","feedback"]);super(e),this.name="FeedbackDelay",this._delayNode=new xw({context:this.context,delayTime:e.delayTime,maxDelay:e.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),Us(this,"delayTime")}static getDefaults(){return Object.assign(Pne.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class fV extends CL{constructor(){const e=pr(fV.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);super(e),this.name="Phaser",this._lfoL=new HE({context:this.context,frequency:e.frequency,min:0,max:1}),this._lfoR=new HE({context:this.context,frequency:e.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(e.baseFrequency),this._octaves=e.octaves,this.Q=new fa({context:this.context,value:e.Q,units:"positive"}),this._filtersL=this._makeFilters(e.stages,this._lfoL),this._filtersR=this._makeFilters(e.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=e.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=e.baseFrequency,this.octaves=e.octaves,this._lfoL.start(),this._lfoR.start(),Us(this,["frequency","Q"])}static getDefaults(){return Object.assign(CL.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(e,t){const r=[];for(let i=0;i<e;i++){const s=this.context.createBiquadFilter();s.type="allpass",this.Q.connect(s.Q),t.connect(s.frequency),r.push(s)}return r}get octaves(){return this._octaves}set octaves(e){this._octaves=e;const t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach(e=>e.disconnect()),this._filtersR.forEach(e=>e.disconnect()),this.frequency.dispose(),this}}class hV extends $m{constructor(){const e=pr(hV.getDefaults(),arguments,["decay"]);super(e),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=this.toSeconds(e.decay);I0(t,.001),this._decay=t;const r=this.toSeconds(e.preDelay);I0(r,0),this._preDelay=r,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign($m.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(e){e=this.toSeconds(e),I0(e,.001),this._decay=e,this.generate()}get preDelay(){return this._preDelay}set preDelay(e){e=this.toSeconds(e),I0(e,0),this._preDelay=e,this.generate()}generate(){return Ec(this,void 0,void 0,function*(){const e=this.ready,t=new jO(2,this._decay+this._preDelay,this.context.sampleRate),r=new jE({context:t}),i=new jE({context:t}),s=new YO({context:t});r.connect(s,0,0),i.connect(s,0,1);const a=new ji({context:t}).toDestination();s.connect(a),r.start(0),i.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=t.render();return this.ready=o.then(lo),yield e,this._convolver.buffer=(yield o).get(),this})}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class ZU extends $m{constructor(){const e=pr(ZU.getDefaults(),arguments,["frequency","depth"]);super(e),this.name="Vibrato",this._delayNode=new xw({context:this.context,delayTime:0,maxDelay:e.maxDelay}),this._lfo=new HE({context:this.context,type:e.type,min:0,max:e.maxDelay,frequency:e.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=e.depth,Us(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign($m.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(e){this._lfo.type=e}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class hf extends xr{constructor(){const e=pr(hf.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new ji({context:this.context}),hf._allSolos.has(this.context)||hf._allSolos.set(this.context,new Set),hf._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(xr.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),hf._allSolos.get(this.context).forEach(t=>t._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){hf._soloed.has(this.context)||hf._soloed.set(this.context,new Set),hf._soloed.get(this.context).add(this)}_removeSolo(){hf._soloed.has(this.context)&&hf._soloed.get(this.context).delete(this)}_isSoloed(){return hf._soloed.has(this.context)&&hf._soloed.get(this.context).has(this)}_noSolos(){return!hf._soloed.has(this.context)||hf._soloed.has(this.context)&&hf._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),hf._allSolos.get(this.context).delete(this),this._removeSolo(),this}}hf._allSolos=new Map;hf._soloed=new Map;class dV extends xr{constructor(){const e=pr(dV.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new aV({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new Sm({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Us(this,["pan","volume"])}static getDefaults(){return Object.assign(xr.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class Em extends xr{constructor(){const e=pr(Em.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new hf({solo:e.solo,context:this.context}),this._panVol=this.output=new dV({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Us(this,["pan","volume"])}static getDefaults(){return Object.assign(xr.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return Em.buses.has(e)||Em.buses.set(e,new ji({context:this.context})),Em.buses.get(e)}send(e,t=0){const r=this._getBus(e),i=new ji({context:this.context,units:"decibels",gain:t});return this.connect(i),i.connect(r),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}Em.buses=new Map;class pV extends xr{constructor(){const e=pr(pV.getDefaults(),arguments,["lowFrequency","highFrequency"]);super(e),this.name="MultibandSplit",this.input=new ji({context:this.context}),this.output=void 0,this.low=new bd({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new bd({context:this.context,frequency:0,type:"highpass"}),this.mid=new bd({context:this.context,frequency:0,type:"lowpass"}),this.high=new bd({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high],this.lowFrequency=new fa({context:this.context,units:"frequency",value:e.lowFrequency}),this.highFrequency=new fa({context:this.context,units:"frequency",value:e.highFrequency}),this.Q=new fa({context:this.context,units:"positive",value:e.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),Us(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(xr.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),zO(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class mV extends xr{constructor(){const e=pr(mV.getDefaults(),arguments,["threshold","ratio"]);super(e),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor,this.threshold=new zi({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:e.threshold}),this.attack=new zi({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:e.attack}),this.release=new zi({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:e.release}),this.knee=new zi({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:e.knee}),this.ratio=new zi({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:e.ratio}),Us(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(xr.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class R2 extends xr{constructor(){const e=pr(R2.getDefaults(),arguments,["low","mid","high"]);super(e),this.name="EQ3",this.output=new ji({context:this.context}),this._internalChannels=[],this.input=this._multibandSplit=new pV({context:this.context,highFrequency:e.highFrequency,lowFrequency:e.lowFrequency}),this._lowGain=new ji({context:this.context,gain:e.low,units:"decibels"}),this._midGain=new ji({context:this.context,gain:e.mid,units:"decibels"}),this._highGain=new ji({context:this.context,gain:e.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),Us(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(xr.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),zO(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}ic().transport;function B9(){return ic().transport}ic().destination;ic().destination;function Eat(){return ic().destination}ic().listener;ic().draw;function xat(){return ic().draw}ic();function j0e(n){return n!==null&&typeof n=="object"&&"name"in n&&typeof n.name=="string"}function H0e(n){return n!==null&&typeof n=="object"&&"step"in n&&typeof n.step=="number"&&"alt"in n&&typeof n.alt=="number"&&!isNaN(n.step)&&!isNaN(n.alt)}var q0e=[0,2,4,-1,1,3,5],V0e=q0e.map(n=>Math.floor(n*7/12));function G0e(n){const{step:e,alt:t,oct:r,dir:i=1}=n,s=q0e[e]+7*t;if(r===void 0)return[i*s];const a=r-V0e[e]-4*t;return[i*s,i*a]}var Tat=[3,0,4,1,5,2,6];function wat(n){const[e,t,r]=n,i=Tat[Rat(e)],s=Math.floor((e+1)/7);if(t===void 0)return{step:i,alt:s,dir:r};const a=t+4*s+V0e[i];return{step:i,alt:s,oct:a,dir:r}}function Rat(n){const e=(n+1)%7;return e<0?7+e:e}var Dne=(n,e)=>Array(Math.abs(e)+1).join(n),F9=Object.freeze({empty:!0,name:"",num:NaN,q:"",type:"",step:NaN,alt:NaN,dir:NaN,simple:NaN,semitones:NaN,chroma:NaN,coord:[],oct:NaN}),Aat="([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})",Cat="(AA|A|P|M|m|d|dd)([-+]?\\d+)",Mat=new RegExp("^"+Aat+"|"+Cat+"$");function kat(n){const e=Mat.exec(`${n}`);return e===null?["",""]:e[1]?[e[1],e[2]]:[e[4],e[3]]}var Lne={};function ML(n){return typeof n=="string"?Lne[n]||(Lne[n]=Oat(n)):H0e(n)?ML(Nat(n)):j0e(n)?ML(n.name):F9}var Une=[0,2,4,5,7,9,11],$0e="PMMPPMM";function Oat(n){const e=kat(n);if(e[0]==="")return F9;const t=+e[0],r=e[1],i=(Math.abs(t)-1)%7,s=$0e[i];if(s==="M"&&r==="P")return F9;const a=s==="M"?"majorable":"perfectable",o=""+t+r,l=t<0?-1:1,c=t===8||t===-8?t:l*(i+1),u=Iat(a,r),f=Math.floor((Math.abs(t)-1)/7),d=l*(Une[i]+u+12*f),g=(l*(Une[i]+u)%12+12)%12,p=G0e({step:i,alt:u,oct:f,dir:l});return{empty:!1,name:o,num:t,q:r,step:i,alt:u,dir:l,type:a,simple:c,semitones:d,chroma:g,coord:p,oct:f}}function Iat(n,e){return e==="M"&&n==="majorable"||e==="P"&&n==="perfectable"?0:e==="m"&&n==="majorable"?-1:/^A+$/.test(e)?e.length:/^d+$/.test(e)?-1*(n==="perfectable"?e.length:e.length+1):0}function Nat(n){const{step:e,alt:t,oct:r=0,dir:i}=n;if(!i)return"";const s=e+1+7*r,a=s===0?e+1:s,o=i<0?"-":"",l=$0e[e]==="M"?"majorable":"perfectable";return o+a+Pat(l,t)}function Pat(n,e){return e===0?n==="majorable"?"M":"P":e===-1&&n==="majorable"?"m":e>0?Dne("A",e):Dne("d",n==="perfectable"?e:e+1)}var Bne=(n,e)=>Array(Math.abs(e)+1).join(n),W0e=Object.freeze({empty:!0,name:"",letter:"",acc:"",pc:"",step:NaN,alt:NaN,chroma:NaN,height:NaN,coord:[],midi:null,freq:null}),Fne=new Map,Dat=n=>"CDEFGAB".charAt(n),Lat=n=>n<0?Bne("b",-n):Bne("#",n),Uat=n=>n[0]==="b"?-n.length:n.length;function Uk(n){const e=JSON.stringify(n),t=Fne.get(e);if(t)return t;const r=typeof n=="string"?Hat(n):H0e(n)?Uk(qat(n)):j0e(n)?Uk(n.name):W0e;return Fne.set(e,r),r}var Bat=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function Fat(n){const e=Bat.exec(n);return e?[e[1].toUpperCase(),e[2].replace(/x/g,"##"),e[3],e[4]]:["","","",""]}function zat(n){return Uk(wat(n))}var jat=(n,e)=>(n%e+e)%e,$8=[0,2,4,5,7,9,11];function Hat(n){const e=Fat(n);if(e[0]===""||e[3]!=="")return W0e;const t=e[0],r=e[1],i=e[2],s=(t.charCodeAt(0)+3)%7,a=Uat(r),o=i.length?+i:void 0,l=G0e({step:s,alt:a,oct:o}),c=t+r+i,u=t+r,f=($8[s]+a+120)%12,d=o===void 0?jat($8[s]+a,12)-1188:$8[s]+a+12*(o+1),g=d>=0&&d<=127?d:null,p=o===void 0?null:Math.pow(2,(d-69)/12)*440;return{empty:!1,acc:r,alt:a,chroma:f,coord:l,freq:p,height:d,letter:t,midi:g,name:c,oct:o,pc:u,step:s}}function qat(n){const{step:e,alt:t,oct:r}=n,i=Dat(e);if(!i)return"";const s=i+Lat(t);return r||r===0?s+r:s}function Y0e(n,e){const t=Uk(n),r=Array.isArray(e)?e:ML(e).coord;if(t.empty||!r||r.length<2)return"";const i=t.coord,s=i.length===1?[i[0]+r[0]]:[i[0]+r[0],i[1]+r[1]];return zat(s).name}function X0e(n,e){const t=e.length,r=(n%t+t)%t;return e.slice(r,t).concat(e.slice(0,r))}var qE={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},K0e=n=>Number(n).toString(2).padStart(12,"0"),zne=n=>parseInt(n,2),Vat=/^[01]{12}$/;function Z0e(n){return Vat.test(n)}var Gat=n=>typeof n=="number"&&n>=0&&n<=4095,$at=n=>n&&Z0e(n.chroma),jne={[qE.chroma]:qE};function Q0e(n){const e=Z0e(n)?n:Gat(n)?K0e(n):Array.isArray(n)?Zat(n):$at(n)?n.chroma:qE.chroma;return jne[e]=jne[e]||Kat(e)}var Wat=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function Yat(n){const e=[];for(let t=0;t<12;t++)n.charAt(t)==="1"&&e.push(Wat[t]);return e}function Xat(n){const e=n.split("");return e.map((t,r)=>X0e(r,e).join(""))}function Kat(n){const e=zne(n),t=Xat(n).map(zne).filter(s=>s>=2048).sort()[0],r=K0e(t),i=Yat(n);return{empty:!1,name:"",setNum:e,chroma:n,normalized:r,intervals:i}}function Zat(n){if(n.length===0)return qE.chroma;let e;const t=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<n.length;r++)e=Uk(n[r]),e.empty&&(e=ML(n[r])),e.empty||(t[e.chroma]=1);return t.join("")}var Qat=[["1P 3M 5P","major","M ^  maj"],["1P 3M 5P 7M","major seventh","maj7  ma7 M7 Maj7 ^7"],["1P 3M 5P 7M 9M","major ninth","maj9 9 ^9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13 ^13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth added ninth","6add9 6/9 69 M69"],["1P 3M 6m 7M","major seventh flat sixth","M7b6 ^7b6"],["1P 3M 5P 7M 11A","major seventh sharp eleventh","maj#4 #4 #11 M7#11 ^7#11 maj7#11"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -7 m -^7 -maj7"],["1P 3m 5P 6M","minor sixth","m6 -6"],["1P 3m 5P 7m 9M","minor ninth","m9 -9"],["1P 3m 5P 7M 9M","minor/major ninth","mM9 mMaj9 -^9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11 -11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13 -13"],["1P 3m 5d","diminished","dim  o"],["1P 3m 5d 7d","diminished seventh","dim7 7 o7"],["1P 3m 5d 7m","half-diminished","m7b5  -7b5 h7 h"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4 sus"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4 7sus"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg 7b9sus 7b9sus4"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5 ^#5"],["1P 3m 5A","minor augmented","m#5 -#5 m+"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7 ^7#5"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 9#11 ^9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7+ 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7#9#5 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9 7b9#5"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3m 5P 6M 9M","","m69 -69"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9 7#9b5"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9 7b9b5"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 5A 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]],Jat=Qat;({...qE});var J0e=[],sP={};function eot(n,e,t){const r=not(n),i={...Q0e(n),name:t||"",quality:r,intervals:n,aliases:e};J0e.push(i),i.name&&(sP[i.name]=i),sP[i.setNum]=i,sP[i.chroma]=i,i.aliases.forEach(s=>tot(i,s))}function tot(n,e){sP[e]=n}function not(n){const e=t=>n.indexOf(t)!==-1;return e("5A")?"Augmented":e("3M")?"Major":e("5d")?"Diminished":e("3m")?"Minor":"Unknown"}Jat.forEach(([n,e,t])=>eot(n.split(" "),t.split(" "),e));J0e.sort((n,e)=>n.setNum-e.setNum);var rot=[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2M 3m 4P 5P 6m 7m","minor","aeolian"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 6A","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2m 2A 3M 4A 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 4A 5P 6M 7m","dorian #4","ukrainian dorian","romanian minor","altered dorian"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]],iot=rot,sot={...qE,intervals:[],aliases:[]},A2={};function aot(n){return A2[n]||sot}function oot(n,e,t=[]){const r={...Q0e(n),name:e,intervals:n,aliases:t};return A2[r.name]=r,A2[r.setNum]=r,A2[r.chroma]=r,r.aliases.forEach(i=>lot(r,i)),r}function lot(n,e){A2[e]=n}iot.forEach(([n,e,...t])=>oot(n.split(" "),e,t));var cot=[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]],uot=cot;uot.forEach(([n,e,t])=>void 0);var fot=Y0e;function hot(n,e){return fot(n,[0,e])}var gV=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]],Hne={...qE,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},dot=gV.map(pot),z9={};dot.forEach(n=>{z9[n.name]=n,n.aliases.forEach(e=>{z9[e]=n})});function e_e(n){return typeof n=="string"?z9[n.toLowerCase()]||Hne:n&&n.name?e_e(n.name):Hne}function pot(n){const[e,t,r,i,s,a,o]=n,l=o?[o]:[],c=Number(t).toString(2);return{empty:!1,intervals:aot(i).intervals,modeNum:e,chroma:c,normalized:c,name:i,setNum:t,alt:r,triad:s,seventh:a,aliases:l}}function t_e(n){return(e,t)=>{const r=e_e(e);if(r.empty)return[];const i=X0e(r.modeNum,n),s=r.intervals.map(a=>Y0e(t,a));return i.map((a,o)=>s[o]+a)}}t_e(gV.map(n=>n[4]));t_e(gV.map(n=>n[5]));function mot(n,e){const t=new R2(-6,6,10).connect(n),r=new bd(8e3,"highpass",-12);r.connect(t);const i=new n1;i.set({envelope:{attack:.001,decay:.05,sustain:.001,release:.05}}),i.connect(r);function s(Pe,Ce){i.triggerAttackRelease(Pe,Ce)}const a=new R2(-6,3,8).connect(n),o=new bd(6e3,"highpass",-12);o.connect(a);const l=new n1;l.set({envelope:{attack:.001,decay:.2,sustain:.1,release:.3}}),l.connect(o);function c(Pe,Ce){l.triggerAttackRelease(Pe,Ce)}function u(Pe){s("16n",Pe)}function f(Pe){c("8n",Pe)}const d=new bd(350,"bandpass").connect(n),g=new ji().connect(d);g.gain.value=0;const p=new sV().connect(g);p.volume.value=16,p.maxPolyphony=8,p.set({envelope:{attack:.001,decay:.01,sustain:.1,release:.1},oscillator:{type:"square"}});function _(Pe,Ce){const Xe=Rh("64n").toSeconds()+Rh(Pe).toSeconds();g.gain.setValueAtTime(.5,Ce),g.gain.exponentialRampToValueAtTime(.01,Xe+Ce),p.triggerAttackRelease([800,540],Pe,Ce)}const y=new R2(-10,10,-1).connect(n);y.connect(e);const v=new bd(800,"highpass",-12);v.connect(y);const x=new n1;x.set({envelope:{attack:.01,decay:.1,sustain:.1,release:.1}}),x.connect(v);function E(Pe,Ce){x.triggerAttackRelease(Pe,Ce)}const M=new Lk().connect(n);M.set({distortion:.666});const O=new Kd;O.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),O.connect(M);const N=new bd;N.set({type:"highpass",frequency:1e4}),N.connect(M);const I=new n1;I.set({envelope:{attack:.01,decay:.1,sustain:0,release:.1}}),I.connect(N);function D(Pe,Ce){const Xe=Rh("512n").toSeconds(),$e=Rh("32n").toSeconds();O.triggerAttackRelease(1e4,Pe,Ce,1),O.frequency.exponentialRampToValueAtTime(300,Ce+Xe),O.frequency.exponentialRampToValueAtTime(100,Ce+$e),I.triggerAttackRelease("8n",Ce,.333),I.volume.setValueAtTime(1,Ce),I.volume.exponentialRampToValueAtTime(0,Ce+Rh("32n").toSeconds())}const V=new bd;V.set({type:"bandpass",frequency:256,Q:.17}),V.connect(n);const G=new Kd;G.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),G.connect(V);const Q=new Kd;Q.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),Q.connect(V);function B(Pe,Ce){G.triggerAttackRelease(2e3,Pe,Ce),G.frequency.exponentialRampToValueAtTime(1e3,Ce+Rh("32n").toSeconds()),Q.triggerAttackRelease(999,Pe,Ce),Q.frequency.exponentialRampToValueAtTime(888,Ce+Rh("256n").toSeconds())}const $=new Lk().connect(n);$.set({distortion:.876});const U=new Kd;U.set({envelope:{attack:0,decay:.1,sustain:0,release:1},oscillator:{type:"triangle"}}),U.connect($);const J=new bd;J.set({type:"highpass",frequency:1e4}),J.connect($);const W=new n1;W.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}}),W.connect(J);function q(Pe,Ce){const Xe=Rh("512n").toSeconds(),$e=Rh("32n").toSeconds();U.triggerAttackRelease(1e4,Pe,Ce,1),U.frequency.exponentialRampToValueAtTime(150,Ce+Xe),U.frequency.exponentialRampToValueAtTime(100,Ce+$e),W.triggerAttackRelease("8n",Ce,.25),W.volume.setValueAtTime(1,Ce),W.volume.exponentialRampToValueAtTime(0,Ce+Rh("32n").toSeconds())}const Y=new Kd().connect(n);Y.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"sawtooth"}});const ae=new Kd().connect(n);Y.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1},oscillator:{type:"triangle"}});const Z=new n1().connect(n);Z.set({envelope:{attack:.01,decay:.1,sustain:.001,release:.1}});function K(Pe,Ce){const Xe=Rh("256n").toSeconds(),$e=Rh(Pe).toSeconds()-Xe;Y.triggerAttackRelease("C4",$e,Ce,1),Y.frequency.exponentialRampToValueAtTime(Mne("C0").toFrequency(),Ce+$e),ae.triggerAttackRelease("C5",$e,Ce,.5),ae.frequency.exponentialRampToValueAtTime(Mne("C0").toFrequency(),Ce+$e);const at=Rh("4n").toSeconds();Z.triggerAttackRelease("8n",Ce),Z.volume.setValueAtTime(1,Ce),Z.volume.exponentialRampToValueAtTime(0,Ce+at)}const ne=new bd;ne.set({type:"bandpass",frequency:256,Q:.17}),ne.connect(n);const le=new Kd;le.set({envelope:{attack:.001,decay:.001,sustain:.001,release:.1},oscillator:{type:"sawtooth"}}),le.connect(ne);const ce=new Kd;ce.set({envelope:{attack:.001,decay:.1,sustain:.001,release:.1},oscillator:{type:"sine"}}),ce.connect(ne);function de(Pe,Ce){le.triggerAttackRelease(2e3,Pe,Ce),le.frequency.exponentialRampToValueAtTime(100,Ce+Rh("32n").toSeconds()),ce.triggerAttackRelease(699,Pe,Ce),ce.frequency.exponentialRampToValueAtTime(399,Ce+Rh("256n").toSeconds())}const Me=new iR().connect(n);Me.set({octaves:8,volume:8,pitchDecay:.125}),Me.connect(e);function qe(Pe){Me.triggerAttackRelease("C1","8n",Pe)}return{ticktrigger:u,tweettrigger:f,cowbelltrigger:_,claptrigger:E,hisnaretrigger:D,hiwoodblocktrigger:B,lowsnaretrigger:q,lowtomtrigger:K,lowwoodblocktrigger:de,basstrigger:qe}}const got="data:text/javascript;base64,Ly8gQSBkb3duc2FtcGxpbmcvZGVncmFkaW5nIHByb2Nlc3NpbmcgZWZmZWN0Ci8vIFNhbXBsZSBhbmQgaG9sZHMgdGhlIHNpZ25hbCBiYXNlZCBvbiBhbiBpbmNyZW1lbnRpbmcgY291bnRlcgovLyB3cml0dGVuIGJ5IFRpbW8gSG9vZ2xhbmQsIChjKSAyMDIzLCB3d3cudGltb2hvb2dsYW5kLmNvbQovLwoKY2xhc3MgU3ludGhGQ3J1c2hXb3JrbGV0UHJvY2Vzc29yIGV4dGVuZHMgQXVkaW9Xb3JrbGV0UHJvY2Vzc29yIHsKICBzdGF0aWMgZ2V0IHBhcmFtZXRlckRlc2NyaXB0b3JzKCkgewogICAgcmV0dXJuIFsKICAgICAgewogICAgICAgIG5hbWU6ICdyYXRlJywKICAgICAgICBkZWZhdWx0VmFsdWU6IDEsCiAgICAgICAgbWluVmFsdWU6IDEsCiAgICAgICAgbWF4VmFsdWU6IDUxMiwKICAgICAgfSwKICAgIF0KICB9CgogIGNvbnN0cnVjdG9yKCkgewogICAgc3VwZXIoKQogICAgLy8gdGhlIGZyYW1lIGNvdW50ZXIKICAgIHRoaXMuY291bnQgPSAwCiAgICAvLyBzYW1wbGUgYW5kIGhvbGQgdmFyaWFibGUgYXJyYXkKICAgIHRoaXMuc2FoID0gW10KICB9CgogIHByb2Nlc3MoaW5wdXRzLCBvdXRwdXRzLCBwYXJhbWV0ZXJzKSB7CiAgICBjb25zdCBpbnB1dCA9IGlucHV0c1swXQogICAgY29uc3Qgb3V0cHV0ID0gb3V0cHV0c1swXQoKICAgIC8vIGlmIHRoZXJlIGlzIGFueXRoaW5nIHRvIHByb2Nlc3MKICAgIGlmIChpbnB1dC5sZW5ndGggPiAwKSB7CiAgICAgIC8vIGZvciB0aGUgbGVuZ3RoIG9mIHRoZSBzYW1wbGUgYXJyYXkgKGdlbmVyYWxseSAxMjgpCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5wdXRbMF0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAvLyBmb3IgZXZlcnkgY2hhbm5lbAogICAgICAgIGZvciAobGV0IGNoYW5uZWwgPSAwOyBjaGFubmVsIDwgaW5wdXQubGVuZ3RoOyArK2NoYW5uZWwpIHsKICAgICAgICAgIC8vIGlmIGNvdW50ZXIgZXF1YWxzIDAsIHNhbXBsZSBhbmQgaG9sZAogICAgICAgICAgaWYgKHRoaXMuY291bnQgJSBwYXJhbWV0ZXJzLnJhdGUgPT09IDApIHsKICAgICAgICAgICAgdGhpcy5zYWhbY2hhbm5lbF0gPSBpbnB1dFtjaGFubmVsXVtpXQogICAgICAgICAgfQogICAgICAgICAgLy8gb3V0cHV0IHRoZSBjdXJyZW50bHkgaGVsZCBzYW1wbGUKICAgICAgICAgIG91dHB1dFtjaGFubmVsXVtpXSA9IHRoaXMuc2FoW2NoYW5uZWxdCiAgICAgICAgfQogICAgICAgIC8vIGluY3JlbWVudCBzYW1wbGUgY291bnRlcgogICAgICAgIHRoaXMuY291bnQrKwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHRydWUKICB9Cn0KCnJlZ2lzdGVyUHJvY2Vzc29yKCdmY3J1c2hwcm9jZXNzb3InLCBTeW50aEZDcnVzaFdvcmtsZXRQcm9jZXNzb3IpCg==";class _V extends $m{name="FrequencyCrusher";rate;_audioworkletnode=this.context.createAudioWorkletNode("fcrushprocessor");constructor(){const e=pr(_V.getDefaults(),arguments,["rate"]);super(e),this.rate=new zi({context:this.context,param:this._audioworkletnode.parameters.get("rate"),value:e.rate,minValue:1,maxValue:512}),this.connectEffect(this._audioworkletnode)}static getDefaults(){return Object.assign($m.getDefaults(),{rate:64})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}function _ot(){return ic().rawContext.audioWorklet.addModule(got)}function Mp(n){return 20*Math.log10(n)-35}function vot(){const n=new hV,e=Sl(n.get()),t=new uV,r=Sl(t.get()),i=new fV,s=Sl(i.get()),a=new Lk,o=Sl(a.get()),l=new ZU,c=Sl(l.get()),u=new _V,f=Sl(u.get()),d=new lV,g=Sl(d.get());function p(){n.set({...e,wet:1}),t.set({...r,wet:1,delayTime:"8n",maxDelay:"8n",feedback:.666}),i.set({...s,wet:1,frequency:5,octaves:.5,baseFrequency:400}),a.set({...o,wet:1,oversample:"4x"}),l.set({...c,wet:1,depth:0,maxDelay:.5}),u.set({...f,wet:1,rate:32}),d.set({...g,wet:1})}function _(){return{fc:Sl(u.get()),echo:Sl(t.get()),reverb:Sl(n.get()),phaser:Sl(i.get()),vibrato:Sl(l.get()),distortion:Sl(a.get())}}function y(x){u.set(x.fc),t.set(x.echo),n.set(x.reverb),i.set(x.phaser),l.set(x.vibrato),a.set(x.distortion)}function v(){u.dispose(),t.dispose(),n.dispose(),i.dispose(),l.dispose(),a.dispose()}return p(),{fc:u,echo:t,reverb:n,phaser:i,vibrato:l,distortion:a,applyreset:p,getreplay:_,setreplay:y,autowah:d,fcrush:u,distort:a,destroy:v}}function W8(n){const e=ic().isOffline?"offline":"",t=new Em(Mp(0)),r=new Em(Mp(0)),i=new Em(Mp(0)),s=new Em(Mp(0)),a=new Em(Mp(0)),o=new Em(Mp(0)),l=new Em(Mp(0));t.receive(`${e}fc${n}`),r.receive(`${e}echo${n}`),i.receive(`${e}reverb${n}`),s.receive(`${e}phaser${n}`),a.receive(`${e}vibrato${n}`),o.receive(`${e}distortion${n}`),l.receive(`${e}autowah${n}`);const c=new Em;c.send(`${e}fc${n}`),c.send(`${e}echo${n}`),c.send(`${e}reverb${n}`),c.send(`${e}phaser${n}`),c.send(`${e}vibrato${n}`),c.send(`${e}distortion${n}`),c.send(`${e}autowah${n}`);function u(){return{fc:t.volume.value,echo:r.volume.value,reverb:i.volume.value,phaser:s.volume.value,vibrato:a.volume.value,distortion:o.volume.value,autowah:l.volume.value}}function f(g){t.volume.value=g.fc,r.volume.value=g.echo,i.volume.value=g.reverb,s.volume.value=g.phaser,a.volume.value=g.vibrato,o.volume.value=g.distortion,l.volume.value=g.autowah}function d(){t.dispose(),r.dispose(),i.dispose(),s.dispose(),a.dispose(),o.dispose(),l.dispose(),c.dispose()}return{sendtofx:c,fc:t,echo:r,reverb:i,phaser:s,vibrato:a,distortion:o,autowah:l,fcrush:t,distort:o,getreplay:u,setreplay:f,destroy:d}}function yot(n){return new Int8Array(n)}function bot(n){return new Int16Array(n)}function n_e(n){return new Int32Array(n)}function r_e(n){return new Float32Array(n)}function Sot(n){return new Float64Array(n)}function i_e(n){if(n.length==1)return r_e(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(i_e(n));return t}function s_e(n){if(n.length==1)return n_e(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(s_e(n));return t}function a_e(n){if(n.length==1)return bot(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(a_e(n));return t}function o_e(n){if(n.length==1)return new Array(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(o_e(n));return t}var l_e={};l_e.fill=function(n,e,t,r){if(arguments.length==2)for(var i=0;i<n.length;i++)n[i]=arguments[1];else for(var i=e;i<t;i++)n[i]=r};var XO={};XO.arraycopy=function(n,e,t,r,i){for(var s=e+i;e<s;)t[r++]=n[e++]};XO.out={};XO.out.println=function(n){console.log(n)};XO.out.printf=function(){console.log.apply(console,arguments)};var QU={};QU.SQRT2=1.4142135623730951;QU.FAST_LOG10=function(n){return Math.log10(n)};QU.FAST_LOG10_X=function(n,e){return Math.log10(n)*e};function fb(n){this.ordinal=n}fb.short_block_allowed=new fb(0);fb.short_block_coupled=new fb(1);fb.short_block_dispensed=new fb(2);fb.short_block_forced=new fb(3);var c_e={};c_e.MAX_VALUE=34028235e31;function qg(n){this.ordinal=n}qg.vbr_off=new qg(0);qg.vbr_mt=new qg(1);qg.vbr_rh=new qg(2);qg.vbr_abr=new qg(3);qg.vbr_mtrh=new qg(4);qg.vbr_default=qg.vbr_mtrh;var Eot=function(n){},Tc={System:XO,VbrMode:qg,Float:c_e,ShortBlock:fb,Util:QU,Arrays:l_e,new_array_n:o_e,new_byte:yot,new_double:Sot,new_float:r_e,new_float_n:i_e,new_int:n_e,new_int_n:s_e,new_short_n:a_e,assert:Eot},Y8,qne;function xot(){if(qne)return Y8;qne=1;var n=Tc,e=n.System,t=n.Util,r=n.Arrays,i=n.new_float,s=op();function a(){var o=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*t.SQRT2*.5/2384e-9,.017876148*t.SQRT2*.5/2384e-9,.003134727*t.SQRT2*.5/2384e-9,.002457142*t.SQRT2*.5/2384e-9,971317e-9*t.SQRT2*.5/2384e-9,218868e-9*t.SQRT2*.5/2384e-9,101566e-9*t.SQRT2*.5/2384e-9,13828e-9*t.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],l=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],c=l[s.SHORT_TYPE],u=l[s.SHORT_TYPE],f=l[s.SHORT_TYPE],d=l[s.SHORT_TYPE],g=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function p(v,x,E){for(var M=10,O=x+238-14-286,N=-15;N<0;N++){var I,D,V;I=o[M+-10],D=v[O+-224]*I,V=v[x+224]*I,I=o[M+-9],D+=v[O+-160]*I,V+=v[x+160]*I,I=o[M+-8],D+=v[O+-96]*I,V+=v[x+96]*I,I=o[M+-7],D+=v[O+-32]*I,V+=v[x+32]*I,I=o[M+-6],D+=v[O+32]*I,V+=v[x+-32]*I,I=o[M+-5],D+=v[O+96]*I,V+=v[x+-96]*I,I=o[M+-4],D+=v[O+160]*I,V+=v[x+-160]*I,I=o[M+-3],D+=v[O+224]*I,V+=v[x+-224]*I,I=o[M+-2],D+=v[x+-256]*I,V-=v[O+256]*I,I=o[M+-1],D+=v[x+-192]*I,V-=v[O+192]*I,I=o[M+0],D+=v[x+-128]*I,V-=v[O+128]*I,I=o[M+1],D+=v[x+-64]*I,V-=v[O+64]*I,I=o[M+2],D+=v[x+0]*I,V-=v[O+0]*I,I=o[M+3],D+=v[x+64]*I,V-=v[O+-64]*I,I=o[M+4],D+=v[x+128]*I,V-=v[O+-128]*I,I=o[M+5],D+=v[x+192]*I,V-=v[O+-192]*I,D*=o[M+6],I=V-D,E[30+N*2]=V+D,E[31+N*2]=o[M+7]*I,M+=18,x--,O++}{var D,V,G,Q;V=v[x+-16]*o[M+-10],D=v[x+-32]*o[M+-2],V+=(v[x+-48]-v[x+16])*o[M+-9],D+=v[x+-96]*o[M+-1],V+=(v[x+-80]+v[x+48])*o[M+-8],D+=v[x+-160]*o[M+0],V+=(v[x+-112]-v[x+80])*o[M+-7],D+=v[x+-224]*o[M+1],V+=(v[x+-144]+v[x+112])*o[M+-6],D-=v[x+32]*o[M+2],V+=(v[x+-176]-v[x+144])*o[M+-5],D-=v[x+96]*o[M+3],V+=(v[x+-208]+v[x+176])*o[M+-4],D-=v[x+160]*o[M+4],V+=(v[x+-240]-v[x+208])*o[M+-3],D-=v[x+224],G=D-V,Q=D+V,V=E[14],D=E[15]-V,E[31]=Q+V,E[30]=G+D,E[15]=G-D,E[14]=Q-V}{var B;B=E[28]-E[0],E[0]+=E[28],E[28]=B*o[M+-36+7],B=E[29]-E[1],E[1]+=E[29],E[29]=B*o[M+-36+7],B=E[26]-E[2],E[2]+=E[26],E[26]=B*o[M+-72+7],B=E[27]-E[3],E[3]+=E[27],E[27]=B*o[M+-72+7],B=E[24]-E[4],E[4]+=E[24],E[24]=B*o[M+-108+7],B=E[25]-E[5],E[5]+=E[25],E[25]=B*o[M+-108+7],B=E[22]-E[6],E[6]+=E[22],E[22]=B*t.SQRT2,B=E[23]-E[7],E[7]+=E[23],E[23]=B*t.SQRT2-E[7],E[7]-=E[6],E[22]-=E[7],E[23]-=E[22],B=E[6],E[6]=E[31]-B,E[31]=E[31]+B,B=E[7],E[7]=E[30]-B,E[30]=E[30]+B,B=E[22],E[22]=E[15]-B,E[15]=E[15]+B,B=E[23],E[23]=E[14]-B,E[14]=E[14]+B,B=E[20]-E[8],E[8]+=E[20],E[20]=B*o[M+-180+7],B=E[21]-E[9],E[9]+=E[21],E[21]=B*o[M+-180+7],B=E[18]-E[10],E[10]+=E[18],E[18]=B*o[M+-216+7],B=E[19]-E[11],E[11]+=E[19],E[19]=B*o[M+-216+7],B=E[16]-E[12],E[12]+=E[16],E[16]=B*o[M+-252+7],B=E[17]-E[13],E[13]+=E[17],E[17]=B*o[M+-252+7],B=-E[20]+E[24],E[20]+=E[24],E[24]=B*o[M+-216+7],B=-E[21]+E[25],E[21]+=E[25],E[25]=B*o[M+-216+7],B=E[4]-E[8],E[4]+=E[8],E[8]=B*o[M+-216+7],B=E[5]-E[9],E[5]+=E[9],E[9]=B*o[M+-216+7],B=E[0]-E[12],E[0]+=E[12],E[12]=B*o[M+-72+7],B=E[1]-E[13],E[1]+=E[13],E[13]=B*o[M+-72+7],B=E[16]-E[28],E[16]+=E[28],E[28]=B*o[M+-72+7],B=-E[17]+E[29],E[17]+=E[29],E[29]=B*o[M+-72+7],B=t.SQRT2*(E[2]-E[10]),E[2]+=E[10],E[10]=B,B=t.SQRT2*(E[3]-E[11]),E[3]+=E[11],E[11]=B,B=t.SQRT2*(-E[18]+E[26]),E[18]+=E[26],E[26]=B-E[18],B=t.SQRT2*(-E[19]+E[27]),E[19]+=E[27],E[27]=B-E[19],B=E[2],E[19]-=E[3],E[3]-=B,E[2]=E[31]-B,E[31]+=B,B=E[3],E[11]-=E[19],E[18]-=B,E[3]=E[30]-B,E[30]+=B,B=E[18],E[27]-=E[11],E[19]-=B,E[18]=E[15]-B,E[15]+=B,B=E[19],E[10]-=B,E[19]=E[14]-B,E[14]+=B,B=E[10],E[11]-=B,E[10]=E[23]-B,E[23]+=B,B=E[11],E[26]-=B,E[11]=E[22]-B,E[22]+=B,B=E[26],E[27]-=B,E[26]=E[7]-B,E[7]+=B,B=E[27],E[27]=E[6]-B,E[6]+=B,B=t.SQRT2*(E[0]-E[4]),E[0]+=E[4],E[4]=B,B=t.SQRT2*(E[1]-E[5]),E[1]+=E[5],E[5]=B,B=t.SQRT2*(E[16]-E[20]),E[16]+=E[20],E[20]=B,B=t.SQRT2*(E[17]-E[21]),E[17]+=E[21],E[21]=B,B=-t.SQRT2*(E[8]-E[12]),E[8]+=E[12],E[12]=B-E[8],B=-t.SQRT2*(E[9]-E[13]),E[9]+=E[13],E[13]=B-E[9],B=-t.SQRT2*(E[25]-E[29]),E[25]+=E[29],E[29]=B-E[25],B=-t.SQRT2*(E[24]+E[28]),E[24]-=E[28],E[28]=B-E[24],B=E[24]-E[16],E[24]=B,B=E[20]-B,E[20]=B,B=E[28]-B,E[28]=B,B=E[25]-E[17],E[25]=B,B=E[21]-B,E[21]=B,B=E[29]-B,E[29]=B,B=E[17]-E[1],E[17]=B,B=E[9]-B,E[9]=B,B=E[25]-B,E[25]=B,B=E[5]-B,E[5]=B,B=E[21]-B,E[21]=B,B=E[13]-B,E[13]=B,B=E[29]-B,E[29]=B,B=E[1]-E[0],E[1]=B,B=E[16]-B,E[16]=B,B=E[17]-B,E[17]=B,B=E[8]-B,E[8]=B,B=E[9]-B,E[9]=B,B=E[24]-B,E[24]=B,B=E[25]-B,E[25]=B,B=E[4]-B,E[4]=B,B=E[5]-B,E[5]=B,B=E[20]-B,E[20]=B,B=E[21]-B,E[21]=B,B=E[12]-B,E[12]=B,B=E[13]-B,E[13]=B,B=E[28]-B,E[28]=B,B=E[29]-B,E[29]=B,B=E[0],E[0]+=E[31],E[31]-=B,B=E[1],E[1]+=E[30],E[30]-=B,B=E[16],E[16]+=E[15],E[15]-=B,B=E[17],E[17]+=E[14],E[14]-=B,B=E[8],E[8]+=E[23],E[23]-=B,B=E[9],E[9]+=E[22],E[22]-=B,B=E[24],E[24]+=E[7],E[7]-=B,B=E[25],E[25]+=E[6],E[6]-=B,B=E[4],E[4]+=E[27],E[27]-=B,B=E[5],E[5]+=E[26],E[26]-=B,B=E[20],E[20]+=E[11],E[11]-=B,B=E[21],E[21]+=E[10],E[10]-=B,B=E[12],E[12]+=E[19],E[19]-=B,B=E[13],E[13]+=E[18],E[18]-=B,B=E[28],E[28]+=E[3],E[3]-=B,B=E[29],E[29]+=E[2],E[2]-=B}}function _(v,x){for(var E=0;E<3;E++){var M,O,N,I,D,V;I=v[x+6]*l[s.SHORT_TYPE][0]-v[x+15],M=v[x+0]*l[s.SHORT_TYPE][2]-v[x+9],O=I+M,N=I-M,I=v[x+15]*l[s.SHORT_TYPE][0]+v[x+6],M=v[x+9]*l[s.SHORT_TYPE][2]+v[x+0],D=I+M,V=-I+M,M=(v[x+3]*l[s.SHORT_TYPE][1]-v[x+12])*2069978111953089e-26,I=(v[x+12]*l[s.SHORT_TYPE][1]+v[x+3])*2069978111953089e-26,v[x+0]=O*190752519173728e-25+M,v[x+15]=-D*190752519173728e-25+I,N=N*.8660254037844387*1907525191737281e-26,D=D*.5*1907525191737281e-26+I,v[x+3]=N-D,v[x+6]=N+D,O=O*.5*1907525191737281e-26-M,V=V*.8660254037844387*1907525191737281e-26,v[x+9]=O+V,v[x+12]=O-V,x++}}function y(v,x,E){var M,O;{var N,I,D,V,G,Q,B,$;N=E[17]-E[9],D=E[15]-E[11],V=E[14]-E[12],G=E[0]+E[8],Q=E[1]+E[7],B=E[2]+E[6],$=E[3]+E[5],v[x+17]=G+B-$-(Q-E[4]),O=(G+B-$)*u[19]+(Q-E[4]),M=(N-D-V)*u[18],v[x+5]=M+O,v[x+6]=M-O,I=(E[16]-E[10])*u[18],Q=Q*u[19]+E[4],M=N*u[12]+I+D*u[13]+V*u[14],O=-G*u[16]+Q-B*u[17]+$*u[15],v[x+1]=M+O,v[x+2]=M-O,M=N*u[13]-I-D*u[14]+V*u[12],O=-G*u[17]+Q-B*u[15]+$*u[16],v[x+9]=M+O,v[x+10]=M-O,M=N*u[14]-I+D*u[12]-V*u[13],O=G*u[15]-Q+B*u[16]-$*u[17],v[x+13]=M+O,v[x+14]=M-O}{var U,J,W,q,Y,ae,Z,K;U=E[8]-E[0],W=E[6]-E[2],q=E[5]-E[3],Y=E[17]+E[9],ae=E[16]+E[10],Z=E[15]+E[11],K=E[14]+E[12],v[x+0]=Y+Z+K+(ae+E[13]),M=(Y+Z+K)*u[19]-(ae+E[13]),O=(U-W+q)*u[18],v[x+11]=M+O,v[x+12]=M-O,J=(E[7]-E[1])*u[18],ae=E[13]-ae*u[19],M=Y*u[15]-ae+Z*u[16]+K*u[17],O=U*u[14]+J+W*u[12]+q*u[13],v[x+3]=M+O,v[x+4]=M-O,M=-Y*u[17]+ae-Z*u[15]-K*u[16],O=U*u[13]+J-W*u[14]-q*u[12],v[x+7]=M+O,v[x+8]=M-O,M=-Y*u[16]+ae-Z*u[17]-K*u[15],O=U*u[12]-J+W*u[13]-q*u[14],v[x+15]=M+O,v[x+16]=M-O}}this.mdct_sub48=function(v,x,E){for(var M=x,O=286,N=0;N<v.channels_out;N++){for(var I=0;I<v.mode_gr;I++){for(var D,V=v.l3_side.tt[I][N],G=V.xr,Q=0,B=v.sb_sample[N][1-I],$=0,U=0;U<18/2;U++)for(p(M,O,B[$]),p(M,O+32,B[$+1]),$+=2,O+=64,D=1;D<32;D+=2)B[$-1][D]*=-1;for(D=0;D<32;D++,Q+=18){var J=V.block_type,W=v.sb_sample[N][I],q=v.sb_sample[N][1-I];if(V.mixed_block_flag!=0&&D<2&&(J=0),v.amp_filter[D]<1e-12)r.fill(G,Q+0,Q+18,0);else{if(v.amp_filter[D]<1)for(var U=0;U<18;U++)q[U][g[D]]*=v.amp_filter[D];if(J==s.SHORT_TYPE){for(var U=-12/4;U<0;U++){var Y=l[s.SHORT_TYPE][U+3];G[Q+U*3+9]=W[9+U][g[D]]*Y-W[8-U][g[D]],G[Q+U*3+18]=W[14-U][g[D]]*Y+W[15+U][g[D]],G[Q+U*3+10]=W[15+U][g[D]]*Y-W[14-U][g[D]],G[Q+U*3+19]=q[2-U][g[D]]*Y+q[3+U][g[D]],G[Q+U*3+11]=q[3+U][g[D]]*Y-q[2-U][g[D]],G[Q+U*3+20]=q[8-U][g[D]]*Y+q[9+U][g[D]]}_(G,Q)}else{for(var ae=i(18),U=-36/4;U<0;U++){var Z,K;Z=l[J][U+27]*q[U+9][g[D]]+l[J][U+36]*q[8-U][g[D]],K=l[J][U+9]*W[U+9][g[D]]-l[J][U+18]*W[8-U][g[D]],ae[U+9]=Z-K*c[3+U+9],ae[U+18]=Z*c[3+U+9]+K}y(G,Q,ae)}}if(J!=s.SHORT_TYPE&&D!=0)for(var U=7;U>=0;--U){var ne,le;ne=G[Q+U]*f[20+U]+G[Q+-1-U]*d[28+U],le=G[Q+U]*d[28+U]-G[Q+-1-U]*f[20+U],G[Q+-1-U]=ne,G[Q+U]=le}}}if(M=E,O=286,v.mode_gr==1)for(var ce=0;ce<18;ce++)e.arraycopy(v.sb_sample[N][1][ce],0,v.sb_sample[N][0][ce],0,32)}}}return Y8=a,Y8}var X8,Vne;function u_e(){if(Vne)return X8;Vne=1;var n=op(),e=Tc,t=e.System,r=e.new_float,i=e.new_float_n;function s(){this.l=r(n.SBMAX_l),this.s=i([n.SBMAX_s,3]);var a=this;this.assign=function(o){t.arraycopy(o.l,0,a.l,0,n.SBMAX_l);for(var l=0;l<n.SBMAX_s;l++)for(var c=0;c<3;c++)a.s[l][c]=o.s[l][c]}}return X8=s,X8}var K8,Gne;function Tot(){if(Gne)return K8;Gne=1;var n=u_e();function e(){this.thm=new n,this.en=new n}return K8=e,K8}function D_(n){var e=n;this.ordinal=function(){return e}}D_.STEREO=new D_(0);D_.JOINT_STEREO=new D_(1);D_.DUAL_CHANNEL=new D_(2);D_.MONO=new D_(3);D_.NOT_SET=new D_(4);var KO=D_,Z8,$ne;function op(){if($ne)return Z8;$ne=1;var n=Tc,e=n.System,t=n.VbrMode,r=n.new_array_n,i=n.new_float,s=n.new_float_n,a=n.new_int,o=n.assert;l.ENCDELAY=576,l.POSTDELAY=1152,l.MDCTDELAY=48,l.FFTOFFSET=224+l.MDCTDELAY,l.DECDELAY=528,l.SBLIMIT=32,l.CBANDS=64,l.SBPSY_l=21,l.SBPSY_s=12,l.SBMAX_l=22,l.SBMAX_s=13,l.PSFB21=6,l.PSFB12=6,l.BLKSIZE=1024,l.HBLKSIZE=l.BLKSIZE/2+1,l.BLKSIZE_s=256,l.HBLKSIZE_s=l.BLKSIZE_s/2+1,l.NORM_TYPE=0,l.START_TYPE=1,l.SHORT_TYPE=2,l.STOP_TYPE=3,l.MPG_MD_LR_LR=0,l.MPG_MD_LR_I=1,l.MPG_MD_MS_LR=2,l.MPG_MD_MS_I=3,l.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function l(){var c=xot(),u=Tot(),f=KO,d=l.FFTOFFSET,g=l.MPG_MD_MS_LR,p=null;this.psy=null;var _=null,y=null,v=null;this.setModules=function(N,I,D,V){p=N,this.psy=I,_=I,y=V,v=D};var x=new c;function E(N){var I,D;if(N.ATH.useAdjust==0){N.ATH.adjust=1;return}if(D=N.loudness_sq[0][0],I=N.loudness_sq[1][0],N.channels_out==2?(D+=N.loudness_sq[0][1],I+=N.loudness_sq[1][1]):(D+=D,I+=I),N.mode_gr==2&&(D=Math.max(D,I)),D*=.5,D*=N.ATH.aaSensitivityP,D>.03125)N.ATH.adjust>=1?N.ATH.adjust=1:N.ATH.adjust<N.ATH.adjustLimit&&(N.ATH.adjust=N.ATH.adjustLimit),N.ATH.adjustLimit=1;else{var V=31.98*D+625e-6;N.ATH.adjust>=V?(N.ATH.adjust*=V*.075+.925,N.ATH.adjust<V&&(N.ATH.adjust=V)):N.ATH.adjustLimit>=V?N.ATH.adjust=V:N.ATH.adjust<N.ATH.adjustLimit&&(N.ATH.adjust=N.ATH.adjustLimit),N.ATH.adjustLimit=V}}function M(N){var I,D;for(o(0<=N.bitrate_index&&N.bitrate_index<16),o(0<=N.mode_ext&&N.mode_ext<4),N.bitrate_stereoMode_Hist[N.bitrate_index][4]++,N.bitrate_stereoMode_Hist[15][4]++,N.channels_out==2&&(N.bitrate_stereoMode_Hist[N.bitrate_index][N.mode_ext]++,N.bitrate_stereoMode_Hist[15][N.mode_ext]++),I=0;I<N.mode_gr;++I)for(D=0;D<N.channels_out;++D){var V=N.l3_side.tt[I][D].block_type|0;N.l3_side.tt[I][D].mixed_block_flag!=0&&(V=4),N.bitrate_blockType_Hist[N.bitrate_index][V]++,N.bitrate_blockType_Hist[N.bitrate_index][5]++,N.bitrate_blockType_Hist[15][V]++,N.bitrate_blockType_Hist[15][5]++}}function O(N,I){var D=N.internal_flags,V,G;if(D.lame_encode_frame_init==0){var Q,B,$=i(2014),U=i(2014);for(D.lame_encode_frame_init=1,Q=0,B=0;Q<286+576*(1+D.mode_gr);++Q)Q<576*D.mode_gr?($[Q]=0,D.channels_out==2&&(U[Q]=0)):($[Q]=I[0][B],D.channels_out==2&&(U[Q]=I[1][B]),++B);for(G=0;G<D.mode_gr;G++)for(V=0;V<D.channels_out;V++)D.l3_side.tt[G][V].block_type=l.SHORT_TYPE;x.mdct_sub48(D,$,U),o(576>=l.FFTOFFSET),o(D.mf_size>=l.BLKSIZE+N.framesize-l.FFTOFFSET),o(D.mf_size>=512+N.framesize-32)}}this.lame_encode_mp3_frame=function(N,I,D,V,G,Q){var B,$=r([2,2]);$[0][0]=new u,$[0][1]=new u,$[1][0]=new u,$[1][1]=new u;var U=r([2,2]);U[0][0]=new u,U[0][1]=new u,U[1][0]=new u,U[1][1]=new u;var J,W=[null,null],q=N.internal_flags,Y=s([2,4]),ae=[.5,.5],Z=[[0,0],[0,0]],K=[[0,0],[0,0]],ne,le,ce;if(W[0]=I,W[1]=D,q.lame_encode_frame_init==0&&O(N,W),q.padding=0,(q.slot_lag-=q.frac_SpF)<0&&(q.slot_lag+=N.out_samplerate,q.padding=1),q.psymodel!=0){var de,Me=[null,null],qe=0,Pe=a(2);for(ce=0;ce<q.mode_gr;ce++){for(le=0;le<q.channels_out;le++)Me[le]=W[le],qe=576+ce*576-l.FFTOFFSET;if(N.VBR==t.vbr_mtrh||N.VBR==t.vbr_mt?de=_.L3psycho_anal_vbr(N,Me,qe,ce,$,U,Z[ce],K[ce],Y[ce],Pe):de=_.L3psycho_anal_ns(N,Me,qe,ce,$,U,Z[ce],K[ce],Y[ce],Pe),de!=0)return-4;for(N.mode==f.JOINT_STEREO&&(ae[ce]=Y[ce][2]+Y[ce][3],ae[ce]>0&&(ae[ce]=Y[ce][3]/ae[ce])),le=0;le<q.channels_out;le++){var Ce=q.l3_side.tt[ce][le];Ce.block_type=Pe[le],Ce.mixed_block_flag=0}}}else for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)q.l3_side.tt[ce][le].block_type=l.NORM_TYPE,q.l3_side.tt[ce][le].mixed_block_flag=0,K[ce][le]=Z[ce][le]=700;if(E(q),x.mdct_sub48(q,W[0],W[1]),q.mode_ext=l.MPG_MD_LR_LR,N.force_ms)q.mode_ext=l.MPG_MD_MS_LR;else if(N.mode==f.JOINT_STEREO){var Xe=0,$e=0;for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)Xe+=K[ce][le],$e+=Z[ce][le];if(Xe<=1*$e){var at=q.l3_side.tt[0],pt=q.l3_side.tt[q.mode_gr-1];at[0].block_type==at[1].block_type&&pt[0].block_type==pt[1].block_type&&(q.mode_ext=l.MPG_MD_MS_LR)}}if(q.mode_ext==g?(J=U,ne=K):(J=$,ne=Z),N.analysis&&q.pinfo!=null)for(ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)q.pinfo.ms_ratio[ce]=q.ms_ratio[ce],q.pinfo.ms_ener_ratio[ce]=ae[ce],q.pinfo.blocktype[ce][le]=q.l3_side.tt[ce][le].block_type,q.pinfo.pe[ce][le]=ne[ce][le],e.arraycopy(q.l3_side.tt[ce][le].xr,0,q.pinfo.xr[ce][le],0,576),q.mode_ext==g&&(q.pinfo.ers[ce][le]=q.pinfo.ers[ce][le+2],e.arraycopy(q.pinfo.energy[ce][le+2],0,q.pinfo.energy[ce][le],0,q.pinfo.energy[ce][le].length));if(N.VBR==t.vbr_off||N.VBR==t.vbr_abr){var oe,Ue;for(oe=0;oe<18;oe++)q.nsPsy.pefirbuf[oe]=q.nsPsy.pefirbuf[oe+1];for(Ue=0,ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)Ue+=ne[ce][le];for(q.nsPsy.pefirbuf[18]=Ue,Ue=q.nsPsy.pefirbuf[9],oe=0;oe<9;oe++)Ue+=(q.nsPsy.pefirbuf[oe]+q.nsPsy.pefirbuf[18-oe])*l.fircoef[oe];for(Ue=670*5*q.mode_gr*q.channels_out/Ue,ce=0;ce<q.mode_gr;ce++)for(le=0;le<q.channels_out;le++)ne[ce][le]*=Ue}if(q.iteration_loop.iteration_loop(N,ne,ae,J),p.format_bitstream(N),B=p.copy_buffer(q,V,G,Q,1),N.bWriteVbrTag&&y.addVbrFrame(N),N.analysis&&q.pinfo!=null){for(le=0;le<q.channels_out;le++){var Ge;for(Ge=0;Ge<d;Ge++)q.pinfo.pcmdata[le][Ge]=q.pinfo.pcmdata[le][Ge+N.framesize];for(Ge=d;Ge<1600;Ge++)q.pinfo.pcmdata[le][Ge]=W[le][Ge-d]}v.set_frame_pinfo(N,J)}return M(q),B}}return Z8=l,Z8}var f_e=Tc,Wne=f_e.Util,Yne=f_e.new_float,Fu=op();function wot(){var n=Yne(Fu.BLKSIZE),e=Yne(Fu.BLKSIZE_s/2),t=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(s,a,o){var l=0,c,u,f;o<<=1;var d=a+o;c=4;do{var g,p,_,y,v,x,E;E=c>>1,y=c,v=c<<1,x=v+y,c=v<<1,u=a,f=u+E;do{var M,O,N,I;O=s[u+0]-s[u+y],M=s[u+0]+s[u+y],I=s[u+v]-s[u+x],N=s[u+v]+s[u+x],s[u+v]=M-N,s[u+0]=M+N,s[u+x]=O-I,s[u+y]=O+I,O=s[f+0]-s[f+y],M=s[f+0]+s[f+y],I=Wne.SQRT2*s[f+x],N=Wne.SQRT2*s[f+v],s[f+v]=M-N,s[f+0]=M+N,s[f+x]=O-I,s[f+y]=O+I,f+=c,u+=c}while(u<d);for(p=t[l+0],g=t[l+1],_=1;_<E;_++){var D,V;D=1-2*g*g,V=2*g*p,u=a+_,f=a+y-_;do{var G,Q,B,M,O,$,N,U,I,J;Q=V*s[u+y]-D*s[f+y],G=D*s[u+y]+V*s[f+y],O=s[u+0]-G,M=s[u+0]+G,$=s[f+0]-Q,B=s[f+0]+Q,Q=V*s[u+x]-D*s[f+x],G=D*s[u+x]+V*s[f+x],I=s[u+v]-G,N=s[u+v]+G,J=s[f+v]-Q,U=s[f+v]+Q,Q=g*N-p*J,G=p*N+g*J,s[u+v]=M-G,s[u+0]=M+G,s[f+x]=$-Q,s[f+y]=$+Q,Q=p*U-g*I,G=g*U+p*I,s[f+v]=B-G,s[f+0]=B+G,s[u+x]=O-Q,s[u+y]=O+Q,f+=c,u+=c}while(u<d);D=p,p=D*t[l+0]-g*t[l+1],g=D*t[l+1]+g*t[l+0]}l+=2}while(c<o)}var i=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(s,a,o,l,c){for(var u=0;u<3;u++){var f=Fu.BLKSIZE_s/2,d=65535&576/3*(u+1),g=Fu.BLKSIZE_s/8-1;do{var p,_,y,v,x,E=i[g<<2]&255;p=e[E]*l[o][c+E+d],x=e[127-E]*l[o][c+E+d+128],_=p-x,p=p+x,y=e[E+64]*l[o][c+E+d+64],x=e[63-E]*l[o][c+E+d+192],v=y-x,y=y+x,f-=4,a[u][f+0]=p+y,a[u][f+2]=p-y,a[u][f+1]=_+v,a[u][f+3]=_-v,p=e[E+1]*l[o][c+E+d+1],x=e[126-E]*l[o][c+E+d+129],_=p-x,p=p+x,y=e[E+65]*l[o][c+E+d+65],x=e[62-E]*l[o][c+E+d+193],v=y-x,y=y+x,a[u][f+Fu.BLKSIZE_s/2+0]=p+y,a[u][f+Fu.BLKSIZE_s/2+2]=p-y,a[u][f+Fu.BLKSIZE_s/2+1]=_+v,a[u][f+Fu.BLKSIZE_s/2+3]=_-v}while(--g>=0);r(a[u],f,Fu.BLKSIZE_s/2)}},this.fft_long=function(s,a,o,l,c){var u=Fu.BLKSIZE/8-1,f=Fu.BLKSIZE/2;do{var d,g,p,_,y,v=i[u]&255;d=n[v]*l[o][c+v],y=n[v+512]*l[o][c+v+512],g=d-y,d=d+y,p=n[v+256]*l[o][c+v+256],y=n[v+768]*l[o][c+v+768],_=p-y,p=p+y,f-=4,a[f+0]=d+p,a[f+2]=d-p,a[f+1]=g+_,a[f+3]=g-_,d=n[v+1]*l[o][c+v+1],y=n[v+513]*l[o][c+v+513],g=d-y,d=d+y,p=n[v+257]*l[o][c+v+257],y=n[v+769]*l[o][c+v+769],_=p-y,p=p+y,a[f+Fu.BLKSIZE/2+0]=d+p,a[f+Fu.BLKSIZE/2+2]=d-p,a[f+Fu.BLKSIZE/2+1]=g+_,a[f+Fu.BLKSIZE/2+3]=g-_}while(--u>=0);r(a,f,Fu.BLKSIZE/2)},this.init_fft=function(s){for(var a=0;a<Fu.BLKSIZE;a++)n[a]=.42-.5*Math.cos(2*Math.PI*(a+.5)/Fu.BLKSIZE)+.08*Math.cos(4*Math.PI*(a+.5)/Fu.BLKSIZE);for(var a=0;a<Fu.BLKSIZE_s/2;a++)e[a]=.5*(1-Math.cos(2*Math.PI*(a+.5)/Fu.BLKSIZE_s))}}var Rot=wot,wb=Tc,Wx=wb.VbrMode,Xne=wb.Float,Yx=wb.ShortBlock,pm=wb.Util,Aot=wb.Arrays,ff=wb.new_float,d0=wb.new_float_n,xS=wb.new_int,Fi=wb.assert,Cot=Rot,pn=op();function Mot(){var n=KO,e=new Cot,t=2.302585092994046,r=2,i=16,s=2,a=16,o=.34,l=1/(14752*14752)/(pn.BLKSIZE/2),c=.01,u=.8,f=.6,d=.3,g=3.5,p=21,_=.2302585093;function y(se,_e){for(var Ne=0,Le=0;Le<pn.BLKSIZE/2;++Le)Ne+=se[Le]*_e.ATH.eql_w[Le];return Ne*=l,Ne}function v(se,_e,Ne,Le,ke,Re,st,Ve,tt,Ze,nt){var vt=se.internal_flags;if(tt<2)e.fft_long(vt,Le[ke],tt,Ze,nt),e.fft_short(vt,Re[st],tt,Ze,nt);else if(tt==2){for(var Qe=pn.BLKSIZE-1;Qe>=0;--Qe){var ht=Le[ke+0][Qe],mt=Le[ke+1][Qe];Le[ke+0][Qe]=(ht+mt)*pm.SQRT2*.5,Le[ke+1][Qe]=(ht-mt)*pm.SQRT2*.5}for(var ft=2;ft>=0;--ft)for(var Qe=pn.BLKSIZE_s-1;Qe>=0;--Qe){var ht=Re[st+0][ft][Qe],mt=Re[st+1][ft][Qe];Re[st+0][ft][Qe]=(ht+mt)*pm.SQRT2*.5,Re[st+1][ft][Qe]=(ht-mt)*pm.SQRT2*.5}}_e[0]=Le[ke+0][0],_e[0]*=_e[0];for(var Qe=pn.BLKSIZE/2-1;Qe>=0;--Qe){var _t=Le[ke+0][pn.BLKSIZE/2-Qe],gn=Le[ke+0][pn.BLKSIZE/2+Qe];_e[pn.BLKSIZE/2-Qe]=(_t*_t+gn*gn)*.5}for(var ft=2;ft>=0;--ft){Ne[ft][0]=Re[st+0][ft][0],Ne[ft][0]*=Ne[ft][0];for(var Qe=pn.BLKSIZE_s/2-1;Qe>=0;--Qe){var _t=Re[st+0][ft][pn.BLKSIZE_s/2-Qe],gn=Re[st+0][ft][pn.BLKSIZE_s/2+Qe];Ne[ft][pn.BLKSIZE_s/2-Qe]=(_t*_t+gn*gn)*.5}}{for(var _n=0,Qe=11;Qe<pn.HBLKSIZE;Qe++)_n+=_e[Qe];vt.tot_ener[tt]=_n}if(se.analysis){for(var Qe=0;Qe<pn.HBLKSIZE;Qe++)vt.pinfo.energy[Ve][tt][Qe]=vt.pinfo.energy_save[tt][Qe],vt.pinfo.energy_save[tt][Qe]=_e[Qe];vt.pinfo.pe[Ve][tt]=vt.pe[tt]}se.athaa_loudapprox==2&&tt<2&&(vt.loudness_sq[Ve][tt]=vt.loudness_sq_save[tt],vt.loudness_sq_save[tt]=y(_e,vt))}var x=8,E=23,M=15,O,N,I,D=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function V(){O=Math.pow(10,(x+1)/16),N=Math.pow(10,(E+1)/16),I=Math.pow(10,M/10)}var G=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],Q=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],B=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function $(se,_e,Ne,Le,ke,Re){var st;if(_e>se)if(_e<se*N)st=_e/se;else return se+_e;else{if(se>=_e*N)return se+_e;st=se/_e}if(se+=_e,Le+3<=6){if(st>=O)return se;var Ve=0|pm.FAST_LOG10_X(st,16);return se*Q[Ve]}var Ve=0|pm.FAST_LOG10_X(st,16);if(_e=ke.ATH.cb_l[Ne]*ke.ATH.adjust,se<I*_e){if(se>_e){var tt,Ze;return tt=1,Ve<=13&&(tt=B[Ve]),Ze=pm.FAST_LOG10_X(se/_e,10/15),se*((G[Ve]-tt)*Ze+tt)}return Ve>13?se:se*B[Ve]}return se*G[Ve]}var U=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function J(se,_e,Ne){var Le;if(se<0&&(se=0),_e<0&&(_e=0),se<=0)return _e;if(_e<=0)return se;if(_e>se?Le=_e/se:Le=se/_e,-2<=Ne&&Ne<=2){if(Le>=O)return se+_e;var ke=0|pm.FAST_LOG10_X(Le,16);return(se+_e)*U[ke]}return Le<N?se+_e:(se<_e&&(se=_e),se)}function W(se,_e){var Ne=se.internal_flags;if(Ne.channels_out>1){for(var Le=0;Le<pn.SBMAX_l;Le++){var ke=Ne.thm[0].l[Le],Re=Ne.thm[1].l[Le];Ne.thm[0].l[Le]+=Re*_e,Ne.thm[1].l[Le]+=ke*_e}for(var Le=0;Le<pn.SBMAX_s;Le++)for(var st=0;st<3;st++){var ke=Ne.thm[0].s[Le][st],Re=Ne.thm[1].s[Le][st];Ne.thm[0].s[Le][st]+=Re*_e,Ne.thm[1].s[Le][st]+=ke*_e}}}function q(se){for(var _e=0;_e<pn.SBMAX_l;_e++)if(!(se.thm[0].l[_e]>1.58*se.thm[1].l[_e]||se.thm[1].l[_e]>1.58*se.thm[0].l[_e])){var Ne=se.mld_l[_e]*se.en[3].l[_e],Le=Math.max(se.thm[2].l[_e],Math.min(se.thm[3].l[_e],Ne));Ne=se.mld_l[_e]*se.en[2].l[_e];var ke=Math.max(se.thm[3].l[_e],Math.min(se.thm[2].l[_e],Ne));se.thm[2].l[_e]=Le,se.thm[3].l[_e]=ke}for(var _e=0;_e<pn.SBMAX_s;_e++)for(var Re=0;Re<3;Re++)if(!(se.thm[0].s[_e][Re]>1.58*se.thm[1].s[_e][Re]||se.thm[1].s[_e][Re]>1.58*se.thm[0].s[_e][Re])){var Ne=se.mld_s[_e]*se.en[3].s[_e][Re],Le=Math.max(se.thm[2].s[_e][Re],Math.min(se.thm[3].s[_e][Re],Ne));Ne=se.mld_s[_e]*se.en[2].s[_e][Re];var ke=Math.max(se.thm[3].s[_e][Re],Math.min(se.thm[2].s[_e][Re],Ne));se.thm[2].s[_e][Re]=Le,se.thm[3].s[_e][Re]=ke}}function Y(se,_e,Ne){var Le=_e,ke=Math.pow(10,Ne);_e*=2,Le*=2;for(var Re=0;Re<pn.SBMAX_l;Re++){var st,Ve,tt,Ze;if(Ze=se.ATH.cb_l[se.bm_l[Re]]*ke,st=Math.min(Math.max(se.thm[0].l[Re],Ze),Math.max(se.thm[1].l[Re],Ze)),Ve=Math.max(se.thm[2].l[Re],Ze),tt=Math.max(se.thm[3].l[Re],Ze),st*_e<Ve+tt){var nt=st*Le/(Ve+tt);Ve*=nt,tt*=nt}se.thm[2].l[Re]=Math.min(Ve,se.thm[2].l[Re]),se.thm[3].l[Re]=Math.min(tt,se.thm[3].l[Re])}ke*=pn.BLKSIZE_s/pn.BLKSIZE;for(var Re=0;Re<pn.SBMAX_s;Re++)for(var vt=0;vt<3;vt++){var st,Ve,tt,Ze;if(Ze=se.ATH.cb_s[se.bm_s[Re]]*ke,st=Math.min(Math.max(se.thm[0].s[Re][vt],Ze),Math.max(se.thm[1].s[Re][vt],Ze)),Ve=Math.max(se.thm[2].s[Re][vt],Ze),tt=Math.max(se.thm[3].s[Re][vt],Ze),st*_e<Ve+tt){var nt=st*_e/(Ve+tt);Ve*=nt,tt*=nt}se.thm[2].s[Re][vt]=Math.min(se.thm[2].s[Re][vt],Ve),se.thm[3].s[Re][vt]=Math.min(se.thm[3].s[Re][vt],tt)}}function ae(se,_e,Ne,Le,ke){var Re,st,Ve=0,tt=0;for(Re=st=0;Re<pn.SBMAX_s;++st,++Re){for(var Ze=se.bo_s[Re],nt=se.npart_s,vt=Ze<nt?Ze:nt;st<vt;)Fi(_e[st]>=0),Fi(Ne[st]>=0),Ve+=_e[st],tt+=Ne[st],st++;if(se.en[Le].s[Re][ke]=Ve,se.thm[Le].s[Re][ke]=tt,st>=nt){++Re;break}Fi(_e[st]>=0),Fi(Ne[st]>=0);{var Qe=se.PSY.bo_s_weight[Re],ht=1-Qe;Ve=Qe*_e[st],tt=Qe*Ne[st],se.en[Le].s[Re][ke]+=Ve,se.thm[Le].s[Re][ke]+=tt,Ve=ht*_e[st],tt=ht*Ne[st]}}for(;Re<pn.SBMAX_s;++Re)se.en[Le].s[Re][ke]=0,se.thm[Le].s[Re][ke]=0}function Z(se,_e,Ne,Le){var ke,Re,st=0,Ve=0;for(ke=Re=0;ke<pn.SBMAX_l;++Re,++ke){for(var tt=se.bo_l[ke],Ze=se.npart_l,nt=tt<Ze?tt:Ze;Re<nt;)Fi(_e[Re]>=0),Fi(Ne[Re]>=0),st+=_e[Re],Ve+=Ne[Re],Re++;if(se.en[Le].l[ke]=st,se.thm[Le].l[ke]=Ve,Re>=Ze){++ke;break}Fi(_e[Re]>=0),Fi(Ne[Re]>=0);{var vt=se.PSY.bo_l_weight[ke],Qe=1-vt;st=vt*_e[Re],Ve=vt*Ne[Re],se.en[Le].l[ke]+=st,se.thm[Le].l[ke]+=Ve,st=Qe*_e[Re],Ve=Qe*Ne[Re]}}for(;ke<pn.SBMAX_l;++ke)se.en[Le].l[ke]=0,se.thm[Le].l[ke]=0}function K(se,_e,Ne,Le,ke,Re){var st=se.internal_flags,Ve,tt;for(tt=Ve=0;tt<st.npart_s;++tt){for(var Ze=0,nt=st.numlines_s[tt],vt=0;vt<nt;++vt,++Ve){var Qe=_e[Re][Ve];Ze+=Qe}Ne[tt]=Ze}for(Fi(tt==st.npart_s),Ve=tt=0;tt<st.npart_s;tt++){var ht=st.s3ind_s[tt][0],mt=st.s3_ss[Ve++]*Ne[ht];for(++ht;ht<=st.s3ind_s[tt][1];)mt+=st.s3_ss[Ve]*Ne[ht],++Ve,++ht;{var ft=s*st.nb_s1[ke][tt];Le[tt]=Math.min(mt,ft)}if(st.blocktype_old[ke&1]==pn.SHORT_TYPE){var ft=a*st.nb_s2[ke][tt],_t=Le[tt];Le[tt]=Math.min(ft,_t)}st.nb_s2[ke][tt]=st.nb_s1[ke][tt],st.nb_s1[ke][tt]=mt,Fi(Le[tt]>=0)}for(;tt<=pn.CBANDS;++tt)Ne[tt]=0,Le[tt]=0}function ne(se,_e,Ne,Le){var ke=se.internal_flags;se.short_blocks==Yx.short_block_coupled&&!(_e[0]!=0&&_e[1]!=0)&&(_e[0]=_e[1]=0);for(var Re=0;Re<ke.channels_out;Re++)Le[Re]=pn.NORM_TYPE,se.short_blocks==Yx.short_block_dispensed&&(_e[Re]=1),se.short_blocks==Yx.short_block_forced&&(_e[Re]=0),_e[Re]!=0?(Fi(ke.blocktype_old[Re]!=pn.START_TYPE),ke.blocktype_old[Re]==pn.SHORT_TYPE&&(Le[Re]=pn.STOP_TYPE)):(Le[Re]=pn.SHORT_TYPE,ke.blocktype_old[Re]==pn.NORM_TYPE&&(ke.blocktype_old[Re]=pn.START_TYPE),ke.blocktype_old[Re]==pn.STOP_TYPE&&(ke.blocktype_old[Re]=pn.SHORT_TYPE)),Ne[Re]=ke.blocktype_old[Re],ke.blocktype_old[Re]=Le[Re]}function le(se,_e,Ne){return Ne>=1?se:Ne<=0?_e:_e>0?Math.pow(se/_e,Ne)*_e:0}var ce=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function de(se,_e){for(var Ne=309.07,Le=0;Le<pn.SBMAX_s-1;Le++)for(var ke=0;ke<3;ke++){var Re=se.thm.s[Le][ke];if(Re>0){var st=Re*_e,Ve=se.en.s[Le][ke];Ve>st&&(Ve>st*1e10?Ne+=ce[Le]*(10*t):Ne+=ce[Le]*pm.FAST_LOG10(Ve/st))}}return Ne}var Me=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function qe(se,_e){for(var Ne=281.0575,Le=0;Le<pn.SBMAX_l-1;Le++){var ke=se.thm.l[Le];if(ke>0){var Re=ke*_e,st=se.en.l[Le];st>Re&&(st>Re*1e10?Ne+=Me[Le]*(10*t):Ne+=Me[Le]*pm.FAST_LOG10(st/Re))}}return Ne}function Pe(se,_e,Ne,Le,ke){var Re,st;for(Re=st=0;Re<se.npart_l;++Re){var Ve=0,tt=0,Ze;for(Ze=0;Ze<se.numlines_l[Re];++Ze,++st){var nt=_e[st];Ve+=nt,tt<nt&&(tt=nt)}Ne[Re]=Ve,Le[Re]=tt,ke[Re]=Ve*se.rnumlines_l[Re],Fi(se.rnumlines_l[Re]>=0),Fi(Ne[Re]>=0),Fi(Le[Re]>=0),Fi(ke[Re]>=0)}}function Ce(se,_e,Ne,Le){var ke=D.length-1,Re=0,st=Ne[Re]+Ne[Re+1];if(st>0){var Ve=_e[Re];Ve<_e[Re+1]&&(Ve=_e[Re+1]),Fi(se.numlines_l[Re]+se.numlines_l[Re+1]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_l[Re]+se.numlines_l[Re+1]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;for(Re=1;Re<se.npart_l-1;Re++)if(st=Ne[Re-1]+Ne[Re]+Ne[Re+1],st>0){var Ve=_e[Re-1];Ve<_e[Re]&&(Ve=_e[Re]),Ve<_e[Re+1]&&(Ve=_e[Re+1]),Fi(se.numlines_l[Re-1]+se.numlines_l[Re]+se.numlines_l[Re+1]-1>0),st=20*(Ve*3-st)/(st*(se.numlines_l[Re-1]+se.numlines_l[Re]+se.numlines_l[Re+1]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;if(Fi(Re==se.npart_l-1),st=Ne[Re-1]+Ne[Re],st>0){var Ve=_e[Re-1];Ve<_e[Re]&&(Ve=_e[Re]),Fi(se.numlines_l[Re-1]+se.numlines_l[Re]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_l[Re-1]+se.numlines_l[Re]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;Fi(Re==se.npart_l-1)}var Xe=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(se,_e,Ne,Le,ke,Re,st,Ve,tt,Ze){var nt=se.internal_flags,vt=d0([2,pn.BLKSIZE]),Qe=d0([2,3,pn.BLKSIZE_s]),ht=ff(pn.CBANDS+1),mt=ff(pn.CBANDS+1),ft=ff(pn.CBANDS+2),_t=xS(2),gn=xS(2),_n,Bt,Yt,Mt,fn,Bn,cn,In,$n=d0([2,576]),er,as=xS(pn.CBANDS+2),di=xS(pn.CBANDS+2);for(Aot.fill(di,0),_n=nt.channels_out,se.mode==n.JOINT_STEREO&&(_n=4),se.VBR==Wx.vbr_off?er=nt.ResvMax==0?0:nt.ResvSize/nt.ResvMax*.5:se.VBR==Wx.vbr_rh||se.VBR==Wx.vbr_mtrh||se.VBR==Wx.vbr_mt?er=.6:er=1,Bt=0;Bt<nt.channels_out;Bt++){var Oi=_e[Bt],Bs=Ne+576-350-p+192;for(Mt=0;Mt<576;Mt++){var pi,ws;for(pi=Oi[Bs+Mt+10],ws=0,fn=0;fn<(p-1)/2-1;fn+=2)pi+=Xe[fn]*(Oi[Bs+Mt+fn]+Oi[Bs+Mt+p-fn]),ws+=Xe[fn+1]*(Oi[Bs+Mt+fn+1]+Oi[Bs+Mt+p-fn-1]);$n[Bt][Mt]=pi+ws}ke[Le][Bt].en.assign(nt.en[Bt]),ke[Le][Bt].thm.assign(nt.thm[Bt]),_n>2&&(Re[Le][Bt].en.assign(nt.en[Bt+2]),Re[Le][Bt].thm.assign(nt.thm[Bt+2]))}for(Bt=0;Bt<_n;Bt++){var na,os,We=ff(12),At=[0,0,0,0],Wt=ff(12),Kt=1,Lt,yn=ff(pn.CBANDS),zn=ff(pn.CBANDS),En=[0,0,0,0],tr=ff(pn.HBLKSIZE),Ir=d0([3,pn.HBLKSIZE_s]);for(Fi(nt.npart_s<=pn.CBANDS),Fi(nt.npart_l<=pn.CBANDS),Mt=0;Mt<3;Mt++)We[Mt]=nt.nsPsy.last_en_subshort[Bt][Mt+6],Fi(nt.nsPsy.last_en_subshort[Bt][Mt+4]>0),Wt[Mt]=We[Mt]/nt.nsPsy.last_en_subshort[Bt][Mt+4],At[0]+=We[Mt];if(Bt==2)for(Mt=0;Mt<576;Mt++){var Er,rr;Er=$n[0][Mt],rr=$n[1][Mt],$n[0][Mt]=Er+rr,$n[1][Mt]=Er-rr}{var Dr=$n[Bt&1],ri=0;for(Mt=0;Mt<9;Mt++){for(var ha=ri+64,Cr=1;ri<ha;ri++)Cr<Math.abs(Dr[ri])&&(Cr=Math.abs(Dr[ri]));nt.nsPsy.last_en_subshort[Bt][Mt]=We[Mt+3]=Cr,At[1+Mt/3]+=Cr,Cr>We[Mt+3-2]?(Fi(We[Mt+3-2]>0),Cr=Cr/We[Mt+3-2]):We[Mt+3-2]>Cr*10?Cr=We[Mt+3-2]/(Cr*10):Cr=0,Wt[Mt+3]=Cr}}if(se.analysis){var ii=Wt[0];for(Mt=1;Mt<12;Mt++)ii<Wt[Mt]&&(ii=Wt[Mt]);nt.pinfo.ers[Le][Bt]=nt.pinfo.ers_save[Bt],nt.pinfo.ers_save[Bt]=ii}for(Lt=Bt==3?nt.nsPsy.attackthre_s:nt.nsPsy.attackthre,Mt=0;Mt<12;Mt++)En[Mt/3]==0&&Wt[Mt]>Lt&&(En[Mt/3]=Mt%3+1);for(Mt=1;Mt<4;Mt++){var Tr;At[Mt-1]>At[Mt]?(Fi(At[Mt]>0),Tr=At[Mt-1]/At[Mt]):(Fi(At[Mt-1]>0),Tr=At[Mt]/At[Mt-1]),Tr<1.7&&(En[Mt]=0,Mt==1&&(En[0]=0))}for(En[0]!=0&&nt.nsPsy.lastAttacks[Bt]!=0&&(En[0]=0),(nt.nsPsy.lastAttacks[Bt]==3||En[0]+En[1]+En[2]+En[3]!=0)&&(Kt=0,En[1]!=0&&En[0]!=0&&(En[1]=0),En[2]!=0&&En[1]!=0&&(En[2]=0),En[3]!=0&&En[2]!=0&&(En[3]=0)),Bt<2?gn[Bt]=Kt:Kt==0&&(gn[0]=gn[1]=0),tt[Bt]=nt.tot_ener[Bt],os=Qe,na=vt,v(se,tr,Ir,na,Bt&1,os,Bt&1,Le,Bt,_e,Ne),Pe(nt,tr,ht,yn,zn),Ce(nt,yn,zn,as),In=0;In<3;In++){var Pr,Cn;for(K(se,Ir,mt,ft,Bt,In),ae(nt,mt,ft,Bt,In),cn=0;cn<pn.SBMAX_s;cn++){if(Cn=nt.thm[Bt].s[cn][In],Cn*=u,En[In]>=2||En[In+1]==1){var zr=In!=0?In-1:2,Cr=le(nt.thm[Bt].s[cn][zr],Cn,f*er);Cn=Math.min(Cn,Cr)}if(En[In]==1){var zr=In!=0?In-1:2,Cr=le(nt.thm[Bt].s[cn][zr],Cn,d*er);Cn=Math.min(Cn,Cr)}else if(In!=0&&En[In-1]==3||In==0&&nt.nsPsy.lastAttacks[Bt]==3){var zr=In!=2?In+1:0,Cr=le(nt.thm[Bt].s[cn][zr],Cn,d*er);Cn=Math.min(Cn,Cr)}Pr=We[In*3+3]+We[In*3+4]+We[In*3+5],We[In*3+5]*6<Pr&&(Cn*=.5,We[In*3+4]*6<Pr&&(Cn*=.5)),nt.thm[Bt].s[cn][In]=Cn}}for(nt.nsPsy.lastAttacks[Bt]=En[2],Bn=0,Yt=0;Yt<nt.npart_l;Yt++){for(var Do=nt.s3ind[Yt][0],ls=ht[Do]*D[as[Do]],Lo=nt.s3_ll[Bn++]*ls;++Do<=nt.s3ind[Yt][1];)ls=ht[Do]*D[as[Do]],Lo=$(Lo,nt.s3_ll[Bn++]*ls,Do,Do-Yt,nt);Lo*=.158489319246111,nt.blocktype_old[Bt&1]==pn.SHORT_TYPE?ft[Yt]=Lo:ft[Yt]=le(Math.min(Lo,Math.min(r*nt.nb_1[Bt][Yt],i*nt.nb_2[Bt][Yt])),Lo,er),nt.nb_2[Bt][Yt]=nt.nb_1[Bt][Yt],nt.nb_1[Bt][Yt]=Lo}for(;Yt<=pn.CBANDS;++Yt)ht[Yt]=0,ft[Yt]=0;Z(nt,ht,ft,Bt)}if((se.mode==n.STEREO||se.mode==n.JOINT_STEREO)&&se.interChRatio>0&&W(se,se.interChRatio),se.mode==n.JOINT_STEREO){var cs;q(nt),cs=se.msfix,Math.abs(cs)>0&&Y(nt,cs,se.ATHlower*nt.ATH.adjust)}for(ne(se,gn,Ze,_t),Bt=0;Bt<_n;Bt++){var Xn,Jr=0,ur,Fs;Bt>1?(Xn=Ve,Jr=-2,ur=pn.NORM_TYPE,(Ze[0]==pn.SHORT_TYPE||Ze[1]==pn.SHORT_TYPE)&&(ur=pn.SHORT_TYPE),Fs=Re[Le][Bt-2]):(Xn=st,Jr=0,ur=Ze[Bt],Fs=ke[Le][Bt]),ur==pn.SHORT_TYPE?Xn[Jr+Bt]=de(Fs,nt.masking_lower):Xn[Jr+Bt]=qe(Fs,nt.masking_lower),se.analysis&&(nt.pinfo.pe[Le][Bt]=Xn[Jr+Bt])}return 0};function $e(se,_e,Ne,Le,ke,Re,st,Ve){var tt=se.internal_flags;if(Le<2)e.fft_long(tt,st[Ve],Le,_e,Ne);else if(Le==2)for(var Ze=pn.BLKSIZE-1;Ze>=0;--Ze){var nt=st[Ve+0][Ze],vt=st[Ve+1][Ze];st[Ve+0][Ze]=(nt+vt)*pm.SQRT2*.5,st[Ve+1][Ze]=(nt-vt)*pm.SQRT2*.5}Re[0]=st[Ve+0][0],Re[0]*=Re[0];for(var Ze=pn.BLKSIZE/2-1;Ze>=0;--Ze){var Qe=st[Ve+0][pn.BLKSIZE/2-Ze],ht=st[Ve+0][pn.BLKSIZE/2+Ze];Re[pn.BLKSIZE/2-Ze]=(Qe*Qe+ht*ht)*.5}{for(var mt=0,Ze=11;Ze<pn.HBLKSIZE;Ze++)mt+=Re[Ze];tt.tot_ener[Le]=mt}if(se.analysis){for(var Ze=0;Ze<pn.HBLKSIZE;Ze++)tt.pinfo.energy[ke][Le][Ze]=tt.pinfo.energy_save[Le][Ze],tt.pinfo.energy_save[Le][Ze]=Re[Ze];tt.pinfo.pe[ke][Le]=tt.pe[Le]}}function at(se,_e,Ne,Le,ke,Re,st,Ve){var tt=se.internal_flags;if(ke==0&&Le<2&&e.fft_short(tt,st[Ve],Le,_e,Ne),Le==2)for(var Ze=pn.BLKSIZE_s-1;Ze>=0;--Ze){var nt=st[Ve+0][ke][Ze],vt=st[Ve+1][ke][Ze];st[Ve+0][ke][Ze]=(nt+vt)*pm.SQRT2*.5,st[Ve+1][ke][Ze]=(nt-vt)*pm.SQRT2*.5}Re[ke][0]=st[Ve+0][ke][0],Re[ke][0]*=Re[ke][0];for(var Ze=pn.BLKSIZE_s/2-1;Ze>=0;--Ze){var Qe=st[Ve+0][ke][pn.BLKSIZE_s/2-Ze],ht=st[Ve+0][ke][pn.BLKSIZE_s/2+Ze];Re[ke][pn.BLKSIZE_s/2-Ze]=(Qe*Qe+ht*ht)*.5}}function pt(se,_e,Ne,Le){var ke=se.internal_flags;se.athaa_loudapprox==2&&Ne<2&&(ke.loudness_sq[_e][Ne]=ke.loudness_sq_save[Ne],ke.loudness_sq_save[Ne]=y(Le,ke))}var oe=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function Ue(se,_e,Ne,Le,ke,Re,st,Ve,tt,Ze){for(var nt=d0([2,576]),vt=se.internal_flags,Qe=vt.channels_out,ht=se.mode==n.JOINT_STEREO?4:Qe,mt=0;mt<Qe;mt++){firbuf=_e[mt];for(var ft=Ne+576-350-p+192,_t=0;_t<576;_t++){var gn,_n;gn=firbuf[ft+_t+10],_n=0;for(var Bt=0;Bt<(p-1)/2-1;Bt+=2)gn+=oe[Bt]*(firbuf[ft+_t+Bt]+firbuf[ft+_t+p-Bt]),_n+=oe[Bt+1]*(firbuf[ft+_t+Bt+1]+firbuf[ft+_t+p-Bt-1]);nt[mt][_t]=gn+_n}ke[Le][mt].en.assign(vt.en[mt]),ke[Le][mt].thm.assign(vt.thm[mt]),ht>2&&(Re[Le][mt].en.assign(vt.en[mt+2]),Re[Le][mt].thm.assign(vt.thm[mt+2]))}for(var mt=0;mt<ht;mt++){var Yt=ff(12),Mt=ff(12),fn=[0,0,0,0],Bn=nt[mt&1],cn=0,In=mt==3?vt.nsPsy.attackthre_s:vt.nsPsy.attackthre,$n=1;if(mt==2)for(var _t=0,Bt=576;Bt>0;++_t,--Bt){var er=nt[0][_t],as=nt[1][_t];nt[0][_t]=er+as,nt[1][_t]=er-as}for(var _t=0;_t<3;_t++)Mt[_t]=vt.nsPsy.last_en_subshort[mt][_t+6],Fi(vt.nsPsy.last_en_subshort[mt][_t+4]>0),Yt[_t]=Mt[_t]/vt.nsPsy.last_en_subshort[mt][_t+4],fn[0]+=Mt[_t];for(var _t=0;_t<9;_t++){for(var di=cn+64,Oi=1;cn<di;cn++)Oi<Math.abs(Bn[cn])&&(Oi=Math.abs(Bn[cn]));vt.nsPsy.last_en_subshort[mt][_t]=Mt[_t+3]=Oi,fn[1+_t/3]+=Oi,Oi>Mt[_t+3-2]?(Fi(Mt[_t+3-2]>0),Oi=Oi/Mt[_t+3-2]):Mt[_t+3-2]>Oi*10?Oi=Mt[_t+3-2]/(Oi*10):Oi=0,Yt[_t+3]=Oi}for(var _t=0;_t<3;++_t){var Bs=Mt[_t*3+3]+Mt[_t*3+4]+Mt[_t*3+5],pi=1;Mt[_t*3+5]*6<Bs&&(pi*=.5,Mt[_t*3+4]*6<Bs&&(pi*=.5)),Ve[mt][_t]=pi}if(se.analysis){for(var ws=Yt[0],_t=1;_t<12;_t++)ws<Yt[_t]&&(ws=Yt[_t]);vt.pinfo.ers[Le][mt]=vt.pinfo.ers_save[mt],vt.pinfo.ers_save[mt]=ws}for(var _t=0;_t<12;_t++)tt[mt][_t/3]==0&&Yt[_t]>In&&(tt[mt][_t/3]=_t%3+1);for(var _t=1;_t<4;_t++){var na=fn[_t-1],os=fn[_t],We=Math.max(na,os);We<4e4&&na<1.7*os&&os<1.7*na&&(_t==1&&tt[mt][0]<=tt[mt][_t]&&(tt[mt][0]=0),tt[mt][_t]=0)}tt[mt][0]<=vt.nsPsy.lastAttacks[mt]&&(tt[mt][0]=0),(vt.nsPsy.lastAttacks[mt]==3||tt[mt][0]+tt[mt][1]+tt[mt][2]+tt[mt][3]!=0)&&($n=0,tt[mt][1]!=0&&tt[mt][0]!=0&&(tt[mt][1]=0),tt[mt][2]!=0&&tt[mt][1]!=0&&(tt[mt][2]=0),tt[mt][3]!=0&&tt[mt][2]!=0&&(tt[mt][3]=0)),mt<2?Ze[mt]=$n:$n==0&&(Ze[0]=Ze[1]=0),st[mt]=vt.tot_ener[mt]}}function Ge(se,_e,Ne){if(Ne==0)for(var Le=0;Le<se.npart_s;Le++)se.nb_s2[_e][Le]=se.nb_s1[_e][Le],se.nb_s1[_e][Le]=0}function ze(se,_e){for(var Ne=0;Ne<se.npart_l;Ne++)se.nb_2[_e][Ne]=se.nb_1[_e][Ne],se.nb_1[_e][Ne]=0}function Be(se,_e,Ne,Le){var ke=D.length-1,Re=0,st=Ne[Re]+Ne[Re+1];if(st>0){var Ve=_e[Re];Ve<_e[Re+1]&&(Ve=_e[Re+1]),Fi(se.numlines_s[Re]+se.numlines_s[Re+1]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_s[Re]+se.numlines_s[Re+1]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;for(Re=1;Re<se.npart_s-1;Re++)if(st=Ne[Re-1]+Ne[Re]+Ne[Re+1],Fi(Re+1<se.npart_s),st>0){var Ve=_e[Re-1];Ve<_e[Re]&&(Ve=_e[Re]),Ve<_e[Re+1]&&(Ve=_e[Re+1]),Fi(se.numlines_s[Re-1]+se.numlines_s[Re]+se.numlines_s[Re+1]-1>0),st=20*(Ve*3-st)/(st*(se.numlines_s[Re-1]+se.numlines_s[Re]+se.numlines_s[Re+1]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;if(Fi(Re==se.npart_s-1),st=Ne[Re-1]+Ne[Re],st>0){var Ve=_e[Re-1];Ve<_e[Re]&&(Ve=_e[Re]),Fi(se.numlines_s[Re-1]+se.numlines_s[Re]-1>0),st=20*(Ve*2-st)/(st*(se.numlines_s[Re-1]+se.numlines_s[Re]-1));var tt=0|st;tt>ke&&(tt=ke),Le[Re]=tt}else Le[Re]=0;Fi(Re==se.npart_s-1)}function me(se,_e,Ne,Le,ke,Re){var st=se.internal_flags,Ve=new float[pn.CBANDS],tt=ff(pn.CBANDS),Ze,nt,vt,Qe=new int[pn.CBANDS];for(vt=nt=0;vt<st.npart_s;++vt){var ht=0,mt=0,ft=st.numlines_s[vt];for(Ze=0;Ze<ft;++Ze,++nt){var _t=_e[Re][nt];ht+=_t,mt<_t&&(mt=_t)}Ne[vt]=ht,Ve[vt]=mt,tt[vt]=ht/ft,Fi(tt[vt]>=0)}for(Fi(vt==st.npart_s);vt<pn.CBANDS;++vt)Ve[vt]=0,tt[vt]=0;for(Be(st,Ve,tt,Qe),nt=vt=0;vt<st.npart_s;vt++){var gn=st.s3ind_s[vt][0],_n=st.s3ind_s[vt][1],Bt,Yt,Mt,fn,Bn;for(Bt=Qe[gn],Yt=1,fn=st.s3_ss[nt]*Ne[gn]*D[Qe[gn]],++nt,++gn;gn<=_n;)Bt+=Qe[gn],Yt+=1,Mt=st.s3_ss[nt]*Ne[gn]*D[Qe[gn]],fn=J(fn,Mt,gn-vt),++nt,++gn;Bt=(1+2*Bt)/(2*Yt),Bn=D[Bt]*.5,fn*=Bn,Le[vt]=fn,st.nb_s2[ke][vt]=st.nb_s1[ke][vt],st.nb_s1[ke][vt]=fn,Mt=Ve[vt],Mt*=st.minval_s[vt],Mt*=Bn,Le[vt]>Mt&&(Le[vt]=Mt),st.masking_lower>1&&(Le[vt]*=st.masking_lower),Le[vt]>Ne[vt]&&(Le[vt]=Ne[vt]),st.masking_lower<1&&(Le[vt]*=st.masking_lower),Fi(Le[vt]>=0)}for(;vt<pn.CBANDS;++vt)Ne[vt]=0,Le[vt]=0}function Se(se,_e,Ne,Le,ke){var Re=ff(pn.CBANDS),st=ff(pn.CBANDS),Ve=xS(pn.CBANDS+2),tt;Pe(se,_e,Ne,Re,st),Ce(se,Re,st,Ve);var Ze=0;for(tt=0;tt<se.npart_l;tt++){var nt,vt,Qe,ht,mt=se.s3ind[tt][0],ft=se.s3ind[tt][1],_t=0,gn=0;for(_t=Ve[mt],gn+=1,vt=se.s3_ll[Ze]*Ne[mt]*D[Ve[mt]],++Ze,++mt;mt<=ft;)_t+=Ve[mt],gn+=1,nt=se.s3_ll[Ze]*Ne[mt]*D[Ve[mt]],ht=J(vt,nt,mt-tt),vt=ht,++Ze,++mt;if(_t=(1+2*_t)/(2*gn),Qe=D[_t]*.5,vt*=Qe,se.blocktype_old[ke&1]==pn.SHORT_TYPE){var _n=r*se.nb_1[ke][tt];_n>0?Le[tt]=Math.min(vt,_n):Le[tt]=Math.min(vt,Ne[tt]*d)}else{var Bt=i*se.nb_2[ke][tt],Yt=r*se.nb_1[ke][tt],_n;Bt<=0&&(Bt=vt),Yt<=0&&(Yt=vt),se.blocktype_old[ke&1]==pn.NORM_TYPE?_n=Math.min(Yt,Bt):_n=Yt,Le[tt]=Math.min(vt,_n)}se.nb_2[ke][tt]=se.nb_1[ke][tt],se.nb_1[ke][tt]=vt,nt=Re[tt],nt*=se.minval_l[tt],nt*=Qe,Le[tt]>nt&&(Le[tt]=nt),se.masking_lower>1&&(Le[tt]*=se.masking_lower),Le[tt]>Ne[tt]&&(Le[tt]=Ne[tt]),se.masking_lower<1&&(Le[tt]*=se.masking_lower),Fi(Le[tt]>=0)}for(;tt<pn.CBANDS;++tt)Ne[tt]=0,Le[tt]=0}function Ie(se,_e){var Ne=se.internal_flags;se.short_blocks==Yx.short_block_coupled&&!(_e[0]!=0&&_e[1]!=0)&&(_e[0]=_e[1]=0);for(var Le=0;Le<Ne.channels_out;Le++)se.short_blocks==Yx.short_block_dispensed&&(_e[Le]=1),se.short_blocks==Yx.short_block_forced&&(_e[Le]=0)}function be(se,_e,Ne){for(var Le=se.internal_flags,ke=0;ke<Le.channels_out;ke++){var Re=pn.NORM_TYPE;_e[ke]!=0?(Fi(Le.blocktype_old[ke]!=pn.START_TYPE),Le.blocktype_old[ke]==pn.SHORT_TYPE&&(Re=pn.STOP_TYPE)):(Re=pn.SHORT_TYPE,Le.blocktype_old[ke]==pn.NORM_TYPE&&(Le.blocktype_old[ke]=pn.START_TYPE),Le.blocktype_old[ke]==pn.STOP_TYPE&&(Le.blocktype_old[ke]=pn.SHORT_TYPE)),Ne[ke]=Le.blocktype_old[ke],Le.blocktype_old[ke]=Re}}function Ke(se,_e,Ne,Le,ke,Re,st){for(var Ve=Re*2,tt=Re>0?Math.pow(10,ke):1,Ze,nt,vt=0;vt<st;++vt){var Qe=se[2][vt],ht=se[3][vt],mt=_e[0][vt],ft=_e[1][vt],_t=_e[2][vt],gn=_e[3][vt];if(mt<=1.58*ft&&ft<=1.58*mt){var _n=Ne[vt]*ht,Bt=Ne[vt]*Qe;nt=Math.max(_t,Math.min(gn,_n)),Ze=Math.max(gn,Math.min(_t,Bt))}else nt=_t,Ze=gn;if(Re>0){var Yt,Mt,fn=Le[vt]*tt;if(Yt=Math.min(Math.max(mt,fn),Math.max(ft,fn)),_t=Math.max(nt,fn),gn=Math.max(Ze,fn),Mt=_t+gn,Mt>0&&Yt*Ve<Mt){var Bn=Yt*Ve/Mt;_t*=Bn,gn*=Bn}nt=Math.min(_t,nt),Ze=Math.min(gn,Ze)}nt>Qe&&(nt=Qe),Ze>ht&&(Ze=ht),_e[2][vt]=nt,_e[3][vt]=Ze}}this.L3psycho_anal_vbr=function(se,_e,Ne,Le,ke,Re,st,Ve,tt,Ze){var nt=se.internal_flags,vt,Qe,ht=ff(pn.HBLKSIZE),mt=d0([3,pn.HBLKSIZE_s]),ft=d0([2,pn.BLKSIZE]),_t=d0([2,3,pn.BLKSIZE_s]),gn=d0([4,pn.CBANDS]),_n=d0([4,pn.CBANDS]),Bt=d0([4,3]),Yt=.6,Mt=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],fn=xS(2),Bn=se.mode==n.JOINT_STEREO?4:nt.channels_out;Ue(se,_e,Ne,Le,ke,Re,tt,Bt,Mt,fn),Ie(se,fn);{for(var cn=0;cn<Bn;cn++){var In=cn&1;vt=ft,$e(se,_e,Ne,cn,Le,ht,vt,In),pt(se,Le,cn,ht),fn[In]!=0?Se(nt,ht,gn[cn],_n[cn],cn):ze(nt,cn)}fn[0]+fn[1]==2&&se.mode==n.JOINT_STEREO&&Ke(gn,_n,nt.mld_cb_l,nt.ATH.cb_l,se.ATHlower*nt.ATH.adjust,se.msfix,nt.npart_l);for(var cn=0;cn<Bn;cn++){var In=cn&1;fn[In]!=0&&Z(nt,gn[cn],_n[cn],cn)}}{for(var $n=0;$n<3;$n++){for(var cn=0;cn<Bn;++cn){var In=cn&1;fn[In]!=0?Ge(nt,cn,$n):(Qe=_t,at(se,_e,Ne,cn,$n,mt,Qe,In),me(se,mt,gn[cn],_n[cn],cn,$n))}fn[0]+fn[1]==0&&se.mode==n.JOINT_STEREO&&Ke(gn,_n,nt.mld_cb_s,nt.ATH.cb_s,se.ATHlower*nt.ATH.adjust,se.msfix,nt.npart_s);for(var cn=0;cn<Bn;++cn){var In=cn&1;fn[In]==0&&ae(nt,gn[cn],_n[cn],cn,$n)}}for(var cn=0;cn<Bn;cn++){var In=cn&1;if(fn[In]==0)for(var er=0;er<pn.SBMAX_s;er++){for(var as=ff(3),$n=0;$n<3;$n++){var di=nt.thm[cn].s[er][$n];if(di*=u,Mt[cn][$n]>=2||Mt[cn][$n+1]==1){var Oi=$n!=0?$n-1:2,Bs=le(nt.thm[cn].s[er][Oi],di,f*Yt);di=Math.min(di,Bs)}else if(Mt[cn][$n]==1){var Oi=$n!=0?$n-1:2,Bs=le(nt.thm[cn].s[er][Oi],di,d*Yt);di=Math.min(di,Bs)}else if($n!=0&&Mt[cn][$n-1]==3||$n==0&&nt.nsPsy.lastAttacks[cn]==3){var Oi=$n!=2?$n+1:0,Bs=le(nt.thm[cn].s[er][Oi],di,d*Yt);di=Math.min(di,Bs)}di*=Bt[cn][$n],as[$n]=di}for(var $n=0;$n<3;$n++)nt.thm[cn].s[er][$n]=as[$n]}}}for(var cn=0;cn<Bn;cn++)nt.nsPsy.lastAttacks[cn]=Mt[cn][2];be(se,fn,Ze);for(var cn=0;cn<Bn;cn++){var pi,ws,na,os;cn>1?(pi=Ve,ws=-2,na=pn.NORM_TYPE,(Ze[0]==pn.SHORT_TYPE||Ze[1]==pn.SHORT_TYPE)&&(na=pn.SHORT_TYPE),os=Re[Le][cn-2]):(pi=st,ws=0,na=Ze[cn],os=ke[Le][cn]),na==pn.SHORT_TYPE?pi[ws+cn]=de(os,nt.masking_lower):pi[ws+cn]=qe(os,nt.masking_lower),se.analysis&&(nt.pinfo.pe[Le][cn]=pi[ws+cn])}return 0};function ot(se,_e){var Ne=se,Le;return Ne>=0?Le=-Ne*27:Le=Ne*_e,Le<=-72?0:Math.exp(Le*_)}function lt(se){var _e=0,Ne=0;{var Le=0,ke,Re;for(Le=0;ot(Le,se)>1e-20;Le-=1);for(ke=Le,Re=0;Math.abs(Re-ke)>1e-12;)Le=(Re+ke)/2,ot(Le,se)>0?Re=Le:ke=Le;_e=ke}{var Le=0,ke,Re;for(Le=0;ot(Le,se)>1e-20;Le+=1);for(ke=0,Re=Le;Math.abs(Re-ke)>1e-12;)Le=(Re+ke)/2,ot(Le,se)>0?ke=Le:Re=Le;Ne=Re}{var st=0,Ve=1e3,tt;for(tt=0;tt<=Ve;++tt){var Le=_e+tt*(Ne-_e)/Ve,Ze=ot(Le,se);st+=Ze}{var nt=(Ve+1)/(st*(Ne-_e));return nt}}}function ct(se){var _e,Ne,Le,ke;return _e=se,_e>=0?_e*=3:_e*=1.5,_e>=.5&&_e<=2.5?(ke=_e-.5,Ne=8*(ke*ke-2*ke)):Ne=0,_e+=.474,Le=15.811389+7.5*_e-17.5*Math.sqrt(1+_e*_e),Le<=-60?0:(_e=Math.exp((Ne+Le)*_),_e/=.6609193,_e)}function Vt(se){return se<0&&(se=0),se=se*.001,13*Math.atan(.76*se)+3.5*Math.atan(se*se/(7.5*7.5))}function kt(se,_e,Ne,Le,ke,Re,st,Ve,tt,Ze,nt,vt){var Qe=ff(pn.CBANDS+1),ht=Ve/(vt>15?2*576:384),mt=xS(pn.HBLKSIZE),ft;Ve/=tt;var _t=0,gn=0;for(ft=0;ft<pn.CBANDS;ft++){var _n,Bt;for(_n=Vt(Ve*_t),Qe[ft]=Ve*_t,Bt=_t;Vt(Ve*Bt)-_n<o&&Bt<=tt/2;Bt++);for(se[ft]=Bt-_t,gn=ft+1;_t<Bt;)Fi(_t<pn.HBLKSIZE),mt[_t++]=ft;if(_t>tt/2){_t=tt/2,++ft;break}}Fi(ft<pn.CBANDS),Qe[ft]=Ve*_t;for(var Yt=0;Yt<vt;Yt++){var Mt,fn,Bn,cn,In;Bn=Ze[Yt],cn=Ze[Yt+1],Mt=0|Math.floor(.5+nt*(Bn-.5)),Mt<0&&(Mt=0),fn=0|Math.floor(.5+nt*(cn-.5)),fn>tt/2&&(fn=tt/2),Ne[Yt]=(mt[Mt]+mt[fn])/2,_e[Yt]=mt[fn];var $n=ht*cn;st[Yt]=($n-Qe[_e[Yt]])/(Qe[_e[Yt]+1]-Qe[_e[Yt]]),st[Yt]<0?st[Yt]=0:st[Yt]>1&&(st[Yt]=1),In=Vt(Ve*Ze[Yt]*nt),In=Math.min(In,15.5)/15.5,Re[Yt]=Math.pow(10,1.25*(1-Math.cos(Math.PI*In))-2.5)}_t=0;for(var er=0;er<gn;er++){var as=se[er],_n,di;_n=Vt(Ve*_t),di=Vt(Ve*(_t+as-1)),Le[er]=.5*(_n+di),_n=Vt(Ve*(_t-.5)),di=Vt(Ve*(_t+as-.5)),ke[er]=di-_n,_t+=as}return gn}function Ut(se,_e,Ne,Le,ke,Re){var st=d0([pn.CBANDS,pn.CBANDS]),Ve,tt=0;if(Re)for(var Ze=0;Ze<_e;Ze++)for(Ve=0;Ve<_e;Ve++){var nt=ct(Ne[Ze]-Ne[Ve])*Le[Ve];st[Ze][Ve]=nt*ke[Ze]}else for(Ve=0;Ve<_e;Ve++)for(var vt=15+Math.min(21/Ne[Ve],12),Qe=lt(vt),Ze=0;Ze<_e;Ze++){var nt=Qe*ot(Ne[Ze]-Ne[Ve],vt)*Le[Ve];st[Ze][Ve]=nt*ke[Ze]}for(var Ze=0;Ze<_e;Ze++){for(Ve=0;Ve<_e&&!(st[Ze][Ve]>0);Ve++);for(se[Ze][0]=Ve,Ve=_e-1;Ve>0&&!(st[Ze][Ve]>0);Ve--);se[Ze][1]=Ve,tt+=se[Ze][1]-se[Ze][0]+1}for(var ht=ff(tt),mt=0,Ze=0;Ze<_e;Ze++)for(Ve=se[Ze][0];Ve<=se[Ze][1];Ve++)ht[mt++]=st[Ze][Ve];return ht}function je(se){var _e=Vt(se);return _e=Math.min(_e,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*_e))-2.5)}this.psymodel_init=function(se){var _e=se.internal_flags,Ne,Le=!0,ke=13,Re=24,st=0,Ve=0,tt=-8.25,Ze=-4.5,nt=ff(pn.CBANDS),vt=ff(pn.CBANDS),Qe=ff(pn.CBANDS),ht=se.out_samplerate;switch(se.experimentalZ){default:case 0:Le=!0;break;case 1:Le=!(se.VBR==Wx.vbr_mtrh||se.VBR==Wx.vbr_mt);break;case 2:Le=!1;break;case 3:ke=8,st=-1.75,Ve=-.0125,tt=-8.25,Ze=-2.25;break}for(_e.ms_ener_ratio_old=.25,_e.blocktype_old[0]=_e.blocktype_old[1]=pn.NORM_TYPE,Ne=0;Ne<4;++Ne){for(var _t=0;_t<pn.CBANDS;++_t)_e.nb_1[Ne][_t]=1e20,_e.nb_2[Ne][_t]=1e20,_e.nb_s1[Ne][_t]=_e.nb_s2[Ne][_t]=1;for(var mt=0;mt<pn.SBMAX_l;mt++)_e.en[Ne].l[mt]=1e20,_e.thm[Ne].l[mt]=1e20;for(var _t=0;_t<3;++_t){for(var mt=0;mt<pn.SBMAX_s;mt++)_e.en[Ne].s[mt][_t]=1e20,_e.thm[Ne].s[mt][_t]=1e20;_e.nsPsy.lastAttacks[Ne]=0}for(var _t=0;_t<9;_t++)_e.nsPsy.last_en_subshort[Ne][_t]=10}for(_e.loudness_sq_save[0]=_e.loudness_sq_save[1]=0,_e.npart_l=kt(_e.numlines_l,_e.bo_l,_e.bm_l,nt,vt,_e.mld_l,_e.PSY.bo_l_weight,ht,pn.BLKSIZE,_e.scalefac_band.l,pn.BLKSIZE/(2*576),pn.SBMAX_l),Fi(_e.npart_l<pn.CBANDS),Ne=0;Ne<_e.npart_l;Ne++){var ft=st;nt[Ne]>=ke&&(ft=Ve*(nt[Ne]-ke)/(Re-ke)+st*(Re-nt[Ne])/(Re-ke)),Qe[Ne]=Math.pow(10,ft/10),_e.numlines_l[Ne]>0?_e.rnumlines_l[Ne]=1/_e.numlines_l[Ne]:_e.rnumlines_l[Ne]=0}_e.s3_ll=Ut(_e.s3ind,_e.npart_l,nt,vt,Qe,Le);var _t=0;for(Ne=0;Ne<_e.npart_l;Ne++){var gn;gn=Xne.MAX_VALUE;for(var _n=0;_n<_e.numlines_l[Ne];_n++,_t++){var Bt=ht*_t/(1e3*pn.BLKSIZE),Yt;Yt=this.ATHformula(Bt*1e3,se)-20,Yt=Math.pow(10,.1*Yt),Yt*=_e.numlines_l[Ne],gn>Yt&&(gn=Yt)}_e.ATH.cb_l[Ne]=gn,gn=-20+nt[Ne]*20/10,gn>6&&(gn=100),gn<-15&&(gn=-15),gn-=8,_e.minval_l[Ne]=Math.pow(10,gn/10)*_e.numlines_l[Ne]}for(_e.npart_s=kt(_e.numlines_s,_e.bo_s,_e.bm_s,nt,vt,_e.mld_s,_e.PSY.bo_s_weight,ht,pn.BLKSIZE_s,_e.scalefac_band.s,pn.BLKSIZE_s/384,pn.SBMAX_s),Fi(_e.npart_s<pn.CBANDS),_t=0,Ne=0;Ne<_e.npart_s;Ne++){var gn,ft=tt;nt[Ne]>=ke&&(ft=Ze*(nt[Ne]-ke)/(Re-ke)+tt*(Re-nt[Ne])/(Re-ke)),Qe[Ne]=Math.pow(10,ft/10),gn=Xne.MAX_VALUE;for(var _n=0;_n<_e.numlines_s[Ne];_n++,_t++){var Bt=ht*_t/(1e3*pn.BLKSIZE_s),Yt;Yt=this.ATHformula(Bt*1e3,se)-20,Yt=Math.pow(10,.1*Yt),Yt*=_e.numlines_s[Ne],gn>Yt&&(gn=Yt)}_e.ATH.cb_s[Ne]=gn,gn=-7+nt[Ne]*7/12,nt[Ne]>12&&(gn*=1+Math.log(1+gn)*3.1),nt[Ne]<12&&(gn*=1+Math.log(1-gn)*2.3),gn<-15&&(gn=-15),gn-=8,_e.minval_s[Ne]=Math.pow(10,gn/10)*_e.numlines_s[Ne]}_e.s3_ss=Ut(_e.s3ind_s,_e.npart_s,nt,vt,Qe,Le),V(),e.init_fft(_e),_e.decay=Math.exp(-1*t/(c*ht/192));{var Mt;Mt=g,se.exp_nspsytune&2&&(Mt=1),Math.abs(se.msfix)>0&&(Mt=se.msfix),se.msfix=Mt;for(var fn=0;fn<_e.npart_l;fn++)_e.s3ind[fn][1]>_e.npart_l-1&&(_e.s3ind[fn][1]=_e.npart_l-1)}var Bn=576*_e.mode_gr/ht;if(_e.ATH.decay=Math.pow(10,-12/10*Bn),_e.ATH.adjust=.01,_e.ATH.adjustLimit=1,Fi(_e.bo_l[pn.SBMAX_l-1]<=_e.npart_l),Fi(_e.bo_s[pn.SBMAX_s-1]<=_e.npart_s),se.ATHtype!=-1){var Bt,cn=se.out_samplerate/pn.BLKSIZE,In=0;for(Bt=0,Ne=0;Ne<pn.BLKSIZE/2;++Ne)Bt+=cn,_e.ATH.eql_w[Ne]=1/Math.pow(10,this.ATHformula(Bt,se)/10),In+=_e.ATH.eql_w[Ne];for(In=1/In,Ne=pn.BLKSIZE/2;--Ne>=0;)_e.ATH.eql_w[Ne]*=In}{for(var fn=_t=0;fn<_e.npart_s;++fn)for(Ne=0;Ne<_e.numlines_s[fn];++Ne)++_t;for(var fn=_t=0;fn<_e.npart_l;++fn)for(Ne=0;Ne<_e.numlines_l[fn];++Ne)++_t}for(_t=0,Ne=0;Ne<_e.npart_l;Ne++){var Bt=ht*(_t+_e.numlines_l[Ne]/2)/(1*pn.BLKSIZE);_e.mld_cb_l[Ne]=je(Bt),_t+=_e.numlines_l[Ne]}for(;Ne<pn.CBANDS;++Ne)_e.mld_cb_l[Ne]=1;for(_t=0,Ne=0;Ne<_e.npart_s;Ne++){var Bt=ht*(_t+_e.numlines_s[Ne]/2)/(1*pn.BLKSIZE_s);_e.mld_cb_s[Ne]=je(Bt),_t+=_e.numlines_s[Ne]}for(;Ne<pn.CBANDS;++Ne)_e.mld_cb_s[Ne]=1;return 0};function ge(se,_e){se<-.3&&(se=3410),se/=1e3,se=Math.max(.1,se);var Ne=3.64*Math.pow(se,-.8)-6.8*Math.exp(-.6*Math.pow(se-3.4,2))+6*Math.exp(-.15*Math.pow(se-8.7,2))+(.6+.04*_e)*.001*Math.pow(se,4);return Ne}this.ATHformula=function(se,_e){var Ne;switch(_e.ATHtype){case 0:Ne=ge(se,9);break;case 1:Ne=ge(se,-1);break;case 2:Ne=ge(se,0);break;case 3:Ne=ge(se,1)+6;break;case 4:Ne=ge(se,_e.ATHcurve);break;default:Ne=ge(se,0);break}return Ne}}var kot=Mot,Oot=KO;function Iot(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=Oot.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var Not=Iot,Pot=op(),h_e={};h_e.SFBMAX=Pot.SBMAX_s*3;var JU=h_e,d_e=Tc,Dot=d_e.new_float,TS=d_e.new_int,Q8=JU;function Lot(){this.xr=Dot(576),this.l3_enc=TS(576),this.scalefac=TS(Q8.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=TS(3),this.subblock_gain=TS(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=TS(Q8.SFBMAX),this.window=TS(Q8.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=TS(4),this.max_nonzero_coeff=0;var n=this;function e(r){return new Int32Array(r)}function t(r){return new Float32Array(r)}this.assign=function(r){n.xr=t(r.xr),n.l3_enc=e(r.l3_enc),n.scalefac=e(r.scalefac),n.xrpow_max=r.xrpow_max,n.part2_3_length=r.part2_3_length,n.big_values=r.big_values,n.count1=r.count1,n.global_gain=r.global_gain,n.scalefac_compress=r.scalefac_compress,n.block_type=r.block_type,n.mixed_block_flag=r.mixed_block_flag,n.table_select=e(r.table_select),n.subblock_gain=e(r.subblock_gain),n.region0_count=r.region0_count,n.region1_count=r.region1_count,n.preflag=r.preflag,n.scalefac_scale=r.scalefac_scale,n.count1table_select=r.count1table_select,n.part2_length=r.part2_length,n.sfb_lmax=r.sfb_lmax,n.sfb_smin=r.sfb_smin,n.psy_lmax=r.psy_lmax,n.sfbmax=r.sfbmax,n.psymax=r.psymax,n.sfbdivide=r.sfbdivide,n.width=e(r.width),n.window=e(r.window),n.count1bits=r.count1bits,n.sfb_partition_table=r.sfb_partition_table.slice(0),n.slen=e(r.slen),n.max_nonzero_coeff=r.max_nonzero_coeff}}var vV=Lot,Uot=Tc,Kne=Uot.new_int,Bot=vV;function Fot(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[Kne(4),Kne(4)];for(var n=0;n<2;n++)for(var e=0;e<2;e++)this.tt[n][e]=new Bot}var zot=Fot,p_e=Tc,cN=p_e.System,uN=p_e.new_int,fN=op();function jot(n,e,t,r){this.l=uN(1+fN.SBMAX_l),this.s=uN(1+fN.SBMAX_s),this.psfb21=uN(1+fN.PSFB21),this.psfb12=uN(1+fN.PSFB12);var i=this.l,s=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],cN.arraycopy(this.arrL,0,i,0,Math.min(this.arrL.length,this.l.length)),cN.arraycopy(this.arrS,0,s,0,Math.min(this.arrS.length,this.s.length)),cN.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),cN.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var m_e=jot,yV=Tc,J8=yV.new_float,Hot=yV.new_float_n,qot=yV.new_int,Zne=op();function Vot(){this.last_en_subshort=Hot([4,9]),this.lastAttacks=qot(4),this.pefirbuf=J8(19),this.longfact=J8(Zne.SBMAX_l),this.shortfact=J8(Zne.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var Got=Vot;function $ot(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var Wot=$ot,sR=Tc,Yot=sR.new_byte,Xot=sR.new_double,p0=sR.new_float,wS=sR.new_float_n,c_=sR.new_int,hN=sR.new_int_n,Kot=zot,Zot=m_e,Qot=Got,Jot=Wot,Qne=u_e(),fu=op(),elt=JU;eb.MFSIZE=3*1152+fu.ENCDELAY-fu.MDCTDELAY;eb.MAX_HEADER_BUF=256;eb.MAX_BITS_PER_CHANNEL=4095;eb.MAX_BITS_PER_GRANULE=7680;eb.BPC=320;function eb(){var n=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=wS([2,eb.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new Kot,this.ms_ratio=p0(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=c_(2),this.CurrentStep=c_(2),this.masking_lower=0,this.bv_scf=c_(576),this.pseudohalf=c_(elt.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*eb.BPC+1),this.itime=Xot(2),this.sideinfo_len=0,this.sb_sample=wS([2,2,18,fu.SBLIMIT]),this.amp_filter=p0(32);function e(){this.write_timing=0,this.ptr=0,this.buf=Yot(n)}this.header=new Array(eb.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new Zot,this.minval_l=p0(fu.CBANDS),this.minval_s=p0(fu.CBANDS),this.nb_1=wS([4,fu.CBANDS]),this.nb_2=wS([4,fu.CBANDS]),this.nb_s1=wS([4,fu.CBANDS]),this.nb_s2=wS([4,fu.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=p0(4),this.loudness_sq=wS([2,2]),this.loudness_sq_save=p0(2),this.mld_l=p0(fu.SBMAX_l),this.mld_s=p0(fu.SBMAX_s),this.bm_l=c_(fu.SBMAX_l),this.bo_l=c_(fu.SBMAX_l),this.bm_s=c_(fu.SBMAX_s),this.bo_s=c_(fu.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=hN([fu.CBANDS,2]),this.s3ind_s=hN([fu.CBANDS,2]),this.numlines_s=c_(fu.CBANDS),this.numlines_l=c_(fu.CBANDS),this.rnumlines_l=p0(fu.CBANDS),this.mld_cb_l=p0(fu.CBANDS),this.mld_cb_s=p0(fu.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=p0(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=c_(2),this.nsPsy=new Qot,this.VBR_seek_table=new Jot,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=hN([16,5]),this.bitrate_blockType_Hist=hN([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new Qne;for(var t=0;t<this.thm.length;t++)this.thm[t]=new Qne;for(var t=0;t<this.header.length;t++)this.header[t]=new e}var e5=eb,tlt=Tc,RS=tlt.new_float,AS=op();function nlt(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=RS(AS.SBMAX_l),this.s=RS(AS.SBMAX_s),this.psfb21=RS(AS.PSFB21),this.psfb12=RS(AS.PSFB12),this.cb_l=RS(AS.CBANDS),this.cb_s=RS(AS.CBANDS),this.eql_w=RS(AS.BLKSIZE/2)}var rlt=nlt,g_e=Tc,mm=g_e.System,Jne=g_e.Arrays;yu.STEPS_per_dB=100;yu.MAX_dB=120;yu.GAIN_NOT_ENOUGH_SAMPLES=-24601;yu.GAIN_ANALYSIS_ERROR=0;yu.GAIN_ANALYSIS_OK=1;yu.INIT_GAIN_ANALYSIS_ERROR=0;yu.INIT_GAIN_ANALYSIS_OK=1;yu.YULE_ORDER=10;yu.MAX_ORDER=yu.YULE_ORDER;yu.MAX_SAMP_FREQ=48e3;yu.RMS_WINDOW_TIME_NUMERATOR=1;yu.RMS_WINDOW_TIME_DENOMINATOR=20;yu.MAX_SAMPLES_PER_WINDOW=yu.MAX_SAMP_FREQ*yu.RMS_WINDOW_TIME_NUMERATOR/yu.RMS_WINDOW_TIME_DENOMINATOR+1;function yu(){var n=64.82,e=.95,t=yu.RMS_WINDOW_TIME_NUMERATOR,r=yu.RMS_WINDOW_TIME_DENOMINATOR,i=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],s=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function a(f,d,g,p,_,y){for(;_--!=0;)g[p]=1e-10+f[d+0]*y[0]-g[p-1]*y[1]+f[d-1]*y[2]-g[p-2]*y[3]+f[d-2]*y[4]-g[p-3]*y[5]+f[d-3]*y[6]-g[p-4]*y[7]+f[d-4]*y[8]-g[p-5]*y[9]+f[d-5]*y[10]-g[p-6]*y[11]+f[d-6]*y[12]-g[p-7]*y[13]+f[d-7]*y[14]-g[p-8]*y[15]+f[d-8]*y[16]-g[p-9]*y[17]+f[d-9]*y[18]-g[p-10]*y[19]+f[d-10]*y[20],++p,++d}function o(f,d,g,p,_,y){for(;_--!=0;)g[p]=f[d+0]*y[0]-g[p-1]*y[1]+f[d-1]*y[2]-g[p-2]*y[3]+f[d-2]*y[4],++p,++d}function l(f,d){for(var g=0;g<MAX_ORDER;g++)f.linprebuf[g]=f.lstepbuf[g]=f.loutbuf[g]=f.rinprebuf[g]=f.rstepbuf[g]=f.routbuf[g]=0;switch(0|d){case 48e3:f.reqindex=0;break;case 44100:f.reqindex=1;break;case 32e3:f.reqindex=2;break;case 24e3:f.reqindex=3;break;case 22050:f.reqindex=4;break;case 16e3:f.reqindex=5;break;case 12e3:f.reqindex=6;break;case 11025:f.reqindex=7;break;case 8e3:f.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return f.sampleWindow=0|(d*t+r-1)/r,f.lsum=0,f.rsum=0,f.totsamp=0,Jne.ill(f.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(f,d){return l(f,d)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(f.linpre=MAX_ORDER,f.rinpre=MAX_ORDER,f.lstep=MAX_ORDER,f.rstep=MAX_ORDER,f.lout=MAX_ORDER,f.rout=MAX_ORDER,Jne.fill(f.B,0),INIT_GAIN_ANALYSIS_OK)};function c(f){return f*f}this.AnalyzeSamples=function(f,d,g,p,_,y,v){var x,E,M,O,N,I,D;if(y==0)return GAIN_ANALYSIS_OK;switch(D=0,N=y,v){case 1:p=d,_=g;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(y<MAX_ORDER?(mm.arraycopy(d,g,f.linprebuf,MAX_ORDER,y),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER,y)):(mm.arraycopy(d,g,f.linprebuf,MAX_ORDER,MAX_ORDER),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER,MAX_ORDER));N>0;){I=N>f.sampleWindow-f.totsamp?f.sampleWindow-f.totsamp:N,D<MAX_ORDER?(x=f.linpre+D,E=f.linprebuf,M=f.rinpre+D,O=f.rinprebuf,I>MAX_ORDER-D&&(I=MAX_ORDER-D)):(x=g+D,E=d,M=_+D,O=p),a(E,x,f.lstepbuf,f.lstep+f.totsamp,I,i[f.reqindex]),a(O,M,f.rstepbuf,f.rstep+f.totsamp,I,i[f.reqindex]),o(f.lstepbuf,f.lstep+f.totsamp,f.loutbuf,f.lout+f.totsamp,I,s[f.reqindex]),o(f.rstepbuf,f.rstep+f.totsamp,f.routbuf,f.rout+f.totsamp,I,s[f.reqindex]),x=f.lout+f.totsamp,E=f.loutbuf,M=f.rout+f.totsamp,O=f.routbuf;for(var V=I%8;V--!=0;)f.lsum+=c(E[x++]),f.rsum+=c(O[M++]);for(V=I/8;V--!=0;)f.lsum+=c(E[x+0])+c(E[x+1])+c(E[x+2])+c(E[x+3])+c(E[x+4])+c(E[x+5])+c(E[x+6])+c(E[x+7]),x+=8,f.rsum+=c(O[M+0])+c(O[M+1])+c(O[M+2])+c(O[M+3])+c(O[M+4])+c(O[M+5])+c(O[M+6])+c(O[M+7]),M+=8;if(N-=I,D+=I,f.totsamp+=I,f.totsamp==f.sampleWindow){var G=yu.STEPS_per_dB*10*Math.log10((f.lsum+f.rsum)/f.totsamp*.5+1e-37),Q=G<=0?0:0|G;Q>=f.A.length&&(Q=f.A.length-1),f.A[Q]++,f.lsum=f.rsum=0,mm.arraycopy(f.loutbuf,f.totsamp,f.loutbuf,0,MAX_ORDER),mm.arraycopy(f.routbuf,f.totsamp,f.routbuf,0,MAX_ORDER),mm.arraycopy(f.lstepbuf,f.totsamp,f.lstepbuf,0,MAX_ORDER),mm.arraycopy(f.rstepbuf,f.totsamp,f.rstepbuf,0,MAX_ORDER),f.totsamp=0}if(f.totsamp>f.sampleWindow)return GAIN_ANALYSIS_ERROR}return y<MAX_ORDER?(mm.arraycopy(f.linprebuf,y,f.linprebuf,0,MAX_ORDER-y),mm.arraycopy(f.rinprebuf,y,f.rinprebuf,0,MAX_ORDER-y),mm.arraycopy(d,g,f.linprebuf,MAX_ORDER-y,y),mm.arraycopy(p,_,f.rinprebuf,MAX_ORDER-y,y)):(mm.arraycopy(d,g+y-MAX_ORDER,f.linprebuf,0,MAX_ORDER),mm.arraycopy(p,_+y-MAX_ORDER,f.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function u(f,d){var g,p=0;for(g=0;g<d;g++)p+=f[g];if(p==0)return GAIN_NOT_ENOUGH_SAMPLES;var _=0|Math.ceil(p*(1-e));for(g=d;g-- >0&&!((_-=f[g])<=0););return n-g/yu.STEPS_per_dB}this.GetTitleGain=function(f){for(var d=u(f.A,f.A.length),g=0;g<f.A.length;g++)f.B[g]+=f.A[g],f.A[g]=0;for(var g=0;g<MAX_ORDER;g++)f.linprebuf[g]=f.lstepbuf[g]=f.loutbuf[g]=f.rinprebuf[g]=f.rstepbuf[g]=f.routbuf[g]=0;return f.totsamp=0,f.lsum=f.rsum=0,d}}var __e=yu,v_e=Tc,Xx=v_e.new_float,ere=v_e.new_int,gm=__e;function ilt(){this.linprebuf=Xx(gm.MAX_ORDER*2),this.linpre=0,this.lstepbuf=Xx(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.lstep=0,this.loutbuf=Xx(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.lout=0,this.rinprebuf=Xx(gm.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=Xx(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.rstep=0,this.routbuf=Xx(gm.MAX_SAMPLES_PER_WINDOW+gm.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=ere(0|gm.STEPS_per_dB*gm.MAX_dB),this.B=ere(0|gm.STEPS_per_dB*gm.MAX_dB)}var slt=ilt;function alt(n){this.bits=n}var y_e=alt,bV=Tc,tre=bV.new_float,olt=bV.new_int,nre=bV.assert,llt=y_e,rre=op(),clt=JU,ult=e5;function flt(n){var e=n;this.quantize=e,this.iteration_loop=function(t,r,i,s){var a=t.internal_flags,o=tre(clt.SFBMAX),l=tre(576),c=olt(2),u=0,f,d=a.l3_side,g=new llt(u);this.quantize.rv.ResvFrameBegin(t,g),u=g.bits;for(var p=0;p<a.mode_gr;p++){f=this.quantize.qupvt.on_pe(t,r,c,u,p,p),a.mode_ext==rre.MPG_MD_MS_LR&&(this.quantize.ms_convert(a.l3_side,p),this.quantize.qupvt.reduce_side(c,i[p],u,f));for(var _=0;_<a.channels_out;_++){var y,v,x=d.tt[p][_];x.block_type!=rre.SHORT_TYPE?(y=0,v=a.PSY.mask_adjust-y):(y=0,v=a.PSY.mask_adjust_short-y),a.masking_lower=Math.pow(10,v*.1),this.quantize.init_outer_loop(a,x),this.quantize.init_xrpow(a,x,l)&&(this.quantize.qupvt.calc_xmin(t,s[p][_],x,o),this.quantize.outer_loop(t,x,o,l,_,c[_])),this.quantize.iteration_finish_one(a,p,_),nre(x.part2_3_length<=ult.MAX_BITS_PER_CHANNEL),nre(x.part2_3_length<=c[_])}}this.quantize.rv.ResvFrameEnd(a,u)}}var hlt=flt;function Ca(n,e,t,r){this.xlen=n,this.linmax=e,this.table=t,this.hlen=r}var kn={};kn.t1HB=[1,1,1,0];kn.t2HB=[1,2,1,3,1,1,3,2,0];kn.t3HB=[3,2,1,1,1,1,3,2,0];kn.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];kn.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];kn.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];kn.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];kn.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];kn.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];kn.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];kn.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];kn.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];kn.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];kn.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];kn.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];kn.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];kn.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];kn.t1l=[1,4,3,5];kn.t2l=[1,4,7,4,5,7,6,7,8];kn.t3l=[2,3,7,4,4,7,6,7,8];kn.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];kn.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];kn.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];kn.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];kn.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];kn.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];kn.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];kn.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];kn.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];kn.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];kn.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];kn.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];kn.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];kn.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10];kn.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8];kn.ht=[new Ca(0,0,null,null),new Ca(2,0,kn.t1HB,kn.t1l),new Ca(3,0,kn.t2HB,kn.t2l),new Ca(3,0,kn.t3HB,kn.t3l),new Ca(0,0,null,null),new Ca(4,0,kn.t5HB,kn.t5l),new Ca(4,0,kn.t6HB,kn.t6l),new Ca(6,0,kn.t7HB,kn.t7l),new Ca(6,0,kn.t8HB,kn.t8l),new Ca(6,0,kn.t9HB,kn.t9l),new Ca(8,0,kn.t10HB,kn.t10l),new Ca(8,0,kn.t11HB,kn.t11l),new Ca(8,0,kn.t12HB,kn.t12l),new Ca(16,0,kn.t13HB,kn.t13l),new Ca(0,0,null,kn.t16_5l),new Ca(16,0,kn.t15HB,kn.t15l),new Ca(1,1,kn.t16HB,kn.t16l),new Ca(2,3,kn.t16HB,kn.t16l),new Ca(3,7,kn.t16HB,kn.t16l),new Ca(4,15,kn.t16HB,kn.t16l),new Ca(6,63,kn.t16HB,kn.t16l),new Ca(8,255,kn.t16HB,kn.t16l),new Ca(10,1023,kn.t16HB,kn.t16l),new Ca(13,8191,kn.t16HB,kn.t16l),new Ca(4,15,kn.t24HB,kn.t24l),new Ca(5,31,kn.t24HB,kn.t24l),new Ca(6,63,kn.t24HB,kn.t24l),new Ca(7,127,kn.t24HB,kn.t24l),new Ca(8,255,kn.t24HB,kn.t24l),new Ca(9,511,kn.t24HB,kn.t24l),new Ca(11,2047,kn.t24HB,kn.t24l),new Ca(13,8191,kn.t24HB,kn.t24l),new Ca(0,0,kn.t32HB,kn.t32l),new Ca(0,0,kn.t33HB,kn.t33l)];kn.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];kn.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];kn.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];kn.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];kn.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];kn.scfsi_band=[0,6,11,16,21];var SV=kn,eF,ire;function b_e(){if(ire)return eF;ire=1;var n=m_e,e=Tc,t=e.VbrMode,r=e.Float,i=e.Util,s=e.new_float,a=e.new_int,o=e.assert,l=op(),c=y_e,u=e5;f.Q_MAX=257,f.Q_MAX2=116,f.LARGE_BITS=1e5,f.IXMAX_VAL=8206;function f(){var d=EV(),g=null,p=null,_=null;this.setModules=function(J,W,q){g=J,p=W,_=q};function y(J){return o(0<=J+f.Q_MAX2&&J<f.Q_MAX),D[J+f.Q_MAX2]}this.IPOW20=function(J){return o(0<=J&&J<f.Q_MAX),V[J]};var v=2220446049250313e-31,x=f.IXMAX_VAL,E=x+2,M=f.Q_MAX,O=f.Q_MAX2;f.LARGE_BITS;var N=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var I=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=I,this.sfBandIndex=[new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var D=s(M+O+1),V=s(M),G=s(E),Q=s(E);this.adj43=Q;function B(J,W){var q=_.ATHformula(W,J);return q-=N,q=Math.pow(10,q/10+J.ATHlower),q}function $(J){for(var W=J.internal_flags.ATH.l,q=J.internal_flags.ATH.psfb21,Y=J.internal_flags.ATH.s,ae=J.internal_flags.ATH.psfb12,Z=J.internal_flags,K=J.out_samplerate,ne=0;ne<l.SBMAX_l;ne++){var le=Z.scalefac_band.l[ne],ce=Z.scalefac_band.l[ne+1];W[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/1152,qe=B(J,Me);W[ne]=Math.min(W[ne],qe)}}for(var ne=0;ne<l.PSFB21;ne++){var le=Z.scalefac_band.psfb21[ne],ce=Z.scalefac_band.psfb21[ne+1];q[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/1152,qe=B(J,Me);q[ne]=Math.min(q[ne],qe)}}for(var ne=0;ne<l.SBMAX_s;ne++){var le=Z.scalefac_band.s[ne],ce=Z.scalefac_band.s[ne+1];Y[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/384,qe=B(J,Me);Y[ne]=Math.min(Y[ne],qe)}Y[ne]*=Z.scalefac_band.s[ne+1]-Z.scalefac_band.s[ne]}for(var ne=0;ne<l.PSFB12;ne++){var le=Z.scalefac_band.psfb12[ne],ce=Z.scalefac_band.psfb12[ne+1];ae[ne]=r.MAX_VALUE;for(var de=le;de<ce;de++){var Me=de*K/384,qe=B(J,Me);ae[ne]=Math.min(ae[ne],qe)}ae[ne]*=Z.scalefac_band.s[13]-Z.scalefac_band.s[12]}if(J.noATH){for(var ne=0;ne<l.SBMAX_l;ne++)W[ne]=1e-20;for(var ne=0;ne<l.PSFB21;ne++)q[ne]=1e-20;for(var ne=0;ne<l.SBMAX_s;ne++)Y[ne]=1e-20;for(var ne=0;ne<l.PSFB12;ne++)ae[ne]=1e-20}Z.ATH.floor=10*Math.log10(B(J,-1))}this.iteration_init=function(J){var W=J.internal_flags,q=W.l3_side,Y;if(W.iteration_init_init==0){for(W.iteration_init_init=1,q.main_data_begin=0,$(J),G[0]=0,Y=1;Y<E;Y++)G[Y]=Math.pow(Y,4/3);for(Y=0;Y<E-1;Y++)Q[Y]=Y+1-Math.pow(.5*(G[Y]+G[Y+1]),.75);for(Q[Y]=.5,Y=0;Y<M;Y++)V[Y]=Math.pow(2,(Y-210)*-.1875);for(Y=0;Y<=M+O;Y++)D[Y]=Math.pow(2,(Y-210-O)*.25);g.huffman_init(W);{var ae,Z,K,ne;for(Y=J.exp_nspsytune>>2&63,Y>=32&&(Y-=64),ae=Math.pow(10,Y/4/10),Y=J.exp_nspsytune>>8&63,Y>=32&&(Y-=64),Z=Math.pow(10,Y/4/10),Y=J.exp_nspsytune>>14&63,Y>=32&&(Y-=64),K=Math.pow(10,Y/4/10),Y=J.exp_nspsytune>>20&63,Y>=32&&(Y-=64),ne=K*Math.pow(10,Y/4/10),Y=0;Y<l.SBMAX_l;Y++){var le;Y<=6?le=ae:Y<=13?le=Z:Y<=20?le=K:le=ne,W.nsPsy.longfact[Y]=le}for(Y=0;Y<l.SBMAX_s;Y++){var le;Y<=5?le=ae:Y<=10?le=Z:Y<=11?le=K:le=ne,W.nsPsy.shortfact[Y]=le}}}},this.on_pe=function(J,W,q,Y,ae,Z){var K=J.internal_flags,ne=0,le,ce=a(2),de,Me=new c(ne),qe=p.ResvMaxBits(J,Y,Me,Z);ne=Me.bits;var Pe=ne+qe;for(Pe>u.MAX_BITS_PER_GRANULE&&(Pe=u.MAX_BITS_PER_GRANULE),le=0,de=0;de<K.channels_out;++de)q[de]=Math.min(u.MAX_BITS_PER_CHANNEL,ne/K.channels_out),ce[de]=0|q[de]*W[ae][de]/700-q[de],ce[de]>Y*3/4&&(ce[de]=Y*3/4),ce[de]<0&&(ce[de]=0),ce[de]+q[de]>u.MAX_BITS_PER_CHANNEL&&(ce[de]=Math.max(0,u.MAX_BITS_PER_CHANNEL-q[de])),le+=ce[de];if(le>qe)for(de=0;de<K.channels_out;++de)ce[de]=qe*ce[de]/le;for(de=0;de<K.channels_out;++de)q[de]+=ce[de],qe-=ce[de];for(le=0,de=0;de<K.channels_out;++de)le+=q[de];if(le>u.MAX_BITS_PER_GRANULE){var Ce=0;for(de=0;de<K.channels_out;++de)q[de]*=u.MAX_BITS_PER_GRANULE,q[de]/=le,Ce+=q[de]}return Pe},this.reduce_side=function(J,W,q,Y){o(J[0]+J[1]<=u.MAX_BITS_PER_GRANULE);var ae=.33*(.5-W)/.5;ae<0&&(ae=0),ae>.5&&(ae=.5);var Z=0|ae*.5*(J[0]+J[1]);Z>u.MAX_BITS_PER_CHANNEL-J[0]&&(Z=u.MAX_BITS_PER_CHANNEL-J[0]),Z<0&&(Z=0),J[1]>=125&&(J[1]-Z>125?(J[0]<q&&(J[0]+=Z),J[1]-=Z):(J[0]+=J[1]-125,J[1]=125)),Z=J[0]+J[1],Z>Y&&(J[0]=Y*J[0]/Z,J[1]=Y*J[1]/Z),o(J[0]<=u.MAX_BITS_PER_CHANNEL),o(J[1]<=u.MAX_BITS_PER_CHANNEL),o(J[0]+J[1]<=u.MAX_BITS_PER_GRANULE)},this.athAdjust=function(J,W,q){var Y=90.30873362,ae=94.82444863,Z=i.FAST_LOG10_X(W,10),K=J*J,ne=0;return Z-=q,K>1e-20&&(ne=1+i.FAST_LOG10_X(K,10/Y)),ne<0&&(ne=0),Z*=ne,Z+=q+Y-ae,Math.pow(10,.1*Z)},this.calc_xmin=function(J,W,q,Y){var ae=0,Z=J.internal_flags,K,ne=0,le=0,ce=Z.ATH,de=q.xr,Me=J.VBR==t.vbr_mtrh?1:0,qe=Z.masking_lower;for((J.VBR==t.vbr_mtrh||J.VBR==t.vbr_mt)&&(qe=1),K=0;K<q.psy_lmax;K++){var Pe,Ce,Xe,$e,at,pt;J.VBR==t.vbr_rh||J.VBR==t.vbr_mtrh?Ce=athAdjust(ce.adjust,ce.l[K],ce.floor):Ce=ce.adjust*ce.l[K],at=q.width[K],Xe=Ce/at,$e=v,pt=at>>1,Pe=0;do{var oe,Ue;oe=de[ne]*de[ne],Pe+=oe,$e+=oe<Xe?oe:Xe,ne++,Ue=de[ne]*de[ne],Pe+=Ue,$e+=Ue<Xe?Ue:Xe,ne++}while(--pt>0);if(Pe>Ce&&le++,K==l.SBPSY_l){var Ge=Ce*Z.nsPsy.longfact[K];$e<Ge&&($e=Ge)}if(Me!=0&&(Ce=$e),!J.ATHonly){var ze=W.en.l[K];if(ze>0){var Ge;Ge=Pe*W.thm.l[K]*qe/ze,Me!=0&&(Ge*=Z.nsPsy.longfact[K]),Ce<Ge&&(Ce=Ge)}}Me!=0?Y[ae++]=Ce:Y[ae++]=Ce*Z.nsPsy.longfact[K]}var Be=575;if(q.block_type!=l.SHORT_TYPE)for(var me=576;me--!=0&&d.EQ(de[me],0);)Be=me;q.max_nonzero_coeff=Be;for(var Se=q.sfb_smin;K<q.psymax;Se++,K+=3){var at,Ie,be;for(J.VBR==t.vbr_rh||J.VBR==t.vbr_mtrh?be=athAdjust(ce.adjust,ce.s[Se],ce.floor):be=ce.adjust*ce.s[Se],at=q.width[K],Ie=0;Ie<3;Ie++){var Pe=0,Ce,Xe,$e,pt=at>>1;Xe=be/at,$e=v;do{var oe,Ue;oe=de[ne]*de[ne],Pe+=oe,$e+=oe<Xe?oe:Xe,ne++,Ue=de[ne]*de[ne],Pe+=Ue,$e+=Ue<Xe?Ue:Xe,ne++}while(--pt>0);if(Pe>be&&le++,Se==l.SBPSY_s){var Ge=be*Z.nsPsy.shortfact[Se];$e<Ge&&($e=Ge)}if(Me!=0?Ce=$e:Ce=be,!J.ATHonly&&!J.ATHshort){var ze=W.en.s[Se][Ie];if(ze>0){var Ge;Ge=Pe*W.thm.s[Se][Ie]*qe/ze,Me!=0&&(Ge*=Z.nsPsy.shortfact[Se]),Ce<Ge&&(Ce=Ge)}}Me!=0?Y[ae++]=Ce:Y[ae++]=Ce*Z.nsPsy.shortfact[Se]}J.useTemporal&&(Y[ae-3]>Y[ae-3+1]&&(Y[ae-3+1]+=(Y[ae-3]-Y[ae-3+1])*Z.decay),Y[ae-3+1]>Y[ae-3+2]&&(Y[ae-3+2]+=(Y[ae-3+1]-Y[ae-3+2])*Z.decay))}return le};function U(J){this.s=J}this.calc_noise_core=function(J,W,q,Y){var ae=0,Z=W.s,K=J.l3_enc;if(Z>J.count1)for(;q--!=0;){var ne;ne=J.xr[Z],Z++,ae+=ne*ne,ne=J.xr[Z],Z++,ae+=ne*ne}else if(Z>J.big_values){var le=s(2);for(le[0]=0,le[1]=Y;q--!=0;){var ne;ne=Math.abs(J.xr[Z])-le[K[Z]],Z++,ae+=ne*ne,ne=Math.abs(J.xr[Z])-le[K[Z]],Z++,ae+=ne*ne}}else for(;q--!=0;){var ne;ne=Math.abs(J.xr[Z])-G[K[Z]]*Y,Z++,ae+=ne*ne,ne=Math.abs(J.xr[Z])-G[K[Z]]*Y,Z++,ae+=ne*ne}return W.s=Z,ae},this.calc_noise=function(J,W,q,Y,ae){var Z=0,K=0,ne,le,ce=0,de=0,Me=0,qe=-20,Pe=0,Ce=J.scalefac,Xe=0;for(Y.over_SSD=0,ne=0;ne<J.psymax;ne++){var $e=J.global_gain-(Ce[Xe++]+(J.preflag!=0?I[ne]:0)<<J.scalefac_scale+1)-J.subblock_gain[J.window[ne]]*8,at=0;if(ae!=null&&ae.step[ne]==$e)at=ae.noise[ne],Pe+=J.width[ne],q[Z++]=at/W[K++],at=ae.noise_log[ne];else{var pt=y($e);if(le=J.width[ne]>>1,Pe+J.width[ne]>J.max_nonzero_coeff){var oe;oe=J.max_nonzero_coeff-Pe+1,oe>0?le=oe>>1:le=0}var Ue=new U(Pe);at=this.calc_noise_core(J,Ue,le,pt),Pe=Ue.s,ae!=null&&(ae.step[ne]=$e,ae.noise[ne]=at),at=q[Z++]=at/W[K++],at=i.FAST_LOG10(Math.max(at,1e-20)),ae!=null&&(ae.noise_log[ne]=at)}if(ae!=null&&(ae.global_gain=J.global_gain),Me+=at,at>0){var Ge;Ge=Math.max(0|at*10+.5,1),Y.over_SSD+=Ge*Ge,ce++,de+=at}qe=Math.max(qe,at)}return Y.over_count=ce,Y.tot_noise=Me,Y.over_noise=de,Y.max_noise=qe,ce},this.set_pinfo=function(J,W,q,Y,ae){var Z=J.internal_flags,K,ne,le,ce,de,Me=W.scalefac_scale==0?.5:1,qe=W.scalefac,Pe=s(L3Side.SFBMAX),Ce=s(L3Side.SFBMAX),Xe=new CalcNoiseResult;calc_xmin(J,q,W,Pe),calc_noise(W,Pe,Ce,Xe,null);var $e=0;for(ne=W.sfb_lmax,W.block_type!=l.SHORT_TYPE&&W.mixed_block_flag==0&&(ne=22),K=0;K<ne;K++){var at=Z.scalefac_band.l[K],pt=Z.scalefac_band.l[K+1],oe=pt-at;for(ce=0;$e<pt;$e++)ce+=W.xr[$e]*W.xr[$e];ce/=oe,de=1e15,Z.pinfo.en[Y][ae][K]=de*ce,Z.pinfo.xfsf[Y][ae][K]=de*Pe[K]*Ce[K]/oe,q.en.l[K]>0&&!J.ATHonly?ce=ce/q.en.l[K]:ce=0,Z.pinfo.thr[Y][ae][K]=de*Math.max(ce*q.thm.l[K],Z.ATH.l[K]),Z.pinfo.LAMEsfb[Y][ae][K]=0,W.preflag!=0&&K>=11&&(Z.pinfo.LAMEsfb[Y][ae][K]=-Me*I[K]),K<l.SBPSY_l&&(o(qe[K]>=0),Z.pinfo.LAMEsfb[Y][ae][K]-=Me*qe[K])}if(W.block_type==l.SHORT_TYPE)for(ne=K,K=W.sfb_smin;K<l.SBMAX_s;K++)for(var at=Z.scalefac_band.s[K],pt=Z.scalefac_band.s[K+1],oe=pt-at,Ue=0;Ue<3;Ue++){for(ce=0,le=at;le<pt;le++)ce+=W.xr[$e]*W.xr[$e],$e++;ce=Math.max(ce/oe,1e-20),de=1e15,Z.pinfo.en_s[Y][ae][3*K+Ue]=de*ce,Z.pinfo.xfsf_s[Y][ae][3*K+Ue]=de*Pe[ne]*Ce[ne]/oe,q.en.s[K][Ue]>0?ce=ce/q.en.s[K][Ue]:ce=0,(J.ATHonly||J.ATHshort)&&(ce=0),Z.pinfo.thr_s[Y][ae][3*K+Ue]=de*Math.max(ce*q.thm.s[K][Ue],Z.ATH.s[K]),Z.pinfo.LAMEsfb_s[Y][ae][3*K+Ue]=-2*W.subblock_gain[Ue],K<l.SBPSY_s&&(Z.pinfo.LAMEsfb_s[Y][ae][3*K+Ue]-=Me*qe[ne]),ne++}Z.pinfo.LAMEqss[Y][ae]=W.global_gain,Z.pinfo.LAMEmainbits[Y][ae]=W.part2_3_length+W.part2_length,Z.pinfo.LAMEsfbits[Y][ae]=W.part2_length,Z.pinfo.over[Y][ae]=Xe.over_count,Z.pinfo.max_noise[Y][ae]=Xe.max_noise*10,Z.pinfo.over_noise[Y][ae]=Xe.over_noise*10,Z.pinfo.tot_noise[Y][ae]=Xe.tot_noise*10,Z.pinfo.over_SSD[Y][ae]=Xe.over_SSD}}return eF=f,eF}var tF,sre;function S_e(){if(sre)return tF;sre=1;var n=Tc,e=n.System,t=n.Arrays,r=n.new_int,i=n.assert,s=op(),a=SV,o=vV,l=b_e();function c(){var u=null;this.qupvt=null,this.setModules=function(Z){this.qupvt=Z,u=Z};function f(Z){this.bits=0|Z}var d=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function g(Z,K,ne,le,ce,de){var Me=.5946/K;for(Z=Z>>1;Z--!=0;)ce[de++]=Me>ne[le++]?0:1,ce[de++]=Me>ne[le++]?0:1}function p(Z,K,ne,le,ce,de){Z=Z>>1;var Me=Z%2;for(Z=Z>>1;Z--!=0;){var qe,Pe,Ce,Xe,$e,at,pt,oe;qe=ne[le++]*K,Pe=ne[le++]*K,$e=0|qe,Ce=ne[le++]*K,at=0|Pe,Xe=ne[le++]*K,pt=0|Ce,qe+=u.adj43[$e],oe=0|Xe,Pe+=u.adj43[at],ce[de++]=0|qe,Ce+=u.adj43[pt],ce[de++]=0|Pe,Xe+=u.adj43[oe],ce[de++]=0|Ce,ce[de++]=0|Xe}if(Me!=0){var qe,Pe,$e,at;qe=ne[le++]*K,Pe=ne[le++]*K,$e=0|qe,at=0|Pe,qe+=u.adj43[$e],Pe+=u.adj43[at],ce[de++]=0|qe,ce[de++]=0|Pe}}function _(Z,K,ne,le,ce){var de,Me,qe=0,Pe,Ce=0,Xe=0,$e=0,at=K,pt=0,oe=at,Ue=0,Ge=Z,ze=0;for(Pe=ce!=null&&le.global_gain==ce.global_gain,le.block_type==s.SHORT_TYPE?Me=38:Me=21,de=0;de<=Me;de++){var Be=-1;if((Pe||le.block_type==s.NORM_TYPE)&&(Be=le.global_gain-(le.scalefac[de]+(le.preflag!=0?u.pretab[de]:0)<<le.scalefac_scale+1)-le.subblock_gain[le.window[de]]*8),i(le.width[de]>=0),Pe&&ce.step[de]==Be)Ce!=0&&(p(Ce,ne,Ge,ze,oe,Ue),Ce=0),Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0);else{var me=le.width[de];if(qe+le.width[de]>le.max_nonzero_coeff){var Se;Se=le.max_nonzero_coeff-qe+1,t.fill(K,le.max_nonzero_coeff,576,0),me=Se,me<0&&(me=0),de=Me+1}if(Ce==0&&Xe==0&&(oe=at,Ue=pt,Ge=Z,ze=$e),ce!=null&&ce.sfb_count1>0&&de>=ce.sfb_count1&&ce.step[de]>0&&Be>=ce.step[de]?(Ce!=0&&(p(Ce,ne,Ge,ze,oe,Ue),Ce=0,oe=at,Ue=pt,Ge=Z,ze=$e),Xe+=me):(Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0,oe=at,Ue=pt,Ge=Z,ze=$e),Ce+=me),me<=0){Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0),Ce!=0&&(p(Ce,ne,Ge,ze,oe,Ue),Ce=0);break}}de<=Me&&(pt+=le.width[de],$e+=le.width[de],qe+=le.width[de])}Ce!=0&&(p(Ce,ne,Ge,ze,oe,Ue),Ce=0),Xe!=0&&(g(Xe,ne,Ge,ze,oe,Ue),Xe=0)}function y(Z,K,ne){var le=0,ce=0;do{var de=Z[K++],Me=Z[K++];le<de&&(le=de),ce<Me&&(ce=Me)}while(K<ne);return le<ce&&(le=ce),le}function v(Z,K,ne,le,ce,de){var Me=a.ht[le].xlen*65536+a.ht[ce].xlen,qe=0,Pe;do{var Ce=Z[K++],Xe=Z[K++];Ce!=0&&(Ce>14&&(Ce=15,qe+=Me),Ce*=16),Xe!=0&&(Xe>14&&(Xe=15,qe+=Me),Ce+=Xe),qe+=a.largetbl[Ce]}while(K<ne);return Pe=qe&65535,qe>>=16,qe>Pe&&(qe=Pe,le=ce),de.bits+=qe,le}function x(Z,K,ne,le){var ce=0,de=a.ht[1].hlen;do{var Me=Z[K+0]*2+Z[K+1];K+=2,ce+=de[Me]}while(K<ne);return le.bits+=ce,1}function E(Z,K,ne,le,ce){var de=0,Me,qe=a.ht[le].xlen,Pe;le==2?Pe=a.table23:Pe=a.table56;do{var Ce=Z[K+0]*qe+Z[K+1];K+=2,de+=Pe[Ce]}while(K<ne);return Me=de&65535,de>>=16,de>Me&&(de=Me,le++),ce.bits+=de,le}function M(Z,K,ne,le,ce){var de=0,Me=0,qe=0,Pe=a.ht[le].xlen,Ce=a.ht[le].hlen,Xe=a.ht[le+1].hlen,$e=a.ht[le+2].hlen;do{var at=Z[K+0]*Pe+Z[K+1];K+=2,de+=Ce[at],Me+=Xe[at],qe+=$e[at]}while(K<ne);var pt=le;return de>Me&&(de=Me,pt++),de>qe&&(de=qe,pt=le+2),ce.bits+=de,pt}var O=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function N(Z,K,ne,le){var ce=y(Z,K,ne);switch(ce){case 0:return ce;case 1:return x(Z,K,ne,le);case 2:case 3:return E(Z,K,ne,O[ce-1],le);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return M(Z,K,ne,O[ce-1],le);default:if(ce>l.IXMAX_VAL)return le.bits=l.LARGE_BITS,-1;ce-=15;var de;for(de=24;de<32&&!(a.ht[de].linmax>=ce);de++);var Me;for(Me=de-8;Me<24&&!(a.ht[Me].linmax>=ce);Me++);return v(Z,K,ne,Me,de,le)}}this.noquant_count_bits=function(Z,K,ne){var le=K.l3_enc,ce=Math.min(576,K.max_nonzero_coeff+2>>1<<1);for(ne!=null&&(ne.sfb_count1=0);ce>1&&!(le[ce-1]|le[ce-2]);ce-=2);K.count1=ce;for(var de=0,Me=0;ce>3;ce-=4){var qe;if(((le[ce-1]|le[ce-2]|le[ce-3]|le[ce-4])&2147483647)>1)break;qe=((le[ce-4]*2+le[ce-3])*2+le[ce-2])*2+le[ce-1],de+=a.t32l[qe],Me+=a.t33l[qe]}var Pe=de;if(K.count1table_select=0,de>Me&&(Pe=Me,K.count1table_select=1),K.count1bits=Pe,K.big_values=ce,ce==0)return Pe;if(K.block_type==s.SHORT_TYPE)de=3*Z.scalefac_band.s[3],de>K.big_values&&(de=K.big_values),Me=K.big_values;else if(K.block_type==s.NORM_TYPE){if(de=K.region0_count=Z.bv_scf[ce-2],Me=K.region1_count=Z.bv_scf[ce-1],i(de+Me+2<s.SBPSY_l),Me=Z.scalefac_band.l[de+Me+2],de=Z.scalefac_band.l[de+1],Me<ce){var Ce=new f(Pe);K.table_select[2]=N(le,Me,ce,Ce),Pe=Ce.bits}}else K.region0_count=7,K.region1_count=s.SBMAX_l-1-7-1,de=Z.scalefac_band.l[8],Me=ce,de>Me&&(de=Me);if(de=Math.min(de,ce),Me=Math.min(Me,ce),0<de){var Ce=new f(Pe);K.table_select[0]=N(le,0,de,Ce),Pe=Ce.bits}if(de<Me){var Ce=new f(Pe);K.table_select[1]=N(le,de,Me,Ce),Pe=Ce.bits}if(Z.use_best_huffman==2&&(K.part2_3_length=Pe,best_huffman_divide(Z,K),Pe=K.part2_3_length),ne!=null&&K.block_type==s.NORM_TYPE){for(var Xe=0;Z.scalefac_band.l[Xe]<K.big_values;)Xe++;ne.sfb_count1=Xe}return Pe},this.count_bits=function(Z,K,ne,le){var ce=ne.l3_enc,de=l.IXMAX_VAL/u.IPOW20(ne.global_gain);if(ne.xrpow_max>de)return l.LARGE_BITS;if(_(K,ce,u.IPOW20(ne.global_gain),ne,le),Z.substep_shaping&2)for(var Me=0,qe=ne.global_gain+ne.scalefac_scale,Pe=.634521682242439/u.IPOW20(qe),Ce=0;Ce<ne.sfbmax;Ce++){var Xe=ne.width[Ce];if(Z.pseudohalf[Ce]==0)Me+=Xe;else{var $e;for($e=Me,Me+=Xe;$e<Me;++$e)ce[$e]=K[$e]>=Pe?ce[$e]:0}}return this.noquant_count_bits(Z,ne,le)};function I(Z,K,ne,le,ce,de,Me){for(var qe=K.big_values,Pe=0;Pe<=22;Pe++)le[Pe]=l.LARGE_BITS;for(var Pe=0;Pe<16;Pe++){var Ce=Z.scalefac_band.l[Pe+1];if(Ce>=qe)break;var Xe=0,$e=new f(Xe),at=N(ne,0,Ce,$e);Xe=$e.bits;for(var pt=0;pt<8;pt++){var oe=Z.scalefac_band.l[Pe+pt+2];if(oe>=qe)break;var Ue=Xe;$e=new f(Ue);var Ge=N(ne,Ce,oe,$e);Ue=$e.bits,le[Pe+pt]>Ue&&(le[Pe+pt]=Ue,ce[Pe+pt]=Pe,de[Pe+pt]=at,Me[Pe+pt]=Ge)}}}function D(Z,K,ne,le,ce,de,Me,qe){for(var Pe=K.big_values,Ce=2;Ce<s.SBMAX_l+1;Ce++){var Xe=Z.scalefac_band.l[Ce];if(Xe>=Pe)break;var $e=ce[Ce-2]+K.count1bits;if(ne.part2_3_length<=$e)break;var at=new f($e),pt=N(le,Xe,Pe,at);$e=at.bits,!(ne.part2_3_length<=$e)&&(ne.assign(K),ne.part2_3_length=$e,ne.region0_count=de[Ce-2],ne.region1_count=Ce-2-de[Ce-2],ne.table_select[0]=Me[Ce-2],ne.table_select[1]=qe[Ce-2],ne.table_select[2]=pt)}}this.best_huffman_divide=function(Z,K){var ne=new o,le=K.l3_enc,ce=r(23),de=r(23),Me=r(23),qe=r(23);if(!(K.block_type==s.SHORT_TYPE&&Z.mode_gr==1)){ne.assign(K),K.block_type==s.NORM_TYPE&&(I(Z,K,le,ce,de,Me,qe),D(Z,ne,K,le,ce,de,Me,qe));var Pe=ne.big_values;if(!(Pe==0||(le[Pe-2]|le[Pe-1])>1)&&(Pe=K.count1+2,!(Pe>576))){ne.assign(K),ne.count1=Pe;for(var Ce=0,Xe=0;Pe>ne.big_values;Pe-=4){var $e=((le[Pe-4]*2+le[Pe-3])*2+le[Pe-2])*2+le[Pe-1];Ce+=a.t32l[$e],Xe+=a.t33l[$e]}if(ne.big_values=Pe,ne.count1table_select=0,Ce>Xe&&(Ce=Xe,ne.count1table_select=1),ne.count1bits=Ce,ne.block_type==s.NORM_TYPE)D(Z,ne,K,le,ce,de,Me,qe);else{if(ne.part2_3_length=Ce,Ce=Z.scalefac_band.l[8],Ce>Pe&&(Ce=Pe),Ce>0){var at=new f(ne.part2_3_length);ne.table_select[0]=N(le,0,Ce,at),ne.part2_3_length=at.bits}if(Pe>Ce){var at=new f(ne.part2_3_length);ne.table_select[1]=N(le,Ce,Pe,at),ne.part2_3_length=at.bits}K.part2_3_length>ne.part2_3_length&&K.assign(ne)}}}};var V=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],G=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],Q=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],B=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];c.slen1_tab=Q,c.slen2_tab=B;function $(Z,K){for(var ne,le=K.tt[1][Z],ce=K.tt[0][Z],de=0;de<a.scfsi_band.length-1;de++){for(ne=a.scfsi_band[de];ne<a.scfsi_band[de+1]&&!(ce.scalefac[ne]!=le.scalefac[ne]&&le.scalefac[ne]>=0);ne++);if(ne==a.scfsi_band[de+1]){for(ne=a.scfsi_band[de];ne<a.scfsi_band[de+1];ne++)le.scalefac[ne]=-1;K.scfsi[Z][de]=1}}var Me=0,qe=0;for(ne=0;ne<11;ne++)le.scalefac[ne]!=-1&&(qe++,Me<le.scalefac[ne]&&(Me=le.scalefac[ne]));for(var Pe=0,Ce=0;ne<s.SBPSY_l;ne++)le.scalefac[ne]!=-1&&(Ce++,Pe<le.scalefac[ne]&&(Pe=le.scalefac[ne]));for(var de=0;de<16;de++)if(Me<V[de]&&Pe<G[de]){var Xe=Q[de]*qe+B[de]*Ce;le.part2_length>Xe&&(le.part2_length=Xe,le.scalefac_compress=de)}}this.best_scalefac_store=function(Z,K,ne,le){var ce=le.tt[K][ne],de,Me,qe,Pe,Ce=0;for(qe=0,de=0;de<ce.sfbmax;de++){var Xe=ce.width[de];for(qe+=Xe,Pe=-Xe;Pe<0&&ce.l3_enc[Pe+qe]==0;Pe++);Pe==0&&(ce.scalefac[de]=Ce=-2)}if(ce.scalefac_scale==0&&ce.preflag==0){var $e=0;for(de=0;de<ce.sfbmax;de++)ce.scalefac[de]>0&&($e|=ce.scalefac[de]);if(!($e&1)&&$e!=0){for(de=0;de<ce.sfbmax;de++)ce.scalefac[de]>0&&(ce.scalefac[de]>>=1);ce.scalefac_scale=Ce=1}}if(ce.preflag==0&&ce.block_type!=s.SHORT_TYPE&&Z.mode_gr==2){for(de=11;de<s.SBPSY_l&&!(ce.scalefac[de]<u.pretab[de]&&ce.scalefac[de]!=-2);de++);if(de==s.SBPSY_l){for(de=11;de<s.SBPSY_l;de++)ce.scalefac[de]>0&&(ce.scalefac[de]-=u.pretab[de]);ce.preflag=Ce=1}}for(Me=0;Me<4;Me++)le.scfsi[ne][Me]=0;for(Z.mode_gr==2&&K==1&&le.tt[0][ne].block_type!=s.SHORT_TYPE&&le.tt[1][ne].block_type!=s.SHORT_TYPE&&($(ne,le),Ce=0),de=0;de<ce.sfbmax;de++)ce.scalefac[de]==-2&&(ce.scalefac[de]=0);Ce!=0&&(Z.mode_gr==2?this.scale_bitcount(ce):this.scale_bitcount_lsf(Z,ce))};function U(Z,K){for(var ne=0;ne<K;++ne)if(Z[ne]<0)return!1;return!0}var J=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],W=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],q=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(Z){var K,ne,le=0,ce=0,de,Me=Z.scalefac;if(i(U(Me,Z.sfbmax)),Z.block_type==s.SHORT_TYPE)de=J,Z.mixed_block_flag!=0&&(de=W);else if(de=q,Z.preflag==0){for(ne=11;ne<s.SBPSY_l&&!(Me[ne]<u.pretab[ne]);ne++);if(ne==s.SBPSY_l)for(Z.preflag=1,ne=11;ne<s.SBPSY_l;ne++)Me[ne]-=u.pretab[ne]}for(ne=0;ne<Z.sfbdivide;ne++)le<Me[ne]&&(le=Me[ne]);for(;ne<Z.sfbmax;ne++)ce<Me[ne]&&(ce=Me[ne]);for(Z.part2_length=l.LARGE_BITS,K=0;K<16;K++)le<V[K]&&ce<G[K]&&Z.part2_length>de[K]&&(Z.part2_length=de[K],Z.scalefac_compress=K);return Z.part2_length==l.LARGE_BITS};var Y=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(Z,K){var ne,le,ce,de,Me,qe,Pe,Ce,Xe=r(4),$e=K.scalefac;for(K.preflag!=0?ne=2:ne=0,Pe=0;Pe<4;Pe++)Xe[Pe]=0;if(K.block_type==s.SHORT_TYPE){le=1;var at=u.nr_of_sfb_block[ne][le];for(Ce=0,ce=0;ce<4;ce++)for(de=at[ce]/3,Pe=0;Pe<de;Pe++,Ce++)for(Me=0;Me<3;Me++)$e[Ce*3+Me]>Xe[ce]&&(Xe[ce]=$e[Ce*3+Me])}else{le=0;var at=u.nr_of_sfb_block[ne][le];for(Ce=0,ce=0;ce<4;ce++)for(de=at[ce],Pe=0;Pe<de;Pe++,Ce++)$e[Ce]>Xe[ce]&&(Xe[ce]=$e[Ce])}for(qe=!1,ce=0;ce<4;ce++)Xe[ce]>Y[ne][ce]&&(qe=!0);if(!qe){var pt,oe,Ue,Ge;for(K.sfb_partition_table=u.nr_of_sfb_block[ne][le],ce=0;ce<4;ce++)K.slen[ce]=ae[Xe[ce]];switch(pt=K.slen[0],oe=K.slen[1],Ue=K.slen[2],Ge=K.slen[3],ne){case 0:K.scalefac_compress=(pt*5+oe<<4)+(Ue<<2)+Ge;break;case 1:K.scalefac_compress=400+(pt*5+oe<<2)+Ue;break;case 2:K.scalefac_compress=500+pt*3+oe;break;default:e.err.printf(`intensity stereo not implemented yet
`);break}}if(!qe)for(i(K.sfb_partition_table!=null),K.part2_length=0,ce=0;ce<4;ce++)K.part2_length+=K.slen[ce]*K.sfb_partition_table[ce];return qe};var ae=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(Z){for(var K=2;K<=576;K+=2){for(var ne=0,le;Z.scalefac_band.l[++ne]<K;);for(le=d[ne][0];Z.scalefac_band.l[le+1]>K;)le--;for(le<0&&(le=d[ne][0]),Z.bv_scf[K-2]=le,le=d[ne][1];Z.scalefac_band.l[le+Z.bv_scf[K-2]+2]>K;)le--;le<0&&(le=d[ne][1]),Z.bv_scf[K-1]=le}}}return tF=c,tF}var nF,are;function EV(){if(are)return nF;are=1;var n=Tc,e=n.System,t=n.Arrays,r=n.new_byte,i=n.new_float_n,s=n.new_int,a=n.assert,o=S_e(),l=SV,c=op(),u=e5;f.EQ=function(d,g){return Math.abs(d)>Math.abs(g)?Math.abs(d-g)<=Math.abs(d)*1e-6:Math.abs(d-g)<=Math.abs(g)*1e-6},f.NEQ=function(d,g){return!f.EQ(d,g)};function f(){var d=xV(),g=this,p=32773,_=null,y=null,v=null,x=null;this.setModules=function(K,ne,le,ce){_=K,y=ne,v=le,x=ce};var E=null,M=0,O=0,N=0;this.getframebits=function(K){var ne=K.internal_flags,le;ne.bitrate_index!=0?le=l.bitrate_table[K.version][ne.bitrate_index]:le=K.brate;var ce=0|(K.version+1)*72e3*le/K.out_samplerate+ne.padding;return 8*ce};function I(K){e.arraycopy(K.header[K.w_ptr].buf,0,E,O,K.sideinfo_len),O+=K.sideinfo_len,M+=K.sideinfo_len*8,K.w_ptr=K.w_ptr+1&u.MAX_HEADER_BUF-1}function D(K,ne,le){for(;le>0;){var ce;N==0&&(N=8,O++,a(O<d.LAME_MAXMP3BUFFER),a(K.header[K.w_ptr].write_timing>=M),K.header[K.w_ptr].write_timing==M&&I(K),E[O]=0),ce=Math.min(le,N),le-=ce,N-=ce,E[O]|=ne>>le<<N,M+=ce}}function V(K,ne,le){for(;le>0;){var ce;N==0&&(N=8,O++,a(O<d.LAME_MAXMP3BUFFER),E[O]=0),ce=Math.min(le,N),le-=ce,N-=ce,E[O]|=ne>>le<<N,M+=ce}}function G(K,ne){var le=K.internal_flags,ce;if(ne>=8&&(D(le,76,8),ne-=8),ne>=8&&(D(le,65,8),ne-=8),ne>=8&&(D(le,77,8),ne-=8),ne>=8&&(D(le,69,8),ne-=8),ne>=32){var de=v.getLameShortVersion();if(ne>=32)for(ce=0;ce<de.length&&ne>=8;++ce)ne-=8,D(le,de.charAt(ce),8)}for(;ne>=1;ne-=1)D(le,le.ancillary_flag,1),le.ancillary_flag^=K.disable_reservoir?0:1}function Q(K,ne,le){for(var ce=K.header[K.h_ptr].ptr;le>0;){var de=Math.min(le,8-(ce&7));le-=de,K.header[K.h_ptr].buf[ce>>3]|=ne>>le<<8-(ce&7)-de,ce+=de}K.header[K.h_ptr].ptr=ce}function B(K,ne){K<<=8;for(var le=0;le<8;le++)K<<=1,ne<<=1,(ne^K)&65536&&(ne^=p);return ne}this.CRC_writeheader=function(K,ne){var le=65535;le=B(ne[2]&255,le),le=B(ne[3]&255,le);for(var ce=6;ce<K.sideinfo_len;ce++)le=B(ne[ce]&255,le);ne[4]=byte(le>>8),ne[5]=byte(le&255)};function $(K,ne){var le=K.internal_flags,ce,de,Me;if(ce=le.l3_side,le.header[le.h_ptr].ptr=0,t.fill(le.header[le.h_ptr].buf,0,le.sideinfo_len,0),K.out_samplerate<16e3?Q(le,4094,12):Q(le,4095,12),Q(le,K.version,1),Q(le,1,2),Q(le,K.error_protection?0:1,1),Q(le,le.bitrate_index,4),Q(le,le.samplerate_index,2),Q(le,le.padding,1),Q(le,K.extension,1),Q(le,K.mode.ordinal(),2),Q(le,le.mode_ext,2),Q(le,K.copyright,1),Q(le,K.original,1),Q(le,K.emphasis,2),K.error_protection&&Q(le,0,16),K.version==1){for(a(ce.main_data_begin>=0),Q(le,ce.main_data_begin,9),le.channels_out==2?Q(le,ce.private_bits,3):Q(le,ce.private_bits,5),Me=0;Me<le.channels_out;Me++){var qe;for(qe=0;qe<4;qe++)Q(le,ce.scfsi[Me][qe],1)}for(de=0;de<2;de++)for(Me=0;Me<le.channels_out;Me++){var Pe=ce.tt[de][Me];Q(le,Pe.part2_3_length+Pe.part2_length,12),Q(le,Pe.big_values/2,9),Q(le,Pe.global_gain,8),Q(le,Pe.scalefac_compress,4),Pe.block_type!=c.NORM_TYPE?(Q(le,1,1),Q(le,Pe.block_type,2),Q(le,Pe.mixed_block_flag,1),Pe.table_select[0]==14&&(Pe.table_select[0]=16),Q(le,Pe.table_select[0],5),Pe.table_select[1]==14&&(Pe.table_select[1]=16),Q(le,Pe.table_select[1],5),Q(le,Pe.subblock_gain[0],3),Q(le,Pe.subblock_gain[1],3),Q(le,Pe.subblock_gain[2],3)):(Q(le,0,1),Pe.table_select[0]==14&&(Pe.table_select[0]=16),Q(le,Pe.table_select[0],5),Pe.table_select[1]==14&&(Pe.table_select[1]=16),Q(le,Pe.table_select[1],5),Pe.table_select[2]==14&&(Pe.table_select[2]=16),Q(le,Pe.table_select[2],5),a(0<=Pe.region0_count&&Pe.region0_count<16),a(0<=Pe.region1_count&&Pe.region1_count<8),Q(le,Pe.region0_count,4),Q(le,Pe.region1_count,3)),Q(le,Pe.preflag,1),Q(le,Pe.scalefac_scale,1),Q(le,Pe.count1table_select,1)}}else for(a(ce.main_data_begin>=0),Q(le,ce.main_data_begin,8),Q(le,ce.private_bits,le.channels_out),de=0,Me=0;Me<le.channels_out;Me++){var Pe=ce.tt[de][Me];Q(le,Pe.part2_3_length+Pe.part2_length,12),Q(le,Pe.big_values/2,9),Q(le,Pe.global_gain,8),Q(le,Pe.scalefac_compress,9),Pe.block_type!=c.NORM_TYPE?(Q(le,1,1),Q(le,Pe.block_type,2),Q(le,Pe.mixed_block_flag,1),Pe.table_select[0]==14&&(Pe.table_select[0]=16),Q(le,Pe.table_select[0],5),Pe.table_select[1]==14&&(Pe.table_select[1]=16),Q(le,Pe.table_select[1],5),Q(le,Pe.subblock_gain[0],3),Q(le,Pe.subblock_gain[1],3),Q(le,Pe.subblock_gain[2],3)):(Q(le,0,1),Pe.table_select[0]==14&&(Pe.table_select[0]=16),Q(le,Pe.table_select[0],5),Pe.table_select[1]==14&&(Pe.table_select[1]=16),Q(le,Pe.table_select[1],5),Pe.table_select[2]==14&&(Pe.table_select[2]=16),Q(le,Pe.table_select[2],5),a(0<=Pe.region0_count&&Pe.region0_count<16),a(0<=Pe.region1_count&&Pe.region1_count<8),Q(le,Pe.region0_count,4),Q(le,Pe.region1_count,3)),Q(le,Pe.scalefac_scale,1),Q(le,Pe.count1table_select,1)}K.error_protection&&CRC_writeheader(le,le.header[le.h_ptr].buf);{var Ce=le.h_ptr;a(le.header[Ce].ptr==le.sideinfo_len*8),le.h_ptr=Ce+1&u.MAX_HEADER_BUF-1,le.header[le.h_ptr].write_timing=le.header[Ce].write_timing+ne,le.h_ptr==le.w_ptr&&e.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function U(K,ne){var le=l.ht[ne.count1table_select+32],ce,de=0,Me=ne.big_values,qe=ne.big_values;for(a(ne.count1table_select<2),ce=(ne.count1-ne.big_values)/4;ce>0;--ce){var Pe=0,Ce=0,Xe;Xe=ne.l3_enc[Me+0],Xe!=0&&(Ce+=8,ne.xr[qe+0]<0&&Pe++),Xe=ne.l3_enc[Me+1],Xe!=0&&(Ce+=4,Pe*=2,ne.xr[qe+1]<0&&Pe++),Xe=ne.l3_enc[Me+2],Xe!=0&&(Ce+=2,Pe*=2,ne.xr[qe+2]<0&&Pe++),Xe=ne.l3_enc[Me+3],Xe!=0&&(Ce++,Pe*=2,ne.xr[qe+3]<0&&Pe++),Me+=4,qe+=4,D(K,Pe+le.table[Ce],le.hlen[Ce]),de+=le.hlen[Ce]}return de}function J(K,ne,le,ce,de){var Me=l.ht[ne],qe=0;if(ne==0)return qe;for(var Pe=le;Pe<ce;Pe+=2){var Ce=0,Xe=0,$e=Me.xlen,at=Me.xlen,pt=0,oe=de.l3_enc[Pe],Ue=de.l3_enc[Pe+1];if(oe!=0&&(de.xr[Pe]<0&&pt++,Ce--),ne>15){if(oe>14){var Ge=oe-15;a(Ge<=Me.linmax),pt|=Ge<<1,Xe=$e,oe=15}if(Ue>14){var ze=Ue-15;a(ze<=Me.linmax),pt<<=$e,pt|=ze,Xe+=$e,Ue=15}at=16}Ue!=0&&(pt<<=1,de.xr[Pe+1]<0&&pt++,Ce--),oe=oe*at+Ue,Xe-=Ce,Ce+=Me.hlen[oe],D(K,Me.table[oe],Ce),D(K,pt,Xe),qe+=Ce+Xe}return qe}function W(K,ne){var le=3*K.scalefac_band.s[3];le>ne.big_values&&(le=ne.big_values);var ce=J(K,ne.table_select[0],0,le,ne);return ce+=J(K,ne.table_select[1],le,ne.big_values,ne),ce}function q(K,ne){var le,ce,de,Me;le=ne.big_values;var qe=ne.region0_count+1;return a(qe<K.scalefac_band.l.length),de=K.scalefac_band.l[qe],qe+=ne.region1_count+1,a(qe<K.scalefac_band.l.length),Me=K.scalefac_band.l[qe],de>le&&(de=le),Me>le&&(Me=le),ce=J(K,ne.table_select[0],0,de,ne),ce+=J(K,ne.table_select[1],de,Me,ne),ce+=J(K,ne.table_select[2],Me,le,ne),ce}function Y(K){var ne,le,ce,de,Me=0,qe=K.internal_flags,Pe=qe.l3_side;if(K.version==1)for(ne=0;ne<2;ne++)for(le=0;le<qe.channels_out;le++){var Ce=Pe.tt[ne][le],Xe=o.slen1_tab[Ce.scalefac_compress],$e=o.slen2_tab[Ce.scalefac_compress];for(de=0,ce=0;ce<Ce.sfbdivide;ce++)Ce.scalefac[ce]!=-1&&(D(qe,Ce.scalefac[ce],Xe),de+=Xe);for(;ce<Ce.sfbmax;ce++)Ce.scalefac[ce]!=-1&&(D(qe,Ce.scalefac[ce],$e),de+=$e);a(de==Ce.part2_length),Ce.block_type==c.SHORT_TYPE?de+=W(qe,Ce):de+=q(qe,Ce),de+=U(qe,Ce),a(de==Ce.part2_3_length+Ce.part2_length),Me+=de}else for(ne=0,le=0;le<qe.channels_out;le++){var Ce=Pe.tt[ne][le],at,pt,oe=0;if(a(Ce.sfb_partition_table!=null),de=0,ce=0,pt=0,Ce.block_type==c.SHORT_TYPE){for(;pt<4;pt++){var Ue=Ce.sfb_partition_table[pt]/3,Ge=Ce.slen[pt];for(at=0;at<Ue;at++,ce++)D(qe,Math.max(Ce.scalefac[ce*3+0],0),Ge),D(qe,Math.max(Ce.scalefac[ce*3+1],0),Ge),D(qe,Math.max(Ce.scalefac[ce*3+2],0),Ge),oe+=3*Ge}de+=W(qe,Ce)}else{for(;pt<4;pt++){var Ue=Ce.sfb_partition_table[pt],Ge=Ce.slen[pt];for(at=0;at<Ue;at++,ce++)D(qe,Math.max(Ce.scalefac[ce],0),Ge),oe+=Ge}de+=q(qe,Ce)}de+=U(qe,Ce),a(de==Ce.part2_3_length),a(oe==Ce.part2_length),Me+=oe+de}return Me}function ae(){this.total=0}function Z(K,ne){var le=K.internal_flags,ce,de,Me,qe,Pe;return Pe=le.w_ptr,qe=le.h_ptr-1,qe==-1&&(qe=u.MAX_HEADER_BUF-1),ce=le.header[qe].write_timing-M,ne.total=ce,ce>=0&&(de=1+qe-Pe,qe<Pe&&(de=1+qe-Pe+u.MAX_HEADER_BUF),ce-=de*8*le.sideinfo_len),Me=g.getframebits(K),ce+=Me,ne.total+=Me,ne.total%8!=0?ne.total=1+ne.total/8:ne.total=ne.total/8,ne.total+=O+1,ce<0&&e.err.println(`strange error flushing buffer ... 
`),ce}this.flush_bitstream=function(K){var ne=K.internal_flags,le,ce,de=ne.h_ptr-1;if(de==-1&&(de=u.MAX_HEADER_BUF-1),le=ne.l3_side,!((ce=Z(K,new ae))<0)){if(G(K,ce),a(ne.header[de].write_timing+this.getframebits(K)==M),ne.ResvSize=0,le.main_data_begin=0,ne.findReplayGain){var Me=_.GetTitleGain(ne.rgdata);a(NEQ(Me,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),ne.RadioGain=Math.floor(Me*10+.5)|0}ne.findPeakSample&&(ne.noclipGainChange=Math.ceil(Math.log10(ne.PeakSample/32767)*20*10)|0,ne.noclipGainChange>0&&(EQ(K.scale,1)||EQ(K.scale,0))?ne.noclipScale=Math.floor(32767/ne.PeakSample*100)/100:ne.noclipScale=-1)}},this.add_dummy_byte=function(K,ne,le){for(var ce=K.internal_flags,de;le-- >0;)for(V(ce,ne,8),de=0;de<u.MAX_HEADER_BUF;++de)ce.header[de].write_timing+=8},this.format_bitstream=function(K){var ne=K.internal_flags,le;le=ne.l3_side;var ce=this.getframebits(K);G(K,le.resvDrain_pre),$(K,ce);var de=8*ne.sideinfo_len;if(de+=Y(K),G(K,le.resvDrain_post),de+=le.resvDrain_post,le.main_data_begin+=(ce-de)/8,Z(K,new ae)!=ne.ResvSize&&e.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),le.main_data_begin*8!=ne.ResvSize&&(e.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*le.main_data_begin,ne.ResvSize,le.resvDrain_post,le.resvDrain_pre,8*ne.sideinfo_len,de-le.resvDrain_post-8*ne.sideinfo_len,de,de%8,ce),e.err.println("This is a fatal error.  It has several possible causes:"),e.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),e.err.println(" 9%%  Your system is overclocked"),e.err.println(" 1%%  bug in LAME encoding library"),ne.ResvSize=le.main_data_begin*8),M>1e9){var Me;for(Me=0;Me<u.MAX_HEADER_BUF;++Me)ne.header[Me].write_timing-=M;M=0}return 0},this.copy_buffer=function(K,ne,le,ce,de){var Me=O+1;if(Me<=0)return 0;if(ce!=0&&Me>ce)return-1;if(e.arraycopy(E,0,ne,le,Me),O=-1,N=0,de!=0){var qe=s(1);if(qe[0]=K.nMusicCRC,x.updateMusicCRC(qe,ne,le,Me),K.nMusicCRC=qe[0],Me>0&&(K.VBR_seek_table.nBytesWritten+=Me),K.decode_on_the_fly){for(var Pe=i([2,1152]),Ce=Me,Xe=-1,$e;Xe!=0;)if(Xe=y.hip_decode1_unclipped(K.hip,ne,le,Ce,Pe[0],Pe[1]),Ce=0,Xe==-1&&(Xe=0),Xe>0){if(K.findPeakSample){for($e=0;$e<Xe;$e++)Pe[0][$e]>K.PeakSample?K.PeakSample=Pe[0][$e]:-Pe[0][$e]>K.PeakSample&&(K.PeakSample=-Pe[0][$e]);if(K.channels_out>1)for($e=0;$e<Xe;$e++)Pe[1][$e]>K.PeakSample?K.PeakSample=Pe[1][$e]:-Pe[1][$e]>K.PeakSample&&(K.PeakSample=-Pe[1][$e])}if(K.findReplayGain&&_.AnalyzeSamples(K.rgdata,Pe[0],0,Pe[1],0,Xe,K.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return Me},this.init_bit_stream_w=function(K){E=r(d.LAME_MAXMP3BUFFER),K.h_ptr=K.w_ptr=0,K.header[K.h_ptr].write_timing=0,O=-1,N=0,M=0}}return nF=f,nF}var rF,ore;function xV(){if(ore)return rF;ore=1;var n=Tc,e=n.System,t=n.VbrMode,r=n.ShortBlock,i=n.new_float,s=n.new_int_n,a=n.new_short_n,o=n.assert,l=kot,c=Not,u=e5,f=rlt,d=slt,g=hlt,p=EV(),_=SV,y=op();function v(){var x=KO,E=this,M=128*1024;v.V9=410,v.V8=420,v.V7=430,v.V6=440,v.V5=450,v.V4=460,v.V3=470,v.V2=480,v.V1=490,v.V0=500,v.R3MIX=1e3,v.STANDARD=1001,v.EXTREME=1002,v.INSANE=1003,v.STANDARD_FAST=1004,v.EXTREME_FAST=1005,v.MEDIUM=1006,v.MEDIUM_FAST=1007;var O=16384+M;v.LAME_MAXMP3BUFFER=O;var N,I,D,V,G,Q=new l,B,$,U;this.enc=new y,this.setModules=function(me,Se,Ie,be,Ke,ot,lt,ct,Vt){N=me,I=Se,D=Ie,V=be,G=Ke,B=ot,$=ct,U=Vt,this.enc.setModules(I,Q,V,B)};function J(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=i(y.SBMAX_l),this.bo_s_weight=i(y.SBMAX_s)}function W(){this.lowerlimit=0}function q(me,Se){this.lowpass=Se}var Y=4294479419;function ae(me){var Se;return me.class_id=Y,Se=me.internal_flags=new u,me.mode=x.NOT_SET,me.original=1,me.in_samplerate=44100,me.num_channels=2,me.num_samples=-1,me.bWriteVbrTag=!0,me.quality=-1,me.short_blocks=null,Se.subblock_gain=-1,me.lowpassfreq=0,me.highpassfreq=0,me.lowpasswidth=-1,me.highpasswidth=-1,me.VBR=t.vbr_off,me.VBR_q=4,me.ATHcurve=-1,me.VBR_mean_bitrate_kbps=128,me.VBR_min_bitrate_kbps=0,me.VBR_max_bitrate_kbps=0,me.VBR_hard_min=0,Se.VBR_min_bitrate=1,Se.VBR_max_bitrate=13,me.quant_comp=-1,me.quant_comp_short=-1,me.msfix=-1,Se.resample_ratio=1,Se.OldValue[0]=180,Se.OldValue[1]=180,Se.CurrentStep[0]=4,Se.CurrentStep[1]=4,Se.masking_lower=1,Se.nsPsy.attackthre=-1,Se.nsPsy.attackthre_s=-1,me.scale=-1,me.athaa_type=-1,me.ATHtype=-1,me.athaa_loudapprox=-1,me.athaa_sensitivity=0,me.useTemporal=null,me.interChRatio=-1,Se.mf_samples_to_encode=y.ENCDELAY+y.POSTDELAY,me.encoder_padding=0,Se.mf_size=y.ENCDELAY-y.MDCTDELAY,me.findReplayGain=!1,me.decode_on_the_fly=!1,Se.decode_on_the_fly=!1,Se.findReplayGain=!1,Se.findPeakSample=!1,Se.RadioGain=0,Se.AudiophileGain=0,Se.noclipGainChange=0,Se.noclipScale=-1,me.preset=0,me.write_id3tag_automatic=!0,0}this.lame_init=function(){var me=new c;return ae(me),me.lame_allocated_gfp=1,me};function Z(me){return me>1?0:me<=0?1:Math.cos(Math.PI/2*me)}this.nearestBitrateFullIndex=function(me){var Se=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],Ie=0,be=0,Ke=0,ot=0;ot=Se[16],Ke=16,be=Se[16],Ie=16;for(var lt=0;lt<16;lt++)if(Math.max(me,Se[lt+1])!=me){ot=Se[lt+1],Ke=lt+1,be=Se[lt],Ie=lt;break}return ot-me>me-be?Ie:Ke};function K(me,Se){var Ie=44100;return Se>=48e3?Ie=48e3:Se>=44100?Ie=44100:Se>=32e3?Ie=32e3:Se>=24e3?Ie=24e3:Se>=22050?Ie=22050:Se>=16e3?Ie=16e3:Se>=12e3?Ie=12e3:Se>=11025?Ie=11025:Se>=8e3&&(Ie=8e3),me==-1?Ie:(me<=15960&&(Ie=44100),me<=15250&&(Ie=32e3),me<=11220&&(Ie=24e3),me<=9970&&(Ie=22050),me<=7230&&(Ie=16e3),me<=5420&&(Ie=12e3),me<=4510&&(Ie=11025),me<=3970&&(Ie=8e3),Se<Ie?Se>44100?48e3:Se>32e3?44100:Se>24e3?32e3:Se>22050?24e3:Se>16e3?22050:Se>12e3?16e3:Se>11025?12e3:Se>8e3?11025:8e3:Ie)}function ne(me,Se){switch(me){case 44100:return Se.version=1,0;case 48e3:return Se.version=1,1;case 32e3:return Se.version=1,2;case 22050:return Se.version=0,0;case 24e3:return Se.version=0,1;case 16e3:return Se.version=0,2;case 11025:return Se.version=0,0;case 12e3:return Se.version=0,1;case 8e3:return Se.version=0,2;default:return Se.version=0,-1}}function le(me,Se,Ie){Ie<16e3&&(Se=2);for(var be=_.bitrate_table[Se][1],Ke=2;Ke<=14;Ke++)_.bitrate_table[Se][Ke]>0&&Math.abs(_.bitrate_table[Se][Ke]-me)<Math.abs(be-me)&&(be=_.bitrate_table[Se][Ke]);return be}function ce(me,Se,Ie){Ie<16e3&&(Se=2);for(var be=0;be<=14;be++)if(_.bitrate_table[Se][be]>0&&_.bitrate_table[Se][be]==me)return be;return-1}function de(me,Se){var Ie=[new q(8,2e3),new q(16,3700),new q(24,3900),new q(32,5500),new q(40,7e3),new q(48,7500),new q(56,1e4),new q(64,11e3),new q(80,13500),new q(96,15100),new q(112,15600),new q(128,17e3),new q(160,17500),new q(192,18600),new q(224,19400),new q(256,19700),new q(320,20500)],be=E.nearestBitrateFullIndex(Se);me.lowerlimit=Ie[be].lowpass}function Me(me){var Se=me.internal_flags,Ie=32,be=-1;if(Se.lowpass1>0){for(var Ke=999,ot=0;ot<=31;ot++){var lt=ot/31;lt>=Se.lowpass2&&(Ie=Math.min(Ie,ot)),Se.lowpass1<lt&&lt<Se.lowpass2&&(Ke=Math.min(Ke,ot))}Ke==999?Se.lowpass1=(Ie-.75)/31:Se.lowpass1=(Ke-.75)/31,Se.lowpass2=Ie/31}if(Se.highpass2>0&&Se.highpass2<.9*(.75/31)&&(Se.highpass1=0,Se.highpass2=0,e.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),Se.highpass2>0){for(var ct=-1,ot=0;ot<=31;ot++){var lt=ot/31;lt<=Se.highpass1&&(be=Math.max(be,ot)),Se.highpass1<lt&&lt<Se.highpass2&&(ct=Math.max(ct,ot))}Se.highpass1=be/31,ct==-1?Se.highpass2=(be+.75)/31:Se.highpass2=(ct+.75)/31}for(var ot=0;ot<32;ot++){var Vt,kt,lt=ot/31;Se.highpass2>Se.highpass1?Vt=Z((Se.highpass2-lt)/(Se.highpass2-Se.highpass1+1e-20)):Vt=1,Se.lowpass2>Se.lowpass1?kt=Z((lt-Se.lowpass1)/(Se.lowpass2-Se.lowpass1+1e-20)):kt=1,Se.amp_filter[ot]=Vt*kt}}function qe(me){var Se=me.internal_flags;switch(me.quality){default:case 9:Se.psymodel=0,Se.noise_shaping=0,Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 8:me.quality=7;case 7:Se.psymodel=1,Se.noise_shaping=0,Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 6:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 5:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=0,Se.full_outer_loop=0;break;case 4:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=0,Se.noise_shaping_stop=0,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 3:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.noise_shaping_amp=1,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 2:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=1,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 1:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=2,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break;case 0:Se.psymodel=1,Se.noise_shaping==0&&(Se.noise_shaping=1),Se.substep_shaping==0&&(Se.substep_shaping=2),Se.noise_shaping_amp=2,Se.noise_shaping_stop=1,Se.subblock_gain==-1&&(Se.subblock_gain=1),Se.use_best_huffman=1,Se.full_outer_loop=0;break}}function Pe(me){var Se=me.internal_flags;me.frameNum=0,me.write_id3tag_automatic&&$.id3tag_write_v2(me),Se.bitrate_stereoMode_Hist=s([16,5]),Se.bitrate_blockType_Hist=s([16,6]),Se.PeakSample=0,me.bWriteVbrTag&&B.InitVbrTag(me)}this.lame_init_params=function(me){var Se=me.internal_flags;if(Se.Class_ID=0,Se.ATH==null&&(Se.ATH=new f),Se.PSY==null&&(Se.PSY=new J),Se.rgdata==null&&(Se.rgdata=new d),Se.channels_in=me.num_channels,Se.channels_in==1&&(me.mode=x.MONO),Se.channels_out=me.mode==x.MONO?1:2,Se.mode_ext=y.MPG_MD_MS_LR,me.mode==x.MONO&&(me.force_ms=!1),me.VBR==t.vbr_off&&me.VBR_mean_bitrate_kbps!=128&&me.brate==0&&(me.brate=me.VBR_mean_bitrate_kbps),me.VBR==t.vbr_off||me.VBR==t.vbr_mtrh||me.VBR==t.vbr_mt||(me.free_format=!1),me.VBR==t.vbr_off&&me.brate==0&&p.EQ(me.compression_ratio,0)&&(me.compression_ratio=11.025),me.VBR==t.vbr_off&&me.compression_ratio>0&&(me.out_samplerate==0&&(me.out_samplerate=map2MP3Frequency(int(.97*me.in_samplerate))),me.brate=0|me.out_samplerate*16*Se.channels_out/(1e3*me.compression_ratio),Se.samplerate_index=ne(me.out_samplerate,me),me.free_format||(me.brate=le(me.brate,me.version,me.out_samplerate))),me.out_samplerate!=0&&(me.out_samplerate<16e3?(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,8),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,64)):me.out_samplerate<32e3?(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,8),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,160)):(me.VBR_mean_bitrate_kbps=Math.max(me.VBR_mean_bitrate_kbps,32),me.VBR_mean_bitrate_kbps=Math.min(me.VBR_mean_bitrate_kbps,320))),me.lowpassfreq==0){var Ie=16e3;switch(me.VBR){case t.vbr_off:{var be=new W;de(be,me.brate),Ie=be.lowerlimit;break}case t.vbr_abr:{var be=new W;de(be,me.VBR_mean_bitrate_kbps),Ie=be.lowerlimit;break}case t.vbr_rh:{var Ke=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=me.VBR_q&&me.VBR_q<=9){var ot=Ke[me.VBR_q],lt=Ke[me.VBR_q+1],ct=me.VBR_q_frac;Ie=linear_int(ot,lt,ct)}else Ie=19500;break}default:{var Ke=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=me.VBR_q&&me.VBR_q<=9){var ot=Ke[me.VBR_q],lt=Ke[me.VBR_q+1],ct=me.VBR_q_frac;Ie=linear_int(ot,lt,ct)}else Ie=19500}}me.mode==x.MONO&&(me.VBR==t.vbr_off||me.VBR==t.vbr_abr)&&(Ie*=1.5),me.lowpassfreq=Ie|0}if(me.out_samplerate==0&&(2*me.lowpassfreq>me.in_samplerate&&(me.lowpassfreq=me.in_samplerate/2),me.out_samplerate=K(me.lowpassfreq|0,me.in_samplerate)),me.lowpassfreq=Math.min(20500,me.lowpassfreq),me.lowpassfreq=Math.min(me.out_samplerate/2,me.lowpassfreq),me.VBR==t.vbr_off&&(me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.brate)),me.VBR==t.vbr_abr&&(me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.VBR_mean_bitrate_kbps)),me.bWriteVbrTag||(me.findReplayGain=!1,me.decode_on_the_fly=!1,Se.findPeakSample=!1),Se.findReplayGain=me.findReplayGain,Se.decode_on_the_fly=me.decode_on_the_fly,Se.decode_on_the_fly&&(Se.findPeakSample=!0),Se.findReplayGain&&N.InitGainAnalysis(Se.rgdata,me.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return me.internal_flags=null,-6;switch(Se.decode_on_the_fly&&!me.decode_only&&(Se.hip!=null&&U.hip_decode_exit(Se.hip),Se.hip=U.hip_decode_init()),Se.mode_gr=me.out_samplerate<=24e3?1:2,me.framesize=576*Se.mode_gr,me.encoder_delay=y.ENCDELAY,Se.resample_ratio=me.in_samplerate/me.out_samplerate,me.VBR){case t.vbr_mt:case t.vbr_rh:case t.vbr_mtrh:{var Vt=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];me.compression_ratio=Vt[me.VBR_q]}break;case t.vbr_abr:me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.VBR_mean_bitrate_kbps);break;default:me.compression_ratio=me.out_samplerate*16*Se.channels_out/(1e3*me.brate);break}if(me.mode==x.NOT_SET&&(me.mode=x.JOINT_STEREO),me.highpassfreq>0?(Se.highpass1=2*me.highpassfreq,me.highpasswidth>=0?Se.highpass2=2*(me.highpassfreq+me.highpasswidth):Se.highpass2=2*me.highpassfreq,Se.highpass1/=me.out_samplerate,Se.highpass2/=me.out_samplerate):(Se.highpass1=0,Se.highpass2=0),me.lowpassfreq>0?(Se.lowpass2=2*me.lowpassfreq,me.lowpasswidth>=0?(Se.lowpass1=2*(me.lowpassfreq-me.lowpasswidth),Se.lowpass1<0&&(Se.lowpass1=0)):Se.lowpass1=2*me.lowpassfreq,Se.lowpass1/=me.out_samplerate,Se.lowpass2/=me.out_samplerate):(Se.lowpass1=0,Se.lowpass2=0),Me(me),Se.samplerate_index=ne(me.out_samplerate,me),Se.samplerate_index<0)return me.internal_flags=null,-1;if(me.VBR==t.vbr_off){if(me.free_format)Se.bitrate_index=0;else if(me.brate=le(me.brate,me.version,me.out_samplerate),Se.bitrate_index=ce(me.brate,me.version,me.out_samplerate),Se.bitrate_index<=0)return me.internal_flags=null,-1}else Se.bitrate_index=1;me.analysis&&(me.bWriteVbrTag=!1),Se.pinfo!=null&&(me.bWriteVbrTag=!1),I.init_bit_stream_w(Se);for(var kt=Se.samplerate_index+3*me.version+6*(me.out_samplerate<16e3?1:0),Ut=0;Ut<y.SBMAX_l+1;Ut++)Se.scalefac_band.l[Ut]=V.sfBandIndex[kt].l[Ut];for(var Ut=0;Ut<y.PSFB21+1;Ut++){var je=(Se.scalefac_band.l[22]-Se.scalefac_band.l[21])/y.PSFB21,ge=Se.scalefac_band.l[21]+Ut*je;Se.scalefac_band.psfb21[Ut]=ge}Se.scalefac_band.psfb21[y.PSFB21]=576;for(var Ut=0;Ut<y.SBMAX_s+1;Ut++)Se.scalefac_band.s[Ut]=V.sfBandIndex[kt].s[Ut];for(var Ut=0;Ut<y.PSFB12+1;Ut++){var je=(Se.scalefac_band.s[13]-Se.scalefac_band.s[12])/y.PSFB12,ge=Se.scalefac_band.s[12]+Ut*je;Se.scalefac_band.psfb12[Ut]=ge}Se.scalefac_band.psfb12[y.PSFB12]=192,me.version==1?Se.sideinfo_len=Se.channels_out==1?21:36:Se.sideinfo_len=Se.channels_out==1?13:21,me.error_protection&&(Se.sideinfo_len+=2),Pe(me),Se.Class_ID=Y;{var se;for(se=0;se<19;se++)Se.nsPsy.pefirbuf[se]=700*Se.mode_gr*Se.channels_out;me.ATHtype==-1&&(me.ATHtype=4)}switch(o(me.VBR_q<=9),o(me.VBR_q>=0),me.VBR){case t.vbr_mt:me.VBR=t.vbr_mtrh;case t.vbr_mtrh:{me.useTemporal==null&&(me.useTemporal=!1),D.apply_preset(me,500-me.VBR_q*10,0),me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),me.quality<5&&(me.quality=0),me.quality>5&&(me.quality=5),Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,me.experimentalY?Se.sfb21_extra=!1:Se.sfb21_extra=me.out_samplerate>44e3,Se.iteration_loop=new VBRNewIterationLoop(G);break}case t.vbr_rh:{D.apply_preset(me,500-me.VBR_q*10,0),Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,me.experimentalY?Se.sfb21_extra=!1:Se.sfb21_extra=me.out_samplerate>44e3,me.quality>6&&(me.quality=6),me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),Se.iteration_loop=new VBROldIterationLoop(G);break}default:{var _e;Se.sfb21_extra=!1,me.quality<0&&(me.quality=LAME_DEFAULT_QUALITY),_e=me.VBR,_e==t.vbr_off&&(me.VBR_mean_bitrate_kbps=me.brate),D.apply_preset(me,me.VBR_mean_bitrate_kbps,0),me.VBR=_e,Se.PSY.mask_adjust=me.maskingadjust,Se.PSY.mask_adjust_short=me.maskingadjust_short,_e==t.vbr_off?Se.iteration_loop=new g(G):Se.iteration_loop=new ABRIterationLoop(G);break}}if(o(me.scale>=0),me.VBR!=t.vbr_off){if(Se.VBR_min_bitrate=1,Se.VBR_max_bitrate=14,me.out_samplerate<16e3&&(Se.VBR_max_bitrate=8),me.VBR_min_bitrate_kbps!=0&&(me.VBR_min_bitrate_kbps=le(me.VBR_min_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_min_bitrate=ce(me.VBR_min_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_min_bitrate<0)||me.VBR_max_bitrate_kbps!=0&&(me.VBR_max_bitrate_kbps=le(me.VBR_max_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_max_bitrate=ce(me.VBR_max_bitrate_kbps,me.version,me.out_samplerate),Se.VBR_max_bitrate<0))return-1;me.VBR_min_bitrate_kbps=_.bitrate_table[me.version][Se.VBR_min_bitrate],me.VBR_max_bitrate_kbps=_.bitrate_table[me.version][Se.VBR_max_bitrate],me.VBR_mean_bitrate_kbps=Math.min(_.bitrate_table[me.version][Se.VBR_max_bitrate],me.VBR_mean_bitrate_kbps),me.VBR_mean_bitrate_kbps=Math.max(_.bitrate_table[me.version][Se.VBR_min_bitrate],me.VBR_mean_bitrate_kbps)}return me.tune&&(Se.PSY.mask_adjust+=me.tune_value_a,Se.PSY.mask_adjust_short+=me.tune_value_a),qe(me),o(me.scale>=0),me.athaa_type<0?Se.ATH.useAdjust=3:Se.ATH.useAdjust=me.athaa_type,Se.ATH.aaSensitivityP=Math.pow(10,me.athaa_sensitivity/-10),me.short_blocks==null&&(me.short_blocks=r.short_block_allowed),me.short_blocks==r.short_block_allowed&&(me.mode==x.JOINT_STEREO||me.mode==x.STEREO)&&(me.short_blocks=r.short_block_coupled),me.quant_comp<0&&(me.quant_comp=1),me.quant_comp_short<0&&(me.quant_comp_short=0),me.msfix<0&&(me.msfix=0),me.exp_nspsytune=me.exp_nspsytune|1,me.internal_flags.nsPsy.attackthre<0&&(me.internal_flags.nsPsy.attackthre=l.NSATTACKTHRE),me.internal_flags.nsPsy.attackthre_s<0&&(me.internal_flags.nsPsy.attackthre_s=l.NSATTACKTHRE_S),o(me.scale>=0),me.scale<0&&(me.scale=1),me.ATHtype<0&&(me.ATHtype=4),me.ATHcurve<0&&(me.ATHcurve=4),me.athaa_loudapprox<0&&(me.athaa_loudapprox=2),me.interChRatio<0&&(me.interChRatio=0),me.useTemporal==null&&(me.useTemporal=!0),Se.slot_lag=Se.frac_SpF=0,me.VBR==t.vbr_off&&(Se.slot_lag=Se.frac_SpF=(me.version+1)*72e3*me.brate%me.out_samplerate|0),V.iteration_init(me),Q.psymodel_init(me),o(me.scale>=0),0};function Ce(me,Se){(me.in_buffer_0==null||me.in_buffer_nsamples<Se)&&(me.in_buffer_0=i(Se),me.in_buffer_1=i(Se),me.in_buffer_nsamples=Se)}this.lame_encode_flush=function(me,Se,Ie,be){var Ke=me.internal_flags,ot=a([2,1152]),lt=0,ct,Vt,kt,Ut,je=Ke.mf_samples_to_encode-y.POSTDELAY,ge=Xe(me);if(Ke.mf_samples_to_encode<1)return 0;for(ct=0,me.in_samplerate!=me.out_samplerate&&(je+=16*me.out_samplerate/me.in_samplerate),kt=me.framesize-je%me.framesize,kt<576&&(kt+=me.framesize),me.encoder_padding=kt,Ut=(je+kt)/me.framesize;Ut>0&&lt>=0;){var se=ge-Ke.mf_size,_e=me.frameNum;se*=me.in_samplerate,se/=me.out_samplerate,se>1152&&(se=1152),se<1&&(se=1),Vt=be-ct,be==0&&(Vt=0),lt=this.lame_encode_buffer(me,ot[0],ot[1],se,Se,Ie,Vt),Ie+=lt,ct+=lt,Ut-=_e!=me.frameNum?1:0}if(Ke.mf_samples_to_encode=0,lt<0||(Vt=be-ct,be==0&&(Vt=0),I.flush_bitstream(me),lt=I.copy_buffer(Ke,Se,Ie,Vt,1),lt<0))return lt;if(Ie+=lt,ct+=lt,Vt=be-ct,be==0&&(Vt=0),me.write_id3tag_automatic){if($.id3tag_write_v1(me),lt=I.copy_buffer(Ke,Se,Ie,Vt,0),lt<0)return lt;ct+=lt}return ct},this.lame_encode_buffer=function(me,Se,Ie,be,Ke,ot,lt){var ct=me.internal_flags,Vt=[null,null];if(ct.Class_ID!=Y)return-3;if(be==0)return 0;Ce(ct,be),Vt[0]=ct.in_buffer_0,Vt[1]=ct.in_buffer_1;for(var kt=0;kt<be;kt++)Vt[0][kt]=Se[kt],ct.channels_in>1&&(Vt[1][kt]=Ie[kt]);return $e(me,Vt[0],Vt[1],be,Ke,ot,lt)};function Xe(me){var Se=y.BLKSIZE+me.framesize-y.FFTOFFSET;return Se=Math.max(Se,512+me.framesize-32),Se}function $e(me,Se,Ie,be,Ke,ot,lt){var ct=me.internal_flags,Vt=0,kt,Ut,je,ge,se,_e=[null,null],Ne=[null,null];if(ct.Class_ID!=Y)return-3;if(be==0)return 0;if(se=I.copy_buffer(ct,Ke,ot,lt,0),se<0)return se;if(ot+=se,Vt+=se,Ne[0]=Se,Ne[1]=Ie,p.NEQ(me.scale,0)&&p.NEQ(me.scale,1))for(Ut=0;Ut<be;++Ut)Ne[0][Ut]*=me.scale,ct.channels_out==2&&(Ne[1][Ut]*=me.scale);if(p.NEQ(me.scale_left,0)&&p.NEQ(me.scale_left,1))for(Ut=0;Ut<be;++Ut)Ne[0][Ut]*=me.scale_left;if(p.NEQ(me.scale_right,0)&&p.NEQ(me.scale_right,1))for(Ut=0;Ut<be;++Ut)Ne[1][Ut]*=me.scale_right;if(me.num_channels==2&&ct.channels_out==1)for(Ut=0;Ut<be;++Ut)Ne[0][Ut]=.5*(Ne[0][Ut]+Ne[1][Ut]),Ne[1][Ut]=0;ge=Xe(me),_e[0]=ct.mfbuf[0],_e[1]=ct.mfbuf[1];for(var Le=0;be>0;){var ke=[null,null],Re=0,st=0;ke[0]=Ne[0],ke[1]=Ne[1];var Ve=new pt;if(Be(me,_e,ke,Le,be,Ve),Re=Ve.n_in,st=Ve.n_out,ct.findReplayGain&&!ct.decode_on_the_fly&&N.AnalyzeSamples(ct.rgdata,_e[0],ct.mf_size,_e[1],ct.mf_size,st,ct.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(be-=Re,Le+=Re,ct.channels_out==2,ct.mf_size+=st,o(ct.mf_size<=u.MFSIZE),ct.mf_samples_to_encode<1&&(ct.mf_samples_to_encode=y.ENCDELAY+y.POSTDELAY),ct.mf_samples_to_encode+=st,ct.mf_size>=ge){var tt=lt-Vt;if(lt==0&&(tt=0),kt=at(me,_e[0],_e[1],Ke,ot,tt),kt<0)return kt;for(ot+=kt,Vt+=kt,ct.mf_size-=me.framesize,ct.mf_samples_to_encode-=me.framesize,je=0;je<ct.channels_out;je++)for(Ut=0;Ut<ct.mf_size;Ut++)_e[je][Ut]=_e[je][Ut+me.framesize]}}return Vt}function at(me,Se,Ie,be,Ke,ot){var lt=E.enc.lame_encode_mp3_frame(me,Se,Ie,be,Ke,ot);return me.frameNum++,lt}function pt(){this.n_in=0,this.n_out=0}function oe(){this.num_used=0}function Ue(me,Se){return Se!=0?Ue(Se,me%Se):me}function Ge(me,Se,Ie){var be=Math.PI*Se;me/=Ie,me<0&&(me=0),me>1&&(me=1);var Ke=me-.5,ot=.42-.5*Math.cos(2*me*Math.PI)+.08*Math.cos(4*me*Math.PI);return Math.abs(Ke)<1e-9?be/Math.PI:ot*Math.sin(Ie*be*Ke)/(Math.PI*Ie*Ke)}function ze(me,Se,Ie,be,Ke,ot,lt,ct,Vt){var kt=me.internal_flags,Ut,je=0,ge,se=me.out_samplerate/Ue(me.out_samplerate,me.in_samplerate);se>u.BPC&&(se=u.BPC);var _e=Math.abs(kt.resample_ratio-Math.floor(.5+kt.resample_ratio))<1e-4?1:0,Ne=1/kt.resample_ratio;Ne>1&&(Ne=1);var Le=31;Le%2==0&&--Le,Le+=_e;var ke=Le+1;if(kt.fill_buffer_resample_init==0){for(kt.inbuf_old[0]=i(ke),kt.inbuf_old[1]=i(ke),Ut=0;Ut<=2*se;++Ut)kt.blackfilt[Ut]=i(ke);for(kt.itime[0]=0,kt.itime[1]=0,je=0;je<=2*se;je++){var Re=0,st=(je-se)/(2*se);for(Ut=0;Ut<=Le;Ut++)Re+=kt.blackfilt[je][Ut]=Ge(Ut-st,Ne,Le);for(Ut=0;Ut<=Le;Ut++)kt.blackfilt[je][Ut]/=Re}kt.fill_buffer_resample_init=1}var Ve=kt.inbuf_old[Vt];for(ge=0;ge<be;ge++){var tt,Ze;if(tt=ge*kt.resample_ratio,je=0|Math.floor(tt-kt.itime[Vt]),Le+je-Le/2>=lt)break;var st=tt-kt.itime[Vt]-(je+.5*(Le%2));Ze=0|Math.floor(st*2*se+se+.5);var nt=0;for(Ut=0;Ut<=Le;++Ut){var vt=0|Ut+je-Le/2,Qe;Qe=vt<0?Ve[ke+vt]:Ke[ot+vt],nt+=Qe*kt.blackfilt[Ze][Ut]}Se[Ie+ge]=nt}if(ct.num_used=Math.min(lt,Le+je-Le/2),kt.itime[Vt]+=ct.num_used-ge*kt.resample_ratio,ct.num_used>=ke)for(Ut=0;Ut<ke;Ut++)Ve[Ut]=Ke[ot+ct.num_used+Ut-ke];else{var ht=ke-ct.num_used;for(Ut=0;Ut<ht;++Ut)Ve[Ut]=Ve[Ut+ct.num_used];for(je=0;Ut<ke;++Ut,++je)Ve[Ut]=Ke[ot+je];o(je==ct.num_used)}return ge}function Be(me,Se,Ie,be,Ke,ot){var lt=me.internal_flags;if(lt.resample_ratio<.9999||lt.resample_ratio>1.0001)for(var ct=0;ct<lt.channels_out;ct++){var Vt=new oe;ot.n_out=ze(me,Se[ct],lt.mf_size,me.framesize,Ie[ct],be,Ke,Vt,ct),ot.n_in=Vt.num_used}else{ot.n_out=Math.min(me.framesize,Ke),ot.n_in=ot.n_out;for(var kt=0;kt<ot.n_out;++kt)Se[0][lt.mf_size+kt]=Ie[0][be+kt],lt.channels_out==2&&(Se[1][lt.mf_size+kt]=Ie[1][be+kt])}}}return rF=v,rF}var dlt=Tc,sv=dlt.VbrMode;function plt(){var n=xV();function e(u,f,d,g,p,_,y,v,x,E,M,O,N,I,D){this.vbr_q=u,this.quant_comp=f,this.quant_comp_s=d,this.expY=g,this.st_lrm=p,this.st_s=_,this.masking_adj=y,this.masking_adj_short=v,this.ath_lower=x,this.ath_curve=E,this.ath_sensitivity=M,this.interch=O,this.safejoint=N,this.sfb21mod=I,this.msfix=D}function t(u,f,d,g,p,_,y,v,x,E,M,O,N,I){this.quant_comp=f,this.quant_comp_s=d,this.safejoint=g,this.nsmsfix=p,this.st_lrm=_,this.st_s=y,this.nsbass=v,this.scale=x,this.masking_adj=E,this.ath_lower=M,this.ath_curve=O,this.interch=N,this.sfscale=I}var r;this.setModules=function(u){r=u};var i=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],s=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function a(u,f,d){var g=u.VBR==sv.vbr_rh?i:s,p=u.VBR_q_frac,_=g[f],y=g[f+1],v=_;_.st_lrm=_.st_lrm+p*(y.st_lrm-_.st_lrm),_.st_s=_.st_s+p*(y.st_s-_.st_s),_.masking_adj=_.masking_adj+p*(y.masking_adj-_.masking_adj),_.masking_adj_short=_.masking_adj_short+p*(y.masking_adj_short-_.masking_adj_short),_.ath_lower=_.ath_lower+p*(y.ath_lower-_.ath_lower),_.ath_curve=_.ath_curve+p*(y.ath_curve-_.ath_curve),_.ath_sensitivity=_.ath_sensitivity+p*(y.ath_sensitivity-_.ath_sensitivity),_.interch=_.interch+p*(y.interch-_.interch),_.msfix=_.msfix+p*(y.msfix-_.msfix),c(u,v.vbr_q),d!=0?u.quant_comp=v.quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=v.quant_comp),d!=0?u.quant_comp_short=v.quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=v.quant_comp_s),v.expY!=0&&(u.experimentalY=v.expY!=0),d!=0?u.internal_flags.nsPsy.attackthre=v.st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=v.st_lrm),d!=0?u.internal_flags.nsPsy.attackthre_s=v.st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=v.st_s),d!=0?u.maskingadjust=v.masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=v.masking_adj),d!=0?u.maskingadjust_short=v.masking_adj_short:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=v.masking_adj_short),d!=0?u.ATHlower=-v.ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-v.ath_lower/10),d!=0?u.ATHcurve=v.ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=v.ath_curve),d!=0?u.athaa_sensitivity=v.ath_sensitivity:Math.abs(u.athaa_sensitivity- -1)>0||(u.athaa_sensitivity=v.ath_sensitivity),v.interch>0&&(d!=0?u.interChRatio=v.interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=v.interch)),v.safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|v.safejoint),v.sfb21mod>0&&(u.exp_nspsytune=u.exp_nspsytune|v.sfb21mod<<20),d!=0?u.msfix=v.msfix:Math.abs(u.msfix- -1)>0||(u.msfix=v.msfix),d==0&&(u.VBR_q=f,u.VBR_q_frac=p)}var o=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(u,f,d){var g=f,p=r.nearestBitrateFullIndex(f);if(u.VBR=sv.vbr_abr,u.VBR_mean_bitrate_kbps=g,u.VBR_mean_bitrate_kbps=Math.min(u.VBR_mean_bitrate_kbps,320),u.VBR_mean_bitrate_kbps=Math.max(u.VBR_mean_bitrate_kbps,8),u.brate=u.VBR_mean_bitrate_kbps,u.VBR_mean_bitrate_kbps>320&&(u.disable_reservoir=!0),o[p].safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|2),o[p].sfscale>0&&(u.internal_flags.noise_shaping=2),Math.abs(o[p].nsbass)>0){var _=int(o[p].nsbass*4);_<0&&(_+=64),u.exp_nspsytune=u.exp_nspsytune|_<<2}return d!=0?u.quant_comp=o[p].quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=o[p].quant_comp),d!=0?u.quant_comp_short=o[p].quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=o[p].quant_comp_s),d!=0?u.msfix=o[p].nsmsfix:Math.abs(u.msfix- -1)>0||(u.msfix=o[p].nsmsfix),d!=0?u.internal_flags.nsPsy.attackthre=o[p].st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=o[p].st_lrm),d!=0?u.internal_flags.nsPsy.attackthre_s=o[p].st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=o[p].st_s),d!=0?u.scale=o[p].scale:Math.abs(u.scale- -1)>0||(u.scale=o[p].scale),d!=0?u.maskingadjust=o[p].masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=o[p].masking_adj),o[p].masking_adj>0?d!=0?u.maskingadjust_short=o[p].masking_adj*.9:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=o[p].masking_adj*.9):d!=0?u.maskingadjust_short=o[p].masking_adj*1.1:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=o[p].masking_adj*1.1),d!=0?u.ATHlower=-o[p].ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-o[p].ath_lower/10),d!=0?u.ATHcurve=o[p].ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=o[p].ath_curve),d!=0?u.interChRatio=o[p].interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=o[p].interch),f}this.apply_preset=function(u,f,d){switch(f){case n.R3MIX:{f=n.V3,u.VBR=sv.vbr_mtrh;break}case n.MEDIUM:{f=n.V4,u.VBR=sv.vbr_rh;break}case n.MEDIUM_FAST:{f=n.V4,u.VBR=sv.vbr_mtrh;break}case n.STANDARD:{f=n.V2,u.VBR=sv.vbr_rh;break}case n.STANDARD_FAST:{f=n.V2,u.VBR=sv.vbr_mtrh;break}case n.EXTREME:{f=n.V0,u.VBR=sv.vbr_rh;break}case n.EXTREME_FAST:{f=n.V0,u.VBR=sv.vbr_mtrh;break}case n.INSANE:return f=320,u.preset=f,l(u,f,d),u.VBR=sv.vbr_off,f}switch(u.preset=f,f){case n.V9:return a(u,9,d),f;case n.V8:return a(u,8,d),f;case n.V7:return a(u,7,d),f;case n.V6:return a(u,6,d),f;case n.V5:return a(u,5,d),f;case n.V4:return a(u,4,d),f;case n.V3:return a(u,3,d),f;case n.V2:return a(u,2,d),f;case n.V1:return a(u,1,d),f;case n.V0:return a(u,0,d),f}return 8<=f&&f<=320?l(u,f,d):(u.preset=0,f)};function c(u,f){var d=0;return 0>f&&(d=-1,f=0),9<f&&(d=-1,f=9),u.VBR_q=f,u.VBR_q_frac=0,d}}var mlt=plt;function glt(){this.setModules=function(n,e){}}var _lt=glt;function vlt(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var ylt=vlt,E_e=Tc,lre=E_e.new_float,blt=E_e.new_int;function Slt(){this.global_gain=0,this.sfb_count1=0,this.step=blt(39),this.noise=lre(39),this.noise_log=lre(39)}var Elt=Slt,aR=Tc,Gb=aR.System,cre=aR.VbrMode,iF=aR.Util,Kx=aR.Arrays,UM=aR.new_float,BM=aR.assert,xlt=_lt,sF=ylt,Tlt=Elt,Ma=op(),ure=vV,fre=JU;function wlt(){var n;this.rv=null;var e;this.qupvt=null;var t,r=new xlt,i;this.setModules=function(v,x,E,M){n=v,e=x,this.rv=x,t=E,this.qupvt=E,i=M,r.setModules(t,i)},this.ms_convert=function(v,x){for(var E=0;E<576;++E){var M=v.tt[x][0].xr[E],O=v.tt[x][1].xr[E];v.tt[x][0].xr[E]=(M+O)*(iF.SQRT2*.5),v.tt[x][1].xr[E]=(M-O)*(iF.SQRT2*.5)}};function s(v,x,E,M){M=0;for(var O=0;O<=E;++O){var N=Math.abs(v.xr[O]);M+=N,x[O]=Math.sqrt(N*Math.sqrt(N)),x[O]>v.xrpow_max&&(v.xrpow_max=x[O])}return M}this.init_xrpow=function(v,x,E){var M=0,O=0|x.max_nonzero_coeff;if(x.xrpow_max=0,Kx.fill(E,O,576,0),M=s(x,E,O,M),M>1e-20){var N=0;v.substep_shaping&2&&(N=1);for(var I=0;I<x.psymax;I++)v.pseudohalf[I]=N;return!0}return Kx.fill(x.l3_enc,0,576,0),!1};function a(v,x){var E=v.ATH,M=x.xr;if(x.block_type!=Ma.SHORT_TYPE)for(var O=!1,N=Ma.PSFB21-1;N>=0&&!O;N--){var I=v.scalefac_band.psfb21[N],D=v.scalefac_band.psfb21[N+1],V=t.athAdjust(E.adjust,E.psfb21[N],E.floor);v.nsPsy.longfact[21]>1e-12&&(V*=v.nsPsy.longfact[21]);for(var G=D-1;G>=I;G--)if(Math.abs(M[G])<V)M[G]=0;else{O=!0;break}}else for(var Q=0;Q<3;Q++)for(var O=!1,N=Ma.PSFB12-1;N>=0&&!O;N--){var I=v.scalefac_band.s[12]*3+(v.scalefac_band.s[13]-v.scalefac_band.s[12])*Q+(v.scalefac_band.psfb12[N]-v.scalefac_band.psfb12[0]),D=I+(v.scalefac_band.psfb12[N+1]-v.scalefac_band.psfb12[N]),B=t.athAdjust(E.adjust,E.psfb12[N],E.floor);v.nsPsy.shortfact[12]>1e-12&&(B*=v.nsPsy.shortfact[12]);for(var G=D-1;G>=I;G--)if(Math.abs(M[G])<B)M[G]=0;else{O=!0;break}}}this.init_outer_loop=function(v,x){x.part2_3_length=0,x.big_values=0,x.count1=0,x.global_gain=210,x.scalefac_compress=0,x.table_select[0]=0,x.table_select[1]=0,x.table_select[2]=0,x.subblock_gain[0]=0,x.subblock_gain[1]=0,x.subblock_gain[2]=0,x.subblock_gain[3]=0,x.region0_count=0,x.region1_count=0,x.preflag=0,x.scalefac_scale=0,x.count1table_select=0,x.part2_length=0,x.sfb_lmax=Ma.SBPSY_l,x.sfb_smin=Ma.SBPSY_s,x.psy_lmax=v.sfb21_extra?Ma.SBMAX_l:Ma.SBPSY_l,x.psymax=x.psy_lmax,x.sfbmax=x.sfb_lmax,x.sfbdivide=11;for(var E=0;E<Ma.SBMAX_l;E++)x.width[E]=v.scalefac_band.l[E+1]-v.scalefac_band.l[E],x.window[E]=3;if(x.block_type==Ma.SHORT_TYPE){var M=UM(576);x.sfb_smin=0,x.sfb_lmax=0,x.mixed_block_flag!=0&&(x.sfb_smin=3,x.sfb_lmax=v.mode_gr*2+4),x.psymax=x.sfb_lmax+3*((v.sfb21_extra?Ma.SBMAX_s:Ma.SBPSY_s)-x.sfb_smin),x.sfbmax=x.sfb_lmax+3*(Ma.SBPSY_s-x.sfb_smin),x.sfbdivide=x.sfbmax-18,x.psy_lmax=x.sfb_lmax;var O=v.scalefac_band.l[x.sfb_lmax];Gb.arraycopy(x.xr,0,M,0,576);for(var E=x.sfb_smin;E<Ma.SBMAX_s;E++)for(var N=v.scalefac_band.s[E],I=v.scalefac_band.s[E+1],D=0;D<3;D++)for(var V=N;V<I;V++)x.xr[O++]=M[3*V+D];for(var G=x.sfb_lmax,E=x.sfb_smin;E<Ma.SBMAX_s;E++)x.width[G]=x.width[G+1]=x.width[G+2]=v.scalefac_band.s[E+1]-v.scalefac_band.s[E],x.window[G]=0,x.window[G+1]=1,x.window[G+2]=2,G+=3}x.count1bits=0,x.sfb_partition_table=t.nr_of_sfb_block[0][0],x.slen[0]=0,x.slen[1]=0,x.slen[2]=0,x.slen[3]=0,x.max_nonzero_coeff=575,Kx.fill(x.scalefac,0),a(v,x)};function o(v){this.ordinal=v}o.BINSEARCH_NONE=new o(0),o.BINSEARCH_UP=new o(1),o.BINSEARCH_DOWN=new o(2);function l(v,x,E,M,O){var N,I=v.CurrentStep[M],D=!1,V=v.OldValue[M],G=o.BINSEARCH_NONE;for(x.global_gain=V,E-=x.part2_length;;){var Q;if(N=i.count_bits(v,O,x,null),I==1||N==E)break;N>E?(G==o.BINSEARCH_DOWN&&(D=!0),D&&(I/=2),G=o.BINSEARCH_UP,Q=I):(G==o.BINSEARCH_UP&&(D=!0),D&&(I/=2),G=o.BINSEARCH_DOWN,Q=-I),x.global_gain+=Q,x.global_gain<0&&(x.global_gain=0,D=!0),x.global_gain>255&&(x.global_gain=255,D=!0)}for(BM(x.global_gain>=0),BM(x.global_gain<256);N>E&&x.global_gain<255;)x.global_gain++,N=i.count_bits(v,O,x,null);return v.CurrentStep[M]=V-x.global_gain>=4?4:2,v.OldValue[M]=x.global_gain,x.part2_3_length=N,N}this.trancate_smallspectrums=function(v,x,E,M){var O=UM(fre.SFBMAX);if(!(!(v.substep_shaping&4)&&x.block_type==Ma.SHORT_TYPE||v.substep_shaping&128)){t.calc_noise(x,E,O,new sF,null);for(var I=0;I<576;I++){var N=0;x.l3_enc[I]!=0&&(N=Math.abs(x.xr[I])),M[I]=N}var I=0,D=8;x.block_type==Ma.SHORT_TYPE&&(D=6);do{var V,G,Q,B,$=x.width[D];if(I+=$,!(O[D]>=1)&&(Kx.sort(M,I-$,$),!BitStream.EQ(M[I-1],0))){V=(1-O[D])*E[D],G=0,B=0;do{var U;for(Q=1;B+Q<$&&!BitStream.NEQ(M[B+I-$],M[B+I+Q-$]);Q++);if(U=M[B+I-$]*M[B+I-$]*Q,V<U){B!=0&&(G=M[B+I-$-1]);break}V-=U,B+=Q}while(B<$);if(!BitStream.EQ(G,0))do Math.abs(x.xr[I-$])<=G&&(x.l3_enc[I-$]=0);while(--$>0)}}while(++D<x.psymax);x.part2_3_length=i.noquant_count_bits(v,x,null)}};function c(v){for(var x=0;x<v.sfbmax;x++)if(v.scalefac[x]+v.subblock_gain[v.window[x]]==0)return!1;return!0}function u(v){return iF.FAST_LOG10(.368+.632*v*v*v)}function f(v,x){for(var E=1e-37,M=0;M<x.psymax;M++)E+=u(v[M]);return Math.max(1e-20,E)}function d(v,x,E,M,O){var N;switch(v){default:case 9:{x.over_count>0?(N=E.over_SSD<=x.over_SSD,E.over_SSD==x.over_SSD&&(N=E.bits<x.bits)):N=E.max_noise<0&&E.max_noise*10+E.bits<=x.max_noise*10+x.bits;break}case 0:N=E.over_count<x.over_count||E.over_count==x.over_count&&E.over_noise<x.over_noise||E.over_count==x.over_count&&BitStream.EQ(E.over_noise,x.over_noise)&&E.tot_noise<x.tot_noise;break;case 8:E.max_noise=f(O,M);case 1:N=E.max_noise<x.max_noise;break;case 2:N=E.tot_noise<x.tot_noise;break;case 3:N=E.tot_noise<x.tot_noise&&E.max_noise<x.max_noise;break;case 4:N=E.max_noise<=0&&x.max_noise>.2||E.max_noise<=0&&x.max_noise<0&&x.max_noise>E.max_noise-.2&&E.tot_noise<x.tot_noise||E.max_noise<=0&&x.max_noise>0&&x.max_noise>E.max_noise-.2&&E.tot_noise<x.tot_noise+x.over_noise||E.max_noise>0&&x.max_noise>-.05&&x.max_noise>E.max_noise-.1&&E.tot_noise+E.over_noise<x.tot_noise+x.over_noise||E.max_noise>0&&x.max_noise>-.1&&x.max_noise>E.max_noise-.15&&E.tot_noise+E.over_noise+E.over_noise<x.tot_noise+x.over_noise+x.over_noise;break;case 5:N=E.over_noise<x.over_noise||BitStream.EQ(E.over_noise,x.over_noise)&&E.tot_noise<x.tot_noise;break;case 6:N=E.over_noise<x.over_noise||BitStream.EQ(E.over_noise,x.over_noise)&&(E.max_noise<x.max_noise||BitStream.EQ(E.max_noise,x.max_noise)&&E.tot_noise<=x.tot_noise);break;case 7:N=E.over_count<x.over_count||E.over_noise<x.over_noise;break}return x.over_count==0&&(N=N&&E.bits<x.bits),N}function g(v,x,E,M,O){var N=v.internal_flags,I;x.scalefac_scale==0?I=1.2968395546510096:I=1.6817928305074292;for(var D=0,V=0;V<x.sfbmax;V++)D<E[V]&&(D=E[V]);var G=N.noise_shaping_amp;switch(G==3&&(O?G=2:G=1),G){case 2:break;case 1:D>1?D=Math.pow(D,.5):D*=.95;break;case 0:default:D>1?D=1:D*=.95;break}for(var Q=0,V=0;V<x.sfbmax;V++){var B=x.width[V],$;if(Q+=B,!(E[V]<D)){if(N.substep_shaping&2&&(N.pseudohalf[V]=N.pseudohalf[V]==0?1:0,N.pseudohalf[V]==0&&N.noise_shaping_amp==2))return;for(x.scalefac[V]++,$=-B;$<0;$++)M[Q+$]*=I,M[Q+$]>x.xrpow_max&&(x.xrpow_max=M[Q+$]);if(N.noise_shaping_amp==2)return}}}function p(v,x){for(var E=1.2968395546510096,M=0,O=0;O<v.sfbmax;O++){var N=v.width[O],I=v.scalefac[O];if(v.preflag!=0&&(I+=t.pretab[O]),M+=N,I&1){I++;for(var D=-N;D<0;D++)x[M+D]*=E,x[M+D]>v.xrpow_max&&(v.xrpow_max=x[M+D])}v.scalefac[O]=I>>1}v.preflag=0,v.scalefac_scale=1}function _(v,x,E){var M,O=x.scalefac;for(M=0;M<x.sfb_lmax;M++)if(O[M]>=16)return!0;for(var N=0;N<3;N++){var I=0,D=0;for(M=x.sfb_lmax+N;M<x.sfbdivide;M+=3)I<O[M]&&(I=O[M]);for(;M<x.sfbmax;M+=3)D<O[M]&&(D=O[M]);if(!(I<16&&D<8)){if(x.subblock_gain[N]>=7)return!0;x.subblock_gain[N]++;var V=v.scalefac_band.l[x.sfb_lmax];for(M=x.sfb_lmax+N;M<x.sfbmax;M+=3){var G,Q=x.width[M],B=O[M];if(B=B-(4>>x.scalefac_scale),B>=0){O[M]=B,V+=Q*3;continue}O[M]=0;{var $=210+(B<<x.scalefac_scale+1);G=t.IPOW20($)}V+=Q*(N+1);for(var U=-Q;U<0;U++)E[V+U]*=G,E[V+U]>x.xrpow_max&&(x.xrpow_max=E[V+U]);V+=Q*(3-N-1)}{var G=t.IPOW20(202);V+=x.width[M]*(N+1);for(var U=-x.width[M];U<0;U++)E[V+U]*=G,E[V+U]>x.xrpow_max&&(x.xrpow_max=E[V+U])}}}return!1}function y(v,x,E,M,O){var N=v.internal_flags;g(v,x,E,M,O);var I=c(x);return I?!1:(N.mode_gr==2?I=i.scale_bitcount(x):I=i.scale_bitcount_lsf(N,x),I?(N.noise_shaping>1&&(Kx.fill(N.pseudohalf,0),x.scalefac_scale==0?(p(x,M),I=!1):x.block_type==Ma.SHORT_TYPE&&N.subblock_gain>0&&(I=_(N,x,M)||c(x))),I||(N.mode_gr==2?I=i.scale_bitcount(x):I=i.scale_bitcount_lsf(N,x)),!I):!0)}this.outer_loop=function(v,x,E,M,O,N){var I=v.internal_flags,D=new ure,V=UM(576),G=UM(fre.SFBMAX),Q=new sF,B,$=new Tlt,U=9999999,J=!1,W=!1,q=0;if(l(I,x,N,O,M),I.noise_shaping==0)return 100;t.calc_noise(x,E,G,Q,$),Q.bits=x.part2_3_length,D.assign(x);var Y=0;for(Gb.arraycopy(M,0,V,0,576);!J;){do{var ae=new sF,Z,K=255;if(I.substep_shaping&2?Z=20:Z=3,I.sfb21_extra&&(G[D.sfbmax]>1||D.block_type==Ma.SHORT_TYPE&&(G[D.sfbmax+1]>1||G[D.sfbmax+2]>1))||!y(v,D,G,M,W))break;D.scalefac_scale!=0&&(K=254);var ne=N-D.part2_length;if(ne<=0)break;for(;(D.part2_3_length=i.count_bits(I,M,D,$))>ne&&D.global_gain<=K;)D.global_gain++;if(D.global_gain>K)break;if(Q.over_count==0){for(;(D.part2_3_length=i.count_bits(I,M,D,$))>U&&D.global_gain<=K;)D.global_gain++;if(D.global_gain>K)break}if(t.calc_noise(D,E,G,ae,$),ae.bits=D.part2_3_length,x.block_type!=Ma.SHORT_TYPE?B=v.quant_comp:B=v.quant_comp_short,B=d(B,Q,ae,D,G)?1:0,B!=0)U=x.part2_3_length,Q=ae,x.assign(D),Y=0,Gb.arraycopy(M,0,V,0,576);else if(I.full_outer_loop==0&&(++Y>Z&&Q.over_count==0||I.noise_shaping_amp==3&&W&&Y>30||I.noise_shaping_amp==3&&W&&D.global_gain-q>15))break}while(D.global_gain+D.scalefac_scale<255);I.noise_shaping_amp==3?W?J=!0:(D.assign(x),Gb.arraycopy(V,0,M,0,576),Y=0,q=D.global_gain,W=!0):J=!0}return BM(x.global_gain+x.scalefac_scale<=255),v.VBR==cre.vbr_rh||v.VBR==cre.vbr_mtrh?Gb.arraycopy(V,0,M,0,576):I.substep_shaping&1&&trancate_smallspectrums(I,x,E,M),Q.over_count},this.iteration_finish_one=function(v,x,E){var M=v.l3_side,O=M.tt[x][E];i.best_scalefac_store(v,x,E,M),v.use_best_huffman==1&&i.best_huffman_divide(v,O),e.ResvAdjust(v,O)},this.VBR_encode_granule=function(v,x,E,M,O,N,I){var D=v.internal_flags,V=new ure,G=UM(576),Q=I,B=I+1,$=(I+N)/2,U,J,W=0,q=D.sfb21_extra;BM(Q<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Kx.fill(V.l3_enc,0);do $>Q-42?D.sfb21_extra=!1:D.sfb21_extra=q,J=outer_loop(v,x,E,M,O,$),J<=0?(W=1,B=x.part2_3_length,V.assign(x),Gb.arraycopy(M,0,G,0,576),I=B-32,U=I-N,$=(I+N)/2):(N=$+32,U=I-N,$=(I+N)/2,W!=0&&(W=2,x.assign(V),Gb.arraycopy(G,0,M,0,576)));while(U>12);D.sfb21_extra=q,W==2&&Gb.arraycopy(V.l3_enc,0,x.l3_enc,0,576),BM(x.part2_3_length<=Q)},this.get_framebits=function(v,x){var E=v.internal_flags;E.bitrate_index=E.VBR_min_bitrate;var M=n.getframebits(v);E.bitrate_index=1,M=n.getframebits(v);for(var O=1;O<=E.VBR_max_bitrate;O++){E.bitrate_index=O;var N=new MeanBits(M);x[O]=e.ResvFrameBegin(v,N),M=N.bits}},this.VBR_old_prepare=function(v,x,E,M,O,N,I,D,V){var G=v.internal_flags,Q,B=0,$=1,U=0;G.bitrate_index=G.VBR_max_bitrate;var J=e.ResvFrameBegin(v,new MeanBits(0))/G.mode_gr;get_framebits(v,N);for(var W=0;W<G.mode_gr;W++){var q=t.on_pe(v,x,D[W],J,W,0);G.mode_ext==Ma.MPG_MD_MS_LR&&(ms_convert(G.l3_side,W),t.reduce_side(D[W],E[W],J,q));for(var Y=0;Y<G.channels_out;++Y){var ae=G.l3_side.tt[W][Y];ae.block_type!=Ma.SHORT_TYPE?(B=1.28/(1+Math.exp(3.5-x[W][Y]/300))-.05,Q=G.PSY.mask_adjust-B):(B=2.56/(1+Math.exp(3.5-x[W][Y]/300))-.14,Q=G.PSY.mask_adjust_short-B),G.masking_lower=Math.pow(10,Q*.1),init_outer_loop(G,ae),V[W][Y]=t.calc_xmin(v,M[W][Y],ae,O[W][Y]),V[W][Y]!=0&&($=0),I[W][Y]=126,U+=D[W][Y]}}for(var W=0;W<G.mode_gr;W++)for(var Y=0;Y<G.channels_out;Y++)U>N[G.VBR_max_bitrate]&&(D[W][Y]*=N[G.VBR_max_bitrate],D[W][Y]/=U),I[W][Y]>D[W][Y]&&(I[W][Y]=D[W][Y]);return $},this.bitpressure_strategy=function(v,x,E,M){for(var O=0;O<v.mode_gr;O++)for(var N=0;N<v.channels_out;N++){for(var I=v.l3_side.tt[O][N],D=x[O][N],V=0,G=0;G<I.psy_lmax;G++)D[V++]*=1+.029*G*G/Ma.SBMAX_l/Ma.SBMAX_l;if(I.block_type==Ma.SHORT_TYPE)for(var G=I.sfb_smin;G<Ma.SBMAX_s;G++)D[V++]*=1+.029*G*G/Ma.SBMAX_s/Ma.SBMAX_s,D[V++]*=1+.029*G*G/Ma.SBMAX_s/Ma.SBMAX_s,D[V++]*=1+.029*G*G/Ma.SBMAX_s/Ma.SBMAX_s;M[O][N]=0|Math.max(E[O][N],.9*M[O][N])}},this.VBR_new_prepare=function(v,x,E,M,O,N){var I=v.internal_flags,D=1,V=0,G=0,Q;if(v.free_format){I.bitrate_index=0;var B=new MeanBits(V);Q=e.ResvFrameBegin(v,B),V=B.bits,O[0]=Q}else{I.bitrate_index=I.VBR_max_bitrate;var B=new MeanBits(V);e.ResvFrameBegin(v,B),V=B.bits,get_framebits(v,O),Q=O[I.VBR_max_bitrate]}for(var $=0;$<I.mode_gr;$++){t.on_pe(v,x,N[$],V,$,0),I.mode_ext==Ma.MPG_MD_MS_LR&&ms_convert(I.l3_side,$);for(var U=0;U<I.channels_out;++U){var J=I.l3_side.tt[$][U];I.masking_lower=Math.pow(10,I.PSY.mask_adjust*.1),init_outer_loop(I,J),t.calc_xmin(v,E[$][U],J,M[$][U])!=0&&(D=0),G+=N[$][U]}}for(var $=0;$<I.mode_gr;$++)for(var U=0;U<I.channels_out;U++)G>Q&&(N[$][U]*=Q,N[$][U]/=G);return D},this.calc_target_bits=function(v,x,E,M,O,N){var I=v.internal_flags,D=I.l3_side,V,G,Q,B,$=0;I.bitrate_index=I.VBR_max_bitrate;var U=new MeanBits($);for(N[0]=e.ResvFrameBegin(v,U),$=U.bits,I.bitrate_index=1,$=n.getframebits(v)-I.sideinfo_len*8,O[0]=$/(I.mode_gr*I.channels_out),$=v.VBR_mean_bitrate_kbps*v.framesize*1e3,I.substep_shaping&1&&($*=1.09),$/=v.out_samplerate,$-=I.sideinfo_len*8,$/=I.mode_gr*I.channels_out,V=.93+.07*(11-v.compression_ratio)/(11-5.5),V<.9&&(V=.9),V>1&&(V=1),G=0;G<I.mode_gr;G++){var J=0;for(Q=0;Q<I.channels_out;Q++){if(M[G][Q]=int(V*$),x[G][Q]>700){var W=int((x[G][Q]-700)/1.4),q=D.tt[G][Q];M[G][Q]=int(V*$),q.block_type==Ma.SHORT_TYPE&&W<$/2&&(W=$/2),W>$*3/2?W=$*3/2:W<0&&(W=0),M[G][Q]+=W}M[G][Q]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[G][Q]=LameInternalFlags.MAX_BITS_PER_CHANNEL),J+=M[G][Q]}if(J>LameInternalFlags.MAX_BITS_PER_GRANULE)for(Q=0;Q<I.channels_out;++Q)M[G][Q]*=LameInternalFlags.MAX_BITS_PER_GRANULE,M[G][Q]/=J}if(I.mode_ext==Ma.MPG_MD_MS_LR)for(G=0;G<I.mode_gr;G++)t.reduce_side(M[G],E[G],$*I.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(B=0,G=0;G<I.mode_gr;G++)for(Q=0;Q<I.channels_out;Q++)M[G][Q]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(M[G][Q]=LameInternalFlags.MAX_BITS_PER_CHANNEL),B+=M[G][Q];if(B>N[0])for(G=0;G<I.mode_gr;G++)for(Q=0;Q<I.channels_out;Q++)M[G][Q]*=N[0],M[G][Q]/=B}}var Rlt=wlt,Alt=Tc,hre=Alt.assert;function Clt(){var n;this.setModules=function(e){n=e},this.ResvFrameBegin=function(e,t){var r=e.internal_flags,i,s=r.l3_side,a=n.getframebits(e);t.bits=(a-r.sideinfo_len*8)/r.mode_gr;var o=8*256*r.mode_gr-8;e.brate>320?i=8*int(e.brate*1e3/(e.out_samplerate/1152)/8+.5):(i=8*1440,e.strict_ISO&&(i=8*int(32e4/(e.out_samplerate/1152)/8+.5))),r.ResvMax=i-a,r.ResvMax>o&&(r.ResvMax=o),(r.ResvMax<0||e.disable_reservoir)&&(r.ResvMax=0);var l=t.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return l>i&&(l=i),hre(r.ResvMax%8==0),hre(r.ResvMax>=0),s.resvDrain_pre=0,r.pinfo!=null&&(r.pinfo.mean_bits=t.bits/2,r.pinfo.resvsize=r.ResvSize),l},this.ResvMaxBits=function(e,t,r,i){var s=e.internal_flags,a,o=s.ResvSize,l=s.ResvMax;i!=0&&(o+=t),s.substep_shaping&1&&(l*=.9),r.bits=t,o*10>l*9?(a=o-l*9/10,r.bits+=a,s.substep_shaping|=128):(a=0,s.substep_shaping&=127,!e.disable_reservoir&&!(s.substep_shaping&1)&&(r.bits-=.1*t));var c=o<s.ResvMax*6/10?o:s.ResvMax*6/10;return c-=a,c<0&&(c=0),c},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var r,i=e.l3_side;e.ResvSize+=t*e.mode_gr;var s=0;i.resvDrain_post=0,i.resvDrain_pre=0,(r=e.ResvSize%8)!=0&&(s+=r),r=e.ResvSize-s-e.ResvMax,r>0&&(s+=r);{var a=Math.min(i.main_data_begin*8,s)/8;i.resvDrain_pre+=8*a,s-=8*a,e.ResvSize-=8*a,i.main_data_begin-=a}i.resvDrain_post+=s,e.ResvSize-=s}}var Mlt=Clt;function klt(){var n="http://www.mp3dev.org/",e=3,t=98,r=4,i=0,s=93;this.getLameVersion=function(){return e+"."+t+"."+r},this.getLameShortVersion=function(){return e+"."+t+"."+r},this.getLameVeryShortVersion=function(){return"LAME"+e+"."+t+"r"},this.getPsyVersion=function(){return i+"."+s},this.getLameUrl=function(){return n},this.getLameOsBitness=function(){return"32bits"}}var Olt=klt,oR=Tc,Ilt=oR.System,aF=oR.VbrMode,dre=oR.ShortBlock,Nlt=oR.Arrays,dN=oR.new_byte,Plt=oR.assert;Bk.NUMTOCENTRIES=100;Bk.MAXFRAMESIZE=2880;function Bk(){var n,e,t;this.setModules=function($,U,J){n=$,e=U,t=J};var r=1,i=2,s=4,a=8,o=Bk.NUMTOCENTRIES,l=Bk.MAXFRAMESIZE,c=o+4+4+4+4+4,u=c+9+1+1+8+1+1+3+1+1+2+4+2+2,f=128,d=64,g=32,p=null,_="Xing",y="Info",v=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function x($,U){if($.nVbrNumFrames++,$.sum+=U,$.seen++,!($.seen<$.want)&&($.pos<$.size&&($.bag[$.pos]=$.sum,$.pos++,$.seen=0),$.pos==$.size)){for(var J=1;J<$.size;J+=2)$.bag[J/2]=$.bag[J];$.want*=2,$.pos/=2}}function E($,U){if(!($.pos<=0))for(var J=1;J<o;++J){var W=J/o,q,Y,ae=0|Math.floor(W*$.pos);ae>$.pos-1&&(ae=$.pos-1),q=$.bag[ae],Y=$.sum;var Z=0|256*q/Y;Z>255&&(Z=255),U[J]=255&Z}}this.addVbrFrame=function($){var U=$.internal_flags,J=Tables.bitrate_table[$.version][U.bitrate_index];Plt(U.VBR_seek_table.bag!=null),x(U.VBR_seek_table,J)};function M($,U){var J=$[U+0]&255;return J<<=8,J|=$[U+1]&255,J<<=8,J|=$[U+2]&255,J<<=8,J|=$[U+3]&255,J}function O($,U,J){$[U+0]=255&(J>>24&255),$[U+1]=255&(J>>16&255),$[U+2]=255&(J>>8&255),$[U+3]=255&(J&255)}function N($,U,J){$[U+0]=255&(J>>8&255),$[U+1]=255&(J&255)}function I($,U){return new String($,U,_.length(),p).equals(_)||new String($,U,y.length(),p).equals(y)}function D($,U,J){return 255&($<<U|J&~(-1<<U))}function V($,U){var J=$.internal_flags;U[0]=D(U[0],8,255),U[1]=D(U[1],3,7),U[1]=D(U[1],1,$.out_samplerate<16e3?0:1),U[1]=D(U[1],1,$.version),U[1]=D(U[1],2,1),U[1]=D(U[1],1,$.error_protection?0:1),U[2]=D(U[2],4,J.bitrate_index),U[2]=D(U[2],2,J.samplerate_index),U[2]=D(U[2],1,0),U[2]=D(U[2],1,$.extension),U[3]=D(U[3],2,$.mode.ordinal()),U[3]=D(U[3],2,J.mode_ext),U[3]=D(U[3],1,$.copyright),U[3]=D(U[3],1,$.original),U[3]=D(U[3],2,$.emphasis),U[0]=255;var W=255&(U[1]&241),q;$.version==1?q=f:$.out_samplerate<16e3?q=g:q=d,$.VBR==aF.vbr_off&&(q=$.brate);var Y;$.free_format?Y=0:Y=255&16*n.BitrateIndex(q,$.version,$.out_samplerate),$.version==1?(U[1]=255&(W|10),W=255&(U[2]&13),U[2]=255&(Y|W)):(U[1]=255&(W|2),W=255&(U[2]&13),U[2]=255&(Y|W))}this.getVbrTag=function($){var U=new VBRTagData,J=0;U.flags=0;var W=$[J+1]>>3&1,q=$[J+2]>>2&3,Y=$[J+3]>>6&3,ae=$[J+2]>>4&15;if(ae=Tables.bitrate_table[W][ae],$[J+1]>>4==14?U.samprate=Tables.samplerate_table[2][q]:U.samprate=Tables.samplerate_table[W][q],W!=0?Y!=3?J+=36:J+=21:Y!=3?J+=21:J+=13,!I($,J))return null;J+=4,U.hId=W;var Z=U.flags=M($,J);if(J+=4,Z&r&&(U.frames=M($,J),J+=4),Z&i&&(U.bytes=M($,J),J+=4),Z&s){if(U.toc!=null)for(var K=0;K<o;K++)U.toc[K]=$[J+K];J+=o}U.vbrScale=-1,Z&a&&(U.vbrScale=M($,J),J+=4),U.headersize=(W+1)*72e3*ae/U.samprate,J+=21;var ne=$[J+0]<<4;ne+=$[J+1]>>4;var le=($[J+1]&15)<<8;return le+=$[J+2]&255,(ne<0||ne>3e3)&&(ne=-1),(le<0||le>3e3)&&(le=-1),U.encDelay=ne,U.encPadding=le,U},this.InitVbrTag=function($){var U=$.internal_flags,J;$.version==1?J=f:$.out_samplerate<16e3?J=g:J=d,$.VBR==aF.vbr_off&&(J=$.brate);var W=($.version+1)*72e3*J/$.out_samplerate,q=U.sideinfo_len+u;if(U.VBR_seek_table.TotalFrameSize=W,W<q||W>l){$.bWriteVbrTag=!1;return}U.VBR_seek_table.nVbrNumFrames=0,U.VBR_seek_table.nBytesWritten=0,U.VBR_seek_table.sum=0,U.VBR_seek_table.seen=0,U.VBR_seek_table.want=1,U.VBR_seek_table.pos=0,U.VBR_seek_table.bag==null&&(U.VBR_seek_table.bag=new int[400],U.VBR_seek_table.size=400);var Y=dN(l);V($,Y);for(var ae=U.VBR_seek_table.TotalFrameSize,Z=0;Z<ae;++Z)e.add_dummy_byte($,Y[Z]&255,1)};function G($,U){var J=U^$;return U=U>>8^v[J&255],U}this.updateMusicCRC=function($,U,J,W){for(var q=0;q<W;++q)$[0]=G(U[J+q],$[0])};function Q($,U,J,W,q){var Y=$.internal_flags,ae=0,Z=$.encoder_delay,K=$.encoder_padding,ne=100-10*$.VBR_q-$.quality,le=t.getLameVeryShortVersion(),ce,de=0,Me,qe=[1,5,3,2,4,0,3],Pe=0|($.lowpassfreq/100+.5>255?255:$.lowpassfreq/100+.5),Ce=0,Xe=0,$e=0,at=$.internal_flags.noise_shaping,pt=0,oe=0,Ue=0,Ge=0,ze=0,Be=($.exp_nspsytune&1)!=0,me=($.exp_nspsytune&2)!=0,Se=!1,Ie=!1,be=$.internal_flags.nogap_total,Ke=$.internal_flags.nogap_current,ot=$.ATHtype,lt=0,ct;switch($.VBR){case vbr_abr:ct=$.VBR_mean_bitrate_kbps;break;case vbr_off:ct=$.brate;break;default:ct=$.VBR_min_bitrate_kbps}switch($.VBR.ordinal()<qe.length?ce=qe[$.VBR.ordinal()]:ce=0,Me=16*de+ce,Y.findReplayGain&&(Y.RadioGain>510&&(Y.RadioGain=510),Y.RadioGain<-510&&(Y.RadioGain=-510),Xe=8192,Xe|=3072,Y.RadioGain>=0?Xe|=Y.RadioGain:(Xe|=512,Xe|=-Y.RadioGain)),Y.findPeakSample&&(Ce=Math.abs(0|Y.PeakSample/32767*Math.pow(2,23)+.5)),be!=-1&&(Ke>0&&(Ie=!0),Ke<be-1&&(Se=!0)),lt=ot+((Be?1:0)<<4)+((me?1:0)<<5)+((Se?1:0)<<6)+((Ie?1:0)<<7),ne<0&&(ne=0),$.mode){case MONO:pt=0;break;case STEREO:pt=1;break;case DUAL_CHANNEL:pt=2;break;case JOINT_STEREO:$.force_ms?pt=4:pt=3;break;case NOT_SET:default:pt=7;break}$.in_samplerate<=32e3?Ue=0:$.in_samplerate==48e3?Ue=2:$.in_samplerate>48e3?Ue=3:Ue=1,($.short_blocks==dre.short_block_forced||$.short_blocks==dre.short_block_dispensed||$.lowpassfreq==-1&&$.highpassfreq==-1||$.scale_left<$.scale_right||$.scale_left>$.scale_right||$.disable_reservoir&&$.brate<320||$.noATH||$.ATHonly||ot==0||$.in_samplerate<=32e3)&&(oe=1),Ge=at+(pt<<2)+(oe<<5)+(Ue<<6),ze=Y.nMusicCRC,O(J,W+ae,ne),ae+=4;for(var Vt=0;Vt<9;Vt++)J[W+ae+Vt]=255&le.charAt(Vt);ae+=9,J[W+ae]=255&Me,ae++,J[W+ae]=255&Pe,ae++,O(J,W+ae,Ce),ae+=4,N(J,W+ae,Xe),ae+=2,N(J,W+ae,$e),ae+=2,J[W+ae]=255&lt,ae++,ct>=255?J[W+ae]=255:J[W+ae]=255&ct,ae++,J[W+ae]=255&Z>>4,J[W+ae+1]=255&(Z<<4)+(K>>8),J[W+ae+2]=255&K,ae+=3,J[W+ae]=255&Ge,ae++,J[W+ae++]=0,N(J,W+ae,$.preset),ae+=2,O(J,W+ae,U),ae+=4,N(J,W+ae,ze),ae+=2;for(var kt=0;kt<ae;kt++)q=G(J[W+kt],q);return N(J,W+ae,q),ae+=2,ae}function B($){$.seek(0);var U=dN(10);$.readFully(U);var J;return new String(U,"ISO-8859-1").startsWith("ID3")?J=0:J=((U[6]&127)<<21|(U[7]&127)<<14|(U[8]&127)<<7|U[9]&127)+U.length,J}this.getLameTagFrame=function($,U){var J=$.internal_flags;if(!$.bWriteVbrTag||J.Class_ID!=Lame.LAME_ID||J.VBR_seek_table.pos<=0)return 0;if(U.length<J.VBR_seek_table.TotalFrameSize)return J.VBR_seek_table.TotalFrameSize;Nlt.fill(U,0,J.VBR_seek_table.TotalFrameSize,0),V($,U);var W=dN(o);if($.free_format)for(var q=1;q<o;++q)W[q]=255&255*q/100;else E(J.VBR_seek_table,W);var Y=J.sideinfo_len;$.error_protection&&(Y-=2),$.VBR==aF.vbr_off?(U[Y++]=255&y.charAt(0),U[Y++]=255&y.charAt(1),U[Y++]=255&y.charAt(2),U[Y++]=255&y.charAt(3)):(U[Y++]=255&_.charAt(0),U[Y++]=255&_.charAt(1),U[Y++]=255&_.charAt(2),U[Y++]=255&_.charAt(3)),O(U,Y,r+i+s+a),Y+=4,O(U,Y,J.VBR_seek_table.nVbrNumFrames),Y+=4;var ae=J.VBR_seek_table.nBytesWritten+J.VBR_seek_table.TotalFrameSize;O(U,Y,0|ae),Y+=4,Ilt.arraycopy(W,0,U,Y,W.length),Y+=W.length,$.error_protection&&e.CRC_writeheader(J,U);for(var Z=0,q=0;q<Y;q++)Z=G(U[q],Z);return Y+=Q($,ae,U,Y,Z),J.VBR_seek_table.TotalFrameSize},this.putVbrTag=function($,U){var J=$.internal_flags;if(J.VBR_seek_table.pos<=0||(U.seek(U.length()),U.length()==0))return-1;var W=B(U);U.seek(W);var q=dN(l),Y=getLameTagFrame($,q);return Y>q.length?-1:(Y<1||U.write(q,0,Y),0)}}var Dlt=Bk,x_e=Tc,pre=x_e.new_byte,Llt=x_e.assert,Ult=xV(),Blt=mlt,Flt=__e,zlt=b_e(),jlt=Rlt,Hlt=S_e(),qlt=Mlt,Vlt=KO,Glt=EV();op();var $lt=Olt,Wlt=Dlt;function Ylt(){this.setModules=function(n,e){}}function Xlt(){this.setModules=function(n,e,t){}}function Klt(){}function Zlt(){this.setModules=function(n,e){}}function Qlt(n,e,t){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),n=1,e=44100,t=128);var r=new Ult,i=new Ylt,s=new Flt,a=new Glt,o=new Blt,l=new zlt,c=new jlt,u=new Wlt,f=new $lt,d=new Zlt,g=new qlt,p=new Hlt,_=new Xlt,y=new Klt;r.setModules(s,a,o,l,c,u,f,d,y),a.setModules(s,y,f,u),d.setModules(a,f),o.setModules(r),c.setModules(a,g,l,p),l.setModules(p,g,r.enc.psy),g.setModules(a),p.setModules(l),u.setModules(r,a,f),i.setModules(_,y),_.setModules(f,d,o);var v=r.lame_init();v.num_channels=n,v.in_samplerate=e,v.brate=t,v.mode=Vlt.STEREO,v.quality=3,v.bWriteVbrTag=!1,v.disable_reservoir=!0,v.write_id3tag_automatic=!1,r.lame_init_params(v);var x=1152,E=0|1.25*x+7200,M=pre(E);this.encodeBuffer=function(O,N){n==1&&(N=O),Llt(O.length==N.length),O.length>x&&(x=O.length,E=0|1.25*x+7200,M=pre(E));var I=r.lame_encode_buffer(v,O,N,O.length,M,0,E);return new Int8Array(M.subarray(0,I))},this.flush=function(){var O=r.lame_encode_flush(v,M,0,E);return new Int8Array(M.subarray(0,O))}}function gv(){this.dataOffset=0,this.dataLen=0,this.channels=0,this.sampleRate=0}function t5(n){return n.charCodeAt(0)<<24|n.charCodeAt(1)<<16|n.charCodeAt(2)<<8|n.charCodeAt(3)}gv.RIFF=t5("RIFF");gv.WAVE=t5("WAVE");gv.fmt_=t5("fmt ");gv.data=t5("data");gv.readHeader=function(n){var e=new gv,t=n.getUint32(0,!1);if(gv.RIFF==t&&(n.getUint32(4,!0),gv.WAVE==n.getUint32(8,!1)&&gv.fmt_==n.getUint32(12,!1))){var r=n.getUint32(16,!0),i=20;switch(r){case 16:case 18:e.channels=n.getUint16(i+2,!0),e.sampleRate=n.getUint32(i+4,!0);break;default:throw"extended fmt chunk not implemented"}i+=r;for(var s=gv.data,a=0;s!=t&&(t=n.getUint32(i,!1),a=n.getUint32(i+4,!0),s!=t);)i+=a+8;return e.dataLen=a,e.dataOffset=i+8,e}};var Jlt=Qlt;async function ect(n){const e=ss(),t=n.getChannelData(0),r=n.sampleRate,i=new Jlt(1,r,128),s=1152,a=[];for(let l=0;l<t.length;l+=s){a.length%64===0&&es(xt,e,`encoding chunk (${l}/${t.length})`);const c=new Int16Array(s);for(let f=0;f<s;f++)l+f<t.length&&(c[f]=t[l+f]<0?t[l+f]*32768:t[l+f]*32767);const u=i.encodeBuffer(c);u.length>0&&a.push(u),a.length%16===0&&await Ch(10)}const o=i.flush();return o.length>0&&a.push(o),es(xt,e,`total chunks ${a.length+1}`),await Ch(100),new Uint8Array(a.reduce((l,c)=>{const u=new Uint8Array(l.length+c.length);return u.set(l,0),u.set(c,l.length),u},new Uint8Array(0)))}const mre=4,tct={a:1,b:2,c:3,d:4,e:5,f:6,g:7,x:8,A:1,B:2,C:3,D:4,E:5,F:6,G:7,X:8,"#":9,"!":10,y:13,t:14,s:15,i:16,q:17,h:18,w:19,Y:13,T:14,S:15,I:16,Q:17,H:18,W:19,3:20,".":21,"+":11,"-":12,0:22,1:23,2:24,p:25,4:26,5:27,6:29,7:28,8:30,9:31},T_e="64n";function nct(n){return Rh({[T_e]:n}).toNotation()}function rct(n){return Rh({[T_e]:n}).toSeconds()}function ict(n,e,t,r=!0){let i=e,s=4,a=2,o="",l="";const c=[];function u(){l="",o="",i+=rct(a)}function f(){const d=nct(a);l===null?(c.push([i,[n,d,l]]),u()):Mn(l)?(c.push([i,[n,d,l]]),u()):l.startsWith("#")?(c.push([i,[n,d,l]]),u()):l!==""&&(c.push([i,[n,d,`${l}${o}${s}`]]),u())}if(Vn(t))l=t;else for(let d=0;d<t.length;++d){switch(t[d]){case 9:case 10:break;default:f();break}switch(t[d]){case 1:l="A";break;case 2:l="B";break;case 3:l="C";break;case 4:l="D";break;case 5:l="E";break;case 6:l="F";break;case 7:l="G";break;case 8:l=null;break;case 9:o+="#";break;case 10:o+="b";break;case 11:s<8&&++s;break;case 12:s>0&&--s;break;case 13:a=1;break;case 14:a=2;break;case 15:a=4;break;case 16:a=8;break;case 17:a=16;break;case 18:a=32;break;case 19:a=64;break;case 20:a=Math.round(a/3);break;case 21:a=Math.round(a*3/2);break;case 22:l=0;break;case 23:l=1;break;case 24:l=2;break;case 25:l=3;break;case 26:l=4;break;case 27:l=5;break;case 29:l=6;break;case 28:l=7;break;case 30:l=8;break;case 31:l=9;break}}return f(),r&&c.push([i,[n,"8n",-1]]),c}function gre(n){const e=[],t=n.split(";");for(let r=0;r<t.length;++r){const i=[],s=t[r];if(s.startsWith("#"))e.push(s);else{for(let a=0;a<s.length;++a){const o=tct[s[a]];xe(o)&&i.push(o)}e.push(i)}}return e}const sct="/assets/sidechainworklet-ByNOiUo8.js";class TV extends $m{name="SidechainCompressor";threshold;ratio;attack;release;mix;makeupGain;sidechain=new ji;_audioworkletnode=this.context.createAudioWorkletNode("sidechaincompressorprocessor",{numberOfInputs:2,outputChannelCount:[2]});constructor(){const e=pr(TV.getDefaults(),arguments,["threshold","ratio","attack","release","mix","makeupGain"]);super(e),this.threshold=new zi({context:this.context,param:this._audioworkletnode.parameters.get("threshold"),value:e.threshold,minValue:-128,maxValue:0}),this.ratio=new zi({context:this.context,param:this._audioworkletnode.parameters.get("ratio"),value:e.ratio,minValue:1,maxValue:128}),this.attack=new zi({context:this.context,param:this._audioworkletnode.parameters.get("attack"),value:e.attack,minValue:1e-4,maxValue:128}),this.release=new zi({context:this.context,param:this._audioworkletnode.parameters.get("release"),value:e.release,minValue:1e-4,maxValue:128}),this.mix=new zi({context:this.context,param:this._audioworkletnode.parameters.get("mix"),value:e.mix,minValue:0,maxValue:1}),this.makeupGain=new zi({context:this.context,param:this._audioworkletnode.parameters.get("makeupGain"),value:e.makeupGain,minValue:-128,maxValue:60}),this.connectEffect(this._audioworkletnode),this.sidechain.connect(this._audioworkletnode,0,1)}static getDefaults(){return Object.assign($m.getDefaults(),{threshold:-28,ratio:4,attack:.005,release:.005,mix:1,makeupGain:0})}dispose(){return super.dispose(),this._audioworkletnode.disconnect(),this}}function act(){return ic().rawContext.audioWorklet.addModule(sct)}var Po=(n=>(n[n.SYNTH=0]="SYNTH",n[n.RETRO_NOISE=1]="RETRO_NOISE",n[n.BUZZ_NOISE=2]="BUZZ_NOISE",n[n.CLANG_NOISE=3]="CLANG_NOISE",n[n.METALLIC_NOISE=4]="METALLIC_NOISE",n[n.BELLS=5]="BELLS",n[n.DOOT=6]="DOOT",n))(Po||{});const _re=131072;function oct(n){const e=ic().createBuffer(1,_re,ic().sampleRate);let t=1;const r=e.getChannelData(0);for(let i=0;i<_re;i++){n===4?r[i]=(t&1)*4*(Math.random()*14+1)-8:r[i]=(t&1)*2-1;let s=t>>1;if((t+s&1)==1)switch(n){default:case 1:s+=16384;break;case 3:s+=32768;break;case 2:s+=40;break;case 4:s+=60;break}t=s}return e}function Ay(n){let e,t;function r(){switch(e?.type){case 0:{e.synth.set({...t,envelope:{...t.envelope,attack:.01,decay:.01,sustain:.5,release:.01},oscillator:{...t.oscillator,type:"square"}});break}case 1:{e.synth.set({...t,attack:.01,decay:.01,sustain:.5,release:.01});break}case 5:{e.synth.set({...t,harmonicity:1.5,modulationIndex:30,oscillator:{type:"sine"},modulation:{type:"square"},envelope:{attack:.01,decay:3,sustain:.3,release:6},modulationEnvelope:{attack:.5,decay:1,sustain:.2,release:4}});break}case 6:{e.synth.set({...t});break}}}function i(){return{type:e?.type,synth:e?.synth.get()}}function s(o){e?.synth.set(o.synth)}function a(){e?.synth.dispose()}switch(n){case 0:return e={type:n,synth:new Kd},t=Sl(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 1:case 2:case 3:case 4:return e={type:n,synth:new WO({volume:-44,urls:{C4:oct(n)}}),filter1:new Rw({type:"lowshelf",gain:-32,frequency:440}),filter2:new Rw({type:"highshelf",gain:32,frequency:440})},t=Sl(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 5:return e={type:5,synth:new tV,sparkle:new nV({volume:-16,envelope:{attack:.001,decay:1.4,release:.321},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1.5})},t=Sl(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a};case 6:return e={type:n,synth:new iR},t=Sl(e.synth.get()),r(),{source:e,applyreset:r,getreplay:i,setreplay:s,destroy:a}}}async function w_e(){await _ot(),await act()}function R_e(){const n=Eat(),e=new Sm;e.connect(n);let t;ic().isOffline||(t=ic().createMediaStreamDestination(),e.connect(t));const r=new ji(10),i=new ZU({maxDelay:.005,frequency:1.5,depth:.2,type:"sine",wet:.6}),s=new cV({frequency:.6,delayTime:7,depth:.7,type:"sine",spread:128,wet:.5}),a=new jE({type:"pink",volume:-42}),o=new Sm,l=new Zq,c=new zc(Math.PI*.25,"sine");c.chain(l,o.volume),c.start(),a.start(),a.chain(o,s),i.chain(s,e);const u=new mV({threshold:-24,ratio:4,attack:.003,release:.25,knee:30});r.chain(u,i);const f=new TV({threshold:-42,ratio:4,attack:.005,release:.005,mix:.777,makeupGain:24});f.connect(r);const d=new Sm(-12),g=new Sm(-32),p=new Sm(Mp(20));p.connect(f);const _=new Sm(Mp(100));_.connect(r);const y=new Sm;y.connect(r),y.connect(d);const v=new Sm;v.connect(r),v.connect(d),d.connect(f.sidechain),g.connect(f.sidechain);const x=[Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH),Ay(Po.SYNTH)],E=vot(),M=[W8(1),W8(2),W8(3)];for(let $e=0;$e<M.length;++$e){const at=M[$e];at.fc.connect(E.fc),at.echo.connect(E.echo),at.reverb.connect(E.reverb),at.phaser.connect(E.phaser),at.vibrato.connect(E.vibrato),at.distortion.connect(E.distortion),at.autowah.connect(E.autowah);const oe=$e<2?p:y;E.fc.connect(oe),E.echo.connect(oe),E.reverb.connect(oe),E.phaser.connect(oe),E.vibrato.connect(oe),E.distortion.connect(oe),E.autowah.connect(oe)}function O($e){return $e<4?Math.floor($e/2):2}function N($e){const at=O($e),oe=$e<4?p:y;switch(x[$e]?.source.type){case Po.RETRO_NOISE:case Po.BUZZ_NOISE:case Po.CLANG_NOISE:case Po.METALLIC_NOISE:break;default:x[$e]?.source.synth.connect(oe),x[$e]?.source.synth.connect(M[at].sendtofx);break}switch(x[$e]?.source.type){case Po.RETRO_NOISE:case Po.BUZZ_NOISE:case Po.CLANG_NOISE:case Po.METALLIC_NOISE:x[$e]?.source.synth.chain(x[$e]?.source.filter1,x[$e]?.source.filter2,oe),x[$e]?.source.synth.chain(x[$e]?.source.filter1,x[$e]?.source.filter2,M[at].sendtofx);break;case Po.BELLS:{x[$e]?.source.sparkle.connect(oe),x[$e]?.source.sparkle.connect(M[at].sendtofx);break}}}for(let $e=0;$e<x.length;++$e)N($e);function I($e,at){x[$e]?.source.type!==at&&(x[$e]?.source.synth.dispose(),x[$e]=Ay(at),N($e))}const D=mot(_,g);let V=new Dk(W),G=0,Q=0,B=[];function $($e,at,pt){$e.forEach((oe,Ue)=>{I(Ue,oe.type),x[Ue].setreplay(oe)}),E.setreplay(at),pt.forEach((oe,Ue)=>{M[Ue].setreplay(oe)})}function U(){B=[],G=0,Q=0}function J($e){if(B.length){const at=ss(),pt=B.map(be=>{const[Ke]=be;return Ke}),oe=Math.min(...pt),Ue=Math.max(...pt),Ge=Math.ceil(Ue-oe+5),ze=[];for(let be=0;be<B.length;++be){const[Ke,ot]=B[be];ze.push([Ke-oe+.1,ot])}const Be=x.map(be=>be.getreplay()),me=E.getreplay(),Se=M.map(be=>be.getreplay());let Ie;lat(async({transport:be})=>{es(xt,at,"create synth"),await w_e(),Ie=R_e(),es(xt,at,"synth waiting for setup"),await Ch(2e3),Ie.setplayvolume(40),Ie.applyreplay(Be,me,Se),Ie.synthreplay(ze,Ue),es(xt,at,"rendering audio"),be.start(0)},Ge).then(be=>(es(xt,at,"rendering complete, exporting mp3"),ect(be))).then(be=>{const Ke=document.createElement("a");Ke.href=URL.createObjectURL(new Blob([be],{type:"audio/mp3"})),Ke.download=`${$e||gle()}.mp3`,es(xt,at,`saving file ${Ke.download}`),Ke.click(),Ie?.destroy()}).catch(be=>{Si(xt,at,"synthrecord",be)})}U()}function W($e,at){if(at===null)return;if(Q>0){const ze=Math.round($e/Q*100);ze!==G&&(G=ze,es(xt,ss(),`${ze}%`))}else B.push([$e,at]);const[pt,oe,Ue]=at,Ge=O(pt);if(Vn(Ue)&&xe(x[pt])&&xe(M[Ge]))if(Ue.startsWith("#"))xat().schedule(()=>AOe(xt,"",Ue.slice(1)),$e);else{switch(x[pt].source.type){case Po.BELLS:x[pt].source.synth.detune.value=Mg(-3,3),x[pt].source.sparkle.triggerAttackRelease(hot(Ue,2),oe,$e);break}x[pt].source.synth.triggerAttackRelease(Ue,oe,$e);const ze=x[pt].source.synth.toSeconds(oe),Be="128n",me=x[pt].source.synth.toSeconds(Be);E.vibrato.depth.rampTo(1,"2n",$e),E.vibrato.depth.rampTo(0,Be,$e+ze-me),E.vibrato.frequency.rampTo(5,"4n",$e),E.vibrato.frequency.rampTo(1,Be,$e+ze-me)}if(Mn(Ue))switch(Ue){case 0:D.ticktrigger($e);break;case 1:D.tweettrigger($e);break;case 2:D.cowbelltrigger(oe,$e);break;case 3:D.claptrigger(oe,$e);break;case 4:D.hisnaretrigger(oe,$e);break;case 5:D.hiwoodblocktrigger(oe,$e);break;case 6:D.lowsnaretrigger(oe,$e);break;case 7:D.lowtomtrigger(oe,$e);break;case 8:D.lowwoodblocktrigger(oe,$e);break;case 9:D.basstrigger($e);break;case-1:--Z,Z===0&&(V.clear(),ae=-1);break}}function q($e,at,pt,oe=!0){let Ue=at;const Ge=ict($e,at,pt,oe),ze=Ge[Ge.length-1];xe(ze)&&(Ue=Math.max(Ue,ze[0]));for(let Be=0;Be<Ge.length;++Be){const[me,Se]=Ge[Be];V.add(me,Se)}return Ue}function Y($e,at){G=0,Q=at;for(let pt=0;pt<$e.length;++pt){const[oe,Ue]=$e[pt];V.add(oe,Ue)}}let ae=-1,Z=0,K=mre;function ne($e){const at=gre($e);ae===-1&&(ae=B9().now(),V.start(0)),Z+=at.length;const pt=ae;for(let oe=0;oe<at.length&&oe<x.length;++oe){const Ue=q(oe,pt,at[oe]);ae=Math.max(ae,Ue)}}function le($e,at){const pt=gre($e),oe=Rh(at||"+0.05").toSeconds();for(let Ue=0;Ue<pt.length;++Ue)q(K++,oe,pt[Ue],!1),K>=x.length&&(K=mre)}function ce(){V.clear(),ae=-1,Z=0}function de($e){ce(),B9().bpm.setValueAtTime($e,0),V=new Dk(W)}function Me($e){e.volume.value=Mp($e*.25)}function qe($e){y.volume.value=Mp($e)}function Pe($e){new $O($e).connect(v).start(0)}function Ce($e){v.volume.value=$e}Ce(25),Me(80),qe(100);function Xe(){x.forEach($e=>$e.destroy()),M.forEach($e=>$e.destroy()),E.destroy(),e.dispose()}return{destroy:Xe,broadcastdestination:t,addplay:ne,addbgplay:le,stopplay:ce,applyreplay:$,synthrecord:J,synthflush:U,synthreplay:Y,addttsaudiobuffer:Pe,setbpm:de,setplayvolume:Me,setbgplayvolume:qe,setttsvolume:Ce,SOURCE:x,FX:M,FXCHAIN:E,changesource:I}}const lct=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]+/,cct=/(am|fm|fat)*(sine|square|triangle|sawtooth|custom)[0-9]*/;function uct(n,e){if(Vn(n)){const t=qr(n);if(lct.test(t))return bi(e);switch(t){case"pwm":case"pulse":case"retro":case"buzz":case"clang":case"metallic":case"bells":case"doot":return!0;default:return cct.test(t)}}return!1}function fct(n,e,t,r,i){if(!xe(e))return;const s=e.SOURCE[t];if(!xe(s)){Si(xt,n,"synth",`unknown voice ${t}`);return}switch(r){case"reset":case"restart":s.applyreset();return;case"vol":case"volume":Mn(i)&&(s.source.synth.volume.value=i);return;case"port":case"portamento":if(Mn(i))switch(s.source.type){case Po.SYNTH:s.source.synth.portamento=i;break;case Po.RETRO_NOISE:Si(xt,n,"synth","portamento for retro synth not supported");break}return;case"env":case"envelope":if(bi(i)){const[a,o,l,c]=i;s.source.synth.set({envelope:{attack:a,decay:o,sustain:l,release:c}})}return;default:if(Vn(r)){if(uct(r,i)){switch(r){case"retro":e.changesource(t,Po.RETRO_NOISE);break;case"buzz":e.changesource(t,Po.BUZZ_NOISE);break;case"clang":e.changesource(t,Po.CLANG_NOISE);break;case"metallic":e.changesource(t,Po.METALLIC_NOISE);break;case"bells":e.changesource(t,Po.BELLS);break;case"doot":e.changesource(t,Po.DOOT);break;default:e.changesource(t,Po.SYNTH),s.source.synth.set({oscillator:{type:r}}),bi(i)&&s.source.synth.set({oscillator:{type:r,partials:i,partialCount:i.length}}),Mn(i)&&s.source.synth.set({oscillator:{type:r,partials:[i],partialCount:1}});break}return}switch(s.source.type){case Po.SYNTH:{switch(s.source.synth.get().oscillator.type){case"pwm":switch(r){case"modfreq":case"modulationfrequency":Mn(i)&&s.source.synth.set({oscillator:{modulationFrequency:i}});return}break;case"pulse":switch(r){case"width":Mn(i)&&s.source.synth.set({oscillator:{width:i}});return}break;case"custom":case"sine":case"square":case"triangle":case"sawtooth":switch(r){case"phase":Mn(i)&&s.source.synth.set({oscillator:{phase:i}});return}break;case"amcustom":case"amsine":case"amsquare":case"amtriangle":case"amsawtooth":switch(r){case"harmonicity":Mn(i)&&s.source.synth.set({oscillator:{harmonicity:i}});return;case"modtype":case"modulationtype":Vn(i)&&s.source.synth.set({oscillator:{modulationType:i}});return;case"modenv":case"modulationenvelope":if(bi(i)){const[o,l,c,u]=i;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:l,sustain:c,release:u}}});return}break}break;case"fmcustom":case"fmsine":case"fmsquare":case"fmtriangle":case"fmsawtooth":switch(r){case"harmonicity":if(Mn(i)){s.source.synth.set({oscillator:{harmonicity:i}});return}break;case"modindex":if(Mn(i)){s.source.synth.set({oscillator:{modulationIndex:i}});return}break;case"modtype":if(Vn(i)){s.source.synth.set({oscillator:{modulationType:i}});return}break;case"modenv":if(bi(i)){const[o,l,c,u]=i;s.source.synth.set({oscillator:{modulationEnvelope:{attack:o,decay:l,sustain:c,release:u}}});return}break}break;case"fatcustom":case"fatsine":case"fatsquare":case"fattriangle":case"fatsawtooth":switch(r){case"count":if(Mn(i)){s.source.synth.set({oscillator:{count:i}});return}break;case"phase":if(Mn(i)){s.source.synth.set({oscillator:{phase:i}});return}break;case"spread":if(Mn(i)){s.source.synth.set({oscillator:{spread:i}});return}break}break}return}}Si(xt,n,"synth",`unknown config ${r}`)}break}}function hct(n,e,t,r,i){if(!xe(e))return;if(t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.autowah;switch(r){case"basefrequency":if(Mn(i)){s.set({baseFrequency:i});return}break;case"octaves":if(Mn(i)){s.set({octaves:i});return}break;case"sensitivity":if(Mn(i)){s.set({sensitivity:i});return}break;case"gain":if(Mn(i)){s.set({gain:i});return}break;case"follower":if(Mn(i)){s.set({follower:i});return}break}Si(xt,n,"synth",`unknown autowah config ${r} with ${i}`)}function dct(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.distortion;switch(r){case"distortion":if(Mn(i)){s.set({distortion:i});return}break;case"oversample":if(Vn(i)){s.set({oversample:i});return}break}Si(xt,n,"kind",`unknown distortion ${r} or ${i}`)}function pct(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.echo;switch(r){case"delaytime":if(Mn(i)){s.set({delayTime:i});return}break;case"feedback":if(Mn(i)){s.set({feedback:i});return}break}Si(xt,n,"kind",`unknown echo ${r} or ${i}`)}function mct(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.fcrush;switch(r){case"rate":if(Mn(i)){s.set({rate:i});return}break}Si(xt,n,"kind",`unknown fcrush ${r} or ${i}`)}function gct(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.phaser;switch(r){case"frequency":if(Mn(i)){s.set({frequency:i});return}break;case"octaves":if(Mn(i)){s.set({octaves:i});return}break;case"basefrequency":s.set({baseFrequency:i});return}Si(xt,n,"kind",`unknown phaser ${r} or ${i}`)}function _ct(n,e,t,r,i){if(!xe(e)||t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.reverb;switch(r){case"decay":if(Mn(i)){s.set({decay:i});return}break;case"predelay":if(Mn(i)){s.set({preDelay:i});return}break}Si(xt,n,"kind",`unknown reverb ${r} or ${i}`)}function vct(n,e,t,r,i){if(!xe(e))return;if(t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const s=e.FXCHAIN.vibrato;switch(r){case"maxdelay":if(Mn(i)){s.set({maxDelay:i});return}break}Si(xt,n,"synth",`unknown vibrato config ${r} with ${i}`)}function yct(n,e,t,r,i,s){if(!xe(e))return;if(t<0||t>=e.FX.length){Si(xt,n,"synth",`index ${t} out of bounds`);return}const a=e.FX[t][r];if(xe(a)){switch(i){case"on":switch(r){case"vibrato":a.volume.value=Mp(80);break;default:a.volume.value=Mp(20);break}break;case"off":a.volume.value=Mp(0);break;default:if(Mn(i))a.volume.value=Mp(i);else switch(r){case"fc":case"fcrush":mct(n,e,t,i,s);break;case"echo":pct(n,e,t,i,s);break;case"phaser":gct(n,e,t,i,s);break;case"reverb":_ct(n,e,t,i,s);break;case"distort":case"distortion":dct(n,e,t,i,s);break;case"vibrato":vct(n,e,t,i,s);break;case"autowah":hct(n,e,t,i,s);break}break}return}Si(xt,n,"synth",`unknown fx ${r}`)}let oF=Promise,A_e=n=>{let e=0,t=0,r,i,s,a,o=()=>{e--,--t?l():a=s?.()},l=()=>{if(r&&e<n){e++;let c=r;r=r.a,c.p().then(u=>(c.b(u),o()),u=>(c.c(u),o()))}};return{add(c){let u={p:c},f=new oF((d,g)=>{u.b=d,u.c=g});return r?i=i.a=u:i=r=u,t++,l(),f},done:()=>t?a||(a=new oF(c=>s=c)):oF.resolve(),clear(){r=i=null,t=e},active:()=>e,size:()=>t}};const aP={"ar-SA":["ar-SA-HamedNeural","ar-SA-ZariyahNeural"],"de-DE":["de-DE-AmalaNeural","de-DE-ConradNeural","de-DE-KatjaNeural","de-DE-KillianNeural"],"en-US":["en-US-AriaNeural","en-US-AnaNeural","en-US-ChristopherNeural","en-US-EricNeural","en-US-GuyNeural","en-US-JennyNeural","en-US-MichelleNeural","en-US-RogerNeural","en-US-SteffanNeural"],"es-ES":["es-ES-AlvaroNeural","es-ES-ElviraNeural"],"fr-FR":["fr-FR-DeniseNeural","fr-FR-EloiseNeural","fr-FR-HenriNeural"],"ja-JP":["ja-JP-KeitaNeural","ja-JP-NanamiNeural"],"ko-KR":["ko-KR-InJoonNeural","ko-KR-SunHiNeural"],"pt-BR":["pt-BR-AntonioNeural","pt-BR-FranciscaNeural"],"ru-RU":["ru-RU-DmitryNeural","ru-RU-SvetlanaNeural"],"zh-CN":["zh-CN-XiaoxiaoNeural","zh-CN-XiaoyiNeural","zh-CN-YunjianNeural","zh-CN-liaoning-XiaobeiNeural","zh-CN-shaanxi-XiaoniNeural","zh-CN-YunxiNeural","zh-CN-YunxiaNeural","zh-CN-YunyangNeural"],"zh-TW":["zh-TW-HsiaoChenNeural","zh-TW-YunJheNeural","zh-TW-HsiaoYuNeural"]},oP={"ar-SA-HamedNeural":"","ar-SA-ZariyahNeural":"","de-DE-AmalaNeural":"Amala","de-DE-BerndNeural":"Bernd","de-DE-ChristophNeural":"Christoph","de-DE-ConradNeural":"Conrad","de-DE-ElkeNeural":"Elke","de-DE-GiselaNeural":"Gisela","de-DE-KasperNeural":"Kasper","de-DE-KatjaNeural":"Katja","de-DE-KillianNeural":"Killian","de-DE-KlarissaNeural":"Klarissa","de-DE-KlausNeural":"Klaus","de-DE-LouisaNeural":"Louisa","de-DE-MajaNeural":"Maja","de-DE-RalfNeural":"Ralf","de-DE-TanjaNeural":"Tanja","en-US-AIGenerate1Neural":"AIGenerate1","en-US-AIGenerate2Neural":"AIGenerate2","en-US-AmberNeural":"Amber","en-US-AnaNeural":"Ana","en-US-AndrewNeural":"Andrew","en-US-AriaNeural":"Aria","en-US-AshleyNeural":"Ashley","en-US-BlueNeural":"Blue","en-US-BrandonNeural":"Brandon","en-US-BrianNeural":"Brian","en-US-ChristopherNeural":"Christopher","en-US-CoraNeural":"Cora","en-US-DavisNeural":"Davis","en-US-ElizabethNeural":"Elizabeth","en-US-EmmaNeural":"Emma","en-US-EricNeural":"Eric","en-US-GuyNeural":"Guy","en-US-JacobNeural":"Jacob","en-US-JaneNeural":"Jane","en-US-JasonNeural":"Jason","en-US-JennyMultilingualNeural":"Jenny Multilingual","en-US-JennyMultilingualV2Neural":"Jenny Multilingual V2","en-US-JennyNeural":"Jenny","en-US-MichelleNeural":"Michelle","en-US-MonicaNeural":"Monica","en-US-NancyNeural":"Nancy","en-US-RogerNeural":"Roger","en-US-RyanMultilingualNeural":"Ryan Multilingual","en-US-SaraNeural":"Sara","en-US-SteffanNeural":"Steffan","en-US-TonyNeural":"Tony","es-ES-AbrilNeural":"Abril","es-ES-AlvaroNeural":"lvaro","es-ES-ArnauNeural":"Arnau","es-ES-DarioNeural":"Dario","es-ES-EliasNeural":"Elias","es-ES-ElviraNeural":"Elvira","es-ES-EstrellaNeural":"Estrella","es-ES-IreneNeural":"Irene","es-ES-LaiaNeural":"Laia","es-ES-LiaNeural":"Lia","es-ES-NilNeural":"Nil","es-ES-SaulNeural":"Saul","es-ES-TeoNeural":"Teo","es-ES-TrianaNeural":"Triana","es-ES-VeraNeural":"Vera","fr-FR-AlainNeural":"Alain","fr-FR-BrigitteNeural":"Brigitte","fr-FR-CelesteNeural":"Celeste","fr-FR-ClaudeNeural":"Claude","fr-FR-CoralieNeural":"Coralie","fr-FR-DeniseNeural":"Denise","fr-FR-EloiseNeural":"Eloise","fr-FR-HenriNeural":"Henri","fr-FR-JacquelineNeural":"Jacqueline","fr-FR-JeromeNeural":"Jerome","fr-FR-JosephineNeural":"Josephine","fr-FR-MauriceNeural":"Maurice","fr-FR-YvesNeural":"Yves","fr-FR-YvetteNeural":"Yvette","ja-JP-AoiNeural":"","ja-JP-DaichiNeural":"","ja-JP-KeitaNeural":"","ja-JP-MayuNeural":"","ja-JP-NanamiNeural":"","ja-JP-NaokiNeural":"","ja-JP-ShioriNeural":"","ko-KR-BongJinNeural":"","ko-KR-GookMinNeural":"","ko-KR-InJoonNeural":"","ko-KR-JiMinNeural":"","ko-KR-SeoHyeonNeural":"","ko-KR-SoonBokNeural":"","ko-KR-SunHiNeural":"","ko-KR-YuJinNeural":"","pt-BR-AntonioNeural":"Antnio","pt-BR-BrendaNeural":"Brenda","pt-BR-DonatoNeural":"Donato","pt-BR-ElzaNeural":"Elza","pt-BR-FabioNeural":"Fabio","pt-BR-FranciscaNeural":"Francisca","pt-BR-GiovannaNeural":"Giovanna","pt-BR-HumbertoNeural":"Humberto","pt-BR-JulioNeural":"Julio","pt-BR-LeilaNeural":"Leila","pt-BR-LeticiaNeural":"Leticia","pt-BR-ManuelaNeural":"Manuela","pt-BR-NicolauNeural":"Nicolau","pt-BR-ValerioNeural":"Valerio","pt-BR-YaraNeural":"Yara","ru-RU-DariyaNeural":"","ru-RU-DmitryNeural":"","ru-RU-SvetlanaNeural":"","wuu-CN-XiaotongNeural":"","wuu-CN-YunzheNeural":"","yue-CN-XiaoMinNeural":"","yue-CN-YunSongNeural":"","zh-CN-XiaochenNeural":"","zh-CN-XiaohanNeural":"","zh-CN-XiaomengNeural":"","zh-CN-XiaomoNeural":"","zh-CN-XiaoqiuNeural":"","zh-CN-XiaorouNeural":"","zh-CN-XiaoruiNeural":"","zh-CN-XiaoshuangNeural":"","zh-CN-XiaoxiaoNeural":"","zh-CN-XiaoxuanNeural":"","zh-CN-XiaoyanNeural":"","zh-CN-XiaoyiNeural":"","zh-CN-XiaoyouNeural":"","zh-CN-XiaozhenNeural":"","zh-CN-YunfengNeural":"","zh-CN-YunhaoNeural":"","zh-CN-YunjianNeural":"","zh-CN-YunjieNeural":"","zh-CN-YunxiNeural":"","zh-CN-YunxiaNeural":"","zh-CN-YunyangNeural":"","zh-CN-YunyeNeural":"","zh-CN-YunzeNeural":"","zh-CN-guangxi-YunqiNeural":"","zh-CN-henan-YundengNeural":"","zh-CN-liaoning-XiaobeiNeural":"","zh-CN-liaoning-YunbiaoNeural":"","zh-CN-shaanxi-XiaoniNeural":"","zh-CN-shandong-YunxiangNeural":"","zh-CN-sichuan-YunxiNeural":"","zh-TW-HsiaoChenNeural":"","zh-TW-HsiaoYuNeural":"","zh-TW-YunJheNeural":""};function kL(n){"@babel/helpers - typeof";return kL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kL(n)}function j9(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */j9=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var d="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var O=Object.getPrototypeOf,N=O&&O(O(J([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&kL(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=d;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=Q(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===d)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function Q(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,Q(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function J(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(kL(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=J,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:J(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function vre(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function bct(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){vre(s,r,i,a,o,"next",l)}function o(l){vre(s,r,i,a,o,"throw",l)}a(void 0)})}}var Sct=(function(){var n=bct(j9().mark(function e(t){var r;return j9().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return r=new AudioContext,s.next=3,r.decodeAudioData(t);case 3:return s.abrupt("return",s.sent);case 4:case"end":return s.stop()}},e)}));return function(t){return n.apply(this,arguments)}})();const Ect={"ar-SA":"","de-DE":"Deutsch","en-US":"English","es-ES":"Espaol","fr-FR":"Franais","ja-JP":"","ko-KR":"","pt-BR":"Portugus","ru-RU":"","zh-CN":"","zh-TW":""};function xct(n,e){return Act(n)||Rct(n,e)||wct(n,e)||Tct()}function Tct(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wct(n,e){if(n){if(typeof n=="string")return yre(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yre(n,e)}}function yre(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function Rct(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Act(n){if(Array.isArray(n))return n}var Cct=function(){return Object.entries(Ect).map(function(e){var t=xct(e,2),r=t[0],i=t[1];return{label:i,value:r}})};const Mct="modulepreload",kct=function(n){return"/"+n},bre={},Oct=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){let c=function(u){return Promise.all(u.map(f=>Promise.resolve(f).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};var a=c;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");i=c(t.map(u=>{if(u=kct(u),u in bre)return;bre[u]=!0;const f=u.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Mct,f||(g.as="script"),g.crossOrigin="",g.href=u,l&&g.setAttribute("nonce",l),document.head.appendChild(g),f)return new Promise((p,_)=>{g.addEventListener("load",p),g.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return i.then(o=>{for(const l of o||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},C_e="%[a-f0-9]{2}",Sre=new RegExp("("+C_e+")|([^%]+?)","gi"),Ere=new RegExp("("+C_e+")+","gi");function H9(n,e){try{return[decodeURIComponent(n.join(""))]}catch{}if(n.length===1)return n;e=e||1;const t=n.slice(0,e),r=n.slice(e);return Array.prototype.concat.call([],H9(t),H9(r))}function Ict(n){try{return decodeURIComponent(n)}catch{let e=n.match(Sre)||[];for(let t=1;t<e.length;t++)n=H9(e,t).join(""),e=n.match(Sre)||[];return n}}function Nct(n){const e={"%FE%FF":"","%FF%FE":""};let t=Ere.exec(n);for(;t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{const i=Ict(t[0]);i!==t[0]&&(e[t[0]]=i)}t=Ere.exec(n)}e["%C2"]="";const r=Object.keys(e);for(const i of r)n=n.replace(new RegExp(i,"g"),e[i]);return n}function Pct(n){if(typeof n!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof n+"`");try{return decodeURIComponent(n)}catch{return Nct(n)}}function Dct(n,e){const t={};if(Array.isArray(e))for(const r of e){const i=Object.getOwnPropertyDescriptor(n,r);i?.enumerable&&Object.defineProperty(t,r,i)}else for(const r of Reflect.ownKeys(n)){const i=Object.getOwnPropertyDescriptor(n,r);if(i.enumerable){const s=n[r];e(r,s,n)&&Object.defineProperty(t,r,i)}}return t}function M_e(n,e){if(!(typeof n=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(n===""||e==="")return[];const t=n.indexOf(e);return t===-1?[]:[n.slice(0,t),n.slice(t+e.length)]}const Lct=n=>n==null,Uct=n=>encodeURIComponent(n).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),q9=Symbol("encodeFragmentIdentifier");function Bct(n){switch(n.arrayFormat){case"index":return e=>(t,r)=>{const i=t.length;return r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[df(e,n),"[",i,"]"].join("")]:[...t,[df(e,n),"[",df(i,n),"]=",df(r,n)].join("")]};case"bracket":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[df(e,n),"[]"].join("")]:[...t,[df(e,n),"[]=",df(r,n)].join("")];case"colon-list-separator":return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,[df(e,n),":list="].join("")]:[...t,[df(e,n),":list=",df(r,n)].join("")];case"comma":case"separator":case"bracket-separator":{const e=n.arrayFormat==="bracket-separator"?"[]=":"=";return t=>(r,i)=>i===void 0||n.skipNull&&i===null||n.skipEmptyString&&i===""?r:(i=i===null?"":i,r.length===0?[[df(t,n),e,df(i,n)].join("")]:[[r,df(i,n)].join(n.arrayFormatSeparator)])}default:return e=>(t,r)=>r===void 0||n.skipNull&&r===null||n.skipEmptyString&&r===""?t:r===null?[...t,df(e,n)]:[...t,[df(e,n),"=",df(r,n)].join("")]}}function Fct(n){let e;switch(n.arrayFormat){case"index":return(t,r,i)=>{if(e=/\[(\d*)]$/.exec(t),t=t.replace(/\[\d*]$/,""),!e){i[t]=r;return}i[t]===void 0&&(i[t]={}),i[t][e[1]]=r};case"bracket":return(t,r,i)=>{if(e=/(\[])$/.exec(t),t=t.replace(/\[]$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[...i[t],r]};case"colon-list-separator":return(t,r,i)=>{if(e=/(:list)$/.exec(t),t=t.replace(/:list$/,""),!e){i[t]=r;return}if(i[t]===void 0){i[t]=[r];return}i[t]=[...i[t],r]};case"comma":case"separator":return(t,r,i)=>{const s=typeof r=="string"&&r.includes(n.arrayFormatSeparator),a=typeof r=="string"&&!s&&Dy(r,n).includes(n.arrayFormatSeparator);r=a?Dy(r,n):r;const o=s||a?r.split(n.arrayFormatSeparator).map(l=>Dy(l,n)):r===null?r:Dy(r,n);i[t]=o};case"bracket-separator":return(t,r,i)=>{const s=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!s){i[t]=r&&Dy(r,n);return}const a=r===null?[]:Dy(r,n).split(n.arrayFormatSeparator);if(i[t]===void 0){i[t]=a;return}i[t]=[...i[t],...a]};default:return(t,r,i)=>{if(i[t]===void 0){i[t]=r;return}i[t]=[...[i[t]].flat(),r]}}}function k_e(n){if(typeof n!="string"||n.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function df(n,e){return e.encode?e.strict?Uct(n):encodeURIComponent(n):n}function Dy(n,e){return e.decode?Pct(n):n}function O_e(n){return Array.isArray(n)?n.sort():typeof n=="object"?O_e(Object.keys(n)).sort((e,t)=>Number(e)-Number(t)).map(e=>n[e]):n}function I_e(n){const e=n.indexOf("#");return e!==-1&&(n=n.slice(0,e)),n}function zct(n){let e="";const t=n.indexOf("#");return t!==-1&&(e=n.slice(t)),e}function xre(n,e,t){return t==="string"&&typeof n=="string"?n:typeof t=="function"&&typeof n=="string"?t(n):t==="boolean"&&n===null?!0:t==="boolean"&&n!==null&&(n.toLowerCase()==="true"||n.toLowerCase()==="false")?n.toLowerCase()==="true":t==="boolean"&&n!==null&&(n.toLowerCase()==="1"||n.toLowerCase()==="0")?n.toLowerCase()==="1":t==="string[]"&&e.arrayFormat!=="none"&&typeof n=="string"?[n]:t==="number[]"&&e.arrayFormat!=="none"&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?[Number(n)]:t==="number"&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?Number(n):e.parseBooleans&&n!==null&&(n.toLowerCase()==="true"||n.toLowerCase()==="false")?n.toLowerCase()==="true":e.parseNumbers&&!Number.isNaN(Number(n))&&typeof n=="string"&&n.trim()!==""?Number(n):n}function wV(n){n=I_e(n);const e=n.indexOf("?");return e===-1?"":n.slice(e+1)}function RV(n,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},k_e(e.arrayFormatSeparator);const t=Fct(e),r=Object.create(null);if(typeof n!="string"||(n=n.trim().replace(/^[?#&]/,""),!n))return r;for(const i of n.split("&")){if(i==="")continue;const s=e.decode?i.replaceAll("+"," "):i;let[a,o]=M_e(s,"=");a===void 0&&(a=s),o=o===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?o:Dy(o,e),t(Dy(a,e),o,r)}for(const[i,s]of Object.entries(r))if(typeof s=="object"&&s!==null&&e.types[i]!=="string")for(const[a,o]of Object.entries(s)){const l=e.types[i]?e.types[i].replace("[]",""):void 0;s[a]=xre(o,e,l)}else typeof s=="object"&&s!==null&&e.types[i]==="string"?r[i]=Object.values(s).join(e.arrayFormatSeparator):r[i]=xre(s,e,e.types[i]);return e.sort===!1?r:(e.sort===!0?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((i,s)=>{const a=r[s];return i[s]=a&&typeof a=="object"&&!Array.isArray(a)?O_e(a):a,i},Object.create(null))}function N_e(n,e){if(!n)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},k_e(e.arrayFormatSeparator);const t=a=>e.skipNull&&Lct(n[a])||e.skipEmptyString&&n[a]==="",r=Bct(e),i={};for(const[a,o]of Object.entries(n))t(a)||(i[a]=o);const s=Object.keys(i);return e.sort!==!1&&s.sort(e.sort),s.map(a=>{const o=n[a];return o===void 0?"":o===null?df(a,e):Array.isArray(o)?o.length===0&&e.arrayFormat==="bracket-separator"?df(a,e)+"[]":o.reduce(r(a),[]).join("&"):df(a,e)+"="+df(o,e)}).filter(a=>a.length>0).join("&")}function P_e(n,e){e={decode:!0,...e};let[t,r]=M_e(n,"#");return t===void 0&&(t=n),{url:t?.split("?")?.[0]??"",query:RV(wV(n),e),...e&&e.parseFragmentIdentifier&&r?{fragmentIdentifier:Dy(r,e)}:{}}}function D_e(n,e){e={encode:!0,strict:!0,[q9]:!0,...e};const t=I_e(n.url).split("?")[0]||"",r=wV(n.url),i={...RV(r,{sort:!1,...e}),...n.query};let s=N_e(i,e);s&&=`?${s}`;let a=zct(n.url);if(typeof n.fragmentIdentifier=="string"){const o=new URL(t);o.hash=n.fragmentIdentifier,a=e[q9]?o.hash:`#${n.fragmentIdentifier}`}return`${t}${s}${a}`}function L_e(n,e,t){t={parseFragmentIdentifier:!0,[q9]:!1,...t};const{url:r,query:i,fragmentIdentifier:s}=P_e(n,t);return D_e({url:r,query:Dct(i,e),fragmentIdentifier:s},t)}function jct(n,e,t){const r=Array.isArray(e)?i=>!e.includes(i):(i,s)=>!e(i,s);return L_e(n,r,t)}const Hct=Object.freeze(Object.defineProperty({__proto__:null,exclude:jct,extract:wV,parse:RV,parseUrl:P_e,pick:L_e,stringify:N_e,stringifyUrl:D_e},Symbol.toStringTag,{value:"Module"})),gd=[];for(let n=0;n<256;++n)gd.push((n+256).toString(16).slice(1));function qct(n,e=0){return(gd[n[e+0]]+gd[n[e+1]]+gd[n[e+2]]+gd[n[e+3]]+"-"+gd[n[e+4]]+gd[n[e+5]]+"-"+gd[n[e+6]]+gd[n[e+7]]+"-"+gd[n[e+8]]+gd[n[e+9]]+"-"+gd[n[e+10]]+gd[n[e+11]]+gd[n[e+12]]+gd[n[e+13]]+gd[n[e+14]]+gd[n[e+15]]).toLowerCase()}let lF;const Vct=new Uint8Array(16);function Gct(){if(!lF){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");lF=crypto.getRandomValues.bind(crypto)}return lF(Vct)}const $ct=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Tre={randomUUID:$ct};function Wct(n,e,t){if(Tre.randomUUID&&!n)return Tre.randomUUID();n=n||{};const r=n.random??n.rng?.()??Gct();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,qct(r)}var Yct=function(e,t){var r=t.voice;return'<voice name="'.concat(r,'">').concat(e,"</voice>")},Xct=function(e,t){var r=t.style;return r?'<mstts:express-as style="'.concat(r,'">').concat(e,"</mstts:express-as>"):e},Kct=function(e,t){var r=t.pitch,i=t.rate;return!r&&!i?e:'<prosody pitch="'.concat(Math.floor((r||1)*100),'%" rate="').concat(Math.floor((i||1)*100),'%">').concat(e,"</prosody>")},Zct=function(e){return'<speak version="1.0" xmlns="http://www.w3.org/2001/10/synthesis" xmlns:mstts="https://www.w3.org/2001/mstts" xml:lang="en-US">'.concat(e,"</speak>")},Qct=function(e,t){var r=Kct(e,t);return r=Xct(r,t),r=Yct(r,t),r=Zct(r),r};function Jct(n,e){return rut(n)||nut(n,e)||tut(n,e)||eut()}function eut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tut(n,e){if(n){if(typeof n=="string")return wre(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return wre(n,e)}}function wre(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function nut(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function rut(n){if(Array.isArray(n))return n}var Rre=function(e,t){for(var r=[],i=0,s=Object.entries(e);i<s.length;i++){var a=Jct(s[i],2),o=a[0],l=a[1];r.push("".concat(o,":").concat(l))}return r.push("",t),r.join(`\r
`)};function iut(n,e){return out(n)||aut(n,e)||U_e(n,e)||sut()}function sut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aut(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(t=t.call(n)).next,e!==0)for(;!(l=(r=s.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function out(n){if(Array.isArray(n))return n}function lut(n,e){var t=typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(!t){if(Array.isArray(n)||(t=U_e(n))||e){t&&(n=t);var r=0,i=function(){};return{s:i,n:function(){return r>=n.length?{done:!0}:{done:!1,value:n[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s=!0,a=!1,o;return{s:function(){t=t.call(n)},n:function(){var c=t.next();return s=c.done,c},e:function(c){a=!0,o=c},f:function(){try{!s&&t.return!=null&&t.return()}finally{if(a)throw o}}}}function U_e(n,e){if(n){if(typeof n=="string")return Are(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);if(t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set")return Array.from(n);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Are(n,e)}}function Are(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var cut=function(e){var t={},r=lut(e.slice(0,e.indexOf(`\r
\r
`)).split(`\r
`)),i;try{for(r.s();!(i=r.n()).done;){var s=i.value,a=s.split(":",2),o=iut(a,2),l=o[0],c=o[1];t[l]=c}}catch(u){r.e(u)}finally{r.f()}return{data:e.slice(e.indexOf(`\r
\r
`)+4),headers:t}};function OL(n){"@babel/helpers - typeof";return OL=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OL(n)}function tE(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */tE=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var d="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var O=Object.getPrototypeOf,N=O&&O(O(J([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&OL(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=d;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=Q(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===d)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function Q(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,Q(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function J(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(OL(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=J,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:J(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function Cre(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function V9(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){Cre(s,r,i,a,o,"next",l)}function o(l){Cre(s,r,i,a,o,"throw",l)}a(void 0)})}}var uut="wss://speech.platform.bing.com/consumer/speech/synthesize/readaloud/edge/v1",B_e="6A5AA1D4EAFF4E9FB37E23D68491D6F4",fut="1-132.0.2957.140",hut=BigInt("11644473600"),dut=JSON.stringify({context:{synthesis:{audio:{metadataoptions:{sentenceBoundaryEnabled:!1,wordBoundaryEnabled:!0},outputFormat:"audio-24khz-48kbitrate-mono-mp3"}}}}),put=function(e){var t=new Date().toString(),r={"Content-Type":"application/json; charset=utf-8",Path:"speech.config","X-Timestamp":t},i={"Content-Type":"application/ssml+xml",Path:"ssml","X-RequestId":e,"X-Timestamp":t};return{configHeader:r,contentHeader:i}};function mut(){return G9.apply(this,arguments)}function G9(){return G9=V9(tE().mark(function n(){var e,t,r,i,s;return tE().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return e=BigInt(Math.floor(Date.now()/1e3+Number(hut)))*BigInt("10000000"),t=e-e%BigInt("3000000000"),r=t+B_e,o.next=5,Oct(()=>import("./getSHA256-q1aNYYJS.js"),[]);case 5:return i=o.sent,s=i.hash(r),o.abrupt("return",s.toUpperCase());case 8:case"end":return o.stop()}},n)})),G9.apply(this,arguments)}var F_e=(function(){var n=V9(tE().mark(function e(t){var r,i,s,a,o,l,c,u,f,d,g,p,_,y=arguments;return tE().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(r=t.payload,i=y.length>1&&y[1]!==void 0?y[1]:{},s=i.proxyUrl,a=i.token,o=r.input,l=r.options,c=Wct().replaceAll("-",""),x.t0=Hct,x.t1=c,!a){x.next=10;break}x.t2=a,x.next=13;break;case 10:return x.next=12,mut();case 12:x.t2=x.sent;case 13:return x.t3=x.t2,x.t4=a||fut,x.t5=a||B_e,x.t6={ConnectionId:x.t1,"Sec-MS-GEC":x.t3,"Sec-MS-GEC-Version":x.t4,TrustedClientToken:x.t5},x.t7=s||uut,x.t8={query:x.t6,url:x.t7},u=x.t0.stringifyUrl.call(x.t0,x.t8),f=put(c),d=f.configHeader,g=f.contentHeader,p=Rre(d,dut),_=Rre(g,Qct(o,l)),x.abrupt("return",new Promise(function(E,M){var O=new WebSocket(u);O.binaryType="arraybuffer";var N=function(){O.send(p),O.send(_)},I=new ArrayBuffer(0),D=(function(){var G=V9(tE().mark(function Q(B){var $,U,J,W,q,Y,ae,Z;return tE().wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:if(typeof B.data!="string"){ne.next=13;break}$=cut(B.data),U=$.headers,ne.t0=U.Path,ne.next=ne.t0==="turn.end"?5:11;break;case 5:if(O.close(),I.byteLength){ne.next=8;break}return ne.abrupt("return");case 8:return J=new Response(I),E(J),ne.abrupt("break",11);case 11:ne.next=14;break;case 13:B.data instanceof ArrayBuffer&&(W=new DataView(B.data),q=W.getInt16(0),B.data.byteLength>q+2&&(Y=B.data.slice(2+q),ae=new ArrayBuffer(I.byteLength+Y.byteLength),Z=new Uint8Array(ae),Z.set(new Uint8Array(I),0),Z.set(new Uint8Array(Y),I.byteLength),I=ae));case 14:case"end":return ne.stop()}},Q)}));return function(B){return G.apply(this,arguments)}})(),V=function(){M(new Error("WebSocket error occurred.")),O.close()};O.addEventListener("open",N),O.addEventListener("message",D),O.addEventListener("error",V)}));case 24:case"end":return x.stop()}},e)}));return function(t){return n.apply(this,arguments)}})(),gut=function(e){var t=e&&aP[e]?aP[e]||[]:Nm(Object.values(aP));return t.map(function(r){return{label:oP?.[r]||r,value:r}})};function VE(n){"@babel/helpers - typeof";return VE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},VE(n)}function zS(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */zS=function(){return e};var n,e={},t=Object.prototype,r=t.hasOwnProperty,i=Object.defineProperty||function(W,q,Y){W[q]=Y.value},s=typeof Symbol=="function"?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(W,q,Y){return Object.defineProperty(W,q,{value:Y,enumerable:!0,configurable:!0,writable:!0}),W[q]}try{c({},"")}catch{c=function(Y,ae,Z){return Y[ae]=Z}}function u(W,q,Y,ae){var Z=q&&q.prototype instanceof v?q:v,K=Object.create(Z.prototype),ne=new U(ae||[]);return i(K,"_invoke",{value:G(W,Y,ne)}),K}function f(W,q,Y){try{return{type:"normal",arg:W.call(q,Y)}}catch(ae){return{type:"throw",arg:ae}}}e.wrap=u;var d="suspendedStart",g="suspendedYield",p="executing",_="completed",y={};function v(){}function x(){}function E(){}var M={};c(M,a,function(){return this});var O=Object.getPrototypeOf,N=O&&O(O(J([])));N&&N!==t&&r.call(N,a)&&(M=N);var I=E.prototype=v.prototype=Object.create(M);function D(W){["next","throw","return"].forEach(function(q){c(W,q,function(Y){return this._invoke(q,Y)})})}function V(W,q){function Y(Z,K,ne,le){var ce=f(W[Z],W,K);if(ce.type!=="throw"){var de=ce.arg,Me=de.value;return Me&&VE(Me)=="object"&&r.call(Me,"__await")?q.resolve(Me.__await).then(function(qe){Y("next",qe,ne,le)},function(qe){Y("throw",qe,ne,le)}):q.resolve(Me).then(function(qe){de.value=qe,ne(de)},function(qe){return Y("throw",qe,ne,le)})}le(ce.arg)}var ae;i(this,"_invoke",{value:function(K,ne){function le(){return new q(function(ce,de){Y(K,ne,ce,de)})}return ae=ae?ae.then(le,le):le()}})}function G(W,q,Y){var ae=d;return function(Z,K){if(ae===p)throw new Error("Generator is already running");if(ae===_){if(Z==="throw")throw K;return{value:n,done:!0}}for(Y.method=Z,Y.arg=K;;){var ne=Y.delegate;if(ne){var le=Q(ne,Y);if(le){if(le===y)continue;return le}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(ae===d)throw ae=_,Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);ae=p;var ce=f(W,q,Y);if(ce.type==="normal"){if(ae=Y.done?_:g,ce.arg===y)continue;return{value:ce.arg,done:Y.done}}ce.type==="throw"&&(ae=_,Y.method="throw",Y.arg=ce.arg)}}}function Q(W,q){var Y=q.method,ae=W.iterator[Y];if(ae===n)return q.delegate=null,Y==="throw"&&W.iterator.return&&(q.method="return",q.arg=n,Q(W,q),q.method==="throw")||Y!=="return"&&(q.method="throw",q.arg=new TypeError("The iterator does not provide a '"+Y+"' method")),y;var Z=f(ae,W.iterator,q.arg);if(Z.type==="throw")return q.method="throw",q.arg=Z.arg,q.delegate=null,y;var K=Z.arg;return K?K.done?(q[W.resultName]=K.value,q.next=W.nextLoc,q.method!=="return"&&(q.method="next",q.arg=n),q.delegate=null,y):K:(q.method="throw",q.arg=new TypeError("iterator result is not an object"),q.delegate=null,y)}function B(W){var q={tryLoc:W[0]};1 in W&&(q.catchLoc=W[1]),2 in W&&(q.finallyLoc=W[2],q.afterLoc=W[3]),this.tryEntries.push(q)}function $(W){var q=W.completion||{};q.type="normal",delete q.arg,W.completion=q}function U(W){this.tryEntries=[{tryLoc:"root"}],W.forEach(B,this),this.reset(!0)}function J(W){if(W||W===""){var q=W[a];if(q)return q.call(W);if(typeof W.next=="function")return W;if(!isNaN(W.length)){var Y=-1,ae=function Z(){for(;++Y<W.length;)if(r.call(W,Y))return Z.value=W[Y],Z.done=!1,Z;return Z.value=n,Z.done=!0,Z};return ae.next=ae}}throw new TypeError(VE(W)+" is not iterable")}return x.prototype=E,i(I,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:x,configurable:!0}),x.displayName=c(E,l,"GeneratorFunction"),e.isGeneratorFunction=function(W){var q=typeof W=="function"&&W.constructor;return!!q&&(q===x||(q.displayName||q.name)==="GeneratorFunction")},e.mark=function(W){return Object.setPrototypeOf?Object.setPrototypeOf(W,E):(W.__proto__=E,c(W,l,"GeneratorFunction")),W.prototype=Object.create(I),W},e.awrap=function(W){return{__await:W}},D(V.prototype),c(V.prototype,o,function(){return this}),e.AsyncIterator=V,e.async=function(W,q,Y,ae,Z){Z===void 0&&(Z=Promise);var K=new V(u(W,q,Y,ae),Z);return e.isGeneratorFunction(q)?K:K.next().then(function(ne){return ne.done?ne.value:K.next()})},D(I),c(I,l,"Generator"),c(I,a,function(){return this}),c(I,"toString",function(){return"[object Generator]"}),e.keys=function(W){var q=Object(W),Y=[];for(var ae in q)Y.push(ae);return Y.reverse(),function Z(){for(;Y.length;){var K=Y.pop();if(K in q)return Z.value=K,Z.done=!1,Z}return Z.done=!0,Z}},e.values=J,U.prototype={constructor:U,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach($),!q)for(var Y in this)Y.charAt(0)==="t"&&r.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=n)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if(q.type==="throw")throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function ae(de,Me){return ne.type="throw",ne.arg=q,Y.next=de,Me&&(Y.method="next",Y.arg=n),!!Me}for(var Z=this.tryEntries.length-1;Z>=0;--Z){var K=this.tryEntries[Z],ne=K.completion;if(K.tryLoc==="root")return ae("end");if(K.tryLoc<=this.prev){var le=r.call(K,"catchLoc"),ce=r.call(K,"finallyLoc");if(le&&ce){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0);if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}else if(le){if(this.prev<K.catchLoc)return ae(K.catchLoc,!0)}else{if(!ce)throw new Error("try statement without catch or finally");if(this.prev<K.finallyLoc)return ae(K.finallyLoc)}}}},abrupt:function(q,Y){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var Z=this.tryEntries[ae];if(Z.tryLoc<=this.prev&&r.call(Z,"finallyLoc")&&this.prev<Z.finallyLoc){var K=Z;break}}K&&(q==="break"||q==="continue")&&K.tryLoc<=Y&&Y<=K.finallyLoc&&(K=null);var ne=K?K.completion:{};return ne.type=q,ne.arg=Y,K?(this.method="next",this.next=K.finallyLoc,y):this.complete(ne)},complete:function(q,Y){if(q.type==="throw")throw q.arg;return q.type==="break"||q.type==="continue"?this.next=q.arg:q.type==="return"?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):q.type==="normal"&&Y&&(this.next=Y),y},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.finallyLoc===q)return this.complete(ae.completion,ae.afterLoc),$(ae),y}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var ae=this.tryEntries[Y];if(ae.tryLoc===q){var Z=ae.completion;if(Z.type==="throw"){var K=Z.arg;$(ae)}return K}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,ae){return this.delegate={iterator:J(q),resultName:Y,nextLoc:ae},this.method==="next"&&(this.arg=n),y}},e}function Mre(n,e,t,r,i,s,a){try{var o=n[s](a),l=o.value}catch(c){t(c);return}o.done?e(l):Promise.resolve(l).then(r,i)}function cF(n){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=n.apply(e,t);function a(l){Mre(s,r,i,a,o,"next",l)}function o(l){Mre(s,r,i,a,o,"throw",l)}a(void 0)})}}function _ut(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function vut(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,z_e(r.key),r)}}function yut(n,e,t){return e&&vut(n.prototype,e),Object.defineProperty(n,"prototype",{writable:!1}),n}function _v(n,e,t){return e=z_e(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function z_e(n){var e=but(n,"string");return VE(e)=="symbol"?e:String(e)}function but(n,e){if(VE(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(VE(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}var ZO=(function(){function n(){var e=this,t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.serviceUrl,i=t.locale,s=t.headers;_ut(this,n),_v(this,"locale",void 0),_v(this,"serviceUrl",void 0),_v(this,"headers",void 0),_v(this,"fetch",(function(){var a=cF(zS().mark(function o(l){var c;return zS().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,e.serviceUrl?fetch(e.serviceUrl,{body:JSON.stringify(l),headers:e.headers,method:"POST"}):F_e({payload:l});case 2:return c=f.sent,f.abrupt("return",c);case 4:case"end":return f.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),_v(this,"create",(function(){var a=cF(zS().mark(function o(l){return zS().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",e.fetch(l));case 1:case"end":return u.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),_v(this,"createAudio",(function(){var a=cF(zS().mark(function o(l){var c,u;return zS().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,e.create(l);case 2:return c=d.sent,d.next=5,c.arrayBuffer();case 5:return u=d.sent,d.abrupt("return",Sct(u));case 7:case"end":return d.stop()}},o)}));return function(o){return a.apply(this,arguments)}})()),this.locale=i,this.serviceUrl=r,this.headers=s}return yut(n,[{key:"voiceOptions",get:function(){return gut(this.locale)}}]),n})();_v(ZO,"localeOptions",Cct());_v(ZO,"voiceList",aP);_v(ZO,"voiceName",oP);_v(ZO,"createRequest",F_e);let uF;async function j_e(n,e){return new Promise(t=>{xe(uF)||(uF=new ZO({locale:"en-US"}));const r=setTimeout(()=>t(void 0),5e3);uF.createAudio({input:e,options:{voice:n}}).then(i=>{clearTimeout(r),t(i)})})}async function Sut(n,e,t){if(!xe(n)||t.trim()==="")return;const r=await j_e(e,t);xe(r)&&n.addttsaudiobuffer(r)}const Eut=A_e(1);async function xut(n,e){if(!xe(n))return;n.addttsaudiobuffer(e);const t=Math.max(1e3,Math.round(e.duration*1e3));await Ch(t)}const Tut=A_e(1);async function wut(n,e,t){const r=await j_e(e,t);Eut.add(async()=>{xe(r)&&await xut(n,r)})}function Rut(n,e,t){Tut.add(async()=>{await wut(n,e,t)})}const Aut=Date.now(),wg={get value(){return(Date.now()-Aut)/1e3%1e6}},Cut=120;let H_e=0;function q_e(n){H_e=Cut/n}const Mut=136;q_e(Mut);const QO={get value(){return H_e}};function JO(n){const e=n.clone();return e.uniforms.time=wg,e.uniforms.interval=QO,e}let pN=!1,lP=!1;function e3(){lP||pN||(pN=!0,wL(new rR({latencyHint:"playback"}),!0),nat().then(()=>{if(!lP){try{const n=navigator;xe(n.audioSession)&&(n.audioSession.type="playback")}catch{}return w_e().then(()=>{pN=!1,lP=!0,Yke(qS,ss())})}}).catch(n=>{pN=!1,Si(qS,ss(),"audio",n.toString())}))}let _d;function kut(){return _d?.broadcastdestination}const qS=H1("synth",[],n=>{if(!qS.session(n)||(lP&&!xe(_d)&&(_d=R_e(),B9().start()),!xe(_d)))return;const e=ss();switch(n.target){case"audioenabled":if(n.player!==e)return;break}const t=Ts.getState().gadget.board;switch(n.target){case"audioenabled":xs(qS,n.player,"audio is enabled!"),Fc(qS,n.player,async()=>{await Ch(2e3),T_(qS,n.player,void 0,"text","audioenabled","")});break;case"bpm":if(Mn(n.data)){const r=Math.round(n.data);_d.setbpm(r),q_e(r)}break;case"playvolume":Mn(n.data)&&_d.setplayvolume(n.data);break;case"bgplayvolume":Mn(n.data)&&_d.setbgplayvolume(n.data);break;case"ttsvolume":Mn(n.data)&&_d.setttsvolume(n.data);break;case"play":if(bi(n.data)){const[r,i]=n.data;if(r&&r!==t)return;i.trim()===""?_d.stopplay():_d.addplay(i)}break;case"bgplay":if(bi(n.data)){const[r,i,s]=n.data;if(r&&r!==t)return;_d.addbgplay(i,s)}break;case"voice":if(bi(n.data)){const[r,i,s]=n.data;fct(n.player,_d,r,i,s)}break;case"voicefx":if(bi(n.data)){const[r,i,s,a]=n.data;yct(n.player,_d,r,i,s,a)}break;case"record":Vn(n.data)&&_d.synthrecord(n.data);break;case"flush":_d.synthflush();break;case"tts":Fc(qS,n.player,async()=>{if(bi(n.data)){const[r,i]=n.data;await Sut(_d,r,i)}});break;case"ttsqueue":if(bi(n.data)){const[r,i]=n.data;Rut(_d,r,i)}break}});function GE(){return GE=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},GE.apply(null,arguments)}var Out=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.01,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1/(2*Math.PI);return r/Math.atan(1/t)*Math.atan(Math.sin(2*Math.PI*e*i)/t)},Iut=function(e){return 1/(1+e+.48*e*e+.235*e*e*e)};function U0(n,e,t){var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:.25,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:.01,s=arguments.length>5&&arguments[5]!==void 0?arguments[5]:1/0,a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:Iut,o=arguments.length>7&&arguments[7]!==void 0?arguments[7]:.001,l="velocity_"+e;if(n.__damp===void 0&&(n.__damp={}),n.__damp[l]===void 0&&(n.__damp[l]=0),Math.abs(n[e]-t)<=o)return n[e]=t,!1;r=Math.max(1e-4,r);var c=2/r,u=a(c*i),f=n[e]-t,d=t,g=s*r;f=Math.min(Math.max(f,-g),g),t=n[e]-f;var p=(n.__damp[l]+c*f)*i;n.__damp[l]=(n.__damp[l]-c*p)*u;var _=t+(f+p)*u;return d-n[e]>0==_>d&&(_=d,n.__damp[l]=(_-d)/i),n[e]=_,!0}function fF(n,e,t,r,i,s,a,o){return U0(n,e,n[e]+rke(n[e],t),r,i,s,a,o)}var Zx=new ut,kre,Ore,Ire;function N1(n,e,t,r,i,s,a){return typeof e=="number"?Zx.setScalar(e):Array.isArray(e)?Zx.set(e[0],e[1],e[2]):Zx.copy(e),kre=U0(n,"x",Zx.x,t,r,i,s,a),Ore=U0(n,"y",Zx.y,t,r,i,s,a),Ire=U0(n,"z",Zx.z,t,r,i,s,a),kre||Ore||Ire}var FM=new Um,Nre,Pre,Dre;function $9(n,e,t,r,i,s,a){return Array.isArray(e)?FM.set(e[0],e[1],e[2],e[3]):FM.copy(e),Nre=fF(n,"x",FM.x,t,r,i,s,a),Pre=fF(n,"y",FM.y,t,r,i,s,a),Dre=fF(n,"z",FM.z,t,r,i,s,a),Nre||Pre||Dre}const Lre=n=>Symbol.iterator in n,Ure=n=>"entries"in n,Bre=(n,e)=>{const t=n instanceof Map?n:new Map(n.entries()),r=e instanceof Map?e:new Map(e.entries());if(t.size!==r.size)return!1;for(const[i,s]of t)if(!Object.is(s,r.get(i)))return!1;return!0},Nut=(n,e)=>{const t=n[Symbol.iterator](),r=e[Symbol.iterator]();let i=t.next(),s=r.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=t.next(),s=r.next()}return!!i.done&&!!s.done};function Put(n,e){return Object.is(n,e)?!0:typeof n!="object"||n===null||typeof e!="object"||e===null||Object.getPrototypeOf(n)!==Object.getPrototypeOf(e)?!1:Lre(n)&&Lre(e)?Ure(n)&&Ure(e)?Bre(n,e):Nut(n,e):Bre({entries:()=>Object.entries(n)},{entries:()=>Object.entries(e)})}function wd(n){const e=Og.useRef(void 0);return t=>{const r=n(t);return Put(e.current,r)?e.current:e.current=r}}function V_e(n,e,t){const r=Im(g=>g.size),i=Im(g=>g.viewport),s=typeof n=="number"?n:r.width*i.dpr,a=typeof e=="number"?e:r.height*i.dpr,o=(typeof n=="number"?t:n)||{},{samples:l=0,depth:c,...u}=o,f=c??o.depthBuffer,d=it.useMemo(()=>{const g=new Sf(s,a,{minFilter:nc,magFilter:nc,type:db,...u});return f&&(g.depthTexture=new Dw(s,a,Dp)),g.samples=l,g},[]);return it.useLayoutEffect(()=>{d.setSize(s,a),l&&(d.samples=l)},[l,d,s,a]),it.useEffect(()=>()=>d.dispose(),[]),d}const Dut=n=>typeof n=="function",Lut=it.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,children:r,makeDefault:i,...s},a)=>{const o=Im(({set:y})=>y),l=Im(({camera:y})=>y),c=Im(({size:y})=>y),u=it.useRef(null);it.useImperativeHandle(a,()=>u.current,[]);const f=it.useRef(null),d=V_e(e);it.useLayoutEffect(()=>{s.manual||u.current.updateProjectionMatrix()},[c,s]),it.useLayoutEffect(()=>{u.current.updateProjectionMatrix()}),it.useLayoutEffect(()=>{if(i){const y=l;return o(()=>({camera:u.current})),()=>o(()=>({camera:y}))}},[u,i,o]);let g=0,p=null;const _=Dut(r);return Gg(y=>{_&&(t===1/0||g<t)&&(f.current.visible=!1,y.gl.setRenderTarget(d),p=y.scene.background,n&&(y.scene.background=n),y.gl.render(y.scene,u.current),y.scene.background=p,y.gl.setRenderTarget(null),f.current.visible=!0,g++)}),it.createElement(it.Fragment,null,it.createElement("orthographicCamera",GE({left:c.width/-2,right:c.width/2,top:c.height/2,bottom:c.height/-2,ref:u},s),!_&&r),it.createElement("group",{ref:f},_&&r(d.texture)))});var cP={exports:{}},Uut=cP.exports,Fre;function But(){return Fre||(Fre=1,(function(n,e){(function(t,r){n.exports=r()})(Uut,function(){var t=function(){function r(g){return a.appendChild(g.dom),g}function i(g){for(var p=0;p<a.children.length;p++)a.children[p].style.display=p===g?"block":"none";s=g}var s=0,a=document.createElement("div");a.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",a.addEventListener("click",function(g){g.preventDefault(),i(++s%a.children.length)},!1);var o=(performance||Date).now(),l=o,c=0,u=r(new t.Panel("FPS","#0ff","#002")),f=r(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var d=r(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:a,addPanel:r,showPanel:i,begin:function(){o=(performance||Date).now()},end:function(){c++;var g=(performance||Date).now();if(f.update(g-o,200),g>l+1e3&&(u.update(1e3*c/(g-l),100),l=g,c=0,d)){var p=performance.memory;d.update(p.usedJSHeapSize/1048576,p.jsHeapSizeLimit/1048576)}return g},update:function(){o=this.end()},domElement:a,setMode:i}};return t.Panel=function(r,i,s){var a=1/0,o=0,l=Math.round,c=l(window.devicePixelRatio||1),u=80*c,f=48*c,d=3*c,g=2*c,p=3*c,_=15*c,y=74*c,v=30*c,x=document.createElement("canvas");x.width=u,x.height=f,x.style.cssText="width:80px;height:48px";var E=x.getContext("2d");return E.font="bold "+9*c+"px Helvetica,Arial,sans-serif",E.textBaseline="top",E.fillStyle=s,E.fillRect(0,0,u,f),E.fillStyle=i,E.fillText(r,d,g),E.fillRect(p,_,y,v),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(p,_,y,v),{dom:x,update:function(M,O){a=Math.min(a,M),o=Math.max(o,M),E.fillStyle=s,E.globalAlpha=1,E.fillRect(0,0,u,_),E.fillStyle=i,E.fillText(l(M)+" "+r+" ("+l(a)+"-"+l(o)+")",d,g),E.drawImage(x,p+c,_,y-c,v,p,_,y-c,v),E.fillRect(p+y-c,_,c,v),E.fillStyle=s,E.globalAlpha=.9,E.fillRect(p+y-c,_,c,l((1-M/O)*v))}}},t})})(cP)),cP.exports}var Fut=But();const zut=Bh(Fut);function hF(n,e,t,r){return new(t||(t=Promise))((function(i,s){function a(c){try{l(r.next(c))}catch(u){s(u)}}function o(c){try{l(r.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?i(c.value):(u=c.value,u instanceof t?u:new t((function(f){f(u)}))).then(a,o)}l((r=r.apply(n,[])).next())}))}const jut=["geforce 320m","geforce 8600","geforce 8600m gt","geforce 8800 gs","geforce 8800 gt","geforce 9400","geforce 9400m g","geforce 9400m","geforce 9600m gt","geforce 9600m","geforce fx go5200","geforce gt 120","geforce gt 130","geforce gt 330m","geforce gtx 285","google swiftshader","intel g41","intel g45","intel gma 4500mhd","intel gma x3100","intel hd 3000","intel q45","legacy","mali-2","mali-3","mali-4","quadro fx 1500","quadro fx 4","quadro fx 5","radeon hd 2400","radeon hd 2600","radeon hd 4670","radeon hd 4850","radeon hd 4870","radeon hd 5670","radeon hd 5750","radeon hd 6290","radeon hd 6300","radeon hd 6310","radeon hd 6320","radeon hd 6490m","radeon hd 6630m","radeon hd 6750m","radeon hd 6770m","radeon hd 6970m","sgx 543","sgx543"];function zre(n){return n=n.toLowerCase().replace(/.*angle ?\((.+)\)(?: on vulkan [0-9.]+)?$/i,"$1").replace(/\s(\d{1,2}gb|direct3d.+$)|\(r\)| \([^)]+\)$/g,"").replace(/(?:vulkan|opengl) \d+\.\d+(?:\.\d+)?(?: \((.*)\))?/,"$1")}const G_e=typeof window>"u",uv=(()=>{if(G_e)return;const{userAgent:n,platform:e,maxTouchPoints:t}=window.navigator,r=/(iphone|ipod|ipad)/i.test(n),i=e==="iPad"||e==="MacIntel"&&t>0&&!window.MSStream;return{isIpad:i,isMobile:/android/i.test(n)||r||i,isSafari12:/Version\/12.+Safari/.test(n),isFirefox:/Firefox/.test(n)}})();function Hut(n,e,t){if(!t)return[e];const r=(function(c){const u=`
    precision highp float;
    attribute vec3 aPosition;
    varying float vvv;
    void main() {
      vvv = 0.31622776601683794;
      gl_Position = vec4(aPosition, 1.0);
    }
  `,f=`
    precision highp float;
    varying float vvv;
    void main() {
      vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;
      enc = fract(enc);
      enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);
      gl_FragColor = enc;
    }
  `,d=c.createShader(35633),g=c.createShader(35632),p=c.createProgram();if(!(g&&d&&p))return;c.shaderSource(d,u),c.shaderSource(g,f),c.compileShader(d),c.compileShader(g),c.attachShader(p,d),c.attachShader(p,g),c.linkProgram(p),c.detachShader(p,d),c.detachShader(p,g),c.deleteShader(d),c.deleteShader(g),c.useProgram(p);const _=c.createBuffer();c.bindBuffer(34962,_),c.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const y=c.getAttribLocation(p,"aPosition");c.vertexAttribPointer(y,3,5126,!1,0,0),c.enableVertexAttribArray(y),c.clearColor(1,1,1,1),c.clear(16384),c.viewport(0,0,1,1),c.drawArrays(4,0,3);const v=new Uint8Array(4);return c.readPixels(0,0,1,1,6408,5121,v),c.deleteProgram(p),c.deleteBuffer(_),v.join("")})(n),i="801621810",s="8016218135",a="80162181161",o=uv?.isIpad?[["a7",a,12],["a8",s,15],["a8x",s,15],["a9",s,15],["a9x",s,15],["a10",s,15],["a10x",s,15],["a12",i,15],["a12x",i,15],["a12z",i,15],["a14",i,15],["a15",i,15],["m1",i,15],["m2",i,15]]:[["a7",a,12],["a8",s,12],["a9",s,15],["a10",s,15],["a11",i,15],["a12",i,15],["a13",i,15],["a14",i,15],["a15",i,15],["a16",i,15],["a17",i,15]];let l;return r==="80162181255"?l=o.filter((([,,c])=>c>=14)):(l=o.filter((([,c])=>c===r)),l.length||(l=o)),l.map((([c])=>`apple ${c} gpu`))}class jre extends Error{constructor(e){super(e),Object.setPrototypeOf(this,new.target.prototype)}}const dF=[],Hre=[];function qut(n,e){if(n===e)return 0;const t=n;n.length>e.length&&(n=e,e=t);let r=n.length,i=e.length;for(;r>0&&n.charCodeAt(~-r)===e.charCodeAt(~-i);)r--,i--;let s,a=0;for(;a<r&&n.charCodeAt(a)===e.charCodeAt(a);)a++;if(r-=a,i-=a,r===0)return i;let o,l,c=0,u=0,f=0;for(;u<r;)Hre[u]=n.charCodeAt(a+u),dF[u]=++u;for(;f<i;)for(s=e.charCodeAt(a+f),o=f++,c=f,u=0;u<r;u++)l=s===Hre[u]?o:o+1,o=dF[u],c=dF[u]=o>c?l>c?c+1:l:l>o?o+1:l;return c}function Vut(n){return n!=null}const Gut=({mobileTiers:n=[0,15,30,60],desktopTiers:e=[0,15,30,60],override:t={},glContext:r,failIfMajorPerformanceCaveat:i=!1,benchmarksURL:s="https://unpkg.com/detect-gpu@5.0.70/dist/benchmarks"}={})=>hF(void 0,void 0,void 0,(function*(){const a={};if(G_e)return{tier:0,type:"SSR"};const{isIpad:o=!!uv?.isIpad,isMobile:l=!!uv?.isMobile,screenSize:c=window.screen,loadBenchmarks:u=(O=>hF(void 0,void 0,void 0,(function*(){const N=yield fetch(`${s}/${O}`).then((I=>I.json()));if(parseInt(N.shift().split(".")[0],10)<4)throw new jre("Detect GPU benchmark data is out of date. Please update to version 4x");return N})))}=t;let{renderer:f}=t;const d=(O,N,I,D,V)=>({device:V,fps:D,gpu:I,isMobile:l,tier:O,type:N});let g,p="";if(f)f=zre(f),g=[f];else{const O=r||(function(I,D=!1){const V={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:D,powerPreference:"high-performance",stencil:!1};I&&delete V.powerPreference;const G=window.document.createElement("canvas"),Q=G.getContext("webgl",V)||G.getContext("experimental-webgl",V);return Q??void 0})(uv?.isSafari12,i);if(!O)return d(0,"WEBGL_UNSUPPORTED");const N=uv?.isFirefox?null:O.getExtension("WEBGL_debug_renderer_info");if(f=N?O.getParameter(N.UNMASKED_RENDERER_WEBGL):O.getParameter(O.RENDERER),!f)return d(1,"FALLBACK");p=f,f=zre(f),g=(function(I,D,V){return D==="apple gpu"?Hut(I,D,V):[D]})(O,f,l)}const _=(yield Promise.all(g.map((function(O){var N;return hF(this,void 0,void 0,(function*(){const I=(le=>{const ce=l?["adreno","apple","mali-t","mali","nvidia","powervr","samsung"]:["intel","apple","amd","radeon","nvidia","geforce","adreno"];for(const de of ce)if(le.includes(de))return de})(O);if(!I)return;const D=`${l?"m":"d"}-${I}${o?"-ipad":""}.json`,V=a[D]=(N=a[D])!==null&&N!==void 0?N:u(D);let G;try{G=yield V}catch(le){if(le instanceof jre)throw le;return}const Q=(function(le){var ce;const de=(le=le.replace(/\([^)]+\)/,"")).match(/\d+/)||le.match(/(\W|^)([A-Za-z]{1,3})(\W|$)/g);return(ce=de?.join("").replace(/\W|amd/g,""))!==null&&ce!==void 0?ce:""})(O);let B=G.filter((([,le])=>le===Q));B.length||(B=G.filter((([le])=>le.includes(O))));const $=B.length;if($===0)return;const U=O.split(/[.,()\[\]/\s]/g).sort().filter(((le,ce,de)=>ce===0||le!==de[ce-1])).join(" ");let J,[W,,,,q]=$>1?B.map((le=>[le,qut(U,le[2])])).sort((([,le],[,ce])=>le-ce))[0][0]:B[0],Y=Number.MAX_VALUE;const{devicePixelRatio:ae}=window,Z=c.width*ae*c.height*ae;for(const le of q){const[ce,de]=le,Me=ce*de,qe=Math.abs(Z-Me);qe<Y&&(Y=qe,J=le)}if(!J)return;const[,,K,ne]=J;return[Y,K,W,ne]}))})))).filter(Vut).sort((([O=Number.MAX_VALUE,N],[I=Number.MAX_VALUE,D])=>O===I?N-D:O-I));if(!_.length){const O=jut.find((N=>f.includes(N)));return O?d(0,"BLOCKLISTED",O):d(1,"FALLBACK",`${f} (${p})`)}const[,y,v,x]=_[0];if(y===-1)return d(0,"BLOCKLISTED",v,y,x);const E=l?n:e;let M=0;for(let O=0;O<E.length;O++)y>=E[O]&&(M=O);return d(M,"BENCHMARK",v,y,x)})),$ut=n=>Moe(()=>Gut(n),["useDetectGPU"]),qre=(n,e)=>{n.updateRanges[0]=e};function Wut(n){return typeof n=="function"}const Vre=new Qr,Gre=new Qr,mN=[],zM=new vu;class Yut extends YS{constructor(){super(),this.color=new cr("white"),this.instance={current:void 0},this.instanceKey={current:void 0}}get geometry(){var e;return(e=this.instance.current)==null?void 0:e.geometry}raycast(e,t){const r=this.instance.current;if(!r||!r.geometry||!r.material)return;zM.geometry=r.geometry;const i=r.matrixWorld,s=r.userData.instances.indexOf(this.instanceKey);if(!(s===-1||s>r.count)){r.getMatrixAt(s,Vre),Gre.multiplyMatrices(i,Vre),zM.matrixWorld=Gre,r.material instanceof nh?zM.material.side=r.material.side:zM.material.side=r.material[0].side,zM.raycast(e,mN);for(let a=0,o=mN.length;a<o;a++){const l=mN[a];l.instanceId=s,l.object=this,t.push(l)}mN.length=0}}}const $_e=it.createContext(null),$re=new Qr,Wre=new Qr,Xut=new Qr,Yre=new ut,Xre=new jp,Kre=new ut,Kut=n=>n.isInstancedBufferAttribute,zy=it.forwardRef(({context:n,children:e,...t},r)=>{it.useMemo(()=>nj({PositionMesh:Yut}),[]);const i=it.useRef(null);it.useImperativeHandle(r,()=>i.current,[]);const{subscribe:s,getParent:a}=it.useContext(n||$_e);return it.useLayoutEffect(()=>s(i),[]),it.createElement("positionMesh",GE({instance:a(),instanceKey:i,ref:i},t),e)}),o1=it.forwardRef(({context:n,children:e,range:t,limit:r=1e3,frames:i=1/0,...s},a)=>{const[{localContext:o,instance:l}]=it.useState(()=>{const x=it.createContext(null);return{localContext:x,instance:it.forwardRef((E,M)=>it.createElement(zy,GE({context:x},E,{ref:M})))}}),c=it.useRef(null);it.useImperativeHandle(a,()=>c.current,[]);const[u,f]=it.useState([]),[[d,g]]=it.useState(()=>{const x=new Float32Array(r*16);for(let E=0;E<r;E++)Xut.identity().toArray(x,E*16);return[x,new Float32Array([...new Array(r*3)].map(()=>1))]});it.useEffect(()=>{c.current.instanceMatrix.needsUpdate=!0});let p=0,_=0;const y=it.useRef([]);it.useLayoutEffect(()=>{y.current=Object.entries(c.current.geometry.attributes).filter(([x,E])=>Kut(E))}),Gg(()=>{if(i===1/0||p<i){c.current.updateMatrix(),c.current.updateMatrixWorld(),$re.copy(c.current.matrixWorld).invert(),_=Math.min(r,t!==void 0?t:r,u.length),c.current.count=_,qre(c.current.instanceMatrix,{start:0,count:_*16}),qre(c.current.instanceColor,{start:0,count:_*3});for(let x=0;x<u.length;x++){const E=u[x].current;E.matrixWorld.decompose(Yre,Xre,Kre),Wre.compose(Yre,Xre,Kre).premultiply($re),Wre.toArray(d,x*16),c.current.instanceMatrix.needsUpdate=!0,E.color.toArray(g,x*3),c.current.instanceColor.needsUpdate=!0}p++}});const v=it.useMemo(()=>({getParent:()=>c,subscribe:x=>(f(E=>[...E,x]),()=>f(E=>E.filter(M=>M.current!==x.current)))}),[]);return it.createElement("instancedMesh",GE({userData:{instances:u,limit:r,frames:i},matrixAutoUpdate:!1,ref:c,args:[null,null,0],raycast:()=>null},s),it.createElement("instancedBufferAttribute",{attach:"instanceMatrix",args:[d,16],usage:$F}),it.createElement("instancedBufferAttribute",{attach:"instanceColor",args:[g,3],usage:$F}),Wut(e)?it.createElement(o.Provider,{value:v},e(l)):n?it.createElement(n.Provider,{value:v},e):it.createElement($_e.Provider,{value:v},e))});function Zut(n,e){const t=n+"Geometry";return it.forwardRef(({args:r,children:i,...s},a)=>{const o=it.useRef(null);return it.useImperativeHandle(a,()=>o.current),it.useLayoutEffect(()=>void e?.(o.current)),it.createElement("mesh",GE({ref:o},s),it.createElement(t,{attach:"geometry",args:r}),i)})}const Qut=Zut("plane");/**
 * postprocessing v6.37.7 build Mon Aug 04 2025
 * https://github.com/pmndrs/postprocessing
 * Copyright 2015-2025 Raoul van Rschen
 * @license Zlib
 */var pF=1/1e3,Jut=1e3,eft=class{constructor(){this.startTime=performance.now(),this.previousTime=0,this.currentTime=0,this._delta=0,this._elapsed=0,this._fixedDelta=1e3/60,this.timescale=1,this.useFixedDelta=!1,this._autoReset=!1}get autoReset(){return this._autoReset}set autoReset(n){typeof document<"u"&&document.hidden!==void 0&&(n?document.addEventListener("visibilitychange",this):document.removeEventListener("visibilitychange",this),this._autoReset=n)}get delta(){return this._delta*pF}get fixedDelta(){return this._fixedDelta*pF}set fixedDelta(n){this._fixedDelta=n*Jut}get elapsed(){return this._elapsed*pF}update(n){this.useFixedDelta?this._delta=this.fixedDelta:(this.previousTime=this.currentTime,this.currentTime=(n!==void 0?n:performance.now())-this.startTime,this._delta=this.currentTime-this.previousTime),this._delta*=this.timescale,this._elapsed+=this._delta}reset(){this._delta=0,this._elapsed=0,this.currentTime=performance.now()-this.startTime}getDelta(){return this.delta}getElapsed(){return this.elapsed}handleEvent(n){document.hidden||(this.currentTime=performance.now()-this.startTime)}dispose(){this.autoReset=!1}},tft=(()=>{const n=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),e=new Float32Array([0,0,2,0,0,2]),t=new ts;return t.setAttribute("position",new Ps(n,3)),t.setAttribute("uv",new Ps(e,2)),t})(),Ym=class W9{static get fullscreenGeometry(){return tft}constructor(e="Pass",t=new VT,r=new Zk){this.name=e,this.renderer=null,this.scene=t,this.camera=r,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}get renderToScreen(){return!this.rtt}set renderToScreen(e){if(this.rtt===e){const t=this.fullscreenMaterial;t!==null&&(t.needsUpdate=!0),this.rtt=!e}}set mainScene(e){}set mainCamera(e){}setRenderer(e){this.renderer=e}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}get fullscreenMaterial(){return this.screen!==null?this.screen.material:null}set fullscreenMaterial(e){let t=this.screen;t!==null?t.material=e:(t=new vu(W9.fullscreenGeometry,e),t.frustumCulled=!1,this.scene===null&&(this.scene=new VT),this.scene.add(t),this.screen=t)}getFullscreenMaterial(){return this.fullscreenMaterial}setFullscreenMaterial(e){this.fullscreenMaterial=e}getDepthTexture(){return null}setDepthTexture(e,t=U1){}render(e,t,r,i,s){throw new Error("Render method not implemented!")}setSize(e,t){}initialize(e,t,r){}dispose(){for(const e of Object.keys(this)){const t=this[e];(t instanceof Sf||t instanceof nh||t instanceof xc||t instanceof W9)&&this[e].dispose()}this.fullscreenMaterial!==null&&this.fullscreenMaterial.dispose()}},nft=class extends Ym{constructor(){super("ClearMaskPass",null,null),this.needsSwap=!1}render(n,e,t,r,i){const s=n.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}},rft=`#include <common>
#include <dithering_pars_fragment>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;
#include <colorspace_fragment>
#include <dithering_fragment>
}`,t3="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",W_e=class extends jl{constructor(){super({name:"CopyMaterial",uniforms:{inputBuffer:new jn(null),opacity:new jn(1)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:rft,vertexShader:t3})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}getOpacity(n){return this.uniforms.opacity.value}setOpacity(n){this.uniforms.opacity.value=n}},Y_e=class extends Ym{constructor(n,e=!0){super("CopyPass"),this.fullscreenMaterial=new W_e,this.needsSwap=!1,this.renderTarget=n,n===void 0&&(this.renderTarget=new Sf(1,1,{minFilter:nc,magFilter:nc,stencilBuffer:!1,depthBuffer:!1}),this.renderTarget.texture.name="CopyPass.Target"),this.autoResize=e}get resize(){return this.autoResize}set resize(n){this.autoResize=n}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}setAutoResizeEnabled(n){this.autoResize=n}render(n,e,t,r,i){this.fullscreenMaterial.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){this.autoResize&&this.renderTarget.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTarget.texture.type=t,t!==zl?this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1":n!==null&&n.outputColorSpace===ta&&(this.renderTarget.texture.colorSpace=ta))}},Zre=new cr,X_e=class extends Ym{constructor(n=!0,e=!0,t=!1){super("ClearPass",null,null),this.needsSwap=!1,this.color=n,this.depth=e,this.stencil=t,this.overrideClearColor=null,this.overrideClearAlpha=-1}setClearFlags(n,e,t){this.color=n,this.depth=e,this.stencil=t}getOverrideClearColor(){return this.overrideClearColor}setOverrideClearColor(n){this.overrideClearColor=n}getOverrideClearAlpha(){return this.overrideClearAlpha}setOverrideClearAlpha(n){this.overrideClearAlpha=n}render(n,e,t,r,i){const s=this.overrideClearColor,a=this.overrideClearAlpha,o=n.getClearAlpha(),l=s!==null,c=a>=0;l?(n.getClearColor(Zre),n.setClearColor(s,c?a:o)):c&&n.setClearAlpha(a),n.setRenderTarget(this.renderToScreen?null:e),n.clear(this.color,this.depth,this.stencil),l?n.setClearColor(Zre,o):c&&n.setClearAlpha(o)}},ift=class extends Ym{constructor(n,e){super("MaskPass",n,e),this.needsSwap=!1,this.clearPass=new X_e(!1,!1,!0),this.inverse=!1}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get inverted(){return this.inverse}set inverted(n){this.inverse=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getClearPass(){return this.clearPass}isInverted(){return this.inverted}setInverted(n){this.inverted=n}render(n,e,t,r,i){const s=n.getContext(),a=n.state.buffers,o=this.scene,l=this.camera,c=this.clearPass,u=this.inverted?0:1,f=1-u;a.color.setMask(!1),a.depth.setMask(!1),a.color.setLocked(!0),a.depth.setLocked(!0),a.stencil.setTest(!0),a.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),a.stencil.setFunc(s.ALWAYS,u,4294967295),a.stencil.setClear(f),a.stencil.setLocked(!0),this.clearPass.enabled&&(this.renderToScreen?c.render(n,null):(c.render(n,e),c.render(n,t))),this.renderToScreen?(n.setRenderTarget(null),n.render(o,l)):(n.setRenderTarget(e),n.render(o,l),n.setRenderTarget(t),n.render(o,l)),a.color.setLocked(!1),a.depth.setLocked(!1),a.stencil.setLocked(!1),a.stencil.setFunc(s.EQUAL,1,4294967295),a.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),a.stencil.setLocked(!0)}},K_e=class{constructor(e=null,{depthBuffer:t=!0,stencilBuffer:r=!1,multisampling:i=0,frameBufferType:s}={}){this.renderer=null,this.inputBuffer=this.createBuffer(t,r,s,i),this.outputBuffer=this.inputBuffer.clone(),this.copyPass=new Y_e,this.depthTexture=null,this.passes=[],this.timer=new eft,this.autoRenderToScreen=!0,this.setRenderer(e)}get multisampling(){return this.inputBuffer.samples||0}set multisampling(e){const t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e,this.inputBuffer.dispose(),this.outputBuffer.dispose()):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}getTimer(){return this.timer}getRenderer(){return this.renderer}setRenderer(e){if(this.renderer=e,e!==null){const t=e.getSize(new an),r=e.getContext().getContextAttributes().alpha,i=this.inputBuffer.texture.type;i===zl&&e.outputColorSpace===ta&&(this.inputBuffer.texture.colorSpace=ta,this.outputBuffer.texture.colorSpace=ta,this.inputBuffer.dispose(),this.outputBuffer.dispose()),e.autoClear=!1,this.setSize(t.width,t.height);for(const s of this.passes)s.initialize(e,r,i)}}replaceRenderer(e,t=!0){const r=this.renderer,i=r.domElement.parentNode;return this.setRenderer(e),t&&i!==null&&(i.removeChild(r.domElement),i.appendChild(e.domElement)),r}createDepthTexture(){const e=this.depthTexture=new Dw;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=_E,e.type=gE):e.type=Uv,e}deleteDepthTexture(){if(this.depthTexture!==null){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();for(const e of this.passes)e.setDepthTexture(null)}}createBuffer(e,t,r,i){const s=this.renderer,a=s===null?new an:s.getDrawingBufferSize(new an),o={minFilter:nc,magFilter:nc,stencilBuffer:t,depthBuffer:e,type:r},l=new Sf(a.width,a.height,o);return i>0&&(l.ignoreDepthForMultisampleCopy=!1,l.samples=i),r===zl&&s!==null&&s.outputColorSpace===ta&&(l.texture.colorSpace=ta),l.texture.name="EffectComposer.Buffer",l.texture.generateMipmaps=!1,l}setMainScene(e){for(const t of this.passes)t.mainScene=e}setMainCamera(e){for(const t of this.passes)t.mainCamera=e}addPass(e,t){const r=this.passes,i=this.renderer,s=i.getDrawingBufferSize(new an),a=i.getContext().getContextAttributes().alpha,o=this.inputBuffer.texture.type;if(e.setRenderer(i),e.setSize(s.width,s.height),e.initialize(i,a,o),this.autoRenderToScreen&&(r.length>0&&(r[r.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),t!==void 0?r.splice(t,0,e):r.push(e),this.autoRenderToScreen&&(r[r.length-1].renderToScreen=!0),e.needsDepthTexture||this.depthTexture!==null)if(this.depthTexture===null){const l=this.createDepthTexture();for(e of r)e.setDepthTexture(l)}else e.setDepthTexture(this.depthTexture)}removePass(e){const t=this.passes,r=t.indexOf(e);if(r!==-1&&t.splice(r,1).length>0){if(this.depthTexture!==null){const a=(l,c)=>l||c.needsDepthTexture;t.reduce(a,!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}removeAllPasses(){const e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}render(e){const t=this.renderer,r=this.copyPass;let i=this.inputBuffer,s=this.outputBuffer,a=!1,o,l,c;e===void 0&&(this.timer.update(),e=this.timer.getDelta());for(const u of this.passes)u.enabled&&(u.render(t,i,s,e,a),u.needsSwap&&(a&&(r.renderToScreen=u.renderToScreen,o=t.getContext(),l=t.state.buffers.stencil,l.setFunc(o.NOTEQUAL,1,4294967295),r.render(t,i,s,e,a),l.setFunc(o.EQUAL,1,4294967295)),c=i,i=s,s=c),u instanceof ift?a=!0:u instanceof nft&&(a=!1))}setSize(e,t,r){const i=this.renderer,s=i.getSize(new an);(e===void 0||t===void 0)&&(e=s.width,t=s.height),(s.width!==e||s.height!==t)&&i.setSize(e,t,r);const a=i.getDrawingBufferSize(new an);this.inputBuffer.setSize(a.width,a.height),this.outputBuffer.setSize(a.width,a.height);for(const o of this.passes)o.setSize(a.width,a.height)}reset(){this.dispose(),this.autoRenderToScreen=!0}dispose(){for(const e of this.passes)e.dispose();this.passes=[],this.inputBuffer!==null&&this.inputBuffer.dispose(),this.outputBuffer!==null&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose(),this.timer.dispose(),Ym.fullscreenGeometry.dispose()}},Lm={NONE:0,DEPTH:1,CONVOLUTION:2},Ka={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},sft=class{constructor(){this.shaderParts=new Map([[Ka.FRAGMENT_HEAD,null],[Ka.FRAGMENT_MAIN_UV,null],[Ka.FRAGMENT_MAIN_IMAGE,null],[Ka.VERTEX_HEAD,null],[Ka.VERTEX_MAIN_SUPPORT,null]]),this.defines=new Map,this.uniforms=new Map,this.blendModes=new Map,this.extensions=new Set,this.attributes=Lm.NONE,this.varyings=new Set,this.uvTransformation=!1,this.readDepth=!1,this.colorSpace=Bv}},mF=!1,Qre=class{constructor(n=null){this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.materialsFlatShaded=null,this.materialsFlatShadedBackSide=null,this.materialsFlatShadedDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=e=>{if(e.isMesh){let t;if(e.material.flatShading)switch(e.material.side){case $f:t=this.materialsFlatShadedDoubleSide;break;case Yf:t=this.materialsFlatShadedBackSide;break;default:t=this.materialsFlatShaded;break}else switch(e.material.side){case $f:t=this.materialsDoubleSide;break;case Yf:t=this.materialsBackSide;break;default:t=this.materials;break}this.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=t[2]:e.isInstancedMesh?e.material=t[1]:e.material=t[0],++this.meshCount}}}cloneMaterial(n){if(!(n instanceof jl))return n.clone();const e=n.uniforms,t=new Map;for(const i in e){const s=e[i].value;s.isRenderTargetTexture&&(e[i].value=null,t.set(i,s))}const r=n.clone();for(const i of t)e[i[0]].value=i[1],r.uniforms[i[0]].value=i[1];return r}setMaterial(n){if(this.disposeMaterials(),this.material=n,n!==null){const e=this.materials=[this.cloneMaterial(n),this.cloneMaterial(n),this.cloneMaterial(n)];for(const t of e)t.uniforms=Object.assign({},n.uniforms),t.side=Lv;e[2].skinning=!0,this.materialsBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=Yf,r}),this.materialsDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.side=$f,r}),this.materialsFlatShaded=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r}),this.materialsFlatShadedBackSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=Yf,r}),this.materialsFlatShadedDoubleSide=e.map(t=>{const r=this.cloneMaterial(t);return r.uniforms=Object.assign({},n.uniforms),r.flatShading=!0,r.side=$f,r})}}render(n,e,t){const r=n.shadowMap.enabled;if(n.shadowMap.enabled=!1,mF){const i=this.originalMaterials;this.meshCount=0,e.traverse(this.replaceMaterial),n.render(e,t);for(const s of i)s[0].material=s[1];this.meshCount!==i.size&&i.clear()}else{const i=e.overrideMaterial;e.overrideMaterial=this.material,n.render(e,t),e.overrideMaterial=i}n.shadowMap.enabled=r}disposeMaterials(){if(this.material!==null){const n=this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide).concat(this.materialsFlatShaded).concat(this.materialsFlatShadedBackSide).concat(this.materialsFlatShadedDoubleSide);for(const e of n)e.dispose()}}dispose(){this.originalMaterials.clear(),this.disposeMaterials()}static get workaroundEnabled(){return mF}static set workaroundEnabled(n){mF=n}},$b=-1,Ng=class extends Vg{constructor(n,e=$b,t=$b,r=1){super(),this.resizable=n,this.baseSize=new an(1,1),this.preferredSize=new an(e,t),this.target=this.preferredSize,this.s=r,this.effectiveSize=new an,this.addEventListener("change",()=>this.updateEffectiveSize()),this.updateEffectiveSize()}updateEffectiveSize(){const n=this.baseSize,e=this.preferredSize,t=this.effectiveSize,r=this.scale;e.width!==$b?t.width=e.width:e.height!==$b?t.width=Math.round(e.height*(n.width/Math.max(n.height,1))):t.width=Math.round(n.width*r),e.height!==$b?t.height=e.height:e.width!==$b?t.height=Math.round(e.width/Math.max(n.width/Math.max(n.height,1),1)):t.height=Math.round(n.height*r)}get width(){return this.effectiveSize.width}set width(n){this.preferredWidth=n}get height(){return this.effectiveSize.height}set height(n){this.preferredHeight=n}getWidth(){return this.width}getHeight(){return this.height}get scale(){return this.s}set scale(n){this.s!==n&&(this.s=n,this.preferredSize.setScalar($b),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getScale(){return this.scale}setScale(n){this.scale=n}get baseWidth(){return this.baseSize.width}set baseWidth(n){this.baseSize.width!==n&&(this.baseSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseWidth(){return this.baseWidth}setBaseWidth(n){this.baseWidth=n}get baseHeight(){return this.baseSize.height}set baseHeight(n){this.baseSize.height!==n&&(this.baseSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getBaseHeight(){return this.baseHeight}setBaseHeight(n){this.baseHeight=n}setBaseSize(n,e){(this.baseSize.width!==n||this.baseSize.height!==e)&&(this.baseSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}get preferredWidth(){return this.preferredSize.width}set preferredWidth(n){this.preferredSize.width!==n&&(this.preferredSize.width=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredWidth(){return this.preferredWidth}setPreferredWidth(n){this.preferredWidth=n}get preferredHeight(){return this.preferredSize.height}set preferredHeight(n){this.preferredSize.height!==n&&(this.preferredSize.height=n,this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}getPreferredHeight(){return this.preferredHeight}setPreferredHeight(n){this.preferredHeight=n}setPreferredSize(n,e){(this.preferredSize.width!==n||this.preferredSize.height!==e)&&(this.preferredSize.set(n,e),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height))}copy(n){this.s=n.scale,this.baseSize.set(n.baseWidth,n.baseHeight),this.preferredSize.set(n.preferredWidth,n.preferredHeight),this.dispatchEvent({type:"change"}),this.resizable.setSize(this.baseSize.width,this.baseSize.height)}static get AUTO_SIZE(){return $b}},Es={ADD:0,ALPHA:1,AVERAGE:2,COLOR:3,COLOR_BURN:4,COLOR_DODGE:5,DARKEN:6,DIFFERENCE:7,DIVIDE:8,DST:9,EXCLUSION:10,HARD_LIGHT:11,HARD_MIX:12,HUE:13,INVERT:14,INVERT_RGB:15,LIGHTEN:16,LINEAR_BURN:17,LINEAR_DODGE:18,LINEAR_LIGHT:19,LUMINOSITY:20,MULTIPLY:21,NEGATION:22,NORMAL:23,OVERLAY:24,PIN_LIGHT:25,REFLECT:26,SATURATION:27,SCREEN:28,SOFT_LIGHT:29,SRC:30,SUBTRACT:31,VIVID_LIGHT:32},aft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb,y.a),opacity);}",oft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,y.a*opacity);}",lft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb)*0.5,y.a),opacity);}",cft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.xy,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",uft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=mix(step(0.0,b)*(1.0-min(vec3(1.0),(1.0-a)/b)),vec3(1.0),step(1.0,a));return mix(x,vec4(z,y.a),opacity);}",fft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb,b=y.rgb;vec3 z=step(0.0,a)*mix(min(vec3(1.0),a/max(1.0-b,1e-9)),vec3(1.0),step(1.0,b));return mix(x,vec4(z,y.a),opacity);}",hft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb,y.rgb),y.a),opacity);}",dft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(abs(x.rgb-y.rgb),y.a),opacity);}",pft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb/max(y.rgb,1e-12),y.a),opacity);}",mft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4((x.rgb+y.rgb-2.0*x.rgb*y.rgb),y.a),opacity);}",gft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=min(x.rgb,1.0);vec3 b=min(y.rgb,1.0);vec3 z=mix(2.0*a*b,1.0-2.0*(1.0-a)*(1.0-b),step(0.5,b));return mix(x,vec4(z,y.a),opacity);}",_ft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(step(1.0,x.rgb+y.rgb),y.a),opacity);}",vft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(yHSL.x,xHSL.yz));return mix(x,vec4(z,y.a),opacity);}",yft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-y.rgb,y.a),opacity);}",bft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(y.rgb*(1.0-x.rgb),y.a),opacity);}",Sft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb,y.rgb),y.a),opacity);}",Eft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",xft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(min(x.rgb+y.rgb,1.0),y.a),opacity);}",Tft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(clamp(2.0*y.rgb+x.rgb-1.0,0.0,1.0),y.a),opacity);}",wft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.xy,yHSL.z));return mix(x,vec4(z,y.a),opacity);}",Rft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb*y.rgb,y.a),opacity);}",Aft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(1.0-abs(1.0-x.rgb-y.rgb),y.a),opacity);}",Cft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,y,opacity);}",Mft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(2.0*y.rgb*x.rgb,1.0-2.0*(1.0-y.rgb)*(1.0-x.rgb),step(0.5,x.rgb));return mix(x,vec4(z,y.a),opacity);}",kft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 y2=2.0*y.rgb;vec3 z=mix(mix(y2,x.rgb,step(0.5*x.rgb,y.rgb)),max(y2-1.0,vec3(0.0)),step(x.rgb,y2-1.0));return mix(x,vec4(z,y.a),opacity);}",Oft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(min(x.rgb*x.rgb/max(1.0-y.rgb,1e-12),1.0),y.rgb,step(1.0,y.rgb));return mix(x,vec4(z,y.a),opacity);}",Ift="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 xHSL=RGBToHSL(x.rgb);vec3 yHSL=RGBToHSL(y.rgb);vec3 z=HSLToRGB(vec3(xHSL.x,yHSL.y,xHSL.z));return mix(x,vec4(z,y.a),opacity);}",Nft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(x.rgb+y.rgb-min(x.rgb*y.rgb,1.0),y.a),opacity);}",Pft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 a=x.rgb;vec3 b=y.rgb;vec3 y2=2.0*b;vec3 w=step(0.5,b);vec3 c=a-(1.0-y2)*a*(1.0-a);vec3 d=mix(a+(y2-1.0)*(sqrt(a)-a),a+(y2-1.0)*a*((16.0*a-12.0)*a+3.0),w*(1.0-step(0.25,a)));vec3 z=mix(c,d,w);return mix(x,vec4(z,y.a),opacity);}",Dft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y;}",Lft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return mix(x,vec4(max(x.rgb+y.rgb-1.0,0.0),y.a),opacity);}",Uft="vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec3 z=mix(max(1.0-min((1.0-x.rgb)/(2.0*y.rgb),1.0),0.0),min(x.rgb/(2.0*(1.0-y.rgb)),1.0),step(0.5,y.rgb));return mix(x,vec4(z,y.a),opacity);}",Bft=new Map([[Es.ADD,aft],[Es.ALPHA,oft],[Es.AVERAGE,lft],[Es.COLOR,cft],[Es.COLOR_BURN,uft],[Es.COLOR_DODGE,fft],[Es.DARKEN,hft],[Es.DIFFERENCE,dft],[Es.DIVIDE,pft],[Es.DST,null],[Es.EXCLUSION,mft],[Es.HARD_LIGHT,gft],[Es.HARD_MIX,_ft],[Es.HUE,vft],[Es.INVERT,yft],[Es.INVERT_RGB,bft],[Es.LIGHTEN,Sft],[Es.LINEAR_BURN,Eft],[Es.LINEAR_DODGE,xft],[Es.LINEAR_LIGHT,Tft],[Es.LUMINOSITY,wft],[Es.MULTIPLY,Rft],[Es.NEGATION,Aft],[Es.NORMAL,Cft],[Es.OVERLAY,Mft],[Es.PIN_LIGHT,kft],[Es.REFLECT,Oft],[Es.SATURATION,Ift],[Es.SCREEN,Nft],[Es.SOFT_LIGHT,Pft],[Es.SRC,Dft],[Es.SUBTRACT,Lft],[Es.VIVID_LIGHT,Uft]]),Fft=class extends Vg{constructor(n,e=1){super(),this._blendFunction=n,this.opacity=new jn(e)}getOpacity(){return this.opacity.value}setOpacity(n){this.opacity.value=n}get blendFunction(){return this._blendFunction}set blendFunction(n){this._blendFunction=n,this.dispatchEvent({type:"change"})}getBlendFunction(){return this.blendFunction}setBlendFunction(n){this.blendFunction=n}getShaderCode(){return Bft.get(this.blendFunction)}},L_=class extends Vg{constructor(n,e,{attributes:t=Lm.NONE,blendFunction:r=Es.NORMAL,defines:i=new Map,uniforms:s=new Map,extensions:a=null,vertexShader:o=null}={}){super(),this.name=n,this.renderer=null,this.attributes=t,this.fragmentShader=e,this.vertexShader=o,this.defines=i,this.uniforms=s,this.extensions=a,this.blendMode=new Fft(r),this.blendMode.addEventListener("change",l=>this.setChanged()),this._inputColorSpace=Bv,this._outputColorSpace=v_}get inputColorSpace(){return this._inputColorSpace}set inputColorSpace(n){this._inputColorSpace=n,this.setChanged()}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(n){this._outputColorSpace=n,this.setChanged()}set mainScene(n){}set mainCamera(n){}getName(){return this.name}setRenderer(n){this.renderer=n}getDefines(){return this.defines}getUniforms(){return this.uniforms}getExtensions(){return this.extensions}getBlendMode(){return this.blendMode}getAttributes(){return this.attributes}setAttributes(n){this.attributes=n,this.setChanged()}getFragmentShader(){return this.fragmentShader}setFragmentShader(n){this.fragmentShader=n,this.setChanged()}getVertexShader(){return this.vertexShader}setVertexShader(n){this.vertexShader=n,this.setChanged()}setChanged(){this.dispatchEvent({type:"change"})}setDepthTexture(n,e=U1){}update(n,e,t){}setSize(n,e){}initialize(n,e,t){}dispose(){for(const n of Object.keys(this)){const e=this[n];(e instanceof Sf||e instanceof nh||e instanceof xc||e instanceof Ym)&&this[n].dispose()}}},n3={MEDIUM:2,LARGE:3,VERY_LARGE:4},zft=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;
#include <colorspace_fragment>
}`,jft="uniform vec4 texelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize.xy*vec2(kernel)+texelSize.zw)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",Hft=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],qft=class extends jl{constructor(n=new xa){super({name:"KawaseBlurMaterial",uniforms:{inputBuffer:new jn(null),texelSize:new jn(new xa),scale:new jn(1),kernel:new jn(0)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:zft,vertexShader:jft}),this.setTexelSize(n.x,n.y),this.kernelSize=n3.MEDIUM}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.inputBuffer=n}get kernelSequence(){return Hft[this.kernelSize]}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(){return this.uniforms.scale.value}setScale(n){this.uniforms.scale.value=n}getKernel(){return null}get kernel(){return this.uniforms.kernel.value}set kernel(n){this.uniforms.kernel.value=n}setKernel(n){this.kernel=n}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e,n*.5,e*.5)}setSize(n,e){const t=1/n,r=1/e;this.uniforms.texelSize.value.set(t,r,t*.5,r*.5)}},Z_e=class extends Ym{constructor({kernelSize:n=n3.MEDIUM,resolutionScale:e=.5,width:t=Ng.AUTO_SIZE,height:r=Ng.AUTO_SIZE,resolutionX:i=t,resolutionY:s=r}={}){super("KawaseBlurPass"),this.renderTargetA=new Sf(1,1,{depthBuffer:!1}),this.renderTargetA.texture.name="Blur.Target.A",this.renderTargetB=this.renderTargetA.clone(),this.renderTargetB.texture.name="Blur.Target.B";const a=this.resolution=new Ng(this,i,s,e);a.addEventListener("change",o=>this.setSize(a.baseWidth,a.baseHeight)),this._blurMaterial=new qft,this._blurMaterial.kernelSize=n,this.copyMaterial=new W_e}getResolution(){return this.resolution}get blurMaterial(){return this._blurMaterial}set blurMaterial(n){this._blurMaterial=n}get dithering(){return this.copyMaterial.dithering}set dithering(n){this.copyMaterial.dithering=n}get kernelSize(){return this.blurMaterial.kernelSize}set kernelSize(n){this.blurMaterial.kernelSize=n}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get scale(){return this.blurMaterial.scale}set scale(n){this.blurMaterial.scale=n}getScale(){return this.blurMaterial.scale}setScale(n){this.blurMaterial.scale=n}getKernelSize(){return this.kernelSize}setKernelSize(n){this.kernelSize=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}render(n,e,t,r,i){const s=this.scene,a=this.camera,o=this.renderTargetA,l=this.renderTargetB,c=this.blurMaterial,u=c.kernelSequence;let f=e;this.fullscreenMaterial=c;for(let d=0,g=u.length;d<g;++d){const p=(d&1)===0?o:l;c.kernel=u[d],c.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,a),f=p}this.fullscreenMaterial=this.copyMaterial,this.copyMaterial.inputBuffer=f.texture,n.setRenderTarget(this.renderToScreen?null:t),n.render(s,a)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.renderTargetA.setSize(r,i),this.renderTargetB.setSize(r,i),this.blurMaterial.setSize(n,e)}initialize(n,e,t){t!==void 0&&(this.renderTargetA.texture.type=t,this.renderTargetB.texture.type=t,t!==zl?(this.blurMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.copyMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1"):n!==null&&n.outputColorSpace===ta&&(this.renderTargetA.texture.colorSpace=ta,this.renderTargetB.texture.colorSpace=ta))}static get AUTO_SIZE(){return Ng.AUTO_SIZE}},Vft=`#include <common>
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef RANGE
uniform vec2 range;
#elif defined(THRESHOLD)
uniform float threshold;uniform float smoothing;
#endif
varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=luminance(texel.rgb);float mask=1.0;
#ifdef RANGE
float low=step(range.x,l);float high=step(l,range.y);mask=low*high;
#elif defined(THRESHOLD)
mask=smoothstep(threshold,threshold+smoothing,l);
#endif
#ifdef COLOR
gl_FragColor=texel*mask;
#else
gl_FragColor=vec4(l*mask);
#endif
}`,Gft=class extends jl{constructor(n=!1,e=null){super({name:"LuminanceMaterial",defines:{THREE_REVISION:kw.replace(/\D+/g,"")},uniforms:{inputBuffer:new jn(null),threshold:new jn(0),smoothing:new jn(1),range:new jn(null)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Vft,vertexShader:t3}),this.colorOutput=n,this.luminanceRange=e}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get threshold(){return this.uniforms.threshold.value}set threshold(n){this.smoothing>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.threshold.value=n}getThreshold(){return this.threshold}setThreshold(n){this.threshold=n}get smoothing(){return this.uniforms.smoothing.value}set smoothing(n){this.threshold>0||n>0?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.uniforms.smoothing.value=n}getSmoothingFactor(){return this.smoothing}setSmoothingFactor(n){this.smoothing=n}get useThreshold(){return this.threshold>0||this.smoothing>0}set useThreshold(n){}get colorOutput(){return this.defines.COLOR!==void 0}set colorOutput(n){n?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}isColorOutputEnabled(n){return this.colorOutput}setColorOutputEnabled(n){this.colorOutput=n}get useRange(){return this.luminanceRange!==null}set useRange(n){this.luminanceRange=null}get luminanceRange(){return this.uniforms.range.value}set luminanceRange(n){n!==null?this.defines.RANGE="1":delete this.defines.RANGE,this.uniforms.range.value=n,this.needsUpdate=!0}getLuminanceRange(){return this.luminanceRange}setLuminanceRange(n){this.luminanceRange=n}},$ft=class extends Ym{constructor({renderTarget:n,luminanceRange:e,colorOutput:t,resolutionScale:r=1,width:i=Ng.AUTO_SIZE,height:s=Ng.AUTO_SIZE,resolutionX:a=i,resolutionY:o=s}={}){super("LuminancePass"),this.fullscreenMaterial=new Gft(t,e),this.needsSwap=!1,this.renderTarget=n,this.renderTarget===void 0&&(this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="LuminancePass.Target");const l=this.resolution=new Ng(this,a,o,r);l.addEventListener("change",c=>this.setSize(l.baseWidth,l.baseHeight))}get texture(){return this.renderTarget.texture}getTexture(){return this.renderTarget.texture}getResolution(){return this.resolution}render(n,e,t,r,i){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,n.setRenderTarget(this.renderToScreen?null:this.renderTarget),n.render(this.scene,this.camera)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height)}initialize(n,e,t){t!==void 0&&t!==zl&&(this.renderTarget.texture.type=t,this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},Wft=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#define WEIGHT_INNER 0.125
#define WEIGHT_OUTER 0.0555555
varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;float clampToBorder(const in vec2 uv){return float(uv.s>=0.0&&uv.s<=1.0&&uv.t>=0.0&&uv.t<=1.0);}void main(){vec4 c=vec4(0.0);vec4 w=WEIGHT_INNER*vec4(clampToBorder(vUv00),clampToBorder(vUv01),clampToBorder(vUv02),clampToBorder(vUv03));c+=w.x*texture2D(inputBuffer,vUv00);c+=w.y*texture2D(inputBuffer,vUv01);c+=w.z*texture2D(inputBuffer,vUv02);c+=w.w*texture2D(inputBuffer,vUv03);w=WEIGHT_OUTER*vec4(clampToBorder(vUv04),clampToBorder(vUv05),clampToBorder(vUv06),clampToBorder(vUv07));c+=w.x*texture2D(inputBuffer,vUv04);c+=w.y*texture2D(inputBuffer,vUv05);c+=w.z*texture2D(inputBuffer,vUv06);c+=w.w*texture2D(inputBuffer,vUv07);w=WEIGHT_OUTER*vec4(clampToBorder(vUv08),clampToBorder(vUv09),clampToBorder(vUv10),clampToBorder(vUv11));c+=w.x*texture2D(inputBuffer,vUv08);c+=w.y*texture2D(inputBuffer,vUv09);c+=w.z*texture2D(inputBuffer,vUv10);c+=w.w*texture2D(inputBuffer,vUv11);c+=WEIGHT_OUTER*texture2D(inputBuffer,vUv);gl_FragColor=c;
#include <colorspace_fragment>
}`,Yft="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv00;varying vec2 vUv01;varying vec2 vUv02;varying vec2 vUv03;varying vec2 vUv04;varying vec2 vUv05;varying vec2 vUv06;varying vec2 vUv07;varying vec2 vUv08;varying vec2 vUv09;varying vec2 vUv10;varying vec2 vUv11;void main(){vUv=position.xy*0.5+0.5;vUv00=vUv+texelSize*vec2(-1.0,1.0);vUv01=vUv+texelSize*vec2(1.0,1.0);vUv02=vUv+texelSize*vec2(-1.0,-1.0);vUv03=vUv+texelSize*vec2(1.0,-1.0);vUv04=vUv+texelSize*vec2(-2.0,2.0);vUv05=vUv+texelSize*vec2(0.0,2.0);vUv06=vUv+texelSize*vec2(2.0,2.0);vUv07=vUv+texelSize*vec2(-2.0,0.0);vUv08=vUv+texelSize*vec2(2.0,0.0);vUv09=vUv+texelSize*vec2(-2.0,-2.0);vUv10=vUv+texelSize*vec2(0.0,-2.0);vUv11=vUv+texelSize*vec2(2.0,-2.0);gl_Position=vec4(position.xy,1.0,1.0);}",Xft=class extends jl{constructor(){super({name:"DownsamplingMaterial",uniforms:{inputBuffer:new jn(null),texelSize:new jn(new an)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Wft,vertexShader:Yft})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Kft=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;uniform mediump sampler2D supportBuffer;
#else
uniform lowp sampler2D inputBuffer;uniform lowp sampler2D supportBuffer;
#endif
uniform float radius;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vec4 c=vec4(0.0);c+=texture2D(inputBuffer,vUv0)*0.0625;c+=texture2D(inputBuffer,vUv1)*0.125;c+=texture2D(inputBuffer,vUv2)*0.0625;c+=texture2D(inputBuffer,vUv3)*0.125;c+=texture2D(inputBuffer,vUv)*0.25;c+=texture2D(inputBuffer,vUv4)*0.125;c+=texture2D(inputBuffer,vUv5)*0.0625;c+=texture2D(inputBuffer,vUv6)*0.125;c+=texture2D(inputBuffer,vUv7)*0.0625;vec4 baseColor=texture2D(supportBuffer,vUv);gl_FragColor=mix(baseColor,c,radius);
#include <colorspace_fragment>
}`,Zft="uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;varying vec2 vUv6;varying vec2 vUv7;void main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,1.0);vUv1=vUv+texelSize*vec2(0.0,1.0);vUv2=vUv+texelSize*vec2(1.0,1.0);vUv3=vUv+texelSize*vec2(-1.0,0.0);vUv4=vUv+texelSize*vec2(1.0,0.0);vUv5=vUv+texelSize*vec2(-1.0,-1.0);vUv6=vUv+texelSize*vec2(0.0,-1.0);vUv7=vUv+texelSize*vec2(1.0,-1.0);gl_Position=vec4(position.xy,1.0,1.0);}",Qft=class extends jl{constructor(){super({name:"UpsamplingMaterial",uniforms:{inputBuffer:new jn(null),supportBuffer:new jn(null),texelSize:new jn(new an),radius:new jn(.85)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:Kft,vertexShader:Zft})}set inputBuffer(n){this.uniforms.inputBuffer.value=n}set supportBuffer(n){this.uniforms.supportBuffer.value=n}get radius(){return this.uniforms.radius.value}set radius(n){this.uniforms.radius.value=n}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}},Jft=class extends Ym{constructor(){super("MipmapBlurPass"),this.needsSwap=!1,this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Upsampling.Mipmap0",this.downsamplingMipmaps=[],this.upsamplingMipmaps=[],this.downsamplingMaterial=new Xft,this.upsamplingMaterial=new Qft,this.resolution=new an}get texture(){return this.renderTarget.texture}get levels(){return this.downsamplingMipmaps.length}set levels(n){if(this.levels!==n){const e=this.renderTarget;this.dispose(),this.downsamplingMipmaps=[],this.upsamplingMipmaps=[];for(let t=0;t<n;++t){const r=e.clone();r.texture.name="Downsampling.Mipmap"+t,this.downsamplingMipmaps.push(r)}this.upsamplingMipmaps.push(e);for(let t=1,r=n-1;t<r;++t){const i=e.clone();i.texture.name="Upsampling.Mipmap"+t,this.upsamplingMipmaps.push(i)}this.setSize(this.resolution.x,this.resolution.y)}}get radius(){return this.upsamplingMaterial.radius}set radius(n){this.upsamplingMaterial.radius=n}render(n,e,t,r,i){const{scene:s,camera:a}=this,{downsamplingMaterial:o,upsamplingMaterial:l}=this,{downsamplingMipmaps:c,upsamplingMipmaps:u}=this;let f=e;this.fullscreenMaterial=o;for(let d=0,g=c.length;d<g;++d){const p=c[d];o.setSize(f.width,f.height),o.inputBuffer=f.texture,n.setRenderTarget(p),n.render(s,a),f=p}this.fullscreenMaterial=l;for(let d=u.length-1;d>=0;--d){const g=u[d];l.setSize(f.width,f.height),l.inputBuffer=f.texture,l.supportBuffer=c[d].texture,n.setRenderTarget(g),n.render(s,a),f=g}}setSize(n,e){const t=this.resolution;t.set(n,e);let r=t.width,i=t.height;for(let s=0,a=this.downsamplingMipmaps.length;s<a;++s)r=Math.round(r*.5),i=Math.round(i*.5),this.downsamplingMipmaps[s].setSize(r,i),s<this.upsamplingMipmaps.length&&this.upsamplingMipmaps[s].setSize(r,i)}initialize(n,e,t){if(t!==void 0){const r=this.downsamplingMipmaps.concat(this.upsamplingMipmaps);for(const i of r)i.texture.type=t;if(t!==zl)this.downsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1",this.upsamplingMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1";else if(n!==null&&n.outputColorSpace===ta)for(const i of r)i.texture.colorSpace=ta}}dispose(){super.dispose();for(const n of this.downsamplingMipmaps.concat(this.upsamplingMipmaps))n.dispose()}},eht=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D map;
#else
uniform lowp sampler2D map;
#endif
uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 texel=texture2D(map,uv);outputColor=vec4(texel.rgb*intensity,max(inputColor.a,texel.a));}`,tht=class extends L_{constructor({blendFunction:n=Es.SCREEN,luminanceThreshold:e=1,luminanceSmoothing:t=.03,mipmapBlur:r=!0,intensity:i=1,radius:s=.85,levels:a=8,kernelSize:o=n3.LARGE,resolutionScale:l=.5,width:c=Ng.AUTO_SIZE,height:u=Ng.AUTO_SIZE,resolutionX:f=c,resolutionY:d=u}={}){super("BloomEffect",eht,{blendFunction:n,uniforms:new Map([["map",new jn(null)],["intensity",new jn(i)]])}),this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="Bloom.Target",this.blurPass=new Z_e({kernelSize:o}),this.luminancePass=new $ft({colorOutput:!0}),this.luminanceMaterial.threshold=e,this.luminanceMaterial.smoothing=t,this.mipmapBlurPass=new Jft,this.mipmapBlurPass.enabled=r,this.mipmapBlurPass.radius=s,this.mipmapBlurPass.levels=a,this.uniforms.get("map").value=r?this.mipmapBlurPass.texture:this.renderTarget.texture;const g=this.resolution=new Ng(this,f,d,l);g.addEventListener("change",p=>this.setSize(g.baseWidth,g.baseHeight))}get texture(){return this.mipmapBlurPass.enabled?this.mipmapBlurPass.texture:this.renderTarget.texture}getTexture(){return this.texture}getResolution(){return this.resolution}getBlurPass(){return this.blurPass}getLuminancePass(){return this.luminancePass}get luminanceMaterial(){return this.luminancePass.fullscreenMaterial}getLuminanceMaterial(){return this.luminancePass.fullscreenMaterial}get width(){return this.resolution.width}set width(n){this.resolution.preferredWidth=n}get height(){return this.resolution.height}set height(n){this.resolution.preferredHeight=n}get dithering(){return this.blurPass.dithering}set dithering(n){this.blurPass.dithering=n}get kernelSize(){return this.blurPass.kernelSize}set kernelSize(n){this.blurPass.kernelSize=n}get distinction(){return console.warn(this.name,"distinction was removed"),1}set distinction(n){console.warn(this.name,"distinction was removed")}get intensity(){return this.uniforms.get("intensity").value}set intensity(n){this.uniforms.get("intensity").value=n}getIntensity(){return this.intensity}setIntensity(n){this.intensity=n}getResolutionScale(){return this.resolution.scale}setResolutionScale(n){this.resolution.scale=n}update(n,e,t){const r=this.renderTarget,i=this.luminancePass;i.enabled?(i.render(n,e),this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,i.renderTarget):this.blurPass.render(n,i.renderTarget,r)):this.mipmapBlurPass.enabled?this.mipmapBlurPass.render(n,e):this.blurPass.render(n,e,r)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e),this.renderTarget.setSize(t.width,t.height),this.blurPass.resolution.copy(t),this.luminancePass.setSize(n,e),this.mipmapBlurPass.setSize(n,e)}initialize(n,e,t){this.blurPass.initialize(n,e,t),this.luminancePass.initialize(n,e,t),this.mipmapBlurPass.initialize(n,e,t),t!==void 0&&(this.renderTarget.texture.type=t,n!==null&&n.outputColorSpace===ta&&(this.renderTarget.texture.colorSpace=ta))}},ET={RED:0,GREEN:1,BLUE:2,ALPHA:3},AV={DISCARD:0,MULTIPLY_RGB_SET_ALPHA:2,MULTIPLY_RGB:3},nht=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if PASS == 1
uniform vec4 kernel64[32];
#else
uniform vec4 kernel16[8];
#endif
uniform lowp sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;varying vec2 vUv;void main(){
#ifdef FOREGROUND
vec2 cocNearFar=texture2D(cocBuffer,vUv).rg*scale;float coc=cocNearFar.x;
#else
float coc=texture2D(cocBuffer,vUv).g*scale;
#endif
if(coc==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{
#ifdef FOREGROUND
vec2 step=texelSize*max(cocNearFar.x,cocNearFar.y);
#else
vec2 step=texelSize*coc;
#endif
#if PASS == 1
vec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;
#else
vec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;
#endif
}}`,gN=class extends jl{constructor(n=!1,e=!1){super({name:"BokehMaterial",defines:{PASS:n?"2":"1"},uniforms:{inputBuffer:new jn(null),cocBuffer:new jn(null),texelSize:new jn(new an),kernel64:new jn(null),kernel16:new jn(null),scale:new jn(1)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:nht,vertexShader:t3}),e&&(this.defines.FOREGROUND="1"),this.generateKernel()}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set cocBuffer(n){this.uniforms.cocBuffer.value=n}setCoCBuffer(n){this.uniforms.cocBuffer.value=n}get scale(){return this.uniforms.scale.value}set scale(n){this.uniforms.scale.value=n}getScale(n){return this.scale}setScale(n){this.scale=n}generateKernel(){const n=2.39996323,e=new Float64Array(128),t=new Float64Array(32);let r=0,i=0;for(let s=0,a=Math.sqrt(80);s<80;++s){const o=s*n,l=Math.sqrt(s)/a,c=l*Math.cos(o),u=l*Math.sin(o);s%5===0?(t[i++]=c,t[i++]=u):(e[r++]=c,e[r++]=u)}this.uniforms.kernel64.value=e,this.uniforms.kernel16.value=t}setTexelSize(n,e){this.uniforms.texelSize.value.set(n,e)}setSize(n,e){this.uniforms.texelSize.value.set(1/n,1/e)}};function Jre(n,e,t){return n*(e-t)-e}function Y9(n,e,t){return Math.min(Math.max((n+e)/(e-t),0),1)}var rht=`#include <common>
#include <packing>
#ifdef GL_FRAGMENT_PRECISION_HIGH
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform float focusDistance;uniform float focusRange;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
float depth=unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
float depth=texture2D(depthBuffer,uv).r;
#endif
#ifdef LOG_DEPTH
float d=pow(2.0,depth*log2(cameraFar+1.0))-1.0;float a=cameraFar/(cameraFar-cameraNear);float b=cameraFar*cameraNear/(cameraNear-cameraFar);depth=a+b/d;
#endif
return depth;}void main(){float depth=readDepth(vUv);
#ifdef PERSPECTIVE_CAMERA
float viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);
#else
float linearDepth=depth;
#endif
float signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focusRange,abs(signedDistance));gl_FragColor.rg=magnitude*vec2(step(signedDistance,0.0),step(0.0,signedDistance));}`,iht=class extends jl{constructor(n){super({name:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new jn(null),focusDistance:new jn(0),focusRange:new jn(0),cameraNear:new jn(.3),cameraFar:new jn(1e3)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:rht,vertexShader:t3}),this.uniforms.focalLength=this.uniforms.focusRange,this.copyCameraSettings(n)}get near(){return this.uniforms.cameraNear.value}get far(){return this.uniforms.cameraFar.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=U1){this.depthBuffer=n,this.depthPacking=e}get focusDistance(){return this.uniforms.focusDistance.value}set focusDistance(n){this.uniforms.focusDistance.value=n}get worldFocusDistance(){return-Jre(this.focusDistance,this.near,this.far)}set worldFocusDistance(n){this.focusDistance=Y9(-n,this.near,this.far)}getFocusDistance(n){this.uniforms.focusDistance.value=n}setFocusDistance(n){this.uniforms.focusDistance.value=n}get focalLength(){return this.focusRange}set focalLength(n){this.focusRange=n}get focusRange(){return this.uniforms.focusRange.value}set focusRange(n){this.uniforms.focusRange.value=n}get worldFocusRange(){return-Jre(this.focusRange,this.near,this.far)}set worldFocusRange(n){this.focusRange=Y9(-n,this.near,this.far)}getFocalLength(n){return this.focusRange}setFocalLength(n){this.focusRange=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof vf?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},sht=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#ifdef MASK_PRECISION_HIGH
uniform mediump sampler2D maskTexture;
#else
uniform lowp sampler2D maskTexture;
#endif
#if MASK_FUNCTION != 0
uniform float strength;
#endif
varying vec2 vUv;void main(){
#if COLOR_CHANNEL == 0
float mask=texture2D(maskTexture,vUv).r;
#elif COLOR_CHANNEL == 1
float mask=texture2D(maskTexture,vUv).g;
#elif COLOR_CHANNEL == 2
float mask=texture2D(maskTexture,vUv).b;
#else
float mask=texture2D(maskTexture,vUv).a;
#endif
#if MASK_FUNCTION == 0
#ifdef INVERTED
mask=step(mask,0.0);
#else
mask=1.0-step(mask,0.0);
#endif
#else
mask=clamp(mask*strength,0.0,1.0);
#ifdef INVERTED
mask=1.0-mask;
#endif
#endif
#if MASK_FUNCTION == 3
vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=vec4(mask*texel.rgb,texel.a);
#elif MASK_FUNCTION == 2
gl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);
#else
gl_FragColor=mask*texture2D(inputBuffer,vUv);
#endif
}`,aht=class extends jl{constructor(n=null){super({name:"MaskMaterial",uniforms:{maskTexture:new jn(n),inputBuffer:new jn(null),strength:new jn(1)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,fragmentShader:sht,vertexShader:t3}),this.colorChannel=ET.RED,this.maskFunction=AV.DISCARD}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}set maskTexture(n){this.uniforms.maskTexture.value=n,delete this.defines.MASK_PRECISION_HIGH,n.type!==zl&&(this.defines.MASK_PRECISION_HIGH="1"),this.needsUpdate=!0}setMaskTexture(n){this.maskTexture=n}set colorChannel(n){this.defines.COLOR_CHANNEL=n.toFixed(0),this.needsUpdate=!0}setColorChannel(n){this.colorChannel=n}set maskFunction(n){this.defines.MASK_FUNCTION=n.toFixed(0),this.needsUpdate=!0}setMaskFunction(n){this.maskFunction=n}get inverted(){return this.defines.INVERTED!==void 0}set inverted(n){this.inverted&&!n?delete this.defines.INVERTED:n&&(this.defines.INVERTED="1"),this.needsUpdate=!0}isInverted(){return this.inverted}setInverted(n){this.inverted=n}get strength(){return this.uniforms.strength.value}set strength(n){this.uniforms.strength.value=n}getStrength(){return this.strength}setStrength(n){this.strength=n}},Qx=class extends Ym{constructor(n,e="inputBuffer"){super("ShaderPass"),this.fullscreenMaterial=n,this.input=e}setInput(n){this.input=n}render(n,e,t,r,i){const s=this.fullscreenMaterial.uniforms;e!==null&&s!==void 0&&s[this.input]!==void 0&&(s[this.input].value=e.texture),n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}initialize(n,e,t){t!==void 0&&t!==zl&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}},oht=`#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D nearColorBuffer;uniform mediump sampler2D farColorBuffer;
#else
uniform lowp sampler2D nearColorBuffer;uniform lowp sampler2D farColorBuffer;
#endif
uniform lowp sampler2D nearCoCBuffer;uniform lowp sampler2D farCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);
#if MASK_FUNCTION == 1
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,colorFar.a);cocNearFar.x=min(cocNearFar.x*scale,1.0);
#else
vec2 cocNearFar=vec2(texture2D(nearCoCBuffer,uv).r,texture2D(farCoCBuffer,uv).g);cocNearFar=min(cocNearFar*scale,1.0);
#endif
vec4 result=inputColor*(1.0-cocNearFar.y)+colorFar;result=mix(result,colorNear,cocNearFar.x);outputColor=result;}`,lht=class extends L_{constructor(n,{blendFunction:e,worldFocusDistance:t,worldFocusRange:r,focusDistance:i=0,focalLength:s=.1,focusRange:a=s,bokehScale:o=1,resolutionScale:l=1,width:c=Ng.AUTO_SIZE,height:u=Ng.AUTO_SIZE,resolutionX:f=c,resolutionY:d=u}={}){super("DepthOfFieldEffect",oht,{blendFunction:e,attributes:Lm.DEPTH,uniforms:new Map([["nearColorBuffer",new jn(null)],["farColorBuffer",new jn(null)],["nearCoCBuffer",new jn(null)],["farCoCBuffer",new jn(null)],["scale",new jn(1)]])}),this.camera=n,this.renderTarget=new Sf(1,1,{depthBuffer:!1}),this.renderTarget.texture.name="DoF.Intermediate",this.renderTargetMasked=this.renderTarget.clone(),this.renderTargetMasked.texture.name="DoF.Masked.Far",this.renderTargetNear=this.renderTarget.clone(),this.renderTargetNear.texture.name="DoF.Bokeh.Near",this.uniforms.get("nearColorBuffer").value=this.renderTargetNear.texture,this.renderTargetFar=this.renderTarget.clone(),this.renderTargetFar.texture.name="DoF.Bokeh.Far",this.uniforms.get("farColorBuffer").value=this.renderTargetFar.texture,this.renderTargetCoC=this.renderTarget.clone(),this.renderTargetCoC.texture.name="DoF.CoC",this.uniforms.get("farCoCBuffer").value=this.renderTargetCoC.texture,this.renderTargetCoCBlurred=this.renderTargetCoC.clone(),this.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",this.uniforms.get("nearCoCBuffer").value=this.renderTargetCoCBlurred.texture,this.cocPass=new Qx(new iht(n));const g=this.cocMaterial;g.focusDistance=i,g.focusRange=a,t!==void 0&&(g.worldFocusDistance=t),r!==void 0&&(g.worldFocusRange=r),this.blurPass=new Z_e({resolutionScale:l,resolutionX:f,resolutionY:d,kernelSize:n3.MEDIUM}),this.maskPass=new Qx(new aht(this.renderTargetCoC.texture));const p=this.maskPass.fullscreenMaterial;p.colorChannel=ET.GREEN,this.maskFunction=AV.MULTIPLY_RGB,this.bokehNearBasePass=new Qx(new gN(!1,!0)),this.bokehNearBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehNearFillPass=new Qx(new gN(!0,!0)),this.bokehNearFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoCBlurred.texture,this.bokehFarBasePass=new Qx(new gN(!1,!1)),this.bokehFarBasePass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.bokehFarFillPass=new Qx(new gN(!0,!1)),this.bokehFarFillPass.fullscreenMaterial.cocBuffer=this.renderTargetCoC.texture,this.target=null;const _=this.resolution=new Ng(this,f,d,l);_.addEventListener("change",y=>this.setSize(_.baseWidth,_.baseHeight)),this.bokehScale=o}set mainCamera(n){this.camera=n,this.cocMaterial.copyCameraSettings(n)}get cocTexture(){return this.renderTargetCoC.texture}get maskFunction(){return this.maskPass.fullscreenMaterial.maskFunction}set maskFunction(n){this.maskFunction!==n&&(this.defines.set("MASK_FUNCTION",n.toFixed(0)),this.maskPass.fullscreenMaterial.maskFunction=n,this.setChanged())}get cocMaterial(){return this.cocPass.fullscreenMaterial}get circleOfConfusionMaterial(){return this.cocMaterial}getCircleOfConfusionMaterial(){return this.cocMaterial}getBlurPass(){return this.blurPass}getResolution(){return this.resolution}get bokehScale(){return this.uniforms.get("scale").value}set bokehScale(n){this.bokehNearBasePass.fullscreenMaterial.scale=n,this.bokehNearFillPass.fullscreenMaterial.scale=n,this.bokehFarBasePass.fullscreenMaterial.scale=n,this.bokehFarFillPass.fullscreenMaterial.scale=n,this.maskPass.fullscreenMaterial.strength=n,this.uniforms.get("scale").value=n}getBokehScale(){return this.bokehScale}setBokehScale(n){this.bokehScale=n}getTarget(){return this.target}setTarget(n){this.target=n}calculateFocusDistance(n){const e=this.camera,t=e.position.distanceTo(n);return Y9(-t,e.near,e.far)}setDepthTexture(n,e=U1){this.cocMaterial.depthBuffer=n,this.cocMaterial.depthPacking=e}update(n,e,t){const r=this.renderTarget,i=this.renderTargetCoC,s=this.renderTargetCoCBlurred,a=this.renderTargetMasked;if(this.target!==null){const o=this.calculateFocusDistance(this.target);this.cocMaterial.focusDistance=o}this.cocPass.render(n,null,i),this.blurPass.render(n,i,s),this.maskPass.render(n,e,a),this.bokehFarBasePass.render(n,a,r),this.bokehFarFillPass.render(n,r,this.renderTargetFar),this.bokehNearBasePass.render(n,e,r),this.bokehNearFillPass.render(n,r,this.renderTargetNear)}setSize(n,e){const t=this.resolution;t.setBaseSize(n,e);const r=t.width,i=t.height;this.cocPass.setSize(n,e),this.blurPass.setSize(n,e),this.maskPass.setSize(n,e),this.renderTargetFar.setSize(n,e),this.renderTargetCoC.setSize(n,e),this.renderTargetMasked.setSize(n,e),this.renderTarget.setSize(r,i),this.renderTargetNear.setSize(r,i),this.renderTargetCoCBlurred.setSize(r,i),this.bokehNearBasePass.fullscreenMaterial.setSize(n,e),this.bokehNearFillPass.fullscreenMaterial.setSize(n,e),this.bokehFarBasePass.fullscreenMaterial.setSize(n,e),this.bokehFarFillPass.fullscreenMaterial.setSize(n,e)}initialize(n,e,t){this.cocPass.initialize(n,e,t),this.maskPass.initialize(n,e,t),this.bokehNearBasePass.initialize(n,e,t),this.bokehNearFillPass.initialize(n,e,t),this.bokehFarBasePass.initialize(n,e,t),this.bokehFarFillPass.initialize(n,e,t),this.blurPass.initialize(n,e,zl),n.capabilities.logarithmicDepthBuffer&&(this.cocPass.fullscreenMaterial.defines.LOG_DEPTH="1"),t!==void 0&&(this.renderTarget.texture.type=t,this.renderTargetNear.texture.type=t,this.renderTargetFar.texture.type=t,this.renderTargetMasked.texture.type=t,n!==null&&n.outputColorSpace===ta&&(this.renderTarget.texture.colorSpace=ta,this.renderTargetNear.texture.colorSpace=ta,this.renderTargetFar.texture.colorSpace=ta,this.renderTargetMasked.texture.colorSpace=ta))}},l1={DISABLED:0,SPORADIC:1,CONSTANT_MILD:2,CONSTANT_WILD:3};function cht(n,e,t){const r=new Map([[Iw,1],[JL,2],[Xf,4]]);let i;if(r.has(e)||console.error("Invalid noise texture format"),t===zl){i=new Uint8Array(n*r.get(e));for(let s=0,a=i.length;s<a;++s)i[s]=Math.random()*255+.5}else{i=new Float32Array(n*r.get(e));for(let s=0,a=i.length;s<a;++s)i[s]=Math.random()}return i}var eie=class extends Lg{constructor(n,e,t=Iw,r=zl){super(cht(n*e,t,r),n,e,t,r),this.needsUpdate=!0}},uht="uniform lowp sampler2D perturbationMap;uniform bool active;uniform float columns;uniform float random;uniform vec2 seeds;uniform vec2 distortion;void mainUv(inout vec2 uv){if(active){if(uv.y<distortion.x+columns&&uv.y>distortion.x-columns*random){float sx=clamp(ceil(seeds.x),0.0,1.0);uv.y=sx*(1.0-(uv.y+distortion.y))+(1.0-sx)*distortion.y;}if(uv.x<distortion.y+columns&&uv.x>distortion.y-columns*random){float sy=clamp(ceil(seeds.y),0.0,1.0);uv.x=sy*distortion.x+(1.0-sy)*(1.0-(uv.x+distortion.x));}vec2 normal=texture2D(perturbationMap,uv*random*random).rg;uv+=normal*seeds*(random*0.2);}}",_N="Glitch.Generated";function _m(n,e){return n+Math.random()*(e-n)}var fht=class extends L_{constructor({chromaticAberrationOffset:n=null,delay:e=new an(1.5,3.5),duration:t=new an(.6,1),strength:r=new an(.3,1),columns:i=.05,ratio:s=.85,perturbationMap:a=null,dtSize:o=64}={}){if(super("GlitchEffect",uht,{uniforms:new Map([["perturbationMap",new jn(null)],["columns",new jn(i)],["active",new jn(!1)],["random",new jn(1)],["seeds",new jn(new an)],["distortion",new jn(new an)]])}),a===null){const l=new eie(o,o,Xf);l.name=_N,this.perturbationMap=l}else this.perturbationMap=a;this.time=0,this.distortion=this.uniforms.get("distortion").value,this.delay=e,this.duration=t,this.breakPoint=new an(_m(this.delay.x,this.delay.y),_m(this.duration.x,this.duration.y)),this.strength=r,this.mode=l1.SPORADIC,this.ratio=s,this.chromaticAberrationOffset=n}get seeds(){return this.uniforms.get("seeds").value}get active(){return this.uniforms.get("active").value}isActive(){return this.active}get minDelay(){return this.delay.x}set minDelay(n){this.delay.x=n}getMinDelay(){return this.delay.x}setMinDelay(n){this.delay.x=n}get maxDelay(){return this.delay.y}set maxDelay(n){this.delay.y=n}getMaxDelay(){return this.delay.y}setMaxDelay(n){this.delay.y=n}get minDuration(){return this.duration.x}set minDuration(n){this.duration.x=n}getMinDuration(){return this.duration.x}setMinDuration(n){this.duration.x=n}get maxDuration(){return this.duration.y}set maxDuration(n){this.duration.y=n}getMaxDuration(){return this.duration.y}setMaxDuration(n){this.duration.y=n}get minStrength(){return this.strength.x}set minStrength(n){this.strength.x=n}getMinStrength(){return this.strength.x}setMinStrength(n){this.strength.x=n}get maxStrength(){return this.strength.y}set maxStrength(n){this.strength.y=n}getMaxStrength(){return this.strength.y}setMaxStrength(n){this.strength.y=n}getMode(){return this.mode}setMode(n){this.mode=n}getGlitchRatio(){return 1-this.ratio}setGlitchRatio(n){this.ratio=Math.min(Math.max(1-n,0),1)}get columns(){return this.uniforms.get("columns").value}set columns(n){this.uniforms.get("columns").value=n}getGlitchColumns(){return this.columns}setGlitchColumns(n){this.columns=n}getChromaticAberrationOffset(){return this.chromaticAberrationOffset}setChromaticAberrationOffset(n){this.chromaticAberrationOffset=n}get perturbationMap(){return this.uniforms.get("perturbationMap").value}set perturbationMap(n){const e=this.perturbationMap;e!==null&&e.name===_N&&e.dispose(),n.minFilter=n.magFilter=bf,n.wrapS=n.wrapT=BT,n.generateMipmaps=!1,this.uniforms.get("perturbationMap").value=n}getPerturbationMap(){return this.perturbationMap}setPerturbationMap(n){this.perturbationMap=n}generatePerturbationMap(n=64){const e=new eie(n,n,Xf);return e.name=_N,e}update(n,e,t){const r=this.mode,i=this.breakPoint,s=this.chromaticAberrationOffset,a=this.strength;let o=this.time,l=!1,c=0,u=0,f;r!==l1.DISABLED&&(r===l1.SPORADIC&&(o+=t,f=o>i.x,o>=i.x+i.y&&(i.set(_m(this.delay.x,this.delay.y),_m(this.duration.x,this.duration.y)),o=0)),c=Math.random(),this.uniforms.get("random").value=c,f&&c>this.ratio||r===l1.CONSTANT_WILD?(l=!0,c*=a.y*.03,u=_m(-Math.PI,Math.PI),this.seeds.set(_m(-a.y,a.y),_m(-a.y,a.y)),this.distortion.set(_m(0,1),_m(0,1))):(f||r===l1.CONSTANT_MILD)&&(l=!0,c*=a.x*.03,u=_m(-Math.PI,Math.PI),this.seeds.set(_m(-a.x,a.x),_m(-a.x,a.x)),this.distortion.set(_m(0,1),_m(0,1))),this.time=o),s!==null&&(l?s.set(Math.cos(u),Math.sin(u)).multiplyScalar(c):s.set(0,0)),this.uniforms.get("active").value=l}dispose(){const n=this.perturbationMap;n!==null&&n.name===_N&&n.dispose()}},Q_e=class extends Ym{constructor(n,e,t=null){super("RenderPass",n,e),this.needsSwap=!1,this.clearPass=new X_e,this.overrideMaterialManager=t===null?null:new Qre(t),this.ignoreBackground=!1,this.skipShadowMapUpdate=!1,this.selection=null}set mainScene(n){this.scene=n}set mainCamera(n){this.camera=n}get renderToScreen(){return super.renderToScreen}set renderToScreen(n){super.renderToScreen=n,this.clearPass.renderToScreen=n}get overrideMaterial(){const n=this.overrideMaterialManager;return n!==null?n.material:null}set overrideMaterial(n){const e=this.overrideMaterialManager;n!==null?e!==null?e.setMaterial(n):this.overrideMaterialManager=new Qre(n):e!==null&&(e.dispose(),this.overrideMaterialManager=null)}getOverrideMaterial(){return this.overrideMaterial}setOverrideMaterial(n){this.overrideMaterial=n}get clear(){return this.clearPass.enabled}set clear(n){this.clearPass.enabled=n}getSelection(){return this.selection}setSelection(n){this.selection=n}isBackgroundDisabled(){return this.ignoreBackground}setBackgroundDisabled(n){this.ignoreBackground=n}isShadowMapDisabled(){return this.skipShadowMapUpdate}setShadowMapDisabled(n){this.skipShadowMapUpdate=n}getClearPass(){return this.clearPass}render(n,e,t,r,i){const s=this.scene,a=this.camera,o=this.selection,l=a.layers.mask,c=s.background,u=n.shadowMap.autoUpdate,f=this.renderToScreen?null:e;o!==null&&a.layers.set(o.getLayer()),this.skipShadowMapUpdate&&(n.shadowMap.autoUpdate=!1),(this.ignoreBackground||this.clearPass.overrideClearColor!==null)&&(s.background=null),this.clearPass.enabled&&this.clearPass.render(n,e),n.setRenderTarget(f),this.overrideMaterialManager!==null?this.overrideMaterialManager.render(n,s,a):n.render(s,a),a.layers.mask=l,s.background=c,n.shadowMap.autoUpdate=u}},oT={DEFAULT:0,ESKIL:1},hht=`void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*(1.0+time)));
#ifdef PREMULTIPLY
outputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);
#else
outputColor=vec4(noise,inputColor.a);
#endif
}`,dht=class extends L_{constructor({blendFunction:n=Es.SCREEN,premultiply:e=!1}={}){super("NoiseEffect",hht,{blendFunction:n}),this.premultiply=e}get premultiply(){return this.defines.has("PREMULTIPLY")}set premultiply(n){this.premultiply!==n&&(n?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}isPremultiplied(){return this.premultiply}setPremultiplied(n){this.premultiply=n}},pht=`uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;
#if VIGNETTE_TECHNIQUE == 0
float d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));
#else
vec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));
#endif
outputColor=vec4(color,inputColor.a);}`,mht=class extends L_{constructor({blendFunction:n,eskil:e=!1,technique:t=e?oT.ESKIL:oT.DEFAULT,offset:r=.5,darkness:i=.5}={}){super("VignetteEffect",pht,{blendFunction:n,defines:new Map([["VIGNETTE_TECHNIQUE",t.toFixed(0)]]),uniforms:new Map([["offset",new jn(r)],["darkness",new jn(i)]])})}get technique(){return Number(this.defines.get("VIGNETTE_TECHNIQUE"))}set technique(n){this.technique!==n&&(this.defines.set("VIGNETTE_TECHNIQUE",n.toFixed(0)),this.setChanged())}get eskil(){return this.technique===oT.ESKIL}set eskil(n){this.technique=n?oT.ESKIL:oT.DEFAULT}getTechnique(){return this.technique}setTechnique(n){this.technique=n}get offset(){return this.uniforms.get("offset").value}set offset(n){this.uniforms.get("offset").value=n}getOffset(){return this.offset}setOffset(n){this.offset=n}get darkness(){return this.uniforms.get("darkness").value}set darkness(n){this.uniforms.get("darkness").value=n}getDarkness(){return this.darkness}setDarkness(n){this.darkness=n}},ght=`#include <common>
#include <packing>
#include <dithering_pars_fragment>
#define packFloatToRGBA(v) packDepthToRGBA(v)
#define unpackRGBAToFloat(v) unpackRGBAToDepth(v)
#ifdef FRAMEBUFFER_PRECISION_HIGH
uniform mediump sampler2D inputBuffer;
#else
uniform lowp sampler2D inputBuffer;
#endif
#if DEPTH_PACKING == 3201
uniform lowp sampler2D depthBuffer;
#elif defined(GL_FRAGMENT_PRECISION_HIGH)
uniform highp sampler2D depthBuffer;
#else
uniform mediump sampler2D depthBuffer;
#endif
uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;vec4 sRGBToLinear(const in vec4 value){return vec4(mix(pow(value.rgb*0.9478672986+vec3(0.0521327014),vec3(2.4)),value.rgb*0.0773993808,vec3(lessThanEqual(value.rgb,vec3(0.04045)))),value.a);}float readDepth(const in vec2 uv){
#if DEPTH_PACKING == 3201
return unpackRGBAToDepth(texture2D(depthBuffer,uv));
#else
return texture2D(depthBuffer,uv).r;
#endif
}float getViewZ(const in float depth){
#ifdef PERSPECTIVE_CAMERA
return perspectiveDepthToViewZ(depth,cameraNear,cameraFar);
#else
return orthographicDepthToViewZ(depth,cameraNear,cameraFar);
#endif
}vec3 RGBToHCV(const in vec3 RGB){vec4 P=mix(vec4(RGB.bg,-1.0,2.0/3.0),vec4(RGB.gb,0.0,-1.0/3.0),step(RGB.b,RGB.g));vec4 Q=mix(vec4(P.xyw,RGB.r),vec4(RGB.r,P.yzx),step(P.x,RGB.r));float C=Q.x-min(Q.w,Q.y);float H=abs((Q.w-Q.y)/(6.0*C+EPSILON)+Q.z);return vec3(H,C,Q.x);}vec3 RGBToHSL(const in vec3 RGB){vec3 HCV=RGBToHCV(RGB);float L=HCV.z-HCV.y*0.5;float S=HCV.y/(1.0-abs(L*2.0-1.0)+EPSILON);return vec3(HCV.x,S,L);}vec3 HueToRGB(const in float H){float R=abs(H*6.0-3.0)-1.0;float G=2.0-abs(H*6.0-2.0);float B=2.0-abs(H*6.0-4.0);return clamp(vec3(R,G,B),0.0,1.0);}vec3 HSLToRGB(const in vec3 HSL){vec3 RGB=HueToRGB(HSL.x);float C=(1.0-abs(2.0*HSL.z-1.0))*HSL.y;return(RGB-0.5)*C+HSL.z;}FRAGMENT_HEAD void main(){FRAGMENT_MAIN_UV vec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGE color0.a=clamp(color0.a,0.0,1.0);gl_FragColor=color0;
#ifdef ENCODE_OUTPUT
#include <colorspace_fragment>
#endif
#include <dithering_fragment>
}`,_ht="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEAD void main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORT gl_Position=vec4(position.xy,1.0,1.0);}",vht=class extends jl{constructor(n,e,t,r,i=!1){super({name:"EffectMaterial",defines:{THREE_REVISION:kw.replace(/\D+/g,""),DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new jn(null),depthBuffer:new jn(null),resolution:new jn(new an),texelSize:new jn(new an),cameraNear:new jn(.3),cameraFar:new jn(1e3),aspect:new jn(1),time:new jn(0)},blending:Nh,toneMapped:!1,depthWrite:!1,depthTest:!1,dithering:i}),n&&this.setShaderParts(n),e&&this.setDefines(e),t&&this.setUniforms(t),this.copyCameraSettings(r)}set inputBuffer(n){this.uniforms.inputBuffer.value=n}setInputBuffer(n){this.uniforms.inputBuffer.value=n}get depthBuffer(){return this.uniforms.depthBuffer.value}set depthBuffer(n){this.uniforms.depthBuffer.value=n}get depthPacking(){return Number(this.defines.DEPTH_PACKING)}set depthPacking(n){this.defines.DEPTH_PACKING=n.toFixed(0),this.needsUpdate=!0}setDepthBuffer(n,e=U1){this.depthBuffer=n,this.depthPacking=e}setShaderData(n){this.setShaderParts(n.shaderParts),this.setDefines(n.defines),this.setUniforms(n.uniforms),this.setExtensions(n.extensions)}setShaderParts(n){return this.fragmentShader=ght.replace(Ka.FRAGMENT_HEAD,n.get(Ka.FRAGMENT_HEAD)||"").replace(Ka.FRAGMENT_MAIN_UV,n.get(Ka.FRAGMENT_MAIN_UV)||"").replace(Ka.FRAGMENT_MAIN_IMAGE,n.get(Ka.FRAGMENT_MAIN_IMAGE)||""),this.vertexShader=_ht.replace(Ka.VERTEX_HEAD,n.get(Ka.VERTEX_HEAD)||"").replace(Ka.VERTEX_MAIN_SUPPORT,n.get(Ka.VERTEX_MAIN_SUPPORT)||""),this.needsUpdate=!0,this}setDefines(n){for(const e of n.entries())this.defines[e[0]]=e[1];return this.needsUpdate=!0,this}setUniforms(n){for(const e of n.entries())this.uniforms[e[0]]=e[1];return this}setExtensions(n){this.extensions={};for(const e of n)this.extensions[e]=!0;return this}get encodeOutput(){return this.defines.ENCODE_OUTPUT!==void 0}set encodeOutput(n){this.encodeOutput!==n&&(n?this.defines.ENCODE_OUTPUT="1":delete this.defines.ENCODE_OUTPUT,this.needsUpdate=!0)}isOutputEncodingEnabled(n){return this.encodeOutput}setOutputEncodingEnabled(n){this.encodeOutput=n}get time(){return this.uniforms.time.value}set time(n){this.uniforms.time.value=n}setDeltaTime(n){this.uniforms.time.value+=n}adoptCameraSettings(n){this.copyCameraSettings(n)}copyCameraSettings(n){n&&(this.uniforms.cameraNear.value=n.near,this.uniforms.cameraFar.value=n.far,n instanceof vf?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}setSize(n,e){const t=this.uniforms;t.resolution.value.set(n,e),t.texelSize.value.set(1/n,1/e),t.aspect.value=n/e}static get Section(){return Ka}};function tie(n,e,t){for(const r of e){const i="$1"+n+r.charAt(0).toUpperCase()+r.slice(1),s=new RegExp("([^\\.])(\\b"+r+"\\b)","g");for(const a of t.entries())a[1]!==null&&t.set(a[0],a[1].replace(s,i))}}function yht(n,e,t){let r=e.getFragmentShader(),i=e.getVertexShader();const s=r!==void 0&&/mainImage/.test(r),a=r!==void 0&&/mainUv/.test(r);if(t.attributes|=e.getAttributes(),r===void 0)throw new Error(`Missing fragment shader (${e.name})`);if(a&&(t.attributes&Lm.CONVOLUTION)!==0)throw new Error(`Effects that transform UVs are incompatible with convolution effects (${e.name})`);if(!s&&!a)throw new Error(`Could not find mainImage or mainUv function (${e.name})`);{const o=/\w+\s+(\w+)\([\w\s,]*\)\s*{/g,l=t.shaderParts;let c=l.get(Ka.FRAGMENT_HEAD)||"",u=l.get(Ka.FRAGMENT_MAIN_UV)||"",f=l.get(Ka.FRAGMENT_MAIN_IMAGE)||"",d=l.get(Ka.VERTEX_HEAD)||"",g=l.get(Ka.VERTEX_MAIN_SUPPORT)||"";const p=new Set,_=new Set;if(a&&(u+=`	${n}MainUv(UV);
`,t.uvTransformation=!0),i!==null&&/mainSupport/.test(i)){const x=/mainSupport *\([\w\s]*?uv\s*?\)/.test(i);g+=`	${n}MainSupport(`,g+=x?`vUv);
`:`);
`;for(const E of i.matchAll(/(?:varying\s+\w+\s+([\S\s]*?);)/g))for(const M of E[1].split(/\s*,\s*/))t.varyings.add(M),p.add(M),_.add(M);for(const E of i.matchAll(o))_.add(E[1])}for(const x of r.matchAll(o))_.add(x[1]);for(const x of e.defines.keys())_.add(x.replace(/\([\w\s,]*\)/g,""));for(const x of e.uniforms.keys())_.add(x);_.delete("while"),_.delete("for"),_.delete("if"),e.uniforms.forEach((x,E)=>t.uniforms.set(n+E.charAt(0).toUpperCase()+E.slice(1),x)),e.defines.forEach((x,E)=>t.defines.set(n+E.charAt(0).toUpperCase()+E.slice(1),x));const y=new Map([["fragment",r],["vertex",i]]);tie(n,_,t.defines),tie(n,_,y),r=y.get("fragment"),i=y.get("vertex");const v=e.blendMode;if(t.blendModes.set(v.blendFunction,v),s){e.inputColorSpace!==null&&e.inputColorSpace!==t.colorSpace&&(f+=e.inputColorSpace===ta?`color0 = sRGBTransferOETF(color0);
	`:`color0 = sRGBToLinear(color0);
	`),e.outputColorSpace!==v_?t.colorSpace=e.outputColorSpace:e.inputColorSpace!==null&&(t.colorSpace=e.inputColorSpace);const x=/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/;f+=`${n}MainImage(color0, UV, `,(t.attributes&Lm.DEPTH)!==0&&x.test(r)&&(f+="depth, ",t.readDepth=!0),f+=`color1);
	`;const E=n+"BlendOpacity";t.uniforms.set(E,v.opacity),f+=`color0 = blend${v.blendFunction}(color0, color1, ${E});

	`,c+=`uniform float ${E};

`}if(c+=r+`
`,i!==null&&(d+=i+`
`),l.set(Ka.FRAGMENT_HEAD,c),l.set(Ka.FRAGMENT_MAIN_UV,u),l.set(Ka.FRAGMENT_MAIN_IMAGE,f),l.set(Ka.VERTEX_HEAD,d),l.set(Ka.VERTEX_MAIN_SUPPORT,g),e.extensions!==null)for(const x of e.extensions)t.extensions.add(x)}}var J_e=class extends Ym{constructor(n,...e){super("EffectPass"),this.fullscreenMaterial=new vht(null,null,null,n),this.listener=t=>this.handleEvent(t),this.effects=[],this.setEffects(e),this.skipRendering=!1,this.minTime=1,this.maxTime=Number.POSITIVE_INFINITY,this.timeScale=1}set mainScene(n){for(const e of this.effects)e.mainScene=n}set mainCamera(n){this.fullscreenMaterial.copyCameraSettings(n);for(const e of this.effects)e.mainCamera=n}get encodeOutput(){return this.fullscreenMaterial.encodeOutput}set encodeOutput(n){this.fullscreenMaterial.encodeOutput=n}get dithering(){return this.fullscreenMaterial.dithering}set dithering(n){const e=this.fullscreenMaterial;e.dithering=n,e.needsUpdate=!0}setEffects(n){for(const e of this.effects)e.removeEventListener("change",this.listener);this.effects=n.sort((e,t)=>t.attributes-e.attributes);for(const e of this.effects)e.addEventListener("change",this.listener)}updateMaterial(){const n=new sft;let e=0;for(const a of this.effects)if(a.blendMode.blendFunction===Es.DST)n.attributes|=a.getAttributes()&Lm.DEPTH;else{if((n.attributes&a.getAttributes()&Lm.CONVOLUTION)!==0)throw new Error(`Convolution effects cannot be merged (${a.name})`);yht("e"+e++,a,n)}let t=n.shaderParts.get(Ka.FRAGMENT_HEAD),r=n.shaderParts.get(Ka.FRAGMENT_MAIN_IMAGE),i=n.shaderParts.get(Ka.FRAGMENT_MAIN_UV);const s=/\bblend\b/g;for(const a of n.blendModes.values())t+=a.getShaderCode().replace(s,`blend${a.blendFunction}`)+`
`;(n.attributes&Lm.DEPTH)!==0?(n.readDepth&&(r=`float depth = readDepth(UV);

	`+r),this.needsDepthTexture=this.getDepthTexture()===null):this.needsDepthTexture=!1,n.colorSpace===ta&&(r+=`color0 = sRGBToLinear(color0);
	`),n.uvTransformation?(i=`vec2 transformedUv = vUv;
`+i,n.defines.set("UV","transformedUv")):n.defines.set("UV","vUv"),n.shaderParts.set(Ka.FRAGMENT_HEAD,t),n.shaderParts.set(Ka.FRAGMENT_MAIN_IMAGE,r),n.shaderParts.set(Ka.FRAGMENT_MAIN_UV,i);for(const[a,o]of n.shaderParts)o!==null&&n.shaderParts.set(a,o.trim().replace(/^#/,`
#`));this.skipRendering=e===0,this.needsSwap=!this.skipRendering,this.fullscreenMaterial.setShaderData(n)}recompile(){this.updateMaterial()}getDepthTexture(){return this.fullscreenMaterial.depthBuffer}setDepthTexture(n,e=U1){this.fullscreenMaterial.depthBuffer=n,this.fullscreenMaterial.depthPacking=e;for(const t of this.effects)t.setDepthTexture(n,e)}render(n,e,t,r,i){for(const s of this.effects)s.update(n,e,r);if(!this.skipRendering||this.renderToScreen){const s=this.fullscreenMaterial;s.inputBuffer=e.texture,s.time+=r*this.timeScale,n.setRenderTarget(this.renderToScreen?null:t),n.render(this.scene,this.camera)}}setSize(n,e){this.fullscreenMaterial.setSize(n,e);for(const t of this.effects)t.setSize(n,e)}initialize(n,e,t){this.renderer=n;for(const r of this.effects)r.initialize(n,e,t);this.updateMaterial(),t!==void 0&&t!==zl&&(this.fullscreenMaterial.defines.FRAMEBUFFER_PRECISION_HIGH="1")}dispose(){super.dispose();for(const n of this.effects)n.removeEventListener("change",this.listener),n.dispose()}handleEvent(n){switch(n.type){case"change":this.recompile();break}}};function C2(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}new an;new an;function eve(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}var m0=function n(e,t,r){var i=this;eve(this,n),C2(this,"dot2",function(s,a){return i.x*s+i.y*a}),C2(this,"dot3",function(s,a,o){return i.x*s+i.y*a+i.z*o}),this.x=e,this.y=t,this.z=r},bht=[new m0(1,1,0),new m0(-1,1,0),new m0(1,-1,0),new m0(-1,-1,0),new m0(1,0,1),new m0(-1,0,1),new m0(1,0,-1),new m0(-1,0,-1),new m0(0,1,1),new m0(0,-1,1),new m0(0,1,-1),new m0(0,-1,-1)],nie=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],rie=new Array(512),iie=new Array(512),Sht=function(e){e>0&&e<1&&(e*=65536),e=Math.floor(e),e<256&&(e|=e<<8);for(var t=0;t<256;t++){var r;t&1?r=nie[t]^e&255:r=nie[t]^e>>8&255,rie[t]=rie[t+256]=r,iie[t]=iie[t+256]=bht[r%12]}};Sht(0);function Eht(n){if(typeof n=="number")n=Math.abs(n);else if(typeof n=="string"){var e=n;n=0;for(var t=0;t<e.length;t++)n=(n+(t+1)*(e.charCodeAt(t)%96))%2147483647}return n===0&&(n=311),n}function sie(n){var e=Eht(n);return function(){var t=e*48271%2147483647;return e=t,t/2147483647}}var xht=function n(e){var t=this;eve(this,n),C2(this,"seed",0),C2(this,"init",function(r){t.seed=r,t.value=sie(r)}),C2(this,"value",sie(this.seed)),this.init(e)};new xht(Math.random());const CV=it.createContext(null);let Tht=0;const aie=new WeakMap,r3=(n,e)=>function({blendFunction:t=e?.blendFunction,opacity:r=e?.opacity,...i}){let s=aie.get(n);if(!s){const l=`@react-three/postprocessing/${n.name}-${Tht++}`;nj({[l]:n}),aie.set(n,s=l)}const a=Im(l=>l.camera),o=Og.useMemo(()=>[...e?.args??[],...i.args??[{...e,...i}]],[JSON.stringify(i)]);return we.jsx(s,{camera:a,"blendMode-blendFunction":t,"blendMode-opacity-value":r,...i,args:o})},vN=(n,e)=>{const t=n[e];return Og.useMemo(()=>typeof t=="number"?new an(t,t):t?new an(...t):new an,[t])},MV=it.forwardRef(function({blendFunction:n,worldFocusDistance:e,worldFocusRange:t,focusDistance:r,focusRange:i,focalLength:s,bokehScale:a,resolutionScale:o,resolutionX:l,resolutionY:c,width:u,height:f,target:d,depthTexture:g,...p},_){const{camera:y}=it.useContext(CV),v=d!=null,x=it.useMemo(()=>{const E=new lht(y,{blendFunction:n,worldFocusDistance:e,worldFocusRange:t,focusDistance:r,focusRange:i,focalLength:s,bokehScale:a,resolutionScale:o,resolutionX:l,resolutionY:c,width:u,height:f});v&&(E.target=new ut),g&&E.setDepthTexture(g.texture,g.packing);const M=E.maskPass;return M.maskFunction=AV.MULTIPLY_RGB_SET_ALPHA,E},[y,n,e,t,r,i,s,a,o,l,c,u,f,v,g]);return it.useEffect(()=>()=>{x.dispose()},[x]),we.jsx("primitive",{...p,ref:_,object:x,target:d})}),wht=r3(tht,{blendFunction:0}),Rht=it.forwardRef(function({active:n=!0,...e},t){const r=Im(c=>c.invalidate),i=vN(e,"delay"),s=vN(e,"duration"),a=vN(e,"strength"),o=vN(e,"chromaticAberrationOffset"),l=it.useMemo(()=>new fht({...e,delay:i,duration:s,strength:a,chromaticAberrationOffset:o}),[i,s,e,a,o]);return it.useLayoutEffect(()=>{l.mode=n?e.mode||l1.SPORADIC:l1.DISABLED,r()},[n,l,r,e.mode]),it.useEffect(()=>()=>{l.dispose?.()},[l]),we.jsx("primitive",{ref:t,object:l,dispose:null})}),Aht=r3(dht,{blendFunction:5}),Cht=r3(mht);var q0=typeof window<"u"?window:{screen:{},navigator:{}},Aw=(q0.matchMedia||(function(){return{matches:!1}})).bind(q0),Mht={get passive(){return!0}},tve=function(){};q0.addEventListener&&q0.addEventListener("p",tve,Mht);q0.removeEventListener&&q0.removeEventListener("p",tve,!1);var kV="ontouchstart"in q0,kht="TouchEvent"in q0,Oht=kV||kht&&Aw("(any-pointer: coarse)").matches,oie=(q0.navigator.maxTouchPoints||0)>0||Oht,nve=q0.navigator.userAgent||"",Iht=Aw("(pointer: coarse)").matches&&/iPad|Macintosh/.test(nve)&&Math.min(q0.screen.width||0,q0.screen.height||0)>=768,rve=(Aw("(pointer: coarse)").matches||!Aw("(pointer: fine)").matches&&kV)&&!/Windows.*Firefox/.test(nve),Nht=Aw("(any-pointer: fine)").matches||Aw("(any-hover: hover)").matches||Iht||!kV,X9=oie&&(Nht||!rve)?"hybrid":oie?"touchOnly":"mouseOnly",Pht=X9==="mouseOnly"?"mouse":X9==="touchOnly"||rve?"touch":"mouse";const Dht=`  
vec3 halftone(vec3 texcolor, vec2 st, float frequency) {
  float n = 0.1 * snoise(st * 200.0); // Fractal noise
  n += 0.05 * snoise(st * 400.0);
  n += 0.025 * snoise(st * 800.0);

  // Perform a rough RGB-to-CMYK conversion
  vec4 cmyk;
  // CMY = 1-RGB
  cmyk.xyz = 1.0 - texcolor;
  // Black generation: K = min(C,M,Y)
  cmyk.w = min(cmyk.x, min(cmyk.y, cmyk.z)); 
  // Grey component replacement: subtract K from CMY
  cmyk.xyz -= cmyk.w; 

  // K based modifier
  float flex = pow(cmyk.w, 3.11);

  // Distance to nearest point in a grid of
  // (frequency x frequency) points over the unit square
  
  float t = 0.1 + 0.1 * n + 0.11 * flex + 0.1 * cmyk.y;

  // K component: 45 degrees screen angle
  vec2 Kst = frequency * mat2(0.707, -0.707, 0.707, 0.707) * st;
  vec2 Kuv = 2.0 * fract(Kst) - 1.0; 
  float k = aastep(0.0, sqrt(cmyk.w) + t - length(Kuv) + n);
  
  // C component: 15 degrees screen angle
  vec2 Cst = frequency*mat2(0.966, -0.259, 0.259, 0.966) * st;
  vec2 Cuv = 2.0 * fract(Cst) - 1.0;
  float c = aastep(0.0, sqrt(cmyk.x) + t - length(Cuv) + n);
  
  // M component: -15 degrees screen angle
  vec2 Mst = frequency * mat2(0.966, 0.259, -0.259, 0.966) * st;
  vec2 Muv = 2.0 * fract(Mst) - 1.0;
  float m = aastep(0.0, sqrt(cmyk.y) + t - length(Muv) + n);

  // Y component: 0 degrees screen angle
  vec2 Yst = frequency * st; // 0 deg 
  vec2 Yuv = 2.0 * fract(Yst) - 1.0;
  float y = aastep(0.0, sqrt(cmyk.z) + t - length(Yuv) + n);

  // CMY screen in RGB
  vec3 black = vec3(n + 0.01);
  vec3 rgbscreen = 1.0 - vec3(c,m,y) + n;
  
  // Blend in K for final color
  vec3 factor = mix(rgbscreen, black, 1.1 * k + 0.3 * n);

  // Blend with og color
  return mix(factor, texcolor, 0.777);
}

vec3 halftone(vec3 texcolor, vec2 st) {
  return halftone(texcolor, st, 412.321);
}
`,Lht=`
float blendLighten(float base, float blend) {
	return max(blend,base);
}

vec3 blendLighten(vec3 base, vec3 blend) {
	return vec3(blendLighten(base.r,blend.r),blendLighten(base.g,blend.g),blendLighten(base.b,blend.b));
}

vec3 blendLighten(vec3 base, vec3 blend, float opacity) {
	return (blendLighten(base, blend) * opacity + base * (1.0 - opacity));
}

float blendDarken(float base, float blend) {
	return min(blend,base);
}

vec3 blendDarken(vec3 base, vec3 blend) {
	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));
}

vec3 blendDarken(vec3 base, vec3 blend, float opacity) {
	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));
}
`,Uht=`
float aastep(float threshold, float value) {
  float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;
  return smoothstep(threshold-afwidth, threshold+afwidth, value);
}
`,i3=`
//
// Description : Array and textureless GLSL 2D simplex noise function.
//      Author : Ian McEwan, Ashima Arts.
//  Maintainer : ijm
//     Lastmod : 20110822 (ijm)
//     License : Copyright (C) 2011 Ashima Arts. All rights reserved.
//               Distributed under the MIT License. See LICENSE file.
//               https://github.com/ashima/webgl-noise
//

vec3 mod289(vec3 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec2 mod289(vec2 x) {
  return x - floor(x * (1.0 / 289.0)) * 289.0;
}

vec3 permute(vec3 x) {
  return mod289(((x*34.0)+1.0)*x);
}

float snoise(vec2 v) {
  const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                      0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                     -0.577350269189626,  // -1.0 + 2.0 * C.x
                      0.024390243902439); // 1.0 / 41.0
// First corner
  vec2 i  = floor(v + dot(v, C.yy) );
  vec2 x0 = v -   i + dot(i, C.xx);

// Other corners
  vec2 i1;
  //i1.x = step( x0.y, x0.x ); // x0.x > x0.y ? 1.0 : 0.0
  //i1.y = 1.0 - i1.x;
  i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
  // x0 = x0 - 0.0 + 0.0 * C.xx ;
  // x1 = x0 - i1 + 1.0 * C.xx ;
  // x2 = x0 - 1.0 + 2.0 * C.xx ;
  vec4 x12 = x0.xyxy + C.xxzz;
  x12.xy -= i1;

// Permutations
  i = mod289(i); // Avoid truncation effects in permutation
  vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
    + i.x + vec3(0.0, i1.x, 1.0 ));

  vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
  m = m*m ;
  m = m*m ;

// Gradients: 41 points uniformly over a line, mapped onto a diamond.
// The ring size 17*17 = 289 is close to a multiple of 41 (41*7 = 287)

  vec3 x = 2.0 * fract(p * C.www) - 1.0;
  vec3 h = abs(x) - 0.5;
  vec3 ox = floor(x + 0.5);
  vec3 a0 = x - ox;

// Normalise gradients implicitly by scaling m
// Approximation of: m *= inversesqrt( a0*a0 + h*h );
  m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );

// Compute final noise value at P
  vec3 g;
  g.x  = a0.x  * x0.x  + h.x  * x0.y;
  g.yz = a0.yz * x12.xz + h.yz * x12.yw;
  return 130.0 * dot(m, g);
}
`,Bht=`
#ifdef ASPECT_CORRECTION
	uniform float scale;
#else
	uniform mat3 uvTransform;
#endif

varying vec2 vUv2;

void mainSupport(const in vec2 uv) {
	#ifdef ASPECT_CORRECTION
		vUv2 = uv * vec2(aspect, 1.0) * scale;
	#else
		vUv2 = (uvTransform * vec3(uv, 1.0)).xy;
	#endif
}
`,Fht=`
uniform float viewheight;
uniform sampler2D splat;

${Lht}
${Uht}
${i3}
${Dht}

float rectdistance(vec2 uv) {
  vec2 tl = vec2(-1.0);
  vec2 br = vec2(1.0);
  vec2 d = max(tl - uv, uv - br);
  return abs(length(max(vec2(0.0), d)) + min(0.0, max(d.x, d.y)));
}

vec2 bendy(const in vec2 xn, float dn, float sn) {
  // config
  float distortion = 0.0173 + dn; // 0.0173, 0.511
  float scale = 0.991 + sn; // 1.0, 0.7
  // calc
  vec3 xDistorted = vec3((1.0 + vec2(distortion, distortion) * dot(xn, xn)) * xn, 1.0);
  mat3 kk = mat3(
    vec3(1.0, 0.0, 0.0),
    vec3(0.0, 1.0, 0.0),
    vec3(0.0, 0.0, 1.0)
  );
  return (kk * xDistorted).xy * scale;
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
	#ifdef UV_TRANSFORM
		vec4 bright = texture2D(splat, vUv2);
		vec4 dark = texture2D(splat, 1.0 - vUv2);
	#else
		vec4 bright = texture2D(splat, uv);
		vec4 dark = texture2D(splat, 1.0 - uv);
	#endif
  
  float n = 0.1 * snoise(uv.st * 200.0); // Fractal noise
  n += 0.05 * snoise(uv.st * 400.0);
  n += 0.025 * snoise(uv.st * 800.0);

  vec2 xn = 2.0 * (uv.st - 0.5);
  float fz = 0.005;
  vec2 edge = bendy(xn, fz * n, -fz * n);
  vec2 bent = edge.xy * 0.5 + 0.5;

  float edgetime = time * 0.3;
  float edgetime2 = time * 2.0;
  vec2 edgewiggle = vec2(cos(edgetime) * 0.1, sin(edgetime) * 0.096);
  vec2 edgewiggle2 = vec2(cos(edgetime2) * 0.005, sin(edgetime2) * 0.005);
  vec2 edgeshine = vec2(edge.x * 5.0 + 3.5, edge.y - 0.3) + edgewiggle + edgewiggle2;
  vec2 edgeshine2 = vec2(edge.x, edge.y * 2.0 - 0.5) + edgewiggle + edgewiggle2;
  vec2 edgeshine3 = vec2(edge.x * 3.0 - 2.1, edge.y + 0.3) + edgewiggle + edgewiggle2;
  
  float dx = rectdistance(xn);
  float bx = rectdistance(edge);
  float ex = rectdistance(edgeshine);
  float ex2 = rectdistance(edgeshine2);
  float ex3 = rectdistance(edgeshine3);

  // apply shape
  float doot = max(abs(edge.x), abs(edge.y));
  if (doot < 1.0) {
    // display
    outputColor = texture2D(inputBuffer, bent);

    // apply scratches
    outputColor.rgb = blendLighten(outputColor.rgb, bright.rgb, 0.079);
    outputColor.rgb = blendDarken(outputColor.rgb, dark.rgb, 0.0666);

    // apply halftones
    outputColor.rgb = halftone(outputColor.rgb, uv.st);
  
  } else if (doot > 1.004) {
    // display shell
    // rbgb 205 205 193
    vec3 matte = vec3(205.0 / 255.0, 205.0 / 255.0, 193.0 / 255.0);
    vec3 dkmatte = mix(matte, vec3(0.0), 0.5);
    float mx = pow(1.0 - bx, 16.0) + n;
    outputColor = vec4(mix(matte, dkmatte, mx), inputColor.a);

  } else {
    // border
    outputColor = vec4(mix(vec3(0.0), outputColor.rgb, 0.5), inputColor.a);
  }

  // apply reflection shine
  if (doot < 0.98) {
    float vvv = 0.34;
    if (edge.x > -0.9 && edge.x < -0.5 && edge.y > -0.5) {
      float sh = clamp(0.0, vvv, ex + n * 0.333);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(bx * 3.0)) * (6.0 + sin(edgetime));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
    if (edge.y > -0.3 && edge.y < 0.7) {
      float sh = clamp(0.0, vvv, ex2 + n * 0.15);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(dx * 3.0)) * (4.0 + cos(edgetime * 1.5));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
    if (edge.x > 0.4 && edge.y < 0.8) {
      float sh = clamp(0.0, vvv, ex3 + n * 0.25);
      float ratio = pow(sh, 5.0) * 6.0 * abs(cos(bx * 2.0)) * (3.0 + sin(-edgetime));
      vec3 shade = mix(outputColor.rgb, vec3(1.0), ratio * 0.333);
      outputColor = vec4(shade, inputColor.a);
    }
  }

  // apply inner shade
  if (doot >= 0.5 && doot < 1.0) {
    float sh = clamp(0.0, 1.0, 1.0 - bx - 0.7);
    vec3 shade = mix(outputColor.rgb, vec3(0.0), pow(sh, 4.0));
    outputColor = vec4(shade, inputColor.a);
  }

  // apply outer shade
  if (doot >= 0.97) {
    float sh = clamp(0.0, 1.0, bx * 24.0);
    vec3 dkout = mix(vec3(0.0), outputColor.rgb, 0.81);
    vec3 shade = mix(dkout, outputColor.rgb, sh);
    outputColor = vec4(shade, inputColor.a);
  }
}
`;class zht extends L_{constructor({splat:e,viewheight:t}={}){super("CRTShapeEffect",Fht,{blendFunction:Es.NORMAL,attributes:Lm.CONVOLUTION,defines:new Map([["TEXEL","texel"],["TEXTURE_PRECISION_HIGH","1"]]),uniforms:new Map([["splat",new jn(e)],["viewheight",new jn(t??128)]])})}get splat(){return this.uniforms.get("splat")?.value}set splat(e){const{splat:t,uniforms:r,defines:i}=this,s=r.get("splat"),a=r.get("uvTransform");t!==e&&s&&a&&(s.value=e,a.value=e.matrix,i.delete("TEXTURE_PRECISION_HIGH"),e!==null&&(e.matrixAutoUpdate?(i.set("UV_TRANSFORM","1"),this.setVertexShader(Bht)):(i.delete("UV_TRANSFORM"),this.setVertexShader(null)),e.type!==zl&&i.set("TEXTURE_PRECISION_HIGH","1"),(t===null||t?.type!==e.type)&&this.setChanged()))}getTexture(){return this.splat}setTexture(e){this.splat=e}get aspectCorrection(){return this.defines.has("ASPECT_CORRECTION")}set aspectCorrection(e){this.aspectCorrection!==e&&(e?this.defines.set("ASPECT_CORRECTION","1"):this.defines.delete("ASPECT_CORRECTION"),this.setChanged())}get uvTransform(){return!!this.splat?.matrixAutoUpdate}set uvTransform(e){const t=this.splat;xe(t)&&(t.matrixAutoUpdate=e)}setTextureSwizzleRGBA(e,t=e,r=e,i=e){const s="rgba";let a="";(e!==ET.RED||t!==ET.GREEN||r!==ET.BLUE||i!==ET.ALPHA)&&(a=[".",s[e],s[t],s[r],s[i]].join("")),this.defines.set("TEXEL","texel"+a),this.setChanged()}update(){this.splat?.matrixAutoUpdate&&this.splat.updateMatrix()}}const jht=r3(zht);function ive(n,e,t,r){const i=e*t*4;for(let s=0,a=0;s<i;++a)n.image.data[s]=r[a]*255,s+=4;return n.needsUpdate=!0,n}function sve(n,e){const t=new Uint8Array(4*n*e);return new Lg(t,n,e)}const Hht=new jl({transparent:!1,side:$f,uniforms:{color:{value:new cr(0,0,0)},data:{value:null}},vertexShader:`
      varying vec2 vUv;
    
      void main() {
        vec4 mvPosition = vec4(position, 1.0);
        #ifdef USE_INSTANCING
        	mvPosition = instanceMatrix * mvPosition;
        #endif        
        mvPosition = modelViewMatrix * mvPosition;
        gl_Position = projectionMatrix * mvPosition;
        
        vUv = uv;
      }
    `,fragmentShader:`
      uniform vec3 color;
      uniform sampler2D data;
  
      varying vec2 vUv;

      // adapted from https://www.shadertoy.com/view/Mlt3z8
      float bayerDither2x2( vec2 v ) {
        return mod( 3.0 * v.y + 2.0 * v.x, 4.0 );
      }

      float bayerDither4x4( vec2 v ) {
        vec2 P1 = mod( v, 2.0 );
        vec2 P2 = mod( floor( 0.5  * v ), 2.0 );
        return 4.0 * bayerDither2x2( P1 ) + bayerDither2x2( P2 );
      }

      void main() {
        float alpha = texture2D(data, vUv).r;
        if (alpha < 1.0) {
          vec2 ditherCoord = floor( mod( gl_FragCoord.xy, 4.0 ) );
          if ( bayerDither4x4( ditherCoord ) / 16.0 >= alpha ) {
            discard;
          }
        }

        gl_FragColor.rgba = vec4(color.xyz, 1.0);
      }
    `});function ave(){return JO(Hht)}const kp=[0,1,0],Sv=[1,1,0],Ag=[1,0,0],Ev=[0,0,0],qht=new Float32Array([...kp,...Ag,...Sv,...kp,...Ev,...Ag]),ove=new Float32Array([...kp.slice(0,2),...Ag.slice(0,2),...Sv.slice(0,2),...kp.slice(0,2),...Ev.slice(0,2),...Ag.slice(0,2)]);function Vht(n,e,t,r,i,s){const a=e*t*4;for(let o=0,l=0;o<a;++l){const c=r[l]??0;n.image.data[o++]=c%O0,n.image.data[o++]=Math.floor(c/O0),n.image.data[o++]=i[l]??16,n.image.data[o++]=s[l]??16}return n.needsUpdate=!0,n}function Ght(n,e){const t=new Uint8Array(4*n*e),r=new Lg(t,n,e,Xk,zl);return r.internalFormat="RGBA8UI",r}function OV(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:qht.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s}}),uv:ove}}const lie=[0,1,1],gF=[1,1,1],yN=[1,0,1],_F=[0,0,1],$ht=new Float32Array([...kp,...gF,...Sv,...kp,...lie,...gF,...Ev,...yN,...Ag,...Ev,..._F,...yN,...Sv,...yN,...Ag,...Sv,...gF,...yN,...kp,..._F,...Ev,...kp,...lie,..._F]),Wht=new Float32Array([...kp.slice(0,2),...Ag.slice(0,2),...Sv.slice(0,2),...kp.slice(0,2),...Ev.slice(0,2),...Ag.slice(0,2),...kp.slice(0,2),...Ag.slice(0,2),...Sv.slice(0,2),...kp.slice(0,2),...Ev.slice(0,2),...Ag.slice(0,2),...Sv.slice(0,2),...Ev.slice(0,2),...kp.slice(0,2),...Sv.slice(0,2),...Ag.slice(0,2),...Ev.slice(0,2),...kp.slice(0,2),...Ag.slice(0,2),...Sv.slice(0,2),...kp.slice(0,2),...Ev.slice(0,2),...Ag.slice(0,2)]);function Yht(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:$ht.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s*r}}),uv:Wht}}const cie=[0,0,0],Xht=[1,0,0],uie=[1,0,1],Kht=[0,0,1],Zht=new Float32Array([...cie,...uie,...Xht,...cie,...Kht,...uie]);function Qht(n,e){const t=n*Gn.DRAW_CHAR_WIDTH(),r=e*Gn.DRAW_CHAR_HEIGHT();return{position:Zht.map((s,a)=>{switch(a%3){case 0:return s*t;case 1:return s*r;default:return s*r}}),uv:ove}}const Jht=nw(QE(qw)),fie=mv(JE(Hw)),edt=new jl({transparent:!1,side:$f,uniforms:{time:wg,interval:QO,palette:new jn(Jht),map:new jn(fie),alt:new jn(fie),data:new jn(null),size:new jn(new an),step:new jn(new an),flip:new jn(!0)},vertexShader:`
    varying vec2 vUv;
    void main() {
      vec4 mvPosition = vec4(position, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;
      vUv = uv;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform usampler2D data;
    uniform vec3 palette[16];
    uniform vec2 size;
    uniform vec2 step;
    uniform bool flip;
    varying vec2 vUv;

    ${i3}

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vUv * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      uvec4 tiledata = texture(data, vUv);
      int colori = int(tiledata.z);
      int bgi = int(tiledata.w);

      vec2 charPosition = mod(vUv, size) / size;
      vec2 uv = vec2(charPosition.x * step.x, charPosition.y * step.y);
      
      vec3 color;
      if (colori > 31) {
        vec3 bg = palette[bgi];
        color = palette[colori - 33];
        float cycle = mod(time * 2.5, interval * 2.0) / interval;
        color = mix(bg, color, cyclefromtime());
      } else {
        color = palette[colori % 16];
      }

      uv.x += step.x * float(tiledata.x);
      uv.y += step.y * float(tiledata.y);
      if (flip) {
        uv.y = 1.0 - uv.y;
      }

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${Sn.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function tdt(){return JO(edt)}function tb({width:n,height:e,alphas:t}){const[r]=it.useState(()=>ave());it.useEffect(()=>{r.uniforms.data.value=sve(n,e)},[r.uniforms.data,n,e]),it.useEffect(()=>{ive(r.uniforms.data.value,n,e,t)},[r,r.uniforms.data.value,n,e,t]);const{position:i,uv:s}=it.useMemo(()=>OV(n,e),[n,e]);return we.jsxs("mesh",{children:[we.jsx("primitive",{object:r,attach:"material"}),we.jsxs("bufferGeometry",{children:[we.jsx("bufferAttribute",{attach:"attributes-position",args:[i,3]}),we.jsx("bufferAttribute",{attach:"attributes-uv",args:[s,2]})]})]})}function ndt({width:n,height:e,alpha:t}){const r=it.useMemo(()=>new Array(n*e).fill(t),[n,e,t]);return we.jsx(tb,{width:n,height:e,alphas:r})}const jM=new _oe,CS=new an;function IV({width:n,height:e,top:t,left:r,right:i,bottom:s,scale:a=.125,alpha:o=.25}){const l=it.useMemo(()=>{const c=new Array(n*e);jM.min.x=r,jM.min.y=t,jM.max.x=i,jM.max.y=s,CS.x=0,CS.y=0;for(let u=0;u<c.length;++u)c[u]=fae.smootherstep(1-jM.distanceToPoint(CS)*a,0,1)*o,++CS.x,CS.x>=n&&(CS.x=0,++CS.y);return c},[n,e,t,r,i,s,a,o]);return we.jsx(tb,{width:n,height:e,alphas:l})}function hie(){}const rdt=Og.forwardRef(function({args:e,children:t,...r},i){const s=Og.useRef(null);return Og.useImperativeHandle(i,()=>s.current),we.jsxs("mesh",{ref:s,...r,children:[we.jsx("planeGeometry",{attach:"geometry",args:e}),t]})}),x_=Og.forwardRef(function({blocking:e=!1,cursor:t="default",x:r=0,y:i=0,z:s=0,width:a=1,height:o=1,opacity:l=1,visible:c=!0,color:u="white",...f},d){const g=a*.5,p=o*.5,_=[(r+g)*Gn.DRAW_CHAR_WIDTH(),(i+p)*Gn.DRAW_CHAR_HEIGHT(),s];return we.jsx(rdt,{ref:d,args:[a*Gn.DRAW_CHAR_WIDTH(),o*Gn.DRAW_CHAR_HEIGHT()],userData:{blocking:e,cursor:t},onClick:e?hie:void 0,onPointerMove:e?hie:void 0,position:_,...f,children:we.jsx("meshBasicMaterial",{color:u,opacity:l,visible:c,transparent:l!==1})})});function Dv({width:n,height:e,char:t,color:r,bg:i,fliptexture:s=!0}){const a=qc(p=>p.palettedata),o=qc(p=>p.charsetdata),l=qc(p=>p.altcharsetdata),[c]=it.useState(()=>tdt()),{width:u=0,height:f=0}=o?.image??{};it.useEffect(()=>{n===0||e===0||(c.uniforms.data.value=Ght(n,e))},[c.uniforms.data,n,e]),it.useEffect(()=>{n===0||e===0||Vht(c.uniforms.data.value,n,e,t,r,i)},[c.uniforms.data.value,n,e,t,r,i]),it.useEffect(()=>{n===0||e===0||!o||(c.uniforms.map.value=o,c.uniforms.alt.value=l??o,c.uniforms.palette.value=a,c.uniforms.size.value.x=1/n,c.uniforms.size.value.y=1/e,c.uniforms.step.value.x=1/Math.round(u/Jd),c.uniforms.step.value.y=1/Math.round(f/ep),c.uniforms.flip.value=s,c.needsUpdate=!0)},[a,o,l,c,n,e,u,f,s]);const{position:d,uv:g}=it.useMemo(()=>OV(n,e),[n,e]);return we.jsxs("mesh",{children:[we.jsxs("bufferGeometry",{children:[we.jsx("bufferAttribute",{attach:"attributes-position",args:[d,3]}),we.jsx("bufferAttribute",{attach:"attributes-uv",args:[g,2]})]}),we.jsx("primitive",{object:c,attach:"material"})]})}function lR({store:n,children:e}){return we.jsx(Sq.Provider,{value:n,children:e})}function cR({width:n,height:e}){const t=it.useContext(Sq),[r,i,s]=bq(t,wd(a=>[a.char,a.color,a.bg,a.render]));return n>0&&e>0&&we.jsx(Dv,{char:r.slice(),color:i.slice(),bg:s.slice(),width:n,height:e})}const P1=navigator.userAgent.includes("Mac"),idt=navigator.userAgent.includes("Linux"),g0=P1?"cmd":"ctrl";function s3({x:n,y:e,width:t,height:r,debug:i,...s}){const a=Gn.DRAW_CHAR_WIDTH(),o=Gn.DRAW_CHAR_HEIGHT();return we.jsx(Qut,{...s,args:[t*a,r*o],position:[(n??0)*a+t*a*.5,(e??0)*o+r*o*.5,0],children:we.jsx("meshBasicMaterial",{transparent:!0,opacity:i?.7:0,color:"red"})})}const die=P1?"Meta":"Ctrl";function Kn({x:n,y:e,letters:t,digit:r,usealt:i,usectrl:s}){const a=Fh(),{keyboardshift:o,keyboardctrl:l,keyboardalt:c}=el();if(a.x=n,a.y=e,ci("$219$219$219$219$219",a,!1),a.x=n,a.y=e+1,ci("$219$178$178$178$219",a,!1),a.x=n,a.y=e+2,ci("$219$219$219$219$219",a,!1),t&&(a.x=n+(t.startsWith("$")?2:Math.round(2.5-t.length*.5)),a.y=e,ci(o?t.toUpperCase():t.toLowerCase(),a,!1)),r.trim().length===1){a.x=n+2,a.y=e+2;const u=r==="$"?"$$":r;ci(o?u.toUpperCase():u.toLowerCase(),a,!1)}return we.jsx(s3,{x:n,y:e,width:5,height:3,onPointerDown:()=>{let u="";c&&i&&(u+="{Alt>}"),l&&s&&(u+=`{${die}>}`),o&&(u+="{Shift>}"),u+=r.length===1?r.replace("[","[[").replace("{","{{"):r,c&&i&&(u+="{/Alt}"),l&&s&&(u+=`{/${die}}`),o&&(u+="{/Shift}"),p_.keyboard(u).catch(bm)}})}function kh({x:n,y:e,letters:t,onToggle:r}){const i=Fh();return i.x=n,i.y=e,ci("$178$178$178$178$178",i,!1),i.x=n,i.y=e+1,ci("$178$177$177$177$178",i,!1),i.x=n,i.y=e+2,ci("$178$178$178$178$178",i,!1),t&&(i.x=n+Math.round(2.5-t.length*.5),i.y=e,ci(t,i,!1)),we.jsx(s3,{x:n,y:e,width:5,height:3,onPointerDown:()=>{r()}})}function sdt({width:n}){const{keyboardshift:e,wordlist:t}=el(),r=n-18,i=n-12,s=n-6;return we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:r,y:0,letters:"",digit:"1"}),we.jsx(Kn,{x:i,y:1,letters:"ABC",digit:"2"}),we.jsx(Kn,{x:s,y:0,letters:"DEF",digit:"3"}),we.jsx(Kn,{x:r,y:4,letters:"GHI",digit:"4"}),we.jsx(Kn,{x:i,y:5,letters:"JKL",digit:"5"}),we.jsx(Kn,{x:s,y:4,letters:"MNO",digit:"6"}),we.jsx(Kn,{x:r,y:8,letters:"PQRS",digit:"7"}),we.jsx(Kn,{x:i,y:9,letters:"TUV",digit:"8"}),we.jsx(Kn,{x:s,y:8,letters:"WXYZ",digit:"9"}),we.jsx(Kn,{x:r,y:12,letters:"=",digit:"#"}),we.jsx(Kn,{x:i,y:13,letters:"",digit:"0"}),we.jsx(Kn,{x:s,y:12,letters:"ENTER",digit:"[Enter]"}),t.length?we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"$27",digit:"[ArrowLeft]",usealt:!0}),we.jsx(Kn,{x:1,y:4,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(Kn,{x:1,y:12,letters:"$26",digit:"[ArrowRight]",usealt:!0})]}):we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"^",digit:","}),we.jsx(Kn,{x:7,y:1,letters:"&",digit:"."}),we.jsx(Kn,{x:13,y:0,letters:"{",digit:"["}),we.jsx(Kn,{x:19,y:1,letters:"}",digit:"]"}),we.jsx(Kn,{x:1,y:4,letters:"ESC",digit:"[Escape]"}),we.jsx(kh,{x:7,y:5,letters:"ctrl",onToggle:()=>el.setState({keyboardctrl:!0,keyboardalt:!1})}),we.jsx(kh,{x:13,y:4,letters:"ALT",onToggle:()=>el.setState({keyboardalt:!1})}),we.jsx(Kn,{x:19,y:5,letters:"$27",digit:"[ArrowLeft]",usealt:!0}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(kh,{x:7,y:9,letters:e?"SHIFT":"shift",onToggle:()=>{el.setState(a=>({keyboardshift:!a.keyboardshift}))}}),we.jsx(Kn,{x:13,y:8,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:19,y:9,letters:"$26",digit:"[ArrowRight]",usealt:!0}),we.jsx(Kn,{x:1,y:12,letters:"<",digit:">"}),we.jsx(Kn,{x:7,y:13,letters:";",digit:"!"}),we.jsx(Kn,{x:13,y:12,letters:"\\",digit:"|"}),we.jsx(Kn,{x:19,y:13,letters:"",digit:"x"})]})]})}function adt({width:n}){const{keyboardshift:e,wordlist:t}=el(),r=n-18,i=n-12,s=n-6;return we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:s,y:0,letters:"",digit:"k",usectrl:!0}),we.jsx(Kn,{x:r,y:4,letters:"",digit:"r",usectrl:!0}),we.jsx(Kn,{x:i,y:5,letters:"",digit:"s",usectrl:!0}),we.jsx(Kn,{x:s,y:4,letters:"",digit:"x",usectrl:!0}),we.jsx(Kn,{x:r,y:8,letters:"",digit:"p",usectrl:!0}),we.jsx(Kn,{x:i,y:9,letters:"",digit:"a",usectrl:!0}),we.jsx(Kn,{x:s,y:8,letters:"",digit:"c",usectrl:!0}),we.jsx(Kn,{x:r,y:12,letters:"",digit:"y",usectrl:!0}),we.jsx(Kn,{x:i,y:13,letters:"",digit:"z",usectrl:!0}),we.jsx(Kn,{x:s,y:12,letters:"",digit:"v",usectrl:!0}),t.length?we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"$24",digit:"[ArrowUp]",usealt:!0}),we.jsx(Kn,{x:1,y:4,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(Kn,{x:1,y:12,letters:"$25",digit:"[ArrowDown]",usealt:!0})]}):we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"-",digit:"+"}),we.jsx(Kn,{x:7,y:1,letters:"%",digit:"*"}),we.jsx(Kn,{x:13,y:0,letters:"<",digit:"("}),we.jsx(Kn,{x:19,y:1,letters:">",digit:")"}),we.jsx(Kn,{x:1,y:4,letters:"ESC",digit:"[Escape]"}),we.jsx(kh,{x:7,y:5,letters:"CTRL",onToggle:()=>el.setState({keyboardctrl:!1})}),we.jsx(kh,{x:13,y:4,letters:"alt",onToggle:()=>el.setState({keyboardctrl:!1,keyboardalt:!0})}),we.jsx(Kn,{x:19,y:5,letters:"$24",digit:"[ArrowUp]",usectrl:!0}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(kh,{x:7,y:9,letters:e?"SHIFT":"shift",onToggle:()=>{el.setState(a=>({keyboardshift:!a.keyboardshift}))}}),we.jsx(Kn,{x:13,y:8,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:19,y:9,letters:"$25",digit:"[ArrowDown]",usectrl:!0}),we.jsx(Kn,{x:1,y:12,letters:"/",digit:"?"}),we.jsx(Kn,{x:7,y:13,letters:";",digit:"!"}),we.jsx(Kn,{x:13,y:12,letters:":",digit:"'"}),we.jsx(Kn,{x:19,y:13,letters:'"',digit:"$"})]})]})}function odt({width:n}){const{keyboardshift:e,wordlist:t}=el(),r=n-18,i=n-12,s=n-6;return we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:r,y:0,letters:"",digit:"1"}),we.jsx(Kn,{x:i,y:1,letters:"ABC",digit:"2"}),we.jsx(Kn,{x:s,y:0,letters:"DEF",digit:"3"}),we.jsx(Kn,{x:r,y:4,letters:"GHI",digit:"4"}),we.jsx(Kn,{x:i,y:5,letters:"JKL",digit:"5"}),we.jsx(Kn,{x:s,y:4,letters:"MNO",digit:"6"}),we.jsx(Kn,{x:r,y:8,letters:"PQRS",digit:"7"}),we.jsx(Kn,{x:i,y:9,letters:"TUV",digit:"8"}),we.jsx(Kn,{x:s,y:8,letters:"WXYZ",digit:"9"}),we.jsx(Kn,{x:r,y:12,letters:"@",digit:"#"}),we.jsx(Kn,{x:i,y:13,letters:"",digit:"0"}),we.jsx(Kn,{x:s,y:12,letters:"ENTER",digit:"[Enter]"}),t.length?we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"$27",digit:"[ArrowLeft]",usealt:!0}),we.jsx(Kn,{x:1,y:4,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(Kn,{x:1,y:12,letters:"$26",digit:"[ArrowRight]",usealt:!0})]}):we.jsxs(we.Fragment,{children:[we.jsx(Kn,{x:1,y:0,letters:"-",digit:"+"}),we.jsx(Kn,{x:7,y:1,letters:"%",digit:"*"}),we.jsx(Kn,{x:13,y:0,letters:"<",digit:"("}),we.jsx(Kn,{x:19,y:1,letters:">",digit:")"}),we.jsx(Kn,{x:1,y:4,letters:"ESC",digit:"[Escape]"}),we.jsx(kh,{x:7,y:5,letters:"ctrl",onToggle:()=>el.setState({keyboardctrl:!0})}),we.jsx(kh,{x:13,y:4,letters:"alt",onToggle:()=>el.setState({keyboardalt:!0})}),we.jsx(Kn,{x:19,y:5,letters:"$27",digit:"[ArrowLeft]",usealt:!0}),we.jsx(Kn,{x:1,y:8,letters:"SPACE",digit:"[Space]"}),we.jsx(kh,{x:7,y:9,letters:e?"SHIFT":"shift",onToggle:()=>{el.setState(a=>({keyboardshift:!a.keyboardshift}))}}),we.jsx(Kn,{x:13,y:8,letters:"BKSPC",digit:"[Backspace]"}),we.jsx(Kn,{x:19,y:9,letters:"$26",digit:"[ArrowRight]",usealt:!0}),we.jsx(Kn,{x:1,y:12,letters:"/",digit:"?"}),we.jsx(Kn,{x:7,y:13,letters:";",digit:"!"}),we.jsx(Kn,{x:13,y:12,letters:":",digit:"'"}),we.jsx(Kn,{x:19,y:13,letters:'"',digit:"$"})]})]})}function ldt({width:n}){const e=Fh(),{keyboardalt:t,keyboardctrl:r,keyboardshift:i}=el(),s=n-18,a=n-12,o=n-6,l=Math.round(n*.5)-3,c=o,u=12;e.x=c,e.y=u,ci("$178$178$178$178$178",e,!1),e.x=c,e.y=u+1,ci("$178$177$177$177$178",e,!1),e.x=c,e.y=u+2,ci("$178$178$178$178$178",e,!1);const f="shoot";e.x=c+Math.round(2.5-f.length*.5),e.y=u,ci(f,e,!1);function d(){p_.keyboard("{/Shift}").catch(bm)}return we.jsxs(we.Fragment,{children:[we.jsx(kh,{x:1,y:0,letters:r?"CTRL":"ctrl",onToggle:()=>{el.setState({keyboardctrl:!r})}}),we.jsx(kh,{x:7,y:1,letters:t?"ALT":"alt",onToggle:()=>{el.setState({keyboardalt:!t})}}),we.jsx(kh,{x:13,y:0,letters:i?"SHIFT":"shift",onToggle:()=>{el.setState({keyboardshift:!i})}}),we.jsx(kh,{x:s,y:0,letters:"menu",onToggle:()=>{p_.keyboard("[Tab]").catch(bm)}}),we.jsx(kh,{x:a,y:1,letters:"okay",onToggle:()=>{p_.keyboard("[Enter]").catch(bm)}}),we.jsx(kh,{x:o,y:0,letters:"cancel",onToggle:()=>{p_.keyboard("[Escape]").catch(bm)}}),we.jsx(kh,{x:1,y:12,letters:"?",onToggle:()=>{p_.keyboard("{Shift>}?{/Shift}").catch(bm)}}),we.jsx(kh,{x:7,y:13,letters:"#",onToggle:()=>{p_.keyboard("3").catch(bm)}}),we.jsx(kh,{x:13,y:12,letters:"c",onToggle:()=>{p_.keyboard("c").catch(bm)}}),we.jsx(Kn,{x:l,y:0,letters:"$24",digit:"[ArrowUp]",usealt:!0}),we.jsx(Kn,{x:l,y:13,letters:"$25",digit:"[ArrowDown]",usealt:!0}),we.jsx(Kn,{x:n-6,y:6,letters:"$26",digit:"[ArrowRight]",usealt:!0,usectrl:!0}),we.jsx(Kn,{x:0,y:6,letters:"$27",digit:"[ArrowLeft]",usealt:!0,usectrl:!0}),we.jsx(s3,{x:o,y:12,width:5,height:3,onPointerDown:()=>{p_.keyboard("{Shift>}").catch(bm)},onPointerUp:d,onPointerLeave:d,onPointerCancel:d})]})}var uP={exports:{}},cdt=uP.exports,pie;function udt(){return pie||(pie=1,(function(n,e){(function(t,r){n.exports=r()})(cdt,(()=>(()=>{var t={944:function(a){var o;o=()=>(()=>{var l={d:(v,x)=>{for(var E in x)l.o(x,E)&&!l.o(v,E)&&Object.defineProperty(v,E,{enumerable:!0,get:x[E]})},o:(v,x)=>Object.prototype.hasOwnProperty.call(v,x)},c={};function u(v){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(x){return typeof x}:function(x){return x&&typeof Symbol=="function"&&x.constructor===Symbol&&x!==Symbol.prototype?"symbol":typeof x},u(v)}function f(v,x){var E=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(!E){if(Array.isArray(v)||(E=g(v))||x){E&&(v=E);var M=0,O=function(){};return{s:O,n:function(){return M>=v.length?{done:!0}:{done:!1,value:v[M++]}},e:function(V){throw V},f:O}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var N,I=!0,D=!1;return{s:function(){E=E.call(v)},n:function(){var V=E.next();return I=V.done,V},e:function(V){D=!0,N=V},f:function(){try{I||E.return==null||E.return()}finally{if(D)throw N}}}}function d(v,x){return(function(E){if(Array.isArray(E))return E})(v)||(function(E,M){var O=E==null?null:typeof Symbol<"u"&&E[Symbol.iterator]||E["@@iterator"];if(O!=null){var N,I,D,V,G=[],Q=!0,B=!1;try{if(D=(O=O.call(E)).next,M!==0)for(;!(Q=(N=D.call(O)).done)&&(G.push(N.value),G.length!==M);Q=!0);}catch($){B=!0,I=$}finally{try{if(!Q&&O.return!=null&&(V=O.return(),Object(V)!==V))return}finally{if(B)throw I}}return G}})(v,x)||g(v,x)||(function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)})()}function g(v,x){if(v){if(typeof v=="string")return p(v,x);var E=Object.prototype.toString.call(v).slice(8,-1);return E==="Object"&&v.constructor&&(E=v.constructor.name),E==="Map"||E==="Set"?Array.from(v):E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E)?p(v,x):void 0}}function p(v,x){(x==null||x>v.length)&&(x=v.length);for(var E=0,M=new Array(x);E<x;E++)M[E]=v[E];return M}function _(v,x){if(!(v instanceof x))throw new TypeError("Cannot call a class as a function")}l.d(c,{default:()=>y});var y=(function(){function v(){var M=!(arguments.length>0&&arguments[0]!==void 0)||arguments[0];_(this,v),this.strict=M,this.defaults=new Map,this.validators=new Map,this.types=new Map,this.optional=new Set,this.required=new Set}var x,E;return x=v,(E=[{key:"allowExtra",value:function(){return this.strict=!1,this}},{key:"setDefaults",value:function(M){var O=this;return Object.entries(M).forEach((function(N){var I=d(N,2),D=I[0],V=I[1];return O.defaults.set(D,V)})),this}},{key:"setValidators",value:function(M){var O=this;return Object.entries(M).forEach((function(N){var I=d(N,2),D=I[0],V=I[1];return O.validators.set(D,V)})),this}},{key:"setTypes",value:function(M){var O=this;return Object.entries(M).forEach((function(N){var I=d(N,2),D=I[0],V=I[1];return O.types.set(D,V)})),this}},{key:"setOptional",value:function(M){var O=this;return M.forEach((function(N){return O.optional.add(N)})),this}},{key:"setRequired",value:function(M){var O=this;return M.forEach((function(N){return O.required.add(N)})),this}},{key:"resolve",value:function(M){return this.validate(Object.assign(this.getDefaults(),M))}},{key:"getDefaults",value:function(){var M,O={},N=f(this.defaults);try{for(N.s();!(M=N.n()).done;){var I=d(M.value,2),D=I[0],V=I[1];O[D]=V}}catch(G){N.e(G)}finally{N.f()}return O}},{key:"validate",value:function(M){for(var O in M)this.validators.has(O)&&(M[O]=this.validators.get(O)(M[O]));for(var N in M){if(!this.optionExists(N))throw new Error('Unkown option "'.concat(N,'".'));this.checkType(N,M[N])}var I,D=f(this.required.values());try{for(D.s();!(I=D.n()).done;){var V=I.value;if(M[V]===void 0)throw new Error('Option "'.concat(V,'" is required.'))}}catch(G){D.e(G)}finally{D.f()}return M}},{key:"checkType",value:function(M,O){if(this.types.has(M)){var N=this.types.get(M),I=u(O);if(I!==N)throw new Error('Wrong value for option "'.concat(M,'": expected type "').concat(N,'", got "').concat(I,'".'))}}},{key:"optionExists",value:function(M){return!this.strict||this.defaults.has(M)||this.validators.has(M)||this.optional.has(M)||this.required.has(M)||this.types.has(M)}}])&&(function(M,O){for(var N=0;N<O.length;N++){var I=O[N];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(M,(D=(function(V,G){if(u(V)!=="object"||V===null)return V;var Q=V[Symbol.toPrimitive];if(Q!==void 0){var B=Q.call(V,"string");if(u(B)!=="object")return B;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(V)})(I.key),u(D)==="symbol"?D:String(D)),I)}var D})(x.prototype,E),Object.defineProperty(x,"prototype",{writable:!1}),v})();return c.default})(),a.exports=o()},162:function(a){a.exports=(()=>{var o={d:(u,f)=>{for(var d in f)o.o(f,d)&&!o.o(u,d)&&Object.defineProperty(u,d,{enumerable:!0,get:f[d]})},o:(u,f)=>Object.prototype.hasOwnProperty.call(u,f)},l={};o.d(l,{default:()=>c});var c=(function(){function u(){(function(d,g){if(!(d instanceof g))throw new TypeError("Cannot call a class as a function")})(this,u),this._events={},this.on=this.addEventListener,this.off=this.removeEventListener}var f;return(f=[{key:"emit",value:function(d,g){if(Object.prototype.hasOwnProperty.call(this._events,d))for(var p=this._events[d],_={type:d,detail:g},y=p.length,v=0;v<y;v++)this.handle(p[v],_)}},{key:"handle",value:function(d,g){d(g)}},{key:"addEventListener",value:function(d,g){Object.prototype.hasOwnProperty.call(this._events,d)||(this._events[d]=[]),this._events[d].indexOf(g)<0&&this._events[d].push(g)}},{key:"removeEventListener",value:function(d,g){if(Object.prototype.hasOwnProperty.call(this._events,d)){var p=this._events[d],_=p.indexOf(g);_>=0&&p.splice(_,1),p.length===0&&delete this._events[d]}}}])&&(function(d,g){for(var p=0;p<g.length;p++){var _=g[p];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(d,_.key,_)}})(u.prototype,f),u})();return l.default})()}},r={};function i(a){var o=r[a];if(o!==void 0)return o.exports;var l=r[a]={exports:{}};return t[a].call(l.exports,l,l.exports,i),l.exports}i.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return i.d(o,{a:o}),o},i.d=(a,o)=>{for(var l in o)i.o(o,l)&&!i.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})},i.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),i.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var s={};return(()=>{i.r(s),i.d(s,{GamepadHandler:()=>M,GamepadListener:()=>q});var a=i(162),o=i.n(a),l=i(944),c=i.n(l);function u(Y){return u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},u(Y)}function f(Y,ae){if(!(Y instanceof ae))throw new TypeError("Cannot call a class as a function")}function d(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,y(K.key),K)}}function g(Y,ae){return g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,K){return Z.__proto__=K,Z},g(Y,ae)}function p(Y,ae){if(ae&&(u(ae)==="object"||typeof ae=="function"))return ae;if(ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(Z){if(Z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Z})(Y)}function _(Y){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ae){return ae.__proto__||Object.getPrototypeOf(ae)},_(Y)}function y(Y){var ae=(function(Z,K){if(u(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(u(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return u(ae)==="symbol"?ae:String(ae)}var v,x,E,M=(function(Y){(function(Me,qe){if(typeof qe!="function"&&qe!==null)throw new TypeError("Super expression must either be null or a function");Me.prototype=Object.create(qe&&qe.prototype,{constructor:{value:Me,writable:!0,configurable:!0}}),Object.defineProperty(Me,"prototype",{writable:!1}),qe&&g(Me,qe)})(de,Y);var ae,Z,K,ne,le,ce=(ne=de,le=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Me,qe=_(ne);if(le){var Pe=_(this).constructor;Me=Reflect.construct(qe,arguments,Pe)}else Me=qe.apply(this,arguments);return p(this,Me)});function de(Me,qe){var Pe,Ce=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return f(this,de),(Pe=ce.call(this)).index=Me,Pe.gamepad=qe,Pe.options=Pe.constructor.resolveOptions(Ce),Pe.axes=new Array(qe.axes.length).fill(null),Pe.buttons=new Array(qe.buttons.length).fill(null),Pe.initAxes(),Pe.initButtons(),Pe}return ae=de,K=[{key:"resolveOptions",value:function(Me){var qe,Pe,Ce,Xe,$e=Me.axis,at=Me.button;return{axis:this.optionResolver.resolve((qe=(Pe=$e??at)!==null&&Pe!==void 0?Pe:Me)!==null&&qe!==void 0?qe:{}),button:this.optionResolver.resolve((Ce=(Xe=at??$e)!==null&&Xe!==void 0?Xe:Me)!==null&&Ce!==void 0?Ce:{})}}}],(Z=[{key:"initAxes",value:function(){for(var Me=this.axes.length,qe=0;qe<Me;qe++)this.axes[qe]=this.resolveAxisValue(qe)}},{key:"initButtons",value:function(){for(var Me=this.buttons.length,qe=0;qe<Me;qe++)this.buttons[qe]=this.resolveButtonValue(qe)}},{key:"update",value:function(Me){this.gamepad=Me,this.updateAxis(),this.updateButtons()}},{key:"updateAxis",value:function(){for(var Me=this.axes.length,qe=0;qe<Me;qe++)this.setAxisValue(qe,this.resolveAxisValue(qe))}},{key:"updateButtons",value:function(){for(var Me=this.buttons.length,qe=0;qe<Me;qe++)this.setButtonValue(qe,this.resolveButtonValue(qe))}},{key:"setAxisValue",value:function(Me,qe){this.axes[Me]!==qe&&(this.axes[Me]=qe,this.emit("axis",{gamepad:this.gamepad,index:this.index,axis:Me,value:qe}))}},{key:"setButtonValue",value:function(Me,qe){this.buttons[Me]!==qe&&(this.buttons[Me]=qe,this.emit("button",{gamepad:this.gamepad,index:this.index,button:Me,pressed:this.gamepad.buttons[Me].pressed,value:qe}))}},{key:"resolveAxisValue",value:function(Me){var qe=this.options.axis,Pe=qe.deadZone,Ce=qe.analog,Xe=qe.precision,$e=this.gamepad.axes[Me];return Pe&&$e<Pe&&$e>-Pe?0:Ce?Xe?Math.round($e*Xe)/Xe:$e:$e>0?1:$e<0?-1:0}},{key:"resolveButtonValue",value:function(Me){var qe=this.options.button,Pe=qe.deadZone,Ce=qe.analog,Xe=qe.precision,$e=this.gamepad.buttons[Me].value;return Pe>0&&$e<Pe&&$e>-Pe?0:Ce?Xe?Math.round($e*Xe)/Xe:$e:$e===0?0:1}}])&&d(ae.prototype,Z),K&&d(ae,K),Object.defineProperty(ae,"prototype",{writable:!1}),de})(o());function O(Y){return O=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},O(Y)}function N(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,I(K.key),K)}}function I(Y){var ae=(function(Z,K){if(O(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(O(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return O(ae)==="symbol"?ae:String(ae)}v=M,x="optionResolver",E=new(c())().setDefaults({analog:!0,deadZone:0,precision:0}).setTypes({analog:"boolean",deadZone:"number",precision:"number"}).setValidators({deadZone:function(Y){return Math.max(Math.min(Y,1),0)},precision:function(Y){return Y>0?Math.pow(10,Y):0}}),(x=y(x))in v?Object.defineProperty(v,x,{value:E,enumerable:!0,configurable:!0,writable:!0}):v[x]=E;var D=(function(){function Y(K){(function(ne,le){if(!(ne instanceof le))throw new TypeError("Cannot call a class as a function")})(this,Y),this.callback=K,this.frame=null,this.update=this.update.bind(this)}var ae,Z;return ae=Y,(Z=[{key:"setCallback",value:function(K){this.callback=K}},{key:"start",value:function(){this.frame||(this.frame=window.requestAnimationFrame(this.update))}},{key:"stop",value:function(){this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=null)}},{key:"update",value:function(){this.frame=window.requestAnimationFrame(this.update),this.callback()}}])&&N(ae.prototype,Z),Object.defineProperty(ae,"prototype",{writable:!1}),Y})();function V(Y){return V=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ae){return typeof ae}:function(ae){return ae&&typeof Symbol=="function"&&ae.constructor===Symbol&&ae!==Symbol.prototype?"symbol":typeof ae},V(Y)}function G(Y,ae){if(!(Y instanceof ae))throw new TypeError("Cannot call a class as a function")}function Q(Y,ae){for(var Z=0;Z<ae.length;Z++){var K=ae[Z];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(Y,B(K.key),K)}}function B(Y){var ae=(function(Z,K){if(V(Z)!=="object"||Z===null)return Z;var ne=Z[Symbol.toPrimitive];if(ne!==void 0){var le=ne.call(Z,"string");if(V(le)!=="object")return le;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Z)})(Y);return V(ae)==="symbol"?ae:String(ae)}function $(Y,ae){return $=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,K){return Z.__proto__=K,Z},$(Y,ae)}function U(Y,ae){if(ae&&(V(ae)==="object"||typeof ae=="function"))return ae;if(ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return J(Y)}function J(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function W(Y){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ae){return ae.__proto__||Object.getPrototypeOf(ae)},W(Y)}var q=(function(Y){(function(de,Me){if(typeof Me!="function"&&Me!==null)throw new TypeError("Super expression must either be null or a function");de.prototype=Object.create(Me&&Me.prototype,{constructor:{value:de,writable:!0,configurable:!0}}),Object.defineProperty(de,"prototype",{writable:!1}),Me&&$(de,Me)})(ce,Y);var ae,Z,K,ne,le=(K=ce,ne=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var de,Me=W(K);if(ne){var qe=W(this).constructor;de=Reflect.construct(Me,arguments,qe)}else de=Me.apply(this,arguments);return U(this,de)});function ce(){var de,Me=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(G(this,ce),de=le.call(this),typeof navigator.getGamepads!="function")throw new Error("This browser does not support gamepad API.");return de.options=Me,de.onAxis=de.onAxis.bind(J(de)),de.update=de.update.bind(J(de)),de.start=de.start.bind(J(de)),de.stop=de.stop.bind(J(de)),de.discover=de.discover.bind(J(de)),de.onButton=de.onButton.bind(J(de)),de.handlers=new Array(4).fill(null),de.loop=new D(de.update),window.addEventListener("error",de.stop),de}return ae=ce,(Z=[{key:"start",value:function(){this.loop.start()}},{key:"stop",value:function(){this.loop.stop()}},{key:"update",value:function(){var de=navigator.getGamepads();this.discover(de[0],0),this.discover(de[1],1),this.discover(de[2],2),this.discover(de[3],3)}},{key:"discover",value:function(de,Me){de?(this.handlers[Me]===null&&this.registerHandler(Me,de),this.handlers[Me].update(de)):this.handlers[Me]&&this.removeGamepad(Me)}},{key:"registerHandler",value:function(de,Me){var qe=new M(de,Me,this.options);this.handlers[de]=qe,qe.addEventListener("axis",this.onAxis),qe.addEventListener("button",this.onButton),this.emit("gamepad:connected",{index:de,gamepad:Me}),this.emit("gamepad:".concat(de,":connected"),{index:de,gamepad:Me})}},{key:"removeGamepad",value:function(de){var Me=this.handlers[de];Me.removeEventListener("axis",this.onAxis),Me.removeEventListener("button",this.onButton),this.handlers[de]=null,this.emit("gamepad:disconnected",{index:de}),this.emit("gamepad:".concat(de,":disconnected"),{index:de})}},{key:"onAxis",value:function(de){var Me=de.detail.index;this.emit("gamepad:axis",de.detail),this.emit("gamepad:".concat(Me,":axis"),de.detail),this.emit("gamepad:".concat(Me,":axis:").concat(de.detail.axis),de.detail)}},{key:"onButton",value:function(de){var Me=de.detail.index;this.emit("gamepad:button",de.detail),this.emit("gamepad:".concat(Me,":button"),de.detail),this.emit("gamepad:".concat(Me,":button:").concat(de.detail.button),de.detail)}}])&&Q(ae.prototype,Z),Object.defineProperty(ae,"prototype",{writable:!1}),ce})(o())})(),s})()))})(uP)),uP.exports}var fdt=udt(),u_={},mie;function hdt(){if(mie)return u_;mie=1,Object.defineProperty(u_,"__esModule",{value:!0});for(var n=typeof window<"u"&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),e={alt:"altKey",control:"ctrlKey",meta:"metaKey",shift:"shiftKey"},t={add:"+",break:"pause",cmd:"meta",command:"meta",ctl:"control",ctrl:"control",del:"delete",down:"arrowdown",esc:"escape",ins:"insert",left:"arrowleft",mod:n?"meta":"control",opt:"alt",option:"alt",return:"enter",right:"arrowright",space:" ",spacebar:" ",up:"arrowup",win:"meta",windows:"meta"},r={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,escape:27," ":32,pageup:33,pagedown:34,end:35,home:36,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,insert:45,delete:46,meta:91,numlock:144,scrolllock:145,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},i=1;i<20;i++)r["f"+i]=111+i;function s(d,g,p){g&&!("byKey"in g)&&(p=g,g=null),Array.isArray(d)||(d=[d]);var _=d.map(function(x){return l(x,g)}),y=function(E){return _.some(function(M){return c(M,E)})},v=p==null?y:y(p);return v}function a(d,g){return s(d,g)}function o(d,g){return s(d,{byKey:!0},g)}function l(d,g){var p=g&&g.byKey,_={};d=d.replace("++","+add");var y=d.split("+"),v=y.length;for(var x in e)_[e[x]]=!1;var E=!0,M=!1,O=void 0;try{for(var N=y[Symbol.iterator](),I;!(E=(I=N.next()).done);E=!0){var D=I.value,V=D.endsWith("?")&&D.length>1;V&&(D=D.slice(0,-1));var G=f(D),Q=e[G];if(D.length>1&&!Q&&!t[D]&&!r[G])throw new TypeError('Unknown modifier: "'+D+'"');(v===1||!Q)&&(p?_.key=G:_.which=u(D)),Q&&(_[Q]=V?null:!0)}}catch(B){M=!0,O=B}finally{try{!E&&N.return&&N.return()}finally{if(M)throw O}}return _}function c(d,g){for(var p in d){var _=d[p],y=void 0;if(_!=null&&(p==="key"&&g.key!=null?y=g.key.toLowerCase():p==="which"?y=_===91&&g.which===93?91:g.which:y=g[p],!(y==null&&_===!1)&&y!==_))return!1}return!0}function u(d){d=f(d);var g=r[d]||d.toUpperCase().charCodeAt(0);return g}function f(d){return d=d.toLowerCase(),d=t[d]||d,d}return u_.default=s,u_.isHotkey=s,u_.isCodeHotkey=a,u_.isKeyHotkey=o,u_.parseHotkey=l,u_.compareHotkey=c,u_.toKeyCode=u,u_.toKeyName=f,u_}var ddt=hdt();const gie=Bh(ddt);function lve(n){return{all:n=n||new Map,on:function(e,t){var r=n.get(e);r?r.push(t):n.set(e,[t])},off:function(e,t){var r=n.get(e);r&&(t?r.splice(r.indexOf(t)>>>0,1):n.set(e,[]))},emit:function(e,t){var r=n.get(e);r&&r.slice().map(function(i){i(t)}),(r=n.get("*"))&&r.slice().map(function(i){i(e,t)})}}}const dE={};function NV(n){return`${ss()}local${n}`}const pdt=1e3,lT={};let vF=0,_ie=performance.now();const Cw=D4*10,vie=[Tn.MOVE_UP,Tn.MOVE_DOWN,Tn.MOVE_LEFT,Tn.MOVE_RIGHT,Tn.OK_BUTTON,Tn.CANCEL_BUTTON,Tn.MENU_BUTTON];function cve(){const n=performance.now(),e=n-_ie,t=sb(dE);for(let r=0;r<t.length;++r){const i=parseFloat(t[r]);if(lT[i]=lT[i]??0,lT[i]+=e,lT[i]>=Cw){lT[i]-=Cw;const s=dE[i],a={alt:!!s[Tn.ALT],ctrl:!!s[Tn.CTRL],shift:!!s[Tn.SHIFT]};for(let o=0;o<vie.length;++o){const l=vie[o];s[l]&&fve(i,l,a)}}}if(++vF,_ie=n,setTimeout(cve,10),vF>pdt){vF=0;const r=sb(dE);for(let i=1;i<r.length;++i){const s=parseFloat(r[i]);lle(xt,NV(s))}}}cve();function PV(n){return dE[n]=dE[n]??{[Tn.NONE]:!1,[Tn.ALT]:!1,[Tn.CTRL]:!1,[Tn.SHIFT]:!1,[Tn.MOVE_UP]:!1,[Tn.MOVE_DOWN]:!1,[Tn.MOVE_LEFT]:!1,[Tn.MOVE_RIGHT]:!1,[Tn.OK_BUTTON]:!1,[Tn.CANCEL_BUTTON]:!1,[Tn.MENU_BUTTON]:!1},dE[n]}function Bl(n,e){const t=PV(n);t[e]||(lT[n]=Cw*-2,fve(n,e,{alt:t[Tn.ALT],ctrl:t[Tn.CTRL],shift:t[Tn.SHIFT]})),t[e]=!0}function Ua(n,e){const t=PV(n);t[e]=!1}const vv={root:lve(),ignorehotkeys:!1},uve=it.createContext(vv.root);function a3(n){return{alt:n.altKey,ctrl:P1?n.metaKey:n.ctrlKey,shift:n.shiftKey}}function fve(n,e,t){if(n===0)vv.root.emit(Tn[e],t);else{let r=0;const i=NV(n);t.alt&&(r|=qj),t.ctrl&&(r|=Vj),t.shift&&(r|=Gj),cle(xt,i,e,r)}}window.addEventListener("wheel",n=>{n.preventDefault()},{passive:!1});window.addEventListener("keydown",n=>{const e=qr(n.key),t=a3(n),r=ss();switch(e){case"s":case"r":case"j":case"o":case"f":case"z":case"y":case"e":case"k":case"p":case"h":case"[":case"]":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"delete":case"backspace":(t.alt||t.ctrl||t.shift)&&n.preventDefault();break;case"tab":case"arrowleft":case"arrowright":case"arrowup":case"arrowdown":case"/":n.preventDefault();break}switch(t.alt?Bl(0,Tn.ALT):Ua(0,Tn.ALT),t.ctrl?Bl(0,Tn.CTRL):Ua(0,Tn.CTRL),t.shift?Bl(0,Tn.SHIFT):Ua(0,Tn.SHIFT),e){case"arrowleft":Bl(0,Tn.MOVE_LEFT);break;case"arrowright":Bl(0,Tn.MOVE_RIGHT);break;case"arrowup":Bl(0,Tn.MOVE_UP);break;case"arrowdown":Bl(0,Tn.MOVE_DOWN);break;case"enter":Bl(0,Tn.OK_BUTTON);break;case"esc":case"escape":Bl(0,Tn.CANCEL_BUTTON);break;case"tab":Bl(0,Tn.MENU_BUTTON);break;case"r":t.ctrl&&sOe(xt,r);break;case"s":t.ctrl&&wv(xt,r,"#save");break;case"j":t.ctrl&&wv(xt,r,t.shift?"#jointab hush":"#jointab");break;case"o":t.ctrl&&wv(xt,r,t.shift?"#joincode hush":"#joincode");break;case"l":break;case"f":t.ctrl&&wv(xt,r,"#fork");break;case"k":t.ctrl&&EOe(xt,r)}vv.root.emit("keydown",n)},{capture:!0});window.addEventListener("keyup",n=>{const e=qr(n.key),t=a3(n);switch(t.alt?Bl(0,Tn.ALT):Ua(0,Tn.ALT),t.ctrl?Bl(0,Tn.CTRL):Ua(0,Tn.CTRL),t.shift?Bl(0,Tn.SHIFT):Ua(0,Tn.SHIFT),e){case"meta":Ua(0,Tn.MOVE_LEFT),Ua(0,Tn.MOVE_RIGHT),Ua(0,Tn.MOVE_UP),Ua(0,Tn.MOVE_DOWN);break;case"arrowleft":Ua(0,Tn.MOVE_LEFT);break;case"arrowright":Ua(0,Tn.MOVE_RIGHT);break;case"arrowup":Ua(0,Tn.MOVE_UP);break;case"arrowdown":Ua(0,Tn.MOVE_DOWN);break;case"enter":Ua(0,Tn.OK_BUTTON);break;case"esc":case"escape":Ua(0,Tn.CANCEL_BUTTON);break;case"tab":Ua(0,Tn.MENU_BUTTON);break}},{capture:!0});H1("userinput",[],n=>{switch(n.target){case"up":Mn(n.data)&&Ua(0,n.data);break;case"down":Mn(n.data)&&Bl(0,n.data);break}});const hve=0,dve=1,pve=2,mve=3,mdt=4,gdt=5,_dt=6,vdt=7,ydt=9,bdt=12,Sdt=13,Edt=14,xdt=15,yF={[mve]:Tn.MOVE_UP,[hve]:Tn.MOVE_DOWN,[pve]:Tn.MOVE_LEFT,[dve]:Tn.MOVE_RIGHT,[mdt]:Tn.OK_BUTTON,[gdt]:Tn.CANCEL_BUTTON,[_dt]:Tn.SHIFT,[vdt]:Tn.SHIFT,[ydt]:Tn.MENU_BUTTON,[bdt]:Tn.MOVE_UP,[Sdt]:Tn.MOVE_DOWN,[Edt]:Tn.MOVE_LEFT,[xdt]:Tn.MOVE_RIGHT},bF={};function Tdt(n){return bF[n]=bF[n]??{},bF[n]}function wdt(n,e,t){const r=Tdt(n),i=ZS(r[0]??0,r[1]??0),s=ZS(r[2]??0,r[3]??0);r[e]=t;const a=ZS(r[0]??0,r[1]??0),o=ZS(r[2]??0,r[3]??0);if(i!==a)switch(Ua(n,Tn.MOVE_LEFT),Ua(n,Tn.MOVE_RIGHT),Ua(n,Tn.MOVE_UP),Ua(n,Tn.MOVE_DOWN),a){case Hn.NORTH:Bl(n,Tn.MOVE_UP);break;case Hn.SOUTH:Bl(n,Tn.MOVE_DOWN);break;case Hn.WEST:Bl(n,Tn.MOVE_LEFT);break;case Hn.EAST:Bl(n,Tn.MOVE_RIGHT);break}if(s!==o)switch(o===Hn.IDLE?Ua(n,Tn.SHIFT):Bl(n,Tn.SHIFT),Ua(n,Tn.MOVE_LEFT),Ua(n,Tn.MOVE_RIGHT),Ua(n,Tn.MOVE_UP),Ua(n,Tn.MOVE_DOWN),o){case Hn.NORTH:Bl(n,Tn.MOVE_UP);break;case Hn.SOUTH:Bl(n,Tn.MOVE_DOWN);break;case Hn.WEST:Bl(n,Tn.MOVE_LEFT);break;case Hn.EAST:Bl(n,Tn.MOVE_RIGHT);break}}const o3=new fdt.GamepadListener({analog:!1,deadZone:.3});o3.on("gamepad:connected",n=>{const e=ss();xs(xt,e,`connected ${n.detail.gamepad.id}`),PV(n.detail.index),n.detail.index>0&&yOe(xt,NV(n.detail.index))});o3.on("gamepad:disconnected",n=>{const e=ss();xs(xt,e,`disconnected gamepad ${n.detail.index}`),delete dE[n.detail.index]});o3.on("gamepad:axis",n=>{wdt(n.detail.index,n.detail.axis,n.detail.value)});o3.on("gamepad:button",n=>{const e=n.detail.index;switch(n.detail.button){case pve:case dve:case mve:case hve:Ua(e,Tn.MOVE_UP),Ua(e,Tn.MOVE_DOWN),Ua(e,Tn.MOVE_LEFT),Ua(e,Tn.MOVE_RIGHT),n.detail.value?(Bl(n.detail.index,Tn.SHIFT),Bl(n.detail.index,yF[n.detail.button])):Ua(n.detail.index,Tn.SHIFT);break;default:n.detail.value?Bl(n.detail.index,yF[n.detail.button]):Ua(n.detail.index,yF[n.detail.button]);break}});o3.start();const yie="keyup";function PT({hotkey:n,althotkey:e,children:t}){return it.useEffect(()=>{const r=gie(n,{byKey:!0}),i=xe(e)?gie(e,{byKey:!0}):void 0;function s(a){vv.ignorehotkeys===!1&&(r(a)||i?.(a))&&t()}return document.addEventListener(yie,s,!1),()=>document.removeEventListener(yie,s,!1)},[n,e,t]),null}function Vc(n){const e=it.useContext(uve);return it.useEffect(()=>{const t=Object.entries(n);return t.forEach(([r,i])=>e.on(r,i)),()=>{t.forEach(([r,i])=>e.off(r,i))}},[e,n]),null}function J1({blockhotkeys:n,children:e}){const[t]=it.useState(()=>lve());return it.useEffect(()=>{const r=vv.root,i=vv.ignorehotkeys;return vv.root=t,vv.ignorehotkeys=!!n,()=>{vv.root=r,vv.ignorehotkeys=i}},[t,n]),we.jsx(uve.Provider,{value:t,children:e})}function Rdt(n){const{keyboardshift:e,keyboardctrl:t,keyboardalt:r}=el.getState();let i="";switch(r&&(i+="{Alt>}"),t&&(i+="{Ctrl>}"),e&&(i+="{Shift>}"),n){case 0:i+="[ArrowLeft]";break;case 45:i+="[ArrowLeft][ArrowUp]";break;case 90:i+="[ArrowUp]";break;case 135:i+="[ArrowRight][ArrowUp]";break;case 180:i+="[ArrowRight]";break;case 225:i+="[ArrowRight][ArrowDown]";break;case 270:i+="[ArrowDown]";break;case 315:i+="[ArrowLeft][ArrowDown]";break;case 360:i+="[ArrowLeft]";break}r&&(i+="{/Alt}"),t&&(i+="{/Ctrl}"),e&&(i+="{/Shift}"),p_.keyboard(i).catch(bm)}const Adt=Cw/1e3,HM=new an,IL=new ut;function SF(n,e){const t=Gn.DRAW_CHAR_WIDTH(),r=Gn.DRAW_CHAR_HEIGHT(),i=IL.x+t*.5,s=IL.y+r*.5;return{cx:Math.floor(n*.5)+Math.floor(i/t),cy:Math.floor(e*.5)+Math.floor(s/r)}}const bie=4;function Cdt({width:n,height:e,onUp:t,onDrawStick:r}){const[i]=it.useState({startx:-1,starty:-1,tipx:-1,tipy:-1,pointerid:-1,presscount:0,inputacc:Cw});function s(a){i.pointerid===a.pointerId&&(--i.presscount,i.startx=-1,i.starty=-1,i.tipx=-1,i.tipy=-1,i.pointerid=-1,t())}return Gg((a,o)=>{if(i.inputacc+=o,i.inputacc>=Adt&&i.presscount>0){i.inputacc=0;const{cx:l,cy:c}=SF(n,e);if(HM.set(i.startx-l,i.starty-c),i.tipx!==-1||HM.length()>bie){const u=Qoe(ske(HM.angle()),45);Rdt(u)}}}),we.jsx(s3,{width:n,height:e,onPointerDown:a=>{if(++i.presscount,i.startx===-1){a.intersections[0].object.worldToLocal(IL.copy(a.intersections[0].point));const{cx:o,cy:l}=SF(n,e);i.startx=o,i.starty=l,i.tipx=-1,i.tipy=-1,i.pointerid=a.pointerId,i.inputacc=Cw}},onPointerMove:a=>{if(a.pointerId===i.pointerid&&a.intersections[0]){a.intersections[0].object.worldToLocal(IL.copy(a.intersections[0].point));const{cx:o,cy:l}=SF(n,e);HM.set(i.startx-o,i.starty-l),HM.length()>bie*.25&&(i.tipx=o,i.tipy=l,r(i.startx,i.starty,i.tipx,i.tipy))}},onPointerUp:s,onPointerLeave:s,onPointerCancel:s})}const qM=new an,Mdt=177,kdt=Sn.WHITE,Odt=Sn.DKPURPLE;function Idt({width:n,height:e,onReset:t}){const r=Fh(),i=ao(c=>c.editor.open||c.terminal.open||c.quickterminal),{keyboardalt:s,keyboardctrl:a}=el();MU(r,Mdt,kdt,Odt);const o=Math.floor(n*.333),l=Math.round(n*.666);for(let c=0;c<e;++c)for(let u=o;u<=l;++u)Hu(r,n,e,u,c,{char:176});return we.jsxs(we.Fragment,{children:[we.jsx(s3,{x:0,y:-3,width:n,height:3,onPointerDown:()=>{el.setState(c=>({...c,sidebaropen:!c.sidebaropen}))}}),i?we.jsxs(we.Fragment,{children:[s&&we.jsx(sdt,{width:n}),a&&we.jsx(adt,{width:n}),!s&&!a&&we.jsx(odt,{width:n})]}):we.jsx(ldt,{width:n}),we.jsx(Cdt,{width:n,height:e,onUp:t,onDrawStick:(c,u,f,d)=>{for(let g=0;g<5;++g)r.x=c-3,r.y=u-2+g,ci("$dkblue$177$177$177$177$177$177$177",r,!1);qM.x=f-c,qM.y=d-u,qM.normalize().multiplyScalar(4);for(let g=0;g<3;++g)r.x=c+Math.round(qM.x)-1,r.y=u+Math.round(qM.y)-1+g,ci("$blue$219$219$219",r,!1)}})]})}function Ndt({width:n,height:e}){const[t,r]=it.useState(0),i=Rb(),s=177,a=Sn.WHITE,o=Sn.DKPURPLE,l=Zw(n,e,s,a,o),c={...yb(n,e,a,o),...l.getState()};return i.cols<10||i.rows<10?null:we.jsxs(lR,{store:l,children:[we.jsx(kO.Provider,{value:c,children:we.jsx(Idt,{width:n,height:e,onReset:()=>{MU(c,s,a,o),r(Math.random())}},t)}),we.jsx(cR,{width:n,height:e})]})}const gve=it.createContext({cols:1,rows:1,marginx:1,marginy:1});function Rb(){return it.useContext(gve)}function Pdt({children:n}){const{viewport:e}=Im(),{width:t,height:r}=e.getCurrentViewport(),{islandscape:i,showtouchcontrols:s}=el(),a=t/Gn.DRAW_CHAR_WIDTH();let o=Math.floor(a);const l=r/Gn.DRAW_CHAR_HEIGHT();let c=Math.floor(l);const u=(t-o*Gn.DRAW_CHAR_WIDTH())*.5,f=(r-c*Gn.DRAW_CHAR_HEIGHT())*.5;let d=0,g=0;const p=Math.round(a);let _=Math.round(l);return s&&(i?(d=5*Gn.DRAW_CHAR_WIDTH(),o-=10):(c=Math.floor(l)-16,_-=c,g=c*Gn.DRAW_CHAR_HEIGHT())),it.useEffect(()=>{el.setState(y=>({...y,insetcols:p,insetrows:_}))},[p,_]),we.jsx(gve.Provider,{value:{cols:o,rows:c,marginx:u,marginy:f},children:o>=10&&c>=10&&we.jsx("group",{"scale-x":-1,"rotation-z":Math.PI,children:we.jsxs("group",{position:[t*-.5+u,r*-.5+f,0],children:[we.jsx("group",{position:[d,0,0],children:n}),s&&we.jsx("group",{position:[0,g,1],children:we.jsx(Ndt,{width:p,height:_},p*_)})]})})})}const eS=it.createContext({sendmessage(){},sendclose(){},didclose(){}}),Sie={input:{color:"$white",active:"$yellow"}};function Xm(n){return n?Sie.input.active:Sie.input.color}function DV(n,e){return`vm:${n}:${e}`}function s2(n,e,t=0,r=""){return`${n.substring(0,e)}${r}${n.substring(e+t)}`}function Km(n,e,t){xe(e)&&(t.x=n?1:0,t.y=e,t.disablewrap=!0)}const Zb=32,_ve=8,K9=new ut;function Ddt(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(K9.x/n),r=Math.floor(K9.y/e);return{x:Zb*.5+t,y:_ve*.5+r}}function Ldt({sidebar:n,chip:e,row:t,label:r,args:i,context:s}){Km(n,t,s);const[a]=[Fp(i[0],"")],o=V1(e,a),c=CO(o)??0,u=Wg(),[f,d]=it.useState(!1);it.useLayoutEffect(()=>{d(!0)},[]);const g=`${c}`.padStart(3,"0"),p=r.trim(),_=s.x-1,y=s.y+2,v=[`$green${p} ${g}
$white`];for(let V=0;V<256;++V)if(V%Zb===0&&v.push(`
`),V===c){const G=u?"$green$onwhite":"$white$ongreen";v.push(`${G}$${V}$white$ondkblue`)}else v.push(`$${V}`);const x=v.join("");ci(x,s,!0);const E=it.useContext(eS),M=it.useCallback(()=>{c>=Zb&&Np(o,c-Zb)},[o,c]),O=it.useCallback(()=>{c>0&&Np(o,c-1)},[o,c]),N=it.useCallback(()=>{c<255&&Np(o,c+1)},[o,c]),I=it.useCallback(()=>{c<=255-Zb&&Np(o,c+Zb)},[o,c]),D=it.useCallback(()=>{E.sendclose()},[E]);return we.jsx("group",{position:[_*Gn.DRAW_CHAR_WIDTH(),y*Gn.DRAW_CHAR_HEIGHT(),1],children:f&&we.jsxs(J1,{blockhotkeys:!0,children:[we.jsx(x_,{blocking:!0,visible:!1,width:Zb,height:_ve,onClick:V=>{V.intersections[0].object.worldToLocal(K9.copy(V.intersections[0].point));const G=gf(Ddt(),Zb);G>=0&&G<=255&&(Np(o,G),E.sendclose())}}),we.jsx(Vc,{MOVE_LEFT:O,MOVE_UP:M,MOVE_RIGHT:N,MOVE_DOWN:I,OK_BUTTON:D,CANCEL_BUTTON:D})]})})}const cT=8,vve=2,Z9=new ut;function Udt(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(Z9.x/n),r=Math.floor(Z9.y/e);return{x:cT*.5+t,y:vve*.5+r}}function Bdt(n){switch(n){case"dkyellow":return", brown";case"ltgray":return", ltgrey, gray, grey";case"dkgray":return", dkgrey, ltblack";case"ondkyellow":return", onbrown";case"onltgray":return", onltgrey, ongray, ongrey";case"ondkgray":return", ondkgrey, onltblack";case"bldkyellow":return", blbrown";case"blltgray":return", blltgrey, blgray, blgrey";case"bldkgray":return", bldkgrey, blltblack"}return""}const Fdt=[...ew(0,15),...ew(33,48)],zdt=[...ew(0,15),32];function Eie({sidebar:n,chip:e,row:t,label:r,args:i,context:s,isbg:a=!1}){Km(n,t,s);const[o]=[Fp(i[0],"")],l=V1(e,o),u=CO(l)??0,f=Wg(),[d,g]=it.useState(!1);it.useLayoutEffect(()=>{g(!0)},[]);const p=a?zdt:Fdt,_=p.indexOf(u),y=`${u}`.padStart(2,"0"),v=r.trim(),x=(Sn[u]||Sn[Sn.BLACK]).toLowerCase(),E=Bdt(x).padEnd(32," "),M=s.x-1,O=s.y+2,N=[`$green${v} ${y} ${x}${E}
$white`];for(let U=0;U<p.length;++U){U%cT===0&&N.push(`
`);const J=p[U],W=(Sn[J]||Sn[Sn.BLACK]).toLowerCase();if(J===u)if(f){const q=U%16<8?"white":"black";N.push(J>32?"$onwhite$219":`$${q}$219`)}else N.push(`$onblack$${W}$219`);else N.push(`$onblack$${W}$219`)}N.push("$white"),ci(N.join(""),s,!0);const I=it.useContext(eS),D=it.useCallback(U=>{const J=p[Di(U,0,p.length-1)];Np(l,J)},[p,l]),V=it.useCallback(()=>{D(_-cT)},[D,_]),G=it.useCallback(()=>{D(_-1)},[D,_]),Q=it.useCallback(()=>{D(_+1)},[D,_]),B=it.useCallback(()=>{D(_+cT)},[D,_]),$=it.useCallback(()=>{I.sendclose()},[I]);return we.jsx("group",{position:[M*Gn.DRAW_CHAR_WIDTH(),O*Gn.DRAW_CHAR_HEIGHT(),1],children:d&&we.jsxs(J1,{blockhotkeys:!0,children:[we.jsx(x_,{blocking:!0,visible:!1,width:cT,height:vve,onClick:U=>{U.intersections[0].object.worldToLocal(Z9.copy(U.intersections[0].point));const J=Udt(),W=gf(J,cT);W>=0&&W<=16&&(Np(l,W),I.sendclose())}}),we.jsx(Vc,{MOVE_LEFT:G,MOVE_UP:V,MOVE_RIGHT:Q,MOVE_DOWN:B,OK_BUTTON:$,CANCEL_BUTTON:$})]})})}function jdt({sidebar:n,item:e,row:t,context:r}){Km(n,t,r);const i=W0(r),s=$H(e);if(xe(s)){const a=i.width-3,l=W1(s,a,3)?.measuredwidth??1,c=Di(Math.floor(a*.5-l*.5),0,a);ci(`${" ".repeat(c)}$WHITE${s}${xe(t)?`
`:""}`,r,!0)}else ci(`${e}${xe(t)?`
`:""}`,r,!0);return null}function Hdt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const a=it.useContext(eS),o=it.useCallback(()=>{if(xe(Qo())){const c=[Fp(i[0],""),i[1]],[,...u]=c,f=u.join(" ");Qo().writeText(f).then(()=>{rle(xt,ss(),`copied! ${f}`),a.sendclose()}).catch(d=>console.error(d))}},[i,a]),l=Xm(!!t);return Km(n,e,s),ci(`  $purple$16 $yellowCOPYIT ${l}${r}`,s,!0),t&&we.jsx(Vc,{OK_BUTTON:o})}function qdt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const[o,l,c,u]=[Fp(s[0],""),Fp(s[1],""),Fp(s[2],""),Fp(s[3],"")],f=c||` ${l.toUpperCase()} `,d=Xm(r),g=a.x-.25,p=a.y-.25,_=`${a.iseven?"$black$onltgray":"$black$ondkcyan"}${f}${d}$onclear ${i}${xe(t)?`
`:""}`;ci(_,a,!0);const y=it.useContext(eS),v=it.useCallback(()=>{y.sendmessage(DV(e,o),[]),u||y.sendclose()},[e,y,o,u]);return we.jsxs("group",{position:[g*Gn.DRAW_CHAR_WIDTH(),p*Gn.DRAW_CHAR_HEIGHT(),1],children:[we.jsx(x_,{visible:!1,width:f.length+.5,height:1.5,blocking:!0,onClick:v}),r&&we.jsx(Vc,{OK_BUTTON:v}),l&&we.jsx(PT,{hotkey:l,children:v})]})}function Vdt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const o=s.map(g=>Fp(g,"")),[l,...c]=o,u=Xm(r);ci(`  $purple$16 ${u}${i}
`,a,!0);const f=it.useContext(eS),d=it.useCallback(()=>{f.sendmessage(DV(e,l),c),f.sendclose()},[f,e,l,c]);return r&&we.jsx(Vc,{OK_BUTTON:d})}const bN=-111111;function Gdt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const[o,l,c]=[Fp(s[0],""),vd(s[1],bN),vd(s[2],bN)];let u,f;l===bN?(u=0,f=31):c===bN?(u=0,f=l):(u=l,f=c);const d=V1(e,o),g=CO(d),p=g??0,_=Wg(),[y,v]=it.useState(""),[x,E]=it.useState(0),[M,O]=it.useState(!1);let N=`${p}`;const I=i.trim(),D=Xm(r);M&&(N=_?s2(y,x,1,"$219+"):y),a.writefullwidth=32,ci(` # ${D}${I} $green${N}`,a,!1),a.writefullwidth=void 0;const V=it.useCallback(B=>{const $=B.alt?10:1;Np(d,Math.min(f,p+$))},[f,p,d]),G=it.useCallback(B=>{const $=B.alt?10:1;Np(d,Math.max(u,p-$))},[u,p,d]),Q=it.useCallback(()=>{O(B=>{const $=!B;if($){const U=`${g}`;v(U),E(U.length)}else{const U=parseFloat(y),J=isNaN(U)?0:U;Np(o,Math.min(f,Math.max(u,J)))}return $})},[f,u,y,o,g]);return g!==void 0&&we.jsxs(we.Fragment,{children:[r&&!M&&we.jsx(Vc,{MOVE_LEFT:G,MOVE_RIGHT:V,OK_BUTTON:Q}),M&&we.jsxs(J1,{blockhotkeys:!0,children:[we.jsx(PT,{hotkey:"ctrl+c",children:()=>{console.info("copy")}}),we.jsx(PT,{hotkey:"ctrl+v",children:()=>{console.info("paste")}}),we.jsx(PT,{hotkey:"ctrl+a",children:()=>{console.info("select all")}}),we.jsx(Vc,{MOVE_LEFT:()=>{E(B=>Math.max(0,B-1))},MOVE_RIGHT:()=>{E(B=>Math.min(y.length,B+1))},CANCEL_BUTTON:Q,OK_BUTTON:Q,keydown:B=>{switch(qr(B.key)){case"delete":y.length>0&&v($=>s2($,x,1));break;case"backspace":x>0&&(v($=>s2($,x-1,1)),E($=>Math.max(0,$-1)));break}B.key.length===1&&y.length<a.width*.5&&(v($=>s2($,x,0,B.key)),E($=>$+1))}})]})]})}function $dt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const a=it.useCallback(()=>{const[,l,...c]=i,u=c.join(" "),f=ss();switch(l){case"wiki":Fc(xt,f,async()=>{const d=await Cj(u);Hj(f,d)});break;case"inline":window.location.href=u;break;default:window.open(`${l} ${u}`.trim(),"_blank");break}},[i]),o=Xm(!!t);return Km(n,e,s),ci(`  $purple$16 $yellowOPENIT ${o}${r}`,s,!0),t&&we.jsx(Vc,{OK_BUTTON:a})}function Wdt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const[o,l,c]=[Fp(s[0],""),Fp(s[1],""),Fp(s[2],"")];let u,f;l===""?(u="L ",f=" H"):c===""?(u="L ",f=` ${l}`):(u=`${l} `,f=` ${c}`);const d=0,g=8,p=V1(e,o),y=CO(p)??0,v=Wg(),x=i.trim(),E=Xm(r);ci(`$red $29 ${E}${x} `,a,!1);const O=s2("----:----",y,1,`$green${r?v?"$26":"$27":"$4"}${E}`).replaceAll("-","$7").replaceAll(":","$9");ci(`${E}${u}${O}${f} $green${y+1}`,a,!1);const N=it.useCallback(D=>{const V=D.alt?10:1;Np(p,Math.min(g,y+V))},[g,y,p]),I=it.useCallback(D=>{const V=D.alt?10:1;Np(p,Math.max(d,y-V))},[d,y,p]);return we.jsx(we.Fragment,{children:r&&we.jsx(Vc,{MOVE_LEFT:I,MOVE_RIGHT:N})})}function Ydt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const[o,...l]=[Fp(s[0],""),...s.slice(1)],c=[],u=[];for(let O=0;O<l.length;O+=2)c.push(l[O]),u.push(l[O+1]);const f=V1(e,o),g=`${CO(f)??0}`;let p=u.indexOf(g);p<0&&(p=0);const _=Wg(),y=i.trim(),v=Xm(r);ci(`$dkred ? ${v}${y} `,a,!1);const x=r?_?"$26":"$27":"/";ci(`${p+1}$green${x}${v}${u.length}`,a,!1),a.writefullwidth=32,ci(` $green${c[p]}`,a,!1),a.writefullwidth=void 0;const E=it.useCallback(()=>{const O=Math.min(0,p-1),N=parseFloat(u[O]);Number.isInteger(N)&&Np(f,N)},[p,f]),M=it.useCallback(()=>{const O=Math.max(u.length-1,p+1),N=parseFloat(u[O]);Number.isInteger(N)&&Np(f,N)},[p,f]);return we.jsx(we.Fragment,{children:r&&we.jsx(Vc,{MOVE_LEFT:E,MOVE_RIGHT:M})})}function Xdt({sidebar:n,chip:e,row:t,active:r,label:i,args:s,context:a}){Km(n,t,a);const o=Fp(s[0],""),l=V1(e,o),c=Ume(l),u=c?.toJSON()??"",f=Wg(),[d,g]=it.useState(0),[p,_]=it.useState(!1),[y,v]=it.useState(void 0),x=`${u} `,E=i.trim(),M=Xm(r);ci(`$green $20 ${M}${E} $green`,a,!1);const O=a.x,I=a.y*a.width;a.writefullwidth=32,ci(`${x}`,a,!1),a.writefullwidth=void 0;const D=xe(y),V=a.width-O-2,G=D?Math.min(y,d):d;let Q=D?Math.max(y,d):d;D&&(Q!==G&&Q===d&&--Q,fw(O+G+I,O+Q+I,15,8,a)),p&&f&&_U(O+d+I,"",a);function B(){xe(c)&&(g(G),v(void 0),c.delete(G,Q-G+1))}return we.jsxs(we.Fragment,{children:[r&&we.jsx(Vc,{OK_BUTTON:()=>{c&&(_(!0),g(c.length),v(void 0))}}),p&&we.jsx(J1,{blockhotkeys:!0,children:we.jsx(Vc,{MOVE_LEFT:$=>{$.shift?xe(y)||v(Di(d-1,0,u.length)):v(void 0),g(U=>Di(U-1,0,u.length))},MOVE_RIGHT:$=>{$.shift?xe(y)||v(d):v(void 0),g(U=>Di(U+1,0,u.length))},CANCEL_BUTTON:()=>{_(!1),g(u.length),v(void 0)},OK_BUTTON:()=>_(!1),keydown:$=>{if(!c)return;const{key:U}=$,J=qr(U),W={alt:$.altKey,ctrl:P1?$.metaKey:$.ctrlKey,shift:$.shiftKey},q=c.toJSON();switch(J){case"delete":D?B():q.length>0&&c.delete(d,1);break;case"backspace":D?B():d>0&&(c.delete(d-1,1),g(Y=>Math.max(0,Y-1)));break;default:if(W.ctrl)switch(J){case"a":v(0),g(q.length);break;case"c":xe(Qo())&&Qo().writeText(c.toJSON()).catch(Y=>console.error(Y));break;case"v":xe(Qo())&&Qo().readText().then(Y=>{D&&B(),c.insert(d,Y),g(d+Y.length)}).catch(Y=>console.error(Y));break;case"x":xe(Qo())&&Qo().writeText(c.toJSON()).then(()=>B()).catch(Y=>console.error(Y));break}else W.alt||$.key.length===1&&q.length<V&&(c.insert(d,$.key),g(Y=>Y+1));break}}})})]})}function Kdt({sidebar:n,row:e,active:t,label:r,args:i,context:s}){const{setviewimage:a}=qc(),o=it.useCallback(()=>{const[,...c]=i,u=c.join(" ");a(u)},[a,i]),l=Xm(!!t);return Km(n,e,s),ci(`  $purple$16 $cyanVIEWIT ${l}${r}`,s,!0),t&&we.jsx(Vc,{OK_BUTTON:o})}function Zdt({chip:n,row:e,active:t,label:r,args:i,context:s}){Km(!1,e,s);const[a]=[Fp(i[0],"")],o="z",l=` ${o.toUpperCase()} `,c=Xm(t),u=s.x-.25,f=s.y-.25;ci(`${s.iseven?"$black$onltgray":"$black$ondkcyan"}${l}${c}$onclear ${r}${xe(e)?`
`:""}`,s,!0);const d=it.useContext(eS),g=it.useCallback(()=>{d.sendmessage(DV(n,a),[])},[d,n,a]);return we.jsxs("group",{position:[u*Gn.DRAW_CHAR_WIDTH(),f*Gn.DRAW_CHAR_HEIGHT(),1],children:[we.jsx(x_,{visible:!1,width:l.length+.5,height:1.5,blocking:!0,onClick:g}),t&&we.jsx(Vc,{OK_BUTTON:g}),we.jsx(PT,{hotkey:o,children:g})]})}function Qdt({sidebar:n,row:e,item:t,active:r}){const i=ss(),s=Fh();if(Km(n,e,s),s.iseven=s.y%2===0,typeof t=="string")return we.jsx(jdt,{sidebar:n,player:i,item:t,row:e,context:s});if(bi(t)){const[a,o,l,c,...u]=t;if(typeof a!="string"||typeof o!="string"||typeof l!="string")return null;const f={sidebar:n,player:i,chip:a,row:e,active:r,label:o,args:[l,...u],context:s},d=Vn(c)?c:"";switch(qr(d)){default:case"hyperlink":return we.jsx(Vdt,{...f});case"hk":case"hotkey":return we.jsx(qdt,{...f});case"rn":case"range":return we.jsx(Wdt,{...f});case"sl":case"select":return we.jsx(Ydt,{...f});case"nm":case"number":return we.jsx(Gdt,{...f});case"tx":case"text":return we.jsx(Xdt,{...f});case"copyit":return we.jsx(Hdt,{...f});case"openit":return we.jsx($dt,{...f});case"viewit":return we.jsx(Kdt,{...f});case"zssedit":return we.jsx(Zdt,{...f});case"charedit":return we.jsx(Ldt,{...f});case"coloredit":return we.jsx(Eie,{...f});case"bgedit":return we.jsx(Eie,{isbg:!0,...f})}}return null}function yve({inline:n=!1,xmargin:e=1,ymargin:t=1,selected:r=-1,width:i,height:s,color:a,bg:o,text:l}){const c=Zw(i,s,0,a,o),u=c.getState(),f={...yb(i,s,a,o,t,e,i-e,s-t),...c.getState(),x:e,y:t};return MU(u,0,a,o),we.jsxs(lR,{store:c,children:[we.jsx(cR,{width:i,height:s}),we.jsx(kO.Provider,{value:f,children:l.map((d,g)=>we.jsx(Qdt,{row:n?void 0:g,item:d,active:g===r,sidebar:e!==0},g))})]})}const Jdt=n=>{const e="nativeEvent"in n?n.nativeEvent:n;return{deltaX:e.deltaX||0,deltaY:e.deltaY||0,deltaZ:e.deltaZ||0,timeStamp:e.timeStamp}},ept=n=>[n.deltaX,n.deltaY,n.deltaZ],SN=n=>{const e=ept(n).map(Math.abs);return Math.max(...e)};var r1;(function(n){n.ALL_OTHER_CHECKS_FAILED="ALL_OTHER_CHECKS_FAILED",n.NO_PREVIOUS_EVENT_TO_COMPARE="NO_PREVIOUS_EVENT_TO_COMPARE",n.PAST_TIMESTAMP_EVENT="PAST_TIMESTAMP_EVENT",n.ENOUGH_TIME_PASSED="ENOUGH_TIME_PASSED",n.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN="NON_DECREASING_DELTAS_OF_KNOWN_HUMAN",n.DELTA_MODULE_HAS_BEEN_INCREASING="DELTA_MODULE_HAS_BEEN_INCREASING"})(r1||(r1={}));class tpt{sensitivity;delay;increasingDeltasThreshold;previousEvents;constructor({sensitivity:e=2,delay:t=100,increasingDeltasThreshold:r=3}={}){this.sensitivity=Math.max(1,e),this.delay=Math.max(1,t),this.increasingDeltasThreshold=Math.max(2,r),this.previousEvents=[]}check(e){if(!(("nativeEvent"in e?e.nativeEvent:e)instanceof Event))throw new Error(`"${e}" is not a valid event`);const r=Jdt(e);if(SN(r)<this.sensitivity)return!1;const{isHuman:i}=this.isHuman(r);return i?this.previousEvents=[r]:r.timeStamp>(this.previousEvents.at(-1)?.timeStamp||0)&&this.previousEvents.push(r),i}isHuman(e){const t=this.previousEvents.at(-1);if(!t)return{isHuman:!0,reason:r1.NO_PREVIOUS_EVENT_TO_COMPARE};if(e.timeStamp<t.timeStamp)return{isHuman:!1,reason:r1.PAST_TIMESTAMP_EVENT};if(e.timeStamp>t.timeStamp+this.delay)return{isHuman:!0,reason:r1.ENOUGH_TIME_PASSED};const s=SN(e),a=SN(t);if(s>=a){if(this.previousEvents.length===1)return{isHuman:!0,reason:r1.NON_DECREASING_DELTAS_OF_KNOWN_HUMAN};if(this.increasingDeltasThreshold<=2||this.previousEvents.length>=this.increasingDeltasThreshold&&this.previousEvents.slice(-this.increasingDeltasThreshold).map(SN).every((u,f,d)=>f===0||u>d[f-1]))return{isHuman:!0,reason:r1.DELTA_MODULE_HAS_BEEN_INCREASING}}return{isHuman:!1,reason:r1.ALL_OTHER_CHECKS_FAILED}}}const npt=new tpt({sensitivity:P1?7:2}),xie=4,rpt=.75;function ipt(n){const e=Di(n,-xie,xie);return Math.round(e*rpt)}function LV({debug:n=!1,disabled:e=!1,blocking:t=!0,cursor:r="pointer",x:i=0,y:s=0,width:a=30,height:o=10,children:l,onScroll:c,...u}){return we.jsxs("group",{...u,children:[we.jsx(x_,{blocking:t,cursor:r,visible:n,x:i,y:s,width:a,height:o,onWheel:f=>{e||!npt.check(f)||c?.(ipt(f.deltaY))}}),l]})}const spt=2,apt=14,bve=apt*spt;function opt(n){return Qoe(n,bve*.5)}function lpt(n,e,t,r,i=1.235){function s(o){return Out(o,r)}U0(n.userData,e,t,i,r,bve*12,s),n.position[e]=opt(n.userData[e]);const a=t-n.position.y;return Math.abs(a)<.1}function cpt({name:n,width:e,height:t,context:r}){const i=Tge();for(let l=1;l<e-1;++l)l>2&&l<e-1&&Hu(i,e,t,l,1,{char:205,color:15}),Hu(i,e,t,l,t-1,{char:205,color:15});Hu(i,e,t,e-2,0,{char:196,color:15}),Hu(i,e,t,1,0,{char:205,color:15}),Hu(i,e,t,2,0,{char:187,color:15}),Hu(i,e,t,2,1,{char:200,color:15});for(let l=1;l<t-1;++l)Hu(i,e,t,0,l,{char:179,color:15}),Hu(i,e,t,e-1,l,{char:179,color:15});for(let l=2;l<t-1;++l)Hu(i,e,t,1,l,{char:0,color:15}),Hu(i,e,t,e-2,l,{char:0,color:15});Hu(i,e,t,0,0,{char:213,color:15}),Hu(i,e,t,e-1,0,{char:191,color:15}),Hu(i,e,t,e-1,1,{char:181,color:15}),Hu(i,e,t,0,t-1,{char:212,color:15}),Hu(i,e,t,e-1,t-1,{char:190,color:15});const s=` ${n} `,o=W1(s,e,t)?.x??s.length;return r.x=Math.round(e*.5),r.x-=Math.round(o*.5),r.y++,ci(s,r,!0),null}function upt({store:n,children:e}){return we.jsx(Ege.Provider,{value:n,children:e})}function fpt({width:n,height:e}){const t=it.useContext(Ege),[r]=bq(t,wd(i=>[i.dither,i.render]));return n>0&&e>0&&we.jsx(tb,{alphas:r.slice(),width:n,height:e})}function Tie({x:n,y:e,color:t,on:r=232,off:i=7,alt:s}){const a=Wg(),o=Tge(),l=it.useRef(0),c=xe(s)?l.current%2===0?r:s:r;return Hu(o,o.width,o.height,n,e,{char:a?c:i,color:t}),o.changed(),a&&++l.current,null}function hpt({row:n,width:e,height:t,panelwidth:r,panelheight:i,children:s}){const a=bet(r,i,0),o=[.001,.05,.1,.2],l=.4,{dither:c}=a.getState();yet(c);for(let u=0;u<r;++u){j8(c,r,i,u,n,l);for(let f=0;f<o.length;++f){const d=o.length-f;j8(c,r,i,u,n-d,o[f]),j8(c,r,i,u,n+d,o[f])}}return we.jsxs(we.Fragment,{children:[we.jsx(cR,{width:e,height:t}),we.jsxs("group",{position:[2*Gn.DRAW_CHAR_WIDTH(),2*Gn.DRAW_CHAR_HEIGHT(),0],children:[we.jsx(upt,{store:a,children:we.jsx(fpt,{width:r,height:i})}),s,we.jsx(Tie,{x:1,y:1}),we.jsx(Tie,{x:1,y:2+n,on:26,alt:27,off:45,color:12})]})]})}function UV({line:n,color:e,margin:t,y:r,leftedge:i,rightedge:s,context:a}){const o=Wg(),c=`$${(Sn[e]??"").toLowerCase()} ${n.replaceAll(`
`,"").trim()} --=--`,f=W1(c,1e4,1)?.measuredwidth??1,[d,g]=it.useState(0);it.useEffect(()=>{g(p=>o?p:(p-1)%f)},[o,f]),a.disablewrap=!0,a.active.leftedge=t,a.active.rightedge=s-t;for(let p=i+t+d;p<=s;p+=f)a.x=p,a.y=r,ci(c,a,!1);return a.active.leftedge=0,a.active.rightedge=s,a.disablewrap=!1,null}function dpt({width:n,height:e,color:t,bg:r,text:i,shouldclose:s}){const{viewport:a}=Im(),o=n-3,l=e-3,c=Zw(n,e,0,t,r),u=it.useContext(eS),f=i.length-1,d=Ts(D=>D.gadget.scrollname??""),g={...yb(n,e,t,r,0,0,n,e),...c.getState()},[p,_]=it.useState(()=>{const D=i.findIndex(V=>bi(V));return D>=0&&D<=8?D:0});let y=p-Math.floor(l*.5);y=Math.min(i.length-l,y),y=Math.max(0,y);const v=i.slice(y,y+l),x=p-y,E=it.useRef(null),M=it.useCallback(()=>{s&&u.didclose()},[s,u]),O=it.useCallback(D=>{const V=D.ctrl?f:D.alt?10:1;_(G=>Math.max(0,G-V))},[_,f]),N=it.useCallback(D=>{const V=D.ctrl?f:D.alt?10:1;_(G=>Math.min(f,G+V))},[_,f]),I=it.useCallback(D=>{_(V=>Di(Math.round(V+D),0,f))},[_,f]);return it.useEffect(()=>{if(E.current&&!s){const D=a.height;E.current.position.y=D,E.current.userData.y=D,E.current.userData.vy=0}},[s]),Gg(it.useCallback((D,V)=>{if(xe(E.current)){const G=s?e*2*-Gn.DRAW_CHAR_HEIGHT():0;lpt(E.current,"y",G,V)&&M()}},[s,M,e])),we.jsxs("group",{ref:E,"position-y":1e6,children:[we.jsx(LV,{blocking:!0,x:0,y:0,width:n,height:e,onScroll:D=>I(D*.5)}),we.jsxs(J1,{children:[we.jsx(Vc,{MOVE_UP:O,MOVE_DOWN:N,CANCEL_BUTTON:u.sendclose}),we.jsxs(lR,{store:c,children:[we.jsx(cpt,{name:d,width:n,height:e,context:g}),we.jsx(UV,{margin:3,color:Sn.BLUE,y:0,leftedge:0,rightedge:n,line:`
   up/down$white.SCROLL UP/DOWN   $blue
esc/cancel$white.CLOSE SCROLL   $blue
alt+up/down$white.JUMP 10 LINES   $blue
`,context:g}),we.jsx(hpt,{row:x,width:n,height:e,panelwidth:o,panelheight:l,children:we.jsx(yve,{width:o,height:l,xmargin:0,ymargin:0,color:t,bg:Sn.ONCLEAR,text:v,selected:x})})]})]})]})}const NL=new ut;function wie(){const n=Gn.DRAW_CHAR_WIDTH(),e=Gn.DRAW_CHAR_HEIGHT(),t=Math.floor(NL.x/n),r=Math.floor((NL.y+e*.5)/e);return{x:t,y:Ti*.5+r}}function ppt(){const n=ao(u=>u.inspector),[e,t]=FS(wd(u=>[u.cursor,u.select])),r=iw(e??0,Yn),i=iw(t??e??0,Yn),s={x:Math.min(r.x,i.x),y:Math.min(r.y,i.y)},a={x:Math.max(r.x,i.x),y:Math.max(r.y,i.y)},o=a.x-s.x+1,l=a.y-s.y+1;function c(){Mn(FS.getState().cursor)&&xOe(xt,ss(),s,a),FS.setState(()=>({cursor:void 0,select:void 0}))}return we.jsxs(we.Fragment,{children:[n?we.jsx(x_,{visible:!0,opacity:0,color:"black",x:0,y:0,z:-1,width:Yn,height:Ti,cursor:"pointer",onPointerDown:u=>{u.intersections[0].object.worldToLocal(NL.copy(u.intersections[0].point));const f=wie();FS.setState(()=>({cursor:gf(f,Yn)}))},onPointerMove:u=>{if(xe(FS.getState().cursor)){u.intersections[0].object.worldToLocal(NL.copy(u.intersections[0].point));const f=wie();FS.setState(()=>({select:gf(f,Yn)}))}},onPointerUp:c,onPointerOut:c,onPointerCancel:c}):we.jsx(x_,{visible:!0,opacity:0,color:"blue",x:0,y:0,z:-1,width:Yn,height:Ti}),xe(e)&&we.jsxs(we.Fragment,{children:[we.jsx(x_,{x:s.x+.25,y:s.y+.25,z:100,width:o-.5,height:l-.5,color:"black",opacity:.3}),we.jsx(x_,{x:s.x,y:s.y,z:101,width:o,height:l,color:"white",opacity:.25})]})]})}const mpt=D4,gpt=nw(QE(qw)),Rie=mv(JE(Hw)),_pt=new jl({transparent:!1,side:$f,uniforms:{time:wg,interval:QO,smoothrate:new jn(mpt),palette:new jn(gpt),map:new jn(Rie),alt:new jn(Rie),dpr:new jn(1),screenwidth:new jn(1),screenheight:new jn(1),pointSize:{value:new an(1,1)},rows:new jn(1),step:new jn(new an),size:new jn(new an),pixel:new jn(new an),flip:new jn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float screenwidth;
    uniform float screenheight;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    ${i3}

    float PI = radians(180.0);

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec3 colorFromIndex(float index) {
      return palette[int(index)];
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = colorFromIndex(index);
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vCharData.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      int sourceColori = int(lastColor.x);
      int destColori = int(charData.z);

      vec3 sourceColor;
      if (sourceColori > 32) {
        sourceColor = palette[sourceColori - 33];
      } else {
        sourceColor = palette[sourceColori % 16];
      }

      vec3 destColor;
      if (destColori > 32) {
        destColor = palette[destColori - 33];
      } else {
        destColor = palette[destColori % 16];
      }

      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      if (destColori > 31) {
        vColor = mix(vBg.rgb, vColor, cyclefromtime());
      }

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x -= 1.0;

      // model space
      vec4 mvPosition = vec4(animPosition, 0.0, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif
      mvPosition = modelViewMatrix * mvPosition;
  
      // transform to screenspace 
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      float fov = 2.0 * atan(1.0 / projectionMatrix[1][1]) * 180.0 / PI;
      float heightOfNearPlane = screenheight / (2.0 * tan(0.5 * fov * PI / 180.0));
      gl_PointSize = (heightOfNearPlane * pointSize.y) / gl_Position.w;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 size;
    uniform vec2 pixel;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }
      
      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }

      vec2 idx = vec2(px, py) * size * pixel;
      vec2 lookup = vec2(vCharData.x, rows - vCharData.y) * step * pixel;
      vec2 uv = lookup + idx + vec2(1.0, 1.0) * pixel;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function vpt(){return JO(_pt)}const ypt=D4,bpt=nw(QE(qw)),Aie=mv(JE(Hw)),Spt=new jl({transparent:!1,side:$f,uniforms:{time:wg,interval:QO,smoothrate:new jn(ypt),palette:new jn(bpt),map:new jn(Aie),alt:new jn(Aie),dpr:new jn(1),screenwidth:new jn(1),screenheight:new jn(1),pointSize:new jn(new an),rows:new jn(1),step:new jn(new an),size:new jn(new an),pixel:new jn(new an),flip:new jn(!0)},vertexShader:`
    attribute float visible;
    attribute vec4 charData;
    attribute vec3 lastPosition;
    attribute vec2 lastColor;
    attribute vec2 lastBg;
    attribute vec2 animShake;
    attribute vec2 animBounce;

    uniform float smoothrate;
    uniform float time;
    uniform float interval;
    uniform vec2 pointSize;
    uniform vec3 palette[16];
    uniform float dpr;
    uniform float tindex;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    ${i3}

    float rand(float co) {
      return fract(sin(co*(91.3458)) * 47453.5453);
    }

    vec4 bgFromIndex(float index) {
      vec4 bg;
      if (int(index) >= 16) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      }
      bg.rgb = palette[int(index)];
      bg.a = 1.0;
      return bg;
    }

    float animDelta(float startTime, float deltaMod, float maxDelta) {
      float delta = time - startTime;
      if (delta < 0.0) {
        return maxDelta;
      }
      return clamp(delta * deltaMod, 0.0, maxDelta);
    }

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(vCharData.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }

    void main() {
      vVisible = visible;

      float deltaPosition = clamp((time - lastPosition.z) * smoothrate, 0.0, 1.0);
      vec2 animPosition = mix(lastPosition.xy, position.xy, deltaPosition);

      float deltaShake = 1.0 - animDelta(animShake.y, smoothrate * 0.5, 1.0); 
      animPosition += vec2(
        deltaShake - rand(cos(time) + animShake.x) * deltaShake * 2.0,
        deltaShake - rand(sin(time) + animShake.x) * deltaShake * 2.0
      ) * 0.5;

      float deltaBounce = 1.0 - abs(1.0 - animDelta(animBounce.y, smoothrate, 2.0));
      animPosition.y -= smoothstep(0.0, 1.0, deltaBounce);

      float deltaColor = animDelta(lastColor.y, smoothrate, 1.0);
      int sourceColori = int(lastColor.x);
      int destColori = int(charData.z);

      vec3 sourceColor;
      if (sourceColori > 32) {
        sourceColor = palette[sourceColori - 33];
      } else {
        sourceColor = palette[sourceColori % 16];
      }

      vec3 destColor;
      if (destColori > 32) {
        destColor = palette[destColori - 33];
      } else {
        destColor = palette[destColori % 16];
      }

      vColor = mix(sourceColor, destColor, deltaColor);

      float deltaBg = animDelta(lastBg.y, smoothrate, 1.0);
      vec4 sourceBg = bgFromIndex(lastBg.x);
      vec4 destBg = bgFromIndex(charData.w);
      vBg = mix(sourceBg, destBg, deltaBg);

      if (destColori > 31) {
        vColor = mix(vBg.rgb, vColor, cyclefromtime());
      }

      vCharData.xy = charData.xy;

      animPosition *= pointSize;
      animPosition += pointSize * 0.5;
      animPosition.x -= 1.0;

      vec4 mvPosition = vec4(animPosition, 0.0, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;

      // this handles things being scaled
      gl_PointSize = pointSize.y * modelViewMatrix[0][0] * dpr;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform float rows;
    uniform vec2 step;
    uniform vec2 size;
    uniform vec2 pixel;
    uniform vec2 pointSize;
    uniform bool flip;

    varying float vVisible;
    varying vec2 vCharData;
    varying vec3 vColor;
    varying vec4 vBg;

    void main() {
      float xscale = pointSize.y / pointSize.x;
      float xpadding = (pointSize.y - pointSize.x) / pointSize.y;
      float px = gl_PointCoord.x * xscale - xpadding;      
      if (vVisible == 0.0 || px < 0.0 || px > 1.0) {
        discard;
      }
      float py = gl_PointCoord.y;
      if (flip) {
        py = 1.0 - py;
      }

      vec2 idx = vec2(px, py) * size * pixel;
      vec2 lookup = vec2(vCharData.x, rows - vCharData.y) * step * pixel;
      vec2 uv = lookup + idx + vec2(1.0, 1.0) * pixel;

      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture2D(alt, uv).rgb : texture2D(map, uv).rgb;

      if (blip.r == 0.0) {
        if (vBg.a < 0.001) {
          discard;
        } else {
          gl_FragColor = vBg;
        }
      } else {
        gl_FragColor.rgb = vColor;
        gl_FragColor.a = 1.0;
      }
    }
  `});function Ept(){return JO(Spt)}const Cie=2048;function xpt({sprites:n}){const e=it.useRef(null),t=it.useRef([]);return it.useMemo(()=>{t.current.length===0&&(t.current=Array.from({length:Cie},()=>({id:"",x:0,y:0,char:0,color:0,bg:0,stat:0})));const r={};for(let a=0;a<n.length;++a)r[n[a].id]=n[a];const i=new Set(t.current.map(a=>a.id));let s=0;for(let a=0;a<Cie;++a)if(t.current[a].id){const o=r[t.current[a].id];xe(o)?t.current[a]={...o}:t.current[a].id=""}else if(s<n.length){for(;i.has(n[s]?.id)===!0;)++s;s<n.length&&(t.current[a]={...n[s++]})}},[n]),it.useEffect(()=>{const{current:r}=e,{current:i}=t;if(!r||!i)return;let s=r.getAttribute("visible"),a=r.getAttribute("lastVisible"),o=r.getAttribute("position"),l=r.getAttribute("charData"),c=r.getAttribute("lastPosition"),u=r.getAttribute("lastColor"),f=r.getAttribute("lastBg"),d=r.getAttribute("animShake"),g=r.getAttribute("animBounce");if(!s||s.count!==i.length){s=new Ps(new Float32Array(i.length),1),a=new Ps(new Float32Array(i.length),1),o=new Ps(new Float32Array(i.length*3),3),l=new Ps(new Float32Array(i.length*4),4),c=new Ps(new Float32Array(i.length*3),3),u=new Ps(new Float32Array(i.length*2),2),f=new Ps(new Float32Array(i.length*2),2),d=new Ps(new Float32Array(i.length*2),2),g=new Ps(new Float32Array(i.length*2),2);for(let p=0;p<i.length;++p){const _=i[p],y=_.id?1:0;s.setX(p,y),a.setX(p,y),o.setXY(p,_.x,_.y),l.setXYZW(p,_.char%O0,Math.floor(_.char/O0),_.color,_.bg),c.setXYZ(p,_.x,_.y,wg.value),u.setXY(p,_.color,wg.value),f.setXY(p,_.bg,wg.value),d.setXY(p,0,wg.value-1e6),g.setXY(p,0,wg.value-1e6)}r.setAttribute("visible",s),r.setAttribute("lastVisible",a),r.setAttribute("position",o),r.setAttribute("charData",l),r.setAttribute("lastPosition",c),r.setAttribute("lastColor",u),r.setAttribute("lastBg",f),r.setAttribute("animShake",d),r.setAttribute("animBounce",g)}else for(let p=0;p<i.length;++p){const _=i[p],y=o.getX(p),v=o.getY(p),x=l.getX(p),E=l.getY(p),M=l.getZ(p),O=l.getW(p);a.setX(p,s.getX(p)),a.needsUpdate=!0,s.setX(p,_.id?1:0),s.needsUpdate=!0;const N=a.getX(p)===0&&s.getX(p)===1;(N||y!==_.x||v!==_.y)&&(c.setXYZ(p,N?_.x:y,N?_.y:v,wg.value),c.needsUpdate=!0,o.setXY(p,_.x,_.y),o.needsUpdate=!0),(N||M!==_.color)&&(u.setXY(p,N?_.color:M,wg.value),u.needsUpdate=!0,l.setZ(p,_.color),l.needsUpdate=!0),(N||O!==_.bg)&&(f.setXY(p,N?_.bg:O,wg.value),f.needsUpdate=!0,l.setW(p,_.bg),l.needsUpdate=!0);const I=_.char%O0,D=Math.floor(_.char/O0);(x!==I||E!==D)&&(l.setXY(p,I,D),l.needsUpdate=!0)}r.computeBoundingBox(),r.computeBoundingSphere()},[n]),we.jsx("bufferGeometry",{ref:e})}function Fk({sprites:n,scale:e=1,fliptexture:t=!0,withbillboards:r=!1}){const{viewport:i}=Im(),s=qc(f=>f.palettedata),a=qc(f=>f.spritecharsetdata),o=qc(f=>f.spritealtcharsetdata),l=it.useMemo(()=>r?vpt():Ept(),[r]),{width:c=0,height:u=0}=a?.image??{};return it.useEffect(()=>{if(!a)return;const f=Jd+2,d=ep+2,g=Math.round(u/d);l.uniforms.palette.value=s,l.uniforms.map.value=a,l.uniforms.alt.value=o??a,l.uniforms.dpr.value=e,l.uniforms.screenwidth.value=i.width,l.uniforms.screenheight.value=i.height,l.uniforms.rows.value=g-1,l.uniforms.step.value.x=f,l.uniforms.step.value.y=d,l.uniforms.size.value.x=Jd,l.uniforms.size.value.y=ep,l.uniforms.pixel.value.x=1/c,l.uniforms.pixel.value.y=1/u,l.uniforms.pointSize.value.x=Gn.DRAW_CHAR_WIDTH(),l.uniforms.pointSize.value.y=Gn.DRAW_CHAR_HEIGHT(),l.uniforms.flip.value=t,l.needsUpdate=!0},[s,a,o,l,c,u,t,i.width,i.height,e]),we.jsxs("points",{frustumCulled:!1,children:[we.jsx(xpt,{sprites:n}),we.jsx("primitive",{object:l,attach:"material"})]})}function nb({id:n,z:e,from:t}){const r=Ts(wd(i=>i.gadget[t]?.find(s=>s.id===n)));switch(r?.type){default:case oo.BLANK:case oo.MEDIA:return null;case oo.TILES:return we.jsx("group",{position:[0,0,e],children:we.jsx(Dv,{width:r.width,height:r.height,char:[...r.char],color:[...r.color],bg:[...r.bg]})},r.id);case oo.SPRITES:return we.jsx("group",{position:[0,0,e],children:we.jsx(Fk,{sprites:[...r.sprites],fliptexture:!1})},r.id);case oo.DITHER:return we.jsx("group",{position:[0,0,e],children:we.jsx(tb,{width:r.width,height:r.height,alphas:[...r.alphas]})},r.id)}}function n5({id:n,from:e}){const t=qc(),r=Ts(wd(s=>s.gadget[e]?.find(a=>a.id===n))),i=r?.type===oo.MEDIA?r:void 0;return it.useEffect(()=>{switch(i?.mime){case"image/palette":bi(i.media)&&t.setpalette(mB(tw,Jce,i.media));break;case"image/charset":bi(i.media)&&t.setcharset(mB(O0*Jd,L7*ep,i.media));break;case"image/altcharset":bi(i.media)&&t.setaltcharset(mB(O0*Jd,L7*ep,i.media));break;case"text/mood":Vn(i.media)&&t.setmood(i.media);break;case"text/players":Vn(i.media);break}},[t,i]),null}const Mie=n=>(n.getAttributes()&Lm.CONVOLUTION)===Lm.CONVOLUTION,Tpt=it.memo(it.forwardRef(({children:n,camera:e,width:t,height:r},i)=>{const{gl:s,scene:a}=Im(),[o]=it.useMemo(()=>{const u=new K_e(s,{depthBuffer:!0,stencilBuffer:!1,multisampling:0,frameBufferType:db});return u.autoRenderToScreen=!1,u.addPass(new Q_e(a,e)),[u]},[e,s,a]);Gg((u,f)=>{o.setSize(t,r),o.render(f)},1);const l=it.useRef(null);it.useLayoutEffect(()=>{const u=[],f=l.current.__r3f;if(f&&o){const d=f.children;for(let g=0;g<d.length;g++){const p=d[g].object;if(p instanceof L_){const _=[p];if(!Mie(p)){let v=null;for(;(v=d[g+1]?.object)instanceof L_&&!Mie(v);)_.push(v),g++}const y=new J_e(e,..._);u.push(y)}else p instanceof Ym&&u.push(p)}for(const g of u)o?.addPass(g)}return()=>{for(const d of u)o?.removePass(d)}},[o,n,e]);const c=it.useMemo(()=>({composer:o,normalPass:null,downSamplingPass:null,resolutionScale:void 0,camera:e,scene:a}),[o,e,a]);return it.useImperativeHandle(i,()=>o,[o]),we.jsx(CV.Provider,{value:c,children:we.jsx("group",{ref:l,children:n})})})),wpt=it.forwardRef(function({children:e,fbo:t,...r},i){const[s]=it.useState(()=>new VT);return it.useImperativeHandle(i,()=>t,[t]),we.jsxs(we.Fragment,{children:[O2e(we.jsxs(we.Fragment,{children:[e,we.jsx("group",{onPointerOver:()=>null})]}),s),we.jsx("primitive",{object:t.texture,...r})]})});function Rpt({fbo:n,effects:e}){const{mood:t}=qc(),[r]=it.useState(()=>new Y_e(n,!0));return it.useEffect(()=>()=>{r.dispose()},[r]),we.jsxs(we.Fragment,{children:[t.includes("dark")&&we.jsxs(it.Fragment,{children:[we.jsx(Rht,{delay:[10,120],duration:[.1,3],strength:[0,1],mode:l1.SPORADIC,active:!0,ratio:.5}),we.jsx(Aht,{opacity:.5,premultiply:!0,blendFunction:Es.DARKEN})]},"mood"),t.includes("bright")&&we.jsx(it.Fragment,{children:we.jsx(wht,{intensity:.111,mipmapBlur:!1,luminanceThreshold:.5,luminanceSmoothing:.001,kernelSize:n3.VERY_LARGE})},"mood"),e,we.jsx("primitive",{object:r,dispose:null})]})}function r5({camera:n,viewwidth:e,viewheight:t,effects:r,children:i}){const{mood:s}=qc(),{viewport:a}=Im(),o=V_e(e*a.dpr,t*a.dpr,{samples:0,stencilBuffer:!1,depthBuffer:!0,generateMipmaps:!1}),l=e*.5,c=t*.5;return we.jsx(we.Fragment,{children:we.jsxs("mesh",{position:[l,c,0],children:[we.jsx("planeGeometry",{args:[e,t]}),we.jsx("meshBasicMaterial",{transparent:!0,children:we.jsxs(wpt,{attach:"map",fbo:o,children:[i,we.jsx(Tpt,{camera:n,width:e,height:t,children:we.jsx(Rpt,{fbo:o,effects:r})},s)]})})]})})}function Apt({width:n,height:e}){const t=Rb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),[,u]=it.useState(!1);it.useLayoutEffect(()=>{u(!0)},[]),Gg((O,N)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current)return;const I=jw(Ts.getState().gadget.layers??[]);xe(s.current.userData.focusx)||(s.current.userData={focusx:I.focusx,focusy:I.focusy,tfocusx:I.focusx,tfocusy:I.focusy,facing:I.facing},o.current.scale.setScalar(I.viewscale));const D=Gn.DRAW_CHAR_WIDTH(),V=Gn.DRAW_CHAR_HEIGHT(),G=Yn*D,Q=Ti*V,B=.25;N1(o.current.scale,I.viewscale,B,N);const $=o.current.scale.x,U=s.current.userData.focusx+.5,J=s.current.userData.focusy+.5,W=U*D*$+G*-.5,q=J*V*$+Q*-.5;N1(a.current.position,[-W,-q,0],.05,N),r>G*$?s.current.userData.tfocusx=Yn*.5:s.current.userData.tfocusx=I.focusx,i>Q*$?s.current.userData.tfocusy=Ti*.5:s.current.userData.tfocusy=I.focusy,U0(s.current.userData,"focusx",s.current.userData.tfocusx,B),U0(s.current.userData,"focusy",s.current.userData.tfocusy,B),l.current.position.x=r*.5-G*.5+a.current.position.x,l.current.position.y=i*.5-Q*.5+a.current.position.y,c.current.scale.setScalar($),s.current.position.x=O.size.width*.5,s.current.position.y=O.size.height*.5,s.current.updateProjectionMatrix()}),Ts(O=>O.gadget.over?.length??0),Ts(O=>O.gadget.under?.length??0),Ts(O=>O.gadget.layers?.length??0);const{over:f=[],under:d=[],layers:g=[]}=Ts.getState().gadget,p=d.length===0,_=Gn.DRAW_CHAR_WIDTH(),y=Gn.DRAW_CHAR_HEIGHT(),v=Yn*_,x=Ti*y,E=v*-.5+t.marginx,M=x*-.5-t.marginy;return we.jsxs(we.Fragment,{children:[g.map(O=>we.jsx(n5,{id:O.id,from:"layers"},`media${O.id}`)),we.jsx("group",{ref:l,children:we.jsx("group",{ref:c,children:we.jsx(ppt,{})})}),we.jsx("orthographicCamera",{ref:s,left:r*-.5,right:r*.5,top:i*-.5,bottom:i*.5,near:1,far:2e3,position:[0,0,1e3]}),s.current&&we.jsx(r5,{camera:s.current,viewwidth:r,viewheight:i,effects:we.jsx(we.Fragment,{}),children:we.jsx("group",{position:[E,M,0],children:we.jsx("group",{ref:a,children:we.jsxs("group",{ref:o,children:[p&&we.jsx(x_,{color:"black",width:Yn,height:Ti}),d.map((O,N)=>we.jsx(nb,{from:"under",id:O.id,z:N*2},O.id)),g.map((O,N)=>we.jsx(nb,{from:"layers",id:O.id,z:d.length+N*2},O.id)),f.map((O,N)=>we.jsx(nb,{from:"over",id:O.id,z:d.length+g.length+N*2},O.id))]})})})})]})}const Cpt=nw(QE(qw)),kie=mv(JE(Hw)),Mpt=new jl({transparent:!1,side:$f,uniforms:{time:wg,interval:QO,palette:new jn(Cpt),map:new jn(kie),alt:new jn(kie),cols:new jn(1),rows:new jn(1),step:new jn(new an)},vertexShader:`
    uniform float time;
    uniform float interval;

    varying vec2 vUv;
    varying vec3 vColor;

    void main() {
      vUv = uv;
      vColor.xyz = instanceColor.xyz;
      
      vec4 mvPosition = vec4(position, 1.0);
      #ifdef USE_INSTANCING
      	mvPosition = instanceMatrix * mvPosition;
      #endif        
      
      mvPosition = modelViewMatrix * mvPosition;
      gl_Position = projectionMatrix * mvPosition;
    }
  `,fragmentShader:`
    uniform float time;
    uniform float interval;
    uniform sampler2D map;
    uniform sampler2D alt;
    uniform vec3 palette[16];
    uniform vec2 step;
    uniform float cols;
    uniform float rows;

    varying vec2 vUv;
    varying vec3 vColor;

    ${i3}

    float exponentialInOut(float t) {
      return t == 0.0 || t == 1.0
        ? t
        : t < 0.5
          ? +0.5 * pow(2.0, (20.0 * t) - 10.0)
          : -0.5 * pow(2.0, 10.0 - (t * 20.0)) + 1.0;
    }

    float cyclefromtime() {
      float flux = snoise(gl_FragCoord.xy * 5.0) * 0.05;
      float cycle = mod(time * 2.5 + flux, interval * 2.0) / interval;
      return exponentialInOut(abs(cycle - 1.0));
    }
      
    void main() {
      // r = char, g = color, b = bg
      int tc = int(cols);
      int ti = int(vColor.r);
      float tx = float(ti % tc);
      float ty = rows - floor(vColor.r / cols);

      int colori = int(vColor.g);
      int bgi = int(vColor.b);

      vec3 color;
      if (colori > 31) {
        vec3 bg = palette[bgi];
        color = palette[colori - 33];
        float cycle = mod(time * 2.5, interval * 2.0) / interval;
        color = mix(bg, color, cyclefromtime());
      } else {
        color = palette[colori % 16];
      }

      vec3 bg = palette[bgi];

      vec2 uv = vUv * step + vec2(tx * step.x, ty * step.y);
      bool useAlt = mod(time, interval * 2.0) > interval;
      vec3 blip = useAlt ? texture(alt, uv).rgb : texture(map, uv).rgb;

      if (blip.r == 0.0) {
        if (bgi >= ${Sn.ONCLEAR}) {
          discard;
        }
        color = palette[bgi];
      }

      gl_FragColor.rgb = color;
      gl_FragColor.a = 1.0;
    }
  `});function BV(){return JO(Mpt)}function FV(){const[n]=it.useState(()=>ave());it.useEffect(()=>{n.uniforms.data.value=sve(1,1)},[n.uniforms.data]),it.useEffect(()=>{ive(n.uniforms.data.value,1,1,[.5])},[n,n.uniforms.data.value]);const{position:e,uv:t}=it.useMemo(()=>OV(1,1),[]);return we.jsxs(we.Fragment,{children:[we.jsxs("bufferGeometry",{children:[we.jsx("bufferAttribute",{attach:"attributes-position",args:[e,3]}),we.jsx("bufferAttribute",{attach:"attributes-uv",args:[t,2]})]}),we.jsx("primitive",{object:n,attach:"material"})]})}function kpt(){const n=qc(l=>l.palettedata),e=qc(l=>l.charsetdata),t=qc(l=>l.altcharsetdata),[r]=it.useState(()=>BV()),{width:i=0,height:s=0}=e?.image??{};it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(i/Jd),c=Math.round(s/ep);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,i,s]);const{position:a,uv:o}=it.useMemo(()=>Yht(1,1),[]);return we.jsxs(we.Fragment,{children:[we.jsxs("bufferGeometry",{children:[we.jsx("bufferAttribute",{attach:"attributes-position",args:[a,3]}),we.jsx("bufferAttribute",{attach:"attributes-uv",args:[o,2]})]}),we.jsx("primitive",{object:r,attach:"material"})]})}function Oie(){const n=qc(l=>l.palettedata),e=qc(l=>l.charsetdata),t=qc(l=>l.altcharsetdata),[r]=it.useState(()=>BV()),{width:i=0,height:s=0}=e?.image??{};it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(i/Jd),c=Math.round(s/ep);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,i,s]);const{position:a,uv:o}=it.useMemo(()=>Qht(1,1),[]);return we.jsxs(we.Fragment,{children:[we.jsxs("bufferGeometry",{children:[we.jsx("bufferAttribute",{attach:"attributes-position",args:[a,3]}),we.jsx("bufferAttribute",{attach:"attributes-uv",args:[o,2]})]}),we.jsx("primitive",{object:r,attach:"material"})]})}function Sve(){const n=qc(l=>l.palettedata),e=qc(l=>l.charsetdata),t=qc(l=>l.altcharsetdata),[r]=it.useState(()=>BV()),i=Gn.DRAW_CHAR_WIDTH(),s=Gn.DRAW_CHAR_HEIGHT(),{width:a=0,height:o=0}=e?.image??{};return it.useEffect(()=>{r.uniforms.map.value=e,r.uniforms.alt.value=t??e,r.uniforms.palette.value=n;const l=Math.round(a/Jd),c=Math.round(o/ep);r.uniforms.cols.value=l,r.uniforms.rows.value=c-1,r.uniforms.step.value.x=1/l,r.uniforms.step.value.y=1/c,r.needsUpdate=!0},[n,e,t,r,a,o]),we.jsxs(we.Fragment,{children:[we.jsx("boxGeometry",{args:[i,s,s]}),we.jsx("primitive",{object:r,attach:"material"})]})}function zV(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:case Rr.ISSOLID:return 0}return i}),color:e.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:case Rr.ISSOLID:return Sn.ONCLEAR}return i}),bg:t.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:case Rr.ISSOLID:return Sn.ONCLEAR}return i})}}function Eve(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case Rr.ISSOLID:return i}return 0}),color:e.map((i,s)=>{switch(r[s]){case Rr.ISSOLID:return i}return 0}),bg:t.map((i,s)=>{switch(r[s]){case Rr.ISSOLID:return i}return Sn.ONCLEAR})}}function jV(n,e,t,r){return{char:n.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:return i}return 176}),color:e.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:return i}return Sn.DKGRAY}),bg:t.map((i,s)=>{switch(r[s]){case Rr.ISSWIM:return i}return Sn.BLACK})}}function Opt({id:n,z:e,from:t}){const r=ss(),i=it.useRef(null),s=it.useRef(null),a=it.useRef(null);Gg(()=>{xe(i.current)&&(i.current.computeBoundingBox(),i.current.computeBoundingSphere()),xe(s.current)&&(s.current.computeBoundingBox(),s.current.computeBoundingSphere()),xe(a.current)&&(a.current.computeBoundingBox(),a.current.computeBoundingSphere())});const o=Ts(wd(f=>f.gadget[t]?.find(d=>d.id===n))),l=Gn.DRAW_CHAR_WIDTH(),c=Gn.DRAW_CHAR_HEIGHT(),u=jw(Ts.getState().gadget.layers??[]);switch(o?.type){default:case oo.BLANK:case oo.MEDIA:return null;case oo.TILES:{const f=zV(o.char,o.color,o.bg,o.stats),d=jV(o.char,o.color,o.bg,o.stats);return we.jsx(we.Fragment,{children:we.jsxs("group",{position:[0,0,e],children:[we.jsx(Dv,{width:o.width,height:o.height,char:f.char,color:f.color,bg:f.bg}),we.jsx("group",{"position-z":c*-.5,children:we.jsx(Dv,{width:o.width,height:o.height,char:d.char,color:d.color,bg:d.bg})}),we.jsxs(o1,{ref:s,limit:b_,children:[we.jsx(Sve,{}),o.stats.map((g,p)=>{const _=iw(p,Yn);switch(g){case Rr.ISSOLID:return we.jsx(zy,{position:[(_.x+.5)*l,(_.y+.5)*c,c*.5],scale:[.9,.9,.9],color:[177,Sn.DKGRAY,Sn.BLACK]},p)}return null}).filter(g=>g)]}),we.jsxs(o1,{ref:i,limit:b_,children:[we.jsx(kpt,{}),o.stats.map((g,p)=>{const _=iw(p,Yn);switch(g){case Rr.ISSOLID:return we.jsx(zy,{position:[_.x*l,_.y*c,0],color:[o.char[p],o.color[p],o.bg[p]]},p)}return null}).filter(g=>g)]})]},o.id)})}case oo.SPRITES:{const f=.5714285714285714,d=o.sprites.filter(p=>p.stat!==Rr.ISSWIM),g=o.sprites.filter(p=>p.stat===Rr.ISSWIM);return we.jsxs("group",{position:[0,0,e],children:[we.jsxs(o1,{ref:i,limit:b_,children:[we.jsx(FV,{}),o.sprites.map((p,_)=>we.jsx(zy,{scale:[1,f,1],position:[p.x*l,(p.y-f+.5+.25)*c,c*-.5+.5]},_))]}),we.jsxs(o1,{ref:s,limit:b_,children:[we.jsx(Oie,{}),d.filter(p=>p.pid!==r).map((p,_)=>we.jsx(zy,{rotation:[0,0,u.facing],position:[(p.x+1)*l,(p.y-f+.5+.25)*c,c*-.5],color:[p.char,p.color,p.bg]},_))]}),we.jsxs(o1,{ref:a,limit:b_,children:[we.jsx(Oie,{}),g.filter(p=>p.pid!==r).map((p,_)=>we.jsx(zy,{position:[p.x*l,p.y*c,c*-.5],color:[p.char,p.color,p.bg]},_))]})]},o.id)}case oo.DITHER:return we.jsx("group",{position:[0,0,e],children:we.jsx(tb,{width:o.width,height:o.height,alphas:[...o.alphas]})},o.id)}}function Ipt(n){switch(n.type){case oo.TILES:return 0;case oo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case oo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.5}return 0}function Npt(n){switch(n){case tl.NEAR:return .1;default:case tl.MID:return .2;case tl.FAR:return .3}}function Ppt(n){switch(n){case tl.NEAR:return 64;default:case tl.MID:return 16;case tl.FAR:return 0}}function Dpt(n){switch(n){case tl.NEAR:return 25;default:case tl.MID:return 45;case tl.FAR:return 90}}function Lpt({width:n,height:e}){const t=Rb(),r=Gn.DRAW_CHAR_WIDTH(),i=Gn.DRAW_CHAR_HEIGHT(),s=n*r,a=e*i,o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),f=it.useRef(null),[,d]=it.useState(!1);it.useLayoutEffect(()=>{d(!0)},[]),Gg((x,E)=>{if(!o.current||!l.current||!c.current||!u.current||!f.current)return;const M=jw(Ts.getState().gadget.layers??[]),O=Gn.DRAW_CHAR_WIDTH(),N=Gn.DRAW_CHAR_HEIGHT(),I=Yn*O,D=Ti*N,V=n*O,G=e*N;xe(u.current.userData.focusx)||(u.current.userData={focusx:M.focusx}),l.current.position.x=0,l.current.position.y=G-D;const Q=Di(V/I,1,10);c.current.position.x=V-I*Q,c.current.position.y=0,c.current.scale.setScalar(Q);const B=.05;let $=M.focusx-.5,U=M.focusy+.5;$*=-O,U*=-N,$9(o.current.rotation,[0,Math.PI+M.facing,0],B,E),$9(u.current.rotation,[Npt(M.viewscale),0,0],B,E),N1(o.current.position,[x.size.width*.5-$,x.size.height*.5-N*.25+1,U],B,E),N1(u.current.position,[0,0,Ppt(M.viewscale)],B,E),f.current.bokehScale=5,f.current.cocMaterial.worldFocusRange=1200,f.current.cocMaterial.worldFocusDistance=100,U0(u.current,"fov",Dpt(M.viewscale),B,E),u.current.updateProjectionMatrix()}),Ts(x=>x.gadget.over?.length??0),Ts(x=>x.gadget.under?.length??0),Ts(x=>x.gadget.layers?.length??0);const{over:g=[],under:p=[],layers:_=[]}=Ts.getState().gadget,y=p.length*2+2,v=y+2;return we.jsxs(we.Fragment,{children:[_.map(x=>we.jsx(n5,{id:x.id,from:"layers"},`media${x.id}`)),we.jsx("group",{ref:o,children:we.jsx("perspectiveCamera",{ref:u,near:1,far:3e3,aspect:-s/a})}),we.jsx("group",{ref:c,children:p.map((x,E)=>we.jsx(nb,{from:"under",id:x.id,z:E*2},x.id))}),we.jsx("group",{"position-z":y,children:u.current&&we.jsx(r5,{camera:u.current,viewwidth:s,viewheight:a,effects:we.jsx(we.Fragment,{children:we.jsx(MV,{ref:f})}),children:we.jsx("group",{position:[-t.marginx,-t.marginy,-512],children:we.jsx("group",{rotation:[Math.PI*-.5,0,0],position:[0,i*-.75,0],children:_.map(x=>we.jsx(Opt,{id:x.id,from:"layers",z:Ipt(x)},x.id))})})})}),we.jsx("group",{ref:l,"position-z":v,children:g.map((x,E)=>we.jsx(nb,{from:"over",id:x.id,z:E*2},x.id))})]})}function Upt({id:n,z:e,from:t}){const r=it.useRef(null);Gg(()=>{xe(r.current)&&(r.current.computeBoundingBox(),r.current.computeBoundingSphere())});const i=Ts(wd(o=>o.gadget[t]?.find(l=>l.id===n))),s=Gn.DRAW_CHAR_WIDTH(),a=Gn.DRAW_CHAR_HEIGHT();switch(i?.type){default:case oo.BLANK:case oo.MEDIA:return null;case oo.TILES:{const o=zV(i.char,i.color,i.bg,i.stats),l=Eve(i.char,i.color,i.bg,i.stats),c=jV(i.char,i.color,i.bg,i.stats);return we.jsx(we.Fragment,{children:we.jsxs("group",{position:[0,0,e],children:[we.jsx(Dv,{width:i.width,height:i.height,char:o.char,color:o.color,bg:o.bg}),we.jsx("group",{"position-z":a*-.5,children:we.jsx(Dv,{width:i.width,height:i.height,char:c.char,color:c.color,bg:c.bg})}),we.jsxs(o1,{ref:r,limit:b_,children:[we.jsx(Sve,{}),i.stats.map((u,f)=>{const d=iw(f,Yn);switch(u){case Rr.ISSOLID:return we.jsx(zy,{position:[(d.x+.5)*s,(d.y+.5)*a,a*.5],color:[177,Sn.DKGRAY,Sn.BLACK]},f)}return null}).filter(u=>u)]}),we.jsx("group",{"position-z":a+1,children:we.jsx(Dv,{width:i.width,height:i.height,char:l.char,color:l.color,bg:l.bg})})]},i.id)})}case oo.SPRITES:{const o=.5714285714285714,l=i.sprites.filter(u=>u.stat!==Rr.ISSWIM),c=i.sprites.filter(u=>u.stat===Rr.ISSWIM);return we.jsxs("group",{position:[0,0,e],children:[we.jsxs(o1,{ref:r,limit:b_,children:[we.jsx(FV,{}),i.sprites.map((u,f)=>we.jsx(zy,{scale:[1,o,1],position:[u.x*s,(u.y+.25)*a,a*-.75+.5]},f))]}),we.jsx(Fk,{sprites:[...l],scale:1.5,fliptexture:!1}),we.jsx("group",{"position-z":a*-.5,children:we.jsx(Fk,{sprites:[...c],scale:1.5,fliptexture:!1})})]},i.id)}case oo.DITHER:return we.jsx("group",{position:[0,0,e],children:we.jsx(tb,{width:i.width,height:i.height,alphas:[...i.alphas]})},i.id)}}function Bpt(n){switch(n.type){case oo.TILES:return 0;case oo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case oo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.75}return 0}function Fpt(n){switch(n){case tl.NEAR:return 6;default:case tl.MID:return 3;case tl.FAR:return 1.2}}function zpt({width:n,height:e}){const t=Rb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),[,f]=it.useState(!1);it.useLayoutEffect(()=>{f(!0)},[]),Gg((v,x)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current||!u.current)return;const E=jw(Ts.getState().gadget.layers??[]),M=Gn.DRAW_CHAR_WIDTH(),O=Gn.DRAW_CHAR_HEIGHT(),N=n*Gn.DRAW_CHAR_WIDTH(),I=e*Gn.DRAW_CHAR_HEIGHT();xe(l.current.userData.focusx)||(s.current.scale.setScalar(E.viewscale),l.current.userData={focusx:E.focusx,focusy:E.focusy,focuslx:E.focusx,focusly:E.focusy,focusvx:0,focusvy:0,facing:E.facing,focusz:0}),a.current.position.x=0,a.current.position.y=I-O;const D=Di(N/M,1,10);o.current.position.x=N-M*D,o.current.position.y=0,o.current.scale.setScalar(D);const V=.125,G=l.current.userData.focusx+.5,Q=l.current.userData.focusy+.5,B=G*M,$=Q*O;switch(N1(s.current.scale,Fpt(E.viewscale),V,x),N1(l.current.position,[-B,-$,0],V,x),U0(l.current.userData,"focusx",E.focusx,V),U0(l.current.userData,"focusy",E.focusy,V),c.current.position.x=v.size.width*.5,c.current.position.y=v.size.height*.5,c.current.updateProjectionMatrix(),E.viewscale){case tl.NEAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=1e3;break;default:case tl.MID:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1e3,u.current.cocMaterial.worldFocusDistance=1e3;break;case tl.FAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1500,u.current.cocMaterial.worldFocusDistance=1e3;break}}),Ts(v=>v.gadget.over?.length??0),Ts(v=>v.gadget.under?.length??0),Ts(v=>v.gadget.layers?.length??0);const{over:d=[],under:g=[],layers:p=[]}=Ts.getState().gadget,_=g.length*2+2,y=_+2;return we.jsxs(we.Fragment,{children:[we.jsxs("group",{"position-z":_,children:[p.map(v=>we.jsx(n5,{id:v.id,from:"layers"},`media${v.id}`)),we.jsx("orthographicCamera",{ref:c,left:r*-.5,right:r*.5,top:i*-.5,bottom:i*.5,near:1,far:2e3,position:[0,0,1e3]}),c.current&&we.jsx(r5,{camera:c.current,viewwidth:r,viewheight:i,effects:we.jsx(we.Fragment,{children:we.jsx(MV,{ref:u})}),children:we.jsx("group",{position:[t.marginx,t.marginy,-500],children:we.jsx("group",{rotation:[Math.PI*.25,0,Math.PI*-.25],children:we.jsx("group",{ref:s,children:we.jsx("group",{ref:l,children:p.map(v=>we.jsx(Upt,{id:v.id,from:"layers",z:Bpt(v)},v.id))})})})})})]}),we.jsx("group",{ref:o,children:g.map((v,x)=>we.jsx(nb,{from:"under",id:v.id,z:x*2},v.id))}),we.jsx("group",{ref:a,"position-z":y,children:d.map((v,x)=>we.jsx(nb,{from:"over",id:v.id,z:x*2},v.id))})]})}function jpt({id:n,z:e,from:t}){const r=it.useRef(null);Gg(()=>{xe(r.current)&&(r.current.computeBoundingBox(),r.current.computeBoundingSphere())});const i=Ts(wd(o=>o.gadget[t]?.find(l=>l.id===n))),s=Gn.DRAW_CHAR_WIDTH(),a=Gn.DRAW_CHAR_HEIGHT();switch(i?.type){default:case oo.BLANK:case oo.MEDIA:return null;case oo.TILES:{const o=zV(i.char,i.color,i.bg,i.stats),l=Eve(i.char,i.color,i.bg,i.stats),c=jV(i.char,i.color,i.bg,i.stats);return we.jsxs("group",{position:[0,0,e],children:[we.jsx(Dv,{width:i.width,height:i.height,char:o.char,color:o.color,bg:o.bg}),we.jsx("group",{"position-z":a*-.25,children:we.jsx(Dv,{width:i.width,height:i.height,char:c.char,color:c.color,bg:c.bg})}),we.jsx("group",{"position-z":a*.25,children:we.jsx(Dv,{width:i.width,height:i.height,char:l.char,color:l.color,bg:l.bg})})]},i.id)}case oo.SPRITES:{const o=.5714285714285714,l=i.sprites.filter(u=>u.stat!==Rr.ISSWIM),c=i.sprites.filter(u=>u.stat===Rr.ISSWIM);return we.jsxs("group",{position:[0,0,e],children:[we.jsxs(o1,{ref:r,limit:b_,children:[we.jsx(FV,{}),i.sprites.map((u,f)=>we.jsx(zy,{scale:[1,o,1],position:[u.x*s,(u.y+.5)*a,a*-.5+.5]},f))]}),we.jsx(Fk,{sprites:[...l],withbillboards:!0,fliptexture:!1}),we.jsx("group",{"position-z":a*-.5,children:we.jsx(Fk,{sprites:[...c],withbillboards:!0,fliptexture:!1})})]},i.id)}case oo.DITHER:{const o=new Array((i.width+2)*(i.height+2)).fill(0);for(let c=1;c<Yn-1;++c){const u=i.alphas[gf({x:1+c,y:0},Yn)],f=i.alphas[gf({x:1+c,y:Ti-1},Yn)];o[gf({x:1+c,y:0},Yn+2)]=u,o[gf({x:1+c,y:Ti},Yn+2)]=f}for(let c=1;c<Ti-1;++c){const u=i.alphas[gf({x:0,y:1+c},Yn)],f=i.alphas[gf({x:Yn-1,y:1+c},Yn)];o[gf({x:0,y:1+c},Yn+2)]=u,o[gf({x:Yn,y:1+c},Yn+2)]=f}const l=Gn.DRAW_CHAR_HEIGHT();return we.jsxs(we.Fragment,{children:[we.jsx("group",{position:[0,0,e],children:we.jsx(tb,{width:i.width,height:i.height,alphas:[...i.alphas]})},`under${i.id}`),we.jsx("group",{position:[0,0,e+l],children:we.jsx(tb,{width:i.width,height:i.height,alphas:[...i.alphas]})},`mid${i.id}`),we.jsx("group",{position:[0,0,e+l],children:we.jsx(tb,{width:i.width+2,height:i.height+2,alphas:o})},`over${i.id}`)]})}}}function Hpt(n){switch(n.type){case oo.TILES:return 0;case oo.DITHER:return Gn.DRAW_CHAR_HEIGHT()+1;case oo.SPRITES:return Gn.DRAW_CHAR_HEIGHT()*.5}return 0}function qpt(n,e){switch(n){case tl.NEAR:return e*.11;default:case tl.MID:return e*.082;case tl.FAR:return e*.04}}function Vpt(n){switch(n){case tl.NEAR:return 160;default:case tl.MID:return 320;case tl.FAR:return 768}}function Gpt(n){switch(n){case tl.NEAR:return .888;default:case tl.MID:return .777;case tl.FAR:return .444}}function $pt({width:n,height:e}){const t=Rb(),r=n*Gn.DRAW_CHAR_WIDTH(),i=e*Gn.DRAW_CHAR_HEIGHT(),s=it.useRef(null),a=it.useRef(null),o=it.useRef(null),l=it.useRef(null),c=it.useRef(null),u=it.useRef(null),[,f]=it.useState(!1);it.useLayoutEffect(()=>{f(!0)},[]),Gg((I,D)=>{if(!s.current||!a.current||!o.current||!l.current||!c.current||!u.current)return;const V=jw(Ts.getState().gadget.layers??[]),G=Gn.DRAW_CHAR_WIDTH(),Q=Gn.DRAW_CHAR_HEIGHT(),B=Yn*G,$=Ti*Q;xe(l.current.userData.focusx)||(l.current.userData={focusx:V.focusx,focusy:V.focusy}),a.current.position.x=0,a.current.position.y=i-Q;const U=Di(r/G,1,10);o.current.position.x=r-G*U,o.current.position.y=0,o.current.scale.setScalar(U);const J=.125;let W=l.current.userData.focusx+.5,q=l.current.userData.focusy+.5;switch(W*=-Gn.DRAW_CHAR_WIDTH(),q*=-Gn.DRAW_CHAR_HEIGHT(),W+=B*.5,q+=$*.5,N1(c.current.position,[I.size.width*.5,I.size.height*.5+qpt(V.viewscale,i),Vpt(V.viewscale)],J,D),$9(s.current.rotation,[Gpt(V.viewscale),0,0],J,D),N1(l.current.position,[W,q,0],J,D),U0(l.current.userData,"focusx",V.focusx,J),U0(l.current.userData,"focusy",V.focusy,J),c.current.rotation.z=Math.PI,c.current.updateProjectionMatrix(),V.viewscale){case tl.NEAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=500;break;default:case tl.MID:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=600,u.current.cocMaterial.worldFocusDistance=600;break;case tl.FAR:u.current.bokehScale=10,u.current.cocMaterial.worldFocusRange=1e3,u.current.cocMaterial.worldFocusDistance=1100;break}}),Ts(I=>I.gadget.over?.length??0),Ts(I=>I.gadget.under?.length??0),Ts(I=>I.gadget.layers?.length??0);const{over:d=[],under:g=[],layers:p=[]}=Ts.getState().gadget,_=Gn.DRAW_CHAR_WIDTH(),y=Gn.DRAW_CHAR_HEIGHT(),v=Yn*_,x=Ti*y,E=v*-.5+t.marginx,M=x*-.5+-t.marginy,O=g.length*2+2,N=O+2;return we.jsxs(we.Fragment,{children:[p.map(I=>we.jsx(n5,{id:I.id,from:"layers"},`media${I.id}`)),we.jsx("perspectiveCamera",{ref:c,near:1,far:2e3,aspect:-r/i}),we.jsx("group",{"position-z":O,children:c.current&&we.jsx(r5,{camera:c.current,viewwidth:r,viewheight:i,effects:we.jsx(we.Fragment,{children:we.jsx(MV,{ref:u})}),children:we.jsx("group",{position:[E,M,-1e3],children:we.jsx("group",{ref:s,children:we.jsx("group",{ref:l,children:p.map(I=>we.jsx(jpt,{id:I.id,from:"layers",z:Hpt(I)},I.id))})})})})}),we.jsx("group",{ref:o,children:g.map((I,D)=>we.jsx(nb,{from:"under",id:I.id,z:D*2},I.id))}),we.jsx("group",{ref:a,"position-z":N,children:d.map((I,D)=>we.jsx(nb,{from:"over",id:I.id,z:D*2},I.id))})]})}function Wpt({width:n,height:e}){const t=Zw(n,e,0,Sn.WHITE,Sn.ONCLEAR),r=Ts(s=>s.gadget.tickers),i=it.useMemo(()=>({...yb(n,e,Sn.WHITE,Sn.BLACK),...t.getState()}),[n,e,t]);if(xe(r)){i.x=0,i.y=2,i.disablewrap=!0;const s=t.getState();MU(s,0,Sn.WHITE,Sn.ONCLEAR);for(let a=0;a<r.length;++a){const o=r[a];ci(o,i,!1),i.x=0,i.y++}}return we.jsx(lR,{store:t,children:we.jsx(cR,{width:n,height:e})})}function MS(n,e,t){let r=0;t.alt&&(r|=qj),t.ctrl&&(r|=Vj),t.shift&&(r|=Gj),x0(n)&&cle(xt,n,e,r)}function Ypt({width:n,height:e}){const t=ss();Ts(s=>s.gadget.board),Ts(s=>s.gadget.layers?.length??0);const r=Ts(s=>jw(s.gadget.layers??[]).graphics),i=1.2;return we.jsxs(we.Fragment,{children:[we.jsx(Vc,{MOVE_LEFT:s=>MS(t,Tn.MOVE_LEFT,s),MOVE_RIGHT:s=>MS(t,Tn.MOVE_RIGHT,s),MOVE_UP:s=>MS(t,Tn.MOVE_UP,s),MOVE_DOWN:s=>MS(t,Tn.MOVE_DOWN,s),OK_BUTTON:s=>MS(t,Tn.OK_BUTTON,s),CANCEL_BUTTON:s=>MS(t,Tn.CANCEL_BUTTON,s),MENU_BUTTON:s=>MS(t,Tn.MENU_BUTTON,s),keydown:s=>{const a=qr(s.key),o=a3(s),l=ss();switch(a){case"c":dY(xt,l,"");break;case"#":case"3":dY(xt,l,"#");break;case"p":o.ctrl&&fle(xt,l);break}}}),r==="flat"&&we.jsx(Apt,{width:n,height:e}),r==="mode7"&&we.jsx($pt,{width:n,height:e}),r==="iso"&&we.jsx(zpt,{width:n,height:e}),r==="fpv"&&we.jsx(Lpt,{width:n,height:e}),we.jsx("group",{"position-z":512,scale:[i,i,i],children:we.jsx(Wpt,{width:Math.floor(n/i),height:Math.floor(e/i)})})]})}function Iie({rect:n,islandscape:e=!0,sidebaropen:t=!0,shouldclose:r=!1}){switch(n.type){case 0:return we.jsx("group",{"position-z":512,children:we.jsx(yve,{width:n.width,height:n.height,color:14,bg:1,text:n.text,xmargin:e?1:t?3:10,ymargin:e&&!t?6:0})});case 1:return we.jsx(dpt,{width:n.width,height:n.height,color:14,bg:1,text:n.text,shouldclose:r});case 2:return we.jsx(Ypt,{width:n.width,height:n.height})}return null}const Jx=20;function Xpt(){const n=Rb(),{islandscape:e,sidebaropen:t,insetrows:r,showtouchcontrols:i}=el(),s=Ts(ane(p=>p.gadget.scroll??[])),a=s.length===0,[o,l]=it.useState(!1),c=Ts(ane(p=>p.gadget.sidebar??[]));if(n.cols<10||n.rows<10)return null;const u={name:"main",type:2,x:0,y:0,text:[],width:n.cols,height:n.rows},f=[];if(c.length)if(i)if(e){const p=t?Jx+5:Jx,_=t?Jx:4,y={name:"sidebar",type:0,x:u.x+u.width-_,y:u.y,width:p,height:u.height,text:c};u.width-=_,f.push(y)}else{const p=t?r-7:r,_=t?p:4,y={name:"sidebar",type:0,x:0,y:u.y+u.height-_,width:u.width,height:p,text:c};u.height-=_,f.push(y)}else{const p={name:"sidebar",type:0,x:u.x+u.width-Jx,y:u.y,width:Jx,height:u.height,text:c};u.width-=Jx,f.push(p)}const d={name:"scroll",type:1,x:0,y:0,width:Di(50,24,u.width-2),height:Di(18,8,u.height-8),text:s};d.x=u.x+Math.floor((u.width-d.width)*.5),d.y=u.y+Math.floor((u.height-d.height)*.5),!a&&!o&&l(!0),f.unshift(u);const g=ss();return we.jsxs(eS.Provider,{value:{sendmessage(p,_){xt.emit(g,p,_)},sendclose(){qke(xt,g)},didclose(){l(!1)}},children:[we.jsx("group",{position:[-Gn.DRAW_CHAR_WIDTH(),-Gn.DRAW_CHAR_HEIGHT(),-524],children:we.jsx(x_,{visible:!0,color:new cr(.076,.076,0),width:n.cols+2,height:n.rows+2})}),we.jsx("group",{position:[0,0,-512],children:f.map(p=>we.jsx("group",{position:[p.x*Gn.DRAW_CHAR_WIDTH(),p.y*Gn.DRAW_CHAR_HEIGHT(),0],children:we.jsx(Iie,{islandscape:!i||e,sidebaropen:!i||t,rect:p})},p.name))}),o&&we.jsxs(Og.Fragment,{children:[we.jsx("group",{position:[0,0,800],children:we.jsx(ndt,{width:n.cols,height:n.rows,alpha:.14})}),we.jsx("group",{position:[d.x*Gn.DRAW_CHAR_WIDTH(),d.y*Gn.DRAW_CHAR_HEIGHT(),900],children:we.jsx(Iie,{rect:d,shouldclose:a})})]},"scroll")]})}const Kpt=250,Zpt=249,PL=Sn.BLUE,Qpt=Sn.WHITE,Jpt=Sn.DKGRAY,HV=Sn.BLACK;function uR(n){return n?Sn.ONCLEAR:Sn.DKBLUE}function emt(n){return Math.round(n*.333)}function tmt(n){return Math.round(n*.5)}const xve=it.createContext({sendmessage(){}});function b1(n,e,t,r){const i=W0(r);r.iseven=r.y%2===0,r.active.bg=n?HV:r.reset.bg,r.active.leftedge=i.left,r.active.rightedge=i.right,r.active.topedge=i.top,r.active.bottomedge=i.bottom,r.x=r.active.leftedge+e,r.y=r.active.topedge+t}function VS(n,e,t,r,i,s,a,o){const l=W0(i);i.iseven=i.y%2===0,i.active.color=Sn.WHITE,i.active.bg=i.reset.bg,i.active.leftedge=l.left+s,i.active.rightedge=l.right-s,i.active.topedge=l.top+a,i.active.bottomedge=l.bottom-o,i.x=i.active.leftedge+t,i.y=i.active.topedge+r}function nmt(n){let e=0;return n.split(/\r?\n/).map(r=>{const i=e,s=`${r}
`;return e+=s.length,{start:i,code:s,end:i+r.length}})}function rmt(n){return n.reduce((e,t)=>{const r=t.code.length;return r>e?r:e},0)}function imt(n,e){for(let t=0;t<e.length;++t)if(n<=e[t].end)return t;return 0}function qV({bump:n}){const e=Fh(),t=W0(e),{quickterminal:r}=ao(),i=uR(r);if(n&&t.top++,r){for(let s=t.top;s<=t.bottom;++s)for(let a=t.left;a<=t.right;++a)Hu(e,e.width,e.height,a,s,{char:0,color:PL,bg:i});return null}for(let s=t.top;s<=t.bottom;++s)for(let a=t.left;a<=t.right;++a){let o=0;(a+s)%2===0&&(o=Math.abs(Math.round(Math.cos(a*s*.01)))?Kpt:Zpt),Hu(e,e.width,e.height,a,s,{char:o,color:PL,bg:i})}return null}const EF=Sn.WHITE,M2=Sn.GREEN,ju=Sn.YELLOW,smt=Sn.CYAN,Rg=Sn.DKGREEN,Nie=Sn.DKCYAN,amt=Sn.GREEN,fP=Sn.DKPURPLE,Tve=Sn.WHITE,omt=Sn.LTGRAY,lmt=Sn.DKGRAY,Pie=Sn.DKRED,cmt=Sn.DKRED,xF=Sn.DKYELLOW,umt={[uk.tokenTypeIdx??0]:EF,[zfe.tokenTypeIdx??0]:EF,[jfe.tokenTypeIdx??0]:EF,[OE.tokenTypeIdx??0]:fP,[By.tokenTypeIdx??0]:ju,[fk.tokenTypeIdx??0]:M2,[hk.tokenTypeIdx??0]:smt,[cw.tokenTypeIdx??0]:cmt,[dk.tokenTypeIdx??0]:ju,[TH.tokenTypeIdx??0]:ju,[bu.tokenTypeIdx??0]:M2,[x2.tokenTypeIdx??0]:M2,[GD.tokenTypeIdx??0]:Tve,[wH.tokenTypeIdx??0]:ju,[RH.tokenTypeIdx??0]:ju,[AH.tokenTypeIdx??0]:ju,[CH.tokenTypeIdx??0]:ju,[MH.tokenTypeIdx??0]:ju,[kH.tokenTypeIdx??0]:ju,[$D.tokenTypeIdx??0]:xF,[WD.tokenTypeIdx??0]:xF,[YD.tokenTypeIdx??0]:xF,[XD.tokenTypeIdx??0]:ju,[KD.tokenTypeIdx??0]:ju,[OH.tokenTypeIdx??0]:ju,[IH.tokenTypeIdx??0]:ju,[lE.tokenTypeIdx??0]:ju,[NH.tokenTypeIdx??0]:ju,[PH.tokenTypeIdx??0]:ju,[pk.tokenTypeIdx??0]:ju,[DH.tokenTypeIdx??0]:ju,[LH.tokenTypeIdx??0]:ju,[UH.tokenTypeIdx??0]:amt,[cE.tokenTypeIdx??0]:Rg,[uE.tokenTypeIdx??0]:Nie,[ZD.tokenTypeIdx??0]:Nie,[fE.tokenTypeIdx??0]:Rg,[BH.tokenTypeIdx??0]:Rg,[FH.tokenTypeIdx??0]:Rg,[zH.tokenTypeIdx??0]:Rg,[jH.tokenTypeIdx??0]:Rg,[HH.tokenTypeIdx??0]:Rg,[qH.tokenTypeIdx??0]:Rg};Sn.DKPURPLE;const fmt=Sn.DKYELLOW,hmt=Sn.DKPURPLE,dmt=Sn.CYAN,pmt=Sn.DKCYAN,mmt=Sn.RED,gmt=Sn.WHITE,_mt=Sn.LTGRAY,vmt=Sn.YELLOW,wve=new Map;function f_(n,e){wve.set(n,e)}function Die(n){const e=[];let t=0;for(let r=0;r<n.length;++r){switch(n[r]){case";":t=0;break;case" ":break;default:t===0&&(t=1);break;case"#":t===0&&(t=2);break}switch(t){case 0:e.push(Sn.LTGRAY);break;case 1:e.push(Smt(n[r]));break;case 2:e.push(Sn.CYAN);break}}return e.push(Sn.BLUE),e}function ymt(n){if(n.startsWith("play ")){const e=new Array(5).fill(Rg);return e.push(...Die(n.slice(5))),e}else if(n.startsWith("bgplay ")){const e=new Array(7).fill(Rg);return e.push(...Die(n.slice(7))),e}return wve.get(n)??Sn.GREEN}const ux=Sn.GREEN,bmt=Sn.DKGREEN,sy=Sn.PURPLE,fx=Sn.DKCYAN,Rve=Sn.CYAN,Ave=Sn.YELLOW,Cve=Sn.DKYELLOW,Mve=new Map;function Qa(n,e){Mve.set(n,e)}function Smt(n){return Mve.get(n)??Sn.GREEN}function Emt(){const n=Fh(),e=W0(n),[t,r,i]=ao(wd(v=>[v.quickterminal,v.editor.type,v.editor.title])),s=Sn.WHITE,a=uR(t);for(let v=e.top;v<e.bottom;++v)Hu(n,n.width,n.height,e.left,v,{char:179,color:s,bg:a}),Hu(n,n.width,n.height,e.right,v,{char:179,color:s,bg:a});VS(!1,!1,0,0,n,0,0,0),ci("$213$205$187",n,!0),VS(!1,!1,n.width-3,0,n,0,0,0),ci("$196$196$191",n,!0);const o="$205".repeat(e.width-2);VS(!1,!1,0,e.height-1,n,0,0,0),ci(`$212${o}$190`,n,!0);const l=Wg(),c="$205".repeat(e.width-4);VS(!1,!1,0,1,n,0,0,0),ci(`$179$${l?"7":"232"}$200${c}$181`,n,!0);const f=` ${`$blue[${r}] `}$green${i}$white `,g=W1(f,e.width,e.height)?.measuredwidth??1,p=e.width-2,_=2+Math.round(p*.5)-Math.round(g*.5);VS(!1,!1,_,1,n,0,0,0),ci(f,n,!0);const y=P1?`shift+${g0}+z`:`${g0}+y`;return we.jsx(UV,{margin:3,color:Sn.BLUE,y:e.top,leftedge:0,rightedge:e.width-1,line:`
    esc/cancel$white.CLOSE   $blue
    tab$white.CHANGE LAYOUT   $blue
    hold shift$white.SELECT TEXT   $blue
    alt+up/down$white.JUMP 10 LINES   $blue
    alt+left/right$white.JUMP 10 COLS   $blue
    ${g0}+up/down$white.JUMP TOP/BOTTOM   $blue
    ${g0}+left/right$white.JUMP TO START/END OF LINE   $blue
    ${g0}+a$white.SELECT ALL   $blue
    ${g0}+c$white.COPY   $blue
    ${g0}+x$white.CUT   $blue
    ${g0}+v$white.PASTE   $blue
    ${g0}+z$white.UNDO   $blue
    ${y}$white.REDO   $blue
    ${g0}+p$white.TEST SELECTED CODE   $blue
    ${g0}+k$white.OPEN REFSCROLL   $blue
    ${g0}+e$white.COPY CODEPAGE TO CLIPBOARD AS JSON   $blue
    `,context:n})}function xmt({xcursor:n,ycursor:e,xoffset:t,yoffset:r,rows:i,codepage:s}){const a=Wg(),o=Fh(),l=_c(),c=ss(),u=it.useRef(void 0),f=W0(o),d=ao(q=>q.editor.path),g=xe(s)?s.toJSON():"",p=i.length-1,_=n+1-t,y=e+2-r;if(xe(s)){const q=u.current?.x!==_||u.current?.y!==y;if(a||q){const Y=f.left+_,ae=f.top+y;if(ae>f.top+1&&ae<f.bottom&&Y>f.left&&Y<f.right){const Z=Y+ae*o.width;_U(Z,"",o),fw(Z,Z,Sn.WHITE,Sn.DKBLUE,o)}}}u.current={x:_,y};const v=i[p].end,x=i[e];let E=l.cursor,M=l.cursor,O=!1;xe(l.select)&&(O=!0,E=Math.min(l.cursor,l.select),M=Math.max(l.cursor,l.select),l.cursor!==l.select&&--M);const N=M-E+1,I=O?g.substring(E,M+1):"";function D(q){q?xe(l.select)||_c.setState({select:l.cursor}):_c.setState({select:void 0})}const V=it.useCallback(function(q,Y,ae){Y>0&&s?.delete(q,Y),xe(ae)&&s?.insert(q,ae),_c.setState({cursor:q+(ae??"").length,select:void 0})},[s]),G=it.useCallback(function(q,Y,ae){Y>0&&s?.delete(q,Y),xe(ae)&&s?.insert(q,ae),_c.setState({cursor:q+(ae??"").length})},[s]);function Q(){if(O){const q=I.split(`
`);for(let Y=0;Y<q.length;++Y){const ae=q[Y],Z=ae.trim();Z.startsWith("'")?q[Y]=ae.replace(/' ?/,""):Z&&(q[Y]=`' ${ae}`)}V(E,N,q.join(`
`))}}function B(q=!0){if(O){const Y=I.split(`
`);for(let ae=0;ae<Y.length;++ae){const Z=Y[ae];q?Y[ae].startsWith(" ")&&(Y[ae]=Z.substring(1)):Y[ae]=` ${Z}`}G(E,N,Y.join(`
`))}}function $(){O&&(_c.setState({cursor:E}),V(E,N))}function U(){_c.setState({cursor:v,select:void 0})}const J=it.useCallback(function(q){const Y=Math.round(e+q);if(Y<0)_c.setState({cursor:0});else if(Y>p)_c.setState({cursor:v});else{const ae=i[Y];_c.setState({cursor:ae.start+Math.min(n,ae.code.length-1)})}},[v,i,p,n,e]),W=it.useMemo(()=>s?new R$e(s):void 0,[s]);return it.useEffect(()=>{function q(ae){ae.stackItem.meta.set("cursor",l.cursor)}function Y(ae){if(ae.stackItem.meta.has("cursor")){const Z=ae.stackItem.meta.get("cursor");_c.setState({cursor:Z})}}return W?.on("stack-item-added",q),W?.on("stack-item-popped",Y),()=>{W?.off("stack-item-added",q),W?.off("stack-item-popped",Y)}},[W,l.cursor]),we.jsxs(we.Fragment,{children:[we.jsx(LV,{blocking:!0,x:f.left,y:f.top,width:f.width,height:f.height,onScroll:q=>J(q*.75)}),we.jsx(Vc,{keydown:q=>{if(!xe(s))return;const{key:Y}=q,ae=qr(Y),Z=a3(q);switch(ae){case"arrowleft":if(D(Z.shift),Z.ctrl)_c.setState({cursor:x.start});else{const K=l.cursor-(Z.alt?10:1);_c.setState({cursor:Di(K,0,v)})}break;case"arrowright":if(D(Z.shift),Z.ctrl)_c.setState({cursor:x.end});else{const K=l.cursor+(Z.alt?10:1);_c.setState({cursor:Di(K,0,v)})}break;case"arrowup":D(Z.shift),Z.ctrl?_c.setState({cursor:0}):J(Z.alt?-10:-1);break;case"arrowdown":D(Z.shift),Z.ctrl?_c.setState({cursor:v}):J(Z.alt?10:1);break;case"enter":xe(s)&&(s.insert(l.cursor,`
`),_c.setState({cursor:l.cursor+1}));break;case"esc":case"escape":Z.shift||Z.alt||Z.ctrl?gD(xt,c):uOe(xt,c);break;case"tab":sle(xt,c,!Z.shift);break;case"delete":O?$():V(l.cursor,1);break;case"backspace":O?$():g.length>0&&V(Math.max(l.cursor-1,0),1);break;default:if(Z.ctrl)switch(ae){case"e":bOe(xt,c,d);break;case"z":P1&&Z.shift?W?.redo():W?.undo();break;case"y":P1||W?.redo();break;case"a":_c.setState({cursor:v,select:0});break;case"c":xe(Qo())?Qo().writeText(I).catch(K=>Si(xt,c,"clipboard",K)):U();break;case"v":xe(Qo())?Qo().readText().then(K=>{const ne=K.replaceAll("\r","");O?V(E,N,ne):V(l.cursor,0,ne)}).catch(K=>Si(xt,c,"clipboard",K)):U();break;case"x":xe(Qo())&&O?Qo().writeText(I).then(()=>$()).catch(K=>Si(xt,c,"clipboard",K)):U();break;case"p":O?(wv(xt,c,I),xs(xt,c,`running $WHITE${I.substring(0,16)}...$BLUE`)):(wv(xt,c,x.code),xs(xt,c,`running $WHITE${x.code.substring(0,16)}...$BLUE`));break;case"'":Q();break}else if(!Z.alt){if(q.key.length===1)if(O)q.key==="'"?Q():q.key===" "?B(q.shiftKey):V(E,N,q.key);else{const K=l.cursor+q.key.length;s.insert(l.cursor,q.key),_c.setState({cursor:K})}}break}}})]})}function Lie(n){const[e]=n.substring(1).split(";");return e.split(" ")}let hP;function h_(n){const e=lQe(qme(n));Object.keys(e).length&&(hP=e)}function Tmt({ycursor:n,xoffset:e,yoffset:t,rows:r,codepage:i}){const s=Wg(),a=Fh(),o=_c(),{quickterminal:l}=ao(),c=it.useMemo(()=>{if(r.length){const y=r[r.length-1];return[...r,{code:"",start:y.end+1,end:y.end+1}]}return[]},[r]);if(!xe(i)){const y=(s?"|":"-").repeat(3);return VS(!1,!1,0,0,a,1,2,1),ci(` ${y} LOADING ${y}`,a,!0),null}const u=a.width-2,f=W0(a);f.right=u-1;let d=o.cursor,g=o.cursor,p=!1;xe(o.select)&&(p=!0,d=Math.min(o.cursor,o.select),g=Math.max(o.cursor,o.select),o.cursor!==o.select&&--g);const _=f.left+1-4;VS(!1,!1,-e,-t,a,1,2,1);for(let y=0;y<c.length;++y){if(a.y<=f.top+1){++a.y;continue}const v=c[y],x=c[y-1],E=y===n,M=y-1===n,O=v.code.replaceAll(`
`,""),N=_-e;a.x=N,a.iseven=a.y%2===0,a.active.bg=E?HV:uR(l),a.disablewrap=!0,a.active.rightedge=u;const[I]=v.errors??[],D=`${y+1}`.padStart(3," ");f9(`${y<r.length?D:"   "} ${O} `,a,!1);const V=1+a.y*a.width;h0(V,f.right,-e-3,-e,omt,a.active.bg,a);let G=-1;const Q=Di(o.cursor-v.start,1,v.end-v.start);if(xe(v.tokens))for(let B=0;B<v.tokens.length;++B){const $=v.tokens[B];E&&Q>=($.startColumn??1)&&Q<=($.endColumn??1)&&(G=B);const U=($.startColumn??1)-1-e,J=($.endColumn??1)-1-e,W=umt[$.tokenTypeIdx];if(xe(W))switch(W){case fP:{const q=Lie($.image);switch(n9("",q,!!$.payload).type){case hr.BOARD:case hr.LOADER:case hr.OBJECT:case hr.TERRAIN:case hr.CHARSET:case hr.PALETTE:{h0(V,f.right,U,J,fP,a.active.bg,a);break}case hr.CONST:case hr.RANGE:case hr.SELECT:case hr.NUMBER:case hr.TEXT:case hr.HOTKEY:case hr.COPYIT:case hr.OPENIT:case hr.ZSSEDIT:case hr.CHAREDIT:case hr.COLOREDIT:{const[ae]=q;h0(V,f.right,U,U+ae.length,fP,a.active.bg,a),q.length>1&&h0(V,f.right,U+ae.length+1,J,Tve,a.active.bg,a);break}default:h0(V,f.right,U,J,Sn.DKRED,a.active.bg,a);break}break}case ju:{h0(V,f.right,U,U,W,a.active.bg,a),U!==J&&h0(V,f.right,U+1,J,M2,a.active.bg,a);break}case M2:{const q=ymt($.image);if(bi(q))for(let Y=0;Y<q.length;++Y)h0(V,f.right,U+Y,J+Y,q[Y],a.active.bg,a);else h0(V,f.right,U,J,q,a.active.bg,a);break}default:h0(V,f.right,U,J,W,a.active.bg,a);break}}if(p&&v.start<=g&&v.end>=d){const B=Math.max(v.start,d)-v.start-e,$=Math.min(v.end,g)-v.start-e,U=f.width-3,J=Math.max(0,B),W=Math.min(U,$);J<=U&&W>=_&&h0(V,f.right,J,W,Qpt,Jpt,a)}if(E&&xe(v.tokens)){let B;if(xe(v.asts)){for(let $=0;$<(v.asts?.length??0);++$)v.asts[$].type===ir.IF&&(B=v.asts[$]);xe(B)||(B=v.asts.find($=>Q<=($.endColumn??0)))}hP=void 0;for(let $=G;$>=0;--$){const U=v.tokens[$-1],J=v.tokens[$],W=v.tokens[$+1];switch(J.tokenTypeIdx){case By.tokenTypeIdx:case uE.tokenTypeIdx:case cE.tokenTypeIdx:case fE.tokenTypeIdx:case OE.tokenTypeIdx:case cw.tokenTypeIdx:case hk.tokenTypeIdx:case dk.tokenTypeIdx:case pk.tokenTypeIdx:case lE.tokenTypeIdx:case fk.tokenTypeIdx:if(J.tokenTypeIdx===lE.tokenTypeIdx&&(!xe(B)||J.startColumn!==B.startColumn))continue;break;default:continue}switch(J.tokenTypeIdx){case By.tokenTypeIdx:{h_(`editor:command:${W.image}`);break}case uE.tokenTypeIdx:{h_("editor:command:do");break}case cE.tokenTypeIdx:{h_(U.tokenTypeIdx===fE.tokenTypeIdx?"editor:command:elseif":"editor:command:if");break}case fE.tokenTypeIdx:{h_(W.tokenTypeIdx===cE.tokenTypeIdx?"editor:command:elseif":"editor:command:else");break}case OE.tokenTypeIdx:{const q=Lie(J.image),Y=n9("",q,!!J.payload);h_(`editor:stat:${e1(Y.type)}`);break}case cw.tokenTypeIdx:{h_("editor:label");break}case hk.tokenTypeIdx:{h_("editor:comment");break}case dk.tokenTypeIdx:{h_("editor:hyperlink");break}case pk.tokenTypeIdx:{h_("editor:shorttry");break}case lE.tokenTypeIdx:{h_("editor:shortgo");break}case fk.tokenTypeIdx:{h_("editor:text");break}}break}Vn(hP?.desc)&&ci(hP.desc,a,!1)}if(M&&xe(x.errors)){a.x=N;const[B]=x.errors,$=`${B.message}`.replaceAll(`
`," ");f9($,a,!1),h0(V,f.right,0,$.length-1,Sn.WHITE,Pie,a)}else if(xe(I)){const B=3+(I.column??1),$=I.length??1;JJ(V,f.right,0,2,Pie,a),JJ(V,f.right,B,B+$-1,lmt,a)}if(++a.y,a.y>=f.bottom)break}return a.disablewrap=!1,a.active.rightedge=a.width,null}function TF(n){switch(n){case"stat":case"text":case"hyperlink":return!1;default:return!0}}Qa("a",ux);Qa("b",ux);Qa("c",ux);Qa("d",ux);Qa("e",ux);Qa("f",ux);Qa("g",ux);Qa("x",bmt);Qa("#",Cve);Qa("!",Cve);Qa("y",fx);Qa("t",fx);Qa("s",fx);Qa("i",fx);Qa("q",fx);Qa("h",fx);Qa("w",fx);Qa("3",Rve);Qa(".",Rve);Qa("+",Ave);Qa("-",Ave);Qa("0",sy);Qa("1",sy);Qa("2",sy);Qa("p",sy);Qa("4",sy);Qa("5",sy);Qa("6",sy);Qa("7",sy);Qa("8",sy);Qa("9",sy);Qa(";",ju);function Uie(){const n=ss(),[e]=ao(wd(Q=>[Q.editor])),[t,r,i,s,a,o,l,c,u,f,d]=Ts(wd(Q=>[Q.zsswords.cli,Q.zsswords.loader,Q.zsswords.runtime,Q.zsswords.flags,Q.zsswords.stats,Q.zsswords.kinds,Q.zsswords.altkinds,Q.zsswords.colors,Q.zsswords.dirs,Q.zsswords.dirmods,Q.zsswords.exprs]));it.useEffect(()=>{t.filter(TF).forEach(Q=>f_(Q,Rg)),r.filter(TF).forEach(Q=>f_(Q,Rg)),i.filter(TF).forEach(Q=>f_(Q,Rg)),s.forEach(Q=>f_(Q,fmt)),a.forEach(Q=>f_(Q,hmt)),o.forEach(Q=>f_(Q,dmt)),l.forEach(Q=>f_(Q,pmt)),c.forEach(Q=>f_(Q,mmt)),u.forEach(Q=>f_(Q,gmt)),f.forEach(Q=>f_(Q,_mt)),d.forEach(Q=>f_(Q,vmt))},[t,r,i,s,a,o,l,c,u,f,d]);const g=Fh(),p=_c(),_=Ume(ule(e.book,e.path)),y=W0(g);it.useEffect(()=>(TOe(xt,n,e.book,e.path),()=>{wOe(xt,n,e.book,e.path)}),[e.book,e.path,n]);const v=xe(_)?_.toJSON():"",x=nmt(v),E=imt(p.cursor,x),M=p.cursor-x[E].start,O=rmt(x),N=dge(v);if(xe(N.tokens)){let Q=!0;for(let B=0;B<N.tokens.length;++B){const $=N.tokens[B];$.tokenTypeIdx===OE.tokenTypeIdx&&($.payload=Q,Q=!1);const U=x[($.startLine??1)-1];xe(U)&&(U.tokens=U.tokens??[],U.tokens.push($))}}if(N?.ast?.type===ir.PROGRAM){fge(N.ast);const Q=[];for(let B=1;B<N.ast.lines.length;++B)Q.push(N.ast.lines[B]);for(;Q.length;){const B=Q.pop();if(Mn(B?.type)){switch(B.type){case ir.LINE:case ir.IF:if(Mn(B.startLine)){const U=x[B.startLine-1];U.asts=U.asts??[],U.asts.unshift(B)}break}const $=sb(B);for(let U=0;U<$.length;++U){const J=$[U],W=B[J];bi(W)?Q.push(...W):typeof W=="object"&&Q.push(W)}}}}if(xe(N.errors))for(let Q=0;Q<N.errors.length;++Q){const B=N.errors[Q],$=x[(B.line??1)-1];xe($)&&($.errors=$.errors??[],$.errors.push(B))}const I={rows:x,xcursor:M,ycursor:E,codepage:_,xoffset:-4+p.xscroll,yoffset:p.yscroll},D=32,V=(Math.round(O/D)+1)*D,G=x.length;return it.useEffect(()=>{setTimeout(()=>{_c.setState(Q=>{let B=Q.xscroll;const $=M-B,U=y.width-3;let J=Math.round(Di(Math.abs($)*.5,1,D));J<8&&(J=1),$>U-8&&(B+=J),$<8&&(B-=J);let W=Q.yscroll;const q=E-W,Y=y.height-4,ae=Math.round(Y*.5);let Z=Math.round(Di(Math.abs(q)*.25,1,ae));return Z<8&&(Z=1),q>Y-4&&(W+=Z),q<4&&(W-=Z),{xscroll:Math.round(Di(B,0,V)),yscroll:Math.round(Di(W,0,G))}})},16)},[M,V,p.xscroll,E,G,p.yscroll,y.width,y.height]),we.jsxs(we.Fragment,{children:[we.jsx(qV,{bump:!0}),we.jsx(Emt,{}),we.jsx(Tmt,{...I}),we.jsx(xmt,{...I})]})}function wmt(n,e,t,r){const i=n.slice(0,e),s=n.slice(e+t);return`${i}${r??""}${s}`}function Rmt(n){const[e,t]=n.split(":"),r=xe(t);return[r?e:"self",r?t:n]}const Amt=self.SpeechRecognition??self.webkitSpeechRecognition??self.mozSpeechRecognition??self.msSpeechRecognition??self.oSpeechRecognition;class Cmt{recognition;constructor(e,t,r,i=navigator.language){if(!("webkitSpeechRecognition"in window))throw new Error("This browser doesn't support speech recognition. Try Google Chrome.");this.recognition=new Amt,this.recognition.interimResults=!!r,this.recognition.lang=i;let s="";this.recognition.onresult=a=>{let o="";for(let l=a.resultIndex;l<a.results.length;l+=1){const c=a.results[l][0].transcript;a.results[l].isFinal?(s+=c,e(s),s=""):this.recognition.interimResults&&(o+=c,r(o))}},this.recognition.onend=()=>{t()}}startListening(){this.recognition.start()}stopListening(){this.recognition.stop()}}function Mmt({quickterminal:n,voice2text:e,tapeycursor:t,logrowtotalheight:r}){const i=Wg(),s=Fh(),a=Ko(),o=ss(),l=W0(s),c=a.buffer[a.bufferindex];let u=a.xcursor,f=a.xcursor,d=!1;xe(a.xselect)&&xe(a.yselect)&&(d=!0,u=Math.min(a.xcursor,a.xselect),f=Math.max(a.xcursor,a.xselect),a.xcursor!==a.xselect&&--f);const g=f-u+1,p=a.ycursor===0,_=d?c.substring(u,f+1):c,y=it.useCallback(function(G,Q,B){a.bufferindex>0&&Ko.setState({bufferindex:0}),a.buffer[0]=wmt(c,G,Q,B),Ko.setState({buffer:a.buffer,xselect:void 0,xcursor:G+(B??"").length})},[c,a.buffer,a.bufferindex]),v=it.useCallback(function(G){a.bufferindex>0&&Ko.setState({bufferindex:0}),a.buffer[0]=G,Ko.setState({buffer:a.buffer,xselect:void 0,xcursor:G.length})},[a.buffer,a.bufferindex]);function x(G){const Q=a.buffer.length-1,B=Di(G,0,Q);Ko.setState({bufferindex:B,xcursor:a.buffer[B].length,ycursor:0,xselect:void 0,yselect:void 0})}function E(G){G?xe(a.xselect)||Ko.setState({xselect:a.xcursor,yselect:a.ycursor}):Ko.setState({xselect:void 0,yselect:void 0})}function M(){xe(a.xselect)&&(Ko.setState({xcursor:u,xselect:void 0,yselect:void 0}),y(u,g))}function O(){Ko.setState({scroll:0,xcursor:c.length,ycursor:0,xselect:void 0,yselect:void 0})}if(s.reset.bg=uR(n),!n){b1(!1,0,0,s);const G="main:0.66.3 - if lost try #help";s.x=1,ci(`$dkcyan${G}`,s,!0)}const N="$196",D="$205".repeat(l.width-6);b1(!1,0,l.height-2,s),s.active.color=Sn.WHITE,ci(`  ${N}${D}${N}  `,s,!0);const V=c.padEnd(l.width," ");if(b1(!1,0,l.height-1,s),s.active.color=Sn.WHITE,f9(V,s,!0),xe(a.xselect)&&xe(a.yselect)&&a.xcursor!==a.xselect){const G=Math.min(a.xcursor,a.xselect),Q=Math.min(a.ycursor,a.yselect),B=Math.max(a.xcursor,a.xselect)-1,$=Math.max(a.ycursor,a.yselect);for(let U=Q;U<=$;++U){const J=G+(l.bottom-U)*l.width,W=B+(l.bottom-U)*l.width;fw(J,W,15,8,s)}}if(i){const G=l.left+a.xcursor,Q=l.top+t;if(Q>=l.top&&Q<=l.bottom&&G>=l.left&&G<=l.right){const B=G+Q*s.width;_U(B,"",s),fw(B,B,Sn.WHITE,s.reset.bg,s)}}return it.useEffect(()=>{let G;if(!e||!n)return;const{buffer:Q,bufferindex:B}=Ko.getState(),$=Q[B];function U(q){v(`${$}${q}`),setTimeout(()=>{p_.keyboard("[Enter]").catch(bm)},512)}function J(){}function W(q){v(`${$}${q}`)}try{G=new Cmt(U,J,W),G?.startListening()}catch(q){console.error(q.message)}return()=>{G?.stopListening(),G=void 0}},[e,n,v]),we.jsxs(we.Fragment,{children:[we.jsx(LV,{blocking:!0,x:l.left,y:l.top,width:l.width,height:l.height,onScroll:G=>{E(!1),Ko.setState({ycursor:Di(Math.round(a.ycursor-G),0,r)})}}),we.jsx(Vc,{keydown:G=>{const{key:Q}=G,B=qr(Q),$=a3(G);switch(B){case"arrowleft":E($.shift),$.ctrl?Ko.setState({xcursor:0}):Ko.setState({xcursor:Di(a.xcursor-($.alt?10:1),0,l.right)});break;case"arrowright":E($.shift),$.ctrl?Ko.setState({xcursor:p?c.length:l.right}):Ko.setState({xcursor:Di(a.xcursor+($.alt?10:1),0,l.right)});break;case"arrowup":$.ctrl?x(a.bufferindex+1):(E($.shift),Ko.setState({ycursor:Di(Math.round(a.ycursor+($.alt?10:1)),0,r)}));break;case"arrowdown":$.ctrl?x(a.bufferindex-1):(E($.shift),Ko.setState({ycursor:Di(Math.round(a.ycursor-($.alt?10:1)),0,r)}));break;case"enter":{const U=d?_:c;if(U.length)if(p){const J=["",U,...a.buffer.slice(1).filter(W=>W!==U)].filter(W=>W.includes("#broadcast")===!1);ket(J).catch(W=>Si(xt,o,"terminalinput",W.message)),Ko.setState({xcursor:0,bufferindex:0,xselect:void 0,yselect:void 0,buffer:J}),wv(xt,o,U),n&&gD(xt,o)}else O();break}case"esc":case"escape":gD(xt,o);break;case"tab":sle(xt,o,!$.shift);break;case"delete":p?d?M():c.length>0&&y(a.xcursor,1):O();break;case"backspace":p?d?M():a.xcursor>0&&y(a.xcursor-1,1):O();break;default:if($.ctrl)switch(B){case"e":wv(xt,o,"#export");break;case"p":fle(xt,o);break;case"a":Ko.setState({xselect:0,yselect:0,xcursor:c.length,ycursor:0});break;case"c":p&&xe(Qo())?Qo().writeText(_).catch(U=>console.error(U)):O();break;case"v":p&&xe(Qo())?Qo().readText().then(U=>{try{const W=JSON.parse(U);if(Vn(W.exported)&&xe(W.data)){T_(xt,o,void 0,"json",`file:${W.exported}`,JSON.stringify(W));return}}catch(W){console.error(W)}const J=U.replaceAll("\r","");d?y(u,g,J):y(a.xcursor,0,J)}).catch(U=>console.error(U)):O();break;case"x":p&&xe(Qo())?Qo().writeText(_).then(()=>M()).catch(U=>console.error(U)):O();break}else $.alt||G.key.length===1&&(p&&a.xcursor<=c.length?d?(y(u,g,G.key),Ko.setState({xselect:void 0})):y(a.xcursor,0,G.key):O());break}}})]})}function kmt({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useCallback(()=>{setTimeout(()=>{if(xe(Qo())){const[,...l]=r,c=l.join(" ");Qo().writeText(c).then(()=>Ny(xt,ss(),"copied!")).catch(u=>console.error(u))}},100)},[r]),o=Xm(!!n);return b1(!!n,0,i,s),ci(`${e} $purple$16 $yellowCOPYIT ${o}${t}`,s,!0),n&&we.jsx(Vc,{OK_BUTTON:a})}function Omt({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useContext(xve),o=it.useCallback(()=>{const[c,...u]=r;setTimeout(()=>{a.sendmessage(c,u)},100)},[r,a]),l=Xm(!!n);return b1(!!n,0,i,s),ci(`${e} $purple$16 ${l}${t}`,s,!0),n&&we.jsx(Vc,{OK_BUTTON:o})}function Imt({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),a=it.useCallback(()=>{const[,l,...c]=r,u=c.join(" ");setTimeout(()=>{const f=ss();switch(l){case"wiki":Fc(xt,f,async()=>{const d=await Cj(u);Hj(f,d)});break;case"inline":window.location.href=u;break;default:window.open(`${l} ${u}`.trim(),"_blank");break}},100)},[r]),o=Xm(!!n);return b1(!!n,0,i,s),ci(`${e} $purple$16 $yellowOPENIT ${o}${t}`,s,!0),n&&we.jsx(Vc,{OK_BUTTON:a})}function Nmt({active:n,prefix:e,label:t,words:r,y:i}){const s=Fh(),{setviewimage:a}=qc(),o=it.useCallback(()=>{const[,...c]=r,u=c.join(" ");setTimeout(()=>a(u),100)},[a,r]),l=Xm(!!n);return b1(!!n,0,i,s),ci(`${e} $purple$16 $CYANVIEWIT ${l}${t}`,s,!0),n&&we.jsx(Vc,{OK_BUTTON:o})}function kve({active:n,text:e,y:t}){const r=Fh(),{quickterminal:i}=ao(),s=W0(r),a=e.startsWith("!");b1(!!n,0,t,r),r.reset.bg=n?HV:uR(i),r.active.bottomedge=s.bottom;const o=$H(e);if(xe(o)){const l=s.width-3,u=W1(o,l,3)?.measuredwidth??1,f=Di(Math.floor(l*.5-u*.5),0,l);ci(`${" ".repeat(f)}$WHITE${o}`,r,!0)}else ci(a?"":e,r,!0);if(a){const[l,...c]=e.slice(1).split("!"),u=`${c.join("!")}`;let f="PRESS ME";const d=[],g=EO(u,!0);for(let v=0;v<g.tokens.length;v++){const x=g.tokens[v];switch(x.tokenType){case gU:f=x.image.slice(1);break;default:d.push(x.image);break}}const[p,..._]=d,y={active:n,prefix:l,label:f,words:_,y:t};switch(qr(p)){case"copyit":return we.jsx(kmt,{...y,words:d});case"openit":return we.jsx(Imt,{...y,words:d});case"viewit":return we.jsx(Nmt,{...y,words:d});default:case"hyperlink":return we.jsx(Omt,{...y,words:d});case"hk":case"hotkey":return null;case"rn":case"range":return null;case"sl":case"select":return null;case"nm":case"number":return null;case"tx":case"text":return null;case"zssedit":return null;case"charedit":return null;case"coloredit":return null}}return null}function Pmt({active:n,text:e,y:t}){return Wg(),we.jsx(kve,{active:n,text:e,y:t})}function Dmt(n,e,t){return n.startsWith("!")?1:W1(n,e,t)?.y??1}function Lmt(){const[n]=ao(wd(f=>[f.editor.open])),e=ao(wd(f=>f.terminal.logs)),t=Fh(),r=Ko(),i=W0(t),s=t.width-1,a=e.map(f=>Dmt(f,s,i.height)),o=i.bottom-i.top-(n?0:2);let l=o+1;const c=a.map(f=>(l-=f,l)),u=i.bottom-r.ycursor+r.scroll;return we.jsx(we.Fragment,{children:we.jsx(kO.Provider,{value:t,children:e.map((f,d)=>{const g=c[d]+r.scroll,p=a[d],_=g+p;return _<0||g<0||g>o?null:!n&&u>=g&&u<_?we.jsx(Pmt,{active:!0,text:f,y:g},d):we.jsx(kve,{text:f,y:g},d)})})})}function Umt(n,e,t){return n.startsWith("!")?1:W1(n,e,t)?.y??1}function Bie(){const n=ss(),{quickterminal:e}=ao(),[t]=ao(wd(_=>[_.editor.open])),r=ao(wd(_=>_.terminal.logs)),[i,s]=it.useState(!1);it.useLayoutEffect(()=>{Fc(xt,ss(),async()=>{await w2("voice2text")==="on"&&s(!0)})},[]);const a=Fh(),o=Ko(),l=W0(a),c=emt(a.width),u=a.width-c-1,f=r.map(_=>Umt(_,u,l.height)),d=l.bottom-l.top-(t?0:2);let g=0;f.forEach(_=>{g+=_}),++g;const p=l.bottom-o.ycursor+o.scroll;return it.useEffect(()=>{setTimeout(()=>{Ko.setState(_=>{const y=l.bottom-o.ycursor+o.scroll;let v=_.scroll;return y<5&&v++,y>l.bottom-10&&v--,v=Math.round(Di(v,0,g-d)),{scroll:v}})},16)},[d,l.bottom,g,o.scroll,o.ycursor]),we.jsxs(we.Fragment,{children:[we.jsx(qV,{}),we.jsxs(xve.Provider,{value:{sendmessage(_,y){const[v,x]=Rmt(_);if(v==="self"){const E=`#${x} ${y.join(" ")}`;wv(xt,n,E)}else xt.emit(n,`${v}:${x}`,y)}},children:[we.jsx(Lmt,{}),!t&&we.jsx(Mmt,{quickterminal:e,voice2text:i,tapeycursor:p,logrowtotalheight:g})]})]})}function Bmt(n,e,t,r,i){return{...i,x:n,y:e,reset:{...Sl(i.reset),topedge:e,leftedge:n,rightedge:t,bottomedge:r},active:{...Sl(i.active),topedge:e,leftedge:n,rightedge:t,bottomedge:r}}}function EN({quickterminal:n,top:e,width:t,height:r,children:i}){const s=uR(n),a=Zw(t,r,0,PL,s),o=it.useMemo(()=>Bmt(0,0,t-1,r-1,{...yb(t,r,PL,s),...a.getState()}),[s,t,r,a]);return we.jsxs(lR,{store:a,children:[we.jsxs(kO.Provider,{value:o,children:[we.jsx(qV,{}),i]}),we.jsx("group",{position:[0,e*Gn.DRAW_CHAR_HEIGHT(),0],children:we.jsx(cR,{width:t,height:r})})]})}function Fmt({quickterminal:n,top:e,width:t,height:r}){const[i,s]=ao(wd(a=>[a.layout,a.editor.open]));if(s)switch(i){case A0.SPLIT_X:return we.jsxs(it.Fragment,{children:[we.jsx(EN,{quickterminal:n,top:e,width:Math.round(t*1.5),height:r,children:we.jsx(Bie,{})}),we.jsx(EN,{quickterminal:n,top:e,width:tmt(t),height:r,children:we.jsx(Uie,{})})]},"layout");default:return we.jsx(EN,{quickterminal:n,top:e,width:t,height:r,children:we.jsx(Uie,{})},"layout")}return we.jsx(EN,{quickterminal:n,top:e,width:Math.round(t*1.5),height:r,children:we.jsx(Bie,{})},"layout")}function zmt(){const n=Rb(),[e,t,r,i]=ao(wd(c=>[c.layout,c.quickterminal,c.terminal.open,c.editor.open]));let s=0,a=n.rows;switch(e){case A0.TOP:a=Math.floor(n.rows*.5);break;case A0.BOTTOM:a=Math.ceil(n.rows*.5),s=n.rows-a;break;default:case A0.FULL:break}if(n.cols<10||n.rows<10)return null;const o=ss(),l=t||r||i;return we.jsxs(we.Fragment,{children:[l&&we.jsx(IV,{width:n.cols,height:n.rows,top:s,left:0,right:n.cols-1,bottom:s+a-1,alpha:t?.666:.333}),l?we.jsx(J1,{blockhotkeys:!0,children:we.jsx(Fmt,{quickterminal:t,top:s,width:n.cols,height:a})}):we.jsx(PT,{hotkey:"Shift+?",althotkey:"/",children:()=>lOe(xt,o)})]})}const jmt=`
// CRT Emulation
// by Mattias

vec3 sample_(sampler2D tex, vec2 tc) {
	vec3 s = pow(texture2D(tex, tc).rgb, vec3(2.0));
	return s;
}

vec3 blur(sampler2D tex, vec2 tc, float offs) {
	vec4 xoffs = offs * vec4(-2.0, -1.0, 1.0, 2.0) * texelSize.x * 0.01;
	vec4 yoffs = offs * vec4(-2.0, -1.0, 1.0, 2.0) * texelSize.y * 0.001;
	
	vec3 color = vec3(0.0, 0.0, 0.0);
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.x)) * 0.00366;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.x)) * 0.01465;
	color += sample_(tex, tc + vec2(    0.0, yoffs.x)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.x)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.x)) * 0.00366;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.y)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.y)) * 0.05861;
	color += sample_(tex, tc + vec2(    0.0, yoffs.y)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.y)) * 0.05861;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.y)) * 0.01465;
	
	color += sample_(tex, tc + vec2(xoffs.x, 0.0)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.y, 0.0)) * 0.09524;
	color += sample_(tex, tc + vec2(    0.0, 0.0)) * 0.15018;
	color += sample_(tex, tc + vec2(xoffs.z, 0.0)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.w, 0.0)) * 0.02564;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.z)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.z)) * 0.05861;
	color += sample_(tex, tc + vec2(    0.0, yoffs.z)) * 0.09524;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.z)) * 0.05861;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.z)) * 0.01465;
	
	color += sample_(tex, tc + vec2(xoffs.x, yoffs.w)) * 0.00366;
	color += sample_(tex, tc + vec2(xoffs.y, yoffs.w)) * 0.01465;
	color += sample_(tex, tc + vec2(    0.0, yoffs.w)) * 0.02564;
	color += sample_(tex, tc + vec2(xoffs.z, yoffs.w)) * 0.01465;
	color += sample_(tex, tc + vec2(xoffs.w, yoffs.w)) * 0.00366;

	return color;
}

float rand(vec2 co) {
  float a = 12.9898;
  float b = 78.233;
  float c = 43758.5453;
  float dt = dot(co.xy, vec2(a, b));
  float sn = mod(dt, 3.14);
  return fract(sin(sn) * c);
}

void mainImage(const in vec4 inputColor, const in vec2 uv, out vec4 outputColor) {
  vec3 col;  
  col.r = 1.0 * blur(inputBuffer, vec2(uv.x + 0.0009, uv.y + 0.0009), 1.2).x + 0.005;
  col.g = 1.0 * blur(inputBuffer, vec2(uv.x + 0.000, uv.y - 0.0015), 1.2).y + 0.005;
  col.b = 1.0 * blur(inputBuffer, vec2(uv.x - 0.0015, uv.y + 0.000), 1.2).z + 0.005;  

  col.r += 0.2 * blur(inputBuffer, vec2(uv.x + 0.0009, uv.y + 0.0009), 2.25).x - 0.005;
  col.g += 0.2 * blur(inputBuffer, vec2(uv.x + 0.000, uv.y - 0.0015), 1.75).y - 0.005;
  col.b += 0.2 * blur(inputBuffer, vec2(uv.x - 0.0015, uv.y + 0.000), 1.25).z - 0.005;
  
  float ghs = 0.05;
	float gphase = 0.371 * sin(time * 0.1);
	col.r += ghs * (1.0 - 0.299) * blur(inputBuffer, gphase * vec2(0.01, -0.027) + vec2(uv.x + 0.001, uv.y + 0.001), 7.0).x;
  col.g += ghs * (1.0 - 0.587) * blur(inputBuffer, gphase * vec2(-0.022, -0.02) + vec2(uv.x + 0.000, uv.y - 0.002), 5.0).y;
  col.b += ghs * (1.0 - 0.114) * blur(inputBuffer, gphase * vec2(-0.02, -0.0) + vec2(uv.x - 0.002, uv.y + 0.000), 3.0).z;

  col = clamp(col * 0.4 + 0.6 * col * 1.0, 0.0, 1.0);
	col = mix(col, col * col * col * col * col * col, 0.5) * 3.8;

	float scans = clamp(0.35 + 0.15 * sin(3.5 * (time * 0.125) + uv.y * resolution.y * 1.5), 0.0, 1.0);
	float s = pow(scans, 0.999);
	col = col * vec3(s);

  col *= 1.0 + 0.0015 * sin(500.0 * time);
  col *= 1.0 - 0.15 * vec3(clamp((mod(uv.x * texelSize.x, 2.0) - 1.0) * 2.0, 0.0, 1.0));
	
  col *= vec3(1.0) - 0.25 * vec3(
   rand(uv + 0.0001 * time), 
   rand(uv + 0.0001 * time + 0.3), 
   rand(uv + 0.0001 * time + 0.5));
	col = pow(col, vec3(0.45));

  outputColor = vec4(col.rgb, 1.0);
}
`;class Hmt extends L_{constructor(){super("ScanlinesEffect",jmt,{blendFunction:Es.NORMAL,attributes:Lm.CONVOLUTION,defines:new Map([]),uniforms:new Map([])})}update(){}}const qmt=r3(Hmt),Fie=n=>(n.getAttributes()&Lm.CONVOLUTION)===Lm.CONVOLUTION,Vmt=it.memo(it.forwardRef(({children:n,width:e,height:t},r)=>{const{gl:i,scene:s,camera:a}=Im(),[o]=it.useMemo(()=>{const u=new K_e(i,{depthBuffer:!0,stencilBuffer:!1,multisampling:0,frameBufferType:db});return u.addPass(new Q_e(s,a)),[u]},[a,i,s]);Gg((u,f)=>{const d=i.autoClear;i.autoClear=!0,o.setSize(e,t),o.render(f),i.autoClear=d},2);const l=it.useRef(null);it.useLayoutEffect(()=>{const u=[],f=l.current.__r3f;if(f&&o){const d=f.children;for(let g=0;g<d.length;g++){const p=d[g].object;if(p instanceof L_){const _=[p];if(!Fie(p)){let v=null;for(;(v=d[g+1]?.object)instanceof L_&&!Fie(v);)_.push(v),g++}const y=new J_e(a,..._);u.push(y)}else p instanceof Ym&&u.push(p)}for(const g of u)o?.addPass(g)}return()=>{for(const d of u)o?.removePass(d)}},[o,n,a]);const c=it.useMemo(()=>({composer:o,normalPass:null,downSamplingPass:null,resolutionScale:void 0,camera:a,scene:s}),[o,a,s]);return it.useImperativeHandle(r,()=>o,[o]),we.jsx(CV.Provider,{value:c,children:we.jsx("group",{ref:l,children:n})})}));function Gmt({context:n}){return we.jsx("group",{position:[0,0,999],children:we.jsx(cR,{width:n.width,height:n.height})})}function $mt(){const{toast:n}=ao(),e=Rb(),t=Zw(e.cols,1,0,Sn.GREEN,Sn.ONCLEAR),r={...yb(e.cols,1,Sn.GREEN,Sn.ONCLEAR,0,0,e.cols-1,1),...t.getState()};if(e.cols<10||e.rows<10)return null;const i=e.cols-1;return we.jsx(lR,{store:t,children:n&&we.jsxs(we.Fragment,{children:[we.jsx(UV,{margin:1,color:Sn.YELLOW,y:0,leftedge:0,rightedge:i,line:n,context:r}),we.jsx("group",{position:[0,0,998],children:we.jsx(IV,{alpha:.4,width:e.cols,height:10,top:0,left:0,right:i,bottom:0})}),we.jsx(Gmt,{context:r})]})})}function Wmt({url:n,drawwidth:e,drawheight:t}){const r=tj(noe,n);it.useEffect(()=>{r.flipY=!0,yge(r)},[r]);const{width:i=1,height:s=1}=r?.image??{},a=Math.min(e/i,t/s),o=i*a,l=s*a;return we.jsxs("mesh",{children:[we.jsx("planeGeometry",{args:[o,l]}),we.jsx("meshBasicMaterial",{map:r})]})}function Ymt(){const n=Rb(),{viewimage:e,setviewimage:t}=qc();if(n.cols<10||n.rows<10)return null;const r=n.cols-1,i=n.rows-1,s=(n.cols-4)*Gn.DRAW_CHAR_WIDTH(),a=(n.rows-2)*Gn.DRAW_CHAR_HEIGHT(),o=n.cols*Gn.DRAW_CHAR_WIDTH()*.5,l=n.rows*Gn.DRAW_CHAR_HEIGHT()*.5;return e&&we.jsxs(J1,{children:[we.jsx(Vc,{CANCEL_BUTTON:()=>t("")}),we.jsxs("group",{position:[0,0,998],children:[we.jsx(IV,{alpha:.4,width:n.cols,height:n.rows,top:0,left:0,right:r,bottom:i}),we.jsx("group",{position:[o,l,1],"scale-x":-1,"rotation-z":Math.PI,children:we.jsx(it.Suspense,{fallback:null,children:we.jsx(Wmt,{url:e,drawwidth:s,drawheight:a})})})]})]})}var Ove=(n=>(n[n.id=0]="id",n[n.x=1]="x",n[n.y=2]="y",n[n.char=3]="char",n[n.color=4]="color",n[n.bg=5]="bg",n[n.stat=6]="stat",n[n.pid=7]="pid",n))(Ove||{});function Xmt(n){return Xj(n,Ove)}var Ive=(n=>(n[n.id=0]="id",n[n.type=1]="type",n[n.tag=2]="tag",n[n.width=3]="width",n[n.height=4]="height",n[n.char=5]="char",n[n.color=6]="color",n[n.bg=7]="bg",n[n.stats=8]="stats",n[n.sprites=9]="sprites",n[n.alphas=10]="alphas",n[n.mime=11]="mime",n[n.media=12]="media",n[n.focusx=13]="focusx",n[n.focusy=14]="focusy",n[n.focusid=15]="focusid",n[n.viewscale=16]="viewscale",n[n.graphics=17]="graphics",n[n.facing=18]="facing",n))(Ive||{});function Kmt(n){return Xj(n,Ive,{sprites:e=>e.map(Xmt)})}var Nve=(n=>(n[n.id=0]="id",n[n.board=1]="board",n[n.over=2]="over",n[n.under=3]="under",n[n.layers=4]="layers",n[n.tickers=5]="tickers",n[n.scrollname=6]="scrollname",n[n.scroll=7]="scroll",n[n.sidebar=8]="sidebar",n))(Nve||{});function zie(n){return Xj(n,Nve,{layers:e=>e.map(Kmt)})}const jie=H1("gadgetclient",[],n=>{if(!jie.session(n)||n.player!==ss())return;const{desync:e}=Ts.getState();switch(n.target){case"paint":{const t=zie(n.data);Ts.setState({desync:!1,gadget:t,slim:n.data});break}case"patch":e||Ts.setState(t=>{let r;try{const i=A4(Sl(t.slim),n.data,!0,!0),s=zie(i.newDocument);return{...t,gadget:s,slim:i.newDocument}}catch(i){r=i}return xe(r)?(jie.reply(n,"desync"),{...t,desync:!0}):t});break}}),VV=Object.prototype.toString.call(typeof xl<"u"?xl:0)==="[object process]";var Wb,ti;(function(n){n[n.CRITICAL=0]="CRITICAL",n[n.ERROR=1]="ERROR",n[n.WARNING=2]="WARNING",n[n.INFO=3]="INFO",n[n.DEBUG=4]="DEBUG",n[n.TRACE=7]="TRACE"})(ti||(ti={}));function GV(n){if(typeof n=="number"){if(Object.prototype.hasOwnProperty.call(ti,n))return n;var e=Object.keys(ti).map(function(r){return parseInt(r,10)}).filter(function(r){return!isNaN(r)&&r<n});return e.length?Math.max.apply(Math,e):ti.WARNING}var t=n.replace(/\d+$/,"").toUpperCase();if(!Object.prototype.hasOwnProperty.call(ti,t))throw new Error("Unknown log level string: ".concat(n));return ti[t]}var Zmt=VV?console.log.bind(console):console.debug.bind(console),Pve=(Wb={},Wb[ti.CRITICAL]=console.error.bind(console),Wb[ti.ERROR]=console.error.bind(console),Wb[ti.WARNING]=console.warn.bind(console),Wb[ti.INFO]=console.info.bind(console),Wb[ti.DEBUG]=Zmt.bind(console),Wb[ti.TRACE]=console.trace.bind(console),Wb);function tS(n){return function(e,t){Object.defineProperty(e,t,{get:function(){},set:function(r){Object.defineProperty(this,t,{value:r,writable:!0,enumerable:n})},enumerable:n})}}function Q9(n){return Ec(this,void 0,Promise,function(){return zq(this,function(e){switch(e.label){case 0:return typeof n!="function"?[3,2]:[4,n()];case 1:return[2,e.sent()];case 2:return[2,n]}})})}function Qmt(n){return typeof n=="function"?n():n}function Dve(n){var e,t,r;return zq(this,function(i){switch(i.label){case 0:e=0,t=1,i.label=1;case 1:return e<n?[4,e]:[3,3];case 2:return i.sent(),r=UU([t,e+t],2),e=r[0],t=r[1],[3,1];case 3:return[4,n];case 4:return i.sent(),[3,3];case 5:return[2]}})}function xN(n,e){return Object.assign.apply(Object,L9([{}],UU(n.map(e)),!1))}function J9(n,e){Object.entries(n).forEach(function(t){var r=UU(t,2),i=r[0],s=r[1];return e(s,i)})}function Lve(n){return n==null}function zk(n,e){return Lve(n)?null:e(n)}function Uve(n,e){return Lve(n)?void 0:e(n)}function Jmt(n){return Ec(this,void 0,Promise,function(){return zq(this,function(e){switch(e.label){case 0:return[4,new Promise(function(t){return setTimeout(t,n)})];case 1:return e.sent(),[2]}})})}function ez(){var n,e,t=new Promise(function(r,i){n=r,e=i});return{promise:t,resolve:n,reject:e}}function egt(n,e,t){if(typeof n=="number"&&(n=n.toString()),e=e-n.length,e<=0)return n;t===void 0&&(t=" ");var r="";do(e&1)===1&&(r+=t),e>>=1,e&&(t+=t);while(e);return r+n}function pE(n,e,t){var r=n.split(e);return r.length<=t?r:L9(L9([],UU(r.slice(0,t-1)),!1),[r.slice(t-1).join(e)],!1)}var tgt={},wF,RF,DL=typeof xl>"u"?[]:(RF=(wF=tgt.LOGGING)===null||wF===void 0?void 0:wF.split(";").map(function(n){var e=n.split("=",2),t=e[0],r=e[1];return r?[t==="default"?void 0:t.split(":"),GV(r)]:null}).filter(function(n){return!!n}).sort(function(n,e){var t,r,i=n[0],s=e[0];return((t=s?.length)!==null&&t!==void 0?t:0)-((r=i?.length)!==null&&r!==void 0?r:0)}))!==null&&RF!==void 0?RF:[],AF=DL.findIndex(function(n){var e=n[0];return!e}),Bve=void 0;AF!==-1&&(Bve=DL[AF][1],DL.splice(AF));function ngt(n,e){return e.length<=n.length&&e.every(function(t,r){return t===n[r]})}function Fve(n){for(var e=n.split(":"),t=0,r=DL;t<r.length;t++){var i=r[t],s=i[0],a=i[1];if(ngt(e,s))return a}return Bve}var zve=(function(){function n(e){var t=e.name,r=e.minLevel,i=e.emoji,s=i===void 0?!1:i,a=e.colors,o=e.timestamps,l=o===void 0?VV:o,c,u;this._name=t,this._minLevel=(u=(c=Uve(r,function(f){return GV(f)}))!==null&&c!==void 0?c:Fve(t))!==null&&u!==void 0?u:ti.WARNING,this._emoji=s,this._colors=a,this._timestamps=l}return n.prototype.crit=function(e){this.log(ti.CRITICAL,e)},n.prototype.error=function(e){this.log(ti.ERROR,e)},n.prototype.warn=function(e){this.log(ti.WARNING,e)},n.prototype.info=function(e){this.log(ti.INFO,e)},n.prototype.debug=function(e){this.log(ti.DEBUG,e)},n.prototype.trace=function(e){this.log(ti.TRACE,e)},n})(),rgt=(function(n){A0e(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){if(!(t>this._minLevel)){var i=Pve[t],s="[".concat(this._name,"] ").concat(r);this._timestamps&&(s="[".concat(new Date().toISOString(),"] ").concat(r)),i(s)}},e})(zve),igt=(function(){function n(e){var t=e.name,r=e.minLevel,i=e.custom,s;this._minLevel=(s=Uve(r,function(a){return GV(a)}))!==null&&s!==void 0?s:Fve(t),this._override=typeof i=="function"?{log:i}:i}return n.prototype.log=function(e,t){this._shouldLog(e)&&this._override.log(e,t)},n.prototype.crit=function(e){this._override.crit?this._shouldLog(ti.CRITICAL)&&this._override.crit(e):this.log(ti.CRITICAL,e)},n.prototype.error=function(e){this._override.error?this._shouldLog(ti.ERROR)&&this._override.error(e):this.log(ti.ERROR,e)},n.prototype.warn=function(e){this._override.warn?this._shouldLog(ti.WARNING)&&this._override.warn(e):this.log(ti.WARNING,e)},n.prototype.info=function(e){this._override.info?this._shouldLog(ti.INFO)&&this._override.info(e):this.log(ti.INFO,e)},n.prototype.debug=function(e){this._override.debug?this._shouldLog(ti.DEBUG)&&this._override.debug(e):this.log(ti.DEBUG,e)},n.prototype.trace=function(e){this._override.trace?this._shouldLog(ti.TRACE)&&this._override.trace(e):this.log(ti.TRACE,e)},n.prototype._shouldLog=function(e){return this._minLevel===void 0||this._minLevel>=e},n})(),Yb,Xb,Kb,sgt=(Yb={},Yb[ti.CRITICAL]="",Yb[ti.ERROR]="",Yb[ti.WARNING]=" ",Yb[ti.INFO]=" ",Yb[ti.DEBUG]="",Yb[ti.TRACE]="",Yb),agt={black:30,red:31,green:32,yellow:33,blue:34,magenta:35,cyan:36,white:37,blackBright:90,redBright:91,greenBright:92,yellowBright:93,blueBright:94,magentaBright:95,cyanBright:96,whiteBright:97},ogt={bgBlack:40,bgRed:41,bgGreen:42,bgYellow:43,bgBlue:44,bgMagenta:45,bgCyan:46,bgWhite:47,bgBlackBright:100,bgRedBright:101,bgGreenBright:102,bgYellowBright:103,bgBlueBright:104,bgMagentaBright:105,bgCyanBright:106,bgWhiteBright:107};function i5(n,e,t){return function(r){return"\x1B[".concat(n,"m").concat(t?t(r):r,"\x1B[").concat(e,"m")}}function xv(n){return i5(agt[n],39)}function VM(n,e){return i5(ogt[n],49,e)}var lgt=(Xb={},Xb[ti.CRITICAL]=xv("red"),Xb[ti.ERROR]=xv("redBright"),Xb[ti.WARNING]=xv("yellow"),Xb[ti.INFO]=xv("blue"),Xb[ti.DEBUG]=xv("magenta"),Xb[ti.TRACE]=i5(0,0),Xb),Hie=(Kb={},Kb[ti.CRITICAL]=VM("bgRed",xv("white")),Kb[ti.ERROR]=VM("bgRedBright",xv("white")),Kb[ti.WARNING]=VM("bgYellow",xv("black")),Kb[ti.INFO]=VM("bgBlue",xv("white")),Kb[ti.DEBUG]=VM("bgMagenta",xv("black")),Kb[ti.TRACE]=i5(7,27),Kb),cgt=(function(n){A0e(e,n);function e(){return n!==null&&n.apply(this,arguments)||this}return e.prototype.log=function(t,r){var i,s,a;if(!(t>this._minLevel)){var o=Pve[t],l="";if(this._timestamps&&(l+="[".concat(new Date().toISOString(),"] ")),this._emoji){var c=sgt[t];l+="".concat(c," ")}var u=(a=(i=this._colors)!==null&&i!==void 0?i:(s=xl.stdout)===null||s===void 0?void 0:s.isTTY)!==null&&a!==void 0?a:!0;u?l+="".concat(Hie[t](this._name)," ").concat(Hie[t](ti[t])," ").concat(lgt[t](r)):l+="[".concat(this._name,":").concat(ti[t].toLowerCase(),"] ").concat(r),o(l)}},e})(zve);function s5(n){return n.custom?new igt(n):VV?new cgt(n):new rgt(n)}let jve=class extends Error{constructor(...e){var t;super(...e),Object.setPrototypeOf(this,new.target.prototype),(t=Error.captureStackTrace)===null||t===void 0||t.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}};class LL extends jve{}class Hve extends jve{}class ugt{constructor({logger:e,bucketSize:t,timeFrame:r,doRequest:i,getPartitionKey:s}){this._partitionedQueue=new Map,this._usedFromBucket=new Map,this._counterTimers=new Set,this._paused=!1,this._destroyed=!1,this._logger=s5({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=t,this._timeFrame=r,this._callback=i,this._partitionKeyCallback=s}async request(e,t){return await new Promise((r,i)=>{var s,a;if(this._destroyed){i(new LL("Rate limiter was destroyed"));return}const o={req:e,resolve:r,reject:i,limitReachedBehavior:(s=t?.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"},l=this._partitionKeyCallback(e),c=(a=this._usedFromBucket.get(l))!==null&&a!==void 0?a:0;if(c>=this._bucketSize||this._paused)switch(o.limitReachedBehavior){case"enqueue":{const u=this._getPartitionedQueue(l);u.push(o),c+u.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} for ${l?`partition ${l}`:"default partition"} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${u.length}`):this._logger.info(`Enqueueing request for ${l?`partition ${l}`:"default partition"} because the rate limiter is paused; queue size is ${u.length}`);break}case"null":{o.resolve(null),this._paused?this._logger.info(`Returning null for request for ${l?`partition ${l}`:"default partition"} because the rate limiter is paused`):this._logger.warn(`Rate limit of ${this._bucketSize} for ${l?`partition ${l}`:"default partition"} was reached, dropping request and returning null`);break}case"throw":{o.reject(new Hve(`Request dropped because ${this._paused?"the rate limiter is paused":`the rate limit for ${l?`partition ${l}`:"default partition"} was reached`}`));break}default:throw new Error("this should never happen")}else this._runRequest(o,l)})}clear(){this._partitionedQueue.clear()}pause(){this._paused=!0}resume(){this._paused=!1;for(const e of this._partitionedQueue.keys())this._runNextRequest(e)}destroy(){this._paused=!1,this._destroyed=!0,this._counterTimers.forEach(e=>{clearTimeout(e)});for(const e of this._partitionedQueue.values())for(const t of e)t.reject(new LL("Rate limiter was destroyed"));this._partitionedQueue.clear()}_getPartitionedQueue(e){if(this._partitionedQueue.has(e))return this._partitionedQueue.get(e);const t=[];return this._partitionedQueue.set(e,t),t}async _runRequest(e,t){var r;const i=this._getPartitionedQueue(t);this._logger.debug(`doing a request for ${t?`partition ${t}`:"default partition"}, new queue length is ${i.length}`),this._usedFromBucket.set(t,((r=this._usedFromBucket.get(t))!==null&&r!==void 0?r:0)+1);const{req:s,resolve:a,reject:o}=e;try{a(await this._callback(s))}catch(l){o(l)}finally{const l=setTimeout(()=>{this._counterTimers.delete(l);const c=this._usedFromBucket.get(t)-1;this._usedFromBucket.set(t,c),i.length&&c<this._bucketSize&&this._runNextRequest(t)},this._timeFrame);this._counterTimers.add(l)}}_runNextRequest(e){if(this._paused)return;const r=this._getPartitionedQueue(e).shift();r&&this._runRequest(r,e)}}class tz{constructor({logger:e,bucketSize:t,timeFrame:r,doRequest:i}){this._queue=[],this._usedFromBucket=0,this._counterTimers=new Set,this._paused=!1,this._destroyed=!1,this._logger=s5({name:"rate-limiter",emoji:!0,...e}),this._bucketSize=t,this._timeFrame=r,this._callback=i}async request(e,t){return await new Promise((r,i)=>{var s;if(this._destroyed){i(new LL("Rate limiter was destroyed"));return}const a={req:e,resolve:r,reject:i,limitReachedBehavior:(s=t?.limitReachedBehavior)!==null&&s!==void 0?s:"enqueue"};if(this._usedFromBucket>=this._bucketSize||this._paused)switch(a.limitReachedBehavior){case"enqueue":{this._queue.push(a),this._usedFromBucket+this._queue.length>=this._bucketSize?this._logger.warn(`Rate limit of ${this._bucketSize} was reached, waiting for ${this._paused?"the limiter to be unpaused":"a free bucket entry"}; queue size is ${this._queue.length}`):this._logger.info(`Enqueueing request because the rate limiter is paused; queue size is ${this._queue.length}`);break}case"null":{a.resolve(null),this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`),this._paused?this._logger.info("Returning null for request because the rate limiter is paused"):this._logger.warn(`Rate limit of ${this._bucketSize} was reached, dropping request and returning null`);break}case"throw":{a.reject(new Hve(`Request dropped because ${this._paused?"the rate limiter is paused":"the rate limit was reached"}`));break}default:throw new Error("this should never happen")}else this._runRequest(a)})}clear(){this._queue=[]}pause(){this._paused=!0}resume(){this._paused=!1,this._runNextRequest()}destroy(){this._paused=!1,this._destroyed=!0,this._counterTimers.forEach(e=>{clearTimeout(e)});for(const e of this._queue)e.reject(new LL("Rate limiter was destroyed"));this._queue=[]}async _runRequest(e){this._logger.debug(`doing a request, new queue length is ${this._queue.length}`),this._usedFromBucket+=1;const{req:t,resolve:r,reject:i}=e;try{r(await this._callback(t))}catch(s){i(s)}finally{const s=setTimeout(()=>{this._counterTimers.delete(s),this._usedFromBucket-=1,this._queue.length&&this._usedFromBucket<this._bucketSize&&this._runNextRequest()},this._timeFrame);this._counterTimers.add(s)}}_runNextRequest(){if(this._paused)return;const e=this._queue.shift();e&&this._runRequest(e)}}class fgt extends tz{constructor(e,t){super({...t,async doRequest(r,i){return await e.request(r,i)}})}}class hgt{constructor(e,t,r,i=!1){this.owner=e,this.event=t,this.listener=r,this._internal=i}unbind(){this.owner.removeListener(this)}}class l3{constructor(){this._eventListeners=new Map,this._internalEventListeners=new Map}on(e,t){return this._addListener(!1,e,t)}addListener(e,t){return this._addListener(!1,e,t)}removeListener(e,t){this._removeListener(!1,e,t)}registerEvent(){const e=t=>this.addListener(e,t);return e}emit(e,...t){if(this._eventListeners.has(e))for(const r of this._eventListeners.get(e))r(...t);if(this._internalEventListeners.has(e))for(const r of this._internalEventListeners.get(e))r(...t)}registerInternalEvent(){const e=t=>this.addInternalListener(e,t);return e}addInternalListener(e,t){return this._addListener(!0,e,t)}removeInternalListener(e,t){this._removeListener(!0,e,t)}_addListener(e,t,r){const i=e?this._eventListeners:this._internalEventListeners;return i.has(t)?i.get(t).push(r):i.set(t,[r]),new hgt(this,t,r,e)}_removeListener(e,t,r){const i=e?this._eventListeners:this._internalEventListeners;if(!t)i.clear();else if(typeof t=="object"){const s=t;this._removeListener(s._internal,s.event,s.listener)}else{const s=t;if(i.has(s))if(r){const a=i.get(s);let o=0;for(;(o=a.indexOf(r))!==-1;)a.splice(o,1)}else i.delete(s)}}}const dgt=6e4;function pgt(n){return zk(n.expiresIn,e=>n.obtainmentTimestamp+e*1e3-dgt)}function dP(n){var e;return(e=zk(pgt(n),t=>Date.now()>t))!==null&&e!==void 0?e:!1}var a2={exports:{}},mgt=a2.exports,qie;function ggt(){return qie||(qie=1,(function(n,e){var t=typeof self<"u"?self:mgt,r=(function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s})();(function(s){(function(a){var o={searchParams:"URLSearchParams"in s,iterable:"Symbol"in s&&"iterator"in Symbol,blob:"FileReader"in s&&"Blob"in s&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in s,arrayBuffer:"ArrayBuffer"in s};function l(U){return U&&DataView.prototype.isPrototypeOf(U)}if(o.arrayBuffer)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(U){return U&&c.indexOf(Object.prototype.toString.call(U))>-1};function f(U){if(typeof U!="string"&&(U=String(U)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(U))throw new TypeError("Invalid character in header field name");return U.toLowerCase()}function d(U){return typeof U!="string"&&(U=String(U)),U}function g(U){var J={next:function(){var W=U.shift();return{done:W===void 0,value:W}}};return o.iterable&&(J[Symbol.iterator]=function(){return J}),J}function p(U){this.map={},U instanceof p?U.forEach(function(J,W){this.append(W,J)},this):Array.isArray(U)?U.forEach(function(J){this.append(J[0],J[1])},this):U&&Object.getOwnPropertyNames(U).forEach(function(J){this.append(J,U[J])},this)}p.prototype.append=function(U,J){U=f(U),J=d(J);var W=this.map[U];this.map[U]=W?W+", "+J:J},p.prototype.delete=function(U){delete this.map[f(U)]},p.prototype.get=function(U){return U=f(U),this.has(U)?this.map[U]:null},p.prototype.has=function(U){return this.map.hasOwnProperty(f(U))},p.prototype.set=function(U,J){this.map[f(U)]=d(J)},p.prototype.forEach=function(U,J){for(var W in this.map)this.map.hasOwnProperty(W)&&U.call(J,this.map[W],W,this)},p.prototype.keys=function(){var U=[];return this.forEach(function(J,W){U.push(W)}),g(U)},p.prototype.values=function(){var U=[];return this.forEach(function(J){U.push(J)}),g(U)},p.prototype.entries=function(){var U=[];return this.forEach(function(J,W){U.push([W,J])}),g(U)},o.iterable&&(p.prototype[Symbol.iterator]=p.prototype.entries);function _(U){if(U.bodyUsed)return Promise.reject(new TypeError("Already read"));U.bodyUsed=!0}function y(U){return new Promise(function(J,W){U.onload=function(){J(U.result)},U.onerror=function(){W(U.error)}})}function v(U){var J=new FileReader,W=y(J);return J.readAsArrayBuffer(U),W}function x(U){var J=new FileReader,W=y(J);return J.readAsText(U),W}function E(U){for(var J=new Uint8Array(U),W=new Array(J.length),q=0;q<J.length;q++)W[q]=String.fromCharCode(J[q]);return W.join("")}function M(U){if(U.slice)return U.slice(0);var J=new Uint8Array(U.byteLength);return J.set(new Uint8Array(U)),J.buffer}function O(){return this.bodyUsed=!1,this._initBody=function(U){this._bodyInit=U,U?typeof U=="string"?this._bodyText=U:o.blob&&Blob.prototype.isPrototypeOf(U)?this._bodyBlob=U:o.formData&&FormData.prototype.isPrototypeOf(U)?this._bodyFormData=U:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(U)?this._bodyText=U.toString():o.arrayBuffer&&o.blob&&l(U)?(this._bodyArrayBuffer=M(U.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(U)||u(U))?this._bodyArrayBuffer=M(U):this._bodyText=U=Object.prototype.toString.call(U):this._bodyText="",this.headers.get("content-type")||(typeof U=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(U)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var U=_(this);if(U)return U;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?_(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var U=_(this);if(U)return U;if(this._bodyBlob)return x(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(E(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(V)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function I(U){var J=U.toUpperCase();return N.indexOf(J)>-1?J:U}function D(U,J){J=J||{};var W=J.body;if(U instanceof D){if(U.bodyUsed)throw new TypeError("Already read");this.url=U.url,this.credentials=U.credentials,J.headers||(this.headers=new p(U.headers)),this.method=U.method,this.mode=U.mode,this.signal=U.signal,!W&&U._bodyInit!=null&&(W=U._bodyInit,U.bodyUsed=!0)}else this.url=String(U);if(this.credentials=J.credentials||this.credentials||"same-origin",(J.headers||!this.headers)&&(this.headers=new p(J.headers)),this.method=I(J.method||this.method||"GET"),this.mode=J.mode||this.mode||null,this.signal=J.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&W)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(W)}D.prototype.clone=function(){return new D(this,{body:this._bodyInit})};function V(U){var J=new FormData;return U.trim().split("&").forEach(function(W){if(W){var q=W.split("="),Y=q.shift().replace(/\+/g," "),ae=q.join("=").replace(/\+/g," ");J.append(decodeURIComponent(Y),decodeURIComponent(ae))}}),J}function G(U){var J=new p,W=U.replace(/\r?\n[\t ]+/g," ");return W.split(/\r?\n/).forEach(function(q){var Y=q.split(":"),ae=Y.shift().trim();if(ae){var Z=Y.join(":").trim();J.append(ae,Z)}}),J}O.call(D.prototype);function Q(U,J){J||(J={}),this.type="default",this.status=J.status===void 0?200:J.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in J?J.statusText:"OK",this.headers=new p(J.headers),this.url=J.url||"",this._initBody(U)}O.call(Q.prototype),Q.prototype.clone=function(){return new Q(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},Q.error=function(){var U=new Q(null,{status:0,statusText:""});return U.type="error",U};var B=[301,302,303,307,308];Q.redirect=function(U,J){if(B.indexOf(J)===-1)throw new RangeError("Invalid status code");return new Q(null,{status:J,headers:{location:U}})},a.DOMException=s.DOMException;try{new a.DOMException}catch{a.DOMException=function(J,W){this.message=J,this.name=W;var q=Error(J);this.stack=q.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function $(U,J){return new Promise(function(W,q){var Y=new D(U,J);if(Y.signal&&Y.signal.aborted)return q(new a.DOMException("Aborted","AbortError"));var ae=new XMLHttpRequest;function Z(){ae.abort()}ae.onload=function(){var K={status:ae.status,statusText:ae.statusText,headers:G(ae.getAllResponseHeaders()||"")};K.url="responseURL"in ae?ae.responseURL:K.headers.get("X-Request-URL");var ne="response"in ae?ae.response:ae.responseText;W(new Q(ne,K))},ae.onerror=function(){q(new TypeError("Network request failed"))},ae.ontimeout=function(){q(new TypeError("Network request failed"))},ae.onabort=function(){q(new a.DOMException("Aborted","AbortError"))},ae.open(Y.method,Y.url,!0),Y.credentials==="include"?ae.withCredentials=!0:Y.credentials==="omit"&&(ae.withCredentials=!1),"responseType"in ae&&o.blob&&(ae.responseType="blob"),Y.headers.forEach(function(K,ne){ae.setRequestHeader(ne,K)}),Y.signal&&(Y.signal.addEventListener("abort",Z),ae.onreadystatechange=function(){ae.readyState===4&&Y.signal.removeEventListener("abort",Z)}),ae.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return $.polyfill=!0,s.fetch||(s.fetch=$,s.Headers=p,s.Request=D,s.Response=Q),a.Headers=p,a.Request=D,a.Response=Q,a.fetch=$,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var i=r;e=i.fetch,e.default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,n.exports=e})(a2,a2.exports)),a2.exports}var qve=ggt();const _gt=Bh(qve);var CF,Vie;function $V(){if(Vie)return CF;Vie=1;var n=Object.prototype.hasOwnProperty,e=Array.isArray,t=(function(){for(var g=[],p=0;p<256;++p)g.push("%"+((p<16?"0":"")+p.toString(16)).toUpperCase());return g})(),r=function(p){for(;p.length>1;){var _=p.pop(),y=_.obj[_.prop];if(e(y)){for(var v=[],x=0;x<y.length;++x)typeof y[x]<"u"&&v.push(y[x]);_.obj[_.prop]=v}}},i=function(p,_){for(var y=_&&_.plainObjects?Object.create(null):{},v=0;v<p.length;++v)typeof p[v]<"u"&&(y[v]=p[v]);return y},s=function g(p,_,y){if(!_)return p;if(typeof _!="object"){if(e(p))p.push(_);else if(p&&typeof p=="object")(y&&(y.plainObjects||y.allowPrototypes)||!n.call(Object.prototype,_))&&(p[_]=!0);else return[p,_];return p}if(!p||typeof p!="object")return[p].concat(_);var v=p;return e(p)&&!e(_)&&(v=i(p,y)),e(p)&&e(_)?(_.forEach(function(x,E){if(n.call(p,E)){var M=p[E];M&&typeof M=="object"&&x&&typeof x=="object"?p[E]=g(M,x,y):p.push(x)}else p[E]=x}),p):Object.keys(_).reduce(function(x,E){var M=_[E];return n.call(x,E)?x[E]=g(x[E],M,y):x[E]=M,x},v)},a=function(p,_){return Object.keys(_).reduce(function(y,v){return y[v]=_[v],y},p)},o=function(g,p,_){var y=g.replace(/\+/g," ");if(_==="iso-8859-1")return y.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(y)}catch{return y}},l=function(p,_,y){if(p.length===0)return p;var v=p;if(typeof p=="symbol"?v=Symbol.prototype.toString.call(p):typeof p!="string"&&(v=String(p)),y==="iso-8859-1")return escape(v).replace(/%u[0-9a-f]{4}/gi,function(O){return"%26%23"+parseInt(O.slice(2),16)+"%3B"});for(var x="",E=0;E<v.length;++E){var M=v.charCodeAt(E);if(M===45||M===46||M===95||M===126||M>=48&&M<=57||M>=65&&M<=90||M>=97&&M<=122){x+=v.charAt(E);continue}if(M<128){x=x+t[M];continue}if(M<2048){x=x+(t[192|M>>6]+t[128|M&63]);continue}if(M<55296||M>=57344){x=x+(t[224|M>>12]+t[128|M>>6&63]+t[128|M&63]);continue}E+=1,M=65536+((M&1023)<<10|v.charCodeAt(E)&1023),x+=t[240|M>>18]+t[128|M>>12&63]+t[128|M>>6&63]+t[128|M&63]}return x},c=function(p){for(var _=[{obj:{o:p},prop:"o"}],y=[],v=0;v<_.length;++v)for(var x=_[v],E=x.obj[x.prop],M=Object.keys(E),O=0;O<M.length;++O){var N=M[O],I=E[N];typeof I=="object"&&I!==null&&y.indexOf(I)===-1&&(_.push({obj:E,prop:N}),y.push(I))}return r(_),p},u=function(p){return Object.prototype.toString.call(p)==="[object RegExp]"},f=function(p){return!p||typeof p!="object"?!1:!!(p.constructor&&p.constructor.isBuffer&&p.constructor.isBuffer(p))},d=function(p,_){return[].concat(p,_)};return CF={arrayToObject:i,assign:a,combine:d,compact:c,decode:o,encode:l,isBuffer:f,isRegExp:u,merge:s},CF}var MF,Gie;function Vve(){if(Gie)return MF;Gie=1;var n=String.prototype.replace,e=/%20/g,t=$V(),r={RFC1738:"RFC1738",RFC3986:"RFC3986"};return MF=t.assign({default:r.RFC3986,formatters:{RFC1738:function(i){return n.call(i,e,"+")},RFC3986:function(i){return String(i)}}},r),MF}var kF,$ie;function vgt(){if($ie)return kF;$ie=1;var n=$V(),e=Vve(),t=Object.prototype.hasOwnProperty,r={brackets:function(p){return p+"[]"},comma:"comma",indices:function(p,_){return p+"["+_+"]"},repeat:function(p){return p}},i=Array.isArray,s=Array.prototype.push,a=function(g,p){s.apply(g,i(p)?p:[p])},o=Date.prototype.toISOString,l=e.default,c={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:n.encode,encodeValuesOnly:!1,format:l,formatter:e.formatters[l],indices:!1,serializeDate:function(p){return o.call(p)},skipNulls:!1,strictNullHandling:!1},u=function(p){return typeof p=="string"||typeof p=="number"||typeof p=="boolean"||typeof p=="symbol"||typeof p=="bigint"},f=function g(p,_,y,v,x,E,M,O,N,I,D,V,G){var Q=p;if(typeof M=="function"?Q=M(_,Q):Q instanceof Date?Q=I(Q):y==="comma"&&i(Q)&&(Q=Q.join(",")),Q===null){if(v)return E&&!V?E(_,c.encoder,G,"key"):_;Q=""}if(u(Q)||n.isBuffer(Q)){if(E){var B=V?_:E(_,c.encoder,G,"key");return[D(B)+"="+D(E(Q,c.encoder,G,"value"))]}return[D(_)+"="+D(String(Q))]}var $=[];if(typeof Q>"u")return $;var U;if(i(M))U=M;else{var J=Object.keys(Q);U=O?J.sort(O):J}for(var W=0;W<U.length;++W){var q=U[W];x&&Q[q]===null||(i(Q)?a($,g(Q[q],typeof y=="function"?y(_,q):_,y,v,x,E,M,O,N,I,D,V,G)):a($,g(Q[q],_+(N?"."+q:"["+q+"]"),y,v,x,E,M,O,N,I,D,V,G)))}return $},d=function(p){if(!p)return c;if(p.encoder!==null&&p.encoder!==void 0&&typeof p.encoder!="function")throw new TypeError("Encoder has to be a function.");var _=p.charset||c.charset;if(typeof p.charset<"u"&&p.charset!=="utf-8"&&p.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var y=e.default;if(typeof p.format<"u"){if(!t.call(e.formatters,p.format))throw new TypeError("Unknown format option provided.");y=p.format}var v=e.formatters[y],x=c.filter;return(typeof p.filter=="function"||i(p.filter))&&(x=p.filter),{addQueryPrefix:typeof p.addQueryPrefix=="boolean"?p.addQueryPrefix:c.addQueryPrefix,allowDots:typeof p.allowDots>"u"?c.allowDots:!!p.allowDots,charset:_,charsetSentinel:typeof p.charsetSentinel=="boolean"?p.charsetSentinel:c.charsetSentinel,delimiter:typeof p.delimiter>"u"?c.delimiter:p.delimiter,encode:typeof p.encode=="boolean"?p.encode:c.encode,encoder:typeof p.encoder=="function"?p.encoder:c.encoder,encodeValuesOnly:typeof p.encodeValuesOnly=="boolean"?p.encodeValuesOnly:c.encodeValuesOnly,filter:x,formatter:v,serializeDate:typeof p.serializeDate=="function"?p.serializeDate:c.serializeDate,skipNulls:typeof p.skipNulls=="boolean"?p.skipNulls:c.skipNulls,sort:typeof p.sort=="function"?p.sort:null,strictNullHandling:typeof p.strictNullHandling=="boolean"?p.strictNullHandling:c.strictNullHandling}};return kF=function(g,p){var _=g,y=d(p),v,x;typeof y.filter=="function"?(x=y.filter,_=x("",_)):i(y.filter)&&(x=y.filter,v=x);var E=[];if(typeof _!="object"||_===null)return"";var M;p&&p.arrayFormat in r?M=p.arrayFormat:p&&"indices"in p?M=p.indices?"indices":"repeat":M="indices";var O=r[M];v||(v=Object.keys(_)),y.sort&&v.sort(y.sort);for(var N=0;N<v.length;++N){var I=v[N];y.skipNulls&&_[I]===null||a(E,f(_[I],I,O,y.strictNullHandling,y.skipNulls,y.encode?y.encoder:null,y.filter,y.sort,y.allowDots,y.serializeDate,y.formatter,y.encodeValuesOnly,y.charset))}var D=E.join(y.delimiter),V=y.addQueryPrefix===!0?"?":"";return y.charsetSentinel&&(y.charset==="iso-8859-1"?V+="utf8=%26%2310003%3B&":V+="utf8=%E2%9C%93&"),D.length>0?V+D:""},kF}var ygt=vgt();const Gve=Bh(ygt);var OF,Wie;function bgt(){if(Wie)return OF;Wie=1;var n=$V(),e=Object.prototype.hasOwnProperty,t=Array.isArray,r={allowDots:!1,allowPrototypes:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:n.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},i=function(g){return g.replace(/&#(\d+);/g,function(p,_){return String.fromCharCode(parseInt(_,10))})},s=function(g,p){return g&&typeof g=="string"&&p.comma&&g.indexOf(",")>-1?g.split(","):g},a=function(p,_){if(t(p)){for(var y=[],v=0;v<p.length;v+=1)y.push(_(p[v]));return y}return _(p)},o="utf8=%26%2310003%3B",l="utf8=%E2%9C%93",c=function(p,_){var y={},v=_.ignoreQueryPrefix?p.replace(/^\?/,""):p,x=_.parameterLimit===1/0?void 0:_.parameterLimit,E=v.split(_.delimiter,x),M=-1,O,N=_.charset;if(_.charsetSentinel)for(O=0;O<E.length;++O)E[O].indexOf("utf8=")===0&&(E[O]===l?N="utf-8":E[O]===o&&(N="iso-8859-1"),M=O,O=E.length);for(O=0;O<E.length;++O)if(O!==M){var I=E[O],D=I.indexOf("]="),V=D===-1?I.indexOf("="):D+1,G,Q;V===-1?(G=_.decoder(I,r.decoder,N,"key"),Q=_.strictNullHandling?null:""):(G=_.decoder(I.slice(0,V),r.decoder,N,"key"),Q=a(s(I.slice(V+1),_),function(B){return _.decoder(B,r.decoder,N,"value")})),Q&&_.interpretNumericEntities&&N==="iso-8859-1"&&(Q=i(Q)),I.indexOf("[]=")>-1&&(Q=t(Q)?[Q]:Q),e.call(y,G)?y[G]=n.combine(y[G],Q):y[G]=Q}return y},u=function(g,p,_,y){for(var v=y?p:s(p,_),x=g.length-1;x>=0;--x){var E,M=g[x];if(M==="[]"&&_.parseArrays)E=[].concat(v);else{E=_.plainObjects?Object.create(null):{};var O=M.charAt(0)==="["&&M.charAt(M.length-1)==="]"?M.slice(1,-1):M,N=parseInt(O,10);!_.parseArrays&&O===""?E={0:v}:!isNaN(N)&&M!==O&&String(N)===O&&N>=0&&_.parseArrays&&N<=_.arrayLimit?(E=[],E[N]=v):E[O]=v}v=E}return v},f=function(p,_,y,v){if(p){var x=y.allowDots?p.replace(/\.([^.[]+)/g,"[$1]"):p,E=/(\[[^[\]]*])/,M=/(\[[^[\]]*])/g,O=y.depth>0&&E.exec(x),N=O?x.slice(0,O.index):x,I=[];if(N){if(!y.plainObjects&&e.call(Object.prototype,N)&&!y.allowPrototypes)return;I.push(N)}for(var D=0;y.depth>0&&(O=M.exec(x))!==null&&D<y.depth;){if(D+=1,!y.plainObjects&&e.call(Object.prototype,O[1].slice(1,-1))&&!y.allowPrototypes)return;I.push(O[1])}return O&&I.push("["+x.slice(O.index)+"]"),u(I,_,y,v)}},d=function(p){if(!p)return r;if(p.decoder!==null&&p.decoder!==void 0&&typeof p.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof p.charset<"u"&&p.charset!=="utf-8"&&p.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var _=typeof p.charset>"u"?r.charset:p.charset;return{allowDots:typeof p.allowDots>"u"?r.allowDots:!!p.allowDots,allowPrototypes:typeof p.allowPrototypes=="boolean"?p.allowPrototypes:r.allowPrototypes,arrayLimit:typeof p.arrayLimit=="number"?p.arrayLimit:r.arrayLimit,charset:_,charsetSentinel:typeof p.charsetSentinel=="boolean"?p.charsetSentinel:r.charsetSentinel,comma:typeof p.comma=="boolean"?p.comma:r.comma,decoder:typeof p.decoder=="function"?p.decoder:r.decoder,delimiter:typeof p.delimiter=="string"||n.isRegExp(p.delimiter)?p.delimiter:r.delimiter,depth:typeof p.depth=="number"||p.depth===!1?+p.depth:r.depth,ignoreQueryPrefix:p.ignoreQueryPrefix===!0,interpretNumericEntities:typeof p.interpretNumericEntities=="boolean"?p.interpretNumericEntities:r.interpretNumericEntities,parameterLimit:typeof p.parameterLimit=="number"?p.parameterLimit:r.parameterLimit,parseArrays:p.parseArrays!==!1,plainObjects:typeof p.plainObjects=="boolean"?p.plainObjects:r.plainObjects,strictNullHandling:typeof p.strictNullHandling=="boolean"?p.strictNullHandling:r.strictNullHandling}};return OF=function(g,p){var _=d(p);if(g===""||g===null||typeof g>"u")return _.plainObjects?Object.create(null):{};for(var y=typeof g=="string"?c(g,_):g,v=_.plainObjects?Object.create(null):{},x=Object.keys(y),E=0;E<x.length;++E){var M=x[E],O=f(M,y[M],_,typeof g=="string");v=n.merge(v,O,_)}return n.compact(v)},OF}bgt();Vve();const uT=Symbol("twurpleRawData");class Sgt{constructor(e){this[uT]=e}}class hx extends Error{constructor(e,t){var r;super(e,t),Object.setPrototypeOf(this,new.target.prototype),(r=Error.captureStackTrace)===null||r===void 0||r.call(Error,this,new.target.constructor)}get name(){return this.constructor.name}}function c3(n,e,t){return r=>{const i=t?function(){return`[${e}#${this[t]} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`}:function(){return`[${e} - please check https://twurple.js.org/reference/${n}/classes/${e}.html for available properties]`};Object.defineProperty(r.prototype,Symbol.for("nodejs.util.inspect.custom"),{value:i,enumerable:!1})}}class Yie extends hx{constructor(e){super(`${e} - this should never happen, please file a bug in the GitHub issue tracker`)}}function Cy(n){return typeof n=="string"?n:typeof n=="number"?n.toString(10):n.id}class $ve extends hx{constructor(e,t,r,i,s,a){super(`Encountered HTTP status code ${e}: ${t}

URL: ${r}
Method: ${i}
Body:
${!a&&s.length>150?`${s.slice(0,147)}...`:s}`),this._statusCode=e,this._url=r,this._method=i,this._body=s}get statusCode(){return this._statusCode}get url(){return this._url}get method(){return this._method}get body(){return this._body}}async function Egt(n,e){var t;if(!n.ok){const r=n.headers.get("Content-Type")==="application/json",i=r?JSON.stringify(await n.json(),null,2):await n.text(),s=Gve(e.query,{arrayFormat:"repeat",addQueryPrefix:!0}),a=`${e.url}${s}`;throw new $ve(n.status,n.statusText,a,(t=e.method)!==null&&t!==void 0?t:"GET",i,r)}}async function xgt(n){if(n.status===204)return;const e=await n.text();if(e)return JSON.parse(e)}function Tgt(n,e,t){switch(e){case"helix":return`https://api.twitch.tv/helix/${n.replace(/^\//,"")}`;case"auth":return`https://id.twitch.tv/oauth2/${n.replace(/^\//,"")}`;case"custom":return n;default:return n}}async function wgt(n,e,t,r,i={},s){var a,o;const l=(a=n.type)!==null&&a!==void 0?a:"helix",c=Tgt(n.url,l),u=Gve(n.query,{arrayFormat:"repeat",addQueryPrefix:!0}),f=new qve.Headers({Accept:"application/json"});let d;n.jsonBody&&(d=JSON.stringify(n.jsonBody),f.append("Content-Type","application/json")),e&&l!=="auth"&&f.append("Client-ID",e),t&&f.append("Authorization",`${l==="helix"?"Bearer":"OAuth"} ${t}`);const g={...i,method:(o=n.method)!==null&&o!==void 0?o:"GET",headers:f,body:d};return await _gt(`${c}${u}`,g)}async function a5(n,e,t,r,i={}){const s=await wgt(n,e,t,r,i);return await Egt(s,n),await xgt(s)}class DT extends hx{constructor(e){super("Invalid token supplied",e)}}class pP extends hx{}function Rgt(n,e,t,r){return{grant_type:"authorization_code",client_id:n,client_secret:e,code:t,redirect_uri:r}}function Agt(n,e){return{grant_type:"client_credentials",client_id:n,client_secret:e}}function Cgt(n,e,t){return{grant_type:"refresh_token",client_id:n,client_secret:e,refresh_token:t}}let nz=class extends Sgt{constructor(e){super(e),this._obtainmentDate=new Date}get clientId(){return this[uT].client_id}get userId(){var e;return(e=this[uT].user_id)!==null&&e!==void 0?e:null}get userName(){var e;return(e=this[uT].login)!==null&&e!==void 0?e:null}get scopes(){return this[uT].scopes}get expiryDate(){return zk(this[uT].expires_in,e=>new Date(this._obtainmentDate.getTime()+e*1e3))}};nz=ql([c3("auth","TokenInfo","clientId")],nz);function WV(n){var e,t;return{accessToken:n.access_token,refreshToken:n.refresh_token||null,scope:(e=n.scope)!==null&&e!==void 0?e:[],expiresIn:(t=n.expires_in)!==null&&t!==void 0?t:null,obtainmentTimestamp:Date.now()}}async function Mgt(n,e,t,r){return WV(await a5({type:"auth",url:"token",method:"POST",query:Rgt(n,e,t,r)}))}async function kgt(n,e){return WV(await a5({type:"auth",url:"token",method:"POST",query:Agt(n,e)}))}async function Xie(n,e,t){return WV(await a5({type:"auth",url:"token",method:"POST",query:Cgt(n,e,t)}))}async function jk(n,e){try{const t=await a5({type:"auth",url:"validate"},e,n);return new nz(t)}catch(t){throw t instanceof $ve&&t.statusCode===401?new DT({cause:t}):t}}const Ogt=new Map([["channel_commercial",["channel:edit:commercial"]],["channel_editor",["channel:manage:broadcast"]],["channel_read",["channel:read:stream_key"]],["channel_subscriptions",["channel:read:subscriptions"]],["user_blocks_read",["user:read:blocked_users"]],["user_blocks_edit",["user:manage:blocked_users"]],["user_follows_edit",["user:edit:follows"]],["user_read",["user:read:email"]],["user_subscriptions",["user:read:subscriptions"]],["user:edit:broadcast",["channel:manage:broadcast","channel:manage:extensions"]]]);function Igt(n,e){if(e?.length){const t=new Set(n.flatMap(r=>{var i;return[r,...(i=Ogt.get(r))!==null&&i!==void 0?i:[]]}));if(e.every(r=>!t.has(r))){const r=e.join(", ");throw new Error(`This token does not have any of the requested scopes (${r}) and can not be upgraded.
If you need dynamically upgrading scopes, please implement the AuthProvider interface accordingly:

	https://twurple.js.org/reference/auth/interfaces/AuthProvider.html`)}}}function mP(n,e){for(const t of e)Igt(n,t)}async function Ngt(n,e,t,r,i){if(i?.length||!t){const s=await jk(e,n);if(!s.userId)throw new Error("Trying to use an app access token as a user access token");const a=r??s.scopes;return i&&mP(a,i.filter(o=>!!o)),[a,s.userId]}return[r,t]}class Kie{constructor(e){this._newTokenScopeSets=[],this._newTokenPromise=null,this._queuedScopeSets=[],this._queueExecutor=null,this._queuePromise=null,this._executor=e}async fetch(...e){var t;const r=e.filter(o=>!!o);if(this._newTokenPromise){if(!r.length)return await this._newTokenPromise;if(this._queueExecutor?this._queuedScopeSets.push(...r):this._queuedScopeSets=[...r],!this._queuePromise){const{promise:o,resolve:l,reject:c}=ez();this._queuePromise=o,this._queueExecutor=async()=>{var u;if(this._queuePromise){this._newTokenScopeSets=this._queuedScopeSets,this._queuedScopeSets=[],this._newTokenPromise=this._queuePromise,this._queuePromise=null,this._queueExecutor=null;try{l(await this._executor(this._newTokenScopeSets))}catch(f){c(f)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(u=this._queueExecutor)===null||u===void 0||u.call(this)}}}}return await this._queuePromise}this._newTokenScopeSets=[...r];const{promise:i,resolve:s,reject:a}=ez();this._newTokenPromise=i;try{s(await this._executor(this._newTokenScopeSets))}catch(o){a(o)}finally{this._newTokenPromise=null,this._newTokenScopeSets=[],(t=this._queueExecutor)===null||t===void 0||t.call(this)}return await i}}class Zie extends hx{constructor(e){super(`The user context for the user ${e} has been disabled.
This happened because the access token became invalid (e.g. by expiry) and refreshing it failed (e.g. because the account's password was changed).

Use .addUser(), .addUserForToken() or .addUserForCode() for the same user context to re-enable the user with a new, valid token.`),this.userId=e}}class Pgt extends hx{constructor(e){super(`User ${e} was removed while trying to fetch a token.

Make sure you're not executing any actions when you want to remove a user.`),this.userId=e}}class Dgt extends hx{constructor(e){super(`Unknown intent: ${e}`),this.intent=e}}let D1=class extends l3{constructor(e){var t;super(),this._userAccessTokens=new Map,this._userTokenFetchers=new Map,this._intentToUserId=new Map,this._userIdToIntents=new Map,this._cachedRefreshFailures=new Set,this.onRefresh=this.registerEvent(),this.onRefreshFailure=this.registerEvent(),this._clientId=e.clientId,this._clientSecret=e.clientSecret,this._redirectUri=e.redirectUri,this._appImpliedScopes=(t=e.appImpliedScopes)!==null&&t!==void 0?t:[],this._appTokenFetcher=new Kie(async r=>await this._fetchAppToken(r))}addUser(e,t,r){const i=Cy(e);if(!t.refreshToken)throw new Error(`Trying to add user ${i} without refresh token`);this._cachedRefreshFailures.delete(i),this._userAccessTokens.set(i,{...t,userId:i}),this._userTokenFetchers.has(i)||this._userTokenFetchers.set(i,new Kie(async s=>await this._fetchUserToken(i,s))),r&&this.addIntentsToUser(e,r)}async addUserForToken(e,t){let r=null;if(e.accessToken&&!dP(e))try{const o=await jk(e.accessToken);r=[e,o]}catch(o){if(!(o instanceof DT))throw o}if(!r){if(!e.refreshToken)throw new DT;const o=await Xie(this._clientId,this._clientSecret,e.refreshToken),l=await jk(o.accessToken);this.emit(this.onRefresh,l.userId,o),r=[o,l]}const[i,s]=r;if(!s.userId)throw new pP("Could not determine a user ID for your token; you might be trying to disguise an app token as a user token.");const a=i.scope?i:{...i,scope:s.scopes};return this.addUser(s.userId,a,t),s.userId}async addUserForCode(e,t){if(!this._redirectUri)throw new Error("This method requires you to pass a `redirectUri` as a configuration property");const r=await Mgt(this._clientId,this._clientSecret,e,this._redirectUri);return await this.addUserForToken(r,t)}hasUser(e){return this._userTokenFetchers.has(Cy(e))}removeUser(e){const t=Cy(e);if(this._userIdToIntents.has(t)){const r=this._userIdToIntents.get(t);for(const i of r)this._intentToUserId.delete(i);this._userIdToIntents.delete(t)}this._userAccessTokens.delete(t),this._userTokenFetchers.delete(t),this._cachedRefreshFailures.delete(t)}addIntentsToUser(e,t){const r=Cy(e);if(!this._userAccessTokens.has(r))throw new Error("Trying to add intents to a user that was not added to this provider");for(const i of t)this._intentToUserId.has(i)&&this._userIdToIntents.get(this._intentToUserId.get(i)).delete(i),this._intentToUserId.set(i,r),this._userIdToIntents.has(r)?this._userIdToIntents.get(r).add(i):this._userIdToIntents.set(r,new Set([i]))}getIntentsForUser(e){const t=Cy(e);return this._userIdToIntents.has(t)?Array.from(this._userIdToIntents.get(t)):[]}removeIntents(e){var t;for(const r of e)if(this._intentToUserId.has(r)){const i=this._intentToUserId.get(r);(t=this._userIdToIntents.get(i))===null||t===void 0||t.delete(r),this._intentToUserId.delete(r)}}async refreshAccessTokenForUser(e){const t=Cy(e);if(this._cachedRefreshFailures.has(t))throw new Zie(t);const r=this._userAccessTokens.get(t);if(!r)throw new Error("Trying to refresh token for user that was not added to the provider");const i=await this._refreshUserTokenWithCallback(t,r.refreshToken);return this._checkIntermediateUserRemoval(t),this._userAccessTokens.set(t,{...i,userId:t}),this.emit(this.onRefresh,t,i),{...i,userId:t}}async refreshAccessTokenForIntent(e){if(!this._intentToUserId.has(e))throw new Dgt(e);const t=this._intentToUserId.get(e);return await this.refreshAccessTokenForUser(t)}get clientId(){return this._clientId}getCurrentScopesForUser(e){var t;const r=this._userAccessTokens.get(Cy(e));if(!r)throw new Error("Trying to get scopes for user that was not added to the provider");return(t=r.scope)!==null&&t!==void 0?t:[]}async getAccessTokenForUser(e,...t){const r=Cy(e),i=this._userTokenFetchers.get(r);if(!i)return null;if(this._cachedRefreshFailures.has(r))throw new Zie(r);return mP(this.getCurrentScopesForUser(r),t.filter(Boolean)),await i.fetch(...t)}async getAccessTokenForIntent(e,...t){if(!this._intentToUserId.has(e))return null;const r=this._intentToUserId.get(e),i=await this.getAccessTokenForUser(r,...t);if(!i)throw new Yie(`Found intent ${e} corresponding to user ID ${r} but no token was found`);return{...i,userId:r}}async getAnyAccessToken(e){if(e){const t=Cy(e);if(this._userAccessTokens.has(t)){const r=await this.getAccessTokenForUser(t);if(!r)throw new Yie(`Token for user ID ${t} exists but nothing was returned by getAccessTokenForUser`);return{...r,userId:t}}}return await this.getAppAccessToken()}async getAppAccessToken(e=!1){return e&&(this._appAccessToken=void 0),await this._appTokenFetcher.fetch(...this._appImpliedScopes.map(t=>[t]))}_checkIntermediateUserRemoval(e){if(!this._userTokenFetchers.has(e))throw this._cachedRefreshFailures.delete(e),new Pgt(e)}async _fetchUserToken(e,t){const r=this._userAccessTokens.get(e);if(!r)throw new Error("Trying to get token for user that was not added to the provider");if(r.accessToken&&!dP(r))try{if(r.scope)return mP(r.scope,t),r;const[s=[]]=await Ngt(this._clientId,r.accessToken,e,r.scope,t),a={...r,scope:s};return this._checkIntermediateUserRemoval(e),this._userAccessTokens.set(e,a),a}catch(s){if(!(s instanceof DT))throw s}this._checkIntermediateUserRemoval(e);const i=await this.refreshAccessTokenForUser(e);return mP(i.scope,t),i}async _refreshUserTokenWithCallback(e,t){try{return await Xie(this.clientId,this._clientSecret,t)}catch(r){throw this._cachedRefreshFailures.add(e),this.emit(this.onRefreshFailure,e,r),r}}async _fetchAppToken(e){if(e.length>0)for(const t of e)if(this._appImpliedScopes.length){if(t.every(r=>!this._appImpliedScopes.includes(r)))throw new Error(`One of the scopes ${t.join(", ")} requested but only the scope ${this._appImpliedScopes.join(", ")} is implied`)}else throw new Error(`One of the scopes ${t.join(", ")} requested but the client credentials flow does not support scopes`);return!this._appAccessToken||dP(this._appAccessToken)?await this._refreshAppToken():this._appAccessToken}async _refreshAppToken(){return this._appAccessToken=await kgt(this._clientId,this._clientSecret)}};ql([tS(!1)],D1.prototype,"_clientSecret",void 0);ql([tS(!1)],D1.prototype,"_userAccessTokens",void 0);ql([tS(!1)],D1.prototype,"_userTokenFetchers",void 0);ql([tS(!1)],D1.prototype,"_appAccessToken",void 0);ql([tS(!1)],D1.prototype,"_appTokenFetcher",void 0);D1=ql([c3("auth","RefreshingAuthProvider","clientId")],D1);class Lgt extends l3{constructor({lineBased:e,logger:t,additionalOptions:r}={}){super(),this._currentLine="",this._connecting=!1,this._connected=!1,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._lineBased=e??!1,this._logger=t,this._additionalOptions=r}get isConnecting(){return this._connecting}get isConnected(){return this._connected}sendLine(e){this._connected&&(e=e.replace(/[\0\r\n]/g,""),this.sendRaw(`${e}\r
`))}assumeExternalDisconnect(){var e;(e=this._logger)===null||e===void 0||e.trace("AbstractConnection assumeExternalDisconnect"),this._connected=!1,this._connecting=!1,this.clearSocket(),this.emit(this.onDisconnect,!1)}receiveRaw(e){var t,r;if(!this._lineBased){this.emit(this.onReceive,e);return}const i=e.split(`\r
`);if(this._currentLine+=(t=i.shift())!==null&&t!==void 0?t:"",i.length){this.emit(this.onReceive,this._currentLine),this._currentLine=(r=i.pop())!==null&&r!==void 0?r:"";for(const s of i)this.emit(this.onReceive,s)}}}class Ugt{constructor(){throw new Error("DirectConnection is not implemented in a browser environment")}}class Bgt extends l3{constructor(e,t,r={}){var i;super(),this._type=e,this._target=t,this._config=r,this._retryLimit=1/0,this._initialRetryLimit=3,this._connecting=!1,this._connectionRetryCount=0,this.onReceive=this.registerEvent(),this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onEnd=this.registerEvent(),this._retryLimit=(i=r.retryLimit)!==null&&i!==void 0?i:1/0,this._logger=r.logger}get isConnected(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnected)!==null&&t!==void 0?t:!1}get isConnecting(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.isConnecting)!==null&&t!==void 0?t:this._connecting}get hasSocket(){var e,t;return(t=(e=this._currentConnection)===null||e===void 0?void 0:e.hasSocket)!==null&&t!==void 0?t:!1}sendLine(e){var t;(t=this._currentConnection)===null||t===void 0||t.sendLine(e)}connect(){if(this._currentConnection||this._connecting)throw new Error("Connection already present");this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(!0)}disconnect(){var e;if((e=this._logger)===null||e===void 0||e.trace(`PersistentConnection disconnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`),this._connecting=!1,this._currentConnection){const t=this._currentConnection;this._currentConnection=void 0,t.disconnect()}}assumeExternalDisconnect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("PersistentConnection assumeExternalDisconnect"),(t=this._currentConnection)===null||t===void 0||t.assumeExternalDisconnect()}reconnect(){this._reconnect(!0)}acknowledgeSuccessfulReconnect(){this._previousConnection&&(this._previousConnection.disconnect(),this._previousConnection=void 0)}_startTryingToConnect(e=!1){this._connecting=!0,this._connectionRetryCount=0,this._tryConnect(e)}_tryConnect(e=!1){var t,r;(t=this._logger)===null||t===void 0||t.trace(`PersistentConnection tryConnect currentConnectionExists:${(!!this._currentConnection).toString()} connecting:${this._connecting.toString()}`);const i=e?this._initialRetryLimit:this._retryLimit;(r=this._retryTimerGenerator)!==null&&r!==void 0||(this._retryTimerGenerator=Dve(120));const s=this._currentConnection=new this._type(Qmt(this._target),this._config);s.onReceive(a=>this.emit(this.onReceive,a)),s.onConnect(()=>{this.emit(this.onConnect),this._connecting=!1,this._retryTimerGenerator=void 0}),s.onDisconnect((a,o)=>{var l,c,u;if(this.emit(this.onDisconnect,a,o),a)this.emit(this.onEnd,!0),this._connecting=!1,this._retryTimerGenerator=void 0,s.disconnect(),this._currentConnection===s&&(this._currentConnection=void 0),this._previousConnection===s&&(this._previousConnection=void 0);else if(this._connecting){if((l=this._logger)===null||l===void 0||l.debug(`Connection error caught: ${(c=o?.message)!==null&&c!==void 0?c:"unknown error"}`),this._connectionRetryCount>=i)return;this._connectionRetryCount++;const f=this._retryTimerGenerator.next().value;f!==0&&((u=this._logger)===null||u===void 0||u.info(`Retrying in ${f} seconds`)),setTimeout(()=>{var d;this._connecting&&((d=this._logger)===null||d===void 0||d.info(e?"Retrying connection":"Trying to reconnect"),this._tryConnect())},f*1e3)}else this._reconnect()}),s.connect()}_reconnect(e=!1){e&&this._config.overlapManualReconnect?(this._previousConnection=this._currentConnection,this._currentConnection=void 0):this.disconnect(),this._startTryingToConnect(e)}}var fT=null;typeof WebSocket<"u"?fT=WebSocket:typeof MozWebSocket<"u"?fT=MozWebSocket:typeof Wy<"u"?fT=Wy.WebSocket||Wy.MozWebSocket:typeof window<"u"?fT=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(fT=self.WebSocket||self.MozWebSocket);class Fgt extends Lgt{constructor(e,t){if(super(t),this._socket=null,this._closingOnDemand=!1,e.hostName&&e.port)this._url=`ws${e.secure?"s":""}://${e.hostName}:${e.port}`;else if(e.url)this._url=e.url;else throw new Error("WebSocketConnection requires either hostName & port or url to be set")}get hasSocket(){return!!this._socket}sendRaw(e){var t;(t=this._socket)===null||t===void 0||t.send(e)}connect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection connect"),this._connecting=!0,this._socket=new fT(this._url,(t=this._additionalOptions)===null||t===void 0?void 0:t.wsOptions),this._socket.onopen=()=>{var r;(r=this._logger)===null||r===void 0||r.trace("WebSocketConnection onOpen"),this._connected=!0,this._connecting=!1,this._closingOnDemand=!1,this.emit(this.onConnect)},this._socket.onmessage=({data:r})=>{this.receiveRaw(r.toString())},this._socket.onerror=r=>{var i;(i=this._logger)===null||i===void 0||i.trace(`WebSocketConnection onError message:${r.message}`)},this._socket.onclose=r=>{var i;const s=this._connected,a=this._connecting;if((i=this._logger)===null||i===void 0||i.trace(`WebSocketConnection onClose wasConnected:${s.toString()} wasConnecting:${a.toString()} closingOnDemand:${this._closingOnDemand.toString()} wasClean:${r.wasClean.toString()}`),this._connected=!1,this._connecting=!1,this._closingOnDemand)this._closingOnDemand=!1,this.emit(this.onDisconnect,!0),this.emit(this.onEnd,!0);else{const o=new Error(`[${r.code}] ${r.reason}`);this.emit(this.onDisconnect,!1,o),this.emit(this.onEnd,!1,o)}this.clearSocket()}}disconnect(){var e,t;(e=this._logger)===null||e===void 0||e.trace("WebSocketConnection disconnect"),this._closingOnDemand=!0,(t=this._socket)===null||t===void 0||t.close()}clearSocket(){this._socket&&(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onerror=null,this._socket.onclose=null,this._socket=null)}}function k2(n){var e,t,r;if(Array.isArray(n)){for(t=Array(e=n.length);e--;)t[e]=(r=n[e])&&typeof r=="object"?k2(r):r;return t}if(Object.prototype.toString.call(n)==="[object Object]"){t={};for(e in n)e==="__proto__"?Object.defineProperty(t,e,{value:k2(n[e]),configurable:!0,enumerable:!0,writable:!0}):t[e]=(r=n[e])&&typeof r=="object"?k2(r):r;return t}return n}const zgt={name:"away-notify"};class UL extends Error{constructor(e,t,r){super(`command "${e}" expected ${t} or more parameters, got ${r}`),this._command=e,this._expectedParams=t,this._actualParams=r,Object.setPrototypeOf(this,UL.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,UL)}get command(){return this._command}get expectedParams(){return this._expectedParams}get actualParams(){return this._actualParams}}class BL extends Error{constructor(e,t,r,i){var s;super(`required parameter "${t}" did not validate against ${(s=r.type)!==null&&s!==void 0?s:"regex"} validation: "${i}"`),this._command=e,this._paramName=t,this._paramSpec=r,this._givenValue=i,Object.setPrototypeOf(this,BL.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,BL)}get command(){return this._command}get paramName(){return this._paramName}get paramSpec(){return this._paramSpec}get givenValue(){return this._givenValue}}const LT={channelTypes:"#&",supportedUserModes:"iwso",supportedChannelModes:{prefix:"ov",list:"b",alwaysWithParam:"ovk",paramWhenSet:"l",noParam:"imnpst"},prefixes:[{modeChar:"v",prefix:"+"},{modeChar:"o",prefix:"@"}]};var IF={exports:{}},Qie;function jgt(){return Qie||(Qie=1,(function(n){n.exports=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")},n.exports.default=n.exports})(IF)),IF.exports}var Hgt=jgt();const qgt=Bh(Hgt);function rz(n,e="#&"){return new RegExp(`^[${qgt(e)}][^ \b\0
\r,]+$`).test(n)}const Jie={0:"\0",n:`
`,r:"\r","":""};function ese(n){if(!n.startsWith("")||(n=n.substring(1),n.endsWith("")&&(n=n.slice(0,-1)),!n))return!1;n=n.replace(/\x10(.)/,(r,i)=>i in Jie?Jie[i]:"");let[e,t=""]=pE(n," ",2);return e=e?e.toUpperCase():"",{command:e,params:t}}const Vgt={"\\":"\\",";":":","\n":"n","\r":"r"," ":"s"};function Ggt(n){return n.replace(/[\\;\n\r ]/g,e=>`\\${Vgt[e]}`)}function $gt(n){let e=`${n.nick}`;return n.user&&(e+=`!${n.user}`),n.host&&(e+=`@${n.host}`),e}function Wgt(n,e,t,r,i=LT,s=!1){const a=new n(n.COMMAND,void 0,{serverProperties:i}),o={};if(a._paramSpec&&J9(a._paramSpec,(l,c)=>{if(!(s&&l.noServer)&&!(!s&&l.noClient)){if(c in e){const u=e[c];if(u!==void 0){if(n.checkParam(u,l,i))o[c]={value:u,trailing:!!l.trailing};else if(!l.optional)throw new Error(`required parameter "${c}" did not suit requirements: "${u}"`)}}if(!(c in o)&&!l.optional)throw new Error(`required parameter "${c}" not found in command "${n.COMMAND}"`)}}),a._parsedParams=o,a._paramSpec)for(const l of Object.keys(a._paramSpec))Object.defineProperty(a,l,{get(){var c,u;return(u=(c=this._parsedParams)===null||c===void 0?void 0:c[l])===null||u===void 0?void 0:u.value}});return a._initPrefixAndTags(t,r),a}class An{static checkParam(e,t,r=LT){return!(t.type==="channel"&&!rz(e,r.channelTypes)||t.type==="channelList"&&!e.split(",").every(s=>rz(s,r.channelTypes))||t.match&&!t.match.test(e))}constructor(e,{params:t,tags:r,prefix:i,rawLine:s}={},{serverProperties:a=LT,isServer:o=!1,shouldParseParams:l=!0}={},c){this._params=[],this._serverProperties=LT,this._paramSpec=c,this._command=e,this._params=t,this._tags=r??new Map,this._prefix=i,this._serverProperties=a,this._raw=s,l&&this.parseParams(o)}getMinParamCount(e=!1){return this._paramSpec?Object.values(this._paramSpec).filter(t=>t.noServer&&e||t.noClient&&!e?!1:!t.optional).length:0}get paramCount(){var e,t;return(t=(e=this._params)===null||e===void 0?void 0:e.length)!==null&&t!==void 0?t:0}prefixToString(){return this._prefix?$gt(this._prefix):""}tagsToString(){return[...this._tags.entries()].map(([e,t])=>t?`${e}=${Ggt(t)}`:e).join(";")}toString(e=!1,t=!1){const i=[t?this._buildCommandFromRawParams():this._buildCommandFromNamedParams()];if(e){const a=this.prefixToString();a&&i.unshift(`:${a}`)}const s=this.tagsToString();return s&&i.unshift(`@${s}`),i.join(" ")}_initPrefixAndTags(e,t){this._prefix=e,t&&(this._tags=t)}parseParams(e=!1){if(this._params){let t=this.getMinParamCount(e);if(t>this._params.length)throw new UL(this._command,t,this._params.length);const r=this._paramSpec;if(!r)return;let i=0;const s={};for(const[a,o]of Object.entries(r)){if(o.noServer&&e||o.noClient&&!e)continue;if(this._params.length-i<=t){if(o.optional)continue;if(this._params.length-i!==t)throw new Error("not enough parameters left for required parameters parsing (this is a library bug)")}let l=this._params[i];if(!l){if(o.optional)break;throw new Error("unexpected parameter underflow")}if(o.rest){const c=[];for(;this._params[i]&&!this._params[i].trailing;)c.push(this._params[i].value),++i;if(!c.length){if(o.optional)continue;throw new Error(`no parameters left for required rest parameter "${a}"`)}l={value:c.join(" "),trailing:!1}}if(An.checkParam(l.value,o))s[a]={...l},o.optional||--t,o.rest||++i;else if(!o.optional)throw new BL(this._command,a,o,l.value);if(o.trailing)break}if(this._parsedParams=s,this._paramSpec)for(const a of Object.keys(this._paramSpec))Object.defineProperty(this,a,{get(){var o,l;return(l=(o=this._parsedParams)===null||o===void 0?void 0:o[a])===null||l===void 0?void 0:l.value}})}}get rawParamValues(){var e,t;return(t=(e=this._params)===null||e===void 0?void 0:e.map(r=>r.value))!==null&&t!==void 0?t:[]}get prefix(){return this._prefix}get command(){return this._command}get tags(){return this._tags}get rawLine(){return this._raw}isResponseTo(e){return!1}endsResponseTo(e){return!1}_acceptsInReplyCollection(e){return e.isResponseTo(this)}_buildCommandFromNamedParams(){const e=this._paramSpec?Object.keys(this._paramSpec):[];return[this._command,...e.map(t=>{var r;const i=(r=this._parsedParams)===null||r===void 0?void 0:r[t];if(i)return(i.trailing?":":"")+i.value}).filter(t=>t!==void 0)].join(" ")}_buildCommandFromRawParams(){var e,t;return[this._command,...(t=(e=this._params)===null||e===void 0?void 0:e.map(r=>`${r.trailing?":":""}${r.value}`))!==null&&t!==void 0?t:[]].join(" ")}}An.COMMAND="";An.SUPPORTS_CAPTURE=!1;class Wve extends An{constructor(e,t,r){super(e,t,r,{reference:{},type:{optional:!0},additionalParams:{optional:!0}})}}Wve.COMMAND="BATCH";const Ygt={name:"batch",messageTypes:[Wve],usesTags:!0},Xgt={name:"cap-notify"};class Yve extends An{constructor(e,t,r){super(e,t,r,{newUser:{},newHost:{}})}}Yve.COMMAND="CHGHOST";const Kgt={name:"chghost",messageTypes:[Yve]},Zgt={name:"invite-notify"};class Xve extends An{}Xve.COMMAND="ACK";const Qgt={name:"labeled-response",messageTypes:[Xve],usesTags:!0},Jgt={name:"message-tags",usesTags:!0},e0t={name:"multi-prefix"},t0t=Object.freeze(Object.defineProperty({__proto__:null,AwayNotify:zgt,Batch:Ygt,CapNotify:Xgt,ChgHost:Kgt,InviteNotify:Zgt,LabeledResponse:Qgt,MessageTags:Jgt,MultiPrefix:e0t},Symbol.toStringTag,{value:"Module"}));class n0t{constructor(e,t,...r){this._client=e,this._originalMessage=t,this._messages=[],this._endEventHandlers=new Map,this._types=new Set(r)}untilEvent(e){this._cleanEndEventHandler(e);const t=this._client.on(e,()=>this.end());this._endEventHandlers.set(e,t)}async promise(){return this._promise||(this._promise=new Promise(e=>{this._promiseResolve=e})),await this._promise}collect(e){return this._originalMessage._acceptsInReplyCollection(e)?(this._messages.push(e),e.endsResponseTo(this._originalMessage)&&this.end(),!0):!1}end(){this._client.stopCollect(this),this._cleanEndEventHandlers(),this._promiseResolve&&this._promiseResolve(this._messages)}_cleanEndEventHandlers(){this._endEventHandlers.forEach(e=>{this._client.removeListener(e)}),this._endEventHandlers.clear()}_cleanEndEventHandler(e){this._endEventHandlers.has(e)&&(this._client.removeListener(this._endEventHandlers.get(e)),this._endEventHandlers.delete(e))}}class YV extends An{constructor(e,t,r){super(e,t,r,{password:{}})}}YV.COMMAND="PASS";class O2 extends An{constructor(e,t,r){super(e,t,r,{nick:{}})}}O2.COMMAND="NICK";class XV extends An{constructor(e,t,r){super(e,t,r,{user:{},mode:{},unused:{},realName:{trailing:!0}})}}XV.COMMAND="USER";class Kve extends An{constructor(e,t,r){super(e,t,r,{name:{},password:{}})}}Kve.COMMAND="OPER";class KV extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0,optional:!0}})}}KV.COMMAND="QUIT";class Zve extends An{constructor(e,t,r){super(e,t,r,{server:{},reason:{trailing:!0}})}}Zve.COMMAND="SQUIT";class Hk extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},key:{optional:!0}})}}Hk.COMMAND="JOIN";class qk extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},reason:{trailing:!0,optional:!0}})}}qk.COMMAND="PART";class FL extends Error{constructor(e){super(`Unknown channel mode character ${e}`),this._char=e,Object.setPrototypeOf(this,FL.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,FL)}get char(){return this._char}}class Qve extends An{constructor(e,t,r){super(e,t,r,{target:{},modes:{rest:!0,optional:!0}})}get isChannel(){return rz(this.target,this._serverProperties.channelTypes)}separate(){const e=[],t=this.modes;if(!t)throw new Error("can't separate a channel mode request, just set actions");const r=t.split(" "),i=r.shift();let s="add";for(const a of i){let o=s;switch(a){case"+":{s="add";break}case"-":{s="remove";break}default:{let l=!1,c=!0;if(this.isChannel){if(this._serverProperties.supportedChannelModes.alwaysWithParam.includes(a)||this._serverProperties.supportedChannelModes.prefix.includes(a))l=!0;else if(this._serverProperties.supportedChannelModes.paramWhenSet.includes(a))s==="add"&&(l=!0);else if(this._serverProperties.supportedChannelModes.list.includes(a))r.length?l=!0:o="getList";else if(!this._serverProperties.supportedChannelModes.noParam.includes(a))throw new FL(a)}else c=this._serverProperties.supportedUserModes.includes(a);if(l&&!r.length)continue;e.push({prefix:this._prefix,action:o,letter:a,param:l?r.shift():void 0,known:c})}}}return e}}Qve.COMMAND="MODE";class Jve extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},newTopic:{optional:!0,trailing:!0}})}}Jve.COMMAND="TOPIC";class u3 extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channelList",optional:!0}})}}u3.COMMAND="NAMES";u3.SUPPORTS_CAPTURE=!0;class eye extends An{constructor(e,t,r){super(e,t,r,{channel:{optional:!0},server:{optional:!0}})}}eye.COMMAND="LIST";class tye extends An{constructor(e,t,r){super(e,t,r,{target:{},channel:{type:"channel"}})}}tye.COMMAND="INVITE";class nye extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},target:{},reason:{trailing:!0,optional:!0}})}}nye.COMMAND="KICK";class rye extends An{constructor(e,t,r){super(e,t,r,{server:{optional:!0}})}}rye.COMMAND="TIME";class Vk extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}}Vk.COMMAND="PRIVMSG";class o5 extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}}o5.COMMAND="NOTICE";class l5 extends An{constructor(e,t,r){super(e,t,r,{mask:{},flags:{optional:!0},extendedMask:{optional:!0,trailing:!0}})}}l5.COMMAND="WHO";class iye extends An{constructor(e,t,r){super(e,t,r,{server:{optional:!0},nickMask:{}})}}iye.COMMAND="WHOIS";class sye extends An{constructor(e,t,r){super(e,t,r,{nick:{},count:{optional:!0},server:{optional:!0}})}}sye.COMMAND="WHOWAS";class aye extends An{constructor(e,t,r){super(e,t,r,{target:{},reason:{trailing:!0,optional:!0}})}}aye.COMMAND="KILL";class zL extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}zL.COMMAND="PING";class jL extends An{constructor(e,t,r){super(e,t,r,{server:{noClient:!0},text:{trailing:!0}})}}jL.COMMAND="PONG";class oye extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}oye.COMMAND="ERROR";class lye extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0,optional:!0}})}}lye.COMMAND="AWAY";class cye extends An{}cye.COMMAND="REHASH";class uye extends An{}uye.COMMAND="RESTART";class fye extends An{constructor(e,t,r){super(e,t,r,{text:{trailing:!0}})}}fye.COMMAND="WALLOPS";class hye extends An{constructor(e,t,r){super(e,t,r,{nicks:{rest:!0}})}}hye.COMMAND="USERHOST";class dye extends An{constructor(e,t,r){super(e,t,r,{nicks:{rest:!0}})}}dye.COMMAND="ISON";class E0 extends An{constructor(e,t,r){super(e,t,r,{target:{match:/^(?:[a-z_\-\[\]\\^{}|`][a-z0-9_\-\[\]\\^{}|`]+|\*)$/i,optional:!0,noClient:!0},subCommand:{match:/^(?:LS|LIST|REQ|ACK|NAK|END|NEW|DEL)$/i},version:{match:/^\d+$/,optional:!0},continued:{match:/^\*$/,optional:!0},capabilities:{trailing:!0,optional:!0}})}isResponseTo(e){if(!(e instanceof E0))return!1;switch(this.subCommand){case"ACK":case"NAK":return e.subCommand==="REQ"&&e.capabilities===this.capabilities.trim();case"LS":case"LIST":return e.subCommand===this.subCommand;default:return!1}}endsResponseTo(e){if(!(e instanceof E0))return!1;switch(this.subCommand){case"LS":case"LIST":return!this.continued;default:return!0}}}E0.COMMAND="CAP";E0.SUPPORTS_CAPTURE=!0;class pye extends An{constructor(e,t,r){super(e,t,r,{target:{}})}}pye.COMMAND="TAGMSG";const mye=Object.freeze(Object.defineProperty({__proto__:null,Away:lye,CapabilityNegotiation:E0,ChannelInvite:tye,ChannelJoin:Hk,ChannelKick:nye,ChannelList:eye,ChannelPart:qk,ClientQuit:KV,ErrorMessage:oye,IsOnQuery:dye,Kill:aye,Mode:Qve,Names:u3,NickChange:O2,Notice:o5,OperLogin:Kve,Password:YV,Ping:zL,Pong:jL,PrivateMessage:Vk,Rehash:cye,Restart:uye,ServerQuit:Zve,TagMessage:pye,Time:rye,Topic:Jve,UserHostQuery:hye,UserRegistration:XV,Wallops:fye,WhoIsQuery:iye,WhoQuery:l5,WhoWasQuery:sye},Symbol.toStringTag,{value:"Module"}));class ZV extends An{constructor(e,t,r){super(e,t,r,{me:{},welcomeText:{trailing:!0}})}}ZV.COMMAND="001";class gye extends An{constructor(e,t,r){super(e,t,r,{me:{},yourHost:{trailing:!0}})}}gye.COMMAND="002";class _ye extends An{constructor(e,t,r){super(e,t,r,{me:{},createdText:{trailing:!0}})}}_ye.COMMAND="003";class QV extends An{constructor(e,t,r){super(e,t,r,{me:{},serverName:{},version:{},userModes:{},channelModes:{},channelModesWithParam:{optional:!0}})}}QV.COMMAND="004";class JV extends An{constructor(e,t,r){super(e,t,r,{me:{},supports:{rest:!0},suffix:{trailing:!0}})}}JV.COMMAND="005";class vye extends An{constructor(e,t,r){super(e,t,r,{me:{},modes:{}})}}vye.COMMAND="221";class yye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},text:{trailing:!0}})}}yye.COMMAND="301";class bye extends An{constructor(e,t,r){super(e,t,r,{me:{},hosts:{trailing:!0}})}}bye.COMMAND="302";class Sye extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}Sye.COMMAND="305";class Eye extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}Eye.COMMAND="306";class xye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},username:{},host:{},_unused:{},realname:{trailing:!0}})}}xye.COMMAND="311";class Tye extends An{constructor(e,t,r){super(e,t,r,{me:{},query:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof l5}endsResponseTo(){return!0}}Tye.COMMAND="315";class wye extends An{constructor(e,t,r){super(e,t,r,{me:{},nickMask:{},suffix:{trailing:!0}})}}wye.COMMAND="318";class Rye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channels:{trailing:!0}})}}Rye.COMMAND="319";class Aye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},memberCount:{},topic:{trailing:!0}})}}Aye.COMMAND="322";class Cye extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}Cye.COMMAND="323";class Mye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},modes:{rest:!0}})}}Mye.COMMAND="324";class kye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}kye.COMMAND="331";class Oye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},topic:{trailing:!0}})}}Oye.COMMAND="332";class Iye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},who:{},ts:{}})}}Iye.COMMAND="333";class Nye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"}})}}Nye.COMMAND="341";class Pye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}Pye.COMMAND="348";class Dye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Dye.COMMAND="349";class Lye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},user:{},host:{},server:{},nick:{},flags:{},hopsAndRealName:{trailing:!0}})}get isAway(){return this.flags.includes("G")}get isOper(){return this.flags.includes("*")}get isBot(){return this.flags.includes("B")}isResponseTo(e){return e instanceof l5}}Lye.COMMAND="352";class Uye extends An{constructor(e,t,r){super(e,t,r,{me:{},channelType:{},channel:{type:"channel"},names:{trailing:!0}})}isResponseTo(e){return e instanceof u3}}Uye.COMMAND="353";class Bye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}isResponseTo(e){return e instanceof u3}endsResponseTo(){return!0}}Bye.COMMAND="366";class Fye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},mask:{},creatorName:{optional:!0},timestamp:{optional:!0}})}}Fye.COMMAND="367";class zye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}zye.COMMAND="368";class jye extends An{constructor(e,t,r){super(e,t,r,{me:{},line:{trailing:!0}})}}jye.COMMAND="372";class Hye extends An{constructor(e,t,r){super(e,t,r,{me:{},line:{trailing:!0}})}}Hye.COMMAND="375";class eG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}eG.COMMAND="376";class qye extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}qye.COMMAND="381";class Vye extends An{constructor(e,t,r){super(e,t,r,{me:{},server:{optional:!0},timestamp:{trailing:!0}})}}Vye.COMMAND="391";class Gye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}}Gye.COMMAND="401";class $ye extends An{constructor(e,t,r){super(e,t,r,{me:{},server:{},suffix:{trailing:!0}})}}$ye.COMMAND="402";class Wye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}Wye.COMMAND="403";class Yye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Yye.COMMAND="404";class Xye extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}Xye.COMMAND="405";class Kye extends An{constructor(e,t,r){super(e,t,r,{me:{},subCommand:{},suffix:{trailing:!0}})}}Kye.COMMAND="410";class Zye extends An{constructor(e,t,r){super(e,t,r,{me:{},originalCommand:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command===this.originalCommand}endsResponseTo(){return!0}}Zye.COMMAND="421";class tG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}tG.COMMAND="422";class Qye extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Qye.COMMAND="431";class Jye extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}Jye.COMMAND="432";class ebe extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}ebe.COMMAND="433";class tbe extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}tbe.COMMAND="436";class nbe extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}nbe.COMMAND="441";class rbe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}rbe.COMMAND="442";class ibe extends An{constructor(e,t,r){super(e,t,r,{me:{},nick:{},channel:{type:"channel"},suffix:{trailing:!0}})}isResponseTo(e){return e.command==="NICK"}endsResponseTo(){return!0}}ibe.COMMAND="443";class sbe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}sbe.COMMAND="451";class abe extends An{constructor(e,t,r){super(e,t,r,{me:{},originalCommand:{},suffix:{trailing:!0}})}}abe.COMMAND="461";class nG extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}nG.COMMAND="462";class obe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}obe.COMMAND="471";class lbe extends An{constructor(e,t,r){super(e,t,r,{me:{},char:{},suffix:{trailing:!0}})}}lbe.COMMAND="472";class cbe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}cbe.COMMAND="473";class ube extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}ube.COMMAND="474";class fbe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{type:"channel"},suffix:{trailing:!0}})}}fbe.COMMAND="475";class hbe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}hbe.COMMAND="479";class dbe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}dbe.COMMAND="481";class pbe extends An{constructor(e,t,r){super(e,t,r,{me:{},channel:{},suffix:{trailing:!0}})}}pbe.COMMAND="482";class mbe extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}mbe.COMMAND="491";class gbe extends An{constructor(e,t,r){super(e,t,r,{me:{},modeChar:{optional:!0,match:/^\w$/},suffix:{trailing:!0}})}}gbe.COMMAND="501";class _be extends An{constructor(e,t,r){super(e,t,r,{me:{},suffix:{trailing:!0}})}}_be.COMMAND="502";const vbe=Object.freeze(Object.defineProperty({__proto__:null,Error401NoSuchNick:Gye,Error402NoSuchServer:$ye,Error403NoSuchChannel:Wye,Error404CanNotSendToChan:Yye,Error405TooManyChannels:Xye,Error410InvalidCapCmd:Kye,Error421UnknownCommand:Zye,Error422NoMotd:tG,Error431NoNickNameGiven:Qye,Error432ErroneusNickname:Jye,Error433NickNameInUse:ebe,Error436NickCollision:tbe,Error441UserNotInChannel:nbe,Error442NotOnChannel:rbe,Error443UserOnChannel:ibe,Error451NotRegistered:sbe,Error461NeedMoreParams:abe,Error462AlreadyRegistered:nG,Error471ChannelIsFull:obe,Error472UnknownMode:lbe,Error473InviteOnlyChan:cbe,Error474BannedFromChan:ube,Error475BadChannelKey:fbe,Error479BadChanName:hbe,Error481NoPrivileges:dbe,Error482ChanOpPrivsNeeded:pbe,Error491NoOperHost:mbe,Error501UmodeUnknownFlag:gbe,Error502UsersDontMatch:_be,Reply001Welcome:ZV,Reply002YourHost:gye,Reply003Created:_ye,Reply004ServerInfo:QV,Reply005Isupport:JV,Reply221UmodeIs:vye,Reply301Away:yye,Reply302UserHost:bye,Reply305UnAway:Sye,Reply306NowAway:Eye,Reply311WhoisUser:xye,Reply315EndOfWho:Tye,Reply318EndOfWhois:wye,Reply319WhoisChannels:Rye,Reply322List:Aye,Reply323ListEnd:Cye,Reply324ChannelModeIs:Mye,Reply331NoTopic:kye,Reply332Topic:Oye,Reply333TopicWhoTime:Iye,Reply341Inviting:Nye,Reply348ExceptList:Pye,Reply349EndOfExceptList:Dye,Reply352WhoReply:Lye,Reply353NamesReply:Uye,Reply366EndOfNames:Bye,Reply367BanList:Fye,Reply368EndOfBanList:zye,Reply372Motd:jye,Reply375MotdStart:Hye,Reply376EndOfMotd:eG,Reply381YoureOper:qye,Reply391Time:Vye},Symbol.toStringTag,{value:"Module"})),r0t=new Map([...Object.values(mye),...Object.values(vbe)].map(n=>[n.COMMAND,n]));function i0t(n){const[e,t]=pE(n,"!",2);if(t){const[r,i]=pE(t,"@",2);return i?{nick:e,user:r,host:i}:{nick:e,host:r}}return{nick:e}}const tse={":":";",n:`
`,r:"\r",s:" "};function s0t(n){const e=new Map,t=n.split(";");for(const r of t){const[i,s]=pE(r,"=",2);i!==""&&e.set(i,s?s.replace(/\\(.?)/g,(a,o)=>Object.prototype.hasOwnProperty.call(tse,o)?tse[o]:o):"")}return e}function a0t(n,e=LT,t=r0t,r=!1,i=[],s=!0){const a=n.split(" ");let o,l;const c=[];let u,f;for(;a.length;){if([o]=a,o.startsWith("@")&&!u&&!l&&!f)u=s0t(o.slice(1));else if(o.startsWith(":"))if(!f&&!l)o.length>1&&(f=i0t(o.slice(1)));else{c.push({value:a.join(" ").slice(1),trailing:!0});break}else l?c.push({value:o,trailing:!1}):l=o.toUpperCase();a.shift()}if(u||(u=new Map),!l)throw new Error(`line without command received: ${n}`);s&&(s=!i.includes(l));let d=An;return t.has(l)&&(d=t.get(l)),new d(l,{params:c,tags:u,prefix:f,rawLine:n},{serverProperties:e,isServer:r,shouldParseParams:s})}class ybe extends l3{constructor(e){super(),this._registered=!1,this._supportsCapabilities=!0,this._events=new Map,this._registeredMessageTypes=new Map,this.onConnect=this.registerEvent(),this.onRegister=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onPrivmsg=this.registerEvent(),this.onAction=this.registerEvent(),this.onNotice=this.registerEvent(),this.onNickChange=this.registerEvent(),this.onCtcp=this.registerEvent(),this.onCtcpReply=this.registerEvent(),this.onPasswordError=this.registerEvent(),this.onAnyMessage=this.registerEvent(),this._serverProperties=k2(LT),this._supportedFeatures={},this._collectors=[],this._clientCapabilities=new Map,this._serverCapabilities=new Map,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._hasRegisteredBefore=!1,this._channelsFromLastRegister=new Set,this._initialConnectionSetupDone=!1;const{connection:t,credentials:r,channels:i,channelTypes:s,webSocket:a,logger:o={}}=e;this._options=e;const{pingOnInactivity:l=60,pingTimeout:c=10}=t;this._pingOnInactivity=l,this._pingTimeout=c,this._currentNick=r.nick,this._logger=s5({name:"ircv3",emoji:!0,...o}),this.registerCoreMessageTypes();const{hostName:u,secure:f,reconnect:d=!0}=t,g={hostName:u,port:this.port,secure:f},p={lineBased:!0,logger:this._logger,additionalOptions:e.connectionOptions},_=a?Fgt:Ugt;d?this._connection=new Bgt(_,g,p):this._connection=new _(p,this._logger,e.connectionOptions);for(const y of Object.values(t0t))this.addCapability(y);this.addInternalListener(this.onRegister,async()=>{const y=this._hasRegisteredBefore,v=this._channelsFromLastRegister;this._hasRegisteredBefore=!0,this._channelsFromLastRegister=new Set;const x=y&&this._options.rejoinChannelsOnReconnect?v:await Q9(i);if(x)for(const E of x)this.join(E)}),this.onTypedMessage(E0,async({subCommand:y,capabilities:v})=>{const x=v.split(" ");switch(y.toUpperCase()){case"NEW":{this._logger.debug(`Server registered new capabilities: ${x.join(", ")}`);const E=xN(x,O=>{if(!O)return{};const[N,I]=pE(O,"=",2);return{[N]:{name:N,param:I||!0}}});for(const[O,N]of Object.entries(E))this._serverCapabilities.set(O,N);const M=Object.keys(E);await this._negotiateCapabilities(Array.from(this._clientCapabilities.entries()).filter(([O])=>M.includes(O)).map(([,O])=>O));break}case"DEL":{this._logger.debug(`Server removed capabilities: ${x.join(", ")}`);for(const E of x)this._serverCapabilities.delete(E),this._negotiatedCapabilities.delete(E)}}}),this.onTypedMessage(zL,({text:y})=>{this.sendMessage(jL,{text:y})}),this.onTypedMessage(ZV,({me:y})=>this._handleReceivedClientNick(y)),this.onTypedMessage(QV,({userModes:y})=>{y&&(this._serverProperties.supportedUserModes=y)}),this.onTypedMessage(JV,({supports:y})=>{const v=xN(y.split(" "),x=>{const[E,M]=pE(x,"=",2);return{[E]:M||!0}});this._supportedFeatures={...this._supportedFeatures,...v}}),this.onTypedMessage(eG,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(tG,({me:y})=>{this._registered||(this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(nG,({me:y})=>{this._registered||(this._logger.warn("We thought we're not registered yet, but we actually are"),this._handleReceivedClientNick(y),this._registered=!0,this.emit(this.onRegister))}),this.onTypedMessage(Vk,y=>{var v;const{target:x,text:E}=y,M=ese(E),O=(v=y.prefix)===null||v===void 0?void 0:v.nick;M?M.command==="ACTION"?this.emit(this.onAction,x,O,M.params,y):this.emit(this.onCtcp,x,O,M.command,M.params,y):this.emit(this.onPrivmsg,x,O,E,y)}),this.onTypedMessage(O2,y=>{var v;const{nick:x}=y,E=(v=y.prefix)===null||v===void 0?void 0:v.nick;E===this._currentNick&&(this._currentNick=x),this.emit(this.onNickChange,E,x,y)}),this.onTypedMessage(o5,y=>{var v;const{target:x,text:E}=y,M=ese(E),O=(v=y.prefix)===null||v===void 0?void 0:v.nick;M&&this.emit(this.onCtcpReply,x,O,M.command,M.params,y),this.emit(this.onNotice,x,O,E,y)}),this._options.manuallyAcknowledgeJoins||this.onTypedMessage(Hk,({channel:y,prefix:v})=>{v?.nick===this._currentNick&&this.acknowledgeJoin(y)}),this.onTypedMessage(qk,y=>{var v;((v=y.prefix)===null||v===void 0?void 0:v.nick)===this._currentNick&&(this._currentChannels.delete(y.channel),this._channelsFromLastRegister.delete(y.channel))}),this.addInternalListener(this.onRegister,()=>this._startPingCheckTimer()),this._desiredNick=r.nick,this._userName=r.userName,this._realName=r.realName,s&&(this._serverProperties.channelTypes=s)}receiveLine(e){var t;this._logger.debug(`Received message: ${e}`);let r;try{r=a0t(e,this._serverProperties,this._registeredMessageTypes,!0,this._options.nonConformingCommands)}catch(i){this._logger.error(`Error parsing message: ${i.message}`),this._logger.trace((t=i.stack)!==null&&t!==void 0?t:"No stack available");return}this._logger.trace(`Parsed message: ${JSON.stringify(r)}`),this._startPingCheckTimer(),this.emit(this.onAnyMessage,r),this._handleEvents(r)}get serverProperties(){return k2(this._serverProperties)}get port(){const{webSocket:e,connection:{port:t,secure:r}}=this._options;return t||(e?r?443:80:r?6697:6667)}pingCheck(){const e=Date.now(),t=e.toString(),r=this.onTypedMessage(jL,i=>{const{text:s}=i;s===t&&(this._logger.debug(`Current ping: ${Date.now()-e}ms`),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),this.removeMessageListener(r))});this._pingTimeoutTimer=setTimeout(()=>{this.removeMessageListener(r),this._options.connection.reconnect===!1?this._logger.error(`Disconnecting because the last ping took over ${this._pingTimeout} seconds`):this._logger.warn(`Reconnecting because the last ping took over ${this._pingTimeout} seconds`),this._connection.assumeExternalDisconnect()},this._pingTimeout*1e3),this.sendMessage(zL,{text:t})}reconnect(e){this.quit(e),this.connect()}registerMessageType(e){e.COMMAND!==""&&(this._logger.trace(`Registering message type ${e.COMMAND}`),this._registeredMessageTypes.set(e.COMMAND.toUpperCase(),e))}knowsCommand(e){return this._registeredMessageTypes.has(e.toUpperCase())}getCommandClass(e){return this._registeredMessageTypes.get(e.toUpperCase())}acknowledgeJoin(e){this._currentChannels.add(e),this._channelsFromLastRegister.add(e)}connect(){this._supportsCapabilities=!1,this._negotiatedCapabilities=new Map,this._currentChannels=new Set,this._currentNick=this._desiredNick,this._setupConnection(),this._logger.info(`Connecting to ${this._options.connection.hostName}:${this.port}`),this._connection.connect()}addCapability(e){if(this._clientCapabilities.set(e.name,e),e.messageTypes)for(const t of Object.values(e.messageTypes))this.registerMessageType(t)}async registerCapability(e){return this.addCapability(e),this._serverCapabilities.has(e.name)?await this._negotiateCapabilities([e]):[]}send(e){this.sendRaw(e.toString())}sendRaw(e){this._connection.isConnected&&(this._logger.debug(`Sending message: ${e}`),this._connection.sendLine(e))}onNamedMessage(e,t,r){this._events.has(e)||this._events.set(e,new Map);const i=this._events.get(e);if(!r)do r=`${e}:${egt(Math.random()*1e4,4,"0")}`;while(i.has(r));return i.set(r,t),r}onTypedMessage(e,t,r){return this.onNamedMessage(e.COMMAND,t,r)}removeMessageListener(e){const[t]=e.split(":");this._events.has(t)&&this._events.get(t).delete(e)}createMessage(e,t,r){const i=r?new Map(Object.entries(r)):void 0;return Wgt(e,t,void 0,i,this.serverProperties)}sendMessage(e,t,r){this.send(this.createMessage(e,t,r))}async sendMessageAndCaptureReply(e,t){if(!e.SUPPORTS_CAPTURE)throw new Error(`The command "${e.COMMAND}" does not support reply capture`);const r=this.createMessage(e,t),i=this.collect(r).promise();return this.send(r),await i}get isConnected(){return this._connection.isConnected}get isConnecting(){return this._connection.isConnecting}get isRegistered(){return this._registered}get currentNick(){return this._currentNick}get currentChannels(){return Array.from(this._currentChannels)}collect(e,...t){const r=new n0t(this,e,...t);return this._collectors.push(r),r}stopCollect(e){this._collectors.splice(this._collectors.findIndex(t=>t===e),1)}join(e,t){this.sendMessage(Hk,{channel:e,key:t})}part(e){this.sendMessage(qk,{channel:e})}quit(e){this.sendMessage(KV,{text:e}),this.quitAbruptly()}quitAbruptly(){this._registered=!1,this._connection.disconnect()}say(e,t,r={}){this.sendMessage(Vk,{target:e,text:t},r)}sendCtcp(e,t,r){this.say(e,`${t.toUpperCase()} ${r}`)}action(e,t){this.sendCtcp(e,"ACTION",t)}changeNick(e){this._currentNick!==e&&(this._desiredNick=e,this.isRegistered&&this.sendMessage(O2,{nick:e}))}registerCoreMessageTypes(){J9(mye,e=>{this.registerMessageType(e)}),J9(vbe,e=>{this.registerMessageType(e)})}async _negotiateCapabilityBatch(e){return await Promise.all(e.filter(t=>t.length).map(async t=>await this._negotiateCapabilities(t)))}async _negotiateCapabilities(e){const t=xN(e,a=>({[a.name]:a})),i=(await this.sendMessageAndCaptureReply(E0,{subCommand:"REQ",capabilities:e.map(a=>a.name).join(" ")})).shift();if(!i)throw new Error("capability negotiation failed unexpectedly without any reply");if(!(i instanceof E0))throw new Error(`capability negotiation failed unexpectedly with "${i.command}" command`);const s=i.capabilities.split(" ").filter(a=>a);if(i.subCommand==="ACK"){this._logger.debug(`Successfully negotiated capabilities: ${s.join(", ")}`);const a=s.map(o=>t[o]);for(const o of a){const l=this._clientCapabilities.get(o.name);l.param=o.param,this._negotiatedCapabilities.set(l.name,l)}return a}return this._logger.warn(`Failed to negotiate capabilities: ${s.join(", ")}`),new Error("capabilities failed to negotiate")}_setupConnection(){this._initialConnectionSetupDone||(this._connection.onConnect(async()=>{var e,t;this._logger.info(`Connection to server ${this._options.connection.hostName}:${this.port} established`),this.emit(this.onConnect),this._logger.debug("Determining connection password");try{const[r]=await Promise.all([Q9(this._options.credentials.password),this.sendMessageAndCaptureReply(E0,{subCommand:"LS",version:"302"}).then(async i=>{if(!i.length||!(i[0]instanceof E0))return this._logger.debug("Server does not support capabilities"),[];this._supportsCapabilities=!0;const s=i.map(o=>xN(o.capabilities.split(" "),l=>{if(!l)return{};const[c,u]=pE(l,"=",2);return{[c]:{name:c,param:u||!0}}}));this._serverCapabilities=new Map(Object.entries(Object.assign({},...s))),this._logger.debug(`Capabilities supported by server: ${Array.from(this._serverCapabilities.keys()).join(", ")}`);const a=s.map(o=>{const l=Object.keys(o);return Array.from(this._clientCapabilities.entries()).filter(([c])=>l.includes(c)).map(([,c])=>c)});return await this._negotiateCapabilityBatch(a)}).then(()=>{this.sendMessage(E0,{subCommand:"END"})})]);r&&this.sendMessage(YV,{password:r}),this.sendMessage(O2,{nick:this._desiredNick}),this.sendMessage(XV,{user:(e=this._userName)!==null&&e!==void 0?e:this._desiredNick,mode:"8",unused:"*",realName:(t=this._realName)!==null&&t!==void 0?t:this._desiredNick})}catch(r){this.emit(this.onPasswordError,r),this.quit()}}),this._initialConnectionSetupDone=!0,this._connection.onReceive(e=>{this.receiveLine(e)}),this._connection.onDisconnect((e,t)=>{var r;if(this._registered=!1,this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._pingTimeoutTimer&&clearTimeout(this._pingTimeoutTimer),e)this._logger.info("Disconnected");else{const i=(r=this._options.connection.reconnect)!==null&&r!==void 0?r:!0,s=t?`Disconnected unexpectedly: ${t.message}`:"Disconnected unexpectedly";i?this._logger.warn(`${s}; trying to reconnect`):this._logger.error(s)}this.emit(this.onDisconnect,e,t)}),this._connection.onEnd(e=>{e||this._logger.warn("No further retries will be made")}))}_handleReceivedClientNick(e){this._currentNick!==e&&(this._currentNick!==""&&this._logger.warn(`Mismatching nicks: passed ${this._currentNick}, but you're actually ${e}`),this._currentNick=e)}_handleEvents(e){this._collectors.some(r=>r.collect(e));const t=this._events.get(e.constructor.COMMAND);if(t)for(const r of t.values())r(e)}_startPingCheckTimer(){this._pingCheckTimer&&clearTimeout(this._pingCheckTimer),this._connection.isConnected?this._pingCheckTimer=setTimeout(()=>this.pingCheck(),this._pingOnInactivity*1e3):this._pingCheckTimer=void 0}}ql([tS(!1)],ybe.prototype,"_options",void 0);class rG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},user:{trailing:!0,optional:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get channelId(){return this._tags.get("room-id")}get targetUserId(){var e;return(e=this._tags.get("target-user-id"))!==null&&e!==void 0?e:null}}rG.COMMAND="CLEARCHAT";class bbe extends An{}bbe.COMMAND="RECONNECT";class iG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"}})}}iG.COMMAND="ROOMSTATE";function o0t(n){switch(typeof n){case"undefined":return"";case"object":{if(n===null)return"";if("cacheKey"in n)return n.cacheKey;const e=JSON.stringify(n);if(e!=="{}")return e}default:return n.toString()}}function Sbe(n,e,t){return[n,...e.map(o0t)].join("/")+(t?"/":"")}const My=Symbol("cache");function l0t(n){var e,t;return t=class extends n{constructor(){super(...arguments),this[e]=new Map}getFromCache(r){if(this._cleanCache(),this[My].has(r)){const i=this[My].get(r);if(i)return i.value}}setCache(r,i,s){this[My].set(r,{value:i,expires:Date.now()+s*1e3})}removeFromCache(r,i){const s=this._getInternalCacheKey(r,i);i?this[My].forEach((a,o)=>{o.startsWith(s)&&this[My].delete(o)}):this[My].delete(s)}_cleanCache(){const r=Date.now();this[My].forEach((i,s)=>{i.expires<r&&this[My].delete(s)})}_getInternalCacheKey(r,i){if(typeof r=="string"){let s=r;return s.endsWith("/")||(s+="/"),s}else{const s=r.shift();return Sbe(s,r,i)}}},e=My,t}function Ebe(n=1/0){return function(e,t,r){if(r.get){const i=r.get;r.get=function(){const s=Sbe(t,[]),a=this.getFromCache(s);if(a)return a;const o=i.call(this);return this.setCache(s,o,n),o}}return r}}var gP;let L1=gP=class{constructor(e,t){this._userName=e.toLowerCase(),this._userData=t?new Map(t):new Map}static _parseBadgesLike(e){return e?new Map(e.split(",").map(t=>{const r=t.indexOf("/");return r===-1?[t,""]:[t.slice(0,r),t.slice(r+1)]})):new Map}get userName(){return this._userName}get displayName(){var e;return(e=this._userData.get("display-name"))!==null&&e!==void 0?e:this._userName}get color(){return this._userData.get("color")}get badges(){const e=this._userData.get("badges");return gP._parseBadgesLike(e)}get badgeInfo(){const e=this._userData.get("badge-info");return gP._parseBadgesLike(e)}get userId(){return this._userData.get("user-id")}get userType(){return this._userData.get("user-type")}get isBroadcaster(){return this.badges.has("broadcaster")}get isSubscriber(){return this.badges.has("subscriber")||this.isFounder}get isFounder(){return this.badges.has("founder")}get isMod(){return this.badges.has("moderator")}get isVip(){const e=this._userData.get("vip");return e!=null&&e!=="0"}get isArtist(){return this.badges.has("artist-badge")}};ql([tS(!1)],L1.prototype,"_userData",void 0);ql([Ebe()],L1.prototype,"badges",null);ql([Ebe()],L1.prototype,"badgeInfo",null);L1=gP=ql([l0t,c3("chat","ChatUser","userId")],L1);function sG(n){return n?new Map(n.split("/").map(e=>{const[t,r]=e.split(":",2);return r?[t,r.split(",")]:null}).filter(e=>e!==null)):new Map}class aG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},text:{trailing:!0,optional:!0}})}get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new L1(this._tags.get("login"),this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get emoteOffsets(){return sG(this._tags.get("emotes"))}}aG.COMMAND="USERNOTICE";class xbe extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"}})}}xbe.COMMAND="USERSTATE";class oG extends An{constructor(e,t,r){super(e,t,r,{target:{},text:{trailing:!0}})}get userInfo(){return new L1(this._prefix.nick,this._tags)}get emoteOffsets(){return sG(this._tags.get("emotes"))}}oG.COMMAND="WHISPER";const c0t={name:"twitch.tv/commands",messageTypes:[rG,bbe,iG,aG,xbe,oG]},u0t={name:"twitch.tv/membership"};class lG extends An{constructor(e,t,r){super(e,t,r,{channel:{type:"channel"},text:{trailing:!0}})}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userName(){return this._tags.get("login")}get channelId(){return this._tags.get("room-id")}get targetMessageId(){return this._tags.get("target-msg-id")}}lG.COMMAND="CLEARMSG";class Tbe extends An{}Tbe.COMMAND="GLOBALUSERSTATE";const f0t={name:"twitch.tv/tags",messageTypes:[Tbe,lG]},h0t=["ONE","TWO","THREE","FOUR","FIVE","SIX","SEVEN","EIGHT","NINE","TEN"];let HL=class extends Vk{get id(){return this._tags.get("id")}get date(){const e=this._tags.get("tmi-sent-ts");return new Date(Number(e))}get userInfo(){return new L1(this._prefix.nick,this._tags)}get channelId(){var e;return(e=this._tags.get("room-id"))!==null&&e!==void 0?e:null}get isCheer(){return this._tags.has("bits")}get isRedemption(){return!!this._tags.get("custom-reward-id")}get rewardId(){return this._tags.get("custom-reward-id")||null}get isFirst(){return this._tags.get("first-msg")==="1"}get isReturningChatter(){return this._tags.get("returning-chatter")==="1"}get isHighlight(){return this._tags.get("msg-id")==="highlighted-message"}get isReply(){return this._tags.has("reply-parent-msg-id")}get parentMessageId(){var e;return(e=this._tags.get("reply-parent-msg-id"))!==null&&e!==void 0?e:null}get parentMessageText(){var e;return(e=this._tags.get("reply-parent-msg-body"))!==null&&e!==void 0?e:null}get parentMessageUserId(){var e;return(e=this._tags.get("reply-parent-user-id"))!==null&&e!==void 0?e:null}get parentMessageUserName(){var e;return(e=this._tags.get("reply-parent-user-login"))!==null&&e!==void 0?e:null}get parentMessageUserDisplayName(){var e;return(e=this._tags.get("reply-parent-display-name"))!==null&&e!==void 0?e:null}get threadMessageId(){var e;return(e=this._tags.get("reply-thread-parent-msg-id"))!==null&&e!==void 0?e:null}get threadMessageUserId(){var e;return(e=this._tags.get("reply-thread-parent-user-id"))!==null&&e!==void 0?e:null}get bits(){var e;return Number((e=this._tags.get("bits"))!==null&&e!==void 0?e:0)}get emoteOffsets(){return sG(this._tags.get("emotes"))}get isHypeChat(){return this._tags.has("pinned-chat-paid-amount")}get hypeChatAmount(){return zk(this._tags.get("pinned-chat-paid-amount"),Number)}get hypeChatDecimalPlaces(){return zk(this._tags.get("pinned-chat-paid-exponent"),Number)}get hypeChatLocalizedAmount(){const e=this.hypeChatAmount;return e?e/10**this.hypeChatDecimalPlaces:null}get hypeChatCurrency(){var e;return(e=this._tags.get("pinned-chat-paid-currency"))!==null&&e!==void 0?e:null}get hypeChatLevel(){const e=this._tags.get("pinned-chat-paid-level");return e?h0t.indexOf(e)+1:null}get hypeChatIsSystemMessage(){const e=this._tags.get("pinned-chat-paid-is-system-message");return e?!!Number(e):null}};HL=ql([c3("chat","ChatMessage","id")],HL);function d0t(n){return n instanceof HL?n.tags.get("id"):n}function nse(n,e){if(n.length<=e)return[n];n=n.trim();const t=[];let r=0,i=e;for(;r<n.length;){let s=n.lastIndexOf(" ",i);(s===-1||s<=r||n.length-r+1<=e)&&(s=r+e);const a=n.slice(r,s).trim();a.length&&t.push(a),r=s+(n[s]===" "?1:0),i=r+e}return t}const p0t=/^[a-z0-9][a-z0-9_]{0,24}$/;function Hf(n){const e=n.replace(/^#/,"").toLowerCase();if(!p0t.test(e))throw new Error(`"${e}" is not a valid user or channel name. It must be at most 25 characters long, can only include letters, numbers and underscores, and can not start with an underscore.`);return e}function TN(n){return`#${Hf(n)}`}var iz;let qL=iz=class extends l3{constructor(e={}){var t,r,i,s,a,o,l;if(e.authProvider&&!e.authProvider.getAccessTokenForIntent)throw new pP("You can not connect to chat using an AuthProvider that does not support intents.\nTo get an anonymous, read-only connection, please don't pass an `AuthProvider` at all.\nTo get a read-write connection, please provide an auth provider that provides user access tokens via intents, such as `RefreshingAuthProvider`.");super(),this._authVerified=!1,this._authRetryCount=0,this.onConnect=this.registerEvent(),this.onDisconnect=this.registerEvent(),this.onTimeout=this.registerEvent(),this.onBan=this.registerEvent(),this.onBitsBadgeUpgrade=this.registerEvent(),this.onChatClear=this.registerEvent(),this.onEmoteOnly=this.registerEvent(),this.onFollowersOnly=this.registerEvent(),this.onJoin=this.registerEvent(),this.onJoinFailure=this.registerEvent(),this.onPart=this.registerEvent(),this.onMessageRemove=this.registerEvent(),this.onUniqueChat=this.registerEvent(),this.onRaid=this.registerEvent(),this.onRaidCancel=this.registerEvent(),this.onRitual=this.registerEvent(),this.onSlow=this.registerEvent(),this.onSubsOnly=this.registerEvent(),this.onSub=this.registerEvent(),this.onResub=this.registerEvent(),this.onSubGift=this.registerEvent(),this.onCommunitySub=this.registerEvent(),this.onSubExtend=this.registerEvent(),this.onRewardGift=this.registerEvent(),this.onPrimePaidUpgrade=this.registerEvent(),this.onGiftPaidUpgrade=this.registerEvent(),this.onPrimeCommunityGift=this.registerEvent(),this.onStandardPayForward=this.registerEvent(),this.onCommunityPayForward=this.registerEvent(),this.onAnnouncement=this.registerEvent(),this.onWhisper=this.registerEvent(),this.onNoPermission=this.registerEvent(),this.onMessageRatelimit=this.registerEvent(),this.onAuthenticationSuccess=this.registerEvent(),this.onAuthenticationFailure=this.registerEvent(),this.onTokenFetchFailure=this.registerEvent(),this.onMessageFailed=this.registerEvent(),this.onMessage=this.registerEvent(),this.onAction=this.registerEvent(),this._onJoinResult=this.registerInternalEvent(),this._ircClient=new ybe({connection:{hostName:(t=e.hostName)!==null&&t!==void 0?t:!((r=e.webSocket)!==null&&r!==void 0)||r?"irc-ws.chat.twitch.tv":"irc.chat.twitch.tv",secure:(i=e.ssl)!==null&&i!==void 0?i:!0},credentials:{nick:"",password:async()=>await this._getAuthToken()},webSocket:(s=e.webSocket)!==null&&s!==void 0?s:!0,connectionOptions:e.connectionOptions,logger:{name:"twurple:chat:irc",...e.logger},nonConformingCommands:["004"],manuallyAcknowledgeJoins:!0,rejoinChannelsOnReconnect:e.rejoinChannelsOnReconnect}),this._ircClient.onDisconnect((c,u)=>{var f,d,g,p;(f=this._messageRateLimiter)===null||f===void 0||f.clear(),(d=this._messageRateLimiter)===null||d===void 0||d.pause(),(g=this._joinRateLimiter)===null||g===void 0||g.clear(),(p=this._joinRateLimiter)===null||p===void 0||p.pause(),this.emit(this.onDisconnect,c,u)}),this._ircClient.registerMessageType(HL),this._chatLogger=s5({name:"twurple:chat:twitch",...e.logger}),this._authProvider=e.authProvider,this._useLegacyScopes=!!e.legacyScopes,this._readOnly=!!e.readOnly,this._authIntents=[...(a=e.authIntents)!==null&&a!==void 0?a:[],"chat"],this._isAlwaysMod=(o=e.isAlwaysMod)!==null&&o!==void 0?o:!1,this._botLevel=(l=e.botLevel)!==null&&l!==void 0?l:"none",this._ircClient.addCapability(f0t),this._ircClient.addCapability(c0t),e.requestMembershipEvents&&this._ircClient.addCapability(u0t),this._ircClient.onConnect(()=>{this.emit(this.onConnect)}),this._ircClient.onRegister(async()=>{var c,u;(c=this._messageRateLimiter)===null||c===void 0||c.resume(),(u=this._joinRateLimiter)===null||u===void 0||u.resume(),this._authVerified=!0,this._authRetryTimer=void 0,this._authRetryCount=0,this.emit(this.onAuthenticationSuccess);const f=await Q9(e.channels);f&&await Promise.all(f.map(async d=>{var g;try{await this.join(d)}catch(p){this._chatLogger.warn(`Failed to join configured channel ${d}; original message: ${(g=p?.message)!==null&&g!==void 0?g:p}`)}}))}),this._ircClient.onPasswordError(c=>{this._chatLogger.error(`Error fetching a token for connecting to the server: ${c.message}`),this.emit(this.onTokenFetchFailure,c)}),this._ircClient.onPrivmsg((c,u,f,d)=>{u!=="jtv"&&this.emit(this.onMessage,Hf(c),u,f,d)}),this._ircClient.onAction((c,u,f,d)=>{this.emit(this.onAction,Hf(c),u,f,d)}),this.addInternalListener(this._onJoinResult,(c,u,f)=>{f?this.emit(this.onJoinFailure,Hf(c),f):this._ircClient.acknowledgeJoin(c)}),this._ircClient.onTypedMessage(rG,c=>{const{channel:u,user:f,tags:d}=c,g=Hf(u);if(f){const p=d.get("ban-duration");p===void 0?this.emit(this.onBan,g,f,c):this.emit(this.onTimeout,g,f,Number(p),c)}else this.emit(this.onChatClear,g,c)}),this._ircClient.onTypedMessage(lG,c=>{const{channel:u,targetMessageId:f}=c;this.emit(this.onMessageRemove,Hf(u),f,c)}),this._ircClient.onTypedMessage(Hk,({prefix:c,channel:u})=>{this.emit(this.onJoin,Hf(u),c.nick)}),this._ircClient.onTypedMessage(qk,({prefix:c,channel:u})=>{this.emit(this.onPart,Hf(u),c.nick)}),this._ircClient.onTypedMessage(iG,({channel:c,tags:u})=>{let f=!1;if(u.has("subs-only")&&u.has("slow")&&(this.emit(this._onJoinResult,c,u),f=!0),!f){const d=Hf(c);if(u.has("slow")){const g=Number(u.get("slow"));g?this.emit(this.onSlow,d,!0,g):this.emit(this.onSlow,d,!1)}if(u.has("followers-only")){const g=Number(u.get("followers-only"));g===-1?this.emit(this.onFollowersOnly,d,!1):this.emit(this.onFollowersOnly,d,!0,g)}}}),this._ircClient.onTypedMessage(aG,c=>{const{channel:u,text:f,tags:d}=c,g=d.get("msg-id"),p=Hf(u);switch(g){case"sub":case"resub":{const _=g==="sub"?this.onSub:this.onResub,y=d.get("msg-param-sub-plan"),v=d.get("msg-param-streak-months"),x={userId:d.get("user-id"),displayName:d.get("display-name"),plan:y,planName:d.get("msg-param-sub-plan-name"),isPrime:y==="Prime",months:Number(d.get("msg-param-cumulative-months")),streak:v?Number(v):void 0,message:f};if(d.get("msg-param-was-gifted")==="true"){const M=d.get("msg-param-anon-gift")==="true",O=Number(d.get("msg-param-gift-months")),N=Number(d.get("msg-param-gift-month-being-redeemed"));M?x.originalGiftInfo={anonymous:!0,duration:O,redeemedMonth:N}:x.originalGiftInfo={anonymous:!1,duration:O,redeemedMonth:N,userId:d.get("msg-param-gifter-id"),userName:d.get("msg-param-gifter-login"),userDisplayName:d.get("msg-param-gifter-name")}}this.emit(_,p,d.get("login"),x,c);break}case"subgift":{const _=d.get("msg-param-sub-plan"),y=d.get("login"),v=y==="ananonymousgifter",x={userId:d.get("msg-param-recipient-id"),displayName:d.get("msg-param-recipient-display-name"),gifter:v?void 0:y,gifterUserId:v?void 0:d.get("user-id"),gifterDisplayName:v?void 0:d.get("display-name"),gifterGiftCount:v?void 0:Number(d.get("msg-param-sender-count")),giftDuration:Number(d.get("msg-param-gift-months")),plan:_,planName:d.get("msg-param-sub-plan-name"),isPrime:_==="Prime",months:Number(d.get("msg-param-months"))};this.emit(this.onSubGift,p,d.get("msg-param-recipient-user-name"),x,c);break}case"submysterygift":{const _=d.get("login"),y=_==="ananonymousgifter",v={gifter:y?void 0:_,gifterUserId:y?void 0:d.get("user-id"),gifterDisplayName:y?void 0:d.get("display-name"),gifterGiftCount:y?void 0:Number(d.get("msg-param-sender-count")),count:Number(d.get("msg-param-mass-gift-count")),plan:d.get("msg-param-sub-plan")};this.emit(this.onCommunitySub,p,d.get("login"),v,c);break}case"primepaidupgrade":{const _={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan")};this.emit(this.onPrimePaidUpgrade,p,d.get("login"),_,c);break}case"giftpaidupgrade":{const _={userId:d.get("user-id"),displayName:d.get("display-name"),gifter:d.get("msg-param-sender-login"),gifterDisplayName:d.get("msg-param-sender-name")};this.emit(this.onGiftPaidUpgrade,p,d.get("login"),_,c);break}case"standardpayforward":{const _=d.get("msg-param-prior-gifter-anonymous")==="true",y={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:_?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:_?void 0:d.get("msg-param-prior-gifter-display-name"),recipientUserId:d.get("msg-param-recipient-id"),recipientDisplayName:d.get("msg-param-recipient-display-name")};this.emit(this.onStandardPayForward,p,d.get("login"),y,c);break}case"communitypayforward":{const _=d.get("msg-param-prior-gifter-anonymous")==="true",y={userId:d.get("user-id"),displayName:d.get("display-name"),originalGifterUserId:_?void 0:d.get("msg-param-prior-gifter-id"),originalGifterDisplayName:_?void 0:d.get("msg-param-prior-gifter-display-name")};this.emit(this.onCommunityPayForward,p,d.get("login"),y,c);break}case"primecommunitygiftreceived":{const _={name:d.get("msg-param-gift-name"),gifter:d.get("login"),gifterDisplayName:d.get("display-name")};this.emit(this.onPrimeCommunityGift,p,d.get("msg-param-recipient"),_,c);break}case"raid":{const _={displayName:d.get("msg-param-displayName"),viewerCount:Number(d.get("msg-param-viewerCount"))};this.emit(this.onRaid,p,d.get("login"),_,c);break}case"unraid":{this.emit(this.onRaidCancel,p,c);break}case"ritual":{const _={ritualName:d.get("msg-param-ritual-name"),message:f};this.emit(this.onRitual,p,d.get("login"),_,c);break}case"bitsbadgetier":{const _={displayName:d.get("display-name"),threshold:Number(d.get("msg-param-threshold"))};this.emit(this.onBitsBadgeUpgrade,p,d.get("login"),_,c);break}case"extendsub":{const _={userId:d.get("user-id"),displayName:d.get("display-name"),plan:d.get("msg-param-sub-plan"),months:Number(d.get("msg-param-cumulative-months")),endMonth:Number(d.get("msg-param-sub-benefit-end-month"))};this.emit(this.onSubExtend,p,d.get("login"),_,c);break}case"rewardgift":{const _={domain:d.get("msg-param-domain"),gifterId:d.get("user-id"),gifterDisplayName:d.get("display-name"),count:Number(d.get("msg-param-selected-count")),gifterGiftCount:Number(d.get("msg-param-total-reward-count")),triggerType:d.get("msg-param-trigger-type")};this.emit(this.onRewardGift,p,d.get("login"),_,c);break}case"announcement":{const _={color:d.get("msg-param-color")};this.emit(this.onAnnouncement,p,d.get("login"),_,c);break}default:this._chatLogger.warn(`Unrecognized usernotice ID: ${g}`)}}),this._ircClient.onTypedMessage(oG,c=>{this.emit(this.onWhisper,c.prefix.nick,c.text,c)}),this._ircClient.onTypedMessage(o5,async({target:c,text:u,tags:f})=>{const d=f.get("msg-id");switch(d){case"emote_only_on":{this.emit(this.onEmoteOnly,Hf(c),!0);break}case"emote_only_off":{this.emit(this.onEmoteOnly,Hf(c),!1);break}case"msg_channel_suspended":case"msg_banned":{this.emit(this._onJoinResult,c,void 0,d);break}case"r9k_on":{this.emit(this.onUniqueChat,Hf(c),!0);break}case"r9k_off":{this.emit(this.onUniqueChat,Hf(c),!1);break}case"subs_on":{this.emit(this.onSubsOnly,Hf(c),!0);break}case"subs_off":{this.emit(this.onSubsOnly,Hf(c),!1);break}case"cmds_available":break;case"followers_on":case"followers_on_zero":case"followers_off":case"slow_on":case"slow_off":break;case"timeout_success":break;case"unrecognized_cmd":break;case"no_permission":{this.emit(this.onNoPermission,Hf(c),u);break}case"msg_ratelimit":{this.emit(this.onMessageRatelimit,Hf(c),u);break}case"msg_duplicate":case"msg_emoteonly":case"msg_followersonly":case"msg_followersonly_followed":case"msg_followersonly_zero":case"msg_subsonly":case"msg_slowmode":case"msg_r9k":case"msg_verified_email":case"msg_timedout":case"msg_rejected_mandatory":case"msg_channel_blocked":{this.emit(this.onMessageFailed,Hf(c),d);break}case void 0:{if(u==="Login authentication failed"||u==="Improperly formatted AUTH"||u==="Invalid NICK"){this._authVerified=!1,this._authRetryTimer||(this._authRetryTimer=Dve(120),this._authRetryCount=0);const g=this._authRetryTimer.next().value,p=++this._authRetryCount;this.emit(this.onAuthenticationFailure,u,p),g!==0&&this._chatLogger.info(`Retrying authentication in ${g} seconds`),await Jmt(g*1e3),this._ircClient.reconnect()}break}default:d.startsWith("usage_")||this._chatLogger.warn(`Unrecognized notice ID: '${d}'`)}})}connect(){this._authProvider||this._ircClient.changeNick(iz._generateJustinfanNick()),this._initializeRateLimiters(),this._ircClient.connect()}get irc(){return this._ircClient}get isConnected(){return this._ircClient.isConnected}get isConnecting(){return this._ircClient.isConnecting}get currentChannels(){return this._ircClient.currentChannels}async say(e,t,r={},i){const s={};r.replyTo&&(s["reply-parent-msg-id"]=d0t(r.replyTo));const a=nse(t,500);await Promise.all(a.map(async o=>await this._messageRateLimiter.request({type:"say",channel:TN(e),text:o,tags:s},i)))}async action(e,t,r){const i=nse(t,490);await Promise.all(i.map(async s=>await this._messageRateLimiter.request({type:"action",channel:TN(e),text:s},r)))}async join(e){await this._joinRateLimiter.request(TN(e))}part(e){this._ircClient.part(TN(e))}quit(){var e,t,r,i;(t=(e=this._messageRateLimiter)===null||e===void 0?void 0:e.destroy)===null||t===void 0||t.call(e),(i=(r=this._joinRateLimiter)===null||r===void 0?void 0:r.destroy)===null||i===void 0||i.call(r),this._messageRateLimiter=void 0,this._joinRateLimiter=void 0,this._ircClient.quitAbruptly()}reconnect(){this.quit(),this.connect()}async _getAuthToken(){var e,t;if(!this._authProvider){this._chatLogger.debug("No authProvider given; connecting anonymously");return}if(this._authToken&&!dP(this._authToken)&&this._authVerified)return this._chatLogger.debug("AccessToken assumed to be correct from last connection"),`oauth:${this._authToken.accessToken}`;const r=this._getNecessaryScopes();let i,s=!1;for(const a of this._authIntents){try{if(this._authToken=await this._authProvider.getAccessTokenForIntent(a,r),!this._authToken)continue;s=!0;const o=await jk(this._authToken.accessToken);if(!o.userName)throw new pP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}catch(o){o instanceof DT?i=o:this._chatLogger.error(`Retrieving an access token failed: ${o.message}`)}this._chatLogger.warn("No valid token available; trying to refresh");try{if(this._authToken=await((t=(e=this._authProvider).refreshAccessTokenForIntent)===null||t===void 0?void 0:t.call(e,a)),this._authToken){const o=await jk(this._authToken.accessToken);if(!o.userName)throw new pP("Could not determine a user name for your token; you might be trying to disguise an app token as a user token.");return this._ircClient.changeNick(o.userName),`oauth:${this._authToken.accessToken}`}}catch(o){o instanceof DT?i=o:this._chatLogger.error(`Refreshing the access token failed: ${o.message}`)}}throw this._authVerified=!1,i??new Error(s?"Could not retrieve a valid token":`None of the queried intents (${this._authIntents.join(", ")}) are known by the auth provider${this._authProvider instanceof D1?".\nPlease add one of these to the user you want to connect with using the `addIntentToUser` method or the additional parameter to `addUser` or `addUserForToken`.":""}`)}_getNecessaryScopes(){return this._useLegacyScopes?["chat_login"]:this._readOnly?["chat:read"]:["chat:read","chat:edit"]}static _generateJustinfanNick(){return`justinfan${Math.floor(Math.random()*1e5).toString().padStart(5,"0")}`}_initializeRateLimiters(){const e=async({type:r,text:i,channel:s,tags:a})=>{r==="say"?this._ircClient.say(s,i,a):this._ircClient.action(s,i)},t=async r=>{const{promise:i,resolve:s,reject:a}=ez();let o;const l=this.addInternalListener(this._onJoinResult,(c,u,f)=>{c===r&&(clearTimeout(o),f?a(f):s(),this.removeListener(l))});o=setTimeout(()=>{this.removeListener(l),this.emit(this._onJoinResult,r,void 0,"twurple_timeout"),a(new Error(`Did not receive a reply to join ${r} in time; assuming that the join failed`))},1e4),this._ircClient.join(r),await i};if(this._isAlwaysMod)this._messageRateLimiter=new tz({bucketSize:this._botLevel==="verified"?7500:100,timeFrame:32e3,doRequest:e});else{let r=20;this._botLevel==="verified"?r=7500:this._botLevel==="known"&&(r=50),this._messageRateLimiter=new fgt(new ugt({bucketSize:1,timeFrame:1200,logger:{minLevel:ti.ERROR},doRequest:e,getPartitionKey:({channel:i})=>i}),{bucketSize:r,timeFrame:32e3})}this._joinRateLimiter=new tz({bucketSize:this._botLevel==="verified"?2e3:20,timeFrame:11e3,doRequest:t}),this._messageRateLimiter.pause(),this._joinRateLimiter.pause()}};ql([tS(!1)],qL.prototype,"_authProvider",void 0);qL=iz=ql([c3("chat","ChatClient")],qL);var NF={exports:{}},rse;function m0t(){return rse||(rse=1,(function(n,e){(function(t,r){n.exports=r()})(self,(()=>(()=>{var t={2505:(a,o,l)=>{a.exports=l(8015)},5592:(a,o,l)=>{var c=l(9516),u=l(7522),f=l(3948),d=l(9106),g=l(9615),p=l(2012),_=l(4202),y=l(4896),v=l(5845),x=l(8563),E=l(5656);a.exports=function(M){return new Promise((function(O,N){var I,D=M.data,V=M.headers,G=M.responseType;function Q(){M.cancelToken&&M.cancelToken.unsubscribe(I),M.signal&&M.signal.removeEventListener("abort",I)}c.isFormData(D)&&c.isStandardBrowserEnv()&&delete V["Content-Type"];var B=new XMLHttpRequest;if(M.auth){var $=M.auth.username||"",U=M.auth.password?unescape(encodeURIComponent(M.auth.password)):"";V.Authorization="Basic "+btoa($+":"+U)}var J=g(M.baseURL,M.url);function W(){if(B){var ae="getAllResponseHeaders"in B?p(B.getAllResponseHeaders()):null,Z={data:G&&G!=="text"&&G!=="json"?B.response:B.responseText,status:B.status,statusText:B.statusText,headers:ae,config:M,request:B};u((function(K){O(K),Q()}),(function(K){N(K),Q()}),Z),B=null}}if(B.open(M.method.toUpperCase(),d(J,M.params,M.paramsSerializer),!0),B.timeout=M.timeout,"onloadend"in B?B.onloadend=W:B.onreadystatechange=function(){B&&B.readyState===4&&(B.status!==0||B.responseURL&&B.responseURL.indexOf("file:")===0)&&setTimeout(W)},B.onabort=function(){B&&(N(new v("Request aborted",v.ECONNABORTED,M,B)),B=null)},B.onerror=function(){N(new v("Network Error",v.ERR_NETWORK,M,B,B)),B=null},B.ontimeout=function(){var ae=M.timeout?"timeout of "+M.timeout+"ms exceeded":"timeout exceeded",Z=M.transitional||y;M.timeoutErrorMessage&&(ae=M.timeoutErrorMessage),N(new v(ae,Z.clarifyTimeoutError?v.ETIMEDOUT:v.ECONNABORTED,M,B)),B=null},c.isStandardBrowserEnv()){var q=(M.withCredentials||_(J))&&M.xsrfCookieName?f.read(M.xsrfCookieName):void 0;q&&(V[M.xsrfHeaderName]=q)}"setRequestHeader"in B&&c.forEach(V,(function(ae,Z){D===void 0&&Z.toLowerCase()==="content-type"?delete V[Z]:B.setRequestHeader(Z,ae)})),c.isUndefined(M.withCredentials)||(B.withCredentials=!!M.withCredentials),G&&G!=="json"&&(B.responseType=M.responseType),typeof M.onDownloadProgress=="function"&&B.addEventListener("progress",M.onDownloadProgress),typeof M.onUploadProgress=="function"&&B.upload&&B.upload.addEventListener("progress",M.onUploadProgress),(M.cancelToken||M.signal)&&(I=function(ae){B&&(N(!ae||ae&&ae.type?new x:ae),B.abort(),B=null)},M.cancelToken&&M.cancelToken.subscribe(I),M.signal&&(M.signal.aborted?I():M.signal.addEventListener("abort",I))),D||(D=null);var Y=E(J);Y&&["http","https","file"].indexOf(Y)===-1?N(new v("Unsupported protocol "+Y+":",v.ERR_BAD_REQUEST,M)):B.send(D)}))}},8015:(a,o,l)=>{var c=l(9516),u=l(9012),f=l(5155),d=l(5343),g=(function p(_){var y=new f(_),v=u(f.prototype.request,y);return c.extend(v,f.prototype,y),c.extend(v,y),v.create=function(x){return p(d(_,x))},v})(l(7412));g.Axios=f,g.CanceledError=l(8563),g.CancelToken=l(3191),g.isCancel=l(3864),g.VERSION=l(9641).version,g.toFormData=l(6440),g.AxiosError=l(5845),g.Cancel=g.CanceledError,g.all=function(p){return Promise.all(p)},g.spread=l(7980),g.isAxiosError=l(5019),a.exports=g,a.exports.default=g},3191:(a,o,l)=>{var c=l(8563);function u(f){if(typeof f!="function")throw new TypeError("executor must be a function.");var d;this.promise=new Promise((function(p){d=p}));var g=this;this.promise.then((function(p){if(g._listeners){var _,y=g._listeners.length;for(_=0;_<y;_++)g._listeners[_](p);g._listeners=null}})),this.promise.then=function(p){var _,y=new Promise((function(v){g.subscribe(v),_=v})).then(p);return y.cancel=function(){g.unsubscribe(_)},y},f((function(p){g.reason||(g.reason=new c(p),d(g.reason))}))}u.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},u.prototype.subscribe=function(f){this.reason?f(this.reason):this._listeners?this._listeners.push(f):this._listeners=[f]},u.prototype.unsubscribe=function(f){if(this._listeners){var d=this._listeners.indexOf(f);d!==-1&&this._listeners.splice(d,1)}},u.source=function(){var f;return{token:new u((function(d){f=d})),cancel:f}},a.exports=u},8563:(a,o,l)=>{var c=l(5845);function u(f){c.call(this,f??"canceled",c.ERR_CANCELED),this.name="CanceledError"}l(9516).inherits(u,c,{__CANCEL__:!0}),a.exports=u},3864:a=>{a.exports=function(o){return!(!o||!o.__CANCEL__)}},5155:(a,o,l)=>{var c=l(9516),u=l(9106),f=l(3471),d=l(4490),g=l(5343),p=l(9615),_=l(4841),y=_.validators;function v(x){this.defaults=x,this.interceptors={request:new f,response:new f}}v.prototype.request=function(x,E){typeof x=="string"?(E=E||{}).url=x:E=x||{},(E=g(this.defaults,E)).method?E.method=E.method.toLowerCase():this.defaults.method?E.method=this.defaults.method.toLowerCase():E.method="get";var M=E.transitional;M!==void 0&&_.assertOptions(M,{silentJSONParsing:y.transitional(y.boolean),forcedJSONParsing:y.transitional(y.boolean),clarifyTimeoutError:y.transitional(y.boolean)},!1);var O=[],N=!0;this.interceptors.request.forEach((function($){typeof $.runWhen=="function"&&$.runWhen(E)===!1||(N=N&&$.synchronous,O.unshift($.fulfilled,$.rejected))}));var I,D=[];if(this.interceptors.response.forEach((function($){D.push($.fulfilled,$.rejected)})),!N){var V=[d,void 0];for(Array.prototype.unshift.apply(V,O),V=V.concat(D),I=Promise.resolve(E);V.length;)I=I.then(V.shift(),V.shift());return I}for(var G=E;O.length;){var Q=O.shift(),B=O.shift();try{G=Q(G)}catch($){B($);break}}try{I=d(G)}catch($){return Promise.reject($)}for(;D.length;)I=I.then(D.shift(),D.shift());return I},v.prototype.getUri=function(x){x=g(this.defaults,x);var E=p(x.baseURL,x.url);return u(E,x.params,x.paramsSerializer)},c.forEach(["delete","get","head","options"],(function(x){v.prototype[x]=function(E,M){return this.request(g(M||{},{method:x,url:E,data:(M||{}).data}))}})),c.forEach(["post","put","patch"],(function(x){function E(M){return function(O,N,I){return this.request(g(I||{},{method:x,headers:M?{"Content-Type":"multipart/form-data"}:{},url:O,data:N}))}}v.prototype[x]=E(),v.prototype[x+"Form"]=E(!0)})),a.exports=v},5845:(a,o,l)=>{var c=l(9516);function u(g,p,_,y,v){Error.call(this),this.message=g,this.name="AxiosError",p&&(this.code=p),_&&(this.config=_),y&&(this.request=y),v&&(this.response=v)}c.inherits(u,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var f=u.prototype,d={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED"].forEach((function(g){d[g]={value:g}})),Object.defineProperties(u,d),Object.defineProperty(f,"isAxiosError",{value:!0}),u.from=function(g,p,_,y,v,x){var E=Object.create(f);return c.toFlatObject(g,E,(function(M){return M!==Error.prototype})),u.call(E,g.message,p,_,y,v),E.name=g.name,x&&Object.assign(E,x),E},a.exports=u},3471:(a,o,l)=>{var c=l(9516);function u(){this.handlers=[]}u.prototype.use=function(f,d,g){return this.handlers.push({fulfilled:f,rejected:d,synchronous:!!g&&g.synchronous,runWhen:g?g.runWhen:null}),this.handlers.length-1},u.prototype.eject=function(f){this.handlers[f]&&(this.handlers[f]=null)},u.prototype.forEach=function(f){c.forEach(this.handlers,(function(d){d!==null&&f(d)}))},a.exports=u},9615:(a,o,l)=>{var c=l(9137),u=l(4680);a.exports=function(f,d){return f&&!c(d)?u(f,d):d}},4490:(a,o,l)=>{var c=l(9516),u=l(2881),f=l(3864),d=l(7412),g=l(8563);function p(_){if(_.cancelToken&&_.cancelToken.throwIfRequested(),_.signal&&_.signal.aborted)throw new g}a.exports=function(_){return p(_),_.headers=_.headers||{},_.data=u.call(_,_.data,_.headers,_.transformRequest),_.headers=c.merge(_.headers.common||{},_.headers[_.method]||{},_.headers),c.forEach(["delete","get","head","post","put","patch","common"],(function(y){delete _.headers[y]})),(_.adapter||d.adapter)(_).then((function(y){return p(_),y.data=u.call(_,y.data,y.headers,_.transformResponse),y}),(function(y){return f(y)||(p(_),y&&y.response&&(y.response.data=u.call(_,y.response.data,y.response.headers,_.transformResponse))),Promise.reject(y)}))}},5343:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){f=f||{};var d={};function g(E,M){return c.isPlainObject(E)&&c.isPlainObject(M)?c.merge(E,M):c.isPlainObject(M)?c.merge({},M):c.isArray(M)?M.slice():M}function p(E){return c.isUndefined(f[E])?c.isUndefined(u[E])?void 0:g(void 0,u[E]):g(u[E],f[E])}function _(E){if(!c.isUndefined(f[E]))return g(void 0,f[E])}function y(E){return c.isUndefined(f[E])?c.isUndefined(u[E])?void 0:g(void 0,u[E]):g(void 0,f[E])}function v(E){return E in f?g(u[E],f[E]):E in u?g(void 0,u[E]):void 0}var x={url:_,method:_,data:_,baseURL:y,transformRequest:y,transformResponse:y,paramsSerializer:y,timeout:y,timeoutMessage:y,withCredentials:y,adapter:y,responseType:y,xsrfCookieName:y,xsrfHeaderName:y,onUploadProgress:y,onDownloadProgress:y,decompress:y,maxContentLength:y,maxBodyLength:y,beforeRedirect:y,transport:y,httpAgent:y,httpsAgent:y,cancelToken:y,socketPath:y,responseEncoding:y,validateStatus:v};return c.forEach(Object.keys(u).concat(Object.keys(f)),(function(E){var M=x[E]||p,O=M(E);c.isUndefined(O)&&M!==v||(d[E]=O)})),d}},7522:(a,o,l)=>{var c=l(5845);a.exports=function(u,f,d){var g=d.config.validateStatus;d.status&&g&&!g(d.status)?f(new c("Request failed with status code "+d.status,[c.ERR_BAD_REQUEST,c.ERR_BAD_RESPONSE][Math.floor(d.status/100)-4],d.config,d.request,d)):u(d)}},2881:(a,o,l)=>{var c=l(9516),u=l(7412);a.exports=function(f,d,g){var p=this||u;return c.forEach(g,(function(_){f=_.call(p,f,d)})),f}},7412:(a,o,l)=>{var c=l(9516),u=l(7018),f=l(5845),d=l(4896),g=l(6440),p={"Content-Type":"application/x-www-form-urlencoded"};function _(x,E){!c.isUndefined(x)&&c.isUndefined(x["Content-Type"])&&(x["Content-Type"]=E)}var y,v={transitional:d,adapter:((typeof XMLHttpRequest<"u"||typeof xl<"u"&&Object.prototype.toString.call(xl)==="[object process]")&&(y=l(5592)),y),transformRequest:[function(x,E){if(u(E,"Accept"),u(E,"Content-Type"),c.isFormData(x)||c.isArrayBuffer(x)||c.isBuffer(x)||c.isStream(x)||c.isFile(x)||c.isBlob(x))return x;if(c.isArrayBufferView(x))return x.buffer;if(c.isURLSearchParams(x))return _(E,"application/x-www-form-urlencoded;charset=utf-8"),x.toString();var M,O=c.isObject(x),N=E&&E["Content-Type"];if((M=c.isFileList(x))||O&&N==="multipart/form-data"){var I=this.env&&this.env.FormData;return g(M?{"files[]":x}:x,I&&new I)}return O||N==="application/json"?(_(E,"application/json"),(function(D,V,G){if(c.isString(D))try{return(V||JSON.parse)(D),c.trim(D)}catch(Q){if(Q.name!=="SyntaxError")throw Q}return(G||JSON.stringify)(D)})(x)):x}],transformResponse:[function(x){var E=this.transitional||v.transitional,M=E&&E.silentJSONParsing,O=E&&E.forcedJSONParsing,N=!M&&this.responseType==="json";if(N||O&&c.isString(x)&&x.length)try{return JSON.parse(x)}catch(I){if(N)throw I.name==="SyntaxError"?f.from(I,f.ERR_BAD_RESPONSE,this,null,this.response):I}return x}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:l(1534)},validateStatus:function(x){return x>=200&&x<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};c.forEach(["delete","get","head"],(function(x){v.headers[x]={}})),c.forEach(["post","put","patch"],(function(x){v.headers[x]=c.merge(p)})),a.exports=v},4896:a=>{a.exports={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1}},9641:a=>{a.exports={version:"0.27.2"}},9012:a=>{a.exports=function(o,l){return function(){for(var c=new Array(arguments.length),u=0;u<c.length;u++)c[u]=arguments[u];return o.apply(l,c)}}},9106:(a,o,l)=>{var c=l(9516);function u(f){return encodeURIComponent(f).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}a.exports=function(f,d,g){if(!d)return f;var p;if(g)p=g(d);else if(c.isURLSearchParams(d))p=d.toString();else{var _=[];c.forEach(d,(function(v,x){v!=null&&(c.isArray(v)?x+="[]":v=[v],c.forEach(v,(function(E){c.isDate(E)?E=E.toISOString():c.isObject(E)&&(E=JSON.stringify(E)),_.push(u(x)+"="+u(E))})))})),p=_.join("&")}if(p){var y=f.indexOf("#");y!==-1&&(f=f.slice(0,y)),f+=(f.indexOf("?")===-1?"?":"&")+p}return f}},4680:a=>{a.exports=function(o,l){return l?o.replace(/\/+$/,"")+"/"+l.replace(/^\/+/,""):o}},3948:(a,o,l)=>{var c=l(9516);a.exports=c.isStandardBrowserEnv()?{write:function(u,f,d,g,p,_){var y=[];y.push(u+"="+encodeURIComponent(f)),c.isNumber(d)&&y.push("expires="+new Date(d).toGMTString()),c.isString(g)&&y.push("path="+g),c.isString(p)&&y.push("domain="+p),_===!0&&y.push("secure"),document.cookie=y.join("; ")},read:function(u){var f=document.cookie.match(new RegExp("(^|;\\s*)("+u+")=([^;]*)"));return f?decodeURIComponent(f[3]):null},remove:function(u){this.write(u,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},9137:a=>{a.exports=function(o){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(o)}},5019:(a,o,l)=>{var c=l(9516);a.exports=function(u){return c.isObject(u)&&u.isAxiosError===!0}},4202:(a,o,l)=>{var c=l(9516);a.exports=c.isStandardBrowserEnv()?(function(){var u,f=/(msie|trident)/i.test(navigator.userAgent),d=document.createElement("a");function g(p){var _=p;return f&&(d.setAttribute("href",_),_=d.href),d.setAttribute("href",_),{href:d.href,protocol:d.protocol?d.protocol.replace(/:$/,""):"",host:d.host,search:d.search?d.search.replace(/^\?/,""):"",hash:d.hash?d.hash.replace(/^#/,""):"",hostname:d.hostname,port:d.port,pathname:d.pathname.charAt(0)==="/"?d.pathname:"/"+d.pathname}}return u=g(window.location.href),function(p){var _=c.isString(p)?g(p):p;return _.protocol===u.protocol&&_.host===u.host}})():function(){return!0}},7018:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){c.forEach(u,(function(d,g){g!==f&&g.toUpperCase()===f.toUpperCase()&&(u[f]=d,delete u[g])}))}},1534:a=>{a.exports=null},2012:(a,o,l)=>{var c=l(9516),u=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];a.exports=function(f){var d,g,p,_={};return f&&c.forEach(f.split(`
`),(function(y){if(p=y.indexOf(":"),d=c.trim(y.substr(0,p)).toLowerCase(),g=c.trim(y.substr(p+1)),d){if(_[d]&&u.indexOf(d)>=0)return;_[d]=d==="set-cookie"?(_[d]?_[d]:[]).concat([g]):_[d]?_[d]+", "+g:g}})),_}},5656:a=>{a.exports=function(o){var l=/^([-+\w]{1,25})(:?\/\/|:)/.exec(o);return l&&l[1]||""}},7980:a=>{a.exports=function(o){return function(l){return o.apply(null,l)}}},6440:(a,o,l)=>{var c=l(9516);a.exports=function(u,f){f=f||new FormData;var d=[];function g(p){return p===null?"":c.isDate(p)?p.toISOString():c.isArrayBuffer(p)||c.isTypedArray(p)?typeof Blob=="function"?new Blob([p]):mf.from(p):p}return(function p(_,y){if(c.isPlainObject(_)||c.isArray(_)){if(d.indexOf(_)!==-1)throw Error("Circular reference detected in "+y);d.push(_),c.forEach(_,(function(v,x){if(!c.isUndefined(v)){var E,M=y?y+"."+x:x;if(v&&!y&&typeof v=="object"){if(c.endsWith(x,"{}"))v=JSON.stringify(v);else if(c.endsWith(x,"[]")&&(E=c.toArray(v)))return void E.forEach((function(O){!c.isUndefined(O)&&f.append(M,g(O))}))}p(v,M)}})),d.pop()}else f.append(y,g(_))})(u),f}},4841:(a,o,l)=>{var c=l(9641).version,u=l(5845),f={};["object","boolean","number","function","string","symbol"].forEach((function(g,p){f[g]=function(_){return typeof _===g||"a"+(p<1?"n ":" ")+g}}));var d={};f.transitional=function(g,p,_){function y(v,x){return"[Axios v"+c+"] Transitional option '"+v+"'"+x+(_?". "+_:"")}return function(v,x,E){if(g===!1)throw new u(y(x," has been removed"+(p?" in "+p:"")),u.ERR_DEPRECATED);return p&&!d[x]&&(d[x]=!0,console.warn(y(x," has been deprecated since v"+p+" and will be removed in the near future"))),!g||g(v,x,E)}},a.exports={assertOptions:function(g,p,_){if(typeof g!="object")throw new u("options must be an object",u.ERR_BAD_OPTION_VALUE);for(var y=Object.keys(g),v=y.length;v-- >0;){var x=y[v],E=p[x];if(E){var M=g[x],O=M===void 0||E(M,x,g);if(O!==!0)throw new u("option "+x+" must be "+O,u.ERR_BAD_OPTION_VALUE)}else if(_!==!0)throw new u("Unknown option "+x,u.ERR_BAD_OPTION)}},validators:f}},9516:(a,o,l)=>{var c,u=l(9012),f=Object.prototype.toString,d=(c=Object.create(null),function(B){var $=f.call(B);return c[$]||(c[$]=$.slice(8,-1).toLowerCase())});function g(B){return B=B.toLowerCase(),function($){return d($)===B}}function p(B){return Array.isArray(B)}function _(B){return B===void 0}var y=g("ArrayBuffer");function v(B){return B!==null&&typeof B=="object"}function x(B){if(d(B)!=="object")return!1;var $=Object.getPrototypeOf(B);return $===null||$===Object.prototype}var E=g("Date"),M=g("File"),O=g("Blob"),N=g("FileList");function I(B){return f.call(B)==="[object Function]"}var D=g("URLSearchParams");function V(B,$){if(B!=null)if(typeof B!="object"&&(B=[B]),p(B))for(var U=0,J=B.length;U<J;U++)$.call(null,B[U],U,B);else for(var W in B)Object.prototype.hasOwnProperty.call(B,W)&&$.call(null,B[W],W,B)}var G,Q=(G=typeof Uint8Array<"u"&&Object.getPrototypeOf(Uint8Array),function(B){return G&&B instanceof G});a.exports={isArray:p,isArrayBuffer:y,isBuffer:function(B){return B!==null&&!_(B)&&B.constructor!==null&&!_(B.constructor)&&typeof B.constructor.isBuffer=="function"&&B.constructor.isBuffer(B)},isFormData:function(B){var $="[object FormData]";return B&&(typeof FormData=="function"&&B instanceof FormData||f.call(B)===$||I(B.toString)&&B.toString()===$)},isArrayBufferView:function(B){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(B):B&&B.buffer&&y(B.buffer)},isString:function(B){return typeof B=="string"},isNumber:function(B){return typeof B=="number"},isObject:v,isPlainObject:x,isUndefined:_,isDate:E,isFile:M,isBlob:O,isFunction:I,isStream:function(B){return v(B)&&I(B.pipe)},isURLSearchParams:D,isStandardBrowserEnv:function(){return(typeof navigator>"u"||navigator.product!=="ReactNative"&&navigator.product!=="NativeScript"&&navigator.product!=="NS")&&typeof window<"u"&&typeof document<"u"},forEach:V,merge:function B(){var $={};function U(q,Y){x($[Y])&&x(q)?$[Y]=B($[Y],q):x(q)?$[Y]=B({},q):p(q)?$[Y]=q.slice():$[Y]=q}for(var J=0,W=arguments.length;J<W;J++)V(arguments[J],U);return $},extend:function(B,$,U){return V($,(function(J,W){B[W]=U&&typeof J=="function"?u(J,U):J})),B},trim:function(B){return B.trim?B.trim():B.replace(/^\s+|\s+$/g,"")},stripBOM:function(B){return B.charCodeAt(0)===65279&&(B=B.slice(1)),B},inherits:function(B,$,U,J){B.prototype=Object.create($.prototype,J),B.prototype.constructor=B,U&&Object.assign(B.prototype,U)},toFlatObject:function(B,$,U){var J,W,q,Y={};$=$||{};do{for(W=(J=Object.getOwnPropertyNames(B)).length;W-- >0;)Y[q=J[W]]||($[q]=B[q],Y[q]=!0);B=Object.getPrototypeOf(B)}while(B&&(!U||U(B,$))&&B!==Object.prototype);return $},kindOf:d,kindOfTest:g,endsWith:function(B,$,U){B=String(B),(U===void 0||U>B.length)&&(U=B.length),U-=$.length;var J=B.indexOf($,U);return J!==-1&&J===U},toArray:function(B){if(!B)return null;var $=B.length;if(_($))return null;for(var U=new Array($);$-- >0;)U[$]=B[$];return U},isTypedArray:Q,isFileList:N}},6880:function(a){a.exports=(function(o){var l={};function c(u){if(l[u])return l[u].exports;var f=l[u]={i:u,l:!1,exports:{}};return o[u].call(f.exports,f,f.exports,c),f.l=!0,f.exports}return c.m=o,c.c=l,c.d=function(u,f,d){c.o(u,f)||Object.defineProperty(u,f,{enumerable:!0,get:d})},c.r=function(u){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(u,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(u,"__esModule",{value:!0})},c.t=function(u,f){if(1&f&&(u=c(u)),8&f||4&f&&typeof u=="object"&&u&&u.__esModule)return u;var d=Object.create(null);if(c.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:u}),2&f&&typeof u!="string")for(var g in u)c.d(d,g,(function(p){return u[p]}).bind(null,g));return d},c.n=function(u){var f=u&&u.__esModule?function(){return u.default}:function(){return u};return c.d(f,"a",f),f},c.o=function(u,f){return Object.prototype.hasOwnProperty.call(u,f)},c.p="",c(c.s=90)})({17:function(o,l,c){l.__esModule=!0,l.default=void 0;var u=c(18),f=(function(){function d(){}return d.getFirstMatch=function(g,p){var _=p.match(g);return _&&_.length>0&&_[1]||""},d.getSecondMatch=function(g,p){var _=p.match(g);return _&&_.length>1&&_[2]||""},d.matchAndReturnConst=function(g,p,_){if(g.test(p))return _},d.getWindowsVersionName=function(g){switch(g){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},d.getMacOSVersionName=function(g){var p=g.split(".").splice(0,2).map((function(_){return parseInt(_,10)||0}));if(p.push(0),p[0]===10)switch(p[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},d.getAndroidVersionName=function(g){var p=g.split(".").splice(0,2).map((function(_){return parseInt(_,10)||0}));if(p.push(0),!(p[0]===1&&p[1]<5))return p[0]===1&&p[1]<6?"Cupcake":p[0]===1&&p[1]>=6?"Donut":p[0]===2&&p[1]<2?"Eclair":p[0]===2&&p[1]===2?"Froyo":p[0]===2&&p[1]>2?"Gingerbread":p[0]===3?"Honeycomb":p[0]===4&&p[1]<1?"Ice Cream Sandwich":p[0]===4&&p[1]<4?"Jelly Bean":p[0]===4&&p[1]>=4?"KitKat":p[0]===5?"Lollipop":p[0]===6?"Marshmallow":p[0]===7?"Nougat":p[0]===8?"Oreo":p[0]===9?"Pie":void 0},d.getVersionPrecision=function(g){return g.split(".").length},d.compareVersions=function(g,p,_){_===void 0&&(_=!1);var y=d.getVersionPrecision(g),v=d.getVersionPrecision(p),x=Math.max(y,v),E=0,M=d.map([g,p],(function(O){var N=x-d.getVersionPrecision(O),I=O+new Array(N+1).join(".0");return d.map(I.split("."),(function(D){return new Array(20-D.length).join("0")+D})).reverse()}));for(_&&(E=x-Math.min(y,v)),x-=1;x>=E;){if(M[0][x]>M[1][x])return 1;if(M[0][x]===M[1][x]){if(x===E)return 0;x-=1}else if(M[0][x]<M[1][x])return-1}},d.map=function(g,p){var _,y=[];if(Array.prototype.map)return Array.prototype.map.call(g,p);for(_=0;_<g.length;_+=1)y.push(p(g[_]));return y},d.find=function(g,p){var _,y;if(Array.prototype.find)return Array.prototype.find.call(g,p);for(_=0,y=g.length;_<y;_+=1){var v=g[_];if(p(v,_))return v}},d.assign=function(g){for(var p,_,y=g,v=arguments.length,x=new Array(v>1?v-1:0),E=1;E<v;E++)x[E-1]=arguments[E];if(Object.assign)return Object.assign.apply(Object,[g].concat(x));var M=function(){var O=x[p];typeof O=="object"&&O!==null&&Object.keys(O).forEach((function(N){y[N]=O[N]}))};for(p=0,_=x.length;p<_;p+=1)M();return g},d.getBrowserAlias=function(g){return u.BROWSER_ALIASES_MAP[g]},d.getBrowserTypeByAlias=function(g){return u.BROWSER_MAP[g]||""},d})();l.default=f,o.exports=l.default},18:function(o,l,c){l.__esModule=!0,l.ENGINE_MAP=l.OS_MAP=l.PLATFORMS_MAP=l.BROWSER_MAP=l.BROWSER_ALIASES_MAP=void 0,l.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},l.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},l.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},l.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},l.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(91))&&u.__esModule?u:{default:u},d=c(18);function g(_,y){for(var v=0;v<y.length;v++){var x=y[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(_,x.key,x)}}var p=(function(){function _(){}var y,v,x;return _.getParser=function(E,M){if(M===void 0&&(M=!1),typeof E!="string")throw new Error("UserAgent should be a string");return new f.default(E,M)},_.parse=function(E){return new f.default(E).getResult()},y=_,x=[{key:"BROWSER_MAP",get:function(){return d.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return d.ENGINE_MAP}},{key:"OS_MAP",get:function(){return d.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return d.PLATFORMS_MAP}}],(v=null)&&g(y.prototype,v),x&&g(y,x),_})();l.default=p,o.exports=l.default},91:function(o,l,c){l.__esModule=!0,l.default=void 0;var u=_(c(92)),f=_(c(93)),d=_(c(94)),g=_(c(95)),p=_(c(17));function _(v){return v&&v.__esModule?v:{default:v}}var y=(function(){function v(E,M){if(M===void 0&&(M=!1),E==null||E==="")throw new Error("UserAgent parameter can't be empty");this._ua=E,this.parsedResult={},M!==!0&&this.parse()}var x=v.prototype;return x.getUA=function(){return this._ua},x.test=function(E){return E.test(this._ua)},x.parseBrowser=function(){var E=this;this.parsedResult.browser={};var M=p.default.find(u.default,(function(O){if(typeof O.test=="function")return O.test(E);if(O.test instanceof Array)return O.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.browser=M.describe(this.getUA())),this.parsedResult.browser},x.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},x.getBrowserName=function(E){return E?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},x.getBrowserVersion=function(){return this.getBrowser().version},x.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},x.parseOS=function(){var E=this;this.parsedResult.os={};var M=p.default.find(f.default,(function(O){if(typeof O.test=="function")return O.test(E);if(O.test instanceof Array)return O.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.os=M.describe(this.getUA())),this.parsedResult.os},x.getOSName=function(E){var M=this.getOS().name;return E?String(M).toLowerCase()||"":M||""},x.getOSVersion=function(){return this.getOS().version},x.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},x.getPlatformType=function(E){E===void 0&&(E=!1);var M=this.getPlatform().type;return E?String(M).toLowerCase()||"":M||""},x.parsePlatform=function(){var E=this;this.parsedResult.platform={};var M=p.default.find(d.default,(function(O){if(typeof O.test=="function")return O.test(E);if(O.test instanceof Array)return O.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.platform=M.describe(this.getUA())),this.parsedResult.platform},x.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},x.getEngineName=function(E){return E?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},x.parseEngine=function(){var E=this;this.parsedResult.engine={};var M=p.default.find(g.default,(function(O){if(typeof O.test=="function")return O.test(E);if(O.test instanceof Array)return O.test.some((function(N){return E.test(N)}));throw new Error("Browser's test function is not valid")}));return M&&(this.parsedResult.engine=M.describe(this.getUA())),this.parsedResult.engine},x.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},x.getResult=function(){return p.default.assign({},this.parsedResult)},x.satisfies=function(E){var M=this,O={},N=0,I={},D=0;if(Object.keys(E).forEach((function(W){var q=E[W];typeof q=="string"?(I[W]=q,D+=1):typeof q=="object"&&(O[W]=q,N+=1)})),N>0){var V=Object.keys(O),G=p.default.find(V,(function(W){return M.isOS(W)}));if(G){var Q=this.satisfies(O[G]);if(Q!==void 0)return Q}var B=p.default.find(V,(function(W){return M.isPlatform(W)}));if(B){var $=this.satisfies(O[B]);if($!==void 0)return $}}if(D>0){var U=Object.keys(I),J=p.default.find(U,(function(W){return M.isBrowser(W,!0)}));if(J!==void 0)return this.compareVersion(I[J])}},x.isBrowser=function(E,M){M===void 0&&(M=!1);var O=this.getBrowserName().toLowerCase(),N=E.toLowerCase(),I=p.default.getBrowserTypeByAlias(N);return M&&I&&(N=I.toLowerCase()),N===O},x.compareVersion=function(E){var M=[0],O=E,N=!1,I=this.getBrowserVersion();if(typeof I=="string")return E[0]===">"||E[0]==="<"?(O=E.substr(1),E[1]==="="?(N=!0,O=E.substr(2)):M=[],E[0]===">"?M.push(1):M.push(-1)):E[0]==="="?O=E.substr(1):E[0]==="~"&&(N=!0,O=E.substr(1)),M.indexOf(p.default.compareVersions(I,O,N))>-1},x.isOS=function(E){return this.getOSName(!0)===String(E).toLowerCase()},x.isPlatform=function(E){return this.getPlatformType(!0)===String(E).toLowerCase()},x.isEngine=function(E){return this.getEngineName(!0)===String(E).toLowerCase()},x.is=function(E,M){return M===void 0&&(M=!1),this.isBrowser(E,M)||this.isOS(E)||this.isPlatform(E)},x.some=function(E){var M=this;return E===void 0&&(E=[]),E.some((function(O){return M.is(O)}))},v})();l.default=y,o.exports=l.default},92:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},d=/version\/(\d+(\.?_?\d+)+)/i,g=[{test:[/googlebot/i],describe:function(p){var _={name:"Googlebot"},y=f.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/opera/i],describe:function(p){var _={name:"Opera"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/opr\/|opios/i],describe:function(p){var _={name:"Opera"},y=f.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/SamsungBrowser/i],describe:function(p){var _={name:"Samsung Internet for Android"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/Whale/i],describe:function(p){var _={name:"NAVER Whale Browser"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/MZBrowser/i],describe:function(p){var _={name:"MZ Browser"},y=f.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/focus/i],describe:function(p){var _={name:"Focus"},y=f.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/swing/i],describe:function(p){var _={name:"Swing"},y=f.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/coast/i],describe:function(p){var _={name:"Opera Coast"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(p){var _={name:"Opera Touch"},y=f.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/yabrowser/i],describe:function(p){var _={name:"Yandex Browser"},y=f.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/ucbrowser/i],describe:function(p){var _={name:"UC Browser"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/Maxthon|mxios/i],describe:function(p){var _={name:"Maxthon"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/epiphany/i],describe:function(p){var _={name:"Epiphany"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/puffin/i],describe:function(p){var _={name:"Puffin"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/sleipnir/i],describe:function(p){var _={name:"Sleipnir"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/k-meleon/i],describe:function(p){var _={name:"K-Meleon"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/micromessenger/i],describe:function(p){var _={name:"WeChat"},y=f.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/qqbrowser/i],describe:function(p){var _={name:/qqbrowserlite/i.test(p)?"QQ Browser Lite":"QQ Browser"},y=f.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/msie|trident/i],describe:function(p){var _={name:"Internet Explorer"},y=f.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/\sedg\//i],describe:function(p){var _={name:"Microsoft Edge"},y=f.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/edg([ea]|ios)/i],describe:function(p){var _={name:"Microsoft Edge"},y=f.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/vivaldi/i],describe:function(p){var _={name:"Vivaldi"},y=f.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/seamonkey/i],describe:function(p){var _={name:"SeaMonkey"},y=f.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/sailfish/i],describe:function(p){var _={name:"Sailfish"},y=f.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,p);return y&&(_.version=y),_}},{test:[/silk/i],describe:function(p){var _={name:"Amazon Silk"},y=f.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/phantom/i],describe:function(p){var _={name:"PhantomJS"},y=f.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/slimerjs/i],describe:function(p){var _={name:"SlimerJS"},y=f.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var _={name:"BlackBerry"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var _={name:"WebOS Browser"},y=f.default.getFirstMatch(d,p)||f.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/bada/i],describe:function(p){var _={name:"Bada"},y=f.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/tizen/i],describe:function(p){var _={name:"Tizen"},y=f.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/qupzilla/i],describe:function(p){var _={name:"QupZilla"},y=f.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/firefox|iceweasel|fxios/i],describe:function(p){var _={name:"Firefox"},y=f.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/electron/i],describe:function(p){var _={name:"Electron"},y=f.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/MiuiBrowser/i],describe:function(p){var _={name:"Miui"},y=f.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/chromium/i],describe:function(p){var _={name:"Chromium"},y=f.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,p)||f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/chrome|crios|crmo/i],describe:function(p){var _={name:"Chrome"},y=f.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/GSA/i],describe:function(p){var _={name:"Google Search"},y=f.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){var _=!p.test(/like android/i),y=p.test(/android/i);return _&&y},describe:function(p){var _={name:"Android Browser"},y=f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/playstation 4/i],describe:function(p){var _={name:"PlayStation 4"},y=f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/safari|applewebkit/i],describe:function(p){var _={name:"Safari"},y=f.default.getFirstMatch(d,p);return y&&(_.version=y),_}},{test:[/.*/i],describe:function(p){var _=p.search("\\(")!==-1?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:f.default.getFirstMatch(_,p),version:f.default.getSecondMatch(_,p)}}}];l.default=g,o.exports=l.default},93:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},d=c(18),g=[{test:[/Roku\/DVP/],describe:function(p){var _=f.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,p);return{name:d.OS_MAP.Roku,version:_}}},{test:[/windows phone/i],describe:function(p){var _=f.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.WindowsPhone,version:_}}},{test:[/windows /i],describe:function(p){var _=f.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,p),y=f.default.getWindowsVersionName(_);return{name:d.OS_MAP.Windows,version:_,versionName:y}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(p){var _={name:d.OS_MAP.iOS},y=f.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,p);return y&&(_.version=y),_}},{test:[/macintosh/i],describe:function(p){var _=f.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,p).replace(/[_\s]/g,"."),y=f.default.getMacOSVersionName(_),v={name:d.OS_MAP.MacOS,version:_};return y&&(v.versionName=y),v}},{test:[/(ipod|iphone|ipad)/i],describe:function(p){var _=f.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,p).replace(/[_\s]/g,".");return{name:d.OS_MAP.iOS,version:_}}},{test:function(p){var _=!p.test(/like android/i),y=p.test(/android/i);return _&&y},describe:function(p){var _=f.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,p),y=f.default.getAndroidVersionName(_),v={name:d.OS_MAP.Android,version:_};return y&&(v.versionName=y),v}},{test:[/(web|hpw)[o0]s/i],describe:function(p){var _=f.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,p),y={name:d.OS_MAP.WebOS};return _&&_.length&&(y.version=_),y}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(p){var _=f.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,p)||f.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,p)||f.default.getFirstMatch(/\bbb(\d+)/i,p);return{name:d.OS_MAP.BlackBerry,version:_}}},{test:[/bada/i],describe:function(p){var _=f.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Bada,version:_}}},{test:[/tizen/i],describe:function(p){var _=f.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.Tizen,version:_}}},{test:[/linux/i],describe:function(){return{name:d.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:d.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(p){var _=f.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,p);return{name:d.OS_MAP.PlayStation4,version:_}}}];l.default=g,o.exports=l.default},94:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},d=c(18),g=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(p){var _=f.default.getFirstMatch(/(can-l01)/i,p)&&"Nova",y={type:d.PLATFORMS_MAP.mobile,vendor:"Huawei"};return _&&(y.model=_),y}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){var _=p.test(/ipod|iphone/i),y=p.test(/like (ipod|iphone)/i);return _&&!y},describe:function(p){var _=f.default.getFirstMatch(/(ipod|iphone)/i,p);return{type:d.PLATFORMS_MAP.mobile,vendor:"Apple",model:_}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName(!0)==="blackberry"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(p){return p.getBrowserName(!0)==="bada"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getBrowserName()==="windows phone"},describe:function(){return{type:d.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(p){var _=Number(String(p.getOSVersion()).split(".")[0]);return p.getOSName(!0)==="android"&&_>=3},describe:function(){return{type:d.PLATFORMS_MAP.tablet}}},{test:function(p){return p.getOSName(!0)==="android"},describe:function(){return{type:d.PLATFORMS_MAP.mobile}}},{test:function(p){return p.getOSName(!0)==="macos"},describe:function(){return{type:d.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(p){return p.getOSName(!0)==="windows"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="linux"},describe:function(){return{type:d.PLATFORMS_MAP.desktop}}},{test:function(p){return p.getOSName(!0)==="playstation 4"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}},{test:function(p){return p.getOSName(!0)==="roku"},describe:function(){return{type:d.PLATFORMS_MAP.tv}}}];l.default=g,o.exports=l.default},95:function(o,l,c){l.__esModule=!0,l.default=void 0;var u,f=(u=c(17))&&u.__esModule?u:{default:u},d=c(18),g=[{test:function(p){return p.getBrowserName(!0)==="microsoft edge"},describe:function(p){if(/\sedg\//i.test(p))return{name:d.ENGINE_MAP.Blink};var _=f.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,p);return{name:d.ENGINE_MAP.EdgeHTML,version:_}}},{test:[/trident/i],describe:function(p){var _={name:d.ENGINE_MAP.Trident},y=f.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){return p.test(/presto/i)},describe:function(p){var _={name:d.ENGINE_MAP.Presto},y=f.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:function(p){var _=p.test(/gecko/i),y=p.test(/like gecko/i);return _&&!y},describe:function(p){var _={name:d.ENGINE_MAP.Gecko},y=f.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:d.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(p){var _={name:d.ENGINE_MAP.WebKit},y=f.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,p);return y&&(_.version=y),_}}];l.default=g,o.exports=l.default}})},228:a=>{var o=Object.prototype.hasOwnProperty,l="~";function c(){}function u(p,_,y){this.fn=p,this.context=_,this.once=y||!1}function f(p,_,y,v,x){if(typeof y!="function")throw new TypeError("The listener must be a function");var E=new u(y,v||p,x),M=l?l+_:_;return p._events[M]?p._events[M].fn?p._events[M]=[p._events[M],E]:p._events[M].push(E):(p._events[M]=E,p._eventsCount++),p}function d(p,_){--p._eventsCount==0?p._events=new c:delete p._events[_]}function g(){this._events=new c,this._eventsCount=0}Object.create&&(c.prototype=Object.create(null),new c().__proto__||(l=!1)),g.prototype.eventNames=function(){var p,_,y=[];if(this._eventsCount===0)return y;for(_ in p=this._events)o.call(p,_)&&y.push(l?_.slice(1):_);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(p)):y},g.prototype.listeners=function(p){var _=l?l+p:p,y=this._events[_];if(!y)return[];if(y.fn)return[y.fn];for(var v=0,x=y.length,E=new Array(x);v<x;v++)E[v]=y[v].fn;return E},g.prototype.listenerCount=function(p){var _=l?l+p:p,y=this._events[_];return y?y.fn?1:y.length:0},g.prototype.emit=function(p,_,y,v,x,E){var M=l?l+p:p;if(!this._events[M])return!1;var O,N,I=this._events[M],D=arguments.length;if(I.fn){switch(I.once&&this.removeListener(p,I.fn,void 0,!0),D){case 1:return I.fn.call(I.context),!0;case 2:return I.fn.call(I.context,_),!0;case 3:return I.fn.call(I.context,_,y),!0;case 4:return I.fn.call(I.context,_,y,v),!0;case 5:return I.fn.call(I.context,_,y,v,x),!0;case 6:return I.fn.call(I.context,_,y,v,x,E),!0}for(N=1,O=new Array(D-1);N<D;N++)O[N-1]=arguments[N];I.fn.apply(I.context,O)}else{var V,G=I.length;for(N=0;N<G;N++)switch(I[N].once&&this.removeListener(p,I[N].fn,void 0,!0),D){case 1:I[N].fn.call(I[N].context);break;case 2:I[N].fn.call(I[N].context,_);break;case 3:I[N].fn.call(I[N].context,_,y);break;case 4:I[N].fn.call(I[N].context,_,y,v);break;default:if(!O)for(V=1,O=new Array(D-1);V<D;V++)O[V-1]=arguments[V];I[N].fn.apply(I[N].context,O)}}return!0},g.prototype.on=function(p,_,y){return f(this,p,_,y,!1)},g.prototype.once=function(p,_,y){return f(this,p,_,y,!0)},g.prototype.removeListener=function(p,_,y,v){var x=l?l+p:p;if(!this._events[x])return this;if(!_)return d(this,x),this;var E=this._events[x];if(E.fn)E.fn!==_||v&&!E.once||y&&E.context!==y||d(this,x);else{for(var M=0,O=[],N=E.length;M<N;M++)(E[M].fn!==_||v&&!E[M].once||y&&E[M].context!==y)&&O.push(E[M]);O.length?this._events[x]=O.length===1?O[0]:O:d(this,x)}return this},g.prototype.removeAllListeners=function(p){var _;return p?(_=l?l+p:p,this._events[_]&&d(this,_)):(this._events=new c,this._eventsCount=0),this},g.prototype.off=g.prototype.removeListener,g.prototype.addListener=g.prototype.on,g.prefixed=l,g.EventEmitter=g,a.exports=g},8954:function(a){var o;o=()=>(()=>{var l={228:f=>{var d=Object.prototype.hasOwnProperty,g="~";function p(){}function _(E,M,O){this.fn=E,this.context=M,this.once=O||!1}function y(E,M,O,N,I){if(typeof O!="function")throw new TypeError("The listener must be a function");var D=new _(O,N||E,I),V=g?g+M:M;return E._events[V]?E._events[V].fn?E._events[V]=[E._events[V],D]:E._events[V].push(D):(E._events[V]=D,E._eventsCount++),E}function v(E,M){--E._eventsCount==0?E._events=new p:delete E._events[M]}function x(){this._events=new p,this._eventsCount=0}Object.create&&(p.prototype=Object.create(null),new p().__proto__||(g=!1)),x.prototype.eventNames=function(){var E,M,O=[];if(this._eventsCount===0)return O;for(M in E=this._events)d.call(E,M)&&O.push(g?M.slice(1):M);return Object.getOwnPropertySymbols?O.concat(Object.getOwnPropertySymbols(E)):O},x.prototype.listeners=function(E){var M=g?g+E:E,O=this._events[M];if(!O)return[];if(O.fn)return[O.fn];for(var N=0,I=O.length,D=new Array(I);N<I;N++)D[N]=O[N].fn;return D},x.prototype.listenerCount=function(E){var M=g?g+E:E,O=this._events[M];return O?O.fn?1:O.length:0},x.prototype.emit=function(E,M,O,N,I,D){var V=g?g+E:E;if(!this._events[V])return!1;var G,Q,B=this._events[V],$=arguments.length;if(B.fn){switch(B.once&&this.removeListener(E,B.fn,void 0,!0),$){case 1:return B.fn.call(B.context),!0;case 2:return B.fn.call(B.context,M),!0;case 3:return B.fn.call(B.context,M,O),!0;case 4:return B.fn.call(B.context,M,O,N),!0;case 5:return B.fn.call(B.context,M,O,N,I),!0;case 6:return B.fn.call(B.context,M,O,N,I,D),!0}for(Q=1,G=new Array($-1);Q<$;Q++)G[Q-1]=arguments[Q];B.fn.apply(B.context,G)}else{var U,J=B.length;for(Q=0;Q<J;Q++)switch(B[Q].once&&this.removeListener(E,B[Q].fn,void 0,!0),$){case 1:B[Q].fn.call(B[Q].context);break;case 2:B[Q].fn.call(B[Q].context,M);break;case 3:B[Q].fn.call(B[Q].context,M,O);break;case 4:B[Q].fn.call(B[Q].context,M,O,N);break;default:if(!G)for(U=1,G=new Array($-1);U<$;U++)G[U-1]=arguments[U];B[Q].fn.apply(B[Q].context,G)}}return!0},x.prototype.on=function(E,M,O){return y(this,E,M,O,!1)},x.prototype.once=function(E,M,O){return y(this,E,M,O,!0)},x.prototype.removeListener=function(E,M,O,N){var I=g?g+E:E;if(!this._events[I])return this;if(!M)return v(this,I),this;var D=this._events[I];if(D.fn)D.fn!==M||N&&!D.once||O&&D.context!==O||v(this,I);else{for(var V=0,G=[],Q=D.length;V<Q;V++)(D[V].fn!==M||N&&!D[V].once||O&&D[V].context!==O)&&G.push(D[V]);G.length?this._events[I]=G.length===1?G[0]:G:v(this,I)}return this},x.prototype.removeAllListeners=function(E){var M;return E?(M=g?g+E:E,this._events[M]&&v(this,M)):(this._events=new p,this._eventsCount=0),this},x.prototype.off=x.prototype.removeListener,x.prototype.addListener=x.prototype.on,x.prefixed=g,x.EventEmitter=x,f.exports=x},543:function(f,d,g){var p;f=g.nmd(f),(function(){var _,y="Expected a function",v="__lodash_hash_undefined__",x="__lodash_placeholder__",E=32,M=128,O=1/0,N=9007199254740991,I=NaN,D=4294967295,V=[["ary",M],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",E],["partialRight",64],["rearg",256]],G="[object Arguments]",Q="[object Array]",B="[object Boolean]",$="[object Date]",U="[object Error]",J="[object Function]",W="[object GeneratorFunction]",q="[object Map]",Y="[object Number]",ae="[object Object]",Z="[object Promise]",K="[object RegExp]",ne="[object Set]",le="[object String]",ce="[object Symbol]",de="[object WeakMap]",Me="[object ArrayBuffer]",qe="[object DataView]",Pe="[object Float32Array]",Ce="[object Float64Array]",Xe="[object Int8Array]",$e="[object Int16Array]",at="[object Int32Array]",pt="[object Uint8Array]",oe="[object Uint8ClampedArray]",Ue="[object Uint16Array]",Ge="[object Uint32Array]",ze=/\b__p \+= '';/g,Be=/\b(__p \+=) '' \+/g,me=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Se=/&(?:amp|lt|gt|quot|#39);/g,Ie=/[&<>"']/g,be=RegExp(Se.source),Ke=RegExp(Ie.source),ot=/<%-([\s\S]+?)%>/g,lt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,Vt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kt=/^\w*$/,Ut=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,je=/[\\^$.*+?()[\]{}|]/g,ge=RegExp(je.source),se=/^\s+/,_e=/\s/,Ne=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Le=/\{\n\/\* \[wrapped with (.+)\] \*/,ke=/,? & /,Re=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,st=/[()=,{}\[\]\/\s]/,Ve=/\\(\\)?/g,tt=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ze=/\w*$/,nt=/^[-+]0x[0-9a-f]+$/i,vt=/^0b[01]+$/i,Qe=/^\[object .+?Constructor\]$/,ht=/^0o[0-7]+$/i,mt=/^(?:0|[1-9]\d*)$/,ft=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_t=/($^)/,gn=/['\n\r\u2028\u2029\\]/g,_n="\\ud800-\\udfff",Bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",Yt="\\u2700-\\u27bf",Mt="a-z\\xdf-\\xf6\\xf8-\\xff",fn="A-Z\\xc0-\\xd6\\xd8-\\xde",Bn="\\ufe0e\\ufe0f",cn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",In="["+_n+"]",$n="["+cn+"]",er="["+Bt+"]",as="\\d+",di="["+Yt+"]",Oi="["+Mt+"]",Bs="[^"+_n+cn+as+Yt+Mt+fn+"]",pi="\\ud83c[\\udffb-\\udfff]",ws="[^"+_n+"]",na="(?:\\ud83c[\\udde6-\\uddff]){2}",os="[\\ud800-\\udbff][\\udc00-\\udfff]",We="["+fn+"]",At="\\u200d",Wt="(?:"+Oi+"|"+Bs+")",Kt="(?:"+We+"|"+Bs+")",Lt="(?:['](?:d|ll|m|re|s|t|ve))?",yn="(?:['](?:D|LL|M|RE|S|T|VE))?",zn="(?:"+er+"|"+pi+")?",En="["+Bn+"]?",tr=En+zn+"(?:"+At+"(?:"+[ws,na,os].join("|")+")"+En+zn+")*",Ir="(?:"+[di,na,os].join("|")+")"+tr,Er="(?:"+[ws+er+"?",er,na,os,In].join("|")+")",rr=RegExp("[']","g"),Dr=RegExp(er,"g"),ri=RegExp(pi+"(?="+pi+")|"+Er+tr,"g"),ha=RegExp([We+"?"+Oi+"+"+Lt+"(?="+[$n,We,"$"].join("|")+")",Kt+"+"+yn+"(?="+[$n,We+Wt,"$"].join("|")+")",We+"?"+Wt+"+"+Lt,We+"+"+yn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",as,Ir].join("|"),"g"),Cr=RegExp("["+At+_n+Bt+Bn+"]"),ii=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Tr=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Pr=-1,Cn={};Cn[Pe]=Cn[Ce]=Cn[Xe]=Cn[$e]=Cn[at]=Cn[pt]=Cn[oe]=Cn[Ue]=Cn[Ge]=!0,Cn[G]=Cn[Q]=Cn[Me]=Cn[B]=Cn[qe]=Cn[$]=Cn[U]=Cn[J]=Cn[q]=Cn[Y]=Cn[ae]=Cn[K]=Cn[ne]=Cn[le]=Cn[de]=!1;var zr={};zr[G]=zr[Q]=zr[Me]=zr[qe]=zr[B]=zr[$]=zr[Pe]=zr[Ce]=zr[Xe]=zr[$e]=zr[at]=zr[q]=zr[Y]=zr[ae]=zr[K]=zr[ne]=zr[le]=zr[ce]=zr[pt]=zr[oe]=zr[Ue]=zr[Ge]=!0,zr[U]=zr[J]=zr[de]=!1;var Do={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ls=parseFloat,Lo=parseInt,cs=typeof g.g=="object"&&g.g&&g.g.Object===Object&&g.g,Xn=typeof self=="object"&&self&&self.Object===Object&&self,Jr=cs||Xn||Function("return this")(),ur=d&&!d.nodeType&&d,Fs=ur&&f&&!f.nodeType&&f,bo=Fs&&Fs.exports===ur,da=bo&&cs.process,pa=(function(){try{return Fs&&Fs.require&&Fs.require("util").types||da&&da.binding&&da.binding("util")}catch{}})(),zh=pa&&pa.isArrayBuffer,lp=pa&&pa.isDate,Wp=pa&&pa.isMap,Yp=pa&&pa.isRegExp,rh=pa&&pa.isSet,Tl=pa&&pa.isTypedArray;function ac(rt,Tt,Rt){switch(Rt.length){case 0:return rt.call(Tt);case 1:return rt.call(Tt,Rt[0]);case 2:return rt.call(Tt,Rt[0],Rt[1]);case 3:return rt.call(Tt,Rt[0],Rt[1],Rt[2])}return rt.apply(Tt,Rt)}function Uo(rt,Tt,Rt,tn){for(var wn=-1,Zn=rt==null?0:rt.length;++wn<Zn;){var Ri=rt[wn];Tt(tn,Ri,Rt(Ri),rt)}return tn}function rl(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function Xp(rt,Tt){for(var Rt=rt==null?0:rt.length;Rt--&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function wc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(!Tt(rt[Rt],Rt,rt))return!1;return!0}function Gc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=0,Zn=[];++Rt<tn;){var Ri=rt[Rt];Tt(Ri,Rt,rt)&&(Zn[wn++]=Ri)}return Zn}function $u(rt,Tt){return!(rt==null||!rt.length)&&ih(rt,Tt,0)>-1}function Wi(rt,Tt,Rt){for(var tn=-1,wn=rt==null?0:rt.length;++tn<wn;)if(Rt(Tt,rt[tn]))return!0;return!1}function Yi(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=Array(tn);++Rt<tn;)wn[Rt]=Tt(rt[Rt],Rt,rt);return wn}function Rc(rt,Tt){for(var Rt=-1,tn=Tt.length,wn=rt.length;++Rt<tn;)rt[wn+Rt]=Tt[Rt];return rt}function Ef(rt,Tt,Rt,tn){var wn=-1,Zn=rt==null?0:rt.length;for(tn&&Zn&&(Rt=rt[++wn]);++wn<Zn;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Zm(rt,Tt,Rt,tn){var wn=rt==null?0:rt.length;for(tn&&wn&&(Rt=rt[--wn]);wn--;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function oc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(Tt(rt[Rt],Rt,rt))return!0;return!1}var co=ah("length");function $c(rt,Tt,Rt){var tn;return Rt(rt,(function(wn,Zn,Ri){if(Tt(wn,Zn,Ri))return tn=Zn,!1})),tn}function Wc(rt,Tt,Rt,tn){for(var wn=rt.length,Zn=Rt+(tn?1:-1);tn?Zn--:++Zn<wn;)if(Tt(rt[Zn],Zn,rt))return Zn;return-1}function ih(rt,Tt,Rt){return Tt==Tt?(function(tn,wn,Zn){for(var Ri=Zn-1,sl=tn.length;++Ri<sl;)if(tn[Ri]===wn)return Ri;return-1})(rt,Tt,Rt):Wc(rt,xf,Rt)}function ma(rt,Tt,Rt,tn){for(var wn=Rt-1,Zn=rt.length;++wn<Zn;)if(tn(rt[wn],Tt))return wn;return-1}function xf(rt){return rt!=rt}function sh(rt,Tt){var Rt=rt==null?0:rt.length;return Rt?Tf(rt,Tt)/Rt:I}function ah(rt){return function(Tt){return Tt==null?_:Tt[rt]}}function Qm(rt){return function(Tt){return rt==null?_:rt[Tt]}}function Wu(rt,Tt,Rt,tn,wn){return wn(rt,(function(Zn,Ri,sl){Rt=tn?(tn=!1,Zn):Tt(Rt,Zn,Ri,sl)})),Rt}function Tf(rt,Tt){for(var Rt,tn=-1,wn=rt.length;++tn<wn;){var Zn=Tt(rt[tn]);Zn!==_&&(Rt=Rt===_?Zn:Rt+Zn)}return Rt}function oh(rt,Tt){for(var Rt=-1,tn=Array(rt);++Rt<rt;)tn[Rt]=Tt(Rt);return tn}function Bo(rt){return rt&&rt.slice(0,up(rt)+1).replace(se,"")}function Vl(rt){return function(Tt){return rt(Tt)}}function Ad(rt,Tt){return Yi(Tt,(function(Rt){return rt[Rt]}))}function Kp(rt,Tt){return rt.has(Tt)}function il(rt,Tt){for(var Rt=-1,tn=rt.length;++Rt<tn&&ih(Tt,rt[Rt],0)>-1;);return Rt}function Jm(rt,Tt){for(var Rt=rt.length;Rt--&&ih(Tt,rt[Rt],0)>-1;);return Rt}var q_=Qm({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),V_=Qm({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function cp(rt){return"\\"+Do[rt]}function jh(rt){return Cr.test(rt)}function Hh(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn,wn){Rt[++Tt]=[wn,tn]})),Rt}function Yu(rt,Tt){return function(Rt){return rt(Tt(Rt))}}function Xu(rt,Tt){for(var Rt=-1,tn=rt.length,wn=0,Zn=[];++Rt<tn;){var Ri=rt[Rt];Ri!==Tt&&Ri!==x||(rt[Rt]=x,Zn[wn++]=Rt)}return Zn}function eg(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=tn})),Rt}function vs(rt){return jh(rt)?(function(Tt){for(var Rt=ri.lastIndex=0;ri.test(Tt);)++Rt;return Rt})(rt):co(rt)}function Ta(rt){return jh(rt)?(function(Tt){return Tt.match(ri)||[]})(rt):(function(Tt){return Tt.split("")})(rt)}function up(rt){for(var Tt=rt.length;Tt--&&_e.test(rt.charAt(Tt)););return Tt}var tg=Qm({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qh=(function rt(Tt){var Rt,tn=(Tt=Tt==null?Jr:qh.defaults(Jr.Object(),Tt,qh.pick(Jr,Tr))).Array,wn=Tt.Date,Zn=Tt.Error,Ri=Tt.Function,sl=Tt.Math,_r=Tt.Object,So=Tt.RegExp,wf=Tt.String,ns=Tt.TypeError,Ac=tn.prototype,lh=Ri.prototype,sr=_r.prototype,Cc=Tt["__core-js_shared__"],Oa=lh.toString,vr=sr.hasOwnProperty,Vr=0,ch=(Rt=/[^.]+$/.exec(Cc&&Cc.keys&&Cc.keys.IE_PROTO||""))?"Symbol(src)_1."+Rt:"",Rf=sr.toString,X0=Oa.call(_r),Gl=Jr._,ng=So("^"+Oa.call(vr).replace(je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Eo=bo?Tt.Buffer:_,Fo=Tt.Symbol,Su=Tt.Uint8Array,Yg=Eo?Eo.allocUnsafe:_,Eu=Yu(_r.getPrototypeOf,_r),uh=_r.create,Zp=sr.propertyIsEnumerable,fh=Ac.splice,Af=Fo?Fo.isConcatSpreadable:_,Yc=Fo?Fo.iterator:_,Hi=Fo?Fo.toStringTag:_,xu=(function(){try{var h=mo(_r,"defineProperty");return h({},"",{}),h}catch{}})(),G_=Tt.clearTimeout!==Jr.clearTimeout&&Tt.clearTimeout,$_=wn&&wn.now!==Jr.Date.now&&wn.now,rg=Tt.setTimeout!==Jr.setTimeout&&Tt.setTimeout,Mc=sl.ceil,Cd=sl.floor,uo=_r.getOwnPropertySymbols,Cf=Eo?Eo.isBuffer:_,$l=Tt.isFinite,ig=Ac.join,Xg=Yu(_r.keys,_r),mi=sl.max,Xi=sl.min,sg=wn.now,hh=Tt.parseInt,fp=sl.random,Fn=Ac.reverse,zs=mo(Tt,"DataView"),Mf=mo(Tt,"Map"),xo=mo(Tt,"Promise"),wl=mo(Tt,"Set"),Ku=mo(Tt,"WeakMap"),kf=mo(_r,"create"),kc=Ku&&new Ku,Rs={},Kg=Lc(zs),Xs=Lc(Mf),K0=Lc(xo),Rl=Lc(wl),hp=Lc(Ku),zo=Fo?Fo.prototype:_,lc=zo?zo.valueOf:_,Br=zo?zo.toString:_;function ve(h){if(hs(h)&&!wr(h)&&!(h instanceof On)){if(h instanceof Ai)return h;if(vr.call(h,"__wrapped__"))return om(h)}return new Ai(h)}var cc=(function(){function h(){}return function(b){if(!Hr(b))return{};if(uh)return uh(b);h.prototype=b;var k=new h;return h.prototype=_,k}})();function Ja(){}function Ai(h,b){this.__wrapped__=h,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=_}function On(h){this.__wrapped__=h,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=D,this.__views__=[]}function fo(h){var b=-1,k=h==null?0:h.length;for(this.clear();++b<k;){var F=h[b];this.set(F[0],F[1])}}function ho(h){var b=-1,k=h==null?0:h.length;for(this.clear();++b<k;){var F=h[b];this.set(F[0],F[1])}}function Ki(h){var b=-1,k=h==null?0:h.length;for(this.clear();++b<k;){var F=h[b];this.set(F[0],F[1])}}function hn(h){var b=-1,k=h==null?0:h.length;for(this.__data__=new Ki;++b<k;)this.add(h[b])}function Ei(h){var b=this.__data__=new ho(h);this.size=b.size}function ag(h,b){var k=wr(h),F=!k&&Sr(h),ie=!k&&!F&&wa(h),pe=!k&&!F&&!ie&&Ni(h),ye=k||F||ie||pe,Ae=ye?oh(h.length,wf):[],De=Ae.length;for(var Fe in h)!b&&!vr.call(h,Fe)||ye&&(Fe=="length"||ie&&(Fe=="offset"||Fe=="parent")||pe&&(Fe=="buffer"||Fe=="byteLength"||Fe=="byteOffset")||sf(Fe,De))||Ae.push(Fe);return Ae}function Of(h){var b=h.length;return b?h[Qu(0,b-1)]:_}function If(h,b){return am(kl(h),Al(b,0,h.length))}function og(h){return am(kl(h))}function To(h,b,k){(k!==_&&!sa(h[b],k)||k===_&&!(b in h))&&Ia(h,b,k)}function Oc(h,b,k){var F=h[b];vr.call(h,b)&&sa(F,k)&&(k!==_||b in h)||Ia(h,b,k)}function ga(h,b){for(var k=h.length;k--;)if(sa(h[k][0],b))return k;return-1}function dp(h,b,k,F){return us(h,(function(ie,pe,ye){b(F,ie,k(ie),ye)})),F}function wo(h,b){return h&&Hs(b,Zr(b),h)}function Ia(h,b,k){b=="__proto__"&&xu?xu(h,b,{configurable:!0,enumerable:!0,value:k,writable:!0}):h[b]=k}function dh(h,b){for(var k=-1,F=b.length,ie=tn(F),pe=h==null;++k<F;)ie[k]=pe?_:xp(h,b[k]);return ie}function Al(h,b,k){return h==h&&(k!==_&&(h=h<=k?h:k),b!==_&&(h=h>=b?h:b)),h}function js(h,b,k,F,ie,pe){var ye,Ae=1&b,De=2&b,Fe=4&b;if(k&&(ye=ie?k(h,F,ie,pe):k(h)),ye!==_)return ye;if(!Hr(h))return h;var Ye=wr(h);if(Ye){if(ye=(function(gt){var Ot=gt.length,wt=new gt.constructor(Ot);return Ot&&typeof gt[0]=="string"&&vr.call(gt,"index")&&(wt.index=gt.index,wt.input=gt.input),wt})(h),!Ae)return kl(h,ye)}else{var dt=Ho(h),Et=dt==J||dt==W;if(wa(h))return em(h,Ae);if(dt==ae||dt==G||Et&&!ie){if(ye=De||Et?{}:id(h),!Ae)return De?(function(gt,Ot){return Hs(gt,yp(gt),Ot)})(h,(function(gt,Ot){return gt&&Hs(Ot,so(Ot),gt)})(ye,h)):(function(gt,Ot){return Hs(gt,Zl(gt),Ot)})(h,wo(ye,h))}else{if(!zr[dt])return ie?h:{};ye=(function(gt,Ot,wt){var It,Ft=gt.constructor;switch(Ot){case Me:return jr(gt);case B:case $:return new Ft(+gt);case qe:return(function(Zt,Gt){var $t=Gt?jr(Zt.buffer):Zt.buffer;return new Zt.constructor($t,Zt.byteOffset,Zt.byteLength)})(gt,wt);case Pe:case Ce:case Xe:case $e:case at:case pt:case oe:case Ue:case Ge:return Au(gt,wt);case q:return new Ft;case Y:case le:return new Ft(gt);case K:return(function(Zt){var Gt=new Zt.constructor(Zt.source,Ze.exec(Zt));return Gt.lastIndex=Zt.lastIndex,Gt})(gt);case ne:return new Ft;case ce:return It=gt,lc?_r(lc.call(It)):{}}})(h,dt,Ae)}}pe||(pe=new Ei);var Pt=pe.get(h);if(Pt)return Pt;pe.set(h,ye),of(h)?h.forEach((function(gt){ye.add(js(gt,b,k,gt,h,pe))})):Ra(h)&&h.forEach((function(gt,Ot){ye.set(Ot,js(gt,b,k,Ot,h,pe))}));var bt=Ye?_:(Fe?De?vp:Kl:De?so:Zr)(h);return rl(bt||h,(function(gt,Ot){bt&&(gt=h[Ot=gt]),Oc(ye,Ot,js(gt,b,k,Ot,h,pe))})),ye}function Cl(h,b,k){var F=k.length;if(h==null)return!F;for(h=_r(h);F--;){var ie=k[F],pe=b[ie],ye=h[ie];if(ye===_&&!(ie in h)||!pe(ye))return!1}return!0}function Vh(h,b,k){if(typeof h!="function")throw new ns(y);return Ud((function(){h.apply(_,k)}),b)}function Ic(h,b,k,F){var ie=-1,pe=$u,ye=!0,Ae=h.length,De=[],Fe=b.length;if(!Ae)return De;k&&(b=Yi(b,Vl(k))),F?(pe=Wi,ye=!1):b.length>=200&&(pe=Kp,ye=!1,b=new hn(b));e:for(;++ie<Ae;){var Ye=h[ie],dt=k==null?Ye:k(Ye);if(Ye=F||Ye!==0?Ye:0,ye&&dt==dt){for(var Et=Fe;Et--;)if(b[Et]===dt)continue e;De.push(Ye)}else pe(b,dt,F)||De.push(Ye)}return De}ve.templateSettings={escape:ot,evaluate:lt,interpolate:ct,variable:"",imports:{_:ve}},ve.prototype=Ja.prototype,ve.prototype.constructor=ve,Ai.prototype=cc(Ja.prototype),Ai.prototype.constructor=Ai,On.prototype=cc(Ja.prototype),On.prototype.constructor=On,fo.prototype.clear=function(){this.__data__=kf?kf(null):{},this.size=0},fo.prototype.delete=function(h){var b=this.has(h)&&delete this.__data__[h];return this.size-=b?1:0,b},fo.prototype.get=function(h){var b=this.__data__;if(kf){var k=b[h];return k===v?_:k}return vr.call(b,h)?b[h]:_},fo.prototype.has=function(h){var b=this.__data__;return kf?b[h]!==_:vr.call(b,h)},fo.prototype.set=function(h,b){var k=this.__data__;return this.size+=this.has(h)?0:1,k[h]=kf&&b===_?v:b,this},ho.prototype.clear=function(){this.__data__=[],this.size=0},ho.prototype.delete=function(h){var b=this.__data__,k=ga(b,h);return!(k<0||(k==b.length-1?b.pop():fh.call(b,k,1),--this.size,0))},ho.prototype.get=function(h){var b=this.__data__,k=ga(b,h);return k<0?_:b[k][1]},ho.prototype.has=function(h){return ga(this.__data__,h)>-1},ho.prototype.set=function(h,b){var k=this.__data__,F=ga(k,h);return F<0?(++this.size,k.push([h,b])):k[F][1]=b,this},Ki.prototype.clear=function(){this.size=0,this.__data__={hash:new fo,map:new(Mf||ho),string:new fo}},Ki.prototype.delete=function(h){var b=br(this,h).delete(h);return this.size-=b?1:0,b},Ki.prototype.get=function(h){return br(this,h).get(h)},Ki.prototype.has=function(h){return br(this,h).has(h)},Ki.prototype.set=function(h,b){var k=br(this,h),F=k.size;return k.set(h,b),this.size+=k.size==F?0:1,this},hn.prototype.add=hn.prototype.push=function(h){return this.__data__.set(h,v),this},hn.prototype.has=function(h){return this.__data__.has(h)},Ei.prototype.clear=function(){this.__data__=new ho,this.size=0},Ei.prototype.delete=function(h){var b=this.__data__,k=b.delete(h);return this.size=b.size,k},Ei.prototype.get=function(h){return this.__data__.get(h)},Ei.prototype.has=function(h){return this.__data__.has(h)},Ei.prototype.set=function(h,b){var k=this.__data__;if(k instanceof ho){var F=k.__data__;if(!Mf||F.length<199)return F.push([h,b]),this.size=++k.size,this;k=this.__data__=new Ki(F)}return k.set(h,b),this.size=k.size,this};var us=Nd(Ks),uc=Nd(Ro,!0);function Gh(h,b){var k=!0;return us(h,(function(F,ie,pe){return k=!!b(F,ie,pe)})),k}function Wl(h,b,k){for(var F=-1,ie=h.length;++F<ie;){var pe=h[F],ye=b(pe);if(ye!=null&&(Ae===_?ye==ye&&!Ms(ye):k(ye,Ae)))var Ae=ye,De=pe}return De}function Tu(h,b){var k=[];return us(h,(function(F,ie,pe){b(F,ie,pe)&&k.push(F)})),k}function si(h,b,k,F,ie){var pe=-1,ye=h.length;for(k||(k=Qg),ie||(ie=[]);++pe<ye;){var Ae=h[pe];b>0&&k(Ae)?b>1?si(Ae,b-1,k,F,ie):Rc(ie,Ae):F||(ie[ie.length]=Ae)}return ie}var $h=Pd(),Qp=Pd(!0);function Ks(h,b){return h&&$h(h,b,Zr)}function Ro(h,b){return h&&Qp(h,b,Zr)}function As(h,b){return Gc(b,(function(k){return Ga(h[k])}))}function ei(h,b){for(var k=0,F=(b=Co(b,h)).length;h!=null&&k<F;)h=h[pl(b[k++])];return k&&k==F?h:_}function Nc(h,b,k){var F=b(h);return wr(h)?F:Rc(F,k(h))}function gi(h){return h==null?h===_?"[object Undefined]":"[object Null]":Hi&&Hi in _r(h)?(function(b){var k=vr.call(b,Hi),F=b[Hi];try{b[Hi]=_;var ie=!0}catch{}var pe=Rf.call(b);return ie&&(k?b[Hi]=F:delete b[Hi]),pe})(h):(function(b){return Rf.call(b)})(h)}function Wh(h,b){return h>b}function Yh(h,b){return h!=null&&vr.call(h,b)}function W_(h,b){return h!=null&&b in _r(h)}function Md(h,b,k){for(var F=k?Wi:$u,ie=h[0].length,pe=h.length,ye=pe,Ae=tn(pe),De=1/0,Fe=[];ye--;){var Ye=h[ye];ye&&b&&(Ye=Yi(Ye,Vl(b))),De=Xi(Ye.length,De),Ae[ye]=!k&&(b||ie>=120&&Ye.length>=120)?new hn(ye&&Ye):_}Ye=h[0];var dt=-1,Et=Ae[0];e:for(;++dt<ie&&Fe.length<De;){var Pt=Ye[dt],bt=b?b(Pt):Pt;if(Pt=k||Pt!==0?Pt:0,!(Et?Kp(Et,bt):F(Fe,bt,k))){for(ye=pe;--ye;){var gt=Ae[ye];if(!(gt?Kp(gt,bt):F(h[ye],bt,k)))continue e}Et&&Et.push(bt),Fe.push(Pt)}}return Fe}function al(h,b,k){var F=(h=im(h,b=Co(b,h)))==null?h:h[pl(Ql(b))];return F==null?_:ac(F,h,k)}function Qn(h){return hs(h)&&gi(h)==G}function Ii(h,b,k,F,ie){return h===b||(h==null||b==null||!hs(h)&&!hs(b)?h!=h&&b!=b:(function(pe,ye,Ae,De,Fe,Ye){var dt=wr(pe),Et=wr(ye),Pt=dt?Q:Ho(pe),bt=Et?Q:Ho(ye),gt=(Pt=Pt==G?ae:Pt)==ae,Ot=(bt=bt==G?ae:bt)==ae,wt=Pt==bt;if(wt&&wa(pe)){if(!wa(ye))return!1;dt=!0,gt=!1}if(wt&&!gt)return Ye||(Ye=new Ei),dt||Ni(pe)?_p(pe,ye,Ae,De,Fe,Ye):(function($t,dn,Rn,Nn,qn,Dn,gr){switch(Rn){case qe:if($t.byteLength!=dn.byteLength||$t.byteOffset!=dn.byteOffset)return!1;$t=$t.buffer,dn=dn.buffer;case Me:return!($t.byteLength!=dn.byteLength||!Dn(new Su($t),new Su(dn)));case B:case $:case Y:return sa(+$t,+dn);case U:return $t.name==dn.name&&$t.message==dn.message;case K:case le:return $t==dn+"";case q:var Ur=Hh;case ne:var Ci=1&Nn;if(Ur||(Ur=eg),$t.size!=dn.size&&!Ci)return!1;var ai=gr.get($t);if(ai)return ai==dn;Nn|=2,gr.set($t,dn);var oi=_p(Ur($t),Ur(dn),Nn,qn,Dn,gr);return gr.delete($t),oi;case ce:if(lc)return lc.call($t)==lc.call(dn)}return!1})(pe,ye,Pt,Ae,De,Fe,Ye);if(!(1&Ae)){var It=gt&&vr.call(pe,"__wrapped__"),Ft=Ot&&vr.call(ye,"__wrapped__");if(It||Ft){var Zt=It?pe.value():pe,Gt=Ft?ye.value():ye;return Ye||(Ye=new Ei),Fe(Zt,Gt,Ae,De,Ye)}}return!!wt&&(Ye||(Ye=new Ei),(function($t,dn,Rn,Nn,qn,Dn){var gr=1&Rn,Ur=Kl($t),Ci=Ur.length;if(Ci!=Kl(dn).length&&!gr)return!1;for(var ai=Ci;ai--;){var oi=Ur[ai];if(!(gr?oi in dn:vr.call(dn,oi)))return!1}var Bi=Dn.get($t),Wr=Dn.get(dn);if(Bi&&Wr)return Bi==dn&&Wr==$t;var bs=!0;Dn.set($t,dn),Dn.set(dn,$t);for(var li=gr;++ai<Ci;){var Os=$t[oi=Ur[ai]],Vi=dn[oi];if(Nn)var Js=gr?Nn(Vi,Os,oi,dn,$t,Dn):Nn(Os,Vi,oi,$t,dn,Dn);if(!(Js===_?Os===Vi||qn(Os,Vi,Rn,Nn,Dn):Js)){bs=!1;break}li||(li=oi=="constructor")}if(bs&&!li){var Is=$t.constructor,ps=dn.constructor;Is==ps||!("constructor"in $t)||!("constructor"in dn)||typeof Is=="function"&&Is instanceof Is&&typeof ps=="function"&&ps instanceof ps||(bs=!1)}return Dn.delete($t),Dn.delete(dn),bs})(pe,ye,Ae,De,Fe,Ye))})(h,b,k,F,Ii,ie))}function Xc(h,b,k,F){var ie=k.length,pe=ie,ye=!F;if(h==null)return!pe;for(h=_r(h);ie--;){var Ae=k[ie];if(ye&&Ae[2]?Ae[1]!==h[Ae[0]]:!(Ae[0]in h))return!1}for(;++ie<pe;){var De=(Ae=k[ie])[0],Fe=h[De],Ye=Ae[1];if(ye&&Ae[2]){if(Fe===_&&!(De in h))return!1}else{var dt=new Ei;if(F)var Et=F(Fe,Ye,De,h,b,dt);if(!(Et===_?Ii(Ye,Fe,3,F,dt):Et))return!1}}return!0}function po(h){return!(!Hr(h)||(b=h,ch&&ch in b))&&(Ga(h)?ng:Qe).test(Lc(h));var b}function Nf(h){return typeof h=="function"?h:h==null?ds:typeof h=="object"?wr(h)?kd(h[0],h[1]):Jp(h):hm(h)}function Kc(h){if(!nm(h))return Xg(h);var b=[];for(var k in _r(h))vr.call(h,k)&&k!="constructor"&&b.push(k);return b}function ph(h,b){return h<b}function Zc(h,b){var k=-1,F=Li(h)?tn(h.length):[];return us(h,(function(ie,pe,ye){F[++k]=b(ie,pe,ye)})),F}function Jp(h){var b=rd(h);return b.length==1&&b[0][2]?rm(b[0][0],b[0][1]):function(k){return k===h||Xc(k,h,b)}}function kd(h,b){return qo(h)&&qa(b)?rm(pl(h),b):function(k){var F=xp(k,h);return F===_&&F===b?gl(k,h):Ii(b,F,3)}}function Ao(h,b,k,F,ie){h!==b&&$h(b,(function(pe,ye){if(ie||(ie=new Ei),Hr(pe))(function(De,Fe,Ye,dt,Et,Pt,bt){var gt=sm(De,Ye),Ot=sm(Fe,Ye),wt=bt.get(Ot);if(wt)To(De,Ye,wt);else{var It=Pt?Pt(gt,Ot,Ye+"",De,Fe,bt):_,Ft=It===_;if(Ft){var Zt=wr(Ot),Gt=!Zt&&wa(Ot),$t=!Zt&&!Gt&&Ni(Ot);It=Ot,Zt||Gt||$t?wr(gt)?It=gt:aa(gt)?It=kl(gt):Gt?(Ft=!1,It=em(Ot,!0)):$t?(Ft=!1,It=Au(Ot,!0)):It=[]:qi(Ot)||Sr(Ot)?(It=gt,Sr(gt)?It=$r(gt):Hr(gt)&&!Ga(gt)||(It=id(Ot))):Ft=!1}Ft&&(bt.set(Ot,It),Et(It,Ot,dt,Pt,bt),bt.delete(Ot)),To(De,Ye,It)}})(h,b,ye,k,Ao,F,ie);else{var Ae=F?F(sm(h,ye),pe,ye+"",h,b,ie):_;Ae===_&&(Ae=pe),To(h,ye,Ae)}}),so)}function Xh(h,b){var k=h.length;if(k)return sf(b+=b<0?k:0,k)?h[b]:_}function Zu(h,b,k){b=b.length?Yi(b,(function(pe){return wr(pe)?function(ye){return ei(ye,pe.length===1?pe[0]:pe)}:pe})):[ds];var F=-1;b=Yi(b,Vl(dr()));var ie=Zc(h,(function(pe,ye,Ae){var De=Yi(b,(function(Fe){return Fe(pe)}));return{criteria:De,index:++F,value:pe}}));return(function(pe){var ye=pe.length;for(pe.sort((function(Ae,De){return(function(Fe,Ye,dt){for(var Et=-1,Pt=Fe.criteria,bt=Ye.criteria,gt=Pt.length,Ot=dt.length;++Et<gt;){var wt=Pf(Pt[Et],bt[Et]);if(wt)return Et>=Ot?wt:wt*(dt[Et]=="desc"?-1:1)}return Fe.index-Ye.index})(Ae,De,k)}));ye--;)pe[ye]=pe[ye].value;return pe})(ie)}function Na(h,b,k){for(var F=-1,ie=b.length,pe={};++F<ie;){var ye=b[F],Ae=ei(h,ye);k(Ae,ye)&&Yl(pe,Co(ye,h),Ae)}return pe}function Kh(h,b,k,F){var ie=F?ma:ih,pe=-1,ye=b.length,Ae=h;for(h===b&&(b=kl(b)),k&&(Ae=Yi(h,Vl(k)));++pe<ye;)for(var De=0,Fe=b[pe],Ye=k?k(Fe):Fe;(De=ie(Ae,Ye,De,F))>-1;)Ae!==h&&fh.call(Ae,De,1),fh.call(h,De,1);return h}function pp(h,b){for(var k=h?b.length:0,F=k-1;k--;){var ie=b[k];if(k==F||ie!==pe){var pe=ie;sf(ie)?fh.call(h,ie,1):Pc(h,ie)}}return h}function Qu(h,b){return h+Cd(fp()*(b-h+1))}function mh(h,b){var k="";if(!h||b<1||b>N)return k;do b%2&&(k+=h),(b=Cd(b/2))&&(h+=h);while(b);return k}function Lr(h,b){return ku(Jg(h,b,ds),h+"")}function yr(h){return Of(iu(h))}function ol(h,b){var k=iu(h);return am(k,Al(b,0,k.length))}function Yl(h,b,k,F){if(!Hr(h))return h;for(var ie=-1,pe=(b=Co(b,h)).length,ye=pe-1,Ae=h;Ae!=null&&++ie<pe;){var De=pl(b[ie]),Fe=k;if(De==="__proto__"||De==="constructor"||De==="prototype")return h;if(ie!=ye){var Ye=Ae[De];(Fe=F?F(Ye,De,Ae):_)===_&&(Fe=Hr(Ye)?Ye:sf(b[ie+1])?[]:{})}Oc(Ae,De,Fe),Ae=Ae[De]}return h}var xi=kc?function(h,b){return kc.set(h,b),h}:ds,mp=xu?function(h,b){return xu(h,"toString",{configurable:!0,enumerable:!1,value:bh(b),writable:!0})}:ds;function Fr(h){return am(iu(h))}function Ml(h,b,k){var F=-1,ie=h.length;b<0&&(b=-b>ie?0:ie+b),(k=k>ie?ie:k)<0&&(k+=ie),ie=b>k?0:k-b>>>0,b>>>=0;for(var pe=tn(ie);++F<ie;)pe[F]=h[F+b];return pe}function Pa(h,b){var k;return us(h,(function(F,ie,pe){return!(k=b(F,ie,pe))})),!!k}function Od(h,b,k){var F=0,ie=h==null?F:h.length;if(typeof b=="number"&&b==b&&ie<=2147483647){for(;F<ie;){var pe=F+ie>>>1,ye=h[pe];ye!==null&&!Ms(ye)&&(k?ye<=b:ye<b)?F=pe+1:ie=pe}return ie}return gp(h,b,ds,k)}function gp(h,b,k,F){var ie=0,pe=h==null?0:h.length;if(pe===0)return 0;for(var ye=(b=k(b))!=b,Ae=b===null,De=Ms(b),Fe=b===_;ie<pe;){var Ye=Cd((ie+pe)/2),dt=k(h[Ye]),Et=dt!==_,Pt=dt===null,bt=dt==dt,gt=Ms(dt);if(ye)var Ot=F||bt;else Ot=Fe?bt&&(F||Et):Ae?bt&&Et&&(F||!Pt):De?bt&&Et&&!Pt&&(F||!gt):!Pt&&!gt&&(F?dt<=b:dt<b);Ot?ie=Ye+1:pe=Ye}return Xi(pe,4294967294)}function ll(h,b){for(var k=-1,F=h.length,ie=0,pe=[];++k<F;){var ye=h[k],Ae=b?b(ye):ye;if(!k||!sa(Ae,De)){var De=Ae;pe[ie++]=ye===0?0:ye}}return pe}function Xl(h){return typeof h=="number"?h:Ms(h)?I:+h}function ja(h){if(typeof h=="string")return h;if(wr(h))return Yi(h,ja)+"";if(Ms(h))return Br?Br.call(h):"";var b=h+"";return b=="0"&&1/h==-1/0?"-0":b}function ra(h,b,k){var F=-1,ie=$u,pe=h.length,ye=!0,Ae=[],De=Ae;if(k)ye=!1,ie=Wi;else if(pe>=200){var Fe=b?null:Zg(h);if(Fe)return eg(Fe);ye=!1,ie=Kp,De=new hn}else De=b?[]:Ae;e:for(;++F<pe;){var Ye=h[F],dt=b?b(Ye):Ye;if(Ye=k||Ye!==0?Ye:0,ye&&dt==dt){for(var Et=De.length;Et--;)if(De[Et]===dt)continue e;b&&De.push(dt),Ae.push(Ye)}else ie(De,dt,k)||(De!==Ae&&De.push(dt),Ae.push(Ye))}return Ae}function Pc(h,b){return(h=im(h,b=Co(b,h)))==null||delete h[pl(Ql(b))]}function Id(h,b,k,F){return Yl(h,b,k(ei(h,b)),F)}function wu(h,b,k,F){for(var ie=h.length,pe=F?ie:-1;(F?pe--:++pe<ie)&&b(h[pe],pe,h););return k?Ml(h,F?0:pe,F?pe+1:ie):Ml(h,F?pe+1:0,F?ie:pe)}function eo(h,b){var k=h;return k instanceof On&&(k=k.value()),Ef(b,(function(F,ie){return ie.func.apply(ie.thisArg,Rc([F],ie.args))}),k)}function Ju(h,b,k){var F=h.length;if(F<2)return F?ra(h[0]):[];for(var ie=-1,pe=tn(F);++ie<F;)for(var ye=h[ie],Ae=-1;++Ae<F;)Ae!=ie&&(pe[ie]=Ic(pe[ie]||ye,h[Ae],b,k));return ra(si(pe,1),b,k)}function Dc(h,b,k){for(var F=-1,ie=h.length,pe=b.length,ye={};++F<ie;){var Ae=F<pe?b[F]:_;k(ye,h[F],Ae)}return ye}function ef(h){return aa(h)?h:[]}function Ru(h){return typeof h=="function"?h:ds}function Co(h,b){return wr(h)?h:qo(h,b)?[h]:Ou(rs(h))}var tf=Lr;function nf(h,b,k){var F=h.length;return k=k===_?F:k,!b&&k>=F?h:Ml(h,b,k)}var Mo=G_||function(h){return Jr.clearTimeout(h)};function em(h,b){if(b)return h.slice();var k=h.length,F=Yg?Yg(k):new h.constructor(k);return h.copy(F),F}function jr(h){var b=new h.constructor(h.byteLength);return new Su(b).set(new Su(h)),b}function Au(h,b){var k=b?jr(h.buffer):h.buffer;return new h.constructor(k,h.byteOffset,h.length)}function Pf(h,b){if(h!==b){var k=h!==_,F=h===null,ie=h==h,pe=Ms(h),ye=b!==_,Ae=b===null,De=b==b,Fe=Ms(b);if(!Ae&&!Fe&&!pe&&h>b||pe&&ye&&De&&!Ae&&!Fe||F&&ye&&De||!k&&De||!ie)return 1;if(!F&&!pe&&!Fe&&h<b||Fe&&k&&ie&&!F&&!pe||Ae&&k&&ie||!ye&&ie||!De)return-1}return 0}function Zh(h,b,k,F){for(var ie=-1,pe=h.length,ye=k.length,Ae=-1,De=b.length,Fe=mi(pe-ye,0),Ye=tn(De+Fe),dt=!F;++Ae<De;)Ye[Ae]=b[Ae];for(;++ie<ye;)(dt||ie<pe)&&(Ye[k[ie]]=h[ie]);for(;Fe--;)Ye[Ae++]=h[ie++];return Ye}function Qh(h,b,k,F){for(var ie=-1,pe=h.length,ye=-1,Ae=k.length,De=-1,Fe=b.length,Ye=mi(pe-Ae,0),dt=tn(Ye+Fe),Et=!F;++ie<Ye;)dt[ie]=h[ie];for(var Pt=ie;++De<Fe;)dt[Pt+De]=b[De];for(;++ye<Ae;)(Et||ie<pe)&&(dt[Pt+k[ye]]=h[ie++]);return dt}function kl(h,b){var k=-1,F=h.length;for(b||(b=tn(F));++k<F;)b[k]=h[k];return b}function Hs(h,b,k,F){var ie=!k;k||(k={});for(var pe=-1,ye=b.length;++pe<ye;){var Ae=b[pe],De=F?F(k[Ae],h[Ae],Ae,k,h):_;De===_&&(De=h[Ae]),ie?Ia(k,Ae,De):Oc(k,Ae,De)}return k}function Ol(h,b){return function(k,F){var ie=wr(k)?Uo:dp,pe=b?b():{};return ie(k,h,dr(F,2),pe)}}function Qc(h){return Lr((function(b,k){var F=-1,ie=k.length,pe=ie>1?k[ie-1]:_,ye=ie>2?k[2]:_;for(pe=h.length>3&&typeof pe=="function"?(ie--,pe):_,ye&&La(k[0],k[1],ye)&&(pe=ie<3?_:pe,ie=1),b=_r(b);++F<ie;){var Ae=k[F];Ae&&h(b,Ae,F,pe)}return b}))}function Nd(h,b){return function(k,F){if(k==null)return k;if(!Li(k))return h(k,F);for(var ie=k.length,pe=b?ie:-1,ye=_r(k);(b?pe--:++pe<ie)&&F(ye[pe],pe,ye)!==!1;);return k}}function Pd(h){return function(b,k,F){for(var ie=-1,pe=_r(b),ye=F(b),Ae=ye.length;Ae--;){var De=ye[h?Ae:++ie];if(k(pe[De],De,pe)===!1)break}return b}}function tm(h){return function(b){var k=jh(b=rs(b))?Ta(b):_,F=k?k[0]:b.charAt(0),ie=k?nf(k,1).join(""):b.slice(1);return F[h]()+ie}}function Jh(h){return function(b){return Ef(Ui(ca(b).replace(rr,"")),h,"")}}function Cu(h){return function(){var b=arguments;switch(b.length){case 0:return new h;case 1:return new h(b[0]);case 2:return new h(b[0],b[1]);case 3:return new h(b[0],b[1],b[2]);case 4:return new h(b[0],b[1],b[2],b[3]);case 5:return new h(b[0],b[1],b[2],b[3],b[4]);case 6:return new h(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new h(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var k=cc(h.prototype),F=h.apply(k,b);return Hr(F)?F:k}}function cl(h){return function(b,k,F){var ie=_r(b);if(!Li(b)){var pe=dr(k,3);b=Zr(b),k=function(Ae){return pe(ie[Ae],Ae,ie)}}var ye=h(b,k,F);return ye>-1?ie[pe?b[ye]:ye]:_}}function rf(h){return fl((function(b){var k=b.length,F=k,ie=Ai.prototype.thru;for(h&&b.reverse();F--;){var pe=b[F];if(typeof pe!="function")throw new ns(y);if(ie&&!ye&&ia(pe)=="wrapper")var ye=new Ai([],!0)}for(F=ye?F:k;++F<k;){var Ae=ia(pe=b[F]),De=Ae=="wrapper"?hl(pe):_;ye=De&&Dd(De[0])&&De[1]==424&&!De[4].length&&De[9]==1?ye[ia(De[0])].apply(ye,De[3]):pe.length==1&&Dd(pe)?ye[Ae]():ye.thru(pe)}return function(){var Fe=arguments,Ye=Fe[0];if(ye&&Fe.length==1&&wr(Ye))return ye.plant(Ye).value();for(var dt=0,Et=k?b[dt].apply(this,Fe):Ye;++dt<k;)Et=b[dt].call(this,Et);return Et}}))}function Kr(h,b,k,F,ie,pe,ye,Ae,De,Fe){var Ye=b&M,dt=1&b,Et=2&b,Pt=24&b,bt=512&b,gt=Et?_:Cu(h);return function Ot(){for(var wt=arguments.length,It=tn(wt),Ft=wt;Ft--;)It[Ft]=arguments[Ft];if(Pt)var Zt=hc(Ot),Gt=(function(Nn,qn){for(var Dn=Nn.length,gr=0;Dn--;)Nn[Dn]===qn&&++gr;return gr})(It,Zt);if(F&&(It=Zh(It,F,ie,Pt)),pe&&(It=Qh(It,pe,ye,Pt)),wt-=Gt,Pt&&wt<Fe){var $t=Xu(It,Zt);return fc(h,b,Kr,Ot.placeholder,k,It,$t,Ae,De,Fe-wt)}var dn=dt?k:this,Rn=Et?dn[h]:h;return wt=It.length,Ae?It=(function(Nn,qn){for(var Dn=Nn.length,gr=Xi(qn.length,Dn),Ur=kl(Nn);gr--;){var Ci=qn[gr];Nn[gr]=sf(Ci,Dn)?Ur[Ci]:_}return Nn})(It,Ae):bt&&wt>1&&It.reverse(),Ye&&De<wt&&(It.length=De),this&&this!==Jr&&this instanceof Ot&&(Rn=gt||Cu(Rn)),Rn.apply(dn,It)}}function fs(h,b){return function(k,F){return(function(ie,pe,ye,Ae){return Ks(ie,(function(De,Fe,Ye){pe(Ae,ye(De),Fe,Ye)})),Ae})(k,h,b(F),{})}}function Ha(h,b){return function(k,F){var ie;if(k===_&&F===_)return b;if(k!==_&&(ie=k),F!==_){if(ie===_)return F;typeof k=="string"||typeof F=="string"?(k=ja(k),F=ja(F)):(k=Xl(k),F=Xl(F)),ie=h(k,F)}return ie}}function ed(h){return fl((function(b){return b=Yi(b,Vl(dr())),Lr((function(k){var F=this;return h(b,(function(ie){return ac(ie,F,k)}))}))}))}function Mu(h,b){var k=(b=b===_?" ":ja(b)).length;if(k<2)return k?mh(b,h):b;var F=mh(b,Mc(h/vs(b)));return jh(b)?nf(Ta(F),0,h).join(""):F.slice(0,h)}function ul(h){return function(b,k,F){return F&&typeof F!="number"&&La(b,k,F)&&(k=F=_),b=mr(b),k===_?(k=b,b=0):k=mr(k),(function(ie,pe,ye,Ae){for(var De=-1,Fe=mi(Mc((pe-ie)/(ye||1)),0),Ye=tn(Fe);Fe--;)Ye[Ae?Fe:++De]=ie,ie+=ye;return Ye})(b,k,F=F===_?b<k?1:-1:mr(F),h)}}function to(h){return function(b,k){return typeof b=="string"&&typeof k=="string"||(b=Wa(b),k=Wa(k)),h(b,k)}}function fc(h,b,k,F,ie,pe,ye,Ae,De,Fe){var Ye=8&b;b|=Ye?E:64,4&(b&=~(Ye?64:E))||(b&=-4);var dt=[h,b,ie,Ye?pe:_,Ye?ye:_,Ye?_:pe,Ye?_:ye,Ae,De,Fe],Et=k.apply(_,dt);return Dd(h)&&Ld(Et,dt),Et.placeholder=F,cg(Et,h,b)}function jo(h){var b=sl[h];return function(k,F){if(k=Wa(k),(F=F==null?0:Xi(fr(F),292))&&$l(k)){var ie=(rs(k)+"e").split("e");return+((ie=(rs(b(ie[0]+"e"+(+ie[1]+F)))+"e").split("e"))[0]+"e"+(+ie[1]-F))}return b(k)}}var Zg=wl&&1/eg(new wl([,-0]))[1]==O?function(h){return new wl(h)}:ui;function Da(h){return function(b){var k=Ho(b);return k==q?Hh(b):k==ne?(function(F){var ie=-1,pe=Array(F.size);return F.forEach((function(ye){pe[++ie]=[ye,ye]})),pe})(b):(function(F,ie){return Yi(ie,(function(pe){return[pe,F[pe]]}))})(b,h(b))}}function Zs(h,b,k,F,ie,pe,ye,Ae){var De=2&b;if(!De&&typeof h!="function")throw new ns(y);var Fe=F?F.length:0;if(Fe||(b&=-97,F=ie=_),ye=ye===_?ye:mi(fr(ye),0),Ae=Ae===_?Ae:fr(Ae),Fe-=ie?ie.length:0,64&b){var Ye=F,dt=ie;F=ie=_}var Et=De?_:hl(h),Pt=[h,b,k,F,ie,Ye,dt,pe,ye,Ae];if(Et&&(function(gt,Ot){var wt=gt[1],It=Ot[1],Ft=wt|It,Zt=Ft<131,Gt=It==M&&wt==8||It==M&&wt==256&&gt[7].length<=Ot[8]||It==384&&Ot[7].length<=Ot[8]&&wt==8;if(!Zt&&!Gt)return gt;1&It&&(gt[2]=Ot[2],Ft|=1&wt?0:4);var $t=Ot[3];if($t){var dn=gt[3];gt[3]=dn?Zh(dn,$t,Ot[4]):$t,gt[4]=dn?Xu(gt[3],x):Ot[4]}($t=Ot[5])&&(dn=gt[5],gt[5]=dn?Qh(dn,$t,Ot[6]):$t,gt[6]=dn?Xu(gt[5],x):Ot[6]),($t=Ot[7])&&(gt[7]=$t),It&M&&(gt[8]=gt[8]==null?Ot[8]:Xi(gt[8],Ot[8])),gt[9]==null&&(gt[9]=Ot[9]),gt[0]=Ot[0],gt[1]=Ft})(Pt,Et),h=Pt[0],b=Pt[1],k=Pt[2],F=Pt[3],ie=Pt[4],!(Ae=Pt[9]=Pt[9]===_?De?0:h.length:mi(Pt[9]-Fe,0))&&24&b&&(b&=-25),b&&b!=1)bt=b==8||b==16?(function(gt,Ot,wt){var It=Cu(gt);return function Ft(){for(var Zt=arguments.length,Gt=tn(Zt),$t=Zt,dn=hc(Ft);$t--;)Gt[$t]=arguments[$t];var Rn=Zt<3&&Gt[0]!==dn&&Gt[Zt-1]!==dn?[]:Xu(Gt,dn);return(Zt-=Rn.length)<wt?fc(gt,Ot,Kr,Ft.placeholder,_,Gt,Rn,_,_,wt-Zt):ac(this&&this!==Jr&&this instanceof Ft?It:gt,this,Gt)}})(h,b,Ae):b!=E&&b!=33||ie.length?Kr.apply(_,Pt):(function(gt,Ot,wt,It){var Ft=1&Ot,Zt=Cu(gt);return function Gt(){for(var $t=-1,dn=arguments.length,Rn=-1,Nn=It.length,qn=tn(Nn+dn),Dn=this&&this!==Jr&&this instanceof Gt?Zt:gt;++Rn<Nn;)qn[Rn]=It[Rn];for(;dn--;)qn[Rn++]=arguments[++$t];return ac(Dn,Ft?wt:this,qn)}})(h,b,k,F);else var bt=(function(gt,Ot,wt){var It=1&Ot,Ft=Cu(gt);return function Zt(){return(this&&this!==Jr&&this instanceof Zt?Ft:gt).apply(It?wt:this,arguments)}})(h,b,k);return cg((Et?xi:Ld)(bt,Pt),h,b)}function no(h,b,k,F){return h===_||sa(h,sr[k])&&!vr.call(F,k)?b:h}function td(h,b,k,F,ie,pe){return Hr(h)&&Hr(b)&&(pe.set(b,h),Ao(h,b,_,td,pe),pe.delete(b)),h}function nd(h){return qi(h)?_:h}function _p(h,b,k,F,ie,pe){var ye=1&k,Ae=h.length,De=b.length;if(Ae!=De&&!(ye&&De>Ae))return!1;var Fe=pe.get(h),Ye=pe.get(b);if(Fe&&Ye)return Fe==b&&Ye==h;var dt=-1,Et=!0,Pt=2&k?new hn:_;for(pe.set(h,b),pe.set(b,h);++dt<Ae;){var bt=h[dt],gt=b[dt];if(F)var Ot=ye?F(gt,bt,dt,b,h,pe):F(bt,gt,dt,h,b,pe);if(Ot!==_){if(Ot)continue;Et=!1;break}if(Pt){if(!oc(b,(function(wt,It){if(!Kp(Pt,It)&&(bt===wt||ie(bt,wt,k,F,pe)))return Pt.push(It)}))){Et=!1;break}}else if(bt!==gt&&!ie(bt,gt,k,F,pe)){Et=!1;break}}return pe.delete(h),pe.delete(b),Et}function fl(h){return ku(Jg(h,_,cm),h+"")}function Kl(h){return Nc(h,Zr,Zl)}function vp(h){return Nc(h,so,yp)}var hl=kc?function(h){return kc.get(h)}:ui;function ia(h){for(var b=h.name+"",k=Rs[b],F=vr.call(Rs,b)?k.length:0;F--;){var ie=k[F],pe=ie.func;if(pe==null||pe==h)return ie.name}return b}function hc(h){return(vr.call(ve,"placeholder")?ve:h).placeholder}function dr(){var h=ve.iteratee||Qs;return h=h===Qs?Nf:h,arguments.length?h(arguments[0],arguments[1]):h}function br(h,b){var k,F,ie=h.__data__;return((F=typeof(k=b))=="string"||F=="number"||F=="symbol"||F=="boolean"?k!=="__proto__":k===null)?ie[typeof b=="string"?"string":"hash"]:ie.map}function rd(h){for(var b=Zr(h),k=b.length;k--;){var F=b[k],ie=h[F];b[k]=[F,ie,qa(ie)]}return b}function mo(h,b){var k=(function(F,ie){return F==null?_:F[ie]})(h,b);return po(k)?k:_}var Zl=uo?function(h){return h==null?[]:(h=_r(h),Gc(uo(h),(function(b){return Zp.call(h,b)})))}:Du,yp=uo?function(h){for(var b=[];h;)Rc(b,Zl(h)),h=Eu(h);return b}:Du,Ho=gi;function dl(h,b,k){for(var F=-1,ie=(b=Co(b,h)).length,pe=!1;++F<ie;){var ye=pl(b[F]);if(!(pe=h!=null&&k(h,ye)))break;h=h[ye]}return pe||++F!=ie?pe:!!(ie=h==null?0:h.length)&&oa(ie)&&sf(ye,ie)&&(wr(h)||Sr(h))}function id(h){return typeof h.constructor!="function"||nm(h)?{}:cc(Eu(h))}function Qg(h){return wr(h)||Sr(h)||!!(Af&&h&&h[Af])}function sf(h,b){var k=typeof h;return!!(b=b??N)&&(k=="number"||k!="symbol"&&mt.test(h))&&h>-1&&h%1==0&&h<b}function La(h,b,k){if(!Hr(k))return!1;var F=typeof b;return!!(F=="number"?Li(k)&&sf(b,k.length):F=="string"&&b in k)&&sa(k[b],h)}function qo(h,b){if(wr(h))return!1;var k=typeof h;return!(k!="number"&&k!="symbol"&&k!="boolean"&&h!=null&&!Ms(h))||kt.test(h)||!Vt.test(h)||b!=null&&h in _r(b)}function Dd(h){var b=ia(h),k=ve[b];if(typeof k!="function"||!(b in On.prototype))return!1;if(h===k)return!0;var F=hl(k);return!!F&&h===F[0]}(zs&&Ho(new zs(new ArrayBuffer(1)))!=qe||Mf&&Ho(new Mf)!=q||xo&&Ho(xo.resolve())!=Z||wl&&Ho(new wl)!=ne||Ku&&Ho(new Ku)!=de)&&(Ho=function(h){var b=gi(h),k=b==ae?h.constructor:_,F=k?Lc(k):"";if(F)switch(F){case Kg:return qe;case Xs:return q;case K0:return Z;case Rl:return ne;case hp:return de}return b});var lg=Cc?Ga:j;function nm(h){var b=h&&h.constructor;return h===(typeof b=="function"&&b.prototype||sr)}function qa(h){return h==h&&!Hr(h)}function rm(h,b){return function(k){return k!=null&&k[h]===b&&(b!==_||h in _r(k))}}function Jg(h,b,k){return b=mi(b===_?h.length-1:b,0),function(){for(var F=arguments,ie=-1,pe=mi(F.length-b,0),ye=tn(pe);++ie<pe;)ye[ie]=F[b+ie];ie=-1;for(var Ae=tn(b+1);++ie<b;)Ae[ie]=F[ie];return Ae[b]=k(ye),ac(h,this,Ae)}}function im(h,b){return b.length<2?h:ei(h,Ml(b,0,-1))}function sm(h,b){if((b!=="constructor"||typeof h[b]!="function")&&b!="__proto__")return h[b]}var Ld=Z0(xi),Ud=rg||function(h,b){return Jr.setTimeout(h,b)},ku=Z0(mp);function cg(h,b,k){var F=b+"";return ku(h,(function(ie,pe){var ye=pe.length;if(!ye)return ie;var Ae=ye-1;return pe[Ae]=(ye>1?"& ":"")+pe[Ae],pe=pe.join(ye>2?", ":" "),ie.replace(Ne,`{
/* [wrapped with `+pe+`] */
`)})(F,(function(ie,pe){return rl(V,(function(ye){var Ae="_."+ye[0];pe&ye[1]&&!$u(ie,Ae)&&ie.push(Ae)})),ie.sort()})((function(ie){var pe=ie.match(Le);return pe?pe[1].split(ke):[]})(F),k)))}function Z0(h){var b=0,k=0;return function(){var F=sg(),ie=16-(F-k);if(k=F,ie>0){if(++b>=800)return arguments[0]}else b=0;return h.apply(_,arguments)}}function am(h,b){var k=-1,F=h.length,ie=F-1;for(b=b===_?F:b;++k<b;){var pe=Qu(k,ie),ye=h[pe];h[pe]=h[k],h[k]=ye}return h.length=b,h}var Df,Bd,Ou=(Df=ro((function(h){var b=[];return h.charCodeAt(0)===46&&b.push(""),h.replace(Ut,(function(k,F,ie,pe){b.push(ie?pe.replace(Ve,"$1"):F||k)})),b}),(function(h){return Bd.size===500&&Bd.clear(),h})),Bd=Df.cache,Df);function pl(h){if(typeof h=="string"||Ms(h))return h;var b=h+"";return b=="0"&&1/h==-1/0?"-0":b}function Lc(h){if(h!=null){try{return Oa.call(h)}catch{}try{return h+""}catch{}}return""}function om(h){if(h instanceof On)return h.clone();var b=new Ai(h.__wrapped__,h.__chain__);return b.__actions__=kl(h.__actions__),b.__index__=h.__index__,b.__values__=h.__values__,b}var e0=Lr((function(h,b){return aa(h)?Ic(h,si(b,1,aa,!0)):[]})),lm=Lr((function(h,b){var k=Ql(b);return aa(k)&&(k=_),aa(h)?Ic(h,si(b,1,aa,!0),dr(k,2)):[]})),ug=Lr((function(h,b){var k=Ql(b);return aa(k)&&(k=_),aa(h)?Ic(h,si(b,1,aa,!0),_,k):[]}));function t0(h,b,k){var F=h==null?0:h.length;if(!F)return-1;var ie=k==null?0:fr(k);return ie<0&&(ie=mi(F+ie,0)),Wc(h,dr(b,3),ie)}function n0(h,b,k){var F=h==null?0:h.length;if(!F)return-1;var ie=F-1;return k!==_&&(ie=fr(k),ie=k<0?mi(F+ie,0):Xi(ie,F-1)),Wc(h,dr(b,3),ie,!0)}function cm(h){return h!=null&&h.length?si(h,1):[]}function Q0(h){return h&&h.length?h[0]:_}var um=Lr((function(h){var b=Yi(h,ef);return b.length&&b[0]===h[0]?Md(b):[]})),r0=Lr((function(h){var b=Ql(h),k=Yi(h,ef);return b===Ql(k)?b=_:k.pop(),k.length&&k[0]===h[0]?Md(k,dr(b,2)):[]})),Iu=Lr((function(h){var b=Ql(h),k=Yi(h,ef);return(b=typeof b=="function"?b:_)&&k.pop(),k.length&&k[0]===h[0]?Md(k,_,b):[]}));function Ql(h){var b=h==null?0:h.length;return b?h[b-1]:_}var fg=Lr(hg);function hg(h,b){return h&&h.length&&b&&b.length?Kh(h,b):h}var i0=fl((function(h,b){var k=h==null?0:h.length,F=dh(h,b);return pp(h,Yi(b,(function(ie){return sf(ie,k)?+ie:ie})).sort(Pf)),F}));function s0(h){return h==null?h:Fn.call(h)}var J0=Lr((function(h){return ra(si(h,1,aa,!0))})),Y_=Lr((function(h){var b=Ql(h);return aa(b)&&(b=_),ra(si(h,1,aa,!0),dr(b,2))})),a0=Lr((function(h){var b=Ql(h);return b=typeof b=="function"?b:_,ra(si(h,1,aa,!0),_,b)}));function o0(h){if(!h||!h.length)return[];var b=0;return h=Gc(h,(function(k){if(aa(k))return b=mi(k.length,b),!0})),oh(b,(function(k){return Yi(h,ah(k))}))}function e_(h,b){if(!h||!h.length)return[];var k=o0(h);return b==null?k:Yi(k,(function(F){return ac(b,_,F)}))}var X_=Lr((function(h,b){return aa(h)?Ic(h,b):[]})),dg=Lr((function(h){return Ju(Gc(h,aa))})),pg=Lr((function(h){var b=Ql(h);return aa(b)&&(b=_),Ju(Gc(h,aa),dr(b,2))})),l0=Lr((function(h){var b=Ql(h);return b=typeof b=="function"?b:_,Ju(Gc(h,aa),_,b)})),K_=Lr(o0),Jc=Lr((function(h){var b=h.length,k=b>1?h[b-1]:_;return k=typeof k=="function"?(h.pop(),k):_,e_(h,k)}));function sd(h){var b=ve(h);return b.__chain__=!0,b}function bp(h,b){return b(h)}var t_=fl((function(h){var b=h.length,k=b?h[0]:0,F=this.__wrapped__,ie=function(pe){return dh(pe,h)};return!(b>1||this.__actions__.length)&&F instanceof On&&sf(k)?((F=F.slice(k,+k+(b?1:0))).__actions__.push({func:bp,args:[ie],thisArg:_}),new Ai(F,this.__chain__).thru((function(pe){return b&&!pe.length&&pe.push(_),pe}))):this.thru(ie)})),Z_=Ol((function(h,b,k){vr.call(h,k)?++h[k]:Ia(h,k,1)})),Sp=cl(t0),fm=cl(n0);function Fd(h,b){return(wr(h)?rl:us)(h,dr(b,3))}function gh(h,b){return(wr(h)?Xp:uc)(h,dr(b,3))}var Jl=Ol((function(h,b,k){vr.call(h,k)?h[k].push(b):Ia(h,k,[b])})),Nu=Lr((function(h,b,k){var F=-1,ie=typeof b=="function",pe=Li(h)?tn(h.length):[];return us(h,(function(ye){pe[++F]=ie?ac(b,ye,k):al(ye,b,k)})),pe})),Cs=Ol((function(h,b,k){Ia(h,k,b)}));function _h(h,b){return(wr(h)?Yi:Zc)(h,dr(b,3))}var n_=Ol((function(h,b,k){h[k?0:1].push(b)}),(function(){return[[],[]]})),qs=Lr((function(h,b){if(h==null)return[];var k=b.length;return k>1&&La(h,b[0],b[1])?b=[]:k>2&&La(b[0],b[1],b[2])&&(b=[b[0]]),Zu(h,si(b,1),[])})),dc=$_||function(){return Jr.Date.now()};function Lf(h,b,k){return b=k?_:b,b=h&&b==null?h.length:b,Zs(h,M,_,_,_,_,b)}function mg(h,b){var k;if(typeof b!="function")throw new ns(y);return h=fr(h),function(){return--h>0&&(k=b.apply(this,arguments)),h<=1&&(b=_),k}}var Uf=Lr((function(h,b,k){var F=1;if(k.length){var ie=Xu(k,hc(Uf));F|=E}return Zs(h,F,b,k,ie)})),af=Lr((function(h,b,k){var F=3;if(k.length){var ie=Xu(k,hc(af));F|=E}return Zs(b,F,h,k,ie)}));function go(h,b,k){var F,ie,pe,ye,Ae,De,Fe=0,Ye=!1,dt=!1,Et=!0;if(typeof h!="function")throw new ns(y);function Pt(It){var Ft=F,Zt=ie;return F=ie=_,Fe=It,ye=h.apply(Zt,Ft)}function bt(It){var Ft=It-De;return De===_||Ft>=b||Ft<0||dt&&It-Fe>=pe}function gt(){var It=dc();if(bt(It))return Ot(It);Ae=Ud(gt,(function(Ft){var Zt=b-(Ft-De);return dt?Xi(Zt,pe-(Ft-Fe)):Zt})(It))}function Ot(It){return Ae=_,Et&&F?Pt(It):(F=ie=_,ye)}function wt(){var It=dc(),Ft=bt(It);if(F=arguments,ie=this,De=It,Ft){if(Ae===_)return(function(Zt){return Fe=Zt,Ae=Ud(gt,b),Ye?Pt(Zt):ye})(De);if(dt)return Mo(Ae),Ae=Ud(gt,b),Pt(De)}return Ae===_&&(Ae=Ud(gt,b)),ye}return b=Wa(b)||0,Hr(k)&&(Ye=!!k.leading,pe=(dt="maxWait"in k)?mi(Wa(k.maxWait)||0,b):pe,Et="trailing"in k?!!k.trailing:Et),wt.cancel=function(){Ae!==_&&Mo(Ae),Fe=0,F=De=ie=Ae=_},wt.flush=function(){return Ae===_?ye:Ot(dc())},wt}var ad=Lr((function(h,b){return Vh(h,1,b)})),Bf=Lr((function(h,b,k){return Vh(h,Wa(b)||0,k)}));function ro(h,b){if(typeof h!="function"||b!=null&&typeof b!="function")throw new ns(y);var k=function(){var F=arguments,ie=b?b.apply(this,F):F[0],pe=k.cache;if(pe.has(ie))return pe.get(ie);var ye=h.apply(this,F);return k.cache=pe.set(ie,ye)||pe,ye};return k.cache=new(ro.Cache||Ki),k}function Vo(h){if(typeof h!="function")throw new ns(y);return function(){var b=arguments;switch(b.length){case 0:return!h.call(this);case 1:return!h.call(this,b[0]);case 2:return!h.call(this,b[0],b[1]);case 3:return!h.call(this,b[0],b[1],b[2])}return!h.apply(this,b)}}ro.Cache=Ki;var gg=tf((function(h,b){var k=(b=b.length==1&&wr(b[0])?Yi(b[0],Vl(dr())):Yi(si(b,1),Vl(dr()))).length;return Lr((function(F){for(var ie=-1,pe=Xi(F.length,k);++ie<pe;)F[ie]=b[ie].call(this,F[ie]);return ac(h,this,F)}))})),eu=Lr((function(h,b){var k=Xu(b,hc(eu));return Zs(h,E,_,b,k)})),zd=Lr((function(h,b){var k=Xu(b,hc(zd));return Zs(h,64,_,b,k)})),ml=fl((function(h,b){return Zs(h,256,_,_,_,b)}));function sa(h,b){return h===b||h!=h&&b!=b}var Q_=to(Wh),Ff=to((function(h,b){return h>=b})),Sr=Qn((function(){return arguments})())?Qn:function(h){return hs(h)&&vr.call(h,"callee")&&!Zp.call(h,"callee")},wr=tn.isArray,pc=zh?Vl(zh):function(h){return hs(h)&&gi(h)==Me};function Li(h){return h!=null&&oa(h.length)&&!Ga(h)}function aa(h){return hs(h)&&Li(h)}var wa=Cf||j,Va=lp?Vl(lp):function(h){return hs(h)&&gi(h)==$};function ys(h){if(!hs(h))return!1;var b=gi(h);return b==U||b=="[object DOMException]"||typeof h.message=="string"&&typeof h.name=="string"&&!qi(h)}function Ga(h){if(!Hr(h))return!1;var b=gi(h);return b==J||b==W||b=="[object AsyncFunction]"||b=="[object Proxy]"}function Il(h){return typeof h=="number"&&h==fr(h)}function oa(h){return typeof h=="number"&&h>-1&&h%1==0&&h<=N}function Hr(h){var b=typeof h;return h!=null&&(b=="object"||b=="function")}function hs(h){return h!=null&&typeof h=="object"}var Ra=Wp?Vl(Wp):function(h){return hs(h)&&Ho(h)==q};function tu(h){return typeof h=="number"||hs(h)&&gi(h)==Y}function qi(h){if(!hs(h)||gi(h)!=ae)return!1;var b=Eu(h);if(b===null)return!0;var k=vr.call(b,"constructor")&&b.constructor;return typeof k=="function"&&k instanceof k&&Oa.call(k)==X0}var $a=Yp?Vl(Yp):function(h){return hs(h)&&gi(h)==K},of=rh?Vl(rh):function(h){return hs(h)&&Ho(h)==ne};function Vs(h){return typeof h=="string"||!wr(h)&&hs(h)&&gi(h)==le}function Ms(h){return typeof h=="symbol"||hs(h)&&gi(h)==ce}var Ni=Tl?Vl(Tl):function(h){return hs(h)&&oa(h.length)&&!!Cn[gi(h)]},io=to(ph),mc=to((function(h,b){return h<=b}));function Nl(h){if(!h)return[];if(Li(h))return Vs(h)?Ta(h):kl(h);if(Yc&&h[Yc])return(function(k){for(var F,ie=[];!(F=k.next()).done;)ie.push(F.value);return ie})(h[Yc]());var b=Ho(h);return(b==q?Hh:b==ne?eg:iu)(h)}function mr(h){return h?(h=Wa(h))===O||h===-1/0?17976931348623157e292*(h<0?-1:1):h==h?h:0:h===0?h:0}function fr(h){var b=mr(h),k=b%1;return b==b?k?b-k:b:0}function Wn(h){return h?Al(fr(h),0,D):0}function Wa(h){if(typeof h=="number")return h;if(Ms(h))return I;if(Hr(h)){var b=typeof h.valueOf=="function"?h.valueOf():h;h=Hr(b)?b+"":b}if(typeof h!="string")return h===0?h:+h;h=Bo(h);var k=vt.test(h);return k||ht.test(h)?Lo(h.slice(2),k?2:8):nt.test(h)?I:+h}function $r(h){return Hs(h,so(h))}function rs(h){return h==null?"":ja(h)}var Pu=Qc((function(h,b){if(nm(b)||Li(b))Hs(b,Zr(b),h);else for(var k in b)vr.call(b,k)&&Oc(h,k,b[k])})),nu=Qc((function(h,b){Hs(b,so(b),h)})),ko=Qc((function(h,b,k,F){Hs(b,so(b),h,F)})),od=Qc((function(h,b,k,F){Hs(b,Zr(b),h,F)})),ld=fl(dh),Ep=Lr((function(h,b){h=_r(h);var k=-1,F=b.length,ie=F>2?b[2]:_;for(ie&&La(b[0],b[1],ie)&&(F=1);++k<F;)for(var pe=b[k],ye=so(pe),Ae=-1,De=ye.length;++Ae<De;){var Fe=ye[Ae],Ye=h[Fe];(Ye===_||sa(Ye,sr[Fe])&&!vr.call(h,Fe))&&(h[Fe]=pe[Fe])}return h})),la=Lr((function(h){return h.push(_,td),ac(vl,_,h)}));function xp(h,b,k){var F=h==null?_:ei(h,b);return F===_?k:F}function gl(h,b){return h!=null&&dl(h,b,W_)}var _l=fs((function(h,b,k){b!=null&&typeof b.toString!="function"&&(b=Rf.call(b)),h[b]=k}),bh(ds)),Uc=fs((function(h,b,k){b!=null&&typeof b.toString!="function"&&(b=Rf.call(b)),vr.call(h,b)?h[b].push(k):h[b]=[k]}),dr),Zi=Lr(al);function Zr(h){return Li(h)?ag(h):Kc(h)}function so(h){return Li(h)?ag(h,!0):(function(b){if(!Hr(b))return(function(pe){var ye=[];if(pe!=null)for(var Ae in _r(pe))ye.push(Ae);return ye})(b);var k=nm(b),F=[];for(var ie in b)(ie!="constructor"||!k&&vr.call(b,ie))&&F.push(ie);return F})(h)}var vh=Qc((function(h,b,k){Ao(h,b,k)})),vl=Qc((function(h,b,k,F){Ao(h,b,k,F)})),_a=fl((function(h,b){var k={};if(h==null)return k;var F=!1;b=Yi(b,(function(pe){return pe=Co(pe,h),F||(F=pe.length>1),pe})),Hs(h,vp(h),k),F&&(k=js(k,7,nd));for(var ie=b.length;ie--;)Pc(k,b[ie]);return k})),Go=fl((function(h,b){return h==null?{}:(function(k,F){return Na(k,F,(function(ie,pe){return gl(k,pe)}))})(h,b)}));function jd(h,b){if(h==null)return{};var k=Yi(vp(h),(function(F){return[F]}));return b=dr(b),Na(h,k,(function(F,ie){return b(F,ie[0])}))}var zf=Da(Zr),ru=Da(so);function iu(h){return h==null?[]:Ad(h,Zr(h))}var yh=Jh((function(h,b,k){return b=b.toLowerCase(),h+(k?lf(b):b)}));function lf(h){return ar(rs(h).toLowerCase())}function ca(h){return(h=rs(h))&&h.replace(ft,q_).replace(Dr,"")}var Hd=Jh((function(h,b,k){return h+(k?"-":"")+b.toLowerCase()})),su=Jh((function(h,b,k){return h+(k?" ":"")+b.toLowerCase()})),Gs=tm("toLowerCase"),Oo=Jh((function(h,b,k){return h+(k?"_":"")+b.toLowerCase()})),cd=Jh((function(h,b,k){return h+(k?" ":"")+ar(b)})),_i=Jh((function(h,b,k){return h+(k?" ":"")+b.toUpperCase()})),ar=tm("toUpperCase");function Ui(h,b,k){return h=rs(h),(b=k?_:b)===_?(function(F){return ii.test(F)})(h)?(function(F){return F.match(ha)||[]})(h):(function(F){return F.match(Re)||[]})(h):h.match(b)||[]}var $o=Lr((function(h,b){try{return ac(h,_,b)}catch(k){return ys(k)?k:new Zn(k)}})),ud=fl((function(h,b){return rl(b,(function(k){k=pl(k),Ia(h,k,Uf(h[k],h))})),h}));function bh(h){return function(){return h}}var _g=rf(),Io=rf(!0);function ds(h){return h}function Qs(h){return Nf(typeof h=="function"?h:js(h,1))}var ec=Lr((function(h,b){return function(k){return al(k,h,b)}})),ks=Lr((function(h,b){return function(k){return al(h,k,b)}}));function cf(h,b,k){var F=Zr(b),ie=As(b,F);k!=null||Hr(b)&&(ie.length||!F.length)||(k=b,b=h,h=this,ie=As(b,Zr(b)));var pe=!(Hr(k)&&"chain"in k&&!k.chain),ye=Ga(h);return rl(ie,(function(Ae){var De=b[Ae];h[Ae]=De,ye&&(h.prototype[Ae]=function(){var Fe=this.__chain__;if(pe||Fe){var Ye=h(this.__wrapped__);return(Ye.__actions__=kl(this.__actions__)).push({func:De,args:arguments,thisArg:h}),Ye.__chain__=Fe,Ye}return De.apply(h,Rc([this.value()],arguments))})})),h}function ui(){}var au=ed(Yi),Sh=ed(wc),fd=ed(oc);function hm(h){return qo(h)?ah(pl(h)):(function(b){return function(k){return ei(k,b)}})(h)}var va=ul(),jf=ul(!0);function Du(){return[]}function j(){return!1}var C,P=Ha((function(h,b){return h+b}),0),H=jo("ceil"),X=Ha((function(h,b){return h/b}),1),te=jo("floor"),ue=Ha((function(h,b){return h*b}),1),Ee=jo("round"),w=Ha((function(h,b){return h-b}),0);return ve.after=function(h,b){if(typeof b!="function")throw new ns(y);return h=fr(h),function(){if(--h<1)return b.apply(this,arguments)}},ve.ary=Lf,ve.assign=Pu,ve.assignIn=nu,ve.assignInWith=ko,ve.assignWith=od,ve.at=ld,ve.before=mg,ve.bind=Uf,ve.bindAll=ud,ve.bindKey=af,ve.castArray=function(){if(!arguments.length)return[];var h=arguments[0];return wr(h)?h:[h]},ve.chain=sd,ve.chunk=function(h,b,k){b=(k?La(h,b,k):b===_)?1:mi(fr(b),0);var F=h==null?0:h.length;if(!F||b<1)return[];for(var ie=0,pe=0,ye=tn(Mc(F/b));ie<F;)ye[pe++]=Ml(h,ie,ie+=b);return ye},ve.compact=function(h){for(var b=-1,k=h==null?0:h.length,F=0,ie=[];++b<k;){var pe=h[b];pe&&(ie[F++]=pe)}return ie},ve.concat=function(){var h=arguments.length;if(!h)return[];for(var b=tn(h-1),k=arguments[0],F=h;F--;)b[F-1]=arguments[F];return Rc(wr(k)?kl(k):[k],si(b,1))},ve.cond=function(h){var b=h==null?0:h.length,k=dr();return h=b?Yi(h,(function(F){if(typeof F[1]!="function")throw new ns(y);return[k(F[0]),F[1]]})):[],Lr((function(F){for(var ie=-1;++ie<b;){var pe=h[ie];if(ac(pe[0],this,F))return ac(pe[1],this,F)}}))},ve.conforms=function(h){return(function(b){var k=Zr(b);return function(F){return Cl(F,b,k)}})(js(h,1))},ve.constant=bh,ve.countBy=Z_,ve.create=function(h,b){var k=cc(h);return b==null?k:wo(k,b)},ve.curry=function h(b,k,F){var ie=Zs(b,8,_,_,_,_,_,k=F?_:k);return ie.placeholder=h.placeholder,ie},ve.curryRight=function h(b,k,F){var ie=Zs(b,16,_,_,_,_,_,k=F?_:k);return ie.placeholder=h.placeholder,ie},ve.debounce=go,ve.defaults=Ep,ve.defaultsDeep=la,ve.defer=ad,ve.delay=Bf,ve.difference=e0,ve.differenceBy=lm,ve.differenceWith=ug,ve.drop=function(h,b,k){var F=h==null?0:h.length;return F?Ml(h,(b=k||b===_?1:fr(b))<0?0:b,F):[]},ve.dropRight=function(h,b,k){var F=h==null?0:h.length;return F?Ml(h,0,(b=F-(b=k||b===_?1:fr(b)))<0?0:b):[]},ve.dropRightWhile=function(h,b){return h&&h.length?wu(h,dr(b,3),!0,!0):[]},ve.dropWhile=function(h,b){return h&&h.length?wu(h,dr(b,3),!0):[]},ve.fill=function(h,b,k,F){var ie=h==null?0:h.length;return ie?(k&&typeof k!="number"&&La(h,b,k)&&(k=0,F=ie),(function(pe,ye,Ae,De){var Fe=pe.length;for((Ae=fr(Ae))<0&&(Ae=-Ae>Fe?0:Fe+Ae),(De=De===_||De>Fe?Fe:fr(De))<0&&(De+=Fe),De=Ae>De?0:Wn(De);Ae<De;)pe[Ae++]=ye;return pe})(h,b,k,F)):[]},ve.filter=function(h,b){return(wr(h)?Gc:Tu)(h,dr(b,3))},ve.flatMap=function(h,b){return si(_h(h,b),1)},ve.flatMapDeep=function(h,b){return si(_h(h,b),O)},ve.flatMapDepth=function(h,b,k){return k=k===_?1:fr(k),si(_h(h,b),k)},ve.flatten=cm,ve.flattenDeep=function(h){return h!=null&&h.length?si(h,O):[]},ve.flattenDepth=function(h,b){return h!=null&&h.length?si(h,b=b===_?1:fr(b)):[]},ve.flip=function(h){return Zs(h,512)},ve.flow=_g,ve.flowRight=Io,ve.fromPairs=function(h){for(var b=-1,k=h==null?0:h.length,F={};++b<k;){var ie=h[b];F[ie[0]]=ie[1]}return F},ve.functions=function(h){return h==null?[]:As(h,Zr(h))},ve.functionsIn=function(h){return h==null?[]:As(h,so(h))},ve.groupBy=Jl,ve.initial=function(h){return h!=null&&h.length?Ml(h,0,-1):[]},ve.intersection=um,ve.intersectionBy=r0,ve.intersectionWith=Iu,ve.invert=_l,ve.invertBy=Uc,ve.invokeMap=Nu,ve.iteratee=Qs,ve.keyBy=Cs,ve.keys=Zr,ve.keysIn=so,ve.map=_h,ve.mapKeys=function(h,b){var k={};return b=dr(b,3),Ks(h,(function(F,ie,pe){Ia(k,b(F,ie,pe),F)})),k},ve.mapValues=function(h,b){var k={};return b=dr(b,3),Ks(h,(function(F,ie,pe){Ia(k,ie,b(F,ie,pe))})),k},ve.matches=function(h){return Jp(js(h,1))},ve.matchesProperty=function(h,b){return kd(h,js(b,1))},ve.memoize=ro,ve.merge=vh,ve.mergeWith=vl,ve.method=ec,ve.methodOf=ks,ve.mixin=cf,ve.negate=Vo,ve.nthArg=function(h){return h=fr(h),Lr((function(b){return Xh(b,h)}))},ve.omit=_a,ve.omitBy=function(h,b){return jd(h,Vo(dr(b)))},ve.once=function(h){return mg(2,h)},ve.orderBy=function(h,b,k,F){return h==null?[]:(wr(b)||(b=b==null?[]:[b]),wr(k=F?_:k)||(k=k==null?[]:[k]),Zu(h,b,k))},ve.over=au,ve.overArgs=gg,ve.overEvery=Sh,ve.overSome=fd,ve.partial=eu,ve.partialRight=zd,ve.partition=n_,ve.pick=Go,ve.pickBy=jd,ve.property=hm,ve.propertyOf=function(h){return function(b){return h==null?_:ei(h,b)}},ve.pull=fg,ve.pullAll=hg,ve.pullAllBy=function(h,b,k){return h&&h.length&&b&&b.length?Kh(h,b,dr(k,2)):h},ve.pullAllWith=function(h,b,k){return h&&h.length&&b&&b.length?Kh(h,b,_,k):h},ve.pullAt=i0,ve.range=va,ve.rangeRight=jf,ve.rearg=ml,ve.reject=function(h,b){return(wr(h)?Gc:Tu)(h,Vo(dr(b,3)))},ve.remove=function(h,b){var k=[];if(!h||!h.length)return k;var F=-1,ie=[],pe=h.length;for(b=dr(b,3);++F<pe;){var ye=h[F];b(ye,F,h)&&(k.push(ye),ie.push(F))}return pp(h,ie),k},ve.rest=function(h,b){if(typeof h!="function")throw new ns(y);return Lr(h,b=b===_?b:fr(b))},ve.reverse=s0,ve.sampleSize=function(h,b,k){return b=(k?La(h,b,k):b===_)?1:fr(b),(wr(h)?If:ol)(h,b)},ve.set=function(h,b,k){return h==null?h:Yl(h,b,k)},ve.setWith=function(h,b,k,F){return F=typeof F=="function"?F:_,h==null?h:Yl(h,b,k,F)},ve.shuffle=function(h){return(wr(h)?og:Fr)(h)},ve.slice=function(h,b,k){var F=h==null?0:h.length;return F?(k&&typeof k!="number"&&La(h,b,k)?(b=0,k=F):(b=b==null?0:fr(b),k=k===_?F:fr(k)),Ml(h,b,k)):[]},ve.sortBy=qs,ve.sortedUniq=function(h){return h&&h.length?ll(h):[]},ve.sortedUniqBy=function(h,b){return h&&h.length?ll(h,dr(b,2)):[]},ve.split=function(h,b,k){return k&&typeof k!="number"&&La(h,b,k)&&(b=k=_),(k=k===_?D:k>>>0)?(h=rs(h))&&(typeof b=="string"||b!=null&&!$a(b))&&!(b=ja(b))&&jh(h)?nf(Ta(h),0,k):h.split(b,k):[]},ve.spread=function(h,b){if(typeof h!="function")throw new ns(y);return b=b==null?0:mi(fr(b),0),Lr((function(k){var F=k[b],ie=nf(k,0,b);return F&&Rc(ie,F),ac(h,this,ie)}))},ve.tail=function(h){var b=h==null?0:h.length;return b?Ml(h,1,b):[]},ve.take=function(h,b,k){return h&&h.length?Ml(h,0,(b=k||b===_?1:fr(b))<0?0:b):[]},ve.takeRight=function(h,b,k){var F=h==null?0:h.length;return F?Ml(h,(b=F-(b=k||b===_?1:fr(b)))<0?0:b,F):[]},ve.takeRightWhile=function(h,b){return h&&h.length?wu(h,dr(b,3),!1,!0):[]},ve.takeWhile=function(h,b){return h&&h.length?wu(h,dr(b,3)):[]},ve.tap=function(h,b){return b(h),h},ve.throttle=function(h,b,k){var F=!0,ie=!0;if(typeof h!="function")throw new ns(y);return Hr(k)&&(F="leading"in k?!!k.leading:F,ie="trailing"in k?!!k.trailing:ie),go(h,b,{leading:F,maxWait:b,trailing:ie})},ve.thru=bp,ve.toArray=Nl,ve.toPairs=zf,ve.toPairsIn=ru,ve.toPath=function(h){return wr(h)?Yi(h,pl):Ms(h)?[h]:kl(Ou(rs(h)))},ve.toPlainObject=$r,ve.transform=function(h,b,k){var F=wr(h),ie=F||wa(h)||Ni(h);if(b=dr(b,4),k==null){var pe=h&&h.constructor;k=ie?F?new pe:[]:Hr(h)&&Ga(pe)?cc(Eu(h)):{}}return(ie?rl:Ks)(h,(function(ye,Ae,De){return b(k,ye,Ae,De)})),k},ve.unary=function(h){return Lf(h,1)},ve.union=J0,ve.unionBy=Y_,ve.unionWith=a0,ve.uniq=function(h){return h&&h.length?ra(h):[]},ve.uniqBy=function(h,b){return h&&h.length?ra(h,dr(b,2)):[]},ve.uniqWith=function(h,b){return b=typeof b=="function"?b:_,h&&h.length?ra(h,_,b):[]},ve.unset=function(h,b){return h==null||Pc(h,b)},ve.unzip=o0,ve.unzipWith=e_,ve.update=function(h,b,k){return h==null?h:Id(h,b,Ru(k))},ve.updateWith=function(h,b,k,F){return F=typeof F=="function"?F:_,h==null?h:Id(h,b,Ru(k),F)},ve.values=iu,ve.valuesIn=function(h){return h==null?[]:Ad(h,so(h))},ve.without=X_,ve.words=Ui,ve.wrap=function(h,b){return eu(Ru(b),h)},ve.xor=dg,ve.xorBy=pg,ve.xorWith=l0,ve.zip=K_,ve.zipObject=function(h,b){return Dc(h||[],b||[],Oc)},ve.zipObjectDeep=function(h,b){return Dc(h||[],b||[],Yl)},ve.zipWith=Jc,ve.entries=zf,ve.entriesIn=ru,ve.extend=nu,ve.extendWith=ko,cf(ve,ve),ve.add=P,ve.attempt=$o,ve.camelCase=yh,ve.capitalize=lf,ve.ceil=H,ve.clamp=function(h,b,k){return k===_&&(k=b,b=_),k!==_&&(k=(k=Wa(k))==k?k:0),b!==_&&(b=(b=Wa(b))==b?b:0),Al(Wa(h),b,k)},ve.clone=function(h){return js(h,4)},ve.cloneDeep=function(h){return js(h,5)},ve.cloneDeepWith=function(h,b){return js(h,5,b=typeof b=="function"?b:_)},ve.cloneWith=function(h,b){return js(h,4,b=typeof b=="function"?b:_)},ve.conformsTo=function(h,b){return b==null||Cl(h,b,Zr(b))},ve.deburr=ca,ve.defaultTo=function(h,b){return h==null||h!=h?b:h},ve.divide=X,ve.endsWith=function(h,b,k){h=rs(h),b=ja(b);var F=h.length,ie=k=k===_?F:Al(fr(k),0,F);return(k-=b.length)>=0&&h.slice(k,ie)==b},ve.eq=sa,ve.escape=function(h){return(h=rs(h))&&Ke.test(h)?h.replace(Ie,V_):h},ve.escapeRegExp=function(h){return(h=rs(h))&&ge.test(h)?h.replace(je,"\\$&"):h},ve.every=function(h,b,k){var F=wr(h)?wc:Gh;return k&&La(h,b,k)&&(b=_),F(h,dr(b,3))},ve.find=Sp,ve.findIndex=t0,ve.findKey=function(h,b){return $c(h,dr(b,3),Ks)},ve.findLast=fm,ve.findLastIndex=n0,ve.findLastKey=function(h,b){return $c(h,dr(b,3),Ro)},ve.floor=te,ve.forEach=Fd,ve.forEachRight=gh,ve.forIn=function(h,b){return h==null?h:$h(h,dr(b,3),so)},ve.forInRight=function(h,b){return h==null?h:Qp(h,dr(b,3),so)},ve.forOwn=function(h,b){return h&&Ks(h,dr(b,3))},ve.forOwnRight=function(h,b){return h&&Ro(h,dr(b,3))},ve.get=xp,ve.gt=Q_,ve.gte=Ff,ve.has=function(h,b){return h!=null&&dl(h,b,Yh)},ve.hasIn=gl,ve.head=Q0,ve.identity=ds,ve.includes=function(h,b,k,F){h=Li(h)?h:iu(h),k=k&&!F?fr(k):0;var ie=h.length;return k<0&&(k=mi(ie+k,0)),Vs(h)?k<=ie&&h.indexOf(b,k)>-1:!!ie&&ih(h,b,k)>-1},ve.indexOf=function(h,b,k){var F=h==null?0:h.length;if(!F)return-1;var ie=k==null?0:fr(k);return ie<0&&(ie=mi(F+ie,0)),ih(h,b,ie)},ve.inRange=function(h,b,k){return b=mr(b),k===_?(k=b,b=0):k=mr(k),(function(F,ie,pe){return F>=Xi(ie,pe)&&F<mi(ie,pe)})(h=Wa(h),b,k)},ve.invoke=Zi,ve.isArguments=Sr,ve.isArray=wr,ve.isArrayBuffer=pc,ve.isArrayLike=Li,ve.isArrayLikeObject=aa,ve.isBoolean=function(h){return h===!0||h===!1||hs(h)&&gi(h)==B},ve.isBuffer=wa,ve.isDate=Va,ve.isElement=function(h){return hs(h)&&h.nodeType===1&&!qi(h)},ve.isEmpty=function(h){if(h==null)return!0;if(Li(h)&&(wr(h)||typeof h=="string"||typeof h.splice=="function"||wa(h)||Ni(h)||Sr(h)))return!h.length;var b=Ho(h);if(b==q||b==ne)return!h.size;if(nm(h))return!Kc(h).length;for(var k in h)if(vr.call(h,k))return!1;return!0},ve.isEqual=function(h,b){return Ii(h,b)},ve.isEqualWith=function(h,b,k){var F=(k=typeof k=="function"?k:_)?k(h,b):_;return F===_?Ii(h,b,_,k):!!F},ve.isError=ys,ve.isFinite=function(h){return typeof h=="number"&&$l(h)},ve.isFunction=Ga,ve.isInteger=Il,ve.isLength=oa,ve.isMap=Ra,ve.isMatch=function(h,b){return h===b||Xc(h,b,rd(b))},ve.isMatchWith=function(h,b,k){return k=typeof k=="function"?k:_,Xc(h,b,rd(b),k)},ve.isNaN=function(h){return tu(h)&&h!=+h},ve.isNative=function(h){if(lg(h))throw new Zn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return po(h)},ve.isNil=function(h){return h==null},ve.isNull=function(h){return h===null},ve.isNumber=tu,ve.isObject=Hr,ve.isObjectLike=hs,ve.isPlainObject=qi,ve.isRegExp=$a,ve.isSafeInteger=function(h){return Il(h)&&h>=-9007199254740991&&h<=N},ve.isSet=of,ve.isString=Vs,ve.isSymbol=Ms,ve.isTypedArray=Ni,ve.isUndefined=function(h){return h===_},ve.isWeakMap=function(h){return hs(h)&&Ho(h)==de},ve.isWeakSet=function(h){return hs(h)&&gi(h)=="[object WeakSet]"},ve.join=function(h,b){return h==null?"":ig.call(h,b)},ve.kebabCase=Hd,ve.last=Ql,ve.lastIndexOf=function(h,b,k){var F=h==null?0:h.length;if(!F)return-1;var ie=F;return k!==_&&(ie=(ie=fr(k))<0?mi(F+ie,0):Xi(ie,F-1)),b==b?(function(pe,ye,Ae){for(var De=Ae+1;De--;)if(pe[De]===ye)return De;return De})(h,b,ie):Wc(h,xf,ie,!0)},ve.lowerCase=su,ve.lowerFirst=Gs,ve.lt=io,ve.lte=mc,ve.max=function(h){return h&&h.length?Wl(h,ds,Wh):_},ve.maxBy=function(h,b){return h&&h.length?Wl(h,dr(b,2),Wh):_},ve.mean=function(h){return sh(h,ds)},ve.meanBy=function(h,b){return sh(h,dr(b,2))},ve.min=function(h){return h&&h.length?Wl(h,ds,ph):_},ve.minBy=function(h,b){return h&&h.length?Wl(h,dr(b,2),ph):_},ve.stubArray=Du,ve.stubFalse=j,ve.stubObject=function(){return{}},ve.stubString=function(){return""},ve.stubTrue=function(){return!0},ve.multiply=ue,ve.nth=function(h,b){return h&&h.length?Xh(h,fr(b)):_},ve.noConflict=function(){return Jr._===this&&(Jr._=Gl),this},ve.noop=ui,ve.now=dc,ve.pad=function(h,b,k){h=rs(h);var F=(b=fr(b))?vs(h):0;if(!b||F>=b)return h;var ie=(b-F)/2;return Mu(Cd(ie),k)+h+Mu(Mc(ie),k)},ve.padEnd=function(h,b,k){h=rs(h);var F=(b=fr(b))?vs(h):0;return b&&F<b?h+Mu(b-F,k):h},ve.padStart=function(h,b,k){h=rs(h);var F=(b=fr(b))?vs(h):0;return b&&F<b?Mu(b-F,k)+h:h},ve.parseInt=function(h,b,k){return k||b==null?b=0:b&&(b=+b),hh(rs(h).replace(se,""),b||0)},ve.random=function(h,b,k){if(k&&typeof k!="boolean"&&La(h,b,k)&&(b=k=_),k===_&&(typeof b=="boolean"?(k=b,b=_):typeof h=="boolean"&&(k=h,h=_)),h===_&&b===_?(h=0,b=1):(h=mr(h),b===_?(b=h,h=0):b=mr(b)),h>b){var F=h;h=b,b=F}if(k||h%1||b%1){var ie=fp();return Xi(h+ie*(b-h+ls("1e-"+((ie+"").length-1))),b)}return Qu(h,b)},ve.reduce=function(h,b,k){var F=wr(h)?Ef:Wu,ie=arguments.length<3;return F(h,dr(b,4),k,ie,us)},ve.reduceRight=function(h,b,k){var F=wr(h)?Zm:Wu,ie=arguments.length<3;return F(h,dr(b,4),k,ie,uc)},ve.repeat=function(h,b,k){return b=(k?La(h,b,k):b===_)?1:fr(b),mh(rs(h),b)},ve.replace=function(){var h=arguments,b=rs(h[0]);return h.length<3?b:b.replace(h[1],h[2])},ve.result=function(h,b,k){var F=-1,ie=(b=Co(b,h)).length;for(ie||(ie=1,h=_);++F<ie;){var pe=h==null?_:h[pl(b[F])];pe===_&&(F=ie,pe=k),h=Ga(pe)?pe.call(h):pe}return h},ve.round=Ee,ve.runInContext=rt,ve.sample=function(h){return(wr(h)?Of:yr)(h)},ve.size=function(h){if(h==null)return 0;if(Li(h))return Vs(h)?vs(h):h.length;var b=Ho(h);return b==q||b==ne?h.size:Kc(h).length},ve.snakeCase=Oo,ve.some=function(h,b,k){var F=wr(h)?oc:Pa;return k&&La(h,b,k)&&(b=_),F(h,dr(b,3))},ve.sortedIndex=function(h,b){return Od(h,b)},ve.sortedIndexBy=function(h,b,k){return gp(h,b,dr(k,2))},ve.sortedIndexOf=function(h,b){var k=h==null?0:h.length;if(k){var F=Od(h,b);if(F<k&&sa(h[F],b))return F}return-1},ve.sortedLastIndex=function(h,b){return Od(h,b,!0)},ve.sortedLastIndexBy=function(h,b,k){return gp(h,b,dr(k,2),!0)},ve.sortedLastIndexOf=function(h,b){if(h!=null&&h.length){var k=Od(h,b,!0)-1;if(sa(h[k],b))return k}return-1},ve.startCase=cd,ve.startsWith=function(h,b,k){return h=rs(h),k=k==null?0:Al(fr(k),0,h.length),b=ja(b),h.slice(k,k+b.length)==b},ve.subtract=w,ve.sum=function(h){return h&&h.length?Tf(h,ds):0},ve.sumBy=function(h,b){return h&&h.length?Tf(h,dr(b,2)):0},ve.template=function(h,b,k){var F=ve.templateSettings;k&&La(h,b,k)&&(b=_),h=rs(h),b=ko({},b,F,no);var ie,pe,ye=ko({},b.imports,F.imports,no),Ae=Zr(ye),De=Ad(ye,Ae),Fe=0,Ye=b.interpolate||_t,dt="__p += '",Et=So((b.escape||_t).source+"|"+Ye.source+"|"+(Ye===ct?tt:_t).source+"|"+(b.evaluate||_t).source+"|$","g"),Pt="//# sourceURL="+(vr.call(b,"sourceURL")?(b.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Pr+"]")+`
`;h.replace(Et,(function(Ot,wt,It,Ft,Zt,Gt){return It||(It=Ft),dt+=h.slice(Fe,Gt).replace(gn,cp),wt&&(ie=!0,dt+=`' +
__e(`+wt+`) +
'`),Zt&&(pe=!0,dt+=`';
`+Zt+`;
__p += '`),It&&(dt+=`' +
((__t = (`+It+`)) == null ? '' : __t) +
'`),Fe=Gt+Ot.length,Ot})),dt+=`';
`;var bt=vr.call(b,"variable")&&b.variable;if(bt){if(st.test(bt))throw new Zn("Invalid `variable` option passed into `_.template`")}else dt=`with (obj) {
`+dt+`
}
`;dt=(pe?dt.replace(ze,""):dt).replace(Be,"$1").replace(me,"$1;"),dt="function("+(bt||"obj")+`) {
`+(bt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ie?", __e = _.escape":"")+(pe?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+dt+`return __p
}`;var gt=$o((function(){return Ri(Ae,Pt+"return "+dt).apply(_,De)}));if(gt.source=dt,ys(gt))throw gt;return gt},ve.times=function(h,b){if((h=fr(h))<1||h>N)return[];var k=D,F=Xi(h,D);b=dr(b),h-=D;for(var ie=oh(F,b);++k<h;)b(k);return ie},ve.toFinite=mr,ve.toInteger=fr,ve.toLength=Wn,ve.toLower=function(h){return rs(h).toLowerCase()},ve.toNumber=Wa,ve.toSafeInteger=function(h){return h?Al(fr(h),-9007199254740991,N):h===0?h:0},ve.toString=rs,ve.toUpper=function(h){return rs(h).toUpperCase()},ve.trim=function(h,b,k){if((h=rs(h))&&(k||b===_))return Bo(h);if(!h||!(b=ja(b)))return h;var F=Ta(h),ie=Ta(b);return nf(F,il(F,ie),Jm(F,ie)+1).join("")},ve.trimEnd=function(h,b,k){if((h=rs(h))&&(k||b===_))return h.slice(0,up(h)+1);if(!h||!(b=ja(b)))return h;var F=Ta(h);return nf(F,0,Jm(F,Ta(b))+1).join("")},ve.trimStart=function(h,b,k){if((h=rs(h))&&(k||b===_))return h.replace(se,"");if(!h||!(b=ja(b)))return h;var F=Ta(h);return nf(F,il(F,Ta(b))).join("")},ve.truncate=function(h,b){var k=30,F="...";if(Hr(b)){var ie="separator"in b?b.separator:ie;k="length"in b?fr(b.length):k,F="omission"in b?ja(b.omission):F}var pe=(h=rs(h)).length;if(jh(h)){var ye=Ta(h);pe=ye.length}if(k>=pe)return h;var Ae=k-vs(F);if(Ae<1)return F;var De=ye?nf(ye,0,Ae).join(""):h.slice(0,Ae);if(ie===_)return De+F;if(ye&&(Ae+=De.length-Ae),$a(ie)){if(h.slice(Ae).search(ie)){var Fe,Ye=De;for(ie.global||(ie=So(ie.source,rs(Ze.exec(ie))+"g")),ie.lastIndex=0;Fe=ie.exec(Ye);)var dt=Fe.index;De=De.slice(0,dt===_?Ae:dt)}}else if(h.indexOf(ja(ie),Ae)!=Ae){var Et=De.lastIndexOf(ie);Et>-1&&(De=De.slice(0,Et))}return De+F},ve.unescape=function(h){return(h=rs(h))&&be.test(h)?h.replace(Se,tg):h},ve.uniqueId=function(h){var b=++Vr;return rs(h)+b},ve.upperCase=_i,ve.upperFirst=ar,ve.each=Fd,ve.eachRight=gh,ve.first=Q0,cf(ve,(C={},Ks(ve,(function(h,b){vr.call(ve.prototype,b)||(C[b]=h)})),C),{chain:!1}),ve.VERSION="4.17.21",rl(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(h){ve[h].placeholder=ve})),rl(["drop","take"],(function(h,b){On.prototype[h]=function(k){k=k===_?1:mi(fr(k),0);var F=this.__filtered__&&!b?new On(this):this.clone();return F.__filtered__?F.__takeCount__=Xi(k,F.__takeCount__):F.__views__.push({size:Xi(k,D),type:h+(F.__dir__<0?"Right":"")}),F},On.prototype[h+"Right"]=function(k){return this.reverse()[h](k).reverse()}})),rl(["filter","map","takeWhile"],(function(h,b){var k=b+1,F=k==1||k==3;On.prototype[h]=function(ie){var pe=this.clone();return pe.__iteratees__.push({iteratee:dr(ie,3),type:k}),pe.__filtered__=pe.__filtered__||F,pe}})),rl(["head","last"],(function(h,b){var k="take"+(b?"Right":"");On.prototype[h]=function(){return this[k](1).value()[0]}})),rl(["initial","tail"],(function(h,b){var k="drop"+(b?"":"Right");On.prototype[h]=function(){return this.__filtered__?new On(this):this[k](1)}})),On.prototype.compact=function(){return this.filter(ds)},On.prototype.find=function(h){return this.filter(h).head()},On.prototype.findLast=function(h){return this.reverse().find(h)},On.prototype.invokeMap=Lr((function(h,b){return typeof h=="function"?new On(this):this.map((function(k){return al(k,h,b)}))})),On.prototype.reject=function(h){return this.filter(Vo(dr(h)))},On.prototype.slice=function(h,b){h=fr(h);var k=this;return k.__filtered__&&(h>0||b<0)?new On(k):(h<0?k=k.takeRight(-h):h&&(k=k.drop(h)),b!==_&&(k=(b=fr(b))<0?k.dropRight(-b):k.take(b-h)),k)},On.prototype.takeRightWhile=function(h){return this.reverse().takeWhile(h).reverse()},On.prototype.toArray=function(){return this.take(D)},Ks(On.prototype,(function(h,b){var k=/^(?:filter|find|map|reject)|While$/.test(b),F=/^(?:head|last)$/.test(b),ie=ve[F?"take"+(b=="last"?"Right":""):b],pe=F||/^find/.test(b);ie&&(ve.prototype[b]=function(){var ye=this.__wrapped__,Ae=F?[1]:arguments,De=ye instanceof On,Fe=Ae[0],Ye=De||wr(ye),dt=function(wt){var It=ie.apply(ve,Rc([wt],Ae));return F&&Et?It[0]:It};Ye&&k&&typeof Fe=="function"&&Fe.length!=1&&(De=Ye=!1);var Et=this.__chain__,Pt=!!this.__actions__.length,bt=pe&&!Et,gt=De&&!Pt;if(!pe&&Ye){ye=gt?ye:new On(this);var Ot=h.apply(ye,Ae);return Ot.__actions__.push({func:bp,args:[dt],thisArg:_}),new Ai(Ot,Et)}return bt&&gt?h.apply(this,Ae):(Ot=this.thru(dt),bt?F?Ot.value()[0]:Ot.value():Ot)})})),rl(["pop","push","shift","sort","splice","unshift"],(function(h){var b=Ac[h],k=/^(?:push|sort|unshift)$/.test(h)?"tap":"thru",F=/^(?:pop|shift)$/.test(h);ve.prototype[h]=function(){var ie=arguments;if(F&&!this.__chain__){var pe=this.value();return b.apply(wr(pe)?pe:[],ie)}return this[k]((function(ye){return b.apply(wr(ye)?ye:[],ie)}))}})),Ks(On.prototype,(function(h,b){var k=ve[b];if(k){var F=k.name+"";vr.call(Rs,F)||(Rs[F]=[]),Rs[F].push({name:b,func:k})}})),Rs[Kr(_,2).name]=[{name:"wrapper",func:_}],On.prototype.clone=function(){var h=new On(this.__wrapped__);return h.__actions__=kl(this.__actions__),h.__dir__=this.__dir__,h.__filtered__=this.__filtered__,h.__iteratees__=kl(this.__iteratees__),h.__takeCount__=this.__takeCount__,h.__views__=kl(this.__views__),h},On.prototype.reverse=function(){if(this.__filtered__){var h=new On(this);h.__dir__=-1,h.__filtered__=!0}else(h=this.clone()).__dir__*=-1;return h},On.prototype.value=function(){var h=this.__wrapped__.value(),b=this.__dir__,k=wr(h),F=b<0,ie=k?h.length:0,pe=(function(Gt,$t,dn){for(var Rn=-1,Nn=dn.length;++Rn<Nn;){var qn=dn[Rn],Dn=qn.size;switch(qn.type){case"drop":Gt+=Dn;break;case"dropRight":$t-=Dn;break;case"take":$t=Xi($t,Gt+Dn);break;case"takeRight":Gt=mi(Gt,$t-Dn)}}return{start:Gt,end:$t}})(0,ie,this.__views__),ye=pe.start,Ae=pe.end,De=Ae-ye,Fe=F?Ae:ye-1,Ye=this.__iteratees__,dt=Ye.length,Et=0,Pt=Xi(De,this.__takeCount__);if(!k||!F&&ie==De&&Pt==De)return eo(h,this.__actions__);var bt=[];e:for(;De--&&Et<Pt;){for(var gt=-1,Ot=h[Fe+=b];++gt<dt;){var wt=Ye[gt],It=wt.iteratee,Ft=wt.type,Zt=It(Ot);if(Ft==2)Ot=Zt;else if(!Zt){if(Ft==1)continue e;break e}}bt[Et++]=Ot}return bt},ve.prototype.at=t_,ve.prototype.chain=function(){return sd(this)},ve.prototype.commit=function(){return new Ai(this.value(),this.__chain__)},ve.prototype.next=function(){this.__values__===_&&(this.__values__=Nl(this.value()));var h=this.__index__>=this.__values__.length;return{done:h,value:h?_:this.__values__[this.__index__++]}},ve.prototype.plant=function(h){for(var b,k=this;k instanceof Ja;){var F=om(k);F.__index__=0,F.__values__=_,b?ie.__wrapped__=F:b=F;var ie=F;k=k.__wrapped__}return ie.__wrapped__=h,b},ve.prototype.reverse=function(){var h=this.__wrapped__;if(h instanceof On){var b=h;return this.__actions__.length&&(b=new On(this)),(b=b.reverse()).__actions__.push({func:bp,args:[s0],thisArg:_}),new Ai(b,this.__chain__)}return this.thru(s0)},ve.prototype.toJSON=ve.prototype.valueOf=ve.prototype.value=function(){return eo(this.__wrapped__,this.__actions__)},ve.prototype.first=ve.prototype.head,Yc&&(ve.prototype[Yc]=function(){return this}),ve})();Jr._=qh,(p=(function(){return qh}).call(d,g,d,f))===_||(f.exports=p)}).call(this)},815:function(f,d){var g,p,_=this&&this.__extends||(g=function(W,q){return g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Y,ae){Y.__proto__=ae}||function(Y,ae){for(var Z in ae)Object.prototype.hasOwnProperty.call(ae,Z)&&(Y[Z]=ae[Z])},g(W,q)},function(W,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");function Y(){this.constructor=W}g(W,q),W.prototype=q===null?Object.create(q):(Y.prototype=q.prototype,new Y)});function y(W){return 60*W*60}function v(W,q){var Y={};return Object.assign(Y,W),q&&Object.assign(Y,q),Y}Object.defineProperty(d,"__esModule",{value:!0}),d.DeviceConfigPropertyHolder=d.DeviceConfigManager=d.DeviceConfigEnv=void 0,(function(W){W.BETA="beta",W.PROD="prod",W.CUSTOM="custom"})(p||(d.DeviceConfigEnv=p={}));var x=(function(W){function q(Y){return W.call(this,Y)||this}return _(q,W),q})(Error),E="data",M=y(2),O="base64",N=(function(){function W(q,Y){var ae,Z,K,ne,le,ce,de,Me;if(!Y.fileKey)throw new Error("options.fileKey cannot be empty");var qe=(ae=Y.clock)!==null&&ae!==void 0?ae:new $,Pe=qe.getMillis();switch(this.context=q,this.fileKey=Y.fileKey,this.env=Y.standardEnv,Y.standardEnv){case p.BETA:this.fetchServer="beta.ivs-device-config-beta.live-video.net";break;case p.PROD:this.fetchServer="prod.ivs-device-config.live-video.net";break;case p.CUSTOM:if(!Y.customServer)throw new Error("Custom env requires options.customServer");this.fetchServer=Y.customServer;break;default:throw new Error("Invalid value for standardEnv: ".concat(Y.standardEnv))}this.trace=(Z=Y.trace)!==null&&Z!==void 0?Z:new G(Y.enableConsoleLog),this.fetch=(K=Y.fetch)!==null&&K!==void 0?K:new V(q),this.storage=new B("amazon_ivs_device_config_v1_"+Y.fileKey,q.localStorage),this.state=new J(this.storage,"state"),this.refresh={refreshIntervalSeconds:(ne=Y.refresh.refreshIntervalSeconds)!==null&&ne!==void 0?ne:900,retryCount:(le=Y.refresh.retryCount)!==null&&le!==void 0?le:3,retryIntervalSeconds:(ce=Y.refresh.retryIntervalSeconds)!==null&&ce!==void 0?ce:10,maxCacheAgeSeconds:(de=Y.refresh.maxCacheAgeSeconds)!==null&&de!==void 0?de:259200,stopRefreshAfterSeconds:(Me=Y.refresh.stopRefreshAfterSeconds)!==null&&Me!==void 0?Me:M,canRefreshNow:Y.refresh.canRefreshNow},this.emitMetrics=Y.emitMetrics,this.analyticsProperties=Y.analyticsProperties,this.enableConsoleLog=Y.enableConsoleLog,this.clock=qe,this.isInitialRefreshDone=!1;var Ce=0,Xe=this.state.getState();Xe&&Xe.fetchServer===this.fetchServer&&Xe.lastFetchWhenMs&&(Ce=Xe.lastFetchWhenMs);var $e,at=qe.getMillis(),pt=(at-Ce)/1e3;if(pt<=this.refresh.maxCacheAgeSeconds){var oe=this.storage.getJson(E);oe&&oe.fetchServer===this.fetchServer&&this.setData(oe.json)}this.lastUseMs=at,pt>=this.refresh.refreshIntervalSeconds||Ce==0?$e=0:($e=Math.round(this.refresh.refreshIntervalSeconds-pt),this.isInitialRefreshDone=!0),$e<5&&($e=5),this.trace.onTrace("Will start refresh in "+$e+" seconds"),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*$e);var Ue=qe.getMillis();this.initialLoadTime=Ue-Pe}return W.getInstance=function(q,Y){try{if(!(q.fetch&&q.setTimeout&&q.clearTimeout&&q.localStorage))return void console.log("Context needs to provide fetch, setTimeout, clearTimeout, localStorage")}catch(ae){return void console.error("Error checking for context properties "+ae)}if(this.gInstance){if(this.gInstance.fileKey!=Y.fileKey)throw new Error("Existing instance has file key ".concat(this.gInstance.fileKey,", now asking for ").concat(Y.fileKey));return this.gInstance}return this.gInstance=new W(q,Y),this.gInstance},W.prototype.getConfigurationHolder=function(q){var Y,ae=this.clock.getMillis();this.lastUseMs=ae;var Z=(Y=q.analytics)!==null&&Y!==void 0?Y:new Q(this.enableConsoleLog),K=0,ne=this.state.getState();return ne&&ne.fetchServer===this.fetchServer&&ne.lastFetchWhenMs&&(K=ne.lastFetchWhenMs),(ae-K)/1e3<=this.refresh.maxCacheAgeSeconds?new I(Z,this.analyticsProperties,this.properties,K,this.clock):new I(Z,void 0,void 0,0,this.clock)},W.prototype.getFetchUrl=function(){var q="https://".concat(this.fetchServer,"/").concat(this.fileKey,".json"),Y=new URL(q);return Y.searchParams.set("version","1.0"),Y},W.clearInstance=function(){var q;(q=this.gInstance)===null||q===void 0||q.clearInstanceImpl(),this.gInstance=void 0},W.prototype.clearInstanceImpl=function(){this.context.clearTimeout(this.fetchTask),this.fetchTask=void 0,this.context.clearTimeout(this.retryTask),this.retryTask=void 0},W.prototype.startRefresh=function(){var q=this;this.trace.onTrace("Starting refresh request"),this.fetchTask=void 0,this.retryTask&&(this.context.clearTimeout(this.retryTask),this.retryTask=void 0),this.fetchTask=this.context.setTimeout(this.startRefresh.bind(this),1e3*this.refresh.refreshIntervalSeconds);var Y=this.clock.getMillis();if((Y-this.lastUseMs)/1e3>this.refresh.stopRefreshAfterSeconds)this.trace.onTrace("Will not refresh due to refresh timeout");else if(!this.isInitialRefreshDone||this.refresh.canRefreshNow()){this.isInitialRefreshDone=!0;var ae={};this.fetchData().then((function(Z){q.processResponse(Z,ae,Y),q.emitMetricsImpl(ae)})).catch((function(Z){q.exceptionMetrics(ae,Z),q.emitMetricsImpl(ae),q.trace.onTrace("Fetch error: "+Z),q.refresh.retryCount>0&&q.scheduleRetry(1)}))}else this.trace.onTrace("Will not refresh due to callback having returned false")},W.prototype.fetchData=function(){var q=this.getFetchUrl(),Y=new Headers,ae=this.state.getState();return ae.fetchServer===this.fetchServer&&(ae.lastFetchWhenFullMs&&this.clock.getMillis()-ae.lastFetchWhenFullMs>1e3*y(24)?this.trace.onTrace("Forcing full refresh"):this.properties&&ae.lastFetchEtagHeader&&Y.set("If-None-Match",ae.lastFetchEtagHeader)),this.fetch.fetchUrl(q,Y)},W.prototype.processResponse=function(q,Y,ae){var Z={fetchServer:this.fetchServer,lastFetchWhenMs:this.clock.getMillis()},K=q.headers.get("etag");if(K&&(Z.lastFetchEtagHeader=K),q.status<300&&q.json)if(this.setData(q.json)){this.trace.onTrace("Successfully parsed fetched data"),this.storage.setJson(E,{fetchServer:this.fetchServer,json:q.json});var ne=this.clock.getMillis();Z.lastFetchWhenFullMs=ne,this.state.setState(Z),Y.success_new_data_count=1,Y.fetch_duration_average=Math.max(0,ne-ae)}else Y.fail_invalid_data_count=1;else{if(q.status!==304){var le="Unexpected http fetch status: "+q.status;throw this.trace.onTrace(le),new x(le)}this.trace.onTrace("Server said no change in data"),ne=this.clock.getMillis(),Z.lastFetchWhenMs=ne,this.state.setState(Z),Y.success_no_change_count=1,Y.fetch_duration_average=Math.max(0,ne-ae)}},W.prototype.scheduleRetry=function(q){var Y=this;this.retryTask&&this.context.clearTimeout(this.retryTask);var ae=q*this.refresh.retryIntervalSeconds;this.retryTask=this.context.setTimeout((function(){Y.retryTask=void 0,Y.fetchRetry(q)}),1e3*ae)},W.prototype.fetchRetry=function(q){var Y=this;this.trace.onTrace("Starting retry request ".concat(q,"..."));var ae={},Z=this.clock.getMillis();this.fetchData().then((function(K){Y.processResponse(K,ae,Z),Y.emitMetricsImpl(ae)})).catch((function(K){Y.exceptionMetrics(ae,K),Y.emitMetricsImpl(ae),Y.trace.onTrace("Fetch error: "+K),Y.refresh.retryCount>q&&Y.scheduleRetry(q+1)}))},W.prototype.setData=function(q){if(!q)return!1;if(q.version!=="1.0")return this.trace.onTrace("Data version is not 1.0, not applying"),!1;var Y=q.properties;if(!Y||!Array.isArray(Y))return this.trace.onTrace("Data properties is not an array, not applying"),!1;for(var ae=new Map,Z=0,K=Y;Z<K.length;Z++){var ne=K[Z];if(ne.name&&ne.type&&this.isValidValueType(ne.type)){if(ne.value_string&&typeof ne.value_string!="string"){this.trace.onTrace("Invalid type of value.value_string "+typeof ne.value_string);continue}if(ne.value_number&&typeof ne.value_number!="number"){this.trace.onTrace("Invalid type of value.value_number "+typeof ne.value_number);continue}if(ne.value_boolean&&typeof ne.value_boolean!="boolean"){this.trace.onTrace("Invalid type of value.value_boolean "+typeof ne.value_boolean);continue}if(ne.value_json&&typeof ne.value_json!="string"){this.trace.onTrace("Invalid type of value.value_json "+typeof ne.value_json);continue}if(ne.value_analytics&&typeof ne.value_analytics!="string"){this.trace.onTrace("Invalid type of item.value_analytics "+typeof ne.value_analytics);continue}var le=new U(ne.name,this.parseValueType(ne.type),ne.value_string,ne.value_number,ne.value_boolean,ne.value_json,ne.value_analytics,ne.encoding);ae.set(le.name,le)}}return ae.size!=0&&(this.properties=ae,!0)},W.prototype.isValidValueType=function(q){return q==="string"||q==="number"||q==="boolean"||q=="json"},W.prototype.parseValueType=function(q){switch(q){case"string":return D.STRING;case"number":return D.NUMBER;case"boolean":return D.BOOLEAN;case"json":return D.JSON;default:throw new Error("Unsupported value type ".concat(q))}},W.prototype.emitMetricsImpl=function(q){var Y,ae,Z,K,ne,le,ce={initial_load_time:this.initialLoadTime,fetch_attempt_count:1,fetch_duration_average:(Y=q.fetch_duration_average)!==null&&Y!==void 0?Y:0,success_no_change_count:(ae=q.success_no_change_count)!==null&&ae!==void 0?ae:0,success_new_data_count:(Z=q.success_new_data_count)!==null&&Z!==void 0?Z:0,fail_exception_count:(K=q.fail_exception_count)!==null&&K!==void 0?K:0,fail_http_error_count:(ne=q.fail_http_error_count)!==null&&ne!==void 0?ne:0,fail_invalid_data_count:(le=q.fail_invalid_data_count)!==null&&le!==void 0?le:0};this.emitMetrics(v(ce,this.analyticsProperties))},W.prototype.exceptionMetrics=function(q,Y){var ae;Y instanceof x||!((ae=Y?.message)===null||ae===void 0)&&ae.startsWith("http error")?q.fail_http_error_count=1:q.fail_exception_count=1},W})();d.DeviceConfigManager=N;var I=(function(){function W(q,Y,ae,Z,K){this.analytics=q,this.analyticsProperties=Y,this.properties=ae,this.dataFetchedWhenMs=Z,this.clock=K}return W.prototype.getSize=function(){return this.properties?this.properties.size:-1},W.prototype.getStringValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.STRING){var K=(Y=Z.valueString)!==null&&Y!==void 0?Y:"";return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not string"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getNumberValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.NUMBER){var K=(Y=Z.valueNumber)!==null&&Y!==void 0?Y:0;return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getBooleanValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.BOOLEAN){var K=(Y=Z.valueBoolean)!==null&&Y!==void 0&&Y;return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:K.toString(),fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),K}this.analytics.onError(v({key_name:Z.name,message:"Type is not number"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getJsonValue=function(q){var Y,ae;if(this.properties){var Z=this.properties.get(q);if(Z){if(Z.type===D.JSON){var K=Z.valueJson;if(!K)return this.analytics.onValue(v({key_name:Z.name,value:(Y=Z.valueAnalytics)!==null&&Y!==void 0?Y:"",fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),null;try{var ne=JSON.parse(K);return this.analytics.onValue(v({key_name:Z.name,value:(ae=Z.valueAnalytics)!==null&&ae!==void 0?ae:ne,fetched_seconds_ago:this.getFetchedSecondsAgo()},this.analyticsProperties)),ne}catch{return void this.analytics.onError(v({key_name:Z.name,message:"JSON parse error"},this.analyticsProperties))}}this.analytics.onError(v({key_name:Z.name,message:"Type is not JSON"},this.analyticsProperties))}}else this.analytics.onTrace(v({key_name:q,message:"Configuration is not available"},this.analyticsProperties))},W.prototype.getFetchedSecondsAgo=function(){if(this.dataFetchedWhenMs)return(this.clock.getMillis()-this.dataFetchedWhenMs)/1e3},W})();d.DeviceConfigPropertyHolder=I;var D,V=(function(){function W(q){this.context=q}return W.prototype.fetchUrl=function(q,Y){var ae=this,Z={headers:Y,cache:"no-store"},K=null;if(typeof AbortController<"u"){var ne=new AbortController;K=this.context.setTimeout((function(){return ne.abort()}),15e3),Z.signal=ne.signal}return new Promise((function(le,ce){ae.context.fetch(q,Z).then((function(de){if(de.status>=400)ce(new x("http error ".concat(de.status,", ").concat(de.statusText)));else{var Me={status:de.status,headers:de.headers};de.json().then((function(qe){Me.json=qe,le(Me)})).catch((function(){le(Me)}))}})).catch((function(de){ce(de)})).finally((function(){K&&ae.context.clearTimeout(K)}))}))},W})(),G=(function(){function W(q){this.enableConsoleLog=q}return W.prototype.onTrace=function(q){this.enableConsoleLog&&console.log("DeviceConfig trace: "+q)},W})(),Q=(function(){function W(q){this.enableConsoleLog=q}return W.prototype.onValue=function(q){this.enableConsoleLog&&console.log("DeviceConfig analytics value:  ".concat(q))},W.prototype.onError=function(q){this.enableConsoleLog&&console.error("DeviceConfig analytics error: ".concat(q))},W.prototype.onTrace=function(q){this.enableConsoleLog&&console.log("DeviceConfig analytics trace: ".concat(q))},W})(),B=(function(){function W(q,Y){this.prefix=q,this.storage=Y}return W.prototype.getJson=function(q){var Y=this.prefix+"_"+q;try{var ae=this.storage.getItem(Y);if(ae)return JSON.parse(ae)}catch(Z){console.error("Error getting local storage key ".concat(Y)+Z)}return null},W.prototype.setJson=function(q,Y){var ae=this.prefix+"_"+q;try{this.storage.setItem(ae,JSON.stringify(Y))}catch(Z){console.error("Error setting local storage key ".concat(ae,": ")+Z)}},W})(),$=(function(){function W(){}return W.prototype.getMillis=function(){return Date.now()},W})();(function(W){W[W.STRING=0]="STRING",W[W.NUMBER=1]="NUMBER",W[W.BOOLEAN=2]="BOOLEAN",W[W.JSON=3]="JSON"})(D||(D={}));var U=function(W,q,Y,ae,Z,K,ne,le){switch(this.name=W,this.type=q,this.valueString=Y,this.valueNumber=ae,this.valueBoolean=Z,this.valueJson=K,this.valueAnalytics=ne,this.type){case D.STRING:le===O&&Y&&(this.valueString=atob(Y));break;case D.JSON:le===O&&K&&(this.valueJson=atob(K))}},J=(function(){function W(q,Y){var ae;this.storage=q,this.key=Y,this.state=(ae=q.getJson(Y))!==null&&ae!==void 0?ae:{}}return W.prototype.getState=function(){return this.state},W.prototype.setState=function(q){Object.assign(this.state,q),this.storage.setJson(this.key,this.state)},W})()},456:function(f,d,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(d,"__esModule",{value:!0}),_(g(903),d)},903:function(f,d,g){var p=this&&this.__spreadArray||function(v,x,E){if(E||arguments.length===2)for(var M,O=0,N=x.length;O<N;O++)!M&&O in x||(M||(M=Array.prototype.slice.call(x,0,O)),M[O]=x[O]);return v.concat(M||Array.prototype.slice.call(x))};Object.defineProperty(d,"__esModule",{value:!0}),d.TypedEmitter=void 0;var _=g(228),y=(function(){function v(x){var E=x.propagateErrors;this.emitter=new _.EventEmitter,this.propagateErrors=E!=null&&E}return v.prototype.on=function(x,E){E.call=this.wrapCall(x,E),this.emitter.on(x,E)},v.prototype.off=function(x,E){this.emitter.off(x,E)},v.prototype.emit=function(x){for(var E,M=[],O=1;O<arguments.length;O++)M[O-1]=arguments[O];(E=this.emitter).emit.apply(E,p([x],M,!1))},v.prototype.removeAllListeners=function(){this.emitter.removeAllListeners()},v.prototype.wrapCall=function(x,E){var M=this;return function(O){for(var N=[],I=1;I<arguments.length;I++)N[I-1]=arguments[I];if(M.propagateErrors)E.apply(O,N);else try{E.apply(O,N)}catch(G){var D="Error in callback for ".concat(x),V=E.name;return V&&(D+=" for function ".concat(V)),void console.error(D,G)}}},v})();d.TypedEmitter=y},987:function(f,d,g){var p,_=this&&this.__extends||(p=function(N,I){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(D,V){D.__proto__=V}||function(D,V){for(var G in V)Object.prototype.hasOwnProperty.call(V,G)&&(D[G]=V[G])},p(N,I)},function(N,I){if(typeof I!="function"&&I!==null)throw new TypeError("Class extends value "+String(I)+" is not a constructor or null");function D(){this.constructor=N}p(N,I),N.prototype=I===null?Object.create(I):(D.prototype=I.prototype,new D)}),y=this&&this.__createBinding||(Object.create?function(N,I,D,V){V===void 0&&(V=D);var G=Object.getOwnPropertyDescriptor(I,D);G&&!("get"in G?!I.__esModule:G.writable||G.configurable)||(G={enumerable:!0,get:function(){return I[D]}}),Object.defineProperty(N,V,G)}:function(N,I,D,V){V===void 0&&(V=D),N[V]=I[D]}),v=this&&this.__setModuleDefault||(Object.create?function(N,I){Object.defineProperty(N,"default",{enumerable:!0,value:I})}:function(N,I){N.default=I}),x=this&&this.__importStar||function(N){if(N&&N.__esModule)return N;var I={};if(N!=null)for(var D in N)D!=="default"&&Object.prototype.hasOwnProperty.call(N,D)&&y(I,N,D);return v(I,N),I};Object.defineProperty(d,"__esModule",{value:!0}),d.createFsm=d.FsmWildcardState=d.RejectedTransitionError=d.InvalidStateTransitionError=void 0;var E=x(g(293)),M=(function(N){function I(D,V){var G=N.call(this,"Invalid transition from '".concat(V,"' via event '").concat(D,"'"))||this;return G.name="InvalidStateTransitionError",G}return _(I,N),I})(Error);d.InvalidStateTransitionError=M;var O=(function(N){function I(D,V,G){var Q=N.call(this,"Transition from '".concat(V,"' via event '").concat(D,"' was rejected for: ").concat(G))||this;return Q.name="RejectedTransitionError",Q}return _(I,N),I})(Error);d.RejectedTransitionError=O,d.FsmWildcardState="*",d.createFsm=function(N){var I,D=N.transitions,V=N.callbacks,G=N.initialState,Q=function(B){var $,U=($=D[B])===null||$===void 0?void 0:$.from;return!!U&&(typeof U=="string"?U===d.FsmWildcardState:U.includes(G))};return{canTransition:Q,transition:function(B,$){var U,J,W,q,Y,ae;if(!Q(B))return E.err(new M(String(G),String(B)));var Z=D[B];return Z.shouldTransition===void 0||Z.shouldTransition(G)?((J=(U=V?.[G])===null||U===void 0?void 0:U.onExiting)===null||J===void 0||J.call(U),(W=V?.onStateExiting)===null||W===void 0||W.call(V,G),I=G,G=Z.to,(Y=(q=V?.[G])===null||q===void 0?void 0:q.onChanged)===null||Y===void 0||Y.call(q,I,$),(ae=V?.onStateChanged)===null||ae===void 0||ae.call(V,I,G,$),E.ok(G)):E.err(new O(String(G),String(B),"shouldTransition returned false"))},previousState:function(){return I},currentState:function(){return G}}}},156:function(f,d,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(d,"__esModule",{value:!0}),d.VERSION=void 0,d.VERSION="0.5.0",_(g(815),d),_(g(456),d),_(g(987),d),_(g(293),d),_(g(925),d)},925:function(f,d,g){var p=this&&this.__createBinding||(Object.create?function(y,v,x,E){E===void 0&&(E=x);var M=Object.getOwnPropertyDescriptor(v,x);M&&!("get"in M?!v.__esModule:M.writable||M.configurable)||(M={enumerable:!0,get:function(){return v[x]}}),Object.defineProperty(y,E,M)}:function(y,v,x,E){E===void 0&&(E=x),y[E]=v[x]}),_=this&&this.__exportStar||function(y,v){for(var x in y)x==="default"||Object.prototype.hasOwnProperty.call(v,x)||p(v,y,x)};Object.defineProperty(d,"__esModule",{value:!0}),_(g(166),d),_(g(612),d),_(g(56),d),_(g(139),d),_(g(877),d)},166:function(f,d,g){var p=this&&this.__assign||function(){return p=Object.assign||function(N){for(var I,D=1,V=arguments.length;D<V;D++)for(var G in I=arguments[D])Object.prototype.hasOwnProperty.call(I,G)&&(N[G]=I[G]);return N},p.apply(this,arguments)},_=this&&this.__spreadArray||function(N,I,D){if(D||arguments.length===2)for(var V,G=0,Q=I.length;G<Q;G++)!V&&G in I||(V||(V=Array.prototype.slice.call(I,0,G)),V[G]=I[G]);return N.concat(V||Array.prototype.slice.call(I))};Object.defineProperty(d,"__esModule",{value:!0}),d.getLogConfig=d.setLogConfig=d.setLogConfigByLevel=d.extractLogConfig=void 0;var y=g(612),v=g(56),x=g(139),E=g(478),M={enabled:!1,levels:{debug:!0,log:!0,info:!0,warn:!0,error:!0},targets:[(0,v.createConsoleLogTarget)()],categories:{}},O=Object.keys(M);d.extractLogConfig=function(N){var I={};if(Object.keys(N).some((function(B){return O.includes(B)}))){for(var D=0,V=O;D<V.length;D++){var G=V[D];if(N[G]!==void 0){var Q=N[G];I[G]=Q}}return I}},d.setLogConfigByLevel=function(N){var I=N.enabled||M.enabled,D=N.targets||M.targets,V={debug:!1,log:!1,info:!1,warn:!1,error:!1},G=function(Q,B){for(var $=0,U=Q;$<U.length;$++){var J=U[$];V[J]=B}};switch(N.level){case"debug":G(["debug","log","info","warn","error"],I);break;case"log":G(["log","info","warn","error"],I);break;case"info":G(["info","warn","error"],!0);break;case"warn":G(["warn","error"],!0);break;case"error":G(["error"],!0)}(0,d.setLogConfig)({enabled:I,levels:V,targets:D})},d.setLogConfig=function(N){var I=(0,E.mergeConfigs)(M,N);I&&(M=I,y.defaultLogEmitter.emit(x.LogEventType.CONFIG_UPDATED,M))},d.getLogConfig=function(){return{enabled:M.enabled,levels:p({},M.levels),targets:_([],M.targets,!0),categories:p({},M.categories)}}},612:(f,d,g)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.defaultLogEmitter=void 0;var p=g(456);d.defaultLogEmitter=new p.TypedEmitter({})},56:function(f,d,g){var p=this&&this.__spreadArray||function(y,v,x){if(x||arguments.length===2)for(var E,M=0,O=v.length;M<O;M++)!E&&M in v||(E||(E=Array.prototype.slice.call(v,0,M)),E[M]=v[M]);return y.concat(E||Array.prototype.slice.call(v))};Object.defineProperty(d,"__esModule",{value:!0}),d.createEventLogTarget=d.createConsoleLogTarget=void 0;var _=g(139);d.createConsoleLogTarget=function(){return{handleMessage:function(y){for(var v=[],x=1;x<arguments.length;x++)v[x-1]=arguments[x];console[y].apply(console,v)}}},d.createEventLogTarget=function(y){return{handleMessage:function(v){for(var x=[],E=1;E<arguments.length;E++)x[E-1]=arguments[E];y.emit.apply(y,p([_.LogEventType.MESSAGE_LOGGED,v],x,!1))}}}},139:(f,d)=>{var g;Object.defineProperty(d,"__esModule",{value:!0}),d.LogEventType=void 0,(function(p){p.CONFIG_UPDATED="logConfigUpdated",p.MESSAGE_LOGGED="messageLogged"})(g||(d.LogEventType=g={}))},877:function(f,d,g){var p=this&&this.__assign||function(){return p=Object.assign||function(O){for(var N,I=1,D=arguments.length;I<D;I++)for(var V in N=arguments[I])Object.prototype.hasOwnProperty.call(N,V)&&(O[V]=N[V]);return O},p.apply(this,arguments)},_=this&&this.__spreadArray||function(O,N,I){if(I||arguments.length===2)for(var D,V=0,G=N.length;V<G;V++)!D&&V in N||(D||(D=Array.prototype.slice.call(N,0,V)),D[V]=N[V]);return O.concat(D||Array.prototype.slice.call(N))};Object.defineProperty(d,"__esModule",{value:!0}),d.createLogger=void 0;var y=g(478),v=g(166),x=g(612),E=g(139),M=function(O,N){return(0,y.mergeConfigs)(O,N)||O};d.createLogger=function(O){var N=O.name,I=O.category,D=O.parent,V=(0,v.extractLogConfig)(O)||{},G=M((0,v.getLogConfig)(),V);x.defaultLogEmitter.on(E.LogEventType.CONFIG_UPDATED,(function(J){G=M(J,V||{})}));var Q=function(J){for(var W=[],q=1;q<arguments.length;q++)W[q-1]=arguments[q];if(D&&!D.canLog(J)||!$(J))return!1;for(var Y=B(),ae=new Date().toTimeString().split(" ")[0],Z=_(["".concat(ae," - (").concat(Y,")")],W,!0),K=0,ne=G.targets;K<ne.length;K++){var le=ne[K];le.handleMessage.apply(le,_([J],Z,!1))}return!0},B=function(){return D?"".concat(D.getName()," | ").concat(N):N},$=function(J){return!(!G.enabled||!G.levels[J]||G.targets.length===0||I!==void 0&&!G.categories[I])},U={debug:function(){for(var J=[],W=0;W<arguments.length;W++)J[W]=arguments[W];return Q.apply(void 0,_(["debug"],J,!1))},log:function(){for(var J=[],W=0;W<arguments.length;W++)J[W]=arguments[W];return Q.apply(void 0,_(["log"],J,!1))},info:function(){for(var J=[],W=0;W<arguments.length;W++)J[W]=arguments[W];return Q.apply(void 0,_(["info"],J,!1))},warn:function(){for(var J=[],W=0;W<arguments.length;W++)J[W]=arguments[W];return Q.apply(void 0,_(["warn"],J,!1))},error:function(){for(var J=[],W=0;W<arguments.length;W++)J[W]=arguments[W];return Q.apply(void 0,_(["error"],J,!1))},getName:B,canLog:$,getChildLogger:function(J){return(0,d.createLogger)(p(p({},J),{parent:U}))},setConfig:function(J){G=M(G,V=J)}};return U}},478:function(f,d,g){var p=this&&this.__spreadArray||function(v,x,E){if(E||arguments.length===2)for(var M,O=0,N=x.length;O<N;O++)!M&&O in x||(M||(M=Array.prototype.slice.call(x,0,O)),M[O]=x[O]);return v.concat(M||Array.prototype.slice.call(x))};Object.defineProperty(d,"__esModule",{value:!0}),d.mergeConfigs=void 0;var _=g(543),y=function(v,x){if((0,_.isArray)(v))return x};d.mergeConfigs=function(v){for(var x=[],E=1;E<arguments.length;E++)x[E-1]=arguments[E];var M=x.map((function(O){return O==null||typeof O!="object"})).filter(Boolean).length>0;if(typeof v=="object"&&!M)return _.mergeWith.apply(void 0,p(p([{},v],x,!1),[y],!1))}},293:(f,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.getErr=d.getOk_or=d.getOk=d.isNotOk=d.isOk=d.err=d.ok=void 0,d.ok=function(g){return{ok:!0,value:g}},d.err=function(g){return{ok:!1,error:g}},d.isOk=function(g){return g.ok===!0},d.isNotOk=function(g){return!(0,d.isOk)(g)},d.getOk=function(g){return g.ok===!0?g.value:void 0},d.getOk_or=function(g,p){return g.ok===!0?g.value:p},d.getErr=function(g){return g.ok===!0?void 0:g.error}}},c={};function u(f){var d=c[f];if(d!==void 0)return d.exports;var g=c[f]={id:f,loaded:!1,exports:{}};return l[f].call(g.exports,g,g.exports,u),g.loaded=!0,g.exports}return u.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),u.nmd=f=>(f.paths=[],f.children||(f.children=[]),f),u(156)})(),a.exports=o()},1549:(a,o,l)=>{var c=l(2032),u=l(3862),f=l(6721),d=l(2749),g=l(5749);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=d,p.prototype.set=g,a.exports=p},79:(a,o,l)=>{var c=l(3702),u=l(80),f=l(4739),d=l(8655),g=l(1175);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=d,p.prototype.set=g,a.exports=p},8223:(a,o,l)=>{var c=l(6110)(l(9325),"Map");a.exports=c},3661:(a,o,l)=>{var c=l(3040),u=l(7670),f=l(289),d=l(4509),g=l(2949);function p(_){var y=-1,v=_==null?0:_.length;for(this.clear();++y<v;){var x=_[y];this.set(x[0],x[1])}}p.prototype.clear=c,p.prototype.delete=u,p.prototype.get=f,p.prototype.has=d,p.prototype.set=g,a.exports=p},7217:(a,o,l)=>{var c=l(79),u=l(1420),f=l(938),d=l(3605),g=l(9817),p=l(945);function _(y){var v=this.__data__=new c(y);this.size=v.size}_.prototype.clear=u,_.prototype.delete=f,_.prototype.get=d,_.prototype.has=g,_.prototype.set=p,a.exports=_},1873:(a,o,l)=>{var c=l(9325).Symbol;a.exports=c},7828:(a,o,l)=>{var c=l(9325).Uint8Array;a.exports=c},1033:a=>{a.exports=function(o,l,c){switch(c.length){case 0:return o.call(l);case 1:return o.call(l,c[0]);case 2:return o.call(l,c[0],c[1]);case 3:return o.call(l,c[0],c[1],c[2])}return o.apply(l,c)}},695:(a,o,l)=>{var c=l(8096),u=l(2428),f=l(6449),d=l(3656),g=l(361),p=l(7167),_=Object.prototype.hasOwnProperty;a.exports=function(y,v){var x=f(y),E=!x&&u(y),M=!x&&!E&&d(y),O=!x&&!E&&!M&&p(y),N=x||E||M||O,I=N?c(y.length,String):[],D=I.length;for(var V in y)!v&&!_.call(y,V)||N&&(V=="length"||M&&(V=="offset"||V=="parent")||O&&(V=="buffer"||V=="byteLength"||V=="byteOffset")||g(V,D))||I.push(V);return I}},7805:(a,o,l)=>{var c=l(3360),u=l(5288);a.exports=function(f,d,g){(g!==void 0&&!u(f[d],g)||g===void 0&&!(d in f))&&c(f,d,g)}},6547:(a,o,l)=>{var c=l(3360),u=l(5288),f=Object.prototype.hasOwnProperty;a.exports=function(d,g,p){var _=d[g];f.call(d,g)&&u(_,p)&&(p!==void 0||g in d)||c(d,g,p)}},6025:(a,o,l)=>{var c=l(5288);a.exports=function(u,f){for(var d=u.length;d--;)if(c(u[d][0],f))return d;return-1}},3360:(a,o,l)=>{var c=l(3243);a.exports=function(u,f,d){f=="__proto__"&&c?c(u,f,{configurable:!0,enumerable:!0,value:d,writable:!0}):u[f]=d}},9344:(a,o,l)=>{var c=l(3805),u=Object.create,f=(function(){function d(){}return function(g){if(!c(g))return{};if(u)return u(g);d.prototype=g;var p=new d;return d.prototype=void 0,p}})();a.exports=f},6649:(a,o,l)=>{var c=l(3221)();a.exports=c},2552:(a,o,l)=>{var c=l(1873),u=l(659),f=l(9350),d=c?c.toStringTag:void 0;a.exports=function(g){return g==null?g===void 0?"[object Undefined]":"[object Null]":d&&d in Object(g)?u(g):f(g)}},7534:(a,o,l)=>{var c=l(2552),u=l(346);a.exports=function(f){return u(f)&&c(f)=="[object Arguments]"}},5083:(a,o,l)=>{var c=l(1882),u=l(7296),f=l(3805),d=l(7473),g=/^\[object .+?Constructor\]$/,p=Function.prototype,_=Object.prototype,y=p.toString,v=_.hasOwnProperty,x=RegExp("^"+y.call(v).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");a.exports=function(E){return!(!f(E)||u(E))&&(c(E)?x:g).test(d(E))}},4901:(a,o,l)=>{var c=l(2552),u=l(294),f=l(346),d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d["[object Arguments]"]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d["[object Map]"]=d["[object Number]"]=d["[object Object]"]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1,a.exports=function(g){return f(g)&&u(g.length)&&!!d[c(g)]}},2903:(a,o,l)=>{var c=l(3805),u=l(5527),f=l(181),d=Object.prototype.hasOwnProperty;a.exports=function(g){if(!c(g))return f(g);var p=u(g),_=[];for(var y in g)(y!="constructor"||!p&&d.call(g,y))&&_.push(y);return _}},5250:(a,o,l)=>{var c=l(7217),u=l(7805),f=l(6649),d=l(2824),g=l(3805),p=l(7241),_=l(4974);a.exports=function y(v,x,E,M,O){v!==x&&f(x,(function(N,I){if(O||(O=new c),g(N))d(v,x,I,E,y,M,O);else{var D=M?M(_(v,I),N,I+"",v,x,O):void 0;D===void 0&&(D=N),u(v,I,D)}}),p)}},2824:(a,o,l)=>{var c=l(7805),u=l(3290),f=l(1961),d=l(3007),g=l(5529),p=l(2428),_=l(6449),y=l(3693),v=l(3656),x=l(1882),E=l(3805),M=l(1331),O=l(7167),N=l(4974),I=l(9884);a.exports=function(D,V,G,Q,B,$,U){var J=N(D,G),W=N(V,G),q=U.get(W);if(q)c(D,G,q);else{var Y=$?$(J,W,G+"",D,V,U):void 0,ae=Y===void 0;if(ae){var Z=_(W),K=!Z&&v(W),ne=!Z&&!K&&O(W);Y=W,Z||K||ne?_(J)?Y=J:y(J)?Y=d(J):K?(ae=!1,Y=u(W,!0)):ne?(ae=!1,Y=f(W,!0)):Y=[]:M(W)||p(W)?(Y=J,p(J)?Y=I(J):E(J)&&!x(J)||(Y=g(W))):ae=!1}ae&&(U.set(W,Y),B(Y,W,Q,$,U),U.delete(W)),c(D,G,Y)}}},9302:(a,o,l)=>{var c=l(3488),u=l(6757),f=l(2865);a.exports=function(d,g){return f(u(d,g,c),d+"")}},9570:(a,o,l)=>{var c=l(7334),u=l(3243),f=l(3488),d=u?function(g,p){return u(g,"toString",{configurable:!0,enumerable:!1,value:c(p),writable:!0})}:f;a.exports=d},8096:a=>{a.exports=function(o,l){for(var c=-1,u=Array(o);++c<o;)u[c]=l(c);return u}},7301:a=>{a.exports=function(o){return function(l){return o(l)}}},9653:(a,o,l)=>{var c=l(7828);a.exports=function(u){var f=new u.constructor(u.byteLength);return new c(f).set(new c(u)),f}},3290:(a,o,l)=>{a=l.nmd(a);var c=l(9325),u=o&&!o.nodeType&&o,f=u&&a&&!a.nodeType&&a,d=f&&f.exports===u?c.Buffer:void 0,g=d?d.allocUnsafe:void 0;a.exports=function(p,_){if(_)return p.slice();var y=p.length,v=g?g(y):new p.constructor(y);return p.copy(v),v}},1961:(a,o,l)=>{var c=l(9653);a.exports=function(u,f){var d=f?c(u.buffer):u.buffer;return new u.constructor(d,u.byteOffset,u.length)}},3007:a=>{a.exports=function(o,l){var c=-1,u=o.length;for(l||(l=Array(u));++c<u;)l[c]=o[c];return l}},1791:(a,o,l)=>{var c=l(6547),u=l(3360);a.exports=function(f,d,g,p){var _=!g;g||(g={});for(var y=-1,v=d.length;++y<v;){var x=d[y],E=p?p(g[x],f[x],x,g,f):void 0;E===void 0&&(E=f[x]),_?u(g,x,E):c(g,x,E)}return g}},5481:(a,o,l)=>{var c=l(9325)["__core-js_shared__"];a.exports=c},999:(a,o,l)=>{var c=l(9302),u=l(6800);a.exports=function(f){return c((function(d,g){var p=-1,_=g.length,y=_>1?g[_-1]:void 0,v=_>2?g[2]:void 0;for(y=f.length>3&&typeof y=="function"?(_--,y):void 0,v&&u(g[0],g[1],v)&&(y=_<3?void 0:y,_=1),d=Object(d);++p<_;){var x=g[p];x&&f(d,x,p,y)}return d}))}},3221:a=>{a.exports=function(o){return function(l,c,u){for(var f=-1,d=Object(l),g=u(l),p=g.length;p--;){var _=g[o?p:++f];if(c(d[_],_,d)===!1)break}return l}}},3243:(a,o,l)=>{var c=l(6110),u=(function(){try{var f=c(Object,"defineProperty");return f({},"",{}),f}catch{}})();a.exports=u},4840:(a,o,l)=>{var c=typeof l.g=="object"&&l.g&&l.g.Object===Object&&l.g;a.exports=c},2651:(a,o,l)=>{var c=l(4218);a.exports=function(u,f){var d=u.__data__;return c(f)?d[typeof f=="string"?"string":"hash"]:d.map}},6110:(a,o,l)=>{var c=l(5083),u=l(392);a.exports=function(f,d){var g=u(f,d);return c(g)?g:void 0}},8879:(a,o,l)=>{var c=l(4335)(Object.getPrototypeOf,Object);a.exports=c},659:(a,o,l)=>{var c=l(1873),u=Object.prototype,f=u.hasOwnProperty,d=u.toString,g=c?c.toStringTag:void 0;a.exports=function(p){var _=f.call(p,g),y=p[g];try{p[g]=void 0;var v=!0}catch{}var x=d.call(p);return v&&(_?p[g]=y:delete p[g]),x}},392:a=>{a.exports=function(o,l){return o?.[l]}},2032:(a,o,l)=>{var c=l(1042);a.exports=function(){this.__data__=c?c(null):{},this.size=0}},3862:a=>{a.exports=function(o){var l=this.has(o)&&delete this.__data__[o];return this.size-=l?1:0,l}},6721:(a,o,l)=>{var c=l(1042),u=Object.prototype.hasOwnProperty;a.exports=function(f){var d=this.__data__;if(c){var g=d[f];return g==="__lodash_hash_undefined__"?void 0:g}return u.call(d,f)?d[f]:void 0}},2749:(a,o,l)=>{var c=l(1042),u=Object.prototype.hasOwnProperty;a.exports=function(f){var d=this.__data__;return c?d[f]!==void 0:u.call(d,f)}},5749:(a,o,l)=>{var c=l(1042);a.exports=function(u,f){var d=this.__data__;return this.size+=this.has(u)?0:1,d[u]=c&&f===void 0?"__lodash_hash_undefined__":f,this}},5529:(a,o,l)=>{var c=l(9344),u=l(8879),f=l(5527);a.exports=function(d){return typeof d.constructor!="function"||f(d)?{}:c(u(d))}},361:a=>{var o=/^(?:0|[1-9]\d*)$/;a.exports=function(l,c){var u=typeof l;return!!(c=c??9007199254740991)&&(u=="number"||u!="symbol"&&o.test(l))&&l>-1&&l%1==0&&l<c}},6800:(a,o,l)=>{var c=l(5288),u=l(4894),f=l(361),d=l(3805);a.exports=function(g,p,_){if(!d(_))return!1;var y=typeof p;return!!(y=="number"?u(_)&&f(p,_.length):y=="string"&&p in _)&&c(_[p],g)}},4218:a=>{a.exports=function(o){var l=typeof o;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?o!=="__proto__":o===null}},7296:(a,o,l)=>{var c,u=l(5481),f=(c=/[^.]+$/.exec(u&&u.keys&&u.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"";a.exports=function(d){return!!f&&f in d}},5527:a=>{var o=Object.prototype;a.exports=function(l){var c=l&&l.constructor;return l===(typeof c=="function"&&c.prototype||o)}},3702:a=>{a.exports=function(){this.__data__=[],this.size=0}},80:(a,o,l)=>{var c=l(6025),u=Array.prototype.splice;a.exports=function(f){var d=this.__data__,g=c(d,f);return!(g<0)&&(g==d.length-1?d.pop():u.call(d,g,1),--this.size,!0)}},4739:(a,o,l)=>{var c=l(6025);a.exports=function(u){var f=this.__data__,d=c(f,u);return d<0?void 0:f[d][1]}},8655:(a,o,l)=>{var c=l(6025);a.exports=function(u){return c(this.__data__,u)>-1}},1175:(a,o,l)=>{var c=l(6025);a.exports=function(u,f){var d=this.__data__,g=c(d,u);return g<0?(++this.size,d.push([u,f])):d[g][1]=f,this}},3040:(a,o,l)=>{var c=l(1549),u=l(79),f=l(8223);a.exports=function(){this.size=0,this.__data__={hash:new c,map:new(f||u),string:new c}}},7670:(a,o,l)=>{var c=l(2651);a.exports=function(u){var f=c(this,u).delete(u);return this.size-=f?1:0,f}},289:(a,o,l)=>{var c=l(2651);a.exports=function(u){return c(this,u).get(u)}},4509:(a,o,l)=>{var c=l(2651);a.exports=function(u){return c(this,u).has(u)}},2949:(a,o,l)=>{var c=l(2651);a.exports=function(u,f){var d=c(this,u),g=d.size;return d.set(u,f),this.size+=d.size==g?0:1,this}},1042:(a,o,l)=>{var c=l(6110)(Object,"create");a.exports=c},181:a=>{a.exports=function(o){var l=[];if(o!=null)for(var c in Object(o))l.push(c);return l}},6009:(a,o,l)=>{a=l.nmd(a);var c=l(4840),u=o&&!o.nodeType&&o,f=u&&a&&!a.nodeType&&a,d=f&&f.exports===u&&c.process,g=(function(){try{var p=f&&f.require&&f.require("util").types;return p||d&&d.binding&&d.binding("util")}catch{}})();a.exports=g},9350:a=>{var o=Object.prototype.toString;a.exports=function(l){return o.call(l)}},4335:a=>{a.exports=function(o,l){return function(c){return o(l(c))}}},6757:(a,o,l)=>{var c=l(1033),u=Math.max;a.exports=function(f,d,g){return d=u(d===void 0?f.length-1:d,0),function(){for(var p=arguments,_=-1,y=u(p.length-d,0),v=Array(y);++_<y;)v[_]=p[d+_];_=-1;for(var x=Array(d+1);++_<d;)x[_]=p[_];return x[d]=g(v),c(f,this,x)}}},9325:(a,o,l)=>{var c=l(4840),u=typeof self=="object"&&self&&self.Object===Object&&self,f=c||u||Function("return this")();a.exports=f},4974:a=>{a.exports=function(o,l){if((l!=="constructor"||typeof o[l]!="function")&&l!="__proto__")return o[l]}},2865:(a,o,l)=>{var c=l(9570),u=l(1811)(c);a.exports=u},1811:a=>{var o=Date.now;a.exports=function(l){var c=0,u=0;return function(){var f=o(),d=16-(f-u);if(u=f,d>0){if(++c>=800)return arguments[0]}else c=0;return l.apply(void 0,arguments)}}},1420:(a,o,l)=>{var c=l(79);a.exports=function(){this.__data__=new c,this.size=0}},938:a=>{a.exports=function(o){var l=this.__data__,c=l.delete(o);return this.size=l.size,c}},3605:a=>{a.exports=function(o){return this.__data__.get(o)}},9817:a=>{a.exports=function(o){return this.__data__.has(o)}},945:(a,o,l)=>{var c=l(79),u=l(8223),f=l(3661);a.exports=function(d,g){var p=this.__data__;if(p instanceof c){var _=p.__data__;if(!u||_.length<199)return _.push([d,g]),this.size=++p.size,this;p=this.__data__=new f(_)}return p.set(d,g),this.size=p.size,this}},7473:a=>{var o=Function.prototype.toString;a.exports=function(l){if(l!=null){try{return o.call(l)}catch{}try{return l+""}catch{}}return""}},7334:a=>{a.exports=function(o){return function(){return o}}},5288:a=>{a.exports=function(o,l){return o===l||o!=o&&l!=l}},3488:a=>{a.exports=function(o){return o}},2428:(a,o,l)=>{var c=l(7534),u=l(346),f=Object.prototype,d=f.hasOwnProperty,g=f.propertyIsEnumerable,p=c((function(){return arguments})())?c:function(_){return u(_)&&d.call(_,"callee")&&!g.call(_,"callee")};a.exports=p},6449:a=>{var o=Array.isArray;a.exports=o},4894:(a,o,l)=>{var c=l(1882),u=l(294);a.exports=function(f){return f!=null&&u(f.length)&&!c(f)}},3693:(a,o,l)=>{var c=l(4894),u=l(346);a.exports=function(f){return u(f)&&c(f)}},3656:(a,o,l)=>{a=l.nmd(a);var c=l(9325),u=l(9935),f=o&&!o.nodeType&&o,d=f&&a&&!a.nodeType&&a,g=d&&d.exports===f?c.Buffer:void 0,p=(g?g.isBuffer:void 0)||u;a.exports=p},1882:(a,o,l)=>{var c=l(2552),u=l(3805);a.exports=function(f){if(!u(f))return!1;var d=c(f);return d=="[object Function]"||d=="[object GeneratorFunction]"||d=="[object AsyncFunction]"||d=="[object Proxy]"}},294:a=>{a.exports=function(o){return typeof o=="number"&&o>-1&&o%1==0&&o<=9007199254740991}},3805:a=>{a.exports=function(o){var l=typeof o;return o!=null&&(l=="object"||l=="function")}},346:a=>{a.exports=function(o){return o!=null&&typeof o=="object"}},1331:(a,o,l)=>{var c=l(2552),u=l(8879),f=l(346),d=Function.prototype,g=Object.prototype,p=d.toString,_=g.hasOwnProperty,y=p.call(Object);a.exports=function(v){if(!f(v)||c(v)!="[object Object]")return!1;var x=u(v);if(x===null)return!0;var E=_.call(x,"constructor")&&x.constructor;return typeof E=="function"&&E instanceof E&&p.call(E)==y}},7167:(a,o,l)=>{var c=l(4901),u=l(7301),f=l(6009),d=f&&f.isTypedArray,g=d?u(d):c;a.exports=g},7241:(a,o,l)=>{var c=l(695),u=l(2903),f=l(4894);a.exports=function(d){return f(d)?c(d,!0):u(d)}},2543:function(a,o,l){var c;a=l.nmd(a),(function(){var u,f="Expected a function",d="__lodash_hash_undefined__",g="__lodash_placeholder__",p=16,_=32,y=64,v=128,x=256,E=1/0,M=9007199254740991,O=NaN,N=4294967295,I=[["ary",v],["bind",1],["bindKey",2],["curry",8],["curryRight",p],["flip",512],["partial",_],["partialRight",y],["rearg",x]],D="[object Arguments]",V="[object Array]",G="[object Boolean]",Q="[object Date]",B="[object Error]",$="[object Function]",U="[object GeneratorFunction]",J="[object Map]",W="[object Number]",q="[object Object]",Y="[object Promise]",ae="[object RegExp]",Z="[object Set]",K="[object String]",ne="[object Symbol]",le="[object WeakMap]",ce="[object ArrayBuffer]",de="[object DataView]",Me="[object Float32Array]",qe="[object Float64Array]",Pe="[object Int8Array]",Ce="[object Int16Array]",Xe="[object Int32Array]",$e="[object Uint8Array]",at="[object Uint8ClampedArray]",pt="[object Uint16Array]",oe="[object Uint32Array]",Ue=/\b__p \+= '';/g,Ge=/\b(__p \+=) '' \+/g,ze=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Be=/&(?:amp|lt|gt|quot|#39);/g,me=/[&<>"']/g,Se=RegExp(Be.source),Ie=RegExp(me.source),be=/<%-([\s\S]+?)%>/g,Ke=/<%([\s\S]+?)%>/g,ot=/<%=([\s\S]+?)%>/g,lt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,Vt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,kt=/[\\^$.*+?()[\]{}|]/g,Ut=RegExp(kt.source),je=/^\s+/,ge=/\s/,se=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,_e=/\{\n\/\* \[wrapped with (.+)\] \*/,Ne=/,? & /,Le=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ke=/[()=,{}\[\]\/\s]/,Re=/\\(\\)?/g,st=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ve=/\w*$/,tt=/^[-+]0x[0-9a-f]+$/i,Ze=/^0b[01]+$/i,nt=/^\[object .+?Constructor\]$/,vt=/^0o[0-7]+$/i,Qe=/^(?:0|[1-9]\d*)$/,ht=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,mt=/($^)/,ft=/['\n\r\u2028\u2029\\]/g,_t="\\ud800-\\udfff",gn="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",_n="\\u2700-\\u27bf",Bt="a-z\\xdf-\\xf6\\xf8-\\xff",Yt="A-Z\\xc0-\\xd6\\xd8-\\xde",Mt="\\ufe0e\\ufe0f",fn="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Bn="[']",cn="["+_t+"]",In="["+fn+"]",$n="["+gn+"]",er="\\d+",as="["+_n+"]",di="["+Bt+"]",Oi="[^"+_t+fn+er+_n+Bt+Yt+"]",Bs="\\ud83c[\\udffb-\\udfff]",pi="[^"+_t+"]",ws="(?:\\ud83c[\\udde6-\\uddff]){2}",na="[\\ud800-\\udbff][\\udc00-\\udfff]",os="["+Yt+"]",We="\\u200d",At="(?:"+di+"|"+Oi+")",Wt="(?:"+os+"|"+Oi+")",Kt="(?:['](?:d|ll|m|re|s|t|ve))?",Lt="(?:['](?:D|LL|M|RE|S|T|VE))?",yn="(?:"+$n+"|"+Bs+")?",zn="["+Mt+"]?",En=zn+yn+("(?:"+We+"(?:"+[pi,ws,na].join("|")+")"+zn+yn+")*"),tr="(?:"+[as,ws,na].join("|")+")"+En,Ir="(?:"+[pi+$n+"?",$n,ws,na,cn].join("|")+")",Er=RegExp(Bn,"g"),rr=RegExp($n,"g"),Dr=RegExp(Bs+"(?="+Bs+")|"+Ir+En,"g"),ri=RegExp([os+"?"+di+"+"+Kt+"(?="+[In,os,"$"].join("|")+")",Wt+"+"+Lt+"(?="+[In,os+At,"$"].join("|")+")",os+"?"+At+"+"+Kt,os+"+"+Lt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",er,tr].join("|"),"g"),ha=RegExp("["+We+_t+gn+Mt+"]"),Cr=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ii=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Tr=-1,Pr={};Pr[Me]=Pr[qe]=Pr[Pe]=Pr[Ce]=Pr[Xe]=Pr[$e]=Pr[at]=Pr[pt]=Pr[oe]=!0,Pr[D]=Pr[V]=Pr[ce]=Pr[G]=Pr[de]=Pr[Q]=Pr[B]=Pr[$]=Pr[J]=Pr[W]=Pr[q]=Pr[ae]=Pr[Z]=Pr[K]=Pr[le]=!1;var Cn={};Cn[D]=Cn[V]=Cn[ce]=Cn[de]=Cn[G]=Cn[Q]=Cn[Me]=Cn[qe]=Cn[Pe]=Cn[Ce]=Cn[Xe]=Cn[J]=Cn[W]=Cn[q]=Cn[ae]=Cn[Z]=Cn[K]=Cn[ne]=Cn[$e]=Cn[at]=Cn[pt]=Cn[oe]=!0,Cn[B]=Cn[$]=Cn[le]=!1;var zr={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Do=parseFloat,ls=parseInt,Lo=typeof l.g=="object"&&l.g&&l.g.Object===Object&&l.g,cs=typeof self=="object"&&self&&self.Object===Object&&self,Xn=Lo||cs||Function("return this")(),Jr=o&&!o.nodeType&&o,ur=Jr&&a&&!a.nodeType&&a,Fs=ur&&ur.exports===Jr,bo=Fs&&Lo.process,da=(function(){try{var rt=ur&&ur.require&&ur.require("util").types;return rt||bo&&bo.binding&&bo.binding("util")}catch{}})(),pa=da&&da.isArrayBuffer,zh=da&&da.isDate,lp=da&&da.isMap,Wp=da&&da.isRegExp,Yp=da&&da.isSet,rh=da&&da.isTypedArray;function Tl(rt,Tt,Rt){switch(Rt.length){case 0:return rt.call(Tt);case 1:return rt.call(Tt,Rt[0]);case 2:return rt.call(Tt,Rt[0],Rt[1]);case 3:return rt.call(Tt,Rt[0],Rt[1],Rt[2])}return rt.apply(Tt,Rt)}function ac(rt,Tt,Rt,tn){for(var wn=-1,Zn=rt==null?0:rt.length;++wn<Zn;){var Ri=rt[wn];Tt(tn,Ri,Rt(Ri),rt)}return tn}function Uo(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function rl(rt,Tt){for(var Rt=rt==null?0:rt.length;Rt--&&Tt(rt[Rt],Rt,rt)!==!1;);return rt}function Xp(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(!Tt(rt[Rt],Rt,rt))return!1;return!0}function wc(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=0,Zn=[];++Rt<tn;){var Ri=rt[Rt];Tt(Ri,Rt,rt)&&(Zn[wn++]=Ri)}return Zn}function Gc(rt,Tt){return!!(rt!=null&&rt.length)&&Wc(rt,Tt,0)>-1}function $u(rt,Tt,Rt){for(var tn=-1,wn=rt==null?0:rt.length;++tn<wn;)if(Rt(Tt,rt[tn]))return!0;return!1}function Wi(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length,wn=Array(tn);++Rt<tn;)wn[Rt]=Tt(rt[Rt],Rt,rt);return wn}function Yi(rt,Tt){for(var Rt=-1,tn=Tt.length,wn=rt.length;++Rt<tn;)rt[wn+Rt]=Tt[Rt];return rt}function Rc(rt,Tt,Rt,tn){var wn=-1,Zn=rt==null?0:rt.length;for(tn&&Zn&&(Rt=rt[++wn]);++wn<Zn;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Ef(rt,Tt,Rt,tn){var wn=rt==null?0:rt.length;for(tn&&wn&&(Rt=rt[--wn]);wn--;)Rt=Tt(Rt,rt[wn],wn,rt);return Rt}function Zm(rt,Tt){for(var Rt=-1,tn=rt==null?0:rt.length;++Rt<tn;)if(Tt(rt[Rt],Rt,rt))return!0;return!1}var oc=sh("length");function co(rt,Tt,Rt){var tn;return Rt(rt,(function(wn,Zn,Ri){if(Tt(wn,Zn,Ri))return tn=Zn,!1})),tn}function $c(rt,Tt,Rt,tn){for(var wn=rt.length,Zn=Rt+(tn?1:-1);tn?Zn--:++Zn<wn;)if(Tt(rt[Zn],Zn,rt))return Zn;return-1}function Wc(rt,Tt,Rt){return Tt==Tt?(function(tn,wn,Zn){for(var Ri=Zn-1,sl=tn.length;++Ri<sl;)if(tn[Ri]===wn)return Ri;return-1})(rt,Tt,Rt):$c(rt,ma,Rt)}function ih(rt,Tt,Rt,tn){for(var wn=Rt-1,Zn=rt.length;++wn<Zn;)if(tn(rt[wn],Tt))return wn;return-1}function ma(rt){return rt!=rt}function xf(rt,Tt){var Rt=rt==null?0:rt.length;return Rt?Wu(rt,Tt)/Rt:O}function sh(rt){return function(Tt){return Tt==null?u:Tt[rt]}}function ah(rt){return function(Tt){return rt==null?u:rt[Tt]}}function Qm(rt,Tt,Rt,tn,wn){return wn(rt,(function(Zn,Ri,sl){Rt=tn?(tn=!1,Zn):Tt(Rt,Zn,Ri,sl)})),Rt}function Wu(rt,Tt){for(var Rt,tn=-1,wn=rt.length;++tn<wn;){var Zn=Tt(rt[tn]);Zn!==u&&(Rt=Rt===u?Zn:Rt+Zn)}return Rt}function Tf(rt,Tt){for(var Rt=-1,tn=Array(rt);++Rt<rt;)tn[Rt]=Tt(Rt);return tn}function oh(rt){return rt&&rt.slice(0,up(rt)+1).replace(je,"")}function Bo(rt){return function(Tt){return rt(Tt)}}function Vl(rt,Tt){return Wi(Tt,(function(Rt){return rt[Rt]}))}function Ad(rt,Tt){return rt.has(Tt)}function Kp(rt,Tt){for(var Rt=-1,tn=rt.length;++Rt<tn&&Wc(Tt,rt[Rt],0)>-1;);return Rt}function il(rt,Tt){for(var Rt=rt.length;Rt--&&Wc(Tt,rt[Rt],0)>-1;);return Rt}var Jm=ah({:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"}),q_=ah({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function V_(rt){return"\\"+zr[rt]}function cp(rt){return ha.test(rt)}function jh(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn,wn){Rt[++Tt]=[wn,tn]})),Rt}function Hh(rt,Tt){return function(Rt){return rt(Tt(Rt))}}function Yu(rt,Tt){for(var Rt=-1,tn=rt.length,wn=0,Zn=[];++Rt<tn;){var Ri=rt[Rt];Ri!==Tt&&Ri!==g||(rt[Rt]=g,Zn[wn++]=Rt)}return Zn}function Xu(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=tn})),Rt}function eg(rt){var Tt=-1,Rt=Array(rt.size);return rt.forEach((function(tn){Rt[++Tt]=[tn,tn]})),Rt}function vs(rt){return cp(rt)?(function(Tt){for(var Rt=Dr.lastIndex=0;Dr.test(Tt);)++Rt;return Rt})(rt):oc(rt)}function Ta(rt){return cp(rt)?(function(Tt){return Tt.match(Dr)||[]})(rt):(function(Tt){return Tt.split("")})(rt)}function up(rt){for(var Tt=rt.length;Tt--&&ge.test(rt.charAt(Tt)););return Tt}var tg=ah({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),qh=(function rt(Tt){var Rt,tn=(Tt=Tt==null?Xn:qh.defaults(Xn.Object(),Tt,qh.pick(Xn,ii))).Array,wn=Tt.Date,Zn=Tt.Error,Ri=Tt.Function,sl=Tt.Math,_r=Tt.Object,So=Tt.RegExp,wf=Tt.String,ns=Tt.TypeError,Ac=tn.prototype,lh=Ri.prototype,sr=_r.prototype,Cc=Tt["__core-js_shared__"],Oa=lh.toString,vr=sr.hasOwnProperty,Vr=0,ch=(Rt=/[^.]+$/.exec(Cc&&Cc.keys&&Cc.keys.IE_PROTO||""))?"Symbol(src)_1."+Rt:"",Rf=sr.toString,X0=Oa.call(_r),Gl=Xn._,ng=So("^"+Oa.call(vr).replace(kt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Eo=Fs?Tt.Buffer:u,Fo=Tt.Symbol,Su=Tt.Uint8Array,Yg=Eo?Eo.allocUnsafe:u,Eu=Hh(_r.getPrototypeOf,_r),uh=_r.create,Zp=sr.propertyIsEnumerable,fh=Ac.splice,Af=Fo?Fo.isConcatSpreadable:u,Yc=Fo?Fo.iterator:u,Hi=Fo?Fo.toStringTag:u,xu=(function(){try{var w=Zl(_r,"defineProperty");return w({},"",{}),w}catch{}})(),G_=Tt.clearTimeout!==Xn.clearTimeout&&Tt.clearTimeout,$_=wn&&wn.now!==Xn.Date.now&&wn.now,rg=Tt.setTimeout!==Xn.setTimeout&&Tt.setTimeout,Mc=sl.ceil,Cd=sl.floor,uo=_r.getOwnPropertySymbols,Cf=Eo?Eo.isBuffer:u,$l=Tt.isFinite,ig=Ac.join,Xg=Hh(_r.keys,_r),mi=sl.max,Xi=sl.min,sg=wn.now,hh=Tt.parseInt,fp=sl.random,Fn=Ac.reverse,zs=Zl(Tt,"DataView"),Mf=Zl(Tt,"Map"),xo=Zl(Tt,"Promise"),wl=Zl(Tt,"Set"),Ku=Zl(Tt,"WeakMap"),kf=Zl(_r,"create"),kc=Ku&&new Ku,Rs={},Kg=pl(zs),Xs=pl(Mf),K0=pl(xo),Rl=pl(wl),hp=pl(Ku),zo=Fo?Fo.prototype:u,lc=zo?zo.valueOf:u,Br=zo?zo.toString:u;function ve(w){if(Hr(w)&&!Sr(w)&&!(w instanceof On)){if(w instanceof Ai)return w;if(vr.call(w,"__wrapped__"))return Lc(w)}return new Ai(w)}var cc=(function(){function w(){}return function(h){if(!oa(h))return{};if(uh)return uh(h);w.prototype=h;var b=new w;return w.prototype=u,b}})();function Ja(){}function Ai(w,h){this.__wrapped__=w,this.__actions__=[],this.__chain__=!!h,this.__index__=0,this.__values__=u}function On(w){this.__wrapped__=w,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=N,this.__views__=[]}function fo(w){var h=-1,b=w==null?0:w.length;for(this.clear();++h<b;){var k=w[h];this.set(k[0],k[1])}}function ho(w){var h=-1,b=w==null?0:w.length;for(this.clear();++h<b;){var k=w[h];this.set(k[0],k[1])}}function Ki(w){var h=-1,b=w==null?0:w.length;for(this.clear();++h<b;){var k=w[h];this.set(k[0],k[1])}}function hn(w){var h=-1,b=w==null?0:w.length;for(this.__data__=new Ki;++h<b;)this.add(w[h])}function Ei(w){var h=this.__data__=new ho(w);this.size=h.size}function ag(w,h){var b=Sr(w),k=!b&&Ff(w),F=!b&&!k&&aa(w),ie=!b&&!k&&!F&&Ms(w),pe=b||k||F||ie,ye=pe?Tf(w.length,wf):[],Ae=ye.length;for(var De in w)!h&&!vr.call(w,De)||pe&&(De=="length"||F&&(De=="offset"||De=="parent")||ie&&(De=="buffer"||De=="byteLength"||De=="byteOffset")||La(De,Ae))||ye.push(De);return ye}function Of(w){var h=w.length;return h?w[mh(0,h-1)]:u}function If(w,h){return Df(Hs(w),Al(h,0,w.length))}function og(w){return Df(Hs(w))}function To(w,h,b){(b!==u&&!ml(w[h],b)||b===u&&!(h in w))&&Ia(w,h,b)}function Oc(w,h,b){var k=w[h];vr.call(w,h)&&ml(k,b)&&(b!==u||h in w)||Ia(w,h,b)}function ga(w,h){for(var b=w.length;b--;)if(ml(w[b][0],h))return b;return-1}function dp(w,h,b,k){return us(w,(function(F,ie,pe){h(k,F,b(F),pe)})),k}function wo(w,h){return w&&Ol(h,Zi(h),w)}function Ia(w,h,b){h=="__proto__"&&xu?xu(w,h,{configurable:!0,enumerable:!0,value:b,writable:!0}):w[h]=b}function dh(w,h){for(var b=-1,k=h.length,F=tn(k),ie=w==null;++b<k;)F[b]=ie?u:la(w,h[b]);return F}function Al(w,h,b){return w==w&&(b!==u&&(w=w<=b?w:b),h!==u&&(w=w>=h?w:h)),w}function js(w,h,b,k,F,ie){var pe,ye=1&h,Ae=2&h,De=4&h;if(b&&(pe=F?b(w,k,F,ie):b(w)),pe!==u)return pe;if(!oa(w))return w;var Fe=Sr(w);if(Fe){if(pe=(function(bt){var gt=bt.length,Ot=new bt.constructor(gt);return gt&&typeof bt[0]=="string"&&vr.call(bt,"index")&&(Ot.index=bt.index,Ot.input=bt.input),Ot})(w),!ye)return Hs(w,pe)}else{var Ye=dl(w),dt=Ye==$||Ye==U;if(aa(w))return jr(w,ye);if(Ye==q||Ye==D||dt&&!F){if(pe=Ae||dt?{}:Qg(w),!ye)return Ae?(function(bt,gt){return Ol(bt,Ho(bt),gt)})(w,(function(bt,gt){return bt&&Ol(gt,Zr(gt),bt)})(pe,w)):(function(bt,gt){return Ol(bt,yp(bt),gt)})(w,wo(pe,w))}else{if(!Cn[Ye])return F?w:{};pe=(function(bt,gt,Ot){var wt=bt.constructor;switch(gt){case ce:return Au(bt);case G:case Q:return new wt(+bt);case de:return(function(Ft,Zt){var Gt=Zt?Au(Ft.buffer):Ft.buffer;return new Ft.constructor(Gt,Ft.byteOffset,Ft.byteLength)})(bt,Ot);case Me:case qe:case Pe:case Ce:case Xe:case $e:case at:case pt:case oe:return Pf(bt,Ot);case J:return new wt;case W:case K:return new wt(bt);case ae:return(function(Ft){var Zt=new Ft.constructor(Ft.source,Ve.exec(Ft));return Zt.lastIndex=Ft.lastIndex,Zt})(bt);case Z:return new wt;case ne:return It=bt,lc?_r(lc.call(It)):{}}var It})(w,Ye,ye)}}ie||(ie=new Ei);var Et=ie.get(w);if(Et)return Et;ie.set(w,pe),$a(w)?w.forEach((function(bt){pe.add(js(bt,h,b,bt,w,ie))})):hs(w)&&w.forEach((function(bt,gt){pe.set(gt,js(bt,h,b,gt,w,ie))}));var Pt=Fe?u:(De?Ae?hl:vp:Ae?Zr:Zi)(w);return Uo(Pt||w,(function(bt,gt){Pt&&(bt=w[gt=bt]),Oc(pe,gt,js(bt,h,b,gt,w,ie))})),pe}function Cl(w,h,b){var k=b.length;if(w==null)return!k;for(w=_r(w);k--;){var F=b[k],ie=h[F],pe=w[F];if(pe===u&&!(F in w)||!ie(pe))return!1}return!0}function Vh(w,h,b){if(typeof w!="function")throw new ns(f);return ku((function(){w.apply(u,b)}),h)}function Ic(w,h,b,k){var F=-1,ie=Gc,pe=!0,ye=w.length,Ae=[],De=h.length;if(!ye)return Ae;b&&(h=Wi(h,Bo(b))),k?(ie=$u,pe=!1):h.length>=200&&(ie=Ad,pe=!1,h=new hn(h));e:for(;++F<ye;){var Fe=w[F],Ye=b==null?Fe:b(Fe);if(Fe=k||Fe!==0?Fe:0,pe&&Ye==Ye){for(var dt=De;dt--;)if(h[dt]===Ye)continue e;Ae.push(Fe)}else ie(h,Ye,k)||Ae.push(Fe)}return Ae}ve.templateSettings={escape:be,evaluate:Ke,interpolate:ot,variable:"",imports:{_:ve}},ve.prototype=Ja.prototype,ve.prototype.constructor=ve,Ai.prototype=cc(Ja.prototype),Ai.prototype.constructor=Ai,On.prototype=cc(Ja.prototype),On.prototype.constructor=On,fo.prototype.clear=function(){this.__data__=kf?kf(null):{},this.size=0},fo.prototype.delete=function(w){var h=this.has(w)&&delete this.__data__[w];return this.size-=h?1:0,h},fo.prototype.get=function(w){var h=this.__data__;if(kf){var b=h[w];return b===d?u:b}return vr.call(h,w)?h[w]:u},fo.prototype.has=function(w){var h=this.__data__;return kf?h[w]!==u:vr.call(h,w)},fo.prototype.set=function(w,h){var b=this.__data__;return this.size+=this.has(w)?0:1,b[w]=kf&&h===u?d:h,this},ho.prototype.clear=function(){this.__data__=[],this.size=0},ho.prototype.delete=function(w){var h=this.__data__,b=ga(h,w);return!(b<0)&&(b==h.length-1?h.pop():fh.call(h,b,1),--this.size,!0)},ho.prototype.get=function(w){var h=this.__data__,b=ga(h,w);return b<0?u:h[b][1]},ho.prototype.has=function(w){return ga(this.__data__,w)>-1},ho.prototype.set=function(w,h){var b=this.__data__,k=ga(b,w);return k<0?(++this.size,b.push([w,h])):b[k][1]=h,this},Ki.prototype.clear=function(){this.size=0,this.__data__={hash:new fo,map:new(Mf||ho),string:new fo}},Ki.prototype.delete=function(w){var h=rd(this,w).delete(w);return this.size-=h?1:0,h},Ki.prototype.get=function(w){return rd(this,w).get(w)},Ki.prototype.has=function(w){return rd(this,w).has(w)},Ki.prototype.set=function(w,h){var b=rd(this,w),k=b.size;return b.set(w,h),this.size+=b.size==k?0:1,this},hn.prototype.add=hn.prototype.push=function(w){return this.__data__.set(w,d),this},hn.prototype.has=function(w){return this.__data__.has(w)},Ei.prototype.clear=function(){this.__data__=new ho,this.size=0},Ei.prototype.delete=function(w){var h=this.__data__,b=h.delete(w);return this.size=h.size,b},Ei.prototype.get=function(w){return this.__data__.get(w)},Ei.prototype.has=function(w){return this.__data__.has(w)},Ei.prototype.set=function(w,h){var b=this.__data__;if(b instanceof ho){var k=b.__data__;if(!Mf||k.length<199)return k.push([w,h]),this.size=++b.size,this;b=this.__data__=new Ki(k)}return b.set(w,h),this.size=b.size,this};var us=Pd(Ks),uc=Pd(Ro,!0);function Gh(w,h){var b=!0;return us(w,(function(k,F,ie){return b=!!h(k,F,ie)})),b}function Wl(w,h,b){for(var k=-1,F=w.length;++k<F;){var ie=w[k],pe=h(ie);if(pe!=null&&(ye===u?pe==pe&&!Vs(pe):b(pe,ye)))var ye=pe,Ae=ie}return Ae}function Tu(w,h){var b=[];return us(w,(function(k,F,ie){h(k,F,ie)&&b.push(k)})),b}function si(w,h,b,k,F){var ie=-1,pe=w.length;for(b||(b=sf),F||(F=[]);++ie<pe;){var ye=w[ie];h>0&&b(ye)?h>1?si(ye,h-1,b,k,F):Yi(F,ye):k||(F[F.length]=ye)}return F}var $h=tm(),Qp=tm(!0);function Ks(w,h){return w&&$h(w,h,Zi)}function Ro(w,h){return w&&Qp(w,h,Zi)}function As(w,h){return wc(h,(function(b){return ys(w[b])}))}function ei(w,h){for(var b=0,k=(h=tf(h,w)).length;w!=null&&b<k;)w=w[Ou(h[b++])];return b&&b==k?w:u}function Nc(w,h,b){var k=h(w);return Sr(w)?k:Yi(k,b(w))}function gi(w){return w==null?w===u?"[object Undefined]":"[object Null]":Hi&&Hi in _r(w)?(function(h){var b=vr.call(h,Hi),k=h[Hi];try{h[Hi]=u;var F=!0}catch{}var ie=Rf.call(h);return F&&(b?h[Hi]=k:delete h[Hi]),ie})(w):(function(h){return Rf.call(h)})(w)}function Wh(w,h){return w>h}function Yh(w,h){return w!=null&&vr.call(w,h)}function W_(w,h){return w!=null&&h in _r(w)}function Md(w,h,b){for(var k=b?$u:Gc,F=w[0].length,ie=w.length,pe=ie,ye=tn(ie),Ae=1/0,De=[];pe--;){var Fe=w[pe];pe&&h&&(Fe=Wi(Fe,Bo(h))),Ae=Xi(Fe.length,Ae),ye[pe]=!b&&(h||F>=120&&Fe.length>=120)?new hn(pe&&Fe):u}Fe=w[0];var Ye=-1,dt=ye[0];e:for(;++Ye<F&&De.length<Ae;){var Et=Fe[Ye],Pt=h?h(Et):Et;if(Et=b||Et!==0?Et:0,!(dt?Ad(dt,Pt):k(De,Pt,b))){for(pe=ie;--pe;){var bt=ye[pe];if(!(bt?Ad(bt,Pt):k(w[pe],Pt,b)))continue e}dt&&dt.push(Pt),De.push(Et)}}return De}function al(w,h,b){var k=(w=sm(w,h=tf(h,w)))==null?w:w[Ou(Iu(h))];return k==null?u:Tl(k,w,b)}function Qn(w){return Hr(w)&&gi(w)==D}function Ii(w,h,b,k,F){return w===h||(w==null||h==null||!Hr(w)&&!Hr(h)?w!=w&&h!=h:(function(ie,pe,ye,Ae,De,Fe){var Ye=Sr(ie),dt=Sr(pe),Et=Ye?V:dl(ie),Pt=dt?V:dl(pe),bt=(Et=Et==D?q:Et)==q,gt=(Pt=Pt==D?q:Pt)==q,Ot=Et==Pt;if(Ot&&aa(ie)){if(!aa(pe))return!1;Ye=!0,bt=!1}if(Ot&&!bt)return Fe||(Fe=new Ei),Ye||Ms(ie)?fl(ie,pe,ye,Ae,De,Fe):(function(Gt,$t,dn,Rn,Nn,qn,Dn){switch(dn){case de:if(Gt.byteLength!=$t.byteLength||Gt.byteOffset!=$t.byteOffset)return!1;Gt=Gt.buffer,$t=$t.buffer;case ce:return!(Gt.byteLength!=$t.byteLength||!qn(new Su(Gt),new Su($t)));case G:case Q:case W:return ml(+Gt,+$t);case B:return Gt.name==$t.name&&Gt.message==$t.message;case ae:case K:return Gt==$t+"";case J:var gr=jh;case Z:var Ur=1&Rn;if(gr||(gr=Xu),Gt.size!=$t.size&&!Ur)return!1;var Ci=Dn.get(Gt);if(Ci)return Ci==$t;Rn|=2,Dn.set(Gt,$t);var ai=fl(gr(Gt),gr($t),Rn,Nn,qn,Dn);return Dn.delete(Gt),ai;case ne:if(lc)return lc.call(Gt)==lc.call($t)}return!1})(ie,pe,Et,ye,Ae,De,Fe);if(!(1&ye)){var wt=bt&&vr.call(ie,"__wrapped__"),It=gt&&vr.call(pe,"__wrapped__");if(wt||It){var Ft=wt?ie.value():ie,Zt=It?pe.value():pe;return Fe||(Fe=new Ei),De(Ft,Zt,ye,Ae,Fe)}}return Ot?(Fe||(Fe=new Ei),(function(Gt,$t,dn,Rn,Nn,qn){var Dn=1&dn,gr=vp(Gt),Ur=gr.length,Ci=vp($t),ai=Ci.length;if(Ur!=ai&&!Dn)return!1;for(var oi=Ur;oi--;){var Bi=gr[oi];if(!(Dn?Bi in $t:vr.call($t,Bi)))return!1}var Wr=qn.get(Gt),bs=qn.get($t);if(Wr&&bs)return Wr==$t&&bs==Gt;var li=!0;qn.set(Gt,$t),qn.set($t,Gt);for(var Os=Dn;++oi<Ur;){var Vi=Gt[Bi=gr[oi]],Js=$t[Bi];if(Rn)var Is=Dn?Rn(Js,Vi,Bi,$t,Gt,qn):Rn(Vi,Js,Bi,Gt,$t,qn);if(!(Is===u?Vi===Js||Nn(Vi,Js,dn,Rn,qn):Is)){li=!1;break}Os||(Os=Bi=="constructor")}if(li&&!Os){var ps=Gt.constructor,_o=$t.constructor;ps==_o||!("constructor"in Gt)||!("constructor"in $t)||typeof ps=="function"&&ps instanceof ps&&typeof _o=="function"&&_o instanceof _o||(li=!1)}return qn.delete(Gt),qn.delete($t),li})(ie,pe,ye,Ae,De,Fe)):!1})(w,h,b,k,Ii,F))}function Xc(w,h,b,k){var F=b.length,ie=F,pe=!k;if(w==null)return!ie;for(w=_r(w);F--;){var ye=b[F];if(pe&&ye[2]?ye[1]!==w[ye[0]]:!(ye[0]in w))return!1}for(;++F<ie;){var Ae=(ye=b[F])[0],De=w[Ae],Fe=ye[1];if(pe&&ye[2]){if(De===u&&!(Ae in w))return!1}else{var Ye=new Ei;if(k)var dt=k(De,Fe,Ae,w,h,Ye);if(!(dt===u?Ii(Fe,De,3,k,Ye):dt))return!1}}return!0}function po(w){return!(!oa(w)||(h=w,ch&&ch in h))&&(ys(w)?ng:nt).test(pl(w));var h}function Nf(w){return typeof w=="function"?w:w==null?Io:typeof w=="object"?Sr(w)?Ao(w[0],w[1]):kd(w):fd(w)}function Kc(w){if(!qa(w))return Xg(w);var h=[];for(var b in _r(w))vr.call(w,b)&&b!="constructor"&&h.push(b);return h}function ph(w){if(!oa(w))return(function(F){var ie=[];if(F!=null)for(var pe in _r(F))ie.push(pe);return ie})(w);var h=qa(w),b=[];for(var k in w)(k!="constructor"||!h&&vr.call(w,k))&&b.push(k);return b}function Zc(w,h){return w<h}function Jp(w,h){var b=-1,k=pc(w)?tn(w.length):[];return us(w,(function(F,ie,pe){k[++b]=h(F,ie,pe)})),k}function kd(w){var h=mo(w);return h.length==1&&h[0][2]?Jg(h[0][0],h[0][1]):function(b){return b===w||Xc(b,w,h)}}function Ao(w,h){return Dd(w)&&rm(h)?Jg(Ou(w),h):function(b){var k=la(b,w);return k===u&&k===h?xp(b,w):Ii(h,k,3)}}function Xh(w,h,b,k,F){w!==h&&$h(h,(function(ie,pe){if(F||(F=new Ei),oa(ie))(function(Ae,De,Fe,Ye,dt,Et,Pt){var bt=Ld(Ae,Fe),gt=Ld(De,Fe),Ot=Pt.get(gt);if(Ot)return void To(Ae,Fe,Ot);var wt=Et?Et(bt,gt,Fe+"",Ae,De,Pt):u,It=wt===u;if(It){var Ft=Sr(gt),Zt=!Ft&&aa(gt),Gt=!Ft&&!Zt&&Ms(gt);wt=gt,Ft||Zt||Gt?Sr(bt)?wt=bt:Li(bt)?wt=Hs(bt):Zt?(It=!1,wt=jr(gt,!0)):Gt?(It=!1,wt=Pf(gt,!0)):wt=[]:tu(gt)||Ff(gt)?(wt=bt,Ff(bt)?wt=Wa(bt):oa(bt)&&!ys(bt)||(wt=Qg(gt))):It=!1}It&&(Pt.set(gt,wt),dt(wt,gt,Ye,Et,Pt),Pt.delete(gt)),To(Ae,Fe,wt)})(w,h,pe,b,Xh,k,F);else{var ye=k?k(Ld(w,pe),ie,pe+"",w,h,F):u;ye===u&&(ye=ie),To(w,pe,ye)}}),Zr)}function Zu(w,h){var b=w.length;if(b)return La(h+=h<0?b:0,b)?w[h]:u}function Na(w,h,b){h=h.length?Wi(h,(function(ie){return Sr(ie)?function(pe){return ei(pe,ie.length===1?ie[0]:ie)}:ie})):[Io];var k=-1;h=Wi(h,Bo(br()));var F=Jp(w,(function(ie,pe,ye){var Ae=Wi(h,(function(De){return De(ie)}));return{criteria:Ae,index:++k,value:ie}}));return(function(ie,pe){var ye=ie.length;for(ie.sort(pe);ye--;)ie[ye]=ie[ye].value;return ie})(F,(function(ie,pe){return(function(ye,Ae,De){for(var Fe=-1,Ye=ye.criteria,dt=Ae.criteria,Et=Ye.length,Pt=De.length;++Fe<Et;){var bt=Zh(Ye[Fe],dt[Fe]);if(bt)return Fe>=Pt?bt:bt*(De[Fe]=="desc"?-1:1)}return ye.index-Ae.index})(ie,pe,b)}))}function Kh(w,h,b){for(var k=-1,F=h.length,ie={};++k<F;){var pe=h[k],ye=ei(w,pe);b(ye,pe)&&xi(ie,tf(pe,w),ye)}return ie}function pp(w,h,b,k){var F=k?ih:Wc,ie=-1,pe=h.length,ye=w;for(w===h&&(h=Hs(h)),b&&(ye=Wi(w,Bo(b)));++ie<pe;)for(var Ae=0,De=h[ie],Fe=b?b(De):De;(Ae=F(ye,Fe,Ae,k))>-1;)ye!==w&&fh.call(ye,Ae,1),fh.call(w,Ae,1);return w}function Qu(w,h){for(var b=w?h.length:0,k=b-1;b--;){var F=h[b];if(b==k||F!==ie){var ie=F;La(F)?fh.call(w,F,1):Id(w,F)}}return w}function mh(w,h){return w+Cd(fp()*(h-w+1))}function Lr(w,h){var b="";if(!w||h<1||h>M)return b;do h%2&&(b+=w),(h=Cd(h/2))&&(w+=w);while(h);return b}function yr(w,h){return cg(im(w,h,Io),w+"")}function ol(w){return Of(ru(w))}function Yl(w,h){var b=ru(w);return Df(b,Al(h,0,b.length))}function xi(w,h,b,k){if(!oa(w))return w;for(var F=-1,ie=(h=tf(h,w)).length,pe=ie-1,ye=w;ye!=null&&++F<ie;){var Ae=Ou(h[F]),De=b;if(Ae==="__proto__"||Ae==="constructor"||Ae==="prototype")return w;if(F!=pe){var Fe=ye[Ae];(De=k?k(Fe,Ae,ye):u)===u&&(De=oa(Fe)?Fe:La(h[F+1])?[]:{})}Oc(ye,Ae,De),ye=ye[Ae]}return w}var mp=kc?function(w,h){return kc.set(w,h),w}:Io,Fr=xu?function(w,h){return xu(w,"toString",{configurable:!0,enumerable:!1,value:ud(h),writable:!0})}:Io;function Ml(w){return Df(ru(w))}function Pa(w,h,b){var k=-1,F=w.length;h<0&&(h=-h>F?0:F+h),(b=b>F?F:b)<0&&(b+=F),F=h>b?0:b-h>>>0,h>>>=0;for(var ie=tn(F);++k<F;)ie[k]=w[k+h];return ie}function Od(w,h){var b;return us(w,(function(k,F,ie){return!(b=h(k,F,ie))})),!!b}function gp(w,h,b){var k=0,F=w==null?k:w.length;if(typeof h=="number"&&h==h&&F<=2147483647){for(;k<F;){var ie=k+F>>>1,pe=w[ie];pe!==null&&!Vs(pe)&&(b?pe<=h:pe<h)?k=ie+1:F=ie}return F}return ll(w,h,Io,b)}function ll(w,h,b,k){var F=0,ie=w==null?0:w.length;if(ie===0)return 0;for(var pe=(h=b(h))!=h,ye=h===null,Ae=Vs(h),De=h===u;F<ie;){var Fe=Cd((F+ie)/2),Ye=b(w[Fe]),dt=Ye!==u,Et=Ye===null,Pt=Ye==Ye,bt=Vs(Ye);if(pe)var gt=k||Pt;else gt=De?Pt&&(k||dt):ye?Pt&&dt&&(k||!Et):Ae?Pt&&dt&&!Et&&(k||!bt):!Et&&!bt&&(k?Ye<=h:Ye<h);gt?F=Fe+1:ie=Fe}return Xi(ie,4294967294)}function Xl(w,h){for(var b=-1,k=w.length,F=0,ie=[];++b<k;){var pe=w[b],ye=h?h(pe):pe;if(!b||!ml(ye,Ae)){var Ae=ye;ie[F++]=pe===0?0:pe}}return ie}function ja(w){return typeof w=="number"?w:Vs(w)?O:+w}function ra(w){if(typeof w=="string")return w;if(Sr(w))return Wi(w,ra)+"";if(Vs(w))return Br?Br.call(w):"";var h=w+"";return h=="0"&&1/w==-1/0?"-0":h}function Pc(w,h,b){var k=-1,F=Gc,ie=w.length,pe=!0,ye=[],Ae=ye;if(b)pe=!1,F=$u;else if(ie>=200){var De=h?null:Da(w);if(De)return Xu(De);pe=!1,F=Ad,Ae=new hn}else Ae=h?[]:ye;e:for(;++k<ie;){var Fe=w[k],Ye=h?h(Fe):Fe;if(Fe=b||Fe!==0?Fe:0,pe&&Ye==Ye){for(var dt=Ae.length;dt--;)if(Ae[dt]===Ye)continue e;h&&Ae.push(Ye),ye.push(Fe)}else F(Ae,Ye,b)||(Ae!==ye&&Ae.push(Ye),ye.push(Fe))}return ye}function Id(w,h){return(w=sm(w,h=tf(h,w)))==null||delete w[Ou(Iu(h))]}function wu(w,h,b,k){return xi(w,h,b(ei(w,h)),k)}function eo(w,h,b,k){for(var F=w.length,ie=k?F:-1;(k?ie--:++ie<F)&&h(w[ie],ie,w););return b?Pa(w,k?0:ie,k?ie+1:F):Pa(w,k?ie+1:0,k?F:ie)}function Ju(w,h){var b=w;return b instanceof On&&(b=b.value()),Rc(h,(function(k,F){return F.func.apply(F.thisArg,Yi([k],F.args))}),b)}function Dc(w,h,b){var k=w.length;if(k<2)return k?Pc(w[0]):[];for(var F=-1,ie=tn(k);++F<k;)for(var pe=w[F],ye=-1;++ye<k;)ye!=F&&(ie[F]=Ic(ie[F]||pe,w[ye],h,b));return Pc(si(ie,1),h,b)}function ef(w,h,b){for(var k=-1,F=w.length,ie=h.length,pe={};++k<F;){var ye=k<ie?h[k]:u;b(pe,w[k],ye)}return pe}function Ru(w){return Li(w)?w:[]}function Co(w){return typeof w=="function"?w:Io}function tf(w,h){return Sr(w)?w:Dd(w,h)?[w]:Bd($r(w))}var nf=yr;function Mo(w,h,b){var k=w.length;return b=b===u?k:b,!h&&b>=k?w:Pa(w,h,b)}var em=G_||function(w){return Xn.clearTimeout(w)};function jr(w,h){if(h)return w.slice();var b=w.length,k=Yg?Yg(b):new w.constructor(b);return w.copy(k),k}function Au(w){var h=new w.constructor(w.byteLength);return new Su(h).set(new Su(w)),h}function Pf(w,h){var b=h?Au(w.buffer):w.buffer;return new w.constructor(b,w.byteOffset,w.length)}function Zh(w,h){if(w!==h){var b=w!==u,k=w===null,F=w==w,ie=Vs(w),pe=h!==u,ye=h===null,Ae=h==h,De=Vs(h);if(!ye&&!De&&!ie&&w>h||ie&&pe&&Ae&&!ye&&!De||k&&pe&&Ae||!b&&Ae||!F)return 1;if(!k&&!ie&&!De&&w<h||De&&b&&F&&!k&&!ie||ye&&b&&F||!pe&&F||!Ae)return-1}return 0}function Qh(w,h,b,k){for(var F=-1,ie=w.length,pe=b.length,ye=-1,Ae=h.length,De=mi(ie-pe,0),Fe=tn(Ae+De),Ye=!k;++ye<Ae;)Fe[ye]=h[ye];for(;++F<pe;)(Ye||F<ie)&&(Fe[b[F]]=w[F]);for(;De--;)Fe[ye++]=w[F++];return Fe}function kl(w,h,b,k){for(var F=-1,ie=w.length,pe=-1,ye=b.length,Ae=-1,De=h.length,Fe=mi(ie-ye,0),Ye=tn(Fe+De),dt=!k;++F<Fe;)Ye[F]=w[F];for(var Et=F;++Ae<De;)Ye[Et+Ae]=h[Ae];for(;++pe<ye;)(dt||F<ie)&&(Ye[Et+b[pe]]=w[F++]);return Ye}function Hs(w,h){var b=-1,k=w.length;for(h||(h=tn(k));++b<k;)h[b]=w[b];return h}function Ol(w,h,b,k){var F=!b;b||(b={});for(var ie=-1,pe=h.length;++ie<pe;){var ye=h[ie],Ae=k?k(b[ye],w[ye],ye,b,w):u;Ae===u&&(Ae=w[ye]),F?Ia(b,ye,Ae):Oc(b,ye,Ae)}return b}function Qc(w,h){return function(b,k){var F=Sr(b)?ac:dp,ie=h?h():{};return F(b,w,br(k,2),ie)}}function Nd(w){return yr((function(h,b){var k=-1,F=b.length,ie=F>1?b[F-1]:u,pe=F>2?b[2]:u;for(ie=w.length>3&&typeof ie=="function"?(F--,ie):u,pe&&qo(b[0],b[1],pe)&&(ie=F<3?u:ie,F=1),h=_r(h);++k<F;){var ye=b[k];ye&&w(h,ye,k,ie)}return h}))}function Pd(w,h){return function(b,k){if(b==null)return b;if(!pc(b))return w(b,k);for(var F=b.length,ie=h?F:-1,pe=_r(b);(h?ie--:++ie<F)&&k(pe[ie],ie,pe)!==!1;);return b}}function tm(w){return function(h,b,k){for(var F=-1,ie=_r(h),pe=k(h),ye=pe.length;ye--;){var Ae=pe[w?ye:++F];if(b(ie[Ae],Ae,ie)===!1)break}return h}}function Jh(w){return function(h){var b=cp(h=$r(h))?Ta(h):u,k=b?b[0]:h.charAt(0),F=b?Mo(b,1).join(""):h.slice(1);return k[w]()+F}}function Cu(w){return function(h){return Rc(ar(lf(h).replace(Er,"")),w,"")}}function cl(w){return function(){var h=arguments;switch(h.length){case 0:return new w;case 1:return new w(h[0]);case 2:return new w(h[0],h[1]);case 3:return new w(h[0],h[1],h[2]);case 4:return new w(h[0],h[1],h[2],h[3]);case 5:return new w(h[0],h[1],h[2],h[3],h[4]);case 6:return new w(h[0],h[1],h[2],h[3],h[4],h[5]);case 7:return new w(h[0],h[1],h[2],h[3],h[4],h[5],h[6])}var b=cc(w.prototype),k=w.apply(b,h);return oa(k)?k:b}}function rf(w){return function(h,b,k){var F=_r(h);if(!pc(h)){var ie=br(b,3);h=Zi(h),b=function(ye){return ie(F[ye],ye,F)}}var pe=w(h,b,k);return pe>-1?F[ie?h[pe]:pe]:u}}function Kr(w){return Kl((function(h){var b=h.length,k=b,F=Ai.prototype.thru;for(w&&h.reverse();k--;){var ie=h[k];if(typeof ie!="function")throw new ns(f);if(F&&!pe&&hc(ie)=="wrapper")var pe=new Ai([],!0)}for(k=pe?k:b;++k<b;){var ye=hc(ie=h[k]),Ae=ye=="wrapper"?ia(ie):u;pe=Ae&&lg(Ae[0])&&Ae[1]==424&&!Ae[4].length&&Ae[9]==1?pe[hc(Ae[0])].apply(pe,Ae[3]):ie.length==1&&lg(ie)?pe[ye]():pe.thru(ie)}return function(){var De=arguments,Fe=De[0];if(pe&&De.length==1&&Sr(Fe))return pe.plant(Fe).value();for(var Ye=0,dt=b?h[Ye].apply(this,De):Fe;++Ye<b;)dt=h[Ye].call(this,dt);return dt}}))}function fs(w,h,b,k,F,ie,pe,ye,Ae,De){var Fe=h&v,Ye=1&h,dt=2&h,Et=24&h,Pt=512&h,bt=dt?u:cl(w);return function gt(){for(var Ot=arguments.length,wt=tn(Ot),It=Ot;It--;)wt[It]=arguments[It];if(Et)var Ft=dr(gt),Zt=(function(Rn,Nn){for(var qn=Rn.length,Dn=0;qn--;)Rn[qn]===Nn&&++Dn;return Dn})(wt,Ft);if(k&&(wt=Qh(wt,k,F,Et)),ie&&(wt=kl(wt,ie,pe,Et)),Ot-=Zt,Et&&Ot<De){var Gt=Yu(wt,Ft);return jo(w,h,fs,gt.placeholder,b,wt,Gt,ye,Ae,De-Ot)}var $t=Ye?b:this,dn=dt?$t[w]:w;return Ot=wt.length,ye?wt=(function(Rn,Nn){for(var qn=Rn.length,Dn=Xi(Nn.length,qn),gr=Hs(Rn);Dn--;){var Ur=Nn[Dn];Rn[Dn]=La(Ur,qn)?gr[Ur]:u}return Rn})(wt,ye):Pt&&Ot>1&&wt.reverse(),Fe&&Ae<Ot&&(wt.length=Ae),this&&this!==Xn&&this instanceof gt&&(dn=bt||cl(dn)),dn.apply($t,wt)}}function Ha(w,h){return function(b,k){return(function(F,ie,pe,ye){return Ks(F,(function(Ae,De,Fe){ie(ye,pe(Ae),De,Fe)})),ye})(b,w,h(k),{})}}function ed(w,h){return function(b,k){var F;if(b===u&&k===u)return h;if(b!==u&&(F=b),k!==u){if(F===u)return k;typeof b=="string"||typeof k=="string"?(b=ra(b),k=ra(k)):(b=ja(b),k=ja(k)),F=w(b,k)}return F}}function Mu(w){return Kl((function(h){return h=Wi(h,Bo(br())),yr((function(b){var k=this;return w(h,(function(F){return Tl(F,k,b)}))}))}))}function ul(w,h){var b=(h=h===u?" ":ra(h)).length;if(b<2)return b?Lr(h,w):h;var k=Lr(h,Mc(w/vs(h)));return cp(h)?Mo(Ta(k),0,w).join(""):k.slice(0,w)}function to(w){return function(h,b,k){return k&&typeof k!="number"&&qo(h,b,k)&&(b=k=u),h=Nl(h),b===u?(b=h,h=0):b=Nl(b),(function(F,ie,pe,ye){for(var Ae=-1,De=mi(Mc((ie-F)/(pe||1)),0),Fe=tn(De);De--;)Fe[ye?De:++Ae]=F,F+=pe;return Fe})(h,b,k=k===u?h<b?1:-1:Nl(k),w)}}function fc(w){return function(h,b){return typeof h=="string"&&typeof b=="string"||(h=Wn(h),b=Wn(b)),w(h,b)}}function jo(w,h,b,k,F,ie,pe,ye,Ae,De){var Fe=8&h;h|=Fe?_:y,4&(h&=~(Fe?y:_))||(h&=-4);var Ye=[w,h,F,Fe?ie:u,Fe?pe:u,Fe?u:ie,Fe?u:pe,ye,Ae,De],dt=b.apply(u,Ye);return lg(w)&&Ud(dt,Ye),dt.placeholder=k,Z0(dt,w,h)}function Zg(w){var h=sl[w];return function(b,k){if(b=Wn(b),(k=k==null?0:Xi(mr(k),292))&&$l(b)){var F=($r(b)+"e").split("e");return+((F=($r(h(F[0]+"e"+(+F[1]+k)))+"e").split("e"))[0]+"e"+(+F[1]-k))}return h(b)}}var Da=wl&&1/Xu(new wl([,-0]))[1]==E?function(w){return new wl(w)}:cf;function Zs(w){return function(h){var b=dl(h);return b==J?jh(h):b==Z?eg(h):(function(k,F){return Wi(F,(function(ie){return[ie,k[ie]]}))})(h,w(h))}}function no(w,h,b,k,F,ie,pe,ye){var Ae=2&h;if(!Ae&&typeof w!="function")throw new ns(f);var De=k?k.length:0;if(De||(h&=-97,k=F=u),pe=pe===u?pe:mi(mr(pe),0),ye=ye===u?ye:mr(ye),De-=F?F.length:0,h&y){var Fe=k,Ye=F;k=F=u}var dt=Ae?u:ia(w),Et=[w,h,b,k,F,Fe,Ye,ie,pe,ye];if(dt&&(function(bt,gt){var Ot=bt[1],wt=gt[1],It=Ot|wt,Ft=It<131,Zt=wt==v&&Ot==8||wt==v&&Ot==x&&bt[7].length<=gt[8]||wt==384&&gt[7].length<=gt[8]&&Ot==8;if(!Ft&&!Zt)return bt;1&wt&&(bt[2]=gt[2],It|=1&Ot?0:4);var Gt=gt[3];if(Gt){var $t=bt[3];bt[3]=$t?Qh($t,Gt,gt[4]):Gt,bt[4]=$t?Yu(bt[3],g):gt[4]}(Gt=gt[5])&&($t=bt[5],bt[5]=$t?kl($t,Gt,gt[6]):Gt,bt[6]=$t?Yu(bt[5],g):gt[6]),(Gt=gt[7])&&(bt[7]=Gt),wt&v&&(bt[8]=bt[8]==null?gt[8]:Xi(bt[8],gt[8])),bt[9]==null&&(bt[9]=gt[9]),bt[0]=gt[0],bt[1]=It})(Et,dt),w=Et[0],h=Et[1],b=Et[2],k=Et[3],F=Et[4],!(ye=Et[9]=Et[9]===u?Ae?0:w.length:mi(Et[9]-De,0))&&24&h&&(h&=-25),h&&h!=1)Pt=h==8||h==p?(function(bt,gt,Ot){var wt=cl(bt);return function It(){for(var Ft=arguments.length,Zt=tn(Ft),Gt=Ft,$t=dr(It);Gt--;)Zt[Gt]=arguments[Gt];var dn=Ft<3&&Zt[0]!==$t&&Zt[Ft-1]!==$t?[]:Yu(Zt,$t);return(Ft-=dn.length)<Ot?jo(bt,gt,fs,It.placeholder,u,Zt,dn,u,u,Ot-Ft):Tl(this&&this!==Xn&&this instanceof It?wt:bt,this,Zt)}})(w,h,ye):h!=_&&h!=33||F.length?fs.apply(u,Et):(function(bt,gt,Ot,wt){var It=1&gt,Ft=cl(bt);return function Zt(){for(var Gt=-1,$t=arguments.length,dn=-1,Rn=wt.length,Nn=tn(Rn+$t),qn=this&&this!==Xn&&this instanceof Zt?Ft:bt;++dn<Rn;)Nn[dn]=wt[dn];for(;$t--;)Nn[dn++]=arguments[++Gt];return Tl(qn,It?Ot:this,Nn)}})(w,h,b,k);else var Pt=(function(bt,gt,Ot){var wt=1&gt,It=cl(bt);return function Ft(){return(this&&this!==Xn&&this instanceof Ft?It:bt).apply(wt?Ot:this,arguments)}})(w,h,b);return Z0((dt?mp:Ud)(Pt,Et),w,h)}function td(w,h,b,k){return w===u||ml(w,sr[b])&&!vr.call(k,b)?h:w}function nd(w,h,b,k,F,ie){return oa(w)&&oa(h)&&(ie.set(h,w),Xh(w,h,u,nd,ie),ie.delete(h)),w}function _p(w){return tu(w)?u:w}function fl(w,h,b,k,F,ie){var pe=1&b,ye=w.length,Ae=h.length;if(ye!=Ae&&!(pe&&Ae>ye))return!1;var De=ie.get(w),Fe=ie.get(h);if(De&&Fe)return De==h&&Fe==w;var Ye=-1,dt=!0,Et=2&b?new hn:u;for(ie.set(w,h),ie.set(h,w);++Ye<ye;){var Pt=w[Ye],bt=h[Ye];if(k)var gt=pe?k(bt,Pt,Ye,h,w,ie):k(Pt,bt,Ye,w,h,ie);if(gt!==u){if(gt)continue;dt=!1;break}if(Et){if(!Zm(h,(function(Ot,wt){if(!Ad(Et,wt)&&(Pt===Ot||F(Pt,Ot,b,k,ie)))return Et.push(wt)}))){dt=!1;break}}else if(Pt!==bt&&!F(Pt,bt,b,k,ie)){dt=!1;break}}return ie.delete(w),ie.delete(h),dt}function Kl(w){return cg(im(w,u,n0),w+"")}function vp(w){return Nc(w,Zi,yp)}function hl(w){return Nc(w,Zr,Ho)}var ia=kc?function(w){return kc.get(w)}:cf;function hc(w){for(var h=w.name+"",b=Rs[h],k=vr.call(Rs,h)?b.length:0;k--;){var F=b[k],ie=F.func;if(ie==null||ie==w)return F.name}return h}function dr(w){return(vr.call(ve,"placeholder")?ve:w).placeholder}function br(){var w=ve.iteratee||ds;return w=w===ds?Nf:w,arguments.length?w(arguments[0],arguments[1]):w}function rd(w,h){var b,k,F=w.__data__;return((k=typeof(b=h))=="string"||k=="number"||k=="symbol"||k=="boolean"?b!=="__proto__":b===null)?F[typeof h=="string"?"string":"hash"]:F.map}function mo(w){for(var h=Zi(w),b=h.length;b--;){var k=h[b],F=w[k];h[b]=[k,F,rm(F)]}return h}function Zl(w,h){var b=(function(k,F){return k==null?u:k[F]})(w,h);return po(b)?b:u}var yp=uo?function(w){return w==null?[]:(w=_r(w),wc(uo(w),(function(h){return Zp.call(w,h)})))}:jf,Ho=uo?function(w){for(var h=[];w;)Yi(h,yp(w)),w=Eu(w);return h}:jf,dl=gi;function id(w,h,b){for(var k=-1,F=(h=tf(h,w)).length,ie=!1;++k<F;){var pe=Ou(h[k]);if(!(ie=w!=null&&b(w,pe)))break;w=w[pe]}return ie||++k!=F?ie:!!(F=w==null?0:w.length)&&Il(F)&&La(pe,F)&&(Sr(w)||Ff(w))}function Qg(w){return typeof w.constructor!="function"||qa(w)?{}:cc(Eu(w))}function sf(w){return Sr(w)||Ff(w)||!!(Af&&w&&w[Af])}function La(w,h){var b=typeof w;return!!(h=h??M)&&(b=="number"||b!="symbol"&&Qe.test(w))&&w>-1&&w%1==0&&w<h}function qo(w,h,b){if(!oa(b))return!1;var k=typeof h;return!!(k=="number"?pc(b)&&La(h,b.length):k=="string"&&h in b)&&ml(b[h],w)}function Dd(w,h){if(Sr(w))return!1;var b=typeof w;return!(b!="number"&&b!="symbol"&&b!="boolean"&&w!=null&&!Vs(w))||ct.test(w)||!lt.test(w)||h!=null&&w in _r(h)}function lg(w){var h=hc(w),b=ve[h];if(typeof b!="function"||!(h in On.prototype))return!1;if(w===b)return!0;var k=ia(b);return!!k&&w===k[0]}(zs&&dl(new zs(new ArrayBuffer(1)))!=de||Mf&&dl(new Mf)!=J||xo&&dl(xo.resolve())!=Y||wl&&dl(new wl)!=Z||Ku&&dl(new Ku)!=le)&&(dl=function(w){var h=gi(w),b=h==q?w.constructor:u,k=b?pl(b):"";if(k)switch(k){case Kg:return de;case Xs:return J;case K0:return Y;case Rl:return Z;case hp:return le}return h});var nm=Cc?ys:Du;function qa(w){var h=w&&w.constructor;return w===(typeof h=="function"&&h.prototype||sr)}function rm(w){return w==w&&!oa(w)}function Jg(w,h){return function(b){return b!=null&&b[w]===h&&(h!==u||w in _r(b))}}function im(w,h,b){return h=mi(h===u?w.length-1:h,0),function(){for(var k=arguments,F=-1,ie=mi(k.length-h,0),pe=tn(ie);++F<ie;)pe[F]=k[h+F];F=-1;for(var ye=tn(h+1);++F<h;)ye[F]=k[F];return ye[h]=b(pe),Tl(w,this,ye)}}function sm(w,h){return h.length<2?w:ei(w,Pa(h,0,-1))}function Ld(w,h){if((h!=="constructor"||typeof w[h]!="function")&&h!="__proto__")return w[h]}var Ud=am(mp),ku=rg||function(w,h){return Xn.setTimeout(w,h)},cg=am(Fr);function Z0(w,h,b){var k=h+"";return cg(w,(function(F,ie){var pe=ie.length;if(!pe)return F;var ye=pe-1;return ie[ye]=(pe>1?"& ":"")+ie[ye],ie=ie.join(pe>2?", ":" "),F.replace(se,`{
/* [wrapped with `+ie+`] */
`)})(k,(function(F,ie){return Uo(I,(function(pe){var ye="_."+pe[0];ie&pe[1]&&!Gc(F,ye)&&F.push(ye)})),F.sort()})((function(F){var ie=F.match(_e);return ie?ie[1].split(Ne):[]})(k),b)))}function am(w){var h=0,b=0;return function(){var k=sg(),F=16-(k-b);if(b=k,F>0){if(++h>=800)return arguments[0]}else h=0;return w.apply(u,arguments)}}function Df(w,h){var b=-1,k=w.length,F=k-1;for(h=h===u?k:h;++b<h;){var ie=mh(b,F),pe=w[ie];w[ie]=w[b],w[b]=pe}return w.length=h,w}var Bd=(function(w){var h=Bf(w,(function(k){return b.size===500&&b.clear(),k})),b=h.cache;return h})((function(w){var h=[];return w.charCodeAt(0)===46&&h.push(""),w.replace(Vt,(function(b,k,F,ie){h.push(F?ie.replace(Re,"$1"):k||b)})),h}));function Ou(w){if(typeof w=="string"||Vs(w))return w;var h=w+"";return h=="0"&&1/w==-1/0?"-0":h}function pl(w){if(w!=null){try{return Oa.call(w)}catch{}try{return w+""}catch{}}return""}function Lc(w){if(w instanceof On)return w.clone();var h=new Ai(w.__wrapped__,w.__chain__);return h.__actions__=Hs(w.__actions__),h.__index__=w.__index__,h.__values__=w.__values__,h}var om=yr((function(w,h){return Li(w)?Ic(w,si(h,1,Li,!0)):[]})),e0=yr((function(w,h){var b=Iu(h);return Li(b)&&(b=u),Li(w)?Ic(w,si(h,1,Li,!0),br(b,2)):[]})),lm=yr((function(w,h){var b=Iu(h);return Li(b)&&(b=u),Li(w)?Ic(w,si(h,1,Li,!0),u,b):[]}));function ug(w,h,b){var k=w==null?0:w.length;if(!k)return-1;var F=b==null?0:mr(b);return F<0&&(F=mi(k+F,0)),$c(w,br(h,3),F)}function t0(w,h,b){var k=w==null?0:w.length;if(!k)return-1;var F=k-1;return b!==u&&(F=mr(b),F=b<0?mi(k+F,0):Xi(F,k-1)),$c(w,br(h,3),F,!0)}function n0(w){return w!=null&&w.length?si(w,1):[]}function cm(w){return w&&w.length?w[0]:u}var Q0=yr((function(w){var h=Wi(w,Ru);return h.length&&h[0]===w[0]?Md(h):[]})),um=yr((function(w){var h=Iu(w),b=Wi(w,Ru);return h===Iu(b)?h=u:b.pop(),b.length&&b[0]===w[0]?Md(b,br(h,2)):[]})),r0=yr((function(w){var h=Iu(w),b=Wi(w,Ru);return(h=typeof h=="function"?h:u)&&b.pop(),b.length&&b[0]===w[0]?Md(b,u,h):[]}));function Iu(w){var h=w==null?0:w.length;return h?w[h-1]:u}var Ql=yr(fg);function fg(w,h){return w&&w.length&&h&&h.length?pp(w,h):w}var hg=Kl((function(w,h){var b=w==null?0:w.length,k=dh(w,h);return Qu(w,Wi(h,(function(F){return La(F,b)?+F:F})).sort(Zh)),k}));function i0(w){return w==null?w:Fn.call(w)}var s0=yr((function(w){return Pc(si(w,1,Li,!0))})),J0=yr((function(w){var h=Iu(w);return Li(h)&&(h=u),Pc(si(w,1,Li,!0),br(h,2))})),Y_=yr((function(w){var h=Iu(w);return h=typeof h=="function"?h:u,Pc(si(w,1,Li,!0),u,h)}));function a0(w){if(!w||!w.length)return[];var h=0;return w=wc(w,(function(b){if(Li(b))return h=mi(b.length,h),!0})),Tf(h,(function(b){return Wi(w,sh(b))}))}function o0(w,h){if(!w||!w.length)return[];var b=a0(w);return h==null?b:Wi(b,(function(k){return Tl(h,u,k)}))}var e_=yr((function(w,h){return Li(w)?Ic(w,h):[]})),X_=yr((function(w){return Dc(wc(w,Li))})),dg=yr((function(w){var h=Iu(w);return Li(h)&&(h=u),Dc(wc(w,Li),br(h,2))})),pg=yr((function(w){var h=Iu(w);return h=typeof h=="function"?h:u,Dc(wc(w,Li),u,h)})),l0=yr(a0),K_=yr((function(w){var h=w.length,b=h>1?w[h-1]:u;return b=typeof b=="function"?(w.pop(),b):u,o0(w,b)}));function Jc(w){var h=ve(w);return h.__chain__=!0,h}function sd(w,h){return h(w)}var bp=Kl((function(w){var h=w.length,b=h?w[0]:0,k=this.__wrapped__,F=function(ie){return dh(ie,w)};return!(h>1||this.__actions__.length)&&k instanceof On&&La(b)?((k=k.slice(b,+b+(h?1:0))).__actions__.push({func:sd,args:[F],thisArg:u}),new Ai(k,this.__chain__).thru((function(ie){return h&&!ie.length&&ie.push(u),ie}))):this.thru(F)})),t_=Qc((function(w,h,b){vr.call(w,b)?++w[b]:Ia(w,b,1)})),Z_=rf(ug),Sp=rf(t0);function fm(w,h){return(Sr(w)?Uo:us)(w,br(h,3))}function Fd(w,h){return(Sr(w)?rl:uc)(w,br(h,3))}var gh=Qc((function(w,h,b){vr.call(w,b)?w[b].push(h):Ia(w,b,[h])})),Jl=yr((function(w,h,b){var k=-1,F=typeof h=="function",ie=pc(w)?tn(w.length):[];return us(w,(function(pe){ie[++k]=F?Tl(h,pe,b):al(pe,h,b)})),ie})),Nu=Qc((function(w,h,b){Ia(w,b,h)}));function Cs(w,h){return(Sr(w)?Wi:Jp)(w,br(h,3))}var _h=Qc((function(w,h,b){w[b?0:1].push(h)}),(function(){return[[],[]]})),n_=yr((function(w,h){if(w==null)return[];var b=h.length;return b>1&&qo(w,h[0],h[1])?h=[]:b>2&&qo(h[0],h[1],h[2])&&(h=[h[0]]),Na(w,si(h,1),[])})),qs=$_||function(){return Xn.Date.now()};function dc(w,h,b){return h=b?u:h,h=w&&h==null?w.length:h,no(w,v,u,u,u,u,h)}function Lf(w,h){var b;if(typeof h!="function")throw new ns(f);return w=mr(w),function(){return--w>0&&(b=h.apply(this,arguments)),w<=1&&(h=u),b}}var mg=yr((function(w,h,b){var k=1;if(b.length){var F=Yu(b,dr(mg));k|=_}return no(w,k,h,b,F)})),Uf=yr((function(w,h,b){var k=3;if(b.length){var F=Yu(b,dr(Uf));k|=_}return no(h,k,w,b,F)}));function af(w,h,b){var k,F,ie,pe,ye,Ae,De=0,Fe=!1,Ye=!1,dt=!0;if(typeof w!="function")throw new ns(f);function Et(wt){var It=k,Ft=F;return k=F=u,De=wt,pe=w.apply(Ft,It)}function Pt(wt){var It=wt-Ae;return Ae===u||It>=h||It<0||Ye&&wt-De>=ie}function bt(){var wt=qs();if(Pt(wt))return gt(wt);ye=ku(bt,(function(It){var Ft=h-(It-Ae);return Ye?Xi(Ft,ie-(It-De)):Ft})(wt))}function gt(wt){return ye=u,dt&&k?Et(wt):(k=F=u,pe)}function Ot(){var wt=qs(),It=Pt(wt);if(k=arguments,F=this,Ae=wt,It){if(ye===u)return(function(Ft){return De=Ft,ye=ku(bt,h),Fe?Et(Ft):pe})(Ae);if(Ye)return em(ye),ye=ku(bt,h),Et(Ae)}return ye===u&&(ye=ku(bt,h)),pe}return h=Wn(h)||0,oa(b)&&(Fe=!!b.leading,ie=(Ye="maxWait"in b)?mi(Wn(b.maxWait)||0,h):ie,dt="trailing"in b?!!b.trailing:dt),Ot.cancel=function(){ye!==u&&em(ye),De=0,k=Ae=F=ye=u},Ot.flush=function(){return ye===u?pe:gt(qs())},Ot}var go=yr((function(w,h){return Vh(w,1,h)})),ad=yr((function(w,h,b){return Vh(w,Wn(h)||0,b)}));function Bf(w,h){if(typeof w!="function"||h!=null&&typeof h!="function")throw new ns(f);var b=function(){var k=arguments,F=h?h.apply(this,k):k[0],ie=b.cache;if(ie.has(F))return ie.get(F);var pe=w.apply(this,k);return b.cache=ie.set(F,pe)||ie,pe};return b.cache=new(Bf.Cache||Ki),b}function ro(w){if(typeof w!="function")throw new ns(f);return function(){var h=arguments;switch(h.length){case 0:return!w.call(this);case 1:return!w.call(this,h[0]);case 2:return!w.call(this,h[0],h[1]);case 3:return!w.call(this,h[0],h[1],h[2])}return!w.apply(this,h)}}Bf.Cache=Ki;var Vo=nf((function(w,h){var b=(h=h.length==1&&Sr(h[0])?Wi(h[0],Bo(br())):Wi(si(h,1),Bo(br()))).length;return yr((function(k){for(var F=-1,ie=Xi(k.length,b);++F<ie;)k[F]=h[F].call(this,k[F]);return Tl(w,this,k)}))})),gg=yr((function(w,h){var b=Yu(h,dr(gg));return no(w,_,u,h,b)})),eu=yr((function(w,h){var b=Yu(h,dr(eu));return no(w,y,u,h,b)})),zd=Kl((function(w,h){return no(w,x,u,u,u,h)}));function ml(w,h){return w===h||w!=w&&h!=h}var sa=fc(Wh),Q_=fc((function(w,h){return w>=h})),Ff=Qn((function(){return arguments})())?Qn:function(w){return Hr(w)&&vr.call(w,"callee")&&!Zp.call(w,"callee")},Sr=tn.isArray,wr=pa?Bo(pa):function(w){return Hr(w)&&gi(w)==ce};function pc(w){return w!=null&&Il(w.length)&&!ys(w)}function Li(w){return Hr(w)&&pc(w)}var aa=Cf||Du,wa=zh?Bo(zh):function(w){return Hr(w)&&gi(w)==Q};function Va(w){if(!Hr(w))return!1;var h=gi(w);return h==B||h=="[object DOMException]"||typeof w.message=="string"&&typeof w.name=="string"&&!tu(w)}function ys(w){if(!oa(w))return!1;var h=gi(w);return h==$||h==U||h=="[object AsyncFunction]"||h=="[object Proxy]"}function Ga(w){return typeof w=="number"&&w==mr(w)}function Il(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=M}function oa(w){var h=typeof w;return w!=null&&(h=="object"||h=="function")}function Hr(w){return w!=null&&typeof w=="object"}var hs=lp?Bo(lp):function(w){return Hr(w)&&dl(w)==J};function Ra(w){return typeof w=="number"||Hr(w)&&gi(w)==W}function tu(w){if(!Hr(w)||gi(w)!=q)return!1;var h=Eu(w);if(h===null)return!0;var b=vr.call(h,"constructor")&&h.constructor;return typeof b=="function"&&b instanceof b&&Oa.call(b)==X0}var qi=Wp?Bo(Wp):function(w){return Hr(w)&&gi(w)==ae},$a=Yp?Bo(Yp):function(w){return Hr(w)&&dl(w)==Z};function of(w){return typeof w=="string"||!Sr(w)&&Hr(w)&&gi(w)==K}function Vs(w){return typeof w=="symbol"||Hr(w)&&gi(w)==ne}var Ms=rh?Bo(rh):function(w){return Hr(w)&&Il(w.length)&&!!Pr[gi(w)]},Ni=fc(Zc),io=fc((function(w,h){return w<=h}));function mc(w){if(!w)return[];if(pc(w))return of(w)?Ta(w):Hs(w);if(Yc&&w[Yc])return(function(b){for(var k,F=[];!(k=b.next()).done;)F.push(k.value);return F})(w[Yc]());var h=dl(w);return(h==J?jh:h==Z?Xu:ru)(w)}function Nl(w){return w?(w=Wn(w))===E||w===-1/0?17976931348623157e292*(w<0?-1:1):w==w?w:0:w===0?w:0}function mr(w){var h=Nl(w),b=h%1;return h==h?b?h-b:h:0}function fr(w){return w?Al(mr(w),0,N):0}function Wn(w){if(typeof w=="number")return w;if(Vs(w))return O;if(oa(w)){var h=typeof w.valueOf=="function"?w.valueOf():w;w=oa(h)?h+"":h}if(typeof w!="string")return w===0?w:+w;w=oh(w);var b=Ze.test(w);return b||vt.test(w)?ls(w.slice(2),b?2:8):tt.test(w)?O:+w}function Wa(w){return Ol(w,Zr(w))}function $r(w){return w==null?"":ra(w)}var rs=Nd((function(w,h){if(qa(h)||pc(h))Ol(h,Zi(h),w);else for(var b in h)vr.call(h,b)&&Oc(w,b,h[b])})),Pu=Nd((function(w,h){Ol(h,Zr(h),w)})),nu=Nd((function(w,h,b,k){Ol(h,Zr(h),w,k)})),ko=Nd((function(w,h,b,k){Ol(h,Zi(h),w,k)})),od=Kl(dh),ld=yr((function(w,h){w=_r(w);var b=-1,k=h.length,F=k>2?h[2]:u;for(F&&qo(h[0],h[1],F)&&(k=1);++b<k;)for(var ie=h[b],pe=Zr(ie),ye=-1,Ae=pe.length;++ye<Ae;){var De=pe[ye],Fe=w[De];(Fe===u||ml(Fe,sr[De])&&!vr.call(w,De))&&(w[De]=ie[De])}return w})),Ep=yr((function(w){return w.push(u,nd),Tl(vh,u,w)}));function la(w,h,b){var k=w==null?u:ei(w,h);return k===u?b:k}function xp(w,h){return w!=null&&id(w,h,W_)}var gl=Ha((function(w,h,b){h!=null&&typeof h.toString!="function"&&(h=Rf.call(h)),w[h]=b}),ud(Io)),_l=Ha((function(w,h,b){h!=null&&typeof h.toString!="function"&&(h=Rf.call(h)),vr.call(w,h)?w[h].push(b):w[h]=[b]}),br),Uc=yr(al);function Zi(w){return pc(w)?ag(w):Kc(w)}function Zr(w){return pc(w)?ag(w,!0):ph(w)}var so=Nd((function(w,h,b){Xh(w,h,b)})),vh=Nd((function(w,h,b,k){Xh(w,h,b,k)})),vl=Kl((function(w,h){var b={};if(w==null)return b;var k=!1;h=Wi(h,(function(ie){return ie=tf(ie,w),k||(k=ie.length>1),ie})),Ol(w,hl(w),b),k&&(b=js(b,7,_p));for(var F=h.length;F--;)Id(b,h[F]);return b})),_a=Kl((function(w,h){return w==null?{}:(function(b,k){return Kh(b,k,(function(F,ie){return xp(b,ie)}))})(w,h)}));function Go(w,h){if(w==null)return{};var b=Wi(hl(w),(function(k){return[k]}));return h=br(h),Kh(w,b,(function(k,F){return h(k,F[0])}))}var jd=Zs(Zi),zf=Zs(Zr);function ru(w){return w==null?[]:Vl(w,Zi(w))}var iu=Cu((function(w,h,b){return h=h.toLowerCase(),w+(b?yh(h):h)}));function yh(w){return _i($r(w).toLowerCase())}function lf(w){return(w=$r(w))&&w.replace(ht,Jm).replace(rr,"")}var ca=Cu((function(w,h,b){return w+(b?"-":"")+h.toLowerCase()})),Hd=Cu((function(w,h,b){return w+(b?" ":"")+h.toLowerCase()})),su=Jh("toLowerCase"),Gs=Cu((function(w,h,b){return w+(b?"_":"")+h.toLowerCase()})),Oo=Cu((function(w,h,b){return w+(b?" ":"")+_i(h)})),cd=Cu((function(w,h,b){return w+(b?" ":"")+h.toUpperCase()})),_i=Jh("toUpperCase");function ar(w,h,b){return w=$r(w),(h=b?u:h)===u?(function(k){return Cr.test(k)})(w)?(function(k){return k.match(ri)||[]})(w):(function(k){return k.match(Le)||[]})(w):w.match(h)||[]}var Ui=yr((function(w,h){try{return Tl(w,u,h)}catch(b){return Va(b)?b:new Zn(b)}})),$o=Kl((function(w,h){return Uo(h,(function(b){b=Ou(b),Ia(w,b,mg(w[b],w))})),w}));function ud(w){return function(){return w}}var bh=Kr(),_g=Kr(!0);function Io(w){return w}function ds(w){return Nf(typeof w=="function"?w:js(w,1))}var Qs=yr((function(w,h){return function(b){return al(b,w,h)}})),ec=yr((function(w,h){return function(b){return al(w,b,h)}}));function ks(w,h,b){var k=Zi(h),F=As(h,k);b!=null||oa(h)&&(F.length||!k.length)||(b=h,h=w,w=this,F=As(h,Zi(h)));var ie=!(oa(b)&&"chain"in b&&!b.chain),pe=ys(w);return Uo(F,(function(ye){var Ae=h[ye];w[ye]=Ae,pe&&(w.prototype[ye]=function(){var De=this.__chain__;if(ie||De){var Fe=w(this.__wrapped__);return(Fe.__actions__=Hs(this.__actions__)).push({func:Ae,args:arguments,thisArg:w}),Fe.__chain__=De,Fe}return Ae.apply(w,Yi([this.value()],arguments))})})),w}function cf(){}var ui=Mu(Wi),au=Mu(Xp),Sh=Mu(Zm);function fd(w){return Dd(w)?sh(Ou(w)):(function(h){return function(b){return ei(b,h)}})(w)}var hm=to(),va=to(!0);function jf(){return[]}function Du(){return!1}var j=ed((function(w,h){return w+h}),0),C=Zg("ceil"),P=ed((function(w,h){return w/h}),1),H=Zg("floor"),X,te=ed((function(w,h){return w*h}),1),ue=Zg("round"),Ee=ed((function(w,h){return w-h}),0);return ve.after=function(w,h){if(typeof h!="function")throw new ns(f);return w=mr(w),function(){if(--w<1)return h.apply(this,arguments)}},ve.ary=dc,ve.assign=rs,ve.assignIn=Pu,ve.assignInWith=nu,ve.assignWith=ko,ve.at=od,ve.before=Lf,ve.bind=mg,ve.bindAll=$o,ve.bindKey=Uf,ve.castArray=function(){if(!arguments.length)return[];var w=arguments[0];return Sr(w)?w:[w]},ve.chain=Jc,ve.chunk=function(w,h,b){h=(b?qo(w,h,b):h===u)?1:mi(mr(h),0);var k=w==null?0:w.length;if(!k||h<1)return[];for(var F=0,ie=0,pe=tn(Mc(k/h));F<k;)pe[ie++]=Pa(w,F,F+=h);return pe},ve.compact=function(w){for(var h=-1,b=w==null?0:w.length,k=0,F=[];++h<b;){var ie=w[h];ie&&(F[k++]=ie)}return F},ve.concat=function(){var w=arguments.length;if(!w)return[];for(var h=tn(w-1),b=arguments[0],k=w;k--;)h[k-1]=arguments[k];return Yi(Sr(b)?Hs(b):[b],si(h,1))},ve.cond=function(w){var h=w==null?0:w.length,b=br();return w=h?Wi(w,(function(k){if(typeof k[1]!="function")throw new ns(f);return[b(k[0]),k[1]]})):[],yr((function(k){for(var F=-1;++F<h;){var ie=w[F];if(Tl(ie[0],this,k))return Tl(ie[1],this,k)}}))},ve.conforms=function(w){return(function(h){var b=Zi(h);return function(k){return Cl(k,h,b)}})(js(w,1))},ve.constant=ud,ve.countBy=t_,ve.create=function(w,h){var b=cc(w);return h==null?b:wo(b,h)},ve.curry=function w(h,b,k){var F=no(h,8,u,u,u,u,u,b=k?u:b);return F.placeholder=w.placeholder,F},ve.curryRight=function w(h,b,k){var F=no(h,p,u,u,u,u,u,b=k?u:b);return F.placeholder=w.placeholder,F},ve.debounce=af,ve.defaults=ld,ve.defaultsDeep=Ep,ve.defer=go,ve.delay=ad,ve.difference=om,ve.differenceBy=e0,ve.differenceWith=lm,ve.drop=function(w,h,b){var k=w==null?0:w.length;return k?Pa(w,(h=b||h===u?1:mr(h))<0?0:h,k):[]},ve.dropRight=function(w,h,b){var k=w==null?0:w.length;return k?Pa(w,0,(h=k-(h=b||h===u?1:mr(h)))<0?0:h):[]},ve.dropRightWhile=function(w,h){return w&&w.length?eo(w,br(h,3),!0,!0):[]},ve.dropWhile=function(w,h){return w&&w.length?eo(w,br(h,3),!0):[]},ve.fill=function(w,h,b,k){var F=w==null?0:w.length;return F?(b&&typeof b!="number"&&qo(w,h,b)&&(b=0,k=F),(function(ie,pe,ye,Ae){var De=ie.length;for((ye=mr(ye))<0&&(ye=-ye>De?0:De+ye),(Ae=Ae===u||Ae>De?De:mr(Ae))<0&&(Ae+=De),Ae=ye>Ae?0:fr(Ae);ye<Ae;)ie[ye++]=pe;return ie})(w,h,b,k)):[]},ve.filter=function(w,h){return(Sr(w)?wc:Tu)(w,br(h,3))},ve.flatMap=function(w,h){return si(Cs(w,h),1)},ve.flatMapDeep=function(w,h){return si(Cs(w,h),E)},ve.flatMapDepth=function(w,h,b){return b=b===u?1:mr(b),si(Cs(w,h),b)},ve.flatten=n0,ve.flattenDeep=function(w){return w!=null&&w.length?si(w,E):[]},ve.flattenDepth=function(w,h){return w!=null&&w.length?si(w,h=h===u?1:mr(h)):[]},ve.flip=function(w){return no(w,512)},ve.flow=bh,ve.flowRight=_g,ve.fromPairs=function(w){for(var h=-1,b=w==null?0:w.length,k={};++h<b;){var F=w[h];k[F[0]]=F[1]}return k},ve.functions=function(w){return w==null?[]:As(w,Zi(w))},ve.functionsIn=function(w){return w==null?[]:As(w,Zr(w))},ve.groupBy=gh,ve.initial=function(w){return w!=null&&w.length?Pa(w,0,-1):[]},ve.intersection=Q0,ve.intersectionBy=um,ve.intersectionWith=r0,ve.invert=gl,ve.invertBy=_l,ve.invokeMap=Jl,ve.iteratee=ds,ve.keyBy=Nu,ve.keys=Zi,ve.keysIn=Zr,ve.map=Cs,ve.mapKeys=function(w,h){var b={};return h=br(h,3),Ks(w,(function(k,F,ie){Ia(b,h(k,F,ie),k)})),b},ve.mapValues=function(w,h){var b={};return h=br(h,3),Ks(w,(function(k,F,ie){Ia(b,F,h(k,F,ie))})),b},ve.matches=function(w){return kd(js(w,1))},ve.matchesProperty=function(w,h){return Ao(w,js(h,1))},ve.memoize=Bf,ve.merge=so,ve.mergeWith=vh,ve.method=Qs,ve.methodOf=ec,ve.mixin=ks,ve.negate=ro,ve.nthArg=function(w){return w=mr(w),yr((function(h){return Zu(h,w)}))},ve.omit=vl,ve.omitBy=function(w,h){return Go(w,ro(br(h)))},ve.once=function(w){return Lf(2,w)},ve.orderBy=function(w,h,b,k){return w==null?[]:(Sr(h)||(h=h==null?[]:[h]),Sr(b=k?u:b)||(b=b==null?[]:[b]),Na(w,h,b))},ve.over=ui,ve.overArgs=Vo,ve.overEvery=au,ve.overSome=Sh,ve.partial=gg,ve.partialRight=eu,ve.partition=_h,ve.pick=_a,ve.pickBy=Go,ve.property=fd,ve.propertyOf=function(w){return function(h){return w==null?u:ei(w,h)}},ve.pull=Ql,ve.pullAll=fg,ve.pullAllBy=function(w,h,b){return w&&w.length&&h&&h.length?pp(w,h,br(b,2)):w},ve.pullAllWith=function(w,h,b){return w&&w.length&&h&&h.length?pp(w,h,u,b):w},ve.pullAt=hg,ve.range=hm,ve.rangeRight=va,ve.rearg=zd,ve.reject=function(w,h){return(Sr(w)?wc:Tu)(w,ro(br(h,3)))},ve.remove=function(w,h){var b=[];if(!w||!w.length)return b;var k=-1,F=[],ie=w.length;for(h=br(h,3);++k<ie;){var pe=w[k];h(pe,k,w)&&(b.push(pe),F.push(k))}return Qu(w,F),b},ve.rest=function(w,h){if(typeof w!="function")throw new ns(f);return yr(w,h=h===u?h:mr(h))},ve.reverse=i0,ve.sampleSize=function(w,h,b){return h=(b?qo(w,h,b):h===u)?1:mr(h),(Sr(w)?If:Yl)(w,h)},ve.set=function(w,h,b){return w==null?w:xi(w,h,b)},ve.setWith=function(w,h,b,k){return k=typeof k=="function"?k:u,w==null?w:xi(w,h,b,k)},ve.shuffle=function(w){return(Sr(w)?og:Ml)(w)},ve.slice=function(w,h,b){var k=w==null?0:w.length;return k?(b&&typeof b!="number"&&qo(w,h,b)?(h=0,b=k):(h=h==null?0:mr(h),b=b===u?k:mr(b)),Pa(w,h,b)):[]},ve.sortBy=n_,ve.sortedUniq=function(w){return w&&w.length?Xl(w):[]},ve.sortedUniqBy=function(w,h){return w&&w.length?Xl(w,br(h,2)):[]},ve.split=function(w,h,b){return b&&typeof b!="number"&&qo(w,h,b)&&(h=b=u),(b=b===u?N:b>>>0)?(w=$r(w))&&(typeof h=="string"||h!=null&&!qi(h))&&!(h=ra(h))&&cp(w)?Mo(Ta(w),0,b):w.split(h,b):[]},ve.spread=function(w,h){if(typeof w!="function")throw new ns(f);return h=h==null?0:mi(mr(h),0),yr((function(b){var k=b[h],F=Mo(b,0,h);return k&&Yi(F,k),Tl(w,this,F)}))},ve.tail=function(w){var h=w==null?0:w.length;return h?Pa(w,1,h):[]},ve.take=function(w,h,b){return w&&w.length?Pa(w,0,(h=b||h===u?1:mr(h))<0?0:h):[]},ve.takeRight=function(w,h,b){var k=w==null?0:w.length;return k?Pa(w,(h=k-(h=b||h===u?1:mr(h)))<0?0:h,k):[]},ve.takeRightWhile=function(w,h){return w&&w.length?eo(w,br(h,3),!1,!0):[]},ve.takeWhile=function(w,h){return w&&w.length?eo(w,br(h,3)):[]},ve.tap=function(w,h){return h(w),w},ve.throttle=function(w,h,b){var k=!0,F=!0;if(typeof w!="function")throw new ns(f);return oa(b)&&(k="leading"in b?!!b.leading:k,F="trailing"in b?!!b.trailing:F),af(w,h,{leading:k,maxWait:h,trailing:F})},ve.thru=sd,ve.toArray=mc,ve.toPairs=jd,ve.toPairsIn=zf,ve.toPath=function(w){return Sr(w)?Wi(w,Ou):Vs(w)?[w]:Hs(Bd($r(w)))},ve.toPlainObject=Wa,ve.transform=function(w,h,b){var k=Sr(w),F=k||aa(w)||Ms(w);if(h=br(h,4),b==null){var ie=w&&w.constructor;b=F?k?new ie:[]:oa(w)&&ys(ie)?cc(Eu(w)):{}}return(F?Uo:Ks)(w,(function(pe,ye,Ae){return h(b,pe,ye,Ae)})),b},ve.unary=function(w){return dc(w,1)},ve.union=s0,ve.unionBy=J0,ve.unionWith=Y_,ve.uniq=function(w){return w&&w.length?Pc(w):[]},ve.uniqBy=function(w,h){return w&&w.length?Pc(w,br(h,2)):[]},ve.uniqWith=function(w,h){return h=typeof h=="function"?h:u,w&&w.length?Pc(w,u,h):[]},ve.unset=function(w,h){return w==null||Id(w,h)},ve.unzip=a0,ve.unzipWith=o0,ve.update=function(w,h,b){return w==null?w:wu(w,h,Co(b))},ve.updateWith=function(w,h,b,k){return k=typeof k=="function"?k:u,w==null?w:wu(w,h,Co(b),k)},ve.values=ru,ve.valuesIn=function(w){return w==null?[]:Vl(w,Zr(w))},ve.without=e_,ve.words=ar,ve.wrap=function(w,h){return gg(Co(h),w)},ve.xor=X_,ve.xorBy=dg,ve.xorWith=pg,ve.zip=l0,ve.zipObject=function(w,h){return ef(w||[],h||[],Oc)},ve.zipObjectDeep=function(w,h){return ef(w||[],h||[],xi)},ve.zipWith=K_,ve.entries=jd,ve.entriesIn=zf,ve.extend=Pu,ve.extendWith=nu,ks(ve,ve),ve.add=j,ve.attempt=Ui,ve.camelCase=iu,ve.capitalize=yh,ve.ceil=C,ve.clamp=function(w,h,b){return b===u&&(b=h,h=u),b!==u&&(b=(b=Wn(b))==b?b:0),h!==u&&(h=(h=Wn(h))==h?h:0),Al(Wn(w),h,b)},ve.clone=function(w){return js(w,4)},ve.cloneDeep=function(w){return js(w,5)},ve.cloneDeepWith=function(w,h){return js(w,5,h=typeof h=="function"?h:u)},ve.cloneWith=function(w,h){return js(w,4,h=typeof h=="function"?h:u)},ve.conformsTo=function(w,h){return h==null||Cl(w,h,Zi(h))},ve.deburr=lf,ve.defaultTo=function(w,h){return w==null||w!=w?h:w},ve.divide=P,ve.endsWith=function(w,h,b){w=$r(w),h=ra(h);var k=w.length,F=b=b===u?k:Al(mr(b),0,k);return(b-=h.length)>=0&&w.slice(b,F)==h},ve.eq=ml,ve.escape=function(w){return(w=$r(w))&&Ie.test(w)?w.replace(me,q_):w},ve.escapeRegExp=function(w){return(w=$r(w))&&Ut.test(w)?w.replace(kt,"\\$&"):w},ve.every=function(w,h,b){var k=Sr(w)?Xp:Gh;return b&&qo(w,h,b)&&(h=u),k(w,br(h,3))},ve.find=Z_,ve.findIndex=ug,ve.findKey=function(w,h){return co(w,br(h,3),Ks)},ve.findLast=Sp,ve.findLastIndex=t0,ve.findLastKey=function(w,h){return co(w,br(h,3),Ro)},ve.floor=H,ve.forEach=fm,ve.forEachRight=Fd,ve.forIn=function(w,h){return w==null?w:$h(w,br(h,3),Zr)},ve.forInRight=function(w,h){return w==null?w:Qp(w,br(h,3),Zr)},ve.forOwn=function(w,h){return w&&Ks(w,br(h,3))},ve.forOwnRight=function(w,h){return w&&Ro(w,br(h,3))},ve.get=la,ve.gt=sa,ve.gte=Q_,ve.has=function(w,h){return w!=null&&id(w,h,Yh)},ve.hasIn=xp,ve.head=cm,ve.identity=Io,ve.includes=function(w,h,b,k){w=pc(w)?w:ru(w),b=b&&!k?mr(b):0;var F=w.length;return b<0&&(b=mi(F+b,0)),of(w)?b<=F&&w.indexOf(h,b)>-1:!!F&&Wc(w,h,b)>-1},ve.indexOf=function(w,h,b){var k=w==null?0:w.length;if(!k)return-1;var F=b==null?0:mr(b);return F<0&&(F=mi(k+F,0)),Wc(w,h,F)},ve.inRange=function(w,h,b){return h=Nl(h),b===u?(b=h,h=0):b=Nl(b),(function(k,F,ie){return k>=Xi(F,ie)&&k<mi(F,ie)})(w=Wn(w),h,b)},ve.invoke=Uc,ve.isArguments=Ff,ve.isArray=Sr,ve.isArrayBuffer=wr,ve.isArrayLike=pc,ve.isArrayLikeObject=Li,ve.isBoolean=function(w){return w===!0||w===!1||Hr(w)&&gi(w)==G},ve.isBuffer=aa,ve.isDate=wa,ve.isElement=function(w){return Hr(w)&&w.nodeType===1&&!tu(w)},ve.isEmpty=function(w){if(w==null)return!0;if(pc(w)&&(Sr(w)||typeof w=="string"||typeof w.splice=="function"||aa(w)||Ms(w)||Ff(w)))return!w.length;var h=dl(w);if(h==J||h==Z)return!w.size;if(qa(w))return!Kc(w).length;for(var b in w)if(vr.call(w,b))return!1;return!0},ve.isEqual=function(w,h){return Ii(w,h)},ve.isEqualWith=function(w,h,b){var k=(b=typeof b=="function"?b:u)?b(w,h):u;return k===u?Ii(w,h,u,b):!!k},ve.isError=Va,ve.isFinite=function(w){return typeof w=="number"&&$l(w)},ve.isFunction=ys,ve.isInteger=Ga,ve.isLength=Il,ve.isMap=hs,ve.isMatch=function(w,h){return w===h||Xc(w,h,mo(h))},ve.isMatchWith=function(w,h,b){return b=typeof b=="function"?b:u,Xc(w,h,mo(h),b)},ve.isNaN=function(w){return Ra(w)&&w!=+w},ve.isNative=function(w){if(nm(w))throw new Zn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return po(w)},ve.isNil=function(w){return w==null},ve.isNull=function(w){return w===null},ve.isNumber=Ra,ve.isObject=oa,ve.isObjectLike=Hr,ve.isPlainObject=tu,ve.isRegExp=qi,ve.isSafeInteger=function(w){return Ga(w)&&w>=-9007199254740991&&w<=M},ve.isSet=$a,ve.isString=of,ve.isSymbol=Vs,ve.isTypedArray=Ms,ve.isUndefined=function(w){return w===u},ve.isWeakMap=function(w){return Hr(w)&&dl(w)==le},ve.isWeakSet=function(w){return Hr(w)&&gi(w)=="[object WeakSet]"},ve.join=function(w,h){return w==null?"":ig.call(w,h)},ve.kebabCase=ca,ve.last=Iu,ve.lastIndexOf=function(w,h,b){var k=w==null?0:w.length;if(!k)return-1;var F=k;return b!==u&&(F=(F=mr(b))<0?mi(k+F,0):Xi(F,k-1)),h==h?(function(ie,pe,ye){for(var Ae=ye+1;Ae--;)if(ie[Ae]===pe)return Ae;return Ae})(w,h,F):$c(w,ma,F,!0)},ve.lowerCase=Hd,ve.lowerFirst=su,ve.lt=Ni,ve.lte=io,ve.max=function(w){return w&&w.length?Wl(w,Io,Wh):u},ve.maxBy=function(w,h){return w&&w.length?Wl(w,br(h,2),Wh):u},ve.mean=function(w){return xf(w,Io)},ve.meanBy=function(w,h){return xf(w,br(h,2))},ve.min=function(w){return w&&w.length?Wl(w,Io,Zc):u},ve.minBy=function(w,h){return w&&w.length?Wl(w,br(h,2),Zc):u},ve.stubArray=jf,ve.stubFalse=Du,ve.stubObject=function(){return{}},ve.stubString=function(){return""},ve.stubTrue=function(){return!0},ve.multiply=te,ve.nth=function(w,h){return w&&w.length?Zu(w,mr(h)):u},ve.noConflict=function(){return Xn._===this&&(Xn._=Gl),this},ve.noop=cf,ve.now=qs,ve.pad=function(w,h,b){w=$r(w);var k=(h=mr(h))?vs(w):0;if(!h||k>=h)return w;var F=(h-k)/2;return ul(Cd(F),b)+w+ul(Mc(F),b)},ve.padEnd=function(w,h,b){w=$r(w);var k=(h=mr(h))?vs(w):0;return h&&k<h?w+ul(h-k,b):w},ve.padStart=function(w,h,b){w=$r(w);var k=(h=mr(h))?vs(w):0;return h&&k<h?ul(h-k,b)+w:w},ve.parseInt=function(w,h,b){return b||h==null?h=0:h&&(h=+h),hh($r(w).replace(je,""),h||0)},ve.random=function(w,h,b){if(b&&typeof b!="boolean"&&qo(w,h,b)&&(h=b=u),b===u&&(typeof h=="boolean"?(b=h,h=u):typeof w=="boolean"&&(b=w,w=u)),w===u&&h===u?(w=0,h=1):(w=Nl(w),h===u?(h=w,w=0):h=Nl(h)),w>h){var k=w;w=h,h=k}if(b||w%1||h%1){var F=fp();return Xi(w+F*(h-w+Do("1e-"+((F+"").length-1))),h)}return mh(w,h)},ve.reduce=function(w,h,b){var k=Sr(w)?Rc:Qm,F=arguments.length<3;return k(w,br(h,4),b,F,us)},ve.reduceRight=function(w,h,b){var k=Sr(w)?Ef:Qm,F=arguments.length<3;return k(w,br(h,4),b,F,uc)},ve.repeat=function(w,h,b){return h=(b?qo(w,h,b):h===u)?1:mr(h),Lr($r(w),h)},ve.replace=function(){var w=arguments,h=$r(w[0]);return w.length<3?h:h.replace(w[1],w[2])},ve.result=function(w,h,b){var k=-1,F=(h=tf(h,w)).length;for(F||(F=1,w=u);++k<F;){var ie=w==null?u:w[Ou(h[k])];ie===u&&(k=F,ie=b),w=ys(ie)?ie.call(w):ie}return w},ve.round=ue,ve.runInContext=rt,ve.sample=function(w){return(Sr(w)?Of:ol)(w)},ve.size=function(w){if(w==null)return 0;if(pc(w))return of(w)?vs(w):w.length;var h=dl(w);return h==J||h==Z?w.size:Kc(w).length},ve.snakeCase=Gs,ve.some=function(w,h,b){var k=Sr(w)?Zm:Od;return b&&qo(w,h,b)&&(h=u),k(w,br(h,3))},ve.sortedIndex=function(w,h){return gp(w,h)},ve.sortedIndexBy=function(w,h,b){return ll(w,h,br(b,2))},ve.sortedIndexOf=function(w,h){var b=w==null?0:w.length;if(b){var k=gp(w,h);if(k<b&&ml(w[k],h))return k}return-1},ve.sortedLastIndex=function(w,h){return gp(w,h,!0)},ve.sortedLastIndexBy=function(w,h,b){return ll(w,h,br(b,2),!0)},ve.sortedLastIndexOf=function(w,h){if(w!=null&&w.length){var b=gp(w,h,!0)-1;if(ml(w[b],h))return b}return-1},ve.startCase=Oo,ve.startsWith=function(w,h,b){return w=$r(w),b=b==null?0:Al(mr(b),0,w.length),h=ra(h),w.slice(b,b+h.length)==h},ve.subtract=Ee,ve.sum=function(w){return w&&w.length?Wu(w,Io):0},ve.sumBy=function(w,h){return w&&w.length?Wu(w,br(h,2)):0},ve.template=function(w,h,b){var k=ve.templateSettings;b&&qo(w,h,b)&&(h=u),w=$r(w),h=nu({},h,k,td);var F,ie,pe=nu({},h.imports,k.imports,td),ye=Zi(pe),Ae=Vl(pe,ye),De=0,Fe=h.interpolate||mt,Ye="__p += '",dt=So((h.escape||mt).source+"|"+Fe.source+"|"+(Fe===ot?st:mt).source+"|"+(h.evaluate||mt).source+"|$","g"),Et="//# sourceURL="+(vr.call(h,"sourceURL")?(h.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Tr+"]")+`
`;w.replace(dt,(function(gt,Ot,wt,It,Ft,Zt){return wt||(wt=It),Ye+=w.slice(De,Zt).replace(ft,V_),Ot&&(F=!0,Ye+=`' +
__e(`+Ot+`) +
'`),Ft&&(ie=!0,Ye+=`';
`+Ft+`;
__p += '`),wt&&(Ye+=`' +
((__t = (`+wt+`)) == null ? '' : __t) +
'`),De=Zt+gt.length,gt})),Ye+=`';
`;var Pt=vr.call(h,"variable")&&h.variable;if(Pt){if(ke.test(Pt))throw new Zn("Invalid `variable` option passed into `_.template`")}else Ye=`with (obj) {
`+Ye+`
}
`;Ye=(ie?Ye.replace(Ue,""):Ye).replace(Ge,"$1").replace(ze,"$1;"),Ye="function("+(Pt||"obj")+`) {
`+(Pt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(F?", __e = _.escape":"")+(ie?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ye+`return __p
}`;var bt=Ui((function(){return Ri(ye,Et+"return "+Ye).apply(u,Ae)}));if(bt.source=Ye,Va(bt))throw bt;return bt},ve.times=function(w,h){if((w=mr(w))<1||w>M)return[];var b=N,k=Xi(w,N);h=br(h),w-=N;for(var F=Tf(k,h);++b<w;)h(b);return F},ve.toFinite=Nl,ve.toInteger=mr,ve.toLength=fr,ve.toLower=function(w){return $r(w).toLowerCase()},ve.toNumber=Wn,ve.toSafeInteger=function(w){return w?Al(mr(w),-9007199254740991,M):w===0?w:0},ve.toString=$r,ve.toUpper=function(w){return $r(w).toUpperCase()},ve.trim=function(w,h,b){if((w=$r(w))&&(b||h===u))return oh(w);if(!w||!(h=ra(h)))return w;var k=Ta(w),F=Ta(h);return Mo(k,Kp(k,F),il(k,F)+1).join("")},ve.trimEnd=function(w,h,b){if((w=$r(w))&&(b||h===u))return w.slice(0,up(w)+1);if(!w||!(h=ra(h)))return w;var k=Ta(w);return Mo(k,0,il(k,Ta(h))+1).join("")},ve.trimStart=function(w,h,b){if((w=$r(w))&&(b||h===u))return w.replace(je,"");if(!w||!(h=ra(h)))return w;var k=Ta(w);return Mo(k,Kp(k,Ta(h))).join("")},ve.truncate=function(w,h){var b=30,k="...";if(oa(h)){var F="separator"in h?h.separator:F;b="length"in h?mr(h.length):b,k="omission"in h?ra(h.omission):k}var ie=(w=$r(w)).length;if(cp(w)){var pe=Ta(w);ie=pe.length}if(b>=ie)return w;var ye=b-vs(k);if(ye<1)return k;var Ae=pe?Mo(pe,0,ye).join(""):w.slice(0,ye);if(F===u)return Ae+k;if(pe&&(ye+=Ae.length-ye),qi(F)){if(w.slice(ye).search(F)){var De,Fe=Ae;for(F.global||(F=So(F.source,$r(Ve.exec(F))+"g")),F.lastIndex=0;De=F.exec(Fe);)var Ye=De.index;Ae=Ae.slice(0,Ye===u?ye:Ye)}}else if(w.indexOf(ra(F),ye)!=ye){var dt=Ae.lastIndexOf(F);dt>-1&&(Ae=Ae.slice(0,dt))}return Ae+k},ve.unescape=function(w){return(w=$r(w))&&Se.test(w)?w.replace(Be,tg):w},ve.uniqueId=function(w){var h=++Vr;return $r(w)+h},ve.upperCase=cd,ve.upperFirst=_i,ve.each=fm,ve.eachRight=Fd,ve.first=cm,ks(ve,(X={},Ks(ve,(function(w,h){vr.call(ve.prototype,h)||(X[h]=w)})),X),{chain:!1}),ve.VERSION="4.17.21",Uo(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(w){ve[w].placeholder=ve})),Uo(["drop","take"],(function(w,h){On.prototype[w]=function(b){b=b===u?1:mi(mr(b),0);var k=this.__filtered__&&!h?new On(this):this.clone();return k.__filtered__?k.__takeCount__=Xi(b,k.__takeCount__):k.__views__.push({size:Xi(b,N),type:w+(k.__dir__<0?"Right":"")}),k},On.prototype[w+"Right"]=function(b){return this.reverse()[w](b).reverse()}})),Uo(["filter","map","takeWhile"],(function(w,h){var b=h+1,k=b==1||b==3;On.prototype[w]=function(F){var ie=this.clone();return ie.__iteratees__.push({iteratee:br(F,3),type:b}),ie.__filtered__=ie.__filtered__||k,ie}})),Uo(["head","last"],(function(w,h){var b="take"+(h?"Right":"");On.prototype[w]=function(){return this[b](1).value()[0]}})),Uo(["initial","tail"],(function(w,h){var b="drop"+(h?"":"Right");On.prototype[w]=function(){return this.__filtered__?new On(this):this[b](1)}})),On.prototype.compact=function(){return this.filter(Io)},On.prototype.find=function(w){return this.filter(w).head()},On.prototype.findLast=function(w){return this.reverse().find(w)},On.prototype.invokeMap=yr((function(w,h){return typeof w=="function"?new On(this):this.map((function(b){return al(b,w,h)}))})),On.prototype.reject=function(w){return this.filter(ro(br(w)))},On.prototype.slice=function(w,h){w=mr(w);var b=this;return b.__filtered__&&(w>0||h<0)?new On(b):(w<0?b=b.takeRight(-w):w&&(b=b.drop(w)),h!==u&&(b=(h=mr(h))<0?b.dropRight(-h):b.take(h-w)),b)},On.prototype.takeRightWhile=function(w){return this.reverse().takeWhile(w).reverse()},On.prototype.toArray=function(){return this.take(N)},Ks(On.prototype,(function(w,h){var b=/^(?:filter|find|map|reject)|While$/.test(h),k=/^(?:head|last)$/.test(h),F=ve[k?"take"+(h=="last"?"Right":""):h],ie=k||/^find/.test(h);F&&(ve.prototype[h]=function(){var pe=this.__wrapped__,ye=k?[1]:arguments,Ae=pe instanceof On,De=ye[0],Fe=Ae||Sr(pe),Ye=function(Ot){var wt=F.apply(ve,Yi([Ot],ye));return k&&dt?wt[0]:wt};Fe&&b&&typeof De=="function"&&De.length!=1&&(Ae=Fe=!1);var dt=this.__chain__,Et=!!this.__actions__.length,Pt=ie&&!dt,bt=Ae&&!Et;if(!ie&&Fe){pe=bt?pe:new On(this);var gt=w.apply(pe,ye);return gt.__actions__.push({func:sd,args:[Ye],thisArg:u}),new Ai(gt,dt)}return Pt&&bt?w.apply(this,ye):(gt=this.thru(Ye),Pt?k?gt.value()[0]:gt.value():gt)})})),Uo(["pop","push","shift","sort","splice","unshift"],(function(w){var h=Ac[w],b=/^(?:push|sort|unshift)$/.test(w)?"tap":"thru",k=/^(?:pop|shift)$/.test(w);ve.prototype[w]=function(){var F=arguments;if(k&&!this.__chain__){var ie=this.value();return h.apply(Sr(ie)?ie:[],F)}return this[b]((function(pe){return h.apply(Sr(pe)?pe:[],F)}))}})),Ks(On.prototype,(function(w,h){var b=ve[h];if(b){var k=b.name+"";vr.call(Rs,k)||(Rs[k]=[]),Rs[k].push({name:h,func:b})}})),Rs[fs(u,2).name]=[{name:"wrapper",func:u}],On.prototype.clone=function(){var w=new On(this.__wrapped__);return w.__actions__=Hs(this.__actions__),w.__dir__=this.__dir__,w.__filtered__=this.__filtered__,w.__iteratees__=Hs(this.__iteratees__),w.__takeCount__=this.__takeCount__,w.__views__=Hs(this.__views__),w},On.prototype.reverse=function(){if(this.__filtered__){var w=new On(this);w.__dir__=-1,w.__filtered__=!0}else(w=this.clone()).__dir__*=-1;return w},On.prototype.value=function(){var w=this.__wrapped__.value(),h=this.__dir__,b=Sr(w),k=h<0,F=b?w.length:0,ie=(function(Zt,Gt,$t){for(var dn=-1,Rn=$t.length;++dn<Rn;){var Nn=$t[dn],qn=Nn.size;switch(Nn.type){case"drop":Zt+=qn;break;case"dropRight":Gt-=qn;break;case"take":Gt=Xi(Gt,Zt+qn);break;case"takeRight":Zt=mi(Zt,Gt-qn)}}return{start:Zt,end:Gt}})(0,F,this.__views__),pe=ie.start,ye=ie.end,Ae=ye-pe,De=k?ye:pe-1,Fe=this.__iteratees__,Ye=Fe.length,dt=0,Et=Xi(Ae,this.__takeCount__);if(!b||!k&&F==Ae&&Et==Ae)return Ju(w,this.__actions__);var Pt=[];e:for(;Ae--&&dt<Et;){for(var bt=-1,gt=w[De+=h];++bt<Ye;){var Ot=Fe[bt],wt=Ot.iteratee,It=Ot.type,Ft=wt(gt);if(It==2)gt=Ft;else if(!Ft){if(It==1)continue e;break e}}Pt[dt++]=gt}return Pt},ve.prototype.at=bp,ve.prototype.chain=function(){return Jc(this)},ve.prototype.commit=function(){return new Ai(this.value(),this.__chain__)},ve.prototype.next=function(){this.__values__===u&&(this.__values__=mc(this.value()));var w=this.__index__>=this.__values__.length;return{done:w,value:w?u:this.__values__[this.__index__++]}},ve.prototype.plant=function(w){for(var h,b=this;b instanceof Ja;){var k=Lc(b);k.__index__=0,k.__values__=u,h?F.__wrapped__=k:h=k;var F=k;b=b.__wrapped__}return F.__wrapped__=w,h},ve.prototype.reverse=function(){var w=this.__wrapped__;if(w instanceof On){var h=w;return this.__actions__.length&&(h=new On(this)),(h=h.reverse()).__actions__.push({func:sd,args:[i0],thisArg:u}),new Ai(h,this.__chain__)}return this.thru(i0)},ve.prototype.toJSON=ve.prototype.valueOf=ve.prototype.value=function(){return Ju(this.__wrapped__,this.__actions__)},ve.prototype.first=ve.prototype.head,Yc&&(ve.prototype[Yc]=function(){return this}),ve})();Xn._=qh,(c=(function(){return qh}).call(o,l,o,a))===u||(a.exports=c)}).call(this)},5364:(a,o,l)=>{var c=l(5250),u=l(999)((function(f,d,g){c(f,d,g)}));a.exports=u},9935:a=>{a.exports=function(){return!1}},9884:(a,o,l)=>{var c=l(1791),u=l(7241);a.exports=function(f){return c(f,u(f))}},5602:a=>{var o=a.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(l){return l.encoding?"rtpmap:%d %s/%s/%s":l.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(l){return l.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(l){return l.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(l){return"extmap:%d"+(l.direction?"/%s":"%v")+(l["encrypt-uri"]?" %s":"%v")+" %s"+(l.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(l){return l.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(l){var c="candidate:%s %d %s %d %s %d typ %s";return c+=l.raddr!=null?" raddr %s rport %d":"%v%v",c+=l.tcptype!=null?" tcptype %s":"%v",l.generation!=null&&(c+=" generation %d"),c+=l["network-id"]!=null?" network-id %d":"%v",c+=l["network-cost"]!=null?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(l){var c="ssrc:%d";return l.attribute!=null&&(c+=" %s",l.value!=null&&(c+=":%s")),c}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(l){return l.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(l){return l.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(l){return"imageattr:%s %s %s"+(l.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(l){return"simulcast:%s %s"+(l.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(l){return"ts-refclk:%s"+(l.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(l){var c="mediaclk:";return c+=l.id!=null?"id=%s %s":"%v%s",c+=l.mediaClockValue!=null?"=%s":"",c+=l.rateNumerator!=null?" rate=%s":"",c+=l.rateDenominator!=null?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(o).forEach((function(l){o[l].forEach((function(c){c.reg||(c.reg=/(.*)/),c.format||(c.format="%s")}))}))},7363:(a,o,l)=>{var c=l(5020),u=l(3804);o.M9=u,o.qg=c.parse,o.Sl=c.parseParams,c.parseFmtpConfig,c.parsePayloads,c.parseRemoteCandidates,c.parseImageAttributes,c.parseSimulcastStreamList},5020:(a,o,l)=>{var c=function(p){return String(Number(p))===p?Number(p):p},u=function(p,_,y){var v=p.name&&p.names;p.push&&!_[p.push]?_[p.push]=[]:v&&!_[p.name]&&(_[p.name]={});var x=p.push?{}:v?_[p.name]:_;(function(E,M,O,N){if(N&&!O)M[N]=c(E[1]);else for(var I=0;I<O.length;I+=1)E[I+1]!=null&&(M[O[I]]=c(E[I+1]))})(y.match(p.reg),x,p.names,p.name),p.push&&_[p.push].push(x)},f=l(5602),d=RegExp.prototype.test.bind(/^([a-z])=(.*)/);o.parse=function(p){var _={},y=[],v=_;return p.split(/(\r\n|\r|\n)/).filter(d).forEach((function(x){var E=x[0],M=x.slice(2);E==="m"&&(y.push({rtp:[],fmtp:[]}),v=y[y.length-1]);for(var O=0;O<(f[E]||[]).length;O+=1){var N=f[E][O];if(N.reg.test(M))return u(N,v,M)}})),_.media=y,_};var g=function(p,_){var y=_.split(/=(.+)/,2);return y.length===2?p[y[0]]=c(y[1]):y.length===1&&_.length>1&&(p[y[0]]=void 0),p};o.parseParams=function(p){return p.split(/;\s?/).reduce(g,{})},o.parseFmtpConfig=o.parseParams,o.parsePayloads=function(p){return p.toString().split(" ").map(Number)},o.parseRemoteCandidates=function(p){for(var _=[],y=p.split(" ").map(c),v=0;v<y.length;v+=3)_.push({component:y[v],ip:y[v+1],port:y[v+2]});return _},o.parseImageAttributes=function(p){return p.split(" ").map((function(_){return _.substring(1,_.length-1).split(",").reduce(g,{})}))},o.parseSimulcastStreamList=function(p){return p.split(";").map((function(_){return _.split(",").map((function(y){var v,x=!1;return y[0]!=="~"?v=c(y):(v=c(y.substring(1,y.length)),x=!0),{scid:v,paused:x}}))}))}},3804:(a,o,l)=>{var c=l(5602),u=/%[sdv%]/g,f=function(_){var y=1,v=arguments,x=v.length;return _.replace(u,(function(E){if(y>=x)return E;var M=v[y];switch(y+=1,E){case"%%":return"%";case"%s":return String(M);case"%d":return Number(M);case"%v":return""}}))},d=function(_,y,v){var x=[_+"="+(y.format instanceof Function?y.format(y.push?v:v[y.name]):y.format)];if(y.names)for(var E=0;E<y.names.length;E+=1){var M=y.names[E];y.name?x.push(v[y.name][M]):x.push(v[y.names[E]])}else x.push(v[y.name]);return f.apply(null,x)},g=["v","o","s","i","u","e","p","c","b","t","r","z","a"],p=["i","c","b","a"];a.exports=function(_,y){y=y||{},_.version==null&&(_.version=0),_.name==null&&(_.name=" "),_.media.forEach((function(M){M.payloads==null&&(M.payloads="")}));var v=y.outerOrder||g,x=y.innerOrder||p,E=[];return v.forEach((function(M){c[M].forEach((function(O){O.name in _&&_[O.name]!=null?E.push(d(M,O,_)):O.push in _&&_[O.push]!=null&&_[O.push].forEach((function(N){E.push(d(M,O,N))}))}))})),_.media.forEach((function(M){E.push(d("m",c.m[0],M)),x.forEach((function(O){c[O].forEach((function(N){N.name in M&&M[N.name]!=null?E.push(d(O,N,M)):N.push in M&&M[N.push]!=null&&M[N.push].forEach((function(I){E.push(d(O,N,I))}))}))}))})),E.join(`\r
`)+`\r
`}},7963:a=>{const o={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};o.localCName=o.generateIdentifier(),o.splitLines=function(l){return l.trim().split(`
`).map((c=>c.trim()))},o.splitSections=function(l){return l.split(`
m=`).map(((c,u)=>(u>0?"m="+c:c).trim()+`\r
`))},o.getDescription=function(l){const c=o.splitSections(l);return c&&c[0]},o.getMediaSections=function(l){const c=o.splitSections(l);return c.shift(),c},o.matchPrefix=function(l,c){return o.splitLines(l).filter((u=>u.indexOf(c)===0))},o.parseCandidate=function(l){let c;c=l.indexOf("a=candidate:")===0?l.substring(12).split(" "):l.substring(10).split(" ");const u={foundation:c[0],component:{1:"rtp",2:"rtcp"}[c[1]]||c[1],protocol:c[2].toLowerCase(),priority:parseInt(c[3],10),ip:c[4],address:c[4],port:parseInt(c[5],10),type:c[7]};for(let f=8;f<c.length;f+=2)switch(c[f]){case"raddr":u.relatedAddress=c[f+1];break;case"rport":u.relatedPort=parseInt(c[f+1],10);break;case"tcptype":u.tcpType=c[f+1];break;case"ufrag":u.ufrag=c[f+1],u.usernameFragment=c[f+1];break;default:u[c[f]]===void 0&&(u[c[f]]=c[f+1])}return u},o.writeCandidate=function(l){const c=[];c.push(l.foundation);const u=l.component;u==="rtp"?c.push(1):u==="rtcp"?c.push(2):c.push(u),c.push(l.protocol.toUpperCase()),c.push(l.priority),c.push(l.address||l.ip),c.push(l.port);const f=l.type;return c.push("typ"),c.push(f),f!=="host"&&l.relatedAddress&&l.relatedPort&&(c.push("raddr"),c.push(l.relatedAddress),c.push("rport"),c.push(l.relatedPort)),l.tcpType&&l.protocol.toLowerCase()==="tcp"&&(c.push("tcptype"),c.push(l.tcpType)),(l.usernameFragment||l.ufrag)&&(c.push("ufrag"),c.push(l.usernameFragment||l.ufrag)),"candidate:"+c.join(" ")},o.parseIceOptions=function(l){return l.substring(14).split(" ")},o.parseRtpMap=function(l){let c=l.substring(9).split(" ");const u={payloadType:parseInt(c.shift(),10)};return c=c[0].split("/"),u.name=c[0],u.clockRate=parseInt(c[1],10),u.channels=c.length===3?parseInt(c[2],10):1,u.numChannels=u.channels,u},o.writeRtpMap=function(l){let c=l.payloadType;l.preferredPayloadType!==void 0&&(c=l.preferredPayloadType);const u=l.channels||l.numChannels||1;return"a=rtpmap:"+c+" "+l.name+"/"+l.clockRate+(u!==1?"/"+u:"")+`\r
`},o.parseExtmap=function(l){const c=l.substring(9).split(" ");return{id:parseInt(c[0],10),direction:c[0].indexOf("/")>0?c[0].split("/")[1]:"sendrecv",uri:c[1],attributes:c.slice(2).join(" ")}},o.writeExtmap=function(l){return"a=extmap:"+(l.id||l.preferredId)+(l.direction&&l.direction!=="sendrecv"?"/"+l.direction:"")+" "+l.uri+(l.attributes?" "+l.attributes:"")+`\r
`},o.parseFmtp=function(l){const c={};let u;const f=l.substring(l.indexOf(" ")+1).split(";");for(let d=0;d<f.length;d++)u=f[d].trim().split("="),c[u[0].trim()]=u[1];return c},o.writeFmtp=function(l){let c="",u=l.payloadType;if(l.preferredPayloadType!==void 0&&(u=l.preferredPayloadType),l.parameters&&Object.keys(l.parameters).length){const f=[];Object.keys(l.parameters).forEach((d=>{l.parameters[d]!==void 0?f.push(d+"="+l.parameters[d]):f.push(d)})),c+="a=fmtp:"+u+" "+f.join(";")+`\r
`}return c},o.parseRtcpFb=function(l){const c=l.substring(l.indexOf(" ")+1).split(" ");return{type:c.shift(),parameter:c.join(" ")}},o.writeRtcpFb=function(l){let c="",u=l.payloadType;return l.preferredPayloadType!==void 0&&(u=l.preferredPayloadType),l.rtcpFeedback&&l.rtcpFeedback.length&&l.rtcpFeedback.forEach((f=>{c+="a=rtcp-fb:"+u+" "+f.type+(f.parameter&&f.parameter.length?" "+f.parameter:"")+`\r
`})),c},o.parseSsrcMedia=function(l){const c=l.indexOf(" "),u={ssrc:parseInt(l.substring(7,c),10)},f=l.indexOf(":",c);return f>-1?(u.attribute=l.substring(c+1,f),u.value=l.substring(f+1)):u.attribute=l.substring(c+1),u},o.parseSsrcGroup=function(l){const c=l.substring(13).split(" ");return{semantics:c.shift(),ssrcs:c.map((u=>parseInt(u,10)))}},o.getMid=function(l){const c=o.matchPrefix(l,"a=mid:")[0];if(c)return c.substring(6)},o.parseFingerprint=function(l){const c=l.substring(14).split(" ");return{algorithm:c[0].toLowerCase(),value:c[1].toUpperCase()}},o.getDtlsParameters=function(l,c){return{role:"auto",fingerprints:o.matchPrefix(l+c,"a=fingerprint:").map(o.parseFingerprint)}},o.writeDtlsParameters=function(l,c){let u="a=setup:"+c+`\r
`;return l.fingerprints.forEach((f=>{u+="a=fingerprint:"+f.algorithm+" "+f.value+`\r
`})),u},o.parseCryptoLine=function(l){const c=l.substring(9).split(" ");return{tag:parseInt(c[0],10),cryptoSuite:c[1],keyParams:c[2],sessionParams:c.slice(3)}},o.writeCryptoLine=function(l){return"a=crypto:"+l.tag+" "+l.cryptoSuite+" "+(typeof l.keyParams=="object"?o.writeCryptoKeyParams(l.keyParams):l.keyParams)+(l.sessionParams?" "+l.sessionParams.join(" "):"")+`\r
`},o.parseCryptoKeyParams=function(l){if(l.indexOf("inline:")!==0)return null;const c=l.substring(7).split("|");return{keyMethod:"inline",keySalt:c[0],lifeTime:c[1],mkiValue:c[2]?c[2].split(":")[0]:void 0,mkiLength:c[2]?c[2].split(":")[1]:void 0}},o.writeCryptoKeyParams=function(l){return l.keyMethod+":"+l.keySalt+(l.lifeTime?"|"+l.lifeTime:"")+(l.mkiValue&&l.mkiLength?"|"+l.mkiValue+":"+l.mkiLength:"")},o.getCryptoParameters=function(l,c){return o.matchPrefix(l+c,"a=crypto:").map(o.parseCryptoLine)},o.getIceParameters=function(l,c){const u=o.matchPrefix(l+c,"a=ice-ufrag:")[0],f=o.matchPrefix(l+c,"a=ice-pwd:")[0];return u&&f?{usernameFragment:u.substring(12),password:f.substring(10)}:null},o.writeIceParameters=function(l){let c="a=ice-ufrag:"+l.usernameFragment+`\r
a=ice-pwd:`+l.password+`\r
`;return l.iceLite&&(c+=`a=ice-lite\r
`),c},o.parseRtpParameters=function(l){const c={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},u=o.splitLines(l)[0].split(" ");c.profile=u[2];for(let d=3;d<u.length;d++){const g=u[d],p=o.matchPrefix(l,"a=rtpmap:"+g+" ")[0];if(p){const _=o.parseRtpMap(p),y=o.matchPrefix(l,"a=fmtp:"+g+" ");switch(_.parameters=y.length?o.parseFmtp(y[0]):{},_.rtcpFeedback=o.matchPrefix(l,"a=rtcp-fb:"+g+" ").map(o.parseRtcpFb),c.codecs.push(_),_.name.toUpperCase()){case"RED":case"ULPFEC":c.fecMechanisms.push(_.name.toUpperCase())}}}o.matchPrefix(l,"a=extmap:").forEach((d=>{c.headerExtensions.push(o.parseExtmap(d))}));const f=o.matchPrefix(l,"a=rtcp-fb:* ").map(o.parseRtcpFb);return c.codecs.forEach((d=>{f.forEach((g=>{d.rtcpFeedback.find((p=>p.type===g.type&&p.parameter===g.parameter))||d.rtcpFeedback.push(g)}))})),c},o.writeRtpDescription=function(l,c){let u="";u+="m="+l+" ",u+=c.codecs.length>0?"9":"0",u+=" "+(c.profile||"UDP/TLS/RTP/SAVPF")+" ",u+=c.codecs.map((d=>d.preferredPayloadType!==void 0?d.preferredPayloadType:d.payloadType)).join(" ")+`\r
`,u+=`c=IN IP4 0.0.0.0\r
`,u+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,c.codecs.forEach((d=>{u+=o.writeRtpMap(d),u+=o.writeFmtp(d),u+=o.writeRtcpFb(d)}));let f=0;return c.codecs.forEach((d=>{d.maxptime>f&&(f=d.maxptime)})),f>0&&(u+="a=maxptime:"+f+`\r
`),c.headerExtensions&&c.headerExtensions.forEach((d=>{u+=o.writeExtmap(d)})),u},o.parseRtpEncodingParameters=function(l){const c=[],u=o.parseRtpParameters(l),f=u.fecMechanisms.indexOf("RED")!==-1,d=u.fecMechanisms.indexOf("ULPFEC")!==-1,g=o.matchPrefix(l,"a=ssrc:").map((x=>o.parseSsrcMedia(x))).filter((x=>x.attribute==="cname")),p=g.length>0&&g[0].ssrc;let _;const y=o.matchPrefix(l,"a=ssrc-group:FID").map((x=>x.substring(17).split(" ").map((E=>parseInt(E,10)))));y.length>0&&y[0].length>1&&y[0][0]===p&&(_=y[0][1]),u.codecs.forEach((x=>{if(x.name.toUpperCase()==="RTX"&&x.parameters.apt){let E={ssrc:p,codecPayloadType:parseInt(x.parameters.apt,10)};p&&_&&(E.rtx={ssrc:_}),c.push(E),f&&(E=JSON.parse(JSON.stringify(E)),E.fec={ssrc:p,mechanism:d?"red+ulpfec":"red"},c.push(E))}})),c.length===0&&p&&c.push({ssrc:p});let v=o.matchPrefix(l,"b=");return v.length&&(v=v[0].indexOf("b=TIAS:")===0?parseInt(v[0].substring(7),10):v[0].indexOf("b=AS:")===0?1e3*parseInt(v[0].substring(5),10)*.95-16e3:void 0,c.forEach((x=>{x.maxBitrate=v}))),c},o.parseRtcpParameters=function(l){const c={},u=o.matchPrefix(l,"a=ssrc:").map((g=>o.parseSsrcMedia(g))).filter((g=>g.attribute==="cname"))[0];u&&(c.cname=u.value,c.ssrc=u.ssrc);const f=o.matchPrefix(l,"a=rtcp-rsize");c.reducedSize=f.length>0,c.compound=f.length===0;const d=o.matchPrefix(l,"a=rtcp-mux");return c.mux=d.length>0,c},o.writeRtcpParameters=function(l){let c="";return l.reducedSize&&(c+=`a=rtcp-rsize\r
`),l.mux&&(c+=`a=rtcp-mux\r
`),l.ssrc!==void 0&&l.cname&&(c+="a=ssrc:"+l.ssrc+" cname:"+l.cname+`\r
`),c},o.parseMsid=function(l){let c;const u=o.matchPrefix(l,"a=msid:");if(u.length===1)return c=u[0].substring(7).split(" "),{stream:c[0],track:c[1]};const f=o.matchPrefix(l,"a=ssrc:").map((d=>o.parseSsrcMedia(d))).filter((d=>d.attribute==="msid"));return f.length>0?(c=f[0].value.split(" "),{stream:c[0],track:c[1]}):void 0},o.parseSctpDescription=function(l){const c=o.parseMLine(l),u=o.matchPrefix(l,"a=max-message-size:");let f;u.length>0&&(f=parseInt(u[0].substring(19),10)),isNaN(f)&&(f=65536);const d=o.matchPrefix(l,"a=sctp-port:");if(d.length>0)return{port:parseInt(d[0].substring(12),10),protocol:c.fmt,maxMessageSize:f};const g=o.matchPrefix(l,"a=sctpmap:");if(g.length>0){const p=g[0].substring(10).split(" ");return{port:parseInt(p[0],10),protocol:p[1],maxMessageSize:f}}},o.writeSctpDescription=function(l,c){let u=[];return u=l.protocol!=="DTLS/SCTP"?["m="+l.kind+" 9 "+l.protocol+" "+c.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+c.port+`\r
`]:["m="+l.kind+" 9 "+l.protocol+" "+c.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+c.port+" "+c.protocol+` 65535\r
`],c.maxMessageSize!==void 0&&u.push("a=max-message-size:"+c.maxMessageSize+`\r
`),u.join("")},o.generateSessionId=function(){return Math.random().toString().substr(2,22)},o.writeSessionBoilerplate=function(l,c,u){let f;const d=c!==void 0?c:2;return f=l||o.generateSessionId(),`v=0\r
o=`+(u||"thisisadapterortc")+" "+f+" "+d+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},o.getDirection=function(l,c){const u=o.splitLines(l);for(let f=0;f<u.length;f++)switch(u[f]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return u[f].substring(2)}return c?o.getDirection(c):"sendrecv"},o.getKind=function(l){return o.splitLines(l)[0].split(" ")[0].substring(2)},o.isRejected=function(l){return l.split(" ",2)[1]==="0"},o.parseMLine=function(l){const c=o.splitLines(l)[0].substring(2).split(" ");return{kind:c[0],port:parseInt(c[1],10),protocol:c[2],fmt:c.slice(3).join(" ")}},o.parseOLine=function(l){const c=o.matchPrefix(l,"o=")[0].substring(2).split(" ");return{username:c[0],sessionId:c[1],sessionVersion:parseInt(c[2],10),netType:c[3],addressType:c[4],address:c[5]}},o.isValidSDP=function(l){if(typeof l!="string"||l.length===0)return!1;const c=o.splitLines(l);for(let u=0;u<c.length;u++)if(c[u].length<2||c[u].charAt(1)!=="=")return!1;return!0},a.exports=o},5512:a=>{a.exports=function(o,l,c,u){var f=self||window;try{try{var d;try{d=new f.Blob([o])}catch{(d=new(f.BlobBuilder||f.WebKitBlobBuilder||f.MozBlobBuilder||f.MSBlobBuilder)).append(o),d=d.getBlob()}var g=f.URL||f.webkitURL,p=g.createObjectURL(d),_=new f[l](p,c);return g.revokeObjectURL(p),_}catch{return new f[l]("data:application/javascript,".concat(encodeURIComponent(o)),c)}}catch{if(!u)throw Error("Inline worker is not supported");return new f[l](u,c)}}},8630:(a,o,l)=>{var c;(function(u){(function(){var f=typeof globalThis=="object"?globalThis:typeof l.g=="object"?l.g:typeof self=="object"?self:typeof this=="object"?this:(function(){try{return Function("return this;")()}catch{}})()||(function(){try{return(0,eval)("(function() { return this; })()")}catch{}})(),d=g(u);function g(p,_){return function(y,v){Object.defineProperty(p,y,{configurable:!0,writable:!0,value:v}),_&&_(y,v)}}f.Reflect!==void 0&&(d=g(f.Reflect,d)),(function(p,_){var y=Object.prototype.hasOwnProperty,v=typeof Symbol=="function",x=v&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",E=v&&Symbol.iterator!==void 0?Symbol.iterator:"@@iterator",M=typeof Object.create=="function",O={__proto__:[]}instanceof Array,N=!M&&!O,I={create:M?function(){return vt(Object.create(null))}:O?function(){return vt({__proto__:null})}:function(){return vt({})},has:N?function(Qe,ht){return y.call(Qe,ht)}:function(Qe,ht){return ht in Qe},get:N?function(Qe,ht){return y.call(Qe,ht)?Qe[ht]:void 0}:function(Qe,ht){return Qe[ht]}},D=Object.getPrototypeOf(Function),V=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:tt(),G=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Ze(),Q=typeof WeakMap=="function"?WeakMap:nt(),B=v?Symbol.for("@reflect-metadata:registry"):void 0,$=ke(),U=Re($);function J(Qe,ht,mt,ft){if(Ue(mt)){if(!ot(Qe))throw new TypeError;if(!ct(ht))throw new TypeError;return de(Qe,ht)}if(!ot(Qe))throw new TypeError;if(!Be(ht))throw new TypeError;if(!Be(ft)&&!Ue(ft)&&!Ge(ft))throw new TypeError;return Ge(ft)&&(ft=void 0),Me(Qe,ht,mt=Ke(mt),ft)}function W(Qe,ht){function mt(ft,_t){if(!Be(ft))throw new TypeError;if(!Ue(_t)&&!Vt(_t))throw new TypeError;$e(Qe,ht,ft,_t)}return mt}function q(Qe,ht,mt,ft){if(!Be(mt))throw new TypeError;return Ue(ft)||(ft=Ke(ft)),$e(Qe,ht,mt,ft)}function Y(Qe,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),qe(Qe,ht,mt)}function ae(Qe,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Pe(Qe,ht,mt)}function Z(Qe,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Ce(Qe,ht,mt)}function K(Qe,ht,mt){if(!Be(ht))throw new TypeError;return Ue(mt)||(mt=Ke(mt)),Xe(Qe,ht,mt)}function ne(Qe,ht){if(!Be(Qe))throw new TypeError;return Ue(ht)||(ht=Ke(ht)),at(Qe,ht)}function le(Qe,ht){if(!Be(Qe))throw new TypeError;return Ue(ht)||(ht=Ke(ht)),pt(Qe,ht)}function ce(Qe,ht,mt){if(!Be(ht))throw new TypeError;if(Ue(mt)||(mt=Ke(mt)),!Be(ht))throw new TypeError;Ue(mt)||(mt=Ke(mt));var ft=Ve(ht,mt,!1);return!Ue(ft)&&ft.OrdinaryDeleteMetadata(Qe,ht,mt)}function de(Qe,ht){for(var mt=Qe.length-1;mt>=0;--mt){var ft=(0,Qe[mt])(ht);if(!Ue(ft)&&!Ge(ft)){if(!ct(ft))throw new TypeError;ht=ft}}return ht}function Me(Qe,ht,mt,ft){for(var _t=Qe.length-1;_t>=0;--_t){var gn=(0,Qe[_t])(ht,mt,ft);if(!Ue(gn)&&!Ge(gn)){if(!Be(gn))throw new TypeError;ft=gn}}return ft}function qe(Qe,ht,mt){if(Pe(Qe,ht,mt))return!0;var ft=Ne(ht);return!Ge(ft)&&qe(Qe,ft,mt)}function Pe(Qe,ht,mt){var ft=Ve(ht,mt,!1);return!Ue(ft)&&Ie(ft.OrdinaryHasOwnMetadata(Qe,ht,mt))}function Ce(Qe,ht,mt){if(Pe(Qe,ht,mt))return Xe(Qe,ht,mt);var ft=Ne(ht);return Ge(ft)?void 0:Ce(Qe,ft,mt)}function Xe(Qe,ht,mt){var ft=Ve(ht,mt,!1);if(!Ue(ft))return ft.OrdinaryGetOwnMetadata(Qe,ht,mt)}function $e(Qe,ht,mt,ft){Ve(mt,ft,!0).OrdinaryDefineOwnMetadata(Qe,ht,mt,ft)}function at(Qe,ht){var mt=pt(Qe,ht),ft=Ne(Qe);if(ft===null)return mt;var _t=at(ft,ht);if(_t.length<=0)return mt;if(mt.length<=0)return _t;for(var gn=new G,_n=[],Bt=0,Yt=mt;Bt<Yt.length;Bt++){var Mt=Yt[Bt];gn.has(Mt)||(gn.add(Mt),_n.push(Mt))}for(var fn=0,Bn=_t;fn<Bn.length;fn++)Mt=Bn[fn],gn.has(Mt)||(gn.add(Mt),_n.push(Mt));return _n}function pt(Qe,ht){var mt=Ve(Qe,ht,!1);return mt?mt.OrdinaryOwnMetadataKeys(Qe,ht):[]}function oe(Qe){if(Qe===null)return 1;switch(typeof Qe){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return Qe===null?1:6;default:return 6}}function Ue(Qe){return Qe===void 0}function Ge(Qe){return Qe===null}function ze(Qe){return typeof Qe=="symbol"}function Be(Qe){return typeof Qe=="object"?Qe!==null:typeof Qe=="function"}function me(Qe,ht){switch(oe(Qe)){case 0:case 1:case 2:case 3:case 4:case 5:return Qe}var mt="string",ft=Ut(Qe,x);if(ft!==void 0){var _t=ft.call(Qe,mt);if(Be(_t))throw new TypeError;return _t}return Se(Qe)}function Se(Qe,ht){var mt,ft;{var _t=Qe.toString;if(lt(_t)&&!Be(ft=_t.call(Qe))||lt(mt=Qe.valueOf)&&!Be(ft=mt.call(Qe)))return ft}throw new TypeError}function Ie(Qe){return!!Qe}function be(Qe){return""+Qe}function Ke(Qe){var ht=me(Qe);return ze(ht)?ht:be(ht)}function ot(Qe){return Array.isArray?Array.isArray(Qe):Qe instanceof Object?Qe instanceof Array:Object.prototype.toString.call(Qe)==="[object Array]"}function lt(Qe){return typeof Qe=="function"}function ct(Qe){return typeof Qe=="function"}function Vt(Qe){switch(oe(Qe)){case 3:case 4:return!0;default:return!1}}function kt(Qe,ht){return Qe===ht||Qe!=Qe&&ht!=ht}function Ut(Qe,ht){var mt=Qe[ht];if(mt!=null){if(!lt(mt))throw new TypeError;return mt}}function je(Qe){var ht=Ut(Qe,E);if(!lt(ht))throw new TypeError;var mt=ht.call(Qe);if(!Be(mt))throw new TypeError;return mt}function ge(Qe){return Qe.value}function se(Qe){var ht=Qe.next();return!ht.done&&ht}function _e(Qe){var ht=Qe.return;ht&&ht.call(Qe)}function Ne(Qe){var ht=Object.getPrototypeOf(Qe);if(typeof Qe!="function"||Qe===D||ht!==D)return ht;var mt=Qe.prototype,ft=mt&&Object.getPrototypeOf(mt);if(ft==null||ft===Object.prototype)return ht;var _t=ft.constructor;return typeof _t!="function"||_t===Qe?ht:_t}function Le(){var Qe,ht,mt,ft;Ue(B)||_.Reflect===void 0||B in _.Reflect||typeof _.Reflect.defineMetadata!="function"||(Qe=st(_.Reflect));var _t=new Q,gn={registerProvider:_n,getProvider:Yt,setProvider:fn};return gn;function _n(Bn){if(!Object.isExtensible(gn))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case Qe===Bn:break;case Ue(ht):ht=Bn;break;case ht===Bn:break;case Ue(mt):mt=Bn;break;case mt===Bn:break;default:ft===void 0&&(ft=new G),ft.add(Bn)}}function Bt(Bn,cn){if(!Ue(ht)){if(ht.isProviderFor(Bn,cn))return ht;if(!Ue(mt)){if(mt.isProviderFor(Bn,cn))return ht;if(!Ue(ft))for(var In=je(ft);;){var $n=se(In);if(!$n)return;var er=ge($n);if(er.isProviderFor(Bn,cn))return _e(In),er}}}if(!Ue(Qe)&&Qe.isProviderFor(Bn,cn))return Qe}function Yt(Bn,cn){var In,$n=_t.get(Bn);return Ue($n)||(In=$n.get(cn)),Ue(In)&&(Ue(In=Bt(Bn,cn))||(Ue($n)&&($n=new V,_t.set(Bn,$n)),$n.set(cn,In))),In}function Mt(Bn){if(Ue(Bn))throw new TypeError;return ht===Bn||mt===Bn||!Ue(ft)&&ft.has(Bn)}function fn(Bn,cn,In){if(!Mt(In))throw new Error("Metadata provider not registered.");var $n=Yt(Bn,cn);if($n!==In){if(!Ue($n))return!1;var er=_t.get(Bn);Ue(er)&&(er=new V,_t.set(Bn,er)),er.set(cn,In)}return!0}}function ke(){var Qe;return!Ue(B)&&Be(_.Reflect)&&Object.isExtensible(_.Reflect)&&(Qe=_.Reflect[B]),Ue(Qe)&&(Qe=Le()),!Ue(B)&&Be(_.Reflect)&&Object.isExtensible(_.Reflect)&&Object.defineProperty(_.Reflect,B,{enumerable:!1,configurable:!1,writable:!1,value:Qe}),Qe}function Re(Qe){var ht=new Q,mt={isProviderFor:function(Mt,fn){var Bn=ht.get(Mt);return!Ue(Bn)&&Bn.has(fn)},OrdinaryDefineOwnMetadata:_n,OrdinaryHasOwnMetadata:_t,OrdinaryGetOwnMetadata:gn,OrdinaryOwnMetadataKeys:Bt,OrdinaryDeleteMetadata:Yt};return $.registerProvider(mt),mt;function ft(Mt,fn,Bn){var cn=ht.get(Mt),In=!1;if(Ue(cn)){if(!Bn)return;cn=new V,ht.set(Mt,cn),In=!0}var $n=cn.get(fn);if(Ue($n)){if(!Bn)return;if($n=new V,cn.set(fn,$n),!Qe.setProvider(Mt,fn,mt))throw cn.delete(fn),In&&ht.delete(Mt),new Error("Wrong provider for target.")}return $n}function _t(Mt,fn,Bn){var cn=ft(fn,Bn,!1);return!Ue(cn)&&Ie(cn.has(Mt))}function gn(Mt,fn,Bn){var cn=ft(fn,Bn,!1);if(!Ue(cn))return cn.get(Mt)}function _n(Mt,fn,Bn,cn){ft(Bn,cn,!0).set(Mt,fn)}function Bt(Mt,fn){var Bn=[],cn=ft(Mt,fn,!1);if(Ue(cn))return Bn;for(var In=je(cn.keys()),$n=0;;){var er=se(In);if(!er)return Bn.length=$n,Bn;var as=ge(er);try{Bn[$n]=as}catch(di){try{_e(In)}finally{throw di}}$n++}}function Yt(Mt,fn,Bn){var cn=ft(fn,Bn,!1);if(Ue(cn)||!cn.delete(Mt))return!1;if(cn.size===0){var In=ht.get(fn);Ue(In)||(In.delete(Bn),In.size===0&&ht.delete(In))}return!0}}function st(Qe){var ht=Qe.defineMetadata,mt=Qe.hasOwnMetadata,ft=Qe.getOwnMetadata,_t=Qe.getOwnMetadataKeys,gn=Qe.deleteMetadata,_n=new Q;return{isProviderFor:function(Bt,Yt){var Mt=_n.get(Bt);return!(Ue(Mt)||!Mt.has(Yt))||!!_t(Bt,Yt).length&&(Ue(Mt)&&(Mt=new G,_n.set(Bt,Mt)),Mt.add(Yt),!0)},OrdinaryDefineOwnMetadata:ht,OrdinaryHasOwnMetadata:mt,OrdinaryGetOwnMetadata:ft,OrdinaryOwnMetadataKeys:_t,OrdinaryDeleteMetadata:gn}}function Ve(Qe,ht,mt){var ft=$.getProvider(Qe,ht);if(!Ue(ft))return ft;if(mt){if($.setProvider(Qe,ht,U))return U;throw new Error("Illegal state.")}}function tt(){var Qe={},ht=[],mt=(function(){function _n(Bt,Yt,Mt){this._index=0,this._keys=Bt,this._values=Yt,this._selector=Mt}return _n.prototype["@@iterator"]=function(){return this},_n.prototype[E]=function(){return this},_n.prototype.next=function(){var Bt=this._index;if(Bt>=0&&Bt<this._keys.length){var Yt=this._selector(this._keys[Bt],this._values[Bt]);return Bt+1>=this._keys.length?(this._index=-1,this._keys=ht,this._values=ht):this._index++,{value:Yt,done:!1}}return{value:void 0,done:!0}},_n.prototype.throw=function(Bt){throw this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),Bt},_n.prototype.return=function(Bt){return this._index>=0&&(this._index=-1,this._keys=ht,this._values=ht),{value:Bt,done:!0}},_n})();return(function(){function _n(){this._keys=[],this._values=[],this._cacheKey=Qe,this._cacheIndex=-2}return Object.defineProperty(_n.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),_n.prototype.has=function(Bt){return this._find(Bt,!1)>=0},_n.prototype.get=function(Bt){var Yt=this._find(Bt,!1);return Yt>=0?this._values[Yt]:void 0},_n.prototype.set=function(Bt,Yt){var Mt=this._find(Bt,!0);return this._values[Mt]=Yt,this},_n.prototype.delete=function(Bt){var Yt=this._find(Bt,!1);if(Yt>=0){for(var Mt=this._keys.length,fn=Yt+1;fn<Mt;fn++)this._keys[fn-1]=this._keys[fn],this._values[fn-1]=this._values[fn];return this._keys.length--,this._values.length--,kt(Bt,this._cacheKey)&&(this._cacheKey=Qe,this._cacheIndex=-2),!0}return!1},_n.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=Qe,this._cacheIndex=-2},_n.prototype.keys=function(){return new mt(this._keys,this._values,ft)},_n.prototype.values=function(){return new mt(this._keys,this._values,_t)},_n.prototype.entries=function(){return new mt(this._keys,this._values,gn)},_n.prototype["@@iterator"]=function(){return this.entries()},_n.prototype[E]=function(){return this.entries()},_n.prototype._find=function(Bt,Yt){if(!kt(this._cacheKey,Bt)){this._cacheIndex=-1;for(var Mt=0;Mt<this._keys.length;Mt++)if(kt(this._keys[Mt],Bt)){this._cacheIndex=Mt;break}}return this._cacheIndex<0&&Yt&&(this._cacheIndex=this._keys.length,this._keys.push(Bt),this._values.push(void 0)),this._cacheIndex},_n})();function ft(_n,Bt){return _n}function _t(_n,Bt){return Bt}function gn(_n,Bt){return[_n,Bt]}}function Ze(){return(function(){function Qe(){this._map=new V}return Object.defineProperty(Qe.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Qe.prototype.has=function(ht){return this._map.has(ht)},Qe.prototype.add=function(ht){return this._map.set(ht,ht),this},Qe.prototype.delete=function(ht){return this._map.delete(ht)},Qe.prototype.clear=function(){this._map.clear()},Qe.prototype.keys=function(){return this._map.keys()},Qe.prototype.values=function(){return this._map.keys()},Qe.prototype.entries=function(){return this._map.entries()},Qe.prototype["@@iterator"]=function(){return this.keys()},Qe.prototype[E]=function(){return this.keys()},Qe})()}function nt(){var Qe=16,ht=I.create(),mt=ft();return(function(){function Yt(){this._key=ft()}return Yt.prototype.has=function(Mt){var fn=_t(Mt,!1);return fn!==void 0&&I.has(fn,this._key)},Yt.prototype.get=function(Mt){var fn=_t(Mt,!1);return fn!==void 0?I.get(fn,this._key):void 0},Yt.prototype.set=function(Mt,fn){return _t(Mt,!0)[this._key]=fn,this},Yt.prototype.delete=function(Mt){var fn=_t(Mt,!1);return fn!==void 0&&delete fn[this._key]},Yt.prototype.clear=function(){this._key=ft()},Yt})();function ft(){var Yt;do Yt="@@WeakMap@@"+Bt();while(I.has(ht,Yt));return ht[Yt]=!0,Yt}function _t(Yt,Mt){if(!y.call(Yt,mt)){if(!Mt)return;Object.defineProperty(Yt,mt,{value:I.create()})}return Yt[mt]}function gn(Yt,Mt){for(var fn=0;fn<Mt;++fn)Yt[fn]=255*Math.random()|0;return Yt}function _n(Yt){if(typeof Uint8Array=="function"){var Mt=new Uint8Array(Yt);return typeof crypto<"u"?crypto.getRandomValues(Mt):typeof msCrypto<"u"?msCrypto.getRandomValues(Mt):gn(Mt,Yt),Mt}return gn(new Array(Yt),Yt)}function Bt(){var Yt=_n(Qe);Yt[6]=79&Yt[6]|64,Yt[8]=191&Yt[8]|128;for(var Mt="",fn=0;fn<Qe;++fn){var Bn=Yt[fn];fn!==4&&fn!==6&&fn!==8||(Mt+="-"),Bn<16&&(Mt+="0"),Mt+=Bn.toString(16).toLowerCase()}return Mt}}function vt(Qe){return Qe.__=void 0,delete Qe.__,Qe}p("decorate",J),p("metadata",W),p("defineMetadata",q),p("hasMetadata",Y),p("hasOwnMetadata",ae),p("getMetadata",Z),p("getOwnMetadata",K),p("getMetadataKeys",ne),p("getOwnMetadataKeys",le),p("deleteMetadata",ce)})(d,f),f.Reflect===void 0&&(f.Reflect=u)})()})(c||(c={}))}},r={};function i(a){var o=r[a];if(o!==void 0)return o.exports;var l=r[a]={id:a,loaded:!1,exports:{}};return t[a].call(l.exports,l,l.exports,i),l.loaded=!0,l.exports}i.n=a=>{var o=a&&a.__esModule?()=>a.default:()=>a;return i.d(o,{a:o}),o},i.d=(a,o)=>{for(var l in o)i.o(o,l)&&!i.o(a,l)&&Object.defineProperty(a,l,{enumerable:!0,get:o[l]})},i.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),i.o=(a,o)=>Object.prototype.hasOwnProperty.call(a,o),i.r=a=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},i.nmd=a=>(a.paths=[],a.children||(a.children=[]),a);var s={};return(()=>{i.r(s),i.d(s,{BASIC_FULL_HD_LANDSCAPE:()=>Pr,BASIC_FULL_HD_PORTRAIT:()=>Cn,BASIC_LANDSCAPE:()=>ii,BASIC_PORTRAIT:()=>Tr,BroadcastClientError:()=>Re,BroadcastClientEvents:()=>_r,ConnectionState:()=>sr,Errors:()=>u,InitialLayerPreference:()=>mh,JitterBufferMinDelay:()=>ol,LOG_LEVEL:()=>se,LocalStageStream:()=>zf,LocalStageStreamEvents:()=>Zr,LogLevels:()=>se,RemoteStageStream:()=>su,RemoteStageStreamEvents:()=>Uc,SIMULCAST_DUPLICATE_LAYERS_CONFIGURED:()=>yp,SIMULCAST_LAYER_CONFIGURATION_CONFLICT:()=>qo,SIMULCAST_LAYER_INPUT_FRAMERATE_INSUFFICIENT:()=>nm,SIMULCAST_LAYER_INPUT_RESOLUTION_INSUFFICIENT:()=>lg,SIMULCAST_LAYER_INVALID_TYPE:()=>mo,SIMULCAST_LAYER_ORIENTATION_MISMATCH:()=>Dd,SIMULCAST_MAX_LAYERS_EXCEEDED:()=>Zl,SIMULCAST_MAX_LAYER_BITRATE_EXCEEDED:()=>Ho,SIMULCAST_MAX_LAYER_DIMENSIONS_EXCEEDED:()=>sf,SIMULCAST_MAX_LAYER_FRAMERATE_EXCEEDED:()=>id,SIMULCAST_MIN_LAYER_BITRATE_EXCEEDED:()=>dl,SIMULCAST_MIN_LAYER_DIMENSIONS_EXCEEDED:()=>La,SIMULCAST_MIN_LAYER_FRAMERATE_EXCEEDED:()=>Qg,SIMULCAST_UNSUPPORTED:()=>rd,STAGE_MAX_AUDIO_BITRATE_KBPS:()=>Mo,STAGE_MAX_AUDIO_BITRATE_KBPS_DEFAULT:()=>em,STAGE_MAX_BITRATE:()=>eo,STAGE_MAX_FRAMERATE:()=>Dc,STAGE_MAX_RESOLUTION:()=>Ru,STAGE_MIN_AUDIO_BITRATE_KBPS:()=>nf,STAGE_MIN_BITRATE:()=>wu,STAGE_MIN_FRAMERATE:()=>Ju,STAGE_MIN_RESOLUTION:()=>ef,STANDARD_LANDSCAPE:()=>zr,STANDARD_PORTRAIT:()=>Do,SimulcastLayerPresets:()=>ja,Stage:()=>va,StageConnectionState:()=>Cs,StageErrorCategory:()=>fr,StageErrorCode:()=>Wn,StageEvents:()=>ui,StageLeftReason:()=>jf,StageParticipantPublishState:()=>_a,StageParticipantSubscribeState:()=>Go,StageStream:()=>vh,StageStreamLayerSelectedReason:()=>Zi,StreamType:()=>Vr,SubscribeType:()=>io,__version:()=>fp,create:()=>hh,default:()=>Du,isSupported:()=>ge});var a={};i.r(a),i.d(a,{fixNegotiationNeeded:()=>ae,shimAddTrackRemoveTrack:()=>q,shimAddTrackRemoveTrackWithNative:()=>W,shimGetDisplayMedia:()=>G,shimGetSendersWithDtmf:()=>$,shimGetStats:()=>U,shimGetUserMedia:()=>V,shimMediaStream:()=>Q,shimOnTrack:()=>B,shimPeerConnection:()=>Y,shimSenderReceiverGetStats:()=>J});var o={};i.r(o),i.d(o,{shimAddTransceiver:()=>Pe,shimCreateAnswer:()=>$e,shimCreateOffer:()=>Xe,shimGetDisplayMedia:()=>K,shimGetParameters:()=>Ce,shimGetUserMedia:()=>Z,shimOnTrack:()=>ne,shimPeerConnection:()=>le,shimRTCDataChannel:()=>qe,shimReceiverGetStats:()=>de,shimRemoveStream:()=>Me,shimSenderGetStats:()=>ce});var l={};i.r(l),i.d(l,{shimAudioContext:()=>Se,shimCallbacksAPI:()=>oe,shimConstraints:()=>Ge,shimCreateOfferLegacy:()=>me,shimGetUserMedia:()=>Ue,shimLocalStreamsAPI:()=>at,shimRTCIceServerUrls:()=>ze,shimRemoteStreamsAPI:()=>pt,shimTrackEventTransceiver:()=>Be});var c={};i.r(c),i.d(c,{removeExtmapAllowMixed:()=>kt,shimAddIceCandidateNullOrEmpty:()=>Ut,shimConnectionState:()=>Vt,shimMaxMessageSize:()=>lt,shimParameterlessSetLocalDescription:()=>je,shimRTCIceCandidate:()=>Ke,shimRTCIceCandidateRelayProtocol:()=>ot,shimSendThrowTypeError:()=>ct});var u={};i.r(u),i.d(u,{ADD_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Qe,ADD_DEVICE_COMPOSITION_MISSING_ERROR:()=>vt,ADD_DEVICE_CONSTRAINTS_ERROR:()=>ft,ADD_DEVICE_DEVICE_ERROR:()=>Ze,ADD_DEVICE_NAME_EXISTS_ERROR:()=>nt,ADD_DEVICE_NAME_MISSING_ERROR:()=>ht,ADD_DEVICE_UNSUPPORTED:()=>mt,BROADCAST_CONFIGURATION_ERROR:()=>$n,BROADCAST_ERROR:()=>st,CAMERA_ERROR:()=>Ve,CLIENT_INVALID_ERROR:()=>pi,EXCHANGE_POSITION_DEVICE_NOT_FOUND_ERROR:()=>Mt,FAILED_TO_ADD_IMAGE_ERROR:()=>fn,INGEST_ENDPOINT_TYPE_ERROR:()=>as,INGEST_ENDPOINT_URL_ERROR:()=>di,INPUT_ERROR:()=>tt,INVALID_STREAM_KEY:()=>In,LOGGER_TYPE_ERROR:()=>Bs,LOG_LEVEL_TYPE_ERROR:()=>Oi,NETWORK_RECONNECT_CONFIGURATION_ERROR:()=>ws,NETWORK_RECONNECT_CONFIGURATION_INVALID_TIMEOUT_ERROR:()=>na,PEER_CONNECTION_ERROR:()=>cn,PEER_SETUP_ERROR:()=>Bn,REMOVE_DEVICE_NOT_FOUND_ERROR:()=>_t,REMOVE_IMAGE_NOT_FOUND_ERROR:()=>gn,STAGE_TOKEN_TYPE_ERROR:()=>We,STAGE_WHIP_OVERRIDE_ERROR:()=>At,STREAM_CONFIGURATION_ERROR:()=>er,STREAM_KEY_INVALID_CHAR_ERROR:()=>os,UPDATE_VIDEO_DEVICE_COMPOSITION_INDEX_MISSING_ERROR:()=>Bt,UPDATE_VIDEO_DEVICE_COMPOSITION_MISSING_ERROR:()=>_n,UPDATE_VIDEO_DEVICE_COMPOSITION_NAME_NOT_FOUND_ERROR:()=>Yt});var f={};i.r(f),i.d(f,{BASIC_FULL_HD_LANDSCAPE:()=>Pr,BASIC_FULL_HD_PORTRAIT:()=>Cn,BASIC_LANDSCAPE:()=>ii,BASIC_PORTRAIT:()=>Tr,BroadcastClientError:()=>Re,BroadcastClientEvents:()=>_r,ConnectionState:()=>sr,Errors:()=>u,LOG_LEVEL:()=>se,LogLevels:()=>se,STANDARD_LANDSCAPE:()=>zr,STANDARD_PORTRAIT:()=>Do,__version:()=>fp,create:()=>hh,isSupported:()=>ge});let d=!0,g=!0;function p(j,C,P){const H=j.match(C);return H&&H.length>=P&&parseInt(H[P],10)}function _(j,C,P){if(!j.RTCPeerConnection)return;const H=j.RTCPeerConnection.prototype,X=H.addEventListener;H.addEventListener=function(ue,Ee){if(ue!==C)return X.apply(this,arguments);const w=h=>{const b=P(h);b&&(Ee.handleEvent?Ee.handleEvent(b):Ee(b))};return this._eventMap=this._eventMap||{},this._eventMap[C]||(this._eventMap[C]=new Map),this._eventMap[C].set(Ee,w),X.apply(this,[ue,w])};const te=H.removeEventListener;H.removeEventListener=function(ue,Ee){if(ue!==C||!this._eventMap||!this._eventMap[C])return te.apply(this,arguments);if(!this._eventMap[C].has(Ee))return te.apply(this,arguments);const w=this._eventMap[C].get(Ee);return this._eventMap[C].delete(Ee),this._eventMap[C].size===0&&delete this._eventMap[C],Object.keys(this._eventMap).length===0&&delete this._eventMap,te.apply(this,[ue,w])},Object.defineProperty(H,"on"+C,{get(){return this["_on"+C]},set(ue){this["_on"+C]&&(this.removeEventListener(C,this["_on"+C]),delete this["_on"+C]),ue&&this.addEventListener(C,this["_on"+C]=ue)},enumerable:!0,configurable:!0})}function y(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(d=j,j?"adapter.js logging disabled":"adapter.js logging enabled")}function v(j){return typeof j!="boolean"?new Error("Argument type: "+typeof j+". Please use a boolean."):(g=!j,"adapter.js deprecation warnings "+(j?"disabled":"enabled"))}function x(){if(typeof window=="object"){if(d)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function E(j,C){g&&console.warn(j+" is deprecated, please use "+C+" instead.")}function M(j){return Object.prototype.toString.call(j)==="[object Object]"}function O(j){return M(j)?Object.keys(j).reduce((function(C,P){const H=M(j[P]),X=H?O(j[P]):j[P],te=H&&!Object.keys(X).length;return X===void 0||te?C:Object.assign(C,{[P]:X})}),{}):j}function N(j,C,P){C&&!P.has(C.id)&&(P.set(C.id,C),Object.keys(C).forEach((H=>{H.endsWith("Id")?N(j,j.get(C[H]),P):H.endsWith("Ids")&&C[H].forEach((X=>{N(j,j.get(X),P)}))})))}function I(j,C,P){const H=P?"outbound-rtp":"inbound-rtp",X=new Map;if(C===null)return X;const te=[];return j.forEach((ue=>{ue.type==="track"&&ue.trackIdentifier===C.id&&te.push(ue)})),te.forEach((ue=>{j.forEach((Ee=>{Ee.type===H&&Ee.trackId===ue.id&&N(j,Ee,X)}))})),X}const D=x;function V(j,C){const P=j&&j.navigator;if(!P.mediaDevices)return;const H=function(ue){if(typeof ue!="object"||ue.mandatory||ue.optional)return ue;const Ee={};return Object.keys(ue).forEach((w=>{if(w==="require"||w==="advanced"||w==="mediaSource")return;const h=typeof ue[w]=="object"?ue[w]:{ideal:ue[w]};h.exact!==void 0&&typeof h.exact=="number"&&(h.min=h.max=h.exact);const b=function(k,F){return k?k+F.charAt(0).toUpperCase()+F.slice(1):F==="deviceId"?"sourceId":F};if(h.ideal!==void 0){Ee.optional=Ee.optional||[];let k={};typeof h.ideal=="number"?(k[b("min",w)]=h.ideal,Ee.optional.push(k),k={},k[b("max",w)]=h.ideal,Ee.optional.push(k)):(k[b("",w)]=h.ideal,Ee.optional.push(k))}h.exact!==void 0&&typeof h.exact!="number"?(Ee.mandatory=Ee.mandatory||{},Ee.mandatory[b("",w)]=h.exact):["min","max"].forEach((k=>{h[k]!==void 0&&(Ee.mandatory=Ee.mandatory||{},Ee.mandatory[b(k,w)]=h[k])}))})),ue.advanced&&(Ee.optional=(Ee.optional||[]).concat(ue.advanced)),Ee},X=function(ue,Ee){if(C.version>=61)return Ee(ue);if((ue=JSON.parse(JSON.stringify(ue)))&&typeof ue.audio=="object"){const w=function(h,b,k){b in h&&!(k in h)&&(h[k]=h[b],delete h[b])};w((ue=JSON.parse(JSON.stringify(ue))).audio,"autoGainControl","googAutoGainControl"),w(ue.audio,"noiseSuppression","googNoiseSuppression"),ue.audio=H(ue.audio)}if(ue&&typeof ue.video=="object"){let w=ue.video.facingMode;w=w&&(typeof w=="object"?w:{ideal:w});const h=C.version<66;if(w&&(w.exact==="user"||w.exact==="environment"||w.ideal==="user"||w.ideal==="environment")&&(!P.mediaDevices.getSupportedConstraints||!P.mediaDevices.getSupportedConstraints().facingMode||h)){let b;if(delete ue.video.facingMode,w.exact==="environment"||w.ideal==="environment"?b=["back","rear"]:w.exact!=="user"&&w.ideal!=="user"||(b=["front"]),b)return P.mediaDevices.enumerateDevices().then((k=>{let F=(k=k.filter((ie=>ie.kind==="videoinput"))).find((ie=>b.some((pe=>ie.label.toLowerCase().includes(pe)))));return!F&&k.length&&b.includes("back")&&(F=k[k.length-1]),F&&(ue.video.deviceId=w.exact?{exact:F.deviceId}:{ideal:F.deviceId}),ue.video=H(ue.video),D("chrome: "+JSON.stringify(ue)),Ee(ue)}))}ue.video=H(ue.video)}return D("chrome: "+JSON.stringify(ue)),Ee(ue)},te=function(ue){return C.version>=64?ue:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[ue.name]||ue.name,message:ue.message,constraint:ue.constraint||ue.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(P.getUserMedia=(function(ue,Ee,w){X(ue,(h=>{P.webkitGetUserMedia(h,Ee,(b=>{w&&w(te(b))}))}))}).bind(P),P.mediaDevices.getUserMedia){const ue=P.mediaDevices.getUserMedia.bind(P.mediaDevices);P.mediaDevices.getUserMedia=function(Ee){return X(Ee,(w=>ue(w).then((h=>{if(w.audio&&!h.getAudioTracks().length||w.video&&!h.getVideoTracks().length)throw h.getTracks().forEach((b=>{b.stop()})),new DOMException("","NotFoundError");return h}),(h=>Promise.reject(te(h))))))}}}function G(j,C){j.navigator.mediaDevices&&"getDisplayMedia"in j.navigator.mediaDevices||j.navigator.mediaDevices&&(typeof C=="function"?j.navigator.mediaDevices.getDisplayMedia=function(P){return C(P).then((H=>{const X=P.video&&P.video.width,te=P.video&&P.video.height,ue=P.video&&P.video.frameRate;return P.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:H,maxFrameRate:ue||3}},X&&(P.video.mandatory.maxWidth=X),te&&(P.video.mandatory.maxHeight=te),j.navigator.mediaDevices.getUserMedia(P)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}function Q(j){j.MediaStream=j.MediaStream||j.webkitMediaStream}function B(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("ontrack"in j.RTCPeerConnection.prototype)){Object.defineProperty(j.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(P){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=P)},enumerable:!0,configurable:!0});const C=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=P=>{P.stream.addEventListener("addtrack",(H=>{let X;X=j.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((ue=>ue.track&&ue.track.id===H.track.id)):{track:H.track};const te=new Event("track");te.track=H.track,te.receiver=X,te.transceiver={receiver:X},te.streams=[P.stream],this.dispatchEvent(te)})),P.stream.getTracks().forEach((H=>{let X;X=j.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find((ue=>ue.track&&ue.track.id===H.id)):{track:H};const te=new Event("track");te.track=H,te.receiver=X,te.transceiver={receiver:X},te.streams=[P.stream],this.dispatchEvent(te)}))},this.addEventListener("addstream",this._ontrackpoly)),C.apply(this,arguments)}}else _(j,"track",(C=>(C.transceiver||Object.defineProperty(C,"transceiver",{value:{receiver:C.receiver}}),C)))}function $(j){if(typeof j=="object"&&j.RTCPeerConnection&&!("getSenders"in j.RTCPeerConnection.prototype)&&"createDTMFSender"in j.RTCPeerConnection.prototype){const C=function(X,te){return{track:te,get dtmf(){return this._dtmf===void 0&&(te.kind==="audio"?this._dtmf=X.createDTMFSender(te):this._dtmf=null),this._dtmf},_pc:X}};if(!j.RTCPeerConnection.prototype.getSenders){j.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const X=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(ue,Ee){let w=X.apply(this,arguments);return w||(w=C(this,ue),this._senders.push(w)),w};const te=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(ue){te.apply(this,arguments);const Ee=this._senders.indexOf(ue);Ee!==-1&&this._senders.splice(Ee,1)}}const P=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(X){this._senders=this._senders||[],P.apply(this,[X]),X.getTracks().forEach((te=>{this._senders.push(C(this,te))}))};const H=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(X){this._senders=this._senders||[],H.apply(this,[X]),X.getTracks().forEach((te=>{const ue=this._senders.find((Ee=>Ee.track===te));ue&&this._senders.splice(this._senders.indexOf(ue),1)}))}}else if(typeof j=="object"&&j.RTCPeerConnection&&"getSenders"in j.RTCPeerConnection.prototype&&"createDTMFSender"in j.RTCPeerConnection.prototype&&j.RTCRtpSender&&!("dtmf"in j.RTCRtpSender.prototype)){const C=j.RTCPeerConnection.prototype.getSenders;j.RTCPeerConnection.prototype.getSenders=function(){const P=C.apply(this,[]);return P.forEach((H=>H._pc=this)),P},Object.defineProperty(j.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function U(j){if(!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){const[P,H,X]=arguments;if(arguments.length>0&&typeof P=="function")return C.apply(this,arguments);if(C.length===0&&(arguments.length===0||typeof P!="function"))return C.apply(this,[]);const te=function(Ee){const w={};return Ee.result().forEach((h=>{const b={id:h.id,timestamp:h.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[h.type]||h.type};h.names().forEach((k=>{b[k]=h.stat(k)})),w[b.id]=b})),w},ue=function(Ee){return new Map(Object.keys(Ee).map((w=>[w,Ee[w]])))};if(arguments.length>=2){const Ee=function(w){H(ue(te(w)))};return C.apply(this,[Ee,P])}return new Promise(((Ee,w)=>{C.apply(this,[function(h){Ee(ue(te(h)))},w])})).then(H,X)}}function J(j){if(!(typeof j=="object"&&j.RTCPeerConnection&&j.RTCRtpSender&&j.RTCRtpReceiver))return;if(!("getStats"in j.RTCRtpSender.prototype)){const P=j.RTCPeerConnection.prototype.getSenders;P&&(j.RTCPeerConnection.prototype.getSenders=function(){const X=P.apply(this,[]);return X.forEach((te=>te._pc=this)),X});const H=j.RTCPeerConnection.prototype.addTrack;H&&(j.RTCPeerConnection.prototype.addTrack=function(){const X=H.apply(this,arguments);return X._pc=this,X}),j.RTCRtpSender.prototype.getStats=function(){const X=this;return this._pc.getStats().then((te=>I(te,X.track,!0)))}}if(!("getStats"in j.RTCRtpReceiver.prototype)){const P=j.RTCPeerConnection.prototype.getReceivers;P&&(j.RTCPeerConnection.prototype.getReceivers=function(){const H=P.apply(this,[]);return H.forEach((X=>X._pc=this)),H}),_(j,"track",(H=>(H.receiver._pc=H.srcElement,H))),j.RTCRtpReceiver.prototype.getStats=function(){const H=this;return this._pc.getStats().then((X=>I(X,H.track,!1)))}}if(!("getStats"in j.RTCRtpSender.prototype)||!("getStats"in j.RTCRtpReceiver.prototype))return;const C=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof j.MediaStreamTrack){const P=arguments[0];let H,X,te;return this.getSenders().forEach((ue=>{ue.track===P&&(H?te=!0:H=ue)})),this.getReceivers().forEach((ue=>(ue.track===P&&(X?te=!0:X=ue),ue.track===P))),te||H&&X?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):H?H.getStats():X?X.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return C.apply(this,arguments)}}function W(j){j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((te=>this._shimmedLocalStreams[te][0]))};const C=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addTrack=function(te,ue){if(!ue)return C.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const Ee=C.apply(this,arguments);return this._shimmedLocalStreams[ue.id]?this._shimmedLocalStreams[ue.id].indexOf(Ee)===-1&&this._shimmedLocalStreams[ue.id].push(Ee):this._shimmedLocalStreams[ue.id]=[ue,Ee],Ee};const P=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(te){this._shimmedLocalStreams=this._shimmedLocalStreams||{},te.getTracks().forEach((w=>{if(this.getSenders().find((h=>h.track===w)))throw new DOMException("Track already exists.","InvalidAccessError")}));const ue=this.getSenders();P.apply(this,arguments);const Ee=this.getSenders().filter((w=>ue.indexOf(w)===-1));this._shimmedLocalStreams[te.id]=[te].concat(Ee)};const H=j.RTCPeerConnection.prototype.removeStream;j.RTCPeerConnection.prototype.removeStream=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[te.id],H.apply(this,arguments)};const X=j.RTCPeerConnection.prototype.removeTrack;j.RTCPeerConnection.prototype.removeTrack=function(te){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},te&&Object.keys(this._shimmedLocalStreams).forEach((ue=>{const Ee=this._shimmedLocalStreams[ue].indexOf(te);Ee!==-1&&this._shimmedLocalStreams[ue].splice(Ee,1),this._shimmedLocalStreams[ue].length===1&&delete this._shimmedLocalStreams[ue]})),X.apply(this,arguments)}}function q(j,C){if(!j.RTCPeerConnection)return;if(j.RTCPeerConnection.prototype.addTrack&&C.version>=65)return W(j);const P=j.RTCPeerConnection.prototype.getLocalStreams;j.RTCPeerConnection.prototype.getLocalStreams=function(){const w=P.apply(this);return this._reverseStreams=this._reverseStreams||{},w.map((h=>this._reverseStreams[h.id]))};const H=j.RTCPeerConnection.prototype.addStream;j.RTCPeerConnection.prototype.addStream=function(w){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},w.getTracks().forEach((h=>{if(this.getSenders().find((b=>b.track===h)))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[w.id]){const h=new j.MediaStream(w.getTracks());this._streams[w.id]=h,this._reverseStreams[h.id]=w,w=h}H.apply(this,[w])};const X=j.RTCPeerConnection.prototype.removeStream;function te(w,h){let b=h.sdp;return Object.keys(w._reverseStreams||[]).forEach((k=>{const F=w._reverseStreams[k],ie=w._streams[F.id];b=b.replace(new RegExp(ie.id,"g"),F.id)})),new RTCSessionDescription({type:h.type,sdp:b})}j.RTCPeerConnection.prototype.removeStream=function(w){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},X.apply(this,[this._streams[w.id]||w]),delete this._reverseStreams[this._streams[w.id]?this._streams[w.id].id:w.id],delete this._streams[w.id]},j.RTCPeerConnection.prototype.addTrack=function(w,h){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find((F=>F===w)))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find((F=>F.track===w)))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[h.id];if(k)k.addTrack(w),Promise.resolve().then((()=>{this.dispatchEvent(new Event("negotiationneeded"))}));else{const F=new j.MediaStream([w]);this._streams[h.id]=F,this._reverseStreams[F.id]=h,this.addStream(F)}return this.getSenders().find((F=>F.track===w))},["createOffer","createAnswer"].forEach((function(w){const h=j.RTCPeerConnection.prototype[w],b={[w](){const k=arguments;return arguments.length&&typeof arguments[0]=="function"?h.apply(this,[F=>{const ie=te(this,F);k[0].apply(null,[ie])},F=>{k[1]&&k[1].apply(null,F)},arguments[2]]):h.apply(this,arguments).then((F=>te(this,F)))}};j.RTCPeerConnection.prototype[w]=b[w]}));const ue=j.RTCPeerConnection.prototype.setLocalDescription;j.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(function(w,h){let b=h.sdp;return Object.keys(w._reverseStreams||[]).forEach((k=>{const F=w._reverseStreams[k],ie=w._streams[F.id];b=b.replace(new RegExp(F.id,"g"),ie.id)})),new RTCSessionDescription({type:h.type,sdp:b})})(this,arguments[0]),ue.apply(this,arguments)):ue.apply(this,arguments)};const Ee=Object.getOwnPropertyDescriptor(j.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(j.RTCPeerConnection.prototype,"localDescription",{get(){const w=Ee.get.apply(this);return w.type===""?w:te(this,w)}}),j.RTCPeerConnection.prototype.removeTrack=function(w){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!w._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(w._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let h;this._streams=this._streams||{},Object.keys(this._streams).forEach((b=>{this._streams[b].getTracks().find((k=>w.track===k))&&(h=this._streams[b])})),h&&(h.getTracks().length===1?this.removeStream(this._reverseStreams[h.id]):h.removeTrack(w.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Y(j,C){!j.RTCPeerConnection&&j.webkitRTCPeerConnection&&(j.RTCPeerConnection=j.webkitRTCPeerConnection),j.RTCPeerConnection&&C.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(P){const H=j.RTCPeerConnection.prototype[P],X={[P](){return arguments[0]=new(P==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),H.apply(this,arguments)}};j.RTCPeerConnection.prototype[P]=X[P]}))}function ae(j,C){_(j,"negotiationneeded",(P=>{const H=P.target;if(!(C.version<72||H.getConfiguration&&H.getConfiguration().sdpSemantics==="plan-b")||H.signalingState==="stable")return P}))}function Z(j,C){const P=j&&j.navigator,H=j&&j.MediaStreamTrack;if(P.getUserMedia=function(X,te,ue){E("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),P.mediaDevices.getUserMedia(X).then(te,ue)},!(C.version>55&&"autoGainControl"in P.mediaDevices.getSupportedConstraints())){const X=function(ue,Ee,w){Ee in ue&&!(w in ue)&&(ue[w]=ue[Ee],delete ue[Ee])},te=P.mediaDevices.getUserMedia.bind(P.mediaDevices);if(P.mediaDevices.getUserMedia=function(ue){return typeof ue=="object"&&typeof ue.audio=="object"&&(ue=JSON.parse(JSON.stringify(ue)),X(ue.audio,"autoGainControl","mozAutoGainControl"),X(ue.audio,"noiseSuppression","mozNoiseSuppression")),te(ue)},H&&H.prototype.getSettings){const ue=H.prototype.getSettings;H.prototype.getSettings=function(){const Ee=ue.apply(this,arguments);return X(Ee,"mozAutoGainControl","autoGainControl"),X(Ee,"mozNoiseSuppression","noiseSuppression"),Ee}}if(H&&H.prototype.applyConstraints){const ue=H.prototype.applyConstraints;H.prototype.applyConstraints=function(Ee){return this.kind==="audio"&&typeof Ee=="object"&&(Ee=JSON.parse(JSON.stringify(Ee)),X(Ee,"autoGainControl","mozAutoGainControl"),X(Ee,"noiseSuppression","mozNoiseSuppression")),ue.apply(this,[Ee])}}}}function K(j,C){j.navigator.mediaDevices&&"getDisplayMedia"in j.navigator.mediaDevices||j.navigator.mediaDevices&&(j.navigator.mediaDevices.getDisplayMedia=function(P){if(!P||!P.video){const H=new DOMException("getDisplayMedia without video constraints is undefined");return H.name="NotFoundError",H.code=8,Promise.reject(H)}return P.video===!0?P.video={mediaSource:C}:P.video.mediaSource=C,j.navigator.mediaDevices.getUserMedia(P)})}function ne(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function le(j,C){if(typeof j!="object"||!j.RTCPeerConnection&&!j.mozRTCPeerConnection)return;!j.RTCPeerConnection&&j.mozRTCPeerConnection&&(j.RTCPeerConnection=j.mozRTCPeerConnection),C.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(X){const te=j.RTCPeerConnection.prototype[X],ue={[X](){return arguments[0]=new(X==="addIceCandidate"?j.RTCIceCandidate:j.RTCSessionDescription)(arguments[0]),te.apply(this,arguments)}};j.RTCPeerConnection.prototype[X]=ue[X]}));const P={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},H=j.RTCPeerConnection.prototype.getStats;j.RTCPeerConnection.prototype.getStats=function(){const[X,te,ue]=arguments;return H.apply(this,[X||null]).then((Ee=>{if(C.version<53&&!te)try{Ee.forEach((w=>{w.type=P[w.type]||w.type}))}catch(w){if(w.name!=="TypeError")throw w;Ee.forEach(((h,b)=>{Ee.set(b,Object.assign({},h,{type:P[h.type]||h.type}))}))}return Ee})).then(te,ue)}}function ce(j){if(typeof j!="object"||!j.RTCPeerConnection||!j.RTCRtpSender||j.RTCRtpSender&&"getStats"in j.RTCRtpSender.prototype)return;const C=j.RTCPeerConnection.prototype.getSenders;C&&(j.RTCPeerConnection.prototype.getSenders=function(){const H=C.apply(this,[]);return H.forEach((X=>X._pc=this)),H});const P=j.RTCPeerConnection.prototype.addTrack;P&&(j.RTCPeerConnection.prototype.addTrack=function(){const H=P.apply(this,arguments);return H._pc=this,H}),j.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function de(j){if(typeof j!="object"||!j.RTCPeerConnection||!j.RTCRtpSender||j.RTCRtpSender&&"getStats"in j.RTCRtpReceiver.prototype)return;const C=j.RTCPeerConnection.prototype.getReceivers;C&&(j.RTCPeerConnection.prototype.getReceivers=function(){const P=C.apply(this,[]);return P.forEach((H=>H._pc=this)),P}),_(j,"track",(P=>(P.receiver._pc=P.srcElement,P))),j.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Me(j){j.RTCPeerConnection&&!("removeStream"in j.RTCPeerConnection.prototype)&&(j.RTCPeerConnection.prototype.removeStream=function(C){E("removeStream","removeTrack"),this.getSenders().forEach((P=>{P.track&&C.getTracks().includes(P.track)&&this.removeTrack(P)}))})}function qe(j){j.DataChannel&&!j.RTCDataChannel&&(j.RTCDataChannel=j.DataChannel)}function Pe(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.addTransceiver;C&&(j.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let P=arguments[1]&&arguments[1].sendEncodings;P===void 0&&(P=[]),P=[...P];const H=P.length>0;H&&P.forEach((te=>{if("rid"in te&&!/^[a-z0-9]{0,16}$/i.test(te.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in te&&!(parseFloat(te.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in te&&!(parseFloat(te.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));const X=C.apply(this,arguments);if(H){const{sender:te}=X,ue=te.getParameters();(!("encodings"in ue)||ue.encodings.length===1&&Object.keys(ue.encodings[0]).length===0)&&(ue.encodings=P,te.sendEncodings=P,this.setParametersPromises.push(te.setParameters(ue).then((()=>{delete te.sendEncodings})).catch((()=>{delete te.sendEncodings}))))}return X})}function Ce(j){if(typeof j!="object"||!j.RTCRtpSender)return;const C=j.RTCRtpSender.prototype.getParameters;C&&(j.RTCRtpSender.prototype.getParameters=function(){const P=C.apply(this,arguments);return"encodings"in P||(P.encodings=[].concat(this.sendEncodings||[{}])),P})}function Xe(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>C.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):C.apply(this,arguments)}}function $e(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype.createAnswer;j.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((()=>C.apply(this,arguments))).finally((()=>{this.setParametersPromises=[]})):C.apply(this,arguments)}}function at(j){if(typeof j=="object"&&j.RTCPeerConnection){if("getLocalStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in j.RTCPeerConnection.prototype)){const C=j.RTCPeerConnection.prototype.addTrack;j.RTCPeerConnection.prototype.addStream=function(P){this._localStreams||(this._localStreams=[]),this._localStreams.includes(P)||this._localStreams.push(P),P.getAudioTracks().forEach((H=>C.call(this,H,P))),P.getVideoTracks().forEach((H=>C.call(this,H,P)))},j.RTCPeerConnection.prototype.addTrack=function(P,...H){return H&&H.forEach((X=>{this._localStreams?this._localStreams.includes(X)||this._localStreams.push(X):this._localStreams=[X]})),C.apply(this,arguments)}}"removeStream"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.removeStream=function(C){this._localStreams||(this._localStreams=[]);const P=this._localStreams.indexOf(C);if(P===-1)return;this._localStreams.splice(P,1);const H=C.getTracks();this.getSenders().forEach((X=>{H.includes(X.track)&&this.removeTrack(X)}))})}}function pt(j){if(typeof j=="object"&&j.RTCPeerConnection&&("getRemoteStreams"in j.RTCPeerConnection.prototype||(j.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in j.RTCPeerConnection.prototype))){Object.defineProperty(j.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(P){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=P),this.addEventListener("track",this._onaddstreampoly=H=>{H.streams.forEach((X=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(X))return;this._remoteStreams.push(X);const te=new Event("addstream");te.stream=X,this.dispatchEvent(te)}))})}});const C=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){const P=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(H){H.streams.forEach((X=>{if(P._remoteStreams||(P._remoteStreams=[]),P._remoteStreams.indexOf(X)>=0)return;P._remoteStreams.push(X);const te=new Event("addstream");te.stream=X,P.dispatchEvent(te)}))}),C.apply(P,arguments)}}}function oe(j){if(typeof j!="object"||!j.RTCPeerConnection)return;const C=j.RTCPeerConnection.prototype,P=C.createOffer,H=C.createAnswer,X=C.setLocalDescription,te=C.setRemoteDescription,ue=C.addIceCandidate;C.createOffer=function(w,h){const b=arguments.length>=2?arguments[2]:arguments[0],k=P.apply(this,[b]);return h?(k.then(w,h),Promise.resolve()):k},C.createAnswer=function(w,h){const b=arguments.length>=2?arguments[2]:arguments[0],k=H.apply(this,[b]);return h?(k.then(w,h),Promise.resolve()):k};let Ee=function(w,h,b){const k=X.apply(this,[w]);return b?(k.then(h,b),Promise.resolve()):k};C.setLocalDescription=Ee,Ee=function(w,h,b){const k=te.apply(this,[w]);return b?(k.then(h,b),Promise.resolve()):k},C.setRemoteDescription=Ee,Ee=function(w,h,b){const k=ue.apply(this,[w]);return b?(k.then(h,b),Promise.resolve()):k},C.addIceCandidate=Ee}function Ue(j){const C=j&&j.navigator;if(C.mediaDevices&&C.mediaDevices.getUserMedia){const P=C.mediaDevices,H=P.getUserMedia.bind(P);C.mediaDevices.getUserMedia=X=>H(Ge(X))}!C.getUserMedia&&C.mediaDevices&&C.mediaDevices.getUserMedia&&(C.getUserMedia=(function(P,H,X){C.mediaDevices.getUserMedia(P).then(H,X)}).bind(C))}function Ge(j){return j&&j.video!==void 0?Object.assign({},j,{video:O(j.video)}):j}function ze(j){if(!j.RTCPeerConnection)return;const C=j.RTCPeerConnection;j.RTCPeerConnection=function(P,H){if(P&&P.iceServers){const X=[];for(let te=0;te<P.iceServers.length;te++){let ue=P.iceServers[te];ue.urls===void 0&&ue.url?(E("RTCIceServer.url","RTCIceServer.urls"),ue=JSON.parse(JSON.stringify(ue)),ue.urls=ue.url,delete ue.url,X.push(ue)):X.push(P.iceServers[te])}P.iceServers=X}return new C(P,H)},j.RTCPeerConnection.prototype=C.prototype,"generateCertificate"in C&&Object.defineProperty(j.RTCPeerConnection,"generateCertificate",{get:()=>C.generateCertificate})}function Be(j){typeof j=="object"&&j.RTCTrackEvent&&"receiver"in j.RTCTrackEvent.prototype&&!("transceiver"in j.RTCTrackEvent.prototype)&&Object.defineProperty(j.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function me(j){const C=j.RTCPeerConnection.prototype.createOffer;j.RTCPeerConnection.prototype.createOffer=function(P){if(P){P.offerToReceiveAudio!==void 0&&(P.offerToReceiveAudio=!!P.offerToReceiveAudio);const H=this.getTransceivers().find((te=>te.receiver.track.kind==="audio"));P.offerToReceiveAudio===!1&&H?H.direction==="sendrecv"?H.setDirection?H.setDirection("sendonly"):H.direction="sendonly":H.direction==="recvonly"&&(H.setDirection?H.setDirection("inactive"):H.direction="inactive"):P.offerToReceiveAudio!==!0||H||this.addTransceiver("audio",{direction:"recvonly"}),P.offerToReceiveVideo!==void 0&&(P.offerToReceiveVideo=!!P.offerToReceiveVideo);const X=this.getTransceivers().find((te=>te.receiver.track.kind==="video"));P.offerToReceiveVideo===!1&&X?X.direction==="sendrecv"?X.setDirection?X.setDirection("sendonly"):X.direction="sendonly":X.direction==="recvonly"&&(X.setDirection?X.setDirection("inactive"):X.direction="inactive"):P.offerToReceiveVideo!==!0||X||this.addTransceiver("video",{direction:"recvonly"})}return C.apply(this,arguments)}}function Se(j){typeof j!="object"||j.AudioContext||(j.AudioContext=j.webkitAudioContext)}var Ie=i(7963),be=i.n(Ie);function Ke(j){if(!j.RTCIceCandidate||j.RTCIceCandidate&&"foundation"in j.RTCIceCandidate.prototype)return;const C=j.RTCIceCandidate;j.RTCIceCandidate=function(P){if(typeof P=="object"&&P.candidate&&P.candidate.indexOf("a=")===0&&((P=JSON.parse(JSON.stringify(P))).candidate=P.candidate.substring(2)),P.candidate&&P.candidate.length){const H=new C(P),X=be().parseCandidate(P.candidate);for(const te in X)te in H||Object.defineProperty(H,te,{value:X[te]});return H.toJSON=function(){return{candidate:H.candidate,sdpMid:H.sdpMid,sdpMLineIndex:H.sdpMLineIndex,usernameFragment:H.usernameFragment}},H}return new C(P)},j.RTCIceCandidate.prototype=C.prototype,_(j,"icecandidate",(P=>(P.candidate&&Object.defineProperty(P,"candidate",{value:new j.RTCIceCandidate(P.candidate),writable:"false"}),P)))}function ot(j){!j.RTCIceCandidate||j.RTCIceCandidate&&"relayProtocol"in j.RTCIceCandidate.prototype||_(j,"icecandidate",(C=>{if(C.candidate){const P=be().parseCandidate(C.candidate.candidate);P.type==="relay"&&(C.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[P.priority>>24])}return C}))}function lt(j,C){if(!j.RTCPeerConnection)return;"sctp"in j.RTCPeerConnection.prototype||Object.defineProperty(j.RTCPeerConnection.prototype,"sctp",{get(){return this._sctp===void 0?null:this._sctp}});const P=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,C.browser==="chrome"&&C.version>=76){const{sdpSemantics:H}=this.getConfiguration();H==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return this._sctp===void 0?null:this._sctp},enumerable:!0,configurable:!0})}if((function(H){if(!H||!H.sdp)return!1;const X=be().splitSections(H.sdp);return X.shift(),X.some((te=>{const ue=be().parseMLine(te);return ue&&ue.kind==="application"&&ue.protocol.indexOf("SCTP")!==-1}))})(arguments[0])){const H=(function(w){const h=w.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(h===null||h.length<2)return-1;const b=parseInt(h[1],10);return b!=b?-1:b})(arguments[0]),X=(function(w){let h=65536;return C.browser==="firefox"&&(h=C.version<57?w===-1?16384:2147483637:C.version<60?C.version===57?65535:65536:2147483637),h})(H),te=(function(w,h){let b=65536;C.browser==="firefox"&&C.version===57&&(b=65535);const k=be().matchPrefix(w.sdp,"a=max-message-size:");return k.length>0?b=parseInt(k[0].substring(19),10):C.browser==="firefox"&&h!==-1&&(b=2147483637),b})(arguments[0],H);let ue;ue=X===0&&te===0?Number.POSITIVE_INFINITY:X===0||te===0?Math.max(X,te):Math.min(X,te);const Ee={};Object.defineProperty(Ee,"maxMessageSize",{get:()=>ue}),this._sctp=Ee}return P.apply(this,arguments)}}function ct(j){if(!j.RTCPeerConnection||!("createDataChannel"in j.RTCPeerConnection.prototype))return;function C(H,X){const te=H.send;H.send=function(){const ue=arguments[0],Ee=ue.length||ue.size||ue.byteLength;if(H.readyState==="open"&&X.sctp&&Ee>X.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+X.sctp.maxMessageSize+" bytes)");return te.apply(H,arguments)}}const P=j.RTCPeerConnection.prototype.createDataChannel;j.RTCPeerConnection.prototype.createDataChannel=function(){const H=P.apply(this,arguments);return C(H,this),H},_(j,"datachannel",(H=>(C(H.channel,H.target),H)))}function Vt(j){if(!j.RTCPeerConnection||"connectionState"in j.RTCPeerConnection.prototype)return;const C=j.RTCPeerConnection.prototype;Object.defineProperty(C,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(C,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(P){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),P&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=P)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((P=>{const H=C[P];C[P]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=X=>{const te=X.target;if(te._lastConnectionState!==te.connectionState){te._lastConnectionState=te.connectionState;const ue=new Event("connectionstatechange",X);te.dispatchEvent(ue)}return X},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),H.apply(this,arguments)}}))}function kt(j,C){if(!j.RTCPeerConnection||C.browser==="chrome"&&C.version>=71||C.browser==="safari"&&C.version>=605)return;const P=j.RTCPeerConnection.prototype.setRemoteDescription;j.RTCPeerConnection.prototype.setRemoteDescription=function(H){if(H&&H.sdp&&H.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const X=H.sdp.split(`
`).filter((te=>te.trim()!=="a=extmap-allow-mixed")).join(`
`);j.RTCSessionDescription&&H instanceof j.RTCSessionDescription?arguments[0]=new j.RTCSessionDescription({type:H.type,sdp:X}):H.sdp=X}return P.apply(this,arguments)}}function Ut(j,C){if(!j.RTCPeerConnection||!j.RTCPeerConnection.prototype)return;const P=j.RTCPeerConnection.prototype.addIceCandidate;P&&P.length!==0&&(j.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(C.browser==="chrome"&&C.version<78||C.browser==="firefox"&&C.version<68||C.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():P.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function je(j,C){if(!j.RTCPeerConnection||!j.RTCPeerConnection.prototype)return;const P=j.RTCPeerConnection.prototype.setLocalDescription;P&&P.length!==0&&(j.RTCPeerConnection.prototype.setLocalDescription=function(){let H=arguments[0]||{};if(typeof H!="object"||H.type&&H.sdp)return P.apply(this,arguments);if(H={type:H.type,sdp:H.sdp},!H.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":H.type="offer";break;default:H.type="answer"}return H.sdp||H.type!=="offer"&&H.type!=="answer"?P.apply(this,[H]):(H.type==="offer"?this.createOffer:this.createAnswer).apply(this).then((X=>P.apply(this,[X])))})}(function({window:j}={},C={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const P=x,H=(function(te){const ue={browser:null,version:null};if(te===void 0||!te.navigator||!te.navigator.userAgent)return ue.browser="Not a browser.",ue;const{navigator:Ee}=te;if(Ee.mozGetUserMedia)ue.browser="firefox",ue.version=p(Ee.userAgent,/Firefox\/(\d+)\./,1);else if(Ee.webkitGetUserMedia||te.isSecureContext===!1&&te.webkitRTCPeerConnection)ue.browser="chrome",ue.version=p(Ee.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else{if(!te.RTCPeerConnection||!Ee.userAgent.match(/AppleWebKit\/(\d+)\./))return ue.browser="Not a supported browser.",ue;ue.browser="safari",ue.version=p(Ee.userAgent,/AppleWebKit\/(\d+)\./,1),ue.supportsUnifiedPlan=te.RTCRtpTransceiver&&"currentDirection"in te.RTCRtpTransceiver.prototype}return ue})(j),X={browserDetails:H,commonShim:c,extractVersion:p,disableLog:y,disableWarnings:v,sdp:Ie};switch(H.browser){case"chrome":if(!a||!Y||!C.shimChrome)return P("Chrome shim is not included in this adapter release."),X;if(H.version===null)return P("Chrome shim can not determine version, not shimming."),X;P("adapter.js shimming chrome."),X.browserShim=a,Ut(j,H),je(j),V(j,H),Q(j),Y(j,H),B(j),q(j,H),$(j),U(j),J(j),ae(j,H),Ke(j),ot(j),Vt(j),lt(j,H),ct(j),kt(j,H);break;case"firefox":if(!o||!le||!C.shimFirefox)return P("Firefox shim is not included in this adapter release."),X;P("adapter.js shimming firefox."),X.browserShim=o,Ut(j,H),je(j),Z(j,H),le(j,H),ne(j),Me(j),ce(j),de(j),qe(j),Pe(j),Ce(j),Xe(j),$e(j),Ke(j),Vt(j),lt(j,H),ct(j);break;case"safari":if(!l||!C.shimSafari)return P("Safari shim is not included in this adapter release."),X;P("adapter.js shimming safari."),X.browserShim=l,Ut(j,H),je(j),ze(j),me(j),oe(j),at(j),pt(j),Be(j),Ue(j),Se(j),Ke(j),ot(j),lt(j,H),ct(j),kt(j,H);break;default:P("Unsupported browser!")}})({window:typeof window>"u"?void 0:window}),i(8630);const ge=()=>typeof RTCPeerConnection=="function";var se,_e;(function(j){j[j.TRACE=0]="TRACE",j[j.DEBUG=1]="DEBUG",j[j.INFO=2]="INFO",j[j.WARN=3]="WARN",j[j.ERROR=4]="ERROR",j[j.SILENT=5]="SILENT"})(se||(se={})),(function(j){j.TIME="Time",j.WEBRTC="WebRTC",j.EMITTER="Emitter",j.MEDIA="Media",j.SUBSCRIPTION="StageSubscription",j.PUBLICATION="StagePublication",j.CONNECTION="StageConnection",j.SOCKET="StageSocket",j.BROADCAST_STAGE_CLIENT="BroadcastStageClient",j.STAGE="Stage",j.REMOTE_PARTICIPANT="RemoteParticipant",j.LOCAL_PARTICIPANT="LocalParticipant",j.CONFIGURATION="Configuration",j.REMOTE_PLAYBACK="RemotePlaybackController",j.REMOTE_STAGE_STREAM="RemoteStageStream"})(_e||(_e={}));const Ne=12e4,Le=3e5,ke="no-rid";class Re extends Error{constructor({name:C,message:P,code:H,details:X,cause:te,params:ue}){super(P),Error.captureStackTrace&&Error.captureStackTrace(this,Re),this.name=C||"BroadcastClientError",this.message=P,this.code=H,this.details=X,this.cause=te,this.params=ue}}const st={name:"BroadcastError",code:1e3,message:"Unable to broadcast"},Ve={name:"CameraError",code:2e3,message:"Camera could not be captured"},tt={name:"InputError",code:3e3,message:"Input could not be attached"},Ze={name:"AddDeviceError",code:4e3,message:"Device is missing"},nt={name:"AddDeviceNameExistsError",code:4001,message:"Name is already registered"},vt={name:"AddDeviceCompositionMissingError",code:4002,message:"VideoComposition is missing"},Qe={name:"AddDeviceCompositionIndexMissingError",code:4003,message:`VideoComposition's "index" property is missing`},ht={name:"AddDeviceNameMissingError",code:4004,message:"Name property is missing"},mt={name:"AddDeviceUnsupported",code:4005,message:"Unsupported device"},ft={name:"AddDeviceConstraintsError",code:4006,message:"Constraints error"},_t={name:"RemoveDeviceNotFoundError",code:5e3,message:"Device not found"},gn={name:"RemoveImageNotFoundError",code:6e3,message:"Image not found"},_n={name:"UpdateVideoDeviceCompositionMissingError",code:7e3,message:"VideoComposition is missing"},Bt={name:"UpdateVideoDeviceCompositionIndexMissingError",code:7001,message:`VideoComposition's "index" property is missing`},Yt={name:"UpdateVideoDeviceCompositionNameMissingError",code:7002,message:"Video device with that name is not found"},Mt={name:"ExchangePositionDeviceNotFoundError",code:8e3,message:"Device with that name is not found"},fn={name:"FailedToAddImageError",code:9e3,message:"Failed to add image"},Bn={name:"PeerSetupError",code:1e4,message:"Unexpected return value from setup request"},cn={name:"PeerConnectionError",code:10001,message:"Peer connection has failed."},In={name:"InvalidStreamKey",code:10003,message:"Invalid Stream Key."},$n={name:"BroadcastConfigurationError",code:11e3,message:"Error when configuring broadcast client"},er={name:"StreamConfigurationError",code:12e3,message:"Error when configuring stream"},as={name:"IngestEndpointTypeError",code:13e3,message:"Ingest endpoint must be a string"},di={name:"IngestEndpointUrlError",code:13001,message:"Ingest endpoint must be a valid https or rtmps URL"},Oi={name:"LogLevelTypeError",code:14e3,message:"Log Level must be a valid integer between [0..5]"},Bs={name:"LoggerTypeError",code:15e3,message:"Logger must be an object"},pi={name:"ClientInvalidError",code:16e3,message:"Client is no longer valid, possibly due to delete() invocation."},ws={name:"NetworkReconnectConfigurationError",code:17e3,message:"Error when configuring network reconnect"},na={name:"NetworkReconnectConfigurationInvalidTimeoutError",code:17001,message:"Network reconnect timeout value must be a number between [10000, 300000]"},os={name:"StreamKeyInvalidCharError",code:18e3,message:"Streamkey must contain only [A-Za-z0-9_-] characters"},We={name:"StageTokenTypeError",code:19e3,message:"Stage token must be a string"},At={name:"StageWhipUrlOverrideError",code:19001,message:"Stage WHIP override URL must be a string starting with http"};var Wt,Kt,Lt,yn,zn,En,tr,Ir,Er,rr=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)},Dr=function(j,C,P,H,X){if(typeof C=="function"?j!==C||!0:!C.has(j))throw new TypeError("Cannot write private member to an object whose class did not declare it");return C.set(j,P),P};const ri=1920,ha=1080,Cr=se.ERROR,ii={maxResolution:{width:852,height:480},maxFramerate:30,maxBitrate:1500},Tr={maxResolution:{width:480,height:852},maxFramerate:30,maxBitrate:1500},Pr={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:3500},Cn={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:3500},zr={maxResolution:{width:1920,height:1080},maxFramerate:30,maxBitrate:8500},Do={maxResolution:{width:1080,height:1920},maxFramerate:30,maxBitrate:8500},ls={reconnect:!1,timeout:Ne};function Lo(j){var C,P;if(typeof j!="string"&&j!==void 0)throw new Re(as);if(j){if(j.startsWith("https"))return j;{const H=/(?<protocol>(rtmps|https):\/\/)?(?<id>.+)\.(?<environment>(?=\S*['-])([a-zA-Z'-]+))\.live-video\.net.*/.exec(j);if(((C=H?.groups)===null||C===void 0?void 0:C.protocol)==="rtmps"&&console.warn("rtmps server url detected; please pass in the ingest endpoint (no rtmps:// protocol) instead"),(P=H?.groups)===null||P===void 0?void 0:P.id)return`https://${H.groups.id}.webrtc.live-video.net:4443`;throw new Re(di)}}return""}class cs{constructor(C,P,H=ii,X,te=ls){this.LOG_LEVEL=se,this.BASIC_LANDSCAPE=ii,this.BASIC_PORTRAIT=Tr,this.BASIC_FULL_HD_LANDSCAPE=Pr,this.BASIC_FULL_HD_PORTRAIT=Cn,this.STANDARD_LANDSCAPE=zr,this.STANDARD_PORTRAIT=Do,Wt.set(this,void 0),Kt.set(this,void 0),Lt.set(this,ii),yn.set(this,void 0),zn.set(this,ls),En.set(this,(ue=>{if(!ue)throw new Re(Object.assign(Object.assign({},er),{details:"missing stream configuration"}));if(!(ue.maxBitrate<=8500&&ue.maxBitrate>=200))throw new Re(Object.assign(Object.assign({},er),{details:"maxBitrate must be between 200 and 8500"}));if(!(ue.maxFramerate<=60&&ue.maxFramerate>=10))throw new Re(Object.assign(Object.assign({},er),{details:"maxFramerate must be between 10 and 60"}));const Ee=ue.maxResolution.width,w=ue.maxResolution.height;if(Ee>ri||w>ri||Ee<160||w<160||Ee===ri&&w>ha||w===ri&&Ee>ha)throw new Re(Object.assign(Object.assign({},er),{details:"maxResolution values must be between 1080x1920 or 1920x1080"}))})),tr.set(this,(ue=>{if(!ue)return;const Ee=Number(ue),w=Number.isInteger(Ee),h=Ee>=se.TRACE,b=Ee<=se.SILENT;if(!w||!h||!b)throw new Re(Oi)})),Ir.set(this,(ue=>{if(ue&&typeof ue!="object")throw new Re(Bs)})),Er.set(this,(ue=>{if(!ue)return;if(typeof ue!="object"||typeof ue.reconnect!="boolean")throw new Re(ws);const{timeout:Ee}=ue;if(Ee!==void 0&&(Number.isNaN(Ee)||typeof Ee!="number"||Ee<1e4||Ee>Le))throw new Re(na)})),rr(this,Ir,"f").call(this,X),rr(this,tr,"f").call(this,P),rr(this,En,"f").call(this,H),Dr(this,Wt,C),Dr(this,Kt,P),Dr(this,Lt,H),Dr(this,yn,X),Dr(this,zn,te)}get ingestEndpoint(){return rr(this,Wt,"f")}set ingestEndpoint(C){Dr(this,Wt,Lo(C))}get streamConfig(){return rr(this,Lt,"f")}set streamConfig(C){rr(this,En,"f").call(this,C),Dr(this,Lt,C)}get logLevel(){return rr(this,Kt,"f")}set logLevel(C){rr(this,tr,"f").call(this,C),Dr(this,Kt,C)}get logger(){return rr(this,yn,"f")}set logger(C){rr(this,Ir,"f").call(this,C),Dr(this,yn,C)}get networkReconnectConfig(){return rr(this,zn,"f")}set networkReconnectConfig(C){rr(this,Er,"f").call(this,C),Dr(this,zn,C)}}Wt=new WeakMap,Kt=new WeakMap,Lt=new WeakMap,yn=new WeakMap,zn=new WeakMap,En=new WeakMap,tr=new WeakMap,Ir=new WeakMap,Er=new WeakMap;var Xn,Jr=i(228);(function(j){j.PUBLISHED_VIDEO_STATS="ivs_broadcast_webrtc_published_video_stats",j.PUBLISHED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_published_video_stats_window",j.PUBLISHED_AUDIO_STATS="ivs_broadcast_webrtc_published_audio_stats",j.PUBLISHED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_published_audio_stats_window",j.SUBSCRIBED_VIDEO_STATS="ivs_broadcast_webrtc_subscribed_video_stats",j.SUBSCRIBED_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_video_stats_window",j.SUBSCRIBED_AUDIO_STATS="ivs_broadcast_webrtc_subscribed_audio_stats",j.SUBSCRIBED_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_sbcrbd_audio_stats_window",j.PUBLISH="ivs_broadcast_multihost_publish",j.UNPUBLISH="ivs_broadcast_multihost_unpublish",j.SUBSCRIBE="ivs_broadcast_multihost_subscribe",j.UNSUBSCRIBE="ivs_broadcast_multihost_unsubscribe",j.PUBLISH_STARTED="ivs_broadcast_multihost_publish_started",j.PUBLISH_FAILED="ivs_broadcast_multihost_publish_failed",j.PUBLISH_ENDED="ivs_broadcast_multihost_publish_ended",j.STATE_UPDATED="ivs_broadcast_multihost_event_state_updated",j.SUBSCRIBE_STARTED="ivs_broadcast_multihost_subscribe_started",j.SUBSCRIBE_FAILED="ivs_broadcast_multihost_subscribe_failed",j.SUBSCRIBE_ENDED="ivs_broadcast_multihost_subscribe_ended",j.FIRST_FRAME="ivs_broadcast_multihost_first_frame",j.JOIN="ivs_broadcast_multihost_join",j.JOIN_ATTEMPT="ivs_broadcast_multihost_event_connect_attempt",j.JOIN_ATTEMPT_FAILED="ivs_broadcast_multihost_event_connect_failed",j.JOIN_ENDED="ivs_broadcast_multihost_join_ended",j.LEAVE="ivs_broadcast_multihost_leave",j.REASSIGNMENT_REQUEST="ivs_broadcast_multihost_reassignment_request",j.SERVER_REQUEST="ivs_broadcast_multihost_server_request",j.TRACE="ivs_broadcast_stage_trace",j.ERROR="ivs_broadcast_error",j.MINUTE="ivs_broadcast_multihost_minute",j.CONNECTION_STATE="ivs_broadcast_webrtc_connection_state",j.ICE_GATHERING_STATE="ivs_broadcast_webrtc_gathering_state",j.EDP_CONNECTED="ivs_broadcast_multihost_event_connected",j.EDP_DISCONNECTED="ivs_broadcast_multihost_event_disconnected",j.EDP_PONG="ivs_broadcast_multihost_edp_rtt",j.SIMULCAST_LAYER_INFO="ivs_broadcast_simulcast_layer_info",j.MULTIHOST_CONFIGURATION="ivs_broadcast_multihost_configuration",j.MULTIHOST_SUBSCRIBE_CONFIGURATION="ivs_broadcast_multihost_subscribe_configuration",j.PLAYBACK_LAYER_REQUEST="ivs_broadcast_multihost_playback_layer_request",j.PLAYBACK_LAYER_STATE="ivs_broadcast_multihost_playback_layer_state",j.SELECTED_PAIR_CHANGE="ivs_broadcast_webrtc_selected_pair_change",j.ANALYTICS_HEALTH_REPORT="ivs_broadcast_analytics_health_report"})(Xn||(Xn={}));class ur{constructor(C,P,H,X){let te="unknown";if(P.stageARN&&P.stageARN.startsWith("arn:aws:ivs:")){const ue=P.stageARN.split(":");ue.length===6&&(te=ue[4])}this.event=C,this.properties={client_time:new Date().toISOString(),customer_id:te,device_software:window.navigator.userAgent,multihost_id:P.stageARN,participant_id:P.participantID,participant_user_id:P.userID,platform:"web",sdk_version:"1.27.0",stage_arn:P.stageARN,trace_id:H.value},P.attrGsRole&&(this.properties.token_attribute_0=P.attrGsRole),P.attrGsSessionId&&(this.properties.token_attribute_1=P.attrGsSessionId),this.critical=X}}class Fs extends ur{constructor(C){super(Xn.ERROR,C.token,C.traceId,!0),Object.assign(this.properties,{code:C.code,tag:C.tag,description:C.message,remote_participant_id:C.remoteParticipantId,request_uuid:C.requestUUID,is_nominal:C.nominal,is_fatal:C.fatal,details:C.details,location:C.location,event_count:C.count})}}function bo(j){const C=window.IVS_CLIENT_OVERRIDES;return typeof C=="object"?C[j]:j==="logLevel"?window.STAGES_LOG_LEVEL:j==="appLabel"?window.IVS_APP_LABEL:j==="whipUrl"?window.IVS_DATA_PLANE_ENDPOINT:void 0}function da(j){const C=bo(j);if(typeof C=="string")return C}function pa(j){const C=bo(j);if(typeof C=="boolean")return C}function zh(j){const C=bo(j);if(typeof C=="number")return C;if(typeof C=="string"){const P=parseFloat(C);if(!isNaN(P))return P}}function lp(){const j=bo("logLevel");if(typeof j=="number"&&Object.values(se).includes(j))return j}function Wp(){return pa("disableXdp")}function Yp(){return pa("preferMainProfile")}function rh(){return pa("enableInitialLayerOnSdp")}function Tl(){return pa("disableAudioRtcpRsize")}var ac=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Uo(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(j=>{const C=16*Math.random()|0;return(j==="x"?C:3&C|8).toString(16)}))}function rl(j,C=P=>{}){ac(this,void 0,void 0,(function*(){try{yield j()}catch(P){C(P)}}))}var Xp=i(6880),wc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Gc(j,C,P={},H=""){return wc(this,void 0,void 0,(function*(){const X=new XMLHttpRequest;return X.open(j,C,!0),P&&Object.keys(P).forEach((te=>{P.hasOwnProperty(te)&&X.setRequestHeader(te,P[te])})),new Promise(((te,ue)=>{X.onreadystatechange=()=>{X.readyState===4&&(X.status>=200&&X.status<300?te(X.responseText):ue(new Error(`Ingest ${j} ${C} responded ${X.status}
${X.responseText}`)))},X.send(H)}))}))}function $u(j){const C=Date.now();for(const H of j)H.properties.batch_time_millis=C;var P;return{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},body:`data=${P=JSON.stringify(j),btoa(encodeURIComponent(P).replace(/%([0-9A-F]{2})/g,((H,X)=>String.fromCharCode(+`0x${X}`))))}`}}class Wi{send(C,P=!1){return wc(this,void 0,void 0,(function*(){const{currentEndpoint:H}=ma,{headers:X,body:te}=$u(C),ue="eventSenderResult",Ee=C.length;if(P){const w=navigator.sendBeacon(H,te);ma.trackEvent({type:ue,success:w,count:Ee})}else rl((()=>wc(this,void 0,void 0,(function*(){yield Gc("POST",H,X,te),ma.trackEvent({type:ue,success:!0,count:Ee})}))),(()=>{ma.trackEvent({type:ue,success:!1,count:Ee})}))}))}}class Yi{constructor({globalProperties:C,totalEvents:P,totalEventsLost:H,windowedEvents:X,windowedEventsLost:te,currentEndpoint:ue}){this.transformProperties=(w,h,b,k,F)=>({total_events:w,total_events_lost:h,windowed_events:b,windowed_events_lost:k,current_endpoint:F});const Ee=this.transformProperties(P,H,X,te,ue);this.data={event:Xn.ANALYTICS_HEALTH_REPORT,properties:Object.assign(Object.assign({},C),Ee)}}}var Rc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Ef={totalEvents:0,totalEventsSent:0,totalEventsLost:0,windowedEvents:0,windowedEventsSent:0,windowedEventsLost:0};class Zm{constructor(C){this.globalSession=C,this.eventSenderMetrics=Object.assign({},Ef),this.emptyWindows=0,this.scheduleHealthReport=()=>{this.reportTimer=window.setTimeout(this.onHealthReportInterval,6e4)},this.onHealthReportInterval=()=>{const P=Object.assign({},this.eventSenderMetrics);if(this.eventSenderMetrics.windowedEvents===0?this.emptyWindows++:this.emptyWindows=0,this.emptyWindows>3)return window.clearTimeout(this.reportTimer),void(this.reportTimer=void 0);this.postHealthReport(P),this.eventSenderMetrics.windowedEvents=0,this.eventSenderMetrics.windowedEventsSent=0,this.eventSenderMetrics.windowedEventsLost=0,this.scheduleHealthReport()}}trackEventSendResult(C){const{count:P,success:H}=C;this.eventSenderMetrics.totalEvents+=P,this.eventSenderMetrics.windowedEvents+=P,H?(this.eventSenderMetrics.totalEventsSent+=P,this.eventSenderMetrics.windowedEventsSent+=P):(this.eventSenderMetrics.totalEventsLost+=P,this.eventSenderMetrics.windowedEventsLost+=P),this.isHealthReportScheduled()||this.scheduleHealthReport()}isHealthReportScheduled(){return typeof this.reportTimer=="number"}postHealthReport(C){const P=this.globalSession.parseGlobalProperties(),H=this.globalSession.currentEndpoint,X=new Yi(Object.assign(Object.assign({globalProperties:P},C),{currentEndpoint:H})),{headers:te,body:ue}=$u([X.data]);rl((()=>Rc(this,void 0,void 0,(function*(){yield Gc("POST",H,te,ue)}))))}}class oc{constructor(){this.emitter=new Jr}hasListenersFor(C){return this.emitter.listenerCount(C)>0}on(C,P,H){P.call=(function(X,te){return function(ue,...Ee){try{te.apply(ue,Ee)}catch(w){let h=`Error in callback for ${X}`;const b=te.name;return b&&(h+=` for function ${b}`),void console.error(`${h}
`,w)}}})(C,P),this.emitter.on(C,P,H)}off(C,P,H){this.emitter.off(C,P,H)}emit(C,...P){this.emitter.emit(C,...P)}removeAllListeners(){this.emitter.removeAllListeners()}}var co;(function(j){j[j.EXCELLENT=4]="EXCELLENT",j[j.GOOD=3]="GOOD",j[j.NORMAL=2]="NORMAL",j[j.POOR=1]="POOR",j[j.DOWN=0]="DOWN"})(co||(co={}));var $c;(function(j){j.NETWORK_QUALITY_CHANGE="networkQualityChange"})($c||($c={}));class Wc extends oc{constructor(){super(),this.lastNetworkStatus={},this.networkAssessment={networkQuality:co.NORMAL,reason:"no-data"},this.checkNetworkStatus=()=>{var C,P;const H=(C=navigator?.connection)!==null&&C!==void 0?C:{},X={downlink:H.downlink,effectiveType:H.effectiveType,rtt:H.rtt,isOnline:(P=navigator.onLine)===null||P===void 0||P};if(!this.isChangedNetworkStatus(this.lastNetworkStatus,X))return;this.lastNetworkStatus=X;const te=this.networkAssessment,ue=(function(Ee){const{rtt:w,downlink:h,isOnline:b}=Ee;if(!b)return{networkQuality:co.DOWN,reason:"offline"};if(typeof w!="number"||typeof h!="number")return{networkQuality:co.NORMAL,reason:"no-data"};let k=0;w>800?k+=2:w>300&&(k+=1),h<2.5?k+=2:h<5&&(k+=1);const F="score";switch(k){case 4:return{networkQuality:co.POOR,reason:F};case 0:return{networkQuality:co.EXCELLENT,reason:F};default:return{networkQuality:k<=2?co.GOOD:co.NORMAL,reason:F}}})(X);te.networkQuality!==ue.networkQuality&&this.emit($c.NETWORK_QUALITY_CHANGE,te.networkQuality,ue.networkQuality),this.networkAssessment=ue},this.getNetworkQuality=()=>this.networkAssessment.networkQuality,this.setupWindowListeners(),this.checkNetworkStatus()}setupWindowListeners(){window.addEventListener("online",(()=>{this.checkNetworkStatus()})),window.addEventListener("offline",(()=>{this.checkNetworkStatus()})),window.navigator.connection&&window.navigator.connection.addEventListener("change",(()=>{this.checkNetworkStatus()}))}isChangedNetworkStatus(C,P){const{downlink:H,effectiveType:X,rtt:te,isOnline:ue}=P;return C.effectiveType!==X||C.downlink!==H||C.rtt!==te||C.isOnline!==ue}}class ih{constructor(){this.globalSessionId=Uo(),this.currentGlobalEndpoint="https://broadcast.stats.live-video.net/",this.healthReporter=new Zm(this),this.networkMonitor=new Wc}getGlobalSessionId(){return this.globalSessionId}set currentEndpoint(C){this.currentGlobalEndpoint=C}get currentEndpoint(){var C;return!((C=window.IVS_CLIENT_OVERRIDES)===null||C===void 0)&&C.analyticsPostUrl?window.IVS_CLIENT_OVERRIDES.analyticsPostUrl:this.currentGlobalEndpoint}trackEvent(C){C.type==="eventSenderResult"&&this.healthReporter.trackEventSendResult(C)}getNetworkQuality(){return this.networkMonitor.getNetworkQuality()}parseGlobalProperties(){const C=Xp.getParser(navigator.userAgent),P=(function(H){const X=/^(\d+)\.(\d+)\.(\d+)[+|-]?(.*)?$/.exec(H)||/^(\d+)\.(\d+)[+|-]?(.*)?$/.exec(H)||/^(\d+)$/.exec(H)||[];return{major:parseInt(X[1],10)||0,minor:parseInt(X[2],10)||0,patch:parseInt(X[3],10)||0}})(String(C.getBrowserVersion()));return{browser:navigator.appVersion,browser_family:C.getBrowserName().toLowerCase(),browser_version:`${P.major}.${P.minor}`,customer_id:"ivs",host:window.location.hostname,os_name:C.getOSName(),os_version:String(C.getOSVersion()),platform:"web",global_session_id:this.getGlobalSessionId(),sdk_version:"1.27.0",user_agent:navigator.userAgent,is_backgrounded:document?.visibilityState==="hidden"}}}window.IVS_CLIENT_GLOBAL_STATE||(window.IVS_CLIENT_GLOBAL_STATE={}),window.IVS_CLIENT_GLOBAL_STATE.session||(window.IVS_CLIENT_GLOBAL_STATE.session=new ih);const ma=window.IVS_CLIENT_GLOBAL_STATE.session;function xf(j){if(!j)throw new Error("eventSender is not defined")}class sh{constructor(){this.sharedProperties={},this.eventSender={},this.queuedEvents=[],this.genSessionId();const C=(function(){const P=da("appLabel");if(P!==void 0)return P.substring(0,64)})();this.eventSender=new Wi,this.initSharedProperties({appLabel:C}),this.errorReports=new Map}start(){this.flushInterval||(this.flushInterval=window.setInterval((()=>{this.queueAggregateErrors({force:!1}),this.flushEvents()}),1e3))}stop(C){let P=!1;clearInterval(this.flushInterval),this.flushInterval=void 0,this.queueAggregateErrors({force:!0}),C&&(this.queuedEvents=this.queuedEvents.filter((H=>H.critical)),P=!0),this.flushEvents(P),this.genSessionId()}trackEvent(C,P=!1){let H=this.sharedProperties;P&&(H={global_session_id:this.sharedProperties.global_session_id,session_id:this.sharedProperties.session_id,browser:this.sharedProperties.browser,browser_family:this.sharedProperties.browser_family,browser_version:this.sharedProperties.browser_version,os_name:this.sharedProperties.os_name,os_version:this.sharedProperties.os_version,is_backgrounded:this.sharedProperties.is_backgrounded}),document?.visibilityState==="hidden"&&(H.is_backgrounded=!0),"data"in C?(C.data.properties=Object.assign({},H,C.data.properties),this.queuedEvents.push(C.data)):(C.properties=Object.assign({},H,C.properties),this.queuedEvents.push(C))}trackEventNoSharedProps(C){this.trackEvent(C,!0)}trackErrorAndThrow(C){throw this.trackError(C),C}trackError(C){const P=`${C.code}${C.fatal}${C.nominal}${C.tag}${C.traceId.value}`,H=this.errorReports.get(P),X={error:C,queuedAt:Date.now(),count:0};return H?(H.count===0&&(H.error=C),H.count+=1,H.queuedAt+6e4<=Date.now()?(this.trackErrorReportIfNeeded(H),void this.errorReports.set(P,X)):void 0):(this.errorReports.set(P,X),void this.trackEvent(new Fs(C)))}queueAggregateErrors({force:C=!1}){this.errorReports.forEach(((P,H)=>{const X=P.queuedAt+6e4;!C&&X>Date.now()||(this.trackErrorReportIfNeeded(P),this.errorReports.delete(H))}))}trackErrorReportIfNeeded(C){if(C.count===0)return;const P=C.error;P.count=C.count,this.trackEvent(new Fs(P))}batchEvents(C){xf(this.eventSender);const P=C.map((H=>(H.data.properties=Object.assign({},this.sharedProperties,H.data.properties),H.data)));this.eventSender.send(P)}initSharedProperties({appLabel:C}){const P=ma.parseGlobalProperties();this.sharedProperties=Object.assign(Object.assign({},P),{session_id:this.sessionId}),C&&(this.sharedProperties.app_label=C)}genSessionId(){this.sessionId=Uo(),this.sharedProperties.session_id=this.sessionId}flushEvents(C=!1){xf(this.eventSender),this.queuedEvents.length>0&&this.eventSender.send(this.queuedEvents,C),this.queuedEvents=[]}getSessionId(){return this.sessionId}}class ah{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.CONGESTION_TIME,properties:H}}}class Qm{constructor(C,P,H){this.transformProperties=(te,ue,Ee)=>({duration:(te.getTime()-(ue?.getTime()||0))/1e3,ecn_negotiated:!1,ingest_session_id:Ee});const X=this.transformProperties(C,P,H);this.data={event:vs.CONNECTION_ESTABLISHED,properties:X}}}class Wu{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.CONNECTION_RTT,properties:H}}}class Tf{constructor(C){this.transformProperties=H=>{var X;return{is_fatal:(X=H.isFatal)!==null&&X!==void 0&&X,value:H.value,code:H.code,description:H.description}};const P=this.transformProperties(C);this.data={event:vs.ERROR,properties:P}}}class oh{constructor(C,P){this.transformProperties=(X,te)=>({type:X,input_device_id:te.deviceId,position:te.facingMode||"unknown"});const H=this.transformProperties(C,P);this.data={event:vs.INPUT_DEVICE_ATTACHED,properties:H}}}class Bo{constructor(C,P){this.transformProperties=(X,te)=>({type:X,input_device_id:te.deviceId,position:te.facingMode||"unknown"});const H=this.transformProperties(C,P);this.data={event:vs.INPUT_DEVICE_DETACHED,properties:H}}}class Vl{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.MEASURED_BITRATE,properties:H}}}class Ad{constructor(C,P){this.transformProperties=(X,te)=>({minutes_logged:Math.round((X.timestamp-te)/6e4)});const H=this.transformProperties(C,P);this.data={event:vs.MINUTE_BROADCAST,properties:H}}}class Kp{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.RECOMMENDED_BITRATE,properties:H}}}class il{constructor(C){this.transformProperties=H=>({codec:H.mimeType,bitrate:0,sample_rate:H.clockRate,channel_count:H.channels});const P=this.transformProperties(C);this.data={event:vs.SESSION_AUDIO_ENCODER_CONFIGURED,properties:P}}}class Jm{constructor(C){this.transformProperties=H=>({codec:"audio",bitrate:32e3,sample_rate:H.sampleRate,channel_count:H.channelCount});const P=this.transformProperties(C);this.data={event:vs.SESSION_AUDIO_PROPERTIES,properties:P}}}class q_{constructor(C,P,H){this.transformProperties=(te,ue,Ee)=>({codec:Ee.mimeType,codec_profile:ue.profile,codec_level:ue.level,rate_mode:"vbr",initial_bitrate:0,keyframe_interval:2,width:te.width,height:te.height,bframe_count:0,target_fps:te.frameRate});const X=this.transformProperties(C,P,H);this.data={event:vs.SESSION_VIDEO_ENCODER_CONFIGURED,properties:X}}}class V_{constructor(C){this.transformProperties=H=>({codec:"video",initial_bitrate:32e3,min_bitrate:0,max_bitrate:0,keyframe_interval:2,width:H.width,height:H.height,auto_bitrate_enabled:!0,bframes_enabled:!1,target_fps:H.frameRate});const P=this.transformProperties(C);this.data={event:vs.SESSION_VIDEO_PROPERTIES,properties:P}}}class cp{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.SOURCE_AUDIO_LATENCY,properties:H}}}class jh{constructor(C,P){this.transformProperties=(X,te)=>({sum:X.sum,median:X.median(),min:X.min,max:X.max,p90:X.percentile(.9),event_count:X.data.length,period:te});const H=this.transformProperties(C,P);this.data={event:vs.SOURCE_VIDEO_LATENCY,properties:H}}}class Hh{constructor(C,P){this.transformProperties=({protocol:X,hostname:te,port:ue},Ee)=>({protocol:X,endpoint_host:te,endpoint_port:ue,reason:Ee});const H=this.transformProperties(C,P);this.data={event:vs.START_BROADCAST,properties:H}}}class Yu{constructor(C){this.transformProperties=({protocol:H,hostname:X,port:te})=>({protocol:H,endpoint_host:X,endpoint_port:te});const P=this.transformProperties(C);this.data={event:vs.STOP_BROADCAST,properties:P}}}class Xu{constructor(C){this.transformProperties=H=>({bytes_sent:H.bytesSent,header_bytes_sent:H.headerBytesSent,nack_count:H.nackCount,packets_sent:H.packetsSent,retransmitted_bytes_sent:H.retransmittedBytesSent,retransmitted_packets_sent:H.retransmittedPacketsSent});const P=this.transformProperties(C);this.data={event:vs.WEBRTC_AUDIO_STATS,properties:P}}}class eg{constructor(C){this.transformProperties=H=>({bytes_sent:H.bytesSent,fir_count:H.firCount,frames_encoded:H.framesEncoded,frames_sent:H.framesSent,header_bytes_sent:H.headerBytesSent,huge_frames_sent:H.hugeFramesSent,key_frames_encoded:H.keyFramesEncoded,nack_count:H.nackCount,packets_sent:H.packetsSent,pli_count:H.pliCount,quality_limitation_reason:H.qualityLimitationReason,quality_limitation_resolution_changes:H.qualityLimitationResolutionChanges,retransmitted_bytes_sent:H.retransmittedBytesSent,retransmitted_packets_sent:H.retransmittedPacketsSent,total_encode_time:H.totalEncodeTime,total_encoded_bytes_target:H.totalEncodedBytesTarget,total_packet_send_delay:H.totalPacketSendDelay});const P=this.transformProperties(C);this.data={event:vs.WEBRTC_VIDEO_STATS,properties:P}}}var vs,Ta;(function(j){j.START_BROADCAST="ivs_broadcast_start_broadcast",j.STOP_BROADCAST="ivs_broadcast_stop_broadcast",j.MINUTE_BROADCAST="ivs_broadcast_minute_broadcast",j.WEBRTC_AUDIO_STATS="ivs_broadcast_webrtc_audio_stats",j.WEBRTC_VIDEO_STATS="ivs_broadcast_webrtc_video_stats",j.WEBRTC_AUDIO_STATS_WINDOW="ivs_broadcast_webrtc_audio_stats_window",j.WEBRTC_VIDEO_STATS_WINDOW="ivs_broadcast_webrtc_video_stats_window",j.CONNECTION_ESTABLISHED="ivs_broadcast_connection_established",j.SESSION_VIDEO_PROPERTIES="ivs_broadcast_session_video_properties",j.SESSION_AUDIO_PROPERTIES="ivs_broadcast_session_audio_properties",j.SESSION_VIDEO_ENCODER_CONFIGURED="ivs_broadcast_session_video_encoder_configured",j.SESSION_AUDIO_ENCODER_CONFIGURED="ivs_broadcast_session_audio_encoder_configured",j.SOURCE_AUDIO_LATENCY="ivs_broadcast_source_audio_latency",j.SOURCE_VIDEO_LATENCY="ivs_broadcast_source_video_latency",j.INPUT_DEVICE_ATTACHED="ivs_broadcast_input_device_attached",j.INPUT_DEVICE_DETACHED="ivs_broadcast_input_device_detached",j.CONGESTION_TIME="ivs_broadcast_congestion_time",j.BUFFER_DURATION="ivs_broadcast_buffer_duration",j.MEASURED_BITRATE="ivs_broadcast_measured_bitrate",j.RECOMMENDED_BITRATE="ivs_broadcast_recommended_bitrate",j.CONNECTION_RTT="ivs_broadcast_connection_rtt",j.ERROR="ivs_broadcast_error"})(vs||(vs={})),(function(j){j.USER_INITIATED="user-initiated",j.NETWORK_DISCONNECT="network-disconnect"})(Ta||(Ta={}));const up={[se.INFO]:"#528bff",[se.WARN]:"#ffb31a",[se.DEBUG]:"#00f593",[se.ERROR]:"#ff4f4d",[se.TRACE]:"",[se.SILENT]:"",[_e.TIME]:"#53535f",[_e.WEBRTC]:"#0e9bd8",[_e.SUBSCRIPTION]:"#ffc400",[_e.CONNECTION]:"#ff5edb",[_e.SOCKET]:"#8585ff",[_e.EMITTER]:"#adadb8",[_e.LOCAL_PARTICIPANT]:"#1DD21D",[_e.STAGE]:"#EC9806",[_e.REMOTE_PARTICIPANT]:"#0680EC",details:"#808080"},tg=({label:j})=>`background: ${up[j]||"#333333"}; color: white; padding: 3px; margin-left: 3px;`,qh=Object.entries(se),rt=(j,C,P)=>{const H=tg({label:j}),[X]=qh.find((([,pe])=>pe===Number(j)))||[],te=`%c${X}`,ue=tg({label:C}),Ee=`%c${C}`,w=tg({label:_e.TIME}),h=`%c[${new Date().toISOString()}]`,b=tg({label:"details"}),k=`%c[${P}]`,F=[h,te,Ee],ie=[w,H,ue];return P&&(F.push(k),ie.push(b)),[F.join(""),...ie]},Tt={debug(j){console.groupCollapsed(...rt(se.DEBUG,j.scope,j.label)),console.debug(j.msg,Object.assign(Object.assign({},j),{level:"debug"})),console.groupEnd()},info(j){console.groupCollapsed(...rt(se.INFO,j.scope,j.label)),console.info(j.msg,Object.assign(Object.assign({},j),{level:"info"})),console.groupEnd()},warn(j){console.groupCollapsed(...rt(se.WARN,j.scope,j.label)),console.warn(j.msg,Object.assign(Object.assign({},j),{level:"warn"})),console.groupEnd()},error(j){console.groupCollapsed(...rt(se.ERROR,j.scope,j.label)),console.error(j),console.groupEnd()}};var Rt=function(j,C){var P={};for(var H in j)Object.prototype.hasOwnProperty.call(j,H)&&C.indexOf(H)<0&&(P[H]=j[H]);if(j!=null&&typeof Object.getOwnPropertySymbols=="function"){var X=0;for(H=Object.getOwnPropertySymbols(j);X<H.length;X++)C.indexOf(H[X])<0&&Object.prototype.propertyIsEnumerable.call(j,H[X])&&(P[H[X]]=j[H[X]])}return P};Object.entries(se);class tn{constructor(C=Cr,P=Tt){this.logLevel=C,this.loggerInstance=P}debug(C){var P,H;this.logLevel>se.DEBUG||(H=(P=this.loggerInstance).debug)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"debug"}))))}info(C){var P,H;this.logLevel>se.INFO||(H=(P=this.loggerInstance).info)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"info"}))))}warn(C){var P,H;this.logLevel>se.WARN||(H=(P=this.loggerInstance).warn)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{level:"warn"}))))}error(C){var P,H,{err:X}=C,te=Rt(C,["err"]);this.logLevel>se.ERROR||(H=(P=this.loggerInstance).error)===null||H===void 0||H.call(P,Object.assign({err:X},te))}}class wn{constructor(C,P){this.logger=C,this.scope=P}debug(C){var P,H;(H=(P=this.logger).debug)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}info(C){var P,H;(H=(P=this.logger).info)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}warn(C){var P,H;(H=(P=this.logger).warn)===null||H===void 0||H.call(P,JSON.parse(JSON.stringify(Object.assign(Object.assign({},C),{scope:this.scope}))))}error(C){var P,H,{err:X}=C,te=Rt(C,["err"]);(H=(P=this.logger).error)===null||H===void 0||H.call(P,Object.assign(Object.assign({err:X},te),{scope:this.scope}))}unwrap(){return this.logger}}class Zn{constructor(){this.min=0,this.max=0,this.sum=0,this.data=[]}push(C){(this.min===0||C<this.min)&&(this.min=C),C>=this.max&&(this.max=C),this.data.push(C),this.sum+=C}median(){this.data.sort();const C=this.data.length>>1;return this.data.length%2==0?this.data[C-1]+this.data[C]>>1:this.data[C]}percentile(C){if(this.data.length===0)return 0;if(C<=0)return this.data[0];if(C>=1)return this.data[this.data.length-1];const P=(this.data.length-1)*C,H=Math.floor(P),X=H+1,te=P%1;return X>=this.data.length?this.data[H]:this.data[H]*(1-te)+this.data[X]*te}}var Ri=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class sl{constructor(C,P,H,X){this.peerClient=C,this.broadcastCanvasManager=P,this.analyticsTracker=X,this.logger=new wn(H,_e.EMITTER),this.previousBytesSent=0,this.startTimestamp=0,this.initializeSamples()}start(){this.logger.info({msg:"start emitter"}),this.collectSamplesTimerId=window.setInterval((()=>{this.collectSamples()}),1e3),this.trackSamplesTimerId=window.setInterval((()=>{this.trackSamples()}),3e4),this.trackPeerConnectionStatsTimerId=window.setInterval((()=>{this.trackPeerConnectionStats()}),6e4),this.trackSamples()}stop(){clearInterval(this.collectSamplesTimerId),clearInterval(this.trackSamplesTimerId),clearInterval(this.trackPeerConnectionStatsTimerId),this.collectSamplesTimerId=void 0,this.trackSamplesTimerId=void 0,this.trackPeerConnectionStatsTimerId=void 0}trackPeerConnectionStats(){return Ri(this,void 0,void 0,(function*(){(yield this.peerClient.getReports()).forEach((C=>{if(C.type==="outbound-rtp")switch(C.kind){case"audio":this.analyticsTracker.trackEvent(new Xu(C));break;case"video":{const P=new eg(C),H=new Ad(C,this.startTimestamp);this.analyticsTracker.batchEvents([P,H]);break}default:this.logger.warn({msg:"unknown report kind: ",reportKind:C.kind})}}))}))}collectSamples(){return Ri(this,void 0,void 0,(function*(){let C=0;this.audioLatencySamples.push(this.broadcastCanvasManager.getAudioLatency()),this.videoLatencySamples.push(this.broadcastCanvasManager.getVideoLatency()),(yield this.peerClient.getReports()).forEach((H=>{switch(H.type){case"candidate-pair":H.nominated&&(this.rttSamples.push(H.currentRoundTripTime),this.recommendedBitrateSamples.push(H.availableOutgoingBitrate));break;case"outbound-rtp":C+=H.bytesSent||0,this.startTimestamp===0&&H.kind==="video"&&(this.startTimestamp=H.timestamp)}}));const P=8*Math.round(C-this.previousBytesSent);this.previousBytesSent=C,this.measuredBitrateSamples.push(P)}))}trackSamples(){const P=new cp(this.audioLatencySamples,30),H=new jh(this.videoLatencySamples,30),X=new ah(this.congestionTimeSamples,30),te=new Vl(this.measuredBitrateSamples,30),ue=new Kp(this.recommendedBitrateSamples,30),Ee=new Wu(this.rttSamples,30);this.analyticsTracker.batchEvents([P,H,X,te,ue,Ee]),this.initializeSamples()}initializeSamples(){this.audioLatencySamples=new Zn,this.videoLatencySamples=new Zn,this.congestionTimeSamples=new Zn,this.measuredBitrateSamples=new Zn,this.recommendedBitrateSamples=new Zn,this.rttSamples=new Zn}}const _r={CONNECTION_STATE_CHANGE:"connectionStateChange",ERROR:"clientError",ACTIVE_STATE_CHANGE:"activeStateChange"},So="connectionStateChange",wf="sdpNegotiated",ns="clientError",Ac="seiMessageReceived",lh="transformError";var sr;(function(j){j.CLOSED="closed",j.COMPLETED="completed",j.CONNECTED="connected",j.CONNECTING="connecting",j.DISCONNECTED="disconnected",j.FAILED="failed",j.IDLE="idle",j.NEW="new",j.NONE="none"})(sr||(sr={}));const Cc=j=>{const C=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("web-contents-media-stream")?"tab":void 0},P=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("window")&&te.displaySurface==="window"?"window":void 0},H=te=>{var ue;return!((ue=te.deviceId)===null||ue===void 0)&&ue.startsWith("screen")&&te.displaySurface==="monitor"?"screen":void 0};return(C(X=j)||P(X)||H(X)?void 0:"camera")||H(j)||P(j)||C(j)||"unknown";var X};function Oa(j,C){return j.find((P=>P.kind===C))}function vr(j){return j?.readyState==="live"}var Vr;(function(j){j.VIDEO="video",j.AUDIO="audio"})(Vr||(Vr={}));class ch{constructor(){this.mediaTracks=new Map([[Vr.VIDEO,void 0],[Vr.AUDIO,void 0]])}setTrack(C,P){this.mediaTracks.set(C,P)}getTrack(C){return this.mediaTracks.get(C)}}class Rf{constructor(){this.levelAsymmetryAllowed=!1,this.packetisationMode=!1,this.profile="",this.level=0}extractVideoSdpFmtpLine(C){return C?(C.split("\r").join(";").split(`
`).join(";").split(" ").join(";").split(";").map((P=>P.trim())).filter(Boolean).forEach((P=>{const H=P.split("=");if(H.length===2)switch(H[0]){case"level-asymmetry-allowed":H[1]==="1"?this.levelAsymmetryAllowed=!0:this.levelAsymmetryAllowed=!1;break;case"packetization-mode":H[1]==="1"?this.packetisationMode=!0:this.packetisationMode=!1;break;case"profile-level-id":this.profile=this.getProfileFromId(H[1]),this.level=this.getLevelFromId(H[1])}})),{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}):{levelAsymmetryAllowed:this.levelAsymmetryAllowed,packetisationMode:this.packetisationMode,profile:this.profile,level:this.level}}getProfileFromId(C){const P=C.substr(0,2),H=C.substr(2,2);switch(P.substr(0,2)){case"42":return"baseline";case"4d":return"main";case"58":return"extended";case"64":return"high";case"6e":return H==="00"?"high 10":"high 10 intra";case"7a":return H==="00"?"high 42":"high 42 intra";case"f4":return H==="00"?"high 44":"high 44 intra";default:return"unknown"}}getLevelFromId(C){return parseInt(C.substr(4,2),16)}}function X0(j){return btoa(JSON.stringify(j))}var Gl,ng=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};(function(j){j.IDLE="idle",j.EXECUTING="executing",j.RECONNECTING="reconnecting"})(Gl||(Gl={}));class Eo{constructor(C,P=12e4,H,X){this.state=Gl.IDLE,this.failureCallback=()=>{},this.peerClient=C,this.timeout=P,this.logger=H,this.emitter=X}onFailure(C){this.failureCallback=C}setStartConfig(C,P){this.ingestEndpoint=C,this.streamKey=P}execute(){const{id:C}=this;this.state===Gl.IDLE&&(this.state=Gl.EXECUTING,this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.CONNECTING),this.logger.info({msg:"Starting execution of reconnect strategy.",id:C}),this.startTimeoutTimer(this.timeout),this.executeStrategy())}startTimeoutTimer(C){this.timeoutTimerId=window.setTimeout((()=>{this.state!==Gl.IDLE&&(this.logger.info({msg:"Reconnect strategy timed out."}),this.stop(),this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.FAILED),this.failureCallback())}),C)}stop(){this.state=Gl.IDLE,clearTimeout(this.timeoutTimerId),this.stopStrategy()}reconnect(){return ng(this,void 0,void 0,(function*(){if(this.ingestEndpoint&&this.streamKey){const C=this.peerClient.getConnectionState();try{this.logger.info({msg:"Attempting reconnect."}),C===sr.CONNECTED?this.logger.info({msg:"Already connected! Stopping reconnect strategy."}):(yield this.peerClient.start(this.ingestEndpoint,this.streamKey),this.logger.info({msg:"Reconnect succeeded!"})),this.stop()}catch(P){throw this.logger.error({err:P}),P}}}))}isActive(){return this.state!==Gl.IDLE}}class Fo extends Eo{constructor(){super(...arguments),this.id="ExponentialBackoffStrategy"}executeStrategy(){let C=5e3;const P=()=>ng(this,void 0,void 0,(function*(){if(this.state===Gl.EXECUTING)try{this.state=Gl.RECONNECTING,yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed. Trying again in: ",nextRetry:C}),this.state=Gl.EXECUTING,this.currentTimeoutId=window.setTimeout(P,C),C*=2}}));this.currentTimeoutId=window.setTimeout(P,0)}stopStrategy(){clearTimeout(this.currentTimeoutId)}}class Su extends Eo{constructor(){super(...arguments),this.id="NetworkApiStrategy",this.onConnectionChange=()=>ng(this,void 0,void 0,(function*(){if(navigator.onLine&&this.state===Gl.EXECUTING){this.state=Gl.RECONNECTING;try{yield this.reconnect()}catch{this.logger.warn({msg:"Attempted reconnect failed."}),this.state=Gl.EXECUTING}}}))}executeStrategy(){navigator.connection.addEventListener("change",this.onConnectionChange),this.onConnectionChange()}stopStrategy(){navigator.connection.removeEventListener("change",this.onConnectionChange)}}class Yg{static create(C,P=ls,H,X){const{reconnect:te,timeout:ue}=P;if(te){const Ee=Xp.getParser(navigator.userAgent).getBrowserName().toLowerCase();return["edge","chrome"].includes(Ee)&&navigator.connection?new Su(C,ue,H,X):new Fo(C,ue,H,X)}}}var Eu,uh=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Zp=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};const fh=j=>!!j;function Af(j){if(!j)throw new Error("PeerConnection is not defined")}const Yc={bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",enableDtlsSrtp:{exact:!0},enableRtpDataChannels:{exact:!1},optional:[{googHighStartBitrate:{exact:0}},{googPayloadPadding:{exact:!0}},{googScreencastMinBitrate:{exact:100}},{googCpuOveruseDetection:{exact:!0}},{googCpuOveruseEncodeUsage:{exact:!0}},{googCpuUnderuseThreshold:{exact:55}},{googCpuOveruseThreshold:{exact:85}},{enableDscp:{exact:!0}}]};class Hi{constructor(C,P,H,X,te){this.config=C,this.emitter=P,this.mediaStreamManager=H,this.analyticsTracker=te,this.establishConnection=(ue,Ee)=>uh(this,void 0,void 0,(function*(){var w,h,b;Af(this.peerConnection);try{const k=yield this.peerConnection.createOffer({offerToReceiveAudio:!1,offerToReceiveVideo:!1});yield this.handleLocalDescription(k),yield this.sendSetupRequest(ue,Ee,k)}catch(k){if(k instanceof Error){(w=(b=k).code)!==null&&w!==void 0||(b.code=Bn.code);const F=new Re(Object.assign(Object.assign({},Bn),{name:k.name,message:k.message,code:k?.code,cause:k}));throw!((h=this.reconnectStrategy)===null||h===void 0)&&h.isActive()||this.handleError(k.code,k.message),this.stop(),F}}})),this.getSessionId=()=>this.ingestSessionId,this.getConnectionState=()=>{var ue;if(!this.peerConnection)return sr.NONE;const Ee=(ue=this.reconnectStrategy)===null||ue===void 0?void 0:ue.isActive(),w=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;switch(w){case"new":return sr.NEW;case"closed":return sr.CLOSED;case"disconnected":return Ee?sr.CONNECTING:sr.DISCONNECTED;case"failed":return Ee?sr.CONNECTING:sr.FAILED;case"idle":return sr.IDLE;case"checking":case"connecting":return sr.CONNECTING;case"completed":case"connected":return sr.CONNECTED;default:return this.logger.warn({msg:"Unhandled connection state:",rawState:w}),sr.IDLE}},this.onConnectionStateChange=()=>{var ue;const Ee=this.getConnectionState();switch(Ee){case sr.CONNECTED:{this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee);const w=new Date;this.analyticsTracker.trackEvent(new Qm(w,this.connectionStartDate,this.ingestSessionId));const h=this.mediaStreamManager.getTrack(Vr.AUDIO),b=this.mediaStreamManager.getTrack(Vr.VIDEO);if(b){const k=b.getSettings();this.analyticsTracker.trackEvent(new V_(k))}if(h){const k=h.getSettings();this.analyticsTracker.trackEvent(new Jm(k))}(((ue=this.peerConnection)===null||ue===void 0?void 0:ue.getSenders())||[]).forEach((k=>{var F;(((F=k.getParameters())===null||F===void 0?void 0:F.codecs)||[]).forEach((ie=>{var pe;switch((pe=k.track)===null||pe===void 0?void 0:pe.kind){case"video":{if(!b)break;const ye=new Rf().extractVideoSdpFmtpLine(ie.sdpFmtpLine),Ae=b.getSettings();this.analyticsTracker.trackEvent(new q_(Ae,ye,ie));break}case"audio":if(!h)break;this.analyticsTracker.trackEvent(new il(ie))}}))}));break}case sr.CONNECTING:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.connectionStartDate=new Date,this.disconnectionStartDate=void 0;break;case sr.FAILED:this.reconnectStrategy?this.reconnectStrategy.execute():(this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.handleTerminalConnectionFailure());break;case sr.DISCONNECTED:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee),this.disconnectionStartDate=new Date;break;default:this.emitter.emit(_r.CONNECTION_STATE_CHANGE,Ee)}},this.handleLocalDescription=ue=>uh(this,void 0,void 0,(function*(){var Ee;return(Ee=this.peerConnection)===null||Ee===void 0?void 0:Ee.setLocalDescription(ue)})),Eu.set(this,(ue=>{if(typeof ue!="string")throw new Re(as);try{new URL(ue)}catch{throw new Re(di)}})),this.logger=new wn(X,_e.WEBRTC),this.createReconnectStrategy(C)}start(C,P){var H;return uh(this,void 0,void 0,(function*(){Zp(this,Eu,"f").call(this,C);const X=[this.mediaStreamManager.getTrack(Vr.VIDEO),this.mediaStreamManager.getTrack(Vr.AUDIO)].filter(fh);if(this.createPeerConnection(),this.addTracks({tracks:X}),this.reconnectStrategy&&this.reconnectStrategy.setStartConfig(C,P),yield this.establishConnection(C,P),!((H=this.reconnectStrategy)===null||H===void 0)&&H.isActive()){const te=new URL(C);this.analyticsTracker.trackEvent(new Hh({protocol:"webrtc",hostname:te.hostname,port:te.port},Ta.NETWORK_DISCONNECT))}}))}stop(){var C,P,H,X;this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stopStreamDataChannel&&this.stopStreamDataChannel.readyState==="open"&&this.stopStreamDataChannel.send(" "),[sr.NEW,sr.CONNECTING,sr.CONNECTED].includes(this.getConnectionState())&&this.emitter.emit(_r.CONNECTION_STATE_CHANGE,sr.CLOSED),(C=this.peerConnection)===null||C===void 0||C.close(),(P=this.peerConnection)===null||P===void 0||P.removeEventListener("connectionstatechange",this.onConnectionStateChange),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("iceconnectionstatechange",this.onConnectionStateChange),this.ingestSessionId=void 0,(X=this.reconnectStrategy)===null||X===void 0||X.stop()}addTracks(C){var P;if(Af(this.peerConnection),!C)return;const H=this.peerConnection.getSenders().map((te=>{var ue;return(ue=te.track)===null||ue===void 0?void 0:ue.id})),X=C.tracks.filter((te=>!H.includes(te.id)));for(const te of X)(P=this.peerConnection)===null||P===void 0||P.addTrack(te)}getReports(){var C;return uh(this,void 0,void 0,(function*(){try{const P=(yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats())||[],H=[];return P.forEach((X=>{H.push(X)})),H}catch{return[]}}))}sendSetupRequest(C,P,H){var X;return uh(this,void 0,void 0,(function*(){const te=yield fetch(`${C}/v1/offer`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object.assign({offer:X0(H),streamKey:P},this.config.streamConfig))});if(!te.ok)throw(function(Ee){let w=new Re(Object.assign({},Bn));return Ee?.code===1007&&(w=new Re(Object.assign({},In))),Ee?.message&&(w.message=Ee.message),w})(yield te.json());const ue=yield te.json();ue?.answer&&(yield(X=this.peerConnection)===null||X===void 0?void 0:X.setRemoteDescription((function(Ee){return JSON.parse(atob(Ee))})(ue.answer)),this.ingestSessionId=ue.ingestSessionId)}))}handleTerminalConnectionFailure(){const C=new Re(cn);this.handleError(C.code,C.message)}handleError(C,P){this.analyticsTracker.trackEvent(new Tf({code:C,description:P,isFatal:!0})),this.emitter.emit(_r.ERROR,{code:C,message:P})}createPeerConnection(){var C;const P=this.getConnectionState(),H=P!==sr.NONE,X=P!==sr.CLOSED,te=(C=this.reconnectStrategy)===null||C===void 0?void 0:C.isActive();H&&X&&!te||(this.stateCheckInterval&&(clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0),this.stateCheckInterval=window.setInterval((()=>{const ue=this.getConnectionState();if(this.reconnectStrategy&&ue===sr.DISCONNECTED&&this.disconnectionStartDate){const Ee=Date.now()-this.disconnectionStartDate.getTime();this.logger.info({msg:"Time since disconnected:",timeSinceDisconnect:Ee}),Ee>1e4&&(this.disconnectionStartDate=void 0,this.reconnectStrategy.execute())}else ue===sr.CLOSED&&(this.handleTerminalConnectionFailure(),clearInterval(this.stateCheckInterval),this.stateCheckInterval=void 0)}),1e3),this.peerConnection=new RTCPeerConnection(Yc),this.stopStreamDataChannel=this.peerConnection.createDataChannel("stopStream"),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onConnectionStateChange))}createReconnectStrategy(C){if(this.reconnectStrategy=Yg.create(this,C.networkReconnectConfig,this.logger,this.emitter),this.reconnectStrategy){this.reconnectStrategy.onFailure(this.handleTerminalConnectionFailure.bind(this));const P=this.reconnectStrategy.id;this.logger.info({msg:"Using reconnect strategy:",strategyId:P})}}}Eu=new WeakMap;var xu,G_,$_=i(5364);(function(j){j.CONFIG="config",j.UPDATE="update",j.START="start",j.STOP="stop"})(xu||(xu={})),(function(j){j.VIDEO_SEND="video/send",j.VIDEO_RECEIVE="video/receive",j.INSERT_SEI="insertSei"})(G_||(G_={}));var rg=i(5512),Mc=i.n(rg);function Cd(){return Mc()(`/*! For license information please see scheduler.worker.worker.js.LICENSE.txt */
(()=>{"use strict";var i,t;!function(i){i.CONFIG="config",i.UPDATE="update",i.START="start",i.STOP="stop"}(i||(i={})),function(i){i.VIDEO_SEND="video/send",i.VIDEO_RECEIVE="video/receive",i.INSERT_SEI="insertSei"}(t||(t={}));const s=self;const n=new class Scheduler{constructor(){this.config={frameRate:60,isRunning:!1}}setConfig(i){this.config=Object.assign(Object.assign({},this.config),i),this.config.isRunning&&(this.stop(),this.start())}start(){this.config.isRunning||(this.intervalId=setInterval((()=>{s.postMessage({type:i.UPDATE})}),1e3/this.config.frameRate),this.config.isRunning=!0)}stop(){this.config.isRunning&&(clearInterval(this.intervalId),this.intervalId=void 0,this.config.isRunning=!1)}};s.addEventListener("message",(function(t){var s;if(null===(s=null==t?void 0:t.data)||void 0===s?void 0:s.type)switch(t.data.type){case i.CONFIG:n.setConfig(t.data.payload||{});break;case i.START:n.start();break;case i.STOP:n.stop()}}))})();`,"Worker",void 0,void 0)}var uo=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class Cf{constructor(C,P,H){this.config=C,this.mediaStreamManager=P,this.analyticsTracker=H,this.handleWorkerEvent=Ee=>{var w;((w=Ee.data)===null||w===void 0?void 0:w.type)===xu.UPDATE&&this.drawComposite()},this.mixer={video:[],audio:[]},this.schedulerWorker=new Cd,this.running=!1,this.compositeEl=document.createElement("canvas"),this.compositeEl.height=this.config.streamConfig.maxResolution.height,this.compositeEl.width=this.config.streamConfig.maxResolution.width;const X=this.compositeEl.getContext("2d");if(X===null)throw new Re(Object.assign({},st));this.compositeContext=X,this.compositeStream=this.compositeEl.captureStream(typeof CanvasCaptureMediaStreamTrack!==void 0?0:30);const te=Oa(this.compositeStream.getTracks(),Vr.VIDEO);this.audioContext=new AudioContext,this.unlockAudioContext(),this.audioDestination=this.audioContext.createMediaStreamDestination(),this.setupSilence();const ue=Oa(this.audioDestination.stream.getTracks(),Vr.AUDIO);te&&this.mediaStreamManager.setTrack(Vr.VIDEO,te),ue&&this.mediaStreamManager.setTrack(Vr.AUDIO,ue),this.schedulerWorker.addEventListener("message",this.handleWorkerEvent),this.schedulerWorker.postMessage({type:xu.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.previewElement=null,this.previewCtx=null,this.nextMix=new Date().getTime()}attachPreview(C){this.previewElement=C;const{width:P,height:H}=this.config.streamConfig.maxResolution;this.previewElement.width=P,this.previewElement.height=H,this.previewCtx=this.previewElement.getContext("2d")}detachPreview(){this.previewElement=null,this.previewCtx=null}setupSilence(){const C=this.audioContext.createConstantSource(),P=this.audioContext.createGain();P.gain.value=.001,C.connect(P),P.connect(this.audioDestination),C.start()}unlockAudioContext(){if(this.audioContext.state!=="suspended")return;const C=document.body,P=["touchstart","touchend","mousedown","keydown"],H=()=>{P.forEach((te=>{C.removeEventListener(te,X)}))},X=()=>{this.audioContext.resume().then(H)};P.forEach((te=>{C.addEventListener(te,X,!1)}))}getTracks(){return[this.mediaStreamManager.getTrack(Vr.VIDEO),this.mediaStreamManager.getTrack(Vr.AUDIO)]}getCanvasVideoTrack(){return this.mediaStreamManager.getTrack(Vr.VIDEO)}getAudioInputDevice(C){if(typeof C!="string")return;const P=this.mixer.audio.find((H=>{if(H.name===C)return H.source}));return P?.source}getVideoInputDevice(C){if(typeof C=="string")return this.mixer.video.find((P=>P.name===C))}getCanvasDimensions(){return{height:this.compositeEl.height,width:this.compositeEl.width}}addVideoInputDevice(C,P,H){var X;return uo(this,void 0,void 0,(function*(){if(typeof C!="object")throw new Re(Object.assign({},Ze));if(!P||typeof P!="string")throw new Re(Object.assign({},ht));if(this.mixer.video.some((F=>F.name===P)))throw new Re(Object.assign({},nt));if(!H)throw new Re(Object.assign({},vt));if(typeof H.index!="number")throw new Re(Object.assign({},Qe));const te=(function(){const F=document.createElement("video");return F.autoplay=!0,F.muted=!0,F.setAttribute("playsinline",""),F.setAttribute("webkit-playsinline",""),F})(),ue=C.getVideoTracks(),[Ee]=ue;if(!ue.length)throw new Re(Object.assign({},Ve));const w=Ee.getConstraints(),h=$_({},w,{frameRate:this.config.streamConfig.maxFramerate});try{yield Ee.applyConstraints(h)}catch(F){let ie="Unknown constraints error";F instanceof Error&&(ie=F.message),this.analyticsTracker.trackEvent(new Tf({description:`${ft.message}: ${ie}`,isFatal:!1,code:ft.code}))}const b=()=>uo(this,void 0,void 0,(function*(){let F=0;for(;F<5;)try{return void(yield te.play())}catch(ie){if(!(ie instanceof Error))throw new Error("unknown error trying to add video to broadcast");F++,yield new Promise((pe=>setTimeout(pe,150)))}throw new Error("Error playing video, tries exceeded")})),k=new MediaStream([Ee]);te.srcObject=k;try{yield b();const F={name:P,element:te,position:H,source:k,render:!0},ie=((X=Ee.getSettings)===null||X===void 0?void 0:X.call(Ee))||{};this.analyticsTracker.trackEvent(new oh(Cc(ie),ie)),this.mixer.video.push(F)}catch(F){throw new Re(Object.assign(Object.assign({},Ve),{cause:F}))}}))}addImageSource(C,P,H){var X;return uo(this,void 0,void 0,(function*(){if(!C)throw new Re(Object.assign({},Ze));if(!P||typeof P!="string")throw new Re(Object.assign({},ht));if(C.tagName==="image")throw new Re(Object.assign({},mt));if(this.mixer.video.some((ue=>ue.name===P)))throw new Re(Object.assign({},nt));if(!H)throw new Re(Object.assign({},vt));if(typeof H.index!="number")throw new Re(Object.assign({},Qe));if(C instanceof Image){const ue=(X=C.src)===null||X===void 0?void 0:X.slice();try{const Ee=C.src?new URL(C.src):{};if(Ee.host&&Ee.hostname){const w=yield fetch(C.src).then((b=>uo(this,void 0,void 0,(function*(){return b.blob()})))),h=yield new Promise((b=>{const k=new FileReader;k.onload=()=>{b(k.result)},k.readAsDataURL(w)}));C.src=h}}catch{throw new Re(Object.assign(Object.assign({},fn),{params:{details:`Image URL: ${ue}`}}))}}const te={name:P,element:C,position:H,render:!0};this.mixer.video.push(te)}))}addAudioInputDevice(C,P){return uo(this,void 0,void 0,(function*(){if(typeof C!="object")throw new Re(Object.assign({},Ze));if(!P||typeof P!="string")throw new Re(Object.assign({},ht));if(this.mixer.audio.some((Ee=>Ee.name===P)))throw new Re(Object.assign({},nt));const H=C.getAudioTracks();if(!H.length)throw new Re(Object.assign({},tt));const X=this.audioContext.createMediaStreamSource(new MediaStream(H)),te=this.audioContext.createGain();te.gain.value=1,X.connect(te),te.connect(this.audioDestination);const ue={name:P,source:C,audioTrackSource:X,gainNode:te};this.analyticsTracker.trackEvent(new oh("audio",{deviceId:C.id})),this.mixer.audio.push(ue)}))}removeImage(C){const P=this.mixer.video.findIndex((H=>H.name===C));if(P<0)throw new Re(Object.assign({},gn));this.mixer.video.splice(P,1)}removeVideoInputDevice(C){var P;const H=this.removeDevice(C,this.mixer.video);if(!H)throw new Re(Object.assign({},_t));{const X=Oa(H.source.getTracks(),Vr.VIDEO);if(!X)throw new Re(Object.assign({},_t));H.element.srcObject=null,X.stop();const te=((P=X?.getSettings)===null||P===void 0?void 0:P.call(X))||{};this.analyticsTracker.trackEvent(new Bo(Cc(te),te))}}removeAudioInputDevice(C){const P=this.removeDevice(C,this.mixer.audio);if(P?.audioTrackSource){for(const H of P.source.getTracks())H.stop(),this.analyticsTracker.trackEvent(new Bo("audio",{deviceId:H.id}));P.gainNode.disconnect(this.audioDestination)}else if(!P)throw new Re(Object.assign({},_t))}updateVideoDeviceComposition(C,P){if(!C||typeof C!="string")throw new Re(Object.assign({},Yt));if(!P)throw new Re(Object.assign({},_n));if(typeof P.index!="number")throw new Re(Object.assign({},Bt));this.mixer.video.forEach(((H,X)=>{H.name===C&&(H.position=P)}))}exchangeVideoDevicePositions(C,P){const H=this.getVideoInputDevice(C),X=this.getVideoInputDevice(P);if(!H)throw new Re(Object.assign(Object.assign({},Mt),{params:{details:`device with name: "${C}" not found`}}));if(!X)throw new Re(Object.assign(Object.assign({},Mt),{params:{details:`device with name: "${P}" not found`}}));const te=Object.assign({},H.position),ue=Object.assign({},X.position);for(const Ee of this.mixer.video)Ee.name===C&&($l(ue.x)?Ee.position=Object.assign(Object.assign({},Ee.position),ue):Ee.position={index:ue.index}),Ee.name===P&&($l(te.x)?Ee.position=Object.assign(Object.assign({},Ee.position),te):Ee.position={index:te.index})}start(){this.running||(this.running=!0,this.schedulerWorker.postMessage({type:xu.CONFIG,payload:{frameRate:this.config.streamConfig.maxFramerate}}),this.schedulerWorker.postMessage({type:xu.START}))}stop(){this.running&&(this.running=!1,this.schedulerWorker.removeEventListener("message",this.handleWorkerEvent))}isCapturing(){return this.running}getAudioLatency(){return this.audioContext.baseLatency}getVideoLatency(){var C;return((C=this.mediaStreamManager.getTrack(Vr.VIDEO))===null||C===void 0?void 0:C.getConstraints().latency)||0}disableVideo(){this.mixer.video.forEach((C=>{C.render=!1}))}enableVideo(){this.mixer.video.forEach((C=>{C.render=!0}))}disableAudio(){this.mixer.audio.forEach((C=>{C.audioTrackSource&&(C.gainNode.gain.value=0)}))}enableAudio(){this.mixer.audio.forEach((C=>{C.audioTrackSource&&(C.gainNode.gain.value=1)}))}getDrawRegion(C,P,H){var X,te,ue,Ee;let w=(X=C.position.x)!==null&&X!==void 0?X:0,h=(te=C.position.y)!==null&&te!==void 0?te:0;const b=(ue=C.position.width)!==null&&ue!==void 0?ue:P-w,k=(Ee=C.position.height)!==null&&Ee!==void 0?Ee:H-h,F=b/k;let ie=C.element.width,pe=C.element.height;C.element instanceof HTMLVideoElement&&(ie=C.element.videoWidth,pe=C.element.videoHeight);const ye=ie/pe;let Ae=b,De=k;return ye>F?(Ae=b,De=2*Math.round(b/ye/2),h+=(k-De)/2):ye<F&&(De=k,Ae=2*Math.round(k*ye/2),w+=(b-Ae)/2),{x:w,y:h,width:Ae,height:De}}drawComposite(){if(!this.shouldMix(new Date))return;this.compositeContext.clearRect(0,0,this.compositeEl.width,this.compositeEl.height),this.drawBlackScreen();const C=this.mixer.video.filter((P=>P.render));C.sort(((P,H)=>P.position.index-H.position.index));for(const P of C){const{x:H,y:X,width:te,height:ue}=this.getDrawRegion(P,this.compositeEl.width,this.compositeEl.height);this.compositeContext.drawImage(P.element,H,X,te,ue)}this.previewElement&&this.previewCtx&&this.previewCtx.drawImage(this.compositeEl,0,0,this.previewElement.width,this.previewElement.height),this.requestCanvasCapture()}requestCanvasCapture(){typeof CanvasCaptureMediaStreamTrack!==void 0&&(typeof this.compositeStream.requestFrame=="function"?this.compositeStream.requestFrame():this.mediaStreamManager.getTrack(Vr.VIDEO).requestFrame())}drawBlackScreen(){this.compositeContext.fillStyle="#000000",this.compositeContext.fillRect(0,0,this.compositeEl.width,this.compositeEl.height)}removeDevice(C,P){const H=P.findIndex((X=>(te=>te.name===C)(X)));if(!(H<0))return P.splice(H,1)[0]}shouldMix(C){if(C.getTime()<this.nextMix)return!1;for(;this.nextMix<=C.getTime();)this.nextMix+=1e3/this.config.streamConfig.maxFramerate;return!0}}function $l(j){return Number.isSafeInteger(j)}var ig,Xg,mi=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Xi=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};class sg{constructor(C){this.config=C,ig.add(this),this.emitter=new Jr,this.isValid=!0,this.emitter.on(_r.ERROR,this.stopBroadcast),this.config.ingestEndpoint&&(this.url=new URL(this.config.ingestEndpoint)),this.analyticsTracker=new sh,this.mediaStreamManager=new ch;const P=new tn(C.logLevel,C.logger);this.peerClient=new Hi(this.config,this.emitter,this.mediaStreamManager,P,this.analyticsTracker),this.broadcastCanvasManager=new Cf(C,this.mediaStreamManager,this.analyticsTracker),this.peerStatsTracker=new sl(this.peerClient,this.broadcastCanvasManager,P,this.analyticsTracker),this.broadcastCanvasManager.start(),Object.getOwnPropertyNames(sg.prototype).forEach((H=>{this[H]=new Proxy(this[H],{apply:(X,te,ue)=>{if(!te.isValid)throw new Re(Object.assign({},pi));return Reflect.apply(X,te,ue)}})})),window.addEventListener("beforeunload",(()=>{this.analyticsTracker.stop(!0)}))}delete(){this.isValid=!1,this.peerClient.stop(),this.broadcastCanvasManager.stop(),this.emitter.removeAllListeners()}startBroadcast(C,P){return mi(this,void 0,void 0,(function*(){Xi(this,ig,"m",Xg).call(this,C);const H=Lo(P||this.config.ingestEndpoint);this.analyticsTracker.start(),this.peerStatsTracker.start(),yield this.peerClient.start(H,C),this.emitter.emit(_r.ACTIVE_STATE_CHANGE,!0),this.url=new URL(H),this.url&&this.analyticsTracker.trackEvent(new Hh({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port},Ta.USER_INITIATED))}))}stopBroadcast(){var C,P,H;this.url&&this.analyticsTracker.trackEvent(new Yu({protocol:"webrtc",hostname:this.url.hostname,port:this.url.port})),(C=this.peerStatsTracker)===null||C===void 0||C.stop(),(P=this.peerClient)===null||P===void 0||P.stop(),(H=this.emitter)===null||H===void 0||H.emit(_r.ACTIVE_STATE_CHANGE,!1)}getCanvasDimensions(){return this.broadcastCanvasManager.getCanvasDimensions()}addVideoInputDevice(C,P,H){return mi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addVideoInputDevice(C,P,H)}))}addImageSource(C,P,H){return mi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addImageSource(C,P,H)}))}addAudioInputDevice(C,P){return mi(this,void 0,void 0,(function*(){return this.broadcastCanvasManager.addAudioInputDevice(C,P)}))}removeVideoInputDevice(C){this.broadcastCanvasManager.removeVideoInputDevice(C)}removeAudioInputDevice(C){this.broadcastCanvasManager.removeAudioInputDevice(C)}removeImage(C){this.broadcastCanvasManager.removeImage(C)}updateVideoDeviceComposition(C,P){this.broadcastCanvasManager.updateVideoDeviceComposition(C,P)}exchangeVideoDevicePositions(C,P){this.broadcastCanvasManager.exchangeVideoDevicePositions(C,P)}getAudioInputDevice(C){return this.broadcastCanvasManager.getAudioInputDevice(C)}getVideoInputDevice(C){return this.broadcastCanvasManager.getVideoInputDevice(C)}getConnectionState(){return this.peerClient.getConnectionState()}getSessionId(){return this.peerClient.getSessionId()}on(C,P){this.emitter.on(C,P)}off(C,P){this.emitter.off(C,P)}getAudioContext(){return this.broadcastCanvasManager.audioContext}attachPreview(C){this.broadcastCanvasManager.attachPreview(C)}detachPreview(){this.broadcastCanvasManager.detachPreview()}disableVideo(){this.broadcastCanvasManager.disableVideo()}enableVideo(){this.broadcastCanvasManager.enableVideo()}disableAudio(){this.broadcastCanvasManager.disableAudio()}enableAudio(){this.broadcastCanvasManager.enableAudio()}}function hh(j){return new sg((function(C){const P=new cs;return P.streamConfig=C.streamConfig,P.ingestEndpoint=C.ingestEndpoint,P.logger=C.logger,P.logLevel=C.logLevel,P.networkReconnectConfig=C.networkReconnectConfig,P})(j))}ig=new WeakSet,Xg=function(j){if(typeof j!="string"||!/^[a-zA-Z0-9_-]+$/.test(j))throw new Re(os)};const fp="1.27.0";var Fn,zs=i(2543);(function(j){j.PUBLISH="publish",j.SUBSCRIBE="subscribe",j.JOIN="join",j.LEAVE="leave"})(Fn||(Fn={}));const Mf=2,xo="X-Stages-Options",wl="cap";class Ku extends ur{constructor(C){super(Xn.LEAVE,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.LEAVE,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint,reason:C.reason}),this.critical=!0}}function kf(j){const C="0123456789abcdef";let P="";for(let H=0;H<j;H+=1)P+=C.charAt(Math.floor(16*Math.random()));return P}class kc{constructor(){const C=kf;this.value=`${C(8)}-${C(4)}-${C(4)}-${C(4)}-${C(12)}`}}function Rs(){return new kc}class Kg{constructor(){const C=(Date.now()/1e3|0).toString(16);this.value=`1-${C}-${kf(24)}`}}function Xs(){return new Kg}var K0,Rl,hp,zo=i(2505),lc=i.n(zo);(function(j){j.MESSAGE="message",j.RESPONSE="response"})(K0||(K0={})),(function(j){j.STAGE_DELETED="STAGE_DELETED",j.PARTICIPANT_DISCONNECTED="PARTICIPANT_DISCONNECTED",j.TOKEN_INVALID="TOKEN_INVALID",j.TOKEN_EXPIRED="TOKEN_EXPIRED",j.TOKEN_INVALID_SIGNATURE="TOKEN_INVALID_SIGNATURE",j.TOKEN_MISSING="TOKEN_MISSING",j.INTERNAL="INTERNAL",j.BAD_REQUEST="BAD_REQUEST"})(Rl||(Rl={})),(function(j){j[j.BAD_REQUEST=400]="BAD_REQUEST",j[j.UNAUTHORIZED=401]="UNAUTHORIZED",j[j.FORBIDDEN=403]="FORBIDDEN",j[j.NOT_FOUND=404]="NOT_FOUND",j[j.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"})(hp||(hp={}));class Br extends Re{constructor({token:C,traceId:P,code:H,tag:X,location:te,message:ue,details:Ee,remoteParticipantId:w,requestUUID:h,fatal:b,nominal:k,action:F,count:ie=1}){super({name:"StageClientError",message:ue,code:H}),Error.captureStackTrace&&Error.captureStackTrace(this,Br),this.action=F,this.token=C,this.traceId=P,this.code=H,this.tag=X,this.location=te,this.message=ue,this.details=Ee,this.remoteParticipantId=w,this.requestUUID=h,this.fatal=b,this.nominal=k,this.count=ie}}const ve="signalling_session",cc="webrtc_sink",Ja="webrtc_unsink",Ai="webrtc_source";function On(j,C){switch(j){case Fn.PUBLISH:return cc;case Fn.SUBSCRIBE:return`webrtc_source:${C}`;default:return"unknown"}}function fo(j,C){var P,H,X,te;const ue={code:j.code,message:`${j.message}: ${C.name} ${C.message}`,fatal:(P=j.fatal)!==null&&P!==void 0&&P,nominal:(H=j.nominal)!==null&&H!==void 0&&H};return C instanceof Br&&(ue.fatal=(X=C.fatal)!==null&&X!==void 0&&X,ue.nominal=(te=C.nominal)!==null&&te!==void 0&&te),ue}function ho(j,C){if(j===0)return hn.UNKNOWN_SERVER_ERROR;if(!(j<400))if(j>=400&&j<=403)switch(C){case Ki.TokenExpired:return hn.EXPIRED_TOKEN;case Ki.NoPermissions:return hn.TOKEN_PERMISSIONS_DENIED;case Ki.StageAtCapacity:return hn.STAGE_AT_CAPACITY;case Ki.NoMatchingCodec:return hn.NO_MATCHING_CODEC;default:return hn.UNKNOWN_SERVER_ERROR}else{if(j===404)return C===Ki.RemoteStreamNotFound?hn.REMOTE_STREAM_NOT_FOUND:hn.UNKNOWN_SERVER_ERROR;if(j===412)return C===Ki.AbortedMHCPError?hn.MHCP_ABORTED:hn.UNKNOWN_SERVER_ERROR;if(j===429)return C===Ki.StageAuthThrottled?hn.STAGE_AUTH_THROTTLED:hn.WHIP_TOO_MANY_REQUESTS;if(j!==500)return hn.UNKNOWN_SERVER_ERROR;switch(C){case Ki.InternalMHCPError:return hn.INTERNAL_MHCP_ERROR;case Ki.UnreachableMHCP:return hn.UNREACHABLE_MHCP;case Ki.InvalidSessionStatus:return hn.INVALID_SESSION_STATUS;default:return hn.INTERNAL_SERVER_ERROR}}}var Ki;(function(j){j[j.Unspecified=2001]="Unspecified",j[j.TokenExpired=2002]="TokenExpired",j[j.NoPermissions=2003]="NoPermissions",j[j.RemoteStreamNotFound=2004]="RemoteStreamNotFound",j[j.StageAtCapacity=2005]="StageAtCapacity",j[j.InternalMHCPError=2006]="InternalMHCPError",j[j.UncategorizedMHCPError=2007]="UncategorizedMHCPError",j[j.UnreachableMHCP=2008]="UnreachableMHCP",j[j.InvalidSessionStatus=2010]="InvalidSessionStatus",j[j.PostWithoutOptions=2011]="PostWithoutOptions",j[j.AbortedMHCPError=2012]="AbortedMHCPError",j[j.StageAuthThrottled=2013]="StageAuthThrottled",j[j.NoMatchingCodec=2014]="NoMatchingCodec"})(Ki||(Ki={}));const hn={MALFORMED_TOKEN:{code:1e3,message:"Token is malformed",fatal:!0,nominal:!0},EXPIRED_TOKEN:{code:1001,message:"Token expired and is no longer valid",fatal:!0,nominal:!0},STAGE_DELETED:{code:1037,message:"Stage has been deleted",fatal:!0,nominal:!0},PARTICIPANT_DISCONNECTED:{code:1038,message:"Participant has been disconnected",fatal:!0,nominal:!0},JOIN_SERVER_INTERNAL_ERROR:{code:1039,message:"Internal server error during join",fatal:!1,nominal:!1},JOIN_SERVER_BAD_REQUEST:{code:1040,message:"Bad request during join",fatal:!0,nominal:!1},UNPUBLISH_FAILURE:{code:1013,message:"Failed to unpublish",fatal:!1,nominal:!1},UNSUBSCRIBE_FAILURE:{code:1014,message:"Failed to unsubscribe",fatal:!1,nominal:!1},PUBLISH_FAILURE:{code:1015,message:"Failed to publish",fatal:!1,nominal:!1},SUBSCRIBE_FAILURE:{code:1016,message:"Failed to subscribe",fatal:!1,nominal:!1},JOIN_FAILURE:{code:1017,message:"Failed to join",fatal:!0,nominal:!1},JOIN_TIMED_OUT:{code:1019,message:"Join timed out",fatal:!0,nominal:!1},PUBLISH_TIMED_OUT:{code:1020,message:"Publish timed out",fatal:!1,nominal:!1},SUBSCRIBE_TIMED_OUT:{code:1021,message:"Subscribe timed out",fatal:!1,nominal:!1},OPERATION_ABORTED:{code:1023,message:"Request aborted",fatal:!1,nominal:!0},STAGE_AT_CAPACITY:{code:1024,message:"Stage at capacity",fatal:!0,nominal:!0},INTERNAL_SERVER_ERROR:{code:1025,message:"Internal server error",fatal:!0,nominal:!1},TOKEN_PERMISSIONS_DENIED:{code:1026,message:"Token permissions are not valid for the operation",fatal:!0,nominal:!1},REMOTE_STREAM_NOT_FOUND:{code:1027,message:"Contributor group (PUBLISH) or remote stream (SUBSCRIBE) not found",fatal:!0,nominal:!1},INTERNAL_MHCP_ERROR:{code:1028,message:"Authorization failed due to internal MHCP error",fatal:!0,nominal:!1},UNREACHABLE_MHCP:{code:1030,message:"Authorization failed due to MHCP unreachable",fatal:!0,nominal:!1},INVALID_SESSION_STATUS:{code:1031,message:"Stream has already been published (PUBLISH) or subscribed to (SUBSCRIBE)",fatal:!0,nominal:!1},MHCP_ABORTED:{code:1033,message:"Publisher state conflict",fatal:!0,nominal:!1},STAGE_AUTH_THROTTLED:{code:1034,message:"Too many requests",fatal:!1,nominal:!1},NO_MATCHING_CODEC:{code:1035,message:"No matching codec found",fatal:!0,nominal:!1},UNKNOWN_SERVER_ERROR:{code:1099,message:"Service error code unknown or not found",fatal:!0,nominal:!1},XDP_CONNECTION_LOST:{code:1221,message:"Connection lost during SDP exchange",fatal:!1,nominal:!1},XDP_INVALID_ANSWER_MSG:{code:1222,message:"Invalid answer message received by client",fatal:!1,nominal:!1},XDP_TIMEOUT:{code:1223,message:"Failed to receive SDP answer within timeout period",fatal:!1,nominal:!1},XDP_UNEXPECTED_ERROR:{code:1224,message:"Unexpected error encountered",fatal:!1,nominal:!1},WEBSOCKET_MESSAGE_PARSE_FAILURE:{code:1204,message:"Failed to parse websocket message"},WHIP_TOO_MANY_REQUESTS:{code:1207,message:"WHIP endpoint received too many requests",fatal:!1,nominal:!1},WHIP_POST_FAILURE:{code:1502,message:"WHIP post failure",fatal:!1,nominal:!1},WHIP_DELETE_FAILURE:{code:1503,message:"WHIP delete failure",fatal:!1,nominal:!1},WHIP_URL_MISSING:{code:1504,message:"WHIP delete failure",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_FAILED:{code:1510,message:"Set layer request failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_SET_LAYER_REQUEST_THROTTLED:{code:1511,message:"Too many set layer requests",fatal:!1,nominal:!0},WHEP_GET_LAYER_STATE_FAILED:{code:1512,message:"Get layer state failed for reason: Unknown",fatal:!1,nominal:!1},WHEP_GET_LAYER_STATE_THROTTLED:{code:1513,message:"Too many get layer state requests",fatal:!1,nominal:!0},EVENT_PLANE_WS_CREATE_FAILED:{code:1300,message:"Error creating WebSocket",fatal:!0,nominal:!1},EVENT_PLANE_WS_UNEXPECTED_CLOSE:{code:1302,message:"Unexpectedly not connected to event plane",fatal:!1,nominal:!1},EVENT_PLANE_PONG_TIMEOUT:{code:1304,message:"Pong timed out",fatal:!1,nominal:!1},EVENT_PLANE_WS_CLOSE_BEFORE_OPEN:{code:1305,message:"Connect attempt closed by server",fatal:!1,nominal:!1},PEER_CONNECTION_NETWORK_FAILURE:{code:1400,message:"PeerConnection is lost due to unknown network error",fatal:!1,nominal:!1},CREATE_OFFER_FAILURE:{code:1402,message:"Failed to set local description",fatal:!1,nominal:!1},CREATE_PEER_CONNECTION_FAILURE:{code:1403,message:"Failed to create a peer connection",fatal:!1,nominal:!1},ICE_CANDIDATE_ERROR:{code:1404,message:"ICE candidate error",fatal:!1,nominal:!1},SET_ANSWER_FAILURE:{code:1405,message:"Failed to set remote answer",fatal:!1,nominal:!1},NETWORK_FAILURE:{code:1406,message:"Failed due to network problem",fatal:!1,nominal:!1},SEI_INSERT_NOT_PUBLISHING_VIDEO:{code:1460,message:"SEI failed to insert due to not publishing video",fatal:!1,nominal:!0},SEI_INSERT_INBAND_NOT_ENABLED:{code:1461,message:"SEI failed to insert due to in-band messaging not being enabled",fatal:!1,nominal:!0},REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID:{code:1470,message:"Invalid participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID:{code:1471,message:"Invalid remote participant id in the reassignment message",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE:{code:1472,message:"Invalid subscriber peer connection state for reassignment",fatal:!1,nominal:!1},REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS:{code:1473,message:"Request rejected because client is already processing a previous reassignment request",fatal:!1,nominal:!1},UNEXPECTED_ERROR:{code:9999,message:"Encountered unexpected error condition. Expected StageClientError type.",fatal:!1,nominal:!1},TRANSFORM_UNEXPECTED_ERROR:{code:1480,message:"Unexpected error occurred during transform execution",fatal:!1,nominal:!1},TRANSFORM_TOO_MANY_ERRORS:{code:1481,message:"Transformer encountered too many consecutive errors",fatal:!1,nominal:!1},TRANSFORM_NOT_SUPPORTED_BY_PLATFORM:{code:1482,message:"Transforms are not supported by this platform",fatal:!1,nominal:!1},CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR:{code:1490,message:"Unexpected error occurred when handling incompatible codecs",fatal:!1,nominal:!1}};var Ei;(function(j){j.UNPUBLISH="unpublish",j.UNSUBSCRIBE="unsubscribe",j.UNLOAD="unload",j.CONNECTION_FAIL="connection fail",j.REASSIGNMENT="reassignment"})(Ei||(Ei={}));const ag="stageJoined",Of="stageParticipantJoined",If="stageParticipantLeft",og="stageParticipantKicked",To="stageParticipantUpdated",Oc="localPublishingChanged",ga="stageRefresh",dp="stateChange",wo="error",Ia="reassignmentRequest",dh="incompatibleCodecs",Al="connectionStateChange",js="mediaStreamCreated",Cl="mediaStreamRemoved",Vh="error",Ic="stageStreamSeiMessageReceived",us="transformError",uc="reassignmentStarted",Gh="reassignmentSuccess",Wl="reassignmentFailed",Tu="open",si="closed",$h="messageParseError",Qp="refresh",Ks="error",Ro="stageStateMessage",As="sdpAnswer",ei="disconnectMessage",Nc="reassignmentMessage",gi="incompatibleCodecs",Wh="ssu";function Yh(j){return P=(function(H){return H.replace(/-/g,"+").replace(/_/g,"/").padEnd(H.length+(4-H.length%4)%4,"=")})(j),window.atob(P);var P}class W_{constructor(C,P){this.analyticsTracker=P,this.rawToken=C;const H=C.split(".");if(H.length!==3)throw Error(`Token format incorrect. length: ${H.length}`);try{this.header=JSON.parse(Yh(H[0]))}catch(ue){const Ee=ue instanceof Error?`: ${ue.message}`:"";throw Error(`Error parsing Stage Token header${Ee}`)}try{this.claims=JSON.parse(Yh(H[1]))}catch(ue){const Ee=ue instanceof Error?`: ${ue.message}`:"";throw Error(`Error parsing Stage Token claims${Ee}`)}this.signature=H[2];const{claims:X}=this;this.stageARN=X.resource,this.participantID=X.jti,this.eventsURL=X.events_url,this.whipURL=da("whipUrl")||X.whip_url,this.userID=X.user_id,this.expirationTime=X.exp,this.topic=X.topic,this.parseVersionFlags(X.version);const{attributes:te}=X;te&&(this.attrGsRole=te.gs_role,this.attrGsSessionId=te.gs_session_id)}getPublishEndpoint(){let C="";return this.whipURL&&this.participantID&&(C=`${this.whipURL}/publish/${this.participantID}`),C}getSubscribeEndpoint(C){let P="";return this.whipURL&&(P=`${this.whipURL}/subscribe/${C}`),P}assertTokenIsUnexpired(C,P,H,X){pa("disableTokenValidation")||(!this.expirationTime||Date.now()/1e3>=this.expirationTime)&&this.analyticsTracker.trackErrorAndThrow(new Br(Object.assign(Object.assign({},hn.EXPIRED_TOKEN),{action:Fn.JOIN,location:H,tag:P,token:this,traceId:C,remoteParticipantId:X,message:hn.EXPIRED_TOKEN.message,details:`Token expired at ${this.expirationTime} and is no longer valid`})))}parseVersionFlags(C){if(!C)return;const P=C.split(".");P.length===2&&(this.versionFlags=parseInt(P[1],10))}shouldSendSilentAudio(){return this.versionFlags===void 0||!!(this.versionFlags&Mf)}}function Md(j,C){return new W_(j,C)}class al{constructor(C,P){this.throttleDuration=0,this.throttled=!1,this.timeout=0,this.unthrottle=()=>{this.trailing&&this.trailingFn&&this.trailingFn(...this.trailingFnArgs),this.clear()},this.throttleDuration=C,this.trailing=!(P&&P.skipTrailing)}invoke(C,...P){return this.throttled?(this.trailingFn=C,this.trailingFnArgs=P,!1):(this.throttled=!0,this.timeout=window.setTimeout(this.unthrottle,this.throttleDuration),C(...P),!0)}clear(){clearTimeout(this.timeout),this.timeout=0,this.throttled=!1,delete this.trailingFn,delete this.trailingFnArgs}}var Qn=i(8954);class Ii extends ur{constructor(C,P,H,X,te,ue,Ee,w){super(Xn.SERVER_REQUEST,P,Ee,!0),Object.assign(this.properties,{action:C,http_method:X,remote_participant_id:ue,request_uuid:te,url:H,transport:w})}}const Xc="draft-ietf-wish-whip-04";var po,Nf=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};function Kc(j,C){return Nf(this,void 0,void 0,(function*(){j.validateStatus=H=>H>=200&&H<300||H===403;const P=yield lc()(j);if(P.status===403){if(P.data.code===2003)throw new zo.AxiosError("Request failed with status code 403","ERR_BAD_REQUEST",j,P.request,P);return j.url===P.request.responseURL?(j.validateStatus=H=>H>=200&&H<300,lc()(j)):(j.url=P.request.responseURL,C<5?Kc(j,C+1):(j.validateStatus=H=>H>=200&&H<300,lc()(j)))}return P}))}function ph(j){return Nf(this,void 0,void 0,(function*(){return Kc(j,0)}))}function Zc(){}function Jp(j){switch(j){case"new":return sr.NEW;case"closed":return sr.CLOSED;case"disconnected":return sr.DISCONNECTED;case"failed":return sr.FAILED;case"idle":return sr.IDLE;case"checking":case"connecting":return sr.CONNECTING;case"completed":case"connected":return sr.CONNECTED;default:throw new Error(`unknown connecion state: ${j}`)}}function kd(j,C,P){let H=document.createElement(C);const X=()=>{H&&(H.removeEventListener("loadeddata",te),H.removeEventListener("error",X),H.srcObject=null,H.src="",H=null)},te=()=>{X(),P(C)};return H.addEventListener("loadeddata",te),H.addEventListener("error",X),H.srcObject=j,X}class Ao extends ur{constructor(C,P,H,X,te){super(Xn.TRACE,C,P,!1),Object.assign(this.properties,{action:X,message:H,remote_participant_id:te})}}class Xh extends ur{constructor(C,P,H,X,te){super(Xn.CONNECTION_STATE,P,H,!1),Object.assign(this.properties,{action:C,remote_participant_id:te,state:X})}}class Zu extends ur{constructor(C,P,H,X,te){super(Xn.ICE_GATHERING_STATE,P,H,!1),Object.assign(this.properties,{action:C,remote_participant_id:te,state:X})}}(function(j){j.POST="post",j.CONNECTED="connected",j.ICE_GATHERING="icegathering",j.SDP_EXCHANGE="sdpExchange",j.SET_REMOTE_DESC="setRemoteDesc",j.PEER_CONNECTION="peerConnection"})(po||(po={}));const Na="start",Kh="stop";class pp{constructor(C,P){this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0,this.action=C,this.traceId=P}markActionStart(){this.markStart(po.CONNECTED)}markPostStart(){this.markStart(po.POST)}markPostStop(){this.markStop(po.POST),this.postDuration=this.measure(po.POST)}markIceGatheringStart(){this.markStart(po.ICE_GATHERING)}markIceGatheringStop(){this.markStop(po.ICE_GATHERING),this.timeToCandidate=this.measure(po.ICE_GATHERING)}markActionStop(){this.markStop(po.CONNECTED),this.timeToConnected=this.measure(po.CONNECTED),this.markStop(po.PEER_CONNECTION),this.peerConnectionDuration=this.measure(po.PEER_CONNECTION)}markSetRemoteDescStart(){this.markStart(po.SET_REMOTE_DESC)}markSetRemoteDescStop(){const C=po.SET_REMOTE_DESC;this.markStop(C),this.setRemoteDescDuration=this.measure(C),this.markStart(po.PEER_CONNECTION)}markSdpExchangeStart(){this.markStart(po.SDP_EXCHANGE)}markSdpExchangeStop(){const C=po.SDP_EXCHANGE;this.markStop(C),this.sdpExchangeDuration=this.measure(C)}setTransport(C){this.sdpExchangeTransport=C}markStart(C){this.marks[`${this.namespace}.${C}.${Na}`]=performance.now()}markStop(C){this.marks[`${this.namespace}.${C}.${Kh}`]=performance.now()}measure(C){const P=`${this.namespace}.${C}.${Na}`,H=`${this.namespace}.${C}.${Kh}`,X=this.marks[P],te=this.marks[H];return X===void 0||te===void 0?0:te-X}get namespace(){return`ivswb.peerclient.${this.action}.${this.traceId.value}`}getMeasurements(){const{optionsDuration:C,postDuration:P,timeToCandidate:H,timeToConnected:X,sdpExchangeDuration:te,sdpExchangeTransport:ue,setRemoteDescDuration:Ee,peerConnectionDuration:w}=this;return{optionsDuration:C,postDuration:P,timeToCandidate:H,timeToConnected:X,sdpExchangeDuration:te,sdpExchangeTransport:ue,setRemoteDescDuration:Ee,peerConnectionDuration:w}}resetMeasurements(C){this.traceId=C,this.marks={},this.optionsDuration=0,this.postDuration=0,this.timeToCandidate=0,this.timeToConnected=0,this.sdpExchangeDuration=0,this.sdpExchangeTransport="",this.setRemoteDescDuration=0,this.peerConnectionDuration=0}}var Qu,mh,Lr,yr,ol;(function(j){j.VIDEO="video",j.AUDIO="audio"})(Qu||(Qu={})),(function(j){j.LOWEST_QUALITY="lowest_quality",j.HIGHEST_QUALITY="highest_quality"})(mh||(mh={})),(function(j){j.HI="hi",j.MID="mid",j.LOW="low"})(Lr||(Lr={})),(function(j){j.PORTRAIT="portrait",j.LANDSCAPE="landscape"})(yr||(yr={})),(function(j){j.DEFAULT="default",j.LOW="low",j.MEDIUM="medium",j.HIGH="high"})(ol||(ol={}));var Yl=i(7363);class xi{constructor(C){this.sdp=C}static splitLines(C){return C.trim().split(`
`).map((P=>P.trim()))}static splitSections(C){return C.split(`
m=`).map(((P,H)=>(H>0?`m=${P}`:P).trim()+xi.CRLF))}getUniqueRtpHeaderExtensionId(C){const P=[];for(const X of C)if(/^a=extmap:/.test(X.trim())){const te=+X.split("a=extmap:")[1].split(" ")[0];P.includes(te)||P.push(te)}P.sort(((X,te)=>X-te));let H=0;for(const X of P){if(X-H>1)return H+1;H=X}return H===14?-1:H+1}withVideoLayersAllocationRtpHeaderExtension(C){const P="http://www.webrtc.org/experiments/rtp-hdrext/video-layers-allocation00",H=C?C.getRtpHeaderExtensionId(P):-1,X=H===-1?this.getUniqueRtpHeaderExtensionId(xi.splitLines(this.sdp)):H,te=xi.splitSections(this.sdp),ue=[];for(let w of te){if(/^m=video/.test(w)&&xi.getRtpHeaderExtensionIdInSection(w,P)===-1){const h=xi.splitLines(w),b=[];if(X===-1||this.hasRtpHeaderExtensionId(X)){ue.push(w);continue}for(const k of h)if(b.push(k),/^a=sendrecv/.test(k.trim())){const F=`a=extmap:${X} ${P}`;b.push(F)}w=b.join(xi.CRLF)+xi.CRLF}else if(H!==-1&&/^m=video/.test(w)&&xi.getRtpHeaderExtensionIdInSection(w,P)!==H){const h=xi.splitLines(w),b=[];for(const k of h){if(/^a=extmap:/.test(k.trim())&&k.split("a=extmap:")[1].split(" ")[1]===P){if(!this.hasRtpHeaderExtensionId(H)){const F=`a=extmap:${H} ${P}`;b.push(F)}continue}b.push(k)}w=b.join(xi.CRLF)+xi.CRLF}ue.push(w)}const Ee=ue.join("");return new xi(Ee)}withOpusAudioConfig(C,P){const H=Yl.qg(this.sdp);for(const X of H.media)if(X.type==="audio"){const{payload:te}=X.rtp.find((h=>h.codec==="opus"));if(!te)continue;let ue=X.fmtp.find((h=>h.payload===te));ue||(ue={payload:te,config:""});const Ee=Yl.Sl(ue.config);if(Ee.maxaveragebitrate=C,typeof P=="boolean"){const h=P?1:0;Ee["sprop-stereo"]=h,Ee.stereo=h}let w="";for(const h of Object.keys(Ee))w+=`${h}=${Ee[h]}; `;ue.config=w.trim()}return new xi(Yl.M9(H))}withoutAudioRtcpRSize(){var C;const P=Yl.qg(this.sdp);for(const H of P.media){if(H.type!=="audio")continue;const X=Tl()!==void 0,te=(C=Tl())!==null&&C!==void 0&&C;X&&(H.rtcpRsize=te?void 0:"rtcp-rsize")}return new xi(Yl.M9(P))}withFilteredCandidates(C){const P=Yl.qg(this.sdp);return P.media.forEach((H=>{const X=H.candidates;if(X){const te=X.filter((ue=>ue.transport===C));H.candidates=te}})),new xi(Yl.M9(P))}static getRtpHeaderExtensionIdInSection(C,P){const H=xi.splitLines(C);for(const X of H)if(/^a=extmap:/.test(X.trim())){const te=X.split("a=extmap:")[1].split(" "),ue=+te[0];if(te[1]===P)return ue}return-1}getRtpHeaderExtensionId(C){const P=xi.splitSections(this.sdp);for(const H of P)if(/^m=video/.test(H)){const X=xi.getRtpHeaderExtensionIdInSection(H,C);if(X!==-1)return X}return-1}hasRtpHeaderExtensionId(C){const P=xi.splitLines(this.sdp);for(const H of P)if(/^a=extmap:/.test(H.trim())&&+H.split("a=extmap:")[1].split(" ")[0]===C)return!0;return!1}hasAudioNacksEnabled(){var C,P,H;return((H=(P=((C=Yl.qg(this.sdp).media.filter((X=>X.type==="audio"))[0])!==null&&C!==void 0?C:{}).rtcpFb)===null||P===void 0?void 0:P.filter((X=>X.type==="nack")))!==null&&H!==void 0?H:[]).length>0}}function mp(j){const{config:C}=j;return[{maxBitrate:C.maxBitrateBps}]}xi.CRLF=`\r
`,xi.rfc7587LowestBitrate=6e3,xi.rfc7587HighestBitrate=51e4;function Fr(j){return 1e3*j}const Ml=(j,...C)=>{const P=C.map((H=>typeof H!="object")).filter(Boolean).length>0;if(typeof j=="object"&&!P)return(0,zs.merge)({},j,...C)},Pa=j=>Od(j),Od=j=>(0,zs.cloneDeep)(j),gp=j=>{switch(j){case mh.HIGHEST_QUALITY:return"highest";case mh.LOWEST_QUALITY:default:return"lowest"}},ll=j=>Object.freeze(j),Xl=Object.freeze({DEFAULT_1080:ll({maxBitrateKbps:2500,maxFramerate:30,width:1920,height:1080}),INACTIVE:ll({maxBitrateKbps:0,maxFramerate:0,width:0,height:0})}),ja=Object.freeze({DEFAULT_720:ll({maxBitrateKbps:2500,maxFramerate:30,width:1280,height:720}),DEFAULT_540:ll({maxBitrateKbps:1400,maxFramerate:15,width:960,height:540}),DEFAULT_480:ll({maxBitrateKbps:1100,maxFramerate:15,width:854,height:480}),DEFAULT_360:ll({maxBitrateKbps:600,maxFramerate:15,width:640,height:360}),DEFAULT_270:ll({maxBitrateKbps:350,maxFramerate:15,width:480,height:270}),DEFAULT_180:ll({maxBitrateKbps:150,maxFramerate:15,width:320,height:180}),DEFAULT_160:ll({maxBitrateKbps:120,maxFramerate:15,width:284,height:160})}),ra=Object.freeze({HI:ll(Object.assign({},ja.DEFAULT_720)),MID:ll(Object.assign(Object.assign({},ja.DEFAULT_360),{maxBitrateKbps:700,maxFramerate:20})),LOW:ll(Object.assign(Object.assign({},ja.DEFAULT_180),{maxBitrateKbps:200,maxFramerate:15}))}),Pc=j=>({rid:j,active:!1,scaleFactor:Id(j),maxBitrateBps:Fr(Xl.INACTIVE.maxBitrateKbps),maxFramerate:Xl.INACTIVE.maxFramerate,width:Xl.INACTIVE.width,height:Xl.INACTIVE.height}),Id=j=>{switch(j){case Lr.HI:return 1;case Lr.MID:return 2;case Lr.LOW:return 4;default:return 1}},wu=50,eo=2500,Ju=10,Dc=30,ef=160,Ru=1280,Co=720*Ru,tf=16/9,nf=12,Mo=128,em=64,jr={[ol.DEFAULT]:0,[ol.LOW]:50,[ol.MEDIUM]:150,[ol.HIGH]:250},Au={[ol.DEFAULT]:0,[ol.LOW]:100,[ol.MEDIUM]:200,[ol.HIGH]:300};function Pf(j){const{outbound:C,remoteInbound:P,networkQuality:H}=j;return{networkQuality:H,nackCount:C.nackCount,packetsSent:C.packetsSent,packetsLost:P?.packetsLost,retransmittedPacketsSent:C.retransmittedPacketsSent,bytesSent:C.bytesSent,headerBytesSent:C.headerBytesSent,retransmittedBytesSent:C.retransmittedBytesSent,totalPacketSendDelay:C.totalPacketSendDelay}}function Zh(j){var C,P,H;const{outbound:X,remoteInbound:te,networkQuality:ue}=j;return{networkQuality:ue,nackCount:X.nackCount,packetsSent:X.packetsSent,packetsLost:te?.packetsLost,retransmittedPacketsSent:X.retransmittedPacketsSent,bytesSent:X.bytesSent,headerBytesSent:X.headerBytesSent,retransmittedBytesSent:X.retransmittedBytesSent,totalPacketSendDelay:X.totalPacketSendDelay,firCount:X.firCount,pliCount:X.pliCount,framesEncoded:X.framesEncoded,keyFramesEncoded:X.keyFramesEncoded,totalEncodeTime:X.totalEncodeTime,totalEncodedBytesTarget:X.totalEncodedBytesTarget,framesSent:X.framesSent,hugeFramesSent:X.hugeFramesSent,active:((C=X.framesPerSecond)!==null&&C!==void 0?C:0)!==0,qualityLimitationReason:X.qualityLimitationReason,qualityLimitationResolutionChanges:X.qualityLimitationResolutionChanges,qualityLimitationCpuDuration:(P=X.qualityLimitationDurations)===null||P===void 0?void 0:P.cpu,qualityLimitationBandwidthDuration:(H=X.qualityLimitationDurations)===null||H===void 0?void 0:H.bandwidth,frameWidth:X.frameWidth,frameHeight:X.frameHeight,framesPerSecond:X.framesPerSecond,rid:X.rid,ssrc:X.ssrc}}function Qh(j,C){const P=new Map,H=new Map;for(const X of C.values())if(X.kind===j&&X.type==="outbound-rtp"&&X.ssrc){const te=X.rid||ke;H.set(X.ssrc,te);let ue=P.get(te);ue||(ue={},P.set(te,ue)),ue.outbound=X}for(const X of C.values())if(X.kind===j&&X.type==="remote-inbound-rtp"&&X.ssrc){const te=H.get(X.ssrc)||ke,ue=P.get(te);ue&&(ue.remoteInbound=X)}return P}function kl(j,C){const P=new Map;for(const H of C.values())if(H.kind===j&&H.type==="inbound-rtp"){const X=H.rid||ke;P.set(X,{inbound:H})}return P}function Hs(j,C){return j!==co.DOWN&&C!=null?C:j}const Ol=(j,C)=>{const P=[],H=ma.getNetworkQuality(),X=Qh("audio",j);for(const te of X.values())if(te.outbound){const ue=te.outbound.rid||ke,Ee=Hs(H,C.get(ue)),w=Pf({outbound:te.outbound,remoteInbound:te.remoteInbound,networkQuality:Ee});P.push(w)}if(P.length)return P},Qc=(j,C)=>{const P=[],H=ma.getNetworkQuality(),X=Qh("video",j);for(const te of X.values())if(te.outbound){const ue=te.outbound.rid||ke,Ee=Zh({outbound:te.outbound,remoteInbound:te.remoteInbound});if(Ee.active){const w=Hs(H,C.get(ue));Ee.networkQuality=w}P.push(Ee)}if(P.length)return P},Nd=(j,C)=>{const P=[],H=ma.getNetworkQuality(),X=kl("audio",j);for(const ue of X.values())if(ue.inbound){const Ee=ue.inbound.id;if(!Ee)continue;const w=Hs(H,C.get(Ee)),h={networkQuality:(te={inbound:ue.inbound,networkQuality:w}).networkQuality,nackCount:te.inbound.nackCount,packetsReceived:te.inbound.packetsReceived,packetsLost:te.inbound.packetsLost,packetsDiscarded:te.inbound.packetsDiscarded,bytesReceived:te.inbound.bytesReceived,headerBytesReceived:te.inbound.headerBytesReceived,jitterBufferDelay:te.inbound.jitterBufferDelay,jitterBufferEmittedCount:te.inbound.jitterBufferEmittedCount,jitter:te.inbound.jitter,totalSamplesReceived:te.inbound.totalSamplesReceived,concealedSamples:te.inbound.concealedSamples,silentConcealedSamples:te.inbound.silentConcealedSamples,concealmentEvents:te.inbound.concealmentEvents,insertedSamplesForDeceleration:te.inbound.insertedSamplesForDeceleration,removedSamplesForAcceleration:te.inbound.removedSamplesForAcceleration,audioLevel:te.inbound.audioLevel};P.push(h)}var te;if(P.length)return P},Pd=(j,C)=>{const P=[],H=ma.getNetworkQuality(),X=kl("video",j);for(const ue of X.values())if(ue.inbound){const Ee=ue.inbound.id;if(!Ee)continue;const w={networkQuality:(te={inbound:ue.inbound,networkQuality:Hs(H,C.get(Ee))}).networkQuality,nackCount:te.inbound.nackCount,packetsReceived:te.inbound.packetsReceived,packetsLost:te.inbound.packetsLost,packetsDiscarded:te.inbound.packetsDiscarded,bytesReceived:te.inbound.bytesReceived,headerBytesReceived:te.inbound.headerBytesReceived,jitterBufferDelay:te.inbound.jitterBufferDelay,jitterBufferEmittedCount:te.inbound.jitterBufferEmittedCount,jitter:te.inbound.jitter,pliCount:te.inbound.pliCount,firCount:te.inbound.firCount,framesReceived:te.inbound.framesReceived,framesDecoded:te.inbound.framesDecoded,keyFramesDecoded:te.inbound.keyFramesDecoded,framesDropped:te.inbound.framesDropped,totalDecodeTime:te.inbound.totalDecodeTime,totalInterFrameDelay:te.inbound.totalInterFrameDelay,totalSquaredInterFrameDelay:te.inbound.totalSquaredInterFrameDelay,pauseCount:te.inbound.pauseCount,totalPausesDuration:te.inbound.totalPausesDuration,freezeCount:te.inbound.freezeCount,totalFreezesDuration:te.inbound.totalFreezesDuration,frameWidth:te.inbound.frameWidth,frameHeight:te.inbound.frameHeight,framesPerSecond:te.inbound.framesPerSecond,ssrc:te.inbound.ssrc};P.push(w)}var te;if(P.length)return P};var tm=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Jh="H264",Cu=j=>{const C=j?.split("/");if(C?.length===2)return C[1]},cl=(j,C)=>{const P=Cu(j);if(j===void 0||P===void 0)return;const H={mimeSubtype:P};if(C){const X=(te=>{const ue=te.split(";"),Ee=new Map;for(const w of ue){const[h,b]=w.split("=");Ee.set(h,b)}return Ee})(C);switch(P){case Jh:{const te=X.get("profile-level-id");te&&((ue,Ee)=>{if(Ee.length<6)return;const w=Ee.substring(0,4),h=parseInt(Ee.substring(4,6),16);ue.profile=w,ue.level=h})(H,te);break}case"H265":((te,ue)=>{const Ee=ue.get("profile-id")||"0",w=ue.get("tier-flag")||"0",h=parseInt(ue.get("level-id")||"0",10),b=[w,Ee].join("_");te.profile=b,te.level=h})(H,X)}}return H},rf=(j,C)=>j.sort(((P,H)=>{if(Cu(P.mimeType)===Jh){const X=cl(P.mimeType,P.sdpFmtpLine);if(X?.profile===C)return-1}return 0})),Kr=(j,C)=>{var P;const H=cl(j.mimeType,j.sdpFmtpLine);return H?.mimeSubtype.toLowerCase()===C.mime.toLowerCase()&&((P=H?.profile)===null||P===void 0?void 0:P.toLowerCase().indexOf(C.config.toLowerCase()))===0},fs=(j,C)=>C.filter((P=>!P.mimeType.endsWith("rtx"))).filter((P=>P.mimeType.indexOf("packetization-mode=0")===-1)).find((P=>j.reduce(((H,X)=>H&&Kr(P,X)===!1),!0)));class Ha extends ur{constructor(C,P,H,X,te,ue,Ee,w,h){var b,k;super(Xn.PUBLISHED_VIDEO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(b=H?.node)!==null&&b!==void 0?b:"",cluster:(k=H?.cluster)!==null&&k!==void 0?k:""},((F,ie,pe,ye,Ae,De)=>{var Fe,Ye,dt,Et,Pt,bt,gt,Ot,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur,Ci,ai,oi,Bi,Wr,bs,li,Os,Vi,Js,Is,ps;const _o=(Ye=(Fe=F?.qualityLimitationDurations)===null||Fe===void 0?void 0:Fe.cpu)!==null&&Ye!==void 0?Ye:0,Pl=(Et=(dt=F?.qualityLimitationDurations)===null||dt===void 0?void 0:dt.bandwidth)!==null&&Et!==void 0?Et:0,gc=Math.max((Pt=F?.bytesSent)!==null&&Pt!==void 0?Pt:0,0),ou=8*gc/(De??1),Lu=Math.max((bt=ie?.packetsLost)!==null&&bt!==void 0?bt:0,0),T=Math.max((gt=F?.packetsSent)!==null&&gt!==void 0?gt:0,0),R=Lu/Math.max(T,1),z=cl(ye?.mimeType,ye?.sdpFmtpLine);return{active:!!F?.framesPerSecond&&F.framesPerSecond!==0,bytes_sent:gc,codec_mime_type:z?.mimeSubtype,codec_profile:z?.profile,codec_level:z?.level,configured_bitrate:Ae?.max_bitrate,connection_bandwidth:(wt=(Ot=pe?.candidatePair)===null||Ot===void 0?void 0:Ot.availableOutgoingBitrate)!==null&&wt!==void 0?wt:0,encode_bitrate:ou,encoder_implementation:(It=F?.encoderImplementation)!==null&&It!==void 0?It:"unknown",fir_count:(Ft=F?.firCount)!==null&&Ft!==void 0?Ft:0,fraction_packets_lost:R,frame_height:Math.max((Zt=F?.frameHeight)!==null&&Zt!==void 0?Zt:0,0),frame_width:Math.max((Gt=F?.frameWidth)!==null&&Gt!==void 0?Gt:0,0),frames_encoded:($t=F?.framesEncoded)!==null&&$t!==void 0?$t:0,frames_per_second:Math.max((dn=F?.framesPerSecond)!==null&&dn!==void 0?dn:0,0),frames_sent:(Rn=F?.framesSent)!==null&&Rn!==void 0?Rn:0,header_bytes_sent:(Nn=F?.headerBytesSent)!==null&&Nn!==void 0?Nn:0,huge_frames_sent:(qn=F?.hugeFramesSent)!==null&&qn!==void 0?qn:0,key_frames_encoded:(Dn=F?.keyFramesEncoded)!==null&&Dn!==void 0?Dn:0,nack_count:(gr=F?.nackCount)!==null&&gr!==void 0?gr:0,packets_lost:Lu,packets_sent:T,power_efficient_encoder:(Ur=F?.powerEfficientEncoder)!==null&&Ur!==void 0&&Ur,pli_count:(Ci=F?.pliCount)!==null&&Ci!==void 0?Ci:0,quality_limitation_reason:(ai=F?.qualityLimitationReason)!==null&&ai!==void 0?ai:"none",quality_limitation_resolution_changes:(oi=F?.qualityLimitationResolutionChanges)!==null&&oi!==void 0?oi:0,quality_limitation_cpu_duration:_o,quality_limitation_bandwidth_duration:Pl,retransmitted_bytes_sent:(Bi=F?.retransmittedBytesSent)!==null&&Bi!==void 0?Bi:0,retransmitted_packets_sent:(Wr=F?.retransmittedPacketsSent)!==null&&Wr!==void 0?Wr:0,rid:(bs=F?.rid)!==null&&bs!==void 0?bs:ke,scalability_mode:(li=F?.scalabilityMode)!==null&&li!==void 0?li:"unknown",target_bitrate:Math.max((Os=F?.targetBitrate)!==null&&Os!==void 0?Os:0,0),total_encode_time:(Vi=F?.totalEncodeTime)!==null&&Vi!==void 0?Vi:0,total_encoded_bytes_target:(Js=F?.totalEncodedBytesTarget)!==null&&Js!==void 0?Js:0,total_packet_send_delay:(Is=F?.totalPacketSendDelay)!==null&&Is!==void 0?Is:0,protocol:(ps=pe?.localCandidate)===null||ps===void 0?void 0:ps.protocol}})(X,te,ue,Ee,w,h)))}}class ed extends ur{constructor(C,P,H,X,te,ue,Ee,w,h,b,k,F){var ie,pe,ye,Ae;super(Xn.PUBLISHED_VIDEO_STATS_WINDOW,C,P,!1);const De=Math.max(((ie=X?.timestamp)!==null&&ie!==void 0?ie:0)-((pe=te?.timestamp)!==null&&pe!==void 0?pe:0),0);Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(ye=H?.node)!==null&&ye!==void 0?ye:"",cluster:(Ae=H?.cluster)!==null&&Ae!==void 0?Ae:"",window_size_ms:De},((Fe,Ye,dt,Et,Pt,bt,gt,Ot,wt,It)=>{var Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur,Ci,ai,oi,Bi,Wr,bs,li,Os,Vi,Js,Is,ps,_o,Pl,gc,ou,Lu,T,R,z,re,he,Te,et,yt,zt,mn,Ln,Jn,nr,Yr,lu,hd,dd,Qt,Ct,nn,Un,Mr,ya,Xr,Ss,Aa;const Qi=(Zt=(Ft=Fe?.qualityLimitationDurations)===null||Ft===void 0?void 0:Ft.cpu)!==null&&Zt!==void 0?Zt:0,pd=($t=(Gt=Ye?.qualityLimitationDurations)===null||Gt===void 0?void 0:Gt.cpu)!==null&&$t!==void 0?$t:0,r_=(Rn=(dn=Fe?.qualityLimitationDurations)===null||dn===void 0?void 0:dn.bandwidth)!==null&&Rn!==void 0?Rn:0,fR=(qn=(Nn=Ye?.qualityLimitationDurations)===null||Nn===void 0?void 0:Nn.bandwidth)!==null&&qn!==void 0?qn:0,J_=Math.max(((Dn=Fe?.bytesSent)!==null&&Dn!==void 0?Dn:0)-((gr=Ye?.bytesSent)!==null&&gr!==void 0?gr:0),0),vg=typeof Ot!="number"?1:Ot/1e3,nS=8*J_/vg,f3=Math.max(((Ur=dt?.packetsLost)!==null&&Ur!==void 0?Ur:0)-((Ci=Et?.packetsLost)!==null&&Ci!==void 0?Ci:0),0),hR=Math.max(((ai=Fe?.packetsSent)!==null&&ai!==void 0?ai:0)-((oi=Ye?.packetsSent)!==null&&oi!==void 0?oi:0),0),h3=f3/Math.max(hR,1),ay=cl(bt?.mimeType,bt?.sdpFmtpLine),d3=8*(It||0)/vg;return{active:!!Fe?.framesPerSecond&&Fe?.framesPerSecond!==0,bytes_sent:J_,codec_mime_type:ay?.mimeSubtype,codec_profile:ay?.profile,codec_level:ay?.level,configured_bitrate:gt?.max_bitrate,connection_bandwidth:(Wr=(Bi=Pt?.candidatePair)===null||Bi===void 0?void 0:Bi.availableOutgoingBitrate)!==null&&Wr!==void 0?Wr:0,encode_bitrate:nS,encoder_implementation:(bs=Fe?.encoderImplementation)!==null&&bs!==void 0?bs:"unknown",fir_count:Math.max(((li=Fe?.firCount)!==null&&li!==void 0?li:0)-((Os=Ye?.firCount)!==null&&Os!==void 0?Os:0),0),fraction_packets_lost:h3,frame_height:Math.max((Vi=Fe?.frameHeight)!==null&&Vi!==void 0?Vi:0,0),frame_width:Math.max((Js=Fe?.frameWidth)!==null&&Js!==void 0?Js:0,0),frames_encoded:Math.max(((Is=Fe?.framesEncoded)!==null&&Is!==void 0?Is:0)-((ps=Ye?.framesEncoded)!==null&&ps!==void 0?ps:0),0),frames_per_second:Math.max((_o=Fe?.framesPerSecond)!==null&&_o!==void 0?_o:0,0),frames_sent:Math.max(((Pl=Fe?.framesSent)!==null&&Pl!==void 0?Pl:0)-((gc=Ye?.framesSent)!==null&&gc!==void 0?gc:0),0),header_bytes_sent:Math.max(((ou=Fe?.headerBytesSent)!==null&&ou!==void 0?ou:0)-((Lu=Ye?.headerBytesSent)!==null&&Lu!==void 0?Lu:0),0),huge_frames_sent:Math.max(((T=Fe?.hugeFramesSent)!==null&&T!==void 0?T:0)-((R=Ye?.hugeFramesSent)!==null&&R!==void 0?R:0),0),key_frames_encoded:Math.max(((z=Fe?.keyFramesEncoded)!==null&&z!==void 0?z:0)-((re=Ye?.keyFramesEncoded)!==null&&re!==void 0?re:0),0),nack_count:Math.max(((he=Fe?.nackCount)!==null&&he!==void 0?he:0)-((Te=Ye?.nackCount)!==null&&Te!==void 0?Te:0),0),packets_lost:f3,packets_sent:hR,power_efficient_encoder:(et=Fe?.powerEfficientEncoder)!==null&&et!==void 0&&et,pli_count:Math.max(((yt=Fe?.pliCount)!==null&&yt!==void 0?yt:0)-((zt=Ye?.pliCount)!==null&&zt!==void 0?zt:0),0),quality_limitation_reason:(mn=Fe?.qualityLimitationReason)!==null&&mn!==void 0?mn:"none",quality_limitation_resolution_changes:Math.max(((Ln=Fe?.qualityLimitationResolutionChanges)!==null&&Ln!==void 0?Ln:0)-((Jn=Ye?.qualityLimitationResolutionChanges)!==null&&Jn!==void 0?Jn:0),0),quality_limitation_cpu_duration:Math.max(Qi-pd,0),quality_limitation_bandwidth_duration:Math.max(r_-fR,0),retransmitted_bytes_sent:Math.max(((nr=Fe?.retransmittedBytesSent)!==null&&nr!==void 0?nr:0)-((Yr=Ye?.retransmittedBytesSent)!==null&&Yr!==void 0?Yr:0),0),rid:(lu=Fe?.rid)!==null&&lu!==void 0?lu:ke,retransmitted_packets_sent:Math.max(((hd=Fe?.retransmittedPacketsSent)!==null&&hd!==void 0?hd:0)-((dd=Ye?.retransmittedPacketsSent)!==null&&dd!==void 0?dd:0),0),scalability_mode:(Qt=Fe?.scalabilityMode)!==null&&Qt!==void 0?Qt:"unknown",target_bitrate:Math.max((Ct=Fe?.targetBitrate)!==null&&Ct!==void 0?Ct:0,0),total_encode_time:Math.max(((nn=Fe?.totalEncodeTime)!==null&&nn!==void 0?nn:0)-((Un=Ye?.totalEncodeTime)!==null&&Un!==void 0?Un:0),0),total_encoded_bytes_target:Math.max(((Mr=Fe?.totalEncodedBytesTarget)!==null&&Mr!==void 0?Mr:0)-((ya=Ye?.totalEncodedBytesTarget)!==null&&ya!==void 0?ya:0),0),total_packet_send_delay:Math.max(((Xr=Fe?.totalPacketSendDelay)!==null&&Xr!==void 0?Xr:0)-((Ss=Ye?.totalPacketSendDelay)!==null&&Ss!==void 0?Ss:0),0),sei_write_count:wt,sei_bytes_sent:It,sei_bitrate:d3,protocol:(Aa=Pt?.localCandidate)===null||Aa===void 0?void 0:Aa.protocol}})(X,te,ue,Ee,w,h,b,De,k,F)))}}class Mu extends ur{constructor(C,P,H,X,te,ue,Ee,w,h,b){var k,F;super(Xn.PUBLISHED_AUDIO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(k=H?.node)!==null&&k!==void 0?k:"",cluster:(F=H?.cluster)!==null&&F!==void 0?F:""},((ie,pe,ye,Ae,De,Fe,Ye)=>{var dt,Et,Pt,bt,gt,Ot,wt,It,Ft,Zt,Gt,$t,dn;const Rn=Math.max((dt=ie?.bytesSent)!==null&&dt!==void 0?dt:0,0),Nn=8*Rn/(Fe??1),qn=Math.max((Et=pe?.packetsLost)!==null&&Et!==void 0?Et:0,0),Dn=Math.max((Pt=ie?.packetsSent)!==null&&Pt!==void 0?Pt:0,0),gr=qn/Math.max(Dn,1),Ur=cl(Ae?.mimeType,Ae?.sdpFmtpLine);return{audio_nacks_enabled:(bt=Ye?.audioNacks)!==null&&bt!==void 0&&bt,bytes_sent:Rn,codec_mime_type:Ur?.mimeSubtype,configured_bitrate:(gt=De?.max_audio_bitrate_bps)!==null&&gt!==void 0?gt:0,connection_bandwidth:(wt=(Ot=ye?.candidatePair)===null||Ot===void 0?void 0:Ot.availableOutgoingBitrate)!==null&&wt!==void 0?wt:0,encode_bitrate:Nn,fraction_packets_lost:gr,header_bytes_sent:(It=ie?.headerBytesSent)!==null&&It!==void 0?It:0,nack_count:(Ft=ie?.nackCount)!==null&&Ft!==void 0?Ft:0,packets_lost:qn,packets_sent:Dn,retransmitted_bytes_sent:(Zt=ie?.retransmittedBytesSent)!==null&&Zt!==void 0?Zt:0,retransmitted_packets_sent:(Gt=ie?.retransmittedPacketsSent)!==null&&Gt!==void 0?Gt:0,target_bitrate:($t=ie?.targetBitrate)!==null&&$t!==void 0?$t:0,protocol:(dn=ye?.localCandidate)===null||dn===void 0?void 0:dn.protocol}})(X,te,ue,Ee,w,h,b)))}}class ul extends ur{constructor(C,P,H,X,te,ue,Ee,w,h,b,k){var F,ie,pe,ye;super(Xn.PUBLISHED_AUDIO_STATS_WINDOW,C,P,!1);const Ae=Math.max(((F=X?.timestamp)!==null&&F!==void 0?F:0)-((ie=te?.timestamp)!==null&&ie!==void 0?ie:0),0);Object.assign(this.properties,Object.assign({action:Fn.PUBLISH,node:(pe=H?.node)!==null&&pe!==void 0?pe:"",cluster:(ye=H?.cluster)!==null&&ye!==void 0?ye:"",window_size_ms:Ae},((De,Fe,Ye,dt,Et,Pt,bt,gt,Ot)=>{var wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur,Ci,ai,oi,Bi,Wr,bs,li,Os,Vi;const Js=Math.max(((wt=De?.bytesSent)!==null&&wt!==void 0?wt:0)-((It=Fe?.bytesSent)!==null&&It!==void 0?It:0),0),Is=8*Js/(typeof gt!="number"?1:gt/1e3),ps=Math.max(((Ft=Ye?.packetsLost)!==null&&Ft!==void 0?Ft:0)-((Zt=dt?.packetsLost)!==null&&Zt!==void 0?Zt:0),0),_o=Math.max(((Gt=De?.packetsSent)!==null&&Gt!==void 0?Gt:0)-(($t=Fe?.packetsSent)!==null&&$t!==void 0?$t:0),0),Pl=ps/Math.max(_o,1),gc=cl(Pt?.mimeType,Pt?.sdpFmtpLine);return{audio_nacks_enabled:(dn=Ot?.audioNacks)!==null&&dn!==void 0&&dn,bytes_sent:Js,codec_mime_type:gc?.mimeSubtype,configured_bitrate:(Rn=bt?.max_audio_bitrate_bps)!==null&&Rn!==void 0?Rn:0,connection_bandwidth:(qn=(Nn=Et?.candidatePair)===null||Nn===void 0?void 0:Nn.availableOutgoingBitrate)!==null&&qn!==void 0?qn:0,encode_bitrate:Is,fraction_packets_lost:Pl,header_bytes_sent:Math.max(((Dn=De?.headerBytesSent)!==null&&Dn!==void 0?Dn:0)-((gr=Fe?.headerBytesSent)!==null&&gr!==void 0?gr:0),0),nack_count:Math.max(((Ur=De?.nackCount)!==null&&Ur!==void 0?Ur:0)-((Ci=Fe?.nackCount)!==null&&Ci!==void 0?Ci:0),0),packets_lost:ps,packets_sent:Math.max(((ai=De?.packetsSent)!==null&&ai!==void 0?ai:0)-((oi=Fe?.packetsSent)!==null&&oi!==void 0?oi:0),0),retransmitted_bytes_sent:Math.max(((Bi=De?.retransmittedBytesSent)!==null&&Bi!==void 0?Bi:0)-((Wr=Fe?.retransmittedBytesSent)!==null&&Wr!==void 0?Wr:0),0),retransmitted_packets_sent:Math.max(((bs=De?.retransmittedPacketsSent)!==null&&bs!==void 0?bs:0)-((li=Fe?.retransmittedPacketsSent)!==null&&li!==void 0?li:0),0),target_bitrate:Math.max((Os=De?.targetBitrate)!==null&&Os!==void 0?Os:0,0),protocol:(Vi=Et?.localCandidate)===null||Vi===void 0?void 0:Vi.protocol}})(X,te,ue,Ee,w,h,b,Ae,k)))}}class to extends ur{constructor(C,P,H,X,te,ue,Ee,w){var h,b;super(Xn.SUBSCRIBED_VIDEO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(h=X?.node)!==null&&h!==void 0?h:"",cluster:(b=X?.cluster)!==null&&b!==void 0?b:"",remote_participant_id:H},((k,F,ie,pe)=>{var ye,Ae,De,Fe,Ye,dt,Et,Pt,bt,gt,Ot,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur;let Ci=0;k?.jitterBufferDelay&&k?.jitterBufferEmittedCount&&k.jitterBufferEmittedCount>0&&(Ci=k.jitterBufferDelay/k.jitterBufferEmittedCount);const ai=pe??1,oi=Math.max((ye=k?.bytesReceived)!==null&&ye!==void 0?ye:0,0),Bi=8*oi/ai;let Wr=0;k?.totalDecodeTime&&k?.framesDecoded&&(Wr=k.totalDecodeTime/Math.max(k?.framesDecoded,1));const bs=Math.max((Ae=k?.packetsLost)!==null&&Ae!==void 0?Ae:0,0),li=Math.max((De=k?.packetsReceived)!==null&&De!==void 0?De:0,0),Os=bs/Math.max(li+bs,1),Vi=cl(ie?.mimeType,ie?.sdpFmtpLine);return{bytes_received:oi,codec_mime_type:Vi?.mimeSubtype,codec_profile:Vi?.profile,codec_level:Vi?.level,connection_bandwidth:(Ye=(Fe=F?.candidatePair)===null||Fe===void 0?void 0:Fe.availableIncomingBitrate)!==null&&Ye!==void 0?Ye:0,decode_bitrate:Bi,decoder_implementation:(dt=k?.decoderImplementation)!==null&&dt!==void 0?dt:"unknown",fir_count:Math.max((Et=k?.firCount)!==null&&Et!==void 0?Et:0,0),fraction_packets_lost:Os,frame_decode_time_avg:Wr,frame_height:Math.max((Pt=k?.frameHeight)!==null&&Pt!==void 0?Pt:0,0),frame_width:Math.max((bt=k?.frameWidth)!==null&&bt!==void 0?bt:0,0),frames_decoded:Math.max((gt=k?.framesDecoded)!==null&&gt!==void 0?gt:0,0),frames_dropped:Math.max((Ot=k?.framesDropped)!==null&&Ot!==void 0?Ot:0,0),frames_received:Math.max((wt=k?.framesReceived)!==null&&wt!==void 0?wt:0,0),freeze_count:Math.max((It=k?.freezeCount)!==null&&It!==void 0?It:0,0),frames_rendered:Math.max((Ft=k?.framesRendered)!==null&&Ft!==void 0?Ft:0,0),frames_per_second:Math.max((Zt=k?.framesPerSecond)!==null&&Zt!==void 0?Zt:0,0),header_bytes_received:Math.max((Gt=k?.headerBytesReceived)!==null&&Gt!==void 0?Gt:0,0),jitter_buffer_delay_avg:Ci,key_frames_decoded:Math.max(($t=k?.keyFramesDecoded)!==null&&$t!==void 0?$t:0,0),nack_count:Math.max((dn=k?.nackCount)!==null&&dn!==void 0?dn:0,0),packets_discarded:Math.max((Rn=k?.packetsDiscarded)!==null&&Rn!==void 0?Rn:0,0),packets_lost:bs,packets_received:li,pause_count:Math.max((Nn=k?.pauseCount)!==null&&Nn!==void 0?Nn:0,0),pli_count:Math.max((qn=k?.pliCount)!==null&&qn!==void 0?qn:0,0),power_efficient_decoder:(Dn=k?.powerEfficientDecoder)!==null&&Dn!==void 0&&Dn,total_freezes_duration:Math.max((gr=k?.totalFreezesDuration)!==null&&gr!==void 0?gr:0,0),total_pauses_duration:Math.max((Ur=k?.totalPausesDuration)!==null&&Ur!==void 0?Ur:0,0)}})(te,ue,Ee,w)))}}class fc extends ur{constructor(C,P,H,X,te,ue,Ee,w,h,b,k){var F,ie,pe,ye;super(Xn.SUBSCRIBED_VIDEO_STATS_WINDOW,C,P,!1);const Ae=Math.max(((F=te?.timestamp)!==null&&F!==void 0?F:0)-((ie=ue?.timestamp)!==null&&ie!==void 0?ie:0),0);Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(pe=X?.node)!==null&&pe!==void 0?pe:"",cluster:(ye=X?.cluster)!==null&&ye!==void 0?ye:"",window_size_ms:Ae,remote_participant_id:H},((De,Fe,Ye,dt,Et,Pt,bt,gt)=>{var Ot,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur,Ci,ai,oi,Bi,Wr,bs,li,Os,Vi,Js,Is,ps,_o,Pl,gc,ou,Lu,T,R,z,re,he,Te,et,yt,zt,mn,Ln,Jn,nr,Yr;let lu=0,hd=0;if(De?.jitterBufferEmittedCount&&Fe?.jitterBufferEmittedCount&&De.jitterBufferEmittedCount>Fe.jitterBufferEmittedCount){De?.jitterBufferDelay&&Fe?.jitterBufferDelay&&(lu=(De.jitterBufferDelay-Fe.jitterBufferDelay)/(De.jitterBufferEmittedCount-Fe.jitterBufferEmittedCount));const pd=Fe?.jitterBufferMinimumDelay,r_=De?.jitterBufferMinimumDelay;pd&&r_&&(hd=(r_-pd)/(De.jitterBufferEmittedCount-Fe.jitterBufferEmittedCount))}const dd=Math.max(((Ot=De?.bytesReceived)!==null&&Ot!==void 0?Ot:0)-((wt=Fe?.bytesReceived)!==null&&wt!==void 0?wt:0),0),Qt=typeof Et!="number"?1:Et/1e3,Ct=8*dd/Qt,nn=Math.max(((It=De?.totalDecodeTime)!==null&&It!==void 0?It:0)-((Ft=Fe?.totalDecodeTime)!==null&&Ft!==void 0?Ft:0),0),Un=Math.max(((Zt=De?.framesDecoded)!==null&&Zt!==void 0?Zt:0)-((Gt=Fe?.framesDecoded)!==null&&Gt!==void 0?Gt:0),0),Mr=nn/Math.max(Un,1),ya=Math.max((($t=De?.packetsLost)!==null&&$t!==void 0?$t:0)-((dn=Fe?.packetsLost)!==null&&dn!==void 0?dn:0),0),Xr=Math.max(((Rn=De?.packetsReceived)!==null&&Rn!==void 0?Rn:0)-((Nn=Fe?.packetsReceived)!==null&&Nn!==void 0?Nn:0),0),Ss=ya/Math.max(Xr+ya,1),Aa=cl(dt?.mimeType,dt?.sdpFmtpLine),Qi=8*(gt||0)/Qt;return{bytes_received:dd,codec_mime_type:Aa?.mimeSubtype,codec_profile:Aa?.profile,codec_level:Aa?.level,connection_bandwidth:(Dn=(qn=Ye?.candidatePair)===null||qn===void 0?void 0:qn.availableIncomingBitrate)!==null&&Dn!==void 0?Dn:0,decode_bitrate:Ct,decoder_implementation:(gr=De?.decoderImplementation)!==null&&gr!==void 0?gr:"unknown",fir_count:Math.max(((Ur=De?.firCount)!==null&&Ur!==void 0?Ur:0)-((Ci=Fe?.firCount)!==null&&Ci!==void 0?Ci:0),0),fraction_packets_lost:Ss,frame_decode_time_avg:Mr,frame_height:Math.max((ai=De?.frameHeight)!==null&&ai!==void 0?ai:0,0),frame_width:Math.max((oi=De?.frameWidth)!==null&&oi!==void 0?oi:0,0),frames_decoded:Math.max(((Bi=De?.framesDecoded)!==null&&Bi!==void 0?Bi:0)-((Wr=Fe?.framesDecoded)!==null&&Wr!==void 0?Wr:0),0),frames_dropped:Math.max(((bs=De?.framesDropped)!==null&&bs!==void 0?bs:0)-((li=Fe?.framesDropped)!==null&&li!==void 0?li:0),0),frames_received:Math.max(((Os=De?.framesReceived)!==null&&Os!==void 0?Os:0)-((Vi=Fe?.framesReceived)!==null&&Vi!==void 0?Vi:0),0),freeze_count:Math.max(((Js=De?.freezeCount)!==null&&Js!==void 0?Js:0)-((Is=Fe?.freezeCount)!==null&&Is!==void 0?Is:0),0),frames_rendered:Math.max((ps=De?.framesRendered)!==null&&ps!==void 0?ps:0,0),frames_per_second:Math.max((_o=De?.framesPerSecond)!==null&&_o!==void 0?_o:0,0),header_bytes_received:Math.max(((Pl=De?.headerBytesReceived)!==null&&Pl!==void 0?Pl:0)-((gc=Fe?.headerBytesReceived)!==null&&gc!==void 0?gc:0),0),configured_jitter_buffer_min_delay_ms:Pt??0,jitter_buffer_min_obtainable_delay:hd,jitter_buffer_delay_avg:lu,key_frames_decoded:Math.max(((ou=De?.keyFramesDecoded)!==null&&ou!==void 0?ou:0)-((Lu=Fe?.keyFramesDecoded)!==null&&Lu!==void 0?Lu:0),0),nack_count:Math.max(((T=De?.nackCount)!==null&&T!==void 0?T:0)-((R=Fe?.nackCount)!==null&&R!==void 0?R:0),0),packets_discarded:Math.max(((z=De?.packetsDiscarded)!==null&&z!==void 0?z:0)-((re=Fe?.packetsDiscarded)!==null&&re!==void 0?re:0),0),packets_lost:ya,packets_received:Xr,pause_count:Math.max(((he=De?.pauseCount)!==null&&he!==void 0?he:0)-((Te=Fe?.pauseCount)!==null&&Te!==void 0?Te:0),0),pli_count:Math.max(((et=De?.pliCount)!==null&&et!==void 0?et:0)-((yt=Fe?.pliCount)!==null&&yt!==void 0?yt:0),0),power_efficient_decoder:(zt=De?.powerEfficientDecoder)!==null&&zt!==void 0&&zt,total_freezes_duration:Math.max(((mn=De?.totalFreezesDuration)!==null&&mn!==void 0?mn:0)-((Ln=Fe?.totalFreezesDuration)!==null&&Ln!==void 0?Ln:0),0),total_pauses_duration:Math.max(((Jn=De?.totalPausesDuration)!==null&&Jn!==void 0?Jn:0)-((nr=Fe?.totalPausesDuration)!==null&&nr!==void 0?nr:0),0),sei_read_count:bt,sei_bytes_received:gt,sei_bitrate:Qi,protocol:(Yr=Ye?.localCandidate)===null||Yr===void 0?void 0:Yr.protocol}})(te,ue,Ee,w,Ae,h,b,k)))}}class jo extends ur{constructor(C,P,H,X,te,ue,Ee,w,h){var b,k;super(Xn.SUBSCRIBED_AUDIO_STATS,C,P,!1),Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,node:(b=X?.node)!==null&&b!==void 0?b:"",cluster:(k=X?.cluster)!==null&&k!==void 0?k:"",remote_participant_id:H},((F,ie,pe,ye,Ae)=>{var De,Fe,Ye,dt,Et,Pt,bt,gt,Ot,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn;let qn=0;F?.jitterBufferDelay&&F?.jitterBufferEmittedCount&&F.jitterBufferEmittedCount>0&&(qn=F.jitterBufferDelay/F.jitterBufferEmittedCount);const Dn=ye??1,gr=Math.max((De=F?.bytesReceived)!==null&&De!==void 0?De:0,0),Ur=8*gr/Dn,Ci=Math.max((Fe=F?.packetsLost)!==null&&Fe!==void 0?Fe:0,0),ai=Math.max((Ye=F?.packetsReceived)!==null&&Ye!==void 0?Ye:0,0),oi=Ci/Math.max(ai+Ci,1),Bi=Math.max((dt=F?.concealedSamples)!==null&&dt!==void 0?dt:0,0),Wr=Math.max((Et=F?.totalSamplesReceived)!==null&&Et!==void 0?Et:0,0),bs=Bi/Math.max(Wr,1),li=cl(pe?.mimeType,pe?.sdpFmtpLine);return{audio_level:(Pt=F?.audioLevel)!==null&&Pt!==void 0?Pt:0,audio_nacks_enabled:(bt=Ae?.audioNacks)!==null&&bt!==void 0&&bt,bytes_received:gr,codec_mime_type:li?.mimeSubtype,connection_bandwidth:(Ot=(gt=ie?.candidatePair)===null||gt===void 0?void 0:gt.availableIncomingBitrate)!==null&&Ot!==void 0?Ot:0,concealed_samples:Bi,concealment_events:Math.max((wt=F?.concealmentEvents)!==null&&wt!==void 0?wt:0,0),silent_concealed_samples:Math.max((It=F?.silentConcealedSamples)!==null&&It!==void 0?It:0,0),decode_bitrate:Ur,fraction_audio_concealed:bs,fraction_packets_lost:oi,header_bytes_received:Math.max((Ft=F?.headerBytesReceived)!==null&&Ft!==void 0?Ft:0,0),inserted_samples_for_deceleration:Math.max((Zt=F?.insertedSamplesForDeceleration)!==null&&Zt!==void 0?Zt:0,0),jitter_buffer_delay_avg:qn,packets_discarded:Math.max((Gt=F?.packetsDiscarded)!==null&&Gt!==void 0?Gt:0,0),retransmitted_packets_received:Math.max(($t=F?.retransmittedPacketsReceived)!==null&&$t!==void 0?$t:0,0),retransmitted_bytes_received:Math.max((dn=F?.retransmittedBytesReceived)!==null&&dn!==void 0?dn:0,0),packets_lost:Ci,packets_received:ai,nack_count:Math.max((Rn=F?.nackCount)!==null&&Rn!==void 0?Rn:0,0),removed_samples_for_acceleration:Math.max((Nn=F?.removedSamplesForAcceleration)!==null&&Nn!==void 0?Nn:0,0),total_samples_received:Wr}})(te,ue,Ee,w,h)))}}class Zg extends ur{constructor(C,P,H,X,te,ue,Ee,w,h,b){var k,F,ie,pe;super(Xn.SUBSCRIBED_AUDIO_STATS_WINDOW,C,P,!1);const ye=Math.max(((k=te?.timestamp)!==null&&k!==void 0?k:0)-((F=ue?.timestamp)!==null&&F!==void 0?F:0),0);Object.assign(this.properties,Object.assign({action:Fn.SUBSCRIBE,window_size_ms:ye,node:(ie=X?.node)!==null&&ie!==void 0?ie:"",cluster:(pe=X?.cluster)!==null&&pe!==void 0?pe:"",remote_participant_id:H},((Ae,De,Fe,Ye,dt,Et,Pt)=>{var bt,gt,Ot,wt,It,Ft,Zt,Gt,$t,dn,Rn,Nn,qn,Dn,gr,Ur,Ci,ai,oi,Bi,Wr,bs,li,Os,Vi,Js,Is,ps,_o,Pl,gc,ou,Lu;let T=0,R=0;if(Ae?.jitterBufferEmittedCount&&De?.jitterBufferEmittedCount&&Ae.jitterBufferEmittedCount>De.jitterBufferEmittedCount){Ae?.jitterBufferDelay&&De?.jitterBufferDelay&&(T=(Ae.jitterBufferDelay-De.jitterBufferDelay)/(Ae.jitterBufferEmittedCount-De.jitterBufferEmittedCount));const nr=De?.jitterBufferMinimumDelay,Yr=Ae?.jitterBufferMinimumDelay;nr&&Yr&&(R=(Yr-nr)/(Ae.jitterBufferEmittedCount-De.jitterBufferEmittedCount))}const z=typeof dt!="number"?1:dt/1e3,re=Math.max(((bt=Ae?.bytesReceived)!==null&&bt!==void 0?bt:0)-((gt=De?.bytesReceived)!==null&&gt!==void 0?gt:0),0),he=8*re/z,Te=Math.max(((Ot=Ae?.packetsLost)!==null&&Ot!==void 0?Ot:0)-((wt=De?.packetsLost)!==null&&wt!==void 0?wt:0),0),et=Math.max(((It=Ae?.packetsReceived)!==null&&It!==void 0?It:0)-((Ft=De?.packetsReceived)!==null&&Ft!==void 0?Ft:0),0),yt=Te/Math.max(et+Te,1),zt=Math.max(((Zt=Ae?.concealedSamples)!==null&&Zt!==void 0?Zt:0)-((Gt=De?.concealedSamples)!==null&&Gt!==void 0?Gt:0),0),mn=Math.max((($t=Ae?.totalSamplesReceived)!==null&&$t!==void 0?$t:0)-((dn=De?.totalSamplesReceived)!==null&&dn!==void 0?dn:0),0),Ln=zt/Math.max(mn,1),Jn=cl(Ye?.mimeType,Ye?.sdpFmtpLine);return{audio_level:(Rn=Ae?.audioLevel)!==null&&Rn!==void 0?Rn:0,audio_nacks_enabled:(Nn=Et?.audioNacks)!==null&&Nn!==void 0&&Nn,bytes_received:re,codec_mime_type:Jn?.mimeSubtype,connection_bandwidth:(Dn=(qn=Fe?.candidatePair)===null||qn===void 0?void 0:qn.availableIncomingBitrate)!==null&&Dn!==void 0?Dn:0,decode_bitrate:he,concealed_samples:zt,concealment_events:Math.max(((gr=Ae?.concealmentEvents)!==null&&gr!==void 0?gr:0)-((Ur=De?.concealmentEvents)!==null&&Ur!==void 0?Ur:0),0),silent_concealed_samples:Math.max(((Ci=Ae?.silentConcealedSamples)!==null&&Ci!==void 0?Ci:0)-((ai=De?.silentConcealedSamples)!==null&&ai!==void 0?ai:0),0),fraction_audio_concealed:Ln,fraction_packets_lost:yt,header_bytes_received:Math.max(((oi=Ae?.headerBytesReceived)!==null&&oi!==void 0?oi:0)-((Bi=De?.headerBytesReceived)!==null&&Bi!==void 0?Bi:0),0),inserted_samples_for_deceleration:Math.max(((Wr=Ae?.insertedSamplesForDeceleration)!==null&&Wr!==void 0?Wr:0)-((bs=De?.insertedSamplesForDeceleration)!==null&&bs!==void 0?bs:0),0),configured_jitter_buffer_min_delay_ms:Pt??0,jitter_buffer_min_obtainable_delay:R,jitter_buffer_delay_avg:T,packets_discarded:Math.max(((li=Ae?.packetsDiscarded)!==null&&li!==void 0?li:0)-((Os=De?.packetsDiscarded)!==null&&Os!==void 0?Os:0),0),packets_lost:Te,packets_received:et,nack_count:Math.max(((Vi=Ae?.nackCount)!==null&&Vi!==void 0?Vi:0)-((Js=De?.nackCount)!==null&&Js!==void 0?Js:0),0),removed_samples_for_acceleration:Math.max(((Is=Ae?.removedSamplesForAcceleration)!==null&&Is!==void 0?Is:0)-((ps=De?.removedSamplesForAcceleration)!==null&&ps!==void 0?ps:0),0),retransmitted_packets_received:Math.max(((_o=Ae?.retransmittedPacketsReceived)!==null&&_o!==void 0?_o:0)-((Pl=De?.retransmittedPacketsReceived)!==null&&Pl!==void 0?Pl:0),0),retransmitted_bytes_received:Math.max(((gc=Ae?.retransmittedBytesReceived)!==null&&gc!==void 0?gc:0)-((ou=De?.retransmittedBytesReceived)!==null&&ou!==void 0?ou:0),0),total_samples_received:mn,protocol:(Lu=Fe?.localCandidate)===null||Lu===void 0?void 0:Lu.protocol}})(te,ue,Ee,w,ye,h,b)))}}class Da extends ur{constructor(C,P,H,X,te=Fn.PUBLISH,ue=!1,Ee=""){super(Xn.SIMULCAST_LAYER_INFO,C,P,!1),Object.assign(this.properties,{rid:H,active:X,selected:ue,source:te===Fn.PUBLISH?"publisher":"subscriber",remote_participant_id:Ee})}}const Zs=j=>{console.warn(`[IVS Stages] ${j}`)};var no,td,nd;(function(j){j.Mobile="mobile",j.Tablet="tablet",j.Desktop="desktop",j.Tv="tv"})(no||(no={})),(function(j){j.IOS="iOS",j.MacOS="macOS",j.Windows="Windows",j.Android="Android"})(td||(td={})),(function(j){j.Safari="Safari",j.Firefox="Firefox",j.Chrome="Chrome",j.IE="Internet Explorer",j.Edge="Microsoft Edge"})(nd||(nd={}));const _p=(function(j){const C=fl(j);return{platform:{isMobile:Kl(no.Mobile,C),isTablet:Kl(no.Tablet,C),isDesktop:Kl(no.Desktop,C),isTv:Kl(no.Tv,C)},os:{name:hl(C),version:vp(C),isIOS:ia(td.IOS,C),isMacOS:ia(td.MacOS,C),isWindows:ia(td.Windows,C),isAndroid:ia(td.Android,C)},browser:{name:dr(C),version:hc(C),isSafari:br(nd.Safari,C),isFirefox:br(nd.Firefox,C),isChrome:br(nd.Chrome,C),isIE:br(nd.IE,C),isEdge:br(nd.Edge,C)}}})(window.navigator.userAgent);function fl(j){try{return Xp.getParser(j||window.navigator.userAgent)}catch{}}function Kl(j,C){return()=>(C||(C=fl()),!(!C||C.getPlatformType(!0)!==j.toLowerCase()))}function vp(j){return()=>(j||(j=fl()),j&&j.getOSVersion()||"")}function hl(j){return()=>(j||(j=fl()),j&&j.getOSName()||"")}function ia(j,C){return()=>(C||(C=fl()),!(!C||C.getOSName(!0)!==j.toLowerCase()))}function hc(j){return()=>(j||(j=fl()),j&&j.getBrowserVersion()||"")}function dr(j){return()=>(j||(j=fl()),j&&j.getBrowserName()||"")}function br(j,C){return()=>(C||(C=fl()),!(!C||C.getBrowserName().toLowerCase()!==j.toLowerCase()))}const rd={name:"SimulcastUnsupported",message:`Simulcast is only supported on Chromium browsers at bitrates over ${ra.MID.maxBitrateKbps}Kbps`,code:100},mo={name:"SimulcastLayerInvalidType",message:"Layer configuration is invalid: ",code:101},Zl={name:"SimulcastMaxLayersExceeded",message:"No more than 3 simulcast layers may be configured",code:102},yp={name:"SimulcastDuplicateLayersConfigured",message:"Two duplicate layers are configured. At minimum bitrate, framerate, or dimensions must differ",code:103},Ho={name:"SimulcastMaxLayerBitrateExceeded",message:`maxBitrateKbps cannot exceed ${eo} Kbps`,code:105},dl={name:"SimulcastMinLayerBitrateExceeded",message:`maxBitrateKbps cannot be less than ${wu} Kbps`,code:106},id={name:"SimulcastMaxLayerFramerateExceeded",message:`maxFramerate cannot exceed ${Dc} fps`,code:107},Qg={name:"SimulcastMinLayerFramerateExceeded",message:`maxFramerate cannot be less than ${Ju} fps`,code:108},sf={name:"SimulcastMaxLayerDimensionsExceeded",message:`dimensions cannot exceed max resolution of ${Ru}x720`,code:109},La={name:"SimulcastMinLayerDimensionsExceeded",message:`width or height cannot be lower than ${ef}`,code:110},qo={name:"SimulcastLayerConfigurationConflict",message:"Layer configuration conflict: ",code:111},Dd={name:"SimulcastLayerOrientationMismatch",message:"Layer orientation different from input video track: ",code:112},lg={name:"SimulcastLayerInputResolutionInsufficient",message:"Input video resolution is lower than the configured layer: ",code:113},nm={name:"SimulcastLayerInputFramerateInsufficient",message:"Input video framerate is lower than the configured layer: ",code:114};class qa extends Error{constructor({name:C,message:P,code:H,details:X,cause:te,params:ue}){super(P),Error.captureStackTrace&&Error.captureStackTrace(this,qa),this.name=C,this.message=P,this.code=H,this.details=X,this.cause=te,this.params=ue}}const rm=j=>({rid:j.rid,active:j.active,scaleResolutionDownBy:j.scaleFactor,maxBitrate:j.maxBitrateBps,maxFramerate:j.maxFramerate}),Jg=(j,C)=>j.width*j.height>C.width*C.height||j.maxBitrateKbps>C.maxBitrateKbps||j.maxFramerate>C.maxFramerate?1:im(j,C)?0:-1,im=(j,C)=>{if(typeof j!="object"||typeof C!="object")return!1;const P=Object.keys(j);for(const H of P)if(j[H]!==C[H])return!1;return!0},sm=j=>{const{width:C,height:P}=Ld(j);return C*P},Ld=j=>{const{height:C,width:P}=j;let H=Ru/tf,X=Ru;return C!==void 0&&(H=C),P!==void 0&&(X=P),C&&!P&&(X=C*tf),!C&&P&&(H=P/tf),{height:H,width:X}},Ud=j=>{const{width:C,height:P}=j;return C/P>=1?yr.LANDSCAPE:yr.PORTRAIT},ku=(j,C,P)=>{var H;const X=(H=j.getSettings().frameRate)!==null&&H!==void 0?H:Dc;return Object.assign(Object.assign({},P),{active:!0,height:C.height,width:C.width,maxBitrateBps:Fr(C.maxBitrateKbps),maxFramerate:Math.min(C.maxFramerate,X),scaleFactor:cg(C,j)})},cg=(j,C)=>{const P=sm(C.getSettings()),H=sm(j);if(H>=P)return 1;const X=1/Math.sqrt(H/P);return Math.max(X,1)},Z0=j=>{if(typeof j!="object"){const C=Object.assign({},mo);throw C.message+=" is not an object",new qa(C)}},am=(j,C)=>{if(typeof j!="number"){const P=Object.assign({},mo);throw P.message+="maxBitrateKbps is not a number",new qa(P)}if(j<wu)throw new qa(Object.assign({},dl));if(j>eo)throw new qa(Object.assign({},Ho));if(C&&j>C){const P=Object.assign({},qo);throw P.message+=`maxBitrateKbps cannot be greater than stage maxVideoBitrateKbps of ${C}`,new qa(P)}},Df=(j,C)=>{if(typeof j!="number"){const P=Object.assign({},mo);throw P.message+="maxFramerate is not a number",new qa(P)}if(j<Ju)throw new qa(Object.assign({},Qg));if(j>Dc)throw new qa(Object.assign({},id));if(C&&j>C){const P=Object.assign({},qo);throw P.message+=`maxFramerate cannot be greater than stage maxFramerate of ${C} `,new qa(P)}},Bd=(j,C)=>{var P;if(typeof j!="number"||typeof C!="number"){const te=Object.assign({},mo);throw te.message+="width and height must be numbers",new qa(te)}if(j<ef||C<ef)throw new qa(Object.assign({},La));const H=(P=pa("enable1080pResolution"))!==null&&P!==void 0&&P,X=H?1920:Ru;if(j>X||C>X)throw new qa(Object.assign({},sf));if(j*C>(H?2073600:Co))throw new qa(Object.assign({},sf))},Ou=(j,C)=>{const P=Ld(C.getSettings()),H=Ud(P);H!==Ud(j)&&Zs(`${Dd.message}forcing orientation to ${H}`)},pl=(j,C)=>{var P,H,X,te,ue;let Ee=(0,zs.cloneDeep)(C);const w=(P=Ee.simulcast)!==null&&P!==void 0?P:{},h=!_p.browser.isChrome()&&!_p.browser.isEdge(),b=(X=(H=j.getSettings())===null||H===void 0?void 0:H.displaySurface)!==null&&X!==void 0&&X,k=(te=Ee.maxVideoBitrateKbps)!==null&&te!==void 0?te:eo,F=!(Array.isArray((ue=C.simulcast)===null||ue===void 0?void 0:ue.layers)||!C.maxVideoBitrateKbps)&&k<ra.MID.maxBitrateKbps;if(typeof w.enabled=="boolean"&&w.enabled&&(h||b||F)){Ee.simulcast={enabled:!1};const{name:ie,message:pe}=rd;Zs(`${ie}${pe}, disabling the feature`)}return Ee=((ie,pe)=>{var ye,Ae;const De=pe,Fe=(ye=pe.simulcast)===null||ye===void 0?void 0:ye.layers;if(Fe===void 0)return De;if(!Array.isArray(Fe)){const Ye=Object.assign({},mo);throw Ye.message+=" layers is not an array",new qa(Ye)}if(Fe.length===0)return(Ae=De.simulcast)===null||Ae===void 0||delete Ae.layers,De;if(Fe.length>3)throw new qa(Object.assign({},Zl));if((0,zs.uniqWith)(Fe,im).length!==Fe.length)throw new qa(Object.assign({},yp));for(const Ye of Fe)Z0(Ye),am(Ye.maxBitrateKbps,pe.maxVideoBitrateKbps),Df(Ye.maxFramerate,pe.maxFramerate),Bd(Ye.width,Ye.height),Ou(Ye,ie);return De})(j,Ee),Ee};function Lc(j){return j.track.kind===Qu.AUDIO}function om(j){return j.track.kind===Qu.VIDEO&&typeof j.config=="object"}function e0(j){if(j!==void 0&&(j<wu||j>eo))throw new Error(`Stage bitrate must be a number between ${wu} kbps and ${eo} kbps inclusive`)}function lm(j){return j!==void 0&&("maxBitrate"in j||"maxVideoBitrateKbps"in j||"maxFramerate"in j||"simulcast"in j||"inBandMessaging"in j||"minBitrate"in j)}function ug(j,C){if(C===void 0)return C;let P=(0,zs.cloneDeep)(C);return lm(P)?(P.maxBitrate!==void 0&&(P.maxVideoBitrateKbps=P.maxBitrate,Zs("maxBitrate is deprecated in favor of maxVideoBitrateKbps")),P=pl(j,P),e0(P.maxVideoBitrateKbps),e0(P.minBitrate),(function(H){if(H!==void 0&&(H>Dc||H<Ju))throw new Error(`Stage framerate must be between ${Ju} fps and ${Dc} fps inclusive`)})(P.maxFramerate),(function(H){if(H!==void 0){if(typeof H!="object")throw new Error("In-band messaging config must be an object");if(typeof H.enabled!="boolean")throw new Error("In-band messaging config enabled property must be a boolean")}})(P.inBandMessaging)):((function(H){if(H!==void 0&&(H<nf||H>Mo))throw new Error(`Stage audio bitrate must be between ${nf} Kbps and ${Mo} Kbps inclusive`)})(P.maxAudioBitrateKbps),(function(H){if(H!==void 0&&typeof H!="boolean")throw new Error("Stage stereo prop must be a boolean")})(P.stereo)),P}const t0=(j,C,P)=>{var H;const X={[Lr.HI]:Pc(Lr.HI),[Lr.MID]:Pc(Lr.MID),[Lr.LOW]:Pc(Lr.LOW)},te=C.simulcast,ue=P?.simulcast;let Ee=te.layers.sort(Jg);const w=(H=ue?.layers)!==null&&H!==void 0?H:[],h=Ee.length,b=w.length;return Ee=Ee.map((k=>{((ie,pe)=>{const{width:ye,height:Ae}=Ld(pe.getSettings()),{width:De,height:Fe}=ie;if(De*Fe>ye*Ae){const Ye=`forcing layer of ${De}x${Fe} to the input dimensions ${ye}x${Ae}`,{name:dt,message:Et}=lg;Zs(`${dt}${Et}${Ye}`)}})(k,j),((ie,pe)=>{var ye;const Ae=(ye=pe.getSettings().frameRate)!==null&&ye!==void 0?ye:Dc,De=ie.maxFramerate;if(De>Ae){const Fe=`forcing layer of ${De}fps to the input framerate of ${Ae}`,{name:Ye,message:dt}=nm;Zs(`${Ye}${dt}${Fe}`)}})(k,j);let F=((ie,pe)=>{const{maxVideoBitrateKbps:ye}=pe,Ae=ie;return ye&&ie.maxBitrateKbps>ye&&(Ae.maxBitrateKbps=ye),Ae})(k,C);return F=((ie,pe)=>{const{maxFramerate:ye}=pe,Ae=ie;return ye&&ie.maxFramerate>ye&&(Ae.maxFramerate=ye),Ae})(k,C),F})),(b===0||b===3)&&h===3?(X.hi=ku(j,Ee[2],X.hi),X.mid=ku(j,Ee[1],X.mid),X.low=ku(j,Ee[0],X.low),Qn.ok(X)):b===1&&h===1?(X.hi=ku(j,Ee[0],X.hi),Qn.ok(X)):b===2&&h===2?(X.hi=ku(j,Ee[1],X.hi),X.low=ku(j,Ee[0],X.low),Qn.ok(X)):Qn.err(null)},n0=(j,C,P)=>{const H=C.simulcast,X=C.inBandMessaging,te=Fr(C.minBitrate),ue=Fr(C.maxVideoBitrateKbps),Ee=C.maxFramerate;let w=[{maxBitrate:ue,maxFramerate:Ee}];const h=t0(j,C,P??{});return H.enabled&&h.ok&&(w=(b=>{const{hi:k,mid:F,low:ie}=b;return[rm(ie),rm(F),rm(k)]})(h.value)),{track:j,config:{minBitrateBps:te,maxBitrateBps:ue,maxFramerate:Ee,inBandMessagingEnabled:X.enabled,simulcastEnabled:H.enabled,simulcastLayers:h.ok?h.value:void 0,encodingLayers:w}}},cm=j=>{const C=j.mediaStreamTrack,P=j.normalizedConfig;let H={};const X=j.validatedExternalConfig;return lm(X)&&(H=X),(function(te){return te.kind===Qu.AUDIO})(C)?((te,ue)=>{const Ee={maxBitrateBps:Fr(ue.maxAudioBitrateKbps)},w=ue?.stereo;return typeof w=="boolean"&&(Ee.stereo=w),{track:te,config:Ee}})(C,P):n0(C,P,H)},Q0=(j,C)=>{const P={minBitrate:wu,maxBitrate:eo,maxVideoBitrateKbps:eo,maxFramerate:Dc,simulcast:{enabled:!1,layers:[Object.assign({},ra.HI),Object.assign({},ra.MID),Object.assign({},ra.LOW)]},maxAudioBitrateKbps:em,stereo:!1,inBandMessaging:{enabled:!1}},H=(0,zs.cloneDeep)(C),X=Object.assign(Object.assign({},P),H);return lm(H)&&(H.simulcast&&(X.simulcast=Object.assign(Object.assign({},P.simulcast),H.simulcast)),H.inBandMessaging&&(X.inBandMessaging=Object.assign(Object.assign({},P.inBandMessaging),H.inBandMessaging))),X},um=(j,C)=>{if(typeof j=="number")return j;const P=C?jr:Au;return P[j]!==void 0?P[j]:0};class r0 extends ur{constructor(C,P,H,X){super(Xn.MULTIHOST_CONFIGURATION,C,P,!1),Object.assign(this.properties,Object.assign(Object.assign({},H),{action:X}))}}class Iu extends ur{constructor(C,P,H,X,te){super(Xn.MULTIHOST_SUBSCRIBE_CONFIGURATION,C,P,!1);const ue={trigger:H,remote_participant_id:X,min_delay_when_publishing:um(te.jitterBuffer.minDelayWhenPublishing,!0),min_delay_when_subscribe_only:um(te.jitterBuffer.minDelayWhenSubscribeOnly,!1),in_band_messaging_enabled:te.inBandMessaging.enabled,simulcast_initial_layer_preference:te.simulcast.initialLayerPreference,simulcast_layer_poll_interval_ms:te.simulcast.layerPollingIntervalMs,simulcast_layer_poll_enabled:te.simulcast.layerPollingEnabled};Object.assign(this.properties,ue)}}var Ql=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class fg{constructor(C,P,H,X,te){this.analyticsTracker=te,this.simulcastEnabled=!1,this.simulcastState={low:!1,mid:!1,hi:!1},this.sdp=new xi(""),this.sdpFeatures={audioNacks:!1},this.multihostConfiguration=fg.defaultMultihostConfiguration(),this.prevOutboundVideoStats=new Map,this.prevInboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.sfuResource={node:"",cluster:""},this.connectionStartedTimestamp=Date.now(),this.seiStats={seiReadCnt:0,seiBytesRead:0,seiWriteCnt:0,seiBytesWritten:0},this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0},this.vidNetworkQualityMap=new Map,this.audioNetworkQualityMap=new Map,this.onPeerConnectionStateChange=()=>{switch(this.getConnectionState()){case sr.CONNECTED:this.connectionStartedTimestamp=Date.now(),this.setupIntervals();break;case sr.FAILED:this.flushStats()}},this.action=C,this.token=P,this.traceId=H,this.identifier=X}static defaultMultihostConfiguration(){return{video_codec:"unknown",width:0,height:0,max_bitrate:0,min_bitrate:0,target_fps:0,echo_cancellation:!1,auto_gain:!1,noise_suppression:!1,enable_simulcast:!1,max_audio_bitrate_bps:Fr(Mo),hi_video_layer:"",mid_video_layer:"",low_video_layer:""}}set sdpAnswer(C){try{this.sdp=new xi(C),this.sdpFeatures.audioNacks=this.sdp.hasAudioNacksEnabled()}catch{}}start(C,P=!1){this.peerConnection=C,this.simulcastEnabled=P,this.prevOutboundAudioStats=void 0,this.prevOutboundVideoStats=new Map,this.prevRemoteInboundStats=new Map,this.peerConnection.addEventListener("connectionstatechange",this.onPeerConnectionStateChange)}stop(){var C;clearInterval(this.uploadStatsInterval),this.uploadStatsInterval=void 0,(C=this.peerConnection)===null||C===void 0||C.removeEventListener("connectionstatechange",this.onPeerConnectionStateChange)}updateSfuResource(C){this.sfuResource=C}updateMultihostConfiguration(C,P){var H,X,te,ue,Ee,w,h,b,k;return Ql(this,void 0,void 0,(function*(){if(this.action!==Fn.PUBLISH||!this.peerConnection)return;const F=fg.defaultMultihostConfiguration();if(P){const ie=this.peerConnection.getSenders().filter((Ae=>Ae.track!==null&&Ae.track.kind==="video"));let pe="unknown";ie.length>0&&(yield ie[0].getStats()).forEach((Ae=>{if(Ae.type==="codec"&&(F.video_codec=Ae.mimeType,Ae.sdpFmtpLine)){const De=Ae.sdpFmtpLine.match(/profile-level-id=([a-f0-9]+)/);De&&De.length>0&&(pe=De[1])}}));const ye=P.track.getSettings();F.width=(H=ye.width)!==null&&H!==void 0?H:0,F.height=(X=ye.height)!==null&&X!==void 0?X:0,F.target_fps=(te=ye.frameRate)!==null&&te!==void 0?te:0,P.config?(F.max_bitrate=P.config.maxBitrateBps,F.min_bitrate=P.config.minBitrateBps,F.enable_simulcast=P.config.simulcastEnabled):(F.max_bitrate=Fr(eo),F.min_bitrate=Fr(wu),F.enable_simulcast=!1),P.config.simulcastEnabled&&(F.hi_video_layer=this.mapLayerToMetric(pe,(ue=P.config.simulcastLayers)===null||ue===void 0?void 0:ue.hi),F.mid_video_layer=this.mapLayerToMetric(pe,(Ee=P.config.simulcastLayers)===null||Ee===void 0?void 0:Ee.mid),F.low_video_layer=this.mapLayerToMetric(pe,(w=P.config.simulcastLayers)===null||w===void 0?void 0:w.low))}if(C){const ie=C.track.getSettings();F.auto_gain=(h=ie.autoGainControl)!==null&&h!==void 0&&h,F.echo_cancellation=(b=ie.echoCancellation)!==null&&b!==void 0&&b,F.noise_suppression=(k=ie.noiseSuppression)!==null&&k!==void 0&&k,F.max_audio_bitrate_bps=C.config.maxBitrateBps,F.stereo=C.config.stereo}(0,zs.isEqual)(F,this.multihostConfiguration)||(this.analyticsTracker.trackEventNoSharedProps(new r0(this.token,this.traceId,F,this.action)),this.multihostConfiguration=F)}))}resetTransformers(C,P){this.senderVideoTransformer=P,this.receiveVideoTransformer=C,this.prevVideoReceiverTransformerStats={seiReadCnt:0,seiBytesRead:0},this.prevVideoSenderTransformerStats={seiWriteCnt:0,seiBytesWritten:0}}getStats(C){var P;return Ql(this,void 0,void 0,(function*(){const H=yield(P=this.peerConnection)===null||P===void 0?void 0:P.getStats(C),{action:X}=this;if(H)if(C.kind==="audio"){if(X===Fn.PUBLISH)return{action:X,rawReport:H,stats:Ol(H,this.audioNetworkQualityMap)};if(X===Fn.SUBSCRIBE)return{action:X,rawReport:H,stats:Nd(H,this.audioNetworkQualityMap)}}else{if(X===Fn.PUBLISH)return{action:X,rawReport:H,stats:Qc(H,this.vidNetworkQualityMap)};if(X===Fn.SUBSCRIBE)return{action:X,rawReport:H,stats:Pd(H,this.vidNetworkQualityMap)}}}))}mapLayerToMetric(C,P){return!P||!P.active?"":`${`${P.height}x${P.width}`}_${`${P.maxFramerate}fps`}_${P.maxBitrateBps/1e3+"kbps"}_${C}`}updateJitterBufferMinDelay(C){this.jitterBufferMinDelayInMs=C}setupIntervals(){this.action===Fn.PUBLISH&&this.simulcastEnabled&&!this.pollSimulcastLayerInterval&&(this.pollSimulcastLayers(),this.pollSimulcastLayerInterval=this.startInterval(this.pollSimulcastLayers,5e3)),this.uploadStatsInterval||(this.uploadStats(),this.uploadStatsInterval=this.startInterval(this.uploadStats,1e4))}startInterval(C,P){return setInterval(C.bind(this),P)}getConnectionState(){var C;if(!this.peerConnection)return sr.NONE;const P=(C=this.peerConnection.connectionState)!==null&&C!==void 0?C:this.peerConnection.iceConnectionState;try{return Jp(P)}catch{return sr.IDLE}}pollSimulcastLayers(){var C;return Ql(this,void 0,void 0,(function*(){if(this.getConnectionState()===sr.CONNECTED){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();if(!P)return;P.forEach((H=>{var X;if(H.type==="outbound-rtp"){const te=((X=H.framesPerSecond)!==null&&X!==void 0?X:0)!==0;switch(H.rid){case"low":te!==this.simulcastState.low&&(this.simulcastState.low=te,this.analyticsTracker.trackEventNoSharedProps(new Da(this.token,this.traceId,H.rid,te)));break;case"mid":te!==this.simulcastState.mid&&(this.simulcastState.mid=te,this.analyticsTracker.trackEventNoSharedProps(new Da(this.token,this.traceId,H.rid,te)));break;case"hi":te!==this.simulcastState.hi&&(this.simulcastState.hi=te,this.analyticsTracker.trackEventNoSharedProps(new Da(this.token,this.traceId,H.rid,te)))}}}))}}))}flushStats(){var C;return Ql(this,void 0,void 0,(function*(){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();P&&(this.action===Fn.PUBLISH?this.uploadPublisherStats(P):this.action===Fn.SUBSCRIBE&&this.uploadSubscriberStats(P))}))}uploadStats(){var C;return Ql(this,void 0,void 0,(function*(){if(this.getConnectionState()===sr.CONNECTED){const P=yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats();if(!P)return;this.action===Fn.PUBLISH?this.uploadPublisherStats(P):this.action===Fn.SUBSCRIBE&&this.uploadSubscriberStats(P)}}))}uploadPublisherStats(C){var P,H;const X={audio:{},video:[],candidateStats:{}},te=new Map,ue=(Date.now()-this.connectionStartedTimestamp)/1e3,Ee=Object.assign({},this.multihostConfiguration),{seiWriteCnt:w,seiBytesWritten:h}=this.updateAndDiffSeiPublishStatsSinceLastUpdate((P=this.senderVideoTransformer)===null||P===void 0?void 0:P.getSenderStats());if(this.seiStats.seiWriteCnt+=w,this.seiStats.seiBytesWritten+=h,C.forEach((b=>{if(b.type==="outbound-rtp"){const k=C.get(b.remoteId),F=this.prevRemoteInboundStats.get(b.remoteId);switch(k&&this.prevRemoteInboundStats.set(k.id,k),b.kind){case"audio":X.audio=this.updateOutboundAudio(b),X.audio.remoteInbound=k,X.audio.prevRemoteInbound=F,X.audio.codec=te.get(b.codecId);break;case"video":X.video.push(Object.assign({},this.updateOutboundVideo(b),{remoteInbound:k,prevRemoteInbound:F,codec:te.get(b.codecId)}))}}b.type==="candidate-pair"&&b.nominated&&(X.candidateStats.candidatePair=b,X.candidateStats.localCandidate=C.get(b.localCandidateId),X.candidateStats.remoteCandidate=C.get(b.remoteCandidate)),b.type==="codec"&&te.set(b.id,b)})),X.video.forEach((b=>{var k,F;const{outbound:ie,prevOutbound:pe}=b;if(!ie)return;const ye=(F=(k=b.outbound)===null||k===void 0?void 0:k.rid)!==null&&F!==void 0?F:ke;this.updateNetworkQualityPublish(ye,this.vidNetworkQualityMap,ie,pe)})),X.audio.outbound){const b=(H=X.audio.outbound.rid)!==null&&H!==void 0?H:ke;this.updateNetworkQualityPublish(b,this.audioNetworkQualityMap,X.audio.outbound,X.audio.prevOutbound)}this.analyticsTracker.trackEventNoSharedProps(new Mu(this.token,this.traceId,this.sfuResource,X.audio.outbound,X.audio.remoteInbound,X.candidateStats,X.audio.codec,Ee,ue,this.sdpFeatures)),X.audio.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new ul(this.token,this.traceId,this.sfuResource,X.audio.outbound,X.audio.prevOutbound,X.audio.remoteInbound,X.audio.prevRemoteInbound,X.candidateStats,X.audio.codec,Ee,this.sdpFeatures)),X.video.forEach((b=>{this.analyticsTracker.trackEventNoSharedProps(new Ha(this.token,this.traceId,this.sfuResource,b.outbound,b.remoteInbound,X.candidateStats,b.codec,Ee,ue)),b.prevOutbound&&this.analyticsTracker.trackEventNoSharedProps(new ed(this.token,this.traceId,this.sfuResource,b.outbound,b.prevOutbound,b.remoteInbound,b.prevRemoteInbound,X.candidateStats,b.codec,Ee,this.seiStats.seiWriteCnt,this.seiStats.seiBytesWritten))}))}updateNetworkQualityPublish(C,P,H,X){var te,ue,Ee,w;let h=0;const b=ma.getNetworkQuality(),k=(te=H.packetsSent)!==null&&te!==void 0?te:0,F=(ue=H.nackCount)!==null&&ue!==void 0?ue:0;if(X)if(b===co.DOWN)P.set(C,co.DOWN);else{h=(F-((Ee=X?.nackCount)!==null&&Ee!==void 0?Ee:0))/(k-((w=X?.packetsSent)!==null&&w!==void 0?w:0));const ie=this.convertLostRatioToQuality(h);P.set(C,ie)}else P.set(C,b)}updateNetworkQualitySubscribe(C,P,H){var X,te,ue,Ee;let w=0;const h=ma.getNetworkQuality(),b=(X=P?.packetsReceived)!==null&&X!==void 0?X:0,k=(te=P?.nackCount)!==null&&te!==void 0?te:0;if(!P)return;const F=P.id;if(F)if(H)if(h===co.DOWN)C.set(F,co.DOWN);else{w=(k-((ue=H?.nackCount)!==null&&ue!==void 0?ue:0))/(b-((Ee=H?.packetsReceived)!==null&&Ee!==void 0?Ee:0));const ie=this.convertLostRatioToQuality(w);C.set(F,ie)}else C.set(F,h)}uploadSubscriberStats(C){var P,H;const X={audio:{},video:{},candidateStats:{}},te=new Map,ue=(Date.now()-this.connectionStartedTimestamp)/1e3,Ee=(P=this.jitterBufferMinDelayInMs)!==null&&P!==void 0?P:0,{seiReadCnt:w,seiBytesRead:h}=this.updateAndDiffSeiSubscribeStatsSinceLastUpdate((H=this.receiveVideoTransformer)===null||H===void 0?void 0:H.getReceiverStats());this.seiStats.seiReadCnt+=w,this.seiStats.seiBytesRead+=h,C.forEach((b=>{if(b.type==="inbound-rtp")switch(b.kind){case"audio":X.audio=this.updateInboundAudio(b),X.audio.codec=te.get(b.codecId),this.updateNetworkQualitySubscribe(this.audioNetworkQualityMap,X.audio.inbound,X.audio.prevInbound);break;case"video":X.video=this.updateInboundVideo(b),X.video.codec=te.get(b.codecId),this.updateNetworkQualitySubscribe(this.vidNetworkQualityMap,X.video.inbound,X.video.prevInbound)}b.type==="candidate-pair"&&b.nominated&&(X.candidateStats.candidatePair=b,X.candidateStats.localCandidate=C.get(b.localCandidateId),X.candidateStats.remoteCandidate=C.get(b.remoteCandidate)),b.type==="codec"&&te.set(b.id,b)})),this.analyticsTracker.trackEventNoSharedProps(new jo(this.token,this.traceId,this.identifier,this.sfuResource,X.audio.inbound,X.candidateStats,X.audio.codec,ue,this.sdpFeatures)),X.audio.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new Zg(this.token,this.traceId,this.identifier,this.sfuResource,X.audio.inbound,X.audio.prevInbound,X.candidateStats,X.audio.codec,this.sdpFeatures,Ee)),this.analyticsTracker.trackEventNoSharedProps(new to(this.token,this.traceId,this.identifier,this.sfuResource,X.video.inbound,X.candidateStats,X.video.codec,ue)),X.video.prevInbound&&this.analyticsTracker.trackEventNoSharedProps(new fc(this.token,this.traceId,this.identifier,this.sfuResource,X.video.inbound,X.video.prevInbound,X.candidateStats,X.video.codec,Ee,this.seiStats.seiReadCnt,this.seiStats.seiBytesRead))}updateAndDiffSeiSubscribeStatsSinceLastUpdate(C){const P=this.prevVideoReceiverTransformerStats;if(!C)return{seiReadCnt:P.seiReadCnt,seiBytesRead:P.seiBytesRead};const H=C.seiReadCnt-P.seiReadCnt,X=C.seiBytesRead-P.seiBytesRead;return this.prevVideoReceiverTransformerStats={seiReadCnt:C.seiReadCnt,seiBytesRead:C.seiBytesRead},{seiReadCnt:H,seiBytesRead:X}}updateAndDiffSeiPublishStatsSinceLastUpdate(C){const P=this.prevVideoSenderTransformerStats;if(!C)return{seiWriteCnt:P.seiWriteCnt,seiBytesWritten:P.seiBytesWritten};const H=C.seiWriteCnt-P.seiWriteCnt,X=C.seiBytesWritten-P.seiBytesWritten;return this.prevVideoSenderTransformerStats={seiWriteCnt:C.seiWriteCnt,seiBytesWritten:C.seiBytesWritten},{seiWriteCnt:H,seiBytesWritten:X}}updateOutboundAudio(C){const P=C,H=this.prevOutboundAudioStats,X=C.id===H?.id?H:void 0;return this.prevOutboundAudioStats=C,{outbound:P,prevOutbound:X}}updateInboundAudio(C){const P=C,H=this.prevInboundAudioStats,X=C.id===H?.id?H:void 0;return this.prevInboundAudioStats=C,{inbound:P,prevInbound:X}}updateInboundVideo(C){const P=C,H=this.prevInboundVideoStats.get(ke),X=C.id===H?.id?H:void 0;return this.prevInboundVideoStats.set(ke,C),{inbound:P,prevInbound:X}}updateOutboundVideo(C){const P=C,H=this.getPrevOutboundVideo(C),X=C.id===H?.id?H:void 0;return this.setPrevVideoStat(C),{outbound:P,prevOutbound:X}}getPrevOutboundVideo(C){return this.simulcastEnabled&&C.rid&&this.prevOutboundVideoStats.has(C.rid)?this.prevOutboundVideoStats.get(C.rid):!this.simulcastEnabled&&this.prevOutboundVideoStats.has(ke)?this.prevOutboundVideoStats.get(ke):void 0}setPrevVideoStat(C){this.simulcastEnabled&&C.rid?this.prevOutboundVideoStats.set(C.rid,C):this.simulcastEnabled||this.prevOutboundVideoStats.set(ke,C)}convertLostRatioToQuality(C){return C<=0?co.EXCELLENT:C<=.01?co.GOOD:C<=.03?co.NORMAL:C<=.1?co.POOR:co.DOWN}}class hg extends ur{constructor(C,P,H,X,te){super(Xn.MINUTE,C,P,!1),Object.assign(this.properties,{action:X?Fn.PUBLISH:Fn.SUBSCRIBE,is_publishing:X,minutes_logged:H,subscribed_number:te})}}class i0 extends ur{constructor(C){super(Xn.PUBLISH,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID})}}class s0 extends ur{constructor(C){super(Xn.UNPUBLISH,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID})}}class J0 extends ur{constructor(C){var P,H,X,te;super(Xn.SUBSCRIBE,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.subscribedId,subscribed_id:C.subscribedId,is_edp_connected:C.isEdpConnected,is_reassignment:C.isReassignment,node:(H=(P=C.preAttemptSfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.preAttemptSfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:""})}}class Y_ extends ur{constructor(C){super(Xn.UNSUBSCRIBE,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.unsubscribedId,unsubscribed_id:C.unsubscribedId})}}class a0 extends ur{constructor(C){var P,H,X,te;super(Xn.PUBLISH_STARTED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,options_duration:C.optionsDuration,post_duration:C.postDuration,remote_participant_id:C.token.participantID,time_to_candidate:C.timeToCandidate,total_duration:C.totalDuration,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",publish_retry_times:C.publishRetries,total_duration_with_retries:C.totalDurationWithRetries,protocol:C.protocol})}}class o0 extends ur{constructor(C){super(Xn.PUBLISH_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.PUBLISH,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,protocol:C.protocol})}}class e_ extends ur{constructor(C){super(Xn.PUBLISH_ENDED,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.PUBLISH,remote_participant_id:C.token.participantID,unpublish_successful:C.isUnpublishSuccessful,reason:C.reason,protocol:C.protocol})}}class X_ extends ur{constructor(C){var P,H,X,te;super(Xn.SUBSCRIBE_STARTED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,options_duration:C.optionsDuration,post_duration:C.postDuration,remote_participant_id:C.remoteParticipantId,time_to_candidate:C.timeToCandidate,total_duration:C.totalDuration,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_initial_state_publishing_count:C.edpInitialStatePublishingCount,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",total_duration_with_retries:C.totalDurationWithRetries,subscribe_retry_times:C.subscribeRetryTimes,is_reassignment:C.isReassignment,protocol:C.protocol})}}class dg extends ur{constructor(C){super(Xn.SUBSCRIBE_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,is_reassignment:C.isReassignment,protocol:C.protocol})}}class pg extends ur{constructor(C){super(Xn.SUBSCRIBE_ENDED,C.token,C.traceId,!0),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,unsubscribe_successful:C.isUnsubscribeSuccessful,reason:C.reason,protocol:C.protocol}),this.critical=!0}}class l0 extends ur{constructor(C){super(Xn.STATE_UPDATED,C.token,C.traceId,!1),Object.assign(this.properties,{audio_muted:C.isAudioMuted,is_disconnected:C.isDisconnected,is_publishing:C.isPublishing,other_participant_id:C.otherParticipantId,other_participant_user_id:C.otherParticipantUserId,video_stopped:C.isVideoStopped})}}class K_ extends ur{constructor(C){var P,H,X,te,ue;super(Xn.FIRST_FRAME,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.SUBSCRIBE,remote_participant_id:C.remoteParticipantId,edp_initial_connect_duration:C.edpInitialConnectDuration,edp_initial_connect_retry_times:C.edpInitialConnectRetries,edp_initial_state_duration:C.edpInitialStateDuration,edp_initial_state_publishing_count:C.edpInitialStatePublishingCount,edp_state_update_count:C.edpStateUpdateCount,sdp_exchange_duration:C.sdpExchangeDuration,sdp_exchange_transport:C.sdpExchangeTransport,set_remote_desc_duration:C.setRemoteDescDuration,peer_connection_duration:C.peerConnectionDuration,node:(H=(P=C.sfuResource)===null||P===void 0?void 0:P.node)!==null&&H!==void 0?H:"",cluster:(te=(X=C.sfuResource)===null||X===void 0?void 0:X.cluster)!==null&&te!==void 0?te:"",video_was_paused:C.videoWasPaused,first_frame_duration:C.firstFrameDuration,total_duration_with_retries:C.totalDurationWithRetries,subscribe_retry_times:C.subscribeRetryTimes,media_type:C.mediaType,configured_jitter_buffer_min_delay_ms:(ue=C.currentJitterBufferMinDelayInMs)!==null&&ue!==void 0?ue:0,protocol:C.protocol})}}class Jc extends ur{constructor(C){super(Xn.EDP_PONG,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol,edp_rtt:C.edpRttMs})}}class sd extends ur{constructor(C){super(Xn.JOIN,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint})}}class bp extends ur{constructor(C){super(Xn.JOIN_ATTEMPT,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint})}}class t_ extends ur{constructor(C){super(Xn.JOIN_ATTEMPT_FAILED,C.token,C.traceId,!1),Object.assign(this.properties,{action:Fn.JOIN,event_endpoint:C.eventEndpoint,whip_endpoint:C.whipEndpoint,code:C.code,message:C.message,fatal:C.fatal,nominal:C.nominal,connect_retry_times:C.retryCnt})}}class Z_ extends ur{constructor(C){super(Xn.EDP_DISCONNECTED,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol}),this.critical=!0}}class Sp extends ur{constructor(C){super(Xn.EDP_CONNECTED,C.token,C.traceId,!1),Object.assign(this.properties,{event_endpoint:C.eventEndpoint,protocol:C.protocol,connect_retry_times:C.numRetries}),this.critical=!0}}class fm{constructor(C,P,H){this.token=C,this.analyticsTracker=H,this.protocol="",this.connecting=!1,this.closing=!1,this.windowUnloading=!1,this.maxConnectRetries=6,this.connectionAttempts=0,this.latestSequenceNumber=0,this.nextConnectionAttemptId=0,this.connectTimeoutId=0,this.latestPingTimestamp=0,this.pingIntervalId=0,this.pongTimeoutId=0,this.pingIntervalMs=15e3,this.pongTimeoutMs=3e4,this.attemptConnect=Ee=>{this.latestSequenceNumber=0,this.traceId=Ee||Xs(),this.connectionAttempts++,this.trackJoinAttempt(this.connectionAttempts);const{topic:w,rawToken:h}=this.token;this.connecting=!0,this.closing=!1;try{const b=encodeURIComponent(this.traceId.value),k=`topic=${w}/publishers`,F=`traceid=${b}`,ie="error_over_ws=1",pe=`${this.addr}?${ie}&${k}&${F}`;this.socket=this.createWebSocket(pe,h),this.socket.onmessage=this.onMessage.bind(this),this.socket.onerror=this.onError.bind(this),this.socket.onclose=this.onClose.bind(this),this.socket.onopen=this.onOpen.bind(this),this.protocol=this.socket.protocol}catch(b){const k=b instanceof Error?b.message:void 0,F=this.createError(hn.EVENT_PLANE_WS_CREATE_FAILED,k);this.trackJoinFailed(F,this.getRetryCount()),this.emitter.emit(Ks,F)}},this.triggerSocketOpen=Ee=>{this.clearConnectionAttemptTimeouts();const w=this.getRetryCount();this.connectionAttempts=0,this.connecting=!1,this.trackJoinStarted(w),this.emitter.emit(Tu,{retryCnt:w,traceId:this.traceId,initialStageState:Ee}),this.pingIntervalId=window.setInterval(this.ping,this.pingIntervalMs)},this.ping=()=>{var Ee;if(this.logger.debug({msg:`${this.id}sending PING`}),!this.isSocketOpen()){const w=`${this.id} attempting to ping an unopened socket`;return this.logger.warn({msg:w}),void this.traceJoinOp(w)}this.latestPingTimestamp=performance.now(),this.pongTimeoutId===0&&(this.pongTimeoutId=window.setTimeout(this.pongTimedOut,this.pongTimeoutMs)),(Ee=this.socket)===null||Ee===void 0||Ee.send(JSON.stringify({type:"PING"}))},this.pongTimedOut=()=>{if(!this.isSocketOpen()){const w=`${this.id} attempting pong timeout on an unopened socket`;return this.logger.warn({msg:w}),void this.traceJoinOp(w)}this.logger.debug({msg:`${this.id} Pong timed out!`}),this.clearPingPongTracking();const Ee=this.createError(hn.EVENT_PLANE_PONG_TIMEOUT);this.emitter.emit(Ks,Ee)},this.beforeUnload=()=>{this.emitter.emit(si,"beforeunload"),this.windowUnloading=!0},this.sendSdpOffer=(Ee,w,h,b,k,F,ie,pe)=>{var ye;const Ae={type:"aws:ivs:SDP_OFFER",payload:{whipUrl:w,requestId:b,traceId:h,platform:"web",sdk:"1.27.0",whipVersion:Xc,content:Ee,contentType:"application/sdp"}};k&&(Ae.payload.forceNode=k),F&&(Ae.payload.assignmentToken=F),ie&&(Ae.payload.multiCodec=ie);const De=rh()===void 0,Fe=rh()||De;pe&&Fe&&(Ae.payload.initialLayerPref=gp(pe)),(ye=this.socket)===null||ye===void 0||ye.send(JSON.stringify(Ae))},this.checkNonFatalRetriesLimit=Ee=>{if(Ee.fatal||this.connectionAttempts<=this.maxConnectRetries)return Qn.ok(!0);this.logger.debug({msg:`${this.id} maximum non-fatal retries of ${this.maxConnectRetries} exceeded`});const w=this.createError(hn.JOIN_TIMED_OUT);return Qn.err(w)},this.getRetryCount=()=>Math.max(this.connectionAttempts-1,0),this.trackSocketError=Ee=>{this.connecting&&this.trackJoinFailed(Ee,this.getRetryCount()),this.analyticsTracker.trackError(Ee)},this.trackJoinEnded=()=>{this.analyticsTracker.trackEventNoSharedProps(new Z_({token:this.token,eventEndpoint:this.token.eventsURL,traceId:this.traceId,protocol:this.protocol}))},this.traceJoinOp=Ee=>{this.analyticsTracker.trackEventNoSharedProps(new Ao(this.token,this.traceId,Ee,Fn.JOIN))},this.logger=new wn(P,_e.SOCKET),this.emitter=new Jr.EventEmitter,this.traceId=Xs(),this.id=`[${Rs().value}] `;const X=zh("socketPingMs");X!==void 0&&(this.pingIntervalMs=X);const te=zh("socketPongMs");te!==void 0&&(this.pongTimeoutMs=te);const ue=zh("socketConnectMaxRetries");ue!==void 0&&(this.maxConnectRetries=ue),window.addEventListener("beforeunload",this.beforeUnload)}connect(C,P,H=!1){this.close(),this.logger.debug({msg:`${this.id}connecting to ${this.addr}`}),this.addr=C,this.traceId=P,H&&!this.connecting&&(window.clearTimeout(this.connectTimeoutId),this.connectTimeoutId=window.setTimeout(this.connectTimedOut.bind(this),12e3)),this.attemptConnect(P)}send(C){var P;this.logger.debug({msg:`${this.id}sending ${JSON.stringify(C)}`}),this.logger.debug({msg:`${this.id}isReady called`}),this.isSocketOpen()?(P=this.socket)===null||P===void 0||P.send(JSON.stringify(C)):this.logger.warn({msg:"Trying to send data over stage socket that is not ready"})}close(){this.logger.debug({msg:`${this.id}closing`});const C=this.connecting,P=this.isSocketOpen(),H=this.socket&&this.socket.readyState===this.socket.CLOSING,X=this.getRetryCount();if(this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.connectionAttempts=0,this.socket){if(this.cleanupWebSocket(),P&&this.isStateMessageReceived())this.trackJoinEnded(),this.emitter.emit(si,"intentional-close");else if(C&&!H){const te=this.createError(hn.OPERATION_ABORTED);this.trackJoinFailed(te,X),this.analyticsTracker.trackError(te),this.emitter.emit(Ks,te)}}}markSocketAsClosed(){this.closing=!0,this.connecting=!1}removeAllListeners(){window.removeEventListener("beforeunload",this.beforeUnload),this.emitter.removeAllListeners()}createWebSocket(C,P){return new WebSocket(C,P)}cleanupWebSocket(){this.socket&&(this.socket.close(),this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,this.socket.onopen=null,this.socket=void 0)}createError(C,P){return new Br(Object.assign({action:Fn.JOIN,traceId:this.traceId,token:this.token,location:"StageSocket.connection",tag:ve,details:P},C))}on(C,P){this.emitter.on(C,P)}off(C,P){this.emitter.off(C,P)}onMessage(C){this.logger.debug({msg:`${this.id}received message: ${C.data}`});try{const P=JSON.parse(C.data);switch(P.type){case"STAGE_STATE":case"aws:ivs:STAGE_STATE":{const H=P.payload.sequenceNumber;H>this.latestSequenceNumber&&(this.latestSequenceNumber===0&&this.connectTimeoutId>0?(this.triggerSocketOpen(P),window.setTimeout((()=>{this.emitter.emit(Ro,P)}))):this.emitter.emit(Ro,P),this.latestSequenceNumber=H);break}case"PONG":window.clearTimeout(this.pongTimeoutId),this.pongTimeoutId=0,this.analyticsTracker.trackEventNoSharedProps(new Jc({token:this.token,eventEndpoint:this.token.eventsURL,protocol:this.protocol,traceId:this.traceId,edpRttMs:performance.now()-this.latestPingTimestamp}));break;case"REFRESH":this.emitter.emit(Qp);break;case"aws:ivs:SDP_ANSWER":this.emitter.emit(As,P.payload);break;case"aws:ivs:DISCONNECT":this.emitter.emit(ei,P.payload);break;case"aws:ivs:REASSIGN":this.emitter.emit(Nc,P.payload);break;case"aws:ivs:INCOMPATIBLE_CODECS":this.emitter.emit(gi,P.payload);break;case"aws:ivs:SSU":this.emitter.emit(Wh,P.payload);break;case"aws:ivs:JOIN_ERROR":this.handleJoinError(P.payload);break;default:(0,zs.noop)()}}catch(P){this.logger.debug({msg:`onMessage JSON Parse error: ${P}`}),this.emitter.emit($h,P)}}onError(C){this.logger.debug({msg:`${this.id}error: ${JSON.stringify(C)}`})}onClose(C){if(this.logger.debug({msg:`${this.id} onClose triggered with code (closing = ${this.closing}, connecting = ${this.connecting})`}),this.clearPingPongTracking(),this.closing)return void(this.closing=!1);if(this.windowUnloading)return;const P=`code: ${C?.code}, reason: ${C?.reason}, wasClean: ${C?.wasClean}`;if(this.connecting){const X=this.createError(hn.EVENT_PLANE_WS_CLOSE_BEFORE_OPEN,P);return void this.handleSocketError(X)}this.logger.debug({msg:`${this.id}unexpected close`}),this.emitter.emit(si,"unknown");const H=this.createError(hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE,P);this.trackJoinEnded(),this.emitter.emit(Ks,H)}onOpen(){this.logger.debug({msg:`${this.id} socket opened`}),this.clearConnectionAttemptTimeouts(),this.connectTimeoutId=window.setTimeout(this.triggerSocketOpen,12e3)}clearConnectionAttemptTimeouts(){window.clearTimeout(this.nextConnectionAttemptId),window.clearTimeout(this.connectTimeoutId),this.nextConnectionAttemptId=0,this.connectTimeoutId=0}clearConnectionAttempts(){this.connectionAttempts=0}connectTimedOut(){this.connecting=!1,this.logger.debug({msg:`${this.id} Connect timed out!`});const C=this.createError(hn.JOIN_TIMED_OUT);this.isSocketConnecting()&&this.trackJoinFailed(C,this.getRetryCount()),this.emitter.emit(Ks,C),this.close()}clearPingPongTracking(){window.clearInterval(this.pingIntervalId),window.clearTimeout(this.pongTimeoutId),this.pingIntervalId=0,this.pongTimeoutId=0}handleJoinError(C){const P=(function(X){var te,ue;let Ee;switch(X.code){case Rl.TOKEN_EXPIRED:Ee=hn.EXPIRED_TOKEN;break;case Rl.TOKEN_INVALID:case Rl.TOKEN_INVALID_SIGNATURE:case Rl.TOKEN_MISSING:Ee=hn.MALFORMED_TOKEN;break;case Rl.STAGE_DELETED:Ee=hn.STAGE_DELETED;break;case Rl.PARTICIPANT_DISCONNECTED:Ee=hn.PARTICIPANT_DISCONNECTED;break;case Rl.INTERNAL:Ee=hn.JOIN_SERVER_INTERNAL_ERROR;break;case Rl.BAD_REQUEST:Ee=hn.JOIN_SERVER_BAD_REQUEST;break;default:Ee=Object.assign(Object.assign({},hn.JOIN_FAILURE),{message:X.message||hn.JOIN_FAILURE.message})}return Object.assign(Object.assign({},Ee),{fatal:(te=X.fatal)!==null&&te!==void 0?te:Ee.fatal,nominal:(ue=X.nominal)!==null&&ue!==void 0?ue:Ee.nominal})})(C),H=this.createError(P,`JOIN_ERROR: ${C.code}`);this.logger.debug({msg:`${this.id} received JOIN_ERROR: ${JSON.stringify(C)}`}),this.handleSocketError(H)}handleSocketError(C){const P=this.checkNonFatalRetriesLimit(C);let H=C;P.ok||(H=P.error,H.details=`Timeout triggered by ${C.code}`),this.trackSocketError(H),this.markSocketAsClosed(),this.clearPingPongTracking(),this.clearConnectionAttemptTimeouts(),this.cleanupWebSocket(),H.fatal?(this.clearConnectionAttempts(),this.emitter.emit(Ks,H)):this.queueExponentialBackoffRetry()}queueExponentialBackoffRetry(){let C=Math.pow(2,this.connectionAttempts-1);C>32&&(C=32),this.logger.debug({msg:`${this.id} reconnecting in ${C} seconds`}),window.clearTimeout(this.nextConnectionAttemptId),this.nextConnectionAttemptId=window.setTimeout(this.attemptConnect,1e3*C)}isSocketConnecting(){return this.socket&&this.socket.readyState===this.socket.CONNECTING}isSocketOpen(){return this.socket&&this.socket.readyState===this.socket.OPEN}isStateMessageReceived(){return this.latestSequenceNumber!==0}trackJoinStarted(C){this.analyticsTracker.trackEventNoSharedProps(new Sp({token:this.token,eventEndpoint:this.token.eventsURL,numRetries:C,protocol:this.protocol,traceId:this.traceId}))}trackJoinAttempt(C){const{token:P,traceId:H}=this;this.analyticsTracker.trackEvent(new bp({token:P,eventEndpoint:P?.eventsURL||"",whipEndpoint:P?.whipURL||"",traceId:H}))}trackJoinFailed(C,P){const{token:H,traceId:X,code:te,message:ue,fatal:Ee,nominal:w}=C;this.analyticsTracker.trackEvent(new t_({token:H,eventEndpoint:H.eventsURL,whipEndpoint:H.whipURL,traceId:X,code:te,message:ue,fatal:Ee,nominal:w,retryCnt:P}))}}var Fd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},gh,Jl,Nu,Cs;(function(j){j.SDP_EXCHANGE="xdp",j.JITTER_BUFFER_MIN_DELAY_MS="jit_buf_min_delay_ms"})(gh||(gh={})),(function(j){j.USER_INITIATED="user-initiated",j.CLIENT_RECONNECT="reconnect",j.TOKEN_REUSED="token-reused",j.UNKNOWN="unknown",j.PARTICIPANT_DISCONNECTED="participant-disconnected",j.STAGE_DELETED="stage-deleted",j.TOKEN_EXPIRED="token-expired"})(Jl||(Jl={})),(function(j){j[j.NOT_CONNECTED=0]="NOT_CONNECTED",j[j.CONNECTION_LOST=1]="CONNECTION_LOST",j[j.TIMEDOUT=2]="TIMEDOUT",j[j.ABORTED=3]="ABORTED",j[j.INVALID_MESSAGE=4]="INVALID_MESSAGE",j[j.UNEXPECTED_ERROR=5]="UNEXPECTED_ERROR"})(Nu||(Nu={})),(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Cs||(Cs={}));class _h extends oc{constructor(C,P,H){super(),this.token=C,this.nonScopedLogger=P,this.analyticsTracker=H,this.participants=new Map,this.disconnected=[],this.state={value:Cs.DISCONNECTED,context:{connectStartTime:0,hasConnected:!1}},this.features={sdpExchange:!1},this.stats=this.resetStats(),this.stageMinutesLogged=0,this.isStagePublishing=!1,this.onConnecting=(X,te)=>{this.logger.debug({msg:"onConnecting",context:X,event:te}),X.connectStartTime=performance.now();const ue=te.type==="RECONNECT";ue&&this.stageSocket.close();const{eventsURL:Ee}=this.token;this.emit(dp,Cs.CONNECTING),this.state.value=Cs.CONNECTING;const w=!ue;this.stageSocket.connect(Ee,this.traceId,w)},this.onConnected=(X,te)=>{this.logger.debug({msg:"onConnected",context:X,event:te}),X.hasConnected=!0,this.emit(ag),this.emit(dp,Cs.CONNECTED),this.state.value=Cs.CONNECTED},this.onDisconnected=(X,te)=>{this.logger.debug({msg:"onDisconnected",context:X}),this.state.value=Cs.DISCONNECTED,this.stopStageMinuteLoggedInterval(!0),this.stageSocket.close(),X.hasConnected=!1,this.participants=new Map,this.disconnected=[],this.stageSocket.removeAllListeners(),this.resetStats(),this.emit(dp,Cs.DISCONNECTED,te)},this.onErrored=(X,te)=>{var ue;this.logger.error({msg:"Connection failure occurred",err:te.payload.error}),this.emit(dp,Cs.ERRORED),this.emit(wo,te.payload.error),this.state.value=Cs.ERRORED;const Ee=te.payload.error;if(Ee instanceof Br&&Ee.fatal&&(!((ue=Ee.details)===null||ue===void 0)&&ue.includes("JOIN_ERROR"))&&X.hasConnected){const w=this.mapJoinErrorCodeToDisconnectReason(Ee);this.processStateUpdate({type:"DISCONNECT",reason:w})}else X.hasConnected?this.processStateUpdate({type:"RECONNECT"}):this.stageSocket.close()},this.processStateUpdate=X=>{const te=this.state.value,ue=this.state.context;switch(te){case Cs.DISCONNECTED:X.type==="CONNECT"&&this.onConnecting(ue,X);break;case Cs.CONNECTING:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"?this.onDisconnected(ue,X.reason):X.type==="CONNECT_SUCCESS"?this.onConnected(ue,X):X.type==="ERROR"&&this.onErrored(ue,X);break;case Cs.CONNECTED:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"?this.onDisconnected(ue,X.reason):X.type==="ERROR"&&this.onErrored(ue,X);break;case Cs.ERRORED:X.type==="RECONNECT"?this.onConnecting(ue,X):X.type==="DISCONNECT"&&this.onDisconnected(ue,X.reason)}},this.measureConnect=(X,te)=>{const ue=this.stats.edpConnectCount,Ee=ue+1,w=performance.now(),h=w-te;return Object.assign(this.stats,{edpConnectCount:Ee,edpConnectDuration:h}),ue===0&&Object.assign(this.stats,{edpInitialStartConnectTime:te,edpInitialFinishConnectTime:w,edpInitialConnectDuration:h,edpInitialConnectRetries:X}),this.stats},this.measureStateUpdate=X=>{const{edpInitialFinishConnectTime:te}=this.stats,ue=this.stats.edpStateUpdateCount,Ee=ue+1;return Object.assign(this.stats,{edpStateUpdateCount:Ee}),ue===0&&Object.assign(this.stats,{edpInitialStateDuration:performance.now()-te,edpInitialStatePublishingCount:X}),this.stats},this.trackMessageParseError=X=>{this.logger.error({msg:"Message Parse Error occurred",err:X.err});const te=new Br({token:X.token,traceId:X.traceId,code:hn.WEBSOCKET_MESSAGE_PARSE_FAILURE.code,tag:X.tag,location:X.location,message:X.message,details:X.err.message});this.analyticsTracker.trackEvent(new Fs(te))},this.trackStageSocketMessageParseError=(X,te,ue)=>{this.trackMessageParseError({token:X,traceId:te,tag:ve,location:"StageConnection.onMessage",message:hn.WEBSOCKET_MESSAGE_PARSE_FAILURE.message,err:ue})},this.trackStageStateMessageParseError=(X,te,ue,Ee)=>{this.trackMessageParseError({token:X,traceId:te,tag:ve,location:"StageConnection.onStageStateMessage",message:Ee,err:ue})},this.onDisconnectMessage=X=>{this.analyticsTracker.trackEventNoSharedProps(new Ao(this.token,this.traceId,`DISCONNECT message received: ${X.code}:${X.reason}`,Fn.JOIN));let te=Jl.UNKNOWN;if(X.code==="PARTICIPANT_DISCONNECTED")te=Jl.PARTICIPANT_DISCONNECTED;else if(X.code==="STAGE_DELETED")te=Jl.STAGE_DELETED;else if(X.code==="TOKEN_REUSED"&&(te=Jl.TOKEN_REUSED,pa("disableTokenReuseMessage")))return void console.warn("Token reuse is detected, but skipping as feature is disabled");console.warn(`Disconnecting client due to: ${X.reason}`),this.processStateUpdate({type:"DISCONNECT",reason:te})},this.onReassignmentMessage=X=>{this.emit(Ia,X)},this.onIncompatibleCodecsMessage=X=>{this.emit(dh,X)},this.onSsuMessage=X=>{var te;const ue=window.atob((te=X.A)!==null&&te!==void 0?te:"").trim();ue&&ue.startsWith("http")?ma.currentEndpoint=ue:this.logger.warn({msg:"SSU Url invalid"})},this.onStageStateMessage=(X,te,ue)=>{var Ee,w;this.logger.debug({msg:"State Stage Message occurred",state:ue});const h=ue.payload,b=(Ee=h.participants)!==null&&Ee!==void 0?Ee:[],k=(w=h.disconnected)!==null&&w!==void 0?w:[],F=[],ie=[];this.measureStateUpdate(b.length),this.enableFeaturesBasedOnServerFeatures(h.serverFeatures||[]);const pe=(ye,Ae)=>{this.analyticsTracker.trackEventNoSharedProps(new l0({token:X,otherParticipantId:ye.id,otherParticipantUserId:ye.userId,isAudioMuted:ye.audioMuted,isVideoStopped:ye.videoStopped,isPublishing:ye.isPublishing,isDisconnected:Ae,traceId:te}))};this.participants.forEach((ye=>{const Ae=b.find((De=>De.id===ye.id));if(Ae){let De=!0,Fe=!1;["isPublishing","id","audioMuted","joinedAt","userId","videoStopped"].forEach((Ye=>{De=De&&Ae[Ye.toString()]===ye[Ye.toString()],De||(ye[Ye.toString()]=Ae[Ye.toString()],Fe=!0)})),Object.keys(ye.attributes).forEach((Ye=>{De=De&&Ae.attributes[Ye]===ye.attributes[Ye],De||(ye.attributes=Ae.attributes,Fe=!0)})),Fe&&(pe(ye,!1),this.emit(To,Ae))}else ie.push(ye)})),b.forEach((ye=>{this.participants.get(ye.id)||F.push(ye)})),ie.forEach((ye=>{this.participants.delete(ye.id),pe(ye,!0),this.emit(If,ye)})),F.forEach((ye=>{this.participants.set(ye.id,ye),pe(ye,!1),this.emit(Of,ye)})),k.forEach((ye=>{this.disconnected.find((Ae=>Ae.id===ye.id))||(this.disconnected.push(ye),ye.status==="KICKED"&&this.emit(og,ye))})),this.disconnected=k},this.nonScopedLogger=P,this.logger=new wn(P,_e.CONNECTION),this.stageSocket=new fm(C,this.nonScopedLogger,H),this.token=C,this.traceId=Xs()}resetStats(){return this.stats={isConnected:!1,edpInitialStartConnectTime:0,edpInitialFinishConnectTime:0,edpConnectCount:0,edpInitialConnectDuration:0,edpConnectDuration:0,edpInitialStateDuration:0,edpInitialStatePublishingCount:0,edpStateUpdateCount:0,edpInitialConnectRetries:0},this.stats}connect(C){return Fd(this,void 0,void 0,(function*(){return this.logger.debug({msg:"connect invoked",token:this.token,traceId:C}),this.traceId=C,this.state.value!==Cs.DISCONNECTED&&(this.logger.debug({msg:"Disconnecting previous connection"}),this.processStateUpdate({type:"DISCONNECT",reason:Jl.CLIENT_RECONNECT})),new Promise(((P,H)=>{this.stageSocket.on(Tu,(X=>{var te,ue;const{retryCnt:Ee,initialStageState:w}=X;w&&this.enableFeaturesBasedOnServerFeatures((ue=(te=w.payload)===null||te===void 0?void 0:te.serverFeatures)!==null&&ue!==void 0?ue:[]),this.traceId=X.traceId||Xs(),this.measureConnect(Ee,this.state.context.connectStartTime),this.processStateUpdate({type:"CONNECT_SUCCESS"}),this.startStageMinuteLoggedInterval(this.token,this.traceId),P(this.traceId)})),this.stageSocket.on(Ks,(X=>{H(X),this.processStateUpdate({type:"ERROR",payload:{error:X}})})),this.stageSocket.on(Qp,(()=>{this.logger.debug({msg:"Refresh event occurred"}),this.emit(ga),this.processStateUpdate({type:"RECONNECT"})})),this.stageSocket.on(Ro,(X=>this.onStageStateMessage(this.token,this.traceId,X))),this.stageSocket.on($h,(X=>this.trackStageSocketMessageParseError(this.token,this.traceId,X))),this.stageSocket.on(ei,this.onDisconnectMessage),this.stageSocket.on(Nc,this.onReassignmentMessage),this.stageSocket.on(gi,this.onIncompatibleCodecsMessage),this.stageSocket.on(Wh,this.onSsuMessage),this.stageSocket.on(si,(X=>{this.stopStageMinuteLoggedInterval()})),this.processStateUpdate({type:"CONNECT",payload:{token:this.token,traceId:C}})}))}))}disconnect(){return this.logger.debug({msg:"disconnect invoked"}),this.processStateUpdate({type:"DISCONNECT",reason:Jl.USER_INITIATED}),this.traceId}getParticipant(C){return this.participants.get(C)}listConnectedParticipants(){const C=[];return this.participants.forEach((P=>{P.subscribed&&C.push(P)})),C}listAvailableParticipants(){return Array.from(this.participants.values())}emitStageState(C,P){this.stageSocket.send({audioMuted:C,type:"SET_STATE",version:"0",videoStopped:P})}setStagePublishing(C){this.isStagePublishing=C,this.emit(Oc,this.isStagePublishing)}getIsStagePublishing(){return this.isStagePublishing}startStageMinuteLoggedInterval(C,P){this.uploadStageMinutesBroadcastInterval||(this.analyticsTracker.trackEvent(new hg(C,P,this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++,this.uploadStageMinutesBroadcastInterval=setInterval((()=>{this.analyticsTracker.trackEvent(new hg(C,P??Xs(),this.stageMinutesLogged,this.isStagePublishing,0)),this.stageMinutesLogged++}),6e4))}stopStageMinuteLoggedInterval(C=!1){this.uploadStageMinutesBroadcastInterval&&(clearInterval(this.uploadStageMinutesBroadcastInterval),this.uploadStageMinutesBroadcastInterval=void 0),C&&(this.stageMinutesLogged=0)}enableFeaturesBasedOnServerFeatures(C){const P=(ue,Ee)=>{this.trackStageStateMessageParseError(this.token,this.traceId,Ee,`Could not parse "${ue}" from the Eevee server features list`)},H=C.includes(gh.SDP_EXCHANGE);this.features.sdpExchange!==H&&(this.logger.debug({msg:`XDP SDP exchange feature toggled: ${H}`}),this.features.sdpExchange=H);const X=C.find((ue=>ue.indexOf(gh.JITTER_BUFFER_MIN_DELAY_MS)!==-1)),te=ue=>{this.logger.debug({msg:`jitterBufferMinDelay feature updated to: ${ue}`}),this.features.jitterBufferMinDelayInMs=ue};if(X!==void 0)try{const ue=X.split("=")[1],Ee=parseInt(ue,10);if(isNaN(Ee))throw new Error("Unable to parse - result is NaN");if(Ee<0)throw new Error("Unable to apply - result is negative");this.features.jitterBufferMinDelayInMs!==void 0&&this.features.jitterBufferMinDelayInMs===Ee||te(Ee)}catch(ue){P(X,ue),te(void 0)}else te(void 0)}mapJoinErrorCodeToDisconnectReason(C){switch(C.code){case hn.PARTICIPANT_DISCONNECTED.code:return Jl.PARTICIPANT_DISCONNECTED;case hn.STAGE_DELETED.code:return Jl.STAGE_DELETED;case hn.EXPIRED_TOKEN.code:return Jl.TOKEN_EXPIRED;default:return Jl.UNKNOWN}}isConnected(){return this.state.value===Cs.CONNECTED}supportsSdpExchange(){return this.features.sdpExchange}jitterBufferMinDelayInMs(){return this.features.jitterBufferMinDelayInMs}getConnectionStats(){return Object.assign({},this.stats,{isConnected:this.isConnected()})}exchangeSdp(C,P,H,X,te,ue,Ee,w,h){return Fd(this,void 0,void 0,(function*(){return this.isConnected()?new Promise(((b,k)=>{const F=window.setTimeout((()=>{ie(),k(Nu.TIMEDOUT)}),12e3),ie=()=>{window.clearTimeout(F),this.stageSocket.off(As,pe),this.stageSocket.off(Ks,ye)},pe=Ae=>{Ae.requestId===X&&(ie(),b(Ae))},ye=()=>{ie(),k(Nu.CONNECTION_LOST)};te?.addEventListener("abort",(()=>{ie(),k(Nu.ABORTED)})),this.stageSocket.on(As,pe),this.stageSocket.on(Ks,ye),this.stageSocket.sendSdpOffer(C,P,H,X,ue,Ee,w,h)})):Promise.reject(Nu.NOT_CONNECTED)}))}}class n_{constructor(C){this.token=C}}const qs=new RegExp("^(?:[a-z+]+:)?//","i");function dc(j){return qs.test(j)}function Lf({sdpExchangeTransport:j,serverHttpResponse:C,serverErrorCode:P}){return`sdpExchangeTransport: ${j}, serverHttpResponse: ${C}, serverErrorCode: ${P}`}var mg=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const Uf={[Nu.ABORTED]:hn.OPERATION_ABORTED,[Nu.NOT_CONNECTED]:hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE,[Nu.CONNECTION_LOST]:hn.XDP_CONNECTION_LOST,[Nu.TIMEDOUT]:hn.XDP_TIMEOUT,[Nu.INVALID_MESSAGE]:hn.XDP_INVALID_ANSWER_MSG,[Nu.UNEXPECTED_ERROR]:hn.XDP_UNEXPECTED_ERROR};class af extends n_{constructor(C,P,H,X){super(C),this.token=C,this.stageConnection=P,this.contextData=H,this.analyticsTracker=X}exchange(C){return mg(this,void 0,void 0,(function*(){const P=Rs(),{action:H}=this.contextData,{sdpOffer:X,url:te,traceId:ue,forceNode:Ee,assignmentToken:w,multiCodec:h,abortController:b,initialLayerPreference:k}=C;let F;this.trackAttempt(te,P,ue);try{F=yield this.stageConnection.exchangeSdp(X,te,ue.value,P.value,b?.signal,Ee,w,h,k)}catch(dt){if(typeof dt=="number")throw this.createClientSideErrorFromReasonCode(dt,ue,P,H)}if(!F)return;const{httpStatusCode:ie,errorCode:pe,location:ye,content:Ae,sessionDeleteLink:De,subscriberControlLink:Fe,videoLayersLink:Ye}=F;if(ie>=200&&ie<300)return{sdpAnswer:Ae,url:te,location:ye,sessionDeleteLink:De,mediaControls:Fe,layerControls:Ye};throw this.createServerSideError(ue,P,ie,pe,H)}))}trackAttempt(C,P,H){const{remoteParticipantId:X,action:te}=this.contextData;this.analyticsTracker.trackEventNoSharedProps(new Ii(te,this.token,C,"POST",P.value,X,H,"xdp"))}createServerSideError(C,P,H,X,te){const ue=this.baseErrorProps(C,P);let Ee=ho(H,X);return Ee||(Ee=hn.UNKNOWN_SERVER_ERROR),new Br(Object.assign(Object.assign(Object.assign({action:te},ue),Ee),{details:Lf({sdpExchangeTransport:"xdp",serverHttpResponse:H,serverErrorCode:X})}))}baseErrorProps(C,P){const{remoteParticipantId:H,action:X}=this.contextData;return{token:this.token,traceId:C,tag:On(X,H),location:"EdpSdpExchanger.exchange",requestUUID:P,remoteParticipantId:H}}createClientSideErrorFromReasonCode(C,P,H,X){const te=this.baseErrorProps(P,H),ue=Uf[C];return new Br(ue?Object.assign(Object.assign({action:X},te),ue):Object.assign(Object.assign({action:X},te),hn.XDP_INVALID_ANSWER_MSG))}getTransport(){return"sdp"}}var go=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class ad extends n_{constructor(C,P,H){super(C),this.contextData=P,this.analyticsTracker=H}exchange(C){var P,H,X;return go(this,void 0,void 0,(function*(){const te=Rs(),{token:ue}=this,{action:Ee,remoteParticipantId:w}=this.contextData,{sdpOffer:h,url:b,traceId:k,forceNode:F,assignmentToken:ie,multiCodec:pe,abortController:ye,initialLayerPreference:Ae}=C;try{const Fe="POST",Ye="http";this.analyticsTracker.trackEventNoSharedProps(new Ii(Ee,ue,b,Fe,te.value,w,k,Ye));const dt={data:h,headers:{Authorization:`Bearer ${ue.rawToken}`,"Content-Type":"application/sdp","X-Stages-Platform":"web","X-Stages-Request-ID":te.value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":k.value,"X-Stages-WHIP-Version":Xc,[xo]:(De=JSON.stringify({[wl]:["sau"]}),btoa(De).replace(/[^A-Za-z0-9+/]/g,""))},method:Fe,responseType:"text",url:b,signal:ye?.signal,params:{}};F&&(dt.params.force_node=F),ie&&(dt.params.assignment_token=ie),pe&&(dt.params.multi_codec=!0);const Et=rh()===void 0,Pt=rh()||Et;Ae&&dt.headers&&Pt&&(dt.headers["X-Stages-Initial-Layer-Pref"]=gp(Ae));const{data:bt,headers:gt,request:Ot}=yield ph(dt),wt=this.parseWhipResource(b,gt.location,gt.link);return{url:Ot.responseURL,sdpAnswer:bt,location:wt?.location,sessionDeleteLink:wt?.sessionDeleteLink,mediaControls:wt?.mediaControls,layerControls:wt?.layerControls}}catch(Fe){if(lc().isCancel(Fe))throw new Br(Object.assign(Object.assign({},fo(hn.OPERATION_ABORTED,Fe)),{action:Ee,token:ue,traceId:k,tag:On(Ee,w),location:"StagePeerClient.start",requestUUID:te,remoteParticipantId:w}));const Ye=Number((P=Fe?.response)===null||P===void 0?void 0:P.status)||-1,dt=((X=(H=Fe?.response)===null||H===void 0?void 0:H.data)===null||X===void 0?void 0:X.code)||-1,Et=(function(Pt,bt){var gt;return Pt instanceof zo.AxiosError&&Pt.response&&typeof Pt.response.status=="number"?Pt instanceof zo.AxiosError&&Pt.code==="ERR_NETWORK"?hn.NETWORK_FAILURE:ho(Number(Pt.response.status),(gt=Pt.response.data)===null||gt===void 0?void 0:gt.code)||bt:bt})(Fe,hn.WHIP_POST_FAILURE);throw new Br(Object.assign(Object.assign({},fo(Et,Fe)),{action:Ee,token:ue,traceId:k,tag:On(Ee,w),details:Lf({sdpExchangeTransport:"http",serverHttpResponse:Ye,serverErrorCode:dt}),location:"StagePeerClient.start",requestUUID:te,remoteParticipantId:w}))}var De}))}parseWhipResource(C,P,H){const X=new URL(C);let te;return te=(function(ue,Ee,w){if(!w)return ue;if(ue||(ue={}),dc(w))return ue.location=w,ue;const h=Ee.port?`:${Ee.port}`:"";return ue.location=`${Ee.protocol}//${Ee.hostname}${h}${w}`,ue})(te,X,P),te=(function(ue,Ee,w){if(!w)return ue;ue||(ue={});const h=ue;return w.split(",").forEach((b=>{const k=/<(.+)>;\s?rel="([a-z:-]+)"/.exec(b);if(k?.length!==3)return;let F;if(dc(k[1]))F=k[1];else{const ie=Ee.port?`:${Ee.port}`:"";F=`${Ee.protocol}//${Ee.hostname}${ie}${k[1]}`}switch(k[2]){case"urn:ietf:params:whip:ivs-stages:session-delete":h.sessionDeleteLink=F;break;case"urn:ietf:params:whep:core:playback-controls":h.mediaControls=F;break;case"urn:ietf:params:whep:ext:core:layer":h.layerControls=F;break;default:return}})),h})(te,X,H),te}getTransport(){return"http"}}function Bf(j){const{connection:C,token:P,action:H,identifier:X,tracker:te}=j,ue=C&&C.supportsSdpExchange()&&C.isConnected(),Ee=H===Fn.SUBSCRIBE&&ue&&!Wp()&&!pa("disableXdpSubscribe"),w=H===Fn.PUBLISH&&ue&&!Wp()&&!pa("disableXdpPublish");return Ee||w?new af(P,C,{action:H,remoteParticipantId:X},te):new ad(P,{action:H,remoteParticipantId:X},te)}function ro({stageErrorValue:j,action:C,token:P,traceId:H,tag:X,identifier:te,details:ue}){return new Br(Object.assign(Object.assign({},j),{token:P,traceId:H,location:"peer-client",tag:X,action:C,remoteParticipantId:te,details:ue}))}var Vo;function gg(j){var C;return!((C=j?.sender)===null||C===void 0)&&C.createEncodedStreams?Vo.INSERTABLE_STREAMS:window.RTCRtpSender&&"transform"in RTCRtpSender.prototype&&window.RTCRtpScriptTransform?Vo.ENCODED_TRANSFORMS:Vo.NONE}function eu(j){var C;return!((C=j?.receiver)===null||C===void 0)&&C.createEncodedStreams?Vo.INSERTABLE_STREAMS:window.RTCRtpReceiver&&"transform"in RTCRtpReceiver.prototype&&window.RTCRtpScriptTransform?Vo.ENCODED_TRANSFORMS:Vo.NONE}function zd(){return Mc()(`/*! For license information please see transform.worker.worker.js.LICENSE.txt */
(()=>{"use strict";const e=new Uint8Array([158,80,78,165,238,90,79,2,148,159,176,51,163,118,141,162]);var t;!function(e){e.VIDEO_SEND="video/send",e.VIDEO_RECEIVE="video/receive",e.INSERT_SEI="insertSei"}(t||(t={}));function n(t,n){const{transformerId:s,type:r,payloads:a}=n;let o=[];if("sei"===n.type){const{value:n,messages:s}=function(t,n){function s(e,t,n){return n+t.length<=e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function r(e,t){const n=function(e,t){return new Uint8Array([0,0,1,6,5,...t,...e])}(e,function(e){const t=[];for(;e>=255;)t.push(255),e-=255;return t.push(e),new Uint8Array(t)}(t.length+e.length)),s=function(e){const t=[...e];let n=3;for(;n<t.length-2;)0!==t[n]||0!==t[n+1]||0!==t[n+2]&&1!==t[n+2]&&2!==t[n+2]&&3!==t[n+2]?n+=1:(t.splice(n+2,0,3),n+=3);return t}(new Uint8Array([...n,...t,128]));return new Uint8Array(s)}function a(e,n){const r=function(e){const t=new DataView(e);for(let e=0;e<t.byteLength-4;e++)if(s(t,[0,0,1],e)){const n=31&t.getUint8(e+3);if(n>=1&&n<=5)return e}return-1}(t.data);if(r>=0){const e=new ArrayBuffer(t.data.byteLength+n.byteLength),s=new Uint8Array(e);return s.set(new Uint8Array(t.data.slice(0,r)),0),s.set(n,r),s.set(new Uint8Array(t.data.slice(r)),r+n.byteLength),e}return e}return function(){const s=[];for(let o=0;o<n.length;o+=1){const i=r(e,new Uint8Array(n[o]));t.data=a(t.data,i),s.push({uuid:e,payload:n[o]})}return{value:t,messages:s}}()}(t,a||[]);t=n,o=s}return{success:!0,frame:t,transformerId:s,type:r,seiResult:o}}const s=function(){let e=[];const t=new Map;return{add:({payload:t,repeatCount:n})=>(e.push({payload:t,repeatCount:n}),!0),poll(n){t.has(n)||t.set(n,[]),t.size>0&&(t.forEach((t=>{t.push(...e)})),e=[]);const s=t.get(n)||[],r=s.filter((e=>e.repeatCount>0)).map((e=>Object.assign(Object.assign({},e),{repeatCount:e.repeatCount-1})));return t.set(n,r),s}}}(),r=e=>(t,r)=>{try{const a=t.getMetadata().synchronizationSource,o=(s?s.poll(a):[]).map((e=>e.payload)),i=n(t,Object.assign(Object.assign({},e),{payloads:o}));r.enqueue(i.frame),self.postMessage(Object.assign({success:i.success,seiResult:i.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}},a=e=>(t,n)=>{try{const s=function(e,t){const{type:n,transformerId:s}=t;if("sei"===n){const t=function(e){function t(e,t,n){return n+t.length<e.byteLength&&t.every(((t,s)=>e.getUint8(n+s)===t))}function n(e){const t=[];let n=0;for(;n<e.length;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(t.push(e[n]),t.push(e[n+1]),n+=3):(t.push(e[n]),n+=1);return new Uint8Array(t)}function s(e){let t=2;const n=e.byteLength;for(;t<n;){let s=0;for(;t<n&&255===e[t];)s+=255,t++;s+=e[t],t++;const r=Math.min(t+s,n),a=new Uint8Array(e.slice(t,r));return{uuid:a.slice(0,16),payload:a.slice(16)}}}return{messages:function(e){const r=new DataView(e.data),a=[];let o=0;if(!t(r,[0,0,1],0)&&!t(r,[0,0,0,1],0))return[];for(;o<r.byteLength-5;)if(t(r,[0,0,1],o)){const i=o+3;o=i;const c=31&r.getUint8(o),u=31&r.getUint8(o+1);if(6===c&&5===u){for(;o<r.byteLength&&!t(r,[0,0,1],o);)o++;const c=o,u=s(n(new Uint8Array(e.data.slice(i,c))));u&&a.push(Object.assign({},u))}else o++}else o++;return a}(e),frame:e}}(e),{frame:r,messages:a}=t;return{success:!0,frame:r,type:n,transformerId:s,seiResult:a}}return{success:!0,frame:e,transformerId:s,type:n}}(t,e);n.enqueue(s.frame),self.postMessage(Object.assign({success:s.success,seiResult:s.seiResult},e))}catch(t){self.postMessage(Object.assign({success:!1},e))}};function o(e,t,n,s){const o=new TransformStream({transform:"video/send"===e?r(t):a(t)});n.pipeThrough(o).pipeTo(s)}const i=self;i.addEventListener("message",(function(e){var n,r,a;if(!(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.operation)||!(null===(r=null==e?void 0:e.data)||void 0===r?void 0:r.transformerId))return;const{operation:i,transformerId:c}=e.data;switch(i){case t.VIDEO_SEND:case t.VIDEO_RECEIVE:o(i,{method:i,transformerId:c,type:"sei"},e.data.readable,e.data.writable);break;case t.INSERT_SEI:s.add({payload:e.data.payload,repeatCount:null!==(a=e.data.repeatCount)&&void 0!==a?a:0})}})),i.addEventListener("rtctransform",(function(e){const t=e.transformer;if(!t)return;o(t.options.method,t.options,t.readable,t.writable)}))})();`,"Worker",void 0,void 0)}(function(j){j.NONE="none",j.ENCODED_TRANSFORMS="encodedTransforms",j.INSERTABLE_STREAMS="insertableStreams"})(Vo||(Vo={}));const ml=(()=>{const j={};return{getWorker:C=>(j[C]||(j[C]=new zd),j[C]),destroy:C=>{var P;(P=j[C])===null||P===void 0||P.terminate(),j[C]=void 0}}})();var sa;(function(j){j.NOT_PUBLISHING_VIDEO="NOT_PUBLISHING_VIDEO",j.INBAND_MESSAGING_NOT_ENABLED="INBAND_MESSAGING_NOT_ENABLED",j.INVALID_REPEAT_COUNT="INVALID_REPEAT_COUNT",j.PAYLOAD_SIZE_INVALID="PAYLOAD_SIZE_INVALID",j.PAYLOAD_RATE_EXCEEDED="PAYLOAD_RATE_EXCEEDED",j.INVALID_TRACK_TYPE="INVALID_TRACK_TYPE"})(sa||(sa={}));class Q_{constructor(C){this.maxFramerate=C,this.queued=[]}validateMessagePayload(C,P){if(C.byteLength<=0)return Qn.err(sa.PAYLOAD_SIZE_INVALID);if(P<0||P>30)return Qn.err(sa.INVALID_REPEAT_COUNT);if(C.byteLength>1024)return Qn.err(sa.PAYLOAD_SIZE_INVALID);this.queued=this.trimPastPayloads(this.queued,1e3);const{before:H,after:X}=this.getPayloadSums(this.queued);if(H+C.byteLength>10240||X+C.byteLength*Math.max(1,P)>10240)return Qn.err(sa.PAYLOAD_RATE_EXCEEDED);if(this.queued.push({byteLength:C.byteLength,timestamp:Date.now()}),P>0){const te=1e3/this.maxFramerate;let ue=Date.now()+te;for(let Ee=0;Ee<P;Ee+=1)this.queued.push({byteLength:C.byteLength,timestamp:ue}),ue+=te}return Qn.ok(!0)}trimPastPayloads(C,P){const H=Date.now()-P;return C.filter((X=>X.timestamp>H))}getPayloadSums(C){const P=Date.now();return C.reduce(((H,X)=>{const{before:te,after:ue}=H;return X.timestamp<=P?{before:te+X.byteLength,after:ue}:{before:te,after:ue+X.byteLength}}),{before:0,after:0})}}const Ff="seiMessageReceived",Sr="error";var wr;(function(j){j.CREATED="created",j.INITIALIZED="initialized",j.DESTROYED="destroyed"})(wr||(wr={}));class pc extends oc{constructor(C){super(),this.sessionId=C,this.state=wr.CREATED,this.transformerId=Rs().value,this.prevResultWasError=!1,this.consecutiveErrorResults=0,this.seiReadCnt=0,this.seiBytesRead=0,this.onMessage=P=>{this.onTransformResult(P.data)}}initializeInsertableStreams(C){var P,H;this.worker=ml.getWorker(this.sessionId);const X=C.receiver.createEncodedStreams(),{readable:te,writable:ue}=X;(P=this.worker)===null||P===void 0||P.postMessage({operation:"video/receive",transformerId:this.transformerId,readable:te,writable:ue},[te,ue]),(H=this.worker)===null||H===void 0||H.addEventListener("message",this.onMessage)}initializeEncodedTransforms(C){var P;this.worker=ml.getWorker(this.sessionId);const H={method:"video/receive",type:"sei",transformerId:this.transformerId};C.receiver.transform=new RTCRtpScriptTransform(this.worker,H),(P=this.worker)===null||P===void 0||P.addEventListener("message",this.onMessage)}initialize(C,P){if(this.state!==wr.CREATED)return!1;const H=eu(C);if(H===Vo.NONE)return!1;if(P&&H===Vo.INSERTABLE_STREAMS)this.initializeInsertableStreams(C);else{if(P||H!==Vo.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(C)}return this.transceiver=C,this.state=wr.INITIALIZED,!0}onTransceiverAdd(C){return this.initialize(C,!0)}onTrackEvent(C){return C.track.kind==="video"&&this.initialize(C.transceiver,!1)}static isSupported(C){return eu(C)!==Vo.NONE}onTransformResult(C){return C.transformerId===this.transformerId&&(C.success?(this.prevResultWasError=!1,this.consecutiveErrorResults=0,!!C.seiResult&&(C.seiResult.forEach((P=>{const{payload:H,uuid:X}=P;this.updateReadStats(P),this.emit(Ff,{uuid:X,payload:H})})),C.seiResult.length>0)):(this.prevResultWasError&&this.consecutiveErrorResults++,this.consecutiveErrorResults>=300&&this.onError(C,hn.TRANSFORM_TOO_MANY_ERRORS),this.prevResultWasError=!0,this.onError(C,hn.TRANSFORM_UNEXPECTED_ERROR),!1))}updateReadStats(C){this.seiReadCnt++,this.seiBytesRead+=C.payload.byteLength}getReceiverStats(){const{seiBytesRead:C,seiReadCnt:P}=this;return{seiReadCnt:P,seiBytesRead:C}}onError(C,P){const{type:H}=C;this.emit(Sr,{type:H,stageErrorValue:P})}destroy(){var C,P;this.state!==wr.DESTROYED&&(this.removeAllListeners(),(C=this.worker)===null||C===void 0||C.removeEventListener("message",this.onMessage),!((P=this.transceiver)===null||P===void 0)&&P.receiver&&(this.transceiver.receiver.transform=null),this.state=wr.DESTROYED)}getState(){return this.state}}class Li{constructor(C){this.sessionId=C,this.state=wr.CREATED,this.transformerId=Rs().value,this.seiWriteCnt=0,this.seiBytesWritten=0,this.onMessage=P=>{this.onTransformResult(P.data)}}initializeInsertableStreams(C,P){var H,X;this.worker=ml.getWorker(this.sessionId);const te=C.sender.createEncodedStreams(),{readable:ue,writable:Ee}=te;(H=this.worker)===null||H===void 0||H.postMessage({operation:"video/send",transformerId:this.transformerId,readable:ue,writable:Ee},[ue,Ee]),(X=this.worker)===null||X===void 0||X.addEventListener("message",this.onMessage)}initializeEncodedTransforms(C,P){var H;this.worker=ml.getWorker(this.sessionId);const X={method:"video/send",type:"sei",transformerId:this.transformerId,encodingLayers:P};C.sender.transform=new RTCRtpScriptTransform(this.worker,X),(H=this.worker)===null||H===void 0||H.addEventListener("message",this.onMessage)}initialize(C){var P;if(this.state!==wr.CREATED)return!1;const H=gg(C);if(H===Vo.NONE)return!1;const X=C.sender.getParameters(),te=((P=X?.encodings)===null||P===void 0?void 0:P.length)||1;if(H===Vo.INSERTABLE_STREAMS)this.initializeInsertableStreams(C,te);else{if(H!==Vo.ENCODED_TRANSFORMS)return!1;this.initializeEncodedTransforms(C,te)}return this.transceiver=C,this.state=wr.INITIALIZED,!0}static isSupported(C){return gg(C)!==Vo.NONE}sendSeiMessage(C,P){var H;return this.state===wr.INITIALIZED&&this.transceiver?((H=this.worker)===null||H===void 0||H.postMessage({operation:"insertSei",transformerId:this.transformerId,payload:C,repeatCount:P}),Qn.ok(!0)):Qn.err(sa.NOT_PUBLISHING_VIDEO)}onTransceiverAdd(C){return this.initialize(C)}onTrackEvent(C){return!1}onTransformResult(C){return C.transformerId===this.transformerId&&(C.success&&this.updateSendStats(C),C.success)}updateSendStats(C){C.seiResult&&C.seiResult.forEach((P=>{this.seiWriteCnt++,this.seiBytesWritten+=P.payload.byteLength}))}getSenderStats(){const{seiBytesWritten:C,seiWriteCnt:P}=this;return{seiWriteCnt:P,seiBytesWritten:C}}destroy(){var C;this.state!==wr.DESTROYED&&(!((C=this.transceiver)===null||C===void 0)&&C.receiver&&(this.transceiver.receiver.transform=null),this.state=wr.DESTROYED)}getState(){return this.state}}class aa extends ur{constructor(C,P,H,X,te,ue,Ee,w,h){super(Xn.SELECTED_PAIR_CHANGE,P,H,!1),Object.assign(this.properties,{action:C,protocol:X,local_type:te,local_addr:ue,remote_addr:Ee,local_candidate_priority:w,remote_participant_id:h})}}var wa=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};let Va=null;class ys extends oc{constructor(C,P,H,X,te,ue,Ee,w,h){var b;if(super(),this.analyticsTracker=ue,this.subscribeConfig=h,this.sfuResource={node:"",cluster:""},this.protocol="",this.incompatibleCodecs=new Set,this.connect=({audioOnly:k=!1,traceId:F,iceRestartOptions:ie})=>wa(this,void 0,void 0,(function*(){const{token:pe,tag:ye,identifier:Ae,action:De}=this,Fe=!!ie,Ye=new AbortController;let dt,Et,Pt;this.abortController=Ye,this.traceId=F,this.protocol="",this.perfTracker.resetMeasurements(F);const bt=()=>{dt&&this.off(ns,dt),Et&&this.off(So,Et)},gt=new Promise(((Ot,wt)=>{const It=(function({action:Gt,token:$t,traceId:dn,tag:Rn,identifier:Nn}){const qn=Gt===Fn.SUBSCRIBE?hn.SUBSCRIBE_TIMED_OUT:hn.PUBLISH_TIMED_OUT;return new Br(Object.assign(Object.assign({},qn),{action:Gt,token:$t,traceId:dn,tag:Rn,location:"connect",remoteParticipantId:Nn}))})({action:De,token:pe,traceId:F,tag:ye,identifier:Ae}),Ft=(function({action:Gt,token:$t,traceId:dn,tag:Rn}){const Nn=hn.OPERATION_ABORTED;return new Br(Object.assign(Object.assign({},Nn),{token:$t,traceId:dn,location:"peer-client.connect",tag:Rn,action:Gt}))})({action:De,token:pe,traceId:F,tag:ye}),Zt=setTimeout((()=>{this.stop(),this.analyticsTracker.trackError(It),wt(It)}),1e4);dt=Gt=>{clearTimeout(Zt),Fe||this.stop(),wt(Gt)},Et=Gt=>{if(Gt===sr.CONNECTED)clearTimeout(Zt),Ot();else if(Gt===sr.FAILED){const $t=(function({action:dn,token:Rn,traceId:Nn,tag:qn}){return new Br(Object.assign(Object.assign({},hn.PEER_CONNECTION_NETWORK_FAILURE),{token:Rn,traceId:Nn,location:"peer-client.connect",tag:qn,action:dn}))})({action:De,token:pe,traceId:F,tag:ye});clearTimeout(Zt),wt($t)}},this.on(ns,dt),this.on(So,Et),Pt=()=>{clearTimeout(Zt)},Ye.signal.aborted&&(clearTimeout(Zt),wt(Ft)),Ye.signal.addEventListener("abort",(()=>{clearTimeout(Zt),wt(Ft)}))}));try{const Ot=yield Promise.all([wa(this,void 0,void 0,(function*(){Fe||(yield this.start(),this.mediaStream=yield this.initializePeerConnection(k));const It=ie?.assignmentToken,Ft=ie?.nodeOverride;return yield this.exchangeSdp({iceRestart:Fe,nodeOverride:Ft,assignmentToken:It,abortController:Ye}),this.mediaStream})),gt]);this.statsReporter.traceId=F;const wt=Ot[0];if(this.abortController=void 0,!Fe&&De===Fn.PUBLISH)try{yield this.verifyOrUpdateTransceiverSync()}catch(It){this.logger.error({err:It,msg:"error syncing transceivers"})}return{mediaStream:wt}}catch(Ot){throw Pt&&Pt(),Ot}finally{bt()}})),this.disconnect=(k=!1)=>wa(this,void 0,void 0,(function*(){var F;const{token:ie,action:pe}=this;(F=this.abortController)===null||F===void 0||F.abort(),this.stop(),this.protocol="",k?this.cleanup(pe,ie.participantID,ie,k):yield this.cleanup(pe,ie.participantID,ie,k)})),this.resetTransformers=()=>{var k,F;(k=this.videoSenderTransformer)===null||k===void 0||k.destroy(),this.videoSenderTransformer=this.createVideoSenderTransformer(),(F=this.videoReceiverTransformer)===null||F===void 0||F.destroy(),this.videoReceiverTransformer=this.createVideoReceiverTransformer(),this.statsReporter.resetTransformers(this.videoReceiverTransformer,this.videoSenderTransformer)},this.onTrack=k=>{var F,ie;const{token:pe,action:ye,traceId:Ae,identifier:De}=this;this.trace(pe,Ae,`onTrack: ${k.track.kind}`,ye,De),this.sendInBandMessagingEnabled&&((F=this.videoSenderTransformer)===null||F===void 0||F.onTrackEvent(k)),this.receiveInBandMessagingEnabled&&((ie=this.videoReceiverTransformer)===null||ie===void 0||ie.onTrackEvent(k))},this.onIceGatheringStateChange=()=>{var k,F,ie;const{token:pe,action:ye,traceId:Ae,identifier:De}=this;if(((k=this.peerConnection)===null||k===void 0?void 0:k.iceGatheringState)==="gathering"?this.perfTracker.markIceGatheringStart():((F=this.peerConnection)===null||F===void 0?void 0:F.iceGatheringState)==="complete"&&this.perfTracker.markIceGatheringStop(),this.peerConnection){const Fe=this.peerConnection.iceGatheringState,Ye=new Zu(ye,pe,Ae,Fe,De);this.analyticsTracker.trackEventNoSharedProps(Ye)}this.trace(pe,Ae,`ICE gathering state change: ${(ie=this.peerConnection)===null||ie===void 0?void 0:ie.iceGatheringState}`,ye,De)},this.onSelectedCandidatePairChange=()=>{var k,F,ie,pe,ye,Ae,De,Fe,Ye,dt,Et,Pt,bt,gt;const{token:Ot,action:wt,traceId:It,identifier:Ft}=this,Zt=(F=(k=this.peerConnection)===null||k===void 0?void 0:k.getReceivers()[0].transport)===null||F===void 0?void 0:F.iceTransport,Gt=Zt?.getSelectedCandidatePair();if(Gt){const{local:$t,remote:dn}=Gt,Rn=`Selected candidate pair change (local, remote): ${$t?.candidate}, ${dn?.candidate}`;this.logger.debug({msg:Rn});const Nn=new aa(wt,Ot,It,(pe=(ie=Gt.local)===null||ie===void 0?void 0:ie.protocol)!==null&&pe!==void 0?pe:"",(Ae=(ye=Gt.local)===null||ye===void 0?void 0:ye.type)!==null&&Ae!==void 0?Ae:"",(Fe=(De=Gt.local)===null||De===void 0?void 0:De.address)!==null&&Fe!==void 0?Fe:"",(dt=(Ye=Gt.remote)===null||Ye===void 0?void 0:Ye.address)!==null&&dt!==void 0?dt:"",(Pt=(Et=Gt.local)===null||Et===void 0?void 0:Et.priority)!==null&&Pt!==void 0?Pt:0,Ft);this.analyticsTracker.trackEvent(Nn),this.protocol=(gt=(bt=Gt.local)===null||bt===void 0?void 0:bt.protocol)!==null&&gt!==void 0?gt:""}},this.onIceCandidate=k=>wa(this,void 0,void 0,(function*(){var F,ie;const{identifier:pe,action:ye,traceId:Ae}=this,De=(F=k.target.localDescription)===null||F===void 0?void 0:F.sdp.includes("relay");this.analyticsTracker.trackEventNoSharedProps(new Ao(this.token,Ae,`ice candidate: hasRelay = ${De}, candidate = ${(ie=k.candidate)===null||ie===void 0?void 0:ie.candidate}`,ye,pe))})),this.onMute=()=>wa(this,void 0,void 0,(function*(){const{token:k,action:F,traceId:ie,identifier:pe}=this;this.trace(k,ie,"Track has muted",F,pe)})),this.onUnMute=()=>wa(this,void 0,void 0,(function*(){const{token:k,action:F,traceId:ie,identifier:pe}=this;this.trace(k,ie,"Track has unmuted",F,pe)})),this.fetchAndSetRemoteDescription=k=>wa(this,void 0,void 0,(function*(){var F,ie,pe,ye;const Ae=(ie=(F=this.peerConnection)===null||F===void 0?void 0:F.localDescription)===null||ie===void 0?void 0:ie.sdp;Ae||this.logger.warn({msg:"Unexpected state: No SDP offer when attempting to fetch remote description"});const{token:De,traceId:Fe,action:Ye,identifier:dt,tag:Et}=this,{endpointURL:Pt,nodeOverride:bt,assignmentToken:gt,multiCodec:Ot,abortController:wt}=k;let It;this.perfTracker.markPostStart(),this.perfTracker.markSdpExchangeStart();try{const dn=Bf({connection:this.stageConnection,action:Ye,token:De,identifier:this.identifier,tracker:this.analyticsTracker});this.perfTracker.setTransport(dn.getTransport());const Rn=bt||da("node")||da("dataPlaneEndpoint");It=yield dn.exchange({sdpOffer:Ae,url:Pt,traceId:Fe,forceNode:Rn,assignmentToken:gt,multiCodec:Ot,abortController:wt,initialLayerPreference:(pe=this.simulcastSubscribeConfig)===null||pe===void 0?void 0:pe.initialLayerPreference})}catch(dn){let Rn=dn;Rn instanceof Br||(Rn=new Br(Object.assign(Object.assign({},hn.UNEXPECTED_ERROR),{action:Ye,token:De,traceId:Fe,tag:Et,details:dn instanceof Error?dn.message:"",location:"sdp-exchange"}))),Rn instanceof Br&&(this.analyticsTracker.trackError(Rn),this.emit(ns,Rn))}if(this.perfTracker.markSdpExchangeStop(),!It)return;const{location:Ft,sessionDeleteLink:Zt,mediaControls:Gt}=It;let $t=It.sdpAnswer;try{$t=this.mungeSdpAnswer($t),It.sdpAnswer=$t}catch(dn){this.logger.error({err:dn,msg:"Error while attempting to munge SDP, keeping original answer"})}this.statsReporter.sdpAnswer=$t,this.emit(wf,It),Ft&&(this.whipResource={location:Ft,sessionDeleteLink:Zt,mediaControls:Gt},this.sfuResource=(function(dn){const Rn=dn.match(/https:\/\/([^/]+)\//);if(Rn){const Nn=Rn[1].split(".");if(Nn[0].includes("video-rtx"))return{node:`${Nn[0]}.${Nn[1]}`,cluster:Nn[1]}}})(Ft)||{node:"",cluster:""},this.statsReporter.updateSfuResource(this.sfuResource));try{this.perfTracker.markSetRemoteDescStart(),yield(ye=this.peerConnection)===null||ye===void 0?void 0:ye.setRemoteDescription({sdp:$t,type:"answer"}),this.perfTracker.markSetRemoteDescStop(),this.perfTracker.markPostStop()}catch(dn){const Rn=new Br(Object.assign(Object.assign({},hn.SET_ANSWER_FAILURE),{action:Ye,token:De,traceId:Fe,tag:On(Ye,dt),location:"setRemoteDescription",remoteParticipantId:dt,details:dn instanceof Error?dn.message:""}));this.analyticsTracker.trackError(Rn),this.emit(ns,Rn)}})),this.cleanup=(k,F,ie,pe=!1)=>wa(this,void 0,void 0,(function*(){var ye,Ae,De;const Fe=Rs();if(this.toggleStageConnectionListeners(!1),this.currentJitterBufferMinDelayInMs=void 0,this.stageConnection=void 0,this.closeFailedPeerConnections(),!(!((ye=this.whipResource)===null||ye===void 0)&&ye.location))return this.trace(ie,this.traceId,"whipResource location not known, exiting cleanup",k,F),void this.analyticsTracker.trackError(new Br(Object.assign(Object.assign({},hn.WHIP_URL_MISSING),{action:k,token:ie,traceId:this.traceId,tag:On(k,F),location:k===Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})));let Ye=this.whipResource.location;if(this.trace(ie,this.traceId,`use hostnamecachedurl: ${Ye}`,k,F),pe){if(!((De=this.whipResource)===null||De===void 0)&&De.sessionDeleteLink){Ye=this.whipResource.sessionDeleteLink,this.trace(ie,this.traceId,`DELETE via session-delete beacon path: ${Ye}`,k,F);try{navigator.sendBeacon(Ye,JSON.stringify({authorization:ie.rawToken}))}catch(dt){this.analyticsTracker.trackErrorAndThrow(new Br(Object.assign(Object.assign({},fo(hn.WHIP_DELETE_FAILURE,dt)),{action:k,token:ie,traceId:this.traceId,tag:On(k,F),location:Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})))}}}else try{yield lc().delete(Ye,{headers:{Authorization:`Bearer ${ie.rawToken}`,"X-Stages-Platform":"web","X-Stages-Request-ID":Fe.value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":this.traceId.value,"X-Stages-WHIP-Version":Xc}})}catch(dt){((Ae=dt.response)===null||Ae===void 0?void 0:Ae.status)===404?this.trace(ie,this.traceId,`DELETE returned 404, ignoring, action = ${k}, uuid = ${Fe.value}`,k,F):this.analyticsTracker.trackErrorAndThrow(new Br(Object.assign(Object.assign({},fo(hn.WHIP_DELETE_FAILURE,dt)),{action:k,token:ie,traceId:this.traceId,tag:On(k,F),location:Fn.SUBSCRIBE?"unsubscribe":"unpublish",requestUUID:Fe,remoteParticipantId:F})))}})),this.getConnectionState=()=>{if(!this.peerConnection)return sr.NONE;const k=this.peerConnection.connectionState||this.peerConnection.iceConnectionState;try{return Jp(k)}catch{return this.logger.warn({msg:"Unhandled connection state:",rawState:k}),sr.IDLE}},this.onIceCandidateError=k=>{const{token:F,traceId:ie,tag:pe}=this;if(k.errorCode!==701){const ye=new Br(Object.assign(Object.assign({},hn.ICE_CANDIDATE_ERROR),{action:this.action,token:F,traceId:ie,tag:pe,location:"onIceCandidateError",remoteParticipantId:this.identifier}));this.analyticsTracker.trackError(ye),this.emit(ns,ye)}},this.onIceConnectionStateChange=()=>{var k,F;const{token:ie,traceId:pe,action:ye,identifier:Ae}=this;this.trace(ie,pe,`ICE connection state change: ${(k=this.peerConnection)===null||k===void 0?void 0:k.iceConnectionState}`,ye,Ae),((F=this.peerConnection)===null||F===void 0?void 0:F.iceConnectionState)==="checking"&&this.peerConnection.getTransceivers().forEach((({receiver:De,sender:Fe})=>{[De,Fe].forEach((Ye=>{var dt,Et;(Et=(dt=Ye?.transport)===null||dt===void 0?void 0:dt.iceTransport)===null||Et===void 0||Et.addEventListener("selectedcandidatepairchange",this.onSelectedCandidatePairChange)}))})),this.onConnectionStateChange()},this.createVideoSenderTransformer=()=>new Li(this.analyticsTracker.getSessionId()),this.createVideoReceiverTransformer=()=>{const k=new pc(this.analyticsTracker.getSessionId()),{token:F,tag:ie,identifier:pe,action:ye,traceId:Ae}=this;k.on(Ff,(Ye=>{this.emit(Ac,Ye)}));const De=(function(Ye,dt){let Et=0;return function(...Pt){const bt=Date.now();bt-Et>=dt&&(Et=bt,Ye(...Pt))}})((Ye=>{const dt=`Transform error occurred: ${Ye.type}`,Et=ro({traceId:Ae,token:F,tag:ie,identifier:pe,action:ye,details:dt,stageErrorValue:hn.TRANSFORM_UNEXPECTED_ERROR});this.logger.warn({err:Et,msg:"Error encountered when transforming receiver",error:Ye})}),1e3),Fe=Ye=>{const dt=`Too many errors occurred: ${Ye.type}`,Et=ro({traceId:Ae,token:F,tag:ie,identifier:pe,action:ye,details:dt,stageErrorValue:hn.TRANSFORM_TOO_MANY_ERRORS});this.logger.error({err:Et,msg:"Too many errors encountered when transforming receiver. Shutting down transformer.",error:Ye}),k.destroy(),this.analyticsTracker.trackError(Et),this.emit(lh,Et)};return k.on(Sr,(Ye=>{Ye.stageErrorValue.code!==hn.TRANSFORM_TOO_MANY_ERRORS.code?De(Ye):Fe(Ye)})),k},this.onConnectionStateChange=()=>{if(this.peerConnection){const F=this.peerConnection.connectionState||this.peerConnection.iceConnectionState,{token:ie,traceId:pe,identifier:ye,action:Ae}=this,De=new Xh(Ae,ie,pe,F,ye);this.analyticsTracker.trackEventNoSharedProps(De),this.trace(ie,pe,`connection state change: ${F}`,Ae,ye)}const k=this.getConnectionState();switch(k){case sr.CONNECTED:this.closeFailedPeerConnections(),this.perfTracker.markActionStop(),this.emit(So,k),this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream);break;case sr.FAILED:this.storeFailedPeerConnection(this.peerConnection),this.destroyPeerConnection({closeConnection:!1}),this.emit(So,k),this.handleConnectionFailure();break;default:this.emit(So,k)}},this.onIncompatibleCodecs=k=>wa(this,void 0,void 0,(function*(){if(k.forEach((pe=>{let ye=!1;this.incompatibleCodecs.forEach((Ae=>{Ae.config===pe.config&&Ae.mime===pe.mime&&(ye=!0)})),ye||this.incompatibleCodecs.add(pe)})),this.peerConnection)try{yield(F=this.peerConnection,ie=[...this.incompatibleCodecs],tm(void 0,void 0,void 0,(function*(){var pe;for(const ye of F.getSenders()){const Ae=ye.getParameters();if(Ae.codecs.length>1){const De=Ae.codecs[0];let Fe=!1;for(const Ye of ie)Kr(De,Ye)&&(Fe=!0);if(Fe){const Ye=fs(ie,Ae.codecs);(pe=Ae.encodings)===null||pe===void 0||pe.forEach((dt=>{dt.active&&(dt.codec=Ye)})),yield ye.setParameters(Ae)}}}})))}catch(pe){const{token:ye,action:Ae,traceId:De,identifier:Fe}=this,Ye=new Br(Object.assign(Object.assign({},hn.CODEC_HANDLE_INCOMPATIBLE_UNEXPECTED_ERROR),{action:Ae,token:ye,traceId:De,tag:On(Ae,Fe),location:"onIncompatibleCodecs",remoteParticipantId:Fe,details:pe instanceof Error?pe.message:""}));this.analyticsTracker.trackError(Ye),this.emit(ns,Ye)}var F,ie})),this.token=C,this.logger=new wn(P,_e.WEBRTC),this.action=H,this.tag=X,this.traceId=te,H===Fn.SUBSCRIBE&&!Ee)throw new Error("Subscribe action provided without subscriber Id");this.jitterBufferConfig=h?.jitterBuffer,this.simulcastSubscribeConfig=h?.simulcast,this.subscriberId=Ee,this.stageConnection=w,this.failedPeerConnections=[],this.receiveInBandMessagingEnabled=!!(!((b=this.subscribeConfig)===null||b===void 0)&&b.inBandMessaging.enabled),this.perfTracker=new pp(this.action,this.traceId),this.statsReporter=new fg(H,C,te,this.identifier,this.analyticsTracker),this.handlePublishingChangedBinding=this.handlePublishingChanged.bind(this),this.toggleStageConnectionListeners(!0)}get videoMediaId(){var C,P;return(P=(C=this.videoTransceiver)===null||C===void 0?void 0:C.mid)!==null&&P!==void 0?P:null}toggleStageConnectionListeners(C){var P,H;C?(P=this.stageConnection)===null||P===void 0||P.on(Oc,this.handlePublishingChangedBinding):(H=this.stageConnection)===null||H===void 0||H.off(Oc,this.handlePublishingChangedBinding)}updateSubscribeConfig(C){var P,H;if(this.jitterBufferConfig=C.jitterBuffer,this.simulcastSubscribeConfig=C.simulcast,this.action===Fn.SUBSCRIBE){const X=C.inBandMessaging.enabled;this.receiveInBandMessagingEnabled!==X&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for receiver"})}this.applyJitterBufferMinDelayConditionally((H=(P=this.stageConnection)===null||P===void 0?void 0:P.getIsStagePublishing())!==null&&H!==void 0&&H)}verifyOrUpdateTransceiverSync(){var C,P;return wa(this,void 0,void 0,(function*(){if(this.publishVideoStream){const H=this.getTransceiverForKind("video");H?this.publishVideoStream.track.id!==((C=H.sender.track)===null||C===void 0?void 0:C.id)&&(this.logger.debug({msg:"found out of sync video transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishVideoStream)):this.logger.warn({msg:"missing transceiver for video"})}if(this.publishAudioStream){const H=this.getTransceiverForKind("audio");H?this.publishAudioStream.track.id!==((P=H.sender.track)===null||P===void 0?void 0:P.id)&&(this.logger.debug({msg:"found out of sync audio transceiver... updating"}),yield this.replaceOrUpdateStream(this.publishAudioStream)):this.logger.warn({msg:"missing transceiver for audio"})}}))}start(){return wa(this,void 0,void 0,(function*(){const{token:C,action:P,traceId:H,identifier:X}=this;P!==Fn.PUBLISH||C.claims.capabilities.allow_publish||this.analyticsTracker.trackErrorAndThrow(new Br(Object.assign(Object.assign({},fo(hn.TOKEN_PERMISSIONS_DENIED,new Error("Cannot publish with subscribe only token"))),{action:P,token:C,traceId:H,tag:On(P,X),location:"StagePeerClient.start",remoteParticipantId:X})));const te=(function({action:ue,identifier:Ee,token:w,analyticsTracker:h}){let b="";const k=Md(w,h);switch(ue){case Fn.PUBLISH:b=k.getPublishEndpoint();break;case Fn.SUBSCRIBE:Ee&&(b=k.getSubscribeEndpoint(Ee))}return b})({action:P,identifier:X,token:C.rawToken,analyticsTracker:this.analyticsTracker});try{this.perfTracker.markActionStart(),this.endpointURL=te,this.createPeerConnection(),this.trace(C,H,"peer connection created",P,X)}catch(ue){const Ee=new Br(Object.assign(Object.assign({action:P},fo(hn.CREATE_PEER_CONNECTION_FAILURE,ue)),{token:C,traceId:H,tag:On(P,X),location:"StagePeerClient.start",remoteParticipantId:X}));P===Fn.PUBLISH&&this.emit(So,sr.FAILED),this.emit(ns,Ee),this.analyticsTracker.trackErrorAndThrow(Ee)}}))}mungeSdpOffer(C,P,H){if(H.simulcastEnabled&&(C=new xi(C).withVideoLayersAllocationRtpHeaderExtension().sdp),P===Fn.SUBSCRIBE)C=new xi(C).withOpusAudioConfig(Fr(Mo),!0).sdp;else if(P===Fn.PUBLISH&&H.audioConfig){const{maxBitrateBps:X,stereo:te}=H.audioConfig;C=new xi(C).withOpusAudioConfig(X,te).sdp}return C}mungeSdpAnswer(C){_p.browser.isFirefox()&&this.publishAudioStream&&this.action===Fn.PUBLISH&&(C=new xi(C).withOpusAudioConfig(this.publishAudioStream.config.maxBitrateBps,void 0).sdp);const P=_p.browser.isChrome()||_p.browser.isEdge();this.action===Fn.SUBSCRIBE&&P&&(C=new xi(C).withoutAudioRtcpRSize().sdp);const H=(function(){const X=da("subscribeForceIceProtocol");if(X==="tcp"||X==="udp")return X})();return this.action===Fn.SUBSCRIBE&&H&&(C=new xi(C).withFilteredCandidates(H).sdp),C}createPeerConnection(){var C;this.logger.debug({msg:"setting up peer connection"}),this.peerConnection&&(this.logger.debug({msg:"peer connection is already established, cleaning up previous connection"}),this.destroyPeerConnection({closeConnection:!1})),this.peerConnection=new RTCPeerConnection({iceTransportPolicy:"all"}),this.statsReporter.start(this.peerConnection,(C=this.publishVideoStream)===null||C===void 0?void 0:C.config.simulcastEnabled),this.peerConnection.addEventListener("connectionstatechange",this.onConnectionStateChange),this.peerConnection.addEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),this.peerConnection.addEventListener("icecandidateerror",this.onIceCandidateError),this.peerConnection.addEventListener("icegatheringstatechange",this.onIceGatheringStateChange),this.peerConnection.addEventListener("icecandidate",this.onIceCandidate),this.peerConnection.addEventListener("track",this.onTrack),this.peerConnection.addEventListener("mute",this.onMute),this.peerConnection.addEventListener("unmute",this.onUnMute)}destroyPeerConnection(C){var P,H,X,te,ue,Ee,w,h,b;this.statsReporter.stop(),(P=this.peerConnection)===null||P===void 0||P.removeEventListener("connectionstatechange",this.onConnectionStateChange),(H=this.peerConnection)===null||H===void 0||H.removeEventListener("iceconnectionstatechange",this.onIceConnectionStateChange),(X=this.peerConnection)===null||X===void 0||X.removeEventListener("icecandidateerror",this.onIceCandidateError),(te=this.peerConnection)===null||te===void 0||te.removeEventListener("icegatheringstatechange",this.onIceGatheringStateChange),(ue=this.peerConnection)===null||ue===void 0||ue.removeEventListener("icecandidate",this.onIceCandidate),(Ee=this.peerConnection)===null||Ee===void 0||Ee.removeEventListener("track",this.onTrack),(w=this.peerConnection)===null||w===void 0||w.removeEventListener("mute",this.onMute),(h=this.peerConnection)===null||h===void 0||h.removeEventListener("unmute",this.onUnMute),(C.closeConnection||this.action===Fn.PUBLISH)&&((b=this.peerConnection)===null||b===void 0||b.close()),this.peerConnection=void 0}closeFailedPeerConnections(){for(const C of this.failedPeerConnections)C?.close();this.failedPeerConnections=[]}storeFailedPeerConnection(C){C&&this.action!==Fn.PUBLISH&&this.failedPeerConnections.push(C)}stop(){var C,P;(C=this.videoReceiverTransformer)===null||C===void 0||C.destroy(),(P=this.videoSenderTransformer)===null||P===void 0||P.destroy(),this.destroyPeerConnection({closeConnection:!0})}getTransceiverForKind(C){if(!this.peerConnection)return;const P=this.peerConnection.getTransceivers();return C==="audio"?P.find((H=>H.mid==="0")):C==="video"?P.find((H=>H.mid==="1")):void 0}removeTrack(C){return wa(this,void 0,void 0,(function*(){if(C==="audio"||C==="video")if(this.peerConnection)try{const P=this.getTransceiverForKind(C);if(!P)return void this.logger.warn({msg:`tried removing track type ${C} but couldn't find transceiver`});yield P.sender.replaceTrack(null),C===Qu.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0,yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(P){this.logger.warn({msg:"error replacing track",err:P})}else C===Qu.AUDIO?this.publishAudioStream=void 0:this.publishVideoStream=void 0;else this.logger.warn({msg:"RemoveTrack called with invalid track type",trackType:C})}))}replaceOrUpdateStream(C){return wa(this,void 0,void 0,(function*(){if(C.track){if(Lc(C)?this.publishAudioStream=C:om(C)&&(this.publishVideoStream=C),this.peerConnection)try{const P=this.getTransceiverForKind(C.track.kind);if(!P)return void this.logger.warn({msg:`tried replacing track type ${C.track.kind} but couldn't find transceiver`,track:C.track});if(om(C)){const H=P.sender.getParameters(),X=C.config.encodingLayers;H.encodings=H.encodings.map((te=>{var ue;const Ee=(ue=te.rid)!==null&&ue!==void 0?ue:"",w=X.find((h=>{var b;return((b=h.rid)!==null&&b!==void 0?b:"")===Ee}));return w?Object.assign(Object.assign({},te),w):te})),yield P.sender.setParameters(H)}else if(Lc(C)){const H=P.sender.getParameters(),X=mp(C)[0];H.encodings=H.encodings.map((te=>Object.assign(Object.assign({},te),X))),yield P.sender.setParameters(H)}yield P.sender.replaceTrack(C.track),yield this.statsReporter.updateMultihostConfiguration(this.publishAudioStream,this.publishVideoStream)}catch(P){this.logger.warn({msg:"error replacing track",err:P})}}else this.logger.warn({msg:"Unexpected call to replaceOrUpdateStream with no track"})}))}initializePeerConnection(C=!1){var P,H,X,te,ue,Ee,w,h;return wa(this,void 0,void 0,(function*(){const{traceId:b,token:k,action:F,identifier:ie}=this;Af(this.peerConnection),this.resetTransformers();let pe=new MediaStream;if(F===Fn.PUBLISH){this.publishAudioStream||(this.publishAudioStream={track:this.getSilentAudio(),config:{maxBitrateBps:Fr(nf),stereo:!1}});const ye=this.peerConnection.getTransceivers(),Ae=[];ye.forEach((bt=>{var gt;Ae.concat((gt=bt.sender.track)===null||gt===void 0?void 0:gt.id)})),pe=new MediaStream([this.publishAudioStream.track,(P=this.publishVideoStream)===null||P===void 0?void 0:P.track].filter((bt=>!!bt&&!Ae.includes(bt.id))));const De=pe.getAudioTracks()[0]||"audio",Fe=pe.getVideoTracks()[0]||"video",Ye={direction:"sendonly",streams:[pe],sendEncodings:mp(this.publishAudioStream)},dt={direction:"sendrecv",streams:[pe],sendEncodings:(H=this.publishVideoStream)===null||H===void 0?void 0:H.config.encodingLayers};this.peerConnection.addTransceiver(De,Ye),this.trace(k,b,`track added, type: ${De.kind||De}`,F,ie);const Et=this.peerConnection.addTransceiver(Fe,dt);this.trace(k,b,`track added, type: ${Fe.kind||Fe}`,F,ie);const Pt=!!(!((te=(X=this.publishVideoStream)===null||X===void 0?void 0:X.config)===null||te===void 0)&&te.inBandMessagingEnabled);this.sendInBandMessagingEnabled===void 0?this.sendInBandMessagingEnabled=Pt:this.sendInBandMessagingEnabled!==Pt&&this.logger.warn({msg:"Cannot mutate in-band messaging config value for sender"}),this.sendInBandMessagingEnabled&&!Li.isSupported(Et)?this.handleTransformNotSupported():this.sendInBandMessagingEnabled&&((ue=this.videoSenderTransformer)===null||ue===void 0||ue.onTransceiverAdd(Et))}else F===Fn.SUBSCRIBE&&(k.shouldSendSilentAudio()?this.peerConnection.addTransceiver(this.getSilentAudio(),{direction:"sendrecv"}):this.peerConnection.addTransceiver("audio",{direction:"recvonly"}),this.trace(k,b,"track added, type: audio",F,ie),C||(this.videoTransceiver=this.peerConnection.addTransceiver("video",{direction:"recvonly"}),this.trace(k,b,"track added, type: video",F,ie),this.receiveInBandMessagingEnabled&&!pc.isSupported(this.videoTransceiver)?this.handleTransformNotSupported():this.receiveInBandMessagingEnabled&&((Ee=this.videoReceiverTransformer)===null||Ee===void 0||Ee.onTransceiverAdd(this.videoTransceiver))),this.peerConnection.getTransceivers().forEach((ye=>{ye.receiver?(this.logger.info({msg:"dbg: Subscribe succeeded, adding media track to participant mediaStream"}),pe?.addTrack(ye.receiver.track)):this.logger.info({msg:"dbg: Subscribe succeeded, but Transceiver were negotiated without Receiver"})})),this.applyJitterBufferMinDelayConditionally((h=(w=this.stageConnection)===null||w===void 0?void 0:w.getIsStagePublishing())!==null&&h!==void 0&&h));return pe}))}handlePublishingChanged(C){this.logger.debug({msg:`[handlePublishingChanged (${this.subscriberId})] isStagePublishing: ${C}, currentMinDelay: ${this.currentJitterBufferMinDelayInMs}`}),this.action===Fn.SUBSCRIBE&&this.applyJitterBufferMinDelayConditionally(C)}applyJitterBufferMinDelayConditionally(C){const P=this.currentJitterBufferMinDelayInMs,H=this.calcJitterBufferMinDelay(C,this.jitterBufferConfig);if(C){if(P===void 0||P>H){const X=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is publishing and min delay is unset or > configured; attempting to update to ${H}`;this.logger.debug({msg:X}),this.trace(this.token,this.traceId,X,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(H)}}else if(P===void 0||H!==P){const X=`[applyJitterBufferMinDelayConditionally (${this.subscriberId})] participant is subscribe-only and min delay is unset or != configured; attempting to update to ${H}`;this.logger.debug({msg:X}),this.trace(this.token,this.traceId,X,this.action,this.identifier),this.applyAndTrackJitterBufferMinDelay(H)}}calcJitterBufferMinDelay(C,P){var H,X,te;let ue=0;if(!(()=>{const Ee=RTCRtpReceiver.prototype;return!(!Ee||typeof Ee!="object")&&("jitterBufferTarget"in Ee||"playoutDelayHint"in Ee)})())return 0;if(C)ue=um((H=P?.minDelayWhenPublishing)!==null&&H!==void 0?H:ol.DEFAULT,C);else{ue=um((X=P?.minDelayWhenSubscribeOnly)!==null&&X!==void 0?X:ol.DEFAULT,C);const Ee=(te=this.stageConnection)===null||te===void 0?void 0:te.jitterBufferMinDelayInMs();P?.minDelayWhenSubscribeOnly===ol.DEFAULT&&Ee!==void 0&&(ue=Ee,this.logger.debug({msg:`[calcJitterBufferMinDelay] overriding min delay with remote value: ${ue}`}))}return ue}applyAndTrackJitterBufferMinDelay(C){var P,H;this.currentJitterBufferMinDelayInMs=C,this.statsReporter.updateJitterBufferMinDelay(C),C!==void 0&&((H=(P=this.peerConnection)===null||P===void 0?void 0:P.getTransceivers())===null||H===void 0||H.forEach((X=>{X.receiver&&this.applyJitterBufferMinDelay(X.receiver,C)})))}applyJitterBufferMinDelay(C,P){let H="Unable to set jitter buffer min delay";if("jitterBufferTarget"in C)H=`setting jitterBufferTarget to: ${P} for track: ${C.track.kind}`,this.logger.debug({msg:H}),C.jitterBufferTarget=P;else if("playoutDelayHint"in C){const X=P/1e3;H=`setting playoutDelayHint to: ${P} for track: ${C.track.kind}`,this.logger.debug({msg:H}),C.playoutDelayHint=X}else this.logger.warn({msg:H});this.trace(this.token,this.traceId,H,this.action,this.identifier)}exchangeSdp(C){var P,H,X;return wa(this,void 0,void 0,(function*(){const{traceId:te,token:ue,action:Ee,identifier:w,tag:h,endpointURL:b}=this,{iceRestart:k=!1,nodeOverride:F,assignmentToken:ie,abortController:pe}=C;let ye;this.logger.debug({msg:`Exchanging SDP: ${te.value}, iceRestart=${k}, nodeOverride=${F}, assignmentToken=${ie}`}),Af(this.peerConnection),Ee===Fn.PUBLISH&&Yp()&&(this.logger.debug({msg:"Applying publisher codec preference for main profile."}),((De,Fe)=>{var Ye,dt;const Et=(Ye=RTCRtpReceiver.getCapabilities("video"))===null||Ye===void 0?void 0:Ye.codecs;if(!Et)return;let Pt=Et;Pt=rf(Et,"42e0"),Fe.preferMainProfile&&(Pt=rf(Et,"4d00")),(dt=De.getTransceivers().find((bt=>bt.receiver.track.kind==="video")))===null||dt===void 0||dt.setCodecPreferences(Pt)})(this.peerConnection,{preferMainProfile:Yp()}));try{this.trace(ue,te,"Creating offer",Ee,w),ye=yield this.peerConnection.createOffer({iceRestart:k})}catch(De){const Fe=new Br(Object.assign(Object.assign({},fo(hn.CREATE_OFFER_FAILURE,De)),{action:Ee,token:ue,traceId:te,tag:h,location:"exchangeSdp",remoteParticipantId:w}));this.emit(ns,Fe),this.analyticsTracker.trackErrorAndThrow(Fe)}ye.sdp&&(ye.sdp=this.mungeSdpOffer(ye.sdp,Ee,{simulcastEnabled:(H=(P=this.publishVideoStream)===null||P===void 0?void 0:P.config.simulcastEnabled)!==null&&H!==void 0&&H,audioConfig:(X=this.publishAudioStream)===null||X===void 0?void 0:X.config})),this.trace(ue,te,"Setting local description",Ee,w),yield this.peerConnection.setLocalDescription(ye),this.trace(ue,te,"local description set",Ee,w),b||this.logger.warn({msg:"Unexpected state: No endpointURL specified for fetching of remote description."});const Ae=Ee===Fn.PUBLISH&&Yp()||Ee===Fn.SUBSCRIBE&&pa("multiCodecAnswer");yield this.fetchAndSetRemoteDescription({endpointURL:b,nodeOverride:F,assignmentToken:ie,multiCodec:Ae,abortController:pe})}))}getReports(){var C;return wa(this,void 0,void 0,(function*(){try{const P=(yield(C=this.peerConnection)===null||C===void 0?void 0:C.getStats())||[],H=[];return P.forEach((X=>{H.push(X)})),H}catch{return[]}}))}requestRTCStats(C){return wa(this,void 0,void 0,(function*(){if(this.peerConnection)return this.statsReporter.getStats(C)}))}get identifier(){return this.subscriberId||this.token.participantID}handleTransformNotSupported(){const{token:C,tag:P,identifier:H,action:X,traceId:te}=this,ue=ro({traceId:te,token:C,tag:P,identifier:H,action:X,stageErrorValue:hn.TRANSFORM_NOT_SUPPORTED_BY_PLATFORM});this.logger.error({err:ue,msg:"Transforms not supported by this platform"}),this.analyticsTracker.trackError(ue),this.emit(lh,ue)}handleConnectionFailure(){return wa(this,void 0,void 0,(function*(){const{token:C,traceId:P,tag:H}=this;this.analyticsTracker.trackError(new Br(Object.assign(Object.assign({},hn.PEER_CONNECTION_NETWORK_FAILURE),{action:this.action,token:C,traceId:P,tag:H,location:"onIceCandidateError",remoteParticipantId:this.identifier})))}))}getSilentAudio(){Va||(Va=new AudioContext);const C=Va.createOscillator(),P=Va.createGain();C.connect(P);const H=Va.createMediaStreamDestination();return P.connect(H),P.gain.value=0,C.start(),H.stream.getAudioTracks()[0]}getActionMeasurements(){return this.perfTracker.getMeasurements()}getProtocol(){return this.protocol}initStreamsToPublish(C){this.publishVideoStream=C.find(om),this.publishAudioStream=C.find(Lc)}getSfuResource(){return this.sfuResource}getExpectedJitterBufferMinDelayInMs(){var C,P;return this.calcJitterBufferMinDelay((P=(C=this.stageConnection)===null||C===void 0?void 0:C.getIsStagePublishing())!==null&&P!==void 0&&P,this.jitterBufferConfig)}trace(C,P,H,X,te){this.analyticsTracker.trackEventNoSharedProps(new Ao(C,P,H,X,te))}sendSeiMessage(C,P){const H=this.getTransceiverForKind("video");return this.videoSenderTransformer&&this.sendInBandMessagingEnabled?this.action===Fn.PUBLISH&&H?this.videoSenderTransformer.sendSeiMessage(C,P):Qn.err(sa.NOT_PUBLISHING_VIDEO):Qn.err(sa.INBAND_MESSAGING_NOT_ENABLED)}}const Ga=Fn.SUBSCRIBE;class Il{constructor(C,P,H){this.analyticsTracker=C,this.token=P,this.remoteId=H,this.action=Ga}trackAttempt({stageConnectionStats:C,isReassignment:P=!1,traceIdOverride:H,preAttemptSfuResource:X}){const{action:te,analyticsTracker:ue,token:Ee,remoteId:w}=this,h=H||Xs();return ue.trackEvent(new J0({token:this.token,subscribedId:this.remoteId,traceId:h,isEdpConnected:C.isConnected,isReassignment:P,preAttemptSfuResource:X})),{getTraceId:()=>h,trackSubscribeStarted({totalDurationWithRetries:b,retryTimes:k,sfuResource:F,peerClientPerfStats:ie,protocol:pe}){const{optionsDuration:ye,postDuration:Ae,timeToCandidate:De,timeToConnected:Fe,sdpExchangeDuration:Ye,sdpExchangeTransport:dt,setRemoteDescDuration:Et,peerConnectionDuration:Pt}=ie,{edpInitialConnectDuration:bt,edpInitialConnectRetries:gt,edpInitialStateDuration:Ot,edpInitialStatePublishingCount:wt,edpStateUpdateCount:It}=C;ue.trackEvent(new X_({token:Ee,traceId:h,remoteParticipantId:w,optionsDuration:ye,postDuration:Ae,timeToCandidate:De,totalDuration:Fe,edpInitialConnectDuration:bt,edpInitialConnectRetries:gt,edpInitialStateDuration:Ot,edpInitialStatePublishingCount:wt,edpStateUpdateCount:It,sdpExchangeDuration:Ye,sdpExchangeTransport:dt,setRemoteDescDuration:Et,peerConnectionDuration:Pt,sfuResource:F,totalDurationWithRetries:b,subscribeRetryTimes:k,isReassignment:P,protocol:pe}))},trackSubscribeFirstFrame:({peerClientPerfStats:b,totalDurationWithRetries:k,sfuResource:F,retryTimes:ie,currentJitterBufferMinDelayInMs:pe,mediaType:ye,firstFrameDuration:Ae,protocol:De})=>{const{sdpExchangeDuration:Fe,sdpExchangeTransport:Ye,setRemoteDescDuration:dt,peerConnectionDuration:Et}=b,{edpInitialConnectDuration:Pt,edpInitialConnectRetries:bt,edpInitialStateDuration:gt,edpInitialStatePublishingCount:Ot,edpStateUpdateCount:wt}=C;this.analyticsTracker.trackEvent(new K_({token:this.token,traceId:h,remoteParticipantId:w,edpInitialConnectDuration:Pt,edpInitialConnectRetries:bt,edpInitialStateDuration:gt,edpInitialStatePublishingCount:Ot,edpStateUpdateCount:wt,sdpExchangeDuration:Fe,sdpExchangeTransport:Ye,setRemoteDescDuration:dt,peerConnectionDuration:Et,videoWasPaused:!1,firstFrameDuration:Ae,mediaType:ye,sfuResource:F,totalDurationWithRetries:k,subscribeRetryTimes:ie,currentJitterBufferMinDelayInMs:pe,protocol:De}))},trackSubscribeFailed(b,k,F){const ie=((Ae,De,Fe)=>{if(Ae instanceof Br)return Ae;let Ye="";return Ae instanceof zo.AxiosError&&(Ye+=`AxiosError - ${Ae.code}`),new Br(Object.assign(Object.assign(Object.assign({},hn.SUBSCRIBE_FAILURE),{action:Ga,token:De,traceId:Fe,tag:Ai,location:"subscribe",details:`${Ye} ${Ae?.message}`}),{fatal:!0}))})(b,Ee,h);ue.trackEvent(new dg({token:Ee,traceId:h,remoteParticipantId:w,code:ie.code,message:ie.message,fatal:ie.fatal,nominal:ie.nominal,isReassignment:P,protocol:k}));const{isConnected:pe}=C,ye=new Br(Object.assign(Object.assign({},hn.SUBSCRIBE_FAILURE),{action:te,token:Ee,traceId:h,tag:On(Fn.SUBSCRIBE,w),location:"subscribe",remoteParticipantId:w,isEdpConnected:pe,details:F}));return b instanceof Br&&(ye.fatal=b.fatal,ye.nominal=b.nominal,ye.location=`subscribe > ${b.location}`),ue.trackError(ye),ie},trackUnsubscribe:()=>{ue.trackEvent(new Y_({token:Ee,unsubscribedId:w,traceId:h}))},trackEndSucceeded:(b,k)=>{ue.trackEvent(new pg({token:Ee,traceId:h,remoteParticipantId:w,isUnsubscribeSuccessful:!0,reason:b,protocol:k}))},trackEndFailed:(b,k)=>{const F=new Br(Object.assign(Object.assign({},hn.UNSUBSCRIBE_FAILURE),{token:Ee,traceId:h,tag:On(Fn.SUBSCRIBE,w),location:"unsubscribe",remoteParticipantId:w}));return b!==Ei.UNLOAD&&b!==Ei.UNSUBSCRIBE||ue.trackError(F),ue.trackEvent(new pg({token:Ee,traceId:h,remoteParticipantId:w,isUnsubscribeSuccessful:!0,reason:b,protocol:k})),F}}}}class oa extends ur{constructor(C,P,H,X,te,ue){super(Xn.PLAYBACK_LAYER_REQUEST,C,P,!1),Object.assign(this.properties,{media_type:H,remote_participant_id:X,track_id:te,layer_id:ue})}}class Hr extends ur{constructor(C,P,H,X,te,ue=1){super(Xn.PLAYBACK_LAYER_STATE,C,P,!1),Object.assign(this.properties,{media_type:H,remote_participant_id:X,track_id:te,request_count:ue})}}var hs,Ra,tu,qi;(function(j){j.PAUSE="pause",j.PLAY="play"})(hs||(hs={})),(function(j){j.IDLE="idle",j.ACTIVE="active",j.ERRORED="errored",j.DESTROYED="destroyed"})(Ra||(Ra={})),(function(j){j.SUCCESS="success"})(tu||(tu={})),(function(j){j.FAILED="failed",j.DESTROYED="destroyed",j.THROTTLED="throttled"})(qi||(qi={}));var $a=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class of{constructor(C){this.state=Ra.IDLE,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null,this.stopVideo=()=>$a(this,void 0,void 0,(function*(){return this.state!==Ra.ACTIVE?(this.logCommandSkipped("stopVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(hs.PAUSE)})),this.startVideo=()=>$a(this,void 0,void 0,(function*(){return this.state!==Ra.ACTIVE?(this.logCommandSkipped("startVideo"),this.mapSkippedResultFromState(this.state)):this.sendPlaybackRequest(hs.PLAY)})),this.setLayer=P=>$a(this,void 0,void 0,(function*(){return this.state!==Ra.ACTIVE?(this.logCommandSkipped("setLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest(P)})),this.unsetLayer=()=>$a(this,void 0,void 0,(function*(){return this.state!==Ra.ACTIVE?(this.logCommandSkipped("unsetLayer"),this.mapSkippedResultFromState(this.state)):this.sendLayerRequest()})),this.getLayers=()=>$a(this,void 0,void 0,(function*(){return this.state!==Ra.ACTIVE?(this.logCommandSkipped("getLayers"),this.mapSkippedResultFromState(this.state)):this.sendLayerStateRequest()})),this.sendPlaybackRequest=P=>$a(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Qn.err)(qi.FAILED);if(!this.playbackEndpoint)return this.logger.warn({msg:"Playback endpoint is unset and required for playback control requests"}),(0,Qn.err)(qi.FAILED);this.logger.info({msg:`Sending ${P} request to ${this.playbackEndpoint}`});const H=P===hs.PAUSE?{pause:[this.mid]}:{play:[this.mid]},X=this.createPostWhepRequest(H);return fetch(this.playbackEndpoint,X).then((te=>{if(te.status>=300){const ue=new Error(`Error sending media controls request: ${te.status}:${te.statusText}`);return this.logger.error({err:ue}),(0,Qn.err)(qi.FAILED)}return this.logger.debug({msg:`Request to ${P} was successful: ${te.status}`}),(0,Qn.ok)(tu.SUCCESS)})).catch((te=>(this.logger.error({err:te,msg:"Error sending media controls request"}),(0,Qn.err)(qi.FAILED))))})),this.sendLayerRequest=P=>$a(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Qn.err)(qi.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Qn.err)(qi.FAILED);const H=typeof P=="string",X=H?{mediaId:this.mid,encodingId:P}:{},te=H?`set : ${P}`:"unset layer";this.logger.info({msg:`sendLayerRequest for ${te} at ${this.layersEndpoint}`});const ue=this.createPostWhepRequest(X);return this.trackLayerRequest(P??"auto"),fetch(this.layersEndpoint,ue).then((Ee=>this.state===Ra.DESTROYED?(0,Qn.err)(qi.DESTROYED):Ee.status>=300?this.handleLayerRequestError(Ee.status,Ee.statusText):(this.logger.debug({msg:`Request to ${te} was successful: ${Ee.status}`}),(0,Qn.ok)(tu.SUCCESS)))).catch((Ee=>this.handleLayerRequestError(0,Ee.message)))})),this.sendLayerStateRequest=()=>$a(this,void 0,void 0,(function*(){if(!this.mid)return this.logger.warn({msg:"mid is unexpectedly undefined"}),(0,Qn.err)(qi.FAILED);if(!this.layersEndpoint)return this.logger.warn({msg:"Layers endpoint is unset and required for layer requests"}),(0,Qn.err)(qi.FAILED);this.logger.info({msg:`sendLayerStateRequest for ${this.mid} at ${this.layersEndpoint}`});const P=this.createGetWhepRequest();return this.trackLayerStateRequest(),fetch(this.layersEndpoint,P).then((H=>$a(this,void 0,void 0,(function*(){var X;if(this.state===Ra.DESTROYED)return(0,Qn.err)(qi.DESTROYED);if(H.status>=300)return this.handleLayerStateRequestError(H.status,H.statusText);const te=yield H.json(),ue=(X=te?.layers)!==null&&X!==void 0?X:[],Ee=JSON.stringify(ue,null,2);return this.logger.debug({msg:`sendLayerStateRequest was successful: ${Ee}`}),(0,Qn.ok)(ue)})))).catch((H=>this.handleLayerStateRequestError(0,H.message)))})),this.logger=new wn(C.logger,_e.REMOTE_PLAYBACK),this.token=C.token,this.traceId=C.traceId,this.analyticsTracker=C.analyticsTracker,this.remoteParticipantId=C.remoteParticipantId}set mediaId(C){if(this.state!==Ra.DESTROYED){if(this.mid=C,this.mid===null)return this.logger.info({msg:"media id is unset, controller is transitioning to idle state"}),void(this.state=Ra.IDLE);(this.playbackEndpoint||this.layersEndpoint)&&(this.state=Ra.ACTIVE)}else this.logCommandSkipped("set mediaId")}set endpoints(C){var P,H;if(this.state!==Ra.DESTROYED){if(this.playbackEndpoint=(P=C.playback)!==null&&P!==void 0?P:null,this.layersEndpoint=(H=C.layers)!==null&&H!==void 0?H:null,!this.playbackEndpoint||!this.layersEndpoint){const X={playbackEndpoint:this.playbackEndpoint,layersEndpoint:this.layersEndpoint};return this.logger.info({msg:`no endpoints are set, transitioning to idle state: ${JSON.stringify(X,null)}`}),void(this.state=Ra.IDLE)}this.mid&&(this.state=Ra.ACTIVE)}else this.logCommandSkipped("set endpoints")}destroy(){this.state=Ra.DESTROYED,this.mid=null,this.playbackEndpoint=null,this.layersEndpoint=null}logCommandSkipped(C="command"){this.logger.info({msg:`skipping ${C}, controller state invalid: ${this.state}`})}mapSkippedResultFromState(C){return C===Ra.DESTROYED?(0,Qn.err)(qi.DESTROYED):(0,Qn.err)(qi.FAILED)}createPostWhepRequest(C){return{method:"POST",headers:this.createRequestHeaders(),body:JSON.stringify(C)}}createGetWhepRequest(){return{method:"GET",headers:this.createRequestHeaders()}}createRequestHeaders(){var C,P;return{Authorization:`Bearer ${this.token.rawToken}`,"Content-Type":"application/json","X-Stages-Platform":"web","X-Stages-Request-ID":Rs().value,"X-Stages-SDK":"1.27.0","X-Stages-Session-ID":this.analyticsTracker.getSessionId(),"X-Stages-Trace-ID":(P=(C=this.traceId)===null||C===void 0?void 0:C.value)!==null&&P!==void 0?P:"","X-Stages-WHIP-Version":Xc}}trackLayerRequest(C){var P;this.analyticsTracker.trackEventNoSharedProps(new oa(this.token,this.traceId,Vr.VIDEO,this.remoteParticipantId,(P=this.mid)!==null&&P!==void 0?P:"unknown",C))}trackLayerStateRequest(C=1){var P;this.analyticsTracker.trackEventNoSharedProps(new Hr(this.token,this.traceId,Vr.VIDEO,this.remoteParticipantId,(P=this.mid)!==null&&P!==void 0?P:"unknown",C))}handleLayerRequestError(C,P){const H=`sendLayerRequest failed for reason: ${C} ${P}`;let X,te;return C===429?(X=qi.THROTTLED,te=hn.WHEP_SET_LAYER_REQUEST_THROTTLED):(X=qi.FAILED,te=hn.WHEP_SET_LAYER_REQUEST_FAILED),this.trackRequestError(te,H),(0,Qn.err)(X)}handleLayerStateRequestError(C,P){const H=`sendLayerStateRequest failed for reason: ${C} ${P}`;let X,te;return C===429?(X=qi.THROTTLED,te=hn.WHEP_GET_LAYER_STATE_THROTTLED):(X=qi.FAILED,te=hn.WHEP_GET_LAYER_STATE_FAILED),this.trackRequestError(te,H),(0,Qn.err)(X)}trackRequestError(C,P){const H=new Error(P);this.logger.error({err:H}),C.message=P;const X=this.createError(C);this.analyticsTracker.trackError(X)}createError(C,P){return new Br(Object.assign({action:Fn.SUBSCRIBE,traceId:this.traceId,token:this.token,location:"RemotePlaybackController",tag:Ai,details:P},C))}}var Vs,Ms,Ni,io,mc=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))},Nl=function(j,C,P,H){if(typeof C=="function"?j!==C||!H:!C.has(j))throw new TypeError("Cannot read private member from an object whose class did not declare it");return P==="m"?H:P==="a"?H.call(j):H?H.value:C.get(j)};(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Ni||(Ni={})),(function(j){j.NONE="none",j.AUDIO_ONLY="audio_only",j.AUDIO_VIDEO="audio_video"})(io||(io={}));class mr extends oc{constructor(C,P,H,X,te,ue,Ee){super(),this.id=C,this.token=P,this.stageConnection=H,this.nonScopedLogger=X,this.analyticsTracker=te,this.desiredSubscribeType=ue,Vs.add(this),this.isSubscriptionActive=!1,this.subscriptionState={connectionState:Ni.DISCONNECTED,subscribeInProgress:!1},this.previousSignalState={isTargetPublishing:!1},this.failedRetries=0,this.startConnectingTimestamp=-1,this.throttler=new al(1e3),this.cleanupFirstFrameTracking=Zc,this.actualSubscribeType=io.NONE,this.action=Fn.SUBSCRIBE,this.updateDesiredSubscribeType=h=>{this.desiredSubscribeType=h,this.attemptToActualizeSubscribeType()},this.updateSubscribeConfig=h=>{this.peerClient.updateSubscribeConfig(h)},this.getDesiredSubscribeType=()=>this.desiredSubscribeType,this.attemptToActualizeSubscribeType=()=>{const h=this.actualSubscribeType,b=this.desiredSubscribeType;this.logger.debug({msg:`Attempt to actualize subscribe type to ${b}`}),this.subscriptionState.connectionState===Ni.CONNECTED&&b!==io.NONE&&h!==b&&this.applyVideoControlsBySubscribeType(b,h)},this.onParticipantUpdated=h=>{Nl(this,Vs,"m",Ms).call(this,h)&&(this.logger.debug({msg:"onParticipantUpdated",participant:h}),this.processStateUpdate({isTargetPublishing:h.isPublishing}))},this.onParticipantJoined=h=>{Nl(this,Vs,"m",Ms).call(this,h)&&(this.logger.debug({msg:"onParticipantJoined",participant:h}),this.processStateUpdate({isTargetPublishing:h.isPublishing}))},this.onParticipantLeft=h=>{Nl(this,Vs,"m",Ms).call(this,h)&&(this.logger.debug({msg:"onParticipantLeft",participant:h}),this.processStateUpdate({isTargetPublishing:!1}))},this.onPeerClientConnectionStateChange=h=>{const b=this.stageConnection.getParticipant(this.id);this.logger.debug({msg:`onPeerClientConnectionStateChange: ${h}`,state:h,targetParticipant:b}),this.processStateUpdate({peerClientState:h})},this.onPeerClientTransformError=h=>{this.emit(us,h)},this.onSdpNegotiated=h=>{this.remotePlaybackController.endpoints={playback:h.mediaControls,layers:h.layerControls}},this.seiMessageHandler=h=>{this.emit(Ic,h)},this.requestRTCStats=h=>mc(this,void 0,void 0,(function*(){return this.peerClient.requestRTCStats(h)})),this.trySubscribe=h=>mc(this,void 0,void 0,(function*(){var b,k;if(this.logger.debug({msg:`Subscribe attempt started: ${h}`}),!this.isSubscriptionActive)return this.logger.warn({msg:"Subscribe attempt invalid: Subscription is inactive"}),!1;this.logger.debug({msg:"Subscribe attempt is valid."}),this.startConnectingTimestamp<0&&(this.startConnectingTimestamp=performance.now()),this.subscriptionState.connectionState!==Ni.ERRORED&&(this.logger.debug({msg:"Updating state to CONNECTING"}),this.updateState({connectionState:Ni.CONNECTING}));const F=this.stageConnection.getConnectionStats(),ie=this.peerClient.getExpectedJitterBufferMinDelayInMs(),pe=this.peerClient.getSfuResource();this.attemptTracker=this.subscribeTracker.trackAttempt({stageConnectionStats:F,preAttemptSfuResource:pe});try{this.remotePlaybackController.traceId=this.attemptTracker.getTraceId();const{mediaStream:ye}=yield this.subscribe(this.attemptTracker.getTraceId()),Ae=performance.now()-this.startConnectingTimestamp,De=this.peerClient.getSfuResource();this.remotePlaybackController.mediaId=this.peerClient.videoMediaId;const Fe=this.failedRetries;this.attemptToActualizeSubscribeType();const Ye=this.peerClient.getActionMeasurements(),dt=this.peerClient.getProtocol();if(this.attemptTracker.trackSubscribeStarted({sfuResource:De,totalDurationWithRetries:Ae,retryTimes:Fe,peerClientPerfStats:Ye,protocol:dt}),ye){this.cleanupFirstFrameTracking();const Et=this.actualSubscribeType,Pt=this.attemptTracker,bt=(gt,Ot)=>{Pt.trackSubscribeFirstFrame({peerClientPerfStats:Ye,sfuResource:De,totalDurationWithRetries:Ae,retryTimes:Fe,currentJitterBufferMinDelayInMs:ie,mediaType:Ot,firstFrameDuration:gt,protocol:dt})};this.cleanupFirstFrameTracking=this.measureFirstFrameDuration({mediaStream:ye,subscribeType:Et,callback:bt})}return this.throttler.clear(),this.failedRetries=0,this.startConnectingTimestamp=-1,ye&&this.emit(js,ye,this.remotePlaybackController),this.logger.debug({msg:"Subscribe attempt succeeded"}),!0}catch(ye){const Ae=(k=(b=this.peerClient)===null||b===void 0?void 0:b.getProtocol())!==null&&k!==void 0?k:"",De=this.attemptTracker.trackSubscribeFailed(ye,Ae);this.logger.error({log:"Subscribe attempt failed",err:ye}),this.onTrySubscribeFailure(De,h)}return!1}));const w=Xs();this.peerClient=new ys(P,this.nonScopedLogger,this.action,On(this.action,C),w,te,C,H,Ee),this.logger=new wn(X,_e.SUBSCRIPTION),this.subscribeTracker=new Il(this.analyticsTracker,P,C),this.remotePlaybackController=new of({token:P,analyticsTracker:te,traceId:w,logger:this.nonScopedLogger,remoteParticipantId:this.id})}applyVideoControlsBySubscribeType(C,P){try{C===io.AUDIO_ONLY?this.remotePlaybackController.stopVideo().catch((H=>{this.logger.error({err:H,msg:"Remote playback request to stop video failed"})})):C===io.AUDIO_VIDEO&&this.remotePlaybackController.startVideo().catch((H=>{this.logger.error({err:H,msg:"Remote playback request to start video failed"})})),this.actualSubscribeType=C,this.logger.debug({msg:`Desired subscribe type actualized from ${P} to ${C}.`})}catch(H){this.logger.error({err:H,msg:`Error updating subscribe type from ${P} to ${C}.`})}}processStateUpdate(C){const P=this.previousSignalState,H=Object.assign({},P,C);if(!this.isSubscriptionActive)return void this.logger.warn({msg:"Unexpected processStateUpdate when subscription is inactive"});H.isTargetPublishing?C.peerClientState===sr.CONNECTED?this.updateState({connectionState:Ni.CONNECTED,subscribeInProgress:!0}):C.peerClientState===sr.FAILED&&this.subscriptionState.subscribeInProgress&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ei.CONNECTION_FAIL,this.peerClient.getProtocol()),this.updateState({subscribeInProgress:!1}),this.emit(Cl)):(P.isTargetPublishing&&this.subscriptionState.subscribeInProgress&&(this.logger.debug({msg:"Scheduling an unsubscribe on the event loop"}),this.unsubscribe()),this.throttler.clear(),this.updateState({connectionState:Ni.DISCONNECTED}));const X=!P.isTargetPublishing&&C.isTargetPublishing,te=this.subscriptionState.connectionState===Ni.CONNECTED&&C.peerClientState===sr.FAILED;(X||te)&&this.throttledTrySubscribe("onSignalState change: isTargetPublishing is now true"),Object.assign(this.previousSignalState,C)}onTrySubscribeFailure(C,P){this.logger.debug({msg:"Changing/keeping state FAILED"});const H=C.fatal,X=C.code===hn.OPERATION_ABORTED.code,te=this.failedRetries<=4;if(!X&&!H&&te){const ue=1e3*Math.pow(2,this.failedRetries);this.logger.debug({msg:`Retrying in ${ue}ms`}),this.failedRetries++,this.nextAttemptTimerId=window.setTimeout((()=>mc(this,void 0,void 0,(function*(){this.throttledTrySubscribe(P)}))),ue)}else this.updateState({connectionState:Ni.ERRORED}),this.emit(Vh,C),this.onTerminalFailure()}onTerminalFailure(){this.previousSignalState.isTargetPublishing=!1,this.startConnectingTimestamp=-1,this.failedRetries=0}start(){this.isSubscriptionActive=!0,this.peerClient.on(So,this.onPeerClientConnectionStateChange),this.peerClient.on(wf,this.onSdpNegotiated),this.peerClient.on(Ac,this.seiMessageHandler),this.peerClient.on(lh,this.onPeerClientTransformError),this.stageConnection.on(To,this.onParticipantUpdated),this.stageConnection.on(Of,this.onParticipantJoined),this.stageConnection.on(If,this.onParticipantLeft),this.stageConnection.on(og,this.onParticipantLeft);let C=!0;if(this.stageConnection.isConnected()){const P=this.stageConnection.getParticipant(this.id);C=!!P?.isPublishing}this.processStateUpdate({isTargetPublishing:C})}throttledTrySubscribe(C){return this.throttler.invoke(this.trySubscribe,C)}updateState(C){C.subscribeInProgress!==void 0&&(this.subscriptionState.subscribeInProgress=C.subscribeInProgress),C.connectionState&&this.subscriptionState.connectionState!==C.connectionState&&(this.subscriptionState.connectionState=C.connectionState,this.emit(Al,this.subscriptionState.connectionState))}stop(C=!1){this.peerClient.off(So,this.onPeerClientConnectionStateChange),this.peerClient.off(lh,this.onPeerClientTransformError),this.peerClient.off(wf,this.onSdpNegotiated),this.peerClient.off(Ac,this.seiMessageHandler),this.unsubscribe(C),this.throttler.clear(),this.stageConnection.off(To,this.onParticipantUpdated),this.stageConnection.off(Of,this.onParticipantJoined),this.stageConnection.off(If,this.onParticipantLeft),this.stageConnection.off(og,this.onParticipantLeft),this.isSubscriptionActive=!1,this.updateState({connectionState:Ni.DISCONNECTED})}isActive(){return this.isSubscriptionActive}subscribe(C,P){return mc(this,void 0,void 0,(function*(){const{token:H,id:X}=this;H.assertTokenIsUnexpired(C,On(Fn.SUBSCRIBE,X),"subscribe",X);const{mediaStream:te}=yield this.peerClient.connect({audioOnly:P,traceId:C});return{peerClient:this.peerClient,mediaStream:te}}))}unsubscribe(C=!1){return mc(this,void 0,void 0,(function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.remotePlaybackController.destroy(),!this.isSubscriptionActive||!this.attemptTracker||this.subscriptionState.connectionState===Ni.DISCONNECTED)return;this.cleanupFirstFrameTracking(),this.attemptTracker.trackUnsubscribe();const P=C?Ei.UNLOAD:Ei.UNSUBSCRIBE,H=this.peerClient.getProtocol();try{C?this.peerClient.disconnect(C):yield this.peerClient.disconnect(C),this.updateState({subscribeInProgress:!1}),this.attemptTracker.trackEndSucceeded(P,H)}catch{this.attemptTracker.trackEndFailed(P,H)}}))}triggerIceRestart(C){var P;return mc(this,void 0,void 0,(function*(){const H=this.stageConnection.getConnectionStats(),X=this.peerClient.getSfuResource(),te=this.subscribeTracker.trackAttempt({stageConnectionStats:H,isReassignment:!0,traceIdOverride:C.traceId,preAttemptSfuResource:X}),ue=performance.now();try{this.emit(uc),this.logger.debug({msg:`Triggering attempt. Current node: ${this.peerClient.getSfuResource().node}`}),yield this.peerClient.connect({iceRestartOptions:C,traceId:C.traceId}),this.logger.debug({msg:`Successful ICE restart attempt. Current node: ${this.peerClient.getSfuResource().node}`});const Ee=performance.now()-ue,w=this.peerClient.getSfuResource(),h=this.peerClient.getActionMeasurements();(P=this.attemptTracker)===null||P===void 0||P.trackEndSucceeded(Ei.REASSIGNMENT,this.peerClient.getProtocol()),this.applyVideoControlsBySubscribeType(this.actualSubscribeType,this.actualSubscribeType),te.trackSubscribeStarted({totalDurationWithRetries:Ee,sfuResource:w,retryTimes:0,peerClientPerfStats:h,protocol:this.peerClient.getProtocol()}),this.emit(Gh)}catch(Ee){this.emit(Wl),this.logger.error({msg:"ICE restart attempt failed",err:Ee});const w=this.peerClient.getSfuResource(),h=te.trackSubscribeFailed(Ee,this.peerClient.getProtocol(),`iceRestart=true, startNode=${X.node}, endNode=${w?.node}`);throw h.code===hn.SUBSCRIBE_TIMED_OUT.code&&this.onTrySubscribeFailure(h,"ice restart timeout"),Ee}}))}measureFirstFrameDuration({mediaStream:C,subscribeType:P,callback:H}){const X=performance.now(),te=w=>{const h=performance.now()-X;H(h,w),w==="audio"?Ee():ue()};let ue=Zc,Ee=Zc;return P!==io.AUDIO_ONLY&&(ue=(function(w,h){return kd(w,"video",h)})(C,te)),Ee=(function(w,h){return kd(w,"audio",h)})(C,te),()=>{ue(),Ee()}}}var fr,Wn;Vs=new WeakSet,Ms=function(j){return j.id===this.id},(function(j){j.JOIN_ERROR="JOIN_ERROR",j.PUBLISH_ERROR="PUBLISH_ERROR",j.SUBSCRIBE_ERROR="SUBSCRIBE_ERROR"})(fr||(fr={})),(function(j){j[j.TOKEN_MALFORMED=1]="TOKEN_MALFORMED",j[j.TOKEN_EXPIRED=2]="TOKEN_EXPIRED",j[j.TIMEOUT=3]="TIMEOUT",j[j.FAILED=4]="FAILED",j[j.CANCELED=5]="CANCELED",j[j.STAGE_AT_CAPACITY=6]="STAGE_AT_CAPACITY",j[j.CODEC_MISMATCH=7]="CODEC_MISMATCH",j[j.TOKEN_NOT_ALLOWED=8]="TOKEN_NOT_ALLOWED",j[j.STAGE_DELETED=9]="STAGE_DELETED",j[j.PARTICIPANT_DISCONNECTED=10]="PARTICIPANT_DISCONNECTED"})(Wn||(Wn={}));const Wa={[Wn.TOKEN_MALFORMED]:"Token is malformed",[Wn.TOKEN_EXPIRED]:"Token expired and is no longer valid",[Wn.TIMEOUT]:"Operation timed out",[Wn.FAILED]:"Operation failed",[Wn.CANCELED]:"Operation canceled",[Wn.STAGE_AT_CAPACITY]:"Stage at capacity",[Wn.CODEC_MISMATCH]:"Client codec is not supported",[Wn.TOKEN_NOT_ALLOWED]:"Token not allowed to perform operation",[Wn.STAGE_DELETED]:"Stage has been deleted, unable to join",[Wn.PARTICIPANT_DISCONNECTED]:"Participant has been disconnected, unable to join"},$r={[hn.EXPIRED_TOKEN.code]:Wn.TOKEN_EXPIRED,[hn.MALFORMED_TOKEN.code]:Wn.TOKEN_MALFORMED,[hn.JOIN_SERVER_BAD_REQUEST.code]:Wn.FAILED,[hn.TOKEN_PERMISSIONS_DENIED.code]:Wn.TOKEN_NOT_ALLOWED,[hn.OPERATION_ABORTED.code]:Wn.CANCELED,[hn.JOIN_TIMED_OUT.code]:Wn.TIMEOUT,[hn.STAGE_DELETED.code]:Wn.STAGE_DELETED,[hn.PARTICIPANT_DISCONNECTED.code]:Wn.PARTICIPANT_DISCONNECTED,[hn.EVENT_PLANE_WS_CREATE_FAILED.code]:Wn.FAILED,[hn.PUBLISH_TIMED_OUT.code]:Wn.TIMEOUT,[hn.PUBLISH_FAILURE.code]:Wn.FAILED,[hn.SUBSCRIBE_TIMED_OUT.code]:Wn.TIMEOUT,[hn.SUBSCRIBE_FAILURE.code]:Wn.FAILED,[hn.STAGE_AT_CAPACITY.code]:Wn.STAGE_AT_CAPACITY,[hn.NO_MATCHING_CODEC.code]:Wn.CODEC_MISMATCH,[hn.NETWORK_FAILURE.code]:Wn.FAILED,[hn.INTERNAL_SERVER_ERROR.code]:Wn.FAILED,[hn.REMOTE_STREAM_NOT_FOUND.code]:Wn.FAILED,[hn.INTERNAL_MHCP_ERROR.code]:Wn.FAILED,[hn.UNREACHABLE_MHCP.code]:Wn.FAILED,[hn.INVALID_SESSION_STATUS.code]:Wn.FAILED,[hn.MHCP_ABORTED.code]:Wn.FAILED,[hn.EVENT_PLANE_PONG_TIMEOUT.code]:Wn.FAILED,[hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code]:Wn.FAILED},rs={[hn.SEI_INSERT_NOT_PUBLISHING_VIDEO.code]:"SEI insert failed due to not publishing video",[hn.SEI_INSERT_INBAND_NOT_ENABLED.code]:"SEI insert failed due to in-band messaging not being enabled for the stage stream"};class Pu extends Error{constructor(C,P,H){super(),this.code=C,this.category=P,this.message=H,this.name="StageError",this.errorDetails=[],this.message=`[${P}] ${H}`}addDetails(C){this.errorDetails.push(C)}get details(){return this.errorDetails.length?JSON.stringify(this.errorDetails):""}toString(){return`
${this.message}
details - ${this.details}
        `.trim()}}var nu,ko,od;function ld(j,C){let P;if(j instanceof Br){if(C===fr.JOIN_ERROR&&(j.code===hn.EVENT_PLANE_PONG_TIMEOUT.code||j.code===hn.EVENT_PLANE_WS_UNEXPECTED_CLOSE.code))return;const H=$r[j.code];H&&(P=(function(X,te,ue){var Ee,w,h;const b=Wa[X],k=new Pu(X,te,b);return k.addDetails({stageErrorMessage:b,stageErrorCode:X,stageErrorCategory:te,stageArn:(Ee=ue.token)===null||Ee===void 0?void 0:Ee.stageARN,traceId:(w=ue.traceId)===null||w===void 0?void 0:w.value,causeCode:ue.code,causeDetails:ue.details,causeMessage:ue.message,causeLocation:ue.location,participantId:(h=ue.token)===null||h===void 0?void 0:h.participantID,timeUTC:new Date().toISOString()}),k})(H,C,j))}return P}(function(j){j.ERROR="error"})(nu||(nu={}));class Ep extends oc{constructor(C){super(),this.logger=C,this.handleError=(P,H,X=!0)=>{const te=(function(Ee){let w;return Ee instanceof Br&&(w=rs[Ee.code]),w})(P),ue=ld(P,H);if(te&&this.logger.warn({msg:te}),ue)return X&&this.emit(nu.ERROR,ue),ue}}}(function(j){j.INTERNAL="internal",j.REMOTE="remote",j.API="api"})(ko||(ko={})),(function(j){j.ADDITIVE="additive",j.REPLACE="replace"})(od||(od={}));class la{constructor(C){this.logger=new wn(C.logger,_e.CONNECTION),this.subscribeConfig={defaults:C.subscribeDefaults,participants:{}}}handleSubscribeConfigUpdate(C,P,H,X=od.REPLACE){P=(b=>{const k=Od(b);if(k.jitterBuffer!==void 0){const F=ie=>{if(typeof ie=="number"){if(ie<0)return 0;if(ie>4e3)return 4e3}return ie};k.jitterBuffer.minDelayWhenPublishing!==void 0&&(k.jitterBuffer.minDelayWhenPublishing=F(k.jitterBuffer.minDelayWhenPublishing)),k.jitterBuffer.minDelayWhenSubscribeOnly!==void 0&&(k.jitterBuffer.minDelayWhenSubscribeOnly=F(k.jitterBuffer.minDelayWhenSubscribeOnly))}return k})(P),this.subscribeConfig.participants[C]===void 0&&(this.subscribeConfig.participants[C]={internalOverrides:{},apiOverrides:{},remoteOverrides:{},lastMerged:this.subscribeConfig.defaults});const te=this.subscribeConfig.participants[C];switch(H){case ko.INTERNAL:te.internalOverrides=this.handleSubscribeConfigLevelMerging(te.internalOverrides,P,X);break;case ko.REMOTE:te.remoteOverrides=this.handleSubscribeConfigLevelMerging(te.remoteOverrides,P,X);break;case ko.API:te.apiOverrides=this.handleSubscribeConfigLevelMerging(te.apiOverrides,P,X);break;default:(function(b){throw new Error(`Unknown case kind: ${b}`)})(H)}const ue=Ml(this.subscribeConfig.defaults,te.internalOverrides,te.remoteOverrides,te.apiOverrides);if(ue===void 0)return this.logger.warn({msg:`Unable to merge subscribe configs for participant: ${C} | ${te}, ${P}`}),!1;const Ee=(w=te.lastMerged,h=ue,(typeof w=="object"&&typeof h=="object"&&(0,zs.isEqual)(w,h))===!1);var w,h;return te.lastMerged=ue,this.subscribeConfig.participants[C]=te,Ee}handleExternalSubscribeConfigUpdate(C,P,H,X=od.REPLACE){const te=(ue=>{const Ee={};return typeof ue!="object"?Qn.err(new Error("Invalid input")):(ue.jitterBuffer!==void 0&&(Ee.jitterBuffer={},ue.jitterBuffer.minDelay!==void 0&&(Ee.jitterBuffer.minDelayWhenSubscribeOnly=ue.jitterBuffer.minDelay)),ue.inBandMessaging!==void 0&&(Ee.inBandMessaging={enabled:ue.inBandMessaging.enabled===!0}),ue.simulcast!==void 0&&(Ee.simulcast={},ue.simulcast.initialLayerPreference!==void 0&&(Ee.simulcast.initialLayerPreference=ue.simulcast.initialLayerPreference)),Qn.ok(Ee))})(P);return te.ok===!0&&this.handleSubscribeConfigUpdate(C,te.value,H,X)}handleSubscribeConfigLevelMerging(C,P,H){if(H===od.REPLACE)return P;{const X=Ml(C,P);return X===void 0?(this.logger.warn({msg:`Unable to merge '${C}' and '${P}' with type ${H}`}),C):X}}getSubscribeConfigSnapshot(C){return this.subscribeConfig.participants[C]===void 0?Pa(this.subscribeConfig.defaults):Pa(this.subscribeConfig.participants[C].lastMerged)}}class xp extends ur{constructor(C){super(Xn.REASSIGNMENT_REQUEST,C.token,C.traceId,!1),Object.assign(this.properties,{target_local_participant_id:C.targetLocalParticipantId,target_remote_participant_id:C.targetRemoteParticipantId}),this.critical=!0}}var gl,_l,Uc,Zi,Zr,so=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class vh extends oc{constructor(C,P){super(),this.setGetStats=H=>{this._getInternalStats=H},this.getStats=()=>so(this,void 0,void 0,(function*(){return this.requestRTCStats()})),this.requestRTCStats=()=>so(this,void 0,void 0,(function*(){if(!this._getInternalStats)return;const H=yield this._getInternalStats(this.mediaStreamTrack);return H?H.rawReport:void 0})),this._getInternalStats=P,this.id=C.id,this.isMuted=!C.enabled,this.mediaStreamTrack=C,this.streamType=this.mediaStreamTrack.kind==="audio"?Vr.AUDIO:Vr.VIDEO}cleanup(){this.removeAllListeners(),this._getInternalStats=void 0}}(function(j){j.IDLE="IDLE",j.INITIALIZING="INITIALIZING",j.ACTIVE="ACTIVE",j.CONTROLS_PAUSED="CONTROLS_PAUSED",j.DESTROYED="DESTROYED"})(gl||(gl={})),(function(j){j.LAYERS_CHANGED="LAYERS_CHANGED",j.LAYER_SELECTED="LAYER_SELECTED",j.ADAPTION_CHANGED="ADAPTION_CHANGED"})(_l||(_l={})),(function(j){j.LAYERS_CHANGED="LAYERS_CHANGED",j.LAYER_SELECTED="LAYER_SELECTED",j.ADAPTION_CHANGED="ADAPTION_CHANGED"})(Uc||(Uc={})),(function(j){j.UNAVAILABLE="unavailable",j.SELECTED="selected"})(Zi||(Zi={})),(function(j){j.LOCAL_STREAM_MUTE_CHANGED="localStreamMutedChanged",j.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST="localStreamInsertSeiMsgRequest"})(Zr||(Zr={}));var vl,_a,Go,jd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class zf extends vh{constructor(C,P){super(C),this.setMuted=H=>{H!==this.isMuted&&(this.mediaStreamTrack.enabled=!H,this.isMuted=H,this.emit(Zr.LOCAL_STREAM_MUTE_CHANGED,this))},this.insertSeiMessage=(H,X)=>jd(this,void 0,void 0,(function*(){let te;if(this.streamType==="audio")te=sa.INVALID_TRACK_TYPE;else if(this.mediaConfig.inBandMessaging.enabled){const ue=this.validator.validateMessagePayload(H,X?.repeatCount||0);te=Qn.getErr(ue)}else te=sa.INBAND_MESSAGING_NOT_ENABLED;te?console.warn(`Unable to insert SEI message due to ${te}`):this.emit(Zr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this,H,X)})),this.requestQualityStats=()=>jd(this,void 0,void 0,(function*(){if(!this._getInternalStats)return;const H=yield this._getInternalStats(this.mediaStreamTrack);return H?H.stats:void 0})),this.validatedExternalConfig=ug(C,P),this.normalizedConfig=Q0(0,this.validatedExternalConfig),this.mediaConfig=(0,zs.cloneDeep)(this.normalizedConfig),this.validator=new Q_(Dc)}}class ru{constructor(C,P){this.strategy=C,this.logger=P}setStrategy(C){this.strategy=C}hasStrategy(C){return this.strategy[C]!==void 0}stageStreamsToPublish(){let C=[];try{C=this.strategy.stageStreamsToPublish(),C=C.filter((X=>X instanceof zf))}catch(X){return this.logger.warn({msg:"error executing stageStreamsToPublish treating this as a no-op",err:X}),console.error("Error executing stageStreamsToPublish",X),Qn.err(X)}let P=0,H=0;for(const X of C)X.mediaStreamTrack.kind==="audio"?P++:X.mediaStreamTrack.kind==="video"&&H++;if(P>1||H>1){const X=Error("stageStreamsToPublish strategy function returned more than 1 video or audio stream and as a result will not publish",{cause:"UserStrategy"});return Qn.err(X)}return Qn.ok(C)}shouldPublishParticipant(C){try{return Qn.ok(this.strategy.shouldPublishParticipant(C))}catch(P){return this.logger.warn({msg:"error executing shouldPublishParticipant treating this as a no-op",err:P}),console.error("Error executing shouldPublishParticipant",P),Qn.err(P)}}shouldSubscribeToParticipant(C){try{return Qn.ok(this.strategy.shouldSubscribeToParticipant(C))}catch(P){return this.logger.warn({msg:"error executing shouldSubscribeToParticipant. Treating it as a no-op",err:P}),console.error("Error executing shouldSubscribeToParticipant",P),Qn.err(P)}}subscribeConfiguration(C){var P,H;try{return Qn.ok((H=(P=this.strategy).subscribeConfiguration)===null||H===void 0?void 0:H.call(P,C))}catch(X){return this.logger.warn({msg:"error executing subscribeConfiguration. Treating it as a no-op",err:X}),console.error("Error executing subscribeConfiguration",X),Qn.err(X)}}preferredLayerForStream(C,P){var H,X;try{return Qn.ok((X=(H=this.strategy).preferredLayerForStream)===null||X===void 0?void 0:X.call(H,C,P))}catch(te){return this.logger.warn({msg:"error executing preferredLayerForStream. Treating it as a no-op",err:te}),console.error("Error executing preferredLayerForStream",te),Qn.err(te)}}}class iu extends oc{constructor(C,P){super(),this.audioMuted=!0,this.videoStopped=!0,this.publishState=_a.NOT_PUBLISHED,this.logger=P,this.info=C,this.audioMuted=C.audioMuted,this.videoStopped=C.videoStopped}}(function(j){j.PUBLISH="publish",j.SUBSCRIBE="subscribe"})(vl||(vl={})),(function(j){j.NOT_PUBLISHED="not_published",j.ATTEMPTING_PUBLISH="attempting_publish",j.PUBLISHED="published",j.ERRORED="errored"})(_a||(_a={})),(function(j){j.NOT_SUBSCRIBED="not_subscribed",j.ATTEMPTING_SUBSCRIBE="attempting_subscribe",j.SUBSCRIBED="subscribed",j.ERRORED="errored"})(Go||(Go={}));function yh(j){return j.map((C=>C.remote))}function lf(j){return{label:j.encodingId,bitrateBps:1e3*j.bitrate,width:j.width,height:j.height,framesPerSecond:j.framesPerSecond,selected:j.selected}}function ca(j,C){const P=j.width*j.height,H=C.width*C.height;return P>H||j.bitrateBps>C.bitrateBps||j.framesPerSecond>C.framesPerSecond?1:P===H&&j.bitrateBps===C.bitrateBps&&j.framesPerSecond===C.framesPerSecond?0:-1}var Hd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class su extends oc{constructor(C){var P,H,X;super(),this.onAdaptionChanged=te=>{this.emit(Uc.ADAPTION_CHANGED,te)},this.onLayersChanged=te=>{this.emit(Uc.LAYERS_CHANGED,te)},this.onLayerSelected=(te,ue)=>{this.emit(Uc.LAYER_SELECTED,te,ue)},this.setGetStats=()=>{},this.requestRTCStats=()=>Hd(this,void 0,void 0,(function*(){var te;return(te=this.internalStream)===null||te===void 0?void 0:te.requestRTCStats()})),this.requestQualityStats=()=>Hd(this,void 0,void 0,(function*(){if(this.internalStream)try{const te=yield this.internalStream.getInternalStats();return te?te.stats:void 0}catch{return}})),this.getStats=()=>Hd(this,void 0,void 0,(function*(){var te;return(te=this.internalStream)===null||te===void 0?void 0:te.requestRTCStats()})),this.setMuted=te=>{var ue;(ue=this.internalStream)===null||ue===void 0||ue.setMuted(te)},this.getLayers=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.layers)!==null&&ue!==void 0?ue:this.cachedLayers},this.getSelectedLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.selectedLayer)!==null&&ue!==void 0?ue:this.cachedSelectedLayer},this.getLowestQualityLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.lowestQualityLayer)!==null&&ue!==void 0?ue:this.cachedLowestLowestLayer},this.getHighestQualityLayer=()=>{var te,ue;return(ue=(te=this.internalStream)===null||te===void 0?void 0:te.highestQualityLayer)!==null&&ue!==void 0?ue:this.cachedHighestQualityLayer},this.internalStream=C,this.cachedId=this.internalStream.id,this.cachedParticipantInfo=(0,zs.cloneDeep)(this.internalStream.participantInfo),this.cachedStreamType=this.internalStream.streamType,this.cachedMediaStreamTrack=(X=(H=(P=this.internalStream.mediaStreamTrack).clone)===null||H===void 0?void 0:H.call(P))!==null&&X!==void 0?X:{},this.cachedIsMuted=this.internalStream.isMuted,this.cachedIsAdapting=this.internalStream.isAdapting,this.cachedLayers=this.internalStream.layers,this.updateCachedStreamData(),this.internalStream.on(_l.ADAPTION_CHANGED,this.onAdaptionChanged),this.internalStream.on(_l.LAYERS_CHANGED,this.onLayersChanged),this.internalStream.on(_l.LAYER_SELECTED,this.onLayerSelected)}updateCachedStreamData(){var C,P,H,X,te;this.cachedLayers=(P=(C=this.internalStream)===null||C===void 0?void 0:C.layers)!==null&&P!==void 0?P:[],this.cachedHighestQualityLayer=(H=this.internalStream)===null||H===void 0?void 0:H.highestQualityLayer,this.cachedLowestLowestLayer=(X=this.internalStream)===null||X===void 0?void 0:X.lowestQualityLayer,this.cachedSelectedLayer=(te=this.internalStream)===null||te===void 0?void 0:te.selectedLayer}get id(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.id)!==null&&P!==void 0?P:this.cachedId}get participantInfo(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.participantInfo)!==null&&P!==void 0?P:this.cachedParticipantInfo}get streamType(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.streamType)!==null&&P!==void 0?P:this.cachedStreamType}get mediaStreamTrack(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.mediaStreamTrack)!==null&&P!==void 0?P:this.cachedMediaStreamTrack}get isMuted(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.isMuted)!==null&&P!==void 0?P:this.cachedIsMuted}set isMuted(C){var P;(P=this.internalStream)===null||P===void 0||P.setMuted(C)}get isAdapting(){var C,P;return(P=(C=this.internalStream)===null||C===void 0?void 0:C.isAdapting)!==null&&P!==void 0?P:this.cachedIsAdapting}cleanup(){var C,P,H;this.updateCachedStreamData(),(C=this.internalStream)===null||C===void 0||C.off(_l.ADAPTION_CHANGED,this.onAdaptionChanged),(P=this.internalStream)===null||P===void 0||P.off(_l.LAYERS_CHANGED,this.onLayersChanged),(H=this.internalStream)===null||H===void 0||H.off(_l.LAYER_SELECTED,this.onLayerSelected),this.internalStream=void 0,this.removeAllListeners()}}var Gs,Oo,cd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class _i extends vh{constructor({track:C,info:P,getStats:H,remotePlaybackController:X,analyticsTracker:te,token:ue,subscribeConfig:Ee}){super(C,H),this.hasRemoteListenersForLayerEvents=()=>{const h=this.remote;return h.hasListenersFor(Uc.ADAPTION_CHANGED)||h.hasListenersFor(Uc.LAYERS_CHANGED)||h.hasListenersFor(Uc.LAYER_SELECTED)},this.setMuted=h=>{this.isMuted=h,this.mediaStreamTrack.enabled=!h},this.setLayer=h=>{const b=(0,zs.cloneDeep)(h);if(this.queueLayerUpdateForValidState(b))return void this.logger.debug({msg:`setLayer:${b} queued, skipping for now`});const k=(function(ie,pe){if(!ie)return(0,Qn.ok)(void 0);const ye=typeof ie=="string"?ie:ie.label,Ae=pe.filter((De=>De.label===ye))[0];return Ae?(0,Qn.ok)(Ae):(0,Qn.err)(`Provided layer with id ${ye} does not exist`)})(b,this._layers);if(!k.ok){const ie=k.error;return void this.logger.error({err:ie,msg:"Unable to select layer, skipping selection"})}const F=k.value;if(this.isNextUpdateAdaptionOnly(F))return this.logger.warn({msg:"setLayer:dynamic"}),void this.handleDynamicUpdate();this.isFirstLayerUpdate()||!this.isRepeatLayerSelection(F)||this.isAdapting?F&&(this.logger.warn({msg:`setLayer:${JSON.stringify(F)} `}),this.handleManualUpdate(F)):this.logger.debug({msg:"Setting the same layer, same adaption state, skipping selection"})},this.state=gl.INITIALIZING,this.prevState=gl.IDLE,this.analyticsTracker=te,this.token=ue,this.id=C.id,this.info=P,this.mediaStreamTrack=C,this.remotePlaybackController=X,this.layerPollingIntervalId=null,this.weakRemoteMap=new WeakMap,this.weakRemoteKey={id:"remote"},this.commandMap=new Map,this.subscribeConfig=Ee,this._isAdapting=!0,this._layers=[],this._selectedLayer=null;const w=lp();this.logger=new wn(new tn(w),_e.REMOTE_STAGE_STREAM),this.streamType===Vr.AUDIO?this.isMuted=P.audioMuted:this.isMuted=P.videoStopped,this.initializeLayerPolling(),this.pollInternalLayers(!0)}transitionStateTo(C){this.state!==C&&(this.prevState=this.state,this.state=C)}initializeLayerPolling(){vr(this.mediaStreamTrack)?this.streamType!==Vr.AUDIO?(this.logger.debug({msg:"Setting up RemoteStageStream, requesting initial layers"}),this.layerPollingIntervalId!==null&&clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=setInterval((()=>{this.pollInternalLayers()}),this.subscribeConfig.simulcast.layerPollingIntervalMs)):this.logger.debug({msg:"Skipping initializing polling for audio streams"}):this.logger.debug({msg:"Skipping initializing polling, media track is not active"})}startLayerPolling(){this.layerPollingIntervalId===null?this.initializeLayerPolling():this.logger.debug({msg:"Skipping start polling request, already started"})}stopLayerPolling(){this.layerPollingIntervalId!==null?(clearInterval(this.layerPollingIntervalId),this.layerPollingIntervalId=null):this.logger.debug({msg:"Skipping stop polling request, already stopped"})}pollInternalLayers(C=!1){if(!vr(this.mediaStreamTrack))return void this.pauseControls();if(this.streamType===Vr.AUDIO)return this.logger.debug({msg:"Skipping layer poll request for audio stream"}),void this.transitionStateTo(gl.ACTIVE);const P=!this.hasRemoteListenersForLayerEvents(),H=!this.subscribeConfig.simulcast.layerPollingEnabled;!C&&P&&H?this.logger.debug({msg:"Skipping layer request due to no listeners"}):this.remotePlaybackController.getLayers().then((X=>{if(this.isStateValidForLayerUpdates()){if(!X.ok)throw Error(X.error);this.updateInternalLayersFromRemote(X.value),this.transitionStateTo(gl.ACTIVE),this.flushCommandQueue()}else this.logger.warn({msg:"Stream controls have been paused, skipping getLayers"})})).catch((X=>{this.logger.error({err:X,msg:"Error calling getLayers, returning current layers"})}))}updateInternalLayersFromRemote(C){const P=this._layers,H=C.map(lf).sort(ca),X=!(0,zs.isEqual)(H,P);this._layers=H;const te=this._selectedLayer,ue=this._layers.filter((w=>w.selected))[0],Ee=!(0,zs.isEqual)(ue,te);te&&(te.selected=!1),this._selectedLayer=ue,Ee&&(this.trackLayerUpdate(te),this.trackLayerUpdate(ue)),this.isCommandQueueEmpty()&&(X&&this.emitLayersChanged(),Ee&&this.emitLayerSelected(ue))}flushCommandQueue(){if(this.isCommandQueueEmpty())return;const C=Array.from(this.commandMap.keys());this.logger.debug({msg:`Flushing active commands from map ${C}`});for(const P of this.commandMap.keys()){const H=this.commandMap.get(P);H?.()}this.commandMap.clear()}queueLayerUpdateForValidState(C){if(!C)return this.commandMap.delete("setLayer"),!1;if(this.state===gl.INITIALIZING){const P=this.setLayer.bind(this,C);return this.commandMap.set("setLayer",P),!0}return!1}handleDynamicUpdate(){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const C=this._isAdapting;this._isAdapting=!0,this.emitAdaptionChanged(),this.remotePlaybackController.unsetLayer().then((P=>{if(!this.isStateValidForLayerUpdates())return this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"}),void this.resetAdaptionStateOnError(C,`Stream in invalid state: ${this.state}`);P.ok?this.logger.debug({msg:"Layer successfully unset, restarting dynamic adaption"}):this.resetAdaptionStateOnError(C,P.error)})).catch((()=>{}))}resetAdaptionStateOnError(C,P){this._isAdapting=C,this.emitAdaptionChanged(),this.logger.error({err:P,msg:"Error unsetting layer, reverting adaption state"})}handleManualUpdate(C){if(!this.isStateValidForLayerUpdates())return void this.logger.warn({msg:"Stream controls have been paused, skipping manual updates"});const P=this._isAdapting,H=this._selectedLayer;H&&(H.selected=!1),this._isAdapting=!1,this._selectedLayer=C,C.selected=!0,P!==this._isAdapting&&this.emitAdaptionChanged(),this.updateLocalLayerStateBeforeRemote(C,H),this.trackLayerUpdate(H),this.trackLayerUpdate(C),this.emitLayersChanged(),this.emitLayerSelected(C),this.remotePlaybackController.setLayer(C.label).then((X=>{if(!this.isStateValidForLayerUpdates()){this.logger.warn({msg:"Stream controls have been paused, skipping dynamic mode transition"});const te=`Stream in invalid state: ${this.state}`;return this.resetAdaptionStateOnError(P,te),void this.resetLayerOnError(H,C,te)}if(!X.ok){const te=X.error;return this.resetAdaptionStateOnError(P,te),void this.resetLayerOnError(H,C,te)}this.logger.debug({msg:`Layer successfully selected: ${C.label}`})})).catch((()=>{}))}applyExistingControlState(){var C;this._isAdapting?this.remotePlaybackController.unsetLayer().then((()=>{})).catch((()=>{})):!((C=this._selectedLayer)===null||C===void 0)&&C.label&&this.remotePlaybackController.setLayer(this._selectedLayer.label).then((()=>{})).catch((()=>{}))}resetLayerOnError(C,P,H){P&&(P.selected=!1),C&&(C.selected=!0),this._selectedLayer=C,this.logger.error({err:H,msg:"Error unsetting layer, leaving current selection in place"}),this.updateLocalLayerStateBeforeRemote(C,P),this.emitLayersChanged(),C!==null&&this.emitLayerSelected(C,Zi.UNAVAILABLE),this.trackLayerUpdate(P),this.trackLayerUpdate(C)}updateLocalLayerStateBeforeRemote(C,P){this._layers=this._layers.map((H=>H.label===C?.label?C:H.label===P?.label?P:H)).sort(ca)}trackLayerUpdate(C){var P,H;this.analyticsTracker.trackEventNoSharedProps(new Da(this.token,Xs(),(P=C?.label)!==null&&P!==void 0?P:"auto",!0,Fn.SUBSCRIBE,(H=C?.selected)!==null&&H!==void 0&&H,this.info.id))}isNextUpdateAdaptionOnly(C){return C===void 0&&this.isFirstLayerUpdate()||C===void 0&&!this.isAdapting}isFirstLayerUpdate(){return this._selectedLayer===null}isRepeatLayerSelection(C){var P;return((P=this._selectedLayer)===null||P===void 0?void 0:P.label)===C?.label}isStateValidForLayerUpdates(){return this.state===gl.ACTIVE||this.state===gl.INITIALIZING}isCommandQueueEmpty(){return this.commandMap.size===0}emitLayerSelected(C,P=Zi.SELECTED){this.logger.debug({msg:`Emitting layers selected ${JSON.stringify(C,null,2)}`}),this.emit(_l.LAYER_SELECTED,(0,zs.cloneDeep)(C),P)}emitLayersChanged(){this.emit(_l.LAYERS_CHANGED,(0,zs.cloneDeep)(this._layers))}emitAdaptionChanged(){this.emit(_l.ADAPTION_CHANGED,this._isAdapting)}get remote(){const C=this.weakRemoteMap.get(this.weakRemoteKey);if(C)return C;const P=new su(this);return this.weakRemoteMap.set(this.weakRemoteKey,P),P}get participantInfo(){return(0,zs.cloneDeep)(this.info)}get isAdapting(){return this._isAdapting}get layers(){return(0,zs.cloneDeep)(this._layers)}get selectedLayer(){var C;return(0,zs.cloneDeep)((C=this._selectedLayer)!==null&&C!==void 0?C:void 0)}get highestQualityLayer(){return(0,zs.cloneDeep)(this.layers[this.layers.length-1])}get lowestQualityLayer(){return(0,zs.cloneDeep)(this.layers[0])}getInternalStats(){return cd(this,void 0,void 0,(function*(){if(this._getInternalStats)return this._getInternalStats(this.mediaStreamTrack)}))}pauseControls(){this.transitionStateTo(gl.CONTROLS_PAUSED),this.stopLayerPolling()}resumeControls(){this.applyExistingControlState(),this.startLayerPolling(),this.transitionStateTo(gl.ACTIVE)}updateSubscribeConfig(C){const P=this.subscribeConfig;this.subscribeConfig=C,P.simulcast.layerPollingIntervalMs!==C.simulcast.layerPollingIntervalMs&&this.isStateValidForLayerUpdates()&&this.initializeLayerPolling()}cleanup(){this.transitionStateTo(gl.DESTROYED),super.cleanup(),this.weakRemoteMap.delete(this.weakRemoteKey),this.stopLayerPolling(),this._layers=[],this._selectedLayer=null,this._isAdapting=!0,this.commandMap.clear()}}(function(j){j.STATE_CHANGE="stateChange",j.MEDIA_STREAM_ADDED="mediaStreamAdded",j.MEDIA_STREAM_REMOVED="mediaStreamRemoved",j.MEDIA_STREAM_MUTE_CHANGED="mediaStreamMuteChanged",j.ERROR="error"})(Gs||(Gs={})),(function(j){j.SUBSCRIPTION_STATE_CHANGE="subscriptionStateChange",j.MEDIA_STREAM_SEI_MESSAGE_RECEIVED="mediaStreamSeiMessageReceived"})(Oo||(Oo={}));const ar=Object.assign(Object.assign({},Gs),Oo);var Ui;(function(j){j.PUBLICATION_STATE_CHANGE="publicationStateChange"})(Ui||(Ui={}));const $o=Object.assign(Object.assign({},Gs),Ui);var ud=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class bh extends iu{constructor(C,P,H,X,te,ue,Ee,w=!1){super(C,new wn(X,_e.REMOTE_PARTICIPANT)),this.subscribeState=Go.NOT_SUBSCRIBED,this.reassigning=!1,this.streams=[],this.left=!1,this.onSubscriptionStateChange=h=>{this.logger.debug({msg:"subscriptionStateChange",state:h}),h===Ni.DISCONNECTED?this.updateSubscriptionState(Go.NOT_SUBSCRIBED):h===Ni.CONNECTED?this.updateSubscriptionState(Go.SUBSCRIBED):h===Ni.CONNECTING?this.updateSubscriptionState(Go.ATTEMPTING_SUBSCRIBE):h===Ni.ERRORED?(this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams(),this.updateSubscriptionState(Go.ERRORED)):this.logger.warn({msg:"FIXME onSubscriptionStateChange UNHANDLED STATE",state:h})},this.onSubscriptionStreamRemoved=()=>{this.logger.debug({msg:"onSubscriptionStreamRemoved"}),this.emitStreamsRemovedByType(this.getDesiredSubscribeType()),this.cleanupStreams()},this.onSubscriptionStreamCreated=(h,b)=>{this.logger.debug({msg:"onSubscriptionStreamCreated",stream:h}),this.pruneInactiveStreams();let k=h.getTracks().map((F=>{const ie=new _i({track:F,info:this.info,getStats:this.subscription.requestRTCStats,remotePlaybackController:b,analyticsTracker:this.analyticsTracker,token:this.token,subscribeConfig:this.subscribeConfig});return this.streams.push(ie),ie}));this.subscription.getDesiredSubscribeType()===io.AUDIO_ONLY&&(k=k.filter((F=>F.streamType!==Vr.VIDEO))),this.emit(ar.MEDIA_STREAM_ADDED,k)},this.onSubscriptionError=h=>{this.emit(ar.ERROR,h)},this.onSubscriptionSeiMessageReceived=h=>{this.emit(ar.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,h)},this.onSubscriptionTransformError=h=>{this.emit(ar.ERROR,h)},this.onSubscriptionReassignmentStart=()=>{for(const h of this.streams)h.pauseControls()},this.onSubscriptionReassignmentDone=()=>{for(const h of this.streams)h.resumeControls()},this.updateSubscribeStateIfNecessary=(h,b)=>{if(!this.info.capabilities.has(vl.SUBSCRIBE))return;b!==void 0&&(this.subscribeConfig=b,this.subscription.updateSubscribeConfig(b),this.streams.forEach((ie=>{ie.updateSubscribeConfig(b)})));const k=h!==io.NONE&&this.publishState===_a.PUBLISHED,F=this.subscribeState!==Go.NOT_SUBSCRIBED&&this.subscribeState!==Go.ERRORED;if(k&&!F)this.subscription.updateDesiredSubscribeType(h),this.subscribe();else if(!k&&F)this.unsubscribe(),this.subscription.updateDesiredSubscribeType(h);else if(this.subscribeState===Go.SUBSCRIBED&&this.subscription.getDesiredSubscribeType()!==h)try{h===io.AUDIO_ONLY?this.emit(ar.MEDIA_STREAM_REMOVED,this.filterStreamsByType(this.streams,Vr.VIDEO)):h===io.AUDIO_VIDEO&&this.emit(ar.MEDIA_STREAM_ADDED,this.filterStreamsByType(this.streams,Vr.VIDEO)),this.subscription.updateDesiredSubscribeType(h)}catch(ie){this.logger.error({err:ie,msg:"error updating subscribe type"})}},this.updatePublishState=h=>{const b=h&&this.publishState===_a.PUBLISHED,k=!h&&this.publishState===_a.NOT_PUBLISHED;return!b&&!k&&(this.info.isPublishing=h,this.publishState=h?_a.PUBLISHED:_a.NOT_PUBLISHED,!0)},this.updateStreamState=(h,b)=>{this.audioMuted!==h&&(this.audioMuted=h,this.info.audioMuted=h,this.updateStreamMuteState(Vr.AUDIO,h)),this.videoStopped!==b&&(this.videoStopped=b,this.info.videoStopped=b,this.updateStreamMuteState(Vr.VIDEO,b))},this.updateStreamMuteState=(h,b)=>{const k=this.filterStreamsByType(this.streams,h),F=k[k.length-1];if(!F){const ie=`state update received for ${this.info.id} for non-existent ${h} stream`;return this.logger.warn({msg:ie}),void this.traceRemoteParticipantMsg(ie)}F.setMuted(b),this.emit(ar.MEDIA_STREAM_MUTE_CHANGED,F)},this.cleanup=()=>{this.removeAllListeners()},this.quickUnsubscribe=()=>this.subscribeState!==Go.NOT_SUBSCRIBED&&this.subscription.stop(!0),this.getDesiredSubscribeType=()=>this.subscription.getDesiredSubscribeType(),this.isReassigning=()=>this.reassigning,this.analyticsTracker=Ee,this.token=P,this.subscribeConfig=ue,this.createSubscription=()=>{const h=new mr(C.id,P,H,X,Ee,te,ue);return h.on(Al,this.onSubscriptionStateChange),h.on(js,this.onSubscriptionStreamCreated),h.on(Cl,this.onSubscriptionStreamRemoved),h.on(Vh,this.onSubscriptionError),h.on(Ic,this.onSubscriptionSeiMessageReceived),h.on(us,this.onSubscriptionTransformError),h.on(uc,this.onSubscriptionReassignmentStart),h.on(Gh,this.onSubscriptionReassignmentDone),h.on(Wl,this.onSubscriptionReassignmentDone),h},this.subscription=this.createSubscription(),w&&(this.publishState=_a.PUBLISHED)}updateSubscriptionState(C){C!==this.subscribeState&&(this.subscribeState=C,this.emit(ar.SUBSCRIPTION_STATE_CHANGE,this.subscribeState))}pruneInactiveStreams(){const C=[];this.streams=this.streams.filter((te=>!!vr(te.mediaStreamTrack)||(C.push(te),!1)));const P=C.length;if(P===0)return;const H=this.filterStreamsByType(C,Vr.AUDIO).length,X=P-H;this.traceRemoteParticipantMsg(`Pruning inactive streams (${H} audio, ${X} video)`),this.emitStreamsRemoved(C),C.forEach((te=>{te.remote.cleanup(),te.cleanup()}))}filterStreamsByType(C,P){return C.filter((H=>H.streamType===P))}participantLeave(){this.left=!0}subscribe(){this.left?this.logger.warn({msg:"tried to subscribe to a participant that left"}):(this.updateSubscriptionState(Go.ATTEMPTING_SUBSCRIBE),this.logger.debug({msg:"subscribe"}),this.subscription.start())}unsubscribe(){if(this.subscribeState===Go.NOT_SUBSCRIBED)return;this.logger.debug({msg:"unsubscribe"}),this.subscription.stop(),this.subscription.off(Al,this.onSubscriptionStateChange),this.subscription.off(js,this.onSubscriptionStreamCreated),this.subscription.off(Cl,this.onSubscriptionStreamRemoved),this.subscription.off(Vh,this.onSubscriptionError),this.subscription.off(us,this.onSubscriptionTransformError);const C=this.getDesiredSubscribeType();this.subscription=this.createSubscription(),this.emitStreamsRemovedByType(C),this.updateSubscriptionState(Go.NOT_SUBSCRIBED),this.cleanupStreams()}emitStreamsRemovedByType(C){switch(C){case io.AUDIO_VIDEO:this.emitStreamsRemoved(this.streams);break;case io.AUDIO_ONLY:this.emitStreamsRemoved(this.filterStreamsByType(this.streams,Vr.AUDIO));case io.NONE:}}emitStreamsRemoved(C){this.emit(ar.MEDIA_STREAM_REMOVED,C)}cleanupStreams(){this.streams.length!==0&&(this.logger.debug({msg:"Cleaning up streams due to internal removal"}),this.streams.forEach((C=>{C.remote.cleanup(),C.cleanup()})),this.streams=[])}traceRemoteParticipantMsg(C){this.analyticsTracker.trackEventNoSharedProps(new Ao(this.token,Xs(),C,Fn.SUBSCRIBE,this.info.id))}triggerIceRestart(C){return ud(this,void 0,void 0,(function*(){this.reassigning=!0;try{yield this.subscription.triggerIceRestart(C)}finally{this.reassigning=!1}}))}}const _g=Fn.PUBLISH;function Io(j,C,P){return new Br(Object.assign(Object.assign({},j),{token:C,traceId:P,location:"stage-publication.sendSeiMessage",tag:cc,action:Fn.PUBLISH}))}class ds{constructor(C,P){this.analyticsTracker=C,this.token=P,this.action=_g,this.traceId=Xs()}trackPublish(C){const{action:P,traceId:H,analyticsTracker:X,token:te}=this;return X.trackEvent(new i0({token:te,traceId:H})),{getTraceId:()=>H,trackPublishStarted({totalDurationWithRetries:ue,retryTimes:Ee,sfuResource:w,peerClientPerfStats:h,protocol:b}){const{optionsDuration:k,postDuration:F,timeToCandidate:ie,timeToConnected:pe,sdpExchangeDuration:ye,sdpExchangeTransport:Ae,setRemoteDescDuration:De,peerConnectionDuration:Fe}=h,{edpInitialConnectDuration:Ye,edpInitialConnectRetries:dt,edpInitialStateDuration:Et,edpStateUpdateCount:Pt}=C;X.trackEvent(new a0({token:te,traceId:H,optionsDuration:k,postDuration:F,timeToCandidate:ie,totalDuration:pe,edpInitialConnectDuration:Ye,edpInitialConnectRetries:dt,edpInitialStateDuration:Et,edpStateUpdateCount:Pt,sdpExchangeDuration:ye,sdpExchangeTransport:Ae,setRemoteDescDuration:De,peerConnectionDuration:Fe,publishRetries:Ee,totalDurationWithRetries:ue,sfuResource:w,protocol:b}))},trackPublishFailed(ue,Ee){const w=((b,k,F)=>{if(b instanceof Br)return b;let ie="";return b instanceof zo.AxiosError&&(ie+=`AxiosError - ${b.code}`),new Br(Object.assign(Object.assign(Object.assign({},hn.PUBLISH_FAILURE),{action:_g,token:k,traceId:F,tag:cc,location:"publish",details:`${ie} ${b.message}`}),{fatal:!0}))})(ue,te,H);X.trackEvent(new o0({token:te,traceId:H,code:w.code,message:w.message,fatal:w.fatal,nominal:w.nominal,protocol:Ee}));const h=new Br(Object.assign(Object.assign({},hn.PUBLISH_FAILURE),{action:P,token:te,traceId:H,tag:cc,location:"publish"}));return ue instanceof Br&&(h.fatal=ue.fatal,h.nominal=ue.nominal,h.location=`publish > ${ue.location}`),X.trackError(h),w},trackUnpublish:()=>{X.trackEvent(new s0({token:te,traceId:H}))},trackEndSucceeded:(ue,Ee)=>{X.trackEvent(new e_({token:te,isUnpublishSuccessful:!0,traceId:H,reason:ue,protocol:Ee}))},trackEndFailed:(ue,Ee)=>{const w=new Br(Object.assign(Object.assign({},hn.UNPUBLISH_FAILURE),{token:te,traceId:H,tag:Ja,location:"unpublish"}));return ue!==Ei.UNLOAD&&ue!==Ei.UNPUBLISH||this.analyticsTracker.trackError(w),X.trackEvent(new e_({token:te,isUnpublishSuccessful:!1,traceId:H,reason:ue,protocol:Ee})),w},createSeiNotPublishingVideoError:()=>Io(hn.SEI_INSERT_NOT_PUBLISHING_VIDEO,te,H),createSeiInBandMessagingNotEnabledError:()=>Io(hn.SEI_INSERT_INBAND_NOT_ENABLED,te,H)}}}var Qs,ec,ks=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};(function(j){j.DISCONNECTED="disconnected",j.CONNECTING="connecting",j.CONNECTED="connected",j.ERRORED="errored"})(Qs||(Qs={})),(function(j){j.STATE_CHANGE="stateChange",j.ERROR="error",j.TRANSFORM_ERROR="transformError"})(ec||(ec={}));class cf extends oc{constructor(C,P,H,X){super(),this.token=C,this.stageConnection=P,this.nonScopedLogger=H,this.analyticsTracker=X,this.streamsToPublish=[],this.publicationState=Qs.DISCONNECTED,this.latestPubAttemptNum=0,this.startConnectingTimestamp=-1,this.action=Fn.PUBLISH,this.start=te=>{this.publicationState===Qs.DISCONNECTED||this.publicationState===Qs.ERRORED?(this.streamsToPublish=te,this.latestPubAttemptNum=0,this.processStateUpdate()):this.logger.warn({msg:"publication cannot be started if not in disconnected or error state"})},this.requestRTCStats=te=>ks(this,void 0,void 0,(function*(){return this.peerClient.requestRTCStats(te)})),this.stop=(te=!1)=>ks(this,void 0,void 0,(function*(){this.peerClient.off(So,this.onPeerClientConnectionStateChange),this.peerClient.off(lh,this.onPeerClientTransformError),yield this.unpublish(te),this.updateState(Qs.DISCONNECTED)})),this.processStateUpdate=te=>{const{publicationState:ue}=this;ue===Qs.DISCONNECTED||ue===Qs.ERRORED?this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Qs.CONNECTING),this.tryPublish()):ue===Qs.CONNECTING?te===sr.CONNECTED&&this.updateState(Qs.CONNECTED):ue===Qs.CONNECTED&&te===sr.FAILED&&(this.attemptTracker&&this.attemptTracker.trackEndFailed(Ei.CONNECTION_FAIL,this.peerClient.getProtocol()),this.latestPubAttemptNum===0&&(this.startConnectingTimestamp=performance.now(),this.updateState(Qs.CONNECTING),this.tryPublish()))},this.updateState=te=>{this.publicationState=te,this.emit(ec.STATE_CHANGE,te)},this.tryPublish=()=>ks(this,void 0,void 0,(function*(){if(this.latestPubAttemptNum++,this.latestPubAttemptNum<=4){const te=this.stageConnection.getConnectionStats();this.attemptTracker=this.publishTracker.trackPublish(te);try{this.logger.debug({msg:`attempting to publish, attemptNum: ${this.latestPubAttemptNum}`}),yield this.publish(this.streamsToPublish,this.attemptTracker.getTraceId()),this.logger.debug({msg:"publish succeeded!"});const ue=this.peerClient.getSfuResource(),Ee=this.latestPubAttemptNum-1,w=performance.now()-this.startConnectingTimestamp,h=this.peerClient.getActionMeasurements();this.attemptTracker.trackPublishStarted({sfuResource:ue,totalDurationWithRetries:w,retryTimes:Ee,peerClientPerfStats:h,protocol:this.peerClient.getProtocol()}),this.latestPubAttemptNum=0}catch(ue){this.logger.error({msg:"publish failed!",err:ue});const Ee=this.attemptTracker.trackPublishFailed(ue,this.peerClient.getProtocol()),w=Ee.code===hn.OPERATION_ABORTED.code,h=Ee.fatal,b=this.latestPubAttemptNum===4;if(w)return;if(h||b)return this.logger.error({msg:`Stopping attempts: isFatal=${h}, isLastAttempt=${b}`,err:ue}),this.updateState(Qs.ERRORED),void this.emit(ec.ERROR,Ee);const k=1e3*Math.pow(2,this.latestPubAttemptNum);this.logger.debug({msg:`attempt failed, retrying in ${k}ms`}),this.nextAttemptTimerId=window.setTimeout((()=>{this.tryPublish()}),k)}}})),this.publish=(te,ue)=>ks(this,void 0,void 0,(function*(){this.peerClient.initStreamsToPublish(te),yield this.peerClient.connect({audioOnly:!1,traceId:ue})})),this.unpublish=(te=!1)=>ks(this,void 0,void 0,(function*(){if(window.clearTimeout(this.nextAttemptTimerId),this.publicationState===Qs.DISCONNECTED||this.publicationState===Qs.ERRORED||!this.attemptTracker)return;this.attemptTracker.trackUnpublish();const ue=te?Ei.UNLOAD:Ei.UNPUBLISH,Ee=this.peerClient.getProtocol();try{te?this.peerClient.disconnect(te):yield this.peerClient.disconnect(te),this.attemptTracker.trackEndSucceeded(ue,Ee)}catch{this.attemptTracker.trackEndFailed(ue,Ee)}})),this.replaceOrUpdateStream=te=>ks(this,void 0,void 0,(function*(){this.streamsToPublish.find((ue=>ue.track.kind===te.track.kind))?this.streamsToPublish=this.streamsToPublish.map((ue=>ue.track.kind===te.track.kind?te:ue)):this.streamsToPublish.push(te),yield this.peerClient.replaceOrUpdateStream(te)})),this.onPeerClientConnectionStateChange=te=>{this.logger.debug({msg:`onPeerClientConnectionStateChange: ${te}`,state:te}),this.processStateUpdate(te)},this.onPeerClientTransformError=te=>{this.emit(ec.TRANSFORM_ERROR,te)},this.onIncompatibleCodecs=te=>ks(this,void 0,void 0,(function*(){yield this.peerClient.onIncompatibleCodecs(te)})),this.sendSeiMessage=(te,ue)=>{if(this.publicationState!==Qs.CONNECTED)return this.attemptTracker&&this.emit(ec.ERROR,this.attemptTracker.createSeiNotPublishingVideoError()),Qn.err(sa.NOT_PUBLISHING_VIDEO);const Ee=this.peerClient.sendSeiMessage(te,ue),w=Qn.getErr(Ee);return w&&this.attemptTracker&&(w===sa.INBAND_MESSAGING_NOT_ENABLED?this.emit(ec.ERROR,this.attemptTracker.createSeiInBandMessagingNotEnabledError()):w===sa.NOT_PUBLISHING_VIDEO&&this.emit(ec.ERROR,this.attemptTracker.createSeiNotPublishingVideoError())),Ee},this.peerClient=new ys(C,this.nonScopedLogger,this.action,On(this.action),Xs(),this.analyticsTracker,void 0,P,void 0),this.logger=new wn(H,_e.PUBLICATION),this.peerClient.on(So,this.onPeerClientConnectionStateChange),this.peerClient.on(lh,this.onPeerClientTransformError),this.publishTracker=new ds(this.analyticsTracker,this.token)}removeTrack(C){return ks(this,void 0,void 0,(function*(){this.streamsToPublish=this.streamsToPublish.filter((P=>P.track.kind!==C)),yield this.peerClient.removeTrack(C)}))}}var ui,au=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};class Sh extends iu{constructor(C,P,H,X,te){super(C,new wn(H,_e.LOCAL_PARTICIPANT)),this.onPublicationStateChange=ue=>{switch(this.logger.debug({msg:"publicationStateChange",state:ue}),ue){case"connected":this.connection.setStagePublishing(!0),this.updatePublishState(_a.PUBLISHED);break;case"connecting":this.updatePublishState(_a.ATTEMPTING_PUBLISH);break;case"errored":this.updatePublishState(_a.ERRORED),this.connection.setStagePublishing(!1);break;default:return void this.logger.warn({msg:"FIXME onPublicationStateChange UNHANDLED STATE",state:ue})}},this.onPublicationError=ue=>{this.emit($o.ERROR,ue)},this.updatePublishState=ue=>{this.info.isPublishing=ue===_a.PUBLISHED,this.publishState=ue,this.emit($o.PUBLICATION_STATE_CHANGE,this.publishState)},this.handleMute=ue=>{ue.streamType===Vr.AUDIO&&(this.audioMuted=ue.isMuted,this.info.audioMuted=ue.isMuted),ue.streamType===Vr.VIDEO&&(this.videoStopped=ue.isMuted,this.info.videoStopped=ue.isMuted),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.emit($o.MEDIA_STREAM_MUTE_CHANGED,ue)},this.handleInsertSeiMsgRequest=(ue,Ee,w)=>{this.sendSeiMessage(Ee,w?.repeatCount)},this.publish=ue=>{this.logger.debug({msg:"publish"}),ue.forEach((w=>{w&&(this.setupStreamListeners(w),w.streamType===Vr.AUDIO?(this.audioStream=w,this.audioMuted=!w.mediaStreamTrack.enabled,this.info.audioMuted=this.audioMuted):w.streamType===Vr.VIDEO&&(this.videoStream=w,this.videoStopped=!w.mediaStreamTrack.enabled,this.info.videoStopped=this.videoStopped),w.setGetStats(this.publication.requestRTCStats))})),this.connection.emitStageState(this.audioMuted,this.videoStopped);const Ee=ue.map((w=>cm(w)));this.publication.start(Ee)},this.cleanup=()=>this.removeAllListeners(),this.quickUnpublish=()=>this.publishState!==_a.NOT_PUBLISHED&&this.publishState!==_a.ERRORED&&void this.publication.stop(!0),this.onIncompatibleCodecs=ue=>au(this,void 0,void 0,(function*(){yield this.publication.onIncompatibleCodecs(ue)})),this.sendSeiMessage=(ue,Ee=0)=>this.publication.sendSeiMessage(ue,Ee),this.sendSeiMessageString=(ue,Ee=0)=>{const w=new TextEncoder().encode(ue);return this.publication.sendSeiMessage(w,Ee)},this.connection=X,this.createPublication=()=>{const ue=new cf(P,X,H,te);return ue.on(ec.STATE_CHANGE,this.onPublicationStateChange),ue.on(ec.ERROR,this.onPublicationError),ue.on(ec.TRANSFORM_ERROR,this.onPublicationError),ue},this.publication=this.createPublication()}setupStreamListeners(C){C.on(Zr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),C.streamType===Vr.VIDEO&&C.on(Zr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleInsertSeiMsgRequest)}removeTrack(C){var P,H,X;C.streamType===Vr.AUDIO?((P=this.audioStream)===null||P===void 0||P.off(Zr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),this.audioStream=void 0,this.audioMuted=!0,this.info.audioMuted=!0):C.streamType===Vr.VIDEO&&((H=this.videoStream)===null||H===void 0||H.off(Zr.LOCAL_STREAM_MUTE_CHANGED,this.handleMute),(X=this.videoStream)===null||X===void 0||X.off(Zr.LOCAL_STREAM_INSERT_SEI_MSG_REQUEST,this.handleMute),this.videoStream=void 0,this.videoStopped=!0,this.info.videoStopped=!0),this.connection.emitStageState(this.audioMuted,this.videoStopped),this.publication.removeTrack(C.streamType)}replaceOrAddTrack(C){return au(this,void 0,void 0,(function*(){this.setupStreamListeners(C),C.setGetStats(this.publication.requestRTCStats),C.streamType===Vr.AUDIO?(this.audioStream=C,this.audioMuted=!C.mediaStreamTrack.enabled):C.streamType===Vr.VIDEO&&(this.videoStream=C,this.videoStopped=!C.mediaStreamTrack.enabled),this.connection.emitStageState(this.audioMuted,this.videoStopped);const P=cm(C);yield this.publication.replaceOrUpdateStream(P)}))}unpublish(){if(this.publishState===_a.NOT_PUBLISHED||this.publishState===_a.ERRORED)return;this.logger.debug({msg:"unpublish"}),this.connection.setStagePublishing(!1),this.publication.stop(),this.publication.off(ec.STATE_CHANGE,this.onPublicationStateChange),this.publication.off(ec.ERROR,this.onPublicationError),this.publication.off(ec.TRANSFORM_ERROR,this.onPublicationError);const C=[this.audioStream,this.videoStream].filter((P=>!!P));C.forEach((P=>{P.cleanup()})),this.audioStream=void 0,this.videoStream=void 0,this.emit($o.MEDIA_STREAM_REMOVED,C),this.updatePublishState(_a.NOT_PUBLISHED),this.publication=this.createPublication()}}(function(j){j.STAGE_CONNECTION_STATE_CHANGED="stageConnectionStateChanged",j.STAGE_PARTICIPANT_JOINED="stageParticipantJoined",j.STAGE_PARTICIPANT_LEFT="stageParticipantLeft",j.STAGE_PARTICIPANT_STREAMS_ADDED="stageParticipantStreamsAdded",j.STAGE_PARTICIPANT_STREAMS_REMOVED="stageParticipantStreamsRemoved",j.STAGE_STREAM_MUTE_CHANGED="stageStreamMuteChanged",j.STAGE_STREAM_SEI_MESSAGE_RECEIVED="stageStreamSeiMessageReceived",j.STAGE_STREAM_LAYERS_CHANGED="stageStreamLayersChanged",j.STAGE_STREAM_LAYER_SELECTED="stageStreamLayerSelected",j.STAGE_STREAM_ADAPTION_CHANGED="stageStreamAdaptionChanged",j.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED="stageParticipantSubscribeStateChanged",j.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED="stageParticipantPublishStateChanged",j.ERROR="error",j.STAGE_LEFT="stageLeft"})(ui||(ui={}));var fd=function(j,C,P,H){return new(P||(P=Promise))((function(X,te){function ue(h){try{w(H.next(h))}catch(b){te(b)}}function Ee(h){try{w(H.throw(h))}catch(b){te(b)}}function w(h){var b;h.done?X(h.value):(b=h.value,b instanceof P?b:new P((function(k){k(b)}))).then(ue,Ee)}w((H=H.apply(j,[])).next())}))};const hm=j=>!!j;class va extends oc{constructor(C,P){super(),this.connectionState=Cs.DISCONNECTED,this.participants=new Map,this.connectionStateErrored=!1,this.onConnectionStateChanged=(X,te)=>{var ue,Ee;if(this.connectionState=X,X===Cs.ERRORED&&(this.connectionStateErrored=!0),X===Cs.CONNECTED&&this.localParticipant&&this.localParticipant.publishState!==_a.NOT_PUBLISHED&&this.stageConnection.emitStageState((ue=this.localParticipant)===null||ue===void 0?void 0:ue.audioMuted,(Ee=this.localParticipant)===null||Ee===void 0?void 0:Ee.videoStopped),X===Cs.CONNECTED&&this.connectionStateErrored&&(this.connectionStateErrored=!1,this.refreshStrategy()),X===Cs.DISCONNECTED){if(te&&te!==Jl.CLIENT_RECONNECT&&te!==Jl.USER_INITIATED){let w=jf.UNKNOWN;(function(h){return Object.values(jf).includes(h)})(te)?w=te:this.logger.warn({msg:`DISCONNECTED reason is not a StageLeftReason: ${te}`}),this.cleanup(w)}}else this.emit(ui.STAGE_CONNECTION_STATE_CHANGED,this.connectionState)},this.setupLocalParticipantOnce=()=>{var X;this.localParticipant?this.analyticsTracker.trackEventNoSharedProps(new Ao(this.token,(X=this.joinTraceId)!==null&&X!==void 0?X:new Kg,"reusing local participant from repeat join",Fn.JOIN,"")):this.createLocalParticipant()},this.createLocalParticipant=()=>{const X=(function(te){var ue,Ee;const w=new Set;return te.token.claims.capabilities.allow_publish&&w.add(vl.PUBLISH),te.token.claims.capabilities.allow_subscribe&&w.add(vl.SUBSCRIBE),{id:te.token.participantID,userId:(ue=te.token.userID)!==null&&ue!==void 0?ue:"",attributes:(Ee=te.token.claims.attributes)!==null&&Ee!==void 0?Ee:{},capabilities:w,isLocal:!0,userInfo:{},videoStopped:te.videoStopped,audioMuted:te.audioMuted,isPublishing:te.isPublishing}})({token:this.token,videoStopped:!0,audioMuted:!0,isPublishing:!1});this.localParticipant=new Sh(X,this.token,this.logger.unwrap(),this.stageConnection,this.analyticsTracker),this.localParticipant.on($o.PUBLICATION_STATE_CHANGE,(te=>{this.onPublishStateChanged(this.localParticipant.info,te)})),this.localParticipant.on($o.MEDIA_STREAM_REMOVED,this.onLocalStreamsRemoved),this.localParticipant.on($o.MEDIA_STREAM_MUTE_CHANGED,(te=>{this.localParticipant?this.onStreamMuteChange(this.localParticipant.info,te):this.logger.warn({msg:"tried to emit a stream mute change event for undefined local participant"})})),this.localParticipant.on($o.ERROR,(te=>{this.errorManager.handleError(te,fr.PUBLISH_ERROR)})),this.emit(ui.STAGE_PARTICIPANT_JOINED,X)},this.onRemoteParticipantJoined=X=>{if(X.id!==this.token.participantID){const te=(function(h){return{id:h.id,userId:h.userId,attributes:h.attributes,capabilities:new Set([vl.SUBSCRIBE]),isLocal:!1,userInfo:{},videoStopped:h.videoStopped,audioMuted:h.audioMuted,isPublishing:h.isPublishing}})(X);if(this.participants.has(te.id))return void this.logger.warn({msg:"Remote participant already tracked"});let ue=io.NONE;te.capabilities.has(vl.SUBSCRIBE)&&(ue=Qn.getOk_or(this.strategyWrapper.shouldSubscribeToParticipant(te),ue),this.updateManagerWithExternalSubscribeConfig(te,"joined"));const Ee=this.configManager.getSubscribeConfigSnapshot(te.id),w=new bh(te,this.token,this.stageConnection,this.logger.unwrap(),ue,Ee,this.analyticsTracker,X.isPublishing);this.participants.set(te.id,w),this.setupRemoteParticipantListeners(w),this.emit(ui.STAGE_PARTICIPANT_JOINED,w.info),w.updateSubscribeStateIfNecessary(ue)}},this.setupRemoteParticipantListeners=X=>{X.on(ar.SUBSCRIPTION_STATE_CHANGE,(te=>{this.onParticipantSubscribeStateChanged(X.info.id,te)})),X.on(ar.MEDIA_STREAM_ADDED,(te=>{const ue=this.participants.get(X.info.id);if(ue){for(const Ee of te)this.setupRemoteParticipantStreamEvents(ue.info,Ee);this.emit(ui.STAGE_PARTICIPANT_STREAMS_ADDED,ue.info,yh(te)),this.updateStreamLayerForParticipantInfo(X.info,X.streams)}else this.logger.warn({msg:"Got stream add for participant no longer being tracked"})})),X.on(ar.MEDIA_STREAM_REMOVED,(te=>{const ue=this.participants.get(X.info.id);ue?this.emit(ui.STAGE_PARTICIPANT_STREAMS_REMOVED,ue.info,yh(te)):this.logger.warn({msg:"Got stream remove for participant no longer being tracked"})})),X.on(ar.MEDIA_STREAM_MUTE_CHANGED,(te=>{this.onStreamMuteChange(X.info,te.remote)})),X.on(ar.ERROR,(te=>{this.errorManager.handleError(te,fr.SUBSCRIBE_ERROR)})),X.on(ar.MEDIA_STREAM_SEI_MESSAGE_RECEIVED,(te=>{this.onSeiMessageReceived(X.info,te)}))},this.onRemoteParticipantLeft=X=>{if(this.connectionState!==Cs.CONNECTED)return;const te=this.participants.get(X);te?(te.participantLeave(),te.unsubscribe(),te.cleanup(),this.participants.delete(X),this.emitParticipantLeave(te.info)):this.logger.warn({msg:"Remote participant no longer tracked"})},this.emitParticipantLeave=X=>{this.emit(ui.STAGE_PARTICIPANT_LEFT,X)},this.onRemoteParticipantStateChanged=X=>{const te=this.participants.get(X.id);if(!te)return void this.logger.warn({msg:"Remote participant updated but not tracked"});te.updatePublishState(X.isPublishing)&&this.onPublishStateChanged(te.info,te.publishState),te.updateStreamState(X.audioMuted,X.videoStopped);const ue=this.strategyWrapper.shouldSubscribeToParticipant(te.info);if(Qn.isNotOk(ue))return;this.updateManagerWithExternalSubscribeConfig(te.info,"updated");const Ee=this.configManager.getSubscribeConfigSnapshot(te.info.id),w=Qn.getOk_or(ue,io.NONE);te.updateSubscribeStateIfNecessary(w,Ee)},this.onPublishStateChanged=(X,te)=>{this.emit(ui.STAGE_PARTICIPANT_PUBLISH_STATE_CHANGED,X,te)},this.onParticipantSubscribeStateChanged=(X,te)=>{const ue=this.participants.get(X);ue?this.emit(ui.STAGE_PARTICIPANT_SUBSCRIBE_STATE_CHANGED,ue.info,te):this.logger.warn({msg:"Remote participant subscribe state changed but not tracked"})},this.onLocalStreamsAdded=X=>{this.localParticipant&&this.emit(ui.STAGE_PARTICIPANT_STREAMS_ADDED,this.localParticipant.info,X)},this.onLocalStreamsRemoved=X=>{this.localParticipant&&this.emit(ui.STAGE_PARTICIPANT_STREAMS_REMOVED,this.localParticipant.info,X)},this.onStreamMuteChange=(X,te)=>{this.emit(ui.STAGE_STREAM_MUTE_CHANGED,X,te)},this.onSeiMessageReceived=(X,te)=>{this.emit(ui.STAGE_STREAM_SEI_MESSAGE_RECEIVED,X,te)},this.leave=()=>{this.cleanup(jf.USER_INITIATED)},this.onBeforeUnloadCleanup=()=>{var X;this.participants.forEach((te=>{te.quickUnsubscribe()})),(X=this.localParticipant)===null||X===void 0||X.quickUnpublish(),this.stageConnection.disconnect(),this.emit(ui.STAGE_CONNECTION_STATE_CHANGED,Cs.DISCONNECTED),this.analyticsTracker.stop(!0)},this.cleanup=X=>{if(!this.localParticipant)return;this.analyticsTracker.trackEventNoSharedProps(new Ku({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId,reason:X})),this.localParticipant.unpublish(),this.localParticipant.cleanup();const te=this.localParticipant.info;this.localParticipant=void 0,this.emitParticipantLeave(te);const ue=this.participants.entries();for(const[Ee,w]of ue)w.unsubscribe(),this.participants.delete(Ee),w.cleanup(),this.emitParticipantLeave(w.info);ml.destroy(this.analyticsTracker.getSessionId()),this.stageConnection.disconnect(),this.emit(ui.STAGE_CONNECTION_STATE_CHANGED,Cs.DISCONNECTED),this.emit(ui.STAGE_LEFT,X),this.analyticsTracker.stop(!1),window.removeEventListener("beforeunload",this.onBeforeUnloadCleanup)},this.refreshStrategy=()=>{this.participants.forEach((X=>{if(X.info.capabilities.has(vl.SUBSCRIBE)){const te=this.strategyWrapper.shouldSubscribeToParticipant(X.info);if(Qn.isNotOk(te))return;const ue=Qn.getOk_or(te,io.NONE);this.updateManagerWithExternalSubscribeConfig(X.info,"updated");const Ee=this.configManager.getSubscribeConfigSnapshot(X.info.id);X.updateSubscribeStateIfNecessary(ue,Ee),this.updateStreamLayerForParticipantInfo(X.info,X.streams)}})),this.updateStreamsToPublishIfNecessary()},this.updateStreamsToPublishIfNecessary=()=>{var X;if(!this.localParticipant||!(!((X=this.localParticipant)===null||X===void 0)&&X.info.capabilities.has(vl.PUBLISH)))return;const te=this.localParticipant.publishState!==_a.NOT_PUBLISHED&&this.localParticipant.publishState!==_a.ERRORED,ue=this.strategyWrapper.shouldPublishParticipant(this.localParticipant.info);if(Qn.isNotOk(ue))return;let Ee=Qn.getOk_or(ue,!1);if(!te&&!Ee)return;if(te&&!Ee)return void this.localParticipant.unpublish();const w=this.strategyWrapper.stageStreamsToPublish();if(Qn.isNotOk(w)){const b=Qn.getErr(w);if(b instanceof Error&&b.cause==="UserStrategy")throw b;return}const h=Qn.getOk_or(w,[]);Ee=Ee&&h.length>0,!te&&Ee?(this.localParticipant.publish(h),this.onLocalStreamsAdded(h)):this.syncTracksToPublish(h)},this.syncTracksToPublish=X=>{var te;if(!this.localParticipant)return;const ue=this.localParticipant.audioStream,Ee=this.localParticipant.videoStream,{updates:w,streamsToAdd:h,streamsToRemove:b}=this.determineStreamUpdates(ue,Ee,X);if(w.length){for(const k of w)k.newStream?(te=this.localParticipant)===null||te===void 0||te.replaceOrAddTrack(k.newStream):k.oldStream&&this.localParticipant.removeTrack(k.oldStream);b.length!==0&&this.onLocalStreamsRemoved(b),h.length!==0&&this.onLocalStreamsAdded(h)}},this.determineStreamUpdates=(X,te,ue=[])=>{const Ee=[],w=ue.slice(0,2);if(w.sort(((k,F)=>k.streamType===Vr.AUDIO?-1:1)),w.length===0)X&&Ee.push({oldStream:X}),te&&Ee.push({oldStream:te});else if(w.length===1){const k=w[0];k.streamType===Vr.AUDIO?te&&Ee.push({oldStream:te}):k.streamType===Vr.VIDEO&&X&&Ee.push({oldStream:X})}w.forEach((k=>{var F,ie;k.streamType===Vr.AUDIO?X?X.id===k.id&&(0,zs.isEqual)(X.mediaConfig,k.mediaConfig)||(!!(!((F=X.mediaConfig)===null||F===void 0)&&F.stereo)!=!!(!((ie=k.mediaConfig)===null||ie===void 0)&&ie.stereo)&&this.logger.warn({msg:"Ignoring change to audio stream's stereo configuration. Re-publish to change stereo configuraiton."}),Ee.push({oldStream:X,newStream:k})):Ee.push({newStream:k}):k.streamType===Vr.VIDEO&&(te?te.id===k.id&&(0,zs.isEqual)(te.mediaConfig,k.mediaConfig)||Ee.push({oldStream:te,newStream:k}):Ee.push({newStream:k}))}));const h=Ee.map((k=>k.newStream)).filter(hm),b=Ee.map((k=>k.oldStream)).filter(hm);return{updates:Ee,streamsToAdd:h,streamsToRemove:b}},this.onReassignmentMessage=X=>fd(this,void 0,void 0,(function*(){if(pa("disableReassignments"))return void this.logger.debug({msg:"REASSIGN message ignored: disableReassignments is configured"});if(!_p.browser.isChrome())return void this.logger.debug({msg:"REASSIGN message ignored: browser is not chrome"});const te=Xs();this.trackReassignmentRequest(X,te);const ue=this.participants.get(X.remoteParticipantId),Ee=this.token.participantID,w=(function(h,{localParticipantId:b,remoteParticipant:k}){const{participantId:F}=h;if(b!==F)return Qn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_LOCAL_PARTICIPANT_ID),{details:`Invalid participantId received: ${F}`}));if(!k)return Qn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_REMOTE_PARTICIPANT_ID),{details:`Invalid remoteParticipantId received: ${k}`}));if(k.isReassigning())return Qn.err(hn.REASSIGNMENT_REQUEST_ALREADY_IN_PROGRESS);const ie=k.subscription.peerClient.getConnectionState();return[sr.CONNECTED,sr.DISCONNECTED].includes(ie)?Qn.ok(k):Qn.err(Object.assign(Object.assign({},hn.REASSIGNMENT_REQUEST_INVALID_REMOTE_PEER_CONNECTION_STATE),{details:`connectionState: ${ie}`}))})(X,{localParticipantId:Ee,remoteParticipant:ue});if(!w.ok)this.trackReassignmentRequestRejected(w.error,te);else try{const{token:h,nodeOverride:b}=X;yield w.value.triggerIceRestart({assignmentToken:h,traceId:te,nodeOverride:b})}catch(h){this.logger.error({msg:"Reassignment failed.",err:h})}})),this.onIncompatibleCodecsMessage=X=>fd(this,void 0,void 0,(function*(){var te;yield(te=this.localParticipant)===null||te===void 0?void 0:te.onIncompatibleCodecs(X.codecs)})),this.analyticsTracker=new sh;const H=lp();this.logger=new wn(new tn(H),_e.STAGE),this.strategyWrapper=new ru(P,this.logger),this.configManager=new la({logger:this.logger.unwrap(),subscribeDefaults:{jitterBuffer:{minDelayWhenPublishing:ol.DEFAULT,minDelayWhenSubscribeOnly:ol.DEFAULT},inBandMessaging:{enabled:!1},simulcast:{initialLayerPreference:mh.LOWEST_QUALITY,layerPollingEnabled:!0,layerPollingIntervalMs:3e3}}}),this.errorManager=new Ep(this.logger.unwrap());try{this.token=Md(C,this.analyticsTracker)}catch(X){const te=new Br(Object.assign({action:Fn.JOIN,token:C,traceId:Xs(),tag:ve,location:"Stage.constructor"},hn.MALFORMED_TOKEN));throw X instanceof Error&&(te.details=X.message),this.errorManager.handleError(te,fr.JOIN_ERROR)||X}this.stageConnection=new _h(this.token,this.logger.unwrap(),this.analyticsTracker),this.setupListeners()}setupListeners(){this.stageConnection.on(dp,((C,P)=>{this.onConnectionStateChanged(C,P)})),this.stageConnection.on(Of,(C=>{this.onRemoteParticipantJoined(C)})),this.stageConnection.on(If,(C=>{this.onRemoteParticipantLeft(C.id)})),this.stageConnection.on(To,(C=>{var P;C.id!==((P=this.localParticipant)===null||P===void 0?void 0:P.info.id)&&this.onRemoteParticipantStateChanged(C)})),this.stageConnection.on(Ia,(C=>fd(this,void 0,void 0,(function*(){yield this.onReassignmentMessage(C)})))),this.stageConnection.on(dh,(C=>fd(this,void 0,void 0,(function*(){yield this.onIncompatibleCodecsMessage(C)})))),this.stageConnection.on(wo,(C=>{C instanceof Br&&this.analyticsTracker.trackError(C),this.errorManager.handleError(C,fr.JOIN_ERROR)})),this.errorManager.on(nu.ERROR,(C=>{this.emit(ui.ERROR,C)}))}setupRemoteParticipantStreamEvents(C,P){const H=P.remote;P.on(_l.ADAPTION_CHANGED,(X=>{this.emit(ui.STAGE_STREAM_ADAPTION_CHANGED,C,H,X)})),P.on(_l.LAYERS_CHANGED,(X=>{this.emit(ui.STAGE_STREAM_LAYERS_CHANGED,C,H,X),this.updateStreamLayerForParticipantInfo(C,[P])})),P.on(_l.LAYER_SELECTED,((X,te)=>{this.emit(ui.STAGE_STREAM_LAYER_SELECTED,C,H,X,te)})),P.layers.length>0&&(this.emit(ui.STAGE_STREAM_LAYERS_CHANGED,C,H,H.getLayers()),this.emit(ui.STAGE_STREAM_LAYER_SELECTED,C,H,H.getSelectedLayer(),Zi.SELECTED))}join(){return fd(this,void 0,void 0,(function*(){this.analyticsTracker.start(),this.joinTraceId=Xs(),this.analyticsTracker.trackEvent(new sd({token:this.token,eventEndpoint:this.token.eventsURL,whipEndpoint:this.token.whipURL,traceId:this.joinTraceId}));try{this.token.assertTokenIsUnexpired(Xs(),ve,"join")}catch(C){throw this.errorManager.handleError(C,fr.JOIN_ERROR)||C}try{this.joinTraceId=yield this.stageConnection.connect(this.joinTraceId),this.connectionState===Cs.CONNECTED&&(this.setupLocalParticipantOnce(),this.updateStreamsToPublishIfNecessary()),window.addEventListener("beforeunload",this.onBeforeUnloadCleanup)}catch(C){throw this.logger.error({err:C,msg:"error joining stage"}),this.errorManager.handleError(C,fr.JOIN_ERROR,!1)||C}}))}replaceStrategy(C){this.strategyWrapper.setStrategy(C),this.refreshStrategy()}updateManagerWithExternalSubscribeConfig(C,P){var H;const X=Qn.getOk(this.strategyWrapper.subscribeConfiguration(C)),te=Qn.getOk(this.getRemoteSubscribeConfiguration()),ue=this.getInternalSubscribeOverrides(),Ee=C.id;let w=!1;X&&(w=this.configManager.handleExternalSubscribeConfigUpdate(Ee,X,ko.API));let h=!1;te&&(h=this.configManager.handleSubscribeConfigUpdate(Ee,te,ko.REMOTE));let b=!1;if(ue&&(b=this.configManager.handleSubscribeConfigUpdate(Ee,ue,ko.INTERNAL)),w||h||b){const k=this.configManager.getSubscribeConfigSnapshot(Ee);this.analyticsTracker.trackEventNoSharedProps(new Iu(this.token,(H=this.joinTraceId)!==null&&H!==void 0?H:Xs(),P==="joined"?"initial":"ad-hoc",Ee,k))}}getRemoteSubscribeConfiguration(){return Qn.err("todo")}getInternalSubscribeOverrides(){const C=this.strategyWrapper.hasStrategy("preferredLayerForStream"),P=this.hasListenersFor(ui.STAGE_STREAM_LAYERS_CHANGED)||this.hasListenersFor(ui.STAGE_STREAM_ADAPTION_CHANGED)||this.hasListenersFor(ui.STAGE_STREAM_LAYER_SELECTED);return{simulcast:{layerPollingEnabled:C||P}}}updateStreamLayerForParticipantInfo(C,P){P.forEach((H=>{if(H.streamType==="audio")return;const X=this.strategyWrapper.preferredLayerForStream(C,H.remote),te=Qn.getOk_or(X,void 0);H.setLayer(te)}))}trackReassignmentRequestRejected(C,P){const{token:H}=this,X=new Br(Object.assign(Object.assign({},C),{token:H,action:Fn.JOIN,traceId:P,tag:Ai,location:"publish"}));this.logger.error({err:X,msg:"Reassignment request rejected."}),this.analyticsTracker.trackError(X)}trackReassignmentRequest(C,P){const{token:H}=this;this.analyticsTracker.trackEvent(new xp({token:H,traceId:P,targetLocalParticipantId:C.participantId,targetRemoteParticipantId:C.remoteParticipantId}))}}var jf;(function(j){j.UNKNOWN="unknown",j.USER_INITIATED="user-initiated",j.TOKEN_REUSED="token-reused",j.PARTICIPANT_DISCONNECTED="participant-disconnected",j.STAGE_DELETED="stage-deleted"})(jf||(jf={}));const Du=f})(),s})()))})(NF)),NF.exports}var g0t=m0t();const kS=Bh(g0t),wbe="0123456789abcdefABCDEF";wbe.split("").map(n=>n.codePointAt(0));Array(256).fill(!0).map((n,e)=>{const t=String.fromCodePoint(e),r=wbe.indexOf(t);return r<0?void 0:r<16?r:r-6});new TextEncoder;new TextDecoder;function eT(n,e){const t=Math.min(n.length,e.length);for(let r=0;r<t;++r)if(n[r]!==e[r])return n[r]<e[r]?-1:1;return n.length===e.length?0:n.length>e.length?1:-1}var _0t=(n,e,t=Math.min(n.byteLength,e.byteLength))=>{for(let r=0;r<t;r++){const i=n[r],s=e[r];if(i!==s)return 8*t-(r*8+Math.clz32(i^s)-24)}return 0},ise=class{constructor(n,e){this.id=n,this.bucketSize=e.bucketSize||20,this.buckets=new Array(n.length*8+1).fill(void 0).map(()=>[]),this.compare=e.compare||(()=>0),this.getId=e.getId}get length(){return this.buckets.reduce((n,e)=>n+e.length,0)}*[Symbol.iterator](){for(const n of this.buckets)for(const e of n)yield e}add(n,e=this.getBitwiseDistance(this.getId(n))){if(this.has(this.getId(n),e))return!1;if(this.buckets[e].length<this.bucketSize)return this.buckets[e].push(n),!0;const t=this.buckets[e].slice(0);t.push(n);const r=t.sort(this.compare);this.buckets[e]=r.slice(0,this.bucketSize);const i=r.at(-1);return eT(this.getId(n),this.getId(i))!==0}clear(){for(let n=0;n<this.buckets.length;n++)this.buckets[n]=[]}*iterateClosestToId(n){return this.iterateNodes(n)}listClosestToId(n,e=this.buckets.length*this.bucketSize){return this.getNodes(n,void 0,e)}get(n){const e=this.buckets[n].shift();return e&&this.buckets[n].push(e),e}getById(n,e=this.getBitwiseDistance(n)){const t=this.buckets[e].findIndex(i=>eT(this.getId(i),n)===0);if(t===-1)return;const r=this.buckets[e][t];return this.buckets[e].splice(t,1),this.buckets[e].push(r),r}getBitwiseDistance(n){return _0t(this.id,n)}getNodes(n,e=this.getBitwiseDistance(n),t=this.buckets.length*this.bucketSize){if(!t)return[];const r=[];for(const i of this.iterateNodes(n,e))if(r.push(i),r.length>=t)return r;return r}*iterateNodes(n,e=this.getBitwiseDistance(n)){const t=Math.max(e,this.buckets.length-1-e);let r=0,i=(r%2===0?1:-1)*Math.ceil(r/2);for(;Math.abs(i)<=t;){const s=e+i;if(0<=s&&s<this.buckets.length){const a=this.buckets[s];if(a){const o=a.map(l=>this.getId(l));for(const l of o){const c=this.getById(l,s);c&&(yield c)}}}r++,i=(r%2===0?1:-1)*Math.ceil(r/2)}}has(n,e=this.getBitwiseDistance(n)){return!!this.buckets[e].find(t=>eT(this.getId(t),n)===0)}peek(n){return this.buckets[n].at(0)}peekById(n,e=this.getBitwiseDistance(n)){return this.buckets[e].find(t=>eT(this.getId(t),n)===0)}update(n,e=this.getBitwiseDistance(this.getId(n))){const t=this.buckets[e].findIndex(r=>eT(this.getId(r),this.getId(n))===0);return t===-1?!1:(this.buckets[e][t]=n,!0)}remove(n,e=this.getBitwiseDistance(n)){const t=this.buckets[e].findIndex(r=>eT(this.getId(r),n)===0);return t===-1?!1:(this.buckets[e].splice(t,1),!0)}};class v0t{constructor(){this.encoder=new TextEncoder,this._pieces=[],this._parts=[]}append_buffer(e){this.flush(),this._parts.push(e)}append(e){this._pieces.push(e)}flush(){if(this._pieces.length>0){const e=new Uint8Array(this._pieces);this._parts.push(e),this._pieces=[]}}toArrayBuffer(){const e=[];for(const t of this._parts)e.push(t);return y0t(e).buffer}}function y0t(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n){const s=new Uint8Array(i.buffer,i.byteOffset,i.byteLength);t.set(s,r),r+=i.byteLength}return t}function Rbe(n){return new b0t(n).unpack()}function Abe(n){const e=new S0t,t=e.pack(n);return t instanceof Promise?t.then(()=>e.getBuffer()):e.getBuffer()}class b0t{constructor(e){this.index=0,this.dataBuffer=e,this.dataView=new Uint8Array(this.dataBuffer),this.length=this.dataBuffer.byteLength}unpack(){const e=this.unpack_uint8();if(e<128)return e;if((e^224)<32)return(e^224)-32;let t;if((t=e^160)<=15)return this.unpack_raw(t);if((t=e^176)<=15)return this.unpack_string(t);if((t=e^144)<=15)return this.unpack_array(t);if((t=e^128)<=15)return this.unpack_map(t);switch(e){case 192:return null;case 193:return;case 194:return!1;case 195:return!0;case 202:return this.unpack_float();case 203:return this.unpack_double();case 204:return this.unpack_uint8();case 205:return this.unpack_uint16();case 206:return this.unpack_uint32();case 207:return this.unpack_uint64();case 208:return this.unpack_int8();case 209:return this.unpack_int16();case 210:return this.unpack_int32();case 211:return this.unpack_int64();case 212:return;case 213:return;case 214:return;case 215:return;case 216:return t=this.unpack_uint16(),this.unpack_string(t);case 217:return t=this.unpack_uint32(),this.unpack_string(t);case 218:return t=this.unpack_uint16(),this.unpack_raw(t);case 219:return t=this.unpack_uint32(),this.unpack_raw(t);case 220:return t=this.unpack_uint16(),this.unpack_array(t);case 221:return t=this.unpack_uint32(),this.unpack_array(t);case 222:return t=this.unpack_uint16(),this.unpack_map(t);case 223:return t=this.unpack_uint32(),this.unpack_map(t)}}unpack_uint8(){const e=this.dataView[this.index]&255;return this.index++,e}unpack_uint16(){const e=this.read(2),t=(e[0]&255)*256+(e[1]&255);return this.index+=2,t}unpack_uint32(){const e=this.read(4),t=((e[0]*256+e[1])*256+e[2])*256+e[3];return this.index+=4,t}unpack_uint64(){const e=this.read(8),t=((((((e[0]*256+e[1])*256+e[2])*256+e[3])*256+e[4])*256+e[5])*256+e[6])*256+e[7];return this.index+=8,t}unpack_int8(){const e=this.unpack_uint8();return e<128?e:e-256}unpack_int16(){const e=this.unpack_uint16();return e<32768?e:e-65536}unpack_int32(){const e=this.unpack_uint32();return e<2**31?e:e-2**32}unpack_int64(){const e=this.unpack_uint64();return e<2**63?e:e-2**64}unpack_raw(e){if(this.length<this.index+e)throw new Error(`BinaryPackFailure: index is out of range ${this.index} ${e} ${this.length}`);const t=this.dataBuffer.slice(this.index,this.index+e);return this.index+=e,t}unpack_string(e){const t=this.read(e);let r=0,i="",s,a;for(;r<e;)s=t[r],s<160?(a=s,r++):(s^192)<32?(a=(s&31)<<6|t[r+1]&63,r+=2):(s^224)<16?(a=(s&15)<<12|(t[r+1]&63)<<6|t[r+2]&63,r+=3):(a=(s&7)<<18|(t[r+1]&63)<<12|(t[r+2]&63)<<6|t[r+3]&63,r+=4),i+=String.fromCodePoint(a);return this.index+=e,i}unpack_array(e){const t=new Array(e);for(let r=0;r<e;r++)t[r]=this.unpack();return t}unpack_map(e){const t={};for(let r=0;r<e;r++){const i=this.unpack();t[i]=this.unpack()}return t}unpack_float(){const e=this.unpack_uint32(),t=e>>31,r=(e>>23&255)-127,i=e&8388607|8388608;return(t===0?1:-1)*i*2**(r-23)}unpack_double(){const e=this.unpack_uint32(),t=this.unpack_uint32(),r=e>>31,i=(e>>20&2047)-1023,a=(e&1048575|1048576)*2**(i-20)+t*2**(i-52);return(r===0?1:-1)*a}read(e){const t=this.index;if(t+e<=this.length)return this.dataView.subarray(t,t+e);throw new Error("BinaryPackFailure: read index out of range")}}class S0t{getBuffer(){return this._bufferBuilder.toArrayBuffer()}pack(e){if(typeof e=="string")this.pack_string(e);else if(typeof e=="number")Math.floor(e)===e?this.pack_integer(e):this.pack_double(e);else if(typeof e=="boolean")e===!0?this._bufferBuilder.append(195):e===!1&&this._bufferBuilder.append(194);else if(e===void 0)this._bufferBuilder.append(192);else if(typeof e=="object")if(e===null)this._bufferBuilder.append(192);else{const t=e.constructor;if(e instanceof Array){const r=this.pack_array(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else if(e instanceof ArrayBuffer)this.pack_bin(new Uint8Array(e));else if("BYTES_PER_ELEMENT"in e){const r=e;this.pack_bin(new Uint8Array(r.buffer,r.byteOffset,r.byteLength))}else if(e instanceof Date)this.pack_string(e.toString());else{if(e instanceof Blob)return e.arrayBuffer().then(r=>{this.pack_bin(new Uint8Array(r)),this._bufferBuilder.flush()});if(t==Object||t.toString().startsWith("class")){const r=this.pack_object(e);if(r instanceof Promise)return r.then(()=>this._bufferBuilder.flush())}else throw new Error(`Type "${t.toString()}" not yet supported`)}}else throw new Error(`Type "${typeof e}" not yet supported`);this._bufferBuilder.flush()}pack_bin(e){const t=e.length;if(t<=15)this.pack_uint8(160+t);else if(t<=65535)this._bufferBuilder.append(218),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(219),this.pack_uint32(t);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(e)}pack_string(e){const t=this._textEncoder.encode(e),r=t.length;if(r<=15)this.pack_uint8(176+r);else if(r<=65535)this._bufferBuilder.append(216),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(217),this.pack_uint32(r);else throw new Error("Invalid length");this._bufferBuilder.append_buffer(t)}pack_array(e){const t=e.length;if(t<=15)this.pack_uint8(144+t);else if(t<=65535)this._bufferBuilder.append(220),this.pack_uint16(t);else if(t<=4294967295)this._bufferBuilder.append(221),this.pack_uint32(t);else throw new Error("Invalid length");const r=i=>{if(i<t){const s=this.pack(e[i]);return s instanceof Promise?s.then(()=>r(i+1)):r(i+1)}};return r(0)}pack_integer(e){if(e>=-32&&e<=127)this._bufferBuilder.append(e&255);else if(e>=0&&e<=255)this._bufferBuilder.append(204),this.pack_uint8(e);else if(e>=-128&&e<=127)this._bufferBuilder.append(208),this.pack_int8(e);else if(e>=0&&e<=65535)this._bufferBuilder.append(205),this.pack_uint16(e);else if(e>=-32768&&e<=32767)this._bufferBuilder.append(209),this.pack_int16(e);else if(e>=0&&e<=4294967295)this._bufferBuilder.append(206),this.pack_uint32(e);else if(e>=-2147483648&&e<=2147483647)this._bufferBuilder.append(210),this.pack_int32(e);else if(e>=-9223372036854776e3&&e<=9223372036854776e3)this._bufferBuilder.append(211),this.pack_int64(e);else if(e>=0&&e<=18446744073709552e3)this._bufferBuilder.append(207),this.pack_uint64(e);else throw new Error("Invalid integer")}pack_double(e){let t=0;e<0&&(t=1,e=-e);const r=Math.floor(Math.log(e)/Math.LN2),i=e/2**r-1,s=Math.floor(i*2**52),a=2**32,o=t<<31|r+1023<<20|s/a&1048575,l=s%a;this._bufferBuilder.append(203),this.pack_int32(o),this.pack_int32(l)}pack_object(e){const t=Object.keys(e),r=t.length;if(r<=15)this.pack_uint8(128+r);else if(r<=65535)this._bufferBuilder.append(222),this.pack_uint16(r);else if(r<=4294967295)this._bufferBuilder.append(223),this.pack_uint32(r);else throw new Error("Invalid length");const i=s=>{if(s<t.length){const a=t[s];if(e.hasOwnProperty(a)){this.pack(a);const o=this.pack(e[a]);if(o instanceof Promise)return o.then(()=>i(s+1))}return i(s+1)}};return i(0)}pack_uint8(e){this._bufferBuilder.append(e)}pack_uint16(e){this._bufferBuilder.append(e>>8),this._bufferBuilder.append(e&255)}pack_uint32(e){const t=e&4294967295;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255)}pack_uint64(e){const t=e/4294967296,r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}pack_int8(e){this._bufferBuilder.append(e&255)}pack_int16(e){this._bufferBuilder.append((e&65280)>>8),this._bufferBuilder.append(e&255)}pack_int32(e){this._bufferBuilder.append(e>>>24&255),this._bufferBuilder.append((e&16711680)>>>16),this._bufferBuilder.append((e&65280)>>>8),this._bufferBuilder.append(e&255)}pack_int64(e){const t=Math.floor(e/4294967296),r=e%2**32;this._bufferBuilder.append((t&4278190080)>>>24),this._bufferBuilder.append((t&16711680)>>>16),this._bufferBuilder.append((t&65280)>>>8),this._bufferBuilder.append(t&255),this._bufferBuilder.append((r&4278190080)>>>24),this._bufferBuilder.append((r&16711680)>>>16),this._bufferBuilder.append((r&65280)>>>8),this._bufferBuilder.append(r&255)}constructor(){this._bufferBuilder=new v0t,this._textEncoder=new TextEncoder}}let Cbe=!0,Mbe=!0;function o2(n,e,t){const r=n.match(e);return r&&r.length>=t&&parseFloat(r[t],10)}function dx(n,e,t){if(!n.RTCPeerConnection)return;const r=n.RTCPeerConnection.prototype,i=r.addEventListener;r.addEventListener=function(a,o){if(a!==e)return i.apply(this,arguments);const l=c=>{const u=t(c);u&&(o.handleEvent?o.handleEvent(u):o(u))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,l),i.apply(this,[a,l])};const s=r.removeEventListener;r.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const l=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,l])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function E0t(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Cbe=n,n?"adapter.js logging disabled":"adapter.js logging enabled")}function x0t(n){return typeof n!="boolean"?new Error("Argument type: "+typeof n+". Please use a boolean."):(Mbe=!n,"adapter.js deprecation warnings "+(n?"disabled":"enabled"))}function kbe(){if(typeof window=="object"){if(Cbe)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function cG(n,e){Mbe&&console.warn(n+" is deprecated, please use "+e+" instead.")}function T0t(n){const e={browser:null,version:null};if(typeof n>"u"||!n.navigator||!n.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:t}=n;if(t.userAgentData&&t.userAgentData.brands){const r=t.userAgentData.brands.find(i=>i.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(t.mozGetUserMedia)e.browser="firefox",e.version=parseInt(o2(t.userAgent,/Firefox\/(\d+)\./,1));else if(t.webkitGetUserMedia||n.isSecureContext===!1&&n.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(o2(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(n.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(o2(t.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=n.RTCRtpTransceiver&&"currentDirection"in n.RTCRtpTransceiver.prototype,e._safariVersion=o2(t.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function sse(n){return Object.prototype.toString.call(n)==="[object Object]"}function Obe(n){return sse(n)?Object.keys(n).reduce(function(e,t){const r=sse(n[t]),i=r?Obe(n[t]):n[t],s=r&&!Object.keys(i).length;return i===void 0||s?e:Object.assign(e,{[t]:i})},{}):n}function sz(n,e,t){!e||t.has(e.id)||(t.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?sz(n,n.get(e[r]),t):r.endsWith("Ids")&&e[r].forEach(i=>{sz(n,n.get(i),t)})}))}function ase(n,e,t){const r=t?"outbound-rtp":"inbound-rtp",i=new Map;if(e===null)return i;const s=[];return n.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{n.forEach(o=>{o.type===r&&o.trackId===a.id&&sz(n,o,i)})}),i}const ose=kbe;function Ibe(n,e){const t=n&&n.navigator;if(!t.mediaDevices)return;const r=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const l={};return Object.keys(o).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const u=typeof o[c]=="object"?o[c]:{ideal:o[c]};u.exact!==void 0&&typeof u.exact=="number"&&(u.min=u.max=u.exact);const f=function(d,g){return d?d+g.charAt(0).toUpperCase()+g.slice(1):g==="deviceId"?"sourceId":g};if(u.ideal!==void 0){l.optional=l.optional||[];let d={};typeof u.ideal=="number"?(d[f("min",c)]=u.ideal,l.optional.push(d),d={},d[f("max",c)]=u.ideal,l.optional.push(d)):(d[f("",c)]=u.ideal,l.optional.push(d))}u.exact!==void 0&&typeof u.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[f("",c)]=u.exact):["min","max"].forEach(d=>{u[d]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[f(d,c)]=u[d])})}),o.advanced&&(l.optional=(l.optional||[]).concat(o.advanced)),l},i=function(o,l){if(e.version>=61)return l(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const c=function(u,f,d){f in u&&!(d in u)&&(u[d]=u[f],delete u[f])};o=JSON.parse(JSON.stringify(o)),c(o.audio,"autoGainControl","googAutoGainControl"),c(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=r(o.audio)}if(o&&typeof o.video=="object"){let c=o.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const u=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!u)){delete o.video.facingMode;let f;if(c.exact==="environment"||c.ideal==="environment"?f=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(f=["front"]),f)return t.mediaDevices.enumerateDevices().then(d=>{d=d.filter(p=>p.kind==="videoinput");let g=d.find(p=>f.some(_=>p.label.toLowerCase().includes(_)));return!g&&d.length&&f.includes("back")&&(g=d[d.length-1]),g&&(o.video.deviceId=c.exact?{exact:g.deviceId}:{ideal:g.deviceId}),o.video=r(o.video),ose("chrome: "+JSON.stringify(o)),l(o)})}o.video=r(o.video)}return ose("chrome: "+JSON.stringify(o)),l(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,l,c){i(o,u=>{t.webkitGetUserMedia(u,l,f=>{c&&c(s(f))})})};if(t.getUserMedia=a.bind(t),t.mediaDevices.getUserMedia){const o=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(l){return i(l,c=>o(c).then(u=>{if(c.audio&&!u.getAudioTracks().length||c.video&&!u.getVideoTracks().length)throw u.getTracks().forEach(f=>{f.stop()}),new DOMException("","NotFoundError");return u},u=>Promise.reject(s(u))))}}}function Nbe(n){n.MediaStream=n.MediaStream||n.webkitMediaStream}function Pbe(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("ontrack"in n.RTCPeerConnection.prototype)){Object.defineProperty(n.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(t){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=t)},enumerable:!0,configurable:!0});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===i.track.id):s={track:i.track};const a=new Event("track");a.track=i.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)}),r.stream.getTracks().forEach(i=>{let s;n.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===i.id):s={track:i};const a=new Event("track");a.track=i,a.receiver=s,a.transceiver={receiver:s},a.streams=[r.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else dx(n,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function Dbe(n){if(typeof n=="object"&&n.RTCPeerConnection&&!("getSenders"in n.RTCPeerConnection.prototype)&&"createDTMFSender"in n.RTCPeerConnection.prototype){const e=function(i,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=i.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:i}};if(!n.RTCPeerConnection.prototype.getSenders){n.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const i=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(o,l){let c=i.apply(this,arguments);return c||(c=e(this,o),this._senders.push(c)),c};const s=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const l=this._senders.indexOf(o);l!==-1&&this._senders.splice(l,1)}}const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],t.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],r.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(l=>l.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof n=="object"&&n.RTCPeerConnection&&"getSenders"in n.RTCPeerConnection.prototype&&"createDTMFSender"in n.RTCPeerConnection.prototype&&n.RTCRtpSender&&!("dtmf"in n.RTCRtpSender.prototype)){const e=n.RTCPeerConnection.prototype.getSenders;n.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r},Object.defineProperty(n.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Lbe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender&&n.RTCRtpReceiver))return;if(!("getStats"in n.RTCRtpSender.prototype)){const t=n.RTCPeerConnection.prototype.getSenders;t&&(n.RTCPeerConnection.prototype.getSenders=function(){const s=t.apply(this,[]);return s.forEach(a=>a._pc=this),s});const r=n.RTCPeerConnection.prototype.addTrack;r&&(n.RTCPeerConnection.prototype.addTrack=function(){const s=r.apply(this,arguments);return s._pc=this,s}),n.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>ase(a,s.track,!0))}}if(!("getStats"in n.RTCRtpReceiver.prototype)){const t=n.RTCPeerConnection.prototype.getReceivers;t&&(n.RTCPeerConnection.prototype.getReceivers=function(){const i=t.apply(this,[]);return i.forEach(s=>s._pc=this),i}),dx(n,"track",r=>(r.receiver._pc=r.srcElement,r)),n.RTCRtpReceiver.prototype.getStats=function(){const i=this;return this._pc.getStats().then(s=>ase(s,i.track,!1))}}if(!("getStats"in n.RTCRtpSender.prototype&&"getStats"in n.RTCRtpReceiver.prototype))return;const e=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof n.MediaStreamTrack){const r=arguments[0];let i,s,a;return this.getSenders().forEach(o=>{o.track===r&&(i?a=!0:i=o)}),this.getReceivers().forEach(o=>(o.track===r&&(s?a=!0:s=o),o.track===r)),a||i&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):i?i.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function Ube(n){n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(l)===-1&&this._shimmedLocalStreams[o.id].push(l):this._shimmedLocalStreams[o.id]=[o,l],l};const t=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(c=>{if(this.getSenders().find(f=>f.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();t.apply(this,arguments);const l=this.getSenders().filter(c=>o.indexOf(c)===-1);this._shimmedLocalStreams[a.id]=[a].concat(l)};const r=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],r.apply(this,arguments)};const i=n.RTCPeerConnection.prototype.removeTrack;n.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const l=this._shimmedLocalStreams[o].indexOf(a);l!==-1&&this._shimmedLocalStreams[o].splice(l,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),i.apply(this,arguments)}}function Bbe(n,e){if(!n.RTCPeerConnection)return;if(n.RTCPeerConnection.prototype.addTrack&&e.version>=65)return Ube(n);const t=n.RTCPeerConnection.prototype.getLocalStreams;n.RTCPeerConnection.prototype.getLocalStreams=function(){const u=t.apply(this);return this._reverseStreams=this._reverseStreams||{},u.map(f=>this._reverseStreams[f.id])};const r=n.RTCPeerConnection.prototype.addStream;n.RTCPeerConnection.prototype.addStream=function(u){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},u.getTracks().forEach(f=>{if(this.getSenders().find(g=>g.track===f))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[u.id]){const f=new n.MediaStream(u.getTracks());this._streams[u.id]=f,this._reverseStreams[f.id]=u,u=f}r.apply(this,[u])};const i=n.RTCPeerConnection.prototype.removeStream;n.RTCPeerConnection.prototype.removeStream=function(u){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},i.apply(this,[this._streams[u.id]||u]),delete this._reverseStreams[this._streams[u.id]?this._streams[u.id].id:u.id],delete this._streams[u.id]},n.RTCPeerConnection.prototype.addTrack=function(u,f){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const d=[].slice.call(arguments,1);if(d.length!==1||!d[0].getTracks().find(_=>_===u))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(_=>_.track===u))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const p=this._streams[f.id];if(p)p.addTrack(u),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const _=new n.MediaStream([u]);this._streams[f.id]=_,this._reverseStreams[_.id]=f,this.addStream(_)}return this.getSenders().find(_=>_.track===u)};function s(c,u){let f=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{const g=c._reverseStreams[d],p=c._streams[g.id];f=f.replace(new RegExp(p.id,"g"),g.id)}),new RTCSessionDescription({type:u.type,sdp:f})}function a(c,u){let f=u.sdp;return Object.keys(c._reverseStreams||[]).forEach(d=>{const g=c._reverseStreams[d],p=c._streams[g.id];f=f.replace(new RegExp(g.id,"g"),p.id)}),new RTCSessionDescription({type:u.type,sdp:f})}["createOffer","createAnswer"].forEach(function(c){const u=n.RTCPeerConnection.prototype[c],f={[c](){const d=arguments;return arguments.length&&typeof arguments[0]=="function"?u.apply(this,[p=>{const _=s(this,p);d[0].apply(null,[_])},p=>{d[1]&&d[1].apply(null,p)},arguments[2]]):u.apply(this,arguments).then(p=>s(this,p))}};n.RTCPeerConnection.prototype[c]=f[c]});const o=n.RTCPeerConnection.prototype.setLocalDescription;n.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(n.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(n.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:s(this,c)}}),n.RTCPeerConnection.prototype.removeTrack=function(u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!u._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(u._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let d;Object.keys(this._streams).forEach(g=>{this._streams[g].getTracks().find(_=>u.track===_)&&(d=this._streams[g])}),d&&(d.getTracks().length===1?this.removeStream(this._reverseStreams[d.id]):d.removeTrack(u.track),this.dispatchEvent(new Event("negotiationneeded")))}}function az(n,e){!n.RTCPeerConnection&&n.webkitRTCPeerConnection&&(n.RTCPeerConnection=n.webkitRTCPeerConnection),n.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const r=n.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new(t==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};n.RTCPeerConnection.prototype[t]=i[t]})}function Fbe(n,e){dx(n,"negotiationneeded",t=>{const r=t.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return t})}const lse=Object.freeze(Object.defineProperty({__proto__:null,fixNegotiationNeeded:Fbe,shimAddTrackRemoveTrack:Bbe,shimAddTrackRemoveTrackWithNative:Ube,shimGetSendersWithDtmf:Dbe,shimGetUserMedia:Ibe,shimMediaStream:Nbe,shimOnTrack:Pbe,shimPeerConnection:az,shimSenderReceiverGetStats:Lbe},Symbol.toStringTag,{value:"Module"}));function zbe(n,e){const t=n&&n.navigator,r=n&&n.MediaStreamTrack;if(t.getUserMedia=function(i,s,a){cG("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),t.mediaDevices.getUserMedia(i).then(s,a)},!(e.version>55&&"autoGainControl"in t.mediaDevices.getSupportedConstraints())){const i=function(a,o,l){o in a&&!(l in a)&&(a[l]=a[o],delete a[o])},s=t.mediaDevices.getUserMedia.bind(t.mediaDevices);if(t.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),i(a.audio,"autoGainControl","mozAutoGainControl"),i(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},r&&r.prototype.getSettings){const a=r.prototype.getSettings;r.prototype.getSettings=function(){const o=a.apply(this,arguments);return i(o,"mozAutoGainControl","autoGainControl"),i(o,"mozNoiseSuppression","noiseSuppression"),o}}if(r&&r.prototype.applyConstraints){const a=r.prototype.applyConstraints;r.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),i(o,"autoGainControl","mozAutoGainControl"),i(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function w0t(n,e){n.navigator.mediaDevices&&"getDisplayMedia"in n.navigator.mediaDevices||n.navigator.mediaDevices&&(n.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,n.navigator.mediaDevices.getUserMedia(r)})}function jbe(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function oz(n,e){if(typeof n!="object"||!(n.RTCPeerConnection||n.mozRTCPeerConnection))return;!n.RTCPeerConnection&&n.mozRTCPeerConnection&&(n.RTCPeerConnection=n.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(i){const s=n.RTCPeerConnection.prototype[i],a={[i](){return arguments[0]=new(i==="addIceCandidate"?n.RTCIceCandidate:n.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};n.RTCPeerConnection.prototype[i]=a[i]});const t={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=n.RTCPeerConnection.prototype.getStats;n.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return r.apply(this,[s||null]).then(l=>{if(e.version<53&&!a)try{l.forEach(c=>{c.type=t[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((u,f)=>{l.set(f,Object.assign({},u,{type:t[u.type]||u.type}))})}return l}).then(a,o)}}function Hbe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpSender.prototype)return;const e=n.RTCPeerConnection.prototype.getSenders;e&&(n.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(s=>s._pc=this),i});const t=n.RTCPeerConnection.prototype.addTrack;t&&(n.RTCPeerConnection.prototype.addTrack=function(){const i=t.apply(this,arguments);return i._pc=this,i}),n.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function qbe(n){if(!(typeof n=="object"&&n.RTCPeerConnection&&n.RTCRtpSender)||n.RTCRtpSender&&"getStats"in n.RTCRtpReceiver.prototype)return;const e=n.RTCPeerConnection.prototype.getReceivers;e&&(n.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(i=>i._pc=this),r}),dx(n,"track",t=>(t.receiver._pc=t.srcElement,t)),n.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Vbe(n){!n.RTCPeerConnection||"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){cG("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&t.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Gbe(n){n.DataChannel&&!n.RTCDataChannel&&(n.RTCDataChannel=n.DataChannel)}function $be(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.addTransceiver;e&&(n.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const i=r.length>0;i&&r.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(i){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=r,a.sendEncodings=r,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function Wbe(n){if(!(typeof n=="object"&&n.RTCRtpSender))return;const e=n.RTCRtpSender.prototype.getParameters;e&&(n.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function Ybe(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Xbe(n){if(!(typeof n=="object"&&n.RTCPeerConnection))return;const e=n.RTCPeerConnection.prototype.createAnswer;n.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}const cse=Object.freeze(Object.defineProperty({__proto__:null,shimAddTransceiver:$be,shimCreateAnswer:Xbe,shimCreateOffer:Ybe,shimGetDisplayMedia:w0t,shimGetParameters:Wbe,shimGetUserMedia:zbe,shimOnTrack:jbe,shimPeerConnection:oz,shimRTCDataChannel:Gbe,shimReceiverGetStats:qbe,shimRemoveStream:Vbe,shimSenderGetStats:Hbe},Symbol.toStringTag,{value:"Module"}));function Kbe(n){if(!(typeof n!="object"||!n.RTCPeerConnection)){if("getLocalStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in n.RTCPeerConnection.prototype)){const e=n.RTCPeerConnection.prototype.addTrack;n.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(i=>e.call(this,i,r)),r.getVideoTracks().forEach(i=>e.call(this,i,r))},n.RTCPeerConnection.prototype.addTrack=function(r,...i){return i&&i.forEach(s=>{this._localStreams?this._localStreams.includes(s)||this._localStreams.push(s):this._localStreams=[s]}),e.apply(this,arguments)}}"removeStream"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.removeStream=function(t){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(t);if(r===-1)return;this._localStreams.splice(r,1);const i=t.getTracks();this.getSenders().forEach(s=>{i.includes(s.track)&&this.removeTrack(s)})})}}function Zbe(n){if(!(typeof n!="object"||!n.RTCPeerConnection)&&("getRemoteStreams"in n.RTCPeerConnection.prototype||(n.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in n.RTCPeerConnection.prototype))){Object.defineProperty(n.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(t){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=t),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(i=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(i))return;this._remoteStreams.push(i);const s=new Event("addstream");s.stream=i,this.dispatchEvent(s)})})}});const e=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(i){i.streams.forEach(s=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(s)>=0)return;r._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,r.dispatchEvent(a)})}),e.apply(r,arguments)}}}function Qbe(n){if(typeof n!="object"||!n.RTCPeerConnection)return;const e=n.RTCPeerConnection.prototype,t=e.createOffer,r=e.createAnswer,i=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(c,u){const f=arguments.length>=2?arguments[2]:arguments[0],d=t.apply(this,[f]);return u?(d.then(c,u),Promise.resolve()):d},e.createAnswer=function(c,u){const f=arguments.length>=2?arguments[2]:arguments[0],d=r.apply(this,[f]);return u?(d.then(c,u),Promise.resolve()):d};let o=function(l,c,u){const f=i.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f};e.setLocalDescription=o,o=function(l,c,u){const f=s.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f},e.setRemoteDescription=o,o=function(l,c,u){const f=a.apply(this,[l]);return u?(f.then(c,u),Promise.resolve()):f},e.addIceCandidate=o}function Jbe(n){const e=n&&n.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const t=e.mediaDevices,r=t.getUserMedia.bind(t);e.mediaDevices.getUserMedia=i=>r(e1e(i))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,i,s){e.mediaDevices.getUserMedia(r).then(i,s)}).bind(e))}function e1e(n){return n&&n.video!==void 0?Object.assign({},n,{video:Obe(n.video)}):n}function t1e(n){if(!n.RTCPeerConnection)return;const e=n.RTCPeerConnection;n.RTCPeerConnection=function(r,i){if(r&&r.iceServers){const s=[];for(let a=0;a<r.iceServers.length;a++){let o=r.iceServers[a];o.urls===void 0&&o.url?(cG("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(r.iceServers[a])}r.iceServers=s}return new e(r,i)},n.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(n.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function n1e(n){typeof n=="object"&&n.RTCTrackEvent&&"receiver"in n.RTCTrackEvent.prototype&&!("transceiver"in n.RTCTrackEvent.prototype)&&Object.defineProperty(n.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function r1e(n){const e=n.RTCPeerConnection.prototype.createOffer;n.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const i=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&i?i.direction==="sendrecv"?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":i.direction==="recvonly"&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):r.offerToReceiveAudio===!0&&!i&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):r.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function i1e(n){typeof n!="object"||n.AudioContext||(n.AudioContext=n.webkitAudioContext)}const use=Object.freeze(Object.defineProperty({__proto__:null,shimAudioContext:i1e,shimCallbacksAPI:Qbe,shimConstraints:e1e,shimCreateOfferLegacy:r1e,shimGetUserMedia:Jbe,shimLocalStreamsAPI:Kbe,shimRTCIceServerUrls:t1e,shimRemoteStreamsAPI:Zbe,shimTrackEventTransceiver:n1e},Symbol.toStringTag,{value:"Module"}));var PF={exports:{}},fse;function R0t(){return fse||(fse=1,(function(n){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(t){return t.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(t){return t.split(`
m=`).map((i,s)=>(s>0?"m="+i:i).trim()+`\r
`)},e.getDescription=function(t){const r=e.splitSections(t);return r&&r[0]},e.getMediaSections=function(t){const r=e.splitSections(t);return r.shift(),r},e.matchPrefix=function(t,r){return e.splitLines(t).filter(i=>i.indexOf(r)===0)},e.parseCandidate=function(t){let r;t.indexOf("a=candidate:")===0?r=t.substring(12).split(" "):r=t.substring(10).split(" ");const i={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let s=8;s<r.length;s+=2)switch(r[s]){case"raddr":i.relatedAddress=r[s+1];break;case"rport":i.relatedPort=parseInt(r[s+1],10);break;case"tcptype":i.tcpType=r[s+1];break;case"ufrag":i.ufrag=r[s+1],i.usernameFragment=r[s+1];break;default:i[r[s]]===void 0&&(i[r[s]]=r[s+1]);break}return i},e.writeCandidate=function(t){const r=[];r.push(t.foundation);const i=t.component;i==="rtp"?r.push(1):i==="rtcp"?r.push(2):r.push(i),r.push(t.protocol.toUpperCase()),r.push(t.priority),r.push(t.address||t.ip),r.push(t.port);const s=t.type;return r.push("typ"),r.push(s),s!=="host"&&t.relatedAddress&&t.relatedPort&&(r.push("raddr"),r.push(t.relatedAddress),r.push("rport"),r.push(t.relatedPort)),t.tcpType&&t.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(t.tcpType)),(t.usernameFragment||t.ufrag)&&(r.push("ufrag"),r.push(t.usernameFragment||t.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(t){return t.substring(14).split(" ")},e.parseRtpMap=function(t){let r=t.substring(9).split(" ");const i={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),i.name=r[0],i.clockRate=parseInt(r[1],10),i.channels=r.length===3?parseInt(r[2],10):1,i.numChannels=i.channels,i},e.writeRtpMap=function(t){let r=t.payloadType;t.preferredPayloadType!==void 0&&(r=t.preferredPayloadType);const i=t.channels||t.numChannels||1;return"a=rtpmap:"+r+" "+t.name+"/"+t.clockRate+(i!==1?"/"+i:"")+`\r
`},e.parseExtmap=function(t){const r=t.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(t){return"a=extmap:"+(t.id||t.preferredId)+(t.direction&&t.direction!=="sendrecv"?"/"+t.direction:"")+" "+t.uri+(t.attributes?" "+t.attributes:"")+`\r
`},e.parseFmtp=function(t){const r={};let i;const s=t.substring(t.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)i=s[a].trim().split("="),r[i[0].trim()]=i[1];return r},e.writeFmtp=function(t){let r="",i=t.payloadType;if(t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.parameters&&Object.keys(t.parameters).length){const s=[];Object.keys(t.parameters).forEach(a=>{t.parameters[a]!==void 0?s.push(a+"="+t.parameters[a]):s.push(a)}),r+="a=fmtp:"+i+" "+s.join(";")+`\r
`}return r},e.parseRtcpFb=function(t){const r=t.substring(t.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(t){let r="",i=t.payloadType;return t.preferredPayloadType!==void 0&&(i=t.preferredPayloadType),t.rtcpFeedback&&t.rtcpFeedback.length&&t.rtcpFeedback.forEach(s=>{r+="a=rtcp-fb:"+i+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(t){const r=t.indexOf(" "),i={ssrc:parseInt(t.substring(7,r),10)},s=t.indexOf(":",r);return s>-1?(i.attribute=t.substring(r+1,s),i.value=t.substring(s+1)):i.attribute=t.substring(r+1),i},e.parseSsrcGroup=function(t){const r=t.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(i=>parseInt(i,10))}},e.getMid=function(t){const r=e.matchPrefix(t,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(t){const r=t.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(t,r){return{role:"auto",fingerprints:e.matchPrefix(t+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(t,r){let i="a=setup:"+r+`\r
`;return t.fingerprints.forEach(s=>{i+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),i},e.parseCryptoLine=function(t){const r=t.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(t){return"a=crypto:"+t.tag+" "+t.cryptoSuite+" "+(typeof t.keyParams=="object"?e.writeCryptoKeyParams(t.keyParams):t.keyParams)+(t.sessionParams?" "+t.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(t){if(t.indexOf("inline:")!==0)return null;const r=t.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(t){return t.keyMethod+":"+t.keySalt+(t.lifeTime?"|"+t.lifeTime:"")+(t.mkiValue&&t.mkiLength?"|"+t.mkiValue+":"+t.mkiLength:"")},e.getCryptoParameters=function(t,r){return e.matchPrefix(t+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(t,r){const i=e.matchPrefix(t+r,"a=ice-ufrag:")[0],s=e.matchPrefix(t+r,"a=ice-pwd:")[0];return i&&s?{usernameFragment:i.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(t){let r="a=ice-ufrag:"+t.usernameFragment+`\r
a=ice-pwd:`+t.password+`\r
`;return t.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(t){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(t)[0].split(" ");r.profile=s[2];for(let o=3;o<s.length;o++){const l=s[o],c=e.matchPrefix(t,"a=rtpmap:"+l+" ")[0];if(c){const u=e.parseRtpMap(c),f=e.matchPrefix(t,"a=fmtp:"+l+" ");switch(u.parameters=f.length?e.parseFmtp(f[0]):{},u.rtcpFeedback=e.matchPrefix(t,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),r.codecs.push(u),u.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(u.name.toUpperCase());break}}}e.matchPrefix(t,"a=extmap:").forEach(o=>{r.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(t,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(o=>{a.forEach(l=>{o.rtcpFeedback.find(u=>u.type===l.type&&u.parameter===l.parameter)||o.rtcpFeedback.push(l)})}),r},e.writeRtpDescription=function(t,r){let i="";i+="m="+t+" ",i+=r.codecs.length>0?"9":"0",i+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=r.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,i+=`c=IN IP4 0.0.0.0\r
`,i+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(a=>{i+=e.writeRtpMap(a),i+=e.writeFmtp(a),i+=e.writeRtcpFb(a)});let s=0;return r.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(i+="a=maxptime:"+s+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(a=>{i+=e.writeExtmap(a)}),i},e.parseRtpEncodingParameters=function(t){const r=[],i=e.parseRtpParameters(t),s=i.fecMechanisms.indexOf("RED")!==-1,a=i.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(t,"a=ssrc:").map(d=>e.parseSsrcMedia(d)).filter(d=>d.attribute==="cname"),l=o.length>0&&o[0].ssrc;let c;const u=e.matchPrefix(t,"a=ssrc-group:FID").map(d=>d.substring(17).split(" ").map(p=>parseInt(p,10)));u.length>0&&u[0].length>1&&u[0][0]===l&&(c=u[0][1]),i.codecs.forEach(d=>{if(d.name.toUpperCase()==="RTX"&&d.parameters.apt){let g={ssrc:l,codecPayloadType:parseInt(d.parameters.apt,10)};l&&c&&(g.rtx={ssrc:c}),r.push(g),s&&(g=JSON.parse(JSON.stringify(g)),g.fec={ssrc:l,mechanism:a?"red+ulpfec":"red"},r.push(g))}}),r.length===0&&l&&r.push({ssrc:l});let f=e.matchPrefix(t,"b=");return f.length&&(f[0].indexOf("b=TIAS:")===0?f=parseInt(f[0].substring(7),10):f[0].indexOf("b=AS:")===0?f=parseInt(f[0].substring(5),10)*1e3*.95-2e3*8:f=void 0,r.forEach(d=>{d.maxBitrate=f})),r},e.parseRtcpParameters=function(t){const r={},i=e.matchPrefix(t,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];i&&(r.cname=i.value,r.ssrc=i.ssrc);const s=e.matchPrefix(t,"a=rtcp-rsize");r.reducedSize=s.length>0,r.compound=s.length===0;const a=e.matchPrefix(t,"a=rtcp-mux");return r.mux=a.length>0,r},e.writeRtcpParameters=function(t){let r="";return t.reducedSize&&(r+=`a=rtcp-rsize\r
`),t.mux&&(r+=`a=rtcp-mux\r
`),t.ssrc!==void 0&&t.cname&&(r+="a=ssrc:"+t.ssrc+" cname:"+t.cname+`\r
`),r},e.parseMsid=function(t){let r;const i=e.matchPrefix(t,"a=msid:");if(i.length===1)return r=i[0].substring(7).split(" "),{stream:r[0],track:r[1]};const s=e.matchPrefix(t,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return r=s[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(t){const r=e.parseMLine(t),i=e.matchPrefix(t,"a=max-message-size:");let s;i.length>0&&(s=parseInt(i[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(t,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:r.fmt,maxMessageSize:s};const o=e.matchPrefix(t,"a=sctpmap:");if(o.length>0){const l=o[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(t,r){let i=[];return t.protocol!=="DTLS/SCTP"?i=["m="+t.kind+" 9 "+t.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:i=["m="+t.kind+" 9 "+t.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&i.push("a=max-message-size:"+r.maxMessageSize+`\r
`),i.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(t,r,i){let s;const a=r!==void 0?r:2;return t?s=t:s=e.generateSessionId(),`v=0\r
o=`+(i||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(t,r){const i=e.splitLines(t);for(let s=0;s<i.length;s++)switch(i[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[s].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(t){return e.splitLines(t)[0].split(" ")[0].substring(2)},e.isRejected=function(t){return t.split(" ",2)[1]==="0"},e.parseMLine=function(t){const i=e.splitLines(t)[0].substring(2).split(" ");return{kind:i[0],port:parseInt(i[1],10),protocol:i[2],fmt:i.slice(3).join(" ")}},e.parseOLine=function(t){const i=e.matchPrefix(t,"o=")[0].substring(2).split(" ");return{username:i[0],sessionId:i[1],sessionVersion:parseInt(i[2],10),netType:i[3],addressType:i[4],address:i[5]}},e.isValidSDP=function(t){if(typeof t!="string"||t.length===0)return!1;const r=e.splitLines(t);for(let i=0;i<r.length;i++)if(r[i].length<2||r[i].charAt(1)!=="=")return!1;return!0},n.exports=e})(PF)),PF.exports}var s1e=R0t();const UT=Bh(s1e),A0t=cSe({__proto__:null,default:UT},[s1e]);function _P(n){if(!n.RTCIceCandidate||n.RTCIceCandidate&&"foundation"in n.RTCIceCandidate.prototype)return;const e=n.RTCIceCandidate;n.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const i=new e(r),s=UT.parseCandidate(r.candidate);for(const a in s)a in i||Object.defineProperty(i,a,{value:s[a]});return i.toJSON=function(){return{candidate:i.candidate,sdpMid:i.sdpMid,sdpMLineIndex:i.sdpMLineIndex,usernameFragment:i.usernameFragment}},i}return new e(r)},n.RTCIceCandidate.prototype=e.prototype,dx(n,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new n.RTCIceCandidate(t.candidate),writable:"false"}),t))}function lz(n){!n.RTCIceCandidate||n.RTCIceCandidate&&"relayProtocol"in n.RTCIceCandidate.prototype||dx(n,"icecandidate",e=>{if(e.candidate){const t=UT.parseCandidate(e.candidate.candidate);t.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function vP(n,e){if(!n.RTCPeerConnection)return;"sctp"in n.RTCPeerConnection.prototype||Object.defineProperty(n.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const t=function(o){if(!o||!o.sdp)return!1;const l=UT.splitSections(o.sdp);return l.shift(),l.some(c=>{const u=UT.parseMLine(c);return u&&u.kind==="application"&&u.protocol.indexOf("SCTP")!==-1})},r=function(o){const l=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},i=function(o){let l=65536;return e.browser==="firefox"&&(e.version<57?o===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},s=function(o,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const u=UT.matchPrefix(o.sdp,"a=max-message-size:");return u.length>0?c=parseInt(u[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},a=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(t(arguments[0])){const l=r(arguments[0]),c=i(l),u=s(arguments[0],l);let f;c===0&&u===0?f=Number.POSITIVE_INFINITY:c===0||u===0?f=Math.max(c,u):f=Math.min(c,u);const d={};Object.defineProperty(d,"maxMessageSize",{get(){return f}}),this._sctp=d}return a.apply(this,arguments)}}function yP(n){if(!(n.RTCPeerConnection&&"createDataChannel"in n.RTCPeerConnection.prototype))return;function e(r,i){const s=r.send;r.send=function(){const o=arguments[0],l=o.length||o.size||o.byteLength;if(r.readyState==="open"&&i.sctp&&l>i.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+i.sctp.maxMessageSize+" bytes)");return s.apply(r,arguments)}}const t=n.RTCPeerConnection.prototype.createDataChannel;n.RTCPeerConnection.prototype.createDataChannel=function(){const i=t.apply(this,arguments);return e(i,this),i},dx(n,"datachannel",r=>(e(r.channel,r.target),r))}function cz(n){if(!n.RTCPeerConnection||"connectionState"in n.RTCPeerConnection.prototype)return;const e=n.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(t){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),t&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=t)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(t=>{const r=e[t];e[t]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=i=>{const s=i.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",i);s.dispatchEvent(a)}return i},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function uz(n,e){if(!n.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const t=n.RTCPeerConnection.prototype.setRemoteDescription;n.RTCPeerConnection.prototype.setRemoteDescription=function(i){if(i&&i.sdp&&i.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=i.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);n.RTCSessionDescription&&i instanceof n.RTCSessionDescription?arguments[0]=new n.RTCSessionDescription({type:i.type,sdp:s}):i.sdp=s}return t.apply(this,arguments)}}function bP(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.addIceCandidate;!t||t.length===0||(n.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():t.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function SP(n,e){if(!(n.RTCPeerConnection&&n.RTCPeerConnection.prototype))return;const t=n.RTCPeerConnection.prototype.setLocalDescription;!t||t.length===0||(n.RTCPeerConnection.prototype.setLocalDescription=function(){let i=arguments[0]||{};if(typeof i!="object"||i.type&&i.sdp)return t.apply(this,arguments);if(i={type:i.type,sdp:i.sdp},!i.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":i.type="offer";break;default:i.type="answer";break}return i.sdp||i.type!=="offer"&&i.type!=="answer"?t.apply(this,[i]):(i.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>t.apply(this,[a]))})}const C0t=Object.freeze(Object.defineProperty({__proto__:null,removeExtmapAllowMixed:uz,shimAddIceCandidateNullOrEmpty:bP,shimConnectionState:cz,shimMaxMessageSize:vP,shimParameterlessSetLocalDescription:SP,shimRTCIceCandidate:_P,shimRTCIceCandidateRelayProtocol:lz,shimSendThrowTypeError:yP},Symbol.toStringTag,{value:"Module"}));function M0t({window:n}={},e={shimChrome:!0,shimFirefox:!0,shimSafari:!0}){const t=kbe,r=T0t(n),i={browserDetails:r,commonShim:C0t,extractVersion:o2,disableLog:E0t,disableWarnings:x0t,sdp:A0t};switch(r.browser){case"chrome":if(!lse||!az||!e.shimChrome)return t("Chrome shim is not included in this adapter release."),i;if(r.version===null)return t("Chrome shim can not determine version, not shimming."),i;t("adapter.js shimming chrome."),i.browserShim=lse,bP(n,r),SP(n),Ibe(n,r),Nbe(n),az(n,r),Pbe(n),Bbe(n,r),Dbe(n),Lbe(n),Fbe(n,r),_P(n),lz(n),cz(n),vP(n,r),yP(n),uz(n,r);break;case"firefox":if(!cse||!oz||!e.shimFirefox)return t("Firefox shim is not included in this adapter release."),i;t("adapter.js shimming firefox."),i.browserShim=cse,bP(n,r),SP(n),zbe(n,r),oz(n,r),jbe(n),Vbe(n),Hbe(n),qbe(n),Gbe(n),$be(n),Wbe(n),Ybe(n),Xbe(n),_P(n),cz(n),vP(n,r),yP(n);break;case"safari":if(!use||!e.shimSafari)return t("Safari shim is not included in this adapter release."),i;t("adapter.js shimming safari."),i.browserShim=use,bP(n,r),SP(n),t1e(n),r1e(n),Qbe(n),Kbe(n),Zbe(n),n1e(n),Jbe(n),i1e(n),_P(n),lz(n),vP(n,r),yP(n),uz(n,r);break;default:t("Unsupported browser!");break}return i}const hse=M0t({window:typeof window>"u"?void 0:window});function px(n,e,t,r){Object.defineProperty(n,e,{get:t,set:r,enumerable:!0,configurable:!0})}class a1e{constructor(){this.chunkedMTU=16300,this._dataCount=1,this.chunk=e=>{const t=[],r=e.byteLength,i=Math.ceil(r/this.chunkedMTU);let s=0,a=0;for(;a<r;){const o=Math.min(r,a+this.chunkedMTU),l=e.slice(a,o),c={__peerData:this._dataCount,n:s,data:l,total:i};t.push(c),a=o,s++}return this._dataCount++,t}}}function k0t(n){let e=0;for(const i of n)e+=i.byteLength;const t=new Uint8Array(e);let r=0;for(const i of n)t.set(i,r),r+=i.byteLength;return t}const DF=hse.default||hse,GM=new class{isWebRTCSupported(){return typeof RTCPeerConnection<"u"}isBrowserSupported(){const n=this.getBrowser(),e=this.getVersion();return this.supportedBrowsers.includes(n)?n==="chrome"?e>=this.minChromeVersion:n==="firefox"?e>=this.minFirefoxVersion:n==="safari"?!this.isIOS&&e>=this.minSafariVersion:!1:!1}getBrowser(){return DF.browserDetails.browser}getVersion(){return DF.browserDetails.version||0}isUnifiedPlanSupported(){const n=this.getBrowser(),e=DF.browserDetails.version||0;if(n==="chrome"&&e<this.minChromeVersion)return!1;if(n==="firefox"&&e>=this.minFirefoxVersion)return!0;if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;let t,r=!1;try{t=new RTCPeerConnection,t.addTransceiver("audio"),r=!0}catch{}finally{t&&t.close()}return r}toString(){return`Supports:
    browser:${this.getBrowser()}
    version:${this.getVersion()}
    isIOS:${this.isIOS}
    isWebRTCSupported:${this.isWebRTCSupported()}
    isBrowserSupported:${this.isBrowserSupported()}
    isUnifiedPlanSupported:${this.isUnifiedPlanSupported()}`}constructor(){this.isIOS=typeof navigator<"u"?["iPad","iPhone","iPod"].includes(navigator.platform):!1,this.supportedBrowsers=["firefox","chrome","safari"],this.minFirefoxVersion=59,this.minChromeVersion=72,this.minSafariVersion=605}},O0t=n=>!n||/^[A-Za-z0-9]+(?:[ _-][A-Za-z0-9]+)*$/.test(n),o1e=()=>Math.random().toString(36).slice(2),dse={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:eu-0.turn.peerjs.com:3478","turn:us-0.turn.peerjs.com:3478"],username:"peerjs",credential:"peerjsp"}],sdpSemantics:"unified-plan"};class I0t extends a1e{noop(){}blobToArrayBuffer(e,t){const r=new FileReader;return r.onload=function(i){i.target&&t(i.target.result)},r.readAsArrayBuffer(e),r}binaryStringToArrayBuffer(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r)&255;return t.buffer}isSecure(){return location.protocol==="https:"}constructor(...e){super(...e),this.CLOUD_HOST="0.peerjs.com",this.CLOUD_PORT=443,this.chunkedBrowsers={Chrome:1,chrome:1},this.defaultConfig=dse,this.browser=GM.getBrowser(),this.browserVersion=GM.getVersion(),this.pack=Abe,this.unpack=Rbe,this.supports=(function(){const t={browser:GM.isBrowserSupported(),webRTC:GM.isWebRTCSupported(),audioVideo:!1,data:!1,binaryBlob:!1,reliable:!1};if(!t.webRTC)return t;let r;try{r=new RTCPeerConnection(dse),t.audioVideo=!0;let i;try{i=r.createDataChannel("_PEERJSTEST",{ordered:!0}),t.data=!0,t.reliable=!!i.ordered;try{i.binaryType="blob",t.binaryBlob=!GM.isIOS}catch{}}catch{}finally{i&&i.close()}}catch{}finally{r&&r.close()}return t})(),this.validateId=O0t,this.randomToken=o1e}}const ym=new I0t,N0t="PeerJS: ";class P0t{get logLevel(){return this._logLevel}set logLevel(e){this._logLevel=e}log(...e){this._logLevel>=3&&this._print(3,...e)}warn(...e){this._logLevel>=2&&this._print(2,...e)}error(...e){this._logLevel>=1&&this._print(1,...e)}setLogFunction(e){this._print=e}_print(e,...t){const r=[N0t,...t];for(const i in r)r[i]instanceof Error&&(r[i]="("+r[i].name+") "+r[i].message);e>=3?console.log(...r):e>=2?console.warn("WARNING",...r):e>=1&&console.error("ERROR",...r)}constructor(){this._logLevel=0}}var Nr=new P0t,uG={},D0t=Object.prototype.hasOwnProperty,qp="~";function Gk(){}Object.create&&(Gk.prototype=Object.create(null),new Gk().__proto__||(qp=!1));function L0t(n,e,t){this.fn=n,this.context=e,this.once=t||!1}function l1e(n,e,t,r,i){if(typeof t!="function")throw new TypeError("The listener must be a function");var s=new L0t(t,r||n,i),a=qp?qp+e:e;return n._events[a]?n._events[a].fn?n._events[a]=[n._events[a],s]:n._events[a].push(s):(n._events[a]=s,n._eventsCount++),n}function EP(n,e){--n._eventsCount===0?n._events=new Gk:delete n._events[e]}function ip(){this._events=new Gk,this._eventsCount=0}ip.prototype.eventNames=function(){var e=[],t,r;if(this._eventsCount===0)return e;for(r in t=this._events)D0t.call(t,r)&&e.push(qp?r.slice(1):r);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(t)):e};ip.prototype.listeners=function(e){var t=qp?qp+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,s=r.length,a=new Array(s);i<s;i++)a[i]=r[i].fn;return a};ip.prototype.listenerCount=function(e){var t=qp?qp+e:e,r=this._events[t];return r?r.fn?1:r.length:0};ip.prototype.emit=function(e,t,r,i,s,a){var o=qp?qp+e:e;if(!this._events[o])return!1;var l=this._events[o],c=arguments.length,u,f;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),c){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,r),!0;case 4:return l.fn.call(l.context,t,r,i),!0;case 5:return l.fn.call(l.context,t,r,i,s),!0;case 6:return l.fn.call(l.context,t,r,i,s,a),!0}for(f=1,u=new Array(c-1);f<c;f++)u[f-1]=arguments[f];l.fn.apply(l.context,u)}else{var d=l.length,g;for(f=0;f<d;f++)switch(l[f].once&&this.removeListener(e,l[f].fn,void 0,!0),c){case 1:l[f].fn.call(l[f].context);break;case 2:l[f].fn.call(l[f].context,t);break;case 3:l[f].fn.call(l[f].context,t,r);break;case 4:l[f].fn.call(l[f].context,t,r,i);break;default:if(!u)for(g=1,u=new Array(c-1);g<c;g++)u[g-1]=arguments[g];l[f].fn.apply(l[f].context,u)}}return!0};ip.prototype.on=function(e,t,r){return l1e(this,e,t,r,!1)};ip.prototype.once=function(e,t,r){return l1e(this,e,t,r,!0)};ip.prototype.removeListener=function(e,t,r,i){var s=qp?qp+e:e;if(!this._events[s])return this;if(!t)return EP(this,s),this;var a=this._events[s];if(a.fn)a.fn===t&&(!i||a.once)&&(!r||a.context===r)&&EP(this,s);else{for(var o=0,l=[],c=a.length;o<c;o++)(a[o].fn!==t||i&&!a[o].once||r&&a[o].context!==r)&&l.push(a[o]);l.length?this._events[s]=l.length===1?l[0]:l:EP(this,s)}return this};ip.prototype.removeAllListeners=function(e){var t;return e?(t=qp?qp+e:e,this._events[t]&&EP(this,t)):(this._events=new Gk,this._eventsCount=0),this};ip.prototype.off=ip.prototype.removeListener;ip.prototype.addListener=ip.prototype.on;ip.prefixed=qp;ip.EventEmitter=ip;uG=ip;var mx={};px(mx,"ConnectionType",()=>S1);px(mx,"PeerErrorType",()=>pf);px(mx,"BaseConnectionErrorType",()=>fz);px(mx,"DataConnectionErrorType",()=>fG);px(mx,"SerializationType",()=>c5);px(mx,"SocketEventType",()=>d1);px(mx,"ServerMessageType",()=>Zd);var S1=(function(n){return n.Data="data",n.Media="media",n})({}),pf=(function(n){return n.BrowserIncompatible="browser-incompatible",n.Disconnected="disconnected",n.InvalidID="invalid-id",n.InvalidKey="invalid-key",n.Network="network",n.PeerUnavailable="peer-unavailable",n.SslUnavailable="ssl-unavailable",n.ServerError="server-error",n.SocketError="socket-error",n.SocketClosed="socket-closed",n.UnavailableID="unavailable-id",n.WebRTC="webrtc",n})({}),fz=(function(n){return n.NegotiationFailed="negotiation-failed",n.ConnectionClosed="connection-closed",n})({}),fG=(function(n){return n.NotOpenYet="not-open-yet",n.MessageToBig="message-too-big",n})({}),c5=(function(n){return n.Binary="binary",n.BinaryUTF8="binary-utf8",n.JSON="json",n.None="raw",n})({}),d1=(function(n){return n.Message="message",n.Disconnected="disconnected",n.Error="error",n.Close="close",n})({}),Zd=(function(n){return n.Heartbeat="HEARTBEAT",n.Candidate="CANDIDATE",n.Offer="OFFER",n.Answer="ANSWER",n.Open="OPEN",n.Error="ERROR",n.IdTaken="ID-TAKEN",n.InvalidKey="INVALID-KEY",n.Leave="LEAVE",n.Expire="EXPIRE",n})({});const c1e="1.5.5";class U0t extends uG.EventEmitter{constructor(e,t,r,i,s,a=5e3){super(),this.pingInterval=a,this._disconnected=!0,this._messagesQueue=[];const o=e?"wss://":"ws://";this._baseUrl=o+t+":"+r+i+"peerjs?key="+s}start(e,t){this._id=e;const r=`${this._baseUrl}&id=${e}&token=${t}`;this._socket||!this._disconnected||(this._socket=new WebSocket(r+"&version="+c1e),this._disconnected=!1,this._socket.onmessage=i=>{let s;try{s=JSON.parse(i.data),Nr.log("Server message received:",s)}catch{Nr.log("Invalid server message",i.data);return}this.emit(d1.Message,s)},this._socket.onclose=i=>{this._disconnected||(Nr.log("Socket closed.",i),this._cleanup(),this._disconnected=!0,this.emit(d1.Disconnected))},this._socket.onopen=()=>{this._disconnected||(this._sendQueuedMessages(),Nr.log("Socket open"),this._scheduleHeartbeat())})}_scheduleHeartbeat(){this._wsPingTimer=setTimeout(()=>{this._sendHeartbeat()},this.pingInterval)}_sendHeartbeat(){if(!this._wsOpen()){Nr.log("Cannot send heartbeat, because socket closed");return}const e=JSON.stringify({type:Zd.Heartbeat});this._socket.send(e),this._scheduleHeartbeat()}_wsOpen(){return!!this._socket&&this._socket.readyState===1}_sendQueuedMessages(){const e=[...this._messagesQueue];this._messagesQueue=[];for(const t of e)this.send(t)}send(e){if(this._disconnected)return;if(!this._id){this._messagesQueue.push(e);return}if(!e.type){this.emit(d1.Error,"Invalid message");return}if(!this._wsOpen())return;const t=JSON.stringify(e);this._socket.send(t)}close(){this._disconnected||(this._cleanup(),this._disconnected=!0)}_cleanup(){this._socket&&(this._socket.onopen=this._socket.onmessage=this._socket.onclose=null,this._socket.close(),this._socket=void 0),clearTimeout(this._wsPingTimer)}}class u1e{constructor(e){this.connection=e}startConnection(e){const t=this._startPeerConnection();if(this.connection.peerConnection=t,this.connection.type===S1.Media&&e._stream&&this._addTracksToConnection(e._stream,t),e.originator){const r=this.connection,i={ordered:!!e.reliable},s=t.createDataChannel(r.label,i);r._initializeDataChannel(s),this._makeOffer()}else this.handleSDP("OFFER",e.sdp)}_startPeerConnection(){Nr.log("Creating RTCPeerConnection.");const e=new RTCPeerConnection(this.connection.provider.options.config);return this._setupListeners(e),e}_setupListeners(e){const t=this.connection.peer,r=this.connection.connectionId,i=this.connection.type,s=this.connection.provider;Nr.log("Listening for ICE candidates."),e.onicecandidate=a=>{!a.candidate||!a.candidate.candidate||(Nr.log(`Received ICE candidates for ${t}:`,a.candidate),s.socket.send({type:Zd.Candidate,payload:{candidate:a.candidate,type:i,connectionId:r},dst:t}))},e.oniceconnectionstatechange=()=>{switch(e.iceConnectionState){case"failed":Nr.log("iceConnectionState is failed, closing connections to "+t),this.connection.emitError(fz.NegotiationFailed,"Negotiation of connection to "+t+" failed."),this.connection.close();break;case"closed":Nr.log("iceConnectionState is closed, closing connections to "+t),this.connection.emitError(fz.ConnectionClosed,"Connection to "+t+" closed."),this.connection.close();break;case"disconnected":Nr.log("iceConnectionState changed to disconnected on the connection with "+t);break;case"completed":e.onicecandidate=()=>{};break}this.connection.emit("iceStateChanged",e.iceConnectionState)},Nr.log("Listening for data channel"),e.ondatachannel=a=>{Nr.log("Received data channel");const o=a.channel;s.getConnection(t,r)._initializeDataChannel(o)},Nr.log("Listening for remote stream"),e.ontrack=a=>{Nr.log("Received remote stream");const o=a.streams[0],l=s.getConnection(t,r);if(l.type===S1.Media){const c=l;this._addStreamToMediaConnection(o,c)}}}cleanup(){Nr.log("Cleaning up PeerConnection to "+this.connection.peer);const e=this.connection.peerConnection;if(!e)return;this.connection.peerConnection=null,e.onicecandidate=e.oniceconnectionstatechange=e.ondatachannel=e.ontrack=()=>{};const t=e.signalingState!=="closed";let r=!1;const i=this.connection.dataChannel;i&&(r=!!i.readyState&&i.readyState!=="closed"),(t||r)&&e.close()}async _makeOffer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createOffer(this.connection.options.constraints);Nr.log("Created offer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Nr.log("Set localDescription:",r,`for:${this.connection.peer}`);let i={sdp:r,type:this.connection.type,connectionId:this.connection.connectionId,metadata:this.connection.metadata};if(this.connection.type===S1.Data){const s=this.connection;i={...i,label:s.label,reliable:s.reliable,serialization:s.serialization}}t.socket.send({type:Zd.Offer,payload:i,dst:this.connection.peer})}catch(i){i!="OperationError: Failed to set local offer sdp: Called in wrong state: kHaveRemoteOffer"&&(t.emitError(pf.WebRTC,i),Nr.log("Failed to setLocalDescription, ",i))}}catch(r){t.emitError(pf.WebRTC,r),Nr.log("Failed to createOffer, ",r)}}async _makeAnswer(){const e=this.connection.peerConnection,t=this.connection.provider;try{const r=await e.createAnswer();Nr.log("Created answer."),this.connection.options.sdpTransform&&typeof this.connection.options.sdpTransform=="function"&&(r.sdp=this.connection.options.sdpTransform(r.sdp)||r.sdp);try{await e.setLocalDescription(r),Nr.log("Set localDescription:",r,`for:${this.connection.peer}`),t.socket.send({type:Zd.Answer,payload:{sdp:r,type:this.connection.type,connectionId:this.connection.connectionId},dst:this.connection.peer})}catch(i){t.emitError(pf.WebRTC,i),Nr.log("Failed to setLocalDescription, ",i)}}catch(r){t.emitError(pf.WebRTC,r),Nr.log("Failed to create answer, ",r)}}async handleSDP(e,t){t=new RTCSessionDescription(t);const r=this.connection.peerConnection,i=this.connection.provider;Nr.log("Setting remote description",t);const s=this;try{await r.setRemoteDescription(t),Nr.log(`Set remoteDescription:${e} for:${this.connection.peer}`),e==="OFFER"&&await s._makeAnswer()}catch(a){i.emitError(pf.WebRTC,a),Nr.log("Failed to setRemoteDescription, ",a)}}async handleCandidate(e){Nr.log("handleCandidate:",e);try{await this.connection.peerConnection.addIceCandidate(e),Nr.log(`Added ICE candidate for:${this.connection.peer}`)}catch(t){this.connection.provider.emitError(pf.WebRTC,t),Nr.log("Failed to handleCandidate, ",t)}}_addTracksToConnection(e,t){if(Nr.log(`add tracks from stream ${e.id} to peer connection`),!t.addTrack)return Nr.error("Your browser does't support RTCPeerConnection#addTrack. Ignored.");e.getTracks().forEach(r=>{t.addTrack(r,e)})}_addStreamToMediaConnection(e,t){Nr.log(`add stream ${e.id} to media connection ${t.connectionId}`),t.addStream(e)}}class f1e extends uG.EventEmitter{emitError(e,t){Nr.error("Error:",t),this.emit("error",new B0t(`${e}`,t))}}class B0t extends Error{constructor(e,t){typeof t=="string"?super(t):(super(),Object.assign(this,t)),this.type=e}}class h1e extends f1e{get open(){return this._open}constructor(e,t,r){super(),this.peer=e,this.provider=t,this.options=r,this._open=!1,this.metadata=r.metadata}}class VL extends h1e{static#e=this.ID_PREFIX="mc_";get type(){return S1.Media}get localStream(){return this._localStream}get remoteStream(){return this._remoteStream}constructor(e,t,r){super(e,t,r),this._localStream=this.options._stream,this.connectionId=this.options.connectionId||VL.ID_PREFIX+ym.randomToken(),this._negotiator=new u1e(this),this._localStream&&this._negotiator.startConnection({_stream:this._localStream,originator:!0})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Nr.log(`DC#${this.connectionId} dc connection success`),this.emit("willCloseOnRemote")},this.dataChannel.onclose=()=>{Nr.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}addStream(e){Nr.log("Receiving stream",e),this._remoteStream=e,super.emit("stream",e)}handleMessage(e){const t=e.type,r=e.payload;switch(e.type){case Zd.Answer:this._negotiator.handleSDP(t,r.sdp),this._open=!0;break;case Zd.Candidate:this._negotiator.handleCandidate(r.candidate);break;default:Nr.warn(`Unrecognized message type:${t} from peer:${this.peer}`);break}}answer(e,t={}){if(this._localStream){Nr.warn("Local stream already exists on this MediaConnection. Are you answering a call twice?");return}this._localStream=e,t&&t.sdpTransform&&(this.options.sdpTransform=t.sdpTransform),this._negotiator.startConnection({...this.options._payload,_stream:e});const r=this.provider._getMessages(this.connectionId);for(const i of r)this.handleMessage(i);this._open=!0}close(){this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this._localStream=null,this._remoteStream=null,this.provider&&(this.provider._removeConnection(this),this.provider=null),this.options&&this.options._stream&&(this.options._stream=null),this.open&&(this._open=!1,super.emit("close"))}}class F0t{constructor(e){this._options=e}_buildRequest(e){const t=this._options.secure?"https":"http",{host:r,port:i,path:s,key:a}=this._options,o=new URL(`${t}://${r}:${i}${s}${a}/${e}`);return o.searchParams.set("ts",`${Date.now()}${Math.random()}`),o.searchParams.set("version",c1e),fetch(o.href,{referrerPolicy:this._options.referrerPolicy})}async retrieveId(){try{const e=await this._buildRequest("id");if(e.status!==200)throw new Error(`Error. Status:${e.status}`);return e.text()}catch(e){Nr.error("Error retrieving ID",e);let t="";throw this._options.path==="/"&&this._options.host!==ym.CLOUD_HOST&&(t=" If you passed in a `path` to your self-hosted PeerServer, you'll also need to pass in that same path when creating a new Peer."),new Error("Could not get an ID from the server."+t)}}async listAllPeers(){try{const e=await this._buildRequest("peers");if(e.status!==200){if(e.status===401){let t="";throw this._options.host===ym.CLOUD_HOST?t="It looks like you're using the cloud server. You can email team@peerjs.com to enable peer listing for your API key.":t="You need to enable `allow_discovery` on your self-hosted PeerServer to use this feature.",new Error("It doesn't look like you have permission to list peers IDs. "+t)}throw new Error(`Error. Status:${e.status}`)}return e.json()}catch(e){throw Nr.error("Error retrieving list peers",e),new Error("Could not get list peers from the server."+e)}}}class GL extends h1e{static#e=this.ID_PREFIX="dc_";static#t=this.MAX_BUFFERED_AMOUNT=8388608;get type(){return S1.Data}constructor(e,t,r){super(e,t,r),this.connectionId=this.options.connectionId||GL.ID_PREFIX+o1e(),this.label=this.options.label||this.connectionId,this.reliable=!!this.options.reliable,this._negotiator=new u1e(this),this._negotiator.startConnection(this.options._payload||{originator:!0,reliable:this.reliable})}_initializeDataChannel(e){this.dataChannel=e,this.dataChannel.onopen=()=>{Nr.log(`DC#${this.connectionId} dc connection success`),this._open=!0,this.emit("open")},this.dataChannel.onmessage=t=>{Nr.log(`DC#${this.connectionId} dc onmessage:`,t.data)},this.dataChannel.onclose=()=>{Nr.log(`DC#${this.connectionId} dc closed for:`,this.peer),this.close()}}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._negotiator&&(this._negotiator.cleanup(),this._negotiator=null),this.provider&&(this.provider._removeConnection(this),this.provider=null),this.dataChannel&&(this.dataChannel.onopen=null,this.dataChannel.onmessage=null,this.dataChannel.onclose=null,this.dataChannel=null),this.open&&(this._open=!1,super.emit("close"))}send(e,t=!1){if(!this.open){this.emitError(fG.NotOpenYet,"Connection is not open. You should listen for the `open` event before sending messages.");return}return this._send(e,t)}async handleMessage(e){const t=e.payload;switch(e.type){case Zd.Answer:await this._negotiator.handleSDP(e.type,t.sdp);break;case Zd.Candidate:await this._negotiator.handleCandidate(t.candidate);break;default:Nr.warn("Unrecognized message type:",e.type,"from peer:",this.peer);break}}}class hG extends GL{get bufferSize(){return this._bufferSize}_initializeDataChannel(e){super._initializeDataChannel(e),this.dataChannel.binaryType="arraybuffer",this.dataChannel.addEventListener("message",t=>this._handleDataMessage(t))}_bufferedSend(e){(this._buffering||!this._trySend(e))&&(this._buffer.push(e),this._bufferSize=this._buffer.length)}_trySend(e){if(!this.open)return!1;if(this.dataChannel.bufferedAmount>GL.MAX_BUFFERED_AMOUNT)return this._buffering=!0,setTimeout(()=>{this._buffering=!1,this._tryBuffer()},50),!1;try{this.dataChannel.send(e)}catch(t){return Nr.error(`DC#:${this.connectionId} Error when sending:`,t),this._buffering=!0,this.close(),!1}return!0}_tryBuffer(){if(!this.open||this._buffer.length===0)return;const e=this._buffer[0];this._trySend(e)&&(this._buffer.shift(),this._bufferSize=this._buffer.length,this._tryBuffer())}close(e){if(e?.flush){this.send({__peerData:{type:"close"}});return}this._buffer=[],this._bufferSize=0,super.close()}constructor(...e){super(...e),this._buffer=[],this._bufferSize=0,this._buffering=!1}}class LF extends hG{close(e){super.close(e),this._chunkedData={}}constructor(e,t,r){super(e,t,r),this.chunker=new a1e,this.serialization=c5.Binary,this._chunkedData={}}_handleDataMessage({data:e}){const t=Rbe(e),r=t.__peerData;if(r){if(r.type==="close"){this.close();return}this._handleChunk(t);return}this.emit("data",t)}_handleChunk(e){const t=e.__peerData,r=this._chunkedData[t]||{data:[],count:0,total:e.total};if(r.data[e.n]=new Uint8Array(e.data),r.count++,this._chunkedData[t]=r,r.total===r.count){delete this._chunkedData[t];const i=k0t(r.data);this._handleDataMessage({data:i})}}_send(e,t){const r=Abe(e);if(r instanceof Promise)return this._send_blob(r);if(!t&&r.byteLength>this.chunker.chunkedMTU){this._sendChunks(r);return}this._bufferedSend(r)}async _send_blob(e){const t=await e;if(t.byteLength>this.chunker.chunkedMTU){this._sendChunks(t);return}this._bufferedSend(t)}_sendChunks(e){const t=this.chunker.chunk(e);Nr.log(`DC#${this.connectionId} Try to send ${t.length} chunks...`);for(const r of t)this.send(r,!0)}}class z0t extends hG{_handleDataMessage({data:e}){super.emit("data",e)}_send(e,t){this._bufferedSend(e)}constructor(...e){super(...e),this.serialization=c5.None}}class j0t extends hG{_handleDataMessage({data:e}){const t=this.parse(this.decoder.decode(e)),r=t.__peerData;if(r&&r.type==="close"){this.close();return}this.emit("data",t)}_send(e,t){const r=this.encoder.encode(this.stringify(e));if(r.byteLength>=ym.chunkedMTU){this.emitError(fG.MessageToBig,"Message too big for JSON channel");return}this._bufferedSend(r)}constructor(...e){super(...e),this.serialization=c5.JSON,this.encoder=new TextEncoder,this.decoder=new TextDecoder,this.stringify=JSON.stringify,this.parse=JSON.parse}}class dG extends f1e{static#e=this.DEFAULT_KEY="peerjs";get id(){return this._id}get options(){return this._options}get open(){return this._open}get socket(){return this._socket}get connections(){const e=Object.create(null);for(const[t,r]of this._connections)e[t]=r;return e}get destroyed(){return this._destroyed}get disconnected(){return this._disconnected}constructor(e,t){super(),this._serializers={raw:z0t,json:j0t,binary:LF,"binary-utf8":LF,default:LF},this._id=null,this._lastServerId=null,this._destroyed=!1,this._disconnected=!1,this._open=!1,this._connections=new Map,this._lostMessages=new Map;let r;if(e&&e.constructor==Object?t=e:e&&(r=e.toString()),t={debug:0,host:ym.CLOUD_HOST,port:ym.CLOUD_PORT,path:"/",key:dG.DEFAULT_KEY,token:ym.randomToken(),config:ym.defaultConfig,referrerPolicy:"strict-origin-when-cross-origin",serializers:{},...t},this._options=t,this._serializers={...this._serializers,...this.options.serializers},this._options.host==="/"&&(this._options.host=window.location.hostname),this._options.path&&(this._options.path[0]!=="/"&&(this._options.path="/"+this._options.path),this._options.path[this._options.path.length-1]!=="/"&&(this._options.path+="/")),this._options.secure===void 0&&this._options.host!==ym.CLOUD_HOST?this._options.secure=ym.isSecure():this._options.host==ym.CLOUD_HOST&&(this._options.secure=!0),this._options.logFunction&&Nr.setLogFunction(this._options.logFunction),Nr.logLevel=this._options.debug||0,this._api=new F0t(t),this._socket=this._createServerConnection(),!ym.supports.audioVideo&&!ym.supports.data){this._delayedAbort(pf.BrowserIncompatible,"The current browser does not support WebRTC");return}if(r&&!ym.validateId(r)){this._delayedAbort(pf.InvalidID,`ID "${r}" is invalid`);return}r?this._initialize(r):this._api.retrieveId().then(i=>this._initialize(i)).catch(i=>this._abort(pf.ServerError,i))}_createServerConnection(){const e=new U0t(this._options.secure,this._options.host,this._options.port,this._options.path,this._options.key,this._options.pingInterval);return e.on(d1.Message,t=>{this._handleMessage(t)}),e.on(d1.Error,t=>{this._abort(pf.SocketError,t)}),e.on(d1.Disconnected,()=>{this.disconnected||(this.emitError(pf.Network,"Lost connection to server."),this.disconnect())}),e.on(d1.Close,()=>{this.disconnected||this._abort(pf.SocketClosed,"Underlying socket is already closed.")}),e}_initialize(e){this._id=e,this.socket.start(e,this._options.token)}_handleMessage(e){const t=e.type,r=e.payload,i=e.src;switch(t){case Zd.Open:this._lastServerId=this.id,this._open=!0,this.emit("open",this.id);break;case Zd.Error:this._abort(pf.ServerError,r.msg);break;case Zd.IdTaken:this._abort(pf.UnavailableID,`ID "${this.id}" is taken`);break;case Zd.InvalidKey:this._abort(pf.InvalidKey,`API KEY "${this._options.key}" is invalid`);break;case Zd.Leave:Nr.log(`Received leave message from ${i}`),this._cleanupPeer(i),this._connections.delete(i);break;case Zd.Expire:this.emitError(pf.PeerUnavailable,`Could not connect to peer ${i}`);break;case Zd.Offer:{const s=r.connectionId;let a=this.getConnection(i,s);if(a&&(a.close(),Nr.warn(`Offer received for existing Connection ID:${s}`)),r.type===S1.Media){const l=new VL(i,this,{connectionId:s,_payload:r,metadata:r.metadata});a=l,this._addConnection(i,a),this.emit("call",l)}else if(r.type===S1.Data){const l=new this._serializers[r.serialization](i,this,{connectionId:s,_payload:r,metadata:r.metadata,label:r.label,serialization:r.serialization,reliable:r.reliable});a=l,this._addConnection(i,a),this.emit("connection",l)}else{Nr.warn(`Received malformed connection type:${r.type}`);return}const o=this._getMessages(s);for(const l of o)a.handleMessage(l);break}default:{if(!r){Nr.warn(`You received a malformed message from ${i} of type ${t}`);return}const s=r.connectionId,a=this.getConnection(i,s);a&&a.peerConnection?a.handleMessage(e):s?this._storeMessage(s,e):Nr.warn("You received an unrecognized message:",e);break}}}_storeMessage(e,t){this._lostMessages.has(e)||this._lostMessages.set(e,[]),this._lostMessages.get(e).push(t)}_getMessages(e){const t=this._lostMessages.get(e);return t?(this._lostMessages.delete(e),t):[]}connect(e,t={}){if(t={serialization:"default",...t},this.disconnected){Nr.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect, or call reconnect on this peer if you believe its ID to still be available."),this.emitError(pf.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}const r=new this._serializers[t.serialization](e,this,t);return this._addConnection(e,r),r}call(e,t,r={}){if(this.disconnected){Nr.warn("You cannot connect to a new Peer because you called .disconnect() on this Peer and ended your connection with the server. You can create a new Peer to reconnect."),this.emitError(pf.Disconnected,"Cannot connect to new Peer after disconnecting from server.");return}if(!t){Nr.error("To call a peer, you must provide a stream from your browser's `getUserMedia`.");return}const i=new VL(e,this,{...r,_stream:t});return this._addConnection(e,i),i}_addConnection(e,t){Nr.log(`add connection ${t.type}:${t.connectionId} to peerId:${e}`),this._connections.has(e)||this._connections.set(e,[]),this._connections.get(e).push(t)}_removeConnection(e){const t=this._connections.get(e.peer);if(t){const r=t.indexOf(e);r!==-1&&t.splice(r,1)}this._lostMessages.delete(e.connectionId)}getConnection(e,t){const r=this._connections.get(e);if(!r)return null;for(const i of r)if(i.connectionId===t)return i;return null}_delayedAbort(e,t){setTimeout(()=>{this._abort(e,t)},0)}_abort(e,t){Nr.error("Aborting!"),this.emitError(e,t),this._lastServerId?this.disconnect():this.destroy()}destroy(){this.destroyed||(Nr.log(`Destroy peer with ID:${this.id}`),this.disconnect(),this._cleanup(),this._destroyed=!0,this.emit("close"))}_cleanup(){for(const e of this._connections.keys())this._cleanupPeer(e),this._connections.delete(e);this.socket.removeAllListeners()}_cleanupPeer(e){const t=this._connections.get(e);if(t)for(const r of t)r.close()}disconnect(){if(this.disconnected)return;const e=this.id;Nr.log(`Disconnect peer with ID:${e}`),this._disconnected=!0,this._open=!1,this.socket.close(),this._lastServerId=e,this._id=null,this.emit("disconnected",e)}reconnect(){if(this.disconnected&&!this.destroyed)Nr.log(`Attempting reconnection to server with ID ${this._lastServerId}`),this._disconnected=!1,this._initialize(this._lastServerId);else{if(this.destroyed)throw new Error("This peer cannot reconnect to the server. It has already been destroyed.");if(!this.disconnected&&!this.open)Nr.error("In a hurry? We're still trying to make the initial connection!");else throw new Error(`Peer ${this.id} cannot reconnect because it is not disconnected from the server!`)}}listAllPeers(e=t=>{}){this._api.listAllPeers().then(t=>e(t)).catch(t=>this._abort(pf.ServerError,t))}}var H0t=dG;function pG(n){const e=new Set;function t(s){Cke(s)&&s.target!=="tick"&&s.target!=="tock"&&e.has(s.id)===!1&&(e.add(s.id),K2.invoke(s))}const r=H1("forward",["all"],s=>{e.has(s.id)||(e.add(s.id),n(s))});function i(){K2.disconnect(r)}return{forward:t,disconnect:i}}function q0t(n){switch(n.target){case"tick":case"tock":case"ready":return!0}return!1}function V0t(n){switch(n.target){case"log":case"info":case"error":case"tick":case"tock":case"ready":case"chat":case"toast":case"second":return!0;default:{const e=EE(n.target);switch(e.target){case"vm":case"synth":case"modem":case"bridge":case"register":case"gadgetclient":return!0}switch(e.path){case"sync":case"joinack":case"acklogin":case"ackoperator":case"ackzsswords":case"gadgetclient":return!0}break}}return!1}function G0t(n){switch(n.target){case"tick":case"tock":case"second":return!0}return!1}function d1e(n){const e=EE(n.target);switch(e.target){case"vm":case"modem":case"gadgetserver":return!0}switch(e.path){case"sync":case"desync":case"joinack":return!0}return!1}let kg="",Ns,$k,Mv,Sd;const pse={},mG=new Map,$L=new Map;function p1e(n){return xe(Sd)?Sd.listClosestToId(Ig(n),1).filter(e=>e.peer!==Ns?.id):[]}function gG(n){return JOe(n)}let WL;function $0t(){if(xe(WL)||Ns?.id===kg)return;S1e=128;function n(){const e=ss();_Oe(xt,e),xs(xt,e,"uplinking....")}n(),WL=setInterval(n,5*1e3)}function m1e(){clearInterval(WL),WL=void 0}function g1e(n,e){if(!xe(Ns)||!xe(Sd))return;const t=p1e(n);for(let r=0;r<t.length;++r){const i=t[r];i.peer!==Ns.id&&i.dataconnection?.open&&i.dataconnection?.send(e)?.catch(a=>console.error(a))}}function _1e(n){if(!xe(Ns)||!xe(Sd))return;const e=Date.now(),t=$L.get(kg)??new Map;for(const[r,i]of t)e-i>1e3*60?t.delete(r):g1e(r,n)}function mse(n){$k?.forward({...n,session:xt.session()}),n.target.includes("acklogin")&&m1e()}const W0t=5e3;function v1e(n){const e=ss();pse[n.peer]=setTimeout(()=>{Mv?.remove(Ig(n.peer)),mG.set(n.peer,!0),xs(xt,e,`failed to connect to ${n.peer}`)},W0t);function t(){if(n.open&&xe(Sd)&&xe(Ns)){xs(xt,e,`connection ${n.peer} open`),Sd.add({peer:n.peer,id:Ig(n.peer),dataconnection:n});const i={id:vc(),topic:kg,ping:Ns.id};n.send(i)?.catch(a=>console.error(a)),$0t()}}n.on("open",t),n.on("close",()=>{xe(Ns)&&xe(Sd)&&(xs(xt,e,`disconnection from ${n.peer}`),Sd.remove(Ig(n.peer)))});const r=new Set;n.on("data",i=>{const s=i;if(r.has(s.id)||!xe(Ns)||!xe(Mv)||!xe(Sd))return;r.add(s.id);const a=Date.now(),o=$L.get(kg)??new Map;if("ping"in s){if(s.topic===kg&&s.ping!==Ns.id){const l={id:vc(),topic:kg,pong:Ns.id};n.send(l)?.catch(u=>console.error(u))}}else if("pong"in s)clearTimeout(pse[s.pong]),xs(xt,e,`connected to ${n.peer}`);else if("pub"in s)s.topic===kg&&mse(s.gme),_1e(s);else if("sub"in s){o.set(s.sub,a);const l=Ig(s.sub);Mv.has(l)||Mv.add({peer:s.sub,id:l,dataconnection:void 0}),s.topic===Ns.id?xe(s.gme)&&mse(s.gme):g1e(s.topic,s)}$L.set(s.topic,o)}),n.on("error",i=>{Si(xt,e,"netterminal",`dataconnection ${n.peer} - ${JSON.stringify(i)}`)}),t()}function y1e(n){kg=n;const e=ss(),t=gG(e);Ns=new H0t(t,{debug:2}),window.addEventListener("unload",()=>{Ns?.disconnect(),Ns=void 0}),xs(xt,e,`netterminal for ${t}`),xs(xt,e,`session topic ${kg}`),Mv=new ise(Ig(Ns.id),{getId(r){return r.id}}),Sd=new ise(Ig(Ns.id),{getId(r){return r.id}}),Ns.on("open",()=>{xs(xt,ss(),"connected to netterminal"),E1e()}),Ns.on("connection",v1e),Ns.on("call",()=>{}),Ns.on("disconnected",()=>{Si(xt,ss(),"netterminal","lost connection to netterminal"),X0t()}),Ns.on("error",r=>{switch(r.type){case"peer-unavailable":return}Si(xt,ss(),"netterminal",`${Ns?.id} - ${JSON.stringify(r)}`)})}function gse(){const n=ss();if(xe(Ns)){xs(xt,n,"netterminal already active");return}y1e(gG(n)),$k=pG(e=>{if(xe(Ns)&&xe(Sd)&&V0t(e)&&q0t(e)===!1){const t={id:vc(),topic:kg,pub:Ns.id,gme:e};_1e(t)}})}function Y0t(n){if(xe(Ns)){xs(xt,ss(),"netterminal already active");return}y1e(n),$k=pG(e=>{if(xe(Ns)&&xe(Sd)&&d1e(e)&&G0t(e)===!1){const t=p1e(kg);for(let r=0;r<t.length;++r){const i=t[r];if(i.dataconnection?.open){const s={id:vc(),topic:kg,sub:Ns.id,gme:e};i.dataconnection.send(s,!0)?.catch(o=>console.error(o))}}}})}let b1e,S1e=16;function E1e(){Fc(xt,ss(),async()=>{if(!xe(Ns)||!xe(Mv)||!xe(Sd))return;const n=ss(),e=new FormData;e.append("peer",`pid_${Ns.id}`);const t=new Request("https://terminal.zed.cafe",{method:"POST",body:e}),i=await(await fetch(t)).json();if(bi(i))for(let u=0;u<i.length;++u){const f=i[u].replace("pid_",""),d=Ig(f);Ns.id!=f&&Mv.has(d)===!1&&mG.has(f)===!1&&(xs(xt,n,`adding ${f}`),Mv.add({peer:f,id:d,dataconnection:void 0}))}const s=Ig(Ns.id),a=7,o=Mv.listClosestToId(s,a).filter(u=>u.peer!==Ns?.id),l=new Set;for(let u=0;u<o.length;++u){const f=o[u];l.add(f.peer),Sd.has(f.id)||v1e(Ns.connect(f.peer,{reliable:!0}))}const c=Sd.listClosestToId(s,a*2).filter(u=>u.peer!==Ns?.id);for(let u=0;u<c.length;++u){const f=c[u];l.has(f.peer)===!1&&(f.dataconnection?.close(),Sd.remove(f.id))}}),b1e=setTimeout(E1e,S1e*1e3)}function X0t(){xe(Ns)&&(kg="",$L.clear(),mG.clear(),clearTimeout(b1e),Ns.destroy(),Ns=void 0,Mv=void 0,Sd=void 0,$k?.disconnect(),$k=void 0,m1e())}let av,Xd;async function K0t(n,e,t,r,i,s){let a;switch(qr(i)){case"get":{a=await fetch(r);break}case"post:json":{const c=[];for(let u=0;u<s.length;u+=2)c.push([s[u],s[u+1]]);a=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Rke(c))});break}}if(!a?.ok)return;const o=`fetch:${t}`,[l]=(a.headers.get("content-type")??"").split(";");switch(l){case"text/plain":{const c=await a.text();xs(xt,n,JSON.stringify(c)),T_(xt,n,e,"text",o,c);break}case"application/json":{const c=await a.json();xs(xt,n,JSON.stringify(c)),T_(xt,n,e,"json",o,c);break}case"application/octet-stream":{const c=await a.arrayBuffer();T_(xt,n,e,"binary",o,new Uint8Array(c));break}}}function _se(n){const e=`${location.origin}/join/#${gG(n)}`;return xe(Qo())&&Qo().writeText(e).catch(t=>console.error(t)),e}function Z0t(n){const e=/(?:https?|ftp):\/\/[\n\S]+/g;return n.replace(e,"")}function vse(n){let e=n.text;const t=[...n.emoteOffsets.values()];for(let r=0;r<t.length;++r){const i=t[r].reverse();for(let s=0;s<i.length;++s){const[a,o]=i[s].split("-").map(parseFloat);e=e.substring(0,a)+e.substring(o+1)}}return Z0t(e)}const yl=H1("bridge",[],n=>{if(!yl.session(n))return;const e=ss();switch(n.target){default:if(n.player!==e)return;break}switch(n.target){case"fetch":if(bi(n.data)){const[t,r,i,s,a]=n.data;Fc(xt,n.player,async()=>{await K0t(n.player,t,r,i,s,a)})}break;case"start":gse(),jke(xt,n.player,!!n.data);break;case"tab":gse(),zke(xt,n.player);break;case"tabopen":Fc(yl,n.player,async()=>{await Ch(1e3);const t=_se(n.player);window.open(t,"_blank","noopener,noreferrer")});break;case"join":Vn(n.data)&&Y0t(n.data);break;case"showjoincode":Fc(yl,n.player,async()=>{const t=_se(n.player),r=await _ge(t);n.data?P7(yl,n.player,r,"secret join url",!1):P7(yl,n.player,r,r)});break;case"chatstart":xe(av)?Si(yl,n.player,"bridge","chat is already started"):Vn(n.data)&&(xs(yl,n.player,`connecting to ${n.data}`),av=new qL({channels:[n.data]}),av.connect(),av.onConnect(()=>{xs(yl,n.player,"connected")}),av.onDisconnect(()=>{xs(yl,n.player,"disconnected")}),av.onMessage((t,r,i,s)=>{const a=vse(s);T_(yl,n.player,void 0,"text",`chat:message:${n.data}`,`${r}:${a}`)}),av.onAction((t,r,i,s)=>{const a=vse(s);T_(yl,n.player,void 0,"text",`chat:action:${n.data}`,`${r}:${a}`)}));break;case"chatstop":xe(av)?(av.quit(),av=void 0,xs(yl,n.player,"chat stopped")):Si(yl,n.player,"bridge","chat is already stoped");break;case"streamstart":Fc(yl,n.player,async()=>{if(xe(Xd))Si(yl,n.player,"bridge","stream is already open");else{const t=window.innerHeight>window.innerWidth;Xd=kS.create({streamConfig:t?kS.STANDARD_PORTRAIT:kS.STANDARD_LANDSCAPE,logLevel:kS.LOG_LEVEL.DEBUG}),Xd.on(kS.BroadcastClientEvents.ACTIVE_STATE_CHANGE,function(s){console.info({activestate:s})}),Xd.on(kS.BroadcastClientEvents.CONNECTION_STATE_CHANGE,function(s){xs(yl,n.player,s)}),Xd.on(kS.BroadcastClientEvents.ERROR,function(s){Si(yl,n.player,"bridge",s),Xd=void 0});const r=document.querySelector("canvas");if(xe(r))await Xd.addImageSource(r,"video",{index:1});else{Si(yl,n.player,"video","unabled to find canvas element"),Xd=void 0;return}const i=kut();if(xe(i))await Xd.addAudioInputDevice(i.stream,"audio");else{Si(yl,n.player,"video","unable create media audio node destination"),Xd=void 0;return}xs(yl,n.player,"created client")}Vn(n.data)&&xe(Xd)&&(y_(yl,n.player,"broadcasting in"),Tm(yl,n.player,"3","..."),await Ch(1e3),Tm(yl,n.player,"2","..."),await Ch(1e3),Tm(yl,n.player,"1","..."),await Ch(1e3),y_(yl,n.player,"GOING LIVE"),await Xd.startBroadcast(n.data,"https://g.webrtc.live-video.net:4443"))});break;case"streamstop":xe(Xd)?(Xd.stopBroadcast(),Xd.delete(),Xd=void 0,xs(yl,n.player,"stream stopped")):Si(yl,n.player,"bridge","stream already stopped");break}});function Q0t(){const{viewport:n}=Im(),{width:e,height:t}=n.getCurrentViewport(),[r]=it.useState(()=>new zut);it.useEffect(()=>{if(!uBe)return;document.body.appendChild(r.dom),r.showPanel(0),r.dom.style.cssText="position:fixed;bottom:0;left:0;";const v=P2e(()=>r.begin()),x=D2e(()=>r.end());return()=>{document.body.removeChild(r.dom),v(),x()}},[r]);const i=$ut({benchmarksURL:"/benchmarks-min"}),[s,a]=it.useState(!1),[o,l]=it.useState(!1),[c,u]=it.useState(!1);it.useLayoutEffect(()=>{Fc(xt,ss(),async()=>{await w2("lowrez")==="on"&&a(!0),await w2("crt")==="on"&&!idt&&l(!0),await w2("scanlines")==="on"&&u(!0)})},[]);const f=Math.min(e,t),d=s||f<600;Gn.DRAW_CHAR_SCALE=d?1:2;const g=e>t,p=X9==="touchOnly"||Pht==="touch",_=!d&&!p&&o===!0&&i&&i.tier>2&&!i.isMobile;it.useEffect(()=>{el.setState(v=>({...v,islowrez:d,islandscape:g,showtouchcontrols:p}))},[d,g,p]);const y=it.useRef(null);return we.jsxs(we.Fragment,{children:[we.jsx(Lut,{ref:y,makeDefault:!0,near:1,far:2e3,position:[0,0,1e3]}),we.jsx(J1,{children:we.jsxs(Pdt,{children:[we.jsx(Xpt,{}),we.jsx(zmt,{}),we.jsx($mt,{}),we.jsx(Ymt,{})]})}),we.jsx(Vmt,{width:e,height:t,children:we.jsx(we.Fragment,{children:_&&we.jsxs(we.Fragment,{children:[c&&we.jsx(qmt,{}),we.jsx(Cht,{technique:oT.ESKIL,offset:.89,darkness:.911}),we.jsx(jht,{viewheight:t})]})})})]})}function J0t(n){return new Worker("/assets/simspace-BvVKmxGU.js",{name:n?.name})}function e_t(n){return new Worker("/assets/stubspace-MWP3_jzt.js",{name:n?.name})}let ky,hz;function t_t(n=!1){if(xe(ky))return;Mke(xt),ky=n?new e_t:new J0t;const{forward:e,disconnect:t}=pG(i=>{xe(ky)&&d1e(i)&&ky.postMessage(i)});function r(i){return e(i.data)}ky.addEventListener("message",r),hz=()=>{t(),xe(ky)&&(ky.removeEventListener("message",r),ky.terminate()),ky=void 0}}function n_t(){hz?.(),hz=void 0}document.addEventListener("keydown",()=>{e3()});window.addEventListener("click",()=>{e3()});window.addEventListener("dragover",n=>{n.preventDefault()});window.addEventListener("contextmenu",n=>{e3(),n.preventDefault()});window.addEventListener("paste",n=>{if(!n.clipboardData?.files.length)return;e3(),n.preventDefault(),[...n.clipboardData.files].forEach(t=>T_(xt,ss(),void 0,"file",`file:${t.name}`,t))});window.addEventListener("drop",n=>{e3(),n.preventDefault(),n.dataTransfer?.items?[...n.dataTransfer.items].forEach(t=>{if(t.kind==="file"){const r=t.getAsFile();xe(r)&&T_(xt,ss(),void 0,"file",r.name,r)}}):[...n.dataTransfer?.files??[]].forEach(t=>T_(xt,ss(),void 0,"file",t.name,t))});document.addEventListener("DOMContentLoaded",()=>{let n,e=!1;document.body.style.cursor="none",document.body.addEventListener("mousemove",()=>{e||(document.body.style.cursor="",clearTimeout(n),n=setTimeout(()=>{document.body.style.cursor="none",e=!0,setTimeout(()=>{e=!1},200)},3e3))})});function r_t(){const n=el(t=>t.active),e=el(t=>t.refresh);return it.useEffect(()=>(t_t(vge()),()=>{n_t()}),[e]),n&&we.jsx(Q0t,{},e)}const i_t=n=>({...Koe(n),filter:e=>{const t=e.filter(a=>!!a.object.visible),r=t.findIndex(a=>a.object.userData.blocking),i=r===-1?t:t.slice(0,r+1);let s="default";return i.some(a=>a.object.userData.cursor?(s=a.object.userData.cursor,!0):!1),document.querySelectorAll("html, body").forEach(a=>{a.style.cursor=s}),i}});let UF;function s_t(n,e){const t=document.getElementById("frame");if(!xe(t))return;const r=lY(n),i=lY(e);t.style.width=`${r}px`,t.style.height=`${i}px`,xe(UF)||(UF=Q2e.createRoot(t),UF.render(we.jsx(H2e,{flat:!0,linear:!0,dpr:1,shadows:!1,events:i_t,gl:{alpha:!0,stencil:!1,antialias:!1,preserveDrawingBuffer:!0},children:we.jsx(r_t,{})})))}const x1e=G2e(s_t,256);window.addEventListener("resize",()=>x1e(window.innerWidth,window.innerHeight));x1e(window.innerWidth,window.innerHeight)});export default a_t();
